(function(e,A){typeof exports=="object"&&typeof module<"u"?A(exports,require("react"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","react-dom"],A):(e=typeof globalThis<"u"?globalThis:e||self,A(e["desmy-react"]={},e.React,e.ReactDOM))})(this,function(exports,React2,ReactDOM){"use strict";var _documentCurrentScript=typeof document<"u"?document.currentScript:null;function _interopNamespaceDefault(e){const A=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const l in e)if(l!=="default"){const o=Object.getOwnPropertyDescriptor(e,l);Object.defineProperty(A,l,o.get?o:{enumerable:!0,get:()=>e[l]})}}return A.default=e,Object.freeze(A)}const React2__namespace=_interopNamespaceDefault(React2);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var A=e.default;if(typeof A=="function"){var l=function o(){return this instanceof o?Reflect.construct(A,arguments,this.constructor):A.apply(this,arguments)};l.prototype=A.prototype}else l={};return Object.defineProperty(l,"__esModule",{value:!0}),Object.keys(e).forEach(function(o){var t=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(l,o,t.get?t:{enumerable:!0,get:function(){return e[o]}})}),l}var jsxRuntime={exports:{}},reactJsxRuntime_production={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var e=Symbol.for("react.transitional.element"),A=Symbol.for("react.fragment");function l(o,t,a){var n=null;if(a!==void 0&&(n=""+a),t.key!==void 0&&(n=""+t.key),"key"in t){a={};for(var B in t)B!=="key"&&(a[B]=t[B])}else a=t;return t=a.ref,{$$typeof:e,type:o,key:n,ref:t!==void 0?t:null,props:a}}return reactJsxRuntime_production.Fragment=A,reactJsxRuntime_production.jsx=l,reactJsxRuntime_production.jsxs=l,reactJsxRuntime_production}var reactJsxRuntime_development={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_development;function requireReactJsxRuntime_development(){return hasRequiredReactJsxRuntime_development||(hasRequiredReactJsxRuntime_development=1,process.env.NODE_ENV!=="production"&&function(){function e(wI){if(wI==null)return null;if(typeof wI=="function")return wI.$$typeof===WI?null:wI.displayName||wI.name||null;if(typeof wI=="string")return wI;switch(wI){case CI:return"Fragment";case oI:return"Profiler";case sI:return"StrictMode";case M:return"Suspense";case O:return"SuspenseList";case aI:return"Activity"}if(typeof wI=="object")switch(typeof wI.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),wI.$$typeof){case lI:return"Portal";case _:return(wI.displayName||"Context")+".Provider";case E:return(wI._context.displayName||"Context")+".Consumer";case gI:var pI=wI.render;return wI=wI.displayName,wI||(wI=pI.displayName||pI.name||"",wI=wI!==""?"ForwardRef("+wI+")":"ForwardRef"),wI;case dI:return pI=wI.displayName||null,pI!==null?pI:e(wI.type)||"Memo";case eI:pI=wI._payload,wI=wI._init;try{return e(wI(pI))}catch{}}return null}function A(wI){return""+wI}function l(wI){try{A(wI);var pI=!1}catch{pI=!0}if(pI){pI=console;var xI=pI.error,PI=typeof Symbol=="function"&&Symbol.toStringTag&&wI[Symbol.toStringTag]||wI.constructor.name||"Object";return xI.call(pI,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",PI),A(wI)}}function o(wI){if(wI===CI)return"<>";if(typeof wI=="object"&&wI!==null&&wI.$$typeof===eI)return"<...>";try{var pI=e(wI);return pI?"<"+pI+">":"<...>"}catch{return"<...>"}}function t(){var wI=GI.A;return wI===null?null:wI.getOwner()}function a(){return Error("react-stack-top-frame")}function n(wI){if(HI.call(wI,"key")){var pI=Object.getOwnPropertyDescriptor(wI,"key").get;if(pI&&pI.isReactWarning)return!1}return wI.key!==void 0}function B(wI,pI){function xI(){DI||(DI=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",pI))}xI.isReactWarning=!0,Object.defineProperty(wI,"key",{get:xI,configurable:!0})}function R(){var wI=e(this.type);return NI[wI]||(NI[wI]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),wI=this.props.ref,wI!==void 0?wI:null}function r(wI,pI,xI,PI,XI,tI,mI,YI){return xI=tI.ref,wI={$$typeof:iI,type:wI,key:pI,props:tI,_owner:XI},(xI!==void 0?xI:null)!==null?Object.defineProperty(wI,"ref",{enumerable:!1,get:R}):Object.defineProperty(wI,"ref",{enumerable:!1,value:null}),wI._store={},Object.defineProperty(wI._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(wI,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(wI,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:mI}),Object.defineProperty(wI,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:YI}),Object.freeze&&(Object.freeze(wI.props),Object.freeze(wI)),wI}function H(wI,pI,xI,PI,XI,tI,mI,YI){var BI=pI.children;if(BI!==void 0)if(PI)if(MI(BI)){for(PI=0;PI<BI.length;PI++)II(BI[PI]);Object.freeze&&Object.freeze(BI)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else II(BI);if(HI.call(pI,"key")){BI=e(wI);var AI=Object.keys(pI).filter(function(bI){return bI!=="key"});PI=0<AI.length?"{key: someKey, "+AI.join(": ..., ")+": ...}":"{key: someKey}",hI[BI+PI]||(AI=0<AI.length?"{"+AI.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,PI,BI,AI,BI),hI[BI+PI]=!0)}if(BI=null,xI!==void 0&&(l(xI),BI=""+xI),n(pI)&&(l(pI.key),BI=""+pI.key),"key"in pI){xI={};for(var cI in pI)cI!=="key"&&(xI[cI]=pI[cI])}else xI=pI;return BI&&B(xI,typeof wI=="function"?wI.displayName||wI.name||"Unknown":wI),r(wI,BI,tI,XI,t(),xI,mI,YI)}function II(wI){typeof wI=="object"&&wI!==null&&wI.$$typeof===iI&&wI._store&&(wI._store.validated=1)}var k=React2,iI=Symbol.for("react.transitional.element"),lI=Symbol.for("react.portal"),CI=Symbol.for("react.fragment"),sI=Symbol.for("react.strict_mode"),oI=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),_=Symbol.for("react.context"),gI=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),dI=Symbol.for("react.memo"),eI=Symbol.for("react.lazy"),aI=Symbol.for("react.activity"),WI=Symbol.for("react.client.reference"),GI=k.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,HI=Object.prototype.hasOwnProperty,MI=Array.isArray,KI=console.createTask?console.createTask:function(){return null};k={"react-stack-bottom-frame":function(wI){return wI()}};var DI,NI={},yI=k["react-stack-bottom-frame"].bind(k,a)(),VI=KI(o(a)),hI={};reactJsxRuntime_development.Fragment=CI,reactJsxRuntime_development.jsx=function(wI,pI,xI,PI,XI){var tI=1e4>GI.recentlyCreatedOwnerStacks++;return H(wI,pI,xI,!1,PI,XI,tI?Error("react-stack-top-frame"):yI,tI?KI(o(wI)):VI)},reactJsxRuntime_development.jsxs=function(wI,pI,xI,PI,XI){var tI=1e4>GI.recentlyCreatedOwnerStacks++;return H(wI,pI,xI,!0,PI,XI,tI?Error("react-stack-top-frame"):yI,tI?KI(o(wI)):VI)}}()),reactJsxRuntime_development}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,process.env.NODE_ENV==="production"?jsxRuntime.exports=requireReactJsxRuntime_production():jsxRuntime.exports=requireReactJsxRuntime_development()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime();function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}},dommatrix$1={exports:{}};/*!
* DOMMatrix v1.0.3 (https://thednp.github.io/dommatrix/)
* Copyright 2022 Â© thednp
* Licensed under MIT (https://github.com/thednp/DOMMatrix/blob/master/LICENSE)
*/var dommatrix=dommatrix$1.exports,hasRequiredDommatrix;function requireDommatrix(){return hasRequiredDommatrix||(hasRequiredDommatrix=1,function(e,A){(function(l,o){e.exports=o()})(dommatrix,function(){function l(E){var _=new lI,gI=Array.from(E);if(!gI.every(function(YI){return!Number.isNaN(YI)}))throw TypeError('CSSMatrix: "'+E+'" must only have numbers.');if(gI.length===16){var M=gI[0],O=gI[1],dI=gI[2],eI=gI[3],aI=gI[4],WI=gI[5],GI=gI[6],HI=gI[7],MI=gI[8],KI=gI[9],DI=gI[10],NI=gI[11],yI=gI[12],VI=gI[13],hI=gI[14],wI=gI[15];_.m11=M,_.a=M,_.m21=aI,_.c=aI,_.m31=MI,_.m41=yI,_.e=yI,_.m12=O,_.b=O,_.m22=WI,_.d=WI,_.m32=KI,_.m42=VI,_.f=VI,_.m13=dI,_.m23=GI,_.m33=DI,_.m43=hI,_.m14=eI,_.m24=HI,_.m34=NI,_.m44=wI}else if(gI.length===6){var pI=gI[0],xI=gI[1],PI=gI[2],XI=gI[3],tI=gI[4],mI=gI[5];_.m11=pI,_.a=pI,_.m12=xI,_.b=xI,_.m21=PI,_.c=PI,_.m22=XI,_.d=XI,_.m41=tI,_.e=tI,_.m42=mI,_.f=mI}else throw new TypeError("CSSMatrix: expecting an Array of 6/16 values.");return _}function o(E){var _=Object.keys(new lI);if(typeof E=="object"&&_.every(function(gI){return gI in E}))return l([E.m11,E.m12,E.m13,E.m14,E.m21,E.m22,E.m23,E.m24,E.m31,E.m32,E.m33,E.m34,E.m41,E.m42,E.m43,E.m44]);throw TypeError('CSSMatrix: "'+JSON.stringify(E)+'" is not a DOMMatrix / CSSMatrix / JSON compatible object.')}function t(E){if(typeof E!="string")throw TypeError('CSSMatrix: "'+E+'" is not a string.');var _=String(E).replace(/\s/g,""),gI=new lI,M='CSSMatrix: invalid transform string "'+E+'"';return _.split(")").filter(function(O){return O}).forEach(function(O){var dI=O.split("("),eI=dI[0],aI=dI[1];if(!aI)throw TypeError(M);var WI=aI.split(",").map(function(tI){return tI.includes("rad")?parseFloat(tI)*(180/Math.PI):parseFloat(tI)}),GI=WI[0],HI=WI[1],MI=WI[2],KI=WI[3],DI=[GI,HI,MI],NI=[GI,HI,MI,KI];if(eI==="perspective"&&GI&&[HI,MI].every(function(tI){return tI===void 0}))gI.m34=-1/GI;else if(eI.includes("matrix")&&[6,16].includes(WI.length)&&WI.every(function(tI){return!Number.isNaN(+tI)})){var yI=WI.map(function(tI){return Math.abs(tI)<1e-6?0:tI});gI=gI.multiply(l(yI))}else if(eI==="translate3d"&&DI.every(function(tI){return!Number.isNaN(+tI)}))gI=gI.translate(GI,HI,MI);else if(eI==="translate"&&GI&&MI===void 0)gI=gI.translate(GI,HI||0,0);else if(eI==="rotate3d"&&NI.every(function(tI){return!Number.isNaN(+tI)})&&KI)gI=gI.rotateAxisAngle(GI,HI,MI,KI);else if(eI==="rotate"&&GI&&[HI,MI].every(function(tI){return tI===void 0}))gI=gI.rotate(0,0,GI);else if(eI==="scale3d"&&DI.every(function(tI){return!Number.isNaN(+tI)})&&DI.some(function(tI){return tI!==1}))gI=gI.scale(GI,HI,MI);else if(eI==="scale"&&!Number.isNaN(GI)&&GI!==1&&MI===void 0){var VI=Number.isNaN(+HI),hI=VI?GI:HI;gI=gI.scale(GI,hI,1)}else if(eI==="skew"&&(GI||!Number.isNaN(GI)&&HI)&&MI===void 0)gI=gI.skew(GI,HI||0);else if(/[XYZ]/.test(eI)&&GI&&[HI,MI].every(function(tI){return tI===void 0})&&["translate","rotate","scale","skew"].some(function(tI){return eI.includes(tI)}))if(["skewX","skewY"].includes(eI))gI=gI[eI](GI);else{var wI=eI.replace(/[XYZ]/,""),pI=eI.replace(wI,""),xI=["X","Y","Z"].indexOf(pI),PI=wI==="scale"?1:0,XI=[xI===0?GI:PI,xI===1?GI:PI,xI===2?GI:PI];gI=gI[wI].apply(gI,XI)}else throw TypeError(M)}),gI}function a(E,_){return _?[E.a,E.b,E.c,E.d,E.e,E.f]:[E.m11,E.m12,E.m13,E.m14,E.m21,E.m22,E.m23,E.m24,E.m31,E.m32,E.m33,E.m34,E.m41,E.m42,E.m43,E.m44]}function n(E,_,gI){var M=new lI;return M.m41=E,M.e=E,M.m42=_,M.f=_,M.m43=gI,M}function B(E,_,gI){var M=new lI,O=Math.PI/180,dI=E*O,eI=_*O,aI=gI*O,WI=Math.cos(dI),GI=-Math.sin(dI),HI=Math.cos(eI),MI=-Math.sin(eI),KI=Math.cos(aI),DI=-Math.sin(aI),NI=HI*KI,yI=-HI*DI;M.m11=NI,M.a=NI,M.m12=yI,M.b=yI,M.m13=MI;var VI=GI*MI*KI+WI*DI;M.m21=VI,M.c=VI;var hI=WI*KI-GI*MI*DI;return M.m22=hI,M.d=hI,M.m23=-GI*HI,M.m31=GI*DI-WI*MI*KI,M.m32=GI*KI+WI*MI*DI,M.m33=WI*HI,M}function R(E,_,gI,M){var O=new lI,dI=Math.sqrt(E*E+_*_+gI*gI);if(dI===0)return O;var eI=E/dI,aI=_/dI,WI=gI/dI,GI=M*(Math.PI/360),HI=Math.sin(GI),MI=Math.cos(GI),KI=HI*HI,DI=eI*eI,NI=aI*aI,yI=WI*WI,VI=1-2*(NI+yI)*KI;O.m11=VI,O.a=VI;var hI=2*(eI*aI*KI+WI*HI*MI);O.m12=hI,O.b=hI,O.m13=2*(eI*WI*KI-aI*HI*MI);var wI=2*(aI*eI*KI-WI*HI*MI);O.m21=wI,O.c=wI;var pI=1-2*(yI+DI)*KI;return O.m22=pI,O.d=pI,O.m23=2*(aI*WI*KI+eI*HI*MI),O.m31=2*(WI*eI*KI+aI*HI*MI),O.m32=2*(WI*aI*KI-eI*HI*MI),O.m33=1-2*(DI+NI)*KI,O}function r(E,_,gI){var M=new lI;return M.m11=E,M.a=E,M.m22=_,M.d=_,M.m33=gI,M}function H(E,_){var gI=new lI;if(E){var M=E*Math.PI/180,O=Math.tan(M);gI.m21=O,gI.c=O}if(_){var dI=_*Math.PI/180,eI=Math.tan(dI);gI.m12=eI,gI.b=eI}return gI}function II(E){return H(E,0)}function k(E){return H(0,E)}function iI(E,_){var gI=_.m11*E.m11+_.m12*E.m21+_.m13*E.m31+_.m14*E.m41,M=_.m11*E.m12+_.m12*E.m22+_.m13*E.m32+_.m14*E.m42,O=_.m11*E.m13+_.m12*E.m23+_.m13*E.m33+_.m14*E.m43,dI=_.m11*E.m14+_.m12*E.m24+_.m13*E.m34+_.m14*E.m44,eI=_.m21*E.m11+_.m22*E.m21+_.m23*E.m31+_.m24*E.m41,aI=_.m21*E.m12+_.m22*E.m22+_.m23*E.m32+_.m24*E.m42,WI=_.m21*E.m13+_.m22*E.m23+_.m23*E.m33+_.m24*E.m43,GI=_.m21*E.m14+_.m22*E.m24+_.m23*E.m34+_.m24*E.m44,HI=_.m31*E.m11+_.m32*E.m21+_.m33*E.m31+_.m34*E.m41,MI=_.m31*E.m12+_.m32*E.m22+_.m33*E.m32+_.m34*E.m42,KI=_.m31*E.m13+_.m32*E.m23+_.m33*E.m33+_.m34*E.m43,DI=_.m31*E.m14+_.m32*E.m24+_.m33*E.m34+_.m34*E.m44,NI=_.m41*E.m11+_.m42*E.m21+_.m43*E.m31+_.m44*E.m41,yI=_.m41*E.m12+_.m42*E.m22+_.m43*E.m32+_.m44*E.m42,VI=_.m41*E.m13+_.m42*E.m23+_.m43*E.m33+_.m44*E.m43,hI=_.m41*E.m14+_.m42*E.m24+_.m43*E.m34+_.m44*E.m44;return l([gI,M,O,dI,eI,aI,WI,GI,HI,MI,KI,DI,NI,yI,VI,hI])}var lI=function(){for(var _=[],gI=arguments.length;gI--;)_[gI]=arguments[gI];var M=this;if(M.a=1,M.b=0,M.c=0,M.d=1,M.e=0,M.f=0,M.m11=1,M.m12=0,M.m13=0,M.m14=0,M.m21=0,M.m22=1,M.m23=0,M.m24=0,M.m31=0,M.m32=0,M.m33=1,M.m34=0,M.m41=0,M.m42=0,M.m43=0,M.m44=1,_.length){var O=[16,6].some(function(dI){return dI===_.length})?_:_[0];return M.setMatrixValue(O)}return M},CI={isIdentity:{configurable:!0},is2D:{configurable:!0}};CI.isIdentity.get=function(){var E=this;return E.m11===1&&E.m12===0&&E.m13===0&&E.m14===0&&E.m21===0&&E.m22===1&&E.m23===0&&E.m24===0&&E.m31===0&&E.m32===0&&E.m33===1&&E.m34===0&&E.m41===0&&E.m42===0&&E.m43===0&&E.m44===1},CI.is2D.get=function(){var E=this;return E.m31===0&&E.m32===0&&E.m33===1&&E.m34===0&&E.m43===0&&E.m44===1},lI.prototype.setMatrixValue=function(_){var gI=this;return typeof _=="string"&&_.length&&_!=="none"?t(_):[Array,Float64Array,Float32Array].some(function(M){return _ instanceof M})?l(_):[lI,DOMMatrix,Object].some(function(M){return _ instanceof M})?o(_):gI},lI.prototype.toFloat32Array=function(_){return Float32Array.from(a(this,_))},lI.prototype.toFloat64Array=function(_){return Float64Array.from(a(this,_))},lI.prototype.toString=function(){var _=this,gI=_.is2D,M=_.toFloat64Array(gI).join(", "),O=gI?"matrix":"matrix3d";return O+"("+M+")"},lI.prototype.toJSON=function(){var _=this,gI=_.is2D,M=_.isIdentity;return Object.assign({},_,{is2D:gI,isIdentity:M})},lI.prototype.multiply=function(_){return iI(this,_)},lI.prototype.translate=function(_,gI,M){var O=_,dI=gI,eI=M;return dI===void 0&&(dI=0),eI===void 0&&(eI=0),iI(this,n(O,dI,eI))},lI.prototype.scale=function(_,gI,M){var O=_,dI=gI,eI=M;return dI===void 0&&(dI=_),eI===void 0&&(eI=1),iI(this,r(O,dI,eI))},lI.prototype.rotate=function(_,gI,M){var O=_,dI=gI||0,eI=M||0;return typeof _=="number"&&gI===void 0&&M===void 0&&(eI=O,O=0,dI=0),iI(this,B(O,dI,eI))},lI.prototype.rotateAxisAngle=function(_,gI,M,O){if([_,gI,M,O].some(function(dI){return Number.isNaN(+dI)}))throw new TypeError("CSSMatrix: expecting 4 values");return iI(this,R(_,gI,M,O))},lI.prototype.skewX=function(_){return iI(this,II(_))},lI.prototype.skewY=function(_){return iI(this,k(_))},lI.prototype.skew=function(_,gI){return iI(this,H(_,gI))},lI.prototype.transformPoint=function(_){var gI=this,M=gI.m11*_.x+gI.m21*_.y+gI.m31*_.z+gI.m41*_.w,O=gI.m12*_.x+gI.m22*_.y+gI.m32*_.z+gI.m42*_.w,dI=gI.m13*_.x+gI.m23*_.y+gI.m33*_.z+gI.m43*_.w,eI=gI.m14*_.x+gI.m24*_.y+gI.m34*_.z+gI.m44*_.w;return _ instanceof DOMPoint?new DOMPoint(M,O,dI,eI):{x:M,y:O,z:dI,w:eI}},Object.defineProperties(lI.prototype,CI),Object.assign(lI,{Translate:n,Rotate:B,RotateAxisAngle:R,Scale:r,SkewX:II,SkewY:k,Skew:H,Multiply:iI,fromArray:l,fromMatrix:o,fromString:t,toArray:a});var sI="1.0.3",oI=sI;return Object.assign(lI,{Version:oI}),lI})}(dommatrix$1)),dommatrix$1.exports}var ponyfill$1={exports:{}};/**
 * @license
 * web-streams-polyfill v3.3.3
 * Copyright 2024 Mattias Buelens, Diwank Singh Tomer and other contributors.
 * This code is released under the MIT license.
 * SPDX-License-Identifier: MIT
 */var ponyfill=ponyfill$1.exports,hasRequiredPonyfill;function requirePonyfill(){return hasRequiredPonyfill||(hasRequiredPonyfill=1,function(e,A){(function(l,o){o(A)})(ponyfill,function(l){var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:function(G){return"Symbol(".concat(G,")")};function t(G,j){var ZI={label:0,sent:function(){if(zI[0]&1)throw zI[1];return zI[1]},trys:[],ops:[]},RI,SI,zI,_I;return _I={next:cg(0),throw:cg(1),return:cg(2)},typeof Symbol=="function"&&(_I[Symbol.iterator]=function(){return this}),_I;function cg(dg){return function(Bg){return ag([dg,Bg])}}function ag(dg){if(RI)throw new TypeError("Generator is already executing.");for(;_I&&(_I=0,dg[0]&&(ZI=0)),ZI;)try{if(RI=1,SI&&(zI=dg[0]&2?SI.return:dg[0]?SI.throw||((zI=SI.return)&&zI.call(SI),0):SI.next)&&!(zI=zI.call(SI,dg[1])).done)return zI;switch(SI=0,zI&&(dg=[dg[0]&2,zI.value]),dg[0]){case 0:case 1:zI=dg;break;case 4:return ZI.label++,{value:dg[1],done:!1};case 5:ZI.label++,SI=dg[1],dg=[0];continue;case 7:dg=ZI.ops.pop(),ZI.trys.pop();continue;default:if(zI=ZI.trys,!(zI=zI.length>0&&zI[zI.length-1])&&(dg[0]===6||dg[0]===2)){ZI=0;continue}if(dg[0]===3&&(!zI||dg[1]>zI[0]&&dg[1]<zI[3])){ZI.label=dg[1];break}if(dg[0]===6&&ZI.label<zI[1]){ZI.label=zI[1],zI=dg;break}if(zI&&ZI.label<zI[2]){ZI.label=zI[2],ZI.ops.push(dg);break}zI[2]&&ZI.ops.pop(),ZI.trys.pop();continue}dg=j.call(G,ZI)}catch(Bg){dg=[6,Bg],SI=0}finally{RI=zI=0}if(dg[0]&5)throw dg[1];return{value:dg[0]?dg[1]:void 0,done:!0}}}function a(G){var j=typeof Symbol=="function"&&Symbol.iterator,ZI=j&&G[j],RI=0;if(ZI)return ZI.call(G);if(G&&typeof G.length=="number")return{next:function(){return G&&RI>=G.length&&(G=void 0),{value:G&&G[RI++],done:!G}}};throw new TypeError(j?"Object is not iterable.":"Symbol.iterator is not defined.")}function n(G){return this instanceof n?(this.v=G,this):new n(G)}function B(G,j,ZI){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var RI=ZI.apply(G,j||[]),SI,zI=[];return SI={},_I("next"),_I("throw"),_I("return"),SI[Symbol.asyncIterator]=function(){return this},SI;function _I(Rg){RI[Rg]&&(SI[Rg]=function(xg){return new Promise(function(Og,Pg){zI.push([Rg,xg,Og,Pg])>1||cg(Rg,xg)})})}function cg(Rg,xg){try{ag(RI[Rg](xg))}catch(Og){Ng(zI[0][3],Og)}}function ag(Rg){Rg.value instanceof n?Promise.resolve(Rg.value.v).then(dg,Bg):Ng(zI[0][2],Rg)}function dg(Rg){cg("next",Rg)}function Bg(Rg){cg("throw",Rg)}function Ng(Rg,xg){Rg(xg),zI.shift(),zI.length&&cg(zI[0][0],zI[0][1])}}function R(G){var j,ZI;return j={},RI("next"),RI("throw",function(SI){throw SI}),RI("return"),j[Symbol.iterator]=function(){return this},j;function RI(SI,zI){j[SI]=G[SI]?function(_I){return(ZI=!ZI)?{value:n(G[SI](_I)),done:!1}:zI?zI(_I):_I}:zI}}function r(G){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var j=G[Symbol.asyncIterator],ZI;return j?j.call(G):(G=typeof a=="function"?a(G):G[Symbol.iterator](),ZI={},RI("next"),RI("throw"),RI("return"),ZI[Symbol.asyncIterator]=function(){return this},ZI);function RI(zI){ZI[zI]=G[zI]&&function(_I){return new Promise(function(cg,ag){_I=G[zI](_I),SI(cg,ag,_I.done,_I.value)})}}function SI(zI,_I,cg,ag){Promise.resolve(ag).then(function(dg){zI({value:dg,done:cg})},_I)}}typeof SuppressedError=="function"&&SuppressedError;function H(){}function II(G){return typeof G=="object"&&G!==null||typeof G=="function"}var k=H;function iI(G,j){try{Object.defineProperty(G,"name",{value:j,configurable:!0})}catch{}}var lI=Promise,CI=Promise.prototype.then,sI=Promise.reject.bind(lI);function oI(G){return new lI(G)}function E(G){return oI(function(j){return j(G)})}function _(G){return sI(G)}function gI(G,j,ZI){return CI.call(G,j,ZI)}function M(G,j,ZI){gI(gI(G,j,ZI),void 0,k)}function O(G,j){M(G,j)}function dI(G,j){M(G,void 0,j)}function eI(G,j,ZI){return gI(G,j,ZI)}function aI(G){gI(G,void 0,k)}var WI=function(G){if(typeof queueMicrotask=="function")WI=queueMicrotask;else{var j=E(void 0);WI=function(ZI){return gI(j,ZI)}}return WI(G)};function GI(G,j,ZI){if(typeof G!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(G,j,ZI)}function HI(G,j,ZI){try{return E(GI(G,j,ZI))}catch(RI){return _(RI)}}var MI=16384,KI=function(){function G(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}return Object.defineProperty(G.prototype,"length",{get:function(){return this._size},enumerable:!1,configurable:!0}),G.prototype.push=function(j){var ZI=this._back,RI=ZI;ZI._elements.length===MI-1&&(RI={_elements:[],_next:void 0}),ZI._elements.push(j),RI!==ZI&&(this._back=RI,ZI._next=RI),++this._size},G.prototype.shift=function(){var j=this._front,ZI=j,RI=this._cursor,SI=RI+1,zI=j._elements,_I=zI[RI];return SI===MI&&(ZI=j._next,SI=0),--this._size,this._cursor=SI,j!==ZI&&(this._front=ZI),zI[RI]=void 0,_I},G.prototype.forEach=function(j){for(var ZI=this._cursor,RI=this._front,SI=RI._elements;(ZI!==SI.length||RI._next!==void 0)&&!(ZI===SI.length&&(RI=RI._next,SI=RI._elements,ZI=0,SI.length===0));)j(SI[ZI]),++ZI},G.prototype.peek=function(){var j=this._front,ZI=this._cursor;return j._elements[ZI]},G}(),DI=o("[[AbortSteps]]"),NI=o("[[ErrorSteps]]"),yI=o("[[CancelSteps]]"),VI=o("[[PullSteps]]"),hI=o("[[ReleaseSteps]]");function wI(G,j){G._ownerReadableStream=j,j._reader=G,j._state==="readable"?XI(G):j._state==="closed"?mI(G):tI(G,j._storedError)}function pI(G,j){var ZI=G._ownerReadableStream;return $g(ZI,j)}function xI(G){var j=G._ownerReadableStream;j._state==="readable"?YI(G,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):BI(G,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),j._readableStreamController[hI](),j._reader=void 0,G._ownerReadableStream=void 0}function PI(G){return new TypeError("Cannot "+G+" a stream using a released reader")}function XI(G){G._closedPromise=oI(function(j,ZI){G._closedPromise_resolve=j,G._closedPromise_reject=ZI})}function tI(G,j){XI(G),YI(G,j)}function mI(G){XI(G),AI(G)}function YI(G,j){G._closedPromise_reject!==void 0&&(aI(G._closedPromise),G._closedPromise_reject(j),G._closedPromise_resolve=void 0,G._closedPromise_reject=void 0)}function BI(G,j){tI(G,j)}function AI(G){G._closedPromise_resolve!==void 0&&(G._closedPromise_resolve(void 0),G._closedPromise_resolve=void 0,G._closedPromise_reject=void 0)}var cI=Number.isFinite||function(G){return typeof G=="number"&&isFinite(G)},bI=Math.trunc||function(G){return G<0?Math.ceil(G):Math.floor(G)};function nI(G){return typeof G=="object"||typeof G=="function"}function uI(G,j){if(G!==void 0&&!nI(G))throw new TypeError("".concat(j," is not an object."))}function rI(G,j){if(typeof G!="function")throw new TypeError("".concat(j," is not a function."))}function FI(G){return typeof G=="object"&&G!==null||typeof G=="function"}function kI(G,j){if(!FI(G))throw new TypeError("".concat(j," is not an object."))}function TI(G,j,ZI){if(G===void 0)throw new TypeError("Parameter ".concat(j," is required in '").concat(ZI,"'."))}function QI(G,j,ZI){if(G===void 0)throw new TypeError("".concat(j," is required in '").concat(ZI,"'."))}function fI(G){return Number(G)}function OI(G){return G===0?0:G}function qI(G){return OI(bI(G))}function gg(G,j){var ZI=0,RI=Number.MAX_SAFE_INTEGER,SI=Number(G);if(SI=OI(SI),!cI(SI))throw new TypeError("".concat(j," is not a finite number"));if(SI=qI(SI),SI<ZI||SI>RI)throw new TypeError("".concat(j," is outside the accepted range of ").concat(ZI," to ").concat(RI,", inclusive"));return!cI(SI)||SI===0?0:SI}function lg(G,j){if(!ZC(G))throw new TypeError("".concat(j," is not a ReadableStream."))}function sg(G){return new mg(G)}function tg(G,j){G._reader._readRequests.push(j)}function ig(G,j,ZI){var RI=G._reader,SI=RI._readRequests.shift();ZI?SI._closeSteps():SI._chunkSteps(j)}function Xg(G){return G._reader._readRequests.length}function rg(G){var j=G._reader;return!(j===void 0||!eg(j))}var mg=function(){function G(j){if(TI(j,1,"ReadableStreamDefaultReader"),lg(j,"First parameter"),tC(j))throw new TypeError("This stream has already been locked for exclusive reading by another reader");wI(this,j),this._readRequests=new KI}return Object.defineProperty(G.prototype,"closed",{get:function(){return eg(this)?this._closedPromise:_(Kg("closed"))},enumerable:!1,configurable:!0}),G.prototype.cancel=function(j){return j===void 0&&(j=void 0),eg(this)?this._ownerReadableStream===void 0?_(PI("cancel")):pI(this,j):_(Kg("cancel"))},G.prototype.read=function(){if(!eg(this))return _(Kg("read"));if(this._ownerReadableStream===void 0)return _(PI("read from"));var j,ZI,RI=oI(function(zI,_I){j=zI,ZI=_I}),SI={_chunkSteps:function(zI){return j({value:zI,done:!1})},_closeSteps:function(){return j({value:void 0,done:!0})},_errorSteps:function(zI){return ZI(zI)}};return vI(this,SI),RI},G.prototype.releaseLock=function(){if(!eg(this))throw Kg("releaseLock");this._ownerReadableStream!==void 0&&Cg(this)},G}();Object.defineProperties(mg.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),iI(mg.prototype.cancel,"cancel"),iI(mg.prototype.read,"read"),iI(mg.prototype.releaseLock,"releaseLock"),typeof o.toStringTag=="symbol"&&Object.defineProperty(mg.prototype,o.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function eg(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_readRequests")?!1:G instanceof mg}function vI(G,j){var ZI=G._ownerReadableStream;ZI._disturbed=!0,ZI._state==="closed"?j._closeSteps():ZI._state==="errored"?j._errorSteps(ZI._storedError):ZI._readableStreamController[VI](j)}function Cg(G){xI(G);var j=new TypeError("Reader was released");Gg(G,j)}function Gg(G,j){var ZI=G._readRequests;G._readRequests=new KI,ZI.forEach(function(RI){RI._errorSteps(j)})}function Kg(G){return new TypeError("ReadableStreamDefaultReader.prototype.".concat(G," can only be used on a ReadableStreamDefaultReader"))}var Ig,og,wg;function UI(G){return G.slice()}function JI(G,j,ZI,RI,SI){new Uint8Array(G).set(new Uint8Array(ZI,RI,SI),j)}var LI=function(G){return typeof G.transfer=="function"?LI=function(j){return j.transfer()}:typeof structuredClone=="function"?LI=function(j){return structuredClone(j,{transfer:[j]})}:LI=function(j){return j},LI(G)},$I=function(G){return typeof G.detached=="boolean"?$I=function(j){return j.detached}:$I=function(j){return j.byteLength===0},$I(G)};function bg(G,j,ZI){if(G.slice)return G.slice(j,ZI);var RI=ZI-j,SI=new ArrayBuffer(RI);return JI(SI,0,G,j,RI),SI}function Wg(G,j){var ZI=G[j];if(ZI!=null){if(typeof ZI!="function")throw new TypeError("".concat(String(j)," is not a function"));return ZI}}function EI(G){var j,ZI=(j={},j[o.iterator]=function(){return G.iterator},j),RI=function(){return B(this,arguments,function(){return t(this,function(zI){switch(zI.label){case 0:return[5,a(R(r(ZI)))];case 1:return[4,n.apply(void 0,[zI.sent()])];case 2:return[4,n.apply(void 0,[zI.sent()])];case 3:return[2,zI.sent()]}})})}(),SI=RI.next;return{iterator:RI,nextMethod:SI,done:!1}}var jI=(wg=(Ig=o.asyncIterator)!==null&&Ig!==void 0?Ig:(og=o.for)===null||og===void 0?void 0:og.call(o,"Symbol.asyncIterator"))!==null&&wg!==void 0?wg:"@@asyncIterator";function Ag(G,j,ZI){if(j===void 0&&(j="sync"),ZI===void 0)if(j==="async"){if(ZI=Wg(G,jI),ZI===void 0){var RI=Wg(G,o.iterator),SI=Ag(G,"sync",RI);return EI(SI)}}else ZI=Wg(G,o.iterator);if(ZI===void 0)throw new TypeError("The object is not iterable");var zI=GI(ZI,G,[]);if(!II(zI))throw new TypeError("The iterator method must return an object");var _I=zI.next;return{iterator:zI,nextMethod:_I,done:!1}}function Zg(G){var j=GI(G.nextMethod,G.iterator,[]);if(!II(j))throw new TypeError("The iterator.next() method must return an object");return j}function hg(G){return!!G.done}function Vg(G){return G.value}var ug,yg=(ug={},ug[jI]=function(){return this},ug);Object.defineProperty(yg,jI,{enumerable:!1});var ng=function(){function G(j,ZI){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=j,this._preventCancel=ZI}return G.prototype.next=function(){var j=this,ZI=function(){return j._nextSteps()};return this._ongoingPromise=this._ongoingPromise?eI(this._ongoingPromise,ZI,ZI):ZI(),this._ongoingPromise},G.prototype.return=function(j){var ZI=this,RI=function(){return ZI._returnSteps(j)};return this._ongoingPromise?eI(this._ongoingPromise,RI,RI):RI()},G.prototype._nextSteps=function(){var j=this;if(this._isFinished)return Promise.resolve({value:void 0,done:!0});var ZI=this._reader,RI,SI,zI=oI(function(cg,ag){RI=cg,SI=ag}),_I={_chunkSteps:function(cg){j._ongoingPromise=void 0,WI(function(){return RI({value:cg,done:!1})})},_closeSteps:function(){j._ongoingPromise=void 0,j._isFinished=!0,xI(ZI),RI({value:void 0,done:!0})},_errorSteps:function(cg){j._ongoingPromise=void 0,j._isFinished=!0,xI(ZI),SI(cg)}};return vI(ZI,_I),zI},G.prototype._returnSteps=function(j){if(this._isFinished)return Promise.resolve({value:j,done:!0});this._isFinished=!0;var ZI=this._reader;if(!this._preventCancel){var RI=pI(ZI,j);return xI(ZI),eI(RI,function(){return{value:j,done:!0}})}return xI(ZI),E({value:j,done:!0})},G}(),Mg={next:function(){return pg(this)?this._asyncIteratorImpl.next():_(Hg("next"))},return:function(G){return pg(this)?this._asyncIteratorImpl.return(G):_(Hg("return"))}};Object.setPrototypeOf(Mg,yg);function zg(G,j){var ZI=sg(G),RI=new ng(ZI,j),SI=Object.create(Mg);return SI._asyncIteratorImpl=RI,SI}function pg(G){if(!II(G)||!Object.prototype.hasOwnProperty.call(G,"_asyncIteratorImpl"))return!1;try{return G._asyncIteratorImpl instanceof ng}catch{return!1}}function Hg(G){return new TypeError("ReadableStreamAsyncIterator.".concat(G," can only be used on a ReadableSteamAsyncIterator"))}var Lg=Number.isNaN||function(G){return G!==G};function Sg(G){return!(typeof G!="number"||Lg(G)||G<0)}function Tg(G){var j=bg(G.buffer,G.byteOffset,G.byteOffset+G.byteLength);return new Uint8Array(j)}function Fg(G){var j=G._queue.shift();return G._queueTotalSize-=j.size,G._queueTotalSize<0&&(G._queueTotalSize=0),j.value}function _g(G,j,ZI){if(!Sg(ZI)||ZI===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");G._queue.push({value:j,size:ZI}),G._queueTotalSize+=ZI}function dC(G){var j=G._queue.peek();return j.value}function fg(G){G._queue=new KI,G._queueTotalSize=0}function bC(G){return G===DataView}function VC(G){return bC(G.constructor)}function nC(G){return bC(G)?1:G.BYTES_PER_ELEMENT}var Qg=function(){function G(){throw new TypeError("Illegal constructor")}return Object.defineProperty(G.prototype,"view",{get:function(){if(!aA(this))throw wA("view");return this._view},enumerable:!1,configurable:!0}),G.prototype.respond=function(j){if(!aA(this))throw wA("respond");if(TI(j,1,"respond"),j=gg(j,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if($I(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");fC(this._associatedReadableByteStreamController,j)},G.prototype.respondWithNewView=function(j){if(!aA(this))throw wA("respondWithNewView");if(TI(j,1,"respondWithNewView"),!ArrayBuffer.isView(j))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if($I(j.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");QC(this._associatedReadableByteStreamController,j)},G}();Object.defineProperties(Qg.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),iI(Qg.prototype.respond,"respond"),iI(Qg.prototype.respondWithNewView,"respondWithNewView"),typeof o.toStringTag=="symbol"&&Object.defineProperty(Qg.prototype,o.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});var iC=function(){function G(){throw new TypeError("Illegal constructor")}return Object.defineProperty(G.prototype,"byobRequest",{get:function(){if(!GC(this))throw HC("byobRequest");return GA(this)},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"desiredSize",{get:function(){if(!GC(this))throw HC("desiredSize");return QA(this)},enumerable:!1,configurable:!0}),G.prototype.close=function(){if(!GC(this))throw HC("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var j=this._controlledReadableByteStream._state;if(j!=="readable")throw new TypeError("The stream (in ".concat(j," state) is not in the readable state and cannot be closed"));DC(this)},G.prototype.enqueue=function(j){if(!GC(this))throw HC("enqueue");if(TI(j,1,"enqueue"),!ArrayBuffer.isView(j))throw new TypeError("chunk must be an array buffer view");if(j.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(j.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");var ZI=this._controlledReadableByteStream._state;if(ZI!=="readable")throw new TypeError("The stream (in ".concat(ZI," state) is not in the readable state and cannot be enqueued to"));jC(this,j)},G.prototype.error=function(j){if(j===void 0&&(j=void 0),!GC(this))throw HC("error");Eg(this,j)},G.prototype[yI]=function(j){JA(this),fg(this);var ZI=this._cancelAlgorithm(j);return vC(this),ZI},G.prototype[VI]=function(j){var ZI=this._controlledReadableByteStream;if(this._queueTotalSize>0){fA(this,j);return}var RI=this._autoAllocateChunkSize;if(RI!==void 0){var SI=void 0;try{SI=new ArrayBuffer(RI)}catch(_I){j._errorSteps(_I);return}var zI={buffer:SI,bufferByteLength:RI,byteOffset:0,byteLength:RI,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(zI)}tg(ZI,j),wC(this)},G.prototype[hI]=function(){if(this._pendingPullIntos.length>0){var j=this._pendingPullIntos.peek();j.readerType="none",this._pendingPullIntos=new KI,this._pendingPullIntos.push(j)}},G}();Object.defineProperties(iC.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),iI(iC.prototype.close,"close"),iI(iC.prototype.enqueue,"enqueue"),iI(iC.prototype.error,"error"),typeof o.toStringTag=="symbol"&&Object.defineProperty(iC.prototype,o.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function GC(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_controlledReadableByteStream")?!1:G instanceof iC}function aA(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_associatedReadableByteStreamController")?!1:G instanceof Qg}function wC(G){var j=zi(G);if(j){if(G._pulling){G._pullAgain=!0;return}G._pulling=!0;var ZI=G._pullAlgorithm();M(ZI,function(){return G._pulling=!1,G._pullAgain&&(G._pullAgain=!1,wC(G)),null},function(RI){return Eg(G,RI),null})}}function JA(G){bA(G),G._pendingPullIntos=new KI}function mA(G,j){var ZI=!1;G._state==="closed"&&(ZI=!0);var RI=kA(j);j.readerType==="default"?ig(G,RI,ZI):fi(G,RI,ZI)}function kA(G){var j=G.bytesFilled,ZI=G.elementSize;return new G.viewConstructor(G.buffer,G.byteOffset,j/ZI)}function TC(G,j,ZI,RI){G._queue.push({buffer:j,byteOffset:ZI,byteLength:RI}),G._queueTotalSize+=RI}function zA(G,j,ZI,RI){var SI;try{SI=bg(j,ZI,ZI+RI)}catch(zI){throw Eg(G,zI),zI}TC(G,SI,0,RI)}function LA(G,j){j.bytesFilled>0&&zA(G,j.buffer,j.byteOffset,j.bytesFilled),yC(G)}function xA(G,j){var ZI=Math.min(G._queueTotalSize,j.byteLength-j.bytesFilled),RI=j.bytesFilled+ZI,SI=ZI,zI=!1,_I=RI%j.elementSize,cg=RI-_I;cg>=j.minimumFill&&(SI=cg-j.bytesFilled,zI=!0);for(var ag=G._queue;SI>0;){var dg=ag.peek(),Bg=Math.min(SI,dg.byteLength),Ng=j.byteOffset+j.bytesFilled;JI(j.buffer,Ng,dg.buffer,dg.byteOffset,Bg),dg.byteLength===Bg?ag.shift():(dg.byteOffset+=Bg,dg.byteLength-=Bg),G._queueTotalSize-=Bg,TA(G,Bg,j),SI-=Bg}return zI}function TA(G,j,ZI){ZI.bytesFilled+=j}function vA(G){G._queueTotalSize===0&&G._closeRequested?(vC(G),LC(G._controlledReadableByteStream)):wC(G)}function bA(G){G._byobRequest!==null&&(G._byobRequest._associatedReadableByteStreamController=void 0,G._byobRequest._view=null,G._byobRequest=null)}function nA(G){for(;G._pendingPullIntos.length>0;){if(G._queueTotalSize===0)return;var j=G._pendingPullIntos.peek();xA(G,j)&&(yC(G),mA(G._controlledReadableByteStream,j))}}function Si(G){for(var j=G._controlledReadableByteStream._reader;j._readRequests.length>0;){if(G._queueTotalSize===0)return;var ZI=j._readRequests.shift();fA(G,ZI)}}function Fi(G,j,ZI,RI){var SI=G._controlledReadableByteStream,zI=j.constructor,_I=nC(zI),cg=j.byteOffset,ag=j.byteLength,dg=ZI*_I,Bg;try{Bg=LI(j.buffer)}catch(Pg){RI._errorSteps(Pg);return}var Ng={buffer:Bg,bufferByteLength:Bg.byteLength,byteOffset:cg,byteLength:ag,bytesFilled:0,minimumFill:dg,elementSize:_I,viewConstructor:zI,readerType:"byob"};if(G._pendingPullIntos.length>0){G._pendingPullIntos.push(Ng),EA(SI,RI);return}if(SI._state==="closed"){var Rg=new zI(Ng.buffer,Ng.byteOffset,0);RI._closeSteps(Rg);return}if(G._queueTotalSize>0){if(xA(G,Ng)){var xg=kA(Ng);vA(G),RI._chunkSteps(xg);return}if(G._closeRequested){var Og=new TypeError("Insufficient bytes to fill elements in the given buffer");Eg(G,Og),RI._errorSteps(Og);return}}G._pendingPullIntos.push(Ng),EA(SI,RI),wC(G)}function Ji(G,j){j.readerType==="none"&&yC(G);var ZI=G._controlledReadableByteStream;if(WA(ZI))for(;PA(ZI)>0;){var RI=yC(G);mA(ZI,RI)}}function ki(G,j,ZI){if(TA(G,j,ZI),ZI.readerType==="none"){LA(G,ZI),nA(G);return}if(!(ZI.bytesFilled<ZI.minimumFill)){yC(G);var RI=ZI.bytesFilled%ZI.elementSize;if(RI>0){var SI=ZI.byteOffset+ZI.bytesFilled;zA(G,ZI.buffer,SI-RI,RI)}ZI.bytesFilled-=RI,mA(G._controlledReadableByteStream,ZI),nA(G)}}function jA(G,j){var ZI=G._pendingPullIntos.peek();bA(G);var RI=G._controlledReadableByteStream._state;RI==="closed"?Ji(G,ZI):ki(G,j,ZI),wC(G)}function yC(G){var j=G._pendingPullIntos.shift();return j}function zi(G){var j=G._controlledReadableByteStream;if(j._state!=="readable"||G._closeRequested||!G._started)return!1;if(rg(j)&&Xg(j)>0||WA(j)&&PA(j)>0)return!0;var ZI=QA(G);return ZI>0}function vC(G){G._pullAlgorithm=void 0,G._cancelAlgorithm=void 0}function DC(G){var j=G._controlledReadableByteStream;if(!(G._closeRequested||j._state!=="readable")){if(G._queueTotalSize>0){G._closeRequested=!0;return}if(G._pendingPullIntos.length>0){var ZI=G._pendingPullIntos.peek();if(ZI.bytesFilled%ZI.elementSize!==0){var RI=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Eg(G,RI),RI}}vC(G),LC(j)}}function jC(G,j){var ZI=G._controlledReadableByteStream;if(!(G._closeRequested||ZI._state!=="readable")){var RI=j.buffer,SI=j.byteOffset,zI=j.byteLength;if($I(RI))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");var _I=LI(RI);if(G._pendingPullIntos.length>0){var cg=G._pendingPullIntos.peek();if($I(cg.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");bA(G),cg.buffer=LI(cg.buffer),cg.readerType==="none"&&LA(G,cg)}if(rg(ZI))if(Si(G),Xg(ZI)===0)TC(G,_I,SI,zI);else{G._pendingPullIntos.length>0&&yC(G);var ag=new Uint8Array(_I,SI,zI);ig(ZI,ag,!1)}else WA(ZI)?(TC(G,_I,SI,zI),nA(G)):TC(G,_I,SI,zI);wC(G)}}function Eg(G,j){var ZI=G._controlledReadableByteStream;ZI._state==="readable"&&(JA(G),fg(G),vC(G),hi(ZI,j))}function fA(G,j){var ZI=G._queue.shift();G._queueTotalSize-=ZI.byteLength,vA(G);var RI=new Uint8Array(ZI.buffer,ZI.byteOffset,ZI.byteLength);j._chunkSteps(RI)}function GA(G){if(G._byobRequest===null&&G._pendingPullIntos.length>0){var j=G._pendingPullIntos.peek(),ZI=new Uint8Array(j.buffer,j.byteOffset+j.bytesFilled,j.byteLength-j.bytesFilled),RI=Object.create(Qg.prototype);xi(RI,G,ZI),G._byobRequest=RI}return G._byobRequest}function QA(G){var j=G._controlledReadableByteStream._state;return j==="errored"?null:j==="closed"?0:G._strategyHWM-G._queueTotalSize}function fC(G,j){var ZI=G._pendingPullIntos.peek(),RI=G._controlledReadableByteStream._state;if(RI==="closed"){if(j!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(j===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(ZI.bytesFilled+j>ZI.byteLength)throw new RangeError("bytesWritten out of range")}ZI.buffer=LI(ZI.buffer),jA(G,j)}function QC(G,j){var ZI=G._pendingPullIntos.peek(),RI=G._controlledReadableByteStream._state;if(RI==="closed"){if(j.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(j.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(ZI.byteOffset+ZI.bytesFilled!==j.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(ZI.bufferByteLength!==j.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(ZI.bytesFilled+j.byteLength>ZI.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");var SI=j.byteLength;ZI.buffer=LI(j.buffer),jA(G,SI)}function OA(G,j,ZI,RI,SI,zI,_I){j._controlledReadableByteStream=G,j._pullAgain=!1,j._pulling=!1,j._byobRequest=null,j._queue=j._queueTotalSize=void 0,fg(j),j._closeRequested=!1,j._started=!1,j._strategyHWM=zI,j._pullAlgorithm=RI,j._cancelAlgorithm=SI,j._autoAllocateChunkSize=_I,j._pendingPullIntos=new KI,G._readableStreamController=j;var cg=ZI();M(E(cg),function(){return j._started=!0,wC(j),null},function(ag){return Eg(j,ag),null})}function Li(G,j,ZI){var RI=Object.create(iC.prototype),SI,zI,_I;j.start!==void 0?SI=function(){return j.start(RI)}:SI=function(){},j.pull!==void 0?zI=function(){return j.pull(RI)}:zI=function(){return E(void 0)},j.cancel!==void 0?_I=function(ag){return j.cancel(ag)}:_I=function(){return E(void 0)};var cg=j.autoAllocateChunkSize;if(cg===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");OA(G,RI,SI,zI,_I,ZI,cg)}function xi(G,j,ZI){G._associatedReadableByteStreamController=j,G._view=ZI}function wA(G){return new TypeError("ReadableStreamBYOBRequest.prototype.".concat(G," can only be used on a ReadableStreamBYOBRequest"))}function HC(G){return new TypeError("ReadableByteStreamController.prototype.".concat(G," can only be used on a ReadableByteStreamController"))}function Ti(G,j){uI(G,j);var ZI=G?.mode;return{mode:ZI===void 0?void 0:vi(ZI,"".concat(j," has member 'mode' that"))}}function vi(G,j){if(G="".concat(G),G!=="byob")throw new TypeError("".concat(j," '").concat(G,"' is not a valid enumeration value for ReadableStreamReaderMode"));return G}function ji(G,j){var ZI;uI(G,j);var RI=(ZI=G?.min)!==null&&ZI!==void 0?ZI:1;return{min:gg(RI,"".concat(j," has member 'min' that"))}}function UA(G){return new cC(G)}function EA(G,j){G._reader._readIntoRequests.push(j)}function fi(G,j,ZI){var RI=G._reader,SI=RI._readIntoRequests.shift();ZI?SI._closeSteps(j):SI._chunkSteps(j)}function PA(G){return G._reader._readIntoRequests.length}function WA(G){var j=G._reader;return!(j===void 0||!WC(j))}var cC=function(){function G(j){if(TI(j,1,"ReadableStreamBYOBReader"),lg(j,"First parameter"),tC(j))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!GC(j._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");wI(this,j),this._readIntoRequests=new KI}return Object.defineProperty(G.prototype,"closed",{get:function(){return WC(this)?this._closedPromise:_(OC("closed"))},enumerable:!1,configurable:!0}),G.prototype.cancel=function(j){return j===void 0&&(j=void 0),WC(this)?this._ownerReadableStream===void 0?_(PI("cancel")):pI(this,j):_(OC("cancel"))},G.prototype.read=function(j,ZI){if(ZI===void 0&&(ZI={}),!WC(this))return _(OC("read"));if(!ArrayBuffer.isView(j))return _(new TypeError("view must be an array buffer view"));if(j.byteLength===0)return _(new TypeError("view must have non-zero byteLength"));if(j.buffer.byteLength===0)return _(new TypeError("view's buffer must have non-zero byteLength"));if($I(j.buffer))return _(new TypeError("view's buffer has been detached"));var RI;try{RI=ji(ZI,"options")}catch(dg){return _(dg)}var SI=RI.min;if(SI===0)return _(new TypeError("options.min must be greater than 0"));if(VC(j)){if(SI>j.byteLength)return _(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(SI>j.length)return _(new RangeError("options.min must be less than or equal to view's length"));if(this._ownerReadableStream===void 0)return _(PI("read from"));var zI,_I,cg=oI(function(dg,Bg){zI=dg,_I=Bg}),ag={_chunkSteps:function(dg){return zI({value:dg,done:!1})},_closeSteps:function(dg){return zI({value:dg,done:!0})},_errorSteps:function(dg){return _I(dg)}};return _A(this,j,SI,ag),cg},G.prototype.releaseLock=function(){if(!WC(this))throw OC("releaseLock");this._ownerReadableStream!==void 0&&Qi(this)},G}();Object.defineProperties(cC.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),iI(cC.prototype.cancel,"cancel"),iI(cC.prototype.read,"read"),iI(cC.prototype.releaseLock,"releaseLock"),typeof o.toStringTag=="symbol"&&Object.defineProperty(cC.prototype,o.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function WC(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_readIntoRequests")?!1:G instanceof cC}function _A(G,j,ZI,RI){var SI=G._ownerReadableStream;SI._disturbed=!0,SI._state==="errored"?RI._errorSteps(SI._storedError):Fi(SI._readableStreamController,j,ZI,RI)}function Qi(G){xI(G);var j=new TypeError("Reader was released");qA(G,j)}function qA(G,j){var ZI=G._readIntoRequests;G._readIntoRequests=new KI,ZI.forEach(function(RI){RI._errorSteps(j)})}function OC(G){return new TypeError("ReadableStreamBYOBReader.prototype.".concat(G," can only be used on a ReadableStreamBYOBReader"))}function SC(G,j){var ZI=G.highWaterMark;if(ZI===void 0)return j;if(Lg(ZI)||ZI<0)throw new RangeError("Invalid highWaterMark");return ZI}function UC(G){var j=G.size;return j||function(){return 1}}function EC(G,j){uI(G,j);var ZI=G?.highWaterMark,RI=G?.size;return{highWaterMark:ZI===void 0?void 0:fI(ZI),size:RI===void 0?void 0:Oi(RI,"".concat(j," has member 'size' that"))}}function Oi(G,j){return rI(G,j),function(ZI){return fI(G(ZI))}}function Ui(G,j){uI(G,j);var ZI=G?.abort,RI=G?.close,SI=G?.start,zI=G?.type,_I=G?.write;return{abort:ZI===void 0?void 0:Ei(ZI,G,"".concat(j," has member 'abort' that")),close:RI===void 0?void 0:Pi(RI,G,"".concat(j," has member 'close' that")),start:SI===void 0?void 0:_i(SI,G,"".concat(j," has member 'start' that")),write:_I===void 0?void 0:qi(_I,G,"".concat(j," has member 'write' that")),type:zI}}function Ei(G,j,ZI){return rI(G,ZI),function(RI){return HI(G,j,[RI])}}function Pi(G,j,ZI){return rI(G,ZI),function(){return HI(G,j,[])}}function _i(G,j,ZI){return rI(G,ZI),function(RI){return GI(G,j,[RI])}}function qi(G,j,ZI){return rI(G,ZI),function(RI,SI){return HI(G,j,[RI,SI])}}function $A(G,j){if(!NC(G))throw new TypeError("".concat(j," is not a WritableStream."))}function $i(G){if(typeof G!="object"||G===null)return!1;try{return typeof G.aborted=="boolean"}catch{return!1}}var Il=typeof AbortController=="function";function gl(){if(Il)return new AbortController}var oC=function(){function G(j,ZI){j===void 0&&(j={}),ZI===void 0&&(ZI={}),j===void 0?j=null:kI(j,"First parameter");var RI=EC(ZI,"Second parameter"),SI=Ui(j,"First parameter");gi(this);var zI=SI.type;if(zI!==void 0)throw new RangeError("Invalid type is specified");var _I=UC(RI),cg=SC(RI,1);bl(this,SI,cg,_I)}return Object.defineProperty(G.prototype,"locked",{get:function(){if(!NC(this))throw IA("locked");return XC(this)},enumerable:!1,configurable:!0}),G.prototype.abort=function(j){return j===void 0&&(j=void 0),NC(this)?XC(this)?_(new TypeError("Cannot abort a stream that already has a writer")):PC(this,j):_(IA("abort"))},G.prototype.close=function(){return NC(this)?XC(this)?_(new TypeError("Cannot close a stream that already has a writer")):IC(this)?_(new TypeError("Cannot close an already-closing stream")):Ci(this):_(IA("close"))},G.prototype.getWriter=function(){if(!NC(this))throw IA("getWriter");return Ii(this)},G}();Object.defineProperties(oC.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),iI(oC.prototype.abort,"abort"),iI(oC.prototype.close,"close"),iI(oC.prototype.getWriter,"getWriter"),typeof o.toStringTag=="symbol"&&Object.defineProperty(oC.prototype,o.toStringTag,{value:"WritableStream",configurable:!0});function Ii(G){return new lC(G)}function Cl(G,j,ZI,RI,SI,zI){SI===void 0&&(SI=1),zI===void 0&&(zI=function(){return 1});var _I=Object.create(oC.prototype);gi(_I);var cg=Object.create(RC.prototype);return di(_I,cg,G,j,ZI,RI,SI,zI),_I}function gi(G){G._state="writable",G._storedError=void 0,G._writer=void 0,G._writableStreamController=void 0,G._writeRequests=new KI,G._inFlightWriteRequest=void 0,G._closeRequest=void 0,G._inFlightCloseRequest=void 0,G._pendingAbortRequest=void 0,G._backpressure=!1}function NC(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_writableStreamController")?!1:G instanceof oC}function XC(G){return G._writer!==void 0}function PC(G,j){var ZI;if(G._state==="closed"||G._state==="errored")return E(void 0);G._writableStreamController._abortReason=j,(ZI=G._writableStreamController._abortController)===null||ZI===void 0||ZI.abort(j);var RI=G._state;if(RI==="closed"||RI==="errored")return E(void 0);if(G._pendingAbortRequest!==void 0)return G._pendingAbortRequest._promise;var SI=!1;RI==="erroring"&&(SI=!0,j=void 0);var zI=oI(function(_I,cg){G._pendingAbortRequest={_promise:void 0,_resolve:_I,_reject:cg,_reason:j,_wasAlreadyErroring:SI}});return G._pendingAbortRequest._promise=zI,SI||BA(G,j),zI}function Ci(G){var j=G._state;if(j==="closed"||j==="errored")return _(new TypeError("The stream (in ".concat(j," state) is not in the writable state and cannot be closed")));var ZI=oI(function(SI,zI){var _I={_resolve:SI,_reject:zI};G._closeRequest=_I}),RI=G._writer;return RI!==void 0&&G._backpressure&&j==="writable"&&rA(RI),nl(G._writableStreamController),ZI}function Al(G){var j=oI(function(ZI,RI){var SI={_resolve:ZI,_reject:RI};G._writeRequests.push(SI)});return j}function hA(G,j){var ZI=G._state;if(ZI==="writable"){BA(G,j);return}uA(G)}function BA(G,j){var ZI=G._writableStreamController;G._state="erroring",G._storedError=j;var RI=G._writer;RI!==void 0&&ii(RI,j),!dl(G)&&ZI._started&&uA(G)}function uA(G){G._state="errored",G._writableStreamController[NI]();var j=G._storedError;if(G._writeRequests.forEach(function(SI){SI._reject(j)}),G._writeRequests=new KI,G._pendingAbortRequest===void 0){_C(G);return}var ZI=G._pendingAbortRequest;if(G._pendingAbortRequest=void 0,ZI._wasAlreadyErroring){ZI._reject(j),_C(G);return}var RI=G._writableStreamController[DI](ZI._reason);M(RI,function(){return ZI._resolve(),_C(G),null},function(SI){return ZI._reject(SI),_C(G),null})}function il(G){G._inFlightWriteRequest._resolve(void 0),G._inFlightWriteRequest=void 0}function ll(G,j){G._inFlightWriteRequest._reject(j),G._inFlightWriteRequest=void 0,hA(G,j)}function sl(G){G._inFlightCloseRequest._resolve(void 0),G._inFlightCloseRequest=void 0;var j=G._state;j==="erroring"&&(G._storedError=void 0,G._pendingAbortRequest!==void 0&&(G._pendingAbortRequest._resolve(),G._pendingAbortRequest=void 0)),G._state="closed";var ZI=G._writer;ZI!==void 0&&ti(ZI)}function el(G,j){G._inFlightCloseRequest._reject(j),G._inFlightCloseRequest=void 0,G._pendingAbortRequest!==void 0&&(G._pendingAbortRequest._reject(j),G._pendingAbortRequest=void 0),hA(G,j)}function IC(G){return!(G._closeRequest===void 0&&G._inFlightCloseRequest===void 0)}function dl(G){return!(G._inFlightWriteRequest===void 0&&G._inFlightCloseRequest===void 0)}function cl(G){G._inFlightCloseRequest=G._closeRequest,G._closeRequest=void 0}function ol(G){G._inFlightWriteRequest=G._writeRequests.shift()}function _C(G){G._closeRequest!==void 0&&(G._closeRequest._reject(G._storedError),G._closeRequest=void 0);var j=G._writer;j!==void 0&&XA(j,G._storedError)}function YA(G,j){var ZI=G._writer;ZI!==void 0&&j!==G._backpressure&&(j?Yl(ZI):rA(ZI)),G._backpressure=j}var lC=function(){function G(j){if(TI(j,1,"WritableStreamDefaultWriter"),$A(j,"First parameter"),XC(j))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=j,j._writer=this;var ZI=j._state;if(ZI==="writable")!IC(j)&&j._backpressure?CA(this):ai(this),gA(this);else if(ZI==="erroring")RA(this,j._storedError),gA(this);else if(ZI==="closed")ai(this),Bl(this);else{var RI=j._storedError;RA(this,RI),Zi(this,RI)}}return Object.defineProperty(G.prototype,"closed",{get:function(){return hC(this)?this._closedPromise:_(BC("closed"))},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"desiredSize",{get:function(){if(!hC(this))throw BC("desiredSize");if(this._ownerWritableStream===void 0)throw JC("desiredSize");return ml(this)},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"ready",{get:function(){return hC(this)?this._readyPromise:_(BC("ready"))},enumerable:!1,configurable:!0}),G.prototype.abort=function(j){return j===void 0&&(j=void 0),hC(this)?this._ownerWritableStream===void 0?_(JC("abort")):Zl(this,j):_(BC("abort"))},G.prototype.close=function(){if(!hC(this))return _(BC("close"));var j=this._ownerWritableStream;return j===void 0?_(JC("close")):IC(j)?_(new TypeError("Cannot close an already-closing stream")):Ai(this)},G.prototype.releaseLock=function(){if(!hC(this))throw BC("releaseLock");var j=this._ownerWritableStream;j!==void 0&&li(this)},G.prototype.write=function(j){return j===void 0&&(j=void 0),hC(this)?this._ownerWritableStream===void 0?_(JC("write to")):si(this,j):_(BC("write"))},G}();Object.defineProperties(lC.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),iI(lC.prototype.abort,"abort"),iI(lC.prototype.close,"close"),iI(lC.prototype.releaseLock,"releaseLock"),iI(lC.prototype.write,"write"),typeof o.toStringTag=="symbol"&&Object.defineProperty(lC.prototype,o.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function hC(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_ownerWritableStream")?!1:G instanceof lC}function Zl(G,j){var ZI=G._ownerWritableStream;return PC(ZI,j)}function Ai(G){var j=G._ownerWritableStream;return Ci(j)}function tl(G){var j=G._ownerWritableStream,ZI=j._state;return IC(j)||ZI==="closed"?E(void 0):ZI==="errored"?_(j._storedError):Ai(G)}function al(G,j){G._closedPromiseState==="pending"?XA(G,j):ul(G,j)}function ii(G,j){G._readyPromiseState==="pending"?mi(G,j):Vl(G,j)}function ml(G){var j=G._ownerWritableStream,ZI=j._state;return ZI==="errored"||ZI==="erroring"?null:ZI==="closed"?0:ci(j._writableStreamController)}function li(G){var j=G._ownerWritableStream,ZI=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");ii(G,ZI),al(G,ZI),j._writer=void 0,G._ownerWritableStream=void 0}function si(G,j){var ZI=G._ownerWritableStream,RI=ZI._writableStreamController,SI=Gl(RI,j);if(ZI!==G._ownerWritableStream)return _(JC("write to"));var zI=ZI._state;if(zI==="errored")return _(ZI._storedError);if(IC(ZI)||zI==="closed")return _(new TypeError("The stream is closing or closed and cannot be written to"));if(zI==="erroring")return _(ZI._storedError);var _I=Al(ZI);return wl(RI,j,SI),_I}var ei={},RC=function(){function G(){throw new TypeError("Illegal constructor")}return Object.defineProperty(G.prototype,"abortReason",{get:function(){if(!VA(this))throw NA("abortReason");return this._abortReason},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"signal",{get:function(){if(!VA(this))throw NA("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal},enumerable:!1,configurable:!0}),G.prototype.error=function(j){if(j===void 0&&(j=void 0),!VA(this))throw NA("error");var ZI=this._controlledWritableStream._state;ZI==="writable"&&oi(this,j)},G.prototype[DI]=function(j){var ZI=this._abortAlgorithm(j);return qC(this),ZI},G.prototype[NI]=function(){fg(this)},G}();Object.defineProperties(RC.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(RC.prototype,o.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function VA(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_controlledWritableStream")?!1:G instanceof RC}function di(G,j,ZI,RI,SI,zI,_I,cg){j._controlledWritableStream=G,G._writableStreamController=j,j._queue=void 0,j._queueTotalSize=void 0,fg(j),j._abortReason=void 0,j._abortController=gl(),j._started=!1,j._strategySizeAlgorithm=cg,j._strategyHWM=_I,j._writeAlgorithm=RI,j._closeAlgorithm=SI,j._abortAlgorithm=zI;var ag=yA(j);YA(G,ag);var dg=ZI(),Bg=E(dg);M(Bg,function(){return j._started=!0,$C(j),null},function(Ng){return j._started=!0,hA(G,Ng),null})}function bl(G,j,ZI,RI){var SI=Object.create(RC.prototype),zI,_I,cg,ag;j.start!==void 0?zI=function(){return j.start(SI)}:zI=function(){},j.write!==void 0?_I=function(dg){return j.write(dg,SI)}:_I=function(){return E(void 0)},j.close!==void 0?cg=function(){return j.close()}:cg=function(){return E(void 0)},j.abort!==void 0?ag=function(dg){return j.abort(dg)}:ag=function(){return E(void 0)},di(G,SI,zI,_I,cg,ag,ZI,RI)}function qC(G){G._writeAlgorithm=void 0,G._closeAlgorithm=void 0,G._abortAlgorithm=void 0,G._strategySizeAlgorithm=void 0}function nl(G){_g(G,ei,0),$C(G)}function Gl(G,j){try{return G._strategySizeAlgorithm(j)}catch(ZI){return FC(G,ZI),1}}function ci(G){return G._strategyHWM-G._queueTotalSize}function wl(G,j,ZI){try{_g(G,j,ZI)}catch(zI){FC(G,zI);return}var RI=G._controlledWritableStream;if(!IC(RI)&&RI._state==="writable"){var SI=yA(G);YA(RI,SI)}$C(G)}function $C(G){var j=G._controlledWritableStream;if(G._started&&j._inFlightWriteRequest===void 0){var ZI=j._state;if(ZI==="erroring"){uA(j);return}if(G._queue.length!==0){var RI=dC(G);RI===ei?Wl(G):hl(G,RI)}}}function FC(G,j){G._controlledWritableStream._state==="writable"&&oi(G,j)}function Wl(G){var j=G._controlledWritableStream;cl(j),Fg(G);var ZI=G._closeAlgorithm();qC(G),M(ZI,function(){return sl(j),null},function(RI){return el(j,RI),null})}function hl(G,j){var ZI=G._controlledWritableStream;ol(ZI);var RI=G._writeAlgorithm(j);M(RI,function(){il(ZI);var SI=ZI._state;if(Fg(G),!IC(ZI)&&SI==="writable"){var zI=yA(G);YA(ZI,zI)}return $C(G),null},function(SI){return ZI._state==="writable"&&qC(G),ll(ZI,SI),null})}function yA(G){var j=ci(G);return j<=0}function oi(G,j){var ZI=G._controlledWritableStream;qC(G),BA(ZI,j)}function IA(G){return new TypeError("WritableStream.prototype.".concat(G," can only be used on a WritableStream"))}function NA(G){return new TypeError("WritableStreamDefaultController.prototype.".concat(G," can only be used on a WritableStreamDefaultController"))}function BC(G){return new TypeError("WritableStreamDefaultWriter.prototype.".concat(G," can only be used on a WritableStreamDefaultWriter"))}function JC(G){return new TypeError("Cannot "+G+" a stream using a released writer")}function gA(G){G._closedPromise=oI(function(j,ZI){G._closedPromise_resolve=j,G._closedPromise_reject=ZI,G._closedPromiseState="pending"})}function Zi(G,j){gA(G),XA(G,j)}function Bl(G){gA(G),ti(G)}function XA(G,j){G._closedPromise_reject!==void 0&&(aI(G._closedPromise),G._closedPromise_reject(j),G._closedPromise_resolve=void 0,G._closedPromise_reject=void 0,G._closedPromiseState="rejected")}function ul(G,j){Zi(G,j)}function ti(G){G._closedPromise_resolve!==void 0&&(G._closedPromise_resolve(void 0),G._closedPromise_resolve=void 0,G._closedPromise_reject=void 0,G._closedPromiseState="resolved")}function CA(G){G._readyPromise=oI(function(j,ZI){G._readyPromise_resolve=j,G._readyPromise_reject=ZI}),G._readyPromiseState="pending"}function RA(G,j){CA(G),mi(G,j)}function ai(G){CA(G),rA(G)}function mi(G,j){G._readyPromise_reject!==void 0&&(aI(G._readyPromise),G._readyPromise_reject(j),G._readyPromise_resolve=void 0,G._readyPromise_reject=void 0,G._readyPromiseState="rejected")}function Yl(G){CA(G)}function Vl(G,j){RA(G,j)}function rA(G){G._readyPromise_resolve!==void 0&&(G._readyPromise_resolve(void 0),G._readyPromise_resolve=void 0,G._readyPromise_reject=void 0,G._readyPromiseState="fulfilled")}function yl(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof commonjsGlobal<"u")return commonjsGlobal}var pA=yl();function Nl(G){if(!(typeof G=="function"||typeof G=="object")||G.name!=="DOMException")return!1;try{return new G,!0}catch{return!1}}function Xl(){var G=pA?.DOMException;return Nl(G)?G:void 0}function Rl(){var G=function(ZI,RI){this.message=ZI||"",this.name=RI||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return iI(G,"DOMException"),G.prototype=Object.create(Error.prototype),Object.defineProperty(G.prototype,"constructor",{value:G,writable:!0,configurable:!0}),G}var rl=Xl()||Rl();function bi(G,j,ZI,RI,SI,zI){var _I=sg(G),cg=Ii(j);G._disturbed=!0;var ag=!1,dg=E(void 0);return oI(function(Bg,Ng){var Rg;if(zI!==void 0){if(Rg=function(){var Yg=zI.reason!==void 0?zI.reason:new rl("Aborted","AbortError"),Dg=[];RI||Dg.push(function(){return j._state==="writable"?PC(j,Yg):E(void 0)}),SI||Dg.push(function(){return G._state==="readable"?$g(G,Yg):E(void 0)}),Ug(function(){return Promise.all(Dg.map(function(kg){return kg()}))},!0,Yg)},zI.aborted){Rg();return}zI.addEventListener("abort",Rg)}function xg(){return oI(function(Yg,Dg){function kg(AC){AC?Yg():gI(Og(),kg,Dg)}kg(!1)})}function Og(){return ag?E(!0):gI(cg._readyPromise,function(){return oI(function(Yg,Dg){vI(_I,{_chunkSteps:function(kg){dg=gI(si(cg,kg),void 0,H),Yg(!1)},_closeSteps:function(){return Yg(!0)},_errorSteps:Dg})})})}if(vg(G,_I._closedPromise,function(Yg){return RI?eC(!0,Yg):Ug(function(){return PC(j,Yg)},!0,Yg),null}),vg(j,cg._closedPromise,function(Yg){return SI?eC(!0,Yg):Ug(function(){return $g(G,Yg)},!0,Yg),null}),CC(G,_I._closedPromise,function(){return ZI?eC():Ug(function(){return tl(cg)}),null}),IC(j)||j._state==="closed"){var Pg=new TypeError("the destination writable stream closed before all data could be piped to it");SI?eC(!0,Pg):Ug(function(){return $g(G,Pg)},!0,Pg)}aI(xg());function gC(){var Yg=dg;return gI(dg,function(){return Yg!==dg?gC():void 0})}function vg(Yg,Dg,kg){Yg._state==="errored"?kg(Yg._storedError):dI(Dg,kg)}function CC(Yg,Dg,kg){Yg._state==="closed"?kg():O(Dg,kg)}function Ug(Yg,Dg,kg){if(ag)return;ag=!0,j._state==="writable"&&!IC(j)?O(gC(),AC):AC();function AC(){return M(Yg(),function(){return Jg(Dg,kg)},function(mC){return Jg(!0,mC)}),null}}function eC(Yg,Dg){ag||(ag=!0,j._state==="writable"&&!IC(j)?O(gC(),function(){return Jg(Yg,Dg)}):Jg(Yg,Dg))}function Jg(Yg,Dg){return li(cg),xI(_I),zI!==void 0&&zI.removeEventListener("abort",Rg),Yg?Ng(Dg):Bg(void 0),null}})}var sC=function(){function G(){throw new TypeError("Illegal constructor")}return Object.defineProperty(G.prototype,"desiredSize",{get:function(){if(!AA(this))throw lA("desiredSize");return MA(this)},enumerable:!1,configurable:!0}),G.prototype.close=function(){if(!AA(this))throw lA("close");if(!pC(this))throw new TypeError("The stream is not in a state that permits close");uC(this)},G.prototype.enqueue=function(j){if(j===void 0&&(j=void 0),!AA(this))throw lA("enqueue");if(!pC(this))throw new TypeError("The stream is not in a state that permits enqueue");return rC(this,j)},G.prototype.error=function(j){if(j===void 0&&(j=void 0),!AA(this))throw lA("error");qg(this,j)},G.prototype[yI]=function(j){fg(this);var ZI=this._cancelAlgorithm(j);return iA(this),ZI},G.prototype[VI]=function(j){var ZI=this._controlledReadableStream;if(this._queue.length>0){var RI=Fg(this);this._closeRequested&&this._queue.length===0?(iA(this),LC(ZI)):kC(this),j._chunkSteps(RI)}else tg(ZI,j),kC(this)},G.prototype[hI]=function(){},G}();Object.defineProperties(sC.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),iI(sC.prototype.close,"close"),iI(sC.prototype.enqueue,"enqueue"),iI(sC.prototype.error,"error"),typeof o.toStringTag=="symbol"&&Object.defineProperty(sC.prototype,o.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function AA(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_controlledReadableStream")?!1:G instanceof sC}function kC(G){var j=ni(G);if(j){if(G._pulling){G._pullAgain=!0;return}G._pulling=!0;var ZI=G._pullAlgorithm();M(ZI,function(){return G._pulling=!1,G._pullAgain&&(G._pullAgain=!1,kC(G)),null},function(RI){return qg(G,RI),null})}}function ni(G){var j=G._controlledReadableStream;if(!pC(G)||!G._started)return!1;if(tC(j)&&Xg(j)>0)return!0;var ZI=MA(G);return ZI>0}function iA(G){G._pullAlgorithm=void 0,G._cancelAlgorithm=void 0,G._strategySizeAlgorithm=void 0}function uC(G){if(pC(G)){var j=G._controlledReadableStream;G._closeRequested=!0,G._queue.length===0&&(iA(G),LC(j))}}function rC(G,j){if(pC(G)){var ZI=G._controlledReadableStream;if(tC(ZI)&&Xg(ZI)>0)ig(ZI,j,!1);else{var RI=void 0;try{RI=G._strategySizeAlgorithm(j)}catch(SI){throw qg(G,SI),SI}try{_g(G,j,RI)}catch(SI){throw qg(G,SI),SI}}kC(G)}}function qg(G,j){var ZI=G._controlledReadableStream;ZI._state==="readable"&&(fg(G),iA(G),hi(ZI,j))}function MA(G){var j=G._controlledReadableStream._state;return j==="errored"?null:j==="closed"?0:G._strategyHWM-G._queueTotalSize}function pl(G){return!ni(G)}function pC(G){var j=G._controlledReadableStream._state;return!G._closeRequested&&j==="readable"}function Gi(G,j,ZI,RI,SI,zI,_I){j._controlledReadableStream=G,j._queue=void 0,j._queueTotalSize=void 0,fg(j),j._started=!1,j._closeRequested=!1,j._pullAgain=!1,j._pulling=!1,j._strategySizeAlgorithm=_I,j._strategyHWM=zI,j._pullAlgorithm=RI,j._cancelAlgorithm=SI,G._readableStreamController=j;var cg=ZI();M(E(cg),function(){return j._started=!0,kC(j),null},function(ag){return qg(j,ag),null})}function Ml(G,j,ZI,RI){var SI=Object.create(sC.prototype),zI,_I,cg;j.start!==void 0?zI=function(){return j.start(SI)}:zI=function(){},j.pull!==void 0?_I=function(){return j.pull(SI)}:_I=function(){return E(void 0)},j.cancel!==void 0?cg=function(ag){return j.cancel(ag)}:cg=function(){return E(void 0)},Gi(G,SI,zI,_I,cg,ZI,RI)}function lA(G){return new TypeError("ReadableStreamDefaultController.prototype.".concat(G," can only be used on a ReadableStreamDefaultController"))}function Kl(G,j){return GC(G._readableStreamController)?Hl(G):Dl(G)}function Dl(G,j){var ZI=sg(G),RI=!1,SI=!1,zI=!1,_I=!1,cg,ag,dg,Bg,Ng,Rg=oI(function(vg){Ng=vg});function xg(){if(RI)return SI=!0,E(void 0);RI=!0;var vg={_chunkSteps:function(CC){WI(function(){SI=!1;var Ug=CC,eC=CC;zI||rC(dg._readableStreamController,Ug),_I||rC(Bg._readableStreamController,eC),RI=!1,SI&&xg()})},_closeSteps:function(){RI=!1,zI||uC(dg._readableStreamController),_I||uC(Bg._readableStreamController),(!zI||!_I)&&Ng(void 0)},_errorSteps:function(){RI=!1}};return vI(ZI,vg),E(void 0)}function Og(vg){if(zI=!0,cg=vg,_I){var CC=UI([cg,ag]),Ug=$g(G,CC);Ng(Ug)}return Rg}function Pg(vg){if(_I=!0,ag=vg,zI){var CC=UI([cg,ag]),Ug=$g(G,CC);Ng(Ug)}return Rg}function gC(){}return dg=zC(gC,xg,Og),Bg=zC(gC,xg,Pg),dI(ZI._closedPromise,function(vg){return qg(dg._readableStreamController,vg),qg(Bg._readableStreamController,vg),(!zI||!_I)&&Ng(void 0),null}),[dg,Bg]}function Hl(G){var j=sg(G),ZI=!1,RI=!1,SI=!1,zI=!1,_I=!1,cg,ag,dg,Bg,Ng,Rg=oI(function(Jg){Ng=Jg});function xg(Jg){dI(Jg._closedPromise,function(Yg){return Jg!==j||(Eg(dg._readableStreamController,Yg),Eg(Bg._readableStreamController,Yg),(!zI||!_I)&&Ng(void 0)),null})}function Og(){WC(j)&&(xI(j),j=sg(G),xg(j));var Jg={_chunkSteps:function(Yg){WI(function(){RI=!1,SI=!1;var Dg=Yg,kg=Yg;if(!zI&&!_I)try{kg=Tg(Yg)}catch(AC){Eg(dg._readableStreamController,AC),Eg(Bg._readableStreamController,AC),Ng($g(G,AC));return}zI||jC(dg._readableStreamController,Dg),_I||jC(Bg._readableStreamController,kg),ZI=!1,RI?gC():SI&&vg()})},_closeSteps:function(){ZI=!1,zI||DC(dg._readableStreamController),_I||DC(Bg._readableStreamController),dg._readableStreamController._pendingPullIntos.length>0&&fC(dg._readableStreamController,0),Bg._readableStreamController._pendingPullIntos.length>0&&fC(Bg._readableStreamController,0),(!zI||!_I)&&Ng(void 0)},_errorSteps:function(){ZI=!1}};vI(j,Jg)}function Pg(Jg,Yg){eg(j)&&(xI(j),j=UA(G),xg(j));var Dg=Yg?Bg:dg,kg=Yg?dg:Bg,AC={_chunkSteps:function(mC){WI(function(){RI=!1,SI=!1;var KC=Yg?_I:zI,xC=Yg?zI:_I;if(xC)KC||QC(Dg._readableStreamController,mC);else{var Di=void 0;try{Di=Tg(mC)}catch(FA){Eg(Dg._readableStreamController,FA),Eg(kg._readableStreamController,FA),Ng($g(G,FA));return}KC||QC(Dg._readableStreamController,mC),jC(kg._readableStreamController,Di)}ZI=!1,RI?gC():SI&&vg()})},_closeSteps:function(mC){ZI=!1;var KC=Yg?_I:zI,xC=Yg?zI:_I;KC||DC(Dg._readableStreamController),xC||DC(kg._readableStreamController),mC!==void 0&&(KC||QC(Dg._readableStreamController,mC),!xC&&kg._readableStreamController._pendingPullIntos.length>0&&fC(kg._readableStreamController,0)),(!KC||!xC)&&Ng(void 0)},_errorSteps:function(){ZI=!1}};_A(j,Jg,1,AC)}function gC(){if(ZI)return RI=!0,E(void 0);ZI=!0;var Jg=GA(dg._readableStreamController);return Jg===null?Og():Pg(Jg._view,!1),E(void 0)}function vg(){if(ZI)return SI=!0,E(void 0);ZI=!0;var Jg=GA(Bg._readableStreamController);return Jg===null?Og():Pg(Jg._view,!0),E(void 0)}function CC(Jg){if(zI=!0,cg=Jg,_I){var Yg=UI([cg,ag]),Dg=$g(G,Yg);Ng(Dg)}return Rg}function Ug(Jg){if(_I=!0,ag=Jg,zI){var Yg=UI([cg,ag]),Dg=$g(G,Yg);Ng(Dg)}return Rg}function eC(){}return dg=Wi(eC,gC,CC),Bg=Wi(eC,vg,Ug),xg(j),[dg,Bg]}function Sl(G){return II(G)&&typeof G.getReader<"u"}function Fl(G){return Sl(G)?kl(G.getReader()):Jl(G)}function Jl(G){var j,ZI=Ag(G,"async"),RI=H;function SI(){var _I;try{_I=Zg(ZI)}catch(ag){return _(ag)}var cg=E(_I);return eI(cg,function(ag){if(!II(ag))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");var dg=hg(ag);if(dg)uC(j._readableStreamController);else{var Bg=Vg(ag);rC(j._readableStreamController,Bg)}})}function zI(_I){var cg=ZI.iterator,ag;try{ag=Wg(cg,"return")}catch(Ng){return _(Ng)}if(ag===void 0)return E(void 0);var dg;try{dg=GI(ag,cg,[_I])}catch(Ng){return _(Ng)}var Bg=E(dg);return eI(Bg,function(Ng){if(!II(Ng))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})}return j=zC(RI,SI,zI,0),j}function kl(G){var j,ZI=H;function RI(){var zI;try{zI=G.read()}catch(_I){return _(_I)}return eI(zI,function(_I){if(!II(_I))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(_I.done)uC(j._readableStreamController);else{var cg=_I.value;rC(j._readableStreamController,cg)}})}function SI(zI){try{return E(G.cancel(zI))}catch(_I){return _(_I)}}return j=zC(ZI,RI,SI,0),j}function zl(G,j){uI(G,j);var ZI=G,RI=ZI?.autoAllocateChunkSize,SI=ZI?.cancel,zI=ZI?.pull,_I=ZI?.start,cg=ZI?.type;return{autoAllocateChunkSize:RI===void 0?void 0:gg(RI,"".concat(j," has member 'autoAllocateChunkSize' that")),cancel:SI===void 0?void 0:Ll(SI,ZI,"".concat(j," has member 'cancel' that")),pull:zI===void 0?void 0:xl(zI,ZI,"".concat(j," has member 'pull' that")),start:_I===void 0?void 0:Tl(_I,ZI,"".concat(j," has member 'start' that")),type:cg===void 0?void 0:vl(cg,"".concat(j," has member 'type' that"))}}function Ll(G,j,ZI){return rI(G,ZI),function(RI){return HI(G,j,[RI])}}function xl(G,j,ZI){return rI(G,ZI),function(RI){return HI(G,j,[RI])}}function Tl(G,j,ZI){return rI(G,ZI),function(RI){return GI(G,j,[RI])}}function vl(G,j){if(G="".concat(G),G!=="bytes")throw new TypeError("".concat(j," '").concat(G,"' is not a valid enumeration value for ReadableStreamType"));return G}function jl(G,j){uI(G,j);var ZI=G?.preventCancel;return{preventCancel:!!ZI}}function wi(G,j){uI(G,j);var ZI=G?.preventAbort,RI=G?.preventCancel,SI=G?.preventClose,zI=G?.signal;return zI!==void 0&&Ql(zI,"".concat(j," has member 'signal' that")),{preventAbort:!!ZI,preventCancel:!!RI,preventClose:!!SI,signal:zI}}function Ql(G,j){if(!$i(G))throw new TypeError("".concat(j," is not an AbortSignal."))}function Ol(G,j){uI(G,j);var ZI=G?.readable;QI(ZI,"readable","ReadableWritablePair"),lg(ZI,"".concat(j," has member 'readable' that"));var RI=G?.writable;return QI(RI,"writable","ReadableWritablePair"),$A(RI,"".concat(j," has member 'writable' that")),{readable:ZI,writable:RI}}var jg=function(){function G(j,ZI){j===void 0&&(j={}),ZI===void 0&&(ZI={}),j===void 0?j=null:kI(j,"First parameter");var RI=EC(ZI,"Second parameter"),SI=zl(j,"First parameter");if(KA(this),SI.type==="bytes"){if(RI.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");var zI=SC(RI,0);Li(this,SI,zI)}else{var _I=UC(RI),zI=SC(RI,1);Ml(this,SI,zI,_I)}}return Object.defineProperty(G.prototype,"locked",{get:function(){if(!ZC(this))throw YC("locked");return tC(this)},enumerable:!1,configurable:!0}),G.prototype.cancel=function(j){return j===void 0&&(j=void 0),ZC(this)?tC(this)?_(new TypeError("Cannot cancel a stream that already has a reader")):$g(this,j):_(YC("cancel"))},G.prototype.getReader=function(j){if(j===void 0&&(j=void 0),!ZC(this))throw YC("getReader");var ZI=Ti(j,"First parameter");return ZI.mode===void 0?sg(this):UA(this)},G.prototype.pipeThrough=function(j,ZI){if(ZI===void 0&&(ZI={}),!ZC(this))throw YC("pipeThrough");TI(j,1,"pipeThrough");var RI=Ol(j,"First parameter"),SI=wi(ZI,"Second parameter");if(tC(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(XC(RI.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");var zI=bi(this,RI.writable,SI.preventClose,SI.preventAbort,SI.preventCancel,SI.signal);return aI(zI),RI.readable},G.prototype.pipeTo=function(j,ZI){if(ZI===void 0&&(ZI={}),!ZC(this))return _(YC("pipeTo"));if(j===void 0)return _("Parameter 1 is required in 'pipeTo'.");if(!NC(j))return _(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));var RI;try{RI=wi(ZI,"Second parameter")}catch(SI){return _(SI)}return tC(this)?_(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):XC(j)?_(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):bi(this,j,RI.preventClose,RI.preventAbort,RI.preventCancel,RI.signal)},G.prototype.tee=function(){if(!ZC(this))throw YC("tee");var j=Kl(this);return UI(j)},G.prototype.values=function(j){if(j===void 0&&(j=void 0),!ZC(this))throw YC("values");var ZI=jl(j,"First parameter");return zg(this,ZI.preventCancel)},G.prototype[jI]=function(j){return this.values(j)},G.from=function(j){return Fl(j)},G}();Object.defineProperties(jg,{from:{enumerable:!0}}),Object.defineProperties(jg.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),iI(jg.from,"from"),iI(jg.prototype.cancel,"cancel"),iI(jg.prototype.getReader,"getReader"),iI(jg.prototype.pipeThrough,"pipeThrough"),iI(jg.prototype.pipeTo,"pipeTo"),iI(jg.prototype.tee,"tee"),iI(jg.prototype.values,"values"),typeof o.toStringTag=="symbol"&&Object.defineProperty(jg.prototype,o.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(jg.prototype,jI,{value:jg.prototype.values,writable:!0,configurable:!0});function zC(G,j,ZI,RI,SI){RI===void 0&&(RI=1),SI===void 0&&(SI=function(){return 1});var zI=Object.create(jg.prototype);KA(zI);var _I=Object.create(sC.prototype);return Gi(zI,_I,G,j,ZI,RI,SI),zI}function Wi(G,j,ZI){var RI=Object.create(jg.prototype);KA(RI);var SI=Object.create(iC.prototype);return OA(RI,SI,G,j,ZI,0,void 0),RI}function KA(G){G._state="readable",G._reader=void 0,G._storedError=void 0,G._disturbed=!1}function ZC(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_readableStreamController")?!1:G instanceof jg}function tC(G){return G._reader!==void 0}function $g(G,j){if(G._disturbed=!0,G._state==="closed")return E(void 0);if(G._state==="errored")return _(G._storedError);LC(G);var ZI=G._reader;if(ZI!==void 0&&WC(ZI)){var RI=ZI._readIntoRequests;ZI._readIntoRequests=new KI,RI.forEach(function(zI){zI._closeSteps(void 0)})}var SI=G._readableStreamController[yI](j);return eI(SI,H)}function LC(G){G._state="closed";var j=G._reader;if(j!==void 0&&(AI(j),eg(j))){var ZI=j._readRequests;j._readRequests=new KI,ZI.forEach(function(RI){RI._closeSteps()})}}function hi(G,j){G._state="errored",G._storedError=j;var ZI=G._reader;ZI!==void 0&&(YI(ZI,j),eg(ZI)?Gg(ZI,j):qA(ZI,j))}function YC(G){return new TypeError("ReadableStream.prototype.".concat(G," can only be used on a ReadableStream"))}function Bi(G,j){uI(G,j);var ZI=G?.highWaterMark;return QI(ZI,"highWaterMark","QueuingStrategyInit"),{highWaterMark:fI(ZI)}}var ui=function(G){return G.byteLength};iI(ui,"size");var sA=function(){function G(j){TI(j,1,"ByteLengthQueuingStrategy"),j=Bi(j,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=j.highWaterMark}return Object.defineProperty(G.prototype,"highWaterMark",{get:function(){if(!Vi(this))throw Yi("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"size",{get:function(){if(!Vi(this))throw Yi("size");return ui},enumerable:!1,configurable:!0}),G}();Object.defineProperties(sA.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(sA.prototype,o.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function Yi(G){return new TypeError("ByteLengthQueuingStrategy.prototype.".concat(G," can only be used on a ByteLengthQueuingStrategy"))}function Vi(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_byteLengthQueuingStrategyHighWaterMark")?!1:G instanceof sA}var yi=function(){return 1};iI(yi,"size");var eA=function(){function G(j){TI(j,1,"CountQueuingStrategy"),j=Bi(j,"First parameter"),this._countQueuingStrategyHighWaterMark=j.highWaterMark}return Object.defineProperty(G.prototype,"highWaterMark",{get:function(){if(!Xi(this))throw Ni("highWaterMark");return this._countQueuingStrategyHighWaterMark},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"size",{get:function(){if(!Xi(this))throw Ni("size");return yi},enumerable:!1,configurable:!0}),G}();Object.defineProperties(eA.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(eA.prototype,o.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function Ni(G){return new TypeError("CountQueuingStrategy.prototype.".concat(G," can only be used on a CountQueuingStrategy"))}function Xi(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_countQueuingStrategyHighWaterMark")?!1:G instanceof eA}function Ul(G,j){uI(G,j);var ZI=G?.cancel,RI=G?.flush,SI=G?.readableType,zI=G?.start,_I=G?.transform,cg=G?.writableType;return{cancel:ZI===void 0?void 0:ql(ZI,G,"".concat(j," has member 'cancel' that")),flush:RI===void 0?void 0:El(RI,G,"".concat(j," has member 'flush' that")),readableType:SI,start:zI===void 0?void 0:Pl(zI,G,"".concat(j," has member 'start' that")),transform:_I===void 0?void 0:_l(_I,G,"".concat(j," has member 'transform' that")),writableType:cg}}function El(G,j,ZI){return rI(G,ZI),function(RI){return HI(G,j,[RI])}}function Pl(G,j,ZI){return rI(G,ZI),function(RI){return GI(G,j,[RI])}}function _l(G,j,ZI){return rI(G,ZI),function(RI,SI){return HI(G,j,[RI,SI])}}function ql(G,j,ZI){return rI(G,ZI),function(RI){return HI(G,j,[RI])}}var dA=function(){function G(j,ZI,RI){j===void 0&&(j={}),ZI===void 0&&(ZI={}),RI===void 0&&(RI={}),j===void 0&&(j=null);var SI=EC(ZI,"Second parameter"),zI=EC(RI,"Third parameter"),_I=Ul(j,"First parameter");if(_I.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(_I.writableType!==void 0)throw new RangeError("Invalid writableType specified");var cg=SC(zI,0),ag=UC(zI),dg=SC(SI,1),Bg=UC(SI),Ng,Rg=oI(function(xg){Ng=xg});$l(this,Rg,dg,Bg,cg,ag),gs(this,_I),_I.start!==void 0?Ng(_I.start(this._transformStreamController)):Ng(void 0)}return Object.defineProperty(G.prototype,"readable",{get:function(){if(!Ri(this))throw Ki("readable");return this._readable},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"writable",{get:function(){if(!Ri(this))throw Ki("writable");return this._writable},enumerable:!1,configurable:!0}),G}();Object.defineProperties(dA.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof o.toStringTag=="symbol"&&Object.defineProperty(dA.prototype,o.toStringTag,{value:"TransformStream",configurable:!0});function $l(G,j,ZI,RI,SI,zI){function _I(){return j}function cg(Rg){return is(G,Rg)}function ag(Rg){return ls(G,Rg)}function dg(){return ss(G)}G._writable=Cl(_I,cg,dg,ag,ZI,RI);function Bg(){return es(G)}function Ng(Rg){return ds(G,Rg)}G._readable=zC(_I,Bg,Ng,SI,zI),G._backpressure=void 0,G._backpressureChangePromise=void 0,G._backpressureChangePromise_resolve=void 0,cA(G,!0),G._transformStreamController=void 0}function Ri(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_transformStreamController")?!1:G instanceof dA}function ri(G,j){qg(G._readable._readableStreamController,j),DA(G,j)}function DA(G,j){ZA(G._transformStreamController),FC(G._writable._writableStreamController,j),HA(G)}function HA(G){G._backpressure&&cA(G,!1)}function cA(G,j){G._backpressureChangePromise!==void 0&&G._backpressureChangePromise_resolve(),G._backpressureChangePromise=oI(function(ZI){G._backpressureChangePromise_resolve=ZI}),G._backpressure=j}var aC=function(){function G(){throw new TypeError("Illegal constructor")}return Object.defineProperty(G.prototype,"desiredSize",{get:function(){if(!oA(this))throw tA("desiredSize");var j=this._controlledTransformStream._readable._readableStreamController;return MA(j)},enumerable:!1,configurable:!0}),G.prototype.enqueue=function(j){if(j===void 0&&(j=void 0),!oA(this))throw tA("enqueue");pi(this,j)},G.prototype.error=function(j){if(j===void 0&&(j=void 0),!oA(this))throw tA("error");Cs(this,j)},G.prototype.terminate=function(){if(!oA(this))throw tA("terminate");As(this)},G}();Object.defineProperties(aC.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),iI(aC.prototype.enqueue,"enqueue"),iI(aC.prototype.error,"error"),iI(aC.prototype.terminate,"terminate"),typeof o.toStringTag=="symbol"&&Object.defineProperty(aC.prototype,o.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function oA(G){return!II(G)||!Object.prototype.hasOwnProperty.call(G,"_controlledTransformStream")?!1:G instanceof aC}function Is(G,j,ZI,RI,SI){j._controlledTransformStream=G,G._transformStreamController=j,j._transformAlgorithm=ZI,j._flushAlgorithm=RI,j._cancelAlgorithm=SI,j._finishPromise=void 0,j._finishPromise_resolve=void 0,j._finishPromise_reject=void 0}function gs(G,j){var ZI=Object.create(aC.prototype),RI,SI,zI;j.transform!==void 0?RI=function(_I){return j.transform(_I,ZI)}:RI=function(_I){try{return pi(ZI,_I),E(void 0)}catch(cg){return _(cg)}},j.flush!==void 0?SI=function(){return j.flush(ZI)}:SI=function(){return E(void 0)},j.cancel!==void 0?zI=function(_I){return j.cancel(_I)}:zI=function(){return E(void 0)},Is(G,ZI,RI,SI,zI)}function ZA(G){G._transformAlgorithm=void 0,G._flushAlgorithm=void 0,G._cancelAlgorithm=void 0}function pi(G,j){var ZI=G._controlledTransformStream,RI=ZI._readable._readableStreamController;if(!pC(RI))throw new TypeError("Readable side is not in a state that permits enqueue");try{rC(RI,j)}catch(zI){throw DA(ZI,zI),ZI._readable._storedError}var SI=pl(RI);SI!==ZI._backpressure&&cA(ZI,!0)}function Cs(G,j){ri(G._controlledTransformStream,j)}function Mi(G,j){var ZI=G._transformAlgorithm(j);return eI(ZI,void 0,function(RI){throw ri(G._controlledTransformStream,RI),RI})}function As(G){var j=G._controlledTransformStream,ZI=j._readable._readableStreamController;uC(ZI);var RI=new TypeError("TransformStream terminated");DA(j,RI)}function is(G,j){var ZI=G._transformStreamController;if(G._backpressure){var RI=G._backpressureChangePromise;return eI(RI,function(){var SI=G._writable,zI=SI._state;if(zI==="erroring")throw SI._storedError;return Mi(ZI,j)})}return Mi(ZI,j)}function ls(G,j){var ZI=G._transformStreamController;if(ZI._finishPromise!==void 0)return ZI._finishPromise;var RI=G._readable;ZI._finishPromise=oI(function(zI,_I){ZI._finishPromise_resolve=zI,ZI._finishPromise_reject=_I});var SI=ZI._cancelAlgorithm(j);return ZA(ZI),M(SI,function(){return RI._state==="errored"?MC(ZI,RI._storedError):(qg(RI._readableStreamController,j),SA(ZI)),null},function(zI){return qg(RI._readableStreamController,zI),MC(ZI,zI),null}),ZI._finishPromise}function ss(G){var j=G._transformStreamController;if(j._finishPromise!==void 0)return j._finishPromise;var ZI=G._readable;j._finishPromise=oI(function(SI,zI){j._finishPromise_resolve=SI,j._finishPromise_reject=zI});var RI=j._flushAlgorithm();return ZA(j),M(RI,function(){return ZI._state==="errored"?MC(j,ZI._storedError):(uC(ZI._readableStreamController),SA(j)),null},function(SI){return qg(ZI._readableStreamController,SI),MC(j,SI),null}),j._finishPromise}function es(G){return cA(G,!1),G._backpressureChangePromise}function ds(G,j){var ZI=G._transformStreamController;if(ZI._finishPromise!==void 0)return ZI._finishPromise;var RI=G._writable;ZI._finishPromise=oI(function(zI,_I){ZI._finishPromise_resolve=zI,ZI._finishPromise_reject=_I});var SI=ZI._cancelAlgorithm(j);return ZA(ZI),M(SI,function(){return RI._state==="errored"?MC(ZI,RI._storedError):(FC(RI._writableStreamController,j),HA(G),SA(ZI)),null},function(zI){return FC(RI._writableStreamController,zI),HA(G),MC(ZI,zI),null}),ZI._finishPromise}function tA(G){return new TypeError("TransformStreamDefaultController.prototype.".concat(G," can only be used on a TransformStreamDefaultController"))}function SA(G){G._finishPromise_resolve!==void 0&&(G._finishPromise_resolve(),G._finishPromise_resolve=void 0,G._finishPromise_reject=void 0)}function MC(G,j){G._finishPromise_reject!==void 0&&(aI(G._finishPromise),G._finishPromise_reject(j),G._finishPromise_resolve=void 0,G._finishPromise_reject=void 0)}function Ki(G){return new TypeError("TransformStream.prototype.".concat(G," can only be used on a TransformStream"))}l.ByteLengthQueuingStrategy=sA,l.CountQueuingStrategy=eA,l.ReadableByteStreamController=iC,l.ReadableStream=jg,l.ReadableStreamBYOBReader=cC,l.ReadableStreamBYOBRequest=Qg,l.ReadableStreamDefaultController=sC,l.ReadableStreamDefaultReader=mg,l.TransformStream=dA,l.TransformStreamDefaultController=aC,l.WritableStream=oC,l.WritableStreamDefaultController=RC,l.WritableStreamDefaultWriter=lC})}(ponyfill$1,ponyfill$1.exports)),ponyfill$1.exports}const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$7=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(A,l){module.exports=l()})(globalThis,()=>(()=>{var __webpack_modules__=[,(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.VerbosityLevel=A.Util=A.UnknownErrorException=A.UnexpectedResponseException=A.UNSUPPORTED_FEATURES=A.TextRenderingMode=A.StreamType=A.RenderingIntentFlag=A.PermissionFlag=A.PasswordResponses=A.PasswordException=A.PageActionEventType=A.OPS=A.MissingPDFException=A.LINE_FACTOR=A.LINE_DESCENT_FACTOR=A.InvalidPDFException=A.ImageKind=A.IDENTITY_MATRIX=A.FormatError=A.FontType=A.FeatureTest=A.FONT_IDENTITY_MATRIX=A.DocumentActionEventType=A.CMapCompressionType=A.BaseException=A.AnnotationType=A.AnnotationStateModelType=A.AnnotationReviewState=A.AnnotationReplyType=A.AnnotationMode=A.AnnotationMarkedState=A.AnnotationFlag=A.AnnotationFieldFlag=A.AnnotationEditorType=A.AnnotationEditorPrefix=A.AnnotationEditorParamsType=A.AnnotationBorderStyleType=A.AnnotationActionEventType=A.AbortException=void 0,A.arrayByteLength=TI,A.arraysToBytes=QI,A.assert=PI,A.bytesToString=FI,A.createPromiseCapability=wg,A.createValidAbsoluteUrl=tI,A.escapeString=mg,A.getModificationDate=og,A.getVerbosityLevel=hI,A.info=wI,A.isArrayBuffer=Kg,A.isArrayEqual=Ig,A.isAscii=eg,A.objectFromMap=qI,A.objectSize=OI,A.setVerbosityLevel=VI,A.shadow=mI,A.string32=fI,A.stringToBytes=kI,A.stringToPDFString=rg,A.stringToUTF16BEString=vI,A.stringToUTF8String=Cg,A.unreachable=xI,A.utf8StringToString=Gg,A.warn=pI,l(2);const o=[1,0,0,1,0,0];A.IDENTITY_MATRIX=o;const t=[.001,0,0,.001,0,0];A.FONT_IDENTITY_MATRIX=t;const a=1.35;A.LINE_FACTOR=a;const n=.35;A.LINE_DESCENT_FACTOR=n;const B={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};A.RenderingIntentFlag=B;const R={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};A.AnnotationMode=R;const r="pdfjs_internal_editor_";A.AnnotationEditorPrefix=r;const H={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};A.AnnotationEditorType=H;const II={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};A.AnnotationEditorParamsType=II;const k={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};A.PermissionFlag=k;const iI={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};A.TextRenderingMode=iI;const lI={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};A.ImageKind=lI;const CI={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};A.AnnotationType=CI;const sI={MARKED:"Marked",REVIEW:"Review"};A.AnnotationStateModelType=sI;const oI={MARKED:"Marked",UNMARKED:"Unmarked"};A.AnnotationMarkedState=oI;const E={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};A.AnnotationReviewState=E;const _={GROUP:"Group",REPLY:"R"};A.AnnotationReplyType=_;const gI={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};A.AnnotationFlag=gI;const M={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};A.AnnotationFieldFlag=M;const O={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};A.AnnotationBorderStyleType=O;const dI={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};A.AnnotationActionEventType=dI;const eI={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};A.DocumentActionEventType=eI;const aI={O:"PageOpen",C:"PageClose"};A.PageActionEventType=aI;const WI={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};A.StreamType=WI;const GI={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};A.FontType=GI;const HI={ERRORS:0,WARNINGS:1,INFOS:5};A.VerbosityLevel=HI;const MI={NONE:0,BINARY:1,STREAM:2};A.CMapCompressionType=MI;const KI={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};A.OPS=KI;const DI={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};A.UNSUPPORTED_FEATURES=DI;const NI={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};A.PasswordResponses=NI;let yI=HI.WARNINGS;function VI(UI){Number.isInteger(UI)&&(yI=UI)}function hI(){return yI}function wI(UI){yI>=HI.INFOS&&console.log(`Info: ${UI}`)}function pI(UI){yI>=HI.WARNINGS&&console.log(`Warning: ${UI}`)}function xI(UI){throw new Error(UI)}function PI(UI,JI){UI||xI(JI)}function XI(UI){if(!UI)return!1;switch(UI.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function tI(UI){let JI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,LI=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!UI)return null;try{if(LI&&typeof UI=="string"){if(LI.addDefaultProtocol&&UI.startsWith("www.")){const bg=UI.match(/\./g);bg&&bg.length>=2&&(UI=`http://${UI}`)}if(LI.tryConvertEncoding)try{UI=Cg(UI)}catch{}}const $I=JI?new URL(UI,JI):new URL(UI);if(XI($I))return $I}catch{}return null}function mI(UI,JI,LI){return Object.defineProperty(UI,JI,{value:LI,enumerable:!0,configurable:!0,writable:!1}),LI}const YI=function(){function JI(LI,$I){this.constructor===JI&&xI("Cannot initialize BaseException."),this.message=LI,this.name=$I}return JI.prototype=new Error,JI.constructor=JI,JI}();A.BaseException=YI;class BI extends YI{constructor(JI,LI){super(JI,"PasswordException"),this.code=LI}}A.PasswordException=BI;class AI extends YI{constructor(JI,LI){super(JI,"UnknownErrorException"),this.details=LI}}A.UnknownErrorException=AI;class cI extends YI{constructor(JI){super(JI,"InvalidPDFException")}}A.InvalidPDFException=cI;class bI extends YI{constructor(JI){super(JI,"MissingPDFException")}}A.MissingPDFException=bI;class nI extends YI{constructor(JI,LI){super(JI,"UnexpectedResponseException"),this.status=LI}}A.UnexpectedResponseException=nI;class uI extends YI{constructor(JI){super(JI,"FormatError")}}A.FormatError=uI;class rI extends YI{constructor(JI){super(JI,"AbortException")}}A.AbortException=rI;function FI(UI){(typeof UI!="object"||UI===null||UI.length===void 0)&&xI("Invalid argument for bytesToString");const JI=UI.length,LI=8192;if(JI<LI)return String.fromCharCode.apply(null,UI);const $I=[];for(let bg=0;bg<JI;bg+=LI){const Wg=Math.min(bg+LI,JI),EI=UI.subarray(bg,Wg);$I.push(String.fromCharCode.apply(null,EI))}return $I.join("")}function kI(UI){typeof UI!="string"&&xI("Invalid argument for stringToBytes");const JI=UI.length,LI=new Uint8Array(JI);for(let $I=0;$I<JI;++$I)LI[$I]=UI.charCodeAt($I)&255;return LI}function TI(UI){if(UI.length!==void 0)return UI.length;if(UI.byteLength!==void 0)return UI.byteLength;xI("Invalid argument for arrayByteLength")}function QI(UI){const JI=UI.length;if(JI===1&&UI[0]instanceof Uint8Array)return UI[0];let LI=0;for(let Wg=0;Wg<JI;Wg++)LI+=TI(UI[Wg]);let $I=0;const bg=new Uint8Array(LI);for(let Wg=0;Wg<JI;Wg++){let EI=UI[Wg];EI instanceof Uint8Array||(typeof EI=="string"?EI=kI(EI):EI=new Uint8Array(EI));const jI=EI.byteLength;bg.set(EI,$I),$I+=jI}return bg}function fI(UI){return String.fromCharCode(UI>>24&255,UI>>16&255,UI>>8&255,UI&255)}function OI(UI){return Object.keys(UI).length}function qI(UI){const JI=Object.create(null);for(const[LI,$I]of UI)JI[LI]=$I;return JI}function gg(){const UI=new Uint8Array(4);return UI[0]=1,new Uint32Array(UI.buffer,0,1)[0]===1}function lg(){try{return new Function(""),!0}catch{return!1}}class sg{static get isLittleEndian(){return mI(this,"isLittleEndian",gg())}static get isEvalSupported(){return mI(this,"isEvalSupported",lg())}static get isOffscreenCanvasSupported(){return mI(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}A.FeatureTest=sg;const tg=[...Array(256).keys()].map(UI=>UI.toString(16).padStart(2,"0"));class ig{static makeHexColor(JI,LI,$I){return`#${tg[JI]}${tg[LI]}${tg[$I]}`}static scaleMinMax(JI,LI){let $I;JI[0]?(JI[0]<0&&($I=LI[0],LI[0]=LI[1],LI[1]=$I),LI[0]*=JI[0],LI[1]*=JI[0],JI[3]<0&&($I=LI[2],LI[2]=LI[3],LI[3]=$I),LI[2]*=JI[3],LI[3]*=JI[3]):($I=LI[0],LI[0]=LI[2],LI[2]=$I,$I=LI[1],LI[1]=LI[3],LI[3]=$I,JI[1]<0&&($I=LI[2],LI[2]=LI[3],LI[3]=$I),LI[2]*=JI[1],LI[3]*=JI[1],JI[2]<0&&($I=LI[0],LI[0]=LI[1],LI[1]=$I),LI[0]*=JI[2],LI[1]*=JI[2]),LI[0]+=JI[4],LI[1]+=JI[4],LI[2]+=JI[5],LI[3]+=JI[5]}static transform(JI,LI){return[JI[0]*LI[0]+JI[2]*LI[1],JI[1]*LI[0]+JI[3]*LI[1],JI[0]*LI[2]+JI[2]*LI[3],JI[1]*LI[2]+JI[3]*LI[3],JI[0]*LI[4]+JI[2]*LI[5]+JI[4],JI[1]*LI[4]+JI[3]*LI[5]+JI[5]]}static applyTransform(JI,LI){const $I=JI[0]*LI[0]+JI[1]*LI[2]+LI[4],bg=JI[0]*LI[1]+JI[1]*LI[3]+LI[5];return[$I,bg]}static applyInverseTransform(JI,LI){const $I=LI[0]*LI[3]-LI[1]*LI[2],bg=(JI[0]*LI[3]-JI[1]*LI[2]+LI[2]*LI[5]-LI[4]*LI[3])/$I,Wg=(-JI[0]*LI[1]+JI[1]*LI[0]+LI[4]*LI[1]-LI[5]*LI[0])/$I;return[bg,Wg]}static getAxialAlignedBoundingBox(JI,LI){const $I=ig.applyTransform(JI,LI),bg=ig.applyTransform(JI.slice(2,4),LI),Wg=ig.applyTransform([JI[0],JI[3]],LI),EI=ig.applyTransform([JI[2],JI[1]],LI);return[Math.min($I[0],bg[0],Wg[0],EI[0]),Math.min($I[1],bg[1],Wg[1],EI[1]),Math.max($I[0],bg[0],Wg[0],EI[0]),Math.max($I[1],bg[1],Wg[1],EI[1])]}static inverseTransform(JI){const LI=JI[0]*JI[3]-JI[1]*JI[2];return[JI[3]/LI,-JI[1]/LI,-JI[2]/LI,JI[0]/LI,(JI[2]*JI[5]-JI[4]*JI[3])/LI,(JI[4]*JI[1]-JI[5]*JI[0])/LI]}static apply3dTransform(JI,LI){return[JI[0]*LI[0]+JI[1]*LI[1]+JI[2]*LI[2],JI[3]*LI[0]+JI[4]*LI[1]+JI[5]*LI[2],JI[6]*LI[0]+JI[7]*LI[1]+JI[8]*LI[2]]}static singularValueDecompose2dScale(JI){const LI=[JI[0],JI[2],JI[1],JI[3]],$I=JI[0]*LI[0]+JI[1]*LI[2],bg=JI[0]*LI[1]+JI[1]*LI[3],Wg=JI[2]*LI[0]+JI[3]*LI[2],EI=JI[2]*LI[1]+JI[3]*LI[3],jI=($I+EI)/2,Ag=Math.sqrt(($I+EI)**2-4*($I*EI-Wg*bg))/2,Zg=jI+Ag||1,hg=jI-Ag||1;return[Math.sqrt(Zg),Math.sqrt(hg)]}static normalizeRect(JI){const LI=JI.slice(0);return JI[0]>JI[2]&&(LI[0]=JI[2],LI[2]=JI[0]),JI[1]>JI[3]&&(LI[1]=JI[3],LI[3]=JI[1]),LI}static intersect(JI,LI){const $I=Math.max(Math.min(JI[0],JI[2]),Math.min(LI[0],LI[2])),bg=Math.min(Math.max(JI[0],JI[2]),Math.max(LI[0],LI[2]));if($I>bg)return null;const Wg=Math.max(Math.min(JI[1],JI[3]),Math.min(LI[1],LI[3])),EI=Math.min(Math.max(JI[1],JI[3]),Math.max(LI[1],LI[3]));return Wg>EI?null:[$I,Wg,bg,EI]}static bezierBoundingBox(JI,LI,$I,bg,Wg,EI,jI,Ag){const Zg=[],hg=[[],[]];let Vg,ug,yg,ng,Mg,zg,pg,Hg;for(let Fg=0;Fg<2;++Fg){if(Fg===0?(ug=6*JI-12*$I+6*Wg,Vg=-3*JI+9*$I-9*Wg+3*jI,yg=3*$I-3*JI):(ug=6*LI-12*bg+6*EI,Vg=-3*LI+9*bg-9*EI+3*Ag,yg=3*bg-3*LI),Math.abs(Vg)<1e-12){if(Math.abs(ug)<1e-12)continue;ng=-yg/ug,0<ng&&ng<1&&Zg.push(ng);continue}pg=ug*ug-4*yg*Vg,Hg=Math.sqrt(pg),!(pg<0)&&(Mg=(-ug+Hg)/(2*Vg),0<Mg&&Mg<1&&Zg.push(Mg),zg=(-ug-Hg)/(2*Vg),0<zg&&zg<1&&Zg.push(zg))}let Lg=Zg.length,Sg;const Tg=Lg;for(;Lg--;)ng=Zg[Lg],Sg=1-ng,hg[0][Lg]=Sg*Sg*Sg*JI+3*Sg*Sg*ng*$I+3*Sg*ng*ng*Wg+ng*ng*ng*jI,hg[1][Lg]=Sg*Sg*Sg*LI+3*Sg*Sg*ng*bg+3*Sg*ng*ng*EI+ng*ng*ng*Ag;return hg[0][Tg]=JI,hg[1][Tg]=LI,hg[0][Tg+1]=jI,hg[1][Tg+1]=Ag,hg[0].length=hg[1].length=Tg+2,[Math.min(...hg[0]),Math.min(...hg[1]),Math.max(...hg[0]),Math.max(...hg[1])]}}A.Util=ig;const Xg=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function rg(UI){if(UI[0]>="Ã¯"){let LI;if(UI[0]==="Ã¾"&&UI[1]==="Ã¿"?LI="utf-16be":UI[0]==="Ã¿"&&UI[1]==="Ã¾"?LI="utf-16le":UI[0]==="Ã¯"&&UI[1]==="Â»"&&UI[2]==="Â¿"&&(LI="utf-8"),LI)try{const $I=new TextDecoder(LI,{fatal:!0}),bg=kI(UI);return $I.decode(bg)}catch($I){pI(`stringToPDFString: "${$I}".`)}}const JI=[];for(let LI=0,$I=UI.length;LI<$I;LI++){const bg=Xg[UI.charCodeAt(LI)];JI.push(bg?String.fromCharCode(bg):UI.charAt(LI))}return JI.join("")}function mg(UI){return UI.replace(/([()\\\n\r])/g,JI=>JI===`
`?"\\n":JI==="\r"?"\\r":`\\${JI}`)}function eg(UI){return/^[\x00-\x7F]*$/.test(UI)}function vI(UI){const JI=["Ã¾Ã¿"];for(let LI=0,$I=UI.length;LI<$I;LI++){const bg=UI.charCodeAt(LI);JI.push(String.fromCharCode(bg>>8&255),String.fromCharCode(bg&255))}return JI.join("")}function Cg(UI){return decodeURIComponent(escape(UI))}function Gg(UI){return unescape(encodeURIComponent(UI))}function Kg(UI){return typeof UI=="object"&&UI!==null&&UI.byteLength!==void 0}function Ig(UI,JI){if(UI.length!==JI.length)return!1;for(let LI=0,$I=UI.length;LI<$I;LI++)if(UI[LI]!==JI[LI])return!1;return!0}function og(){let UI=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date;return[UI.getUTCFullYear().toString(),(UI.getUTCMonth()+1).toString().padStart(2,"0"),UI.getUTCDate().toString().padStart(2,"0"),UI.getUTCHours().toString().padStart(2,"0"),UI.getUTCMinutes().toString().padStart(2,"0"),UI.getUTCSeconds().toString().padStart(2,"0")].join("")}function wg(){const UI=Object.create(null);let JI=!1;return Object.defineProperty(UI,"settled",{get(){return JI}}),UI.promise=new Promise(function(LI,$I){UI.resolve=function(bg){JI=!0,LI(bg)},UI.reject=function(bg){JI=!0,$I(bg)}}),UI}},(e,A,l)=>{var o=l(3);globalThis._pdfjsCompatibilityChecked||(globalThis._pdfjsCompatibilityChecked=!0,function(){globalThis.btoa||!o.isNodeJS||(globalThis.btoa=function(a){return Buffer.from(a,"binary").toString("base64")})}(),function(){globalThis.atob||!o.isNodeJS||(globalThis.atob=function(a){return Buffer.from(a,"base64").toString("binary")})}(),function(){globalThis.DOMMatrix||!o.isNodeJS||(globalThis.DOMMatrix=requireDommatrix())}(),function(){globalThis.ReadableStream||!o.isNodeJS||(globalThis.ReadableStream=requirePonyfill().ReadableStream)}(),function(){Array.prototype.at||l(4)}(),function(){Uint8Array.prototype.at||l(76)}(),function(){globalThis.structuredClone||l(86)}())},(e,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.isNodeJS=void 0;const l=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");A.isNodeJS=l},(e,A,l)=>{l(5);var o=l(75);e.exports=o("Array","at")},(e,A,l)=>{var o=l(6),t=l(41),a=l(65),n=l(63),B=l(70);o({target:"Array",proto:!0},{at:function(r){var H=t(this),II=a(H),k=n(r),iI=k>=0?k:II+k;return iI<0||iI>=II?void 0:H[iI]}}),B("at")},(e,A,l)=>{var o=l(7),t=l(8).f,a=l(45),n=l(49),B=l(39),R=l(57),r=l(69);e.exports=function(H,II){var k=H.target,iI=H.global,lI=H.stat,CI,sI,oI,E,_,gI;if(iI?sI=o:lI?sI=o[k]||B(k,{}):sI=(o[k]||{}).prototype,sI)for(oI in II){if(_=II[oI],H.dontCallGetSet?(gI=t(sI,oI),E=gI&&gI.value):E=sI[oI],CI=r(iI?oI:k+(lI?".":"#")+oI,H.forced),!CI&&E!==void 0){if(typeof _==typeof E)continue;R(_,E)}(H.sham||E&&E.sham)&&a(_,"sham",!0),n(sI,oI,_,H)}}},e=>{var A=function(l){return l&&l.Math==Math&&l};e.exports=A(typeof globalThis=="object"&&globalThis)||A(typeof window=="object"&&window)||A(typeof self=="object"&&self)||A(typeof commonjsGlobal=="object"&&commonjsGlobal)||function(){return this}()||Function("return this")()},(e,A,l)=>{var o=l(9),t=l(11),a=l(13),n=l(14),B=l(15),R=l(20),r=l(40),H=l(43),II=Object.getOwnPropertyDescriptor;A.f=o?II:function(iI,lI){if(iI=B(iI),lI=R(lI),H)try{return II(iI,lI)}catch{}if(r(iI,lI))return n(!t(a.f,iI,lI),iI[lI])}},(e,A,l)=>{var o=l(10);e.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},e=>{e.exports=function(A){try{return!!A()}catch{return!0}}},(e,A,l)=>{var o=l(12),t=Function.prototype.call;e.exports=o?t.bind(t):function(){return t.apply(t,arguments)}},(e,A,l)=>{var o=l(10);e.exports=!o(function(){var t=function(){}.bind();return typeof t!="function"||t.hasOwnProperty("prototype")})},(e,A)=>{var l={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,t=o&&!l.call({1:2},1);A.f=t?function(n){var B=o(this,n);return!!B&&B.enumerable}:l},e=>{e.exports=function(A,l){return{enumerable:!(A&1),configurable:!(A&2),writable:!(A&4),value:l}}},(e,A,l)=>{var o=l(16),t=l(19);e.exports=function(a){return o(t(a))}},(e,A,l)=>{var o=l(17),t=l(10),a=l(18),n=Object,B=o("".split);e.exports=t(function(){return!n("z").propertyIsEnumerable(0)})?function(R){return a(R)=="String"?B(R,""):n(R)}:n},(e,A,l)=>{var o=l(12),t=Function.prototype,a=t.bind,n=t.call,B=o&&a.bind(n,n);e.exports=o?function(R){return R&&B(R)}:function(R){return R&&function(){return n.apply(R,arguments)}}},(e,A,l)=>{var o=l(17),t=o({}.toString),a=o("".slice);e.exports=function(n){return a(t(n),8,-1)}},e=>{var A=TypeError;e.exports=function(l){if(l==null)throw A("Can't call method on "+l);return l}},(e,A,l)=>{var o=l(21),t=l(24);e.exports=function(a){var n=o(a,"string");return t(n)?n:n+""}},(e,A,l)=>{var o=l(11),t=l(22),a=l(24),n=l(31),B=l(34),R=l(35),r=TypeError,H=R("toPrimitive");e.exports=function(II,k){if(!t(II)||a(II))return II;var iI=n(II,H),lI;if(iI){if(k===void 0&&(k="default"),lI=o(iI,II,k),!t(lI)||a(lI))return lI;throw r("Can't convert object to primitive value")}return k===void 0&&(k="number"),B(II,k)}},(e,A,l)=>{var o=l(23);e.exports=function(t){return typeof t=="object"?t!==null:o(t)}},e=>{e.exports=function(A){return typeof A=="function"}},(e,A,l)=>{var o=l(25),t=l(23),a=l(26),n=l(27),B=Object;e.exports=n?function(R){return typeof R=="symbol"}:function(R){var r=o("Symbol");return t(r)&&a(r.prototype,B(R))}},(e,A,l)=>{var o=l(7),t=l(23),a=function(n){return t(n)?n:void 0};e.exports=function(n,B){return arguments.length<2?a(o[n]):o[n]&&o[n][B]}},(e,A,l)=>{var o=l(17);e.exports=o({}.isPrototypeOf)},(e,A,l)=>{var o=l(28);e.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},(e,A,l)=>{var o=l(29),t=l(10);e.exports=!!Object.getOwnPropertySymbols&&!t(function(){var a=Symbol();return!String(a)||!(Object(a)instanceof Symbol)||!Symbol.sham&&o&&o<41})},(e,A,l)=>{var o=l(7),t=l(30),a=o.process,n=o.Deno,B=a&&a.versions||n&&n.version,R=B&&B.v8,r,H;R&&(r=R.split("."),H=r[0]>0&&r[0]<4?1:+(r[0]+r[1])),!H&&t&&(r=t.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=t.match(/Chrome\/(\d+)/),r&&(H=+r[1]))),e.exports=H},(e,A,l)=>{var o=l(25);e.exports=o("navigator","userAgent")||""},(e,A,l)=>{var o=l(32);e.exports=function(t,a){var n=t[a];return n==null?void 0:o(n)}},(e,A,l)=>{var o=l(23),t=l(33),a=TypeError;e.exports=function(n){if(o(n))return n;throw a(t(n)+" is not a function")}},e=>{var A=String;e.exports=function(l){try{return A(l)}catch{return"Object"}}},(e,A,l)=>{var o=l(11),t=l(23),a=l(22),n=TypeError;e.exports=function(B,R){var r,H;if(R==="string"&&t(r=B.toString)&&!a(H=o(r,B))||t(r=B.valueOf)&&!a(H=o(r,B))||R!=="string"&&t(r=B.toString)&&!a(H=o(r,B)))return H;throw n("Can't convert object to primitive value")}},(e,A,l)=>{var o=l(7),t=l(36),a=l(40),n=l(42),B=l(28),R=l(27),r=t("wks"),H=o.Symbol,II=H&&H.for,k=R?H:H&&H.withoutSetter||n;e.exports=function(iI){if(!a(r,iI)||!(B||typeof r[iI]=="string")){var lI="Symbol."+iI;B&&a(H,iI)?r[iI]=H[iI]:R&&II?r[iI]=II(lI):r[iI]=k(lI)}return r[iI]}},(e,A,l)=>{var o=l(37),t=l(38);(e.exports=function(a,n){return t[a]||(t[a]=n!==void 0?n:{})})("versions",[]).push({version:"3.24.1",mode:o?"pure":"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.1/LICENSE",source:"https://github.com/zloirock/core-js"})},e=>{e.exports=!1},(e,A,l)=>{var o=l(7),t=l(39),a="__core-js_shared__",n=o[a]||t(a,{});e.exports=n},(e,A,l)=>{var o=l(7),t=Object.defineProperty;e.exports=function(a,n){try{t(o,a,{value:n,configurable:!0,writable:!0})}catch{o[a]=n}return n}},(e,A,l)=>{var o=l(17),t=l(41),a=o({}.hasOwnProperty);e.exports=Object.hasOwn||function(B,R){return a(t(B),R)}},(e,A,l)=>{var o=l(19),t=Object;e.exports=function(a){return t(o(a))}},(e,A,l)=>{var o=l(17),t=0,a=Math.random(),n=o(1 .toString);e.exports=function(B){return"Symbol("+(B===void 0?"":B)+")_"+n(++t+a,36)}},(e,A,l)=>{var o=l(9),t=l(10),a=l(44);e.exports=!o&&!t(function(){return Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a!=7})},(e,A,l)=>{var o=l(7),t=l(22),a=o.document,n=t(a)&&t(a.createElement);e.exports=function(B){return n?a.createElement(B):{}}},(e,A,l)=>{var o=l(9),t=l(46),a=l(14);e.exports=o?function(n,B,R){return t.f(n,B,a(1,R))}:function(n,B,R){return n[B]=R,n}},(e,A,l)=>{var o=l(9),t=l(43),a=l(47),n=l(48),B=l(20),R=TypeError,r=Object.defineProperty,H=Object.getOwnPropertyDescriptor,II="enumerable",k="configurable",iI="writable";A.f=o?a?function(CI,sI,oI){if(n(CI),sI=B(sI),n(oI),typeof CI=="function"&&sI==="prototype"&&"value"in oI&&iI in oI&&!oI[iI]){var E=H(CI,sI);E&&E[iI]&&(CI[sI]=oI.value,oI={configurable:k in oI?oI[k]:E[k],enumerable:II in oI?oI[II]:E[II],writable:!1})}return r(CI,sI,oI)}:r:function(CI,sI,oI){if(n(CI),sI=B(sI),n(oI),t)try{return r(CI,sI,oI)}catch{}if("get"in oI||"set"in oI)throw R("Accessors not supported");return"value"in oI&&(CI[sI]=oI.value),CI}},(e,A,l)=>{var o=l(9),t=l(10);e.exports=o&&t(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},(e,A,l)=>{var o=l(22),t=String,a=TypeError;e.exports=function(n){if(o(n))return n;throw a(t(n)+" is not an object")}},(e,A,l)=>{var o=l(23),t=l(46),a=l(50),n=l(39);e.exports=function(B,R,r,H){H||(H={});var II=H.enumerable,k=H.name!==void 0?H.name:R;if(o(r)&&a(r,k,H),H.global)II?B[R]=r:n(R,r);else{try{H.unsafe?B[R]&&(II=!0):delete B[R]}catch{}II?B[R]=r:t.f(B,R,{value:r,enumerable:!1,configurable:!H.nonConfigurable,writable:!H.nonWritable})}return B}},(e,A,l)=>{var o=l(10),t=l(23),a=l(40),n=l(9),B=l(51).CONFIGURABLE,R=l(52),r=l(53),H=r.enforce,II=r.get,k=Object.defineProperty,iI=n&&!o(function(){return k(function(){},"length",{value:8}).length!==8}),lI=String(String).split("String"),CI=e.exports=function(sI,oI,E){String(oI).slice(0,7)==="Symbol("&&(oI="["+String(oI).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),E&&E.getter&&(oI="get "+oI),E&&E.setter&&(oI="set "+oI),(!a(sI,"name")||B&&sI.name!==oI)&&(n?k(sI,"name",{value:oI,configurable:!0}):sI.name=oI),iI&&E&&a(E,"arity")&&sI.length!==E.arity&&k(sI,"length",{value:E.arity});try{E&&a(E,"constructor")&&E.constructor?n&&k(sI,"prototype",{writable:!1}):sI.prototype&&(sI.prototype=void 0)}catch{}var _=H(sI);return a(_,"source")||(_.source=lI.join(typeof oI=="string"?oI:"")),sI};Function.prototype.toString=CI(function(){return t(this)&&II(this).source||R(this)},"toString")},(e,A,l)=>{var o=l(9),t=l(40),a=Function.prototype,n=o&&Object.getOwnPropertyDescriptor,B=t(a,"name"),R=B&&function(){}.name==="something",r=B&&(!o||o&&n(a,"name").configurable);e.exports={EXISTS:B,PROPER:R,CONFIGURABLE:r}},(e,A,l)=>{var o=l(17),t=l(23),a=l(38),n=o(Function.toString);t(a.inspectSource)||(a.inspectSource=function(B){return n(B)}),e.exports=a.inspectSource},(e,A,l)=>{var o=l(54),t=l(7),a=l(17),n=l(22),B=l(45),R=l(40),r=l(38),H=l(55),II=l(56),k="Object already initialized",iI=t.TypeError,lI=t.WeakMap,CI,sI,oI,E=function(aI){return oI(aI)?sI(aI):CI(aI,{})},_=function(aI){return function(WI){var GI;if(!n(WI)||(GI=sI(WI)).type!==aI)throw iI("Incompatible receiver, "+aI+" required");return GI}};if(o||r.state){var gI=r.state||(r.state=new lI),M=a(gI.get),O=a(gI.has),dI=a(gI.set);CI=function(aI,WI){if(O(gI,aI))throw new iI(k);return WI.facade=aI,dI(gI,aI,WI),WI},sI=function(aI){return M(gI,aI)||{}},oI=function(aI){return O(gI,aI)}}else{var eI=H("state");II[eI]=!0,CI=function(aI,WI){if(R(aI,eI))throw new iI(k);return WI.facade=aI,B(aI,eI,WI),WI},sI=function(aI){return R(aI,eI)?aI[eI]:{}},oI=function(aI){return R(aI,eI)}}e.exports={set:CI,get:sI,has:oI,enforce:E,getterFor:_}},(e,A,l)=>{var o=l(7),t=l(23),a=l(52),n=o.WeakMap;e.exports=t(n)&&/native code/.test(a(n))},(e,A,l)=>{var o=l(36),t=l(42),a=o("keys");e.exports=function(n){return a[n]||(a[n]=t(n))}},e=>{e.exports={}},(e,A,l)=>{var o=l(40),t=l(58),a=l(8),n=l(46);e.exports=function(B,R,r){for(var H=t(R),II=n.f,k=a.f,iI=0;iI<H.length;iI++){var lI=H[iI];!o(B,lI)&&!(r&&o(r,lI))&&II(B,lI,k(R,lI))}}},(e,A,l)=>{var o=l(25),t=l(17),a=l(59),n=l(68),B=l(48),R=t([].concat);e.exports=o("Reflect","ownKeys")||function(H){var II=a.f(B(H)),k=n.f;return k?R(II,k(H)):II}},(e,A,l)=>{var o=l(60),t=l(67),a=t.concat("length","prototype");A.f=Object.getOwnPropertyNames||function(B){return o(B,a)}},(e,A,l)=>{var o=l(17),t=l(40),a=l(15),n=l(61).indexOf,B=l(56),R=o([].push);e.exports=function(r,H){var II=a(r),k=0,iI=[],lI;for(lI in II)!t(B,lI)&&t(II,lI)&&R(iI,lI);for(;H.length>k;)t(II,lI=H[k++])&&(~n(iI,lI)||R(iI,lI));return iI}},(e,A,l)=>{var o=l(15),t=l(62),a=l(65),n=function(B){return function(R,r,H){var II=o(R),k=a(II),iI=t(H,k),lI;if(B&&r!=r){for(;k>iI;)if(lI=II[iI++],lI!=lI)return!0}else for(;k>iI;iI++)if((B||iI in II)&&II[iI]===r)return B||iI||0;return!B&&-1}};e.exports={includes:n(!0),indexOf:n(!1)}},(e,A,l)=>{var o=l(63),t=Math.max,a=Math.min;e.exports=function(n,B){var R=o(n);return R<0?t(R+B,0):a(R,B)}},(e,A,l)=>{var o=l(64);e.exports=function(t){var a=+t;return a!==a||a===0?0:o(a)}},e=>{var A=Math.ceil,l=Math.floor;e.exports=Math.trunc||function(t){var a=+t;return(a>0?l:A)(a)}},(e,A,l)=>{var o=l(66);e.exports=function(t){return o(t.length)}},(e,A,l)=>{var o=l(63),t=Math.min;e.exports=function(a){return a>0?t(o(a),9007199254740991):0}},e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},(e,A)=>{A.f=Object.getOwnPropertySymbols},(e,A,l)=>{var o=l(10),t=l(23),a=/#|\.prototype\./,n=function(II,k){var iI=R[B(II)];return iI==H?!0:iI==r?!1:t(k)?o(k):!!k},B=n.normalize=function(II){return String(II).replace(a,".").toLowerCase()},R=n.data={},r=n.NATIVE="N",H=n.POLYFILL="P";e.exports=n},(e,A,l)=>{var o=l(35),t=l(71),a=l(46).f,n=o("unscopables"),B=Array.prototype;B[n]==null&&a(B,n,{configurable:!0,value:t(null)}),e.exports=function(R){B[n][R]=!0}},(e,A,l)=>{var o=l(48),t=l(72),a=l(67),n=l(56),B=l(74),R=l(44),r=l(55),H=">",II="<",k="prototype",iI="script",lI=r("IE_PROTO"),CI=function(){},sI=function(M){return II+iI+H+M+II+"/"+iI+H},oI=function(M){M.write(sI("")),M.close();var O=M.parentWindow.Object;return M=null,O},E=function(){var M=R("iframe"),O="java"+iI+":",dI;return M.style.display="none",B.appendChild(M),M.src=String(O),dI=M.contentWindow.document,dI.open(),dI.write(sI("document.F=Object")),dI.close(),dI.F},_,gI=function(){try{_=new ActiveXObject("htmlfile")}catch{}gI=typeof document<"u"?document.domain&&_?oI(_):E():oI(_);for(var M=a.length;M--;)delete gI[k][a[M]];return gI()};n[lI]=!0,e.exports=Object.create||function(O,dI){var eI;return O!==null?(CI[k]=o(O),eI=new CI,CI[k]=null,eI[lI]=O):eI=gI(),dI===void 0?eI:t.f(eI,dI)}},(e,A,l)=>{var o=l(9),t=l(47),a=l(46),n=l(48),B=l(15),R=l(73);A.f=o&&!t?Object.defineProperties:function(H,II){n(H);for(var k=B(II),iI=R(II),lI=iI.length,CI=0,sI;lI>CI;)a.f(H,sI=iI[CI++],k[sI]);return H}},(e,A,l)=>{var o=l(60),t=l(67);e.exports=Object.keys||function(n){return o(n,t)}},(e,A,l)=>{var o=l(25);e.exports=o("document","documentElement")},(e,A,l)=>{var o=l(7),t=l(17);e.exports=function(a,n){return t(o[a].prototype[n])}},(e,A,l)=>{l(77)},(e,A,l)=>{var o=l(78),t=l(65),a=l(63),n=o.aTypedArray,B=o.exportTypedArrayMethod;B("at",function(r){var H=n(this),II=t(H),k=a(r),iI=k>=0?k:II+k;return iI<0||iI>=II?void 0:H[iI]})},(e,A,l)=>{var o=l(79),t=l(9),a=l(7),n=l(23),B=l(22),R=l(40),r=l(80),H=l(33),II=l(45),k=l(49),iI=l(46).f,lI=l(26),CI=l(82),sI=l(84),oI=l(35),E=l(42),_=l(53),gI=_.enforce,M=_.get,O=a.Int8Array,dI=O&&O.prototype,eI=a.Uint8ClampedArray,aI=eI&&eI.prototype,WI=O&&CI(O),GI=dI&&CI(dI),HI=Object.prototype,MI=a.TypeError,KI=oI("toStringTag"),DI=E("TYPED_ARRAY_TAG"),NI="TypedArrayConstructor",yI=o&&!!sI&&r(a.opera)!=="Opera",VI=!1,hI,wI,pI,xI={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},PI={BigInt64Array:8,BigUint64Array:8},XI=function(nI){if(!B(nI))return!1;var uI=r(nI);return uI==="DataView"||R(xI,uI)||R(PI,uI)},tI=function(bI){var nI=CI(bI);if(B(nI)){var uI=M(nI);return uI&&R(uI,NI)?uI[NI]:tI(nI)}},mI=function(bI){if(!B(bI))return!1;var nI=r(bI);return R(xI,nI)||R(PI,nI)},YI=function(bI){if(mI(bI))return bI;throw MI("Target is not a typed array")},BI=function(bI){if(n(bI)&&(!sI||lI(WI,bI)))return bI;throw MI(H(bI)+" is not a typed array constructor")},AI=function(bI,nI,uI,rI){if(t){if(uI)for(var FI in xI){var kI=a[FI];if(kI&&R(kI.prototype,bI))try{delete kI.prototype[bI]}catch{try{kI.prototype[bI]=nI}catch{}}}(!GI[bI]||uI)&&k(GI,bI,uI?nI:yI&&dI[bI]||nI,rI)}},cI=function(bI,nI,uI){var rI,FI;if(t){if(sI){if(uI){for(rI in xI)if(FI=a[rI],FI&&R(FI,bI))try{delete FI[bI]}catch{}}if(!WI[bI]||uI)try{return k(WI,bI,uI?nI:yI&&WI[bI]||nI)}catch{}else return}for(rI in xI)FI=a[rI],FI&&(!FI[bI]||uI)&&k(FI,bI,nI)}};for(hI in xI)wI=a[hI],pI=wI&&wI.prototype,pI?gI(pI)[NI]=wI:yI=!1;for(hI in PI)wI=a[hI],pI=wI&&wI.prototype,pI&&(gI(pI)[NI]=wI);if((!yI||!n(WI)||WI===Function.prototype)&&(WI=function(){throw MI("Incorrect invocation")},yI))for(hI in xI)a[hI]&&sI(a[hI],WI);if((!yI||!GI||GI===HI)&&(GI=WI.prototype,yI))for(hI in xI)a[hI]&&sI(a[hI].prototype,GI);if(yI&&CI(aI)!==GI&&sI(aI,GI),t&&!R(GI,KI)){VI=!0,iI(GI,KI,{get:function(){return B(this)?this[DI]:void 0}});for(hI in xI)a[hI]&&II(a[hI],DI,hI)}e.exports={NATIVE_ARRAY_BUFFER_VIEWS:yI,TYPED_ARRAY_TAG:VI&&DI,aTypedArray:YI,aTypedArrayConstructor:BI,exportTypedArrayMethod:AI,exportTypedArrayStaticMethod:cI,getTypedArrayConstructor:tI,isView:XI,isTypedArray:mI,TypedArray:WI,TypedArrayPrototype:GI}},e=>{e.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},(e,A,l)=>{var o=l(81),t=l(23),a=l(18),n=l(35),B=n("toStringTag"),R=Object,r=a(function(){return arguments}())=="Arguments",H=function(II,k){try{return II[k]}catch{}};e.exports=o?a:function(II){var k,iI,lI;return II===void 0?"Undefined":II===null?"Null":typeof(iI=H(k=R(II),B))=="string"?iI:r?a(k):(lI=a(k))=="Object"&&t(k.callee)?"Arguments":lI}},(e,A,l)=>{var o=l(35),t=o("toStringTag"),a={};a[t]="z",e.exports=String(a)==="[object z]"},(e,A,l)=>{var o=l(40),t=l(23),a=l(41),n=l(55),B=l(83),R=n("IE_PROTO"),r=Object,H=r.prototype;e.exports=B?r.getPrototypeOf:function(II){var k=a(II);if(o(k,R))return k[R];var iI=k.constructor;return t(iI)&&k instanceof iI?iI.prototype:k instanceof r?H:null}},(e,A,l)=>{var o=l(10);e.exports=!o(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})},(e,A,l)=>{var o=l(17),t=l(48),a=l(85);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var n=!1,B={},R;try{R=o(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),R(B,[]),n=B instanceof Array}catch{}return function(H,II){return t(H),a(II),n?R(H,II):H.__proto__=II,H}}():void 0)},(e,A,l)=>{var o=l(23),t=String,a=TypeError;e.exports=function(n){if(typeof n=="object"||o(n))return n;throw a("Can't set "+t(n)+" as a prototype")}},(e,A,l)=>{l(87),l(93),l(95),l(117),l(119);var o=l(128);e.exports=o.structuredClone},(e,A,l)=>{var o=l(15),t=l(70),a=l(88),n=l(53),B=l(46).f,R=l(89),r=l(37),H=l(9),II="Array Iterator",k=n.set,iI=n.getterFor(II);e.exports=R(Array,"Array",function(CI,sI){k(this,{type:II,target:o(CI),index:0,kind:sI})},function(){var CI=iI(this),sI=CI.target,oI=CI.kind,E=CI.index++;return!sI||E>=sI.length?(CI.target=void 0,{value:void 0,done:!0}):oI=="keys"?{value:E,done:!1}:oI=="values"?{value:sI[E],done:!1}:{value:[E,sI[E]],done:!1}},"values");var lI=a.Arguments=a.Array;if(t("keys"),t("values"),t("entries"),!r&&H&&lI.name!=="values")try{B(lI,"name",{value:"values"})}catch{}},e=>{e.exports={}},(e,A,l)=>{var o=l(6),t=l(11),a=l(37),n=l(51),B=l(23),R=l(90),r=l(82),H=l(84),II=l(92),k=l(45),iI=l(49),lI=l(35),CI=l(88),sI=l(91),oI=n.PROPER,E=n.CONFIGURABLE,_=sI.IteratorPrototype,gI=sI.BUGGY_SAFARI_ITERATORS,M=lI("iterator"),O="keys",dI="values",eI="entries",aI=function(){return this};e.exports=function(WI,GI,HI,MI,KI,DI,NI){R(HI,GI,MI);var yI=function(YI){if(YI===KI&&xI)return xI;if(!gI&&YI in wI)return wI[YI];switch(YI){case O:return function(){return new HI(this,YI)};case dI:return function(){return new HI(this,YI)};case eI:return function(){return new HI(this,YI)}}return function(){return new HI(this)}},VI=GI+" Iterator",hI=!1,wI=WI.prototype,pI=wI[M]||wI["@@iterator"]||KI&&wI[KI],xI=!gI&&pI||yI(KI),PI=GI=="Array"&&wI.entries||pI,XI,tI,mI;if(PI&&(XI=r(PI.call(new WI)),XI!==Object.prototype&&XI.next&&(!a&&r(XI)!==_&&(H?H(XI,_):B(XI[M])||iI(XI,M,aI)),II(XI,VI,!0,!0),a&&(CI[VI]=aI))),oI&&KI==dI&&pI&&pI.name!==dI&&(!a&&E?k(wI,"name",dI):(hI=!0,xI=function(){return t(pI,this)})),KI)if(tI={values:yI(dI),keys:DI?xI:yI(O),entries:yI(eI)},NI)for(mI in tI)(gI||hI||!(mI in wI))&&iI(wI,mI,tI[mI]);else o({target:GI,proto:!0,forced:gI||hI},tI);return(!a||NI)&&wI[M]!==xI&&iI(wI,M,xI,{name:KI}),CI[GI]=xI,tI}},(e,A,l)=>{var o=l(91).IteratorPrototype,t=l(71),a=l(14),n=l(92),B=l(88),R=function(){return this};e.exports=function(r,H,II,k){var iI=H+" Iterator";return r.prototype=t(o,{next:a(+!k,II)}),n(r,iI,!1,!0),B[iI]=R,r}},(e,A,l)=>{var o=l(10),t=l(23),a=l(71),n=l(82),B=l(49),R=l(35),r=l(37),H=R("iterator"),II=!1,k,iI,lI;[].keys&&(lI=[].keys(),"next"in lI?(iI=n(n(lI)),iI!==Object.prototype&&(k=iI)):II=!0);var CI=k==null||o(function(){var sI={};return k[H].call(sI)!==sI});CI?k={}:r&&(k=a(k)),t(k[H])||B(k,H,function(){return this}),e.exports={IteratorPrototype:k,BUGGY_SAFARI_ITERATORS:II}},(e,A,l)=>{var o=l(46).f,t=l(40),a=l(35),n=a("toStringTag");e.exports=function(B,R,r){B&&!r&&(B=B.prototype),B&&!t(B,n)&&o(B,n,{configurable:!0,value:R})}},(e,A,l)=>{var o=l(81),t=l(49),a=l(94);o||t(Object.prototype,"toString",a,{unsafe:!0})},(e,A,l)=>{var o=l(81),t=l(80);e.exports=o?{}.toString:function(){return"[object "+t(this)+"]"}},(e,A,l)=>{l(96)},(e,A,l)=>{var o=l(97),t=l(114);o("Map",function(a){return function(){return a(this,arguments.length?arguments[0]:void 0)}},t)},(e,A,l)=>{var o=l(6),t=l(7),a=l(17),n=l(69),B=l(49),R=l(98),r=l(105),H=l(111),II=l(23),k=l(22),iI=l(10),lI=l(112),CI=l(92),sI=l(113);e.exports=function(oI,E,_){var gI=oI.indexOf("Map")!==-1,M=oI.indexOf("Weak")!==-1,O=gI?"set":"add",dI=t[oI],eI=dI&&dI.prototype,aI=dI,WI={},GI=function(VI){var hI=a(eI[VI]);B(eI,VI,VI=="add"?function(pI){return hI(this,pI===0?0:pI),this}:VI=="delete"?function(wI){return M&&!k(wI)?!1:hI(this,wI===0?0:wI)}:VI=="get"?function(pI){return M&&!k(pI)?void 0:hI(this,pI===0?0:pI)}:VI=="has"?function(pI){return M&&!k(pI)?!1:hI(this,pI===0?0:pI)}:function(pI,xI){return hI(this,pI===0?0:pI,xI),this})},HI=n(oI,!II(dI)||!(M||eI.forEach&&!iI(function(){new dI().entries().next()})));if(HI)aI=_.getConstructor(E,oI,gI,O),R.enable();else if(n(oI,!0)){var MI=new aI,KI=MI[O](M?{}:-0,1)!=MI,DI=iI(function(){MI.has(1)}),NI=lI(function(VI){new dI(VI)}),yI=!M&&iI(function(){for(var VI=new dI,hI=5;hI--;)VI[O](hI,hI);return!VI.has(-0)});NI||(aI=E(function(VI,hI){H(VI,eI);var wI=sI(new dI,VI,aI);return hI!=null&&r(hI,wI[O],{that:wI,AS_ENTRIES:gI}),wI}),aI.prototype=eI,eI.constructor=aI),(DI||yI)&&(GI("delete"),GI("has"),gI&&GI("get")),(yI||KI)&&GI(O),M&&eI.clear&&delete eI.clear}return WI[oI]=aI,o({global:!0,constructor:!0,forced:aI!=dI},WI),CI(aI,oI),M||_.setStrong(aI,oI,gI),aI}},(e,A,l)=>{var o=l(6),t=l(17),a=l(56),n=l(22),B=l(40),R=l(46).f,r=l(59),H=l(99),II=l(102),k=l(42),iI=l(104),lI=!1,CI=k("meta"),sI=0,oI=function(dI){R(dI,CI,{value:{objectID:"O"+sI++,weakData:{}}})},E=function(dI,eI){if(!n(dI))return typeof dI=="symbol"?dI:(typeof dI=="string"?"S":"P")+dI;if(!B(dI,CI)){if(!II(dI))return"F";if(!eI)return"E";oI(dI)}return dI[CI].objectID},_=function(dI,eI){if(!B(dI,CI)){if(!II(dI))return!0;if(!eI)return!1;oI(dI)}return dI[CI].weakData},gI=function(dI){return iI&&lI&&II(dI)&&!B(dI,CI)&&oI(dI),dI},M=function(){O.enable=function(){},lI=!0;var dI=r.f,eI=t([].splice),aI={};aI[CI]=1,dI(aI).length&&(r.f=function(WI){for(var GI=dI(WI),HI=0,MI=GI.length;HI<MI;HI++)if(GI[HI]===CI){eI(GI,HI,1);break}return GI},o({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:H.f}))},O=e.exports={enable:M,fastKey:E,getWeakData:_,onFreeze:gI};a[CI]=!0},(e,A,l)=>{var o=l(18),t=l(15),a=l(59).f,n=l(100),B=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],R=function(r){try{return a(r)}catch{return n(B)}};e.exports.f=function(H){return B&&o(H)=="Window"?R(H):a(t(H))}},(e,A,l)=>{var o=l(62),t=l(65),a=l(101),n=Array,B=Math.max;e.exports=function(R,r,H){for(var II=t(R),k=o(r,II),iI=o(H===void 0?II:H,II),lI=n(B(iI-k,0)),CI=0;k<iI;k++,CI++)a(lI,CI,R[k]);return lI.length=CI,lI}},(e,A,l)=>{var o=l(20),t=l(46),a=l(14);e.exports=function(n,B,R){var r=o(B);r in n?t.f(n,r,a(0,R)):n[r]=R}},(e,A,l)=>{var o=l(10),t=l(22),a=l(18),n=l(103),B=Object.isExtensible,R=o(function(){});e.exports=R||n?function(H){return!t(H)||n&&a(H)=="ArrayBuffer"?!1:B?B(H):!0}:B},(e,A,l)=>{var o=l(10);e.exports=o(function(){if(typeof ArrayBuffer=="function"){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})},(e,A,l)=>{var o=l(10);e.exports=!o(function(){return Object.isExtensible(Object.preventExtensions({}))})},(e,A,l)=>{var o=l(106),t=l(11),a=l(48),n=l(33),B=l(107),R=l(65),r=l(26),H=l(108),II=l(109),k=l(110),iI=TypeError,lI=function(sI,oI){this.stopped=sI,this.result=oI},CI=lI.prototype;e.exports=function(sI,oI,E){var _=E&&E.that,gI=!!(E&&E.AS_ENTRIES),M=!!(E&&E.IS_RECORD),O=!!(E&&E.IS_ITERATOR),dI=!!(E&&E.INTERRUPTED),eI=o(oI,_),aI,WI,GI,HI,MI,KI,DI,NI=function(VI){return aI&&k(aI,"normal",VI),new lI(!0,VI)},yI=function(VI){return gI?(a(VI),dI?eI(VI[0],VI[1],NI):eI(VI[0],VI[1])):dI?eI(VI,NI):eI(VI)};if(M)aI=sI.iterator;else if(O)aI=sI;else{if(WI=II(sI),!WI)throw iI(n(sI)+" is not iterable");if(B(WI)){for(GI=0,HI=R(sI);HI>GI;GI++)if(MI=yI(sI[GI]),MI&&r(CI,MI))return MI;return new lI(!1)}aI=H(sI,WI)}for(KI=M?sI.next:aI.next;!(DI=t(KI,aI)).done;){try{MI=yI(DI.value)}catch(VI){k(aI,"throw",VI)}if(typeof MI=="object"&&MI&&r(CI,MI))return MI}return new lI(!1)}},(e,A,l)=>{var o=l(17),t=l(32),a=l(12),n=o(o.bind);e.exports=function(B,R){return t(B),R===void 0?B:a?n(B,R):function(){return B.apply(R,arguments)}}},(e,A,l)=>{var o=l(35),t=l(88),a=o("iterator"),n=Array.prototype;e.exports=function(B){return B!==void 0&&(t.Array===B||n[a]===B)}},(e,A,l)=>{var o=l(11),t=l(32),a=l(48),n=l(33),B=l(109),R=TypeError;e.exports=function(r,H){var II=arguments.length<2?B(r):H;if(t(II))return a(o(II,r));throw R(n(r)+" is not iterable")}},(e,A,l)=>{var o=l(80),t=l(31),a=l(88),n=l(35),B=n("iterator");e.exports=function(R){if(R!=null)return t(R,B)||t(R,"@@iterator")||a[o(R)]}},(e,A,l)=>{var o=l(11),t=l(48),a=l(31);e.exports=function(n,B,R){var r,H;t(n);try{if(r=a(n,"return"),!r){if(B==="throw")throw R;return R}r=o(r,n)}catch(II){H=!0,r=II}if(B==="throw")throw R;if(H)throw r;return t(r),R}},(e,A,l)=>{var o=l(26),t=TypeError;e.exports=function(a,n){if(o(n,a))return a;throw t("Incorrect invocation")}},(e,A,l)=>{var o=l(35),t=o("iterator"),a=!1;try{var n=0,B={next:function(){return{done:!!n++}},return:function(){a=!0}};B[t]=function(){return this},Array.from(B,function(){throw 2})}catch{}e.exports=function(R,r){if(!r&&!a)return!1;var H=!1;try{var II={};II[t]=function(){return{next:function(){return{done:H=!0}}}},R(II)}catch{}return H}},(e,A,l)=>{var o=l(23),t=l(22),a=l(84);e.exports=function(n,B,R){var r,H;return a&&o(r=B.constructor)&&r!==R&&t(H=r.prototype)&&H!==R.prototype&&a(n,H),n}},(e,A,l)=>{var o=l(46).f,t=l(71),a=l(115),n=l(106),B=l(111),R=l(105),r=l(89),H=l(116),II=l(9),k=l(98).fastKey,iI=l(53),lI=iI.set,CI=iI.getterFor;e.exports={getConstructor:function(sI,oI,E,_){var gI=sI(function(aI,WI){B(aI,M),lI(aI,{type:oI,index:t(null),first:void 0,last:void 0,size:0}),II||(aI.size=0),WI!=null&&R(WI,aI[_],{that:aI,AS_ENTRIES:E})}),M=gI.prototype,O=CI(oI),dI=function(aI,WI,GI){var HI=O(aI),MI=eI(aI,WI),KI,DI;return MI?MI.value=GI:(HI.last=MI={index:DI=k(WI,!0),key:WI,value:GI,previous:KI=HI.last,next:void 0,removed:!1},HI.first||(HI.first=MI),KI&&(KI.next=MI),II?HI.size++:aI.size++,DI!=="F"&&(HI.index[DI]=MI)),aI},eI=function(aI,WI){var GI=O(aI),HI=k(WI),MI;if(HI!=="F")return GI.index[HI];for(MI=GI.first;MI;MI=MI.next)if(MI.key==WI)return MI};return a(M,{clear:function(){for(var WI=this,GI=O(WI),HI=GI.index,MI=GI.first;MI;)MI.removed=!0,MI.previous&&(MI.previous=MI.previous.next=void 0),delete HI[MI.index],MI=MI.next;GI.first=GI.last=void 0,II?GI.size=0:WI.size=0},delete:function(aI){var WI=this,GI=O(WI),HI=eI(WI,aI);if(HI){var MI=HI.next,KI=HI.previous;delete GI.index[HI.index],HI.removed=!0,KI&&(KI.next=MI),MI&&(MI.previous=KI),GI.first==HI&&(GI.first=MI),GI.last==HI&&(GI.last=KI),II?GI.size--:WI.size--}return!!HI},forEach:function(WI){for(var GI=O(this),HI=n(WI,arguments.length>1?arguments[1]:void 0),MI;MI=MI?MI.next:GI.first;)for(HI(MI.value,MI.key,this);MI&&MI.removed;)MI=MI.previous},has:function(WI){return!!eI(this,WI)}}),a(M,E?{get:function(WI){var GI=eI(this,WI);return GI&&GI.value},set:function(WI,GI){return dI(this,WI===0?0:WI,GI)}}:{add:function(WI){return dI(this,WI=WI===0?0:WI,WI)}}),II&&o(M,"size",{get:function(){return O(this).size}}),gI},setStrong:function(sI,oI,E){var _=oI+" Iterator",gI=CI(oI),M=CI(_);r(sI,oI,function(O,dI){lI(this,{type:_,target:O,state:gI(O),kind:dI,last:void 0})},function(){for(var O=M(this),dI=O.kind,eI=O.last;eI&&eI.removed;)eI=eI.previous;return!O.target||!(O.last=eI=eI?eI.next:O.state.first)?(O.target=void 0,{value:void 0,done:!0}):dI=="keys"?{value:eI.key,done:!1}:dI=="values"?{value:eI.value,done:!1}:{value:[eI.key,eI.value],done:!1}},E?"entries":"values",!E,!0),H(oI)}}},(e,A,l)=>{var o=l(49);e.exports=function(t,a,n){for(var B in a)o(t,B,a[B],n);return t}},(e,A,l)=>{var o=l(25),t=l(46),a=l(35),n=l(9),B=a("species");e.exports=function(R){var r=o(R),H=t.f;n&&r&&!r[B]&&H(r,B,{configurable:!0,get:function(){return this}})}},(e,A,l)=>{l(118)},(e,A,l)=>{var o=l(97),t=l(114);o("Set",function(a){return function(){return a(this,arguments.length?arguments[0]:void 0)}},t)},(e,A,l)=>{var o=l(37),t=l(6),a=l(7),n=l(25),B=l(17),R=l(10),r=l(42),H=l(23),II=l(120),k=l(22),iI=l(24),lI=l(105),CI=l(48),sI=l(80),oI=l(40),E=l(101),_=l(45),gI=l(65),M=l(121),O=l(122),dI=l(124),eI=l(29),aI=l(125),WI=l(126),GI=l(127),HI=a.Object,MI=a.Date,KI=a.Error,DI=a.EvalError,NI=a.RangeError,yI=a.ReferenceError,VI=a.SyntaxError,hI=a.TypeError,wI=a.URIError,pI=a.PerformanceMark,xI=a.WebAssembly,PI=xI&&xI.CompileError||KI,XI=xI&&xI.LinkError||KI,tI=xI&&xI.RuntimeError||KI,mI=n("DOMException"),YI=n("Set"),BI=n("Map"),AI=BI.prototype,cI=B(AI.has),bI=B(AI.get),nI=B(AI.set),uI=B(YI.prototype.add),rI=n("Object","keys"),FI=B([].push),kI=B((!0).valueOf),TI=B(1 .valueOf),QI=B("".valueOf),fI=B(MI.prototype.getTime),OI=r("structuredClone"),qI="DataCloneError",gg="Transferring",lg=function(Ig){return!R(function(){var og=new a.Set([7]),wg=Ig(og),UI=Ig(HI(7));return wg==og||!wg.has(7)||typeof UI!="object"||UI!=7})&&Ig},sg=function(Ig,og){return!R(function(){var wg=new og,UI=Ig({a:wg,b:wg});return!(UI&&UI.a===UI.b&&UI.a instanceof og&&UI.a.stack===wg.stack)})},tg=function(Ig){return!R(function(){var og=Ig(new a.AggregateError([1],OI,{cause:3}));return og.name!="AggregateError"||og.errors[0]!=1||og.message!=OI||og.cause!=3})},ig=a.structuredClone,Xg=o||!sg(ig,KI)||!sg(ig,mI)||!tg(ig),rg=!ig&&lg(function(Ig){return new pI(OI,{detail:Ig}).detail}),mg=lg(ig)||rg,eg=function(Ig){throw new mI("Uncloneable type: "+Ig,qI)},vI=function(Ig,og){throw new mI((og||"Cloning")+" of "+Ig+" cannot be properly polyfilled in this engine",qI)},Cg=function(Ig,og){if(iI(Ig)&&eg("Symbol"),!k(Ig))return Ig;if(og){if(cI(og,Ig))return bI(og,Ig)}else og=new BI;var wg=sI(Ig),UI=!1,JI,LI,$I,bg,Wg,EI,jI,Ag,Zg,hg;switch(wg){case"Array":$I=[],UI=!0;break;case"Object":$I={},UI=!0;break;case"Map":$I=new BI,UI=!0;break;case"Set":$I=new YI,UI=!0;break;case"RegExp":$I=new RegExp(Ig.source,O(Ig));break;case"Error":switch(LI=Ig.name,LI){case"AggregateError":$I=n("AggregateError")([]);break;case"EvalError":$I=DI();break;case"RangeError":$I=NI();break;case"ReferenceError":$I=yI();break;case"SyntaxError":$I=VI();break;case"TypeError":$I=hI();break;case"URIError":$I=wI();break;case"CompileError":$I=PI();break;case"LinkError":$I=XI();break;case"RuntimeError":$I=tI();break;default:$I=KI()}UI=!0;break;case"DOMException":$I=new mI(Ig.message,Ig.name),UI=!0;break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":JI=a[wg],k(JI)||vI(wg),$I=new JI(Cg(Ig.buffer,og),Ig.byteOffset,wg==="DataView"?Ig.byteLength:Ig.length);break;case"DOMQuad":try{$I=new DOMQuad(Cg(Ig.p1,og),Cg(Ig.p2,og),Cg(Ig.p3,og),Cg(Ig.p4,og))}catch{mg?$I=mg(Ig):vI(wg)}break;case"FileList":if(JI=a.DataTransfer,II(JI)){for(bg=new JI,Wg=0,EI=gI(Ig);Wg<EI;Wg++)bg.items.add(Cg(Ig[Wg],og));$I=bg.files}else mg?$I=mg(Ig):vI(wg);break;case"ImageData":try{$I=new ImageData(Cg(Ig.data,og),Ig.width,Ig.height,{colorSpace:Ig.colorSpace})}catch{mg?$I=mg(Ig):vI(wg)}break;default:if(mg)$I=mg(Ig);else switch(wg){case"BigInt":$I=HI(Ig.valueOf());break;case"Boolean":$I=HI(kI(Ig));break;case"Number":$I=HI(TI(Ig));break;case"String":$I=HI(QI(Ig));break;case"Date":$I=new MI(fI(Ig));break;case"ArrayBuffer":JI=a.DataView,!JI&&typeof Ig.slice!="function"&&vI(wg);try{if(typeof Ig.slice=="function")$I=Ig.slice(0);else for(EI=Ig.byteLength,$I=new ArrayBuffer(EI),Zg=new JI(Ig),hg=new JI($I),Wg=0;Wg<EI;Wg++)hg.setUint8(Wg,Zg.getUint8(Wg))}catch{throw new mI("ArrayBuffer is detached",qI)}break;case"SharedArrayBuffer":$I=Ig;break;case"Blob":try{$I=Ig.slice(0,Ig.size,Ig.type)}catch{vI(wg)}break;case"DOMPoint":case"DOMPointReadOnly":JI=a[wg];try{$I=JI.fromPoint?JI.fromPoint(Ig):new JI(Ig.x,Ig.y,Ig.z,Ig.w)}catch{vI(wg)}break;case"DOMRect":case"DOMRectReadOnly":JI=a[wg];try{$I=JI.fromRect?JI.fromRect(Ig):new JI(Ig.x,Ig.y,Ig.width,Ig.height)}catch{vI(wg)}break;case"DOMMatrix":case"DOMMatrixReadOnly":JI=a[wg];try{$I=JI.fromMatrix?JI.fromMatrix(Ig):new JI(Ig)}catch{vI(wg)}break;case"AudioData":case"VideoFrame":H(Ig.clone)||vI(wg);try{$I=Ig.clone()}catch{eg(wg)}break;case"File":try{$I=new File([Ig],Ig.name,Ig)}catch{vI(wg)}break;case"CryptoKey":case"GPUCompilationMessage":case"GPUCompilationInfo":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":vI(wg);default:eg(wg)}}if(nI(og,Ig,$I),UI)switch(wg){case"Array":case"Object":for(jI=rI(Ig),Wg=0,EI=gI(jI);Wg<EI;Wg++)Ag=jI[Wg],E($I,Ag,Cg(Ig[Ag],og));break;case"Map":Ig.forEach(function(Vg,ug){nI($I,Cg(ug,og),Cg(Vg,og))});break;case"Set":Ig.forEach(function(Vg){uI($I,Cg(Vg,og))});break;case"Error":_($I,"message",Cg(Ig.message,og)),oI(Ig,"cause")&&_($I,"cause",Cg(Ig.cause,og)),LI=="AggregateError"&&($I.errors=Cg(Ig.errors,og));case"DOMException":dI&&_($I,"stack",Cg(Ig.stack,og))}return $I},Gg=ig&&!R(function(){if(WI&&eI>92||GI&&eI>94||aI&&eI>97)return!1;var Ig=new ArrayBuffer(8),og=ig(Ig,{transfer:[Ig]});return Ig.byteLength!=0||og.byteLength!=8}),Kg=function(Ig,og){if(!k(Ig))throw hI("Transfer option cannot be converted to a sequence");var wg=[];lI(Ig,function(Zg){FI(wg,CI(Zg))});var UI=0,JI=gI(wg),LI,$I,bg,Wg,EI,jI,Ag;if(Gg)for(Wg=ig(wg,{transfer:wg});UI<JI;)nI(og,wg[UI],Wg[UI++]);else for(;UI<JI;){if(LI=wg[UI++],cI(og,LI))throw new mI("Duplicate transferable",qI);switch($I=sI(LI),$I){case"ImageBitmap":bg=a.OffscreenCanvas,II(bg)||vI($I,gg);try{jI=new bg(LI.width,LI.height),Ag=jI.getContext("bitmaprenderer"),Ag.transferFromImageBitmap(LI),EI=jI.transferToImageBitmap()}catch{}break;case"AudioData":case"VideoFrame":(!H(LI.clone)||!H(LI.close))&&vI($I,gg);try{EI=LI.clone(),LI.close()}catch{}break;case"ArrayBuffer":case"MessagePort":case"OffscreenCanvas":case"ReadableStream":case"TransformStream":case"WritableStream":vI($I,gg)}if(EI===void 0)throw new mI("This object cannot be transferred: "+$I,qI);nI(og,LI,EI)}};t({global:!0,enumerable:!0,sham:!Gg,forced:Xg},{structuredClone:function(og){var wg=M(arguments.length,1)>1&&arguments[1]!=null?CI(arguments[1]):void 0,UI=wg?wg.transfer:void 0,JI;return UI!==void 0&&(JI=new BI,Kg(UI,JI)),Cg(og,JI)}})},(e,A,l)=>{var o=l(17),t=l(10),a=l(23),n=l(80),B=l(25),R=l(52),r=function(){},H=[],II=B("Reflect","construct"),k=/^\s*(?:class|function)\b/,iI=o(k.exec),lI=!k.exec(r),CI=function(E){if(!a(E))return!1;try{return II(r,H,E),!0}catch{return!1}},sI=function(E){if(!a(E))return!1;switch(n(E)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return lI||!!iI(k,R(E))}catch{return!0}};sI.sham=!0,e.exports=!II||t(function(){var oI;return CI(CI.call)||!CI(Object)||!CI(function(){oI=!0})||oI})?sI:CI},e=>{var A=TypeError;e.exports=function(l,o){if(l<o)throw A("Not enough arguments");return l}},(e,A,l)=>{var o=l(11),t=l(40),a=l(26),n=l(123),B=RegExp.prototype;e.exports=function(R){var r=R.flags;return r===void 0&&!("flags"in B)&&!t(R,"flags")&&a(B,R)?o(n,R):r}},(e,A,l)=>{var o=l(48);e.exports=function(){var t=o(this),a="";return t.hasIndices&&(a+="d"),t.global&&(a+="g"),t.ignoreCase&&(a+="i"),t.multiline&&(a+="m"),t.dotAll&&(a+="s"),t.unicode&&(a+="u"),t.unicodeSets&&(a+="v"),t.sticky&&(a+="y"),a}},(e,A,l)=>{var o=l(10),t=l(14);e.exports=!o(function(){var a=Error("a");return"stack"in a?(Object.defineProperty(a,"stack",t(1,7)),a.stack!==7):!0})},(e,A,l)=>{var o=l(126),t=l(127);e.exports=!o&&!t&&typeof window=="object"&&typeof document=="object"},e=>{e.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},(e,A,l)=>{var o=l(18),t=l(7);e.exports=o(t.process)=="process"},(e,A,l)=>{var o=l(7);e.exports=o},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(130),_display_utils=__w_pdfjs_require__(133),_font_loader=__w_pdfjs_require__(136),_canvas=__w_pdfjs_require__(137),_worker_options=__w_pdfjs_require__(140),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(141),_metadata=__w_pdfjs_require__(142),_optional_content_config=__w_pdfjs_require__(143),_transport_stream=__w_pdfjs_require__(144),_xfa_text=__w_pdfjs_require__(145);function _classPrivateMethodInitSpec(e,A){_checkPrivateRedeclaration(e,A),A.add(e)}function _classPrivateMethodGet(e,A,l){if(!A.has(e))throw new TypeError("attempted to get private field on non-instance");return l}function _classPrivateFieldInitSpec(e,A,l){_checkPrivateRedeclaration(e,A),A.set(e,l)}function _checkPrivateRedeclaration(e,A){if(A.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet(e,A,l){var o=_classExtractFieldDescriptor(e,A,"set");return _classApplyDescriptorSet(e,o,l),l}function _classPrivateFieldGet(e,A){var l=_classExtractFieldDescriptor(e,A,"get");return _classApplyDescriptorGet(e,l)}function _classExtractFieldDescriptor(e,A,l){if(!A.has(e))throw new TypeError("attempted to "+l+" private field on non-instance");return A.get(e)}function _classStaticPrivateFieldSpecSet(e,A,l,o){return _classCheckPrivateStaticAccess(e,A),_classCheckPrivateStaticFieldDescriptor(l,"set"),_classApplyDescriptorSet(e,l,o),o}function _classApplyDescriptorSet(e,A,l){if(A.set)A.set.call(e,l);else{if(!A.writable)throw new TypeError("attempted to set read only private field");A.value=l}}function _classStaticPrivateFieldSpecGet(e,A,l){return _classCheckPrivateStaticAccess(e,A),_classCheckPrivateStaticFieldDescriptor(l,"get"),_classApplyDescriptorGet(e,l)}function _classCheckPrivateStaticFieldDescriptor(e,A){if(e===void 0)throw new TypeError("attempted to "+A+" private static field before its declaration")}function _classCheckPrivateStaticAccess(e,A){if(e!==A)throw new TypeError("Private static access of wrong provenance")}function _classApplyDescriptorGet(e,A){return A.get?A.get.call(e):A.value}const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:e,NodeCMapReaderFactory:A,NodeStandardFontDataFactory:l}=__w_pdfjs_require__(146);exports.DefaultCanvasFactory=DefaultCanvasFactory=e,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=A,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=l}let createPDFNetworkStream;function setPDFNetworkStreamFactory(e){createPDFNetworkStream=e}function getDocument(e){const A=new PDFDocumentLoadingTask;let l;if(typeof e=="string"||e instanceof URL)l={url:e};else if((0,_util.isArrayBuffer)(e))l={data:e};else if(e instanceof PDFDataRangeTransport)l={range:e};else{if(typeof e!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");l=e}const o=Object.create(null);let t=null,a=null;for(const B in l){const R=l[B];switch(B){case"url":if(typeof window<"u")try{o[B]=new URL(R,window.location).href;continue}catch(r){(0,_util.warn)(`Cannot create valid URL: "${r}".`)}else if(typeof R=="string"||R instanceof URL){o[B]=R.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":t=R;continue;case"worker":a=R;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&R instanceof Buffer)o[B]=new Uint8Array(R);else{if(R instanceof Uint8Array)break;if(typeof R=="string")o[B]=(0,_util.stringToBytes)(R);else if(typeof R=="object"&&R!==null&&!isNaN(R.length))o[B]=new Uint8Array(R);else if((0,_util.isArrayBuffer)(R))o[B]=new Uint8Array(R);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}o[B]=R}if(o.CMapReaderFactory=o.CMapReaderFactory||DefaultCMapReaderFactory,o.StandardFontDataFactory=o.StandardFontDataFactory||DefaultStandardFontDataFactory,o.ignoreErrors=o.stopAtErrors!==!0,o.fontExtraProperties=o.fontExtraProperties===!0,o.pdfBug=o.pdfBug===!0,o.enableXfa=o.enableXfa===!0,(!Number.isInteger(o.rangeChunkSize)||o.rangeChunkSize<1)&&(o.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof o.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(o.docBaseUrl))&&(o.docBaseUrl=null),(!Number.isInteger(o.maxImageSize)||o.maxImageSize<-1)&&(o.maxImageSize=-1),typeof o.cMapUrl!="string"&&(o.cMapUrl=null),typeof o.standardFontDataUrl!="string"&&(o.standardFontDataUrl=null),typeof o.useWorkerFetch!="boolean"&&(o.useWorkerFetch=o.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&o.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof o.isEvalSupported!="boolean"&&(o.isEvalSupported=!0),typeof o.disableFontFace!="boolean"&&(o.disableFontFace=_is_node.isNodeJS),typeof o.useSystemFonts!="boolean"&&(o.useSystemFonts=!_is_node.isNodeJS&&!o.disableFontFace),(typeof o.ownerDocument!="object"||o.ownerDocument===null)&&(o.ownerDocument=globalThis.document),typeof o.disableRange!="boolean"&&(o.disableRange=!1),typeof o.disableStream!="boolean"&&(o.disableStream=!1),typeof o.disableAutoFetch!="boolean"&&(o.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(o.verbosity),!a){const B={verbosity:o.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};a=B.port?PDFWorker.fromPort(B):new PDFWorker(B),A._worker=a}const n=A.docId;return a.promise.then(function(){if(A.destroyed)throw new Error("Loading aborted");const B=_fetchDocument(a,o,t,n),R=new Promise(function(r){let H;t?H=new _transport_stream.PDFDataTransportStream({length:o.length,initialData:o.initialData,progressiveDone:o.progressiveDone,contentDispositionFilename:o.contentDispositionFilename,disableRange:o.disableRange,disableStream:o.disableStream},t):o.data||(H=createPDFNetworkStream({url:o.url,length:o.length,httpHeaders:o.httpHeaders,withCredentials:o.withCredentials,rangeChunkSize:o.rangeChunkSize,disableRange:o.disableRange,disableStream:o.disableStream})),r(H)});return Promise.all([B,R]).then(function(r){let[H,II]=r;if(A.destroyed)throw new Error("Loading aborted");const k=new _message_handler.MessageHandler(n,H,a.port),iI=new WorkerTransport(k,A,II,o);A._transport=iI,k.send("Ready",null)})}).catch(A._capability.reject),A}async function _fetchDocument(e,A,l,o){if(e.destroyed)throw new Error("Worker was destroyed");l&&(A.length=l.length,A.initialData=l.initialData,A.progressiveDone=l.progressiveDone,A.contentDispositionFilename=l.contentDispositionFilename);const t=await e.messageHandler.sendWithPromise("GetDocRequest",{docId:o,apiVersion:"2.16.105",source:{data:A.data,url:A.url,password:A.password,disableAutoFetch:A.disableAutoFetch,rangeChunkSize:A.rangeChunkSize,length:A.length},maxImageSize:A.maxImageSize,disableFontFace:A.disableFontFace,docBaseUrl:A.docBaseUrl,ignoreErrors:A.ignoreErrors,isEvalSupported:A.isEvalSupported,fontExtraProperties:A.fontExtraProperties,enableXfa:A.enableXfa,useSystemFonts:A.useSystemFonts,cMapUrl:A.useWorkerFetch?A.cMapUrl:null,standardFontDataUrl:A.useWorkerFetch?A.standardFontDataUrl:null});if(A.data&&(A.data=null),e.destroyed)throw new Error("Worker was destroyed");return t}class PDFDocumentLoadingTask{constructor(){var A,l;this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${_classStaticPrivateFieldSpecSet(PDFDocumentLoadingTask,PDFDocumentLoadingTask,_docId,(A=_classStaticPrivateFieldSpecGet(PDFDocumentLoadingTask,PDFDocumentLoadingTask,_docId),l=A++,A)),l}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var A;this.destroyed=!0,await((A=this._transport)===null||A===void 0?void 0:A.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;var _docId={writable:!0,value:0};class PDFDataRangeTransport{constructor(A,l){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this.length=A,this.initialData=l,this.progressiveDone=o,this.contentDispositionFilename=t,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(A){this._rangeListeners.push(A)}addProgressListener(A){this._progressListeners.push(A)}addProgressiveReadListener(A){this._progressiveReadListeners.push(A)}addProgressiveDoneListener(A){this._progressiveDoneListeners.push(A)}onDataRange(A,l){for(const o of this._rangeListeners)o(A,l)}onDataProgress(A,l){this._readyCapability.promise.then(()=>{for(const o of this._progressListeners)o(A,l)})}onDataProgressiveRead(A){this._readyCapability.promise.then(()=>{for(const l of this._progressiveReadListeners)l(A)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const A of this._progressiveDoneListeners)A()})}transportReady(){this._readyCapability.resolve()}requestDataRange(A,l){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(A,l){this._pdfInfo=A,this._transport=l,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(A){return this._transport.getPage(A)}getPageIndex(A){return this._transport.getPageIndex(A)}getDestinations(){return this._transport.getDestinations()}getDestination(A){return this._transport.getDestination(A)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._transport.startCleanup(A||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(A,l,o,t){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;this._pageIndex=A,this._pageInfo=l,this._ownerDocument=t,this._transport=o,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=o.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:A,rotation:l=this.rotate,offsetX:o=0,offsetY:t=0,dontFlip:a=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new _display_utils.PageViewport({viewBox:this.view,scale:A,rotation:l,offsetX:o,offsetY:t,dontFlip:a})}getAnnotations(){let{intent:A="display"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const l=this._transport.getRenderingIntent(A);let o=this._annotationPromises.get(l.cacheKey);return o||(o=this._transport.getAnnotations(this._pageIndex,l.renderingIntent),this._annotationPromises.set(l.cacheKey,o),o=o.then(t=>{for(const a of t)a.titleObj!==void 0&&Object.defineProperty(a,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),a.titleObj.str}}),a.contentsObj!==void 0&&Object.defineProperty(a,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),a.contentsObj.str}});return t})),o}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var A;return((A=this._transport._htmlForXfa)===null||A===void 0?void 0:A.children[this._pageIndex])||null}render(A){var l,o,t;let{canvasContext:a,viewport:n,intent:B="display",annotationMode:R=_util.AnnotationMode.ENABLE,transform:r=null,imageLayer:H=null,canvasFactory:II=null,background:k=null,optionalContentConfigPromise:iI=null,annotationCanvasMap:lI=null,pageColors:CI=null,printAnnotationStorage:sI=null}=A;((l=arguments[0])===null||l===void 0?void 0:l.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&R===_util.AnnotationMode.ENABLE&&(R=_util.AnnotationMode.ENABLE_FORMS)),((o=arguments[0])===null||o===void 0?void 0:o.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&R===_util.AnnotationMode.ENABLE&&(R=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const oI=this._transport.getRenderingIntent(B,R,sI);this.pendingCleanup=!1,iI||(iI=this._transport.getOptionalContentConfig());let E=this._intentStates.get(oI.cacheKey);E||(E=Object.create(null),this._intentStates.set(oI.cacheKey,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const _=II||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),gI=!!(oI.renderingIntent&_util.RenderingIntentFlag.PRINT);E.displayReadyCapability||(E.displayReadyCapability=(0,_util.createPromiseCapability)(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(oI));const M=eI=>{E.renderTasks.delete(O),(this.cleanupAfterRender||gI)&&(this.pendingCleanup=!0),this._tryCleanup(),eI?(O.capability.reject(eI),this._abortOperatorList({intentState:E,reason:eI instanceof Error?eI:new Error(eI)})):O.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},O=new InternalRenderTask({callback:M,params:{canvasContext:a,viewport:n,transform:r,imageLayer:H,background:k},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:lI,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:_,useRequestAnimationFrame:!gI,pdfBug:this._pdfBug,pageColors:CI});((t=E).renderTasks||(t.renderTasks=new Set)).add(O);const dI=O.task;return Promise.all([E.displayReadyCapability.promise,iI]).then(eI=>{let[aI,WI]=eI;if(this.pendingCleanup){M();return}this._stats&&this._stats.time("Rendering"),O.initializeGraphics({transparency:aI,optionalContentConfig:WI}),O.operatorListChanged()}).catch(M),dI}getOperatorList(){let{intent:A="display",annotationMode:l=_util.AnnotationMode.ENABLE,printAnnotationStorage:o=null}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};function t(){n.operatorList.lastChunk&&(n.opListReadCapability.resolve(n.operatorList),n.renderTasks.delete(B))}const a=this._transport.getRenderingIntent(A,l,o,!0);let n=this._intentStates.get(a.cacheKey);n||(n=Object.create(null),this._intentStates.set(a.cacheKey,n));let B;if(!n.opListReadCapability){var R;B=Object.create(null),B.operatorListChanged=t,n.opListReadCapability=(0,_util.createPromiseCapability)(),((R=n).renderTasks||(R.renderTasks=new Set)).add(B),n.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(a)}return n.opListReadCapability.promise}streamTextContent(){let{disableCombineTextItems:A=!1,includeMarkedContent:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:A!==!0,includeMarkedContent:l===!0},{highWaterMark:100,size(t){return t.items.length}})}getTextContent(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(o=>_xfa_text.XfaText.textContent(o));const l=this.streamTextContent(A);return new Promise(function(o,t){function a(){n.read().then(function(R){let{value:r,done:H}=R;if(H){o(B);return}Object.assign(B.styles,r.styles),B.items.push(...r.items),a()},t)}const n=l.getReader(),B={items:[],styles:Object.create(null)};a()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const A=[];for(const l of this._intentStates.values())if(this._abortOperatorList({intentState:l,reason:new Error("Page was destroyed."),force:!0}),!l.opListReadCapability)for(const o of l.renderTasks)A.push(o.completed),o.cancel();this.objs.clear();for(const l of this._bitmaps)l.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(A)}cleanup(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.pendingCleanup=!0,this._tryCleanup(A)}_tryCleanup(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.pendingCleanup)return!1;for(const{renderTasks:l,operatorList:o}of this._intentStates.values())if(l.size>0||!o.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,A&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const l of this._bitmaps)l.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(A,l){const o=this._intentStates.get(l);o&&(this._stats&&this._stats.timeEnd("Page Request"),o.displayReadyCapability&&o.displayReadyCapability.resolve(A))}_renderPageChunk(A,l){for(let o=0,t=A.length;o<t;o++)l.operatorList.fnArray.push(A.fnArray[o]),l.operatorList.argsArray.push(A.argsArray[o]);l.operatorList.lastChunk=A.lastChunk,l.operatorList.separateAnnots=A.separateAnnots;for(const o of l.renderTasks)o.operatorListChanged();A.lastChunk&&this._tryCleanup()}_pumpOperatorList(A){let{renderingIntent:l,cacheKey:o,annotationStorageMap:t}=A;const n=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:o,annotationStorage:t}).getReader(),B=this._intentStates.get(o);B.streamReader=n;const R=()=>{n.read().then(r=>{let{value:H,done:II}=r;if(II){B.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(H,B),R())},r=>{if(B.streamReader=null,!this._transport.destroyed){if(B.operatorList){B.operatorList.lastChunk=!0;for(const H of B.renderTasks)H.operatorListChanged();this._tryCleanup()}if(B.displayReadyCapability)B.displayReadyCapability.reject(r);else if(B.opListReadCapability)B.opListReadCapability.reject(r);else throw r}})};R()}_abortOperatorList(A){let{intentState:l,reason:o,force:t=!1}=A;if(l.streamReader){if(!t){if(l.renderTasks.size>0)return;if(o instanceof _display_utils.RenderingCancelledException){l.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:l,reason:o,force:!0}),l.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(l.streamReader.cancel(new _util.AbortException(o.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[a,n]of this._intentStates)if(n===l){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(A,l){const o={data:structuredClone(A,l)};this._deferred.then(()=>{for(const t of this._listeners)t.call(this,o)})}addEventListener(A,l){this._listeners.push(l)}removeEventListener(A,l){const o=this._listeners.indexOf(l);this._listeners.splice(o,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){var _document,_document$currentScri;const e=(_document=document)===null||_document===void 0||(_document$currentScri=_document.currentScript)===null||_document$currentScri===void 0?void 0:_document$currentScri.src;e&&(PDFWorkerUtil.fallbackWorkerSrc=e.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(e,A){let l;try{if(l=new URL(e),!l.origin||l.origin==="null")return!1}catch{return!1}const o=new URL(A,l);return l.origin===o.origin},PDFWorkerUtil.createCDNWrapper=function(e){const A=`importScripts("${e}");`;return URL.createObjectURL(new Blob([A]))}}class PDFWorker{constructor(){let{name:e=null,port:A=null,verbosity:l=(0,_util.getVerbosityLevel)()}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(A&&_classStaticPrivateFieldSpecGet(PDFWorker,PDFWorker,_workerPorts).has(A))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=e,this.destroyed=!1,this.verbosity=l,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,A){_classStaticPrivateFieldSpecGet(PDFWorker,PDFWorker,_workerPorts).set(A,this),this._initializeFromPort(A);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:e}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,e)||(e=PDFWorkerUtil.createCDNWrapper(new URL(e,window.location).href));const A=new Worker(e),l=new _message_handler.MessageHandler("main","worker",A),o=()=>{A.removeEventListener("error",t),l.destroy(),A.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},t=()=>{this._webWorker||o()};A.addEventListener("error",t),l.on("test",n=>{if(A.removeEventListener("error",t),this.destroyed){o();return}n?(this._messageHandler=l,this._port=A,this._webWorker=A,this._readyCapability.resolve(),l.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),l.destroy(),A.terminate())}),l.on("ready",n=>{if(A.removeEventListener("error",t),this.destroyed){o();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const n=new Uint8Array;l.send("test",n,[n.buffer])};a();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const A=new LoopbackPort;this._port=A;const l=`fake${PDFWorkerUtil.fakeWorkerId++}`,o=new _message_handler.MessageHandler(l+"_worker",l,A);e.setup(o,A);const t=new _message_handler.MessageHandler(l,l+"_worker",A);this._messageHandler=t,this._readyCapability.resolve(),t.send("configure",{verbosity:this.verbosity})}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),_classStaticPrivateFieldSpecGet(PDFWorker,PDFWorker,_workerPorts).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return _classStaticPrivateFieldSpecGet(this,PDFWorker,_workerPorts).has(e.port)?_classStaticPrivateFieldSpecGet(this,PDFWorker,_workerPorts).get(e.port):new PDFWorker(e)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{var e;return((e=globalThis.pdfjsWorker)===null||e===void 0?void 0:e.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;var _workerPorts={value:new WeakMap};PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};var _docStats=new WeakMap,_pageCache=new WeakMap,_pagePromises=new WeakMap,_metadataPromise=new WeakMap;class WorkerTransport{constructor(A,l,o,t){_classPrivateFieldInitSpec(this,_docStats,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,_pageCache,{writable:!0,value:new Map}),_classPrivateFieldInitSpec(this,_pagePromises,{writable:!0,value:new Map}),_classPrivateFieldInitSpec(this,_metadataPromise,{writable:!0,value:null}),this.messageHandler=A,this.loadingTask=l,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:l.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:t.ownerDocument,styleElement:t.styleElement}),this._params=t,t.useWorkerFetch||(this.CMapReaderFactory=new t.CMapReaderFactory({baseUrl:t.cMapUrl,isCompressed:t.cMapPacked}),this.StandardFontDataFactory=new t.StandardFontDataFactory({baseUrl:t.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=o,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return _classPrivateFieldGet(this,_docStats)}getRenderingIntent(A){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_util.AnnotationMode.ENABLE,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=_util.RenderingIntentFlag.DISPLAY,n=null;switch(A){case"any":a=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":a=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${A}`)}switch(l){case _util.AnnotationMode.DISABLE:a+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:a+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:a+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,n=(a&_util.RenderingIntentFlag.PRINT&&o instanceof _annotation_storage.PrintAnnotationStorage?o:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${l}`)}return t&&(a+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:a,cacheKey:`${a}_${_annotation_storage.AnnotationStorage.getHash(n)}`,annotationStorageMap:n}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const A=[];for(const o of _classPrivateFieldGet(this,_pageCache).values())A.push(o._destroy());_classPrivateFieldGet(this,_pageCache).clear(),_classPrivateFieldGet(this,_pagePromises).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const l=this.messageHandler.sendWithPromise("Terminate",null);return A.push(l),Promise.all(A).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),_classPrivateFieldSet(this,_metadataPromise,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:A,loadingTask:l}=this;A.on("GetReader",(o,t)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},t.onPull=()=>{this._fullReader.read().then(function(a){let{value:n,done:B}=a;if(B){t.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(n),"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n])}).catch(a=>{t.error(a)})},t.onCancel=a=>{this._fullReader.cancel(a),t.ready.catch(n=>{if(!this.destroyed)throw n})}}),A.on("ReaderHeadersReady",o=>{const t=(0,_util.createPromiseCapability)(),a=this._fullReader;return a.headersReady.then(()=>{if(!a.isStreamingSupported||!a.isRangeSupported){if(this._lastProgress){var n;(n=l.onProgress)===null||n===void 0||n.call(l,this._lastProgress)}a.onProgress=B=>{var R;(R=l.onProgress)===null||R===void 0||R.call(l,{loaded:B.loaded,total:B.total})}}t.resolve({isStreamingSupported:a.isStreamingSupported,isRangeSupported:a.isRangeSupported,contentLength:a.contentLength})},t.reject),t.promise}),A.on("GetRangeReader",(o,t)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(o.begin,o.end);if(!a){t.close();return}t.onPull=()=>{a.read().then(function(n){let{value:B,done:R}=n;if(R){t.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(B),"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(B),1,[B])}).catch(n=>{t.error(n)})},t.onCancel=n=>{a.cancel(n),t.ready.catch(B=>{if(!this.destroyed)throw B})}}),A.on("GetDoc",o=>{let{pdfInfo:t}=o;this._numPages=t.numPages,this._htmlForXfa=t.htmlForXfa,delete t.htmlForXfa,l._capability.resolve(new PDFDocumentProxy(t,this))}),A.on("DocException",function(o){let t;switch(o.name){case"PasswordException":t=new _util.PasswordException(o.message,o.code);break;case"InvalidPDFException":t=new _util.InvalidPDFException(o.message);break;case"MissingPDFException":t=new _util.MissingPDFException(o.message);break;case"UnexpectedResponseException":t=new _util.UnexpectedResponseException(o.message,o.status);break;case"UnknownErrorException":t=new _util.UnknownErrorException(o.message,o.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}l._capability.reject(t)}),A.on("PasswordRequest",o=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),l.onPassword){const t=a=>{a instanceof Error?this._passwordCapability.reject(a):this._passwordCapability.resolve({password:a})};try{l.onPassword(t,o.code)}catch(a){this._passwordCapability.reject(a)}}else this._passwordCapability.reject(new _util.PasswordException(o.message,o.code));return this._passwordCapability.promise}),A.on("DataLoaded",o=>{var t;(t=l.onProgress)===null||t===void 0||t.call(l,{loaded:o.length,total:o.length}),this.downloadInfoCapability.resolve(o)}),A.on("StartRenderPage",o=>{if(this.destroyed)return;_classPrivateFieldGet(this,_pageCache).get(o.pageIndex)._startRenderPage(o.transparency,o.cacheKey)}),A.on("commonobj",o=>{var t;let[a,n,B]=o;if(!this.destroyed&&!this.commonObjs.has(a))switch(n){case"Font":const R=this._params;if("error"in B){const II=B.error;(0,_util.warn)(`Error during font loading: ${II}`),this.commonObjs.resolve(a,II);break}let r=null;R.pdfBug&&(t=globalThis.FontInspector)!==null&&t!==void 0&&t.enabled&&(r={registerFont(II,k){globalThis.FontInspector.fontAdded(II,k)}});const H=new _font_loader.FontFaceObject(B,{isEvalSupported:R.isEvalSupported,disableFontFace:R.disableFontFace,ignoreErrors:R.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:r});this.fontLoader.bind(H).catch(II=>A.sendWithPromise("FontFallback",{id:a})).finally(()=>{!R.fontExtraProperties&&H.data&&(H.data=null),this.commonObjs.resolve(a,H)});break;case"FontPath":case"Image":this.commonObjs.resolve(a,B);break;default:throw new Error(`Got unknown common object type ${n}`)}}),A.on("obj",o=>{let[t,a,n,B]=o;if(this.destroyed)return;const R=_classPrivateFieldGet(this,_pageCache).get(a);if(!R.objs.has(t))switch(n){case"Image":R.objs.resolve(t,B);const H=8e6;if(B){let II;if(B.bitmap){const{bitmap:k,width:iI,height:lI}=B;II=iI*lI*4,R._bitmaps.add(k)}else{var r;II=((r=B.data)===null||r===void 0?void 0:r.length)||0}II>H&&(R.cleanupAfterRender=!0)}break;case"Pattern":R.objs.resolve(t,B);break;default:throw new Error(`Got unknown object type ${n}`)}}),A.on("DocProgress",o=>{var t;this.destroyed||(t=l.onProgress)===null||t===void 0||t.call(l,{loaded:o.loaded,total:o.total})}),A.on("DocStats",o=>{this.destroyed||_classPrivateFieldSet(this,_docStats,Object.freeze({streamTypes:Object.freeze(o.streamTypes),fontTypes:Object.freeze(o.fontTypes)}))}),A.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),A.on("FetchBuiltInCMap",o=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(o):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),A.on("FetchStandardFontData",o=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(o):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature(A){var l,o;let{featureId:t}=A;this.destroyed||(l=(o=this.loadingTask).onUnsupportedFeature)===null||l===void 0||l.call(o,t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(A){if(!Number.isInteger(A)||A<=0||A>this._numPages)return Promise.reject(new Error("Invalid page request."));const l=A-1,o=_classPrivateFieldGet(this,_pagePromises).get(l);if(o)return o;const t=this.messageHandler.sendWithPromise("GetPage",{pageIndex:l}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");const n=new PDFPageProxy(l,a,this,this._params.ownerDocument,this._params.pdfBug);return _classPrivateFieldGet(this,_pageCache).set(l,n),n});return _classPrivateFieldGet(this,_pagePromises).set(l,t),t}getPageIndex(A){return typeof A!="object"||A===null||!Number.isInteger(A.num)||A.num<0||!Number.isInteger(A.gen)||A.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:A.num,gen:A.gen})}getAnnotations(A,l){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:A,intent:l})}saveDocument(){var A,l;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(A=(l=this._fullReader)===null||l===void 0?void 0:l.filename)!==null&&A!==void 0?A:null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(A){return typeof A!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:A})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(A){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:A})}getStructTree(A){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:A})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(A=>new _optional_content_config.OptionalContentConfig(A))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return _classPrivateFieldGet(this,_metadataPromise)||_classPrivateFieldSet(this,_metadataPromise,this.messageHandler.sendWithPromise("GetMetadata",null).then(A=>{var l,o,t,a;return{info:A[0],metadata:A[1]?new _metadata.Metadata(A[1]):null,contentDispositionFilename:(l=(o=this._fullReader)===null||o===void 0?void 0:o.filename)!==null&&l!==void 0?l:null,contentLength:(t=(a=this._fullReader)===null||a===void 0?void 0:a.contentLength)!==null&&t!==void 0?t:null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const l of _classPrivateFieldGet(this,_pageCache).values())if(!l.cleanup())throw new Error(`startCleanup: Page ${l.pageNumber} is currently rendering.`);this.commonObjs.clear(),A||this.fontLoader.clear(),_classPrivateFieldSet(this,_metadataPromise,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const A=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:A.disableAutoFetch,enableXfa:A.enableXfa})}}var _objs=new WeakMap,_ensureObj=new WeakSet;class PDFObjects{constructor(){_classPrivateMethodInitSpec(this,_ensureObj),_classPrivateFieldInitSpec(this,_objs,{writable:!0,value:Object.create(null)})}get(A){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(l){const t=_classPrivateMethodGet(this,_ensureObj,_ensureObj2).call(this,A);return t.capability.promise.then(()=>l(t.data)),null}const o=_classPrivateFieldGet(this,_objs)[A];if(!(o!=null&&o.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${A}.`);return o.data}has(A){const l=_classPrivateFieldGet(this,_objs)[A];return l?.capability.settled||!1}resolve(A){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const o=_classPrivateMethodGet(this,_ensureObj,_ensureObj2).call(this,A);o.data=l,o.capability.resolve()}clear(){_classPrivateFieldSet(this,_objs,Object.create(null))}}function _ensureObj2(e){const A=_classPrivateFieldGet(this,_objs)[e];return A||(_classPrivateFieldGet(this,_objs)[e]={capability:(0,_util.createPromiseCapability)(),data:null})}var _internalRenderTask=new WeakMap;class RenderTask{constructor(A){_classPrivateFieldInitSpec(this,_internalRenderTask,{writable:!0,value:null}),_classPrivateFieldSet(this,_internalRenderTask,A),this.onContinue=null}get promise(){return _classPrivateFieldGet(this,_internalRenderTask).capability.promise}cancel(){_classPrivateFieldGet(this,_internalRenderTask).cancel()}get separateAnnots(){const{separateAnnots:A}=_classPrivateFieldGet(this,_internalRenderTask).operatorList;if(!A)return!1;const{annotationCanvasMap:l}=_classPrivateFieldGet(this,_internalRenderTask);return A.form||A.canvas&&l?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{constructor(A){let{callback:l,params:o,objs:t,commonObjs:a,annotationCanvasMap:n,operatorList:B,pageIndex:R,canvasFactory:r,useRequestAnimationFrame:H=!1,pdfBug:II=!1,pageColors:k=null}=A;this.callback=l,this.params=o,this.objs=t,this.commonObjs=a,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=B,this._pageIndex=R,this.canvasFactory=r,this._pdfBug=II,this.pageColors=k,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=H===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=o.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics(A){var l;let{transparency:o=!1,optionalContentConfig:t}=A;if(this.cancelled)return;if(this._canvas){if(_classStaticPrivateFieldSpecGet(InternalRenderTask,InternalRenderTask,_canvasInUse).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");_classStaticPrivateFieldSpecGet(InternalRenderTask,InternalRenderTask,_canvasInUse).add(this._canvas)}this._pdfBug&&(l=globalThis.StepperManager)!==null&&l!==void 0&&l.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:a,viewport:n,transform:B,imageLayer:R,background:r}=this.params;this.gfx=new _canvas.CanvasGraphics(a,this.commonObjs,this.objs,this.canvasFactory,R,t,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:B,viewport:n,transparency:o,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&_classStaticPrivateFieldSpecGet(InternalRenderTask,InternalRenderTask,_canvasInUse).delete(this._canvas),this.callback(A||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&_classStaticPrivateFieldSpecGet(InternalRenderTask,InternalRenderTask,_canvasInUse).delete(this._canvas),this.callback())))}}var _canvasInUse={value:new WeakSet};const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PrintAnnotationStorage=A.AnnotationStorage=void 0;var o=l(1),t=l(131),a=l(135);function n(gI,M,O){iI(gI,M),M.set(gI,O)}function B(gI,M){var O=H(gI,M,"get");return R(gI,O)}function R(gI,M){return M.get?M.get.call(gI):M.value}function r(gI,M,O){var dI=H(gI,M,"set");return II(gI,dI,O),O}function H(gI,M,O){if(!M.has(gI))throw new TypeError("attempted to "+O+" private field on non-instance");return M.get(gI)}function II(gI,M,O){if(M.set)M.set.call(gI,O);else{if(!M.writable)throw new TypeError("attempted to set read only private field");M.value=O}}function k(gI,M){iI(gI,M),M.add(gI)}function iI(gI,M){if(M.has(gI))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lI(gI,M,O){if(!M.has(gI))throw new TypeError("attempted to get private field on non-instance");return O}var CI=new WeakSet;class sI{constructor(){k(this,CI),this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(M,O){const dI=this._storage.get(M);return dI===void 0?O:Object.assign(O,dI)}getRawValue(M){return this._storage.get(M)}remove(M){if(this._storage.delete(M),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const O of this._storage.values())if(O instanceof t.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(M,O){const dI=this._storage.get(M);let eI=!1;if(dI!==void 0)for(const[aI,WI]of Object.entries(O))dI[aI]!==WI&&(eI=!0,dI[aI]=WI);else eI=!0,this._storage.set(M,O);eI&&lI(this,CI,oI).call(this),O instanceof t.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(O.constructor._type)}has(M){return this._storage.has(M)}getAll(){return this._storage.size>0?(0,o.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new _(this)}get serializable(){if(this._storage.size===0)return null;const M=new Map;for(const[O,dI]of this._storage){const eI=dI instanceof t.AnnotationEditor?dI.serialize():dI;eI&&M.set(O,eI)}return M}static getHash(M){if(!M)return"";const O=new a.MurmurHash3_64;for(const[dI,eI]of M)O.update(`${dI}:${JSON.stringify(eI)}`);return O.hexdigest()}}A.AnnotationStorage=sI;function oI(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())}var E=new WeakMap;class _ extends sI{constructor(M){super(),n(this,E,{writable:!0,value:null}),r(this,E,structuredClone(M.serializable))}get print(){(0,o.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return B(this,E)}}A.PrintAnnotationStorage=_},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.AnnotationEditor=void 0;var o=l(132),t=l(1);function a(gI,M,O){return M in gI?Object.defineProperty(gI,M,{value:O,enumerable:!0,configurable:!0,writable:!0}):gI[M]=O,gI}function n(gI,M,O){B(gI,M),M.set(gI,O)}function B(gI,M){if(M.has(gI))throw new TypeError("Cannot initialize the same private elements twice on an object")}function R(gI,M,O){var dI=II(gI,M,"set");return r(gI,dI,O),O}function r(gI,M,O){if(M.set)M.set.call(gI,O);else{if(!M.writable)throw new TypeError("attempted to set read only private field");M.value=O}}function H(gI,M){var O=II(gI,M,"get");return k(gI,O)}function II(gI,M,O){if(!M.has(gI))throw new TypeError("attempted to "+O+" private field on non-instance");return M.get(gI)}function k(gI,M){return M.get?M.get.call(gI):M.value}var iI=new WeakMap,lI=new WeakMap,CI=new WeakMap,sI=new WeakMap,oI=new WeakMap,E=new WeakMap;class _{constructor(M){n(this,iI,{writable:!0,value:this.focusin.bind(this)}),n(this,lI,{writable:!0,value:this.focusout.bind(this)}),n(this,CI,{writable:!0,value:!1}),n(this,sI,{writable:!0,value:!1}),n(this,oI,{writable:!0,value:!1}),n(this,E,{writable:!0,value:_._zIndex++}),this.constructor===_&&(0,t.unreachable)("Cannot initialize AnnotationEditor."),this.parent=M.parent,this.id=M.id,this.width=this.height=null,this.pageIndex=M.parent.pageIndex,this.name=M.name,this.div=null;const[O,dI]=this.parent.viewportBaseDimensions;this.x=M.x/O,this.y=M.y/dI,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,t.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=H(this,E)}focusin(M){H(this,CI)?R(this,CI,!1):this.parent.setSelected(this)}focusout(M){if(!this.isAttachedToDOM)return;const O=M.relatedTarget;O!=null&&O.closest(`#${this.id}`)||(M.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(M){const O=this.parent.div.getBoundingClientRect();this.startX=M.clientX-O.x,this.startY=M.clientY-O.y,M.dataTransfer.setData("text/plain",this.id),M.dataTransfer.effectAllowed="move"}setAt(M,O,dI,eI){const[aI,WI]=this.parent.viewportBaseDimensions;[dI,eI]=this.screenToPageTranslation(dI,eI),this.x=(M+dI)/aI,this.y=(O+eI)/WI,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(M,O){const[dI,eI]=this.parent.viewportBaseDimensions;[M,O]=this.screenToPageTranslation(M,O),this.x+=M/dI,this.y+=O/eI,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(M,O){const{rotation:dI}=this.parent.viewport;switch(dI){case 90:return[O,-M];case 180:return[-M,-O];case 270:return[-O,M];default:return[M,O]}}setDims(M,O){const[dI,eI]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*M/dI}%`,this.div.style.height=`${100*O/eI}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",H(this,iI)),this.div.addEventListener("focusout",H(this,lI));const[M,O]=this.getInitialTranslation();return this.translate(M,O),(0,o.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(M){const O=o.KeyboardManager.platform.isMac;if(M.button!==0||M.ctrlKey&&O){M.preventDefault();return}M.ctrlKey&&!O||M.shiftKey||M.metaKey&&O?this.parent.toggleSelected(this):this.parent.setSelected(this),R(this,CI,!0)}getRect(M,O){const[dI,eI]=this.parent.viewportBaseDimensions,[aI,WI]=this.parent.pageDimensions,GI=aI*M/dI,HI=WI*O/eI,MI=this.x*aI,KI=this.y*WI,DI=this.width*aI,NI=this.height*WI;switch(this.rotation){case 0:return[MI+GI,WI-KI-HI-NI,MI+GI+DI,WI-KI-HI];case 90:return[MI+HI,WI-KI+GI,MI+HI+NI,WI-KI+GI+DI];case 180:return[MI-GI-DI,WI-KI+HI,MI-GI,WI-KI+HI+NI];case 270:return[MI-HI-NI,WI-KI-GI-DI,MI-HI,WI-KI-GI];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(M,O){const[dI,eI,aI,WI]=M,GI=aI-dI,HI=WI-eI;switch(this.rotation){case 0:return[dI,O-WI,GI,HI];case 90:return[dI,O-eI,HI,GI];case 180:return[aI,O-eI,GI,HI];case 270:return[aI,O-WI,HI,GI];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){R(this,oI,!0)}disableEditMode(){R(this,oI,!1)}isInEditMode(){return H(this,oI)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var M;(M=this.div)===null||M===void 0||M.addEventListener("focusin",H(this,iI))}serialize(){(0,t.unreachable)("An editor must be serializable")}static deserialize(M,O){const dI=new this.prototype.constructor({parent:O,id:O.getNextId()});dI.rotation=M.rotation;const[eI,aI]=O.pageDimensions,[WI,GI,HI,MI]=dI.getRectInCurrentCoords(M.rect,aI);return dI.x=WI/eI,dI.y=GI/aI,dI.width=HI/eI,dI.height=MI/aI,dI}remove(){this.div.removeEventListener("focusin",H(this,iI)),this.div.removeEventListener("focusout",H(this,lI)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var M;(M=this.div)===null||M===void 0||M.classList.add("selectedEditor")}unselect(){var M;(M=this.div)===null||M===void 0||M.classList.remove("selectedEditor")}updateParams(M,O){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return H(this,sI)}set isEditing(M){R(this,sI,M),M?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}A.AnnotationEditor=_,a(_,"_colorManager",new o.ColorManager),a(_,"_zIndex",1)},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.KeyboardManager=A.CommandManager=A.ColorManager=A.AnnotationEditorUIManager=void 0,A.bindEvents=CI,A.opacityToHex=sI;var o=l(1),t=l(133);function a(eg,vI,Cg){return vI in eg?Object.defineProperty(eg,vI,{value:Cg,enumerable:!0,configurable:!0,writable:!0}):eg[vI]=Cg,eg}function n(eg,vI){r(eg,vI),vI.add(eg)}function B(eg,vI,Cg){if(!vI.has(eg))throw new TypeError("attempted to get private field on non-instance");return Cg}function R(eg,vI,Cg){r(eg,vI),vI.set(eg,Cg)}function r(eg,vI){if(vI.has(eg))throw new TypeError("Cannot initialize the same private elements twice on an object")}function H(eg,vI,Cg){var Gg=iI(eg,vI,"set");return II(eg,Gg,Cg),Cg}function II(eg,vI,Cg){if(vI.set)vI.set.call(eg,Cg);else{if(!vI.writable)throw new TypeError("attempted to set read only private field");vI.value=Cg}}function k(eg,vI){var Cg=iI(eg,vI,"get");return lI(eg,Cg)}function iI(eg,vI,Cg){if(!vI.has(eg))throw new TypeError("attempted to "+Cg+" private field on non-instance");return vI.get(eg)}function lI(eg,vI){return vI.get?vI.get.call(eg):vI.value}function CI(eg,vI,Cg){for(const Gg of Cg)vI.addEventListener(Gg,eg[Gg].bind(eg))}function sI(eg){return Math.round(Math.min(255,Math.max(1,255*eg))).toString(16).padStart(2,"0")}var oI=new WeakMap;class E{constructor(){R(this,oI,{writable:!0,value:0})}getId(){var vI,Cg;return`${o.AnnotationEditorPrefix}${H(this,oI,(vI=k(this,oI),Cg=vI++,vI)),Cg}`}}var _=new WeakMap,gI=new WeakMap,M=new WeakMap,O=new WeakMap;class dI{constructor(){let vI=arguments.length>0&&arguments[0]!==void 0?arguments[0]:128;R(this,_,{writable:!0,value:[]}),R(this,gI,{writable:!0,value:!1}),R(this,M,{writable:!0,value:void 0}),R(this,O,{writable:!0,value:-1}),H(this,M,vI)}add(vI){let{cmd:Cg,undo:Gg,mustExec:Kg,type:Ig=NaN,overwriteIfSameType:og=!1,keepUndo:wg=!1}=vI;if(Kg&&Cg(),k(this,gI))return;const UI={cmd:Cg,undo:Gg,type:Ig};if(k(this,O)===-1){k(this,_).length>0&&(k(this,_).length=0),H(this,O,0),k(this,_).push(UI);return}if(og&&k(this,_)[k(this,O)].type===Ig){wg&&(UI.undo=k(this,_)[k(this,O)].undo),k(this,_)[k(this,O)]=UI;return}const JI=k(this,O)+1;JI===k(this,M)?k(this,_).splice(0,1):(H(this,O,JI),JI<k(this,_).length&&k(this,_).splice(JI)),k(this,_).push(UI)}undo(){k(this,O)!==-1&&(H(this,gI,!0),k(this,_)[k(this,O)].undo(),H(this,gI,!1),H(this,O,k(this,O)-1))}redo(){k(this,O)<k(this,_).length-1&&(H(this,O,k(this,O)+1),H(this,gI,!0),k(this,_)[k(this,O)].cmd(),H(this,gI,!1))}hasSomethingToUndo(){return k(this,O)!==-1}hasSomethingToRedo(){return k(this,O)<k(this,_).length-1}destroy(){H(this,_,null)}}A.CommandManager=dI;var eI=new WeakSet;class aI{constructor(vI){n(this,eI),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const Cg=aI.platform.isMac;for(const[Gg,Kg]of vI)for(const Ig of Gg){const og=Ig.startsWith("mac+");Cg&&og?(this.callbacks.set(Ig.slice(4),Kg),this.allKeys.add(Ig.split("+").at(-1))):!Cg&&!og&&(this.callbacks.set(Ig,Kg),this.allKeys.add(Ig.split("+").at(-1)))}}static get platform(){const vI=typeof navigator<"u"?navigator.platform:"";return(0,o.shadow)(this,"platform",{isWin:vI.includes("Win"),isMac:vI.includes("Mac")})}exec(vI,Cg){if(!this.allKeys.has(Cg.key))return;const Gg=this.callbacks.get(B(this,eI,WI).call(this,Cg));Gg&&(Gg.bind(vI)(),Cg.stopPropagation(),Cg.preventDefault())}}A.KeyboardManager=aI;function WI(eg){eg.altKey&&this.buffer.push("alt"),eg.ctrlKey&&this.buffer.push("ctrl"),eg.metaKey&&this.buffer.push("meta"),eg.shiftKey&&this.buffer.push("shift"),this.buffer.push(eg.key);const vI=this.buffer.join("+");return this.buffer.length=0,vI}var GI=new WeakMap;class HI{constructor(){R(this,GI,{writable:!0,value:null})}copy(vI){vI&&(Array.isArray(vI)?H(this,GI,vI.map(Cg=>Cg.serialize())):H(this,GI,[vI.serialize()]),H(this,GI,k(this,GI).filter(Cg=>!!Cg)),k(this,GI).length===0&&H(this,GI,null))}paste(){return k(this,GI)}isEmpty(){return k(this,GI)===null}destroy(){H(this,GI,null)}}class MI{get _colors(){const vI=new Map([["CanvasText",null],["Canvas",null]]);return(0,t.getColorValues)(vI),(0,o.shadow)(this,"_colors",vI)}convert(vI){const Cg=(0,t.getRGB)(vI);if(!window.matchMedia("(forced-colors: active)").matches)return Cg;for(const[Gg,Kg]of this._colors)if(Kg.every((Ig,og)=>Ig===Cg[og]))return MI._colorsMapping.get(Gg);return Cg}getHexCode(vI){const Cg=this._colors.get(vI);return Cg?o.Util.makeHexColor(...Cg):vI}}A.ColorManager=MI,a(MI,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));var KI=new WeakMap,DI=new WeakMap,NI=new WeakMap,yI=new WeakMap,VI=new WeakMap,hI=new WeakMap,wI=new WeakMap,pI=new WeakMap,xI=new WeakMap,PI=new WeakMap,XI=new WeakMap,tI=new WeakMap,mI=new WeakMap,YI=new WeakMap,BI=new WeakMap,AI=new WeakMap,cI=new WeakMap,bI=new WeakSet,nI=new WeakSet,uI=new WeakSet,rI=new WeakSet,FI=new WeakSet,kI=new WeakSet,TI=new WeakSet,QI=new WeakSet,fI=new WeakSet;class OI{constructor(vI,Cg){n(this,fI),n(this,QI),n(this,TI),n(this,kI),n(this,FI),n(this,rI),n(this,uI),n(this,nI),n(this,bI),R(this,KI,{writable:!0,value:null}),R(this,DI,{writable:!0,value:new Map}),R(this,NI,{writable:!0,value:new Map}),R(this,yI,{writable:!0,value:new HI}),R(this,VI,{writable:!0,value:new dI}),R(this,hI,{writable:!0,value:0}),R(this,wI,{writable:!0,value:null}),R(this,pI,{writable:!0,value:null}),R(this,xI,{writable:!0,value:new E}),R(this,PI,{writable:!0,value:!1}),R(this,XI,{writable:!0,value:o.AnnotationEditorType.NONE}),R(this,tI,{writable:!0,value:new Set}),R(this,mI,{writable:!0,value:this.keydown.bind(this)}),R(this,YI,{writable:!0,value:this.onEditingAction.bind(this)}),R(this,BI,{writable:!0,value:this.onPageChanging.bind(this)}),R(this,AI,{writable:!0,value:{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1}}),R(this,cI,{writable:!0,value:null}),H(this,cI,vI),H(this,pI,Cg),k(this,pI)._on("editingaction",k(this,YI)),k(this,pI)._on("pagechanging",k(this,BI))}destroy(){B(this,nI,gg).call(this),k(this,pI)._off("editingaction",k(this,YI)),k(this,pI)._off("pagechanging",k(this,BI));for(const vI of k(this,NI).values())vI.destroy();k(this,NI).clear(),k(this,DI).clear(),H(this,KI,null),k(this,tI).clear(),k(this,yI).destroy(),k(this,VI).destroy()}onPageChanging(vI){let{pageNumber:Cg}=vI;H(this,hI,Cg-1)}focusMainContainer(){k(this,cI).focus()}keydown(vI){var Cg;(Cg=this.getActive())!==null&&Cg!==void 0&&Cg.shouldGetKeyboardEvents()||OI._keyboardManager.exec(this,vI)}onEditingAction(vI){["undo","redo","cut","copy","paste","delete","selectAll"].includes(vI.name)&&this[vI.name]()}setEditingState(vI){vI?(B(this,bI,qI).call(this),B(this,uI,lg).call(this,{isEditing:k(this,XI)!==o.AnnotationEditorType.NONE,isEmpty:B(this,QI,rg).call(this),hasSomethingToUndo:k(this,VI).hasSomethingToUndo(),hasSomethingToRedo:k(this,VI).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:k(this,yI).isEmpty()})):(B(this,nI,gg).call(this),B(this,uI,lg).call(this,{isEditing:!1}))}registerEditorTypes(vI){H(this,wI,vI);for(const Cg of k(this,wI))B(this,rI,sg).call(this,Cg.defaultPropertiesToUpdate)}getId(){return k(this,xI).getId()}addLayer(vI){k(this,NI).set(vI.pageIndex,vI),k(this,PI)?vI.enable():vI.disable()}removeLayer(vI){k(this,NI).delete(vI.pageIndex)}updateMode(vI){if(H(this,XI,vI),vI===o.AnnotationEditorType.NONE)this.setEditingState(!1),B(this,kI,ig).call(this);else{this.setEditingState(!0),B(this,FI,tg).call(this);for(const Cg of k(this,NI).values())Cg.updateMode(vI)}}updateToolbar(vI){vI!==k(this,XI)&&k(this,pI).dispatch("switchannotationeditormode",{source:this,mode:vI})}updateParams(vI,Cg){for(const Gg of k(this,tI))Gg.updateParams(vI,Cg);for(const Gg of k(this,wI))Gg.updateDefaultParams(vI,Cg)}getEditors(vI){const Cg=[];for(const Gg of k(this,DI).values())Gg.pageIndex===vI&&Cg.push(Gg);return Cg}getEditor(vI){return k(this,DI).get(vI)}addEditor(vI){k(this,DI).set(vI.id,vI)}removeEditor(vI){k(this,DI).delete(vI.id),this.unselect(vI)}setActiveEditor(vI){k(this,KI)!==vI&&(H(this,KI,vI),vI&&B(this,rI,sg).call(this,vI.propertiesToUpdate))}toggleSelected(vI){if(k(this,tI).has(vI)){k(this,tI).delete(vI),vI.unselect(),B(this,uI,lg).call(this,{hasSelectedEditor:this.hasSelection});return}k(this,tI).add(vI),vI.select(),B(this,rI,sg).call(this,vI.propertiesToUpdate),B(this,uI,lg).call(this,{hasSelectedEditor:!0})}setSelected(vI){for(const Cg of k(this,tI))Cg!==vI&&Cg.unselect();k(this,tI).clear(),k(this,tI).add(vI),vI.select(),B(this,rI,sg).call(this,vI.propertiesToUpdate),B(this,uI,lg).call(this,{hasSelectedEditor:!0})}isSelected(vI){return k(this,tI).has(vI)}unselect(vI){vI.unselect(),k(this,tI).delete(vI),B(this,uI,lg).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return k(this,tI).size!==0}undo(){k(this,VI).undo(),B(this,uI,lg).call(this,{hasSomethingToUndo:k(this,VI).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:B(this,QI,rg).call(this)})}redo(){k(this,VI).redo(),B(this,uI,lg).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:k(this,VI).hasSomethingToRedo(),isEmpty:B(this,QI,rg).call(this)})}addCommands(vI){k(this,VI).add(vI),B(this,uI,lg).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:B(this,QI,rg).call(this)})}delete(){if(k(this,KI)&&k(this,KI).commitOrRemove(),!this.hasSelection)return;const vI=[...k(this,tI)],Cg=()=>{for(const Kg of vI)Kg.remove()},Gg=()=>{for(const Kg of vI)B(this,TI,Xg).call(this,Kg)};this.addCommands({cmd:Cg,undo:Gg,mustExec:!0})}copy(){if(k(this,KI)&&k(this,KI).commitOrRemove(),this.hasSelection){const vI=[];for(const Cg of k(this,tI))Cg.isEmpty()||vI.push(Cg);if(vI.length===0)return;k(this,yI).copy(vI),B(this,uI,lg).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(k(this,yI).isEmpty())return;this.unselectAll();const vI=k(this,NI).get(k(this,hI)),Cg=k(this,yI).paste().map(Ig=>vI.deserialize(Ig)),Gg=()=>{for(const Ig of Cg)B(this,TI,Xg).call(this,Ig);B(this,fI,mg).call(this,Cg)},Kg=()=>{for(const Ig of Cg)Ig.remove()};this.addCommands({cmd:Gg,undo:Kg,mustExec:!0})}selectAll(){for(const vI of k(this,tI))vI.commit();B(this,fI,mg).call(this,k(this,DI).values())}unselectAll(){if(k(this,KI)){k(this,KI).commitOrRemove();return}if(B(this,fI,mg).size!==0){for(const vI of k(this,tI))vI.unselect();k(this,tI).clear(),B(this,uI,lg).call(this,{hasSelectedEditor:!1})}}isActive(vI){return k(this,KI)===vI}getActive(){return k(this,KI)}getMode(){return k(this,XI)}}A.AnnotationEditorUIManager=OI;function qI(){k(this,cI).addEventListener("keydown",k(this,mI))}function gg(){k(this,cI).removeEventListener("keydown",k(this,mI))}function lg(eg){Object.entries(eg).some(Cg=>{let[Gg,Kg]=Cg;return k(this,AI)[Gg]!==Kg})&&k(this,pI).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(k(this,AI),eg)})}function sg(eg){k(this,pI).dispatch("annotationeditorparamschanged",{source:this,details:eg})}function tg(){if(!k(this,PI)){H(this,PI,!0);for(const eg of k(this,NI).values())eg.enable()}}function ig(){if(this.unselectAll(),k(this,PI)){H(this,PI,!1);for(const eg of k(this,NI).values())eg.disable()}}function Xg(eg){const vI=k(this,NI).get(eg.pageIndex);vI?vI.addOrRebuild(eg):this.addEditor(eg)}function rg(){if(k(this,DI).size===0)return!0;if(k(this,DI).size===1)for(const eg of k(this,DI).values())return eg.isEmpty();return!1}function mg(eg){k(this,tI).clear();for(const vI of eg)vI.isEmpty()||(k(this,tI).add(vI),vI.select());B(this,uI,lg).call(this,{hasSelectedEditor:!0})}a(OI,"_keyboardManager",new aI([[["ctrl+a","mac+meta+a"],OI.prototype.selectAll],[["ctrl+c","mac+meta+c"],OI.prototype.copy],[["ctrl+v","mac+meta+v"],OI.prototype.paste],[["ctrl+x","mac+meta+x"],OI.prototype.cut],[["ctrl+z","mac+meta+z"],OI.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],OI.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],OI.prototype.delete],[["Escape","mac+Escape"],OI.prototype.unselectAll]]))},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.StatTimer=A.RenderingCancelledException=A.PixelsPerInch=A.PageViewport=A.PDFDateString=A.DOMStandardFontDataFactory=A.DOMSVGFactory=A.DOMCanvasFactory=A.DOMCMapReaderFactory=A.AnnotationPrefix=void 0,A.deprecated=dI,A.getColorValues=HI,A.getCurrentTransform=MI,A.getCurrentTransformInverse=KI,A.getFilenameFromUrl=E,A.getPdfFilenameFromUrl=_,A.getRGB=GI,A.getXfaPageViewport=WI,A.isDataScheme=sI,A.isPdfFile=oI,A.isValidFetchUrl=M,A.loadScript=O;var o=l(134),t=l(1);function a(DI,NI,yI){return NI in DI?Object.defineProperty(DI,NI,{value:yI,enumerable:!0,configurable:!0,writable:!0}):DI[NI]=yI,DI}const n="http://www.w3.org/2000/svg",B="pdfjs_internal_id_";A.AnnotationPrefix=B;class R{}A.PixelsPerInch=R,a(R,"CSS",96),a(R,"PDF",72),a(R,"PDF_TO_CSS_UNITS",R.CSS/R.PDF);class r extends o.BaseCanvasFactory{constructor(){let{ownerDocument:NI=globalThis.document}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this._document=NI}_createCanvas(NI,yI){const VI=this._document.createElement("canvas");return VI.width=NI,VI.height=yI,VI}}A.DOMCanvasFactory=r;async function H(DI){let NI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(M(DI,document.baseURI)){const yI=await fetch(DI);if(!yI.ok)throw new Error(yI.statusText);return NI?new Uint8Array(await yI.arrayBuffer()):(0,t.stringToBytes)(await yI.text())}return new Promise((yI,VI)=>{const hI=new XMLHttpRequest;hI.open("GET",DI,!0),NI&&(hI.responseType="arraybuffer"),hI.onreadystatechange=()=>{if(hI.readyState===XMLHttpRequest.DONE){if(hI.status===200||hI.status===0){let wI;if(NI&&hI.response?wI=new Uint8Array(hI.response):!NI&&hI.responseText&&(wI=(0,t.stringToBytes)(hI.responseText)),wI){yI(wI);return}}VI(new Error(hI.statusText))}},hI.send(null)})}class II extends o.BaseCMapReaderFactory{_fetchData(NI,yI){return H(NI,this.isCompressed).then(VI=>({cMapData:VI,compressionType:yI}))}}A.DOMCMapReaderFactory=II;class k extends o.BaseStandardFontDataFactory{_fetchData(NI){return H(NI,!0)}}A.DOMStandardFontDataFactory=k;class iI extends o.BaseSVGFactory{_createSVG(NI){return document.createElementNS(n,NI)}}A.DOMSVGFactory=iI;class lI{constructor(NI){let{viewBox:yI,scale:VI,rotation:hI,offsetX:wI=0,offsetY:pI=0,dontFlip:xI=!1}=NI;this.viewBox=yI,this.scale=VI,this.rotation=hI,this.offsetX=wI,this.offsetY=pI;const PI=(yI[2]+yI[0])/2,XI=(yI[3]+yI[1])/2;let tI,mI,YI,BI;switch(hI%=360,hI<0&&(hI+=360),hI){case 180:tI=-1,mI=0,YI=0,BI=1;break;case 90:tI=0,mI=1,YI=1,BI=0;break;case 270:tI=0,mI=-1,YI=-1,BI=0;break;case 0:tI=1,mI=0,YI=0,BI=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}xI&&(YI=-YI,BI=-BI);let AI,cI,bI,nI;tI===0?(AI=Math.abs(XI-yI[1])*VI+wI,cI=Math.abs(PI-yI[0])*VI+pI,bI=Math.abs(yI[3]-yI[1])*VI,nI=Math.abs(yI[2]-yI[0])*VI):(AI=Math.abs(PI-yI[0])*VI+wI,cI=Math.abs(XI-yI[1])*VI+pI,bI=Math.abs(yI[2]-yI[0])*VI,nI=Math.abs(yI[3]-yI[1])*VI),this.transform=[tI*VI,mI*VI,YI*VI,BI*VI,AI-tI*VI*PI-YI*VI*XI,cI-mI*VI*PI-BI*VI*XI],this.width=bI,this.height=nI}clone(){let{scale:NI=this.scale,rotation:yI=this.rotation,offsetX:VI=this.offsetX,offsetY:hI=this.offsetY,dontFlip:wI=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new lI({viewBox:this.viewBox.slice(),scale:NI,rotation:yI,offsetX:VI,offsetY:hI,dontFlip:wI})}convertToViewportPoint(NI,yI){return t.Util.applyTransform([NI,yI],this.transform)}convertToViewportRectangle(NI){const yI=t.Util.applyTransform([NI[0],NI[1]],this.transform),VI=t.Util.applyTransform([NI[2],NI[3]],this.transform);return[yI[0],yI[1],VI[0],VI[1]]}convertToPdfPoint(NI,yI){return t.Util.applyInverseTransform([NI,yI],this.transform)}}A.PageViewport=lI;class CI extends t.BaseException{constructor(NI,yI){super(NI,"RenderingCancelledException"),this.type=yI}}A.RenderingCancelledException=CI;function sI(DI){const NI=DI.length;let yI=0;for(;yI<NI&&DI[yI].trim()==="";)yI++;return DI.substring(yI,yI+5).toLowerCase()==="data:"}function oI(DI){return typeof DI=="string"&&/\.pdf$/i.test(DI)}function E(DI){const NI=DI.indexOf("#"),yI=DI.indexOf("?"),VI=Math.min(NI>0?NI:DI.length,yI>0?yI:DI.length);return DI.substring(DI.lastIndexOf("/",VI)+1,VI)}function _(DI){let NI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"document.pdf";if(typeof DI!="string")return NI;if(sI(DI))return(0,t.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),NI;const yI=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,VI=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,hI=yI.exec(DI);let wI=VI.exec(hI[1])||VI.exec(hI[2])||VI.exec(hI[3]);if(wI&&(wI=wI[0],wI.includes("%")))try{wI=VI.exec(decodeURIComponent(wI))[0]}catch{}return wI||NI}class gI{constructor(){this.started=Object.create(null),this.times=[]}time(NI){NI in this.started&&(0,t.warn)(`Timer is already running for ${NI}`),this.started[NI]=Date.now()}timeEnd(NI){NI in this.started||(0,t.warn)(`Timer has not been started for ${NI}`),this.times.push({name:NI,start:this.started[NI],end:Date.now()}),delete this.started[NI]}toString(){const NI=[];let yI=0;for(const VI of this.times){const hI=VI.name;hI.length>yI&&(yI=hI.length)}for(const VI of this.times){const hI=VI.end-VI.start;NI.push(`${VI.name.padEnd(yI)} ${hI}ms
`)}return NI.join("")}}A.StatTimer=gI;function M(DI,NI){try{const{protocol:yI}=NI?new URL(DI,NI):new URL(DI);return yI==="http:"||yI==="https:"}catch{return!1}}function O(DI){let NI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise((yI,VI)=>{const hI=document.createElement("script");hI.src=DI,hI.onload=function(wI){NI&&hI.remove(),yI(wI)},hI.onerror=function(){VI(new Error(`Cannot load script at: ${hI.src}`))},(document.head||document.documentElement).append(hI)})}function dI(DI){console.log("Deprecated API usage: "+DI)}let eI;class aI{static toDateObject(NI){if(!NI||typeof NI!="string")return null;eI||(eI=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const yI=eI.exec(NI);if(!yI)return null;const VI=parseInt(yI[1],10);let hI=parseInt(yI[2],10);hI=hI>=1&&hI<=12?hI-1:0;let wI=parseInt(yI[3],10);wI=wI>=1&&wI<=31?wI:1;let pI=parseInt(yI[4],10);pI=pI>=0&&pI<=23?pI:0;let xI=parseInt(yI[5],10);xI=xI>=0&&xI<=59?xI:0;let PI=parseInt(yI[6],10);PI=PI>=0&&PI<=59?PI:0;const XI=yI[7]||"Z";let tI=parseInt(yI[8],10);tI=tI>=0&&tI<=23?tI:0;let mI=parseInt(yI[9],10)||0;return mI=mI>=0&&mI<=59?mI:0,XI==="-"?(pI+=tI,xI+=mI):XI==="+"&&(pI-=tI,xI-=mI),new Date(Date.UTC(VI,hI,wI,pI,xI,PI))}}A.PDFDateString=aI;function WI(DI,NI){let{scale:yI=1,rotation:VI=0}=NI;const{width:hI,height:wI}=DI.attributes.style,pI=[0,0,parseInt(hI),parseInt(wI)];return new lI({viewBox:pI,scale:yI,rotation:VI})}function GI(DI){if(DI.startsWith("#")){const NI=parseInt(DI.slice(1),16);return[(NI&16711680)>>16,(NI&65280)>>8,NI&255]}return DI.startsWith("rgb(")?DI.slice(4,-1).split(",").map(NI=>parseInt(NI)):DI.startsWith("rgba(")?DI.slice(5,-1).split(",").map(NI=>parseInt(NI)).slice(0,3):((0,t.warn)(`Not a valid color format: "${DI}"`),[0,0,0])}function HI(DI){const NI=document.createElement("span");NI.style.visibility="hidden",document.body.append(NI);for(const yI of DI.keys()){NI.style.color=yI;const VI=window.getComputedStyle(NI).color;DI.set(yI,GI(VI))}NI.remove()}function MI(DI){const{a:NI,b:yI,c:VI,d:hI,e:wI,f:pI}=DI.getTransform();return[NI,yI,VI,hI,wI,pI]}function KI(DI){const{a:NI,b:yI,c:VI,d:hI,e:wI,f:pI}=DI.getTransform().invertSelf();return[NI,yI,VI,hI,wI,pI]}},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.BaseStandardFontDataFactory=A.BaseSVGFactory=A.BaseCanvasFactory=A.BaseCMapReaderFactory=void 0;var o=l(1);class t{constructor(){this.constructor===t&&(0,o.unreachable)("Cannot initialize BaseCanvasFactory.")}create(r,H){if(r<=0||H<=0)throw new Error("Invalid canvas size");const II=this._createCanvas(r,H);return{canvas:II,context:II.getContext("2d")}}reset(r,H,II){if(!r.canvas)throw new Error("Canvas is not specified");if(H<=0||II<=0)throw new Error("Invalid canvas size");r.canvas.width=H,r.canvas.height=II}destroy(r){if(!r.canvas)throw new Error("Canvas is not specified");r.canvas.width=0,r.canvas.height=0,r.canvas=null,r.context=null}_createCanvas(r,H){(0,o.unreachable)("Abstract method `_createCanvas` called.")}}A.BaseCanvasFactory=t;class a{constructor(r){let{baseUrl:H=null,isCompressed:II=!1}=r;this.constructor===a&&(0,o.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=H,this.isCompressed=II}async fetch(r){let{name:H}=r;if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!H)throw new Error("CMap name must be specified.");const II=this.baseUrl+H+(this.isCompressed?".bcmap":""),k=this.isCompressed?o.CMapCompressionType.BINARY:o.CMapCompressionType.NONE;return this._fetchData(II,k).catch(iI=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${II}`)})}_fetchData(r,H){(0,o.unreachable)("Abstract method `_fetchData` called.")}}A.BaseCMapReaderFactory=a;class n{constructor(r){let{baseUrl:H=null}=r;this.constructor===n&&(0,o.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=H}async fetch(r){let{filename:H}=r;if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!H)throw new Error("Font filename must be specified.");const II=`${this.baseUrl}${H}`;return this._fetchData(II).catch(k=>{throw new Error(`Unable to load font data at: ${II}`)})}_fetchData(r){(0,o.unreachable)("Abstract method `_fetchData` called.")}}A.BaseStandardFontDataFactory=n;class B{constructor(){this.constructor===B&&(0,o.unreachable)("Cannot initialize BaseSVGFactory.")}create(r,H){let II=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(r<=0||H<=0)throw new Error("Invalid SVG dimensions");const k=this._createSVG("svg:svg");return k.setAttribute("version","1.1"),II||(k.setAttribute("width",`${r}px`),k.setAttribute("height",`${H}px`)),k.setAttribute("preserveAspectRatio","none"),k.setAttribute("viewBox",`0 0 ${r} ${H}`),k}createElement(r){if(typeof r!="string")throw new Error("Invalid SVG element type");return this._createSVG(r)}_createSVG(r){(0,o.unreachable)("Abstract method `_createSVG` called.")}}A.BaseSVGFactory=B},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.MurmurHash3_64=void 0;var o=l(1);const t=3285377520,a=4294901760,n=65535;class B{constructor(r){this.h1=r?r&4294967295:t,this.h2=r?r&4294967295:t}update(r){let H,II;if(typeof r=="string"){H=new Uint8Array(r.length*2),II=0;for(let dI=0,eI=r.length;dI<eI;dI++){const aI=r.charCodeAt(dI);aI<=255?H[II++]=aI:(H[II++]=aI>>>8,H[II++]=aI&255)}}else if((0,o.isArrayBuffer)(r))H=r.slice(),II=H.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const k=II>>2,iI=II-k*4,lI=new Uint32Array(H.buffer,0,k);let CI=0,sI=0,oI=this.h1,E=this.h2;const _=3432918353,gI=461845907,M=_&n,O=gI&n;for(let dI=0;dI<k;dI++)dI&1?(CI=lI[dI],CI=CI*_&a|CI*M&n,CI=CI<<15|CI>>>17,CI=CI*gI&a|CI*O&n,oI^=CI,oI=oI<<13|oI>>>19,oI=oI*5+3864292196):(sI=lI[dI],sI=sI*_&a|sI*M&n,sI=sI<<15|sI>>>17,sI=sI*gI&a|sI*O&n,E^=sI,E=E<<13|E>>>19,E=E*5+3864292196);switch(CI=0,iI){case 3:CI^=H[k*4+2]<<16;case 2:CI^=H[k*4+1]<<8;case 1:CI^=H[k*4],CI=CI*_&a|CI*M&n,CI=CI<<15|CI>>>17,CI=CI*gI&a|CI*O&n,k&1?oI^=CI:E^=CI}this.h1=oI,this.h2=E}hexdigest(){let r=this.h1,H=this.h2;r^=H>>>1,r=r*3981806797&a|r*36045&n,H=H*4283543511&a|((H<<16|r>>>16)*2950163797&a)>>>16,r^=H>>>1,r=r*444984403&a|r*60499&n,H=H*3301882366&a|((H<<16|r>>>16)*3120437893&a)>>>16,r^=H>>>1;const II=(r>>>0).toString(16),k=(H>>>0).toString(16);return II.padStart(8,"0")+k.padStart(8,"0")}}A.MurmurHash3_64=B},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.FontLoader=A.FontFaceObject=void 0;var o=l(1);class t{constructor(R){let{docId:r,onUnsupportedFeature:H,ownerDocument:II=globalThis.document,styleElement:k=null}=R;this.constructor===t&&(0,o.unreachable)("Cannot initialize BaseFontLoader."),this.docId=r,this._onUnsupportedFeature=H,this._document=II,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(R){this.nativeFontFaces.push(R),this._document.fonts.add(R)}insertRule(R){let r=this.styleElement;r||(r=this.styleElement=this._document.createElement("style"),r.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(r));const H=r.sheet;H.insertRule(R,H.cssRules.length)}clear(){for(const R of this.nativeFontFaces)this._document.fonts.delete(R);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(R){if(R.attached||R.missingFile)return;if(R.attached=!0,this.isFontLoadingAPISupported){const H=R.createNativeFontFace();if(H){this.addNativeFontFace(H);try{await H.loaded}catch(II){throw this._onUnsupportedFeature({featureId:o.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,o.warn)(`Failed to load font '${H.family}': '${II}'.`),R.disableFontFace=!0,II}}return}const r=R.createFontFaceRule();if(r){if(this.insertRule(r),this.isSyncFontLoadingSupported)return;await new Promise(H=>{const II=this._queueLoadingCallback(H);this._prepareFontLoadEvent([r],[R],II)})}}_queueLoadingCallback(R){(0,o.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var R;const r=!!((R=this._document)!==null&&R!==void 0&&R.fonts);return(0,o.shadow)(this,"isFontLoadingAPISupported",r)}get isSyncFontLoadingSupported(){(0,o.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,o.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(R,r,H){(0,o.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let a;A.FontLoader=a,A.FontLoader=a=class extends t{constructor(R){super(R),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let R=!1;if(typeof navigator>"u")R=!0;else{const r=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);r?.[1]>=14&&(R=!0)}return(0,o.shadow)(this,"isSyncFontLoadingSupported",R)}_queueLoadingCallback(R){function r(){for((0,o.assert)(!II.done,"completeRequest() cannot be called twice."),II.done=!0;H.requests.length>0&&H.requests[0].done;){const k=H.requests.shift();setTimeout(k.callback,0)}}const H=this.loadingContext,II={id:`pdfjs-font-loading-${H.nextRequestId++}`,done:!1,complete:r,callback:R};return H.requests.push(II),II}get _loadTestFont(){const R=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,o.shadow)(this,"_loadTestFont",R())}_prepareFontLoadEvent(R,r,H){function II(MI,KI){return MI.charCodeAt(KI)<<24|MI.charCodeAt(KI+1)<<16|MI.charCodeAt(KI+2)<<8|MI.charCodeAt(KI+3)&255}function k(MI,KI,DI,NI){const yI=MI.substring(0,KI),VI=MI.substring(KI+DI);return yI+NI+VI}let iI,lI;const CI=this._document.createElement("canvas");CI.width=1,CI.height=1;const sI=CI.getContext("2d");let oI=0;function E(MI,KI){if(oI++,oI>30){(0,o.warn)("Load test font never loaded."),KI();return}if(sI.font="30px "+MI,sI.fillText(".",0,20),sI.getImageData(0,0,1,1).data[3]>0){KI();return}setTimeout(E.bind(null,MI,KI))}const _=`lt${Date.now()}${this.loadTestFontId++}`;let gI=this._loadTestFont;gI=k(gI,976,_.length,_);const O=16,dI=1482184792;let eI=II(gI,O);for(iI=0,lI=_.length-3;iI<lI;iI+=4)eI=eI-dI+II(_,iI)|0;iI<_.length&&(eI=eI-dI+II(_+"XXX",iI)|0),gI=k(gI,O,4,(0,o.string32)(eI));const aI=`url(data:font/opentype;base64,${btoa(gI)});`,WI=`@font-face {font-family:"${_}";src:${aI}}`;this.insertRule(WI);const GI=[];for(const MI of r)GI.push(MI.loadedName);GI.push(_);const HI=this._document.createElement("div");HI.style.visibility="hidden",HI.style.width=HI.style.height="10px",HI.style.position="absolute",HI.style.top=HI.style.left="0px";for(const MI of GI){const KI=this._document.createElement("span");KI.textContent="Hi",KI.style.fontFamily=MI,HI.append(KI)}this._document.body.append(HI),E(_,()=>{HI.remove(),H.complete()})}};class n{constructor(R,r){let{isEvalSupported:H=!0,disableFontFace:II=!1,ignoreErrors:k=!1,onUnsupportedFeature:iI,fontRegistry:lI=null}=r;this.compiledGlyphs=Object.create(null);for(const CI in R)this[CI]=R[CI];this.isEvalSupported=H!==!1,this.disableFontFace=II===!0,this.ignoreErrors=k===!0,this._onUnsupportedFeature=iI,this.fontRegistry=lI}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let R;if(!this.cssFontInfo)R=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),R=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return this.fontRegistry&&this.fontRegistry.registerFont(this),R}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const R=(0,o.bytesToString)(this.data),r=`url(data:${this.mimetype};base64,${btoa(R)});`;let H;if(!this.cssFontInfo)H=`@font-face {font-family:"${this.loadedName}";src:${r}}`;else{let II=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(II+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),H=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${II}src:${r}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,r),H}getPathGenerator(R,r){if(this.compiledGlyphs[r]!==void 0)return this.compiledGlyphs[r];let H;try{H=R.get(this.loadedName+"_path_"+r)}catch(II){if(!this.ignoreErrors)throw II;return this._onUnsupportedFeature({featureId:o.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,o.warn)(`getPathGenerator - ignoring character: "${II}".`),this.compiledGlyphs[r]=function(k,iI){}}if(this.isEvalSupported&&o.FeatureTest.isEvalSupported){const II=[];for(const k of H){const iI=k.args!==void 0?k.args.join(","):"";II.push("c.",k.cmd,"(",iI,`);
`)}return this.compiledGlyphs[r]=new Function("c","size",II.join(""))}return this.compiledGlyphs[r]=function(II,k){for(const iI of H)iI.cmd==="scale"&&(iI.args=[k,-k]),II[iI.cmd].apply(II,iI.args)}}}A.FontFaceObject=n},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.CanvasGraphics=void 0;var o=l(133),t=l(1),a=l(138),n=l(139),B=l(3);function R(XI,tI){r(XI,tI),tI.add(XI)}function r(XI,tI){if(tI.has(XI))throw new TypeError("Cannot initialize the same private elements twice on an object")}function H(XI,tI,mI){if(!tI.has(XI))throw new TypeError("attempted to get private field on non-instance");return mI}const II=16,k=100,iI=4096,lI=15,CI=10,sI=B.isNodeJS&&typeof Path2D>"u"?-1:1e3,oI=16;function E(XI,tI){if(XI._removeMirroring)throw new Error("Context is already forwarding operations.");XI.__originalSave=XI.save,XI.__originalRestore=XI.restore,XI.__originalRotate=XI.rotate,XI.__originalScale=XI.scale,XI.__originalTranslate=XI.translate,XI.__originalTransform=XI.transform,XI.__originalSetTransform=XI.setTransform,XI.__originalResetTransform=XI.resetTransform,XI.__originalClip=XI.clip,XI.__originalMoveTo=XI.moveTo,XI.__originalLineTo=XI.lineTo,XI.__originalBezierCurveTo=XI.bezierCurveTo,XI.__originalRect=XI.rect,XI.__originalClosePath=XI.closePath,XI.__originalBeginPath=XI.beginPath,XI._removeMirroring=()=>{XI.save=XI.__originalSave,XI.restore=XI.__originalRestore,XI.rotate=XI.__originalRotate,XI.scale=XI.__originalScale,XI.translate=XI.__originalTranslate,XI.transform=XI.__originalTransform,XI.setTransform=XI.__originalSetTransform,XI.resetTransform=XI.__originalResetTransform,XI.clip=XI.__originalClip,XI.moveTo=XI.__originalMoveTo,XI.lineTo=XI.__originalLineTo,XI.bezierCurveTo=XI.__originalBezierCurveTo,XI.rect=XI.__originalRect,XI.closePath=XI.__originalClosePath,XI.beginPath=XI.__originalBeginPath,delete XI._removeMirroring},XI.save=function(){tI.save(),this.__originalSave()},XI.restore=function(){tI.restore(),this.__originalRestore()},XI.translate=function(YI,BI){tI.translate(YI,BI),this.__originalTranslate(YI,BI)},XI.scale=function(YI,BI){tI.scale(YI,BI),this.__originalScale(YI,BI)},XI.transform=function(YI,BI,AI,cI,bI,nI){tI.transform(YI,BI,AI,cI,bI,nI),this.__originalTransform(YI,BI,AI,cI,bI,nI)},XI.setTransform=function(YI,BI,AI,cI,bI,nI){tI.setTransform(YI,BI,AI,cI,bI,nI),this.__originalSetTransform(YI,BI,AI,cI,bI,nI)},XI.resetTransform=function(){tI.resetTransform(),this.__originalResetTransform()},XI.rotate=function(YI){tI.rotate(YI),this.__originalRotate(YI)},XI.clip=function(YI){tI.clip(YI),this.__originalClip(YI)},XI.moveTo=function(mI,YI){tI.moveTo(mI,YI),this.__originalMoveTo(mI,YI)},XI.lineTo=function(mI,YI){tI.lineTo(mI,YI),this.__originalLineTo(mI,YI)},XI.bezierCurveTo=function(mI,YI,BI,AI,cI,bI){tI.bezierCurveTo(mI,YI,BI,AI,cI,bI),this.__originalBezierCurveTo(mI,YI,BI,AI,cI,bI)},XI.rect=function(mI,YI,BI,AI){tI.rect(mI,YI,BI,AI),this.__originalRect(mI,YI,BI,AI)},XI.closePath=function(){tI.closePath(),this.__originalClosePath()},XI.beginPath=function(){tI.beginPath(),this.__originalBeginPath()}}class _{constructor(tI){this.canvasFactory=tI,this.cache=Object.create(null)}getCanvas(tI,mI,YI){let BI;return this.cache[tI]!==void 0?(BI=this.cache[tI],this.canvasFactory.reset(BI,mI,YI)):(BI=this.canvasFactory.create(mI,YI),this.cache[tI]=BI),BI}delete(tI){delete this.cache[tI]}clear(){for(const tI in this.cache){const mI=this.cache[tI];this.canvasFactory.destroy(mI),delete this.cache[tI]}}}function gI(XI,tI,mI,YI,BI,AI,cI,bI,nI,uI){const[rI,FI,kI,TI,QI,fI]=(0,o.getCurrentTransform)(XI);if(FI===0&&kI===0){const gg=cI*rI+QI,lg=Math.round(gg),sg=bI*TI+fI,tg=Math.round(sg),ig=(cI+nI)*rI+QI,Xg=Math.abs(Math.round(ig)-lg)||1,rg=(bI+uI)*TI+fI,mg=Math.abs(Math.round(rg)-tg)||1;return XI.setTransform(Math.sign(rI),0,0,Math.sign(TI),lg,tg),XI.drawImage(tI,mI,YI,BI,AI,0,0,Xg,mg),XI.setTransform(rI,FI,kI,TI,QI,fI),[Xg,mg]}if(rI===0&&TI===0){const gg=bI*kI+QI,lg=Math.round(gg),sg=cI*FI+fI,tg=Math.round(sg),ig=(bI+uI)*kI+QI,Xg=Math.abs(Math.round(ig)-lg)||1,rg=(cI+nI)*FI+fI,mg=Math.abs(Math.round(rg)-tg)||1;return XI.setTransform(0,Math.sign(FI),Math.sign(kI),0,lg,tg),XI.drawImage(tI,mI,YI,BI,AI,0,0,mg,Xg),XI.setTransform(rI,FI,kI,TI,QI,fI),[mg,Xg]}XI.drawImage(tI,mI,YI,BI,AI,cI,bI,nI,uI);const OI=Math.hypot(rI,FI),qI=Math.hypot(kI,TI);return[OI*nI,qI*uI]}function M(XI){const{width:tI,height:mI}=XI;if(tI>sI||mI>sI)return null;const YI=1e3,BI=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),AI=tI+1;let cI=new Uint8Array(AI*(mI+1)),bI,nI,uI;const rI=tI+7&-8;let FI=new Uint8Array(rI*mI),kI=0;for(const qI of XI.data){let gg=128;for(;gg>0;)FI[kI++]=qI&gg?0:255,gg>>=1}let TI=0;for(kI=0,FI[kI]!==0&&(cI[0]=1,++TI),nI=1;nI<tI;nI++)FI[kI]!==FI[kI+1]&&(cI[nI]=FI[kI]?2:1,++TI),kI++;for(FI[kI]!==0&&(cI[nI]=2,++TI),bI=1;bI<mI;bI++){kI=bI*rI,uI=bI*AI,FI[kI-rI]!==FI[kI]&&(cI[uI]=FI[kI]?1:8,++TI);let qI=(FI[kI]?4:0)+(FI[kI-rI]?8:0);for(nI=1;nI<tI;nI++)qI=(qI>>2)+(FI[kI+1]?4:0)+(FI[kI-rI+1]?8:0),BI[qI]&&(cI[uI+nI]=BI[qI],++TI),kI++;if(FI[kI-rI]!==FI[kI]&&(cI[uI+nI]=FI[kI]?2:4,++TI),TI>YI)return null}for(kI=rI*(mI-1),uI=bI*AI,FI[kI]!==0&&(cI[uI]=8,++TI),nI=1;nI<tI;nI++)FI[kI]!==FI[kI+1]&&(cI[uI+nI]=FI[kI]?4:8,++TI),kI++;if(FI[kI]!==0&&(cI[uI+nI]=4,++TI),TI>YI)return null;const QI=new Int32Array([0,AI,-1,0,-AI,0,0,0,1]),fI=new Path2D;for(bI=0;TI&&bI<=mI;bI++){let qI=bI*AI;const gg=qI+tI;for(;qI<gg&&!cI[qI];)qI++;if(qI===gg)continue;fI.moveTo(qI%AI,bI);const lg=qI;let sg=cI[qI];do{const tg=QI[sg];do qI+=tg;while(!cI[qI]);const ig=cI[qI];ig!==5&&ig!==10?(sg=ig,cI[qI]=0):(sg=ig&51*sg>>4,cI[qI]&=sg>>2|sg<<2),fI.lineTo(qI%AI,qI/AI|0),cI[qI]||--TI}while(lg!==qI);--bI}return FI=null,cI=null,function(qI){qI.save(),qI.scale(1/tI,-1/mI),qI.translate(0,-mI),qI.fill(fI),qI.beginPath(),qI.restore()}}class O{constructor(tI,mI){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=t.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=t.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,tI,mI])}clone(){const tI=Object.create(this);return tI.clipBox=this.clipBox.slice(),tI}setCurrentPoint(tI,mI){this.x=tI,this.y=mI}updatePathMinMax(tI,mI,YI){[mI,YI]=t.Util.applyTransform([mI,YI],tI),this.minX=Math.min(this.minX,mI),this.minY=Math.min(this.minY,YI),this.maxX=Math.max(this.maxX,mI),this.maxY=Math.max(this.maxY,YI)}updateRectMinMax(tI,mI){const YI=t.Util.applyTransform(mI,tI),BI=t.Util.applyTransform(mI.slice(2),tI);this.minX=Math.min(this.minX,YI[0],BI[0]),this.minY=Math.min(this.minY,YI[1],BI[1]),this.maxX=Math.max(this.maxX,YI[0],BI[0]),this.maxY=Math.max(this.maxY,YI[1],BI[1])}updateScalingPathMinMax(tI,mI){t.Util.scaleMinMax(tI,mI),this.minX=Math.min(this.minX,mI[0]),this.maxX=Math.max(this.maxX,mI[1]),this.minY=Math.min(this.minY,mI[2]),this.maxY=Math.max(this.maxY,mI[3])}updateCurvePathMinMax(tI,mI,YI,BI,AI,cI,bI,nI,uI,rI){const FI=t.Util.bezierBoundingBox(mI,YI,BI,AI,cI,bI,nI,uI);if(rI){rI[0]=Math.min(rI[0],FI[0],FI[2]),rI[1]=Math.max(rI[1],FI[0],FI[2]),rI[2]=Math.min(rI[2],FI[1],FI[3]),rI[3]=Math.max(rI[3],FI[1],FI[3]);return}this.updateRectMinMax(tI,FI)}getPathBoundingBox(){let tI=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a.PathType.FILL,mI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const YI=[this.minX,this.minY,this.maxX,this.maxY];if(tI===a.PathType.STROKE){mI||(0,t.unreachable)("Stroke bounding box must include transform.");const BI=t.Util.singularValueDecompose2dScale(mI),AI=BI[0]*this.lineWidth/2,cI=BI[1]*this.lineWidth/2;YI[0]-=AI,YI[1]-=cI,YI[2]+=AI,YI[3]+=cI}return YI}updateClipFromPath(){const tI=t.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(tI||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(tI){this.clipBox=tI,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(){let tI=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a.PathType.FILL,mI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return t.Util.intersect(this.clipBox,this.getPathBoundingBox(tI,mI))}}function dI(XI,tI){let mI=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(typeof ImageData<"u"&&tI instanceof ImageData){XI.putImageData(tI,0,0);return}const YI=tI.height,BI=tI.width,AI=YI%oI,cI=(YI-AI)/oI,bI=AI===0?cI:cI+1,nI=XI.createImageData(BI,oI);let uI=0,rI;const FI=tI.data,kI=nI.data;let TI,QI,fI,OI,qI,gg,lg,sg;if(mI)switch(mI.length){case 1:qI=mI[0],gg=mI[0],lg=mI[0],sg=mI[0];break;case 4:qI=mI[0],gg=mI[1],lg=mI[2],sg=mI[3];break}if(tI.kind===t.ImageKind.GRAYSCALE_1BPP){const tg=FI.byteLength,ig=new Uint32Array(kI.buffer,0,kI.byteLength>>2),Xg=ig.length,rg=BI+7>>3;let mg=4294967295,eg=t.FeatureTest.isLittleEndian?4278190080:255;for(sg&&sg[0]===255&&sg[255]===0&&([mg,eg]=[eg,mg]),TI=0;TI<bI;TI++){for(fI=TI<cI?oI:AI,rI=0,QI=0;QI<fI;QI++){const vI=tg-uI;let Cg=0;const Gg=vI>rg?BI:vI*8-7,Kg=Gg&-8;let Ig=0,og=0;for(;Cg<Kg;Cg+=8)og=FI[uI++],ig[rI++]=og&128?mg:eg,ig[rI++]=og&64?mg:eg,ig[rI++]=og&32?mg:eg,ig[rI++]=og&16?mg:eg,ig[rI++]=og&8?mg:eg,ig[rI++]=og&4?mg:eg,ig[rI++]=og&2?mg:eg,ig[rI++]=og&1?mg:eg;for(;Cg<Gg;Cg++)Ig===0&&(og=FI[uI++],Ig=128),ig[rI++]=og&Ig?mg:eg,Ig>>=1}for(;rI<Xg;)ig[rI++]=0;XI.putImageData(nI,0,TI*oI)}}else if(tI.kind===t.ImageKind.RGBA_32BPP){const tg=!!(qI||gg||lg);for(QI=0,OI=BI*oI*4,TI=0;TI<cI;TI++){if(kI.set(FI.subarray(uI,uI+OI)),uI+=OI,tg)for(let ig=0;ig<OI;ig+=4)qI&&(kI[ig+0]=qI[kI[ig+0]]),gg&&(kI[ig+1]=gg[kI[ig+1]]),lg&&(kI[ig+2]=lg[kI[ig+2]]);XI.putImageData(nI,0,QI),QI+=oI}if(TI<bI){if(OI=BI*AI*4,kI.set(FI.subarray(uI,uI+OI)),tg)for(let ig=0;ig<OI;ig+=4)qI&&(kI[ig+0]=qI[kI[ig+0]]),gg&&(kI[ig+1]=gg[kI[ig+1]]),lg&&(kI[ig+2]=lg[kI[ig+2]]);XI.putImageData(nI,0,QI)}}else if(tI.kind===t.ImageKind.RGB_24BPP){const tg=!!(qI||gg||lg);for(fI=oI,OI=BI*fI,TI=0;TI<bI;TI++){for(TI>=cI&&(fI=AI,OI=BI*fI),rI=0,QI=OI;QI--;)kI[rI++]=FI[uI++],kI[rI++]=FI[uI++],kI[rI++]=FI[uI++],kI[rI++]=255;if(tg)for(let ig=0;ig<rI;ig+=4)qI&&(kI[ig+0]=qI[kI[ig+0]]),gg&&(kI[ig+1]=gg[kI[ig+1]]),lg&&(kI[ig+2]=lg[kI[ig+2]]);XI.putImageData(nI,0,TI*oI)}}else throw new Error(`bad image kind: ${tI.kind}`)}function eI(XI,tI){if(tI.bitmap){XI.drawImage(tI.bitmap,0,0);return}const mI=tI.height,YI=tI.width,BI=mI%oI,AI=(mI-BI)/oI,cI=BI===0?AI:AI+1,bI=XI.createImageData(YI,oI);let nI=0;const uI=tI.data,rI=bI.data;for(let FI=0;FI<cI;FI++){const kI=FI<AI?oI:BI;({srcPos:nI}=(0,n.applyMaskImageData)({src:uI,srcPos:nI,dest:rI,width:YI,height:kI})),XI.putImageData(bI,0,FI*oI)}}function aI(XI,tI){const mI=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let YI=0,BI=mI.length;YI<BI;YI++){const AI=mI[YI];XI[AI]!==void 0&&(tI[AI]=XI[AI])}XI.setLineDash!==void 0&&(tI.setLineDash(XI.getLineDash()),tI.lineDashOffset=XI.lineDashOffset)}function WI(XI,tI){XI.strokeStyle=XI.fillStyle=tI||"#000000",XI.fillRule="nonzero",XI.globalAlpha=1,XI.lineWidth=1,XI.lineCap="butt",XI.lineJoin="miter",XI.miterLimit=10,XI.globalCompositeOperation="source-over",XI.font="10px sans-serif",XI.setLineDash!==void 0&&(XI.setLineDash([]),XI.lineDashOffset=0)}function GI(XI,tI,mI,YI){const BI=XI.length;for(let AI=3;AI<BI;AI+=4){const cI=XI[AI];if(cI===0)XI[AI-3]=tI,XI[AI-2]=mI,XI[AI-1]=YI;else if(cI<255){const bI=255-cI;XI[AI-3]=XI[AI-3]*cI+tI*bI>>8,XI[AI-2]=XI[AI-2]*cI+mI*bI>>8,XI[AI-1]=XI[AI-1]*cI+YI*bI>>8}}}function HI(XI,tI,mI){const YI=XI.length,BI=1/255;for(let AI=3;AI<YI;AI+=4){const cI=mI?mI[XI[AI]]:XI[AI];tI[AI]=tI[AI]*cI*BI|0}}function MI(XI,tI,mI){const YI=XI.length;for(let BI=3;BI<YI;BI+=4){const AI=XI[BI-3]*77+XI[BI-2]*152+XI[BI-1]*28;tI[BI]=mI?tI[BI]*mI[AI>>8]>>8:tI[BI]*AI>>16}}function KI(XI,tI,mI,YI,BI,AI,cI,bI,nI,uI,rI){const FI=!!AI,kI=FI?AI[0]:0,TI=FI?AI[1]:0,QI=FI?AI[2]:0;let fI;BI==="Luminosity"?fI=MI:fI=HI;const qI=Math.min(YI,Math.ceil(1048576/mI));for(let gg=0;gg<YI;gg+=qI){const lg=Math.min(qI,YI-gg),sg=XI.getImageData(bI-uI,gg+(nI-rI),mI,lg),tg=tI.getImageData(bI,gg+nI,mI,lg);FI&&GI(sg.data,kI,TI,QI),fI(sg.data,tg.data,cI),tI.putImageData(tg,bI,gg+nI)}}function DI(XI,tI,mI,YI){const BI=YI[0],AI=YI[1],cI=YI[2]-BI,bI=YI[3]-AI;cI===0||bI===0||(KI(tI.context,mI,cI,bI,tI.subtype,tI.backdrop,tI.transferMap,BI,AI,tI.offsetX,tI.offsetY),XI.save(),XI.globalAlpha=1,XI.globalCompositeOperation="source-over",XI.setTransform(1,0,0,1,0,0),XI.drawImage(mI.canvas,0,0),XI.restore())}function NI(XI,tI){const mI=t.Util.singularValueDecompose2dScale(XI);mI[0]=Math.fround(mI[0]),mI[1]=Math.fround(mI[1]);const YI=Math.fround((globalThis.devicePixelRatio||1)*o.PixelsPerInch.PDF_TO_CSS_UNITS);return tI!==void 0?tI:mI[0]<=YI||mI[1]<=YI}const yI=["butt","round","square"],VI=["miter","round","bevel"],hI={},wI={};var pI=new WeakSet;class xI{constructor(tI,mI,YI,BI,AI,cI,bI,nI){R(this,pI),this.ctx=tI,this.current=new O(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=mI,this.objs=YI,this.canvasFactory=BI,this.imageLayer=AI,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=cI,this.cachedCanvases=new _(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=bI,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=nI?.background||null,this.foregroundColor=nI?.foreground||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(tI){let mI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof tI=="string"?tI.startsWith("g_")?this.commonObjs.get(tI):this.objs.get(tI):mI}beginDrawing(tI){let{transform:mI,viewport:YI,transparency:BI=!1,background:AI=null}=tI;const cI=this.ctx.canvas.width,bI=this.ctx.canvas.height,nI=AI||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const uI=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const rI=this.backgroundColor=this.ctx.fillStyle;let FI=!0,kI=nI;if(this.ctx.fillStyle=nI,kI=this.ctx.fillStyle,FI=typeof kI=="string"&&/^#[0-9A-Fa-f]{6}$/.test(kI),uI==="#000000"&&rI==="#ffffff"||uI===rI||!FI)this.foregroundColor=this.backgroundColor=null;else{const[TI,QI,fI]=(0,o.getRGB)(kI),OI=gg=>(gg/=255,gg<=.03928?gg/12.92:((gg+.055)/1.055)**2.4),qI=Math.round(.2126*OI(TI)+.7152*OI(QI)+.0722*OI(fI));this.selectColor=(gg,lg,sg)=>{const tg=.2126*OI(gg)+.7152*OI(lg)+.0722*OI(sg);return Math.round(tg)===qI?rI:uI}}}if(this.ctx.fillStyle=this.backgroundColor||nI,this.ctx.fillRect(0,0,cI,bI),this.ctx.restore(),BI){const uI=this.cachedCanvases.getCanvas("transparent",cI,bI);this.compositeCtx=this.ctx,this.transparentCanvas=uI.canvas,this.ctx=uI.context,this.ctx.save(),this.ctx.transform(...(0,o.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),WI(this.ctx,this.foregroundColor),mI&&(this.ctx.transform(...mI),this.outputScaleX=mI[0],this.outputScaleY=mI[0]),this.ctx.transform(...YI.transform),this.viewportScale=YI.scale,this.baseTransform=(0,o.getCurrentTransform)(this.ctx),this.imageLayer&&((0,o.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(tI,mI,YI,BI){const AI=tI.argsArray,cI=tI.fnArray;let bI=mI||0;const nI=AI.length;if(nI===bI)return bI;const uI=nI-bI>CI&&typeof YI=="function",rI=uI?Date.now()+lI:0;let FI=0;const kI=this.commonObjs,TI=this.objs;let QI;for(;;){if(BI!==void 0&&bI===BI.nextBreakPoint)return BI.breakIt(bI,YI),bI;if(QI=cI[bI],QI!==t.OPS.dependency)this[QI].apply(this,AI[bI]);else for(const fI of AI[bI]){const OI=fI.startsWith("g_")?kI:TI;if(!OI.has(fI))return OI.get(fI,YI),bI}if(bI++,bI===nI)return bI;if(uI&&++FI>CI){if(Date.now()>rI)return YI(),bI;FI=0}}}endDrawing(){H(this,pI,PI).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const tI of this._cachedBitmapsMap.values()){for(const mI of tI.values())typeof HTMLCanvasElement<"u"&&mI instanceof HTMLCanvasElement&&(mI.width=mI.height=0);tI.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(tI,mI){const YI=tI.width,BI=tI.height;let AI=Math.max(Math.hypot(mI[0],mI[1]),1),cI=Math.max(Math.hypot(mI[2],mI[3]),1),bI=YI,nI=BI,uI="prescale1",rI,FI;for(;AI>2&&bI>1||cI>2&&nI>1;){let kI=bI,TI=nI;AI>2&&bI>1&&(kI=Math.ceil(bI/2),AI/=bI/kI),cI>2&&nI>1&&(TI=Math.ceil(nI/2),cI/=nI/TI),rI=this.cachedCanvases.getCanvas(uI,kI,TI),FI=rI.context,FI.clearRect(0,0,kI,TI),FI.drawImage(tI,0,0,bI,nI,0,0,kI,TI),tI=rI.canvas,bI=kI,nI=TI,uI=uI==="prescale1"?"prescale2":"prescale1"}return{img:tI,paintWidth:bI,paintHeight:nI}}_createMaskCanvas(tI){const mI=this.ctx,{width:YI,height:BI}=tI,AI=this.current.fillColor,cI=this.current.patternFill,bI=(0,o.getCurrentTransform)(mI);let nI,uI,rI,FI;if((tI.bitmap||tI.data)&&tI.count>1){const Xg=tI.bitmap||tI.data.buffer,rg=bI.slice(0,4);uI=JSON.stringify(cI?rg:[rg,AI]),nI=this._cachedBitmapsMap.get(Xg),nI||(nI=new Map,this._cachedBitmapsMap.set(Xg,nI));const mg=nI.get(uI);if(mg&&!cI){const eg=Math.round(Math.min(bI[0],bI[2])+bI[4]),vI=Math.round(Math.min(bI[1],bI[3])+bI[5]);return{canvas:mg,offsetX:eg,offsetY:vI}}rI=mg}rI||(FI=this.cachedCanvases.getCanvas("maskCanvas",YI,BI),eI(FI.context,tI));let kI=t.Util.transform(bI,[1/YI,0,0,-1/BI,0,0]);kI=t.Util.transform(kI,[1,0,0,1,0,-BI]);const TI=t.Util.applyTransform([0,0],kI),QI=t.Util.applyTransform([YI,BI],kI),fI=t.Util.normalizeRect([TI[0],TI[1],QI[0],QI[1]]),OI=Math.round(fI[2]-fI[0])||1,qI=Math.round(fI[3]-fI[1])||1,gg=this.cachedCanvases.getCanvas("fillCanvas",OI,qI),lg=gg.context,sg=Math.min(TI[0],QI[0]),tg=Math.min(TI[1],QI[1]);lg.translate(-sg,-tg),lg.transform(...kI),rI||(rI=this._scaleImage(FI.canvas,(0,o.getCurrentTransformInverse)(lg)),rI=rI.img,nI&&cI&&nI.set(uI,rI)),lg.imageSmoothingEnabled=NI((0,o.getCurrentTransform)(lg),tI.interpolate),gI(lg,rI,0,0,rI.width,rI.height,0,0,YI,BI),lg.globalCompositeOperation="source-in";const ig=t.Util.transform((0,o.getCurrentTransformInverse)(lg),[1,0,0,1,-sg,-tg]);return lg.fillStyle=cI?AI.getPattern(mI,this,ig,a.PathType.FILL):AI,lg.fillRect(0,0,YI,BI),nI&&!cI&&(this.cachedCanvases.delete("fillCanvas"),nI.set(uI,gg.canvas)),{canvas:gg.canvas,offsetX:Math.round(sg),offsetY:Math.round(tg)}}setLineWidth(tI){tI!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=tI,this.ctx.lineWidth=tI}setLineCap(tI){this.ctx.lineCap=yI[tI]}setLineJoin(tI){this.ctx.lineJoin=VI[tI]}setMiterLimit(tI){this.ctx.miterLimit=tI}setDash(tI,mI){const YI=this.ctx;YI.setLineDash!==void 0&&(YI.setLineDash(tI),YI.lineDashOffset=mI)}setRenderingIntent(tI){}setFlatness(tI){}setGState(tI){for(let mI=0,YI=tI.length;mI<YI;mI++){const BI=tI[mI],AI=BI[0],cI=BI[1];switch(AI){case"LW":this.setLineWidth(cI);break;case"LC":this.setLineCap(cI);break;case"LJ":this.setLineJoin(cI);break;case"ML":this.setMiterLimit(cI);break;case"D":this.setDash(cI[0],cI[1]);break;case"RI":this.setRenderingIntent(cI);break;case"FL":this.setFlatness(cI);break;case"Font":this.setFont(cI[0],cI[1]);break;case"CA":this.current.strokeAlpha=BI[1];break;case"ca":this.current.fillAlpha=BI[1],this.ctx.globalAlpha=BI[1];break;case"BM":this.ctx.globalCompositeOperation=cI;break;case"SMask":this.current.activeSMask=cI?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=cI}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const tI=this.inSMaskMode;this.current.activeSMask&&!tI?this.beginSMaskMode():!this.current.activeSMask&&tI&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const tI=this.ctx.canvas.width,mI=this.ctx.canvas.height,YI="smaskGroupAt"+this.groupLevel,BI=this.cachedCanvases.getCanvas(YI,tI,mI);this.suspendedCtx=this.ctx,this.ctx=BI.context;const AI=this.ctx;AI.setTransform(...(0,o.getCurrentTransform)(this.suspendedCtx)),aI(this.suspendedCtx,AI),E(AI,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),aI(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(tI){if(!this.current.activeSMask)return;tI?(tI[0]=Math.floor(tI[0]),tI[1]=Math.floor(tI[1]),tI[2]=Math.ceil(tI[2]),tI[3]=Math.ceil(tI[3])):tI=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const mI=this.current.activeSMask,YI=this.suspendedCtx;DI(YI,mI,this.ctx,tI),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(aI(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const tI=this.current;this.stateStack.push(tI),this.current=tI.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),aI(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(tI,mI,YI,BI,AI,cI){this.ctx.transform(tI,mI,YI,BI,AI,cI),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(tI,mI,YI){const BI=this.ctx,AI=this.current;let cI=AI.x,bI=AI.y,nI,uI;const rI=(0,o.getCurrentTransform)(BI),FI=rI[0]===0&&rI[3]===0||rI[1]===0&&rI[2]===0,kI=FI?YI.slice(0):null;for(let TI=0,QI=0,fI=tI.length;TI<fI;TI++)switch(tI[TI]|0){case t.OPS.rectangle:cI=mI[QI++],bI=mI[QI++];const OI=mI[QI++],qI=mI[QI++],gg=cI+OI,lg=bI+qI;BI.moveTo(cI,bI),OI===0||qI===0?BI.lineTo(gg,lg):(BI.lineTo(gg,bI),BI.lineTo(gg,lg),BI.lineTo(cI,lg)),FI||AI.updateRectMinMax(rI,[cI,bI,gg,lg]),BI.closePath();break;case t.OPS.moveTo:cI=mI[QI++],bI=mI[QI++],BI.moveTo(cI,bI),FI||AI.updatePathMinMax(rI,cI,bI);break;case t.OPS.lineTo:cI=mI[QI++],bI=mI[QI++],BI.lineTo(cI,bI),FI||AI.updatePathMinMax(rI,cI,bI);break;case t.OPS.curveTo:nI=cI,uI=bI,cI=mI[QI+4],bI=mI[QI+5],BI.bezierCurveTo(mI[QI],mI[QI+1],mI[QI+2],mI[QI+3],cI,bI),AI.updateCurvePathMinMax(rI,nI,uI,mI[QI],mI[QI+1],mI[QI+2],mI[QI+3],cI,bI,kI),QI+=6;break;case t.OPS.curveTo2:nI=cI,uI=bI,BI.bezierCurveTo(cI,bI,mI[QI],mI[QI+1],mI[QI+2],mI[QI+3]),AI.updateCurvePathMinMax(rI,nI,uI,cI,bI,mI[QI],mI[QI+1],mI[QI+2],mI[QI+3],kI),cI=mI[QI+2],bI=mI[QI+3],QI+=4;break;case t.OPS.curveTo3:nI=cI,uI=bI,cI=mI[QI+2],bI=mI[QI+3],BI.bezierCurveTo(mI[QI],mI[QI+1],cI,bI,cI,bI),AI.updateCurvePathMinMax(rI,nI,uI,mI[QI],mI[QI+1],cI,bI,cI,bI,kI),QI+=4;break;case t.OPS.closePath:BI.closePath();break}FI&&AI.updateScalingPathMinMax(rI,kI),AI.setCurrentPoint(cI,bI)}closePath(){this.ctx.closePath()}stroke(tI){tI=typeof tI<"u"?tI:!0;const mI=this.ctx,YI=this.current.strokeColor;mI.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof YI=="object"&&YI!==null&&YI!==void 0&&YI.getPattern?(mI.save(),mI.strokeStyle=YI.getPattern(mI,this,(0,o.getCurrentTransformInverse)(mI),a.PathType.STROKE),this.rescaleAndStroke(!1),mI.restore()):this.rescaleAndStroke(!0)),tI&&this.consumePath(this.current.getClippedPathBoundingBox()),mI.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(tI){tI=typeof tI<"u"?tI:!0;const mI=this.ctx,YI=this.current.fillColor,BI=this.current.patternFill;let AI=!1;BI&&(mI.save(),mI.fillStyle=YI.getPattern(mI,this,(0,o.getCurrentTransformInverse)(mI),a.PathType.FILL),AI=!0);const cI=this.current.getClippedPathBoundingBox();this.contentVisible&&cI!==null&&(this.pendingEOFill?(mI.fill("evenodd"),this.pendingEOFill=!1):mI.fill()),AI&&mI.restore(),tI&&this.consumePath(cI)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=hI}eoClip(){this.pendingClip=wI}beginText(){this.current.textMatrix=t.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const tI=this.pendingTextPaths,mI=this.ctx;if(tI===void 0){mI.beginPath();return}mI.save(),mI.beginPath();for(const YI of tI)mI.setTransform(...YI.transform),mI.translate(YI.x,YI.y),YI.addToPath(mI,YI.fontSize);mI.restore(),mI.clip(),mI.beginPath(),delete this.pendingTextPaths}setCharSpacing(tI){this.current.charSpacing=tI}setWordSpacing(tI){this.current.wordSpacing=tI}setHScale(tI){this.current.textHScale=tI/100}setLeading(tI){this.current.leading=-tI}setFont(tI,mI){const YI=this.commonObjs.get(tI),BI=this.current;if(!YI)throw new Error(`Can't find font for ${tI}`);if(BI.fontMatrix=YI.fontMatrix||t.FONT_IDENTITY_MATRIX,(BI.fontMatrix[0]===0||BI.fontMatrix[3]===0)&&(0,t.warn)("Invalid font matrix for font "+tI),mI<0?(mI=-mI,BI.fontDirection=-1):BI.fontDirection=1,this.current.font=YI,this.current.fontSize=mI,YI.isType3Font)return;const AI=YI.loadedName||"sans-serif";let cI="normal";YI.black?cI="900":YI.bold&&(cI="bold");const bI=YI.italic?"italic":"normal",nI=`"${AI}", ${YI.fallbackName}`;let uI=mI;mI<II?uI=II:mI>k&&(uI=k),this.current.fontSizeScale=mI/uI,this.ctx.font=`${bI} ${cI} ${uI}px ${nI}`}setTextRenderingMode(tI){this.current.textRenderingMode=tI}setTextRise(tI){this.current.textRise=tI}moveText(tI,mI){this.current.x=this.current.lineX+=tI,this.current.y=this.current.lineY+=mI}setLeadingMoveText(tI,mI){this.setLeading(-mI),this.moveText(tI,mI)}setTextMatrix(tI,mI,YI,BI,AI,cI){this.current.textMatrix=[tI,mI,YI,BI,AI,cI],this.current.textMatrixScale=Math.hypot(tI,mI),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(tI,mI,YI,BI){const AI=this.ctx,cI=this.current,bI=cI.font,nI=cI.textRenderingMode,uI=cI.fontSize/cI.fontSizeScale,rI=nI&t.TextRenderingMode.FILL_STROKE_MASK,FI=!!(nI&t.TextRenderingMode.ADD_TO_PATH_FLAG),kI=cI.patternFill&&!bI.missingFile;let TI;(bI.disableFontFace||FI||kI)&&(TI=bI.getPathGenerator(this.commonObjs,tI)),bI.disableFontFace||kI?(AI.save(),AI.translate(mI,YI),AI.beginPath(),TI(AI,uI),BI&&AI.setTransform(...BI),(rI===t.TextRenderingMode.FILL||rI===t.TextRenderingMode.FILL_STROKE)&&AI.fill(),(rI===t.TextRenderingMode.STROKE||rI===t.TextRenderingMode.FILL_STROKE)&&AI.stroke(),AI.restore()):((rI===t.TextRenderingMode.FILL||rI===t.TextRenderingMode.FILL_STROKE)&&AI.fillText(tI,mI,YI),(rI===t.TextRenderingMode.STROKE||rI===t.TextRenderingMode.FILL_STROKE)&&AI.strokeText(tI,mI,YI)),FI&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,o.getCurrentTransform)(AI),x:mI,y:YI,fontSize:uI,addToPath:TI})}get isFontSubpixelAAEnabled(){const{context:tI}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);tI.scale(1.5,1),tI.fillText("I",0,10);const mI=tI.getImageData(0,0,10,10).data;let YI=!1;for(let BI=3;BI<mI.length;BI+=4)if(mI[BI]>0&&mI[BI]<255){YI=!0;break}return(0,t.shadow)(this,"isFontSubpixelAAEnabled",YI)}showText(tI){const mI=this.current,YI=mI.font;if(YI.isType3Font)return this.showType3Text(tI);const BI=mI.fontSize;if(BI===0)return;const AI=this.ctx,cI=mI.fontSizeScale,bI=mI.charSpacing,nI=mI.wordSpacing,uI=mI.fontDirection,rI=mI.textHScale*uI,FI=tI.length,kI=YI.vertical,TI=kI?1:-1,QI=YI.defaultVMetrics,fI=BI*mI.fontMatrix[0],OI=mI.textRenderingMode===t.TextRenderingMode.FILL&&!YI.disableFontFace&&!mI.patternFill;AI.save(),AI.transform(...mI.textMatrix),AI.translate(mI.x,mI.y+mI.textRise),uI>0?AI.scale(rI,-1):AI.scale(rI,1);let qI;if(mI.patternFill){AI.save();const ig=mI.fillColor.getPattern(AI,this,(0,o.getCurrentTransformInverse)(AI),a.PathType.FILL);qI=(0,o.getCurrentTransform)(AI),AI.restore(),AI.fillStyle=ig}let gg=mI.lineWidth;const lg=mI.textMatrixScale;if(lg===0||gg===0){const ig=mI.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;(ig===t.TextRenderingMode.STROKE||ig===t.TextRenderingMode.FILL_STROKE)&&(gg=this.getSinglePixelWidth())}else gg/=lg;cI!==1&&(AI.scale(cI,cI),gg/=cI),AI.lineWidth=gg;let sg=0,tg;for(tg=0;tg<FI;++tg){const ig=tI[tg];if(typeof ig=="number"){sg+=TI*ig*BI/1e3;continue}let Xg=!1;const rg=(ig.isSpace?nI:0)+bI,mg=ig.fontChar,eg=ig.accent;let vI,Cg,Gg=ig.width;if(kI){const Ig=ig.vmetric||QI,og=-(ig.vmetric?Ig[1]:Gg*.5)*fI,wg=Ig[2]*fI;Gg=Ig?-Ig[0]:Gg,vI=og/cI,Cg=(sg+wg)/cI}else vI=sg/cI,Cg=0;if(YI.remeasure&&Gg>0){const Ig=AI.measureText(mg).width*1e3/BI*cI;if(Gg<Ig&&this.isFontSubpixelAAEnabled){const og=Gg/Ig;Xg=!0,AI.save(),AI.scale(og,1),vI/=og}else Gg!==Ig&&(vI+=(Gg-Ig)/2e3*BI/cI)}if(this.contentVisible&&(ig.isInFont||YI.missingFile)){if(OI&&!eg)AI.fillText(mg,vI,Cg);else if(this.paintChar(mg,vI,Cg,qI),eg){const Ig=vI+BI*eg.offset.x/cI,og=Cg-BI*eg.offset.y/cI;this.paintChar(eg.fontChar,Ig,og,qI)}}let Kg;kI?Kg=Gg*fI-rg*uI:Kg=Gg*fI+rg*uI,sg+=Kg,Xg&&AI.restore()}kI?mI.y-=sg:mI.x+=sg*rI,AI.restore(),this.compose()}showType3Text(tI){const mI=this.ctx,YI=this.current,BI=YI.font,AI=YI.fontSize,cI=YI.fontDirection,bI=BI.vertical?1:-1,nI=YI.charSpacing,uI=YI.wordSpacing,rI=YI.textHScale*cI,FI=YI.fontMatrix||t.FONT_IDENTITY_MATRIX,kI=tI.length,TI=YI.textRenderingMode===t.TextRenderingMode.INVISIBLE;let QI,fI,OI,qI;if(!(TI||AI===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,mI.save(),mI.transform(...YI.textMatrix),mI.translate(YI.x,YI.y),mI.scale(rI,cI),QI=0;QI<kI;++QI){if(fI=tI[QI],typeof fI=="number"){qI=bI*fI*AI/1e3,this.ctx.translate(qI,0),YI.x+=qI*rI;continue}const gg=(fI.isSpace?uI:0)+nI,lg=BI.charProcOperatorList[fI.operatorListId];if(!lg){(0,t.warn)(`Type3 character "${fI.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=fI,this.save(),mI.scale(AI,AI),mI.transform(...FI),this.executeOperatorList(lg),this.restore()),OI=t.Util.applyTransform([fI.width,0],FI)[0]*AI+gg,mI.translate(OI,0),YI.x+=OI*rI}mI.restore(),this.processingType3=null}}setCharWidth(tI,mI){}setCharWidthAndBounds(tI,mI,YI,BI,AI,cI){this.ctx.rect(YI,BI,AI-YI,cI-BI),this.ctx.clip(),this.endPath()}getColorN_Pattern(tI){let mI;if(tI[0]==="TilingPattern"){const YI=tI[1],BI=this.baseTransform||(0,o.getCurrentTransform)(this.ctx),AI={createCanvasGraphics:cI=>new xI(cI,this.commonObjs,this.objs,this.canvasFactory)};mI=new a.TilingPattern(tI,YI,this.ctx,AI,BI)}else mI=this._getPattern(tI[1],tI[2]);return mI}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(tI,mI,YI){var BI;const AI=((BI=this.selectColor)===null||BI===void 0?void 0:BI.call(this,tI,mI,YI))||t.Util.makeHexColor(tI,mI,YI);this.ctx.strokeStyle=AI,this.current.strokeColor=AI}setFillRGBColor(tI,mI,YI){var BI;const AI=((BI=this.selectColor)===null||BI===void 0?void 0:BI.call(this,tI,mI,YI))||t.Util.makeHexColor(tI,mI,YI);this.ctx.fillStyle=AI,this.current.fillColor=AI,this.current.patternFill=!1}_getPattern(tI){let mI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,YI;return this.cachedPatterns.has(tI)?YI=this.cachedPatterns.get(tI):(YI=(0,a.getShadingPattern)(this.objs.get(tI)),this.cachedPatterns.set(tI,YI)),mI&&(YI.matrix=mI),YI}shadingFill(tI){if(!this.contentVisible)return;const mI=this.ctx;this.save();const YI=this._getPattern(tI);mI.fillStyle=YI.getPattern(mI,this,(0,o.getCurrentTransformInverse)(mI),a.PathType.SHADING);const BI=(0,o.getCurrentTransformInverse)(mI);if(BI){const AI=mI.canvas,cI=AI.width,bI=AI.height,nI=t.Util.applyTransform([0,0],BI),uI=t.Util.applyTransform([0,bI],BI),rI=t.Util.applyTransform([cI,0],BI),FI=t.Util.applyTransform([cI,bI],BI),kI=Math.min(nI[0],uI[0],rI[0],FI[0]),TI=Math.min(nI[1],uI[1],rI[1],FI[1]),QI=Math.max(nI[0],uI[0],rI[0],FI[0]),fI=Math.max(nI[1],uI[1],rI[1],FI[1]);this.ctx.fillRect(kI,TI,QI-kI,fI-TI)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,t.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,t.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(tI,mI){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(tI)&&tI.length===6&&this.transform(...tI),this.baseTransform=(0,o.getCurrentTransform)(this.ctx),mI)){const YI=mI[2]-mI[0],BI=mI[3]-mI[1];this.ctx.rect(mI[0],mI[1],YI,BI),this.current.updateRectMinMax((0,o.getCurrentTransform)(this.ctx),mI),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(tI){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const mI=this.ctx;tI.isolated||(0,t.info)("TODO: Support non-isolated groups."),tI.knockout&&(0,t.warn)("Knockout groups not supported.");const YI=(0,o.getCurrentTransform)(mI);if(tI.matrix&&mI.transform(...tI.matrix),!tI.bbox)throw new Error("Bounding box is required.");let BI=t.Util.getAxialAlignedBoundingBox(tI.bbox,(0,o.getCurrentTransform)(mI));const AI=[0,0,mI.canvas.width,mI.canvas.height];BI=t.Util.intersect(BI,AI)||[0,0,0,0];const cI=Math.floor(BI[0]),bI=Math.floor(BI[1]);let nI=Math.max(Math.ceil(BI[2])-cI,1),uI=Math.max(Math.ceil(BI[3])-bI,1),rI=1,FI=1;nI>iI&&(rI=nI/iI,nI=iI),uI>iI&&(FI=uI/iI,uI=iI),this.current.startNewPathAndClipBox([0,0,nI,uI]);let kI="groupAt"+this.groupLevel;tI.smask&&(kI+="_smask_"+this.smaskCounter++%2);const TI=this.cachedCanvases.getCanvas(kI,nI,uI),QI=TI.context;QI.scale(1/rI,1/FI),QI.translate(-cI,-bI),QI.transform(...YI),tI.smask?this.smaskStack.push({canvas:TI.canvas,context:QI,offsetX:cI,offsetY:bI,scaleX:rI,scaleY:FI,subtype:tI.smask.subtype,backdrop:tI.smask.backdrop,transferMap:tI.smask.transferMap||null,startTransformInverse:null}):(mI.setTransform(1,0,0,1,0,0),mI.translate(cI,bI),mI.scale(rI,FI),mI.save()),aI(mI,QI),this.ctx=QI,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(mI),this.groupLevel++}endGroup(tI){if(!this.contentVisible)return;this.groupLevel--;const mI=this.ctx,YI=this.groupStack.pop();if(this.ctx=YI,this.ctx.imageSmoothingEnabled=!1,tI.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const BI=(0,o.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...BI);const AI=t.Util.getAxialAlignedBoundingBox([0,0,mI.canvas.width,mI.canvas.height],BI);this.ctx.drawImage(mI.canvas,0,0),this.ctx.restore(),this.compose(AI)}}beginAnnotation(tI,mI,YI,BI,AI){if(H(this,pI,PI).call(this),WI(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(mI)&&mI.length===4){const cI=mI[2]-mI[0],bI=mI[3]-mI[1];if(AI&&this.annotationCanvasMap){YI=YI.slice(),YI[4]-=mI[0],YI[5]-=mI[1],mI=mI.slice(),mI[0]=mI[1]=0,mI[2]=cI,mI[3]=bI;const[nI,uI]=t.Util.singularValueDecompose2dScale((0,o.getCurrentTransform)(this.ctx)),{viewportScale:rI}=this,FI=Math.ceil(cI*this.outputScaleX*rI),kI=Math.ceil(bI*this.outputScaleY*rI);this.annotationCanvas=this.canvasFactory.create(FI,kI);const{canvas:TI,context:QI}=this.annotationCanvas;this.annotationCanvasMap.set(tI,TI),this.annotationCanvas.savedCtx=this.ctx,this.ctx=QI,this.ctx.setTransform(nI,0,0,-uI,0,bI*uI),WI(this.ctx,this.foregroundColor)}else WI(this.ctx,this.foregroundColor),this.ctx.rect(mI[0],mI[1],cI,bI),this.ctx.clip(),this.endPath()}this.current=new O(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...YI),this.transform(...BI)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(tI){if(!this.contentVisible)return;const mI=tI.count;tI=this.getObject(tI.data,tI),tI.count=mI;const YI=this.ctx,BI=this.processingType3;if(BI&&(BI.compiled===void 0&&(BI.compiled=M(tI)),BI.compiled)){BI.compiled(YI);return}const AI=this._createMaskCanvas(tI),cI=AI.canvas;YI.save(),YI.setTransform(1,0,0,1,0,0),YI.drawImage(cI,AI.offsetX,AI.offsetY),YI.restore(),this.compose()}paintImageMaskXObjectRepeat(tI,mI){let YI=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,BI=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,AI=arguments.length>4?arguments[4]:void 0,cI=arguments.length>5?arguments[5]:void 0;if(!this.contentVisible)return;tI=this.getObject(tI.data,tI);const bI=this.ctx;bI.save();const nI=(0,o.getCurrentTransform)(bI);bI.transform(mI,YI,BI,AI,0,0);const uI=this._createMaskCanvas(tI);bI.setTransform(1,0,0,1,0,0);for(let rI=0,FI=cI.length;rI<FI;rI+=2){const kI=t.Util.transform(nI,[mI,YI,BI,AI,cI[rI],cI[rI+1]]),[TI,QI]=t.Util.applyTransform([0,0],kI);bI.drawImage(uI.canvas,TI,QI)}bI.restore(),this.compose()}paintImageMaskXObjectGroup(tI){if(!this.contentVisible)return;const mI=this.ctx,YI=this.current.fillColor,BI=this.current.patternFill;for(const AI of tI){const{data:cI,width:bI,height:nI,transform:uI}=AI,rI=this.cachedCanvases.getCanvas("maskCanvas",bI,nI),FI=rI.context;FI.save();const kI=this.getObject(cI,AI);eI(FI,kI),FI.globalCompositeOperation="source-in",FI.fillStyle=BI?YI.getPattern(FI,this,(0,o.getCurrentTransformInverse)(mI),a.PathType.FILL):YI,FI.fillRect(0,0,bI,nI),FI.restore(),mI.save(),mI.transform(...uI),mI.scale(1,-1),gI(mI,rI.canvas,0,0,bI,nI,0,-1,1,1),mI.restore()}this.compose()}paintImageXObject(tI){if(!this.contentVisible)return;const mI=this.getObject(tI);if(!mI){(0,t.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(mI)}paintImageXObjectRepeat(tI,mI,YI,BI){if(!this.contentVisible)return;const AI=this.getObject(tI);if(!AI){(0,t.warn)("Dependent image isn't ready yet");return}const cI=AI.width,bI=AI.height,nI=[];for(let uI=0,rI=BI.length;uI<rI;uI+=2)nI.push({transform:[mI,0,0,YI,BI[uI],BI[uI+1]],x:0,y:0,w:cI,h:bI});this.paintInlineImageXObjectGroup(AI,nI)}paintInlineImageXObject(tI){if(!this.contentVisible)return;const mI=tI.width,YI=tI.height,BI=this.ctx;this.save(),BI.scale(1/mI,-1/YI);let AI;if(typeof HTMLElement=="function"&&tI instanceof HTMLElement||!tI.data)AI=tI;else{const uI=this.cachedCanvases.getCanvas("inlineImage",mI,YI),rI=uI.context;dI(rI,tI,this.current.transferMaps),AI=uI.canvas}const cI=this._scaleImage(AI,(0,o.getCurrentTransformInverse)(BI));BI.imageSmoothingEnabled=NI((0,o.getCurrentTransform)(BI),tI.interpolate);const[bI,nI]=gI(BI,cI.img,0,0,cI.paintWidth,cI.paintHeight,0,-YI,mI,YI);if(this.imageLayer){const[uI,rI]=t.Util.applyTransform([0,-YI],(0,o.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:tI,left:uI,top:rI,width:bI,height:nI})}this.compose(),this.restore()}paintInlineImageXObjectGroup(tI,mI){if(!this.contentVisible)return;const YI=this.ctx,BI=tI.width,AI=tI.height,cI=this.cachedCanvases.getCanvas("inlineImage",BI,AI),bI=cI.context;dI(bI,tI,this.current.transferMaps);for(const nI of mI){if(YI.save(),YI.transform(...nI.transform),YI.scale(1,-1),gI(YI,cI.canvas,nI.x,nI.y,nI.w,nI.h,0,-1,1,1),this.imageLayer){const[uI,rI]=t.Util.applyTransform([nI.x,nI.y],(0,o.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:tI,left:uI,top:rI,width:BI,height:AI})}YI.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(tI){}markPointProps(tI,mI){}beginMarkedContent(tI){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(tI,mI){tI==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(mI)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(tI){const mI=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(tI);const YI=this.ctx;this.pendingClip&&(mI||(this.pendingClip===wI?YI.clip("evenodd"):YI.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),YI.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const tI=(0,o.getCurrentTransform)(this.ctx);if(tI[1]===0&&tI[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(tI[0]),Math.abs(tI[3]));else{const mI=Math.abs(tI[0]*tI[3]-tI[2]*tI[1]),YI=Math.hypot(tI[0],tI[2]),BI=Math.hypot(tI[1],tI[3]);this._cachedGetSinglePixelWidth=Math.max(YI,BI)/mI}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:tI}=this.current,mI=(0,o.getCurrentTransform)(this.ctx);let YI,BI;if(mI[1]===0&&mI[2]===0){const AI=Math.abs(mI[0]),cI=Math.abs(mI[3]);if(tI===0)YI=1/AI,BI=1/cI;else{const bI=AI*tI,nI=cI*tI;YI=bI<1?1/bI:1,BI=nI<1?1/nI:1}}else{const AI=Math.abs(mI[0]*mI[3]-mI[2]*mI[1]),cI=Math.hypot(mI[0],mI[1]),bI=Math.hypot(mI[2],mI[3]);if(tI===0)YI=bI/AI,BI=cI/AI;else{const nI=tI*AI;YI=bI>nI?bI/nI:1,BI=cI>nI?cI/nI:1}}this._cachedScaleForStroking=[YI,BI]}return this._cachedScaleForStroking}rescaleAndStroke(tI){const{ctx:mI}=this,{lineWidth:YI}=this.current,[BI,AI]=this.getScaleForStroking();if(mI.lineWidth=YI||1,BI===1&&AI===1){mI.stroke();return}let cI,bI,nI;tI&&(cI=(0,o.getCurrentTransform)(mI),bI=mI.getLineDash().slice(),nI=mI.lineDashOffset),mI.scale(BI,AI);const uI=Math.max(BI,AI);mI.setLineDash(mI.getLineDash().map(rI=>rI/uI)),mI.lineDashOffset/=uI,mI.stroke(),tI&&(mI.setTransform(...cI),mI.setLineDash(bI),mI.lineDashOffset=nI)}isContentVisible(){for(let tI=this.markedContentStack.length-1;tI>=0;tI--)if(!this.markedContentStack[tI].visible)return!1;return!0}}A.CanvasGraphics=xI;function PI(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}for(const XI in t.OPS)xI.prototype[XI]!==void 0&&(xI.prototype[t.OPS[XI]]=xI.prototype[XI])},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.TilingPattern=A.PathType=void 0,A.getShadingPattern=lI;var o=l(1),t=l(133),a=l(3);const n={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};A.PathType=n;function B(oI,E){if(!E||a.isNodeJS)return;const _=E[2]-E[0],gI=E[3]-E[1],M=new Path2D;M.rect(E[0],E[1],_,gI),oI.clip(M)}class R{constructor(){this.constructor===R&&(0,o.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,o.unreachable)("Abstract method `getPattern` called.")}}class r extends R{constructor(E){super(),this._type=E[1],this._bbox=E[2],this._colorStops=E[3],this._p0=E[4],this._p1=E[5],this._r0=E[6],this._r1=E[7],this.matrix=null}_createGradient(E){let _;this._type==="axial"?_=E.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(_=E.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const gI of this._colorStops)_.addColorStop(gI[0],gI[1]);return _}getPattern(E,_,gI,M){let O;if(M===n.STROKE||M===n.FILL){const dI=_.current.getClippedPathBoundingBox(M,(0,t.getCurrentTransform)(E))||[0,0,0,0],eI=Math.ceil(dI[2]-dI[0])||1,aI=Math.ceil(dI[3]-dI[1])||1,WI=_.cachedCanvases.getCanvas("pattern",eI,aI,!0),GI=WI.context;GI.clearRect(0,0,GI.canvas.width,GI.canvas.height),GI.beginPath(),GI.rect(0,0,GI.canvas.width,GI.canvas.height),GI.translate(-dI[0],-dI[1]),gI=o.Util.transform(gI,[1,0,0,1,dI[0],dI[1]]),GI.transform(..._.baseTransform),this.matrix&&GI.transform(...this.matrix),B(GI,this._bbox),GI.fillStyle=this._createGradient(GI),GI.fill(),O=E.createPattern(WI.canvas,"no-repeat");const HI=new DOMMatrix(gI);try{O.setTransform(HI)}catch(MI){(0,o.warn)(`RadialAxialShadingPattern.getPattern: "${MI?.message}".`)}}else B(E,this._bbox),O=this._createGradient(E);return O}}function H(oI,E,_,gI,M,O,dI,eI){const aI=E.coords,WI=E.colors,GI=oI.data,HI=oI.width*4;let MI;aI[_+1]>aI[gI+1]&&(MI=_,_=gI,gI=MI,MI=O,O=dI,dI=MI),aI[gI+1]>aI[M+1]&&(MI=gI,gI=M,M=MI,MI=dI,dI=eI,eI=MI),aI[_+1]>aI[gI+1]&&(MI=_,_=gI,gI=MI,MI=O,O=dI,dI=MI);const KI=(aI[_]+E.offsetX)*E.scaleX,DI=(aI[_+1]+E.offsetY)*E.scaleY,NI=(aI[gI]+E.offsetX)*E.scaleX,yI=(aI[gI+1]+E.offsetY)*E.scaleY,VI=(aI[M]+E.offsetX)*E.scaleX,hI=(aI[M+1]+E.offsetY)*E.scaleY;if(DI>=hI)return;const wI=WI[O],pI=WI[O+1],xI=WI[O+2],PI=WI[dI],XI=WI[dI+1],tI=WI[dI+2],mI=WI[eI],YI=WI[eI+1],BI=WI[eI+2],AI=Math.round(DI),cI=Math.round(hI);let bI,nI,uI,rI,FI,kI,TI,QI;for(let fI=AI;fI<=cI;fI++){if(fI<yI){let sg;fI<DI?sg=0:sg=(DI-fI)/(DI-yI),bI=KI-(KI-NI)*sg,nI=wI-(wI-PI)*sg,uI=pI-(pI-XI)*sg,rI=xI-(xI-tI)*sg}else{let sg;fI>hI?sg=1:yI===hI?sg=0:sg=(yI-fI)/(yI-hI),bI=NI-(NI-VI)*sg,nI=PI-(PI-mI)*sg,uI=XI-(XI-YI)*sg,rI=tI-(tI-BI)*sg}let OI;fI<DI?OI=0:fI>hI?OI=1:OI=(DI-fI)/(DI-hI),FI=KI-(KI-VI)*OI,kI=wI-(wI-mI)*OI,TI=pI-(pI-YI)*OI,QI=xI-(xI-BI)*OI;const qI=Math.round(Math.min(bI,FI)),gg=Math.round(Math.max(bI,FI));let lg=HI*fI+qI*4;for(let sg=qI;sg<=gg;sg++)OI=(bI-sg)/(bI-FI),OI<0?OI=0:OI>1&&(OI=1),GI[lg++]=nI-(nI-kI)*OI|0,GI[lg++]=uI-(uI-TI)*OI|0,GI[lg++]=rI-(rI-QI)*OI|0,GI[lg++]=255}}function II(oI,E,_){const gI=E.coords,M=E.colors;let O,dI;switch(E.type){case"lattice":const eI=E.verticesPerRow,aI=Math.floor(gI.length/eI)-1,WI=eI-1;for(O=0;O<aI;O++){let GI=O*eI;for(let HI=0;HI<WI;HI++,GI++)H(oI,_,gI[GI],gI[GI+1],gI[GI+eI],M[GI],M[GI+1],M[GI+eI]),H(oI,_,gI[GI+eI+1],gI[GI+1],gI[GI+eI],M[GI+eI+1],M[GI+1],M[GI+eI])}break;case"triangles":for(O=0,dI=gI.length;O<dI;O+=3)H(oI,_,gI[O],gI[O+1],gI[O+2],M[O],M[O+1],M[O+2]);break;default:throw new Error("illegal figure")}}class k extends R{constructor(E){super(),this._coords=E[2],this._colors=E[3],this._figures=E[4],this._bounds=E[5],this._bbox=E[7],this._background=E[8],this.matrix=null}_createMeshCanvas(E,_,gI){const eI=Math.floor(this._bounds[0]),aI=Math.floor(this._bounds[1]),WI=Math.ceil(this._bounds[2])-eI,GI=Math.ceil(this._bounds[3])-aI,HI=Math.min(Math.ceil(Math.abs(WI*E[0]*1.1)),3e3),MI=Math.min(Math.ceil(Math.abs(GI*E[1]*1.1)),3e3),KI=WI/HI,DI=GI/MI,NI={coords:this._coords,colors:this._colors,offsetX:-eI,offsetY:-aI,scaleX:1/KI,scaleY:1/DI},yI=HI+2*2,VI=MI+2*2,hI=gI.getCanvas("mesh",yI,VI,!1),wI=hI.context,pI=wI.createImageData(HI,MI);if(_){const PI=pI.data;for(let XI=0,tI=PI.length;XI<tI;XI+=4)PI[XI]=_[0],PI[XI+1]=_[1],PI[XI+2]=_[2],PI[XI+3]=255}for(const PI of this._figures)II(pI,PI,NI);return wI.putImageData(pI,2,2),{canvas:hI.canvas,offsetX:eI-2*KI,offsetY:aI-2*DI,scaleX:KI,scaleY:DI}}getPattern(E,_,gI,M){B(E,this._bbox);let O;if(M===n.SHADING)O=o.Util.singularValueDecompose2dScale((0,t.getCurrentTransform)(E));else if(O=o.Util.singularValueDecompose2dScale(_.baseTransform),this.matrix){const eI=o.Util.singularValueDecompose2dScale(this.matrix);O=[O[0]*eI[0],O[1]*eI[1]]}const dI=this._createMeshCanvas(O,M===n.SHADING?null:this._background,_.cachedCanvases);return M!==n.SHADING&&(E.setTransform(..._.baseTransform),this.matrix&&E.transform(...this.matrix)),E.translate(dI.offsetX,dI.offsetY),E.scale(dI.scaleX,dI.scaleY),E.createPattern(dI.canvas,"no-repeat")}}class iI extends R{getPattern(){return"hotpink"}}function lI(oI){switch(oI[0]){case"RadialAxial":return new r(oI);case"Mesh":return new k(oI);case"Dummy":return new iI}throw new Error(`Unknown IR type: ${oI[0]}`)}const CI={COLORED:1,UNCOLORED:2};class sI{static get MAX_PATTERN_SIZE(){return(0,o.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(E,_,gI,M,O){this.operatorList=E[2],this.matrix=E[3]||[1,0,0,1,0,0],this.bbox=E[4],this.xstep=E[5],this.ystep=E[6],this.paintType=E[7],this.tilingType=E[8],this.color=_,this.ctx=gI,this.canvasGraphicsFactory=M,this.baseTransform=O}createPatternCanvas(E){const _=this.operatorList,gI=this.bbox,M=this.xstep,O=this.ystep,dI=this.paintType,eI=this.tilingType,aI=this.color,WI=this.canvasGraphicsFactory;(0,o.info)("TilingType: "+eI);const GI=gI[0],HI=gI[1],MI=gI[2],KI=gI[3],DI=o.Util.singularValueDecompose2dScale(this.matrix),NI=o.Util.singularValueDecompose2dScale(this.baseTransform),yI=[DI[0]*NI[0],DI[1]*NI[1]],VI=this.getSizeAndScale(M,this.ctx.canvas.width,yI[0]),hI=this.getSizeAndScale(O,this.ctx.canvas.height,yI[1]),wI=E.cachedCanvases.getCanvas("pattern",VI.size,hI.size,!0),pI=wI.context,xI=WI.createCanvasGraphics(pI);xI.groupLevel=E.groupLevel,this.setFillAndStrokeStyleToContext(xI,dI,aI);let PI=GI,XI=HI,tI=MI,mI=KI;return GI<0&&(PI=0,tI+=Math.abs(GI)),HI<0&&(XI=0,mI+=Math.abs(HI)),pI.translate(-(VI.scale*PI),-(hI.scale*XI)),xI.transform(VI.scale,0,0,hI.scale,0,0),pI.save(),this.clipBbox(xI,PI,XI,tI,mI),xI.baseTransform=(0,t.getCurrentTransform)(xI.ctx),xI.executeOperatorList(_),xI.endDrawing(),{canvas:wI.canvas,scaleX:VI.scale,scaleY:hI.scale,offsetX:PI,offsetY:XI}}getSizeAndScale(E,_,gI){E=Math.abs(E);const M=Math.max(sI.MAX_PATTERN_SIZE,_);let O=Math.ceil(E*gI);return O>=M?O=M:gI=O/E,{scale:gI,size:O}}clipBbox(E,_,gI,M,O){const dI=M-_,eI=O-gI;E.ctx.rect(_,gI,dI,eI),E.current.updateRectMinMax((0,t.getCurrentTransform)(E.ctx),[_,gI,M,O]),E.clip(),E.endPath()}setFillAndStrokeStyleToContext(E,_,gI){const M=E.ctx,O=E.current;switch(_){case CI.COLORED:const dI=this.ctx;M.fillStyle=dI.fillStyle,M.strokeStyle=dI.strokeStyle,O.fillColor=dI.fillStyle,O.strokeColor=dI.strokeStyle;break;case CI.UNCOLORED:const eI=o.Util.makeHexColor(gI[0],gI[1],gI[2]);M.fillStyle=eI,M.strokeStyle=eI,O.fillColor=eI,O.strokeColor=eI;break;default:throw new o.FormatError(`Unsupported paint type: ${_}`)}}getPattern(E,_,gI,M){let O=gI;M!==n.SHADING&&(O=o.Util.transform(O,_.baseTransform),this.matrix&&(O=o.Util.transform(O,this.matrix)));const dI=this.createPatternCanvas(_);let eI=new DOMMatrix(O);eI=eI.translate(dI.offsetX,dI.offsetY),eI=eI.scale(1/dI.scaleX,1/dI.scaleY);const aI=E.createPattern(dI.canvas,"repeat");try{aI.setTransform(eI)}catch(WI){(0,o.warn)(`TilingPattern.getPattern: "${WI?.message}".`)}return aI}}A.TilingPattern=sI},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.applyMaskImageData=t;var o=l(1);function t(a){let{src:n,srcPos:B=0,dest:R,destPos:r=0,width:H,height:II,inverseDecode:k=!1}=a;const iI=o.FeatureTest.isLittleEndian?4278190080:255,[lI,CI]=k?[0,iI]:[iI,0],sI=H>>3,oI=H&7,E=n.length;R=new Uint32Array(R.buffer);for(let _=0;_<II;_++){for(const M=B+sI;B<M;B++){const O=B<E?n[B]:255;R[r++]=O&128?CI:lI,R[r++]=O&64?CI:lI,R[r++]=O&32?CI:lI,R[r++]=O&16?CI:lI,R[r++]=O&8?CI:lI,R[r++]=O&4?CI:lI,R[r++]=O&2?CI:lI,R[r++]=O&1?CI:lI}if(oI===0)continue;const gI=B<E?n[B++]:255;for(let M=0;M<oI;M++)R[r++]=gI&1<<7-M?CI:lI}return{srcPos:B,destPos:r}}},(e,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.GlobalWorkerOptions=void 0;const l=Object.create(null);A.GlobalWorkerOptions=l,l.workerPort=l.workerPort===void 0?null:l.workerPort,l.workerSrc=l.workerSrc===void 0?"":l.workerSrc},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.MessageHandler=void 0;var o=l(1);const t={DATA:1,ERROR:2},a={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function n(R){switch(R instanceof Error||typeof R=="object"&&R!==null||(0,o.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),R.name){case"AbortException":return new o.AbortException(R.message);case"MissingPDFException":return new o.MissingPDFException(R.message);case"PasswordException":return new o.PasswordException(R.message,R.code);case"UnexpectedResponseException":return new o.UnexpectedResponseException(R.message,R.status);case"UnknownErrorException":return new o.UnknownErrorException(R.message,R.details);default:return new o.UnknownErrorException(R.message,R.toString())}}class B{constructor(r,H,II){this.sourceName=r,this.targetName=H,this.comObj=II,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=k=>{const iI=k.data;if(iI.targetName!==this.sourceName)return;if(iI.stream){this._processStreamMessage(iI);return}if(iI.callback){const CI=iI.callbackId,sI=this.callbackCapabilities[CI];if(!sI)throw new Error(`Cannot resolve callback ${CI}`);if(delete this.callbackCapabilities[CI],iI.callback===t.DATA)sI.resolve(iI.data);else if(iI.callback===t.ERROR)sI.reject(n(iI.reason));else throw new Error("Unexpected callback case");return}const lI=this.actionHandler[iI.action];if(!lI)throw new Error(`Unknown action from worker: ${iI.action}`);if(iI.callbackId){const CI=this.sourceName,sI=iI.sourceName;new Promise(function(oI){oI(lI(iI.data))}).then(function(oI){II.postMessage({sourceName:CI,targetName:sI,callback:t.DATA,callbackId:iI.callbackId,data:oI})},function(oI){II.postMessage({sourceName:CI,targetName:sI,callback:t.ERROR,callbackId:iI.callbackId,reason:n(oI)})});return}if(iI.streamId){this._createStreamSink(iI);return}lI(iI.data)},II.addEventListener("message",this._onComObjOnMessage)}on(r,H){const II=this.actionHandler;if(II[r])throw new Error(`There is already an actionName called "${r}"`);II[r]=H}send(r,H,II){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,data:H},II)}sendWithPromise(r,H,II){const k=this.callbackId++,iI=(0,o.createPromiseCapability)();this.callbackCapabilities[k]=iI;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,callbackId:k,data:H},II)}catch(lI){iI.reject(lI)}return iI.promise}sendWithStream(r,H,II,k){const iI=this.streamId++,lI=this.sourceName,CI=this.targetName,sI=this.comObj;return new ReadableStream({start:oI=>{const E=(0,o.createPromiseCapability)();return this.streamControllers[iI]={controller:oI,startCall:E,pullCall:null,cancelCall:null,isClosed:!1},sI.postMessage({sourceName:lI,targetName:CI,action:r,streamId:iI,data:H,desiredSize:oI.desiredSize},k),E.promise},pull:oI=>{const E=(0,o.createPromiseCapability)();return this.streamControllers[iI].pullCall=E,sI.postMessage({sourceName:lI,targetName:CI,stream:a.PULL,streamId:iI,desiredSize:oI.desiredSize}),E.promise},cancel:oI=>{(0,o.assert)(oI instanceof Error,"cancel must have a valid reason");const E=(0,o.createPromiseCapability)();return this.streamControllers[iI].cancelCall=E,this.streamControllers[iI].isClosed=!0,sI.postMessage({sourceName:lI,targetName:CI,stream:a.CANCEL,streamId:iI,reason:n(oI)}),E.promise}},II)}_createStreamSink(r){const H=r.streamId,II=this.sourceName,k=r.sourceName,iI=this.comObj,lI=this,CI=this.actionHandler[r.action],sI={enqueue(oI){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,_=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const gI=this.desiredSize;this.desiredSize-=E,gI>0&&this.desiredSize<=0&&(this.sinkCapability=(0,o.createPromiseCapability)(),this.ready=this.sinkCapability.promise),iI.postMessage({sourceName:II,targetName:k,stream:a.ENQUEUE,streamId:H,chunk:oI},_)},close(){this.isCancelled||(this.isCancelled=!0,iI.postMessage({sourceName:II,targetName:k,stream:a.CLOSE,streamId:H}),delete lI.streamSinks[H])},error(oI){(0,o.assert)(oI instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,iI.postMessage({sourceName:II,targetName:k,stream:a.ERROR,streamId:H,reason:n(oI)}))},sinkCapability:(0,o.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:r.desiredSize,ready:null};sI.sinkCapability.resolve(),sI.ready=sI.sinkCapability.promise,this.streamSinks[H]=sI,new Promise(function(oI){oI(CI(r.data,sI))}).then(function(){iI.postMessage({sourceName:II,targetName:k,stream:a.START_COMPLETE,streamId:H,success:!0})},function(oI){iI.postMessage({sourceName:II,targetName:k,stream:a.START_COMPLETE,streamId:H,reason:n(oI)})})}_processStreamMessage(r){const H=r.streamId,II=this.sourceName,k=r.sourceName,iI=this.comObj,lI=this.streamControllers[H],CI=this.streamSinks[H];switch(r.stream){case a.START_COMPLETE:r.success?lI.startCall.resolve():lI.startCall.reject(n(r.reason));break;case a.PULL_COMPLETE:r.success?lI.pullCall.resolve():lI.pullCall.reject(n(r.reason));break;case a.PULL:if(!CI){iI.postMessage({sourceName:II,targetName:k,stream:a.PULL_COMPLETE,streamId:H,success:!0});break}CI.desiredSize<=0&&r.desiredSize>0&&CI.sinkCapability.resolve(),CI.desiredSize=r.desiredSize,new Promise(function(sI){sI(CI.onPull&&CI.onPull())}).then(function(){iI.postMessage({sourceName:II,targetName:k,stream:a.PULL_COMPLETE,streamId:H,success:!0})},function(sI){iI.postMessage({sourceName:II,targetName:k,stream:a.PULL_COMPLETE,streamId:H,reason:n(sI)})});break;case a.ENQUEUE:if((0,o.assert)(lI,"enqueue should have stream controller"),lI.isClosed)break;lI.controller.enqueue(r.chunk);break;case a.CLOSE:if((0,o.assert)(lI,"close should have stream controller"),lI.isClosed)break;lI.isClosed=!0,lI.controller.close(),this._deleteStreamController(lI,H);break;case a.ERROR:(0,o.assert)(lI,"error should have stream controller"),lI.controller.error(n(r.reason)),this._deleteStreamController(lI,H);break;case a.CANCEL_COMPLETE:r.success?lI.cancelCall.resolve():lI.cancelCall.reject(n(r.reason)),this._deleteStreamController(lI,H);break;case a.CANCEL:if(!CI)break;new Promise(function(sI){sI(CI.onCancel&&CI.onCancel(n(r.reason)))}).then(function(){iI.postMessage({sourceName:II,targetName:k,stream:a.CANCEL_COMPLETE,streamId:H,success:!0})},function(sI){iI.postMessage({sourceName:II,targetName:k,stream:a.CANCEL_COMPLETE,streamId:H,reason:n(sI)})}),CI.sinkCapability.reject(n(r.reason)),CI.isCancelled=!0,delete this.streamSinks[H];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(r,H){await Promise.allSettled([r.startCall&&r.startCall.promise,r.pullCall&&r.pullCall.promise,r.cancelCall&&r.cancelCall.promise]),delete this.streamControllers[H]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}A.MessageHandler=B},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.Metadata=void 0;var o=l(1);function t(lI,CI,sI){a(lI,CI),CI.set(lI,sI)}function a(lI,CI){if(CI.has(lI))throw new TypeError("Cannot initialize the same private elements twice on an object")}function n(lI,CI){var sI=r(lI,CI,"get");return B(lI,sI)}function B(lI,CI){return CI.get?CI.get.call(lI):CI.value}function R(lI,CI,sI){var oI=r(lI,CI,"set");return H(lI,oI,sI),sI}function r(lI,CI,sI){if(!CI.has(lI))throw new TypeError("attempted to "+sI+" private field on non-instance");return CI.get(lI)}function H(lI,CI,sI){if(CI.set)CI.set.call(lI,sI);else{if(!CI.writable)throw new TypeError("attempted to set read only private field");CI.value=sI}}var II=new WeakMap,k=new WeakMap;class iI{constructor(CI){let{parsedData:sI,rawData:oI}=CI;t(this,II,{writable:!0,value:void 0}),t(this,k,{writable:!0,value:void 0}),R(this,II,sI),R(this,k,oI)}getRaw(){return n(this,k)}get(CI){var sI;return(sI=n(this,II).get(CI))!==null&&sI!==void 0?sI:null}getAll(){return(0,o.objectFromMap)(n(this,II))}has(CI){return n(this,II).has(CI)}}A.Metadata=iI},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.OptionalContentConfig=void 0;var o=l(1);function t(dI,eI){B(dI,eI),eI.add(dI)}function a(dI,eI,aI){if(!eI.has(dI))throw new TypeError("attempted to get private field on non-instance");return aI}function n(dI,eI,aI){B(dI,eI),eI.set(dI,aI)}function B(dI,eI){if(eI.has(dI))throw new TypeError("Cannot initialize the same private elements twice on an object")}function R(dI,eI,aI){var WI=II(dI,eI,"set");return r(dI,WI,aI),aI}function r(dI,eI,aI){if(eI.set)eI.set.call(dI,aI);else{if(!eI.writable)throw new TypeError("attempted to set read only private field");eI.value=aI}}function H(dI,eI){var aI=II(dI,eI,"get");return k(dI,aI)}function II(dI,eI,aI){if(!eI.has(dI))throw new TypeError("attempted to "+aI+" private field on non-instance");return eI.get(dI)}function k(dI,eI){return eI.get?eI.get.call(dI):eI.value}const iI=Symbol("INTERNAL");var lI=new WeakMap;class CI{constructor(eI,aI){n(this,lI,{writable:!0,value:!0}),this.name=eI,this.intent=aI}get visible(){return H(this,lI)}_setVisible(eI,aI){eI!==iI&&(0,o.unreachable)("Internal method `_setVisible` called."),R(this,lI,aI)}}var sI=new WeakMap,oI=new WeakMap,E=new WeakMap,_=new WeakMap,gI=new WeakSet;class M{constructor(eI){if(t(this,gI),n(this,sI,{writable:!0,value:!0}),n(this,oI,{writable:!0,value:new Map}),n(this,E,{writable:!0,value:null}),n(this,_,{writable:!0,value:null}),this.name=null,this.creator=null,eI!==null){this.name=eI.name,this.creator=eI.creator,R(this,_,eI.order);for(const aI of eI.groups)H(this,oI).set(aI.id,new CI(aI.name,aI.intent));if(eI.baseState==="OFF")for(const aI of H(this,oI).values())aI._setVisible(iI,!1);for(const aI of eI.on)H(this,oI).get(aI)._setVisible(iI,!0);for(const aI of eI.off)H(this,oI).get(aI)._setVisible(iI,!1);R(this,E,new Map);for(const[aI,WI]of H(this,oI))H(this,E).set(aI,WI.visible)}}isVisible(eI){if(H(this,oI).size===0)return!0;if(!eI)return(0,o.warn)("Optional content group not defined."),!0;if(eI.type==="OCG")return H(this,oI).has(eI.id)?H(this,oI).get(eI.id).visible:((0,o.warn)(`Optional content group not found: ${eI.id}`),!0);if(eI.type==="OCMD"){if(eI.expression)return a(this,gI,O).call(this,eI.expression);if(!eI.policy||eI.policy==="AnyOn"){for(const aI of eI.ids){if(!H(this,oI).has(aI))return(0,o.warn)(`Optional content group not found: ${aI}`),!0;if(H(this,oI).get(aI).visible)return!0}return!1}else if(eI.policy==="AllOn"){for(const aI of eI.ids){if(!H(this,oI).has(aI))return(0,o.warn)(`Optional content group not found: ${aI}`),!0;if(!H(this,oI).get(aI).visible)return!1}return!0}else if(eI.policy==="AnyOff"){for(const aI of eI.ids){if(!H(this,oI).has(aI))return(0,o.warn)(`Optional content group not found: ${aI}`),!0;if(!H(this,oI).get(aI).visible)return!0}return!1}else if(eI.policy==="AllOff"){for(const aI of eI.ids){if(!H(this,oI).has(aI))return(0,o.warn)(`Optional content group not found: ${aI}`),!0;if(H(this,oI).get(aI).visible)return!1}return!0}return(0,o.warn)(`Unknown optional content policy ${eI.policy}.`),!0}return(0,o.warn)(`Unknown group type ${eI.type}.`),!0}setVisibility(eI){let aI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!H(this,oI).has(eI)){(0,o.warn)(`Optional content group not found: ${eI}`);return}H(this,oI).get(eI)._setVisible(iI,!!aI),R(this,sI,null)}get hasInitialVisibility(){if(H(this,sI)!==null)return H(this,sI);for(const[eI,aI]of H(this,oI)){const WI=H(this,E).get(eI);if(aI.visible!==WI)return R(this,sI,!1)}return R(this,sI,!0)}getOrder(){return H(this,oI).size?H(this,_)?H(this,_).slice():[...H(this,oI).keys()]:null}getGroups(){return H(this,oI).size>0?(0,o.objectFromMap)(H(this,oI)):null}getGroup(eI){return H(this,oI).get(eI)||null}}A.OptionalContentConfig=M;function O(dI){const eI=dI.length;if(eI<2)return!0;const aI=dI[0];for(let WI=1;WI<eI;WI++){const GI=dI[WI];let HI;if(Array.isArray(GI))HI=a(this,gI,O).call(this,GI);else if(H(this,oI).has(GI))HI=H(this,oI).get(GI).visible;else return(0,o.warn)(`Optional content group not found: ${GI}`),!0;switch(aI){case"And":if(!HI)return!1;break;case"Or":if(HI)return!0;break;case"Not":return!HI;default:return!0}}return aI==="And"}},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFDataTransportStream=void 0;var o=l(1),t=l(133);class a{constructor(r,H){(0,o.assert)(H,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=r.progressiveDone||!1,this._contentDispositionFilename=r.contentDispositionFilename||null;const II=r.initialData;if(II?.length>0){const k=new Uint8Array(II).buffer;this._queuedChunks.push(k)}this._pdfDataRangeTransport=H,this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._contentLength=r.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((k,iI)=>{this._onReceiveData({begin:k,chunk:iI})}),this._pdfDataRangeTransport.addProgressListener((k,iI)=>{this._onProgress({loaded:k,total:iI})}),this._pdfDataRangeTransport.addProgressiveReadListener(k=>{this._onReceiveData({chunk:k})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(r){const H=new Uint8Array(r.chunk).buffer;if(r.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(H):this._queuedChunks.push(H);else{const II=this._rangeReaders.some(function(k){return k._begin!==r.begin?!1:(k._enqueue(H),!0)});(0,o.assert)(II,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var r,H;return(r=(H=this._fullRequestReader)===null||H===void 0?void 0:H._loaded)!==null&&r!==void 0?r:0}_onProgress(r){if(r.total===void 0){const H=this._rangeReaders[0];H!=null&&H.onProgress&&H.onProgress({loaded:r.loaded})}else{const H=this._fullRequestReader;H!=null&&H.onProgress&&H.onProgress({loaded:r.loaded,total:r.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(r){const H=this._rangeReaders.indexOf(r);H>=0&&this._rangeReaders.splice(H,1)}getFullReader(){(0,o.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const r=this._queuedChunks;return this._queuedChunks=null,new n(this,r,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(r,H){if(H<=this._progressiveDataLength)return null;const II=new B(this,r,H);return this._pdfDataRangeTransport.requestDataRange(r,H),this._rangeReaders.push(II),II}cancelAllRequests(r){this._fullRequestReader&&this._fullRequestReader.cancel(r);for(const H of this._rangeReaders.slice(0))H.cancel(r);this._pdfDataRangeTransport.abort()}}A.PDFDataTransportStream=a;class n{constructor(r,H){let II=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this._stream=r,this._done=II||!1,this._filename=(0,t.isPdfFile)(k)?k:null,this._queuedChunks=H||[],this._loaded=0;for(const iI of this._queuedChunks)this._loaded+=iI.byteLength;this._requests=[],this._headersReady=Promise.resolve(),r._fullRequestReader=this,this.onProgress=null}_enqueue(r){this._done||(this._requests.length>0?this._requests.shift().resolve({value:r,done:!1}):this._queuedChunks.push(r),this._loaded+=r.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const r=(0,o.createPromiseCapability)();return this._requests.push(r),r.promise}cancel(r){this._done=!0;for(const H of this._requests)H.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class B{constructor(r,H,II){this._stream=r,this._begin=H,this._end=II,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(r){if(!this._done){if(this._requests.length===0)this._queuedChunk=r;else{this._requests.shift().resolve({value:r,done:!1});for(const II of this._requests)II.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const H=this._queuedChunk;return this._queuedChunk=null,{value:H,done:!1}}if(this._done)return{value:void 0,done:!0};const r=(0,o.createPromiseCapability)();return this._requests.push(r),r.promise}cancel(r){this._done=!0;for(const H of this._requests)H.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.XfaText=void 0;class l{static textContent(t){const a=[],n={items:a,styles:Object.create(null)};function B(R){var r;if(!R)return;let H=null;const II=R.name;if(II==="#text")H=R.value;else if(l.shouldBuildText(II))R!=null&&(r=R.attributes)!==null&&r!==void 0&&r.textContent?H=R.attributes.textContent:R.value&&(H=R.value);else return;if(H!==null&&a.push({str:H}),!!R.children)for(const k of R.children)B(k)}return B(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}A.XfaText=l},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.NodeStandardFontDataFactory=A.NodeCanvasFactory=A.NodeCMapReaderFactory=void 0;var o=l(134);const t=function(R){return new Promise((r,H)=>{require$$7.readFile(R,(k,iI)=>{if(k||!iI){H(new Error(k));return}r(new Uint8Array(iI))})})};class a extends o.BaseCanvasFactory{_createCanvas(r,H){return require$$7.createCanvas(r,H)}}A.NodeCanvasFactory=a;class n extends o.BaseCMapReaderFactory{_fetchData(r,H){return t(r).then(II=>({cMapData:II,compressionType:H}))}}A.NodeCMapReaderFactory=n;class B extends o.BaseStandardFontDataFactory{_fetchData(r){return t(r)}}A.NodeStandardFontDataFactory=B},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.AnnotationEditorLayer=void 0;var o=l(132),t=l(1),a=l(148),n=l(149);function B(VI,hI){H(VI,hI),hI.add(VI)}function R(VI,hI,wI){return hI in VI?Object.defineProperty(VI,hI,{value:wI,enumerable:!0,configurable:!0,writable:!0}):VI[hI]=wI,VI}function r(VI,hI,wI){H(VI,hI),hI.set(VI,wI)}function H(VI,hI){if(hI.has(VI))throw new TypeError("Cannot initialize the same private elements twice on an object")}function II(VI,hI,wI){if(!hI.has(VI))throw new TypeError("attempted to get private field on non-instance");return wI}function k(VI,hI){var wI=CI(VI,hI,"get");return iI(VI,wI)}function iI(VI,hI){return hI.get?hI.get.call(VI):hI.value}function lI(VI,hI,wI){var pI=CI(VI,hI,"set");return sI(VI,pI,wI),wI}function CI(VI,hI,wI){if(!hI.has(VI))throw new TypeError("attempted to "+wI+" private field on non-instance");return hI.get(VI)}function sI(VI,hI,wI){if(hI.set)hI.set.call(VI,wI);else{if(!hI.writable)throw new TypeError("attempted to set read only private field");hI.value=wI}}var oI=new WeakMap,E=new WeakMap,_=new WeakMap,gI=new WeakMap,M=new WeakMap,O=new WeakMap,dI=new WeakMap,eI=new WeakMap,aI=new WeakSet,WI=new WeakSet,GI=new WeakSet,HI=new WeakSet;class MI{constructor(hI){B(this,HI),B(this,GI),B(this,WI),B(this,aI),r(this,oI,{writable:!0,value:void 0}),r(this,E,{writable:!0,value:!1}),r(this,_,{writable:!0,value:this.pointerup.bind(this)}),r(this,gI,{writable:!0,value:this.pointerdown.bind(this)}),r(this,M,{writable:!0,value:new Map}),r(this,O,{writable:!0,value:!1}),r(this,dI,{writable:!0,value:!1}),r(this,eI,{writable:!0,value:void 0}),MI._initialized||(MI._initialized=!0,a.FreeTextEditor.initialize(hI.l10n),n.InkEditor.initialize(hI.l10n),hI.uiManager.registerEditorTypes([a.FreeTextEditor,n.InkEditor])),lI(this,eI,hI.uiManager),this.annotationStorage=hI.annotationStorage,this.pageIndex=hI.pageIndex,this.div=hI.div,lI(this,oI,hI.accessibilityManager),k(this,eI).addLayer(this)}updateToolbar(hI){k(this,eI).updateToolbar(hI)}updateMode(){let hI=arguments.length>0&&arguments[0]!==void 0?arguments[0]:k(this,eI).getMode();II(this,HI,yI).call(this),hI===t.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),k(this,eI).unselectAll()}addInkEditorIfNeeded(hI){if(!hI&&k(this,eI).getMode()!==t.AnnotationEditorType.INK)return;if(!hI){for(const pI of k(this,M).values())if(pI.isEmpty()){pI.setInBackground();return}}II(this,GI,NI).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(hI){k(this,eI).setEditingState(hI)}addCommands(hI){k(this,eI).addCommands(hI)}enable(){this.div.style.pointerEvents="auto";for(const hI of k(this,M).values())hI.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const hI of k(this,M).values())hI.disableEditing()}setActiveEditor(hI){k(this,eI).getActive()!==hI&&k(this,eI).setActiveEditor(hI)}enableClick(){this.div.addEventListener("pointerdown",k(this,gI)),this.div.addEventListener("pointerup",k(this,_))}disableClick(){this.div.removeEventListener("pointerdown",k(this,gI)),this.div.removeEventListener("pointerup",k(this,_))}attach(hI){k(this,M).set(hI.id,hI)}detach(hI){var wI;k(this,M).delete(hI.id),(wI=k(this,oI))===null||wI===void 0||wI.removePointerInTextLayer(hI.contentDiv)}remove(hI){k(this,eI).removeEditor(hI),this.detach(hI),this.annotationStorage.remove(hI.id),hI.div.style.display="none",setTimeout(()=>{hI.div.style.display="",hI.div.remove(),hI.isAttachedToDOM=!1,document.activeElement===document.body&&k(this,eI).focusMainContainer()},0),k(this,dI)||this.addInkEditorIfNeeded(!1)}add(hI){if(II(this,aI,KI).call(this,hI),k(this,eI).addEditor(hI),this.attach(hI),!hI.isAttachedToDOM){const wI=hI.render();this.div.append(wI),hI.isAttachedToDOM=!0}this.moveEditorInDOM(hI),hI.onceAdded(),this.addToAnnotationStorage(hI)}moveEditorInDOM(hI){var wI;(wI=k(this,oI))===null||wI===void 0||wI.moveElementInDOM(this.div,hI.div,hI.contentDiv,!0)}addToAnnotationStorage(hI){!hI.isEmpty()&&!this.annotationStorage.has(hI.id)&&this.annotationStorage.setValue(hI.id,hI)}addOrRebuild(hI){hI.needsToBeRebuilt()?hI.rebuild():this.add(hI)}addANewEditor(hI){const wI=()=>{this.addOrRebuild(hI)},pI=()=>{hI.remove()};this.addCommands({cmd:wI,undo:pI,mustExec:!0})}addUndoableEditor(hI){const wI=()=>{this.addOrRebuild(hI)},pI=()=>{hI.remove()};this.addCommands({cmd:wI,undo:pI,mustExec:!1})}getNextId(){return k(this,eI).getId()}deserialize(hI){switch(hI.annotationType){case t.AnnotationEditorType.FREETEXT:return a.FreeTextEditor.deserialize(hI,this);case t.AnnotationEditorType.INK:return n.InkEditor.deserialize(hI,this)}return null}setSelected(hI){k(this,eI).setSelected(hI)}toggleSelected(hI){k(this,eI).toggleSelected(hI)}isSelected(hI){return k(this,eI).isSelected(hI)}unselect(hI){k(this,eI).unselect(hI)}pointerup(hI){const wI=o.KeyboardManager.platform.isMac;if(!(hI.button!==0||hI.ctrlKey&&wI)&&hI.target===this.div&&k(this,O)){if(lI(this,O,!1),!k(this,E)){lI(this,E,!0);return}II(this,GI,NI).call(this,hI)}}pointerdown(hI){const wI=o.KeyboardManager.platform.isMac;if(hI.button!==0||hI.ctrlKey&&wI||hI.target!==this.div)return;lI(this,O,!0);const pI=k(this,eI).getActive();lI(this,E,!pI||pI.isEmpty())}drop(hI){const wI=hI.dataTransfer.getData("text/plain"),pI=k(this,eI).getEditor(wI);if(!pI)return;hI.preventDefault(),hI.dataTransfer.dropEffect="move",II(this,aI,KI).call(this,pI);const xI=this.div.getBoundingClientRect(),PI=hI.clientX-xI.x,XI=hI.clientY-xI.y;pI.translate(PI-pI.startX,XI-pI.startY),this.moveEditorInDOM(pI),pI.div.focus()}dragover(hI){hI.preventDefault()}destroy(){var hI;((hI=k(this,eI).getActive())===null||hI===void 0?void 0:hI.parent)===this&&k(this,eI).setActiveEditor(null);for(const pI of k(this,M).values()){var wI;(wI=k(this,oI))===null||wI===void 0||wI.removePointerInTextLayer(pI.contentDiv),pI.isAttachedToDOM=!1,pI.div.remove(),pI.parent=null}this.div=null,k(this,M).clear(),k(this,eI).removeLayer(this)}render(hI){this.viewport=hI.viewport,(0,o.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const wI of k(this,eI).getEditors(this.pageIndex))this.add(wI);this.updateMode()}update(hI){this.viewport=hI.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[hI,wI,pI,xI]=this.viewport.viewBox,PI=pI-hI,XI=xI-wI;return[PI,XI]}get viewportBaseDimensions(){const{width:hI,height:wI,rotation:pI}=this.viewport;return pI%180===0?[hI,wI]:[wI,hI]}setDimensions(){const{width:hI,height:wI,rotation:pI}=this.viewport,xI=pI%180!==0,PI=Math.floor(hI)+"px",XI=Math.floor(wI)+"px";this.div.style.width=xI?XI:PI,this.div.style.height=xI?PI:XI,this.div.setAttribute("data-main-rotation",pI)}}A.AnnotationEditorLayer=MI;function KI(VI){var hI;VI.parent!==this&&(this.attach(VI),VI.pageIndex=this.pageIndex,(hI=VI.parent)===null||hI===void 0||hI.detach(VI),VI.parent=this,VI.div&&VI.isAttachedToDOM&&(VI.div.remove(),this.div.append(VI.div)))}function DI(VI){switch(k(this,eI).getMode()){case t.AnnotationEditorType.FREETEXT:return new a.FreeTextEditor(VI);case t.AnnotationEditorType.INK:return new n.InkEditor(VI)}return null}function NI(VI){const hI=this.getNextId(),wI=II(this,WI,DI).call(this,{parent:this,id:hI,x:VI.offsetX,y:VI.offsetY});return wI&&this.add(wI),wI}function yI(){lI(this,dI,!0);for(const VI of k(this,M).values())VI.isEmpty()&&VI.remove();lI(this,dI,!1)}R(MI,"_initialized",!1)},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.FreeTextEditor=void 0;var o=l(1),t=l(132),a=l(131);function n(NI,yI){r(NI,yI),yI.add(NI)}function B(NI,yI,VI){return yI in NI?Object.defineProperty(NI,yI,{value:VI,enumerable:!0,configurable:!0,writable:!0}):NI[yI]=VI,NI}function R(NI,yI,VI){r(NI,yI),yI.set(NI,VI)}function r(NI,yI){if(yI.has(NI))throw new TypeError("Cannot initialize the same private elements twice on an object")}function H(NI,yI){var VI=lI(NI,yI,"get");return II(NI,VI)}function II(NI,yI){return yI.get?yI.get.call(NI):yI.value}function k(NI,yI,VI){if(!yI.has(NI))throw new TypeError("attempted to get private field on non-instance");return VI}function iI(NI,yI,VI){var hI=lI(NI,yI,"set");return CI(NI,hI,VI),VI}function lI(NI,yI,VI){if(!yI.has(NI))throw new TypeError("attempted to "+VI+" private field on non-instance");return yI.get(NI)}function CI(NI,yI,VI){if(yI.set)yI.set.call(NI,VI);else{if(!yI.writable)throw new TypeError("attempted to set read only private field");yI.value=VI}}var sI=new WeakMap,oI=new WeakMap,E=new WeakMap,_=new WeakMap,gI=new WeakMap,M=new WeakMap,O=new WeakMap,dI=new WeakSet,eI=new WeakSet,aI=new WeakSet,WI=new WeakSet;class GI extends a.AnnotationEditor{constructor(yI){super({...yI,name:"freeTextEditor"}),n(this,WI),n(this,aI),n(this,eI),n(this,dI),R(this,sI,{writable:!0,value:this.editorDivBlur.bind(this)}),R(this,oI,{writable:!0,value:this.editorDivFocus.bind(this)}),R(this,E,{writable:!0,value:this.editorDivKeydown.bind(this)}),R(this,_,{writable:!0,value:void 0}),R(this,gI,{writable:!0,value:""}),R(this,M,{writable:!0,value:!1}),R(this,O,{writable:!0,value:void 0}),iI(this,_,yI.color||GI._defaultColor||a.AnnotationEditor._defaultLineColor),iI(this,O,yI.fontSize||GI._defaultFontSize)}static initialize(yI){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(hI=>[hI,yI.get(hI)]));const VI=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(VI.getPropertyValue("--freetext-padding"))}static updateDefaultParams(yI,VI){switch(yI){case o.AnnotationEditorParamsType.FREETEXT_SIZE:GI._defaultFontSize=VI;break;case o.AnnotationEditorParamsType.FREETEXT_COLOR:GI._defaultColor=VI;break}}updateParams(yI,VI){switch(yI){case o.AnnotationEditorParamsType.FREETEXT_SIZE:k(this,dI,HI).call(this,VI);break;case o.AnnotationEditorParamsType.FREETEXT_COLOR:k(this,eI,MI).call(this,VI);break}}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.FREETEXT_SIZE,GI._defaultFontSize],[o.AnnotationEditorParamsType.FREETEXT_COLOR,GI._defaultColor||a.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[o.AnnotationEditorParamsType.FREETEXT_SIZE,H(this,O)],[o.AnnotationEditorParamsType.FREETEXT_COLOR,H(this,_)]]}getInitialTranslation(){return[-GI._internalPadding*this.parent.scaleFactor,-(GI._internalPadding+H(this,O))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(o.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",H(this,E)),this.editorDiv.addEventListener("focus",H(this,oI)),this.editorDiv.addEventListener("blur",H(this,sI)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",H(this,E)),this.editorDiv.removeEventListener("focus",H(this,oI)),this.editorDiv.removeEventListener("blur",H(this,sI)),this.div.focus(),this.isEditing=!1)}focusin(yI){super.focusin(yI),yI.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),H(this,M)||(iI(this,M,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),iI(this,gI,k(this,aI,KI).call(this).trimEnd()),k(this,WI,DI).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(yI){this.enableEditMode(),this.editorDiv.focus()}keydown(yI){yI.target===this.div&&yI.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(yI){GI._keyboardManager.exec(this,yI)}editorDivFocus(yI){this.isEditing=!0}editorDivBlur(yI){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let yI,VI;this.width&&(yI=this.x,VI=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),GI._l10nPromise.get("editor_free_text_aria_label").then(wI=>{var pI;return(pI=this.editorDiv)===null||pI===void 0?void 0:pI.setAttribute("aria-label",wI)}),GI._l10nPromise.get("free_text_default_content").then(wI=>{var pI;return(pI=this.editorDiv)===null||pI===void 0?void 0:pI.setAttribute("default-content",wI)}),this.editorDiv.contentEditable=!0;const{style:hI}=this.editorDiv;if(hI.fontSize=`calc(${H(this,O)}px * var(--scale-factor))`,hI.color=H(this,_),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,t.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[wI,pI]=this.parent.viewportBaseDimensions;this.setAt(yI*wI,VI*pI,this.width*wI,this.height*pI);for(const xI of H(this,gI).split(`
`)){const PI=document.createElement("div");PI.append(xI?document.createTextNode(xI):document.createElement("br")),this.editorDiv.append(PI)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(yI,VI){const hI=super.deserialize(yI,VI);return iI(hI,O,yI.fontSize),iI(hI,_,o.Util.makeHexColor(...yI.color)),iI(hI,gI,yI.value),hI}serialize(){if(this.isEmpty())return null;const yI=GI._internalPadding*this.parent.scaleFactor,VI=this.getRect(yI,yI),hI=a.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:o.AnnotationEditorType.FREETEXT,color:hI,fontSize:H(this,O),value:H(this,gI),pageIndex:this.parent.pageIndex,rect:VI,rotation:this.rotation}}}A.FreeTextEditor=GI;function HI(NI){const yI=hI=>{this.editorDiv.style.fontSize=`calc(${hI}px * var(--scale-factor))`,this.translate(0,-(hI-H(this,O))*this.parent.scaleFactor),iI(this,O,hI),k(this,WI,DI).call(this)},VI=H(this,O);this.parent.addCommands({cmd:()=>{yI(NI)},undo:()=>{yI(VI)},mustExec:!0,type:o.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function MI(NI){const yI=H(this,_);this.parent.addCommands({cmd:()=>{iI(this,_,NI),this.editorDiv.style.color=NI},undo:()=>{iI(this,_,yI),this.editorDiv.style.color=yI},mustExec:!0,type:o.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function KI(){const NI=this.editorDiv.getElementsByTagName("div");if(NI.length===0)return this.editorDiv.innerText;const yI=[];for(let VI=0,hI=NI.length;VI<hI;VI++){const pI=NI[VI].firstChild;pI?.nodeName==="#text"?yI.push(pI.data):yI.push("")}return yI.join(`
`)}function DI(){const[NI,yI]=this.parent.viewportBaseDimensions,VI=this.div.getBoundingClientRect();this.width=VI.width/NI,this.height=VI.height/yI}B(GI,"_freeTextDefaultContent",""),B(GI,"_l10nPromise",void 0),B(GI,"_internalPadding",0),B(GI,"_defaultColor",null),B(GI,"_defaultFontSize",10),B(GI,"_keyboardManager",new t.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],GI.prototype.commitOrRemove]])),B(GI,"_type","freetext")},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.InkEditor=void 0,Object.defineProperty(A,"fitCurve",{enumerable:!0,get:function(){return a.fitCurve}});var o=l(1),t=l(131),a=l(150),n=l(132);function B(EI,jI){H(EI,jI),jI.add(EI)}function R(EI,jI,Ag){return jI in EI?Object.defineProperty(EI,jI,{value:Ag,enumerable:!0,configurable:!0,writable:!0}):EI[jI]=Ag,EI}function r(EI,jI,Ag){H(EI,jI),jI.set(EI,Ag)}function H(EI,jI){if(jI.has(EI))throw new TypeError("Cannot initialize the same private elements twice on an object")}function II(EI,jI,Ag){return k(EI,jI),Ag}function k(EI,jI){if(EI!==jI)throw new TypeError("Private static access of wrong provenance")}function iI(EI,jI,Ag){var Zg=sI(EI,jI,"set");return lI(EI,Zg,Ag),Ag}function lI(EI,jI,Ag){if(jI.set)jI.set.call(EI,Ag);else{if(!jI.writable)throw new TypeError("attempted to set read only private field");jI.value=Ag}}function CI(EI,jI){var Ag=sI(EI,jI,"get");return oI(EI,Ag)}function sI(EI,jI,Ag){if(!jI.has(EI))throw new TypeError("attempted to "+Ag+" private field on non-instance");return jI.get(EI)}function oI(EI,jI){return jI.get?jI.get.call(EI):jI.value}function E(EI,jI,Ag){if(!jI.has(EI))throw new TypeError("attempted to get private field on non-instance");return Ag}const _=16;var gI=new WeakMap,M=new WeakMap,O=new WeakMap,dI=new WeakMap,eI=new WeakMap,aI=new WeakMap,WI=new WeakMap,GI=new WeakMap,HI=new WeakMap,MI=new WeakMap,KI=new WeakMap,DI=new WeakMap,NI=new WeakMap,yI=new WeakMap,VI=new WeakSet,hI=new WeakSet,wI=new WeakSet,pI=new WeakSet,xI=new WeakSet,PI=new WeakSet,XI=new WeakSet,tI=new WeakSet,mI=new WeakSet,YI=new WeakSet,BI=new WeakSet,AI=new WeakSet,cI=new WeakSet,bI=new WeakSet,nI=new WeakSet,uI=new WeakSet,rI=new WeakSet,FI=new WeakSet,kI=new WeakSet,TI=new WeakSet,QI=new WeakSet,fI=new WeakSet;class OI extends t.AnnotationEditor{constructor(jI){super({...jI,name:"inkEditor"}),B(this,fI),B(this,QI),B(this,TI),B(this,kI),B(this,FI),B(this,rI),B(this,uI),B(this,nI),B(this,bI),B(this,cI),B(this,AI),B(this,BI),B(this,YI),B(this,mI),B(this,tI),B(this,XI),B(this,PI),B(this,xI),B(this,pI),B(this,wI),B(this,hI),B(this,VI),r(this,gI,{writable:!0,value:0}),r(this,M,{writable:!0,value:0}),r(this,O,{writable:!0,value:0}),r(this,dI,{writable:!0,value:this.canvasPointermove.bind(this)}),r(this,eI,{writable:!0,value:this.canvasPointerleave.bind(this)}),r(this,aI,{writable:!0,value:this.canvasPointerup.bind(this)}),r(this,WI,{writable:!0,value:this.canvasPointerdown.bind(this)}),r(this,GI,{writable:!0,value:!1}),r(this,HI,{writable:!0,value:!1}),r(this,MI,{writable:!0,value:null}),r(this,KI,{writable:!0,value:null}),r(this,DI,{writable:!0,value:0}),r(this,NI,{writable:!0,value:0}),r(this,yI,{writable:!0,value:null}),this.color=jI.color||null,this.thickness=jI.thickness||null,this.opacity=jI.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(jI){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(Ag=>[Ag,jI.get(Ag)]))}static updateDefaultParams(jI,Ag){switch(jI){case o.AnnotationEditorParamsType.INK_THICKNESS:OI._defaultThickness=Ag;break;case o.AnnotationEditorParamsType.INK_COLOR:OI._defaultColor=Ag;break;case o.AnnotationEditorParamsType.INK_OPACITY:OI._defaultOpacity=Ag/100;break}}updateParams(jI,Ag){switch(jI){case o.AnnotationEditorParamsType.INK_THICKNESS:E(this,VI,qI).call(this,Ag);break;case o.AnnotationEditorParamsType.INK_COLOR:E(this,hI,gg).call(this,Ag);break;case o.AnnotationEditorParamsType.INK_OPACITY:E(this,wI,lg).call(this,Ag);break}}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.INK_THICKNESS,OI._defaultThickness],[o.AnnotationEditorParamsType.INK_COLOR,OI._defaultColor||t.AnnotationEditor._defaultLineColor],[o.AnnotationEditorParamsType.INK_OPACITY,Math.round(OI._defaultOpacity*100)]]}get propertiesToUpdate(){var jI;return[[o.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||OI._defaultThickness],[o.AnnotationEditorParamsType.INK_COLOR,this.color||OI._defaultColor||t.AnnotationEditor._defaultLineColor],[o.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((jI=this.opacity)!==null&&jI!==void 0?jI:OI._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(E(this,BI,vI).call(this),E(this,AI,Cg).call(this)),this.isAttachedToDOM||(this.parent.add(this),E(this,cI,Gg).call(this)),E(this,QI,bg).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,CI(this,KI).disconnect(),iI(this,KI,null),super.remove())}enableEditMode(){CI(this,GI)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",CI(this,WI)),this.canvas.addEventListener("pointerup",CI(this,aI)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",CI(this,WI)),this.canvas.removeEventListener("pointerup",CI(this,aI)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){CI(this,GI)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),iI(this,GI,!0),this.div.classList.add("disabled"),E(this,QI,bg).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(jI){super.focusin(jI),this.enableEditMode()}canvasPointerdown(jI){jI.button!==0||!this.isInEditMode()||CI(this,GI)||(this.setInForeground(),jI.type!=="mouse"&&this.div.focus(),jI.stopPropagation(),this.canvas.addEventListener("pointerleave",CI(this,eI)),this.canvas.addEventListener("pointermove",CI(this,dI)),E(this,PI,ig).call(this,jI.offsetX,jI.offsetY))}canvasPointermove(jI){jI.stopPropagation(),E(this,XI,Xg).call(this,jI.offsetX,jI.offsetY)}canvasPointerup(jI){jI.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(jI.stopPropagation(),E(this,YI,eg).call(this,jI),this.setInBackground())}canvasPointerleave(jI){E(this,YI,eg).call(this,jI),this.setInBackground()}render(){if(this.div)return this.div;let jI,Ag;this.width&&(jI=this.x,Ag=this.y),super.render(),OI._l10nPromise.get("editor_ink_aria_label").then(yg=>{var ng;return(ng=this.div)===null||ng===void 0?void 0:ng.setAttribute("aria-label",yg)});const[Zg,hg,Vg,ug]=E(this,pI,sg).call(this);if(this.setAt(Zg,hg,0,0),this.setDims(Vg,ug),E(this,BI,vI).call(this),this.width){const[yg,ng]=this.parent.viewportBaseDimensions;this.setAt(jI*yg,Ag*ng,this.width*yg,this.height*ng),iI(this,HI,!0),E(this,cI,Gg).call(this),this.setDims(this.width*yg,this.height*ng),E(this,mI,mg).call(this),E(this,fI,Wg).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return E(this,AI,Cg).call(this),this.div}setDimensions(jI,Ag){const Zg=Math.round(jI),hg=Math.round(Ag);if(CI(this,DI)===Zg&&CI(this,NI)===hg)return;iI(this,DI,Zg),iI(this,NI,hg),this.canvas.style.visibility="hidden",CI(this,gI)&&Math.abs(CI(this,gI)-jI/Ag)>.01&&(Ag=Math.ceil(jI/CI(this,gI)),this.setDims(jI,Ag));const[Vg,ug]=this.parent.viewportBaseDimensions;this.width=jI/Vg,this.height=Ag/ug,CI(this,GI)&&E(this,bI,Kg).call(this,jI,Ag),E(this,cI,Gg).call(this),E(this,mI,mg).call(this),this.canvas.style.visibility="visible"}static deserialize(jI,Ag){const Zg=super.deserialize(jI,Ag);Zg.thickness=jI.thickness,Zg.color=o.Util.makeHexColor(...jI.color),Zg.opacity=jI.opacity;const[hg,Vg]=Ag.pageDimensions,ug=Zg.width*hg,yg=Zg.height*Vg,ng=Ag.scaleFactor,Mg=jI.thickness/2;iI(Zg,gI,ug/yg),iI(Zg,GI,!0),iI(Zg,DI,Math.round(ug)),iI(Zg,NI,Math.round(yg));for(const{bezier:pg}of jI.paths){const Hg=[];Zg.paths.push(Hg);let Lg=ng*(pg[0]-Mg),Sg=ng*(yg-pg[1]-Mg);for(let Fg=2,_g=pg.length;Fg<_g;Fg+=6){const dC=ng*(pg[Fg]-Mg),fg=ng*(yg-pg[Fg+1]-Mg),bC=ng*(pg[Fg+2]-Mg),VC=ng*(yg-pg[Fg+3]-Mg),nC=ng*(pg[Fg+4]-Mg),Qg=ng*(yg-pg[Fg+5]-Mg);Hg.push([[Lg,Sg],[dC,fg],[bC,VC],[nC,Qg]]),Lg=nC,Sg=Qg}const Tg=II(this,OI,og).call(this,Hg);Zg.bezierPath2D.push(Tg)}const zg=E(Zg,kI,LI).call(Zg);return iI(Zg,O,Math.max(_,zg[2]-zg[0])),iI(Zg,M,Math.max(_,zg[3]-zg[1])),E(Zg,bI,Kg).call(Zg,ug,yg),Zg}serialize(){if(this.isEmpty())return null;const jI=this.getRect(0,0),Ag=this.rotation%180===0?jI[3]-jI[1]:jI[2]-jI[0],Zg=t.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:o.AnnotationEditorType.INK,color:Zg,thickness:this.thickness,opacity:this.opacity,paths:E(this,uI,wg).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,Ag),pageIndex:this.parent.pageIndex,rect:jI,rotation:this.rotation}}}A.InkEditor=OI;function qI(EI){const jI=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=EI,E(this,QI,bg).call(this)},undo:()=>{this.thickness=jI,E(this,QI,bg).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}function gg(EI){const jI=this.color;this.parent.addCommands({cmd:()=>{this.color=EI,E(this,mI,mg).call(this)},undo:()=>{this.color=jI,E(this,mI,mg).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function lg(EI){EI/=100;const jI=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=EI,E(this,mI,mg).call(this)},undo:()=>{this.opacity=jI,E(this,mI,mg).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}function sg(){const{width:EI,height:jI,rotation:Ag}=this.parent.viewport;switch(Ag){case 90:return[0,EI,EI,jI];case 180:return[EI,jI,EI,jI];case 270:return[jI,0,EI,jI];default:return[0,0,EI,jI]}}function tg(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,n.opacityToHex)(this.opacity)}`}function ig(EI,jI){if(this.isEditing=!0,!CI(this,HI)){var Ag;iI(this,HI,!0),E(this,cI,Gg).call(this),this.thickness||(this.thickness=OI._defaultThickness),this.color||(this.color=OI._defaultColor||t.AnnotationEditor._defaultLineColor),(Ag=this.opacity)!==null&&Ag!==void 0||(this.opacity=OI._defaultOpacity)}this.currentPath.push([EI,jI]),iI(this,MI,null),E(this,xI,tg).call(this),this.ctx.beginPath(),this.ctx.moveTo(EI,jI),iI(this,yI,()=>{CI(this,yI)&&(CI(this,MI)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):E(this,mI,mg).call(this),this.ctx.lineTo(...CI(this,MI)),iI(this,MI,null),this.ctx.stroke()),window.requestAnimationFrame(CI(this,yI)))}),window.requestAnimationFrame(CI(this,yI))}function Xg(EI,jI){const[Ag,Zg]=this.currentPath.at(-1);EI===Ag&&jI===Zg||(this.currentPath.push([EI,jI]),iI(this,MI,[EI,jI]))}function rg(EI,jI){this.ctx.closePath(),iI(this,yI,null),EI=Math.min(Math.max(EI,0),this.canvas.width),jI=Math.min(Math.max(jI,0),this.canvas.height);const[Ag,Zg]=this.currentPath.at(-1);(EI!==Ag||jI!==Zg)&&this.currentPath.push([EI,jI]);let hg;if(this.currentPath.length!==1)hg=(0,a.fitCurve)(this.currentPath,30,null);else{const ng=[EI,jI];hg=[[ng,ng.slice(),ng.slice(),ng]]}const Vg=II(OI,OI,og).call(OI,hg);this.currentPath.length=0;const ug=()=>{this.paths.push(hg),this.bezierPath2D.push(Vg),this.rebuild()},yg=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(E(this,BI,vI).call(this),E(this,AI,Cg).call(this)),E(this,QI,bg).call(this))};this.parent.addCommands({cmd:ug,undo:yg,mustExec:!0})}function mg(){if(this.isEmpty()){E(this,nI,Ig).call(this);return}E(this,xI,tg).call(this);const{canvas:EI,ctx:jI}=this;jI.setTransform(1,0,0,1,0,0),jI.clearRect(0,0,EI.width,EI.height),E(this,nI,Ig).call(this);for(const Ag of this.bezierPath2D)jI.stroke(Ag)}function eg(EI){E(this,tI,rg).call(this,EI.offsetX,EI.offsetY),this.canvas.removeEventListener("pointerleave",CI(this,eI)),this.canvas.removeEventListener("pointermove",CI(this,dI)),this.parent.addToAnnotationStorage(this)}function vI(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",OI._l10nPromise.get("editor_ink_canvas_aria_label").then(EI=>{var jI;return(jI=this.canvas)===null||jI===void 0?void 0:jI.setAttribute("aria-label",EI)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}function Cg(){iI(this,KI,new ResizeObserver(EI=>{const jI=EI[0].contentRect;jI.width&&jI.height&&this.setDimensions(jI.width,jI.height)})),CI(this,KI).observe(this.div)}function Gg(){if(!CI(this,HI))return;const[EI,jI]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*EI),this.canvas.height=Math.ceil(this.height*jI),E(this,nI,Ig).call(this)}function Kg(EI,jI){const Ag=E(this,TI,$I).call(this),Zg=(EI-Ag)/CI(this,O),hg=(jI-Ag)/CI(this,M);this.scaleFactor=Math.min(Zg,hg)}function Ig(){const EI=E(this,TI,$I).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+EI,this.translationY*this.scaleFactor+EI)}function og(EI){const jI=new Path2D;for(let Ag=0,Zg=EI.length;Ag<Zg;Ag++){const[hg,Vg,ug,yg]=EI[Ag];Ag===0&&jI.moveTo(...hg),jI.bezierCurveTo(Vg[0],Vg[1],ug[0],ug[1],yg[0],yg[1])}return jI}function wg(EI,jI,Ag,Zg){const Vg=[],ug=this.thickness/2;let yg,ng;for(const Mg of this.paths){yg=[],ng=[];for(let zg=0,pg=Mg.length;zg<pg;zg++){const[Hg,Lg,Sg,Tg]=Mg[zg],Fg=EI*(Hg[0]+jI)+ug,_g=Zg-EI*(Hg[1]+Ag)-ug,dC=EI*(Lg[0]+jI)+ug,fg=Zg-EI*(Lg[1]+Ag)-ug,bC=EI*(Sg[0]+jI)+ug,VC=Zg-EI*(Sg[1]+Ag)-ug,nC=EI*(Tg[0]+jI)+ug,Qg=Zg-EI*(Tg[1]+Ag)-ug;zg===0&&(yg.push(Fg,_g),ng.push(Fg,_g)),yg.push(dC,fg,bC,VC,nC,Qg),E(this,rI,UI).call(this,Fg,_g,dC,fg,bC,VC,nC,Qg,4,ng)}Vg.push({bezier:yg,points:ng})}return Vg}function UI(EI,jI,Ag,Zg,hg,Vg,ug,yg,ng,Mg){if(E(this,FI,JI).call(this,EI,jI,Ag,Zg,hg,Vg,ug,yg)){Mg.push(ug,yg);return}for(let zg=1;zg<ng-1;zg++){const pg=zg/ng,Hg=1-pg;let Lg=pg*EI+Hg*Ag,Sg=pg*jI+Hg*Zg,Tg=pg*Ag+Hg*hg,Fg=pg*Zg+Hg*Vg;const _g=pg*hg+Hg*ug,dC=pg*Vg+Hg*yg;Lg=pg*Lg+Hg*Tg,Sg=pg*Sg+Hg*Fg,Tg=pg*Tg+Hg*_g,Fg=pg*Fg+Hg*dC,Lg=pg*Lg+Hg*Tg,Sg=pg*Sg+Hg*Fg,Mg.push(Lg,Sg)}Mg.push(ug,yg)}function JI(EI,jI,Ag,Zg,hg,Vg,ug,yg){const Mg=(3*Ag-2*EI-ug)**2,zg=(3*Zg-2*jI-yg)**2,pg=(3*hg-EI-2*ug)**2,Hg=(3*Vg-jI-2*yg)**2;return Math.max(Mg,pg)+Math.max(zg,Hg)<=10}function LI(){let EI=1/0,jI=-1/0,Ag=1/0,Zg=-1/0;for(const hg of this.paths)for(const[Vg,ug,yg,ng]of hg){const Mg=o.Util.bezierBoundingBox(...Vg,...ug,...yg,...ng);EI=Math.min(EI,Mg[0]),Ag=Math.min(Ag,Mg[1]),jI=Math.max(jI,Mg[2]),Zg=Math.max(Zg,Mg[3])}return[EI,Ag,jI,Zg]}function $I(){return CI(this,GI)?Math.ceil(this.thickness*this.parent.scaleFactor):0}function bg(){let EI=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isEmpty())return;if(!CI(this,GI)){E(this,mI,mg).call(this);return}const jI=E(this,kI,LI).call(this),Ag=E(this,TI,$I).call(this);iI(this,O,Math.max(_,jI[2]-jI[0])),iI(this,M,Math.max(_,jI[3]-jI[1]));const Zg=Math.ceil(Ag+CI(this,O)*this.scaleFactor),hg=Math.ceil(Ag+CI(this,M)*this.scaleFactor),[Vg,ug]=this.parent.viewportBaseDimensions;this.width=Zg/Vg,this.height=hg/ug,iI(this,gI,Zg/hg),E(this,fI,Wg).call(this);const yg=this.translationX,ng=this.translationY;this.translationX=-jI[0],this.translationY=-jI[1],E(this,cI,Gg).call(this),E(this,mI,mg).call(this),iI(this,DI,Zg),iI(this,NI,hg),this.setDims(Zg,hg);const Mg=EI?Ag/this.scaleFactor/2:0;this.translate(yg-this.translationX-Mg,ng-this.translationY-Mg)}function Wg(){const{style:EI}=this.div;CI(this,gI)>=1?(EI.minHeight=`${_}px`,EI.minWidth=`${Math.round(CI(this,gI)*_)}px`):(EI.minWidth=`${_}px`,EI.minHeight=`${Math.round(_/CI(this,gI))}px`)}R(OI,"_defaultColor",null),R(OI,"_defaultOpacity",1),R(OI,"_defaultThickness",1),R(OI,"_l10nPromise",void 0),R(OI,"_type","ink")},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.fitCurve=void 0;const o=l(151);A.fitCurve=o},e=>{function A(lI,CI,sI){if(!Array.isArray(lI))throw new TypeError("First argument should be an array");if(lI.forEach(gI=>{if(!Array.isArray(gI)||gI.some(M=>typeof M!="number")||gI.length!==lI[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),lI=lI.filter((gI,M)=>M===0||!gI.every((O,dI)=>O===lI[M-1][dI])),lI.length<2)return[];const oI=lI.length,E=II(lI[1],lI[0]),_=II(lI[oI-2],lI[oI-1]);return l(lI,E,_,CI,sI)}function l(lI,CI,sI,oI,E){var gI,M,O,dI,eI,aI,WI,GI,HI,MI,KI,DI,NI;if(lI.length===2)return DI=k.vectorLen(k.subtract(lI[0],lI[1]))/3,gI=[lI[0],k.addArrays(lI[0],k.mulItems(CI,DI)),k.addArrays(lI[1],k.mulItems(sI,DI)),lI[1]],[gI];if(M=B(lI),[gI,dI,aI]=o(lI,M,M,CI,sI,E),dI===0||dI<oI)return[gI];if(dI<oI*oI)for(O=M,eI=dI,WI=aI,NI=0;NI<20;NI++){if(O=a(gI,lI,O),[gI,dI,aI]=o(lI,M,O,CI,sI,E),dI<oI)return[gI];if(aI===WI){let yI=dI/eI;if(yI>.9999&&yI<1.0001)break}eI=dI,WI=aI}return KI=[],GI=k.subtract(lI[aI-1],lI[aI+1]),GI.every(yI=>yI===0)&&(GI=k.subtract(lI[aI-1],lI[aI]),[GI[0],GI[1]]=[-GI[1],GI[0]]),HI=k.normalize(GI),MI=k.mulItems(HI,-1),KI=KI.concat(l(lI.slice(0,aI+1),CI,HI,oI,E)),KI=KI.concat(l(lI.slice(aI),MI,sI,oI,E)),KI}function o(lI,CI,sI,oI,E,_){var gI,M,O;return gI=t(lI,sI,oI,E),[M,O]=R(lI,gI,CI),_&&_({bez:gI,points:lI,params:CI,maxErr:M,maxPoint:O}),[gI,M,O]}function t(lI,CI,sI,oI){var E,_,gI,M,O,dI,eI,aI,WI,GI,HI,MI,KI,DI,NI,yI,VI,hI=lI[0],wI=lI[lI.length-1];for(E=[hI,null,null,wI],_=k.zeros_Xx2x2(CI.length),KI=0,DI=CI.length;KI<DI;KI++)yI=CI[KI],VI=1-yI,gI=_[KI],gI[0]=k.mulItems(sI,3*yI*(VI*VI)),gI[1]=k.mulItems(oI,3*VI*(yI*yI));for(M=[[0,0],[0,0]],O=[0,0],KI=0,DI=lI.length;KI<DI;KI++)yI=CI[KI],gI=_[KI],M[0][0]+=k.dot(gI[0],gI[0]),M[0][1]+=k.dot(gI[0],gI[1]),M[1][0]+=k.dot(gI[0],gI[1]),M[1][1]+=k.dot(gI[1],gI[1]),NI=k.subtract(lI[KI],iI.q([hI,hI,wI,wI],yI)),O[0]+=k.dot(gI[0],NI),O[1]+=k.dot(gI[1],NI);return dI=M[0][0]*M[1][1]-M[1][0]*M[0][1],eI=M[0][0]*O[1]-M[1][0]*O[0],aI=O[0]*M[1][1]-O[1]*M[0][1],WI=dI===0?0:aI/dI,GI=dI===0?0:eI/dI,MI=k.vectorLen(k.subtract(hI,wI)),HI=1e-6*MI,WI<HI||GI<HI?(E[1]=k.addArrays(hI,k.mulItems(sI,MI/3)),E[2]=k.addArrays(wI,k.mulItems(oI,MI/3))):(E[1]=k.addArrays(hI,k.mulItems(sI,WI)),E[2]=k.addArrays(wI,k.mulItems(oI,GI))),E}function a(lI,CI,sI){return sI.map((oI,E)=>n(lI,CI[E],oI))}function n(lI,CI,sI){var oI=k.subtract(iI.q(lI,sI),CI),E=iI.qprime(lI,sI),_=k.mulMatrix(oI,E),gI=k.sum(k.squareItems(E))+2*k.mulMatrix(oI,iI.qprimeprime(lI,sI));return gI===0?sI:sI-_/gI}function B(lI){var CI=[],sI,oI,E;return lI.forEach((_,gI)=>{sI=gI?oI+k.vectorLen(k.subtract(_,E)):0,CI.push(sI),oI=sI,E=_}),CI=CI.map(_=>_/oI),CI}function R(lI,CI,sI){var oI,E,_,gI,M,O,dI,eI;E=0,_=Math.floor(lI.length/2);const aI=r(CI,10);for(M=0,O=lI.length;M<O;M++)dI=lI[M],eI=H(CI,sI[M],aI,10),gI=k.subtract(iI.q(CI,eI),dI),oI=gI[0]*gI[0]+gI[1]*gI[1],oI>E&&(E=oI,_=M);return[E,_]}var r=function(lI,CI){for(var sI,oI=[0],E=lI[0],_=0,gI=1;gI<=CI;gI++)sI=iI.q(lI,gI/CI),_+=k.vectorLen(k.subtract(sI,E)),oI.push(_),E=sI;return oI=oI.map(M=>M/_),oI};function H(lI,CI,sI,oI){if(CI<0)return 0;if(CI>1)return 1;for(var E,_,gI,M,O,dI=1;dI<=oI;dI++)if(CI<=sI[dI]){M=(dI-1)/oI,gI=dI/oI,_=sI[dI-1],E=sI[dI],O=(CI-_)/(E-_)*(gI-M)+M;break}return O}function II(lI,CI){return k.normalize(k.subtract(lI,CI))}class k{static zeros_Xx2x2(CI){for(var sI=[];CI--;)sI.push([0,0]);return sI}static mulItems(CI,sI){return CI.map(oI=>oI*sI)}static mulMatrix(CI,sI){return CI.reduce((oI,E,_)=>oI+E*sI[_],0)}static subtract(CI,sI){return CI.map((oI,E)=>oI-sI[E])}static addArrays(CI,sI){return CI.map((oI,E)=>oI+sI[E])}static addItems(CI,sI){return CI.map(oI=>oI+sI)}static sum(CI){return CI.reduce((sI,oI)=>sI+oI)}static dot(CI,sI){return k.mulMatrix(CI,sI)}static vectorLen(CI){return Math.hypot(...CI)}static divItems(CI,sI){return CI.map(oI=>oI/sI)}static squareItems(CI){return CI.map(sI=>sI*sI)}static normalize(CI){return this.divItems(CI,this.vectorLen(CI))}}class iI{static q(CI,sI){var oI=1-sI,E=k.mulItems(CI[0],oI*oI*oI),_=k.mulItems(CI[1],3*oI*oI*sI),gI=k.mulItems(CI[2],3*oI*sI*sI),M=k.mulItems(CI[3],sI*sI*sI);return k.addArrays(k.addArrays(E,_),k.addArrays(gI,M))}static qprime(CI,sI){var oI=1-sI,E=k.mulItems(k.subtract(CI[1],CI[0]),3*oI*oI),_=k.mulItems(k.subtract(CI[2],CI[1]),6*oI*sI),gI=k.mulItems(k.subtract(CI[3],CI[2]),3*sI*sI);return k.addArrays(k.addArrays(E,_),gI)}static qprimeprime(CI,sI){return k.addArrays(k.mulItems(k.addArrays(k.subtract(CI[2],k.mulItems(CI[1],2)),CI[0]),6*(1-sI)),k.mulItems(k.addArrays(k.subtract(CI[3],k.mulItems(CI[2],2)),CI[1]),6*sI))}}e.exports=A,e.exports.fitCubic=l,e.exports.createTangent=II},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.AnnotationLayer=void 0;var o=l(1),t=l(133),a=l(130),n=l(153),B=l(154);function R(BI,AI,cI){return r(BI,AI),cI}function r(BI,AI){if(BI!==AI)throw new TypeError("Private static access of wrong provenance")}const H=1e3,II=9,k=new WeakSet;function iI(BI){return{width:BI[2]-BI[0],height:BI[3]-BI[1]}}class lI{static create(AI){switch(AI.data.annotationType){case o.AnnotationType.LINK:return new sI(AI);case o.AnnotationType.TEXT:return new oI(AI);case o.AnnotationType.WIDGET:switch(AI.data.fieldType){case"Tx":return new _(AI);case"Btn":return AI.data.radioButton?new M(AI):AI.data.checkBox?new gI(AI):new O(AI);case"Ch":return new dI(AI)}return new E(AI);case o.AnnotationType.POPUP:return new eI(AI);case o.AnnotationType.FREETEXT:return new WI(AI);case o.AnnotationType.LINE:return new GI(AI);case o.AnnotationType.SQUARE:return new HI(AI);case o.AnnotationType.CIRCLE:return new MI(AI);case o.AnnotationType.POLYLINE:return new KI(AI);case o.AnnotationType.CARET:return new NI(AI);case o.AnnotationType.INK:return new yI(AI);case o.AnnotationType.POLYGON:return new DI(AI);case o.AnnotationType.HIGHLIGHT:return new VI(AI);case o.AnnotationType.UNDERLINE:return new hI(AI);case o.AnnotationType.SQUIGGLY:return new wI(AI);case o.AnnotationType.STRIKEOUT:return new pI(AI);case o.AnnotationType.STAMP:return new xI(AI);case o.AnnotationType.FILEATTACHMENT:return new PI(AI);default:return new CI(AI)}}}class CI{constructor(AI){let{isRenderable:cI=!1,ignoreBorder:bI=!1,createQuadrilaterals:nI=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.isRenderable=cI,this.data=AI.data,this.layer=AI.layer,this.page=AI.page,this.viewport=AI.viewport,this.linkService=AI.linkService,this.downloadManager=AI.downloadManager,this.imageResourcesPath=AI.imageResourcesPath,this.renderForms=AI.renderForms,this.svgFactory=AI.svgFactory,this.annotationStorage=AI.annotationStorage,this.enableScripting=AI.enableScripting,this.hasJSActions=AI.hasJSActions,this._fieldObjects=AI.fieldObjects,this._mouseState=AI.mouseState,cI&&(this.container=this._createContainer(bI)),nI&&(this.quadrilaterals=this._createQuadrilaterals(bI))}_createContainer(){let AI=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const cI=this.data,bI=this.page,nI=this.viewport,uI=document.createElement("section"),{width:rI,height:FI}=iI(cI.rect),[kI,TI,QI,fI]=nI.viewBox,OI=QI-kI,qI=fI-TI;uI.setAttribute("data-annotation-id",cI.id);const gg=o.Util.normalizeRect([cI.rect[0],bI.view[3]-cI.rect[1]+bI.view[1],cI.rect[2],bI.view[3]-cI.rect[3]+bI.view[1]]);if(!AI&&cI.borderStyle.width>0){uI.style.borderWidth=`${cI.borderStyle.width}px`;const sg=cI.borderStyle.horizontalCornerRadius,tg=cI.borderStyle.verticalCornerRadius;if(sg>0||tg>0){const Xg=`calc(${sg}px * var(--scale-factor)) / calc(${tg}px * var(--scale-factor))`;uI.style.borderRadius=Xg}else if(this instanceof M){const Xg=`calc(${rI}px * var(--scale-factor)) / calc(${FI}px * var(--scale-factor))`;uI.style.borderRadius=Xg}switch(cI.borderStyle.style){case o.AnnotationBorderStyleType.SOLID:uI.style.borderStyle="solid";break;case o.AnnotationBorderStyleType.DASHED:uI.style.borderStyle="dashed";break;case o.AnnotationBorderStyleType.BEVELED:(0,o.warn)("Unimplemented border style: beveled");break;case o.AnnotationBorderStyleType.INSET:(0,o.warn)("Unimplemented border style: inset");break;case o.AnnotationBorderStyleType.UNDERLINE:uI.style.borderBottomStyle="solid";break}const ig=cI.borderColor||null;ig?uI.style.borderColor=o.Util.makeHexColor(ig[0]|0,ig[1]|0,ig[2]|0):uI.style.borderWidth=0}uI.style.left=`${100*(gg[0]-kI)/OI}%`,uI.style.top=`${100*(gg[1]-TI)/qI}%`;const{rotation:lg}=cI;return cI.hasOwnCanvas||lg===0?(uI.style.width=`${100*rI/OI}%`,uI.style.height=`${100*FI/qI}%`):this.setRotation(lg,uI),uI}setRotation(AI){let cI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.container;const[bI,nI,uI,rI]=this.viewport.viewBox,FI=uI-bI,kI=rI-nI,{width:TI,height:QI}=iI(this.data.rect);let fI,OI;AI%180===0?(fI=100*TI/FI,OI=100*QI/kI):(fI=100*QI/FI,OI=100*TI/kI),cI.style.width=`${fI}%`,cI.style.height=`${OI}%`,cI.setAttribute("data-main-rotation",(360-AI)%360)}get _commonActions(){const AI=(cI,bI,nI)=>{const uI=nI.detail[cI];nI.target.style[bI]=n.ColorConverters[`${uI[0]}_HTML`](uI.slice(1))};return(0,o.shadow)(this,"_commonActions",{display:cI=>{const bI=cI.detail.display%2===1;this.container.style.visibility=bI?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:bI,print:cI.detail.display===0||cI.detail.display===3})},print:cI=>{this.annotationStorage.setValue(this.data.id,{print:cI.detail.print})},hidden:cI=>{this.container.style.visibility=cI.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:cI.detail.hidden})},focus:cI=>{setTimeout(()=>cI.target.focus({preventScroll:!1}),0)},userName:cI=>{cI.target.title=cI.detail.userName},readonly:cI=>{cI.detail.readonly?cI.target.setAttribute("readonly",""):cI.target.removeAttribute("readonly")},required:cI=>{this._setRequired(cI.target,cI.detail.required)},bgColor:cI=>{AI("bgColor","backgroundColor",cI)},fillColor:cI=>{AI("fillColor","backgroundColor",cI)},fgColor:cI=>{AI("fgColor","color",cI)},textColor:cI=>{AI("textColor","color",cI)},borderColor:cI=>{AI("borderColor","borderColor",cI)},strokeColor:cI=>{AI("strokeColor","borderColor",cI)},rotation:cI=>{const bI=cI.detail.rotation;this.setRotation(bI),this.annotationStorage.setValue(this.data.id,{rotation:bI})}})}_dispatchEventFromSandbox(AI,cI){const bI=this._commonActions;for(const nI of Object.keys(cI.detail)){const uI=AI[nI]||bI[nI];uI&&uI(cI)}}_setDefaultPropertiesFromJS(AI){if(!this.enableScripting)return;const cI=this.annotationStorage.getRawValue(this.data.id);if(!cI)return;const bI=this._commonActions;for(const[nI,uI]of Object.entries(cI)){const rI=bI[nI];if(rI){const FI={detail:{[nI]:uI},target:AI};rI(FI),delete cI[nI]}}}_createQuadrilaterals(){let AI=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.data.quadPoints)return null;const cI=[],bI=this.data.rect;for(const nI of this.data.quadPoints)this.data.rect=[nI[2].x,nI[2].y,nI[1].x,nI[1].y],cI.push(this._createContainer(AI));return this.data.rect=bI,cI}_createPopup(AI,cI){let bI=this.container;this.quadrilaterals&&(AI=AI||this.quadrilaterals,bI=this.quadrilaterals[0]),AI||(AI=document.createElement("div"),AI.className="popupTriggerArea",bI.append(AI));const uI=new aI({container:bI,trigger:AI,color:cI.color,titleObj:cI.titleObj,modificationDate:cI.modificationDate,contentsObj:cI.contentsObj,richText:cI.richText,hideWrapper:!0}).render();uI.style.left="100%",bI.append(uI)}_renderQuadrilaterals(AI){for(const cI of this.quadrilaterals)cI.className=AI;return this.quadrilaterals}render(){(0,o.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(AI){let cI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const bI=[];if(this._fieldObjects){const nI=this._fieldObjects[AI];if(nI)for(const{page:uI,id:rI,exportValues:FI}of nI){if(uI===-1||rI===cI)continue;const kI=typeof FI=="string"?FI:null,TI=document.querySelector(`[data-element-id="${rI}"]`);if(TI&&!k.has(TI)){(0,o.warn)(`_getElementsByName - element not allowed: ${rI}`);continue}bI.push({id:rI,exportValue:kI,domElement:TI})}return bI}for(const nI of document.getElementsByName(AI)){const{id:uI,exportValue:rI}=nI;uI!==cI&&k.has(nI)&&bI.push({id:uI,exportValue:rI,domElement:nI})}return bI}static get platform(){const AI=typeof navigator<"u"?navigator.platform:"";return(0,o.shadow)(this,"platform",{isWin:AI.includes("Win"),isMac:AI.includes("Mac")})}}class sI extends CI{constructor(AI){let cI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;super(AI,{isRenderable:!0,ignoreBorder:!!(cI!=null&&cI.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=AI.data.isTooltipOnly}render(){const{data:AI,linkService:cI}=this,bI=document.createElement("a");bI.setAttribute("data-element-id",AI.id);let nI=!1;return AI.url?(cI.addLinkAttributes(bI,AI.url,AI.newWindow),nI=!0):AI.action?(this._bindNamedAction(bI,AI.action),nI=!0):AI.dest?(this._bindLink(bI,AI.dest),nI=!0):(AI.actions&&(AI.actions.Action||AI.actions["Mouse Up"]||AI.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(bI,AI),nI=!0),AI.resetForm?(this._bindResetFormAction(bI,AI.resetForm),nI=!0):this.isTooltipOnly&&!nI&&(this._bindLink(bI,""),nI=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((uI,rI)=>{const FI=rI===0?bI:bI.cloneNode();return uI.append(FI),uI}):(this.container.className="linkAnnotation",nI&&this.container.append(bI),this.container)}_bindLink(AI,cI){AI.href=this.linkService.getDestinationHash(cI),AI.onclick=()=>(cI&&this.linkService.goToDestination(cI),!1),(cI||cI==="")&&(AI.className="internalLink")}_bindNamedAction(AI,cI){AI.href=this.linkService.getAnchorUrl(""),AI.onclick=()=>(this.linkService.executeNamedAction(cI),!1),AI.className="internalLink"}_bindJSAction(AI,cI){AI.href=this.linkService.getAnchorUrl("");const bI=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const nI of Object.keys(cI.actions)){const uI=bI.get(nI);uI&&(AI[uI]=()=>{var rI;return(rI=this.linkService.eventBus)===null||rI===void 0||rI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:cI.id,name:nI}}),!1})}AI.onclick||(AI.onclick=()=>!1),AI.className="internalLink"}_bindResetFormAction(AI,cI){const bI=AI.onclick;if(bI||(AI.href=this.linkService.getAnchorUrl("")),AI.className="internalLink",!this._fieldObjects){(0,o.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),bI||(AI.onclick=()=>!1);return}AI.onclick=()=>{bI&&bI();const{fields:nI,refs:uI,include:rI}=cI,FI=[];if(nI.length!==0||uI.length!==0){const fI=new Set(uI);for(const OI of nI){const qI=this._fieldObjects[OI]||[];for(const{id:gg}of qI)fI.add(gg)}for(const OI of Object.values(this._fieldObjects))for(const qI of OI)fI.has(qI.id)===rI&&FI.push(qI)}else for(const fI of Object.values(this._fieldObjects))FI.push(...fI);const kI=this.annotationStorage,TI=[];for(const fI of FI){const{id:OI}=fI;switch(TI.push(OI),fI.type){case"text":{const gg=fI.defaultValue||"";kI.setValue(OI,{value:gg});break}case"checkbox":case"radiobutton":{const gg=fI.defaultValue===fI.exportValues;kI.setValue(OI,{value:gg});break}case"combobox":case"listbox":{const gg=fI.defaultValue||"";kI.setValue(OI,{value:gg});break}default:continue}const qI=document.querySelector(`[data-element-id="${OI}"]`);if(qI){if(!k.has(qI)){(0,o.warn)(`_bindResetFormAction - element not allowed: ${OI}`);continue}}else continue;qI.dispatchEvent(new Event("resetform"))}if(this.enableScripting){var QI;(QI=this.linkService.eventBus)===null||QI===void 0||QI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:TI,name:"ResetForm"}})}return!1}}}class oI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI})}render(){this.container.className="textAnnotation";const AI=document.createElement("img");return AI.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",AI.alt="[{{type}} Annotation]",AI.dataset.l10nId="text_annotation_type",AI.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(AI,this.data),this.container.append(AI),this.container}}class E extends CI{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(AI){const{isWin:cI,isMac:bI}=CI.platform;return cI&&AI.ctrlKey||bI&&AI.metaKey}_setEventListener(AI,cI,bI,nI){cI.includes("mouse")?AI.addEventListener(cI,uI=>{var rI;(rI=this.linkService.eventBus)===null||rI===void 0||rI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:bI,value:nI(uI),shift:uI.shiftKey,modifier:this._getKeyModifier(uI)}})}):AI.addEventListener(cI,uI=>{var rI;(rI=this.linkService.eventBus)===null||rI===void 0||rI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:bI,value:nI(uI)}})})}_setEventListeners(AI,cI,bI){for(const[uI,rI]of cI){var nI;(rI==="Action"||(nI=this.data.actions)!==null&&nI!==void 0&&nI[rI])&&this._setEventListener(AI,uI,rI,bI)}}_setBackgroundColor(AI){const cI=this.data.backgroundColor||null;AI.style.backgroundColor=cI===null?"transparent":o.Util.makeHexColor(cI[0],cI[1],cI[2])}_setTextStyle(AI){const cI=["left","center","right"],{fontColor:bI}=this.data.defaultAppearanceData,nI=this.data.defaultAppearanceData.fontSize||II,uI=AI.style;let rI;if(this.data.multiLine){const FI=Math.abs(this.data.rect[3]-this.data.rect[1]),kI=Math.round(FI/(o.LINE_FACTOR*nI))||1,TI=FI/kI;rI=Math.min(nI,Math.round(TI/o.LINE_FACTOR))}else{const FI=Math.abs(this.data.rect[3]-this.data.rect[1]);rI=Math.min(nI,Math.round(FI/o.LINE_FACTOR))}uI.fontSize=`calc(${rI}px * var(--scale-factor))`,uI.color=o.Util.makeHexColor(bI[0],bI[1],bI[2]),this.data.textAlignment!==null&&(uI.textAlign=cI[this.data.textAlignment])}_setRequired(AI,cI){cI?AI.setAttribute("required",!0):AI.removeAttribute("required"),AI.setAttribute("aria-required",cI)}}class _ extends E{constructor(AI){const cI=AI.renderForms||!AI.data.hasAppearance&&!!AI.data.fieldValue;super(AI,{isRenderable:cI})}setPropertyOnSiblings(AI,cI,bI,nI){const uI=this.annotationStorage;for(const rI of this._getElementsByName(AI.name,AI.id))rI.domElement&&(rI.domElement[cI]=bI),uI.setValue(rI.id,{[nI]:bI})}render(){const AI=this.annotationStorage,cI=this.data.id;this.container.className="textWidgetAnnotation";let bI=null;if(this.renderForms){const uI=AI.getValue(cI,{value:this.data.fieldValue});let rI=uI.formattedValue||uI.value||"";const FI=AI.getValue(cI,{charLimit:this.data.maxLen}).charLimit;FI&&rI.length>FI&&(rI=rI.slice(0,FI));const kI={userValue:rI,formattedValue:null,valueOnFocus:""};this.data.multiLine?(bI=document.createElement("textarea"),bI.textContent=rI,this.data.doNotScroll&&(bI.style.overflowY="hidden")):(bI=document.createElement("input"),bI.type="text",bI.setAttribute("value",rI),this.data.doNotScroll&&(bI.style.overflowX="hidden")),k.add(bI),bI.setAttribute("data-element-id",cI),bI.disabled=this.data.readOnly,bI.name=this.data.fieldName,bI.tabIndex=H,this._setRequired(bI,this.data.required),FI&&(bI.maxLength=FI),bI.addEventListener("input",QI=>{AI.setValue(cI,{value:QI.target.value}),this.setPropertyOnSiblings(bI,"value",QI.target.value,"value")}),bI.addEventListener("resetform",QI=>{var fI;const OI=(fI=this.data.defaultFieldValue)!==null&&fI!==void 0?fI:"";bI.value=kI.userValue=OI,kI.formattedValue=null});let TI=QI=>{const{formattedValue:fI}=kI;fI!=null&&(QI.target.value=fI),QI.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var nI;bI.addEventListener("focus",fI=>{kI.userValue&&(fI.target.value=kI.userValue),kI.valueOnFocus=fI.target.value}),bI.addEventListener("updatefromsandbox",fI=>{const OI={value(qI){var gg;kI.userValue=(gg=qI.detail.value)!==null&&gg!==void 0?gg:"",AI.setValue(cI,{value:kI.userValue.toString()}),qI.target.value=kI.userValue},formattedValue(qI){const{formattedValue:gg}=qI.detail;kI.formattedValue=gg,gg!=null&&qI.target!==document.activeElement&&(qI.target.value=gg),AI.setValue(cI,{formattedValue:gg})},selRange(qI){qI.target.setSelectionRange(...qI.detail.selRange)},charLimit:qI=>{var gg;const{charLimit:lg}=qI.detail,{target:sg}=qI;if(lg===0){sg.removeAttribute("maxLength");return}sg.setAttribute("maxLength",lg);let tg=kI.userValue;!tg||tg.length<=lg||(tg=tg.slice(0,lg),sg.value=kI.userValue=tg,AI.setValue(cI,{value:tg}),(gg=this.linkService.eventBus)===null||gg===void 0||gg.dispatch("dispatcheventinsandbox",{source:this,detail:{id:cI,name:"Keystroke",value:tg,willCommit:!0,commitKey:1,selStart:sg.selectionStart,selEnd:sg.selectionEnd}}))}};this._dispatchEventFromSandbox(OI,fI)}),bI.addEventListener("keydown",fI=>{var OI;let qI=-1;if(fI.key==="Escape"?qI=0:fI.key==="Enter"?qI=2:fI.key==="Tab"&&(qI=3),qI===-1)return;const{value:gg}=fI.target;kI.valueOnFocus!==gg&&(kI.userValue=gg,(OI=this.linkService.eventBus)===null||OI===void 0||OI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:cI,name:"Keystroke",value:gg,willCommit:!0,commitKey:qI,selStart:fI.target.selectionStart,selEnd:fI.target.selectionEnd}}))});const QI=TI;TI=null,bI.addEventListener("blur",fI=>{const{value:OI}=fI.target;if(kI.userValue=OI,this._mouseState.isDown&&kI.valueOnFocus!==OI){var qI;(qI=this.linkService.eventBus)===null||qI===void 0||qI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:cI,name:"Keystroke",value:OI,willCommit:!0,commitKey:1,selStart:fI.target.selectionStart,selEnd:fI.target.selectionEnd}})}QI(fI)}),(nI=this.data.actions)!==null&&nI!==void 0&&nI.Keystroke&&bI.addEventListener("beforeinput",fI=>{var OI;const{data:qI,target:gg}=fI,{value:lg,selectionStart:sg,selectionEnd:tg}=gg;let ig=sg,Xg=tg;switch(fI.inputType){case"deleteWordBackward":{const rg=lg.substring(0,sg).match(/\w*[^\w]*$/);rg&&(ig-=rg[0].length);break}case"deleteWordForward":{const rg=lg.substring(sg).match(/^[^\w]*\w*/);rg&&(Xg+=rg[0].length);break}case"deleteContentBackward":sg===tg&&(ig-=1);break;case"deleteContentForward":sg===tg&&(Xg+=1);break}fI.preventDefault(),(OI=this.linkService.eventBus)===null||OI===void 0||OI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:cI,name:"Keystroke",value:lg,change:qI||"",willCommit:!1,selStart:ig,selEnd:Xg}})}),this._setEventListeners(bI,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],fI=>fI.target.value)}if(TI&&bI.addEventListener("blur",TI),this.data.comb){const fI=(this.data.rect[2]-this.data.rect[0])/FI;bI.classList.add("comb"),bI.style.letterSpacing=`calc(${fI}px * var(--scale-factor) - 1ch)`}}else bI=document.createElement("div"),bI.textContent=this.data.fieldValue,bI.style.verticalAlign="middle",bI.style.display="table-cell";return this._setTextStyle(bI),this._setBackgroundColor(bI),this._setDefaultPropertiesFromJS(bI),this.container.append(bI),this.container}}class gI extends E{constructor(AI){super(AI,{isRenderable:AI.renderForms})}render(){const AI=this.annotationStorage,cI=this.data,bI=cI.id;let nI=AI.getValue(bI,{value:cI.exportValue===cI.fieldValue}).value;typeof nI=="string"&&(nI=nI!=="Off",AI.setValue(bI,{value:nI})),this.container.className="buttonWidgetAnnotation checkBox";const uI=document.createElement("input");return k.add(uI),uI.setAttribute("data-element-id",bI),uI.disabled=cI.readOnly,this._setRequired(uI,this.data.required),uI.type="checkbox",uI.name=cI.fieldName,nI&&uI.setAttribute("checked",!0),uI.setAttribute("exportValue",cI.exportValue),uI.tabIndex=H,uI.addEventListener("change",rI=>{const{name:FI,checked:kI}=rI.target;for(const TI of this._getElementsByName(FI,bI)){const QI=kI&&TI.exportValue===cI.exportValue;TI.domElement&&(TI.domElement.checked=QI),AI.setValue(TI.id,{value:QI})}AI.setValue(bI,{value:kI})}),uI.addEventListener("resetform",rI=>{const FI=cI.defaultFieldValue||"Off";rI.target.checked=FI===cI.exportValue}),this.enableScripting&&this.hasJSActions&&(uI.addEventListener("updatefromsandbox",rI=>{const FI={value(kI){kI.target.checked=kI.detail.value!=="Off",AI.setValue(bI,{value:kI.target.checked})}};this._dispatchEventFromSandbox(FI,rI)}),this._setEventListeners(uI,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],rI=>rI.target.checked)),this._setBackgroundColor(uI),this._setDefaultPropertiesFromJS(uI),this.container.append(uI),this.container}}class M extends E{constructor(AI){super(AI,{isRenderable:AI.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const AI=this.annotationStorage,cI=this.data,bI=cI.id;let nI=AI.getValue(bI,{value:cI.fieldValue===cI.buttonValue}).value;typeof nI=="string"&&(nI=nI!==cI.buttonValue,AI.setValue(bI,{value:nI}));const uI=document.createElement("input");if(k.add(uI),uI.setAttribute("data-element-id",bI),uI.disabled=cI.readOnly,this._setRequired(uI,this.data.required),uI.type="radio",uI.name=cI.fieldName,nI&&uI.setAttribute("checked",!0),uI.tabIndex=H,uI.addEventListener("change",rI=>{const{name:FI,checked:kI}=rI.target;for(const TI of this._getElementsByName(FI,bI))AI.setValue(TI.id,{value:!1});AI.setValue(bI,{value:kI})}),uI.addEventListener("resetform",rI=>{const FI=cI.defaultFieldValue;rI.target.checked=FI!=null&&FI===cI.buttonValue}),this.enableScripting&&this.hasJSActions){const rI=cI.buttonValue;uI.addEventListener("updatefromsandbox",FI=>{const kI={value:TI=>{const QI=rI===TI.detail.value;for(const fI of this._getElementsByName(TI.target.name)){const OI=QI&&fI.id===bI;fI.domElement&&(fI.domElement.checked=OI),AI.setValue(fI.id,{value:OI})}}};this._dispatchEventFromSandbox(kI,FI)}),this._setEventListeners(uI,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],FI=>FI.target.checked)}return this._setBackgroundColor(uI),this._setDefaultPropertiesFromJS(uI),this.container.append(uI),this.container}}class O extends sI{constructor(AI){super(AI,{ignoreBorder:AI.data.hasAppearance})}render(){const AI=super.render();AI.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(AI.title=this.data.alternativeText);const cI=AI.lastChild;return this.enableScripting&&this.hasJSActions&&cI&&(this._setDefaultPropertiesFromJS(cI),cI.addEventListener("updatefromsandbox",bI=>{this._dispatchEventFromSandbox({},bI)})),AI}}class dI extends E{constructor(AI){super(AI,{isRenderable:AI.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const AI=this.annotationStorage,cI=this.data.id,bI=AI.getValue(cI,{value:this.data.fieldValue}),nI=document.createElement("select");k.add(nI),nI.setAttribute("data-element-id",cI),nI.disabled=this.data.readOnly,this._setRequired(nI,this.data.required),nI.name=this.data.fieldName,nI.tabIndex=H;let uI=this.data.combo&&this.data.options.length>0;this.data.combo||(nI.size=this.data.options.length,this.data.multiSelect&&(nI.multiple=!0)),nI.addEventListener("resetform",TI=>{const QI=this.data.defaultFieldValue;for(const fI of nI.options)fI.selected=fI.value===QI});for(const TI of this.data.options){const QI=document.createElement("option");QI.textContent=TI.displayValue,QI.value=TI.exportValue,bI.value.includes(TI.exportValue)&&(QI.setAttribute("selected",!0),uI=!1),nI.append(QI)}let rI=null;if(uI){const TI=document.createElement("option");TI.value=" ",TI.setAttribute("hidden",!0),TI.setAttribute("selected",!0),nI.prepend(TI),rI=()=>{TI.remove(),nI.removeEventListener("input",rI),rI=null},nI.addEventListener("input",rI)}const FI=(TI,QI)=>{const fI=QI?"value":"textContent",OI=TI.target.options;return TI.target.multiple?Array.prototype.filter.call(OI,qI=>qI.selected).map(qI=>qI[fI]):OI.selectedIndex===-1?null:OI[OI.selectedIndex][fI]},kI=TI=>{const QI=TI.target.options;return Array.prototype.map.call(QI,fI=>({displayValue:fI.textContent,exportValue:fI.value}))};return this.enableScripting&&this.hasJSActions?(nI.addEventListener("updatefromsandbox",TI=>{const QI={value(fI){var OI;(OI=rI)===null||OI===void 0||OI();const qI=fI.detail.value,gg=new Set(Array.isArray(qI)?qI:[qI]);for(const lg of nI.options)lg.selected=gg.has(lg.value);AI.setValue(cI,{value:FI(fI,!0)})},multipleSelection(fI){nI.multiple=!0},remove(fI){const OI=nI.options,qI=fI.detail.remove;OI[qI].selected=!1,nI.remove(qI),OI.length>0&&Array.prototype.findIndex.call(OI,lg=>lg.selected)===-1&&(OI[0].selected=!0),AI.setValue(cI,{value:FI(fI,!0),items:kI(fI)})},clear(fI){for(;nI.length!==0;)nI.remove(0);AI.setValue(cI,{value:null,items:[]})},insert(fI){const{index:OI,displayValue:qI,exportValue:gg}=fI.detail.insert,lg=nI.children[OI],sg=document.createElement("option");sg.textContent=qI,sg.value=gg,lg?lg.before(sg):nI.append(sg),AI.setValue(cI,{value:FI(fI,!0),items:kI(fI)})},items(fI){const{items:OI}=fI.detail;for(;nI.length!==0;)nI.remove(0);for(const qI of OI){const{displayValue:gg,exportValue:lg}=qI,sg=document.createElement("option");sg.textContent=gg,sg.value=lg,nI.append(sg)}nI.options.length>0&&(nI.options[0].selected=!0),AI.setValue(cI,{value:FI(fI,!0),items:kI(fI)})},indices(fI){const OI=new Set(fI.detail.indices);for(const qI of fI.target.options)qI.selected=OI.has(qI.index);AI.setValue(cI,{value:FI(fI,!0)})},editable(fI){fI.target.disabled=!fI.detail.editable}};this._dispatchEventFromSandbox(QI,TI)}),nI.addEventListener("input",TI=>{var QI;const fI=FI(TI,!0),OI=FI(TI,!1);AI.setValue(cI,{value:fI}),(QI=this.linkService.eventBus)===null||QI===void 0||QI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:cI,name:"Keystroke",value:OI,changeEx:fI,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(nI,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],TI=>TI.target.checked)):nI.addEventListener("input",function(TI){AI.setValue(cI,{value:FI(TI,!0)})}),this.data.combo&&this._setTextStyle(nI),this._setBackgroundColor(nI),this._setDefaultPropertiesFromJS(nI),this.container.append(nI),this.container}}class eI extends CI{constructor(AI){var cI,bI,nI;const uI=!!((cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI})}render(){const AI=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",AI.includes(this.data.parentType))return this.container;const cI=`[data-annotation-id="${this.data.parentId}"]`,bI=this.layer.querySelectorAll(cI);if(bI.length===0)return this.container;const nI=new aI({container:this.container,trigger:Array.from(bI),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),uI=this.page,rI=o.Util.normalizeRect([this.data.parentRect[0],uI.view[3]-this.data.parentRect[1]+uI.view[1],this.data.parentRect[2],uI.view[3]-this.data.parentRect[3]+uI.view[1]]),FI=rI[0]+this.data.parentRect[2]-this.data.parentRect[0],kI=rI[1],[TI,QI,fI,OI]=this.viewport.viewBox,qI=fI-TI,gg=OI-QI;return this.container.style.left=`${100*(FI-TI)/qI}%`,this.container.style.top=`${100*(kI-QI)/gg}%`,this.container.append(nI.render()),this.container}}class aI{constructor(AI){this.container=AI.container,this.trigger=AI.trigger,this.color=AI.color,this.titleObj=AI.titleObj,this.modificationDate=AI.modificationDate,this.contentsObj=AI.contentsObj,this.richText=AI.richText,this.hideWrapper=AI.hideWrapper||!1,this.pinned=!1}render(){var AI,cI;const nI=document.createElement("div");nI.className="popupWrapper",this.hideElement=this.hideWrapper?nI:this.container,this.hideElement.hidden=!0;const uI=document.createElement("div");uI.className="popup";const rI=this.color;if(rI){const TI=.7*(255-rI[0])+rI[0],QI=.7*(255-rI[1])+rI[1],fI=.7*(255-rI[2])+rI[2];uI.style.backgroundColor=o.Util.makeHexColor(TI|0,QI|0,fI|0)}const FI=document.createElement("h1");FI.dir=this.titleObj.dir,FI.textContent=this.titleObj.str,uI.append(FI);const kI=t.PDFDateString.toDateObject(this.modificationDate);if(kI){const TI=document.createElement("span");TI.className="popupDate",TI.textContent="{{date}}, {{time}}",TI.dataset.l10nId="annotation_date_string",TI.dataset.l10nArgs=JSON.stringify({date:kI.toLocaleDateString(),time:kI.toLocaleTimeString()}),uI.append(TI)}if((AI=this.richText)!==null&&AI!==void 0&&AI.str&&(!((cI=this.contentsObj)!==null&&cI!==void 0&&cI.str)||this.contentsObj.str===this.richText.str))B.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:uI}),uI.lastChild.className="richText popupContent";else{const TI=this._formatContents(this.contentsObj);uI.append(TI)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const TI of this.trigger)TI.addEventListener("click",this._toggle.bind(this)),TI.addEventListener("mouseover",this._show.bind(this,!1)),TI.addEventListener("mouseout",this._hide.bind(this,!1));return uI.addEventListener("click",this._hide.bind(this,!0)),nI.append(uI),nI}_formatContents(AI){let{str:cI,dir:bI}=AI;const nI=document.createElement("p");nI.className="popupContent",nI.dir=bI;const uI=cI.split(/(?:\r\n?|\n)/);for(let rI=0,FI=uI.length;rI<FI;++rI){const kI=uI[rI];nI.append(document.createTextNode(kI)),rI<FI-1&&nI.append(document.createElement("br"))}return nI}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class WI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0}),this.textContent=AI.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const AI=document.createElement("div");AI.className="annotationTextContent",AI.setAttribute("role","comment");for(const cI of this.textContent){const bI=document.createElement("span");bI.textContent=cI,AI.append(bI)}this.container.append(AI)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class GI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const AI=this.data,{width:cI,height:bI}=iI(AI.rect),nI=this.svgFactory.create(cI,bI,!0),uI=this.svgFactory.createElement("svg:line");return uI.setAttribute("x1",AI.rect[2]-AI.lineCoordinates[0]),uI.setAttribute("y1",AI.rect[3]-AI.lineCoordinates[1]),uI.setAttribute("x2",AI.rect[2]-AI.lineCoordinates[2]),uI.setAttribute("y2",AI.rect[3]-AI.lineCoordinates[3]),uI.setAttribute("stroke-width",AI.borderStyle.width||1),uI.setAttribute("stroke","transparent"),uI.setAttribute("fill","transparent"),nI.append(uI),this.container.append(nI),this._createPopup(uI,AI),this.container}}class HI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const AI=this.data,{width:cI,height:bI}=iI(AI.rect),nI=this.svgFactory.create(cI,bI,!0),uI=AI.borderStyle.width,rI=this.svgFactory.createElement("svg:rect");return rI.setAttribute("x",uI/2),rI.setAttribute("y",uI/2),rI.setAttribute("width",cI-uI),rI.setAttribute("height",bI-uI),rI.setAttribute("stroke-width",uI||1),rI.setAttribute("stroke","transparent"),rI.setAttribute("fill","transparent"),nI.append(rI),this.container.append(nI),this._createPopup(rI,AI),this.container}}class MI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const AI=this.data,{width:cI,height:bI}=iI(AI.rect),nI=this.svgFactory.create(cI,bI,!0),uI=AI.borderStyle.width,rI=this.svgFactory.createElement("svg:ellipse");return rI.setAttribute("cx",cI/2),rI.setAttribute("cy",bI/2),rI.setAttribute("rx",cI/2-uI/2),rI.setAttribute("ry",bI/2-uI/2),rI.setAttribute("stroke-width",uI||1),rI.setAttribute("stroke","transparent"),rI.setAttribute("fill","transparent"),nI.append(rI),this.container.append(nI),this._createPopup(rI,AI),this.container}}class KI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const AI=this.data,{width:cI,height:bI}=iI(AI.rect),nI=this.svgFactory.create(cI,bI,!0);let uI=[];for(const FI of AI.vertices){const kI=FI.x-AI.rect[0],TI=AI.rect[3]-FI.y;uI.push(kI+","+TI)}uI=uI.join(" ");const rI=this.svgFactory.createElement(this.svgElementName);return rI.setAttribute("points",uI),rI.setAttribute("stroke-width",AI.borderStyle.width||1),rI.setAttribute("stroke","transparent"),rI.setAttribute("fill","transparent"),nI.append(rI),this.container.append(nI),this._createPopup(rI,AI),this.container}}class DI extends KI{constructor(AI){super(AI),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class NI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class yI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const AI=this.data,{width:cI,height:bI}=iI(AI.rect),nI=this.svgFactory.create(cI,bI,!0);for(const uI of AI.inkLists){let rI=[];for(const kI of uI){const TI=kI.x-AI.rect[0],QI=AI.rect[3]-kI.y;rI.push(`${TI},${QI}`)}rI=rI.join(" ");const FI=this.svgFactory.createElement(this.svgElementName);FI.setAttribute("points",rI),FI.setAttribute("stroke-width",AI.borderStyle.width||1),FI.setAttribute("stroke","transparent"),FI.setAttribute("fill","transparent"),this._createPopup(FI,AI),nI.append(FI)}return this.container.append(nI),this.container}}class VI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class hI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class wI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class pI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class xI extends CI{constructor(AI){var cI,bI,nI;const uI=!!(AI.data.hasPopup||(cI=AI.data.titleObj)!==null&&cI!==void 0&&cI.str||(bI=AI.data.contentsObj)!==null&&bI!==void 0&&bI.str||(nI=AI.data.richText)!==null&&nI!==void 0&&nI.str);super(AI,{isRenderable:uI,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class PI extends CI{constructor(AI){var cI;super(AI,{isRenderable:!0});const{filename:bI,content:nI}=this.data.file;this.filename=(0,t.getFilenameFromUrl)(bI),this.content=nI,(cI=this.linkService.eventBus)===null||cI===void 0||cI.dispatch("fileattachmentannotation",{source:this,filename:bI,content:nI})}render(){var AI,cI;this.container.className="fileAttachmentAnnotation";const bI=document.createElement("div");return bI.className="popupTriggerArea",bI.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((AI=this.data.titleObj)!==null&&AI!==void 0&&AI.str||(cI=this.data.contentsObj)!==null&&cI!==void 0&&cI.str||this.data.richText)&&this._createPopup(bI,this.data),this.container.append(bI),this.container}_download(){var AI;(AI=this.downloadManager)===null||AI===void 0||AI.openOrDownloadData(this.container,this.content,this.filename)}}class XI{static render(AI){const{annotations:cI,div:bI,viewport:nI,accessibilityManager:uI}=AI;R(this,XI,mI).call(this,bI,nI);let rI=0;for(const FI of cI){if(FI.annotationType!==o.AnnotationType.POPUP){const{width:TI,height:QI}=iI(FI.rect);if(TI<=0||QI<=0)continue}const kI=lI.create({data:FI,layer:bI,page:AI.page,viewport:nI,linkService:AI.linkService,downloadManager:AI.downloadManager,imageResourcesPath:AI.imageResourcesPath||"",renderForms:AI.renderForms!==!1,svgFactory:new t.DOMSVGFactory,annotationStorage:AI.annotationStorage||new a.AnnotationStorage,enableScripting:AI.enableScripting,hasJSActions:AI.hasJSActions,fieldObjects:AI.fieldObjects,mouseState:AI.mouseState||{isDown:!1}});if(kI.isRenderable){const TI=kI.render();if(FI.hidden&&(TI.style.visibility="hidden"),Array.isArray(TI))for(const QI of TI)QI.style.zIndex=rI++,R(XI,XI,tI).call(XI,QI,FI.id,bI,uI);else TI.style.zIndex=rI++,kI instanceof eI?bI.prepend(TI):R(XI,XI,tI).call(XI,TI,FI.id,bI,uI)}}R(this,XI,YI).call(this,bI,AI.annotationCanvasMap)}static update(AI){const{annotationCanvasMap:cI,div:bI,viewport:nI}=AI;R(this,XI,mI).call(this,bI,nI),R(this,XI,YI).call(this,bI,cI),bI.hidden=!1}}A.AnnotationLayer=XI;function tI(BI,AI,cI,bI){const nI=BI.firstChild||BI;nI.id=`${t.AnnotationPrefix}${AI}`,cI.append(BI),bI?.moveElementInDOM(cI,BI,nI,!1)}function mI(BI,AI){let{width:cI,height:bI,rotation:nI}=AI;const{style:uI}=BI,rI=nI%180!==0,FI=Math.floor(cI)+"px",kI=Math.floor(bI)+"px";uI.width=rI?kI:FI,uI.height=rI?FI:kI,BI.setAttribute("data-main-rotation",nI)}function YI(BI,AI){if(AI){for(const[cI,bI]of AI){const nI=BI.querySelector(`[data-annotation-id="${cI}"]`);if(!nI)continue;const{firstChild:uI}=nI;uI?uI.nodeName==="CANVAS"?uI.replaceWith(bI):uI.before(bI):nI.append(bI)}AI.clear()}}},(e,A)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.ColorConverters=void 0;function l(t){return Math.floor(Math.max(0,Math.min(1,t))*255).toString(16).padStart(2,"0")}class o{static CMYK_G(a){let[n,B,R,r]=a;return["G",1-Math.min(1,.3*n+.59*R+.11*B+r)]}static G_CMYK(a){let[n]=a;return["CMYK",0,0,0,1-n]}static G_RGB(a){let[n]=a;return["RGB",n,n,n]}static G_HTML(a){let[n]=a;const B=l(n);return`#${B}${B}${B}`}static RGB_G(a){let[n,B,R]=a;return["G",.3*n+.59*B+.11*R]}static RGB_HTML(a){let[n,B,R]=a;const r=l(n),H=l(B),II=l(R);return`#${r}${H}${II}`}static T_HTML(){return"#00000000"}static CMYK_RGB(a){let[n,B,R,r]=a;return["RGB",1-Math.min(1,n+r),1-Math.min(1,R+r),1-Math.min(1,B+r)]}static CMYK_HTML(a){const n=this.CMYK_RGB(a).slice(1);return this.RGB_HTML(n)}static RGB_CMYK(a){let[n,B,R]=a;const r=1-n,H=1-B,II=1-R,k=Math.min(r,H,II);return["CMYK",r,H,II,k]}}A.ColorConverters=o},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.XfaLayer=void 0;var o=l(145);class t{static setupStorage(n,B,R,r,H){const II=r.getValue(B,{value:null});switch(R.name){case"textarea":if(II.value!==null&&(n.textContent=II.value),H==="print")break;n.addEventListener("input",k=>{r.setValue(B,{value:k.target.value})});break;case"input":if(R.attributes.type==="radio"||R.attributes.type==="checkbox"){if(II.value===R.attributes.xfaOn?n.setAttribute("checked",!0):II.value===R.attributes.xfaOff&&n.removeAttribute("checked"),H==="print")break;n.addEventListener("change",k=>{r.setValue(B,{value:k.target.checked?k.target.getAttribute("xfaOn"):k.target.getAttribute("xfaOff")})})}else{if(II.value!==null&&n.setAttribute("value",II.value),H==="print")break;n.addEventListener("input",k=>{r.setValue(B,{value:k.target.value})})}break;case"select":if(II.value!==null)for(const k of R.children)k.attributes.value===II.value&&(k.attributes.selected=!0);n.addEventListener("input",k=>{const iI=k.target.options,lI=iI.selectedIndex===-1?"":iI[iI.selectedIndex].value;r.setValue(B,{value:lI})});break}}static setAttributes(n){let{html:B,element:R,storage:r=null,intent:H,linkService:II}=n;const{attributes:k}=R,iI=B instanceof HTMLAnchorElement;k.type==="radio"&&(k.name=`${k.name}-${H}`);for(const[lI,CI]of Object.entries(k))if(CI!=null)switch(lI){case"class":CI.length&&B.setAttribute(lI,CI.join(" "));break;case"dataId":break;case"id":B.setAttribute("data-element-id",CI);break;case"style":Object.assign(B.style,CI);break;case"textContent":B.textContent=CI;break;default:(!iI||lI!=="href"&&lI!=="newWindow")&&B.setAttribute(lI,CI)}iI&&II.addLinkAttributes(B,k.href,k.newWindow),r&&k.dataId&&this.setupStorage(B,k.dataId,R,r)}static render(n){const B=n.annotationStorage,R=n.linkService,r=n.xfaHtml,H=n.intent||"display",II=document.createElement(r.name);r.attributes&&this.setAttributes({html:II,element:r,intent:H,linkService:R});const k=[[r,-1,II]],iI=n.div;if(iI.append(II),n.viewport){const sI=`matrix(${n.viewport.transform.join(",")})`;iI.style.transform=sI}H!=="richText"&&iI.setAttribute("class","xfaLayer xfaFont");const lI=[];for(;k.length>0;){var CI;const[sI,oI,E]=k.at(-1);if(oI+1===sI.children.length){k.pop();continue}const _=sI.children[++k.at(-1)[1]];if(_===null)continue;const{name:gI}=_;if(gI==="#text"){const O=document.createTextNode(_.value);lI.push(O),E.append(O);continue}let M;if(_!=null&&(CI=_.attributes)!==null&&CI!==void 0&&CI.xmlns?M=document.createElementNS(_.attributes.xmlns,gI):M=document.createElement(gI),E.append(M),_.attributes&&this.setAttributes({html:M,element:_,storage:B,intent:H,linkService:R}),_.children&&_.children.length>0)k.push([_,-1,M]);else if(_.value){const O=document.createTextNode(_.value);o.XfaText.shouldBuildText(gI)&&lI.push(O),M.append(O)}}for(const sI of iI.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))sI.setAttribute("readOnly",!0);return{textDivs:lI}}static update(n){const B=`matrix(${n.viewport.transform.join(",")})`;n.div.style.transform=B,n.div.hidden=!1}}A.XfaLayer=t},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.TextLayerRenderTask=void 0,A.renderTextLayer=E;var o=l(1),t=l(133);const a=1e5,n=30,B=.8,R=new Map,r=/^\s+$/g;function H(_,gI){const M=R.get(_);if(M)return M;gI.save(),gI.font=`${n}px ${_}`;const O=gI.measureText("");let dI=O.fontBoundingBoxAscent,eI=Math.abs(O.fontBoundingBoxDescent);if(dI){gI.restore();const WI=dI/(dI+eI);return R.set(_,WI),WI}gI.strokeStyle="red",gI.clearRect(0,0,n,n),gI.strokeText("g",0,0);let aI=gI.getImageData(0,0,n,n).data;eI=0;for(let WI=aI.length-1-3;WI>=0;WI-=4)if(aI[WI]>0){eI=Math.ceil(WI/4/n);break}gI.clearRect(0,0,n,n),gI.strokeText("A",0,n),aI=gI.getImageData(0,0,n,n).data,dI=0;for(let WI=0,GI=aI.length;WI<GI;WI+=4)if(aI[WI]>0){dI=n-Math.floor(WI/4/n);break}if(gI.restore(),dI){const WI=dI/(dI+eI);return R.set(_,WI),WI}return R.set(_,B),B}function II(_,gI,M,O){const dI=document.createElement("span"),eI=_._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:gI.str!=="",hasEOL:gI.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:gI.str!=="",hasEOL:gI.hasEOL,fontSize:0};_._textDivs.push(dI);const aI=o.Util.transform(_._viewport.transform,gI.transform);let WI=Math.atan2(aI[1],aI[0]);const GI=M[gI.fontName];GI.vertical&&(WI+=Math.PI/2);const HI=Math.hypot(aI[2],aI[3]),MI=HI*H(GI.fontFamily,O);let KI,DI;WI===0?(KI=aI[4],DI=aI[5]-MI):(KI=aI[4]+MI*Math.sin(WI),DI=aI[5]-MI*Math.cos(WI)),dI.style.left=`${KI}px`,dI.style.top=`${DI}px`,dI.style.fontSize=`${HI}px`,dI.style.fontFamily=GI.fontFamily,eI.fontSize=HI,dI.setAttribute("role","presentation"),dI.textContent=gI.str,dI.dir=gI.dir,_._fontInspectorEnabled&&(dI.dataset.fontName=gI.fontName),WI!==0&&(eI.angle=WI*(180/Math.PI));let NI=!1;if(gI.str.length>1||_._enhanceTextSelection&&r.test(gI.str))NI=!0;else if(gI.str!==" "&&gI.transform[0]!==gI.transform[3]){const yI=Math.abs(gI.transform[0]),VI=Math.abs(gI.transform[3]);yI!==VI&&Math.max(yI,VI)/Math.min(yI,VI)>1.5&&(NI=!0)}if(NI&&(GI.vertical?eI.canvasWidth=gI.height*_._viewport.scale:eI.canvasWidth=gI.width*_._viewport.scale),_._textDivProperties.set(dI,eI),_._textContentStream&&_._layoutText(dI),_._enhanceTextSelection&&eI.hasText){let yI=1,VI=0;WI!==0&&(yI=Math.cos(WI),VI=Math.sin(WI));const hI=(GI.vertical?gI.height:gI.width)*_._viewport.scale,wI=HI;let pI,xI;WI!==0?(pI=[yI,VI,-VI,yI,KI,DI],xI=o.Util.getAxialAlignedBoundingBox([0,0,hI,wI],pI)):xI=[KI,DI,KI+hI,DI+wI],_._bounds.push({left:xI[0],top:xI[1],right:xI[2],bottom:xI[3],div:dI,size:[hI,wI],m:pI})}}function k(_){if(_._canceled)return;const gI=_._textDivs,M=_._capability,O=gI.length;if(O>a){_._renderingDone=!0,M.resolve();return}if(!_._textContentStream)for(let dI=0;dI<O;dI++)_._layoutText(gI[dI]);_._renderingDone=!0,M.resolve()}function iI(_,gI,M){let O=0;for(let dI=0;dI<M;dI++){const eI=_[gI++];eI>0&&(O=O?Math.min(eI,O):eI)}return O}function lI(_){const gI=_._bounds,M=_._viewport,O=CI(M.width,M.height,gI);for(let dI=0;dI<O.length;dI++){const eI=gI[dI].div,aI=_._textDivProperties.get(eI);if(aI.angle===0){aI.paddingLeft=gI[dI].left-O[dI].left,aI.paddingTop=gI[dI].top-O[dI].top,aI.paddingRight=O[dI].right-gI[dI].right,aI.paddingBottom=O[dI].bottom-gI[dI].bottom,_._textDivProperties.set(eI,aI);continue}const WI=O[dI],GI=gI[dI],HI=GI.m,MI=HI[0],KI=HI[1],DI=[[0,0],[0,GI.size[1]],[GI.size[0],0],GI.size],NI=new Float64Array(64);for(let VI=0,hI=DI.length;VI<hI;VI++){const wI=o.Util.applyTransform(DI[VI],HI);NI[VI+0]=MI&&(WI.left-wI[0])/MI,NI[VI+4]=KI&&(WI.top-wI[1])/KI,NI[VI+8]=MI&&(WI.right-wI[0])/MI,NI[VI+12]=KI&&(WI.bottom-wI[1])/KI,NI[VI+16]=KI&&(WI.left-wI[0])/-KI,NI[VI+20]=MI&&(WI.top-wI[1])/MI,NI[VI+24]=KI&&(WI.right-wI[0])/-KI,NI[VI+28]=MI&&(WI.bottom-wI[1])/MI,NI[VI+32]=MI&&(WI.left-wI[0])/-MI,NI[VI+36]=KI&&(WI.top-wI[1])/-KI,NI[VI+40]=MI&&(WI.right-wI[0])/-MI,NI[VI+44]=KI&&(WI.bottom-wI[1])/-KI,NI[VI+48]=KI&&(WI.left-wI[0])/KI,NI[VI+52]=MI&&(WI.top-wI[1])/-MI,NI[VI+56]=KI&&(WI.right-wI[0])/KI,NI[VI+60]=MI&&(WI.bottom-wI[1])/-MI}const yI=1+Math.min(Math.abs(MI),Math.abs(KI));aI.paddingLeft=iI(NI,32,16)/yI,aI.paddingTop=iI(NI,48,16)/yI,aI.paddingRight=iI(NI,0,16)/yI,aI.paddingBottom=iI(NI,16,16)/yI,_._textDivProperties.set(eI,aI)}}function CI(_,gI,M){const O=M.map(function(eI,aI){return{x1:eI.left,y1:eI.top,x2:eI.right,y2:eI.bottom,index:aI,x1New:void 0,x2New:void 0}});sI(_,O);const dI=new Array(M.length);for(const eI of O){const aI=eI.index;dI[aI]={left:eI.x1New,top:0,right:eI.x2New,bottom:0}}M.map(function(eI,aI){const WI=dI[aI],GI=O[aI];GI.x1=eI.top,GI.y1=_-WI.right,GI.x2=eI.bottom,GI.y2=_-WI.left,GI.index=aI,GI.x1New=void 0,GI.x2New=void 0}),sI(gI,O);for(const eI of O){const aI=eI.index;dI[aI].top=eI.x1New,dI[aI].bottom=eI.x2New}return dI}function sI(_,gI){gI.sort(function(dI,eI){return dI.x1-eI.x1||dI.index-eI.index});const O=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const dI of gI){let eI=0;for(;eI<O.length&&O[eI].end<=dI.y1;)eI++;let aI=O.length-1;for(;aI>=0&&O[aI].start>=dI.y2;)aI--;let WI,GI,HI,MI,KI=-1/0;for(HI=eI;HI<=aI;HI++){WI=O[HI],GI=WI.boundary;let yI;GI.x2>dI.x1?yI=GI.index>dI.index?GI.x1New:dI.x1:GI.x2New===void 0?yI=(GI.x2+dI.x1)/2:yI=GI.x2New,yI>KI&&(KI=yI)}for(dI.x1New=KI,HI=eI;HI<=aI;HI++)WI=O[HI],GI=WI.boundary,GI.x2New===void 0?GI.x2>dI.x1?GI.index>dI.index&&(GI.x2New=GI.x2):GI.x2New=KI:GI.x2New>KI&&(GI.x2New=Math.max(KI,GI.x2));const DI=[];let NI=null;for(HI=eI;HI<=aI;HI++){WI=O[HI],GI=WI.boundary;const yI=GI.x2>dI.x2?GI:dI;NI===yI?DI.at(-1).end=WI.end:(DI.push({start:WI.start,end:WI.end,boundary:yI}),NI=yI)}for(O[eI].start<dI.y1&&(DI[0].start=dI.y1,DI.unshift({start:O[eI].start,end:dI.y1,boundary:O[eI].boundary})),dI.y2<O[aI].end&&(DI.at(-1).end=dI.y2,DI.push({start:dI.y2,end:O[aI].end,boundary:O[aI].boundary})),HI=eI;HI<=aI;HI++){if(WI=O[HI],GI=WI.boundary,GI.x2New!==void 0)continue;let yI=!1;for(MI=eI-1;!yI&&MI>=0&&O[MI].start>=GI.y1;MI--)yI=O[MI].boundary===GI;for(MI=aI+1;!yI&&MI<O.length&&O[MI].end<=GI.y2;MI++)yI=O[MI].boundary===GI;for(MI=0;!yI&&MI<DI.length;MI++)yI=DI[MI].boundary===GI;yI||(GI.x2New=KI)}Array.prototype.splice.apply(O,[eI,aI-eI+1,...DI])}for(const dI of O){const eI=dI.boundary;eI.x2New===void 0&&(eI.x2New=Math.max(_,eI.x2))}}class oI{constructor(gI){var M;let{textContent:O,textContentStream:dI,container:eI,viewport:aI,textDivs:WI,textContentItemsStr:GI,enhanceTextSelection:HI}=gI;HI&&(0,t.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=O,this._textContentStream=dI,this._container=eI,this._document=eI.ownerDocument,this._viewport=aI,this._textDivs=WI||[],this._textContentItemsStr=GI||[],this._enhanceTextSelection=!!HI,this._fontInspectorEnabled=!!((M=globalThis.FontInspector)!==null&&M!==void 0&&M.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,o.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new o.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(gI,M){for(let O=0,dI=gI.length;O<dI;O++){if(gI[O].str===void 0){if(gI[O].type==="beginMarkedContentProps"||gI[O].type==="beginMarkedContent"){const eI=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),gI[O].id!==null&&this._container.setAttribute("id",`${gI[O].id}`),eI.append(this._container)}else gI[O].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(gI[O].str),II(this,gI[O],M,this._layoutTextCtx)}}_layoutText(gI){const M=this._textDivProperties.get(gI);let O="";if(M.canvasWidth!==0&&M.hasText){const{fontFamily:dI}=gI.style,{fontSize:eI}=M;(eI!==this._layoutTextLastFontSize||dI!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${eI*this._devicePixelRatio}px ${dI}`,this._layoutTextLastFontSize=eI,this._layoutTextLastFontFamily=dI);const{width:aI}=this._layoutTextCtx.measureText(gI.textContent);if(aI>0){const WI=this._devicePixelRatio*M.canvasWidth/aI;this._enhanceTextSelection&&(M.scale=WI),O=`scaleX(${WI})`}}if(M.angle!==0&&(O=`rotate(${M.angle}deg) ${O}`),O.length>0&&(this._enhanceTextSelection&&(M.originalTransform=O),gI.style.transform=O),M.hasText&&this._container.append(gI),M.hasEOL){const dI=document.createElement("br");dI.setAttribute("role","presentation"),this._container.append(dI)}}_render(){let gI=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const M=(0,o.createPromiseCapability)();let O=Object.create(null);const dI=this._document.createElement("canvas");if(dI.height=dI.width=n,this._layoutTextCtx=dI.getContext("2d",{alpha:!1}),this._textContent){const eI=this._textContent.items,aI=this._textContent.styles;this._processItems(eI,aI),M.resolve()}else if(this._textContentStream){const eI=()=>{this._reader.read().then(aI=>{let{value:WI,done:GI}=aI;if(GI){M.resolve();return}Object.assign(O,WI.styles),this._processItems(WI.items,O),eI()},M.reject)};this._reader=this._textContentStream.getReader(),eI()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');M.promise.then(()=>{O=null,gI?this._renderTimer=setTimeout(()=>{k(this),this._renderTimer=null},gI):k(this)},this._capability.reject)}expandTextDivs(){let gI=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(lI(this),this._bounds=null);const M=[],O=[];for(let dI=0,eI=this._textDivs.length;dI<eI;dI++){const aI=this._textDivs[dI],WI=this._textDivProperties.get(aI);WI.hasText&&(gI?(M.length=0,O.length=0,WI.originalTransform&&M.push(WI.originalTransform),WI.paddingTop>0?(O.push(`${WI.paddingTop}px`),M.push(`translateY(${-WI.paddingTop}px)`)):O.push(0),WI.paddingRight>0?O.push(`${WI.paddingRight/WI.scale}px`):O.push(0),WI.paddingBottom>0?O.push(`${WI.paddingBottom}px`):O.push(0),WI.paddingLeft>0?(O.push(`${WI.paddingLeft/WI.scale}px`),M.push(`translateX(${-WI.paddingLeft/WI.scale}px)`)):O.push(0),aI.style.padding=O.join(" "),M.length&&(aI.style.transform=M.join(" "))):(aI.style.padding=null,aI.style.transform=WI.originalTransform))}}}A.TextLayerRenderTask=oI;function E(_){const gI=new oI({textContent:_.textContent,textContentStream:_.textContentStream,container:_.container,viewport:_.viewport,textDivs:_.textDivs,textContentItemsStr:_.textContentItemsStr,enhanceTextSelection:_.enhanceTextSelection});return gI._render(_.timeout),gI}},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.SVGGraphics=void 0;var o=l(133),t=l(1),a=l(3);let n=class{constructor(){(0,t.unreachable)("Not implemented: SVGGraphics")}};A.SVGGraphics=n;{let CI=function(M){let O=[];const dI=[];for(const eI of M){if(eI.fn==="save"){O.push({fnId:92,fn:"group",items:[]}),dI.push(O),O=O.at(-1).items;continue}eI.fn==="restore"?O=dI.pop():O.push(eI)}return O},sI=function(M){if(Number.isInteger(M))return M.toString();const O=M.toFixed(10);let dI=O.length-1;if(O[dI]!=="0")return O;do dI--;while(O[dI]==="0");return O.substring(0,O[dI]==="."?dI:dI+1)},oI=function(M){if(M[4]===0&&M[5]===0){if(M[1]===0&&M[2]===0)return M[0]===1&&M[3]===1?"":`scale(${sI(M[0])} ${sI(M[3])})`;if(M[0]===M[3]&&M[1]===-M[2]){const O=Math.acos(M[0])*180/Math.PI;return`rotate(${sI(O)})`}}else if(M[0]===1&&M[1]===0&&M[2]===0&&M[3]===1)return`translate(${sI(M[4])} ${sI(M[5])})`;return`matrix(${sI(M[0])} ${sI(M[1])} ${sI(M[2])} ${sI(M[3])} ${sI(M[4])} ${sI(M[5])})`};const B={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},R="http://www.w3.org/XML/1998/namespace",r="http://www.w3.org/1999/xlink",H=["butt","round","square"],II=["miter","round","bevel"],k=function(M){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",dI=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(URL.createObjectURL&&typeof Blob<"u"&&!dI)return URL.createObjectURL(new Blob([M],{type:O}));const eI="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let aI=`data:${O};base64,`;for(let WI=0,GI=M.length;WI<GI;WI+=3){const HI=M[WI]&255,MI=M[WI+1]&255,KI=M[WI+2]&255,DI=HI>>2,NI=(HI&3)<<4|MI>>4,yI=WI+1<GI?(MI&15)<<2|KI>>6:64,VI=WI+2<GI?KI&63:64;aI+=eI[DI]+eI[NI]+eI[yI]+eI[VI]}return aI},iI=function(){const M=new Uint8Array([137,80,78,71,13,10,26,10]),O=12,dI=new Int32Array(256);for(let KI=0;KI<256;KI++){let DI=KI;for(let NI=0;NI<8;NI++)DI&1?DI=3988292384^DI>>1&2147483647:DI=DI>>1&2147483647;dI[KI]=DI}function eI(KI,DI,NI){let yI=-1;for(let VI=DI;VI<NI;VI++){const hI=(yI^KI[VI])&255,wI=dI[hI];yI=yI>>>8^wI}return yI^-1}function aI(KI,DI,NI,yI){let VI=yI;const hI=DI.length;NI[VI]=hI>>24&255,NI[VI+1]=hI>>16&255,NI[VI+2]=hI>>8&255,NI[VI+3]=hI&255,VI+=4,NI[VI]=KI.charCodeAt(0)&255,NI[VI+1]=KI.charCodeAt(1)&255,NI[VI+2]=KI.charCodeAt(2)&255,NI[VI+3]=KI.charCodeAt(3)&255,VI+=4,NI.set(DI,VI),VI+=DI.length;const wI=eI(NI,yI+4,VI);NI[VI]=wI>>24&255,NI[VI+1]=wI>>16&255,NI[VI+2]=wI>>8&255,NI[VI+3]=wI&255}function WI(KI,DI,NI){let yI=1,VI=0;for(let hI=DI;hI<NI;++hI)yI=(yI+(KI[hI]&255))%65521,VI=(VI+yI)%65521;return VI<<16|yI}function GI(KI){if(!a.isNodeJS)return HI(KI);try{let DI;parseInt(process.versions.node)>=8?DI=KI:DI=Buffer.from(KI);const NI=require$$7.deflateSync(DI,{level:9});return NI instanceof Uint8Array?NI:new Uint8Array(NI)}catch(DI){(0,t.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+DI)}return HI(KI)}function HI(KI){let DI=KI.length;const NI=65535,yI=Math.ceil(DI/NI),VI=new Uint8Array(2+DI+yI*5+4);let hI=0;VI[hI++]=120,VI[hI++]=156;let wI=0;for(;DI>NI;)VI[hI++]=0,VI[hI++]=255,VI[hI++]=255,VI[hI++]=0,VI[hI++]=0,VI.set(KI.subarray(wI,wI+NI),hI),hI+=NI,wI+=NI,DI-=NI;VI[hI++]=1,VI[hI++]=DI&255,VI[hI++]=DI>>8&255,VI[hI++]=~DI&65535&255,VI[hI++]=(~DI&65535)>>8&255,VI.set(KI.subarray(wI),hI),hI+=KI.length-wI;const pI=WI(KI,0,KI.length);return VI[hI++]=pI>>24&255,VI[hI++]=pI>>16&255,VI[hI++]=pI>>8&255,VI[hI++]=pI&255,VI}function MI(KI,DI,NI,yI){const VI=KI.width,hI=KI.height;let wI,pI,xI;const PI=KI.data;switch(DI){case t.ImageKind.GRAYSCALE_1BPP:pI=0,wI=1,xI=VI+7>>3;break;case t.ImageKind.RGB_24BPP:pI=2,wI=8,xI=VI*3;break;case t.ImageKind.RGBA_32BPP:pI=6,wI=8,xI=VI*4;break;default:throw new Error("invalid format")}const XI=new Uint8Array((1+xI)*hI);let tI=0,mI=0;for(let nI=0;nI<hI;++nI)XI[tI++]=0,XI.set(PI.subarray(mI,mI+xI),tI),mI+=xI,tI+=xI;if(DI===t.ImageKind.GRAYSCALE_1BPP&&yI){tI=0;for(let nI=0;nI<hI;nI++){tI++;for(let uI=0;uI<xI;uI++)XI[tI++]^=255}}const YI=new Uint8Array([VI>>24&255,VI>>16&255,VI>>8&255,VI&255,hI>>24&255,hI>>16&255,hI>>8&255,hI&255,wI,pI,0,0,0]),BI=GI(XI),AI=M.length+O*3+YI.length+BI.length,cI=new Uint8Array(AI);let bI=0;return cI.set(M,bI),bI+=M.length,aI("IHDR",YI,cI,bI),bI+=O+YI.length,aI("IDATA",BI,cI,bI),bI+=O+BI.length,aI("IEND",new Uint8Array(0),cI,bI),k(cI,"image/png",NI)}return function(DI,NI,yI){const VI=DI.kind===void 0?t.ImageKind.GRAYSCALE_1BPP:DI.kind;return MI(DI,VI,NI,yI)}}();class lI{constructor(){this.fontSizeScale=1,this.fontWeight=B.fontWeight,this.fontSize=0,this.textMatrix=t.IDENTITY_MATRIX,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=t.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=B.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(O,dI){this.x=O,this.y=dI}}let E=0,_=0,gI=0;A.SVGGraphics=n=class{constructor(M,O){let dI=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;(0,o.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new o.DOMSVGFactory,this.current=new lI,this.transformMatrix=t.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=M,this.objs=O,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!dI,this._operatorIdMapping=[];for(const eI in t.OPS)this._operatorIdMapping[t.OPS[eI]]=eI}save(){this.transformStack.push(this.transformMatrix);const M=this.current;this.extraStack.push(M),this.current=M.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(M){this.save(),this.executeOpTree(M),this.restore()}loadDependencies(M){const O=M.fnArray,dI=M.argsArray;for(let eI=0,aI=O.length;eI<aI;eI++)if(O[eI]===t.OPS.dependency)for(const WI of dI[eI]){const GI=WI.startsWith("g_")?this.commonObjs:this.objs,HI=new Promise(MI=>{GI.get(WI,MI)});this.current.dependencies.push(HI)}return Promise.all(this.current.dependencies)}transform(M,O,dI,eI,aI,WI){const GI=[M,O,dI,eI,aI,WI];this.transformMatrix=t.Util.transform(this.transformMatrix,GI),this.tgrp=null}getSVG(M,O){this.viewport=O;const dI=this._initialize(O);return this.loadDependencies(M).then(()=>(this.transformMatrix=t.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(M)),dI))}convertOpList(M){const O=this._operatorIdMapping,dI=M.argsArray,eI=M.fnArray,aI=[];for(let WI=0,GI=eI.length;WI<GI;WI++){const HI=eI[WI];aI.push({fnId:HI,fn:O[HI],args:dI[WI]})}return CI(aI)}executeOpTree(M){for(const O of M){const dI=O.fn,eI=O.fnId,aI=O.args;switch(eI|0){case t.OPS.beginText:this.beginText();break;case t.OPS.dependency:break;case t.OPS.setLeading:this.setLeading(aI);break;case t.OPS.setLeadingMoveText:this.setLeadingMoveText(aI[0],aI[1]);break;case t.OPS.setFont:this.setFont(aI);break;case t.OPS.showText:this.showText(aI[0]);break;case t.OPS.showSpacedText:this.showText(aI[0]);break;case t.OPS.endText:this.endText();break;case t.OPS.moveText:this.moveText(aI[0],aI[1]);break;case t.OPS.setCharSpacing:this.setCharSpacing(aI[0]);break;case t.OPS.setWordSpacing:this.setWordSpacing(aI[0]);break;case t.OPS.setHScale:this.setHScale(aI[0]);break;case t.OPS.setTextMatrix:this.setTextMatrix(aI[0],aI[1],aI[2],aI[3],aI[4],aI[5]);break;case t.OPS.setTextRise:this.setTextRise(aI[0]);break;case t.OPS.setTextRenderingMode:this.setTextRenderingMode(aI[0]);break;case t.OPS.setLineWidth:this.setLineWidth(aI[0]);break;case t.OPS.setLineJoin:this.setLineJoin(aI[0]);break;case t.OPS.setLineCap:this.setLineCap(aI[0]);break;case t.OPS.setMiterLimit:this.setMiterLimit(aI[0]);break;case t.OPS.setFillRGBColor:this.setFillRGBColor(aI[0],aI[1],aI[2]);break;case t.OPS.setStrokeRGBColor:this.setStrokeRGBColor(aI[0],aI[1],aI[2]);break;case t.OPS.setStrokeColorN:this.setStrokeColorN(aI);break;case t.OPS.setFillColorN:this.setFillColorN(aI);break;case t.OPS.shadingFill:this.shadingFill(aI[0]);break;case t.OPS.setDash:this.setDash(aI[0],aI[1]);break;case t.OPS.setRenderingIntent:this.setRenderingIntent(aI[0]);break;case t.OPS.setFlatness:this.setFlatness(aI[0]);break;case t.OPS.setGState:this.setGState(aI[0]);break;case t.OPS.fill:this.fill();break;case t.OPS.eoFill:this.eoFill();break;case t.OPS.stroke:this.stroke();break;case t.OPS.fillStroke:this.fillStroke();break;case t.OPS.eoFillStroke:this.eoFillStroke();break;case t.OPS.clip:this.clip("nonzero");break;case t.OPS.eoClip:this.clip("evenodd");break;case t.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case t.OPS.paintImageXObject:this.paintImageXObject(aI[0]);break;case t.OPS.paintInlineImageXObject:this.paintInlineImageXObject(aI[0]);break;case t.OPS.paintImageMaskXObject:this.paintImageMaskXObject(aI[0]);break;case t.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(aI[0],aI[1]);break;case t.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case t.OPS.closePath:this.closePath();break;case t.OPS.closeStroke:this.closeStroke();break;case t.OPS.closeFillStroke:this.closeFillStroke();break;case t.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case t.OPS.nextLine:this.nextLine();break;case t.OPS.transform:this.transform(aI[0],aI[1],aI[2],aI[3],aI[4],aI[5]);break;case t.OPS.constructPath:this.constructPath(aI[0],aI[1]);break;case t.OPS.endPath:this.endPath();break;case 92:this.group(O.items);break;default:(0,t.warn)(`Unimplemented operator ${dI}`);break}}}setWordSpacing(M){this.current.wordSpacing=M}setCharSpacing(M){this.current.charSpacing=M}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(M,O,dI,eI,aI,WI){const GI=this.current;GI.textMatrix=GI.lineMatrix=[M,O,dI,eI,aI,WI],GI.textMatrixScale=Math.hypot(M,O),GI.x=GI.lineX=0,GI.y=GI.lineY=0,GI.xcoords=[],GI.ycoords=[],GI.tspan=this.svgFactory.createElement("svg:tspan"),GI.tspan.setAttributeNS(null,"font-family",GI.fontFamily),GI.tspan.setAttributeNS(null,"font-size",`${sI(GI.fontSize)}px`),GI.tspan.setAttributeNS(null,"y",sI(-GI.y)),GI.txtElement=this.svgFactory.createElement("svg:text"),GI.txtElement.append(GI.tspan)}beginText(){const M=this.current;M.x=M.lineX=0,M.y=M.lineY=0,M.textMatrix=t.IDENTITY_MATRIX,M.lineMatrix=t.IDENTITY_MATRIX,M.textMatrixScale=1,M.tspan=this.svgFactory.createElement("svg:tspan"),M.txtElement=this.svgFactory.createElement("svg:text"),M.txtgrp=this.svgFactory.createElement("svg:g"),M.xcoords=[],M.ycoords=[]}moveText(M,O){const dI=this.current;dI.x=dI.lineX+=M,dI.y=dI.lineY+=O,dI.xcoords=[],dI.ycoords=[],dI.tspan=this.svgFactory.createElement("svg:tspan"),dI.tspan.setAttributeNS(null,"font-family",dI.fontFamily),dI.tspan.setAttributeNS(null,"font-size",`${sI(dI.fontSize)}px`),dI.tspan.setAttributeNS(null,"y",sI(-dI.y))}showText(M){const O=this.current,dI=O.font,eI=O.fontSize;if(eI===0)return;const aI=O.fontSizeScale,WI=O.charSpacing,GI=O.wordSpacing,HI=O.fontDirection,MI=O.textHScale*HI,KI=dI.vertical,DI=KI?1:-1,NI=dI.defaultVMetrics,yI=eI*O.fontMatrix[0];let VI=0;for(const pI of M){if(pI===null){VI+=HI*GI;continue}else if(typeof pI=="number"){VI+=DI*pI*eI/1e3;continue}const xI=(pI.isSpace?GI:0)+WI,PI=pI.fontChar;let XI,tI,mI=pI.width;if(KI){let BI;const AI=pI.vmetric||NI;BI=pI.vmetric?AI[1]:mI*.5,BI=-BI*yI;const cI=AI[2]*yI;mI=AI?-AI[0]:mI,XI=BI/aI,tI=(VI+cI)/aI}else XI=VI/aI,tI=0;(pI.isInFont||dI.missingFile)&&(O.xcoords.push(O.x+XI),KI&&O.ycoords.push(-O.y+tI),O.tspan.textContent+=PI);let YI;KI?YI=mI*yI-xI*HI:YI=mI*yI+xI*HI,VI+=YI}O.tspan.setAttributeNS(null,"x",O.xcoords.map(sI).join(" ")),KI?O.tspan.setAttributeNS(null,"y",O.ycoords.map(sI).join(" ")):O.tspan.setAttributeNS(null,"y",sI(-O.y)),KI?O.y-=VI:O.x+=VI*MI,O.tspan.setAttributeNS(null,"font-family",O.fontFamily),O.tspan.setAttributeNS(null,"font-size",`${sI(O.fontSize)}px`),O.fontStyle!==B.fontStyle&&O.tspan.setAttributeNS(null,"font-style",O.fontStyle),O.fontWeight!==B.fontWeight&&O.tspan.setAttributeNS(null,"font-weight",O.fontWeight);const hI=O.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;if(hI===t.TextRenderingMode.FILL||hI===t.TextRenderingMode.FILL_STROKE?(O.fillColor!==B.fillColor&&O.tspan.setAttributeNS(null,"fill",O.fillColor),O.fillAlpha<1&&O.tspan.setAttributeNS(null,"fill-opacity",O.fillAlpha)):O.textRenderingMode===t.TextRenderingMode.ADD_TO_PATH?O.tspan.setAttributeNS(null,"fill","transparent"):O.tspan.setAttributeNS(null,"fill","none"),hI===t.TextRenderingMode.STROKE||hI===t.TextRenderingMode.FILL_STROKE){const pI=1/(O.textMatrixScale||1);this._setStrokeAttributes(O.tspan,pI)}let wI=O.textMatrix;O.textRise!==0&&(wI=wI.slice(),wI[5]+=O.textRise),O.txtElement.setAttributeNS(null,"transform",`${oI(wI)} scale(${sI(MI)}, -1)`),O.txtElement.setAttributeNS(R,"xml:space","preserve"),O.txtElement.append(O.tspan),O.txtgrp.append(O.txtElement),this._ensureTransformGroup().append(O.txtElement)}setLeadingMoveText(M,O){this.setLeading(-O),this.moveText(M,O)}addFontStyle(M){if(!M.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const O=k(M.data,M.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${M.loadedName}"; src: url(${O}); }
`}setFont(M){const O=this.current,dI=this.commonObjs.get(M[0]);let eI=M[1];O.font=dI,this.embedFonts&&!dI.missingFile&&!this.embeddedFonts[dI.loadedName]&&(this.addFontStyle(dI),this.embeddedFonts[dI.loadedName]=dI),O.fontMatrix=dI.fontMatrix||t.FONT_IDENTITY_MATRIX;let aI="normal";dI.black?aI="900":dI.bold&&(aI="bold");const WI=dI.italic?"italic":"normal";eI<0?(eI=-eI,O.fontDirection=-1):O.fontDirection=1,O.fontSize=eI,O.fontFamily=dI.loadedName,O.fontWeight=aI,O.fontStyle=WI,O.tspan=this.svgFactory.createElement("svg:tspan"),O.tspan.setAttributeNS(null,"y",sI(-O.y)),O.xcoords=[],O.ycoords=[]}endText(){var M;const O=this.current;O.textRenderingMode&t.TextRenderingMode.ADD_TO_PATH_FLAG&&(M=O.txtElement)!==null&&M!==void 0&&M.hasChildNodes()&&(O.element=O.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(M){M>0&&(this.current.lineWidth=M)}setLineCap(M){this.current.lineCap=H[M]}setLineJoin(M){this.current.lineJoin=II[M]}setMiterLimit(M){this.current.miterLimit=M}setStrokeAlpha(M){this.current.strokeAlpha=M}setStrokeRGBColor(M,O,dI){this.current.strokeColor=t.Util.makeHexColor(M,O,dI)}setFillAlpha(M){this.current.fillAlpha=M}setFillRGBColor(M,O,dI){this.current.fillColor=t.Util.makeHexColor(M,O,dI),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(M){this.current.strokeColor=this._makeColorN_Pattern(M)}setFillColorN(M){this.current.fillColor=this._makeColorN_Pattern(M)}shadingFill(M){const O=this.viewport.width,dI=this.viewport.height,eI=t.Util.inverseTransform(this.transformMatrix),aI=t.Util.applyTransform([0,0],eI),WI=t.Util.applyTransform([0,dI],eI),GI=t.Util.applyTransform([O,0],eI),HI=t.Util.applyTransform([O,dI],eI),MI=Math.min(aI[0],WI[0],GI[0],HI[0]),KI=Math.min(aI[1],WI[1],GI[1],HI[1]),DI=Math.max(aI[0],WI[0],GI[0],HI[0]),NI=Math.max(aI[1],WI[1],GI[1],HI[1]),yI=this.svgFactory.createElement("svg:rect");yI.setAttributeNS(null,"x",MI),yI.setAttributeNS(null,"y",KI),yI.setAttributeNS(null,"width",DI-MI),yI.setAttributeNS(null,"height",NI-KI),yI.setAttributeNS(null,"fill",this._makeShadingPattern(M)),this.current.fillAlpha<1&&yI.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(yI)}_makeColorN_Pattern(M){return M[0]==="TilingPattern"?this._makeTilingPattern(M):this._makeShadingPattern(M)}_makeTilingPattern(M){const O=M[1],dI=M[2],eI=M[3]||t.IDENTITY_MATRIX,[aI,WI,GI,HI]=M[4],MI=M[5],KI=M[6],DI=M[7],NI=`shading${gI++}`,[yI,VI,hI,wI]=t.Util.normalizeRect([...t.Util.applyTransform([aI,WI],eI),...t.Util.applyTransform([GI,HI],eI)]),[pI,xI]=t.Util.singularValueDecompose2dScale(eI),PI=MI*pI,XI=KI*xI,tI=this.svgFactory.createElement("svg:pattern");tI.setAttributeNS(null,"id",NI),tI.setAttributeNS(null,"patternUnits","userSpaceOnUse"),tI.setAttributeNS(null,"width",PI),tI.setAttributeNS(null,"height",XI),tI.setAttributeNS(null,"x",`${yI}`),tI.setAttributeNS(null,"y",`${VI}`);const mI=this.svg,YI=this.transformMatrix,BI=this.current.fillColor,AI=this.current.strokeColor,cI=this.svgFactory.create(hI-yI,wI-VI);if(this.svg=cI,this.transformMatrix=eI,DI===2){const bI=t.Util.makeHexColor(...O);this.current.fillColor=bI,this.current.strokeColor=bI}return this.executeOpTree(this.convertOpList(dI)),this.svg=mI,this.transformMatrix=YI,this.current.fillColor=BI,this.current.strokeColor=AI,tI.append(cI.childNodes[0]),this.defs.append(tI),`url(#${NI})`}_makeShadingPattern(M){switch(typeof M=="string"&&(M=this.objs.get(M)),M[0]){case"RadialAxial":const O=`shading${gI++}`,dI=M[3];let eI;switch(M[1]){case"axial":const aI=M[4],WI=M[5];eI=this.svgFactory.createElement("svg:linearGradient"),eI.setAttributeNS(null,"id",O),eI.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),eI.setAttributeNS(null,"x1",aI[0]),eI.setAttributeNS(null,"y1",aI[1]),eI.setAttributeNS(null,"x2",WI[0]),eI.setAttributeNS(null,"y2",WI[1]);break;case"radial":const GI=M[4],HI=M[5],MI=M[6],KI=M[7];eI=this.svgFactory.createElement("svg:radialGradient"),eI.setAttributeNS(null,"id",O),eI.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),eI.setAttributeNS(null,"cx",HI[0]),eI.setAttributeNS(null,"cy",HI[1]),eI.setAttributeNS(null,"r",KI),eI.setAttributeNS(null,"fx",GI[0]),eI.setAttributeNS(null,"fy",GI[1]),eI.setAttributeNS(null,"fr",MI);break;default:throw new Error(`Unknown RadialAxial type: ${M[1]}`)}for(const aI of dI){const WI=this.svgFactory.createElement("svg:stop");WI.setAttributeNS(null,"offset",aI[0]),WI.setAttributeNS(null,"stop-color",aI[1]),eI.append(WI)}return this.defs.append(eI),`url(#${O})`;case"Mesh":return(0,t.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${M[0]}`)}}setDash(M,O){this.current.dashArray=M,this.current.dashPhase=O}constructPath(M,O){const dI=this.current;let eI=dI.x,aI=dI.y,WI=[],GI=0;for(const HI of M)switch(HI|0){case t.OPS.rectangle:eI=O[GI++],aI=O[GI++];const MI=O[GI++],KI=O[GI++],DI=eI+MI,NI=aI+KI;WI.push("M",sI(eI),sI(aI),"L",sI(DI),sI(aI),"L",sI(DI),sI(NI),"L",sI(eI),sI(NI),"Z");break;case t.OPS.moveTo:eI=O[GI++],aI=O[GI++],WI.push("M",sI(eI),sI(aI));break;case t.OPS.lineTo:eI=O[GI++],aI=O[GI++],WI.push("L",sI(eI),sI(aI));break;case t.OPS.curveTo:eI=O[GI+4],aI=O[GI+5],WI.push("C",sI(O[GI]),sI(O[GI+1]),sI(O[GI+2]),sI(O[GI+3]),sI(eI),sI(aI)),GI+=6;break;case t.OPS.curveTo2:WI.push("C",sI(eI),sI(aI),sI(O[GI]),sI(O[GI+1]),sI(O[GI+2]),sI(O[GI+3])),eI=O[GI+2],aI=O[GI+3],GI+=4;break;case t.OPS.curveTo3:eI=O[GI+2],aI=O[GI+3],WI.push("C",sI(O[GI]),sI(O[GI+1]),sI(eI),sI(aI),sI(eI),sI(aI)),GI+=4;break;case t.OPS.closePath:WI.push("Z");break}WI=WI.join(" "),dI.path&&M.length>0&&M[0]!==t.OPS.rectangle&&M[0]!==t.OPS.moveTo?WI=dI.path.getAttributeNS(null,"d")+WI:(dI.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(dI.path)),dI.path.setAttributeNS(null,"d",WI),dI.path.setAttributeNS(null,"fill","none"),dI.element=dI.path,dI.setCurrentPoint(eI,aI)}endPath(){const M=this.current;if(M.path=null,!this.pendingClip)return;if(!M.element){this.pendingClip=null;return}const O=`clippath${E++}`,dI=this.svgFactory.createElement("svg:clipPath");dI.setAttributeNS(null,"id",O),dI.setAttributeNS(null,"transform",oI(this.transformMatrix));const eI=M.element.cloneNode(!0);if(this.pendingClip==="evenodd"?eI.setAttributeNS(null,"clip-rule","evenodd"):eI.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,dI.append(eI),this.defs.append(dI),M.activeClipUrl){M.clipGroup=null;for(const aI of this.extraStack)aI.clipGroup=null;dI.setAttributeNS(null,"clip-path",M.activeClipUrl)}M.activeClipUrl=`url(#${O})`,this.tgrp=null}clip(M){this.pendingClip=M}closePath(){const M=this.current;if(M.path){const O=`${M.path.getAttributeNS(null,"d")}Z`;M.path.setAttributeNS(null,"d",O)}}setLeading(M){this.current.leading=-M}setTextRise(M){this.current.textRise=M}setTextRenderingMode(M){this.current.textRenderingMode=M}setHScale(M){this.current.textHScale=M/100}setRenderingIntent(M){}setFlatness(M){}setGState(M){for(const[O,dI]of M)switch(O){case"LW":this.setLineWidth(dI);break;case"LC":this.setLineCap(dI);break;case"LJ":this.setLineJoin(dI);break;case"ML":this.setMiterLimit(dI);break;case"D":this.setDash(dI[0],dI[1]);break;case"RI":this.setRenderingIntent(dI);break;case"FL":this.setFlatness(dI);break;case"Font":this.setFont(dI);break;case"CA":this.setStrokeAlpha(dI);break;case"ca":this.setFillAlpha(dI);break;default:(0,t.warn)(`Unimplemented graphic state operator ${O}`);break}}fill(){const M=this.current;M.element&&(M.element.setAttributeNS(null,"fill",M.fillColor),M.element.setAttributeNS(null,"fill-opacity",M.fillAlpha),this.endPath())}stroke(){const M=this.current;M.element&&(this._setStrokeAttributes(M.element),M.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(M){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const dI=this.current;let eI=dI.dashArray;O!==1&&eI.length>0&&(eI=eI.map(function(aI){return O*aI})),M.setAttributeNS(null,"stroke",dI.strokeColor),M.setAttributeNS(null,"stroke-opacity",dI.strokeAlpha),M.setAttributeNS(null,"stroke-miterlimit",sI(dI.miterLimit)),M.setAttributeNS(null,"stroke-linecap",dI.lineCap),M.setAttributeNS(null,"stroke-linejoin",dI.lineJoin),M.setAttributeNS(null,"stroke-width",sI(O*dI.lineWidth)+"px"),M.setAttributeNS(null,"stroke-dasharray",eI.map(sI).join(" ")),M.setAttributeNS(null,"stroke-dashoffset",sI(O*dI.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const M=this.svgFactory.createElement("svg:rect");M.setAttributeNS(null,"x","0"),M.setAttributeNS(null,"y","0"),M.setAttributeNS(null,"width","1px"),M.setAttributeNS(null,"height","1px"),M.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(M)}paintImageXObject(M){const O=M.startsWith("g_")?this.commonObjs.get(M):this.objs.get(M);if(!O){(0,t.warn)(`Dependent image with object ID ${M} is not ready yet`);return}this.paintInlineImageXObject(O)}paintInlineImageXObject(M,O){const dI=M.width,eI=M.height,aI=iI(M,this.forceDataSchema,!!O),WI=this.svgFactory.createElement("svg:rect");WI.setAttributeNS(null,"x","0"),WI.setAttributeNS(null,"y","0"),WI.setAttributeNS(null,"width",sI(dI)),WI.setAttributeNS(null,"height",sI(eI)),this.current.element=WI,this.clip("nonzero");const GI=this.svgFactory.createElement("svg:image");GI.setAttributeNS(r,"xlink:href",aI),GI.setAttributeNS(null,"x","0"),GI.setAttributeNS(null,"y",sI(-eI)),GI.setAttributeNS(null,"width",sI(dI)+"px"),GI.setAttributeNS(null,"height",sI(eI)+"px"),GI.setAttributeNS(null,"transform",`scale(${sI(1/dI)} ${sI(-1/eI)})`),O?O.append(GI):this._ensureTransformGroup().append(GI)}paintImageMaskXObject(M){const O=this.current,dI=M.width,eI=M.height,aI=O.fillColor;O.maskId=`mask${_++}`;const WI=this.svgFactory.createElement("svg:mask");WI.setAttributeNS(null,"id",O.maskId);const GI=this.svgFactory.createElement("svg:rect");GI.setAttributeNS(null,"x","0"),GI.setAttributeNS(null,"y","0"),GI.setAttributeNS(null,"width",sI(dI)),GI.setAttributeNS(null,"height",sI(eI)),GI.setAttributeNS(null,"fill",aI),GI.setAttributeNS(null,"mask",`url(#${O.maskId})`),this.defs.append(WI),this._ensureTransformGroup().append(GI),this.paintInlineImageXObject(M,WI)}paintFormXObjectBegin(M,O){if(Array.isArray(M)&&M.length===6&&this.transform(M[0],M[1],M[2],M[3],M[4],M[5]),O){const dI=O[2]-O[0],eI=O[3]-O[1],aI=this.svgFactory.createElement("svg:rect");aI.setAttributeNS(null,"x",O[0]),aI.setAttributeNS(null,"y",O[1]),aI.setAttributeNS(null,"width",sI(dI)),aI.setAttributeNS(null,"height",sI(eI)),this.current.element=aI,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(M){const O=this.svgFactory.create(M.width,M.height),dI=this.svgFactory.createElement("svg:defs");O.append(dI),this.defs=dI;const eI=this.svgFactory.createElement("svg:g");return eI.setAttributeNS(null,"transform",oI(M.transform)),O.append(eI),this.svg=eI,O}_ensureClipGroup(){if(!this.current.clipGroup){const M=this.svgFactory.createElement("svg:g");M.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(M),this.current.clipGroup=M}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",oI(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFNodeStream=void 0;var o=l(1),t=l(158);const a=require$$7,n=require$$7,B=require$$7,R=require$$7,r=/^file:\/\/\/[a-zA-Z]:\//;function H(_){const gI=R.parse(_);return gI.protocol==="file:"||gI.host?gI:/^[a-z]:[/\\]/i.test(_)?R.parse(`file:///${_}`):(gI.host||(gI.protocol="file:"),gI)}class II{constructor(gI){this.source=gI,this.url=H(gI.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&gI.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var gI,M;return(gI=(M=this._fullRequestReader)===null||M===void 0?void 0:M._loaded)!==null&&gI!==void 0?gI:0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new oI(this):new CI(this),this._fullRequestReader}getRangeReader(gI,M){if(M<=this._progressiveDataLength)return null;const O=this.isFsUrl?new E(this,gI,M):new sI(this,gI,M);return this._rangeRequestReaders.push(O),O}cancelAllRequests(gI){this._fullRequestReader&&this._fullRequestReader.cancel(gI);for(const M of this._rangeRequestReaders.slice(0))M.cancel(gI)}}A.PDFNodeStream=II;class k{constructor(gI){this._url=gI.url,this._done=!1,this._storedError=null,this.onProgress=null;const M=gI.source;this._contentLength=M.length,this._loaded=0,this._filename=null,this._disableRange=M.disableRange||!1,this._rangeChunkSize=M.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!M.disableStream,this._isRangeSupported=!M.disableRange,this._readableStream=null,this._readCapability=(0,o.createPromiseCapability)(),this._headersCapability=(0,o.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const gI=this._readableStream.read();return gI===null?(this._readCapability=(0,o.createPromiseCapability)(),this.read()):(this._loaded+=gI.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(gI).buffer,done:!1})}cancel(gI){if(!this._readableStream){this._error(gI);return}this._readableStream.destroy(gI)}_error(gI){this._storedError=gI,this._readCapability.resolve()}_setReadableStream(gI){this._readableStream=gI,gI.on("readable",()=>{this._readCapability.resolve()}),gI.on("end",()=>{gI.destroy(),this._done=!0,this._readCapability.resolve()}),gI.on("error",M=>{this._error(M)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new o.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class iI{constructor(gI){this._url=gI.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,o.createPromiseCapability)();const M=gI.source;this._isStreamingSupported=!M.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const gI=this._readableStream.read();return gI===null?(this._readCapability=(0,o.createPromiseCapability)(),this.read()):(this._loaded+=gI.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(gI).buffer,done:!1})}cancel(gI){if(!this._readableStream){this._error(gI);return}this._readableStream.destroy(gI)}_error(gI){this._storedError=gI,this._readCapability.resolve()}_setReadableStream(gI){this._readableStream=gI,gI.on("readable",()=>{this._readCapability.resolve()}),gI.on("end",()=>{gI.destroy(),this._done=!0,this._readCapability.resolve()}),gI.on("error",M=>{this._error(M)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function lI(_,gI){return{protocol:_.protocol,auth:_.auth,host:_.hostname,port:_.port,path:_.path,method:"GET",headers:gI}}class CI extends k{constructor(gI){super(gI);const M=O=>{if(O.statusCode===404){const WI=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=WI,this._headersCapability.reject(WI);return}this._headersCapability.resolve(),this._setReadableStream(O);const dI=WI=>this._readableStream.headers[WI.toLowerCase()],{allowRangeRequests:eI,suggestedLength:aI}=(0,t.validateRangeRequestCapabilities)({getResponseHeader:dI,isHttp:gI.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=eI,this._contentLength=aI||this._contentLength,this._filename=(0,t.extractFilenameFromHeader)(dI)};this._request=null,this._url.protocol==="http:"?this._request=n.request(lI(this._url,gI.httpHeaders),M):this._request=B.request(lI(this._url,gI.httpHeaders),M),this._request.on("error",O=>{this._storedError=O,this._headersCapability.reject(O)}),this._request.end()}}class sI extends iI{constructor(gI,M,O){super(gI),this._httpHeaders={};for(const eI in gI.httpHeaders){const aI=gI.httpHeaders[eI];typeof aI>"u"||(this._httpHeaders[eI]=aI)}this._httpHeaders.Range=`bytes=${M}-${O-1}`;const dI=eI=>{if(eI.statusCode===404){const aI=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=aI;return}this._setReadableStream(eI)};this._request=null,this._url.protocol==="http:"?this._request=n.request(lI(this._url,this._httpHeaders),dI):this._request=B.request(lI(this._url,this._httpHeaders),dI),this._request.on("error",eI=>{this._storedError=eI}),this._request.end()}}class oI extends k{constructor(gI){super(gI);let M=decodeURIComponent(this._url.path);r.test(this._url.href)&&(M=M.replace(/^\//,"")),a.lstat(M,(O,dI)=>{if(O){O.code==="ENOENT"&&(O=new o.MissingPDFException(`Missing PDF "${M}".`)),this._storedError=O,this._headersCapability.reject(O);return}this._contentLength=dI.size,this._setReadableStream(a.createReadStream(M)),this._headersCapability.resolve()})}}class E extends iI{constructor(gI,M,O){super(gI);let dI=decodeURIComponent(this._url.path);r.test(this._url.href)&&(dI=dI.replace(/^\//,"")),this._setReadableStream(a.createReadStream(dI,{start:M,end:O-1}))}}},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.createResponseStatusError=R,A.extractFilenameFromHeader=B,A.validateRangeRequestCapabilities=n,A.validateResponseStatus=r;var o=l(1),t=l(159),a=l(133);function n(H){let{getResponseHeader:II,isHttp:k,rangeChunkSize:iI,disableRange:lI}=H;const CI={allowRangeRequests:!1,suggestedLength:void 0},sI=parseInt(II("Content-Length"),10);return!Number.isInteger(sI)||(CI.suggestedLength=sI,sI<=2*iI)||lI||!k||II("Accept-Ranges")!=="bytes"||(II("Content-Encoding")||"identity")!=="identity"||(CI.allowRangeRequests=!0),CI}function B(H){const II=H("Content-Disposition");if(II){let k=(0,t.getFilenameFromContentDispositionHeader)(II);if(k.includes("%"))try{k=decodeURIComponent(k)}catch{}if((0,a.isPdfFile)(k))return k}return null}function R(H,II){return H===404||H===0&&II.startsWith("file:")?new o.MissingPDFException('Missing PDF "'+II+'".'):new o.UnexpectedResponseException(`Unexpected server response (${H}) while retrieving PDF "${II}".`,H)}function r(H){return H===200||H===206}},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.getFilenameFromContentDispositionHeader=t;var o=l(1);function t(a){let n=!0,B=R("filename\\*","i").exec(a);if(B){B=B[1];let CI=k(B);return CI=unescape(CI),CI=iI(CI),CI=lI(CI),H(CI)}if(B=II(a),B){const CI=lI(B);return H(CI)}if(B=R("filename","i").exec(a),B){B=B[1];let CI=k(B);return CI=lI(CI),H(CI)}function R(CI,sI){return new RegExp("(?:^|;)\\s*"+CI+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',sI)}function r(CI,sI){if(CI){if(!/^[\x00-\xFF]+$/.test(sI))return sI;try{const oI=new TextDecoder(CI,{fatal:!0}),E=(0,o.stringToBytes)(sI);sI=oI.decode(E),n=!1}catch{}}return sI}function H(CI){return n&&/[\x80-\xff]/.test(CI)&&(CI=r("utf-8",CI),n&&(CI=r("iso-8859-1",CI))),CI}function II(CI){const sI=[];let oI;const E=R("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(oI=E.exec(CI))!==null;){let[,gI,M,O]=oI;if(gI=parseInt(gI,10),gI in sI){if(gI===0)break;continue}sI[gI]=[M,O]}const _=[];for(let gI=0;gI<sI.length&&gI in sI;++gI){let[M,O]=sI[gI];O=k(O),M&&(O=unescape(O),gI===0&&(O=iI(O))),_.push(O)}return _.join("")}function k(CI){if(CI.startsWith('"')){const sI=CI.slice(1).split('\\"');for(let oI=0;oI<sI.length;++oI){const E=sI[oI].indexOf('"');E!==-1&&(sI[oI]=sI[oI].slice(0,E),sI.length=oI+1),sI[oI]=sI[oI].replace(/\\(.)/g,"$1")}CI=sI.join('"')}return CI}function iI(CI){const sI=CI.indexOf("'");if(sI===-1)return CI;const oI=CI.slice(0,sI),_=CI.slice(sI+1).replace(/^[^']*'/,"");return r(oI,_)}function lI(CI){return!CI.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(CI)?CI:CI.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(sI,oI,E,_){if(E==="q"||E==="Q")return _=_.replace(/_/g," "),_=_.replace(/=([0-9a-fA-F]{2})/g,function(gI,M){return String.fromCharCode(parseInt(M,16))}),r(oI,_);try{_=atob(_)}catch{}return r(oI,_)})}return""}},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFNetworkStream=void 0;var o=l(1),t=l(158);const a=200,n=206;function B(k){const iI=k.response;return typeof iI!="string"?iI:(0,o.stringToBytes)(iI).buffer}class R{constructor(iI){let lI=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.url=iI,this.isHttp=/^https?:/i.test(iI),this.httpHeaders=this.isHttp&&lI.httpHeaders||Object.create(null),this.withCredentials=lI.withCredentials||!1,this.getXhr=lI.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(iI,lI,CI){const sI={begin:iI,end:lI};for(const oI in CI)sI[oI]=CI[oI];return this.request(sI)}requestFull(iI){return this.request(iI)}request(iI){const lI=this.getXhr(),CI=this.currXhrId++,sI=this.pendingRequests[CI]={xhr:lI};lI.open("GET",this.url),lI.withCredentials=this.withCredentials;for(const oI in this.httpHeaders){const E=this.httpHeaders[oI];typeof E>"u"||lI.setRequestHeader(oI,E)}return this.isHttp&&"begin"in iI&&"end"in iI?(lI.setRequestHeader("Range",`bytes=${iI.begin}-${iI.end-1}`),sI.expectedStatus=n):sI.expectedStatus=a,lI.responseType="arraybuffer",iI.onError&&(lI.onerror=function(oI){iI.onError(lI.status)}),lI.onreadystatechange=this.onStateChange.bind(this,CI),lI.onprogress=this.onProgress.bind(this,CI),sI.onHeadersReceived=iI.onHeadersReceived,sI.onDone=iI.onDone,sI.onError=iI.onError,sI.onProgress=iI.onProgress,lI.send(null),CI}onProgress(iI,lI){var CI;const sI=this.pendingRequests[iI];sI&&((CI=sI.onProgress)===null||CI===void 0||CI.call(sI,lI))}onStateChange(iI,lI){const CI=this.pendingRequests[iI];if(!CI)return;const sI=CI.xhr;if(sI.readyState>=2&&CI.onHeadersReceived&&(CI.onHeadersReceived(),delete CI.onHeadersReceived),sI.readyState!==4||!(iI in this.pendingRequests))return;if(delete this.pendingRequests[iI],sI.status===0&&this.isHttp){var oI;(oI=CI.onError)===null||oI===void 0||oI.call(CI,sI.status);return}const E=sI.status||a;if(!(E===a&&CI.expectedStatus===n)&&E!==CI.expectedStatus){var gI;(gI=CI.onError)===null||gI===void 0||gI.call(CI,sI.status);return}const M=B(sI);if(E===n){const dI=sI.getResponseHeader("Content-Range"),eI=/bytes (\d+)-(\d+)\/(\d+)/.exec(dI);CI.onDone({begin:parseInt(eI[1],10),chunk:M})}else if(M)CI.onDone({begin:0,chunk:M});else{var O;(O=CI.onError)===null||O===void 0||O.call(CI,sI.status)}}getRequestXhr(iI){return this.pendingRequests[iI].xhr}isPendingRequest(iI){return iI in this.pendingRequests}abortRequest(iI){const lI=this.pendingRequests[iI].xhr;delete this.pendingRequests[iI],lI.abort()}}class r{constructor(iI){this._source=iI,this._manager=new R(iI.url,{httpHeaders:iI.httpHeaders,withCredentials:iI.withCredentials}),this._rangeChunkSize=iI.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(iI){const lI=this._rangeRequestReaders.indexOf(iI);lI>=0&&this._rangeRequestReaders.splice(lI,1)}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new H(this._manager,this._source),this._fullRequestReader}getRangeReader(iI,lI){const CI=new II(this._manager,iI,lI);return CI.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(CI),CI}cancelAllRequests(iI){var lI;(lI=this._fullRequestReader)===null||lI===void 0||lI.cancel(iI);for(const CI of this._rangeRequestReaders.slice(0))CI.cancel(iI)}}A.PDFNetworkStream=r;class H{constructor(iI,lI){this._manager=iI;const CI={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=lI.url,this._fullRequestId=iI.requestFull(CI),this._headersReceivedCapability=(0,o.createPromiseCapability)(),this._disableRange=lI.disableRange||!1,this._contentLength=lI.length,this._rangeChunkSize=lI.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const iI=this._fullRequestId,lI=this._manager.getRequestXhr(iI),CI=E=>lI.getResponseHeader(E),{allowRangeRequests:sI,suggestedLength:oI}=(0,t.validateRangeRequestCapabilities)({getResponseHeader:CI,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});sI&&(this._isRangeSupported=!0),this._contentLength=oI||this._contentLength,this._filename=(0,t.extractFilenameFromHeader)(CI),this._isRangeSupported&&this._manager.abortRequest(iI),this._headersReceivedCapability.resolve()}_onDone(iI){if(iI&&(this._requests.length>0?this._requests.shift().resolve({value:iI.chunk,done:!1}):this._cachedChunks.push(iI.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const lI of this._requests)lI.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(iI){this._storedError=(0,t.createResponseStatusError)(iI,this._url),this._headersReceivedCapability.reject(this._storedError);for(const lI of this._requests)lI.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(iI){var lI;(lI=this.onProgress)===null||lI===void 0||lI.call(this,{loaded:iI.loaded,total:iI.lengthComputable?iI.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const iI=(0,o.createPromiseCapability)();return this._requests.push(iI),iI.promise}cancel(iI){this._done=!0,this._headersReceivedCapability.reject(iI);for(const lI of this._requests)lI.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class II{constructor(iI,lI,CI){this._manager=iI;const sI={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=iI.url,this._requestId=iI.requestRange(lI,CI,sI),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var iI;(iI=this.onClosed)===null||iI===void 0||iI.call(this,this)}_onDone(iI){const lI=iI.chunk;this._requests.length>0?this._requests.shift().resolve({value:lI,done:!1}):this._queuedChunk=lI,this._done=!0;for(const CI of this._requests)CI.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(iI){this._storedError=(0,t.createResponseStatusError)(iI,this._url);for(const lI of this._requests)lI.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(iI){if(!this.isStreamingSupported){var lI;(lI=this.onProgress)===null||lI===void 0||lI.call(this,{loaded:iI.loaded})}}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const lI=this._queuedChunk;return this._queuedChunk=null,{value:lI,done:!1}}if(this._done)return{value:void 0,done:!0};const iI=(0,o.createPromiseCapability)();return this._requests.push(iI),iI.promise}cancel(iI){this._done=!0;for(const lI of this._requests)lI.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,A,l)=>{Object.defineProperty(A,"__esModule",{value:!0}),A.PDFFetchStream=void 0;var o=l(1),t=l(158);function a(H,II,k){return{method:"GET",headers:H,signal:k.signal,mode:"cors",credentials:II?"include":"same-origin",redirect:"follow"}}function n(H){const II=new Headers;for(const k in H){const iI=H[k];typeof iI>"u"||II.append(k,iI)}return II}class B{constructor(II){this.source=II,this.isHttp=/^https?:/i.test(II.url),this.httpHeaders=this.isHttp&&II.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var II,k;return(II=(k=this._fullRequestReader)===null||k===void 0?void 0:k._loaded)!==null&&II!==void 0?II:0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new R(this),this._fullRequestReader}getRangeReader(II,k){if(k<=this._progressiveDataLength)return null;const iI=new r(this,II,k);return this._rangeRequestReaders.push(iI),iI}cancelAllRequests(II){this._fullRequestReader&&this._fullRequestReader.cancel(II);for(const k of this._rangeRequestReaders.slice(0))k.cancel(II)}}A.PDFFetchStream=B;class R{constructor(II){this._stream=II,this._reader=null,this._loaded=0,this._filename=null;const k=II.source;this._withCredentials=k.withCredentials||!1,this._contentLength=k.length,this._headersCapability=(0,o.createPromiseCapability)(),this._disableRange=k.disableRange||!1,this._rangeChunkSize=k.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!k.disableStream,this._isRangeSupported=!k.disableRange,this._headers=n(this._stream.httpHeaders);const iI=k.url;fetch(iI,a(this._headers,this._withCredentials,this._abortController)).then(lI=>{if(!(0,t.validateResponseStatus)(lI.status))throw(0,t.createResponseStatusError)(lI.status,iI);this._reader=lI.body.getReader(),this._headersCapability.resolve();const CI=E=>lI.headers.get(E),{allowRangeRequests:sI,suggestedLength:oI}=(0,t.validateRangeRequestCapabilities)({getResponseHeader:CI,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=sI,this._contentLength=oI||this._contentLength,this._filename=(0,t.extractFilenameFromHeader)(CI),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new o.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:II,done:k}=await this._reader.read();return k?{value:II,done:k}:(this._loaded+=II.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(II).buffer,done:!1})}cancel(II){this._reader&&this._reader.cancel(II),this._abortController.abort()}}class r{constructor(II,k,iI){this._stream=II,this._reader=null,this._loaded=0;const lI=II.source;this._withCredentials=lI.withCredentials||!1,this._readCapability=(0,o.createPromiseCapability)(),this._isStreamingSupported=!lI.disableStream,this._abortController=new AbortController,this._headers=n(this._stream.httpHeaders),this._headers.append("Range",`bytes=${k}-${iI-1}`);const CI=lI.url;fetch(CI,a(this._headers,this._withCredentials,this._abortController)).then(sI=>{if(!(0,t.validateResponseStatus)(sI.status))throw(0,t.createResponseStatusError)(sI.status,CI);this._readCapability.resolve(),this._reader=sI.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:II,done:k}=await this._reader.read();return k?{value:II,done:k}:(this._loaded+=II.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(II).buffer,done:!1})}cancel(II){this._reader&&this._reader.cancel(II),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var A=__webpack_module_cache__[e];if(A!==void 0)return A.exports;var l=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](l,l.exports,__w_pdfjs_require__),l.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return t.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return A.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return A.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return a.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return n.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return A.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return A.CMapCompressionType}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return B.GlobalWorkerOptions}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return A.InvalidPDFException}}),Object.defineProperty(e,"LoopbackPort",{enumerable:!0,get:function(){return l.LoopbackPort}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return A.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return A.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return l.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return o.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return l.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return A.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return A.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return o.PixelsPerInch}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return o.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return H.SVGGraphics}}),Object.defineProperty(e,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return A.UNSUPPORTED_FEATURES}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return A.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return A.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return A.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return II.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return l.build}}),Object.defineProperty(e,"createPromiseCapability",{enumerable:!0,get:function(){return A.createPromiseCapability}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return A.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return l.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return o.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return o.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return o.getXfaPageViewport}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return o.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return o.loadScript}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return r.renderTextLayer}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return A.shadow}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return l.version}});var A=__w_pdfjs_require__(1),l=__w_pdfjs_require__(129),o=__w_pdfjs_require__(133),t=__w_pdfjs_require__(147),a=__w_pdfjs_require__(132),n=__w_pdfjs_require__(152),B=__w_pdfjs_require__(140),R=__w_pdfjs_require__(3),r=__w_pdfjs_require__(155),H=__w_pdfjs_require__(156),II=__w_pdfjs_require__(154);if(R.isNodeJS){const{PDFNodeStream:k}=__w_pdfjs_require__(157);(0,l.setPDFNetworkStreamFactory)(iI=>new k(iI))}else{const{PDFNetworkStream:k}=__w_pdfjs_require__(160),{PDFFetchStream:iI}=__w_pdfjs_require__(161);(0,l.setPDFNetworkStreamFactory)(lI=>(0,o.isValidFetchUrl)(lI.url)?new iI(lI):new k(lI))}})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();const workerSrc=new URL("data:text/javascript;base64,LyoqCiAqIEBsaWNzdGFydCBUaGUgZm9sbG93aW5nIGlzIHRoZSBlbnRpcmUgbGljZW5zZSBub3RpY2UgZm9yIHRoZQogKiBKYXZhU2NyaXB0IGNvZGUgaW4gdGhpcyBwYWdlCiAqCiAqIENvcHlyaWdodCAyMDIyIE1vemlsbGEgRm91bmRhdGlvbgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKiBAbGljZW5kIFRoZSBhYm92ZSBpcyB0aGUgZW50aXJlIGxpY2Vuc2Ugbm90aWNlIGZvciB0aGUKICogSmF2YVNjcmlwdCBjb2RlIGluIHRoaXMgcGFnZQogKi8KCihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7CglpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpCgkJbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7CgllbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkKCQlkZWZpbmUoInBkZmpzLWRpc3QvYnVpbGQvcGRmLndvcmtlciIsIFtdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbInBkZmpzLWRpc3QvYnVpbGQvcGRmLndvcmtlciJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbInBkZmpzLWRpc3QvYnVpbGQvcGRmLndvcmtlciJdID0gcm9vdC5wZGZqc1dvcmtlciA9IGZhY3RvcnkoKTsKfSkoZ2xvYmFsVGhpcywgKCkgPT4gewpyZXR1cm4gLyoqKioqKi8gKCgpID0+IHsgLy8gd2VicGFja0Jvb3RzdHJhcAovKioqKioqLyAJdmFyIF9fd2VicGFja19tb2R1bGVzX18gPSAoWwovKiAwICovLAovKiAxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Xb3JrZXJUYXNrID0gZXhwb3J0cy5Xb3JrZXJNZXNzYWdlSGFuZGxlciA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMCk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX3BkZl9tYW5hZ2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzMpOwoKdmFyIF9jbGVhbnVwX2hlbHBlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk2KTsKCnZhciBfd3JpdGVyID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTApOwoKdmFyIF9pc19ub2RlID0gX193X3BkZmpzX3JlcXVpcmVfXyg0KTsKCnZhciBfbWVzc2FnZV9oYW5kbGVyID0gX193X3BkZmpzX3JlcXVpcmVfXygyMjcpOwoKdmFyIF93b3JrZXJfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMjgpOwoKY2xhc3MgV29ya2VyVGFzayB7CiAgY29uc3RydWN0b3IobmFtZSkgewogICAgdGhpcy5uYW1lID0gbmFtZTsKICAgIHRoaXMudGVybWluYXRlZCA9IGZhbHNlOwogICAgdGhpcy5fY2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICB9CgogIGdldCBmaW5pc2hlZCgpIHsKICAgIHJldHVybiB0aGlzLl9jYXBhYmlsaXR5LnByb21pc2U7CiAgfQoKICBmaW5pc2goKSB7CiAgICB0aGlzLl9jYXBhYmlsaXR5LnJlc29sdmUoKTsKICB9CgogIHRlcm1pbmF0ZSgpIHsKICAgIHRoaXMudGVybWluYXRlZCA9IHRydWU7CiAgfQoKICBlbnN1cmVOb3RUZXJtaW5hdGVkKCkgewogICAgaWYgKHRoaXMudGVybWluYXRlZCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIldvcmtlciB0YXNrIHdhcyB0ZXJtaW5hdGVkIik7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5Xb3JrZXJUYXNrID0gV29ya2VyVGFzazsKCmNsYXNzIFdvcmtlck1lc3NhZ2VIYW5kbGVyIHsKICBzdGF0aWMgc2V0dXAoaGFuZGxlciwgcG9ydCkgewogICAgbGV0IHRlc3RNZXNzYWdlUHJvY2Vzc2VkID0gZmFsc2U7CiAgICBoYW5kbGVyLm9uKCJ0ZXN0IiwgZnVuY3Rpb24gd3BoU2V0dXBUZXN0KGRhdGEpIHsKICAgICAgaWYgKHRlc3RNZXNzYWdlUHJvY2Vzc2VkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0ZXN0TWVzc2FnZVByb2Nlc3NlZCA9IHRydWU7CiAgICAgIGhhbmRsZXIuc2VuZCgidGVzdCIsIGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiY29uZmlndXJlIiwgZnVuY3Rpb24gd3BoQ29uZmlndXJlKGRhdGEpIHsKICAgICAgKDAsIF91dGlsLnNldFZlcmJvc2l0eUxldmVsKShkYXRhLnZlcmJvc2l0eSk7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldERvY1JlcXVlc3QiLCBmdW5jdGlvbiB3cGhTZXR1cERvYyhkYXRhKSB7CiAgICAgIHJldHVybiBXb3JrZXJNZXNzYWdlSGFuZGxlci5jcmVhdGVEb2N1bWVudEhhbmRsZXIoZGF0YSwgcG9ydCk7CiAgICB9KTsKICB9CgogIHN0YXRpYyBjcmVhdGVEb2N1bWVudEhhbmRsZXIoZG9jUGFyYW1zLCBwb3J0KSB7CiAgICBsZXQgcGRmTWFuYWdlcjsKICAgIGxldCB0ZXJtaW5hdGVkID0gZmFsc2U7CiAgICBsZXQgY2FuY2VsWEhScyA9IG51bGw7CiAgICBjb25zdCBXb3JrZXJUYXNrcyA9IFtdOwogICAgY29uc3QgdmVyYm9zaXR5ID0gKDAsIF91dGlsLmdldFZlcmJvc2l0eUxldmVsKSgpOwogICAgY29uc3QgYXBpVmVyc2lvbiA9IGRvY1BhcmFtcy5hcGlWZXJzaW9uOwogICAgY29uc3Qgd29ya2VyVmVyc2lvbiA9ICcyLjE2LjEwNSc7CgogICAgaWYgKGFwaVZlcnNpb24gIT09IHdvcmtlclZlcnNpb24pIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgQVBJIHZlcnNpb24gIiR7YXBpVmVyc2lvbn0iIGRvZXMgbm90IG1hdGNoIGAgKyBgdGhlIFdvcmtlciB2ZXJzaW9uICIke3dvcmtlclZlcnNpb259Ii5gKTsKICAgIH0KCiAgICBjb25zdCBlbnVtZXJhYmxlUHJvcGVydGllcyA9IFtdOwoKICAgIGZvciAoY29uc3QgcHJvcGVydHkgaW4gW10pIHsKICAgICAgZW51bWVyYWJsZVByb3BlcnRpZXMucHVzaChwcm9wZXJ0eSk7CiAgICB9CgogICAgaWYgKGVudW1lcmFibGVQcm9wZXJ0aWVzLmxlbmd0aCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIlRoZSBgQXJyYXkucHJvdG90eXBlYCBjb250YWlucyB1bmV4cGVjdGVkIGVudW1lcmFibGUgcHJvcGVydGllczogIiArIGVudW1lcmFibGVQcm9wZXJ0aWVzLmpvaW4oIiwgIikgKyAiOyB0aHVzIGJyZWFraW5nIGUuZy4gYGZvci4uLmluYCBpdGVyYXRpb24gb2YgYEFycmF5YHMuIik7CiAgICB9CgogICAgaWYgKHR5cGVvZiBSZWFkYWJsZVN0cmVhbSA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgY29uc3QgcGFydGlhbE1zZyA9ICJUaGUgYnJvd3Nlci9lbnZpcm9ubWVudCBsYWNrcyBuYXRpdmUgc3VwcG9ydCBmb3IgY3JpdGljYWwgIiArICJmdW5jdGlvbmFsaXR5IHVzZWQgYnkgdGhlIFBERi5qcyBsaWJyYXJ5IChlLmcuIGBSZWFkYWJsZVN0cmVhbWApOyAiOwoKICAgICAgaWYgKF9pc19ub2RlLmlzTm9kZUpTKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHBhcnRpYWxNc2cgKyAicGxlYXNlIHVzZSBhIGBsZWdhY3lgLWJ1aWxkIGluc3RlYWQuIik7CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBFcnJvcihwYXJ0aWFsTXNnICsgInBsZWFzZSB1cGRhdGUgdG8gYSBzdXBwb3J0ZWQgYnJvd3Nlci4iKTsKICAgIH0KCiAgICBjb25zdCBkb2NJZCA9IGRvY1BhcmFtcy5kb2NJZDsKICAgIGNvbnN0IGRvY0Jhc2VVcmwgPSBkb2NQYXJhbXMuZG9jQmFzZVVybDsKICAgIGNvbnN0IHdvcmtlckhhbmRsZXJOYW1lID0gZG9jUGFyYW1zLmRvY0lkICsgIl93b3JrZXIiOwogICAgbGV0IGhhbmRsZXIgPSBuZXcgX21lc3NhZ2VfaGFuZGxlci5NZXNzYWdlSGFuZGxlcih3b3JrZXJIYW5kbGVyTmFtZSwgZG9jSWQsIHBvcnQpOwoKICAgIGZ1bmN0aW9uIGVuc3VyZU5vdFRlcm1pbmF0ZWQoKSB7CiAgICAgIGlmICh0ZXJtaW5hdGVkKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJXb3JrZXIgd2FzIHRlcm1pbmF0ZWQiKTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHN0YXJ0V29ya2VyVGFzayh0YXNrKSB7CiAgICAgIFdvcmtlclRhc2tzLnB1c2godGFzayk7CiAgICB9CgogICAgZnVuY3Rpb24gZmluaXNoV29ya2VyVGFzayh0YXNrKSB7CiAgICAgIHRhc2suZmluaXNoKCk7CiAgICAgIGNvbnN0IGkgPSBXb3JrZXJUYXNrcy5pbmRleE9mKHRhc2spOwogICAgICBXb3JrZXJUYXNrcy5zcGxpY2UoaSwgMSk7CiAgICB9CgogICAgYXN5bmMgZnVuY3Rpb24gbG9hZERvY3VtZW50KHJlY292ZXJ5TW9kZSkgewogICAgICBhd2FpdCBwZGZNYW5hZ2VyLmVuc3VyZURvYygiY2hlY2tIZWFkZXIiKTsKICAgICAgYXdhaXQgcGRmTWFuYWdlci5lbnN1cmVEb2MoInBhcnNlU3RhcnRYUmVmIik7CiAgICAgIGF3YWl0IHBkZk1hbmFnZXIuZW5zdXJlRG9jKCJwYXJzZSIsIFtyZWNvdmVyeU1vZGVdKTsKICAgICAgYXdhaXQgcGRmTWFuYWdlci5lbnN1cmVEb2MoImNoZWNrRmlyc3RQYWdlIiwgW3JlY292ZXJ5TW9kZV0pOwogICAgICBhd2FpdCBwZGZNYW5hZ2VyLmVuc3VyZURvYygiY2hlY2tMYXN0UGFnZSIsIFtyZWNvdmVyeU1vZGVdKTsKICAgICAgY29uc3QgaXNQdXJlWGZhID0gYXdhaXQgcGRmTWFuYWdlci5lbnN1cmVEb2MoImlzUHVyZVhmYSIpOwoKICAgICAgaWYgKGlzUHVyZVhmYSkgewogICAgICAgIGNvbnN0IHRhc2sgPSBuZXcgV29ya2VyVGFzaygibG9hZFhmYUZvbnRzIik7CiAgICAgICAgc3RhcnRXb3JrZXJUYXNrKHRhc2spOwogICAgICAgIGF3YWl0IFByb21pc2UuYWxsKFtwZGZNYW5hZ2VyLmxvYWRYZmFGb250cyhoYW5kbGVyLCB0YXNrKS5jYXRjaChyZWFzb24gPT4ge30pLnRoZW4oKCkgPT4gZmluaXNoV29ya2VyVGFzayh0YXNrKSksIHBkZk1hbmFnZXIubG9hZFhmYUltYWdlcygpXSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IFtudW1QYWdlcywgZmluZ2VycHJpbnRzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtwZGZNYW5hZ2VyLmVuc3VyZURvYygibnVtUGFnZXMiKSwgcGRmTWFuYWdlci5lbnN1cmVEb2MoImZpbmdlcnByaW50cyIpXSk7CiAgICAgIGNvbnN0IGh0bWxGb3JYZmEgPSBpc1B1cmVYZmEgPyBhd2FpdCBwZGZNYW5hZ2VyLmVuc3VyZURvYygiaHRtbEZvclhmYSIpIDogbnVsbDsKICAgICAgcmV0dXJuIHsKICAgICAgICBudW1QYWdlcywKICAgICAgICBmaW5nZXJwcmludHMsCiAgICAgICAgaHRtbEZvclhmYQogICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIGdldFBkZk1hbmFnZXIoZGF0YSwgZXZhbHVhdG9yT3B0aW9ucywgZW5hYmxlWGZhKSB7CiAgICAgIGNvbnN0IHBkZk1hbmFnZXJDYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgICBsZXQgbmV3UGRmTWFuYWdlcjsKICAgICAgY29uc3Qgc291cmNlID0gZGF0YS5zb3VyY2U7CgogICAgICBpZiAoc291cmNlLmRhdGEpIHsKICAgICAgICB0cnkgewogICAgICAgICAgbmV3UGRmTWFuYWdlciA9IG5ldyBfcGRmX21hbmFnZXIuTG9jYWxQZGZNYW5hZ2VyKGRvY0lkLCBzb3VyY2UuZGF0YSwgc291cmNlLnBhc3N3b3JkLCBoYW5kbGVyLCBldmFsdWF0b3JPcHRpb25zLCBlbmFibGVYZmEsIGRvY0Jhc2VVcmwpOwogICAgICAgICAgcGRmTWFuYWdlckNhcGFiaWxpdHkucmVzb2x2ZShuZXdQZGZNYW5hZ2VyKTsKICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgcGRmTWFuYWdlckNhcGFiaWxpdHkucmVqZWN0KGV4KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5wcm9taXNlOwogICAgICB9CgogICAgICBsZXQgcGRmU3RyZWFtLAogICAgICAgICAgY2FjaGVkQ2h1bmtzID0gW107CgogICAgICB0cnkgewogICAgICAgIHBkZlN0cmVhbSA9IG5ldyBfd29ya2VyX3N0cmVhbS5QREZXb3JrZXJTdHJlYW0oaGFuZGxlcik7CiAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgcGRmTWFuYWdlckNhcGFiaWxpdHkucmVqZWN0KGV4KTsKICAgICAgICByZXR1cm4gcGRmTWFuYWdlckNhcGFiaWxpdHkucHJvbWlzZTsKICAgICAgfQoKICAgICAgY29uc3QgZnVsbFJlcXVlc3QgPSBwZGZTdHJlYW0uZ2V0RnVsbFJlYWRlcigpOwogICAgICBmdWxsUmVxdWVzdC5oZWFkZXJzUmVhZHkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKCFmdWxsUmVxdWVzdC5pc1JhbmdlU3VwcG9ydGVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkaXNhYmxlQXV0b0ZldGNoID0gc291cmNlLmRpc2FibGVBdXRvRmV0Y2ggfHwgZnVsbFJlcXVlc3QuaXNTdHJlYW1pbmdTdXBwb3J0ZWQ7CiAgICAgICAgbmV3UGRmTWFuYWdlciA9IG5ldyBfcGRmX21hbmFnZXIuTmV0d29ya1BkZk1hbmFnZXIoZG9jSWQsIHBkZlN0cmVhbSwgewogICAgICAgICAgbXNnSGFuZGxlcjogaGFuZGxlciwKICAgICAgICAgIHBhc3N3b3JkOiBzb3VyY2UucGFzc3dvcmQsCiAgICAgICAgICBsZW5ndGg6IGZ1bGxSZXF1ZXN0LmNvbnRlbnRMZW5ndGgsCiAgICAgICAgICBkaXNhYmxlQXV0b0ZldGNoLAogICAgICAgICAgcmFuZ2VDaHVua1NpemU6IHNvdXJjZS5yYW5nZUNodW5rU2l6ZQogICAgICAgIH0sIGV2YWx1YXRvck9wdGlvbnMsIGVuYWJsZVhmYSwgZG9jQmFzZVVybCk7CgogICAgICAgIGZvciAoY29uc3QgY2h1bmsgb2YgY2FjaGVkQ2h1bmtzKSB7CiAgICAgICAgICBuZXdQZGZNYW5hZ2VyLnNlbmRQcm9ncmVzc2l2ZURhdGEoY2h1bmspOwogICAgICAgIH0KCiAgICAgICAgY2FjaGVkQ2h1bmtzID0gW107CiAgICAgICAgcGRmTWFuYWdlckNhcGFiaWxpdHkucmVzb2x2ZShuZXdQZGZNYW5hZ2VyKTsKICAgICAgICBjYW5jZWxYSFJzID0gbnVsbDsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgIHBkZk1hbmFnZXJDYXBhYmlsaXR5LnJlamVjdChyZWFzb24pOwogICAgICAgIGNhbmNlbFhIUnMgPSBudWxsOwogICAgICB9KTsKICAgICAgbGV0IGxvYWRlZCA9IDA7CgogICAgICBjb25zdCBmbHVzaENodW5rcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBjb25zdCBwZGZGaWxlID0gKDAsIF91dGlsLmFycmF5c1RvQnl0ZXMpKGNhY2hlZENodW5rcyk7CgogICAgICAgIGlmIChzb3VyY2UubGVuZ3RoICYmIHBkZkZpbGUubGVuZ3RoICE9PSBzb3VyY2UubGVuZ3RoKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoInJlcG9ydGVkIEhUVFAgbGVuZ3RoIGlzIGRpZmZlcmVudCBmcm9tIGFjdHVhbCIpOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAgIG5ld1BkZk1hbmFnZXIgPSBuZXcgX3BkZl9tYW5hZ2VyLkxvY2FsUGRmTWFuYWdlcihkb2NJZCwgcGRmRmlsZSwgc291cmNlLnBhc3N3b3JkLCBoYW5kbGVyLCBldmFsdWF0b3JPcHRpb25zLCBlbmFibGVYZmEsIGRvY0Jhc2VVcmwpOwogICAgICAgICAgcGRmTWFuYWdlckNhcGFiaWxpdHkucmVzb2x2ZShuZXdQZGZNYW5hZ2VyKTsKICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgcGRmTWFuYWdlckNhcGFiaWxpdHkucmVqZWN0KGV4KTsKICAgICAgICB9CgogICAgICAgIGNhY2hlZENodW5rcyA9IFtdOwogICAgICB9OwoKICAgICAgY29uc3QgcmVhZFByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgY29uc3QgcmVhZENodW5rID0gZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgICAgIGxldCB7CiAgICAgICAgICAgIHZhbHVlLAogICAgICAgICAgICBkb25lCiAgICAgICAgICB9ID0gX3JlZjsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBlbnN1cmVOb3RUZXJtaW5hdGVkKCk7CgogICAgICAgICAgICBpZiAoZG9uZSkgewogICAgICAgICAgICAgIGlmICghbmV3UGRmTWFuYWdlcikgewogICAgICAgICAgICAgICAgZmx1c2hDaHVua3MoKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhbmNlbFhIUnMgPSBudWxsOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbG9hZGVkICs9ICgwLCBfdXRpbC5hcnJheUJ5dGVMZW5ndGgpKHZhbHVlKTsKCiAgICAgICAgICAgIGlmICghZnVsbFJlcXVlc3QuaXNTdHJlYW1pbmdTdXBwb3J0ZWQpIHsKICAgICAgICAgICAgICBoYW5kbGVyLnNlbmQoIkRvY1Byb2dyZXNzIiwgewogICAgICAgICAgICAgICAgbG9hZGVkLAogICAgICAgICAgICAgICAgdG90YWw6IE1hdGgubWF4KGxvYWRlZCwgZnVsbFJlcXVlc3QuY29udGVudExlbmd0aCB8fCAwKQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobmV3UGRmTWFuYWdlcikgewogICAgICAgICAgICAgIG5ld1BkZk1hbmFnZXIuc2VuZFByb2dyZXNzaXZlRGF0YSh2YWx1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY2FjaGVkQ2h1bmtzLnB1c2godmFsdWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdWxsUmVxdWVzdC5yZWFkKCkudGhlbihyZWFkQ2h1bmssIHJlamVjdCk7CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBmdWxsUmVxdWVzdC5yZWFkKCkudGhlbihyZWFkQ2h1bmssIHJlamVjdCk7CiAgICAgIH0pOwogICAgICByZWFkUHJvbWlzZS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIHBkZk1hbmFnZXJDYXBhYmlsaXR5LnJlamVjdChlKTsKICAgICAgICBjYW5jZWxYSFJzID0gbnVsbDsKICAgICAgfSk7CgogICAgICBjYW5jZWxYSFJzID0gZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgIHBkZlN0cmVhbS5jYW5jZWxBbGxSZXF1ZXN0cyhyZWFzb24pOwogICAgICB9OwoKICAgICAgcmV0dXJuIHBkZk1hbmFnZXJDYXBhYmlsaXR5LnByb21pc2U7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0dXBEb2MoZGF0YSkgewogICAgICBmdW5jdGlvbiBvblN1Y2Nlc3MoZG9jKSB7CiAgICAgICAgZW5zdXJlTm90VGVybWluYXRlZCgpOwogICAgICAgIGhhbmRsZXIuc2VuZCgiR2V0RG9jIiwgewogICAgICAgICAgcGRmSW5mbzogZG9jCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIG9uRmFpbHVyZShleCkgewogICAgICAgIGVuc3VyZU5vdFRlcm1pbmF0ZWQoKTsKCiAgICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX3V0aWwuUGFzc3dvcmRFeGNlcHRpb24pIHsKICAgICAgICAgIGNvbnN0IHRhc2sgPSBuZXcgV29ya2VyVGFzayhgUGFzc3dvcmRFeGNlcHRpb246IHJlc3BvbnNlICR7ZXguY29kZX1gKTsKICAgICAgICAgIHN0YXJ0V29ya2VyVGFzayh0YXNrKTsKICAgICAgICAgIGhhbmRsZXIuc2VuZFdpdGhQcm9taXNlKCJQYXNzd29yZFJlcXVlc3QiLCBleCkudGhlbihmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgICAgICAgbGV0IHsKICAgICAgICAgICAgICBwYXNzd29yZAogICAgICAgICAgICB9ID0gX3JlZjI7CiAgICAgICAgICAgIGZpbmlzaFdvcmtlclRhc2sodGFzayk7CiAgICAgICAgICAgIHBkZk1hbmFnZXIudXBkYXRlUGFzc3dvcmQocGFzc3dvcmQpOwogICAgICAgICAgICBwZGZNYW5hZ2VyUmVhZHkoKTsKICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgZmluaXNoV29ya2VyVGFzayh0YXNrKTsKICAgICAgICAgICAgaGFuZGxlci5zZW5kKCJEb2NFeGNlcHRpb24iLCBleCk7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKGV4IGluc3RhbmNlb2YgX3V0aWwuSW52YWxpZFBERkV4Y2VwdGlvbiB8fCBleCBpbnN0YW5jZW9mIF91dGlsLk1pc3NpbmdQREZFeGNlcHRpb24gfHwgZXggaW5zdGFuY2VvZiBfdXRpbC5VbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb24gfHwgZXggaW5zdGFuY2VvZiBfdXRpbC5Vbmtub3duRXJyb3JFeGNlcHRpb24pIHsKICAgICAgICAgIGhhbmRsZXIuc2VuZCgiRG9jRXhjZXB0aW9uIiwgZXgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoYW5kbGVyLnNlbmQoIkRvY0V4Y2VwdGlvbiIsIG5ldyBfdXRpbC5Vbmtub3duRXJyb3JFeGNlcHRpb24oZXgubWVzc2FnZSwgZXgudG9TdHJpbmcoKSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gcGRmTWFuYWdlclJlYWR5KCkgewogICAgICAgIGVuc3VyZU5vdFRlcm1pbmF0ZWQoKTsKICAgICAgICBsb2FkRG9jdW1lbnQoZmFsc2UpLnRoZW4ob25TdWNjZXNzLCBmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBlbnN1cmVOb3RUZXJtaW5hdGVkKCk7CgogICAgICAgICAgaWYgKCEocmVhc29uIGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuWFJlZlBhcnNlRXhjZXB0aW9uKSkgewogICAgICAgICAgICBvbkZhaWx1cmUocmVhc29uKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHBkZk1hbmFnZXIucmVxdWVzdExvYWRlZFN0cmVhbSgpOwogICAgICAgICAgcGRmTWFuYWdlci5vbkxvYWRlZFN0cmVhbSgpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBlbnN1cmVOb3RUZXJtaW5hdGVkKCk7CiAgICAgICAgICAgIGxvYWREb2N1bWVudCh0cnVlKS50aGVuKG9uU3VjY2Vzcywgb25GYWlsdXJlKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBlbnN1cmVOb3RUZXJtaW5hdGVkKCk7CiAgICAgIGNvbnN0IGV2YWx1YXRvck9wdGlvbnMgPSB7CiAgICAgICAgbWF4SW1hZ2VTaXplOiBkYXRhLm1heEltYWdlU2l6ZSwKICAgICAgICBkaXNhYmxlRm9udEZhY2U6IGRhdGEuZGlzYWJsZUZvbnRGYWNlLAogICAgICAgIGlnbm9yZUVycm9yczogZGF0YS5pZ25vcmVFcnJvcnMsCiAgICAgICAgaXNFdmFsU3VwcG9ydGVkOiBkYXRhLmlzRXZhbFN1cHBvcnRlZCwKICAgICAgICBmb250RXh0cmFQcm9wZXJ0aWVzOiBkYXRhLmZvbnRFeHRyYVByb3BlcnRpZXMsCiAgICAgICAgdXNlU3lzdGVtRm9udHM6IGRhdGEudXNlU3lzdGVtRm9udHMsCiAgICAgICAgY01hcFVybDogZGF0YS5jTWFwVXJsLAogICAgICAgIHN0YW5kYXJkRm9udERhdGFVcmw6IGRhdGEuc3RhbmRhcmRGb250RGF0YVVybAogICAgICB9OwogICAgICBnZXRQZGZNYW5hZ2VyKGRhdGEsIGV2YWx1YXRvck9wdGlvbnMsIGRhdGEuZW5hYmxlWGZhKS50aGVuKGZ1bmN0aW9uIChuZXdQZGZNYW5hZ2VyKSB7CiAgICAgICAgaWYgKHRlcm1pbmF0ZWQpIHsKICAgICAgICAgIG5ld1BkZk1hbmFnZXIudGVybWluYXRlKG5ldyBfdXRpbC5BYm9ydEV4Y2VwdGlvbigiV29ya2VyIHdhcyB0ZXJtaW5hdGVkLiIpKTsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiV29ya2VyIHdhcyB0ZXJtaW5hdGVkIik7CiAgICAgICAgfQoKICAgICAgICBwZGZNYW5hZ2VyID0gbmV3UGRmTWFuYWdlcjsKICAgICAgICBwZGZNYW5hZ2VyLm9uTG9hZGVkU3RyZWFtKCkudGhlbihmdW5jdGlvbiAoc3RyZWFtKSB7CiAgICAgICAgICBoYW5kbGVyLnNlbmQoIkRhdGFMb2FkZWQiLCB7CiAgICAgICAgICAgIGxlbmd0aDogc3RyZWFtLmJ5dGVzLmJ5dGVMZW5ndGgKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KS50aGVuKHBkZk1hbmFnZXJSZWFkeSwgb25GYWlsdXJlKTsKICAgIH0KCiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRQYWdlKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZ2V0UGFnZShkYXRhLnBhZ2VJbmRleCkudGhlbihmdW5jdGlvbiAocGFnZSkgewogICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbcGRmTWFuYWdlci5lbnN1cmUocGFnZSwgInJvdGF0ZSIpLCBwZGZNYW5hZ2VyLmVuc3VyZShwYWdlLCAicmVmIiksIHBkZk1hbmFnZXIuZW5zdXJlKHBhZ2UsICJ1c2VyVW5pdCIpLCBwZGZNYW5hZ2VyLmVuc3VyZShwYWdlLCAidmlldyIpXSkudGhlbihmdW5jdGlvbiAoX3JlZjMpIHsKICAgICAgICAgIGxldCBbcm90YXRlLCByZWYsIHVzZXJVbml0LCB2aWV3XSA9IF9yZWYzOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcm90YXRlLAogICAgICAgICAgICByZWYsCiAgICAgICAgICAgIHVzZXJVbml0LAogICAgICAgICAgICB2aWV3CiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0UGFnZUluZGV4IiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRQYWdlSW5kZXgoZGF0YSkgewogICAgICBjb25zdCBwYWdlUmVmID0gX3ByaW1pdGl2ZXMuUmVmLmdldChkYXRhLm51bSwgZGF0YS5nZW4pOwoKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygiZ2V0UGFnZUluZGV4IiwgW3BhZ2VSZWZdKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0RGVzdGluYXRpb25zIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXREZXN0aW5hdGlvbnMoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJkZXN0aW5hdGlvbnMiKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0RGVzdGluYXRpb24iLCBmdW5jdGlvbiB3cGhTZXR1cEdldERlc3RpbmF0aW9uKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygiZ2V0RGVzdGluYXRpb24iLCBbZGF0YS5pZF0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlTGFiZWxzIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRQYWdlTGFiZWxzKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygicGFnZUxhYmVscyIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlTGF5b3V0IiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRQYWdlTGF5b3V0KGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygicGFnZUxheW91dCIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlTW9kZSIsIGZ1bmN0aW9uIHdwaFNldHVwR2V0UGFnZU1vZGUoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJwYWdlTW9kZSIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRWaWV3ZXJQcmVmZXJlbmNlcyIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coInZpZXdlclByZWZlcmVuY2VzIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldE9wZW5BY3Rpb24iLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJvcGVuQWN0aW9uIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldEF0dGFjaG1lbnRzIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRBdHRhY2htZW50cyhkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coImF0dGFjaG1lbnRzIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldEphdmFTY3JpcHQiLCBmdW5jdGlvbiB3cGhTZXR1cEdldEphdmFTY3JpcHQoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJqYXZhU2NyaXB0Iik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldERvY0pTQWN0aW9ucyIsIGZ1bmN0aW9uIHdwaFNldHVwR2V0RG9jSlNBY3Rpb25zKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygianNBY3Rpb25zIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldFBhZ2VKU0FjdGlvbnMiLCBmdW5jdGlvbiAoX3JlZjQpIHsKICAgICAgbGV0IHsKICAgICAgICBwYWdlSW5kZXgKICAgICAgfSA9IF9yZWY0OwogICAgICByZXR1cm4gcGRmTWFuYWdlci5nZXRQYWdlKHBhZ2VJbmRleCkudGhlbihmdW5jdGlvbiAocGFnZSkgewogICAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZShwYWdlLCAianNBY3Rpb25zIik7CiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRPdXRsaW5lIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRPdXRsaW5lKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygiZG9jdW1lbnRPdXRsaW5lIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldE9wdGlvbmFsQ29udGVudENvbmZpZyIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coIm9wdGlvbmFsQ29udGVudENvbmZpZyIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQZXJtaXNzaW9ucyIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coInBlcm1pc3Npb25zIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldE1ldGFkYXRhIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRNZXRhZGF0YShkYXRhKSB7CiAgICAgIHJldHVybiBQcm9taXNlLmFsbChbcGRmTWFuYWdlci5lbnN1cmVEb2MoImRvY3VtZW50SW5mbyIpLCBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coIm1ldGFkYXRhIildKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0TWFya0luZm8iLCBmdW5jdGlvbiB3cGhTZXR1cEdldE1hcmtJbmZvKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygibWFya0luZm8iKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0RGF0YSIsIGZ1bmN0aW9uIHdwaFNldHVwR2V0RGF0YShkYXRhKSB7CiAgICAgIHBkZk1hbmFnZXIucmVxdWVzdExvYWRlZFN0cmVhbSgpOwogICAgICByZXR1cm4gcGRmTWFuYWdlci5vbkxvYWRlZFN0cmVhbSgpLnRoZW4oZnVuY3Rpb24gKHN0cmVhbSkgewogICAgICAgIHJldHVybiBzdHJlYW0uYnl0ZXM7CiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRBbm5vdGF0aW9ucyIsIGZ1bmN0aW9uIChfcmVmNSkgewogICAgICBsZXQgewogICAgICAgIHBhZ2VJbmRleCwKICAgICAgICBpbnRlbnQKICAgICAgfSA9IF9yZWY1OwogICAgICByZXR1cm4gcGRmTWFuYWdlci5nZXRQYWdlKHBhZ2VJbmRleCkudGhlbihmdW5jdGlvbiAocGFnZSkgewogICAgICAgIGNvbnN0IHRhc2sgPSBuZXcgV29ya2VyVGFzayhgR2V0QW5ub3RhdGlvbnM6IHBhZ2UgJHtwYWdlSW5kZXh9YCk7CiAgICAgICAgc3RhcnRXb3JrZXJUYXNrKHRhc2spOwogICAgICAgIHJldHVybiBwYWdlLmdldEFubm90YXRpb25zRGF0YShoYW5kbGVyLCB0YXNrLCBpbnRlbnQpLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgICBmaW5pc2hXb3JrZXJUYXNrKHRhc2spOwogICAgICAgICAgcmV0dXJuIGRhdGE7CiAgICAgICAgfSwgcmVhc29uID0+IHsKICAgICAgICAgIGZpbmlzaFdvcmtlclRhc2sodGFzayk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRGaWVsZE9iamVjdHMiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVEb2MoImZpZWxkT2JqZWN0cyIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJIYXNKU0FjdGlvbnMiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVEb2MoImhhc0pTQWN0aW9ucyIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRDYWxjdWxhdGlvbk9yZGVySWRzIiwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlRG9jKCJjYWxjdWxhdGlvbk9yZGVySWRzIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIlNhdmVEb2N1bWVudCIsIGZ1bmN0aW9uIChfcmVmNikgewogICAgICBsZXQgewogICAgICAgIGlzUHVyZVhmYSwKICAgICAgICBudW1QYWdlcywKICAgICAgICBhbm5vdGF0aW9uU3RvcmFnZSwKICAgICAgICBmaWxlbmFtZQogICAgICB9ID0gX3JlZjY7CiAgICAgIHBkZk1hbmFnZXIucmVxdWVzdExvYWRlZFN0cmVhbSgpOwogICAgICBjb25zdCBuZXdBbm5vdGF0aW9uc0J5UGFnZSA9ICFpc1B1cmVYZmEgPyAoMCwgX2NvcmVfdXRpbHMuZ2V0TmV3QW5ub3RhdGlvbnNNYXApKGFubm90YXRpb25TdG9yYWdlKSA6IG51bGw7CiAgICAgIGNvbnN0IHByb21pc2VzID0gW3BkZk1hbmFnZXIub25Mb2FkZWRTdHJlYW0oKSwgcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJhY3JvRm9ybSIpLCBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coImFjcm9Gb3JtUmVmIiksIHBkZk1hbmFnZXIuZW5zdXJlRG9jKCJ4cmVmIiksIHBkZk1hbmFnZXIuZW5zdXJlRG9jKCJzdGFydFhSZWYiKV07CgogICAgICBpZiAobmV3QW5ub3RhdGlvbnNCeVBhZ2UpIHsKICAgICAgICBmb3IgKGNvbnN0IFtwYWdlSW5kZXgsIGFubm90YXRpb25zXSBvZiBuZXdBbm5vdGF0aW9uc0J5UGFnZSkgewogICAgICAgICAgcHJvbWlzZXMucHVzaChwZGZNYW5hZ2VyLmdldFBhZ2UocGFnZUluZGV4KS50aGVuKHBhZ2UgPT4gewogICAgICAgICAgICBjb25zdCB0YXNrID0gbmV3IFdvcmtlclRhc2soYFNhdmUgKGVkaXRvcik6IHBhZ2UgJHtwYWdlSW5kZXh9YCk7CiAgICAgICAgICAgIHJldHVybiBwYWdlLnNhdmVOZXdBbm5vdGF0aW9ucyhoYW5kbGVyLCB0YXNrLCBhbm5vdGF0aW9ucykuZmluYWxseShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgZmluaXNoV29ya2VyVGFzayh0YXNrKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoaXNQdXJlWGZhKSB7CiAgICAgICAgcHJvbWlzZXMucHVzaChwZGZNYW5hZ2VyLnNlcmlhbGl6ZVhmYURhdGEoYW5ub3RhdGlvblN0b3JhZ2UpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGxldCBwYWdlSW5kZXggPSAwOyBwYWdlSW5kZXggPCBudW1QYWdlczsgcGFnZUluZGV4KyspIHsKICAgICAgICAgIHByb21pc2VzLnB1c2gocGRmTWFuYWdlci5nZXRQYWdlKHBhZ2VJbmRleCkudGhlbihmdW5jdGlvbiAocGFnZSkgewogICAgICAgICAgICBjb25zdCB0YXNrID0gbmV3IFdvcmtlclRhc2soYFNhdmU6IHBhZ2UgJHtwYWdlSW5kZXh9YCk7CiAgICAgICAgICAgIHJldHVybiBwYWdlLnNhdmUoaGFuZGxlciwgdGFzaywgYW5ub3RhdGlvblN0b3JhZ2UpLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGZpbmlzaFdvcmtlclRhc2sodGFzayk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uIChfcmVmNykgewogICAgICAgIGxldCBbc3RyZWFtLCBhY3JvRm9ybSwgYWNyb0Zvcm1SZWYsIHhyZWYsIHN0YXJ0WFJlZiwgLi4ucmVmc10gPSBfcmVmNzsKICAgICAgICBsZXQgbmV3UmVmcyA9IFtdOwogICAgICAgIGxldCB4ZmFEYXRhID0gbnVsbDsKCiAgICAgICAgaWYgKGlzUHVyZVhmYSkgewogICAgICAgICAgeGZhRGF0YSA9IHJlZnNbMF07CgogICAgICAgICAgaWYgKCF4ZmFEYXRhKSB7CiAgICAgICAgICAgIHJldHVybiBzdHJlYW0uYnl0ZXM7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG5ld1JlZnMgPSByZWZzLmZsYXQoMik7CgogICAgICAgICAgaWYgKG5ld1JlZnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBzdHJlYW0uYnl0ZXM7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb25zdCB4ZmEgPSBhY3JvRm9ybSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgJiYgYWNyb0Zvcm0uZ2V0KCJYRkEiKSB8fCBudWxsOwogICAgICAgIGxldCB4ZmFEYXRhc2V0c1JlZiA9IG51bGw7CiAgICAgICAgbGV0IGhhc1hmYURhdGFzZXRzRW50cnkgPSBmYWxzZTsKCiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoeGZhKSkgewogICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0geGZhLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHsKICAgICAgICAgICAgaWYgKHhmYVtpXSA9PT0gImRhdGFzZXRzIikgewogICAgICAgICAgICAgIHhmYURhdGFzZXRzUmVmID0geGZhW2kgKyAxXTsKICAgICAgICAgICAgICBhY3JvRm9ybVJlZiA9IG51bGw7CiAgICAgICAgICAgICAgaGFzWGZhRGF0YXNldHNFbnRyeSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoeGZhRGF0YXNldHNSZWYgPT09IG51bGwpIHsKICAgICAgICAgICAgeGZhRGF0YXNldHNSZWYgPSB4cmVmLmdldE5ld1JlZigpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoeGZhKSB7CiAgICAgICAgICBhY3JvRm9ybVJlZiA9IG51bGw7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVuc3VwcG9ydGVkIFhGQSB0eXBlLiIpOwogICAgICAgIH0KCiAgICAgICAgbGV0IG5ld1hyZWZJbmZvID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICAgICAgaWYgKHhyZWYudHJhaWxlcikgewogICAgICAgICAgY29uc3QgaW5mb09iaiA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgICBjb25zdCB4cmVmSW5mbyA9IHhyZWYudHJhaWxlci5nZXQoIkluZm8iKSB8fCBudWxsOwoKICAgICAgICAgIGlmICh4cmVmSW5mbyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICAgICAgeHJlZkluZm8uZm9yRWFjaCgoa2V5LCB2YWx1ZSkgPT4gewogICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgICAgICBpbmZvT2JqW2tleV0gPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKHZhbHVlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIG5ld1hyZWZJbmZvID0gewogICAgICAgICAgICByb290UmVmOiB4cmVmLnRyYWlsZXIuZ2V0UmF3KCJSb290IikgfHwgbnVsbCwKICAgICAgICAgICAgZW5jcnlwdFJlZjogeHJlZi50cmFpbGVyLmdldFJhdygiRW5jcnlwdCIpIHx8IG51bGwsCiAgICAgICAgICAgIG5ld1JlZjogeHJlZi5nZXROZXdSZWYoKSwKICAgICAgICAgICAgaW5mb1JlZjogeHJlZi50cmFpbGVyLmdldFJhdygiSW5mbyIpIHx8IG51bGwsCiAgICAgICAgICAgIGluZm86IGluZm9PYmosCiAgICAgICAgICAgIGZpbGVJZHM6IHhyZWYudHJhaWxlci5nZXQoIklEIikgfHwgbnVsbCwKICAgICAgICAgICAgc3RhcnRYUmVmLAogICAgICAgICAgICBmaWxlbmFtZQogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHhyZWYucmVzZXROZXdSZWYoKTsKICAgICAgICByZXR1cm4gKDAsIF93cml0ZXIuaW5jcmVtZW50YWxVcGRhdGUpKHsKICAgICAgICAgIG9yaWdpbmFsRGF0YTogc3RyZWFtLmJ5dGVzLAogICAgICAgICAgeHJlZkluZm86IG5ld1hyZWZJbmZvLAogICAgICAgICAgbmV3UmVmcywKICAgICAgICAgIHhyZWYsCiAgICAgICAgICBoYXNYZmE6ICEheGZhLAogICAgICAgICAgeGZhRGF0YXNldHNSZWYsCiAgICAgICAgICBoYXNYZmFEYXRhc2V0c0VudHJ5LAogICAgICAgICAgYWNyb0Zvcm1SZWYsCiAgICAgICAgICBhY3JvRm9ybSwKICAgICAgICAgIHhmYURhdGEKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldE9wZXJhdG9yTGlzdCIsIGZ1bmN0aW9uIHdwaFNldHVwUmVuZGVyUGFnZShkYXRhLCBzaW5rKSB7CiAgICAgIGNvbnN0IHBhZ2VJbmRleCA9IGRhdGEucGFnZUluZGV4OwogICAgICBwZGZNYW5hZ2VyLmdldFBhZ2UocGFnZUluZGV4KS50aGVuKGZ1bmN0aW9uIChwYWdlKSB7CiAgICAgICAgY29uc3QgdGFzayA9IG5ldyBXb3JrZXJUYXNrKGBHZXRPcGVyYXRvckxpc3Q6IHBhZ2UgJHtwYWdlSW5kZXh9YCk7CiAgICAgICAgc3RhcnRXb3JrZXJUYXNrKHRhc2spOwogICAgICAgIGNvbnN0IHN0YXJ0ID0gdmVyYm9zaXR5ID49IF91dGlsLlZlcmJvc2l0eUxldmVsLklORk9TID8gRGF0ZS5ub3coKSA6IDA7CiAgICAgICAgcGFnZS5nZXRPcGVyYXRvckxpc3QoewogICAgICAgICAgaGFuZGxlciwKICAgICAgICAgIHNpbmssCiAgICAgICAgICB0YXNrLAogICAgICAgICAgaW50ZW50OiBkYXRhLmludGVudCwKICAgICAgICAgIGNhY2hlS2V5OiBkYXRhLmNhY2hlS2V5LAogICAgICAgICAgYW5ub3RhdGlvblN0b3JhZ2U6IGRhdGEuYW5ub3RhdGlvblN0b3JhZ2UKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChvcGVyYXRvckxpc3RJbmZvKSB7CiAgICAgICAgICBmaW5pc2hXb3JrZXJUYXNrKHRhc2spOwoKICAgICAgICAgIGlmIChzdGFydCkgewogICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoYHBhZ2U9JHtwYWdlSW5kZXggKyAxfSAtIGdldE9wZXJhdG9yTGlzdDogdGltZT1gICsgYCR7RGF0ZS5ub3coKSAtIHN0YXJ0fW1zLCBsZW49JHtvcGVyYXRvckxpc3RJbmZvLmxlbmd0aH1gKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzaW5rLmNsb3NlKCk7CiAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgZmluaXNoV29ya2VyVGFzayh0YXNrKTsKCiAgICAgICAgICBpZiAodGFzay50ZXJtaW5hdGVkKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBoYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvck9wZXJhdG9yTGlzdAogICAgICAgICAgfSk7CiAgICAgICAgICBzaW5rLmVycm9yKHJlYXNvbik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRUZXh0Q29udGVudCIsIGZ1bmN0aW9uIHdwaEV4dHJhY3RUZXh0KGRhdGEsIHNpbmspIHsKICAgICAgY29uc3QgcGFnZUluZGV4ID0gZGF0YS5wYWdlSW5kZXg7CiAgICAgIHBkZk1hbmFnZXIuZ2V0UGFnZShwYWdlSW5kZXgpLnRoZW4oZnVuY3Rpb24gKHBhZ2UpIHsKICAgICAgICBjb25zdCB0YXNrID0gbmV3IFdvcmtlclRhc2soIkdldFRleHRDb250ZW50OiBwYWdlICIgKyBwYWdlSW5kZXgpOwogICAgICAgIHN0YXJ0V29ya2VyVGFzayh0YXNrKTsKICAgICAgICBjb25zdCBzdGFydCA9IHZlcmJvc2l0eSA+PSBfdXRpbC5WZXJib3NpdHlMZXZlbC5JTkZPUyA/IERhdGUubm93KCkgOiAwOwogICAgICAgIHBhZ2UuZXh0cmFjdFRleHRDb250ZW50KHsKICAgICAgICAgIGhhbmRsZXIsCiAgICAgICAgICB0YXNrLAogICAgICAgICAgc2luaywKICAgICAgICAgIGluY2x1ZGVNYXJrZWRDb250ZW50OiBkYXRhLmluY2x1ZGVNYXJrZWRDb250ZW50LAogICAgICAgICAgY29tYmluZVRleHRJdGVtczogZGF0YS5jb21iaW5lVGV4dEl0ZW1zCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBmaW5pc2hXb3JrZXJUYXNrKHRhc2spOwoKICAgICAgICAgIGlmIChzdGFydCkgewogICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoYHBhZ2U9JHtwYWdlSW5kZXggKyAxfSAtIGdldFRleHRDb250ZW50OiB0aW1lPWAgKyBgJHtEYXRlLm5vdygpIC0gc3RhcnR9bXNgKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzaW5rLmNsb3NlKCk7CiAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgZmluaXNoV29ya2VyVGFzayh0YXNrKTsKCiAgICAgICAgICBpZiAodGFzay50ZXJtaW5hdGVkKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBzaW5rLmVycm9yKHJlYXNvbik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRTdHJ1Y3RUcmVlIiwgZnVuY3Rpb24gd3BoR2V0U3RydWN0VHJlZShkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmdldFBhZ2UoZGF0YS5wYWdlSW5kZXgpLnRoZW4oZnVuY3Rpb24gKHBhZ2UpIHsKICAgICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmUocGFnZSwgImdldFN0cnVjdFRyZWUiKTsKICAgICAgfSk7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkZvbnRGYWxsYmFjayIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmZvbnRGYWxsYmFjayhkYXRhLmlkLCBoYW5kbGVyKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiQ2xlYW51cCIsIGZ1bmN0aW9uIHdwaENsZWFudXAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5jbGVhbnVwKHRydWUpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJUZXJtaW5hdGUiLCBmdW5jdGlvbiB3cGhUZXJtaW5hdGUoZGF0YSkgewogICAgICB0ZXJtaW5hdGVkID0gdHJ1ZTsKICAgICAgY29uc3Qgd2FpdE9uID0gW107CgogICAgICBpZiAocGRmTWFuYWdlcikgewogICAgICAgIHBkZk1hbmFnZXIudGVybWluYXRlKG5ldyBfdXRpbC5BYm9ydEV4Y2VwdGlvbigiV29ya2VyIHdhcyB0ZXJtaW5hdGVkLiIpKTsKICAgICAgICBjb25zdCBjbGVhbnVwUHJvbWlzZSA9IHBkZk1hbmFnZXIuY2xlYW51cCgpOwogICAgICAgIHdhaXRPbi5wdXNoKGNsZWFudXBQcm9taXNlKTsKICAgICAgICBwZGZNYW5hZ2VyID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX2NsZWFudXBfaGVscGVyLmNsZWFyR2xvYmFsQ2FjaGVzKSgpOwogICAgICB9CgogICAgICBpZiAoY2FuY2VsWEhScykgewogICAgICAgIGNhbmNlbFhIUnMobmV3IF91dGlsLkFib3J0RXhjZXB0aW9uKCJXb3JrZXIgd2FzIHRlcm1pbmF0ZWQuIikpOwogICAgICB9CgogICAgICBmb3IgKGNvbnN0IHRhc2sgb2YgV29ya2VyVGFza3MpIHsKICAgICAgICB3YWl0T24ucHVzaCh0YXNrLmZpbmlzaGVkKTsKICAgICAgICB0YXNrLnRlcm1pbmF0ZSgpOwogICAgICB9CgogICAgICByZXR1cm4gUHJvbWlzZS5hbGwod2FpdE9uKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBoYW5kbGVyLmRlc3Ryb3koKTsKICAgICAgICBoYW5kbGVyID0gbnVsbDsKICAgICAgfSk7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIlJlYWR5IiwgZnVuY3Rpb24gd3BoUmVhZHkoZGF0YSkgewogICAgICBzZXR1cERvYyhkb2NQYXJhbXMpOwogICAgICBkb2NQYXJhbXMgPSBudWxsOwogICAgfSk7CiAgICByZXR1cm4gd29ya2VySGFuZGxlck5hbWU7CiAgfQoKICBzdGF0aWMgaW5pdGlhbGl6ZUZyb21Qb3J0KHBvcnQpIHsKICAgIGNvbnN0IGhhbmRsZXIgPSBuZXcgX21lc3NhZ2VfaGFuZGxlci5NZXNzYWdlSGFuZGxlcigid29ya2VyIiwgIm1haW4iLCBwb3J0KTsKICAgIFdvcmtlck1lc3NhZ2VIYW5kbGVyLnNldHVwKGhhbmRsZXIsIHBvcnQpOwogICAgaGFuZGxlci5zZW5kKCJyZWFkeSIsIG51bGwpOwogIH0KCn0KCmV4cG9ydHMuV29ya2VyTWVzc2FnZUhhbmRsZXIgPSBXb3JrZXJNZXNzYWdlSGFuZGxlcjsKCmZ1bmN0aW9uIGlzTWVzc2FnZVBvcnQobWF5YmVQb3J0KSB7CiAgcmV0dXJuIHR5cGVvZiBtYXliZVBvcnQucG9zdE1lc3NhZ2UgPT09ICJmdW5jdGlvbiIgJiYgIm9ubWVzc2FnZSIgaW4gbWF5YmVQb3J0Owp9CgppZiAodHlwZW9mIHdpbmRvdyA9PT0gInVuZGVmaW5lZCIgJiYgIV9pc19ub2RlLmlzTm9kZUpTICYmIHR5cGVvZiBzZWxmICE9PSAidW5kZWZpbmVkIiAmJiBpc01lc3NhZ2VQb3J0KHNlbGYpKSB7CiAgV29ya2VyTWVzc2FnZUhhbmRsZXIuaW5pdGlhbGl6ZUZyb21Qb3J0KHNlbGYpOwp9CgovKioqLyB9KSwKLyogMiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuVmVyYm9zaXR5TGV2ZWwgPSBleHBvcnRzLlV0aWwgPSBleHBvcnRzLlVua25vd25FcnJvckV4Y2VwdGlvbiA9IGV4cG9ydHMuVW5leHBlY3RlZFJlc3BvbnNlRXhjZXB0aW9uID0gZXhwb3J0cy5VTlNVUFBPUlRFRF9GRUFUVVJFUyA9IGV4cG9ydHMuVGV4dFJlbmRlcmluZ01vZGUgPSBleHBvcnRzLlN0cmVhbVR5cGUgPSBleHBvcnRzLlJlbmRlcmluZ0ludGVudEZsYWcgPSBleHBvcnRzLlBlcm1pc3Npb25GbGFnID0gZXhwb3J0cy5QYXNzd29yZFJlc3BvbnNlcyA9IGV4cG9ydHMuUGFzc3dvcmRFeGNlcHRpb24gPSBleHBvcnRzLlBhZ2VBY3Rpb25FdmVudFR5cGUgPSBleHBvcnRzLk9QUyA9IGV4cG9ydHMuTWlzc2luZ1BERkV4Y2VwdGlvbiA9IGV4cG9ydHMuTElORV9GQUNUT1IgPSBleHBvcnRzLkxJTkVfREVTQ0VOVF9GQUNUT1IgPSBleHBvcnRzLkludmFsaWRQREZFeGNlcHRpb24gPSBleHBvcnRzLkltYWdlS2luZCA9IGV4cG9ydHMuSURFTlRJVFlfTUFUUklYID0gZXhwb3J0cy5Gb3JtYXRFcnJvciA9IGV4cG9ydHMuRm9udFR5cGUgPSBleHBvcnRzLkZlYXR1cmVUZXN0ID0gZXhwb3J0cy5GT05UX0lERU5USVRZX01BVFJJWCA9IGV4cG9ydHMuRG9jdW1lbnRBY3Rpb25FdmVudFR5cGUgPSBleHBvcnRzLkNNYXBDb21wcmVzc2lvblR5cGUgPSBleHBvcnRzLkJhc2VFeGNlcHRpb24gPSBleHBvcnRzLkFubm90YXRpb25UeXBlID0gZXhwb3J0cy5Bbm5vdGF0aW9uU3RhdGVNb2RlbFR5cGUgPSBleHBvcnRzLkFubm90YXRpb25SZXZpZXdTdGF0ZSA9IGV4cG9ydHMuQW5ub3RhdGlvblJlcGx5VHlwZSA9IGV4cG9ydHMuQW5ub3RhdGlvbk1vZGUgPSBleHBvcnRzLkFubm90YXRpb25NYXJrZWRTdGF0ZSA9IGV4cG9ydHMuQW5ub3RhdGlvbkZsYWcgPSBleHBvcnRzLkFubm90YXRpb25GaWVsZEZsYWcgPSBleHBvcnRzLkFubm90YXRpb25FZGl0b3JUeXBlID0gZXhwb3J0cy5Bbm5vdGF0aW9uRWRpdG9yUHJlZml4ID0gZXhwb3J0cy5Bbm5vdGF0aW9uRWRpdG9yUGFyYW1zVHlwZSA9IGV4cG9ydHMuQW5ub3RhdGlvbkJvcmRlclN0eWxlVHlwZSA9IGV4cG9ydHMuQW5ub3RhdGlvbkFjdGlvbkV2ZW50VHlwZSA9IGV4cG9ydHMuQWJvcnRFeGNlcHRpb24gPSB2b2lkIDA7CmV4cG9ydHMuYXJyYXlCeXRlTGVuZ3RoID0gYXJyYXlCeXRlTGVuZ3RoOwpleHBvcnRzLmFycmF5c1RvQnl0ZXMgPSBhcnJheXNUb0J5dGVzOwpleHBvcnRzLmFzc2VydCA9IGFzc2VydDsKZXhwb3J0cy5ieXRlc1RvU3RyaW5nID0gYnl0ZXNUb1N0cmluZzsKZXhwb3J0cy5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSA9IGNyZWF0ZVByb21pc2VDYXBhYmlsaXR5OwpleHBvcnRzLmNyZWF0ZVZhbGlkQWJzb2x1dGVVcmwgPSBjcmVhdGVWYWxpZEFic29sdXRlVXJsOwpleHBvcnRzLmVzY2FwZVN0cmluZyA9IGVzY2FwZVN0cmluZzsKZXhwb3J0cy5nZXRNb2RpZmljYXRpb25EYXRlID0gZ2V0TW9kaWZpY2F0aW9uRGF0ZTsKZXhwb3J0cy5nZXRWZXJib3NpdHlMZXZlbCA9IGdldFZlcmJvc2l0eUxldmVsOwpleHBvcnRzLmluZm8gPSBpbmZvOwpleHBvcnRzLmlzQXJyYXlCdWZmZXIgPSBpc0FycmF5QnVmZmVyOwpleHBvcnRzLmlzQXJyYXlFcXVhbCA9IGlzQXJyYXlFcXVhbDsKZXhwb3J0cy5pc0FzY2lpID0gaXNBc2NpaTsKZXhwb3J0cy5vYmplY3RGcm9tTWFwID0gb2JqZWN0RnJvbU1hcDsKZXhwb3J0cy5vYmplY3RTaXplID0gb2JqZWN0U2l6ZTsKZXhwb3J0cy5zZXRWZXJib3NpdHlMZXZlbCA9IHNldFZlcmJvc2l0eUxldmVsOwpleHBvcnRzLnNoYWRvdyA9IHNoYWRvdzsKZXhwb3J0cy5zdHJpbmczMiA9IHN0cmluZzMyOwpleHBvcnRzLnN0cmluZ1RvQnl0ZXMgPSBzdHJpbmdUb0J5dGVzOwpleHBvcnRzLnN0cmluZ1RvUERGU3RyaW5nID0gc3RyaW5nVG9QREZTdHJpbmc7CmV4cG9ydHMuc3RyaW5nVG9VVEYxNkJFU3RyaW5nID0gc3RyaW5nVG9VVEYxNkJFU3RyaW5nOwpleHBvcnRzLnN0cmluZ1RvVVRGOFN0cmluZyA9IHN0cmluZ1RvVVRGOFN0cmluZzsKZXhwb3J0cy51bnJlYWNoYWJsZSA9IHVucmVhY2hhYmxlOwpleHBvcnRzLnV0ZjhTdHJpbmdUb1N0cmluZyA9IHV0ZjhTdHJpbmdUb1N0cmluZzsKZXhwb3J0cy53YXJuID0gd2FybjsKCl9fd19wZGZqc19yZXF1aXJlX18oMyk7Cgpjb25zdCBJREVOVElUWV9NQVRSSVggPSBbMSwgMCwgMCwgMSwgMCwgMF07CmV4cG9ydHMuSURFTlRJVFlfTUFUUklYID0gSURFTlRJVFlfTUFUUklYOwpjb25zdCBGT05UX0lERU5USVRZX01BVFJJWCA9IFswLjAwMSwgMCwgMCwgMC4wMDEsIDAsIDBdOwpleHBvcnRzLkZPTlRfSURFTlRJVFlfTUFUUklYID0gRk9OVF9JREVOVElUWV9NQVRSSVg7CmNvbnN0IExJTkVfRkFDVE9SID0gMS4zNTsKZXhwb3J0cy5MSU5FX0ZBQ1RPUiA9IExJTkVfRkFDVE9SOwpjb25zdCBMSU5FX0RFU0NFTlRfRkFDVE9SID0gMC4zNTsKZXhwb3J0cy5MSU5FX0RFU0NFTlRfRkFDVE9SID0gTElORV9ERVNDRU5UX0ZBQ1RPUjsKY29uc3QgUmVuZGVyaW5nSW50ZW50RmxhZyA9IHsKICBBTlk6IDB4MDEsCiAgRElTUExBWTogMHgwMiwKICBQUklOVDogMHgwNCwKICBBTk5PVEFUSU9OU19GT1JNUzogMHgxMCwKICBBTk5PVEFUSU9OU19TVE9SQUdFOiAweDIwLAogIEFOTk9UQVRJT05TX0RJU0FCTEU6IDB4NDAsCiAgT1BMSVNUOiAweDEwMAp9OwpleHBvcnRzLlJlbmRlcmluZ0ludGVudEZsYWcgPSBSZW5kZXJpbmdJbnRlbnRGbGFnOwpjb25zdCBBbm5vdGF0aW9uTW9kZSA9IHsKICBESVNBQkxFOiAwLAogIEVOQUJMRTogMSwKICBFTkFCTEVfRk9STVM6IDIsCiAgRU5BQkxFX1NUT1JBR0U6IDMKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uTW9kZSA9IEFubm90YXRpb25Nb2RlOwpjb25zdCBBbm5vdGF0aW9uRWRpdG9yUHJlZml4ID0gInBkZmpzX2ludGVybmFsX2VkaXRvcl8iOwpleHBvcnRzLkFubm90YXRpb25FZGl0b3JQcmVmaXggPSBBbm5vdGF0aW9uRWRpdG9yUHJlZml4Owpjb25zdCBBbm5vdGF0aW9uRWRpdG9yVHlwZSA9IHsKICBESVNBQkxFOiAtMSwKICBOT05FOiAwLAogIEZSRUVURVhUOiAzLAogIElOSzogMTUKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uRWRpdG9yVHlwZSA9IEFubm90YXRpb25FZGl0b3JUeXBlOwpjb25zdCBBbm5vdGF0aW9uRWRpdG9yUGFyYW1zVHlwZSA9IHsKICBGUkVFVEVYVF9TSVpFOiAxLAogIEZSRUVURVhUX0NPTE9SOiAyLAogIEZSRUVURVhUX09QQUNJVFk6IDMsCiAgSU5LX0NPTE9SOiAxMSwKICBJTktfVEhJQ0tORVNTOiAxMiwKICBJTktfT1BBQ0lUWTogMTMKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uRWRpdG9yUGFyYW1zVHlwZSA9IEFubm90YXRpb25FZGl0b3JQYXJhbXNUeXBlOwpjb25zdCBQZXJtaXNzaW9uRmxhZyA9IHsKICBQUklOVDogMHgwNCwKICBNT0RJRllfQ09OVEVOVFM6IDB4MDgsCiAgQ09QWTogMHgxMCwKICBNT0RJRllfQU5OT1RBVElPTlM6IDB4MjAsCiAgRklMTF9JTlRFUkFDVElWRV9GT1JNUzogMHgxMDAsCiAgQ09QWV9GT1JfQUNDRVNTSUJJTElUWTogMHgyMDAsCiAgQVNTRU1CTEU6IDB4NDAwLAogIFBSSU5UX0hJR0hfUVVBTElUWTogMHg4MDAKfTsKZXhwb3J0cy5QZXJtaXNzaW9uRmxhZyA9IFBlcm1pc3Npb25GbGFnOwpjb25zdCBUZXh0UmVuZGVyaW5nTW9kZSA9IHsKICBGSUxMOiAwLAogIFNUUk9LRTogMSwKICBGSUxMX1NUUk9LRTogMiwKICBJTlZJU0lCTEU6IDMsCiAgRklMTF9BRERfVE9fUEFUSDogNCwKICBTVFJPS0VfQUREX1RPX1BBVEg6IDUsCiAgRklMTF9TVFJPS0VfQUREX1RPX1BBVEg6IDYsCiAgQUREX1RPX1BBVEg6IDcsCiAgRklMTF9TVFJPS0VfTUFTSzogMywKICBBRERfVE9fUEFUSF9GTEFHOiA0Cn07CmV4cG9ydHMuVGV4dFJlbmRlcmluZ01vZGUgPSBUZXh0UmVuZGVyaW5nTW9kZTsKY29uc3QgSW1hZ2VLaW5kID0gewogIEdSQVlTQ0FMRV8xQlBQOiAxLAogIFJHQl8yNEJQUDogMiwKICBSR0JBXzMyQlBQOiAzCn07CmV4cG9ydHMuSW1hZ2VLaW5kID0gSW1hZ2VLaW5kOwpjb25zdCBBbm5vdGF0aW9uVHlwZSA9IHsKICBURVhUOiAxLAogIExJTks6IDIsCiAgRlJFRVRFWFQ6IDMsCiAgTElORTogNCwKICBTUVVBUkU6IDUsCiAgQ0lSQ0xFOiA2LAogIFBPTFlHT046IDcsCiAgUE9MWUxJTkU6IDgsCiAgSElHSExJR0hUOiA5LAogIFVOREVSTElORTogMTAsCiAgU1FVSUdHTFk6IDExLAogIFNUUklLRU9VVDogMTIsCiAgU1RBTVA6IDEzLAogIENBUkVUOiAxNCwKICBJTks6IDE1LAogIFBPUFVQOiAxNiwKICBGSUxFQVRUQUNITUVOVDogMTcsCiAgU09VTkQ6IDE4LAogIE1PVklFOiAxOSwKICBXSURHRVQ6IDIwLAogIFNDUkVFTjogMjEsCiAgUFJJTlRFUk1BUks6IDIyLAogIFRSQVBORVQ6IDIzLAogIFdBVEVSTUFSSzogMjQsCiAgVEhSRUVEOiAyNSwKICBSRURBQ1Q6IDI2Cn07CmV4cG9ydHMuQW5ub3RhdGlvblR5cGUgPSBBbm5vdGF0aW9uVHlwZTsKY29uc3QgQW5ub3RhdGlvblN0YXRlTW9kZWxUeXBlID0gewogIE1BUktFRDogIk1hcmtlZCIsCiAgUkVWSUVXOiAiUmV2aWV3Igp9OwpleHBvcnRzLkFubm90YXRpb25TdGF0ZU1vZGVsVHlwZSA9IEFubm90YXRpb25TdGF0ZU1vZGVsVHlwZTsKY29uc3QgQW5ub3RhdGlvbk1hcmtlZFN0YXRlID0gewogIE1BUktFRDogIk1hcmtlZCIsCiAgVU5NQVJLRUQ6ICJVbm1hcmtlZCIKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uTWFya2VkU3RhdGUgPSBBbm5vdGF0aW9uTWFya2VkU3RhdGU7CmNvbnN0IEFubm90YXRpb25SZXZpZXdTdGF0ZSA9IHsKICBBQ0NFUFRFRDogIkFjY2VwdGVkIiwKICBSRUpFQ1RFRDogIlJlamVjdGVkIiwKICBDQU5DRUxMRUQ6ICJDYW5jZWxsZWQiLAogIENPTVBMRVRFRDogIkNvbXBsZXRlZCIsCiAgTk9ORTogIk5vbmUiCn07CmV4cG9ydHMuQW5ub3RhdGlvblJldmlld1N0YXRlID0gQW5ub3RhdGlvblJldmlld1N0YXRlOwpjb25zdCBBbm5vdGF0aW9uUmVwbHlUeXBlID0gewogIEdST1VQOiAiR3JvdXAiLAogIFJFUExZOiAiUiIKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uUmVwbHlUeXBlID0gQW5ub3RhdGlvblJlcGx5VHlwZTsKY29uc3QgQW5ub3RhdGlvbkZsYWcgPSB7CiAgSU5WSVNJQkxFOiAweDAxLAogIEhJRERFTjogMHgwMiwKICBQUklOVDogMHgwNCwKICBOT1pPT006IDB4MDgsCiAgTk9ST1RBVEU6IDB4MTAsCiAgTk9WSUVXOiAweDIwLAogIFJFQURPTkxZOiAweDQwLAogIExPQ0tFRDogMHg4MCwKICBUT0dHTEVOT1ZJRVc6IDB4MTAwLAogIExPQ0tFRENPTlRFTlRTOiAweDIwMAp9OwpleHBvcnRzLkFubm90YXRpb25GbGFnID0gQW5ub3RhdGlvbkZsYWc7CmNvbnN0IEFubm90YXRpb25GaWVsZEZsYWcgPSB7CiAgUkVBRE9OTFk6IDB4MDAwMDAwMSwKICBSRVFVSVJFRDogMHgwMDAwMDAyLAogIE5PRVhQT1JUOiAweDAwMDAwMDQsCiAgTVVMVElMSU5FOiAweDAwMDEwMDAsCiAgUEFTU1dPUkQ6IDB4MDAwMjAwMCwKICBOT1RPR0dMRVRPT0ZGOiAweDAwMDQwMDAsCiAgUkFESU86IDB4MDAwODAwMCwKICBQVVNIQlVUVE9OOiAweDAwMTAwMDAsCiAgQ09NQk86IDB4MDAyMDAwMCwKICBFRElUOiAweDAwNDAwMDAsCiAgU09SVDogMHgwMDgwMDAwLAogIEZJTEVTRUxFQ1Q6IDB4MDEwMDAwMCwKICBNVUxUSVNFTEVDVDogMHgwMjAwMDAwLAogIERPTk9UU1BFTExDSEVDSzogMHgwNDAwMDAwLAogIERPTk9UU0NST0xMOiAweDA4MDAwMDAsCiAgQ09NQjogMHgxMDAwMDAwLAogIFJJQ0hURVhUOiAweDIwMDAwMDAsCiAgUkFESU9TSU5VTklTT046IDB4MjAwMDAwMCwKICBDT01NSVRPTlNFTENIQU5HRTogMHg0MDAwMDAwCn07CmV4cG9ydHMuQW5ub3RhdGlvbkZpZWxkRmxhZyA9IEFubm90YXRpb25GaWVsZEZsYWc7CmNvbnN0IEFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUgPSB7CiAgU09MSUQ6IDEsCiAgREFTSEVEOiAyLAogIEJFVkVMRUQ6IDMsCiAgSU5TRVQ6IDQsCiAgVU5ERVJMSU5FOiA1Cn07CmV4cG9ydHMuQW5ub3RhdGlvbkJvcmRlclN0eWxlVHlwZSA9IEFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGU7CmNvbnN0IEFubm90YXRpb25BY3Rpb25FdmVudFR5cGUgPSB7CiAgRTogIk1vdXNlIEVudGVyIiwKICBYOiAiTW91c2UgRXhpdCIsCiAgRDogIk1vdXNlIERvd24iLAogIFU6ICJNb3VzZSBVcCIsCiAgRm86ICJGb2N1cyIsCiAgQmw6ICJCbHVyIiwKICBQTzogIlBhZ2VPcGVuIiwKICBQQzogIlBhZ2VDbG9zZSIsCiAgUFY6ICJQYWdlVmlzaWJsZSIsCiAgUEk6ICJQYWdlSW52aXNpYmxlIiwKICBLOiAiS2V5c3Ryb2tlIiwKICBGOiAiRm9ybWF0IiwKICBWOiAiVmFsaWRhdGUiLAogIEM6ICJDYWxjdWxhdGUiCn07CmV4cG9ydHMuQW5ub3RhdGlvbkFjdGlvbkV2ZW50VHlwZSA9IEFubm90YXRpb25BY3Rpb25FdmVudFR5cGU7CmNvbnN0IERvY3VtZW50QWN0aW9uRXZlbnRUeXBlID0gewogIFdDOiAiV2lsbENsb3NlIiwKICBXUzogIldpbGxTYXZlIiwKICBEUzogIkRpZFNhdmUiLAogIFdQOiAiV2lsbFByaW50IiwKICBEUDogIkRpZFByaW50Igp9OwpleHBvcnRzLkRvY3VtZW50QWN0aW9uRXZlbnRUeXBlID0gRG9jdW1lbnRBY3Rpb25FdmVudFR5cGU7CmNvbnN0IFBhZ2VBY3Rpb25FdmVudFR5cGUgPSB7CiAgTzogIlBhZ2VPcGVuIiwKICBDOiAiUGFnZUNsb3NlIgp9OwpleHBvcnRzLlBhZ2VBY3Rpb25FdmVudFR5cGUgPSBQYWdlQWN0aW9uRXZlbnRUeXBlOwpjb25zdCBTdHJlYW1UeXBlID0gewogIFVOS05PV046ICJVTktOT1dOIiwKICBGTEFURTogIkZMQVRFIiwKICBMWlc6ICJMWlciLAogIERDVDogIkRDVCIsCiAgSlBYOiAiSlBYIiwKICBKQklHOiAiSkJJRyIsCiAgQTg1OiAiQTg1IiwKICBBSFg6ICJBSFgiLAogIENDRjogIkNDRiIsCiAgUkxYOiAiUkxYIgp9OwpleHBvcnRzLlN0cmVhbVR5cGUgPSBTdHJlYW1UeXBlOwpjb25zdCBGb250VHlwZSA9IHsKICBVTktOT1dOOiAiVU5LTk9XTiIsCiAgVFlQRTE6ICJUWVBFMSIsCiAgVFlQRTFTVEFOREFSRDogIlRZUEUxU1RBTkRBUkQiLAogIFRZUEUxQzogIlRZUEUxQyIsCiAgQ0lERk9OVFRZUEUwOiAiQ0lERk9OVFRZUEUwIiwKICBDSURGT05UVFlQRTBDOiAiQ0lERk9OVFRZUEUwQyIsCiAgVFJVRVRZUEU6ICJUUlVFVFlQRSIsCiAgQ0lERk9OVFRZUEUyOiAiQ0lERk9OVFRZUEUyIiwKICBUWVBFMzogIlRZUEUzIiwKICBPUEVOVFlQRTogIk9QRU5UWVBFIiwKICBUWVBFMDogIlRZUEUwIiwKICBNTVRZUEUxOiAiTU1UWVBFMSIKfTsKZXhwb3J0cy5Gb250VHlwZSA9IEZvbnRUeXBlOwpjb25zdCBWZXJib3NpdHlMZXZlbCA9IHsKICBFUlJPUlM6IDAsCiAgV0FSTklOR1M6IDEsCiAgSU5GT1M6IDUKfTsKZXhwb3J0cy5WZXJib3NpdHlMZXZlbCA9IFZlcmJvc2l0eUxldmVsOwpjb25zdCBDTWFwQ29tcHJlc3Npb25UeXBlID0gewogIE5PTkU6IDAsCiAgQklOQVJZOiAxLAogIFNUUkVBTTogMgp9OwpleHBvcnRzLkNNYXBDb21wcmVzc2lvblR5cGUgPSBDTWFwQ29tcHJlc3Npb25UeXBlOwpjb25zdCBPUFMgPSB7CiAgZGVwZW5kZW5jeTogMSwKICBzZXRMaW5lV2lkdGg6IDIsCiAgc2V0TGluZUNhcDogMywKICBzZXRMaW5lSm9pbjogNCwKICBzZXRNaXRlckxpbWl0OiA1LAogIHNldERhc2g6IDYsCiAgc2V0UmVuZGVyaW5nSW50ZW50OiA3LAogIHNldEZsYXRuZXNzOiA4LAogIHNldEdTdGF0ZTogOSwKICBzYXZlOiAxMCwKICByZXN0b3JlOiAxMSwKICB0cmFuc2Zvcm06IDEyLAogIG1vdmVUbzogMTMsCiAgbGluZVRvOiAxNCwKICBjdXJ2ZVRvOiAxNSwKICBjdXJ2ZVRvMjogMTYsCiAgY3VydmVUbzM6IDE3LAogIGNsb3NlUGF0aDogMTgsCiAgcmVjdGFuZ2xlOiAxOSwKICBzdHJva2U6IDIwLAogIGNsb3NlU3Ryb2tlOiAyMSwKICBmaWxsOiAyMiwKICBlb0ZpbGw6IDIzLAogIGZpbGxTdHJva2U6IDI0LAogIGVvRmlsbFN0cm9rZTogMjUsCiAgY2xvc2VGaWxsU3Ryb2tlOiAyNiwKICBjbG9zZUVPRmlsbFN0cm9rZTogMjcsCiAgZW5kUGF0aDogMjgsCiAgY2xpcDogMjksCiAgZW9DbGlwOiAzMCwKICBiZWdpblRleHQ6IDMxLAogIGVuZFRleHQ6IDMyLAogIHNldENoYXJTcGFjaW5nOiAzMywKICBzZXRXb3JkU3BhY2luZzogMzQsCiAgc2V0SFNjYWxlOiAzNSwKICBzZXRMZWFkaW5nOiAzNiwKICBzZXRGb250OiAzNywKICBzZXRUZXh0UmVuZGVyaW5nTW9kZTogMzgsCiAgc2V0VGV4dFJpc2U6IDM5LAogIG1vdmVUZXh0OiA0MCwKICBzZXRMZWFkaW5nTW92ZVRleHQ6IDQxLAogIHNldFRleHRNYXRyaXg6IDQyLAogIG5leHRMaW5lOiA0MywKICBzaG93VGV4dDogNDQsCiAgc2hvd1NwYWNlZFRleHQ6IDQ1LAogIG5leHRMaW5lU2hvd1RleHQ6IDQ2LAogIG5leHRMaW5lU2V0U3BhY2luZ1Nob3dUZXh0OiA0NywKICBzZXRDaGFyV2lkdGg6IDQ4LAogIHNldENoYXJXaWR0aEFuZEJvdW5kczogNDksCiAgc2V0U3Ryb2tlQ29sb3JTcGFjZTogNTAsCiAgc2V0RmlsbENvbG9yU3BhY2U6IDUxLAogIHNldFN0cm9rZUNvbG9yOiA1MiwKICBzZXRTdHJva2VDb2xvck46IDUzLAogIHNldEZpbGxDb2xvcjogNTQsCiAgc2V0RmlsbENvbG9yTjogNTUsCiAgc2V0U3Ryb2tlR3JheTogNTYsCiAgc2V0RmlsbEdyYXk6IDU3LAogIHNldFN0cm9rZVJHQkNvbG9yOiA1OCwKICBzZXRGaWxsUkdCQ29sb3I6IDU5LAogIHNldFN0cm9rZUNNWUtDb2xvcjogNjAsCiAgc2V0RmlsbENNWUtDb2xvcjogNjEsCiAgc2hhZGluZ0ZpbGw6IDYyLAogIGJlZ2luSW5saW5lSW1hZ2U6IDYzLAogIGJlZ2luSW1hZ2VEYXRhOiA2NCwKICBlbmRJbmxpbmVJbWFnZTogNjUsCiAgcGFpbnRYT2JqZWN0OiA2NiwKICBtYXJrUG9pbnQ6IDY3LAogIG1hcmtQb2ludFByb3BzOiA2OCwKICBiZWdpbk1hcmtlZENvbnRlbnQ6IDY5LAogIGJlZ2luTWFya2VkQ29udGVudFByb3BzOiA3MCwKICBlbmRNYXJrZWRDb250ZW50OiA3MSwKICBiZWdpbkNvbXBhdDogNzIsCiAgZW5kQ29tcGF0OiA3MywKICBwYWludEZvcm1YT2JqZWN0QmVnaW46IDc0LAogIHBhaW50Rm9ybVhPYmplY3RFbmQ6IDc1LAogIGJlZ2luR3JvdXA6IDc2LAogIGVuZEdyb3VwOiA3NywKICBiZWdpbkFubm90YXRpb25zOiA3OCwKICBlbmRBbm5vdGF0aW9uczogNzksCiAgYmVnaW5Bbm5vdGF0aW9uOiA4MCwKICBlbmRBbm5vdGF0aW9uOiA4MSwKICBwYWludEpwZWdYT2JqZWN0OiA4MiwKICBwYWludEltYWdlTWFza1hPYmplY3Q6IDgzLAogIHBhaW50SW1hZ2VNYXNrWE9iamVjdEdyb3VwOiA4NCwKICBwYWludEltYWdlWE9iamVjdDogODUsCiAgcGFpbnRJbmxpbmVJbWFnZVhPYmplY3Q6IDg2LAogIHBhaW50SW5saW5lSW1hZ2VYT2JqZWN0R3JvdXA6IDg3LAogIHBhaW50SW1hZ2VYT2JqZWN0UmVwZWF0OiA4OCwKICBwYWludEltYWdlTWFza1hPYmplY3RSZXBlYXQ6IDg5LAogIHBhaW50U29saWRDb2xvckltYWdlTWFzazogOTAsCiAgY29uc3RydWN0UGF0aDogOTEKfTsKZXhwb3J0cy5PUFMgPSBPUFM7CmNvbnN0IFVOU1VQUE9SVEVEX0ZFQVRVUkVTID0gewogIHVua25vd246ICJ1bmtub3duIiwKICBmb3JtczogImZvcm1zIiwKICBqYXZhU2NyaXB0OiAiamF2YVNjcmlwdCIsCiAgc2lnbmF0dXJlczogInNpZ25hdHVyZXMiLAogIHNtYXNrOiAic21hc2siLAogIHNoYWRpbmdQYXR0ZXJuOiAic2hhZGluZ1BhdHRlcm4iLAogIGZvbnQ6ICJmb250IiwKICBlcnJvclRpbGluZ1BhdHRlcm46ICJlcnJvclRpbGluZ1BhdHRlcm4iLAogIGVycm9yRXh0R1N0YXRlOiAiZXJyb3JFeHRHU3RhdGUiLAogIGVycm9yWE9iamVjdDogImVycm9yWE9iamVjdCIsCiAgZXJyb3JGb250TG9hZFR5cGUzOiAiZXJyb3JGb250TG9hZFR5cGUzIiwKICBlcnJvckZvbnRTdGF0ZTogImVycm9yRm9udFN0YXRlIiwKICBlcnJvckZvbnRNaXNzaW5nOiAiZXJyb3JGb250TWlzc2luZyIsCiAgZXJyb3JGb250VHJhbnNsYXRlOiAiZXJyb3JGb250VHJhbnNsYXRlIiwKICBlcnJvckNvbG9yU3BhY2U6ICJlcnJvckNvbG9yU3BhY2UiLAogIGVycm9yT3BlcmF0b3JMaXN0OiAiZXJyb3JPcGVyYXRvckxpc3QiLAogIGVycm9yRm9udFRvVW5pY29kZTogImVycm9yRm9udFRvVW5pY29kZSIsCiAgZXJyb3JGb250TG9hZE5hdGl2ZTogImVycm9yRm9udExvYWROYXRpdmUiLAogIGVycm9yRm9udEJ1aWxkUGF0aDogImVycm9yRm9udEJ1aWxkUGF0aCIsCiAgZXJyb3JGb250R2V0UGF0aDogImVycm9yRm9udEdldFBhdGgiLAogIGVycm9yTWFya2VkQ29udGVudDogImVycm9yTWFya2VkQ29udGVudCIsCiAgZXJyb3JDb250ZW50U3ViU3RyZWFtOiAiZXJyb3JDb250ZW50U3ViU3RyZWFtIgp9OwpleHBvcnRzLlVOU1VQUE9SVEVEX0ZFQVRVUkVTID0gVU5TVVBQT1JURURfRkVBVFVSRVM7CmNvbnN0IFBhc3N3b3JkUmVzcG9uc2VzID0gewogIE5FRURfUEFTU1dPUkQ6IDEsCiAgSU5DT1JSRUNUX1BBU1NXT1JEOiAyCn07CmV4cG9ydHMuUGFzc3dvcmRSZXNwb25zZXMgPSBQYXNzd29yZFJlc3BvbnNlczsKbGV0IHZlcmJvc2l0eSA9IFZlcmJvc2l0eUxldmVsLldBUk5JTkdTOwoKZnVuY3Rpb24gc2V0VmVyYm9zaXR5TGV2ZWwobGV2ZWwpIHsKICBpZiAoTnVtYmVyLmlzSW50ZWdlcihsZXZlbCkpIHsKICAgIHZlcmJvc2l0eSA9IGxldmVsOwogIH0KfQoKZnVuY3Rpb24gZ2V0VmVyYm9zaXR5TGV2ZWwoKSB7CiAgcmV0dXJuIHZlcmJvc2l0eTsKfQoKZnVuY3Rpb24gaW5mbyhtc2cpIHsKICBpZiAodmVyYm9zaXR5ID49IFZlcmJvc2l0eUxldmVsLklORk9TKSB7CiAgICBjb25zb2xlLmxvZyhgSW5mbzogJHttc2d9YCk7CiAgfQp9CgpmdW5jdGlvbiB3YXJuKG1zZykgewogIGlmICh2ZXJib3NpdHkgPj0gVmVyYm9zaXR5TGV2ZWwuV0FSTklOR1MpIHsKICAgIGNvbnNvbGUubG9nKGBXYXJuaW5nOiAke21zZ31gKTsKICB9Cn0KCmZ1bmN0aW9uIHVucmVhY2hhYmxlKG1zZykgewogIHRocm93IG5ldyBFcnJvcihtc2cpOwp9CgpmdW5jdGlvbiBhc3NlcnQoY29uZCwgbXNnKSB7CiAgaWYgKCFjb25kKSB7CiAgICB1bnJlYWNoYWJsZShtc2cpOwogIH0KfQoKZnVuY3Rpb24gX2lzVmFsaWRQcm90b2NvbCh1cmwpIHsKICBpZiAoIXVybCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgc3dpdGNoICh1cmwucHJvdG9jb2wpIHsKICAgIGNhc2UgImh0dHA6IjoKICAgIGNhc2UgImh0dHBzOiI6CiAgICBjYXNlICJmdHA6IjoKICAgIGNhc2UgIm1haWx0bzoiOgogICAgY2FzZSAidGVsOiI6CiAgICAgIHJldHVybiB0cnVlOwoKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiBmYWxzZTsKICB9Cn0KCmZ1bmN0aW9uIGNyZWF0ZVZhbGlkQWJzb2x1dGVVcmwodXJsKSB7CiAgbGV0IGJhc2VVcmwgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IG51bGw7CiAgbGV0IG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IG51bGw7CgogIGlmICghdXJsKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIHRyeSB7CiAgICBpZiAob3B0aW9ucyAmJiB0eXBlb2YgdXJsID09PSAic3RyaW5nIikgewogICAgICBpZiAob3B0aW9ucy5hZGREZWZhdWx0UHJvdG9jb2wgJiYgdXJsLnN0YXJ0c1dpdGgoInd3dy4iKSkgewogICAgICAgIGNvbnN0IGRvdHMgPSB1cmwubWF0Y2goL1wuL2cpOwoKICAgICAgICBpZiAoZG90cyAmJiBkb3RzLmxlbmd0aCA+PSAyKSB7CiAgICAgICAgICB1cmwgPSBgaHR0cDovLyR7dXJsfWA7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAob3B0aW9ucy50cnlDb252ZXJ0RW5jb2RpbmcpIHsKICAgICAgICB0cnkgewogICAgICAgICAgdXJsID0gc3RyaW5nVG9VVEY4U3RyaW5nKHVybCk7CiAgICAgICAgfSBjYXRjaCAoZXgpIHt9CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBhYnNvbHV0ZVVybCA9IGJhc2VVcmwgPyBuZXcgVVJMKHVybCwgYmFzZVVybCkgOiBuZXcgVVJMKHVybCk7CgogICAgaWYgKF9pc1ZhbGlkUHJvdG9jb2woYWJzb2x1dGVVcmwpKSB7CiAgICAgIHJldHVybiBhYnNvbHV0ZVVybDsKICAgIH0KICB9IGNhdGNoIChleCkge30KCiAgcmV0dXJuIG51bGw7Cn0KCmZ1bmN0aW9uIHNoYWRvdyhvYmosIHByb3AsIHZhbHVlKSB7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgcHJvcCwgewogICAgdmFsdWUsCiAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgd3JpdGFibGU6IGZhbHNlCiAgfSk7CiAgcmV0dXJuIHZhbHVlOwp9Cgpjb25zdCBCYXNlRXhjZXB0aW9uID0gZnVuY3Rpb24gQmFzZUV4Y2VwdGlvbkNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQmFzZUV4Y2VwdGlvbihtZXNzYWdlLCBuYW1lKSB7CiAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gQmFzZUV4Y2VwdGlvbikgewogICAgICB1bnJlYWNoYWJsZSgiQ2Fubm90IGluaXRpYWxpemUgQmFzZUV4Y2VwdGlvbi4iKTsKICAgIH0KCiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlOwogICAgdGhpcy5uYW1lID0gbmFtZTsKICB9CgogIEJhc2VFeGNlcHRpb24ucHJvdG90eXBlID0gbmV3IEVycm9yKCk7CiAgQmFzZUV4Y2VwdGlvbi5jb25zdHJ1Y3RvciA9IEJhc2VFeGNlcHRpb247CiAgcmV0dXJuIEJhc2VFeGNlcHRpb247Cn0oKTsKCmV4cG9ydHMuQmFzZUV4Y2VwdGlvbiA9IEJhc2VFeGNlcHRpb247CgpjbGFzcyBQYXNzd29yZEV4Y2VwdGlvbiBleHRlbmRzIEJhc2VFeGNlcHRpb24gewogIGNvbnN0cnVjdG9yKG1zZywgY29kZSkgewogICAgc3VwZXIobXNnLCAiUGFzc3dvcmRFeGNlcHRpb24iKTsKICAgIHRoaXMuY29kZSA9IGNvZGU7CiAgfQoKfQoKZXhwb3J0cy5QYXNzd29yZEV4Y2VwdGlvbiA9IFBhc3N3b3JkRXhjZXB0aW9uOwoKY2xhc3MgVW5rbm93bkVycm9yRXhjZXB0aW9uIGV4dGVuZHMgQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnLCBkZXRhaWxzKSB7CiAgICBzdXBlcihtc2csICJVbmtub3duRXJyb3JFeGNlcHRpb24iKTsKICAgIHRoaXMuZGV0YWlscyA9IGRldGFpbHM7CiAgfQoKfQoKZXhwb3J0cy5Vbmtub3duRXJyb3JFeGNlcHRpb24gPSBVbmtub3duRXJyb3JFeGNlcHRpb247CgpjbGFzcyBJbnZhbGlkUERGRXhjZXB0aW9uIGV4dGVuZHMgQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihtc2csICJJbnZhbGlkUERGRXhjZXB0aW9uIik7CiAgfQoKfQoKZXhwb3J0cy5JbnZhbGlkUERGRXhjZXB0aW9uID0gSW52YWxpZFBERkV4Y2VwdGlvbjsKCmNsYXNzIE1pc3NpbmdQREZFeGNlcHRpb24gZXh0ZW5kcyBCYXNlRXhjZXB0aW9uIHsKICBjb25zdHJ1Y3Rvcihtc2cpIHsKICAgIHN1cGVyKG1zZywgIk1pc3NpbmdQREZFeGNlcHRpb24iKTsKICB9Cgp9CgpleHBvcnRzLk1pc3NpbmdQREZFeGNlcHRpb24gPSBNaXNzaW5nUERGRXhjZXB0aW9uOwoKY2xhc3MgVW5leHBlY3RlZFJlc3BvbnNlRXhjZXB0aW9uIGV4dGVuZHMgQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnLCBzdGF0dXMpIHsKICAgIHN1cGVyKG1zZywgIlVuZXhwZWN0ZWRSZXNwb25zZUV4Y2VwdGlvbiIpOwogICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7CiAgfQoKfQoKZXhwb3J0cy5VbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb24gPSBVbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb247CgpjbGFzcyBGb3JtYXRFcnJvciBleHRlbmRzIEJhc2VFeGNlcHRpb24gewogIGNvbnN0cnVjdG9yKG1zZykgewogICAgc3VwZXIobXNnLCAiRm9ybWF0RXJyb3IiKTsKICB9Cgp9CgpleHBvcnRzLkZvcm1hdEVycm9yID0gRm9ybWF0RXJyb3I7CgpjbGFzcyBBYm9ydEV4Y2VwdGlvbiBleHRlbmRzIEJhc2VFeGNlcHRpb24gewogIGNvbnN0cnVjdG9yKG1zZykgewogICAgc3VwZXIobXNnLCAiQWJvcnRFeGNlcHRpb24iKTsKICB9Cgp9CgpleHBvcnRzLkFib3J0RXhjZXB0aW9uID0gQWJvcnRFeGNlcHRpb247CgpmdW5jdGlvbiBieXRlc1RvU3RyaW5nKGJ5dGVzKSB7CiAgaWYgKHR5cGVvZiBieXRlcyAhPT0gIm9iamVjdCIgfHwgYnl0ZXMgPT09IG51bGwgfHwgYnl0ZXMubGVuZ3RoID09PSB1bmRlZmluZWQpIHsKICAgIHVucmVhY2hhYmxlKCJJbnZhbGlkIGFyZ3VtZW50IGZvciBieXRlc1RvU3RyaW5nIik7CiAgfQoKICBjb25zdCBsZW5ndGggPSBieXRlcy5sZW5ndGg7CiAgY29uc3QgTUFYX0FSR1VNRU5UX0NPVU5UID0gODE5MjsKCiAgaWYgKGxlbmd0aCA8IE1BWF9BUkdVTUVOVF9DT1VOVCkgewogICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgYnl0ZXMpOwogIH0KCiAgY29uc3Qgc3RyQnVmID0gW107CgogIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IE1BWF9BUkdVTUVOVF9DT1VOVCkgewogICAgY29uc3QgY2h1bmtFbmQgPSBNYXRoLm1pbihpICsgTUFYX0FSR1VNRU5UX0NPVU5ULCBsZW5ndGgpOwogICAgY29uc3QgY2h1bmsgPSBieXRlcy5zdWJhcnJheShpLCBjaHVua0VuZCk7CiAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGNodW5rKSk7CiAgfQoKICByZXR1cm4gc3RyQnVmLmpvaW4oIiIpOwp9CgpmdW5jdGlvbiBzdHJpbmdUb0J5dGVzKHN0cikgewogIGlmICh0eXBlb2Ygc3RyICE9PSAic3RyaW5nIikgewogICAgdW5yZWFjaGFibGUoIkludmFsaWQgYXJndW1lbnQgZm9yIHN0cmluZ1RvQnl0ZXMiKTsKICB9CgogIGNvbnN0IGxlbmd0aCA9IHN0ci5sZW5ndGg7CiAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShsZW5ndGgpOwoKICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICBieXRlc1tpXSA9IHN0ci5jaGFyQ29kZUF0KGkpICYgMHhmZjsKICB9CgogIHJldHVybiBieXRlczsKfQoKZnVuY3Rpb24gYXJyYXlCeXRlTGVuZ3RoKGFycikgewogIGlmIChhcnIubGVuZ3RoICE9PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBhcnIubGVuZ3RoOwogIH0KCiAgaWYgKGFyci5ieXRlTGVuZ3RoICE9PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBhcnIuYnl0ZUxlbmd0aDsKICB9CgogIHVucmVhY2hhYmxlKCJJbnZhbGlkIGFyZ3VtZW50IGZvciBhcnJheUJ5dGVMZW5ndGgiKTsKfQoKZnVuY3Rpb24gYXJyYXlzVG9CeXRlcyhhcnIpIHsKICBjb25zdCBsZW5ndGggPSBhcnIubGVuZ3RoOwoKICBpZiAobGVuZ3RoID09PSAxICYmIGFyclswXSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsKICAgIHJldHVybiBhcnJbMF07CiAgfQoKICBsZXQgcmVzdWx0TGVuZ3RoID0gMDsKCiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgcmVzdWx0TGVuZ3RoICs9IGFycmF5Qnl0ZUxlbmd0aChhcnJbaV0pOwogIH0KCiAgbGV0IHBvcyA9IDA7CiAgY29uc3QgZGF0YSA9IG5ldyBVaW50OEFycmF5KHJlc3VsdExlbmd0aCk7CgogIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgIGxldCBpdGVtID0gYXJyW2ldOwoKICAgIGlmICghKGl0ZW0gaW5zdGFuY2VvZiBVaW50OEFycmF5KSkgewogICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgaXRlbSA9IHN0cmluZ1RvQnl0ZXMoaXRlbSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaXRlbSA9IG5ldyBVaW50OEFycmF5KGl0ZW0pOwogICAgICB9CiAgICB9CgogICAgY29uc3QgaXRlbUxlbmd0aCA9IGl0ZW0uYnl0ZUxlbmd0aDsKICAgIGRhdGEuc2V0KGl0ZW0sIHBvcyk7CiAgICBwb3MgKz0gaXRlbUxlbmd0aDsKICB9CgogIHJldHVybiBkYXRhOwp9CgpmdW5jdGlvbiBzdHJpbmczMih2YWx1ZSkgewogIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHZhbHVlID4+IDI0ICYgMHhmZiwgdmFsdWUgPj4gMTYgJiAweGZmLCB2YWx1ZSA+PiA4ICYgMHhmZiwgdmFsdWUgJiAweGZmKTsKfQoKZnVuY3Rpb24gb2JqZWN0U2l6ZShvYmopIHsKICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5sZW5ndGg7Cn0KCmZ1bmN0aW9uIG9iamVjdEZyb21NYXAobWFwKSB7CiAgY29uc3Qgb2JqID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgbWFwKSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gaXNMaXR0bGVFbmRpYW4oKSB7CiAgY29uc3QgYnVmZmVyOCA9IG5ldyBVaW50OEFycmF5KDQpOwogIGJ1ZmZlcjhbMF0gPSAxOwogIGNvbnN0IHZpZXczMiA9IG5ldyBVaW50MzJBcnJheShidWZmZXI4LmJ1ZmZlciwgMCwgMSk7CiAgcmV0dXJuIHZpZXczMlswXSA9PT0gMTsKfQoKZnVuY3Rpb24gaXNFdmFsU3VwcG9ydGVkKCkgewogIHRyeSB7CiAgICBuZXcgRnVuY3Rpb24oIiIpOwogICAgcmV0dXJuIHRydWU7CiAgfSBjYXRjaCAoZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKY2xhc3MgRmVhdHVyZVRlc3QgewogIHN0YXRpYyBnZXQgaXNMaXR0bGVFbmRpYW4oKSB7CiAgICByZXR1cm4gc2hhZG93KHRoaXMsICJpc0xpdHRsZUVuZGlhbiIsIGlzTGl0dGxlRW5kaWFuKCkpOwogIH0KCiAgc3RhdGljIGdldCBpc0V2YWxTdXBwb3J0ZWQoKSB7CiAgICByZXR1cm4gc2hhZG93KHRoaXMsICJpc0V2YWxTdXBwb3J0ZWQiLCBpc0V2YWxTdXBwb3J0ZWQoKSk7CiAgfQoKICBzdGF0aWMgZ2V0IGlzT2Zmc2NyZWVuQ2FudmFzU3VwcG9ydGVkKCkgewogICAgcmV0dXJuIHNoYWRvdyh0aGlzLCAiaXNPZmZzY3JlZW5DYW52YXNTdXBwb3J0ZWQiLCB0eXBlb2YgT2Zmc2NyZWVuQ2FudmFzICE9PSAidW5kZWZpbmVkIik7CiAgfQoKfQoKZXhwb3J0cy5GZWF0dXJlVGVzdCA9IEZlYXR1cmVUZXN0Owpjb25zdCBoZXhOdW1iZXJzID0gWy4uLkFycmF5KDI1Nikua2V5cygpXS5tYXAobiA9PiBuLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAiMCIpKTsKCmNsYXNzIFV0aWwgewogIHN0YXRpYyBtYWtlSGV4Q29sb3IociwgZywgYikgewogICAgcmV0dXJuIGAjJHtoZXhOdW1iZXJzW3JdfSR7aGV4TnVtYmVyc1tnXX0ke2hleE51bWJlcnNbYl19YDsKICB9CgogIHN0YXRpYyBzY2FsZU1pbk1heCh0cmFuc2Zvcm0sIG1pbk1heCkgewogICAgbGV0IHRlbXA7CgogICAgaWYgKHRyYW5zZm9ybVswXSkgewogICAgICBpZiAodHJhbnNmb3JtWzBdIDwgMCkgewogICAgICAgIHRlbXAgPSBtaW5NYXhbMF07CiAgICAgICAgbWluTWF4WzBdID0gbWluTWF4WzFdOwogICAgICAgIG1pbk1heFsxXSA9IHRlbXA7CiAgICAgIH0KCiAgICAgIG1pbk1heFswXSAqPSB0cmFuc2Zvcm1bMF07CiAgICAgIG1pbk1heFsxXSAqPSB0cmFuc2Zvcm1bMF07CgogICAgICBpZiAodHJhbnNmb3JtWzNdIDwgMCkgewogICAgICAgIHRlbXAgPSBtaW5NYXhbMl07CiAgICAgICAgbWluTWF4WzJdID0gbWluTWF4WzNdOwogICAgICAgIG1pbk1heFszXSA9IHRlbXA7CiAgICAgIH0KCiAgICAgIG1pbk1heFsyXSAqPSB0cmFuc2Zvcm1bM107CiAgICAgIG1pbk1heFszXSAqPSB0cmFuc2Zvcm1bM107CiAgICB9IGVsc2UgewogICAgICB0ZW1wID0gbWluTWF4WzBdOwogICAgICBtaW5NYXhbMF0gPSBtaW5NYXhbMl07CiAgICAgIG1pbk1heFsyXSA9IHRlbXA7CiAgICAgIHRlbXAgPSBtaW5NYXhbMV07CiAgICAgIG1pbk1heFsxXSA9IG1pbk1heFszXTsKICAgICAgbWluTWF4WzNdID0gdGVtcDsKCiAgICAgIGlmICh0cmFuc2Zvcm1bMV0gPCAwKSB7CiAgICAgICAgdGVtcCA9IG1pbk1heFsyXTsKICAgICAgICBtaW5NYXhbMl0gPSBtaW5NYXhbM107CiAgICAgICAgbWluTWF4WzNdID0gdGVtcDsKICAgICAgfQoKICAgICAgbWluTWF4WzJdICo9IHRyYW5zZm9ybVsxXTsKICAgICAgbWluTWF4WzNdICo9IHRyYW5zZm9ybVsxXTsKCiAgICAgIGlmICh0cmFuc2Zvcm1bMl0gPCAwKSB7CiAgICAgICAgdGVtcCA9IG1pbk1heFswXTsKICAgICAgICBtaW5NYXhbMF0gPSBtaW5NYXhbMV07CiAgICAgICAgbWluTWF4WzFdID0gdGVtcDsKICAgICAgfQoKICAgICAgbWluTWF4WzBdICo9IHRyYW5zZm9ybVsyXTsKICAgICAgbWluTWF4WzFdICo9IHRyYW5zZm9ybVsyXTsKICAgIH0KCiAgICBtaW5NYXhbMF0gKz0gdHJhbnNmb3JtWzRdOwogICAgbWluTWF4WzFdICs9IHRyYW5zZm9ybVs0XTsKICAgIG1pbk1heFsyXSArPSB0cmFuc2Zvcm1bNV07CiAgICBtaW5NYXhbM10gKz0gdHJhbnNmb3JtWzVdOwogIH0KCiAgc3RhdGljIHRyYW5zZm9ybShtMSwgbTIpIHsKICAgIHJldHVybiBbbTFbMF0gKiBtMlswXSArIG0xWzJdICogbTJbMV0sIG0xWzFdICogbTJbMF0gKyBtMVszXSAqIG0yWzFdLCBtMVswXSAqIG0yWzJdICsgbTFbMl0gKiBtMlszXSwgbTFbMV0gKiBtMlsyXSArIG0xWzNdICogbTJbM10sIG0xWzBdICogbTJbNF0gKyBtMVsyXSAqIG0yWzVdICsgbTFbNF0sIG0xWzFdICogbTJbNF0gKyBtMVszXSAqIG0yWzVdICsgbTFbNV1dOwogIH0KCiAgc3RhdGljIGFwcGx5VHJhbnNmb3JtKHAsIG0pIHsKICAgIGNvbnN0IHh0ID0gcFswXSAqIG1bMF0gKyBwWzFdICogbVsyXSArIG1bNF07CiAgICBjb25zdCB5dCA9IHBbMF0gKiBtWzFdICsgcFsxXSAqIG1bM10gKyBtWzVdOwogICAgcmV0dXJuIFt4dCwgeXRdOwogIH0KCiAgc3RhdGljIGFwcGx5SW52ZXJzZVRyYW5zZm9ybShwLCBtKSB7CiAgICBjb25zdCBkID0gbVswXSAqIG1bM10gLSBtWzFdICogbVsyXTsKICAgIGNvbnN0IHh0ID0gKHBbMF0gKiBtWzNdIC0gcFsxXSAqIG1bMl0gKyBtWzJdICogbVs1XSAtIG1bNF0gKiBtWzNdKSAvIGQ7CiAgICBjb25zdCB5dCA9ICgtcFswXSAqIG1bMV0gKyBwWzFdICogbVswXSArIG1bNF0gKiBtWzFdIC0gbVs1XSAqIG1bMF0pIC8gZDsKICAgIHJldHVybiBbeHQsIHl0XTsKICB9CgogIHN0YXRpYyBnZXRBeGlhbEFsaWduZWRCb3VuZGluZ0JveChyLCBtKSB7CiAgICBjb25zdCBwMSA9IFV0aWwuYXBwbHlUcmFuc2Zvcm0ociwgbSk7CiAgICBjb25zdCBwMiA9IFV0aWwuYXBwbHlUcmFuc2Zvcm0oci5zbGljZSgyLCA0KSwgbSk7CiAgICBjb25zdCBwMyA9IFV0aWwuYXBwbHlUcmFuc2Zvcm0oW3JbMF0sIHJbM11dLCBtKTsKICAgIGNvbnN0IHA0ID0gVXRpbC5hcHBseVRyYW5zZm9ybShbclsyXSwgclsxXV0sIG0pOwogICAgcmV0dXJuIFtNYXRoLm1pbihwMVswXSwgcDJbMF0sIHAzWzBdLCBwNFswXSksIE1hdGgubWluKHAxWzFdLCBwMlsxXSwgcDNbMV0sIHA0WzFdKSwgTWF0aC5tYXgocDFbMF0sIHAyWzBdLCBwM1swXSwgcDRbMF0pLCBNYXRoLm1heChwMVsxXSwgcDJbMV0sIHAzWzFdLCBwNFsxXSldOwogIH0KCiAgc3RhdGljIGludmVyc2VUcmFuc2Zvcm0obSkgewogICAgY29uc3QgZCA9IG1bMF0gKiBtWzNdIC0gbVsxXSAqIG1bMl07CiAgICByZXR1cm4gW21bM10gLyBkLCAtbVsxXSAvIGQsIC1tWzJdIC8gZCwgbVswXSAvIGQsIChtWzJdICogbVs1XSAtIG1bNF0gKiBtWzNdKSAvIGQsIChtWzRdICogbVsxXSAtIG1bNV0gKiBtWzBdKSAvIGRdOwogIH0KCiAgc3RhdGljIGFwcGx5M2RUcmFuc2Zvcm0obSwgdikgewogICAgcmV0dXJuIFttWzBdICogdlswXSArIG1bMV0gKiB2WzFdICsgbVsyXSAqIHZbMl0sIG1bM10gKiB2WzBdICsgbVs0XSAqIHZbMV0gKyBtWzVdICogdlsyXSwgbVs2XSAqIHZbMF0gKyBtWzddICogdlsxXSArIG1bOF0gKiB2WzJdXTsKICB9CgogIHN0YXRpYyBzaW5ndWxhclZhbHVlRGVjb21wb3NlMmRTY2FsZShtKSB7CiAgICBjb25zdCB0cmFuc3Bvc2UgPSBbbVswXSwgbVsyXSwgbVsxXSwgbVszXV07CiAgICBjb25zdCBhID0gbVswXSAqIHRyYW5zcG9zZVswXSArIG1bMV0gKiB0cmFuc3Bvc2VbMl07CiAgICBjb25zdCBiID0gbVswXSAqIHRyYW5zcG9zZVsxXSArIG1bMV0gKiB0cmFuc3Bvc2VbM107CiAgICBjb25zdCBjID0gbVsyXSAqIHRyYW5zcG9zZVswXSArIG1bM10gKiB0cmFuc3Bvc2VbMl07CiAgICBjb25zdCBkID0gbVsyXSAqIHRyYW5zcG9zZVsxXSArIG1bM10gKiB0cmFuc3Bvc2VbM107CiAgICBjb25zdCBmaXJzdCA9IChhICsgZCkgLyAyOwogICAgY29uc3Qgc2Vjb25kID0gTWF0aC5zcXJ0KChhICsgZCkgKiogMiAtIDQgKiAoYSAqIGQgLSBjICogYikpIC8gMjsKICAgIGNvbnN0IHN4ID0gZmlyc3QgKyBzZWNvbmQgfHwgMTsKICAgIGNvbnN0IHN5ID0gZmlyc3QgLSBzZWNvbmQgfHwgMTsKICAgIHJldHVybiBbTWF0aC5zcXJ0KHN4KSwgTWF0aC5zcXJ0KHN5KV07CiAgfQoKICBzdGF0aWMgbm9ybWFsaXplUmVjdChyZWN0KSB7CiAgICBjb25zdCByID0gcmVjdC5zbGljZSgwKTsKCiAgICBpZiAocmVjdFswXSA+IHJlY3RbMl0pIHsKICAgICAgclswXSA9IHJlY3RbMl07CiAgICAgIHJbMl0gPSByZWN0WzBdOwogICAgfQoKICAgIGlmIChyZWN0WzFdID4gcmVjdFszXSkgewogICAgICByWzFdID0gcmVjdFszXTsKICAgICAgclszXSA9IHJlY3RbMV07CiAgICB9CgogICAgcmV0dXJuIHI7CiAgfQoKICBzdGF0aWMgaW50ZXJzZWN0KHJlY3QxLCByZWN0MikgewogICAgY29uc3QgeExvdyA9IE1hdGgubWF4KE1hdGgubWluKHJlY3QxWzBdLCByZWN0MVsyXSksIE1hdGgubWluKHJlY3QyWzBdLCByZWN0MlsyXSkpOwogICAgY29uc3QgeEhpZ2ggPSBNYXRoLm1pbihNYXRoLm1heChyZWN0MVswXSwgcmVjdDFbMl0pLCBNYXRoLm1heChyZWN0MlswXSwgcmVjdDJbMl0pKTsKCiAgICBpZiAoeExvdyA+IHhIaWdoKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHlMb3cgPSBNYXRoLm1heChNYXRoLm1pbihyZWN0MVsxXSwgcmVjdDFbM10pLCBNYXRoLm1pbihyZWN0MlsxXSwgcmVjdDJbM10pKTsKICAgIGNvbnN0IHlIaWdoID0gTWF0aC5taW4oTWF0aC5tYXgocmVjdDFbMV0sIHJlY3QxWzNdKSwgTWF0aC5tYXgocmVjdDJbMV0sIHJlY3QyWzNdKSk7CgogICAgaWYgKHlMb3cgPiB5SGlnaCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICByZXR1cm4gW3hMb3csIHlMb3csIHhIaWdoLCB5SGlnaF07CiAgfQoKICBzdGF0aWMgYmV6aWVyQm91bmRpbmdCb3goeDAsIHkwLCB4MSwgeTEsIHgyLCB5MiwgeDMsIHkzKSB7CiAgICBjb25zdCB0dmFsdWVzID0gW10sCiAgICAgICAgICBib3VuZHMgPSBbW10sIFtdXTsKICAgIGxldCBhLCBiLCBjLCB0LCB0MSwgdDIsIGIyYWMsIHNxcnRiMmFjOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjsgKytpKSB7CiAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgYiA9IDYgKiB4MCAtIDEyICogeDEgKyA2ICogeDI7CiAgICAgICAgYSA9IC0zICogeDAgKyA5ICogeDEgLSA5ICogeDIgKyAzICogeDM7CiAgICAgICAgYyA9IDMgKiB4MSAtIDMgKiB4MDsKICAgICAgfSBlbHNlIHsKICAgICAgICBiID0gNiAqIHkwIC0gMTIgKiB5MSArIDYgKiB5MjsKICAgICAgICBhID0gLTMgKiB5MCArIDkgKiB5MSAtIDkgKiB5MiArIDMgKiB5MzsKICAgICAgICBjID0gMyAqIHkxIC0gMyAqIHkwOwogICAgICB9CgogICAgICBpZiAoTWF0aC5hYnMoYSkgPCAxZS0xMikgewogICAgICAgIGlmIChNYXRoLmFicyhiKSA8IDFlLTEyKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHQgPSAtYyAvIGI7CgogICAgICAgIGlmICgwIDwgdCAmJiB0IDwgMSkgewogICAgICAgICAgdHZhbHVlcy5wdXNoKHQpOwogICAgICAgIH0KCiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGIyYWMgPSBiICogYiAtIDQgKiBjICogYTsKICAgICAgc3FydGIyYWMgPSBNYXRoLnNxcnQoYjJhYyk7CgogICAgICBpZiAoYjJhYyA8IDApIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdDEgPSAoLWIgKyBzcXJ0YjJhYykgLyAoMiAqIGEpOwoKICAgICAgaWYgKDAgPCB0MSAmJiB0MSA8IDEpIHsKICAgICAgICB0dmFsdWVzLnB1c2godDEpOwogICAgICB9CgogICAgICB0MiA9ICgtYiAtIHNxcnRiMmFjKSAvICgyICogYSk7CgogICAgICBpZiAoMCA8IHQyICYmIHQyIDwgMSkgewogICAgICAgIHR2YWx1ZXMucHVzaCh0Mik7CiAgICAgIH0KICAgIH0KCiAgICBsZXQgaiA9IHR2YWx1ZXMubGVuZ3RoLAogICAgICAgIG10OwogICAgY29uc3QgamxlbiA9IGo7CgogICAgd2hpbGUgKGotLSkgewogICAgICB0ID0gdHZhbHVlc1tqXTsKICAgICAgbXQgPSAxIC0gdDsKICAgICAgYm91bmRzWzBdW2pdID0gbXQgKiBtdCAqIG10ICogeDAgKyAzICogbXQgKiBtdCAqIHQgKiB4MSArIDMgKiBtdCAqIHQgKiB0ICogeDIgKyB0ICogdCAqIHQgKiB4MzsKICAgICAgYm91bmRzWzFdW2pdID0gbXQgKiBtdCAqIG10ICogeTAgKyAzICogbXQgKiBtdCAqIHQgKiB5MSArIDMgKiBtdCAqIHQgKiB0ICogeTIgKyB0ICogdCAqIHQgKiB5MzsKICAgIH0KCiAgICBib3VuZHNbMF1bamxlbl0gPSB4MDsKICAgIGJvdW5kc1sxXVtqbGVuXSA9IHkwOwogICAgYm91bmRzWzBdW2psZW4gKyAxXSA9IHgzOwogICAgYm91bmRzWzFdW2psZW4gKyAxXSA9IHkzOwogICAgYm91bmRzWzBdLmxlbmd0aCA9IGJvdW5kc1sxXS5sZW5ndGggPSBqbGVuICsgMjsKICAgIHJldHVybiBbTWF0aC5taW4oLi4uYm91bmRzWzBdKSwgTWF0aC5taW4oLi4uYm91bmRzWzFdKSwgTWF0aC5tYXgoLi4uYm91bmRzWzBdKSwgTWF0aC5tYXgoLi4uYm91bmRzWzFdKV07CiAgfQoKfQoKZXhwb3J0cy5VdGlsID0gVXRpbDsKY29uc3QgUERGU3RyaW5nVHJhbnNsYXRlVGFibGUgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMHgyZDgsIDB4MmM3LCAweDJjNiwgMHgyZDksIDB4MmRkLCAweDJkYiwgMHgyZGEsIDB4MmRjLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAweDIwMjIsIDB4MjAyMCwgMHgyMDIxLCAweDIwMjYsIDB4MjAxNCwgMHgyMDEzLCAweDE5MiwgMHgyMDQ0LCAweDIwMzksIDB4MjAzYSwgMHgyMjEyLCAweDIwMzAsIDB4MjAxZSwgMHgyMDFjLCAweDIwMWQsIDB4MjAxOCwgMHgyMDE5LCAweDIwMWEsIDB4MjEyMiwgMHhmYjAxLCAweGZiMDIsIDB4MTQxLCAweDE1MiwgMHgxNjAsIDB4MTc4LCAweDE3ZCwgMHgxMzEsIDB4MTQyLCAweDE1MywgMHgxNjEsIDB4MTdlLCAwLCAweDIwYWNdOwoKZnVuY3Rpb24gc3RyaW5nVG9QREZTdHJpbmcoc3RyKSB7CiAgaWYgKHN0clswXSA+PSAiXHhFRiIpIHsKICAgIGxldCBlbmNvZGluZzsKCiAgICBpZiAoc3RyWzBdID09PSAiXHhGRSIgJiYgc3RyWzFdID09PSAiXHhGRiIpIHsKICAgICAgZW5jb2RpbmcgPSAidXRmLTE2YmUiOwogICAgfSBlbHNlIGlmIChzdHJbMF0gPT09ICJceEZGIiAmJiBzdHJbMV0gPT09ICJceEZFIikgewogICAgICBlbmNvZGluZyA9ICJ1dGYtMTZsZSI7CiAgICB9IGVsc2UgaWYgKHN0clswXSA9PT0gIlx4RUYiICYmIHN0clsxXSA9PT0gIlx4QkIiICYmIHN0clsyXSA9PT0gIlx4QkYiKSB7CiAgICAgIGVuY29kaW5nID0gInV0Zi04IjsKICAgIH0KCiAgICBpZiAoZW5jb2RpbmcpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKGVuY29kaW5nLCB7CiAgICAgICAgICBmYXRhbDogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIGNvbnN0IGJ1ZmZlciA9IHN0cmluZ1RvQnl0ZXMoc3RyKTsKICAgICAgICByZXR1cm4gZGVjb2Rlci5kZWNvZGUoYnVmZmVyKTsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICB3YXJuKGBzdHJpbmdUb1BERlN0cmluZzogIiR7ZXh9Ii5gKTsKICAgICAgfQogICAgfQogIH0KCiAgY29uc3Qgc3RyQnVmID0gW107CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IHN0ci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjb2RlID0gUERGU3RyaW5nVHJhbnNsYXRlVGFibGVbc3RyLmNoYXJDb2RlQXQoaSldOwogICAgc3RyQnVmLnB1c2goY29kZSA/IFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSkgOiBzdHIuY2hhckF0KGkpKTsKICB9CgogIHJldHVybiBzdHJCdWYuam9pbigiIik7Cn0KCmZ1bmN0aW9uIGVzY2FwZVN0cmluZyhzdHIpIHsKICByZXR1cm4gc3RyLnJlcGxhY2UoLyhbKClcXFxuXHJdKS9nLCBtYXRjaCA9PiB7CiAgICBpZiAobWF0Y2ggPT09ICJcbiIpIHsKICAgICAgcmV0dXJuICJcXG4iOwogICAgfSBlbHNlIGlmIChtYXRjaCA9PT0gIlxyIikgewogICAgICByZXR1cm4gIlxcciI7CiAgICB9CgogICAgcmV0dXJuIGBcXCR7bWF0Y2h9YDsKICB9KTsKfQoKZnVuY3Rpb24gaXNBc2NpaShzdHIpIHsKICByZXR1cm4gL15bXHgwMC1ceDdGXSokLy50ZXN0KHN0cik7Cn0KCmZ1bmN0aW9uIHN0cmluZ1RvVVRGMTZCRVN0cmluZyhzdHIpIHsKICBjb25zdCBidWYgPSBbIlx4RkVceEZGIl07CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IHN0ci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjaGFyID0gc3RyLmNoYXJDb2RlQXQoaSk7CiAgICBidWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXIgPj4gOCAmIDB4ZmYpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXIgJiAweGZmKSk7CiAgfQoKICByZXR1cm4gYnVmLmpvaW4oIiIpOwp9CgpmdW5jdGlvbiBzdHJpbmdUb1VURjhTdHJpbmcoc3RyKSB7CiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUoc3RyKSk7Cn0KCmZ1bmN0aW9uIHV0ZjhTdHJpbmdUb1N0cmluZyhzdHIpIHsKICByZXR1cm4gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHN0cikpOwp9CgpmdW5jdGlvbiBpc0FycmF5QnVmZmVyKHYpIHsKICByZXR1cm4gdHlwZW9mIHYgPT09ICJvYmplY3QiICYmIHYgIT09IG51bGwgJiYgdi5ieXRlTGVuZ3RoICE9PSB1bmRlZmluZWQ7Cn0KCmZ1bmN0aW9uIGlzQXJyYXlFcXVhbChhcnIxLCBhcnIyKSB7CiAgaWYgKGFycjEubGVuZ3RoICE9PSBhcnIyLmxlbmd0aCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZm9yIChsZXQgaSA9IDAsIGlpID0gYXJyMS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBpZiAoYXJyMVtpXSAhPT0gYXJyMltpXSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICByZXR1cm4gdHJ1ZTsKfQoKZnVuY3Rpb24gZ2V0TW9kaWZpY2F0aW9uRGF0ZSgpIHsKICBsZXQgZGF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbmV3IERhdGUoKTsKICBjb25zdCBidWZmZXIgPSBbZGF0ZS5nZXRVVENGdWxsWWVhcigpLnRvU3RyaW5nKCksIChkYXRlLmdldFVUQ01vbnRoKCkgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICIwIiksIGRhdGUuZ2V0VVRDRGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgIjAiKSwgZGF0ZS5nZXRVVENIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgIjAiKSwgZGF0ZS5nZXRVVENNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAiMCIpLCBkYXRlLmdldFVUQ1NlY29uZHMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICIwIildOwogIHJldHVybiBidWZmZXIuam9pbigiIik7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KCkgewogIGNvbnN0IGNhcGFiaWxpdHkgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIGxldCBpc1NldHRsZWQgPSBmYWxzZTsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2FwYWJpbGl0eSwgInNldHRsZWQiLCB7CiAgICBnZXQoKSB7CiAgICAgIHJldHVybiBpc1NldHRsZWQ7CiAgICB9CgogIH0pOwogIGNhcGFiaWxpdHkucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgIGNhcGFiaWxpdHkucmVzb2x2ZSA9IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIGlzU2V0dGxlZCA9IHRydWU7CiAgICAgIHJlc29sdmUoZGF0YSk7CiAgICB9OwoKICAgIGNhcGFiaWxpdHkucmVqZWN0ID0gZnVuY3Rpb24gKHJlYXNvbikgewogICAgICBpc1NldHRsZWQgPSB0cnVlOwogICAgICByZWplY3QocmVhc29uKTsKICAgIH07CiAgfSk7CiAgcmV0dXJuIGNhcGFiaWxpdHk7Cn0KCi8qKiovIH0pLAovKiAzICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCnZhciBfaXNfbm9kZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNCk7CgppZiAoIWdsb2JhbFRoaXMuX3BkZmpzQ29tcGF0aWJpbGl0eUNoZWNrZWQpIHsKICBnbG9iYWxUaGlzLl9wZGZqc0NvbXBhdGliaWxpdHlDaGVja2VkID0gdHJ1ZTsKCiAgKGZ1bmN0aW9uIGNoZWNrTm9kZUJ0b2EoKSB7CiAgICBpZiAoZ2xvYmFsVGhpcy5idG9hIHx8ICFfaXNfbm9kZS5pc05vZGVKUykgewogICAgICByZXR1cm47CiAgICB9CgogICAgZ2xvYmFsVGhpcy5idG9hID0gZnVuY3Rpb24gKGNoYXJzKSB7CiAgICAgIHJldHVybiBCdWZmZXIuZnJvbShjaGFycywgImJpbmFyeSIpLnRvU3RyaW5nKCJiYXNlNjQiKTsKICAgIH07CiAgfSkoKTsKCiAgKGZ1bmN0aW9uIGNoZWNrTm9kZUF0b2IoKSB7CiAgICBpZiAoZ2xvYmFsVGhpcy5hdG9iIHx8ICFfaXNfbm9kZS5pc05vZGVKUykgewogICAgICByZXR1cm47CiAgICB9CgogICAgZ2xvYmFsVGhpcy5hdG9iID0gZnVuY3Rpb24gKGlucHV0KSB7CiAgICAgIHJldHVybiBCdWZmZXIuZnJvbShpbnB1dCwgImJhc2U2NCIpLnRvU3RyaW5nKCJiaW5hcnkiKTsKICAgIH07CiAgfSkoKTsKCiAgKGZ1bmN0aW9uIGNoZWNrRE9NTWF0cml4KCkgewogICAgaWYgKGdsb2JhbFRoaXMuRE9NTWF0cml4IHx8ICFfaXNfbm9kZS5pc05vZGVKUykgewogICAgICByZXR1cm47CiAgICB9CgogICAgZ2xvYmFsVGhpcy5ET01NYXRyaXggPSByZXF1aXJlKCJkb21tYXRyaXgvZGlzdC9kb21tYXRyaXguanMiKTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tSZWFkYWJsZVN0cmVhbSgpIHsKICAgIGlmIChnbG9iYWxUaGlzLlJlYWRhYmxlU3RyZWFtIHx8ICFfaXNfbm9kZS5pc05vZGVKUykgewogICAgICByZXR1cm47CiAgICB9CgogICAgZ2xvYmFsVGhpcy5SZWFkYWJsZVN0cmVhbSA9IHJlcXVpcmUoIndlYi1zdHJlYW1zLXBvbHlmaWxsL2Rpc3QvcG9ueWZpbGwuanMiKS5SZWFkYWJsZVN0cmVhbTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tBcnJheUF0KCkgewogICAgaWYgKEFycmF5LnByb3RvdHlwZS5hdCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tUeXBlZEFycmF5QXQoKSB7CiAgICBpZiAoVWludDhBcnJheS5wcm90b3R5cGUuYXQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIF9fd19wZGZqc19yZXF1aXJlX18oNzcpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja1N0cnVjdHVyZWRDbG9uZSgpIHsKICAgIGlmIChnbG9iYWxUaGlzLnN0cnVjdHVyZWRDbG9uZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgX193X3BkZmpzX3JlcXVpcmVfXyg4Nyk7CiAgfSkoKTsKfQoKLyoqKi8gfSksCi8qIDQgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmlzTm9kZUpTID0gdm9pZCAwOwpjb25zdCBpc05vZGVKUyA9IHR5cGVvZiBwcm9jZXNzID09PSAib2JqZWN0IiAmJiBwcm9jZXNzICsgIiIgPT09ICJbb2JqZWN0IHByb2Nlc3NdIiAmJiAhcHJvY2Vzcy52ZXJzaW9ucy5udyAmJiAhKHByb2Nlc3MudmVyc2lvbnMuZWxlY3Ryb24gJiYgcHJvY2Vzcy50eXBlICYmIHByb2Nlc3MudHlwZSAhPT0gImJyb3dzZXIiKTsKZXhwb3J0cy5pc05vZGVKUyA9IGlzTm9kZUpTOwoKLyoqKi8gfSksCi8qIDUgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKdmFyIGVudHJ5VW5iaW5kID0gX193X3BkZmpzX3JlcXVpcmVfXyg3Nik7Cm1vZHVsZS5leHBvcnRzID0gZW50cnlVbmJpbmQoJ0FycmF5JywgJ2F0Jyk7CgovKioqLyB9KSwKLyogNiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKdmFyIHRvT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Mik7CnZhciBsZW5ndGhPZkFycmF5TGlrZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNjYpOwp2YXIgdG9JbnRlZ2VyT3JJbmZpbml0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oNjQpOwp2YXIgYWRkVG9VbnNjb3BhYmxlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzEpOwokKHsKIHRhcmdldDogJ0FycmF5JywKIHByb3RvOiB0cnVlCn0sIHsKIGF0OiBmdW5jdGlvbiBhdChpbmRleCkgewogIHZhciBPID0gdG9PYmplY3QodGhpcyk7CiAgdmFyIGxlbiA9IGxlbmd0aE9mQXJyYXlMaWtlKE8pOwogIHZhciByZWxhdGl2ZUluZGV4ID0gdG9JbnRlZ2VyT3JJbmZpbml0eShpbmRleCk7CiAgdmFyIGsgPSByZWxhdGl2ZUluZGV4ID49IDAgPyByZWxhdGl2ZUluZGV4IDogbGVuICsgcmVsYXRpdmVJbmRleDsKICByZXR1cm4gayA8IDAgfHwgayA+PSBsZW4gPyB1bmRlZmluZWQgOiBPW2tdOwogfQp9KTsKYWRkVG9VbnNjb3BhYmxlcygnYXQnKTsKCi8qKiovIH0pLAovKiA3ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgpOwp2YXIgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gKF9fd19wZGZqc19yZXF1aXJlX18oOSkuZik7CnZhciBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ2KTsKdmFyIGRlZmluZUJ1aWx0SW4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUwKTsKdmFyIGRlZmluZUdsb2JhbFByb3BlcnR5ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0MCk7CnZhciBjb3B5Q29uc3RydWN0b3JQcm9wZXJ0aWVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1OCk7CnZhciBpc0ZvcmNlZCA9IF9fd19wZGZqc19yZXF1aXJlX18oNzApOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvcHRpb25zLCBzb3VyY2UpIHsKIHZhciBUQVJHRVQgPSBvcHRpb25zLnRhcmdldDsKIHZhciBHTE9CQUwgPSBvcHRpb25zLmdsb2JhbDsKIHZhciBTVEFUSUMgPSBvcHRpb25zLnN0YXQ7CiB2YXIgRk9SQ0VELCB0YXJnZXQsIGtleSwgdGFyZ2V0UHJvcGVydHksIHNvdXJjZVByb3BlcnR5LCBkZXNjcmlwdG9yOwogaWYgKEdMT0JBTCkgewogIHRhcmdldCA9IGdsb2JhbDsKIH0gZWxzZSBpZiAoU1RBVElDKSB7CiAgdGFyZ2V0ID0gZ2xvYmFsW1RBUkdFVF0gfHwgZGVmaW5lR2xvYmFsUHJvcGVydHkoVEFSR0VULCB7fSk7CiB9IGVsc2UgewogIHRhcmdldCA9IChnbG9iYWxbVEFSR0VUXSB8fCB7fSkucHJvdG90eXBlOwogfQogaWYgKHRhcmdldCkKICBmb3IgKGtleSBpbiBzb3VyY2UpIHsKICAgc291cmNlUHJvcGVydHkgPSBzb3VyY2Vba2V5XTsKICAgaWYgKG9wdGlvbnMuZG9udENhbGxHZXRTZXQpIHsKICAgIGRlc2NyaXB0b3IgPSBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpOwogICAgdGFyZ2V0UHJvcGVydHkgPSBkZXNjcmlwdG9yICYmIGRlc2NyaXB0b3IudmFsdWU7CiAgIH0gZWxzZQogICAgdGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRba2V5XTsKICAgRk9SQ0VEID0gaXNGb3JjZWQoR0xPQkFMID8ga2V5IDogVEFSR0VUICsgKFNUQVRJQyA/ICcuJyA6ICcjJykgKyBrZXksIG9wdGlvbnMuZm9yY2VkKTsKICAgaWYgKCFGT1JDRUQgJiYgdGFyZ2V0UHJvcGVydHkgIT09IHVuZGVmaW5lZCkgewogICAgaWYgKHR5cGVvZiBzb3VyY2VQcm9wZXJ0eSA9PSB0eXBlb2YgdGFyZ2V0UHJvcGVydHkpCiAgICAgY29udGludWU7CiAgICBjb3B5Q29uc3RydWN0b3JQcm9wZXJ0aWVzKHNvdXJjZVByb3BlcnR5LCB0YXJnZXRQcm9wZXJ0eSk7CiAgIH0KICAgaWYgKG9wdGlvbnMuc2hhbSB8fCB0YXJnZXRQcm9wZXJ0eSAmJiB0YXJnZXRQcm9wZXJ0eS5zaGFtKSB7CiAgICBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkoc291cmNlUHJvcGVydHksICdzaGFtJywgdHJ1ZSk7CiAgIH0KICAgZGVmaW5lQnVpbHRJbih0YXJnZXQsIGtleSwgc291cmNlUHJvcGVydHksIG9wdGlvbnMpOwogIH0KfTsKCi8qKiovIH0pLAovKiA4ICovCi8qKiovICgobW9kdWxlKSA9PiB7Cgp2YXIgY2hlY2sgPSBmdW5jdGlvbiAoaXQpIHsKIHJldHVybiBpdCAmJiBpdC5NYXRoID09IE1hdGggJiYgaXQ7Cn07Cm1vZHVsZS5leHBvcnRzID0gY2hlY2sodHlwZW9mIGdsb2JhbFRoaXMgPT0gJ29iamVjdCcgJiYgZ2xvYmFsVGhpcykgfHwgY2hlY2sodHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cpIHx8IGNoZWNrKHR5cGVvZiBzZWxmID09ICdvYmplY3QnICYmIHNlbGYpIHx8IGNoZWNrKHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgZ2xvYmFsKSB8fCAoZnVuY3Rpb24gKCkgewogcmV0dXJuIHRoaXM7Cn0oKSkgfHwgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKCi8qKiovIH0pLAovKiA5ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBERVNDUklQVE9SUyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwp2YXIgY2FsbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTIpOwp2YXIgcHJvcGVydHlJc0VudW1lcmFibGVNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0KTsKdmFyIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTUpOwp2YXIgdG9JbmRleGVkT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygxNik7CnZhciB0b1Byb3BlcnR5S2V5ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMSk7CnZhciBoYXNPd24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQxKTsKdmFyIElFOF9ET01fREVGSU5FID0gX193X3BkZmpzX3JlcXVpcmVfXyg0NCk7CnZhciAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKZXhwb3J0cy5mID0gREVTQ1JJUFRPUlMgPyAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApIHsKIE8gPSB0b0luZGV4ZWRPYmplY3QoTyk7CiBQID0gdG9Qcm9wZXJ0eUtleShQKTsKIGlmIChJRThfRE9NX0RFRklORSkKICB0cnkgewogICByZXR1cm4gJGdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKTsKICB9IGNhdGNoIChlcnJvcikgewogIH0KIGlmIChoYXNPd24oTywgUCkpCiAgcmV0dXJuIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvcighY2FsbChwcm9wZXJ0eUlzRW51bWVyYWJsZU1vZHVsZS5mLCBPLCBQKSwgT1tQXSk7Cn07CgovKioqLyB9KSwKLyogMTAgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gIWZhaWxzKGZ1bmN0aW9uICgpIHsKIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sIDEsIHsKICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgcmV0dXJuIDc7CiAgfQogfSlbMV0gIT0gNzsKfSk7CgovKioqLyB9KSwKLyogMTEgKi8KLyoqKi8gKChtb2R1bGUpID0+IHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGV4ZWMpIHsKIHRyeSB7CiAgcmV0dXJuICEhZXhlYygpOwogfSBjYXRjaCAoZXJyb3IpIHsKICByZXR1cm4gdHJ1ZTsKIH0KfTsKCi8qKiovIH0pLAovKiAxMiAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgTkFUSVZFX0JJTkQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzKTsKdmFyIGNhbGwgPSBGdW5jdGlvbi5wcm90b3R5cGUuY2FsbDsKbW9kdWxlLmV4cG9ydHMgPSBOQVRJVkVfQklORCA/IGNhbGwuYmluZChjYWxsKSA6IGZ1bmN0aW9uICgpIHsKIHJldHVybiBjYWxsLmFwcGx5KGNhbGwsIGFyZ3VtZW50cyk7Cn07CgovKioqLyB9KSwKLyogMTMgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gIWZhaWxzKGZ1bmN0aW9uICgpIHsKIHZhciB0ZXN0ID0gZnVuY3Rpb24gKCkgewogfS5iaW5kKCk7CiByZXR1cm4gdHlwZW9mIHRlc3QgIT0gJ2Z1bmN0aW9uJyB8fCB0ZXN0Lmhhc093blByb3BlcnR5KCdwcm90b3R5cGUnKTsKfSk7CgovKioqLyB9KSwKLyogMTQgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKInVzZSBzdHJpY3QiOwoKdmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlOwp2YXIgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKdmFyIE5BU0hPUk5fQlVHID0gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yICYmICEkcHJvcGVydHlJc0VudW1lcmFibGUuY2FsbCh7IDE6IDIgfSwgMSk7CmV4cG9ydHMuZiA9IE5BU0hPUk5fQlVHID8gZnVuY3Rpb24gcHJvcGVydHlJc0VudW1lcmFibGUoVikgewogdmFyIGRlc2NyaXB0b3IgPSBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGhpcywgVik7CiByZXR1cm4gISFkZXNjcmlwdG9yICYmIGRlc2NyaXB0b3IuZW51bWVyYWJsZTsKfSA6ICRwcm9wZXJ0eUlzRW51bWVyYWJsZTsKCi8qKiovIH0pLAovKiAxNSAqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYml0bWFwLCB2YWx1ZSkgewogcmV0dXJuIHsKICBlbnVtZXJhYmxlOiAhKGJpdG1hcCAmIDEpLAogIGNvbmZpZ3VyYWJsZTogIShiaXRtYXAgJiAyKSwKICB3cml0YWJsZTogIShiaXRtYXAgJiA0KSwKICB2YWx1ZTogdmFsdWUKIH07Cn07CgovKioqLyB9KSwKLyogMTYgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIEluZGV4ZWRPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3KTsKdmFyIHJlcXVpcmVPYmplY3RDb2VyY2libGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKIHJldHVybiBJbmRleGVkT2JqZWN0KHJlcXVpcmVPYmplY3RDb2VyY2libGUoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAxNyAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgdW5jdXJyeVRoaXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE4KTsKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBjbGFzc29mID0gX193X3BkZmpzX3JlcXVpcmVfXygxOSk7CnZhciAkT2JqZWN0ID0gT2JqZWN0Owp2YXIgc3BsaXQgPSB1bmN1cnJ5VGhpcygnJy5zcGxpdCk7Cm1vZHVsZS5leHBvcnRzID0gZmFpbHMoZnVuY3Rpb24gKCkgewogcmV0dXJuICEkT2JqZWN0KCd6JykucHJvcGVydHlJc0VudW1lcmFibGUoMCk7Cn0pID8gZnVuY3Rpb24gKGl0KSB7CiByZXR1cm4gY2xhc3NvZihpdCkgPT0gJ1N0cmluZycgPyBzcGxpdChpdCwgJycpIDogJE9iamVjdChpdCk7Cn0gOiAkT2JqZWN0OwoKLyoqKi8gfSksCi8qIDE4ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBOQVRJVkVfQklORCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMpOwp2YXIgRnVuY3Rpb25Qcm90b3R5cGUgPSBGdW5jdGlvbi5wcm90b3R5cGU7CnZhciBiaW5kID0gRnVuY3Rpb25Qcm90b3R5cGUuYmluZDsKdmFyIGNhbGwgPSBGdW5jdGlvblByb3RvdHlwZS5jYWxsOwp2YXIgdW5jdXJyeVRoaXMgPSBOQVRJVkVfQklORCAmJiBiaW5kLmJpbmQoY2FsbCwgY2FsbCk7Cm1vZHVsZS5leHBvcnRzID0gTkFUSVZFX0JJTkQgPyBmdW5jdGlvbiAoZm4pIHsKIHJldHVybiBmbiAmJiB1bmN1cnJ5VGhpcyhmbik7Cn0gOiBmdW5jdGlvbiAoZm4pIHsKIHJldHVybiBmbiAmJiBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGNhbGwuYXBwbHkoZm4sIGFyZ3VtZW50cyk7CiB9Owp9OwoKLyoqKi8gfSksCi8qIDE5ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciB1bmN1cnJ5VGhpcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTgpOwp2YXIgdG9TdHJpbmcgPSB1bmN1cnJ5VGhpcyh7fS50b1N0cmluZyk7CnZhciBzdHJpbmdTbGljZSA9IHVuY3VycnlUaGlzKCcnLnNsaWNlKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKIHJldHVybiBzdHJpbmdTbGljZSh0b1N0cmluZyhpdCksIDgsIC0xKTsKfTsKCi8qKiovIH0pLAovKiAyMCAqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKdmFyICRUeXBlRXJyb3IgPSBUeXBlRXJyb3I7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7CiBpZiAoaXQgPT0gdW5kZWZpbmVkKQogIHRocm93ICRUeXBlRXJyb3IoIkNhbid0IGNhbGwgbWV0aG9kIG9uICIgKyBpdCk7CiByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjEgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHRvUHJpbWl0aXZlID0gX193X3BkZmpzX3JlcXVpcmVfXygyMik7CnZhciBpc1N5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjUpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcmd1bWVudCkgewogdmFyIGtleSA9IHRvUHJpbWl0aXZlKGFyZ3VtZW50LCAnc3RyaW5nJyk7CiByZXR1cm4gaXNTeW1ib2woa2V5KSA/IGtleSA6IGtleSArICcnOwp9OwoKLyoqKi8gfSksCi8qIDIyICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBjYWxsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMik7CnZhciBpc09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgaXNTeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI1KTsKdmFyIGdldE1ldGhvZCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzIpOwp2YXIgb3JkaW5hcnlUb1ByaW1pdGl2ZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMzUpOwp2YXIgd2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXygzNik7CnZhciAkVHlwZUVycm9yID0gVHlwZUVycm9yOwp2YXIgVE9fUFJJTUlUSVZFID0gd2VsbEtub3duU3ltYm9sKCd0b1ByaW1pdGl2ZScpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpbnB1dCwgcHJlZikgewogaWYgKCFpc09iamVjdChpbnB1dCkgfHwgaXNTeW1ib2woaW5wdXQpKQogIHJldHVybiBpbnB1dDsKIHZhciBleG90aWNUb1ByaW0gPSBnZXRNZXRob2QoaW5wdXQsIFRPX1BSSU1JVElWRSk7CiB2YXIgcmVzdWx0OwogaWYgKGV4b3RpY1RvUHJpbSkgewogIGlmIChwcmVmID09PSB1bmRlZmluZWQpCiAgIHByZWYgPSAnZGVmYXVsdCc7CiAgcmVzdWx0ID0gY2FsbChleG90aWNUb1ByaW0sIGlucHV0LCBwcmVmKTsKICBpZiAoIWlzT2JqZWN0KHJlc3VsdCkgfHwgaXNTeW1ib2wocmVzdWx0KSkKICAgcmV0dXJuIHJlc3VsdDsKICB0aHJvdyAkVHlwZUVycm9yKCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWUiKTsKIH0KIGlmIChwcmVmID09PSB1bmRlZmluZWQpCiAgcHJlZiA9ICdudW1iZXInOwogcmV0dXJuIG9yZGluYXJ5VG9QcmltaXRpdmUoaW5wdXQsIHByZWYpOwp9OwoKLyoqKi8gfSksCi8qIDIzICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBpc0NhbGxhYmxlID0gX193X3BkZmpzX3JlcXVpcmVfXygyNCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7CiByZXR1cm4gdHlwZW9mIGl0ID09ICdvYmplY3QnID8gaXQgIT09IG51bGwgOiBpc0NhbGxhYmxlKGl0KTsKfTsKCi8qKiovIH0pLAovKiAyNCAqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXJndW1lbnQpIHsKIHJldHVybiB0eXBlb2YgYXJndW1lbnQgPT0gJ2Z1bmN0aW9uJzsKfTsKCi8qKiovIH0pLAovKiAyNSAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgZ2V0QnVpbHRJbiA9IF9fd19wZGZqc19yZXF1aXJlX18oMjYpOwp2YXIgaXNDYWxsYWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjQpOwp2YXIgaXNQcm90b3R5cGVPZiA9IF9fd19wZGZqc19yZXF1aXJlX18oMjcpOwp2YXIgVVNFX1NZTUJPTF9BU19VSUQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI4KTsKdmFyICRPYmplY3QgPSBPYmplY3Q7Cm1vZHVsZS5leHBvcnRzID0gVVNFX1NZTUJPTF9BU19VSUQgPyBmdW5jdGlvbiAoaXQpIHsKIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCc7Cn0gOiBmdW5jdGlvbiAoaXQpIHsKIHZhciAkU3ltYm9sID0gZ2V0QnVpbHRJbignU3ltYm9sJyk7CiByZXR1cm4gaXNDYWxsYWJsZSgkU3ltYm9sKSAmJiBpc1Byb3RvdHlwZU9mKCRTeW1ib2wucHJvdG90eXBlLCAkT2JqZWN0KGl0KSk7Cn07CgovKioqLyB9KSwKLyogMjYgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oOCk7CnZhciBpc0NhbGxhYmxlID0gX193X3BkZmpzX3JlcXVpcmVfXygyNCk7CnZhciBhRnVuY3Rpb24gPSBmdW5jdGlvbiAoYXJndW1lbnQpIHsKIHJldHVybiBpc0NhbGxhYmxlKGFyZ3VtZW50KSA/IGFyZ3VtZW50IDogdW5kZWZpbmVkOwp9Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChuYW1lc3BhY2UsIG1ldGhvZCkgewogcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPCAyID8gYUZ1bmN0aW9uKGdsb2JhbFtuYW1lc3BhY2VdKSA6IGdsb2JhbFtuYW1lc3BhY2VdICYmIGdsb2JhbFtuYW1lc3BhY2VdW21ldGhvZF07Cn07CgovKioqLyB9KSwKLyogMjcgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHVuY3VycnlUaGlzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOCk7Cm1vZHVsZS5leHBvcnRzID0gdW5jdXJyeVRoaXMoe30uaXNQcm90b3R5cGVPZik7CgovKioqLyB9KSwKLyogMjggKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIE5BVElWRV9TWU1CT0wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI5KTsKbW9kdWxlLmV4cG9ydHMgPSBOQVRJVkVfU1lNQk9MICYmICFTeW1ib2wuc2hhbSAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09ICdzeW1ib2wnOwoKLyoqKi8gfSksCi8qIDI5ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBWOF9WRVJTSU9OID0gX193X3BkZmpzX3JlcXVpcmVfXygzMCk7CnZhciBmYWlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwptb2R1bGUuZXhwb3J0cyA9ICEhT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyAmJiAhZmFpbHMoZnVuY3Rpb24gKCkgewogdmFyIHN5bWJvbCA9IFN5bWJvbCgpOwogcmV0dXJuICFTdHJpbmcoc3ltYm9sKSB8fCAhKE9iamVjdChzeW1ib2wpIGluc3RhbmNlb2YgU3ltYm9sKSB8fCAhU3ltYm9sLnNoYW0gJiYgVjhfVkVSU0lPTiAmJiBWOF9WRVJTSU9OIDwgNDE7Cn0pOwoKLyoqKi8gfSksCi8qIDMwICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgpOwp2YXIgdXNlckFnZW50ID0gX193X3BkZmpzX3JlcXVpcmVfXygzMSk7CnZhciBwcm9jZXNzID0gZ2xvYmFsLnByb2Nlc3M7CnZhciBEZW5vID0gZ2xvYmFsLkRlbm87CnZhciB2ZXJzaW9ucyA9IHByb2Nlc3MgJiYgcHJvY2Vzcy52ZXJzaW9ucyB8fCBEZW5vICYmIERlbm8udmVyc2lvbjsKdmFyIHY4ID0gdmVyc2lvbnMgJiYgdmVyc2lvbnMudjg7CnZhciBtYXRjaCwgdmVyc2lvbjsKaWYgKHY4KSB7CiBtYXRjaCA9IHY4LnNwbGl0KCcuJyk7CiB2ZXJzaW9uID0gbWF0Y2hbMF0gPiAwICYmIG1hdGNoWzBdIDwgNCA/IDEgOiArKG1hdGNoWzBdICsgbWF0Y2hbMV0pOwp9CmlmICghdmVyc2lvbiAmJiB1c2VyQWdlbnQpIHsKIG1hdGNoID0gdXNlckFnZW50Lm1hdGNoKC9FZGdlXC8oXGQrKS8pOwogaWYgKCFtYXRjaCB8fCBtYXRjaFsxXSA+PSA3NCkgewogIG1hdGNoID0gdXNlckFnZW50Lm1hdGNoKC9DaHJvbWVcLyhcZCspLyk7CiAgaWYgKG1hdGNoKQogICB2ZXJzaW9uID0gK21hdGNoWzFdOwogfQp9Cm1vZHVsZS5leHBvcnRzID0gdmVyc2lvbjsKCi8qKiovIH0pLAovKiAzMSAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgZ2V0QnVpbHRJbiA9IF9fd19wZGZqc19yZXF1aXJlX18oMjYpOwptb2R1bGUuZXhwb3J0cyA9IGdldEJ1aWx0SW4oJ25hdmlnYXRvcicsICd1c2VyQWdlbnQnKSB8fCAnJzsKCi8qKiovIH0pLAovKiAzMiAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgYUNhbGxhYmxlID0gX193X3BkZmpzX3JlcXVpcmVfXygzMyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFYsIFApIHsKIHZhciBmdW5jID0gVltQXTsKIHJldHVybiBmdW5jID09IG51bGwgPyB1bmRlZmluZWQgOiBhQ2FsbGFibGUoZnVuYyk7Cn07CgovKioqLyB9KSwKLyogMzMgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGlzQ2FsbGFibGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI0KTsKdmFyIHRyeVRvU3RyaW5nID0gX193X3BkZmpzX3JlcXVpcmVfXygzNCk7CnZhciAkVHlwZUVycm9yID0gVHlwZUVycm9yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcmd1bWVudCkgewogaWYgKGlzQ2FsbGFibGUoYXJndW1lbnQpKQogIHJldHVybiBhcmd1bWVudDsKIHRocm93ICRUeXBlRXJyb3IodHJ5VG9TdHJpbmcoYXJndW1lbnQpICsgJyBpcyBub3QgYSBmdW5jdGlvbicpOwp9OwoKLyoqKi8gfSksCi8qIDM0ICovCi8qKiovICgobW9kdWxlKSA9PiB7Cgp2YXIgJFN0cmluZyA9IFN0cmluZzsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXJndW1lbnQpIHsKIHRyeSB7CiAgcmV0dXJuICRTdHJpbmcoYXJndW1lbnQpOwogfSBjYXRjaCAoZXJyb3IpIHsKICByZXR1cm4gJ09iamVjdCc7CiB9Cn07CgovKioqLyB9KSwKLyogMzUgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGNhbGwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyKTsKdmFyIGlzQ2FsbGFibGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI0KTsKdmFyIGlzT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMyk7CnZhciAkVHlwZUVycm9yID0gVHlwZUVycm9yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpbnB1dCwgcHJlZikgewogdmFyIGZuLCB2YWw7CiBpZiAocHJlZiA9PT0gJ3N0cmluZycgJiYgaXNDYWxsYWJsZShmbiA9IGlucHV0LnRvU3RyaW5nKSAmJiAhaXNPYmplY3QodmFsID0gY2FsbChmbiwgaW5wdXQpKSkKICByZXR1cm4gdmFsOwogaWYgKGlzQ2FsbGFibGUoZm4gPSBpbnB1dC52YWx1ZU9mKSAmJiAhaXNPYmplY3QodmFsID0gY2FsbChmbiwgaW5wdXQpKSkKICByZXR1cm4gdmFsOwogaWYgKHByZWYgIT09ICdzdHJpbmcnICYmIGlzQ2FsbGFibGUoZm4gPSBpbnB1dC50b1N0cmluZykgJiYgIWlzT2JqZWN0KHZhbCA9IGNhbGwoZm4sIGlucHV0KSkpCiAgcmV0dXJuIHZhbDsKIHRocm93ICRUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpOwp9OwoKLyoqKi8gfSksCi8qIDM2ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgpOwp2YXIgc2hhcmVkID0gX193X3BkZmpzX3JlcXVpcmVfXygzNyk7CnZhciBoYXNPd24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQxKTsKdmFyIHVpZCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDMpOwp2YXIgTkFUSVZFX1NZTUJPTCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjkpOwp2YXIgVVNFX1NZTUJPTF9BU19VSUQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI4KTsKdmFyIFdlbGxLbm93blN5bWJvbHNTdG9yZSA9IHNoYXJlZCgnd2tzJyk7CnZhciBTeW1ib2wgPSBnbG9iYWwuU3ltYm9sOwp2YXIgc3ltYm9sRm9yID0gU3ltYm9sICYmIFN5bWJvbFsnZm9yJ107CnZhciBjcmVhdGVXZWxsS25vd25TeW1ib2wgPSBVU0VfU1lNQk9MX0FTX1VJRCA/IFN5bWJvbCA6IFN5bWJvbCAmJiBTeW1ib2wud2l0aG91dFNldHRlciB8fCB1aWQ7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG5hbWUpIHsKIGlmICghaGFzT3duKFdlbGxLbm93blN5bWJvbHNTdG9yZSwgbmFtZSkgfHwgIShOQVRJVkVfU1lNQk9MIHx8IHR5cGVvZiBXZWxsS25vd25TeW1ib2xzU3RvcmVbbmFtZV0gPT0gJ3N0cmluZycpKSB7CiAgdmFyIGRlc2NyaXB0aW9uID0gJ1N5bWJvbC4nICsgbmFtZTsKICBpZiAoTkFUSVZFX1NZTUJPTCAmJiBoYXNPd24oU3ltYm9sLCBuYW1lKSkgewogICBXZWxsS25vd25TeW1ib2xzU3RvcmVbbmFtZV0gPSBTeW1ib2xbbmFtZV07CiAgfSBlbHNlIGlmIChVU0VfU1lNQk9MX0FTX1VJRCAmJiBzeW1ib2xGb3IpIHsKICAgV2VsbEtub3duU3ltYm9sc1N0b3JlW25hbWVdID0gc3ltYm9sRm9yKGRlc2NyaXB0aW9uKTsKICB9IGVsc2UgewogICBXZWxsS25vd25TeW1ib2xzU3RvcmVbbmFtZV0gPSBjcmVhdGVXZWxsS25vd25TeW1ib2woZGVzY3JpcHRpb24pOwogIH0KIH0KIHJldHVybiBXZWxsS25vd25TeW1ib2xzU3RvcmVbbmFtZV07Cn07CgovKioqLyB9KSwKLyogMzcgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIElTX1BVUkUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM4KTsKdmFyIHN0b3JlID0gX193X3BkZmpzX3JlcXVpcmVfXygzOSk7Cihtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiByZXR1cm4gc3RvcmVba2V5XSB8fCAoc3RvcmVba2V5XSA9IHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IHt9KTsKfSkoJ3ZlcnNpb25zJywgW10pLnB1c2goewogdmVyc2lvbjogJzMuMjQuMScsCiBtb2RlOiBJU19QVVJFID8gJ3B1cmUnIDogJ2dsb2JhbCcsCiBjb3B5cmlnaHQ6ICfCqSAyMDE0LTIwMjIgRGVuaXMgUHVzaGthcmV2ICh6bG9pcm9jay5ydSknLAogbGljZW5zZTogJ2h0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2Jsb2IvdjMuMjQuMS9MSUNFTlNFJywKIHNvdXJjZTogJ2h0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzJwp9KTsKCi8qKiovIH0pLAovKiAzOCAqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSBmYWxzZTsKCi8qKiovIH0pLAovKiAzOSAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgZ2xvYmFsID0gX193X3BkZmpzX3JlcXVpcmVfXyg4KTsKdmFyIGRlZmluZUdsb2JhbFByb3BlcnR5ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0MCk7CnZhciBTSEFSRUQgPSAnX19jb3JlLWpzX3NoYXJlZF9fJzsKdmFyIHN0b3JlID0gZ2xvYmFsW1NIQVJFRF0gfHwgZGVmaW5lR2xvYmFsUHJvcGVydHkoU0hBUkVELCB7fSk7Cm1vZHVsZS5leHBvcnRzID0gc3RvcmU7CgovKioqLyB9KSwKLyogNDAgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oOCk7CnZhciBkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogdHJ5IHsKICBkZWZpbmVQcm9wZXJ0eShnbG9iYWwsIGtleSwgewogICB2YWx1ZTogdmFsdWUsCiAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgd3JpdGFibGU6IHRydWUKICB9KTsKIH0gY2F0Y2ggKGVycm9yKSB7CiAgZ2xvYmFsW2tleV0gPSB2YWx1ZTsKIH0KIHJldHVybiB2YWx1ZTsKfTsKCi8qKiovIH0pLAovKiA0MSAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgdW5jdXJyeVRoaXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE4KTsKdmFyIHRvT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Mik7CnZhciBoYXNPd25Qcm9wZXJ0eSA9IHVuY3VycnlUaGlzKHt9Lmhhc093blByb3BlcnR5KTsKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuaGFzT3duIHx8IGZ1bmN0aW9uIGhhc093bihpdCwga2V5KSB7CiByZXR1cm4gaGFzT3duUHJvcGVydHkodG9PYmplY3QoaXQpLCBrZXkpOwp9OwoKLyoqKi8gfSksCi8qIDQyICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciByZXF1aXJlT2JqZWN0Q29lcmNpYmxlID0gX193X3BkZmpzX3JlcXVpcmVfXygyMCk7CnZhciAkT2JqZWN0ID0gT2JqZWN0Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcmd1bWVudCkgewogcmV0dXJuICRPYmplY3QocmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudCkpOwp9OwoKLyoqKi8gfSksCi8qIDQzICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciB1bmN1cnJ5VGhpcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTgpOwp2YXIgaWQgPSAwOwp2YXIgcG9zdGZpeCA9IE1hdGgucmFuZG9tKCk7CnZhciB0b1N0cmluZyA9IHVuY3VycnlUaGlzKDEuMC50b1N0cmluZyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSkgewogcmV0dXJuICdTeW1ib2woJyArIChrZXkgPT09IHVuZGVmaW5lZCA/ICcnIDoga2V5KSArICcpXycgKyB0b1N0cmluZygrK2lkICsgcG9zdGZpeCwgMzYpOwp9OwoKLyoqKi8gfSksCi8qIDQ0ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBERVNDUklQVE9SUyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwp2YXIgZmFpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIGNyZWF0ZUVsZW1lbnQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ1KTsKbW9kdWxlLmV4cG9ydHMgPSAhREVTQ1JJUFRPUlMgJiYgIWZhaWxzKGZ1bmN0aW9uICgpIHsKIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3JlYXRlRWxlbWVudCgnZGl2JyksICdhJywgewogIGdldDogZnVuY3Rpb24gKCkgewogICByZXR1cm4gNzsKICB9CiB9KS5hICE9IDc7Cn0pOwoKLyoqKi8gfSksCi8qIDQ1ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzKTsKdmFyIGRvY3VtZW50ID0gZ2xvYmFsLmRvY3VtZW50Owp2YXIgRVhJU1RTID0gaXNPYmplY3QoZG9jdW1lbnQpICYmIGlzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkgewogcmV0dXJuIEVYSVNUUyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cn07CgovKioqLyB9KSwKLyogNDYgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBkZWZpbmVQcm9wZXJ0eU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNDcpOwp2YXIgY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yID0gX193X3BkZmpzX3JlcXVpcmVfXygxNSk7Cm1vZHVsZS5leHBvcnRzID0gREVTQ1JJUFRPUlMgPyBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7CiByZXR1cm4gZGVmaW5lUHJvcGVydHlNb2R1bGUuZihvYmplY3QsIGtleSwgY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yKDEsIHZhbHVlKSk7Cn0gOiBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7CiBvYmplY3Rba2V5XSA9IHZhbHVlOwogcmV0dXJuIG9iamVjdDsKfTsKCi8qKiovIH0pLAovKiA0NyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgREVTQ1JJUFRPUlMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyIElFOF9ET01fREVGSU5FID0gX193X3BkZmpzX3JlcXVpcmVfXyg0NCk7CnZhciBWOF9QUk9UT1RZUEVfREVGSU5FX0JVRyA9IF9fd19wZGZqc19yZXF1aXJlX18oNDgpOwp2YXIgYW5PYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ5KTsKdmFyIHRvUHJvcGVydHlLZXkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxKTsKdmFyICRUeXBlRXJyb3IgPSBUeXBlRXJyb3I7CnZhciAkZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7CnZhciAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKdmFyIEVOVU1FUkFCTEUgPSAnZW51bWVyYWJsZSc7CnZhciBDT05GSUdVUkFCTEUgPSAnY29uZmlndXJhYmxlJzsKdmFyIFdSSVRBQkxFID0gJ3dyaXRhYmxlJzsKZXhwb3J0cy5mID0gREVTQ1JJUFRPUlMgPyBWOF9QUk9UT1RZUEVfREVGSU5FX0JVRyA/IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpIHsKIGFuT2JqZWN0KE8pOwogUCA9IHRvUHJvcGVydHlLZXkoUCk7CiBhbk9iamVjdChBdHRyaWJ1dGVzKTsKIGlmICh0eXBlb2YgTyA9PT0gJ2Z1bmN0aW9uJyAmJiBQID09PSAncHJvdG90eXBlJyAmJiAndmFsdWUnIGluIEF0dHJpYnV0ZXMgJiYgV1JJVEFCTEUgaW4gQXR0cmlidXRlcyAmJiAhQXR0cmlidXRlc1tXUklUQUJMRV0pIHsKICB2YXIgY3VycmVudCA9ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCk7CiAgaWYgKGN1cnJlbnQgJiYgY3VycmVudFtXUklUQUJMRV0pIHsKICAgT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CiAgIEF0dHJpYnV0ZXMgPSB7CiAgICBjb25maWd1cmFibGU6IENPTkZJR1VSQUJMRSBpbiBBdHRyaWJ1dGVzID8gQXR0cmlidXRlc1tDT05GSUdVUkFCTEVdIDogY3VycmVudFtDT05GSUdVUkFCTEVdLAogICAgZW51bWVyYWJsZTogRU5VTUVSQUJMRSBpbiBBdHRyaWJ1dGVzID8gQXR0cmlidXRlc1tFTlVNRVJBQkxFXSA6IGN1cnJlbnRbRU5VTUVSQUJMRV0sCiAgICB3cml0YWJsZTogZmFsc2UKICAgfTsKICB9CiB9CiByZXR1cm4gJGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpOwp9IDogJGRlZmluZVByb3BlcnR5IDogZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykgewogYW5PYmplY3QoTyk7CiBQID0gdG9Qcm9wZXJ0eUtleShQKTsKIGFuT2JqZWN0KEF0dHJpYnV0ZXMpOwogaWYgKElFOF9ET01fREVGSU5FKQogIHRyeSB7CiAgIHJldHVybiAkZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcyk7CiAgfSBjYXRjaCAoZXJyb3IpIHsKICB9CiBpZiAoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKQogIHRocm93ICRUeXBlRXJyb3IoJ0FjY2Vzc29ycyBub3Qgc3VwcG9ydGVkJyk7CiBpZiAoJ3ZhbHVlJyBpbiBBdHRyaWJ1dGVzKQogIE9bUF0gPSBBdHRyaWJ1dGVzLnZhbHVlOwogcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNDggKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBmYWlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwptb2R1bGUuZXhwb3J0cyA9IERFU0NSSVBUT1JTICYmIGZhaWxzKGZ1bmN0aW9uICgpIHsKIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoZnVuY3Rpb24gKCkgewogfSwgJ3Byb3RvdHlwZScsIHsKICB2YWx1ZTogNDIsCiAgd3JpdGFibGU6IGZhbHNlCiB9KS5wcm90b3R5cGUgIT0gNDI7Cn0pOwoKLyoqKi8gfSksCi8qIDQ5ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBpc09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgJFN0cmluZyA9IFN0cmluZzsKdmFyICRUeXBlRXJyb3IgPSBUeXBlRXJyb3I7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGFyZ3VtZW50KSB7CiBpZiAoaXNPYmplY3QoYXJndW1lbnQpKQogIHJldHVybiBhcmd1bWVudDsKIHRocm93ICRUeXBlRXJyb3IoJFN0cmluZyhhcmd1bWVudCkgKyAnIGlzIG5vdCBhbiBvYmplY3QnKTsKfTsKCi8qKiovIH0pLAovKiA1MCAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgaXNDYWxsYWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjQpOwp2YXIgZGVmaW5lUHJvcGVydHlNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ3KTsKdmFyIG1ha2VCdWlsdEluID0gX193X3BkZmpzX3JlcXVpcmVfXyg1MSk7CnZhciBkZWZpbmVHbG9iYWxQcm9wZXJ0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oNDApOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChPLCBrZXksIHZhbHVlLCBvcHRpb25zKSB7CiBpZiAoIW9wdGlvbnMpCiAgb3B0aW9ucyA9IHt9OwogdmFyIHNpbXBsZSA9IG9wdGlvbnMuZW51bWVyYWJsZTsKIHZhciBuYW1lID0gb3B0aW9ucy5uYW1lICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm5hbWUgOiBrZXk7CiBpZiAoaXNDYWxsYWJsZSh2YWx1ZSkpCiAgbWFrZUJ1aWx0SW4odmFsdWUsIG5hbWUsIG9wdGlvbnMpOwogaWYgKG9wdGlvbnMuZ2xvYmFsKSB7CiAgaWYgKHNpbXBsZSkKICAgT1trZXldID0gdmFsdWU7CiAgZWxzZQogICBkZWZpbmVHbG9iYWxQcm9wZXJ0eShrZXksIHZhbHVlKTsKIH0gZWxzZSB7CiAgdHJ5IHsKICAgaWYgKCFvcHRpb25zLnVuc2FmZSkKICAgIGRlbGV0ZSBPW2tleV07CiAgIGVsc2UgaWYgKE9ba2V5XSkKICAgIHNpbXBsZSA9IHRydWU7CiAgfSBjYXRjaCAoZXJyb3IpIHsKICB9CiAgaWYgKHNpbXBsZSkKICAgT1trZXldID0gdmFsdWU7CiAgZWxzZQogICBkZWZpbmVQcm9wZXJ0eU1vZHVsZS5mKE8sIGtleSwgewogICAgdmFsdWU6IHZhbHVlLAogICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICBjb25maWd1cmFibGU6ICFvcHRpb25zLm5vbkNvbmZpZ3VyYWJsZSwKICAgIHdyaXRhYmxlOiAhb3B0aW9ucy5ub25Xcml0YWJsZQogICB9KTsKIH0KIHJldHVybiBPOwp9OwoKLyoqKi8gfSksCi8qIDUxICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBmYWlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwp2YXIgaXNDYWxsYWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjQpOwp2YXIgaGFzT3duID0gX193X3BkZmpzX3JlcXVpcmVfXyg0MSk7CnZhciBERVNDUklQVE9SUyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwp2YXIgQ09ORklHVVJBQkxFX0ZVTkNUSU9OX05BTUUgPSAoX193X3BkZmpzX3JlcXVpcmVfXyg1MikuQ09ORklHVVJBQkxFKTsKdmFyIGluc3BlY3RTb3VyY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUzKTsKdmFyIEludGVybmFsU3RhdGVNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU0KTsKdmFyIGVuZm9yY2VJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5lbmZvcmNlOwp2YXIgZ2V0SW50ZXJuYWxTdGF0ZSA9IEludGVybmFsU3RhdGVNb2R1bGUuZ2V0Owp2YXIgZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7CnZhciBDT05GSUdVUkFCTEVfTEVOR1RIID0gREVTQ1JJUFRPUlMgJiYgIWZhaWxzKGZ1bmN0aW9uICgpIHsKIHJldHVybiBkZWZpbmVQcm9wZXJ0eShmdW5jdGlvbiAoKSB7CiB9LCAnbGVuZ3RoJywgeyB2YWx1ZTogOCB9KS5sZW5ndGggIT09IDg7Cn0pOwp2YXIgVEVNUExBVEUgPSBTdHJpbmcoU3RyaW5nKS5zcGxpdCgnU3RyaW5nJyk7CnZhciBtYWtlQnVpbHRJbiA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHZhbHVlLCBuYW1lLCBvcHRpb25zKSB7CiBpZiAoU3RyaW5nKG5hbWUpLnNsaWNlKDAsIDcpID09PSAnU3ltYm9sKCcpIHsKICBuYW1lID0gJ1snICsgU3RyaW5nKG5hbWUpLnJlcGxhY2UoL15TeW1ib2xcKChbXildKilcKS8sICckMScpICsgJ10nOwogfQogaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5nZXR0ZXIpCiAgbmFtZSA9ICdnZXQgJyArIG5hbWU7CiBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnNldHRlcikKICBuYW1lID0gJ3NldCAnICsgbmFtZTsKIGlmICghaGFzT3duKHZhbHVlLCAnbmFtZScpIHx8IENPTkZJR1VSQUJMRV9GVU5DVElPTl9OQU1FICYmIHZhbHVlLm5hbWUgIT09IG5hbWUpIHsKICBpZiAoREVTQ1JJUFRPUlMpCiAgIGRlZmluZVByb3BlcnR5KHZhbHVlLCAnbmFtZScsIHsKICAgIHZhbHVlOiBuYW1lLAogICAgY29uZmlndXJhYmxlOiB0cnVlCiAgIH0pOwogIGVsc2UKICAgdmFsdWUubmFtZSA9IG5hbWU7CiB9CiBpZiAoQ09ORklHVVJBQkxFX0xFTkdUSCAmJiBvcHRpb25zICYmIGhhc093bihvcHRpb25zLCAnYXJpdHknKSAmJiB2YWx1ZS5sZW5ndGggIT09IG9wdGlvbnMuYXJpdHkpIHsKICBkZWZpbmVQcm9wZXJ0eSh2YWx1ZSwgJ2xlbmd0aCcsIHsgdmFsdWU6IG9wdGlvbnMuYXJpdHkgfSk7CiB9CiB0cnkgewogIGlmIChvcHRpb25zICYmIGhhc093bihvcHRpb25zLCAnY29uc3RydWN0b3InKSAmJiBvcHRpb25zLmNvbnN0cnVjdG9yKSB7CiAgIGlmIChERVNDUklQVE9SUykKICAgIGRlZmluZVByb3BlcnR5KHZhbHVlLCAncHJvdG90eXBlJywgeyB3cml0YWJsZTogZmFsc2UgfSk7CiAgfSBlbHNlIGlmICh2YWx1ZS5wcm90b3R5cGUpCiAgIHZhbHVlLnByb3RvdHlwZSA9IHVuZGVmaW5lZDsKIH0gY2F0Y2ggKGVycm9yKSB7CiB9CiB2YXIgc3RhdGUgPSBlbmZvcmNlSW50ZXJuYWxTdGF0ZSh2YWx1ZSk7CiBpZiAoIWhhc093bihzdGF0ZSwgJ3NvdXJjZScpKSB7CiAgc3RhdGUuc291cmNlID0gVEVNUExBVEUuam9pbih0eXBlb2YgbmFtZSA9PSAnc3RyaW5nJyA/IG5hbWUgOiAnJyk7CiB9CiByZXR1cm4gdmFsdWU7Cn07CkZ1bmN0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IG1ha2VCdWlsdEluKGZ1bmN0aW9uIHRvU3RyaW5nKCkgewogcmV0dXJuIGlzQ2FsbGFibGUodGhpcykgJiYgZ2V0SW50ZXJuYWxTdGF0ZSh0aGlzKS5zb3VyY2UgfHwgaW5zcGVjdFNvdXJjZSh0aGlzKTsKfSwgJ3RvU3RyaW5nJyk7CgovKioqLyB9KSwKLyogNTIgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBoYXNPd24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQxKTsKdmFyIEZ1bmN0aW9uUHJvdG90eXBlID0gRnVuY3Rpb24ucHJvdG90eXBlOwp2YXIgZ2V0RGVzY3JpcHRvciA9IERFU0NSSVBUT1JTICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CnZhciBFWElTVFMgPSBoYXNPd24oRnVuY3Rpb25Qcm90b3R5cGUsICduYW1lJyk7CnZhciBQUk9QRVIgPSBFWElTVFMgJiYgZnVuY3Rpb24gc29tZXRoaW5nKCkgewp9Lm5hbWUgPT09ICdzb21ldGhpbmcnOwp2YXIgQ09ORklHVVJBQkxFID0gRVhJU1RTICYmICghREVTQ1JJUFRPUlMgfHwgREVTQ1JJUFRPUlMgJiYgZ2V0RGVzY3JpcHRvcihGdW5jdGlvblByb3RvdHlwZSwgJ25hbWUnKS5jb25maWd1cmFibGUpOwptb2R1bGUuZXhwb3J0cyA9IHsKIEVYSVNUUzogRVhJU1RTLAogUFJPUEVSOiBQUk9QRVIsCiBDT05GSUdVUkFCTEU6IENPTkZJR1VSQUJMRQp9OwoKLyoqKi8gfSksCi8qIDUzICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciB1bmN1cnJ5VGhpcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTgpOwp2YXIgaXNDYWxsYWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjQpOwp2YXIgc3RvcmUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM5KTsKdmFyIGZ1bmN0aW9uVG9TdHJpbmcgPSB1bmN1cnJ5VGhpcyhGdW5jdGlvbi50b1N0cmluZyk7CmlmICghaXNDYWxsYWJsZShzdG9yZS5pbnNwZWN0U291cmNlKSkgewogc3RvcmUuaW5zcGVjdFNvdXJjZSA9IGZ1bmN0aW9uIChpdCkgewogIHJldHVybiBmdW5jdGlvblRvU3RyaW5nKGl0KTsKIH07Cn0KbW9kdWxlLmV4cG9ydHMgPSBzdG9yZS5pbnNwZWN0U291cmNlOwoKLyoqKi8gfSksCi8qIDU0ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBOQVRJVkVfV0VBS19NQVAgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU1KTsKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oOCk7CnZhciB1bmN1cnJ5VGhpcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTgpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzKTsKdmFyIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oNDYpOwp2YXIgaGFzT3duID0gX193X3BkZmpzX3JlcXVpcmVfXyg0MSk7CnZhciBzaGFyZWQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM5KTsKdmFyIHNoYXJlZEtleSA9IF9fd19wZGZqc19yZXF1aXJlX18oNTYpOwp2YXIgaGlkZGVuS2V5cyA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgT0JKRUNUX0FMUkVBRFlfSU5JVElBTElaRUQgPSAnT2JqZWN0IGFscmVhZHkgaW5pdGlhbGl6ZWQnOwp2YXIgVHlwZUVycm9yID0gZ2xvYmFsLlR5cGVFcnJvcjsKdmFyIFdlYWtNYXAgPSBnbG9iYWwuV2Vha01hcDsKdmFyIHNldCwgZ2V0LCBoYXM7CnZhciBlbmZvcmNlID0gZnVuY3Rpb24gKGl0KSB7CiByZXR1cm4gaGFzKGl0KSA/IGdldChpdCkgOiBzZXQoaXQsIHt9KTsKfTsKdmFyIGdldHRlckZvciA9IGZ1bmN0aW9uIChUWVBFKSB7CiByZXR1cm4gZnVuY3Rpb24gKGl0KSB7CiAgdmFyIHN0YXRlOwogIGlmICghaXNPYmplY3QoaXQpIHx8IChzdGF0ZSA9IGdldChpdCkpLnR5cGUgIT09IFRZUEUpIHsKICAgdGhyb3cgVHlwZUVycm9yKCdJbmNvbXBhdGlibGUgcmVjZWl2ZXIsICcgKyBUWVBFICsgJyByZXF1aXJlZCcpOwogIH0KICByZXR1cm4gc3RhdGU7CiB9Owp9OwppZiAoTkFUSVZFX1dFQUtfTUFQIHx8IHNoYXJlZC5zdGF0ZSkgewogdmFyIHN0b3JlID0gc2hhcmVkLnN0YXRlIHx8IChzaGFyZWQuc3RhdGUgPSBuZXcgV2Vha01hcCgpKTsKIHZhciB3bWdldCA9IHVuY3VycnlUaGlzKHN0b3JlLmdldCk7CiB2YXIgd21oYXMgPSB1bmN1cnJ5VGhpcyhzdG9yZS5oYXMpOwogdmFyIHdtc2V0ID0gdW5jdXJyeVRoaXMoc3RvcmUuc2V0KTsKIHNldCA9IGZ1bmN0aW9uIChpdCwgbWV0YWRhdGEpIHsKICBpZiAod21oYXMoc3RvcmUsIGl0KSkKICAgdGhyb3cgbmV3IFR5cGVFcnJvcihPQkpFQ1RfQUxSRUFEWV9JTklUSUFMSVpFRCk7CiAgbWV0YWRhdGEuZmFjYWRlID0gaXQ7CiAgd21zZXQoc3RvcmUsIGl0LCBtZXRhZGF0YSk7CiAgcmV0dXJuIG1ldGFkYXRhOwogfTsKIGdldCA9IGZ1bmN0aW9uIChpdCkgewogIHJldHVybiB3bWdldChzdG9yZSwgaXQpIHx8IHt9OwogfTsKIGhhcyA9IGZ1bmN0aW9uIChpdCkgewogIHJldHVybiB3bWhhcyhzdG9yZSwgaXQpOwogfTsKfSBlbHNlIHsKIHZhciBTVEFURSA9IHNoYXJlZEtleSgnc3RhdGUnKTsKIGhpZGRlbktleXNbU1RBVEVdID0gdHJ1ZTsKIHNldCA9IGZ1bmN0aW9uIChpdCwgbWV0YWRhdGEpIHsKICBpZiAoaGFzT3duKGl0LCBTVEFURSkpCiAgIHRocm93IG5ldyBUeXBlRXJyb3IoT0JKRUNUX0FMUkVBRFlfSU5JVElBTElaRUQpOwogIG1ldGFkYXRhLmZhY2FkZSA9IGl0OwogIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShpdCwgU1RBVEUsIG1ldGFkYXRhKTsKICByZXR1cm4gbWV0YWRhdGE7CiB9OwogZ2V0ID0gZnVuY3Rpb24gKGl0KSB7CiAgcmV0dXJuIGhhc093bihpdCwgU1RBVEUpID8gaXRbU1RBVEVdIDoge307CiB9OwogaGFzID0gZnVuY3Rpb24gKGl0KSB7CiAgcmV0dXJuIGhhc093bihpdCwgU1RBVEUpOwogfTsKfQptb2R1bGUuZXhwb3J0cyA9IHsKIHNldDogc2V0LAogZ2V0OiBnZXQsCiBoYXM6IGhhcywKIGVuZm9yY2U6IGVuZm9yY2UsCiBnZXR0ZXJGb3I6IGdldHRlckZvcgp9OwoKLyoqKi8gfSksCi8qIDU1ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgpOwp2YXIgaXNDYWxsYWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjQpOwp2YXIgaW5zcGVjdFNvdXJjZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNTMpOwp2YXIgV2Vha01hcCA9IGdsb2JhbC5XZWFrTWFwOwptb2R1bGUuZXhwb3J0cyA9IGlzQ2FsbGFibGUoV2Vha01hcCkgJiYgL25hdGl2ZSBjb2RlLy50ZXN0KGluc3BlY3RTb3VyY2UoV2Vha01hcCkpOwoKLyoqKi8gfSksCi8qIDU2ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBzaGFyZWQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM3KTsKdmFyIHVpZCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDMpOwp2YXIga2V5cyA9IHNoYXJlZCgna2V5cycpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChrZXkpIHsKIHJldHVybiBrZXlzW2tleV0gfHwgKGtleXNba2V5XSA9IHVpZChrZXkpKTsKfTsKCi8qKiovIH0pLAovKiA1NyAqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSB7fTsKCi8qKiovIH0pLAovKiA1OCAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgaGFzT3duID0gX193X3BkZmpzX3JlcXVpcmVfXyg0MSk7CnZhciBvd25LZXlzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1OSk7CnZhciBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDkpOwp2YXIgZGVmaW5lUHJvcGVydHlNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ3KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodGFyZ2V0LCBzb3VyY2UsIGV4Y2VwdGlvbnMpIHsKIHZhciBrZXlzID0gb3duS2V5cyhzb3VyY2UpOwogdmFyIGRlZmluZVByb3BlcnR5ID0gZGVmaW5lUHJvcGVydHlNb2R1bGUuZjsKIHZhciBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JNb2R1bGUuZjsKIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogIHZhciBrZXkgPSBrZXlzW2ldOwogIGlmICghaGFzT3duKHRhcmdldCwga2V5KSAmJiAhKGV4Y2VwdGlvbnMgJiYgaGFzT3duKGV4Y2VwdGlvbnMsIGtleSkpKSB7CiAgIGRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICB9CiB9Cn07CgovKioqLyB9KSwKLyogNTkgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGdldEJ1aWx0SW4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI2KTsKdmFyIHVuY3VycnlUaGlzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOCk7CnZhciBnZXRPd25Qcm9wZXJ0eU5hbWVzTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXyg2MCk7CnZhciBnZXRPd25Qcm9wZXJ0eVN5bWJvbHNNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDY5KTsKdmFyIGFuT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0OSk7CnZhciBjb25jYXQgPSB1bmN1cnJ5VGhpcyhbXS5jb25jYXQpOwptb2R1bGUuZXhwb3J0cyA9IGdldEJ1aWx0SW4oJ1JlZmxlY3QnLCAnb3duS2V5cycpIHx8IGZ1bmN0aW9uIG93bktleXMoaXQpIHsKIHZhciBrZXlzID0gZ2V0T3duUHJvcGVydHlOYW1lc01vZHVsZS5mKGFuT2JqZWN0KGl0KSk7CiB2YXIgZ2V0T3duUHJvcGVydHlTeW1ib2xzID0gZ2V0T3duUHJvcGVydHlTeW1ib2xzTW9kdWxlLmY7CiByZXR1cm4gZ2V0T3duUHJvcGVydHlTeW1ib2xzID8gY29uY2F0KGtleXMsIGdldE93blByb3BlcnR5U3ltYm9scyhpdCkpIDoga2V5czsKfTsKCi8qKiovIH0pLAovKiA2MCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgaW50ZXJuYWxPYmplY3RLZXlzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2MSk7CnZhciBlbnVtQnVnS2V5cyA9IF9fd19wZGZqc19yZXF1aXJlX18oNjgpOwp2YXIgaGlkZGVuS2V5cyA9IGVudW1CdWdLZXlzLmNvbmNhdCgnbGVuZ3RoJywgJ3Byb3RvdHlwZScpOwpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKE8pIHsKIHJldHVybiBpbnRlcm5hbE9iamVjdEtleXMoTywgaGlkZGVuS2V5cyk7Cn07CgovKioqLyB9KSwKLyogNjEgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHVuY3VycnlUaGlzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOCk7CnZhciBoYXNPd24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQxKTsKdmFyIHRvSW5kZXhlZE9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTYpOwp2YXIgaW5kZXhPZiA9IChfX3dfcGRmanNfcmVxdWlyZV9fKDYyKS5pbmRleE9mKTsKdmFyIGhpZGRlbktleXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU3KTsKdmFyIHB1c2ggPSB1bmN1cnJ5VGhpcyhbXS5wdXNoKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob2JqZWN0LCBuYW1lcykgewogdmFyIE8gPSB0b0luZGV4ZWRPYmplY3Qob2JqZWN0KTsKIHZhciBpID0gMDsKIHZhciByZXN1bHQgPSBbXTsKIHZhciBrZXk7CiBmb3IgKGtleSBpbiBPKQogICFoYXNPd24oaGlkZGVuS2V5cywga2V5KSAmJiBoYXNPd24oTywga2V5KSAmJiBwdXNoKHJlc3VsdCwga2V5KTsKIHdoaWxlIChuYW1lcy5sZW5ndGggPiBpKQogIGlmIChoYXNPd24oTywga2V5ID0gbmFtZXNbaSsrXSkpIHsKICAgfmluZGV4T2YocmVzdWx0LCBrZXkpIHx8IHB1c2gocmVzdWx0LCBrZXkpOwogIH0KIHJldHVybiByZXN1bHQ7Cn07CgovKioqLyB9KSwKLyogNjIgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHRvSW5kZXhlZE9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTYpOwp2YXIgdG9BYnNvbHV0ZUluZGV4ID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Myk7CnZhciBsZW5ndGhPZkFycmF5TGlrZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNjYpOwp2YXIgY3JlYXRlTWV0aG9kID0gZnVuY3Rpb24gKElTX0lOQ0xVREVTKSB7CiByZXR1cm4gZnVuY3Rpb24gKCR0aGlzLCBlbCwgZnJvbUluZGV4KSB7CiAgdmFyIE8gPSB0b0luZGV4ZWRPYmplY3QoJHRoaXMpOwogIHZhciBsZW5ndGggPSBsZW5ndGhPZkFycmF5TGlrZShPKTsKICB2YXIgaW5kZXggPSB0b0Fic29sdXRlSW5kZXgoZnJvbUluZGV4LCBsZW5ndGgpOwogIHZhciB2YWx1ZTsKICBpZiAoSVNfSU5DTFVERVMgJiYgZWwgIT0gZWwpCiAgIHdoaWxlIChsZW5ndGggPiBpbmRleCkgewogICAgdmFsdWUgPSBPW2luZGV4KytdOwogICAgaWYgKHZhbHVlICE9IHZhbHVlKQogICAgIHJldHVybiB0cnVlOwogICB9CiAgZWxzZQogICBmb3IgKDsgbGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIHsKICAgIGlmICgoSVNfSU5DTFVERVMgfHwgaW5kZXggaW4gTykgJiYgT1tpbmRleF0gPT09IGVsKQogICAgIHJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwOwogICB9CiAgcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTsKIH07Cn07Cm1vZHVsZS5leHBvcnRzID0gewogaW5jbHVkZXM6IGNyZWF0ZU1ldGhvZCh0cnVlKSwKIGluZGV4T2Y6IGNyZWF0ZU1ldGhvZChmYWxzZSkKfTsKCi8qKiovIH0pLAovKiA2MyAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgdG9JbnRlZ2VyT3JJbmZpbml0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oNjQpOwp2YXIgbWF4ID0gTWF0aC5tYXg7CnZhciBtaW4gPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaW5kZXgsIGxlbmd0aCkgewogdmFyIGludGVnZXIgPSB0b0ludGVnZXJPckluZmluaXR5KGluZGV4KTsKIHJldHVybiBpbnRlZ2VyIDwgMCA/IG1heChpbnRlZ2VyICsgbGVuZ3RoLCAwKSA6IG1pbihpbnRlZ2VyLCBsZW5ndGgpOwp9OwoKLyoqKi8gfSksCi8qIDY0ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciB0cnVuYyA9IF9fd19wZGZqc19yZXF1aXJlX18oNjUpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcmd1bWVudCkgewogdmFyIG51bWJlciA9ICthcmd1bWVudDsKIHJldHVybiBudW1iZXIgIT09IG51bWJlciB8fCBudW1iZXIgPT09IDAgPyAwIDogdHJ1bmMobnVtYmVyKTsKfTsKCi8qKiovIH0pLAovKiA2NSAqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKdmFyIGNlaWwgPSBNYXRoLmNlaWw7CnZhciBmbG9vciA9IE1hdGguZmxvb3I7Cm1vZHVsZS5leHBvcnRzID0gTWF0aC50cnVuYyB8fCBmdW5jdGlvbiB0cnVuYyh4KSB7CiB2YXIgbiA9ICt4OwogcmV0dXJuIChuID4gMCA/IGZsb29yIDogY2VpbCkobik7Cn07CgovKioqLyB9KSwKLyogNjYgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHRvTGVuZ3RoID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Nyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9iaikgewogcmV0dXJuIHRvTGVuZ3RoKG9iai5sZW5ndGgpOwp9OwoKLyoqKi8gfSksCi8qIDY3ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciB0b0ludGVnZXJPckluZmluaXR5ID0gX193X3BkZmpzX3JlcXVpcmVfXyg2NCk7CnZhciBtaW4gPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXJndW1lbnQpIHsKIHJldHVybiBhcmd1bWVudCA+IDAgPyBtaW4odG9JbnRlZ2VyT3JJbmZpbml0eShhcmd1bWVudCksIDB4MUZGRkZGRkZGRkZGRkYpIDogMDsKfTsKCi8qKiovIH0pLAovKiA2OCAqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSBbCiAnY29uc3RydWN0b3InLAogJ2hhc093blByb3BlcnR5JywKICdpc1Byb3RvdHlwZU9mJywKICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsCiAndG9Mb2NhbGVTdHJpbmcnLAogJ3RvU3RyaW5nJywKICd2YWx1ZU9mJwpdOwoKLyoqKi8gfSksCi8qIDY5ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHsKCmV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7CgovKioqLyB9KSwKLyogNzAgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBpc0NhbGxhYmxlID0gX193X3BkZmpzX3JlcXVpcmVfXygyNCk7CnZhciByZXBsYWNlbWVudCA9IC8jfFwucHJvdG90eXBlXC4vOwp2YXIgaXNGb3JjZWQgPSBmdW5jdGlvbiAoZmVhdHVyZSwgZGV0ZWN0aW9uKSB7CiB2YXIgdmFsdWUgPSBkYXRhW25vcm1hbGl6ZShmZWF0dXJlKV07CiByZXR1cm4gdmFsdWUgPT0gUE9MWUZJTEwgPyB0cnVlIDogdmFsdWUgPT0gTkFUSVZFID8gZmFsc2UgOiBpc0NhbGxhYmxlKGRldGVjdGlvbikgPyBmYWlscyhkZXRlY3Rpb24pIDogISFkZXRlY3Rpb247Cn07CnZhciBub3JtYWxpemUgPSBpc0ZvcmNlZC5ub3JtYWxpemUgPSBmdW5jdGlvbiAoc3RyaW5nKSB7CiByZXR1cm4gU3RyaW5nKHN0cmluZykucmVwbGFjZShyZXBsYWNlbWVudCwgJy4nKS50b0xvd2VyQ2FzZSgpOwp9Owp2YXIgZGF0YSA9IGlzRm9yY2VkLmRhdGEgPSB7fTsKdmFyIE5BVElWRSA9IGlzRm9yY2VkLk5BVElWRSA9ICdOJzsKdmFyIFBPTFlGSUxMID0gaXNGb3JjZWQuUE9MWUZJTEwgPSAnUCc7Cm1vZHVsZS5leHBvcnRzID0gaXNGb3JjZWQ7CgovKioqLyB9KSwKLyogNzEgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzYpOwp2YXIgY3JlYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXyg3Mik7CnZhciBkZWZpbmVQcm9wZXJ0eSA9IChfX3dfcGRmanNfcmVxdWlyZV9fKDQ3KS5mKTsKdmFyIFVOU0NPUEFCTEVTID0gd2VsbEtub3duU3ltYm9sKCd1bnNjb3BhYmxlcycpOwp2YXIgQXJyYXlQcm90b3R5cGUgPSBBcnJheS5wcm90b3R5cGU7CmlmIChBcnJheVByb3RvdHlwZVtVTlNDT1BBQkxFU10gPT0gdW5kZWZpbmVkKSB7CiBkZWZpbmVQcm9wZXJ0eShBcnJheVByb3RvdHlwZSwgVU5TQ09QQUJMRVMsIHsKICBjb25maWd1cmFibGU6IHRydWUsCiAgdmFsdWU6IGNyZWF0ZShudWxsKQogfSk7Cn0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoa2V5KSB7CiBBcnJheVByb3RvdHlwZVtVTlNDT1BBQkxFU11ba2V5XSA9IHRydWU7Cn07CgovKioqLyB9KSwKLyogNzIgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGFuT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0OSk7CnZhciBkZWZpbmVQcm9wZXJ0aWVzTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXyg3Myk7CnZhciBlbnVtQnVnS2V5cyA9IF9fd19wZGZqc19yZXF1aXJlX18oNjgpOwp2YXIgaGlkZGVuS2V5cyA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgaHRtbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNzUpOwp2YXIgZG9jdW1lbnRDcmVhdGVFbGVtZW50ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0NSk7CnZhciBzaGFyZWRLZXkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU2KTsKdmFyIEdUID0gJz4nOwp2YXIgTFQgPSAnPCc7CnZhciBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsKdmFyIFNDUklQVCA9ICdzY3JpcHQnOwp2YXIgSUVfUFJPVE8gPSBzaGFyZWRLZXkoJ0lFX1BST1RPJyk7CnZhciBFbXB0eUNvbnN0cnVjdG9yID0gZnVuY3Rpb24gKCkgewp9Owp2YXIgc2NyaXB0VGFnID0gZnVuY3Rpb24gKGNvbnRlbnQpIHsKIHJldHVybiBMVCArIFNDUklQVCArIEdUICsgY29udGVudCArIExUICsgJy8nICsgU0NSSVBUICsgR1Q7Cn07CnZhciBOdWxsUHJvdG9PYmplY3RWaWFBY3RpdmVYID0gZnVuY3Rpb24gKGFjdGl2ZVhEb2N1bWVudCkgewogYWN0aXZlWERvY3VtZW50LndyaXRlKHNjcmlwdFRhZygnJykpOwogYWN0aXZlWERvY3VtZW50LmNsb3NlKCk7CiB2YXIgdGVtcCA9IGFjdGl2ZVhEb2N1bWVudC5wYXJlbnRXaW5kb3cuT2JqZWN0OwogYWN0aXZlWERvY3VtZW50ID0gbnVsbDsKIHJldHVybiB0ZW1wOwp9Owp2YXIgTnVsbFByb3RvT2JqZWN0VmlhSUZyYW1lID0gZnVuY3Rpb24gKCkgewogdmFyIGlmcmFtZSA9IGRvY3VtZW50Q3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7CiB2YXIgSlMgPSAnamF2YScgKyBTQ1JJUFQgKyAnOic7CiB2YXIgaWZyYW1lRG9jdW1lbnQ7CiBpZnJhbWUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKIGh0bWwuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKIGlmcmFtZS5zcmMgPSBTdHJpbmcoSlMpOwogaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKIGlmcmFtZURvY3VtZW50Lm9wZW4oKTsKIGlmcmFtZURvY3VtZW50LndyaXRlKHNjcmlwdFRhZygnZG9jdW1lbnQuRj1PYmplY3QnKSk7CiBpZnJhbWVEb2N1bWVudC5jbG9zZSgpOwogcmV0dXJuIGlmcmFtZURvY3VtZW50LkY7Cn07CnZhciBhY3RpdmVYRG9jdW1lbnQ7CnZhciBOdWxsUHJvdG9PYmplY3QgPSBmdW5jdGlvbiAoKSB7CiB0cnkgewogIGFjdGl2ZVhEb2N1bWVudCA9IG5ldyBBY3RpdmVYT2JqZWN0KCdodG1sZmlsZScpOwogfSBjYXRjaCAoZXJyb3IpIHsKIH0KIE51bGxQcm90b09iamVjdCA9IHR5cGVvZiBkb2N1bWVudCAhPSAndW5kZWZpbmVkJyA/IGRvY3VtZW50LmRvbWFpbiAmJiBhY3RpdmVYRG9jdW1lbnQgPyBOdWxsUHJvdG9PYmplY3RWaWFBY3RpdmVYKGFjdGl2ZVhEb2N1bWVudCkgOiBOdWxsUHJvdG9PYmplY3RWaWFJRnJhbWUoKSA6IE51bGxQcm90b09iamVjdFZpYUFjdGl2ZVgoYWN0aXZlWERvY3VtZW50KTsKIHZhciBsZW5ndGggPSBlbnVtQnVnS2V5cy5sZW5ndGg7CiB3aGlsZSAobGVuZ3RoLS0pCiAgZGVsZXRlIE51bGxQcm90b09iamVjdFtQUk9UT1RZUEVdW2VudW1CdWdLZXlzW2xlbmd0aF1dOwogcmV0dXJuIE51bGxQcm90b09iamVjdCgpOwp9OwpoaWRkZW5LZXlzW0lFX1BST1RPXSA9IHRydWU7Cm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBjcmVhdGUoTywgUHJvcGVydGllcykgewogdmFyIHJlc3VsdDsKIGlmIChPICE9PSBudWxsKSB7CiAgRW1wdHlDb25zdHJ1Y3RvcltQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CiAgcmVzdWx0ID0gbmV3IEVtcHR5Q29uc3RydWN0b3IoKTsKICBFbXB0eUNvbnN0cnVjdG9yW1BST1RPVFlQRV0gPSBudWxsOwogIHJlc3VsdFtJRV9QUk9UT10gPSBPOwogfSBlbHNlCiAgcmVzdWx0ID0gTnVsbFByb3RvT2JqZWN0KCk7CiByZXR1cm4gUHJvcGVydGllcyA9PT0gdW5kZWZpbmVkID8gcmVzdWx0IDogZGVmaW5lUHJvcGVydGllc01vZHVsZS5mKHJlc3VsdCwgUHJvcGVydGllcyk7Cn07CgovKioqLyB9KSwKLyogNzMgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBWOF9QUk9UT1RZUEVfREVGSU5FX0JVRyA9IF9fd19wZGZqc19yZXF1aXJlX18oNDgpOwp2YXIgZGVmaW5lUHJvcGVydHlNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ3KTsKdmFyIGFuT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0OSk7CnZhciB0b0luZGV4ZWRPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2KTsKdmFyIG9iamVjdEtleXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc0KTsKZXhwb3J0cy5mID0gREVTQ1JJUFRPUlMgJiYgIVY4X1BST1RPVFlQRV9ERUZJTkVfQlVHID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpIHsKIGFuT2JqZWN0KE8pOwogdmFyIHByb3BzID0gdG9JbmRleGVkT2JqZWN0KFByb3BlcnRpZXMpOwogdmFyIGtleXMgPSBvYmplY3RLZXlzKFByb3BlcnRpZXMpOwogdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoOwogdmFyIGluZGV4ID0gMDsKIHZhciBrZXk7CiB3aGlsZSAobGVuZ3RoID4gaW5kZXgpCiAgZGVmaW5lUHJvcGVydHlNb2R1bGUuZihPLCBrZXkgPSBrZXlzW2luZGV4KytdLCBwcm9wc1trZXldKTsKIHJldHVybiBPOwp9OwoKLyoqKi8gfSksCi8qIDc0ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBpbnRlcm5hbE9iamVjdEtleXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYxKTsKdmFyIGVudW1CdWdLZXlzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2OCk7Cm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24ga2V5cyhPKSB7CiByZXR1cm4gaW50ZXJuYWxPYmplY3RLZXlzKE8sIGVudW1CdWdLZXlzKTsKfTsKCi8qKiovIH0pLAovKiA3NSAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgZ2V0QnVpbHRJbiA9IF9fd19wZGZqc19yZXF1aXJlX18oMjYpOwptb2R1bGUuZXhwb3J0cyA9IGdldEJ1aWx0SW4oJ2RvY3VtZW50JywgJ2RvY3VtZW50RWxlbWVudCcpOwoKLyoqKi8gfSksCi8qIDc2ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgpOwp2YXIgdW5jdXJyeVRoaXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE4KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoQ09OU1RSVUNUT1IsIE1FVEhPRCkgewogcmV0dXJuIHVuY3VycnlUaGlzKGdsb2JhbFtDT05TVFJVQ1RPUl0ucHJvdG90eXBlW01FVEhPRF0pOwp9OwoKLyoqKi8gfSksCi8qIDc3ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKX193X3BkZmpzX3JlcXVpcmVfXyg3OCk7CgovKioqLyB9KSwKLyogNzggKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7Cgp2YXIgQXJyYXlCdWZmZXJWaWV3Q29yZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNzkpOwp2YXIgbGVuZ3RoT2ZBcnJheUxpa2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDY2KTsKdmFyIHRvSW50ZWdlck9ySW5maW5pdHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDY0KTsKdmFyIGFUeXBlZEFycmF5ID0gQXJyYXlCdWZmZXJWaWV3Q29yZS5hVHlwZWRBcnJheTsKdmFyIGV4cG9ydFR5cGVkQXJyYXlNZXRob2QgPSBBcnJheUJ1ZmZlclZpZXdDb3JlLmV4cG9ydFR5cGVkQXJyYXlNZXRob2Q7CmV4cG9ydFR5cGVkQXJyYXlNZXRob2QoJ2F0JywgZnVuY3Rpb24gYXQoaW5kZXgpIHsKIHZhciBPID0gYVR5cGVkQXJyYXkodGhpcyk7CiB2YXIgbGVuID0gbGVuZ3RoT2ZBcnJheUxpa2UoTyk7CiB2YXIgcmVsYXRpdmVJbmRleCA9IHRvSW50ZWdlck9ySW5maW5pdHkoaW5kZXgpOwogdmFyIGsgPSByZWxhdGl2ZUluZGV4ID49IDAgPyByZWxhdGl2ZUluZGV4IDogbGVuICsgcmVsYXRpdmVJbmRleDsKIHJldHVybiBrIDwgMCB8fCBrID49IGxlbiA/IHVuZGVmaW5lZCA6IE9ba107Cn0pOwoKLyoqKi8gfSksCi8qIDc5ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBOQVRJVkVfQVJSQVlfQlVGRkVSID0gX193X3BkZmpzX3JlcXVpcmVfXyg4MCk7CnZhciBERVNDUklQVE9SUyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwp2YXIgZ2xvYmFsID0gX193X3BkZmpzX3JlcXVpcmVfXyg4KTsKdmFyIGlzQ2FsbGFibGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI0KTsKdmFyIGlzT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMyk7CnZhciBoYXNPd24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQxKTsKdmFyIGNsYXNzb2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgxKTsKdmFyIHRyeVRvU3RyaW5nID0gX193X3BkZmpzX3JlcXVpcmVfXygzNCk7CnZhciBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ2KTsKdmFyIGRlZmluZUJ1aWx0SW4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUwKTsKdmFyIGRlZmluZVByb3BlcnR5ID0gKF9fd19wZGZqc19yZXF1aXJlX18oNDcpLmYpOwp2YXIgaXNQcm90b3R5cGVPZiA9IF9fd19wZGZqc19yZXF1aXJlX18oMjcpOwp2YXIgZ2V0UHJvdG90eXBlT2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgzKTsKdmFyIHNldFByb3RvdHlwZU9mID0gX193X3BkZmpzX3JlcXVpcmVfXyg4NSk7CnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM2KTsKdmFyIHVpZCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDMpOwp2YXIgSW50ZXJuYWxTdGF0ZU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNTQpOwp2YXIgZW5mb3JjZUludGVybmFsU3RhdGUgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLmVuZm9yY2U7CnZhciBnZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5nZXQ7CnZhciBJbnQ4QXJyYXkgPSBnbG9iYWwuSW50OEFycmF5Owp2YXIgSW50OEFycmF5UHJvdG90eXBlID0gSW50OEFycmF5ICYmIEludDhBcnJheS5wcm90b3R5cGU7CnZhciBVaW50OENsYW1wZWRBcnJheSA9IGdsb2JhbC5VaW50OENsYW1wZWRBcnJheTsKdmFyIFVpbnQ4Q2xhbXBlZEFycmF5UHJvdG90eXBlID0gVWludDhDbGFtcGVkQXJyYXkgJiYgVWludDhDbGFtcGVkQXJyYXkucHJvdG90eXBlOwp2YXIgVHlwZWRBcnJheSA9IEludDhBcnJheSAmJiBnZXRQcm90b3R5cGVPZihJbnQ4QXJyYXkpOwp2YXIgVHlwZWRBcnJheVByb3RvdHlwZSA9IEludDhBcnJheVByb3RvdHlwZSAmJiBnZXRQcm90b3R5cGVPZihJbnQ4QXJyYXlQcm90b3R5cGUpOwp2YXIgT2JqZWN0UHJvdG90eXBlID0gT2JqZWN0LnByb3RvdHlwZTsKdmFyIFR5cGVFcnJvciA9IGdsb2JhbC5UeXBlRXJyb3I7CnZhciBUT19TVFJJTkdfVEFHID0gd2VsbEtub3duU3ltYm9sKCd0b1N0cmluZ1RhZycpOwp2YXIgVFlQRURfQVJSQVlfVEFHID0gdWlkKCdUWVBFRF9BUlJBWV9UQUcnKTsKdmFyIFRZUEVEX0FSUkFZX0NPTlNUUlVDVE9SID0gJ1R5cGVkQXJyYXlDb25zdHJ1Y3Rvcic7CnZhciBOQVRJVkVfQVJSQVlfQlVGRkVSX1ZJRVdTID0gTkFUSVZFX0FSUkFZX0JVRkZFUiAmJiAhIXNldFByb3RvdHlwZU9mICYmIGNsYXNzb2YoZ2xvYmFsLm9wZXJhKSAhPT0gJ09wZXJhJzsKdmFyIFRZUEVEX0FSUkFZX1RBR19SRVFVSVJFRCA9IGZhbHNlOwp2YXIgTkFNRSwgQ29uc3RydWN0b3IsIFByb3RvdHlwZTsKdmFyIFR5cGVkQXJyYXlDb25zdHJ1Y3RvcnNMaXN0ID0gewogSW50OEFycmF5OiAxLAogVWludDhBcnJheTogMSwKIFVpbnQ4Q2xhbXBlZEFycmF5OiAxLAogSW50MTZBcnJheTogMiwKIFVpbnQxNkFycmF5OiAyLAogSW50MzJBcnJheTogNCwKIFVpbnQzMkFycmF5OiA0LAogRmxvYXQzMkFycmF5OiA0LAogRmxvYXQ2NEFycmF5OiA4Cn07CnZhciBCaWdJbnRBcnJheUNvbnN0cnVjdG9yc0xpc3QgPSB7CiBCaWdJbnQ2NEFycmF5OiA4LAogQmlnVWludDY0QXJyYXk6IDgKfTsKdmFyIGlzVmlldyA9IGZ1bmN0aW9uIGlzVmlldyhpdCkgewogaWYgKCFpc09iamVjdChpdCkpCiAgcmV0dXJuIGZhbHNlOwogdmFyIGtsYXNzID0gY2xhc3NvZihpdCk7CiByZXR1cm4ga2xhc3MgPT09ICdEYXRhVmlldycgfHwgaGFzT3duKFR5cGVkQXJyYXlDb25zdHJ1Y3RvcnNMaXN0LCBrbGFzcykgfHwgaGFzT3duKEJpZ0ludEFycmF5Q29uc3RydWN0b3JzTGlzdCwga2xhc3MpOwp9Owp2YXIgZ2V0VHlwZWRBcnJheUNvbnN0cnVjdG9yID0gZnVuY3Rpb24gKGl0KSB7CiB2YXIgcHJvdG8gPSBnZXRQcm90b3R5cGVPZihpdCk7CiBpZiAoIWlzT2JqZWN0KHByb3RvKSkKICByZXR1cm47CiB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFN0YXRlKHByb3RvKTsKIHJldHVybiBzdGF0ZSAmJiBoYXNPd24oc3RhdGUsIFRZUEVEX0FSUkFZX0NPTlNUUlVDVE9SKSA/IHN0YXRlW1RZUEVEX0FSUkFZX0NPTlNUUlVDVE9SXSA6IGdldFR5cGVkQXJyYXlDb25zdHJ1Y3Rvcihwcm90byk7Cn07CnZhciBpc1R5cGVkQXJyYXkgPSBmdW5jdGlvbiAoaXQpIHsKIGlmICghaXNPYmplY3QoaXQpKQogIHJldHVybiBmYWxzZTsKIHZhciBrbGFzcyA9IGNsYXNzb2YoaXQpOwogcmV0dXJuIGhhc093bihUeXBlZEFycmF5Q29uc3RydWN0b3JzTGlzdCwga2xhc3MpIHx8IGhhc093bihCaWdJbnRBcnJheUNvbnN0cnVjdG9yc0xpc3QsIGtsYXNzKTsKfTsKdmFyIGFUeXBlZEFycmF5ID0gZnVuY3Rpb24gKGl0KSB7CiBpZiAoaXNUeXBlZEFycmF5KGl0KSkKICByZXR1cm4gaXQ7CiB0aHJvdyBUeXBlRXJyb3IoJ1RhcmdldCBpcyBub3QgYSB0eXBlZCBhcnJheScpOwp9Owp2YXIgYVR5cGVkQXJyYXlDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uIChDKSB7CiBpZiAoaXNDYWxsYWJsZShDKSAmJiAoIXNldFByb3RvdHlwZU9mIHx8IGlzUHJvdG90eXBlT2YoVHlwZWRBcnJheSwgQykpKQogIHJldHVybiBDOwogdGhyb3cgVHlwZUVycm9yKHRyeVRvU3RyaW5nKEMpICsgJyBpcyBub3QgYSB0eXBlZCBhcnJheSBjb25zdHJ1Y3RvcicpOwp9Owp2YXIgZXhwb3J0VHlwZWRBcnJheU1ldGhvZCA9IGZ1bmN0aW9uIChLRVksIHByb3BlcnR5LCBmb3JjZWQsIG9wdGlvbnMpIHsKIGlmICghREVTQ1JJUFRPUlMpCiAgcmV0dXJuOwogaWYgKGZvcmNlZCkKICBmb3IgKHZhciBBUlJBWSBpbiBUeXBlZEFycmF5Q29uc3RydWN0b3JzTGlzdCkgewogICB2YXIgVHlwZWRBcnJheUNvbnN0cnVjdG9yID0gZ2xvYmFsW0FSUkFZXTsKICAgaWYgKFR5cGVkQXJyYXlDb25zdHJ1Y3RvciAmJiBoYXNPd24oVHlwZWRBcnJheUNvbnN0cnVjdG9yLnByb3RvdHlwZSwgS0VZKSkKICAgIHRyeSB7CiAgICAgZGVsZXRlIFR5cGVkQXJyYXlDb25zdHJ1Y3Rvci5wcm90b3R5cGVbS0VZXTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgdHJ5IHsKICAgICAgVHlwZWRBcnJheUNvbnN0cnVjdG9yLnByb3RvdHlwZVtLRVldID0gcHJvcGVydHk7CiAgICAgfSBjYXRjaCAoZXJyb3IyKSB7CiAgICAgfQogICAgfQogIH0KIGlmICghVHlwZWRBcnJheVByb3RvdHlwZVtLRVldIHx8IGZvcmNlZCkgewogIGRlZmluZUJ1aWx0SW4oVHlwZWRBcnJheVByb3RvdHlwZSwgS0VZLCBmb3JjZWQgPyBwcm9wZXJ0eSA6IE5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MgJiYgSW50OEFycmF5UHJvdG90eXBlW0tFWV0gfHwgcHJvcGVydHksIG9wdGlvbnMpOwogfQp9Owp2YXIgZXhwb3J0VHlwZWRBcnJheVN0YXRpY01ldGhvZCA9IGZ1bmN0aW9uIChLRVksIHByb3BlcnR5LCBmb3JjZWQpIHsKIHZhciBBUlJBWSwgVHlwZWRBcnJheUNvbnN0cnVjdG9yOwogaWYgKCFERVNDUklQVE9SUykKICByZXR1cm47CiBpZiAoc2V0UHJvdG90eXBlT2YpIHsKICBpZiAoZm9yY2VkKQogICBmb3IgKEFSUkFZIGluIFR5cGVkQXJyYXlDb25zdHJ1Y3RvcnNMaXN0KSB7CiAgICBUeXBlZEFycmF5Q29uc3RydWN0b3IgPSBnbG9iYWxbQVJSQVldOwogICAgaWYgKFR5cGVkQXJyYXlDb25zdHJ1Y3RvciAmJiBoYXNPd24oVHlwZWRBcnJheUNvbnN0cnVjdG9yLCBLRVkpKQogICAgIHRyeSB7CiAgICAgIGRlbGV0ZSBUeXBlZEFycmF5Q29uc3RydWN0b3JbS0VZXTsKICAgICB9IGNhdGNoIChlcnJvcikgewogICAgIH0KICAgfQogIGlmICghVHlwZWRBcnJheVtLRVldIHx8IGZvcmNlZCkgewogICB0cnkgewogICAgcmV0dXJuIGRlZmluZUJ1aWx0SW4oVHlwZWRBcnJheSwgS0VZLCBmb3JjZWQgPyBwcm9wZXJ0eSA6IE5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MgJiYgVHlwZWRBcnJheVtLRVldIHx8IHByb3BlcnR5KTsKICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgfQogIH0gZWxzZQogICByZXR1cm47CiB9CiBmb3IgKEFSUkFZIGluIFR5cGVkQXJyYXlDb25zdHJ1Y3RvcnNMaXN0KSB7CiAgVHlwZWRBcnJheUNvbnN0cnVjdG9yID0gZ2xvYmFsW0FSUkFZXTsKICBpZiAoVHlwZWRBcnJheUNvbnN0cnVjdG9yICYmICghVHlwZWRBcnJheUNvbnN0cnVjdG9yW0tFWV0gfHwgZm9yY2VkKSkgewogICBkZWZpbmVCdWlsdEluKFR5cGVkQXJyYXlDb25zdHJ1Y3RvciwgS0VZLCBwcm9wZXJ0eSk7CiAgfQogfQp9Owpmb3IgKE5BTUUgaW4gVHlwZWRBcnJheUNvbnN0cnVjdG9yc0xpc3QpIHsKIENvbnN0cnVjdG9yID0gZ2xvYmFsW05BTUVdOwogUHJvdG90eXBlID0gQ29uc3RydWN0b3IgJiYgQ29uc3RydWN0b3IucHJvdG90eXBlOwogaWYgKFByb3RvdHlwZSkKICBlbmZvcmNlSW50ZXJuYWxTdGF0ZShQcm90b3R5cGUpW1RZUEVEX0FSUkFZX0NPTlNUUlVDVE9SXSA9IENvbnN0cnVjdG9yOwogZWxzZQogIE5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MgPSBmYWxzZTsKfQpmb3IgKE5BTUUgaW4gQmlnSW50QXJyYXlDb25zdHJ1Y3RvcnNMaXN0KSB7CiBDb25zdHJ1Y3RvciA9IGdsb2JhbFtOQU1FXTsKIFByb3RvdHlwZSA9IENvbnN0cnVjdG9yICYmIENvbnN0cnVjdG9yLnByb3RvdHlwZTsKIGlmIChQcm90b3R5cGUpCiAgZW5mb3JjZUludGVybmFsU3RhdGUoUHJvdG90eXBlKVtUWVBFRF9BUlJBWV9DT05TVFJVQ1RPUl0gPSBDb25zdHJ1Y3RvcjsKfQppZiAoIU5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MgfHwgIWlzQ2FsbGFibGUoVHlwZWRBcnJheSkgfHwgVHlwZWRBcnJheSA9PT0gRnVuY3Rpb24ucHJvdG90eXBlKSB7CiBUeXBlZEFycmF5ID0gZnVuY3Rpb24gVHlwZWRBcnJheSgpIHsKICB0aHJvdyBUeXBlRXJyb3IoJ0luY29ycmVjdCBpbnZvY2F0aW9uJyk7CiB9OwogaWYgKE5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MpCiAgZm9yIChOQU1FIGluIFR5cGVkQXJyYXlDb25zdHJ1Y3RvcnNMaXN0KSB7CiAgIGlmIChnbG9iYWxbTkFNRV0pCiAgICBzZXRQcm90b3R5cGVPZihnbG9iYWxbTkFNRV0sIFR5cGVkQXJyYXkpOwogIH0KfQppZiAoIU5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MgfHwgIVR5cGVkQXJyYXlQcm90b3R5cGUgfHwgVHlwZWRBcnJheVByb3RvdHlwZSA9PT0gT2JqZWN0UHJvdG90eXBlKSB7CiBUeXBlZEFycmF5UHJvdG90eXBlID0gVHlwZWRBcnJheS5wcm90b3R5cGU7CiBpZiAoTkFUSVZFX0FSUkFZX0JVRkZFUl9WSUVXUykKICBmb3IgKE5BTUUgaW4gVHlwZWRBcnJheUNvbnN0cnVjdG9yc0xpc3QpIHsKICAgaWYgKGdsb2JhbFtOQU1FXSkKICAgIHNldFByb3RvdHlwZU9mKGdsb2JhbFtOQU1FXS5wcm90b3R5cGUsIFR5cGVkQXJyYXlQcm90b3R5cGUpOwogIH0KfQppZiAoTkFUSVZFX0FSUkFZX0JVRkZFUl9WSUVXUyAmJiBnZXRQcm90b3R5cGVPZihVaW50OENsYW1wZWRBcnJheVByb3RvdHlwZSkgIT09IFR5cGVkQXJyYXlQcm90b3R5cGUpIHsKIHNldFByb3RvdHlwZU9mKFVpbnQ4Q2xhbXBlZEFycmF5UHJvdG90eXBlLCBUeXBlZEFycmF5UHJvdG90eXBlKTsKfQppZiAoREVTQ1JJUFRPUlMgJiYgIWhhc093bihUeXBlZEFycmF5UHJvdG90eXBlLCBUT19TVFJJTkdfVEFHKSkgewogVFlQRURfQVJSQVlfVEFHX1JFUVVJUkVEID0gdHJ1ZTsKIGRlZmluZVByb3BlcnR5KFR5cGVkQXJyYXlQcm90b3R5cGUsIFRPX1NUUklOR19UQUcsIHsKICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgcmV0dXJuIGlzT2JqZWN0KHRoaXMpID8gdGhpc1tUWVBFRF9BUlJBWV9UQUddIDogdW5kZWZpbmVkOwogIH0KIH0pOwogZm9yIChOQU1FIGluIFR5cGVkQXJyYXlDb25zdHJ1Y3RvcnNMaXN0KQogIGlmIChnbG9iYWxbTkFNRV0pIHsKICAgY3JlYXRlTm9uRW51bWVyYWJsZVByb3BlcnR5KGdsb2JhbFtOQU1FXSwgVFlQRURfQVJSQVlfVEFHLCBOQU1FKTsKICB9Cn0KbW9kdWxlLmV4cG9ydHMgPSB7CiBOQVRJVkVfQVJSQVlfQlVGRkVSX1ZJRVdTOiBOQVRJVkVfQVJSQVlfQlVGRkVSX1ZJRVdTLAogVFlQRURfQVJSQVlfVEFHOiBUWVBFRF9BUlJBWV9UQUdfUkVRVUlSRUQgJiYgVFlQRURfQVJSQVlfVEFHLAogYVR5cGVkQXJyYXk6IGFUeXBlZEFycmF5LAogYVR5cGVkQXJyYXlDb25zdHJ1Y3RvcjogYVR5cGVkQXJyYXlDb25zdHJ1Y3RvciwKIGV4cG9ydFR5cGVkQXJyYXlNZXRob2Q6IGV4cG9ydFR5cGVkQXJyYXlNZXRob2QsCiBleHBvcnRUeXBlZEFycmF5U3RhdGljTWV0aG9kOiBleHBvcnRUeXBlZEFycmF5U3RhdGljTWV0aG9kLAogZ2V0VHlwZWRBcnJheUNvbnN0cnVjdG9yOiBnZXRUeXBlZEFycmF5Q29uc3RydWN0b3IsCiBpc1ZpZXc6IGlzVmlldywKIGlzVHlwZWRBcnJheTogaXNUeXBlZEFycmF5LAogVHlwZWRBcnJheTogVHlwZWRBcnJheSwKIFR5cGVkQXJyYXlQcm90b3R5cGU6IFR5cGVkQXJyYXlQcm90b3R5cGUKfTsKCi8qKiovIH0pLAovKiA4MCAqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2YgQXJyYXlCdWZmZXIgIT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIERhdGFWaWV3ICE9ICd1bmRlZmluZWQnOwoKLyoqKi8gfSksCi8qIDgxICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBUT19TVFJJTkdfVEFHX1NVUFBPUlQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgyKTsKdmFyIGlzQ2FsbGFibGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI0KTsKdmFyIGNsYXNzb2ZSYXcgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5KTsKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzYpOwp2YXIgVE9fU1RSSU5HX1RBRyA9IHdlbGxLbm93blN5bWJvbCgndG9TdHJpbmdUYWcnKTsKdmFyICRPYmplY3QgPSBPYmplY3Q7CnZhciBDT1JSRUNUX0FSR1VNRU5UUyA9IGNsYXNzb2ZSYXcoKGZ1bmN0aW9uICgpIHsKIHJldHVybiBhcmd1bWVudHM7Cn0oKSkpID09ICdBcmd1bWVudHMnOwp2YXIgdHJ5R2V0ID0gZnVuY3Rpb24gKGl0LCBrZXkpIHsKIHRyeSB7CiAgcmV0dXJuIGl0W2tleV07CiB9IGNhdGNoIChlcnJvcikgewogfQp9Owptb2R1bGUuZXhwb3J0cyA9IFRPX1NUUklOR19UQUdfU1VQUE9SVCA/IGNsYXNzb2ZSYXcgOiBmdW5jdGlvbiAoaXQpIHsKIHZhciBPLCB0YWcsIHJlc3VsdDsKIHJldHVybiBpdCA9PT0gdW5kZWZpbmVkID8gJ1VuZGVmaW5lZCcgOiBpdCA9PT0gbnVsbCA/ICdOdWxsJyA6IHR5cGVvZiAodGFnID0gdHJ5R2V0KE8gPSAkT2JqZWN0KGl0KSwgVE9fU1RSSU5HX1RBRykpID09ICdzdHJpbmcnID8gdGFnIDogQ09SUkVDVF9BUkdVTUVOVFMgPyBjbGFzc29mUmF3KE8pIDogKHJlc3VsdCA9IGNsYXNzb2ZSYXcoTykpID09ICdPYmplY3QnICYmIGlzQ2FsbGFibGUoTy5jYWxsZWUpID8gJ0FyZ3VtZW50cycgOiByZXN1bHQ7Cn07CgovKioqLyB9KSwKLyogODIgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzYpOwp2YXIgVE9fU1RSSU5HX1RBRyA9IHdlbGxLbm93blN5bWJvbCgndG9TdHJpbmdUYWcnKTsKdmFyIHRlc3QgPSB7fTsKdGVzdFtUT19TVFJJTkdfVEFHXSA9ICd6JzsKbW9kdWxlLmV4cG9ydHMgPSBTdHJpbmcodGVzdCkgPT09ICdbb2JqZWN0IHpdJzsKCi8qKiovIH0pLAovKiA4MyAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgaGFzT3duID0gX193X3BkZmpzX3JlcXVpcmVfXyg0MSk7CnZhciBpc0NhbGxhYmxlID0gX193X3BkZmpzX3JlcXVpcmVfXygyNCk7CnZhciB0b09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDIpOwp2YXIgc2hhcmVkS2V5ID0gX193X3BkZmpzX3JlcXVpcmVfXyg1Nik7CnZhciBDT1JSRUNUX1BST1RPVFlQRV9HRVRURVIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg0KTsKdmFyIElFX1BST1RPID0gc2hhcmVkS2V5KCdJRV9QUk9UTycpOwp2YXIgJE9iamVjdCA9IE9iamVjdDsKdmFyIE9iamVjdFByb3RvdHlwZSA9ICRPYmplY3QucHJvdG90eXBlOwptb2R1bGUuZXhwb3J0cyA9IENPUlJFQ1RfUFJPVE9UWVBFX0dFVFRFUiA/ICRPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiAoTykgewogdmFyIG9iamVjdCA9IHRvT2JqZWN0KE8pOwogaWYgKGhhc093bihvYmplY3QsIElFX1BST1RPKSkKICByZXR1cm4gb2JqZWN0W0lFX1BST1RPXTsKIHZhciBjb25zdHJ1Y3RvciA9IG9iamVjdC5jb25zdHJ1Y3RvcjsKIGlmIChpc0NhbGxhYmxlKGNvbnN0cnVjdG9yKSAmJiBvYmplY3QgaW5zdGFuY2VvZiBjb25zdHJ1Y3RvcikgewogIHJldHVybiBjb25zdHJ1Y3Rvci5wcm90b3R5cGU7CiB9CiByZXR1cm4gb2JqZWN0IGluc3RhbmNlb2YgJE9iamVjdCA/IE9iamVjdFByb3RvdHlwZSA6IG51bGw7Cn07CgovKioqLyB9KSwKLyogODQgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gIWZhaWxzKGZ1bmN0aW9uICgpIHsKIGZ1bmN0aW9uIEYoKSB7CiB9CiBGLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IG51bGw7CiByZXR1cm4gT2JqZWN0LmdldFByb3RvdHlwZU9mKG5ldyBGKCkpICE9PSBGLnByb3RvdHlwZTsKfSk7CgovKioqLyB9KSwKLyogODUgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHVuY3VycnlUaGlzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOCk7CnZhciBhbk9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDkpOwp2YXIgYVBvc3NpYmxlUHJvdG90eXBlID0gX193X3BkZmpzX3JlcXVpcmVfXyg4Nik7Cm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgnX19wcm90b19fJyBpbiB7fSA/IChmdW5jdGlvbiAoKSB7CiB2YXIgQ09SUkVDVF9TRVRURVIgPSBmYWxzZTsKIHZhciB0ZXN0ID0ge307CiB2YXIgc2V0dGVyOwogdHJ5IHsKICBzZXR0ZXIgPSB1bmN1cnJ5VGhpcyhPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE9iamVjdC5wcm90b3R5cGUsICdfX3Byb3RvX18nKS5zZXQpOwogIHNldHRlcih0ZXN0LCBbXSk7CiAgQ09SUkVDVF9TRVRURVIgPSB0ZXN0IGluc3RhbmNlb2YgQXJyYXk7CiB9IGNhdGNoIChlcnJvcikgewogfQogcmV0dXJuIGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKE8sIHByb3RvKSB7CiAgYW5PYmplY3QoTyk7CiAgYVBvc3NpYmxlUHJvdG90eXBlKHByb3RvKTsKICBpZiAoQ09SUkVDVF9TRVRURVIpCiAgIHNldHRlcihPLCBwcm90byk7CiAgZWxzZQogICBPLl9fcHJvdG9fXyA9IHByb3RvOwogIHJldHVybiBPOwogfTsKfSgpKSA6IHVuZGVmaW5lZCk7CgovKioqLyB9KSwKLyogODYgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGlzQ2FsbGFibGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI0KTsKdmFyICRTdHJpbmcgPSBTdHJpbmc7CnZhciAkVHlwZUVycm9yID0gVHlwZUVycm9yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcmd1bWVudCkgewogaWYgKHR5cGVvZiBhcmd1bWVudCA9PSAnb2JqZWN0JyB8fCBpc0NhbGxhYmxlKGFyZ3VtZW50KSkKICByZXR1cm4gYXJndW1lbnQ7CiB0aHJvdyAkVHlwZUVycm9yKCJDYW4ndCBzZXQgIiArICRTdHJpbmcoYXJndW1lbnQpICsgJyBhcyBhIHByb3RvdHlwZScpOwp9OwoKLyoqKi8gfSksCi8qIDg3ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCl9fd19wZGZqc19yZXF1aXJlX18oODgpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDk0KTsKX193X3BkZmpzX3JlcXVpcmVfXyg5Nik7Cl9fd19wZGZqc19yZXF1aXJlX18oMTE4KTsKX193X3BkZmpzX3JlcXVpcmVfXygxMjApOwp2YXIgcGF0aCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTI5KTsKbW9kdWxlLmV4cG9ydHMgPSBwYXRoLnN0cnVjdHVyZWRDbG9uZTsKCi8qKiovIH0pLAovKiA4OCAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7Cgp2YXIgdG9JbmRleGVkT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygxNik7CnZhciBhZGRUb1Vuc2NvcGFibGVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3MSk7CnZhciBJdGVyYXRvcnMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg5KTsKdmFyIEludGVybmFsU3RhdGVNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU0KTsKdmFyIGRlZmluZVByb3BlcnR5ID0gKF9fd19wZGZqc19yZXF1aXJlX18oNDcpLmYpOwp2YXIgZGVmaW5lSXRlcmF0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDkwKTsKdmFyIElTX1BVUkUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM4KTsKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBBUlJBWV9JVEVSQVRPUiA9ICdBcnJheSBJdGVyYXRvcic7CnZhciBzZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5zZXQ7CnZhciBnZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5nZXR0ZXJGb3IoQVJSQVlfSVRFUkFUT1IpOwptb2R1bGUuZXhwb3J0cyA9IGRlZmluZUl0ZXJhdG9yKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbiAoaXRlcmF0ZWQsIGtpbmQpIHsKIHNldEludGVybmFsU3RhdGUodGhpcywgewogIHR5cGU6IEFSUkFZX0lURVJBVE9SLAogIHRhcmdldDogdG9JbmRleGVkT2JqZWN0KGl0ZXJhdGVkKSwKICBpbmRleDogMCwKICBraW5kOiBraW5kCiB9KTsKfSwgZnVuY3Rpb24gKCkgewogdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxTdGF0ZSh0aGlzKTsKIHZhciB0YXJnZXQgPSBzdGF0ZS50YXJnZXQ7CiB2YXIga2luZCA9IHN0YXRlLmtpbmQ7CiB2YXIgaW5kZXggPSBzdGF0ZS5pbmRleCsrOwogaWYgKCF0YXJnZXQgfHwgaW5kZXggPj0gdGFyZ2V0Lmxlbmd0aCkgewogIHN0YXRlLnRhcmdldCA9IHVuZGVmaW5lZDsKICByZXR1cm4gewogICB2YWx1ZTogdW5kZWZpbmVkLAogICBkb25lOiB0cnVlCiAgfTsKIH0KIGlmIChraW5kID09ICdrZXlzJykKICByZXR1cm4gewogICB2YWx1ZTogaW5kZXgsCiAgIGRvbmU6IGZhbHNlCiAgfTsKIGlmIChraW5kID09ICd2YWx1ZXMnKQogIHJldHVybiB7CiAgIHZhbHVlOiB0YXJnZXRbaW5kZXhdLAogICBkb25lOiBmYWxzZQogIH07CiByZXR1cm4gewogIHZhbHVlOiBbCiAgIGluZGV4LAogICB0YXJnZXRbaW5kZXhdCiAgXSwKICBkb25lOiBmYWxzZQogfTsKfSwgJ3ZhbHVlcycpOwp2YXIgdmFsdWVzID0gSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTsKYWRkVG9VbnNjb3BhYmxlcygna2V5cycpOwphZGRUb1Vuc2NvcGFibGVzKCd2YWx1ZXMnKTsKYWRkVG9VbnNjb3BhYmxlcygnZW50cmllcycpOwppZiAoIUlTX1BVUkUgJiYgREVTQ1JJUFRPUlMgJiYgdmFsdWVzLm5hbWUgIT09ICd2YWx1ZXMnKQogdHJ5IHsKICBkZWZpbmVQcm9wZXJ0eSh2YWx1ZXMsICduYW1lJywgeyB2YWx1ZTogJ3ZhbHVlcycgfSk7CiB9IGNhdGNoIChlcnJvcikgewogfQoKLyoqKi8gfSksCi8qIDg5ICovCi8qKiovICgobW9kdWxlKSA9PiB7Cgptb2R1bGUuZXhwb3J0cyA9IHt9OwoKLyoqKi8gfSksCi8qIDkwICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKdmFyIGNhbGwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyKTsKdmFyIElTX1BVUkUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM4KTsKdmFyIEZ1bmN0aW9uTmFtZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNTIpOwp2YXIgaXNDYWxsYWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjQpOwp2YXIgY3JlYXRlSXRlcmF0b3JDb25zdHJ1Y3RvciA9IF9fd19wZGZqc19yZXF1aXJlX18oOTEpOwp2YXIgZ2V0UHJvdG90eXBlT2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgzKTsKdmFyIHNldFByb3RvdHlwZU9mID0gX193X3BkZmpzX3JlcXVpcmVfXyg4NSk7CnZhciBzZXRUb1N0cmluZ1RhZyA9IF9fd19wZGZqc19yZXF1aXJlX18oOTMpOwp2YXIgY3JlYXRlTm9uRW51bWVyYWJsZVByb3BlcnR5ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Nik7CnZhciBkZWZpbmVCdWlsdEluID0gX193X3BkZmpzX3JlcXVpcmVfXyg1MCk7CnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM2KTsKdmFyIEl0ZXJhdG9ycyA9IF9fd19wZGZqc19yZXF1aXJlX18oODkpOwp2YXIgSXRlcmF0b3JzQ29yZSA9IF9fd19wZGZqc19yZXF1aXJlX18oOTIpOwp2YXIgUFJPUEVSX0ZVTkNUSU9OX05BTUUgPSBGdW5jdGlvbk5hbWUuUFJPUEVSOwp2YXIgQ09ORklHVVJBQkxFX0ZVTkNUSU9OX05BTUUgPSBGdW5jdGlvbk5hbWUuQ09ORklHVVJBQkxFOwp2YXIgSXRlcmF0b3JQcm90b3R5cGUgPSBJdGVyYXRvcnNDb3JlLkl0ZXJhdG9yUHJvdG90eXBlOwp2YXIgQlVHR1lfU0FGQVJJX0lURVJBVE9SUyA9IEl0ZXJhdG9yc0NvcmUuQlVHR1lfU0FGQVJJX0lURVJBVE9SUzsKdmFyIElURVJBVE9SID0gd2VsbEtub3duU3ltYm9sKCdpdGVyYXRvcicpOwp2YXIgS0VZUyA9ICdrZXlzJzsKdmFyIFZBTFVFUyA9ICd2YWx1ZXMnOwp2YXIgRU5UUklFUyA9ICdlbnRyaWVzJzsKdmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbiAoKSB7CiByZXR1cm4gdGhpczsKfTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoSXRlcmFibGUsIE5BTUUsIEl0ZXJhdG9yQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKSB7CiBjcmVhdGVJdGVyYXRvckNvbnN0cnVjdG9yKEl0ZXJhdG9yQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpOwogdmFyIGdldEl0ZXJhdGlvbk1ldGhvZCA9IGZ1bmN0aW9uIChLSU5EKSB7CiAgaWYgKEtJTkQgPT09IERFRkFVTFQgJiYgZGVmYXVsdEl0ZXJhdG9yKQogICByZXR1cm4gZGVmYXVsdEl0ZXJhdG9yOwogIGlmICghQlVHR1lfU0FGQVJJX0lURVJBVE9SUyAmJiBLSU5EIGluIEl0ZXJhYmxlUHJvdG90eXBlKQogICByZXR1cm4gSXRlcmFibGVQcm90b3R5cGVbS0lORF07CiAgc3dpdGNoIChLSU5EKSB7CiAgY2FzZSBLRVlTOgogICByZXR1cm4gZnVuY3Rpb24ga2V5cygpIHsKICAgIHJldHVybiBuZXcgSXRlcmF0b3JDb25zdHJ1Y3Rvcih0aGlzLCBLSU5EKTsKICAgfTsKICBjYXNlIFZBTFVFUzoKICAgcmV0dXJuIGZ1bmN0aW9uIHZhbHVlcygpIHsKICAgIHJldHVybiBuZXcgSXRlcmF0b3JDb25zdHJ1Y3Rvcih0aGlzLCBLSU5EKTsKICAgfTsKICBjYXNlIEVOVFJJRVM6CiAgIHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCkgewogICAgcmV0dXJuIG5ldyBJdGVyYXRvckNvbnN0cnVjdG9yKHRoaXMsIEtJTkQpOwogICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24gKCkgewogICByZXR1cm4gbmV3IEl0ZXJhdG9yQ29uc3RydWN0b3IodGhpcyk7CiAgfTsKIH07CiB2YXIgVE9fU1RSSU5HX1RBRyA9IE5BTUUgKyAnIEl0ZXJhdG9yJzsKIHZhciBJTkNPUlJFQ1RfVkFMVUVTX05BTUUgPSBmYWxzZTsKIHZhciBJdGVyYWJsZVByb3RvdHlwZSA9IEl0ZXJhYmxlLnByb3RvdHlwZTsKIHZhciBuYXRpdmVJdGVyYXRvciA9IEl0ZXJhYmxlUHJvdG90eXBlW0lURVJBVE9SXSB8fCBJdGVyYWJsZVByb3RvdHlwZVsnQEBpdGVyYXRvciddIHx8IERFRkFVTFQgJiYgSXRlcmFibGVQcm90b3R5cGVbREVGQVVMVF07CiB2YXIgZGVmYXVsdEl0ZXJhdG9yID0gIUJVR0dZX1NBRkFSSV9JVEVSQVRPUlMgJiYgbmF0aXZlSXRlcmF0b3IgfHwgZ2V0SXRlcmF0aW9uTWV0aG9kKERFRkFVTFQpOwogdmFyIGFueU5hdGl2ZUl0ZXJhdG9yID0gTkFNRSA9PSAnQXJyYXknID8gSXRlcmFibGVQcm90b3R5cGUuZW50cmllcyB8fCBuYXRpdmVJdGVyYXRvciA6IG5hdGl2ZUl0ZXJhdG9yOwogdmFyIEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSwgbWV0aG9kcywgS0VZOwogaWYgKGFueU5hdGl2ZUl0ZXJhdG9yKSB7CiAgQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoYW55TmF0aXZlSXRlcmF0b3IuY2FsbChuZXcgSXRlcmFibGUoKSkpOwogIGlmIChDdXJyZW50SXRlcmF0b3JQcm90b3R5cGUgIT09IE9iamVjdC5wcm90b3R5cGUgJiYgQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlLm5leHQpIHsKICAgaWYgKCFJU19QVVJFICYmIGdldFByb3RvdHlwZU9mKEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSkgIT09IEl0ZXJhdG9yUHJvdG90eXBlKSB7CiAgICBpZiAoc2V0UHJvdG90eXBlT2YpIHsKICAgICBzZXRQcm90b3R5cGVPZihDdXJyZW50SXRlcmF0b3JQcm90b3R5cGUsIEl0ZXJhdG9yUHJvdG90eXBlKTsKICAgIH0gZWxzZSBpZiAoIWlzQ2FsbGFibGUoQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlW0lURVJBVE9SXSkpIHsKICAgICBkZWZpbmVCdWlsdEluKEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwogICAgfQogICB9CiAgIHNldFRvU3RyaW5nVGFnKEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSwgVE9fU1RSSU5HX1RBRywgdHJ1ZSwgdHJ1ZSk7CiAgIGlmIChJU19QVVJFKQogICAgSXRlcmF0b3JzW1RPX1NUUklOR19UQUddID0gcmV0dXJuVGhpczsKICB9CiB9CiBpZiAoUFJPUEVSX0ZVTkNUSU9OX05BTUUgJiYgREVGQVVMVCA9PSBWQUxVRVMgJiYgbmF0aXZlSXRlcmF0b3IgJiYgbmF0aXZlSXRlcmF0b3IubmFtZSAhPT0gVkFMVUVTKSB7CiAgaWYgKCFJU19QVVJFICYmIENPTkZJR1VSQUJMRV9GVU5DVElPTl9OQU1FKSB7CiAgIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShJdGVyYWJsZVByb3RvdHlwZSwgJ25hbWUnLCBWQUxVRVMpOwogIH0gZWxzZSB7CiAgIElOQ09SUkVDVF9WQUxVRVNfTkFNRSA9IHRydWU7CiAgIGRlZmF1bHRJdGVyYXRvciA9IGZ1bmN0aW9uIHZhbHVlcygpIHsKICAgIHJldHVybiBjYWxsKG5hdGl2ZUl0ZXJhdG9yLCB0aGlzKTsKICAgfTsKICB9CiB9CiBpZiAoREVGQVVMVCkgewogIG1ldGhvZHMgPSB7CiAgIHZhbHVlczogZ2V0SXRlcmF0aW9uTWV0aG9kKFZBTFVFUyksCiAgIGtleXM6IElTX1NFVCA/IGRlZmF1bHRJdGVyYXRvciA6IGdldEl0ZXJhdGlvbk1ldGhvZChLRVlTKSwKICAgZW50cmllczogZ2V0SXRlcmF0aW9uTWV0aG9kKEVOVFJJRVMpCiAgfTsKICBpZiAoRk9SQ0VEKQogICBmb3IgKEtFWSBpbiBtZXRob2RzKSB7CiAgICBpZiAoQlVHR1lfU0FGQVJJX0lURVJBVE9SUyB8fCBJTkNPUlJFQ1RfVkFMVUVTX05BTUUgfHwgIShLRVkgaW4gSXRlcmFibGVQcm90b3R5cGUpKSB7CiAgICAgZGVmaW5lQnVpbHRJbihJdGVyYWJsZVByb3RvdHlwZSwgS0VZLCBtZXRob2RzW0tFWV0pOwogICAgfQogICB9CiAgZWxzZQogICAkKHsKICAgIHRhcmdldDogTkFNRSwKICAgIHByb3RvOiB0cnVlLAogICAgZm9yY2VkOiBCVUdHWV9TQUZBUklfSVRFUkFUT1JTIHx8IElOQ09SUkVDVF9WQUxVRVNfTkFNRQogICB9LCBtZXRob2RzKTsKIH0KIGlmICgoIUlTX1BVUkUgfHwgRk9SQ0VEKSAmJiBJdGVyYWJsZVByb3RvdHlwZVtJVEVSQVRPUl0gIT09IGRlZmF1bHRJdGVyYXRvcikgewogIGRlZmluZUJ1aWx0SW4oSXRlcmFibGVQcm90b3R5cGUsIElURVJBVE9SLCBkZWZhdWx0SXRlcmF0b3IsIHsgbmFtZTogREVGQVVMVCB9KTsKIH0KIEl0ZXJhdG9yc1tOQU1FXSA9IGRlZmF1bHRJdGVyYXRvcjsKIHJldHVybiBtZXRob2RzOwp9OwoKLyoqKi8gfSksCi8qIDkxICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBJdGVyYXRvclByb3RvdHlwZSA9IChfX3dfcGRmanNfcmVxdWlyZV9fKDkyKS5JdGVyYXRvclByb3RvdHlwZSk7CnZhciBjcmVhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcyKTsKdmFyIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTUpOwp2YXIgc2V0VG9TdHJpbmdUYWcgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDkzKTsKdmFyIEl0ZXJhdG9ycyA9IF9fd19wZGZqc19yZXF1aXJlX18oODkpOwp2YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uICgpIHsKIHJldHVybiB0aGlzOwp9Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChJdGVyYXRvckNvbnN0cnVjdG9yLCBOQU1FLCBuZXh0LCBFTlVNRVJBQkxFX05FWFQpIHsKIHZhciBUT19TVFJJTkdfVEFHID0gTkFNRSArICcgSXRlcmF0b3InOwogSXRlcmF0b3JDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSBjcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUsIHsgbmV4dDogY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yKCshRU5VTUVSQUJMRV9ORVhULCBuZXh0KSB9KTsKIHNldFRvU3RyaW5nVGFnKEl0ZXJhdG9yQ29uc3RydWN0b3IsIFRPX1NUUklOR19UQUcsIGZhbHNlLCB0cnVlKTsKIEl0ZXJhdG9yc1tUT19TVFJJTkdfVEFHXSA9IHJldHVyblRoaXM7CiByZXR1cm4gSXRlcmF0b3JDb25zdHJ1Y3RvcjsKfTsKCi8qKiovIH0pLAovKiA5MiAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZmFpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIGlzQ2FsbGFibGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI0KTsKdmFyIGNyZWF0ZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNzIpOwp2YXIgZ2V0UHJvdG90eXBlT2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgzKTsKdmFyIGRlZmluZUJ1aWx0SW4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUwKTsKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzYpOwp2YXIgSVNfUFVSRSA9IF9fd19wZGZqc19yZXF1aXJlX18oMzgpOwp2YXIgSVRFUkFUT1IgPSB3ZWxsS25vd25TeW1ib2woJ2l0ZXJhdG9yJyk7CnZhciBCVUdHWV9TQUZBUklfSVRFUkFUT1JTID0gZmFsc2U7CnZhciBJdGVyYXRvclByb3RvdHlwZSwgUHJvdG90eXBlT2ZBcnJheUl0ZXJhdG9yUHJvdG90eXBlLCBhcnJheUl0ZXJhdG9yOwppZiAoW10ua2V5cykgewogYXJyYXlJdGVyYXRvciA9IFtdLmtleXMoKTsKIGlmICghKCduZXh0JyBpbiBhcnJheUl0ZXJhdG9yKSkKICBCVUdHWV9TQUZBUklfSVRFUkFUT1JTID0gdHJ1ZTsKIGVsc2UgewogIFByb3RvdHlwZU9mQXJyYXlJdGVyYXRvclByb3RvdHlwZSA9IGdldFByb3RvdHlwZU9mKGdldFByb3RvdHlwZU9mKGFycmF5SXRlcmF0b3IpKTsKICBpZiAoUHJvdG90eXBlT2ZBcnJheUl0ZXJhdG9yUHJvdG90eXBlICE9PSBPYmplY3QucHJvdG90eXBlKQogICBJdGVyYXRvclByb3RvdHlwZSA9IFByb3RvdHlwZU9mQXJyYXlJdGVyYXRvclByb3RvdHlwZTsKIH0KfQp2YXIgTkVXX0lURVJBVE9SX1BST1RPVFlQRSA9IEl0ZXJhdG9yUHJvdG90eXBlID09IHVuZGVmaW5lZCB8fCBmYWlscyhmdW5jdGlvbiAoKSB7CiB2YXIgdGVzdCA9IHt9OwogcmV0dXJuIEl0ZXJhdG9yUHJvdG90eXBlW0lURVJBVE9SXS5jYWxsKHRlc3QpICE9PSB0ZXN0Owp9KTsKaWYgKE5FV19JVEVSQVRPUl9QUk9UT1RZUEUpCiBJdGVyYXRvclByb3RvdHlwZSA9IHt9OwplbHNlIGlmIChJU19QVVJFKQogSXRlcmF0b3JQcm90b3R5cGUgPSBjcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUpOwppZiAoIWlzQ2FsbGFibGUoSXRlcmF0b3JQcm90b3R5cGVbSVRFUkFUT1JdKSkgewogZGVmaW5lQnVpbHRJbihJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpczsKIH0pOwp9Cm1vZHVsZS5leHBvcnRzID0gewogSXRlcmF0b3JQcm90b3R5cGU6IEl0ZXJhdG9yUHJvdG90eXBlLAogQlVHR1lfU0FGQVJJX0lURVJBVE9SUzogQlVHR1lfU0FGQVJJX0lURVJBVE9SUwp9OwoKLyoqKi8gfSksCi8qIDkzICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBkZWZpbmVQcm9wZXJ0eSA9IChfX3dfcGRmanNfcmVxdWlyZV9fKDQ3KS5mKTsKdmFyIGhhc093biA9IF9fd19wZGZqc19yZXF1aXJlX18oNDEpOwp2YXIgd2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXygzNik7CnZhciBUT19TVFJJTkdfVEFHID0gd2VsbEtub3duU3ltYm9sKCd0b1N0cmluZ1RhZycpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0YXJnZXQsIFRBRywgU1RBVElDKSB7CiBpZiAodGFyZ2V0ICYmICFTVEFUSUMpCiAgdGFyZ2V0ID0gdGFyZ2V0LnByb3RvdHlwZTsKIGlmICh0YXJnZXQgJiYgIWhhc093bih0YXJnZXQsIFRPX1NUUklOR19UQUcpKSB7CiAgZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBUT19TVFJJTkdfVEFHLCB7CiAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgdmFsdWU6IFRBRwogIH0pOwogfQp9OwoKLyoqKi8gfSksCi8qIDk0ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIFRPX1NUUklOR19UQUdfU1VQUE9SVCA9IF9fd19wZGZqc19yZXF1aXJlX18oODIpOwp2YXIgZGVmaW5lQnVpbHRJbiA9IF9fd19wZGZqc19yZXF1aXJlX18oNTApOwp2YXIgdG9TdHJpbmcgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDk1KTsKaWYgKCFUT19TVFJJTkdfVEFHX1NVUFBPUlQpIHsKIGRlZmluZUJ1aWx0SW4oT2JqZWN0LnByb3RvdHlwZSwgJ3RvU3RyaW5nJywgdG9TdHJpbmcsIHsgdW5zYWZlOiB0cnVlIH0pOwp9CgovKioqLyB9KSwKLyogOTUgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKdmFyIFRPX1NUUklOR19UQUdfU1VQUE9SVCA9IF9fd19wZGZqc19yZXF1aXJlX18oODIpOwp2YXIgY2xhc3NvZiA9IF9fd19wZGZqc19yZXF1aXJlX18oODEpOwptb2R1bGUuZXhwb3J0cyA9IFRPX1NUUklOR19UQUdfU1VQUE9SVCA/IHt9LnRvU3RyaW5nIDogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiByZXR1cm4gJ1tvYmplY3QgJyArIGNsYXNzb2YodGhpcykgKyAnXSc7Cn07CgovKioqLyB9KSwKLyogOTYgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgpfX3dfcGRmanNfcmVxdWlyZV9fKDk3KTsKCi8qKiovIH0pLAovKiA5NyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBjb2xsZWN0aW9uID0gX193X3BkZmpzX3JlcXVpcmVfXyg5OCk7CnZhciBjb2xsZWN0aW9uU3Ryb25nID0gX193X3BkZmpzX3JlcXVpcmVfXygxMTUpOwpjb2xsZWN0aW9uKCdNYXAnLCBmdW5jdGlvbiAoaW5pdCkgewogcmV0dXJuIGZ1bmN0aW9uIE1hcCgpIHsKICByZXR1cm4gaW5pdCh0aGlzLCBhcmd1bWVudHMubGVuZ3RoID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTsKIH07Cn0sIGNvbGxlY3Rpb25TdHJvbmcpOwoKLyoqKi8gfSksCi8qIDk4ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oOCk7CnZhciB1bmN1cnJ5VGhpcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTgpOwp2YXIgaXNGb3JjZWQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcwKTsKdmFyIGRlZmluZUJ1aWx0SW4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUwKTsKdmFyIEludGVybmFsTWV0YWRhdGFNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDk5KTsKdmFyIGl0ZXJhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwNik7CnZhciBhbkluc3RhbmNlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMTIpOwp2YXIgaXNDYWxsYWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjQpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzKTsKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBjaGVja0NvcnJlY3RuZXNzT2ZJdGVyYXRpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExMyk7CnZhciBzZXRUb1N0cmluZ1RhZyA9IF9fd19wZGZqc19yZXF1aXJlX18oOTMpOwp2YXIgaW5oZXJpdElmUmVxdWlyZWQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExNCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKENPTlNUUlVDVE9SX05BTUUsIHdyYXBwZXIsIGNvbW1vbikgewogdmFyIElTX01BUCA9IENPTlNUUlVDVE9SX05BTUUuaW5kZXhPZignTWFwJykgIT09IC0xOwogdmFyIElTX1dFQUsgPSBDT05TVFJVQ1RPUl9OQU1FLmluZGV4T2YoJ1dlYWsnKSAhPT0gLTE7CiB2YXIgQURERVIgPSBJU19NQVAgPyAnc2V0JyA6ICdhZGQnOwogdmFyIE5hdGl2ZUNvbnN0cnVjdG9yID0gZ2xvYmFsW0NPTlNUUlVDVE9SX05BTUVdOwogdmFyIE5hdGl2ZVByb3RvdHlwZSA9IE5hdGl2ZUNvbnN0cnVjdG9yICYmIE5hdGl2ZUNvbnN0cnVjdG9yLnByb3RvdHlwZTsKIHZhciBDb25zdHJ1Y3RvciA9IE5hdGl2ZUNvbnN0cnVjdG9yOwogdmFyIGV4cG9ydGVkID0ge307CiB2YXIgZml4TWV0aG9kID0gZnVuY3Rpb24gKEtFWSkgewogIHZhciB1bmN1cnJpZWROYXRpdmVNZXRob2QgPSB1bmN1cnJ5VGhpcyhOYXRpdmVQcm90b3R5cGVbS0VZXSk7CiAgZGVmaW5lQnVpbHRJbihOYXRpdmVQcm90b3R5cGUsIEtFWSwgS0VZID09ICdhZGQnID8gZnVuY3Rpb24gYWRkKHZhbHVlKSB7CiAgIHVuY3VycmllZE5hdGl2ZU1ldGhvZCh0aGlzLCB2YWx1ZSA9PT0gMCA/IDAgOiB2YWx1ZSk7CiAgIHJldHVybiB0aGlzOwogIH0gOiBLRVkgPT0gJ2RlbGV0ZScgPyBmdW5jdGlvbiAoa2V5KSB7CiAgIHJldHVybiBJU19XRUFLICYmICFpc09iamVjdChrZXkpID8gZmFsc2UgOiB1bmN1cnJpZWROYXRpdmVNZXRob2QodGhpcywga2V5ID09PSAwID8gMCA6IGtleSk7CiAgfSA6IEtFWSA9PSAnZ2V0JyA/IGZ1bmN0aW9uIGdldChrZXkpIHsKICAgcmV0dXJuIElTX1dFQUsgJiYgIWlzT2JqZWN0KGtleSkgPyB1bmRlZmluZWQgOiB1bmN1cnJpZWROYXRpdmVNZXRob2QodGhpcywga2V5ID09PSAwID8gMCA6IGtleSk7CiAgfSA6IEtFWSA9PSAnaGFzJyA/IGZ1bmN0aW9uIGhhcyhrZXkpIHsKICAgcmV0dXJuIElTX1dFQUsgJiYgIWlzT2JqZWN0KGtleSkgPyBmYWxzZSA6IHVuY3VycmllZE5hdGl2ZU1ldGhvZCh0aGlzLCBrZXkgPT09IDAgPyAwIDoga2V5KTsKICB9IDogZnVuY3Rpb24gc2V0KGtleSwgdmFsdWUpIHsKICAgdW5jdXJyaWVkTmF0aXZlTWV0aG9kKHRoaXMsIGtleSA9PT0gMCA/IDAgOiBrZXksIHZhbHVlKTsKICAgcmV0dXJuIHRoaXM7CiAgfSk7CiB9OwogdmFyIFJFUExBQ0UgPSBpc0ZvcmNlZChDT05TVFJVQ1RPUl9OQU1FLCAhaXNDYWxsYWJsZShOYXRpdmVDb25zdHJ1Y3RvcikgfHwgIShJU19XRUFLIHx8IE5hdGl2ZVByb3RvdHlwZS5mb3JFYWNoICYmICFmYWlscyhmdW5jdGlvbiAoKSB7CiAgbmV3IE5hdGl2ZUNvbnN0cnVjdG9yKCkuZW50cmllcygpLm5leHQoKTsKIH0pKSk7CiBpZiAoUkVQTEFDRSkgewogIENvbnN0cnVjdG9yID0gY29tbW9uLmdldENvbnN0cnVjdG9yKHdyYXBwZXIsIENPTlNUUlVDVE9SX05BTUUsIElTX01BUCwgQURERVIpOwogIEludGVybmFsTWV0YWRhdGFNb2R1bGUuZW5hYmxlKCk7CiB9IGVsc2UgaWYgKGlzRm9yY2VkKENPTlNUUlVDVE9SX05BTUUsIHRydWUpKSB7CiAgdmFyIGluc3RhbmNlID0gbmV3IENvbnN0cnVjdG9yKCk7CiAgdmFyIEhBU05UX0NIQUlOSU5HID0gaW5zdGFuY2VbQURERVJdKElTX1dFQUsgPyB7fSA6IC0wLCAxKSAhPSBpbnN0YW5jZTsKICB2YXIgVEhST1dTX09OX1BSSU1JVElWRVMgPSBmYWlscyhmdW5jdGlvbiAoKSB7CiAgIGluc3RhbmNlLmhhcygxKTsKICB9KTsKICB2YXIgQUNDRVBUX0lURVJBQkxFUyA9IGNoZWNrQ29ycmVjdG5lc3NPZkl0ZXJhdGlvbihmdW5jdGlvbiAoaXRlcmFibGUpIHsKICAgbmV3IE5hdGl2ZUNvbnN0cnVjdG9yKGl0ZXJhYmxlKTsKICB9KTsKICB2YXIgQlVHR1lfWkVSTyA9ICFJU19XRUFLICYmIGZhaWxzKGZ1bmN0aW9uICgpIHsKICAgdmFyICRpbnN0YW5jZSA9IG5ldyBOYXRpdmVDb25zdHJ1Y3RvcigpOwogICB2YXIgaW5kZXggPSA1OwogICB3aGlsZSAoaW5kZXgtLSkKICAgICRpbnN0YW5jZVtBRERFUl0oaW5kZXgsIGluZGV4KTsKICAgcmV0dXJuICEkaW5zdGFuY2UuaGFzKC0wKTsKICB9KTsKICBpZiAoIUFDQ0VQVF9JVEVSQUJMRVMpIHsKICAgQ29uc3RydWN0b3IgPSB3cmFwcGVyKGZ1bmN0aW9uIChkdW1teSwgaXRlcmFibGUpIHsKICAgIGFuSW5zdGFuY2UoZHVtbXksIE5hdGl2ZVByb3RvdHlwZSk7CiAgICB2YXIgdGhhdCA9IGluaGVyaXRJZlJlcXVpcmVkKG5ldyBOYXRpdmVDb25zdHJ1Y3RvcigpLCBkdW1teSwgQ29uc3RydWN0b3IpOwogICAgaWYgKGl0ZXJhYmxlICE9IHVuZGVmaW5lZCkKICAgICBpdGVyYXRlKGl0ZXJhYmxlLCB0aGF0W0FEREVSXSwgewogICAgICB0aGF0OiB0aGF0LAogICAgICBBU19FTlRSSUVTOiBJU19NQVAKICAgICB9KTsKICAgIHJldHVybiB0aGF0OwogICB9KTsKICAgQ29uc3RydWN0b3IucHJvdG90eXBlID0gTmF0aXZlUHJvdG90eXBlOwogICBOYXRpdmVQcm90b3R5cGUuY29uc3RydWN0b3IgPSBDb25zdHJ1Y3RvcjsKICB9CiAgaWYgKFRIUk9XU19PTl9QUklNSVRJVkVTIHx8IEJVR0dZX1pFUk8pIHsKICAgZml4TWV0aG9kKCdkZWxldGUnKTsKICAgZml4TWV0aG9kKCdoYXMnKTsKICAgSVNfTUFQICYmIGZpeE1ldGhvZCgnZ2V0Jyk7CiAgfQogIGlmIChCVUdHWV9aRVJPIHx8IEhBU05UX0NIQUlOSU5HKQogICBmaXhNZXRob2QoQURERVIpOwogIGlmIChJU19XRUFLICYmIE5hdGl2ZVByb3RvdHlwZS5jbGVhcikKICAgZGVsZXRlIE5hdGl2ZVByb3RvdHlwZS5jbGVhcjsKIH0KIGV4cG9ydGVkW0NPTlNUUlVDVE9SX05BTUVdID0gQ29uc3RydWN0b3I7CiAkKHsKICBnbG9iYWw6IHRydWUsCiAgY29uc3RydWN0b3I6IHRydWUsCiAgZm9yY2VkOiBDb25zdHJ1Y3RvciAhPSBOYXRpdmVDb25zdHJ1Y3RvcgogfSwgZXhwb3J0ZWQpOwogc2V0VG9TdHJpbmdUYWcoQ29uc3RydWN0b3IsIENPTlNUUlVDVE9SX05BTUUpOwogaWYgKCFJU19XRUFLKQogIGNvbW1vbi5zZXRTdHJvbmcoQ29uc3RydWN0b3IsIENPTlNUUlVDVE9SX05BTUUsIElTX01BUCk7CiByZXR1cm4gQ29uc3RydWN0b3I7Cn07CgovKioqLyB9KSwKLyogOTkgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcpOwp2YXIgdW5jdXJyeVRoaXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE4KTsKdmFyIGhpZGRlbktleXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU3KTsKdmFyIGlzT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMyk7CnZhciBoYXNPd24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQxKTsKdmFyIGRlZmluZVByb3BlcnR5ID0gKF9fd19wZGZqc19yZXF1aXJlX18oNDcpLmYpOwp2YXIgZ2V0T3duUHJvcGVydHlOYW1lc01vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNjApOwp2YXIgZ2V0T3duUHJvcGVydHlOYW1lc0V4dGVybmFsTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMDApOwp2YXIgaXNFeHRlbnNpYmxlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMDMpOwp2YXIgdWlkID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Myk7CnZhciBGUkVFWklORyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTA1KTsKdmFyIFJFUVVJUkVEID0gZmFsc2U7CnZhciBNRVRBREFUQSA9IHVpZCgnbWV0YScpOwp2YXIgaWQgPSAwOwp2YXIgc2V0TWV0YWRhdGEgPSBmdW5jdGlvbiAoaXQpIHsKIGRlZmluZVByb3BlcnR5KGl0LCBNRVRBREFUQSwgewogIHZhbHVlOiB7CiAgIG9iamVjdElEOiAnTycgKyBpZCsrLAogICB3ZWFrRGF0YToge30KICB9CiB9KTsKfTsKdmFyIGZhc3RLZXkgPSBmdW5jdGlvbiAoaXQsIGNyZWF0ZSkgewogaWYgKCFpc09iamVjdChpdCkpCiAgcmV0dXJuIHR5cGVvZiBpdCA9PSAnc3ltYm9sJyA/IGl0IDogKHR5cGVvZiBpdCA9PSAnc3RyaW5nJyA/ICdTJyA6ICdQJykgKyBpdDsKIGlmICghaGFzT3duKGl0LCBNRVRBREFUQSkpIHsKICBpZiAoIWlzRXh0ZW5zaWJsZShpdCkpCiAgIHJldHVybiAnRic7CiAgaWYgKCFjcmVhdGUpCiAgIHJldHVybiAnRSc7CiAgc2V0TWV0YWRhdGEoaXQpOwogfQogcmV0dXJuIGl0W01FVEFEQVRBXS5vYmplY3RJRDsKfTsKdmFyIGdldFdlYWtEYXRhID0gZnVuY3Rpb24gKGl0LCBjcmVhdGUpIHsKIGlmICghaGFzT3duKGl0LCBNRVRBREFUQSkpIHsKICBpZiAoIWlzRXh0ZW5zaWJsZShpdCkpCiAgIHJldHVybiB0cnVlOwogIGlmICghY3JlYXRlKQogICByZXR1cm4gZmFsc2U7CiAgc2V0TWV0YWRhdGEoaXQpOwogfQogcmV0dXJuIGl0W01FVEFEQVRBXS53ZWFrRGF0YTsKfTsKdmFyIG9uRnJlZXplID0gZnVuY3Rpb24gKGl0KSB7CiBpZiAoRlJFRVpJTkcgJiYgUkVRVUlSRUQgJiYgaXNFeHRlbnNpYmxlKGl0KSAmJiAhaGFzT3duKGl0LCBNRVRBREFUQSkpCiAgc2V0TWV0YWRhdGEoaXQpOwogcmV0dXJuIGl0Owp9Owp2YXIgZW5hYmxlID0gZnVuY3Rpb24gKCkgewogbWV0YS5lbmFibGUgPSBmdW5jdGlvbiAoKSB7CiB9OwogUkVRVUlSRUQgPSB0cnVlOwogdmFyIGdldE93blByb3BlcnR5TmFtZXMgPSBnZXRPd25Qcm9wZXJ0eU5hbWVzTW9kdWxlLmY7CiB2YXIgc3BsaWNlID0gdW5jdXJyeVRoaXMoW10uc3BsaWNlKTsKIHZhciB0ZXN0ID0ge307CiB0ZXN0W01FVEFEQVRBXSA9IDE7CiBpZiAoZ2V0T3duUHJvcGVydHlOYW1lcyh0ZXN0KS5sZW5ndGgpIHsKICBnZXRPd25Qcm9wZXJ0eU5hbWVzTW9kdWxlLmYgPSBmdW5jdGlvbiAoaXQpIHsKICAgdmFyIHJlc3VsdCA9IGdldE93blByb3BlcnR5TmFtZXMoaXQpOwogICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gcmVzdWx0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICBpZiAocmVzdWx0W2ldID09PSBNRVRBREFUQSkgewogICAgIHNwbGljZShyZXN1bHQsIGksIDEpOwogICAgIGJyZWFrOwogICAgfQogICB9CiAgIHJldHVybiByZXN1bHQ7CiAgfTsKICAkKHsKICAgdGFyZ2V0OiAnT2JqZWN0JywKICAgc3RhdDogdHJ1ZSwKICAgZm9yY2VkOiB0cnVlCiAgfSwgeyBnZXRPd25Qcm9wZXJ0eU5hbWVzOiBnZXRPd25Qcm9wZXJ0eU5hbWVzRXh0ZXJuYWxNb2R1bGUuZiB9KTsKIH0KfTsKdmFyIG1ldGEgPSBtb2R1bGUuZXhwb3J0cyA9IHsKIGVuYWJsZTogZW5hYmxlLAogZmFzdEtleTogZmFzdEtleSwKIGdldFdlYWtEYXRhOiBnZXRXZWFrRGF0YSwKIG9uRnJlZXplOiBvbkZyZWV6ZQp9OwpoaWRkZW5LZXlzW01FVEFEQVRBXSA9IHRydWU7CgovKioqLyB9KSwKLyogMTAwICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBjbGFzc29mID0gX193X3BkZmpzX3JlcXVpcmVfXygxOSk7CnZhciB0b0luZGV4ZWRPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2KTsKdmFyICRnZXRPd25Qcm9wZXJ0eU5hbWVzID0gKF9fd19wZGZqc19yZXF1aXJlX18oNjApLmYpOwp2YXIgYXJyYXlTbGljZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTAxKTsKdmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW107CnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uIChpdCkgewogdHJ5IHsKICByZXR1cm4gJGdldE93blByb3BlcnR5TmFtZXMoaXQpOwogfSBjYXRjaCAoZXJyb3IpIHsKICByZXR1cm4gYXJyYXlTbGljZSh3aW5kb3dOYW1lcyk7CiB9Cn07Cm1vZHVsZS5leHBvcnRzLmYgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKGl0KSB7CiByZXR1cm4gd2luZG93TmFtZXMgJiYgY2xhc3NvZihpdCkgPT0gJ1dpbmRvdycgPyBnZXRXaW5kb3dOYW1lcyhpdCkgOiAkZ2V0T3duUHJvcGVydHlOYW1lcyh0b0luZGV4ZWRPYmplY3QoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAxMDEgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHRvQWJzb2x1dGVJbmRleCA9IF9fd19wZGZqc19yZXF1aXJlX18oNjMpOwp2YXIgbGVuZ3RoT2ZBcnJheUxpa2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDY2KTsKdmFyIGNyZWF0ZVByb3BlcnR5ID0gX193X3BkZmpzX3JlcXVpcmVfXygxMDIpOwp2YXIgJEFycmF5ID0gQXJyYXk7CnZhciBtYXggPSBNYXRoLm1heDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoTywgc3RhcnQsIGVuZCkgewogdmFyIGxlbmd0aCA9IGxlbmd0aE9mQXJyYXlMaWtlKE8pOwogdmFyIGsgPSB0b0Fic29sdXRlSW5kZXgoc3RhcnQsIGxlbmd0aCk7CiB2YXIgZmluID0gdG9BYnNvbHV0ZUluZGV4KGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuZ3RoIDogZW5kLCBsZW5ndGgpOwogdmFyIHJlc3VsdCA9ICRBcnJheShtYXgoZmluIC0gaywgMCkpOwogZm9yICh2YXIgbiA9IDA7IGsgPCBmaW47IGsrKywgbisrKQogIGNyZWF0ZVByb3BlcnR5KHJlc3VsdCwgbiwgT1trXSk7CiByZXN1bHQubGVuZ3RoID0gbjsKIHJldHVybiByZXN1bHQ7Cn07CgovKioqLyB9KSwKLyogMTAyICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciB0b1Byb3BlcnR5S2V5ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMSk7CnZhciBkZWZpbmVQcm9wZXJ0eU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNDcpOwp2YXIgY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yID0gX193X3BkZmpzX3JlcXVpcmVfXygxNSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9iamVjdCwga2V5LCB2YWx1ZSkgewogdmFyIHByb3BlcnR5S2V5ID0gdG9Qcm9wZXJ0eUtleShrZXkpOwogaWYgKHByb3BlcnR5S2V5IGluIG9iamVjdCkKICBkZWZpbmVQcm9wZXJ0eU1vZHVsZS5mKG9iamVjdCwgcHJvcGVydHlLZXksIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvcigwLCB2YWx1ZSkpOwogZWxzZQogIG9iamVjdFtwcm9wZXJ0eUtleV0gPSB2YWx1ZTsKfTsKCi8qKiovIH0pLAovKiAxMDMgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBpc09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgY2xhc3NvZiA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkpOwp2YXIgQVJSQVlfQlVGRkVSX05PTl9FWFRFTlNJQkxFID0gX193X3BkZmpzX3JlcXVpcmVfXygxMDQpOwp2YXIgJGlzRXh0ZW5zaWJsZSA9IE9iamVjdC5pc0V4dGVuc2libGU7CnZhciBGQUlMU19PTl9QUklNSVRJVkVTID0gZmFpbHMoZnVuY3Rpb24gKCkgewogJGlzRXh0ZW5zaWJsZSgxKTsKfSk7Cm1vZHVsZS5leHBvcnRzID0gRkFJTFNfT05fUFJJTUlUSVZFUyB8fCBBUlJBWV9CVUZGRVJfTk9OX0VYVEVOU0lCTEUgPyBmdW5jdGlvbiBpc0V4dGVuc2libGUoaXQpIHsKIGlmICghaXNPYmplY3QoaXQpKQogIHJldHVybiBmYWxzZTsKIGlmIChBUlJBWV9CVUZGRVJfTk9OX0VYVEVOU0lCTEUgJiYgY2xhc3NvZihpdCkgPT0gJ0FycmF5QnVmZmVyJykKICByZXR1cm4gZmFsc2U7CiByZXR1cm4gJGlzRXh0ZW5zaWJsZSA/ICRpc0V4dGVuc2libGUoaXQpIDogdHJ1ZTsKfSA6ICRpc0V4dGVuc2libGU7CgovKioqLyB9KSwKLyogMTA0ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBmYWlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwptb2R1bGUuZXhwb3J0cyA9IGZhaWxzKGZ1bmN0aW9uICgpIHsKIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgPT0gJ2Z1bmN0aW9uJykgewogIHZhciBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoOCk7CiAgaWYgKE9iamVjdC5pc0V4dGVuc2libGUoYnVmZmVyKSkKICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGJ1ZmZlciwgJ2EnLCB7IHZhbHVlOiA4IH0pOwogfQp9KTsKCi8qKiovIH0pLAovKiAxMDUgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gIWZhaWxzKGZ1bmN0aW9uICgpIHsKIHJldHVybiBPYmplY3QuaXNFeHRlbnNpYmxlKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpOwp9KTsKCi8qKiovIH0pLAovKiAxMDYgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGJpbmQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwNyk7CnZhciBjYWxsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMik7CnZhciBhbk9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDkpOwp2YXIgdHJ5VG9TdHJpbmcgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM0KTsKdmFyIGlzQXJyYXlJdGVyYXRvck1ldGhvZCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTA4KTsKdmFyIGxlbmd0aE9mQXJyYXlMaWtlID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Nik7CnZhciBpc1Byb3RvdHlwZU9mID0gX193X3BkZmpzX3JlcXVpcmVfXygyNyk7CnZhciBnZXRJdGVyYXRvciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTA5KTsKdmFyIGdldEl0ZXJhdG9yTWV0aG9kID0gX193X3BkZmpzX3JlcXVpcmVfXygxMTApOwp2YXIgaXRlcmF0b3JDbG9zZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTExKTsKdmFyICRUeXBlRXJyb3IgPSBUeXBlRXJyb3I7CnZhciBSZXN1bHQgPSBmdW5jdGlvbiAoc3RvcHBlZCwgcmVzdWx0KSB7CiB0aGlzLnN0b3BwZWQgPSBzdG9wcGVkOwogdGhpcy5yZXN1bHQgPSByZXN1bHQ7Cn07CnZhciBSZXN1bHRQcm90b3R5cGUgPSBSZXN1bHQucHJvdG90eXBlOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdGVyYWJsZSwgdW5ib3VuZEZ1bmN0aW9uLCBvcHRpb25zKSB7CiB2YXIgdGhhdCA9IG9wdGlvbnMgJiYgb3B0aW9ucy50aGF0OwogdmFyIEFTX0VOVFJJRVMgPSAhIShvcHRpb25zICYmIG9wdGlvbnMuQVNfRU5UUklFUyk7CiB2YXIgSVNfUkVDT1JEID0gISEob3B0aW9ucyAmJiBvcHRpb25zLklTX1JFQ09SRCk7CiB2YXIgSVNfSVRFUkFUT1IgPSAhIShvcHRpb25zICYmIG9wdGlvbnMuSVNfSVRFUkFUT1IpOwogdmFyIElOVEVSUlVQVEVEID0gISEob3B0aW9ucyAmJiBvcHRpb25zLklOVEVSUlVQVEVEKTsKIHZhciBmbiA9IGJpbmQodW5ib3VuZEZ1bmN0aW9uLCB0aGF0KTsKIHZhciBpdGVyYXRvciwgaXRlckZuLCBpbmRleCwgbGVuZ3RoLCByZXN1bHQsIG5leHQsIHN0ZXA7CiB2YXIgc3RvcCA9IGZ1bmN0aW9uIChjb25kaXRpb24pIHsKICBpZiAoaXRlcmF0b3IpCiAgIGl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsICdub3JtYWwnLCBjb25kaXRpb24pOwogIHJldHVybiBuZXcgUmVzdWx0KHRydWUsIGNvbmRpdGlvbik7CiB9OwogdmFyIGNhbGxGbiA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIGlmIChBU19FTlRSSUVTKSB7CiAgIGFuT2JqZWN0KHZhbHVlKTsKICAgcmV0dXJuIElOVEVSUlVQVEVEID8gZm4odmFsdWVbMF0sIHZhbHVlWzFdLCBzdG9wKSA6IGZuKHZhbHVlWzBdLCB2YWx1ZVsxXSk7CiAgfQogIHJldHVybiBJTlRFUlJVUFRFRCA/IGZuKHZhbHVlLCBzdG9wKSA6IGZuKHZhbHVlKTsKIH07CiBpZiAoSVNfUkVDT1JEKSB7CiAgaXRlcmF0b3IgPSBpdGVyYWJsZS5pdGVyYXRvcjsKIH0gZWxzZSBpZiAoSVNfSVRFUkFUT1IpIHsKICBpdGVyYXRvciA9IGl0ZXJhYmxlOwogfSBlbHNlIHsKICBpdGVyRm4gPSBnZXRJdGVyYXRvck1ldGhvZChpdGVyYWJsZSk7CiAgaWYgKCFpdGVyRm4pCiAgIHRocm93ICRUeXBlRXJyb3IodHJ5VG9TdHJpbmcoaXRlcmFibGUpICsgJyBpcyBub3QgaXRlcmFibGUnKTsKICBpZiAoaXNBcnJheUl0ZXJhdG9yTWV0aG9kKGl0ZXJGbikpIHsKICAgZm9yIChpbmRleCA9IDAsIGxlbmd0aCA9IGxlbmd0aE9mQXJyYXlMaWtlKGl0ZXJhYmxlKTsgbGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIHsKICAgIHJlc3VsdCA9IGNhbGxGbihpdGVyYWJsZVtpbmRleF0pOwogICAgaWYgKHJlc3VsdCAmJiBpc1Byb3RvdHlwZU9mKFJlc3VsdFByb3RvdHlwZSwgcmVzdWx0KSkKICAgICByZXR1cm4gcmVzdWx0OwogICB9CiAgIHJldHVybiBuZXcgUmVzdWx0KGZhbHNlKTsKICB9CiAgaXRlcmF0b3IgPSBnZXRJdGVyYXRvcihpdGVyYWJsZSwgaXRlckZuKTsKIH0KIG5leHQgPSBJU19SRUNPUkQgPyBpdGVyYWJsZS5uZXh0IDogaXRlcmF0b3IubmV4dDsKIHdoaWxlICghKHN0ZXAgPSBjYWxsKG5leHQsIGl0ZXJhdG9yKSkuZG9uZSkgewogIHRyeSB7CiAgIHJlc3VsdCA9IGNhbGxGbihzdGVwLnZhbHVlKTsKICB9IGNhdGNoIChlcnJvcikgewogICBpdGVyYXRvckNsb3NlKGl0ZXJhdG9yLCAndGhyb3cnLCBlcnJvcik7CiAgfQogIGlmICh0eXBlb2YgcmVzdWx0ID09ICdvYmplY3QnICYmIHJlc3VsdCAmJiBpc1Byb3RvdHlwZU9mKFJlc3VsdFByb3RvdHlwZSwgcmVzdWx0KSkKICAgcmV0dXJuIHJlc3VsdDsKIH0KIHJldHVybiBuZXcgUmVzdWx0KGZhbHNlKTsKfTsKCi8qKiovIH0pLAovKiAxMDcgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHVuY3VycnlUaGlzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOCk7CnZhciBhQ2FsbGFibGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDMzKTsKdmFyIE5BVElWRV9CSU5EID0gX193X3BkZmpzX3JlcXVpcmVfXygxMyk7CnZhciBiaW5kID0gdW5jdXJyeVRoaXModW5jdXJyeVRoaXMuYmluZCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGZuLCB0aGF0KSB7CiBhQ2FsbGFibGUoZm4pOwogcmV0dXJuIHRoYXQgPT09IHVuZGVmaW5lZCA/IGZuIDogTkFUSVZFX0JJTkQgPyBiaW5kKGZuLCB0aGF0KSA6IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKIH07Cn07CgovKioqLyB9KSwKLyogMTA4ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM2KTsKdmFyIEl0ZXJhdG9ycyA9IF9fd19wZGZqc19yZXF1aXJlX18oODkpOwp2YXIgSVRFUkFUT1IgPSB3ZWxsS25vd25TeW1ib2woJ2l0ZXJhdG9yJyk7CnZhciBBcnJheVByb3RvdHlwZSA9IEFycmF5LnByb3RvdHlwZTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKIHJldHVybiBpdCAhPT0gdW5kZWZpbmVkICYmIChJdGVyYXRvcnMuQXJyYXkgPT09IGl0IHx8IEFycmF5UHJvdG90eXBlW0lURVJBVE9SXSA9PT0gaXQpOwp9OwoKLyoqKi8gfSksCi8qIDEwOSAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgY2FsbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTIpOwp2YXIgYUNhbGxhYmxlID0gX193X3BkZmpzX3JlcXVpcmVfXygzMyk7CnZhciBhbk9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDkpOwp2YXIgdHJ5VG9TdHJpbmcgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM0KTsKdmFyIGdldEl0ZXJhdG9yTWV0aG9kID0gX193X3BkZmpzX3JlcXVpcmVfXygxMTApOwp2YXIgJFR5cGVFcnJvciA9IFR5cGVFcnJvcjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXJndW1lbnQsIHVzaW5nSXRlcmF0b3IpIHsKIHZhciBpdGVyYXRvck1ldGhvZCA9IGFyZ3VtZW50cy5sZW5ndGggPCAyID8gZ2V0SXRlcmF0b3JNZXRob2QoYXJndW1lbnQpIDogdXNpbmdJdGVyYXRvcjsKIGlmIChhQ2FsbGFibGUoaXRlcmF0b3JNZXRob2QpKQogIHJldHVybiBhbk9iamVjdChjYWxsKGl0ZXJhdG9yTWV0aG9kLCBhcmd1bWVudCkpOwogdGhyb3cgJFR5cGVFcnJvcih0cnlUb1N0cmluZyhhcmd1bWVudCkgKyAnIGlzIG5vdCBpdGVyYWJsZScpOwp9OwoKLyoqKi8gfSksCi8qIDExMCAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgY2xhc3NvZiA9IF9fd19wZGZqc19yZXF1aXJlX18oODEpOwp2YXIgZ2V0TWV0aG9kID0gX193X3BkZmpzX3JlcXVpcmVfXygzMik7CnZhciBJdGVyYXRvcnMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg5KTsKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzYpOwp2YXIgSVRFUkFUT1IgPSB3ZWxsS25vd25TeW1ib2woJ2l0ZXJhdG9yJyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7CiBpZiAoaXQgIT0gdW5kZWZpbmVkKQogIHJldHVybiBnZXRNZXRob2QoaXQsIElURVJBVE9SKSB8fCBnZXRNZXRob2QoaXQsICdAQGl0ZXJhdG9yJykgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsKfTsKCi8qKiovIH0pLAovKiAxMTEgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGNhbGwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyKTsKdmFyIGFuT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0OSk7CnZhciBnZXRNZXRob2QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDMyKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXRlcmF0b3IsIGtpbmQsIHZhbHVlKSB7CiB2YXIgaW5uZXJSZXN1bHQsIGlubmVyRXJyb3I7CiBhbk9iamVjdChpdGVyYXRvcik7CiB0cnkgewogIGlubmVyUmVzdWx0ID0gZ2V0TWV0aG9kKGl0ZXJhdG9yLCAncmV0dXJuJyk7CiAgaWYgKCFpbm5lclJlc3VsdCkgewogICBpZiAoa2luZCA9PT0gJ3Rocm93JykKICAgIHRocm93IHZhbHVlOwogICByZXR1cm4gdmFsdWU7CiAgfQogIGlubmVyUmVzdWx0ID0gY2FsbChpbm5lclJlc3VsdCwgaXRlcmF0b3IpOwogfSBjYXRjaCAoZXJyb3IpIHsKICBpbm5lckVycm9yID0gdHJ1ZTsKICBpbm5lclJlc3VsdCA9IGVycm9yOwogfQogaWYgKGtpbmQgPT09ICd0aHJvdycpCiAgdGhyb3cgdmFsdWU7CiBpZiAoaW5uZXJFcnJvcikKICB0aHJvdyBpbm5lclJlc3VsdDsKIGFuT2JqZWN0KGlubmVyUmVzdWx0KTsKIHJldHVybiB2YWx1ZTsKfTsKCi8qKiovIH0pLAovKiAxMTIgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGlzUHJvdG90eXBlT2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI3KTsKdmFyICRUeXBlRXJyb3IgPSBUeXBlRXJyb3I7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0LCBQcm90b3R5cGUpIHsKIGlmIChpc1Byb3RvdHlwZU9mKFByb3RvdHlwZSwgaXQpKQogIHJldHVybiBpdDsKIHRocm93ICRUeXBlRXJyb3IoJ0luY29ycmVjdCBpbnZvY2F0aW9uJyk7Cn07CgovKioqLyB9KSwKLyogMTEzICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM2KTsKdmFyIElURVJBVE9SID0gd2VsbEtub3duU3ltYm9sKCdpdGVyYXRvcicpOwp2YXIgU0FGRV9DTE9TSU5HID0gZmFsc2U7CnRyeSB7CiB2YXIgY2FsbGVkID0gMDsKIHZhciBpdGVyYXRvcldpdGhSZXR1cm4gPSB7CiAgbmV4dDogZnVuY3Rpb24gKCkgewogICByZXR1cm4geyBkb25lOiAhIWNhbGxlZCsrIH07CiAgfSwKICAncmV0dXJuJzogZnVuY3Rpb24gKCkgewogICBTQUZFX0NMT1NJTkcgPSB0cnVlOwogIH0KIH07CiBpdGVyYXRvcldpdGhSZXR1cm5bSVRFUkFUT1JdID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB0aGlzOwogfTsKIEFycmF5LmZyb20oaXRlcmF0b3JXaXRoUmV0dXJuLCBmdW5jdGlvbiAoKSB7CiAgdGhyb3cgMjsKIH0pOwp9IGNhdGNoIChlcnJvcikgewp9Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGV4ZWMsIFNLSVBfQ0xPU0lORykgewogaWYgKCFTS0lQX0NMT1NJTkcgJiYgIVNBRkVfQ0xPU0lORykKICByZXR1cm4gZmFsc2U7CiB2YXIgSVRFUkFUSU9OX1NVUFBPUlQgPSBmYWxzZTsKIHRyeSB7CiAgdmFyIG9iamVjdCA9IHt9OwogIG9iamVjdFtJVEVSQVRPUl0gPSBmdW5jdGlvbiAoKSB7CiAgIHJldHVybiB7CiAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CiAgICAgcmV0dXJuIHsgZG9uZTogSVRFUkFUSU9OX1NVUFBPUlQgPSB0cnVlIH07CiAgICB9CiAgIH07CiAgfTsKICBleGVjKG9iamVjdCk7CiB9IGNhdGNoIChlcnJvcikgewogfQogcmV0dXJuIElURVJBVElPTl9TVVBQT1JUOwp9OwoKLyoqKi8gfSksCi8qIDExNCAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgaXNDYWxsYWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjQpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzKTsKdmFyIHNldFByb3RvdHlwZU9mID0gX193X3BkZmpzX3JlcXVpcmVfXyg4NSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKCR0aGlzLCBkdW1teSwgV3JhcHBlcikgewogdmFyIE5ld1RhcmdldCwgTmV3VGFyZ2V0UHJvdG90eXBlOwogaWYgKHNldFByb3RvdHlwZU9mICYmIGlzQ2FsbGFibGUoTmV3VGFyZ2V0ID0gZHVtbXkuY29uc3RydWN0b3IpICYmIE5ld1RhcmdldCAhPT0gV3JhcHBlciAmJiBpc09iamVjdChOZXdUYXJnZXRQcm90b3R5cGUgPSBOZXdUYXJnZXQucHJvdG90eXBlKSAmJiBOZXdUYXJnZXRQcm90b3R5cGUgIT09IFdyYXBwZXIucHJvdG90eXBlKQogIHNldFByb3RvdHlwZU9mKCR0aGlzLCBOZXdUYXJnZXRQcm90b3R5cGUpOwogcmV0dXJuICR0aGlzOwp9OwoKLyoqKi8gfSksCi8qIDExNSAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZGVmaW5lUHJvcGVydHkgPSAoX193X3BkZmpzX3JlcXVpcmVfXyg0NykuZik7CnZhciBjcmVhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcyKTsKdmFyIGRlZmluZUJ1aWx0SW5zID0gX193X3BkZmpzX3JlcXVpcmVfXygxMTYpOwp2YXIgYmluZCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTA3KTsKdmFyIGFuSW5zdGFuY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExMik7CnZhciBpdGVyYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMDYpOwp2YXIgZGVmaW5lSXRlcmF0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDkwKTsKdmFyIHNldFNwZWNpZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExNyk7CnZhciBERVNDUklQVE9SUyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwp2YXIgZmFzdEtleSA9IChfX3dfcGRmanNfcmVxdWlyZV9fKDk5KS5mYXN0S2V5KTsKdmFyIEludGVybmFsU3RhdGVNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU0KTsKdmFyIHNldEludGVybmFsU3RhdGUgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLnNldDsKdmFyIGludGVybmFsU3RhdGVHZXR0ZXJGb3IgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLmdldHRlckZvcjsKbW9kdWxlLmV4cG9ydHMgPSB7CiBnZXRDb25zdHJ1Y3RvcjogZnVuY3Rpb24gKHdyYXBwZXIsIENPTlNUUlVDVE9SX05BTUUsIElTX01BUCwgQURERVIpIHsKICB2YXIgQ29uc3RydWN0b3IgPSB3cmFwcGVyKGZ1bmN0aW9uICh0aGF0LCBpdGVyYWJsZSkgewogICBhbkluc3RhbmNlKHRoYXQsIFByb3RvdHlwZSk7CiAgIHNldEludGVybmFsU3RhdGUodGhhdCwgewogICAgdHlwZTogQ09OU1RSVUNUT1JfTkFNRSwKICAgIGluZGV4OiBjcmVhdGUobnVsbCksCiAgICBmaXJzdDogdW5kZWZpbmVkLAogICAgbGFzdDogdW5kZWZpbmVkLAogICAgc2l6ZTogMAogICB9KTsKICAgaWYgKCFERVNDUklQVE9SUykKICAgIHRoYXQuc2l6ZSA9IDA7CiAgIGlmIChpdGVyYWJsZSAhPSB1bmRlZmluZWQpCiAgICBpdGVyYXRlKGl0ZXJhYmxlLCB0aGF0W0FEREVSXSwgewogICAgIHRoYXQ6IHRoYXQsCiAgICAgQVNfRU5UUklFUzogSVNfTUFQCiAgICB9KTsKICB9KTsKICB2YXIgUHJvdG90eXBlID0gQ29uc3RydWN0b3IucHJvdG90eXBlOwogIHZhciBnZXRJbnRlcm5hbFN0YXRlID0gaW50ZXJuYWxTdGF0ZUdldHRlckZvcihDT05TVFJVQ1RPUl9OQU1FKTsKICB2YXIgZGVmaW5lID0gZnVuY3Rpb24gKHRoYXQsIGtleSwgdmFsdWUpIHsKICAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxTdGF0ZSh0aGF0KTsKICAgdmFyIGVudHJ5ID0gZ2V0RW50cnkodGhhdCwga2V5KTsKICAgdmFyIHByZXZpb3VzLCBpbmRleDsKICAgaWYgKGVudHJ5KSB7CiAgICBlbnRyeS52YWx1ZSA9IHZhbHVlOwogICB9IGVsc2UgewogICAgc3RhdGUubGFzdCA9IGVudHJ5ID0gewogICAgIGluZGV4OiBpbmRleCA9IGZhc3RLZXkoa2V5LCB0cnVlKSwKICAgICBrZXk6IGtleSwKICAgICB2YWx1ZTogdmFsdWUsCiAgICAgcHJldmlvdXM6IHByZXZpb3VzID0gc3RhdGUubGFzdCwKICAgICBuZXh0OiB1bmRlZmluZWQsCiAgICAgcmVtb3ZlZDogZmFsc2UKICAgIH07CiAgICBpZiAoIXN0YXRlLmZpcnN0KQogICAgIHN0YXRlLmZpcnN0ID0gZW50cnk7CiAgICBpZiAocHJldmlvdXMpCiAgICAgcHJldmlvdXMubmV4dCA9IGVudHJ5OwogICAgaWYgKERFU0NSSVBUT1JTKQogICAgIHN0YXRlLnNpemUrKzsKICAgIGVsc2UKICAgICB0aGF0LnNpemUrKzsKICAgIGlmIChpbmRleCAhPT0gJ0YnKQogICAgIHN0YXRlLmluZGV4W2luZGV4XSA9IGVudHJ5OwogICB9CiAgIHJldHVybiB0aGF0OwogIH07CiAgdmFyIGdldEVudHJ5ID0gZnVuY3Rpb24gKHRoYXQsIGtleSkgewogICB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFN0YXRlKHRoYXQpOwogICB2YXIgaW5kZXggPSBmYXN0S2V5KGtleSk7CiAgIHZhciBlbnRyeTsKICAgaWYgKGluZGV4ICE9PSAnRicpCiAgICByZXR1cm4gc3RhdGUuaW5kZXhbaW5kZXhdOwogICBmb3IgKGVudHJ5ID0gc3RhdGUuZmlyc3Q7IGVudHJ5OyBlbnRyeSA9IGVudHJ5Lm5leHQpIHsKICAgIGlmIChlbnRyeS5rZXkgPT0ga2V5KQogICAgIHJldHVybiBlbnRyeTsKICAgfQogIH07CiAgZGVmaW5lQnVpbHRJbnMoUHJvdG90eXBlLCB7CiAgIGNsZWFyOiBmdW5jdGlvbiBjbGVhcigpIHsKICAgIHZhciB0aGF0ID0gdGhpczsKICAgIHZhciBzdGF0ZSA9IGdldEludGVybmFsU3RhdGUodGhhdCk7CiAgICB2YXIgZGF0YSA9IHN0YXRlLmluZGV4OwogICAgdmFyIGVudHJ5ID0gc3RhdGUuZmlyc3Q7CiAgICB3aGlsZSAoZW50cnkpIHsKICAgICBlbnRyeS5yZW1vdmVkID0gdHJ1ZTsKICAgICBpZiAoZW50cnkucHJldmlvdXMpCiAgICAgIGVudHJ5LnByZXZpb3VzID0gZW50cnkucHJldmlvdXMubmV4dCA9IHVuZGVmaW5lZDsKICAgICBkZWxldGUgZGF0YVtlbnRyeS5pbmRleF07CiAgICAgZW50cnkgPSBlbnRyeS5uZXh0OwogICAgfQogICAgc3RhdGUuZmlyc3QgPSBzdGF0ZS5sYXN0ID0gdW5kZWZpbmVkOwogICAgaWYgKERFU0NSSVBUT1JTKQogICAgIHN0YXRlLnNpemUgPSAwOwogICAgZWxzZQogICAgIHRoYXQuc2l6ZSA9IDA7CiAgIH0sCiAgICdkZWxldGUnOiBmdW5jdGlvbiAoa2V5KSB7CiAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFN0YXRlKHRoYXQpOwogICAgdmFyIGVudHJ5ID0gZ2V0RW50cnkodGhhdCwga2V5KTsKICAgIGlmIChlbnRyeSkgewogICAgIHZhciBuZXh0ID0gZW50cnkubmV4dDsKICAgICB2YXIgcHJldiA9IGVudHJ5LnByZXZpb3VzOwogICAgIGRlbGV0ZSBzdGF0ZS5pbmRleFtlbnRyeS5pbmRleF07CiAgICAgZW50cnkucmVtb3ZlZCA9IHRydWU7CiAgICAgaWYgKHByZXYpCiAgICAgIHByZXYubmV4dCA9IG5leHQ7CiAgICAgaWYgKG5leHQpCiAgICAgIG5leHQucHJldmlvdXMgPSBwcmV2OwogICAgIGlmIChzdGF0ZS5maXJzdCA9PSBlbnRyeSkKICAgICAgc3RhdGUuZmlyc3QgPSBuZXh0OwogICAgIGlmIChzdGF0ZS5sYXN0ID09IGVudHJ5KQogICAgICBzdGF0ZS5sYXN0ID0gcHJldjsKICAgICBpZiAoREVTQ1JJUFRPUlMpCiAgICAgIHN0YXRlLnNpemUtLTsKICAgICBlbHNlCiAgICAgIHRoYXQuc2l6ZS0tOwogICAgfQogICAgcmV0dXJuICEhZW50cnk7CiAgIH0sCiAgIGZvckVhY2g6IGZ1bmN0aW9uIGZvckVhY2goY2FsbGJhY2tmbikgewogICAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxTdGF0ZSh0aGlzKTsKICAgIHZhciBib3VuZEZ1bmN0aW9uID0gYmluZChjYWxsYmFja2ZuLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7CiAgICB2YXIgZW50cnk7CiAgICB3aGlsZSAoZW50cnkgPSBlbnRyeSA/IGVudHJ5Lm5leHQgOiBzdGF0ZS5maXJzdCkgewogICAgIGJvdW5kRnVuY3Rpb24oZW50cnkudmFsdWUsIGVudHJ5LmtleSwgdGhpcyk7CiAgICAgd2hpbGUgKGVudHJ5ICYmIGVudHJ5LnJlbW92ZWQpCiAgICAgIGVudHJ5ID0gZW50cnkucHJldmlvdXM7CiAgICB9CiAgIH0sCiAgIGhhczogZnVuY3Rpb24gaGFzKGtleSkgewogICAgcmV0dXJuICEhZ2V0RW50cnkodGhpcywga2V5KTsKICAgfQogIH0pOwogIGRlZmluZUJ1aWx0SW5zKFByb3RvdHlwZSwgSVNfTUFQID8gewogICBnZXQ6IGZ1bmN0aW9uIGdldChrZXkpIHsKICAgIHZhciBlbnRyeSA9IGdldEVudHJ5KHRoaXMsIGtleSk7CiAgICByZXR1cm4gZW50cnkgJiYgZW50cnkudmFsdWU7CiAgIH0sCiAgIHNldDogZnVuY3Rpb24gc2V0KGtleSwgdmFsdWUpIHsKICAgIHJldHVybiBkZWZpbmUodGhpcywga2V5ID09PSAwID8gMCA6IGtleSwgdmFsdWUpOwogICB9CiAgfSA6IHsKICAgYWRkOiBmdW5jdGlvbiBhZGQodmFsdWUpIHsKICAgIHJldHVybiBkZWZpbmUodGhpcywgdmFsdWUgPSB2YWx1ZSA9PT0gMCA/IDAgOiB2YWx1ZSwgdmFsdWUpOwogICB9CiAgfSk7CiAgaWYgKERFU0NSSVBUT1JTKQogICBkZWZpbmVQcm9wZXJ0eShQcm90b3R5cGUsICdzaXplJywgewogICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgcmV0dXJuIGdldEludGVybmFsU3RhdGUodGhpcykuc2l6ZTsKICAgIH0KICAgfSk7CiAgcmV0dXJuIENvbnN0cnVjdG9yOwogfSwKIHNldFN0cm9uZzogZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBDT05TVFJVQ1RPUl9OQU1FLCBJU19NQVApIHsKICB2YXIgSVRFUkFUT1JfTkFNRSA9IENPTlNUUlVDVE9SX05BTUUgKyAnIEl0ZXJhdG9yJzsKICB2YXIgZ2V0SW50ZXJuYWxDb2xsZWN0aW9uU3RhdGUgPSBpbnRlcm5hbFN0YXRlR2V0dGVyRm9yKENPTlNUUlVDVE9SX05BTUUpOwogIHZhciBnZXRJbnRlcm5hbEl0ZXJhdG9yU3RhdGUgPSBpbnRlcm5hbFN0YXRlR2V0dGVyRm9yKElURVJBVE9SX05BTUUpOwogIGRlZmluZUl0ZXJhdG9yKENvbnN0cnVjdG9yLCBDT05TVFJVQ1RPUl9OQU1FLCBmdW5jdGlvbiAoaXRlcmF0ZWQsIGtpbmQpIHsKICAgc2V0SW50ZXJuYWxTdGF0ZSh0aGlzLCB7CiAgICB0eXBlOiBJVEVSQVRPUl9OQU1FLAogICAgdGFyZ2V0OiBpdGVyYXRlZCwKICAgIHN0YXRlOiBnZXRJbnRlcm5hbENvbGxlY3Rpb25TdGF0ZShpdGVyYXRlZCksCiAgICBraW5kOiBraW5kLAogICAgbGFzdDogdW5kZWZpbmVkCiAgIH0pOwogIH0sIGZ1bmN0aW9uICgpIHsKICAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxJdGVyYXRvclN0YXRlKHRoaXMpOwogICB2YXIga2luZCA9IHN0YXRlLmtpbmQ7CiAgIHZhciBlbnRyeSA9IHN0YXRlLmxhc3Q7CiAgIHdoaWxlIChlbnRyeSAmJiBlbnRyeS5yZW1vdmVkKQogICAgZW50cnkgPSBlbnRyeS5wcmV2aW91czsKICAgaWYgKCFzdGF0ZS50YXJnZXQgfHwgIShzdGF0ZS5sYXN0ID0gZW50cnkgPSBlbnRyeSA/IGVudHJ5Lm5leHQgOiBzdGF0ZS5zdGF0ZS5maXJzdCkpIHsKICAgIHN0YXRlLnRhcmdldCA9IHVuZGVmaW5lZDsKICAgIHJldHVybiB7CiAgICAgdmFsdWU6IHVuZGVmaW5lZCwKICAgICBkb25lOiB0cnVlCiAgICB9OwogICB9CiAgIGlmIChraW5kID09ICdrZXlzJykKICAgIHJldHVybiB7CiAgICAgdmFsdWU6IGVudHJ5LmtleSwKICAgICBkb25lOiBmYWxzZQogICAgfTsKICAgaWYgKGtpbmQgPT0gJ3ZhbHVlcycpCiAgICByZXR1cm4gewogICAgIHZhbHVlOiBlbnRyeS52YWx1ZSwKICAgICBkb25lOiBmYWxzZQogICAgfTsKICAgcmV0dXJuIHsKICAgIHZhbHVlOiBbCiAgICAgZW50cnkua2V5LAogICAgIGVudHJ5LnZhbHVlCiAgICBdLAogICAgZG9uZTogZmFsc2UKICAgfTsKICB9LCBJU19NQVAgPyAnZW50cmllcycgOiAndmFsdWVzJywgIUlTX01BUCwgdHJ1ZSk7CiAgc2V0U3BlY2llcyhDT05TVFJVQ1RPUl9OQU1FKTsKIH0KfTsKCi8qKiovIH0pLAovKiAxMTYgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGRlZmluZUJ1aWx0SW4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUwKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodGFyZ2V0LCBzcmMsIG9wdGlvbnMpIHsKIGZvciAodmFyIGtleSBpbiBzcmMpCiAgZGVmaW5lQnVpbHRJbih0YXJnZXQsIGtleSwgc3JjW2tleV0sIG9wdGlvbnMpOwogcmV0dXJuIHRhcmdldDsKfTsKCi8qKiovIH0pLAovKiAxMTcgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKdmFyIGdldEJ1aWx0SW4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI2KTsKdmFyIGRlZmluZVByb3BlcnR5TW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Nyk7CnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM2KTsKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBTUEVDSUVTID0gd2VsbEtub3duU3ltYm9sKCdzcGVjaWVzJyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKENPTlNUUlVDVE9SX05BTUUpIHsKIHZhciBDb25zdHJ1Y3RvciA9IGdldEJ1aWx0SW4oQ09OU1RSVUNUT1JfTkFNRSk7CiB2YXIgZGVmaW5lUHJvcGVydHkgPSBkZWZpbmVQcm9wZXJ0eU1vZHVsZS5mOwogaWYgKERFU0NSSVBUT1JTICYmIENvbnN0cnVjdG9yICYmICFDb25zdHJ1Y3RvcltTUEVDSUVTXSkgewogIGRlZmluZVByb3BlcnR5KENvbnN0cnVjdG9yLCBTUEVDSUVTLCB7CiAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpczsKICAgfQogIH0pOwogfQp9OwoKLyoqKi8gfSksCi8qIDExOCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCl9fd19wZGZqc19yZXF1aXJlX18oMTE5KTsKCi8qKiovIH0pLAovKiAxMTkgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7Cgp2YXIgY29sbGVjdGlvbiA9IF9fd19wZGZqc19yZXF1aXJlX18oOTgpOwp2YXIgY29sbGVjdGlvblN0cm9uZyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTE1KTsKY29sbGVjdGlvbignU2V0JywgZnVuY3Rpb24gKGluaXQpIHsKIHJldHVybiBmdW5jdGlvbiBTZXQoKSB7CiAgcmV0dXJuIGluaXQodGhpcywgYXJndW1lbnRzLmxlbmd0aCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7CiB9Owp9LCBjb2xsZWN0aW9uU3Ryb25nKTsKCi8qKiovIH0pLAovKiAxMjAgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7Cgp2YXIgSVNfUFVSRSA9IF9fd19wZGZqc19yZXF1aXJlX18oMzgpOwp2YXIgJCA9IF9fd19wZGZqc19yZXF1aXJlX18oNyk7CnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgpOwp2YXIgZ2V0QnVpbHRpbiA9IF9fd19wZGZqc19yZXF1aXJlX18oMjYpOwp2YXIgdW5jdXJyeVRoaXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE4KTsKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciB1aWQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQzKTsKdmFyIGlzQ2FsbGFibGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI0KTsKdmFyIGlzQ29uc3RydWN0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyMSk7CnZhciBpc09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgaXNTeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI1KTsKdmFyIGl0ZXJhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwNik7CnZhciBhbk9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDkpOwp2YXIgY2xhc3NvZiA9IF9fd19wZGZqc19yZXF1aXJlX18oODEpOwp2YXIgaGFzT3duID0gX193X3BkZmpzX3JlcXVpcmVfXyg0MSk7CnZhciBjcmVhdGVQcm9wZXJ0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTAyKTsKdmFyIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oNDYpOwp2YXIgbGVuZ3RoT2ZBcnJheUxpa2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDY2KTsKdmFyIHZhbGlkYXRlQXJndW1lbnRzTGVuZ3RoID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjIpOwp2YXIgZ2V0UmVnRXhwRmxhZ3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyMyk7CnZhciBFUlJPUl9TVEFDS19JTlNUQUxMQUJMRSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTI1KTsKdmFyIFY4ID0gX193X3BkZmpzX3JlcXVpcmVfXygzMCk7CnZhciBJU19CUk9XU0VSID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjYpOwp2YXIgSVNfREVOTyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTI3KTsKdmFyIElTX05PREUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyOCk7CnZhciBPYmplY3QgPSBnbG9iYWwuT2JqZWN0Owp2YXIgRGF0ZSA9IGdsb2JhbC5EYXRlOwp2YXIgRXJyb3IgPSBnbG9iYWwuRXJyb3I7CnZhciBFdmFsRXJyb3IgPSBnbG9iYWwuRXZhbEVycm9yOwp2YXIgUmFuZ2VFcnJvciA9IGdsb2JhbC5SYW5nZUVycm9yOwp2YXIgUmVmZXJlbmNlRXJyb3IgPSBnbG9iYWwuUmVmZXJlbmNlRXJyb3I7CnZhciBTeW50YXhFcnJvciA9IGdsb2JhbC5TeW50YXhFcnJvcjsKdmFyIFR5cGVFcnJvciA9IGdsb2JhbC5UeXBlRXJyb3I7CnZhciBVUklFcnJvciA9IGdsb2JhbC5VUklFcnJvcjsKdmFyIFBlcmZvcm1hbmNlTWFyayA9IGdsb2JhbC5QZXJmb3JtYW5jZU1hcms7CnZhciBXZWJBc3NlbWJseSA9IGdsb2JhbC5XZWJBc3NlbWJseTsKdmFyIENvbXBpbGVFcnJvciA9IFdlYkFzc2VtYmx5ICYmIFdlYkFzc2VtYmx5LkNvbXBpbGVFcnJvciB8fCBFcnJvcjsKdmFyIExpbmtFcnJvciA9IFdlYkFzc2VtYmx5ICYmIFdlYkFzc2VtYmx5LkxpbmtFcnJvciB8fCBFcnJvcjsKdmFyIFJ1bnRpbWVFcnJvciA9IFdlYkFzc2VtYmx5ICYmIFdlYkFzc2VtYmx5LlJ1bnRpbWVFcnJvciB8fCBFcnJvcjsKdmFyIERPTUV4Y2VwdGlvbiA9IGdldEJ1aWx0aW4oJ0RPTUV4Y2VwdGlvbicpOwp2YXIgU2V0ID0gZ2V0QnVpbHRpbignU2V0Jyk7CnZhciBNYXAgPSBnZXRCdWlsdGluKCdNYXAnKTsKdmFyIE1hcFByb3RvdHlwZSA9IE1hcC5wcm90b3R5cGU7CnZhciBtYXBIYXMgPSB1bmN1cnJ5VGhpcyhNYXBQcm90b3R5cGUuaGFzKTsKdmFyIG1hcEdldCA9IHVuY3VycnlUaGlzKE1hcFByb3RvdHlwZS5nZXQpOwp2YXIgbWFwU2V0ID0gdW5jdXJyeVRoaXMoTWFwUHJvdG90eXBlLnNldCk7CnZhciBzZXRBZGQgPSB1bmN1cnJ5VGhpcyhTZXQucHJvdG90eXBlLmFkZCk7CnZhciBvYmplY3RLZXlzID0gZ2V0QnVpbHRpbignT2JqZWN0JywgJ2tleXMnKTsKdmFyIHB1c2ggPSB1bmN1cnJ5VGhpcyhbXS5wdXNoKTsKdmFyIGJvb2xlYW5WYWx1ZU9mID0gdW5jdXJyeVRoaXModHJ1ZS52YWx1ZU9mKTsKdmFyIG51bWJlclZhbHVlT2YgPSB1bmN1cnJ5VGhpcygxLjAudmFsdWVPZik7CnZhciBzdHJpbmdWYWx1ZU9mID0gdW5jdXJyeVRoaXMoJycudmFsdWVPZik7CnZhciBnZXRUaW1lID0gdW5jdXJyeVRoaXMoRGF0ZS5wcm90b3R5cGUuZ2V0VGltZSk7CnZhciBQRVJGT1JNQU5DRV9NQVJLID0gdWlkKCdzdHJ1Y3R1cmVkQ2xvbmUnKTsKdmFyIERBVEFfQ0xPTkVfRVJST1IgPSAnRGF0YUNsb25lRXJyb3InOwp2YXIgVFJBTlNGRVJSSU5HID0gJ1RyYW5zZmVycmluZyc7CnZhciBjaGVja0Jhc2ljU2VtYW50aWMgPSBmdW5jdGlvbiAoc3RydWN0dXJlZENsb25lSW1wbGVtZW50YXRpb24pIHsKIHJldHVybiAhZmFpbHMoZnVuY3Rpb24gKCkgewogIHZhciBzZXQxID0gbmV3IGdsb2JhbC5TZXQoWzddKTsKICB2YXIgc2V0MiA9IHN0cnVjdHVyZWRDbG9uZUltcGxlbWVudGF0aW9uKHNldDEpOwogIHZhciBudW1iZXIgPSBzdHJ1Y3R1cmVkQ2xvbmVJbXBsZW1lbnRhdGlvbihPYmplY3QoNykpOwogIHJldHVybiBzZXQyID09IHNldDEgfHwgIXNldDIuaGFzKDcpIHx8IHR5cGVvZiBudW1iZXIgIT0gJ29iamVjdCcgfHwgbnVtYmVyICE9IDc7CiB9KSAmJiBzdHJ1Y3R1cmVkQ2xvbmVJbXBsZW1lbnRhdGlvbjsKfTsKdmFyIGNoZWNrRXJyb3JzQ2xvbmluZyA9IGZ1bmN0aW9uIChzdHJ1Y3R1cmVkQ2xvbmVJbXBsZW1lbnRhdGlvbiwgJEVycm9yKSB7CiByZXR1cm4gIWZhaWxzKGZ1bmN0aW9uICgpIHsKICB2YXIgZXJyb3IgPSBuZXcgJEVycm9yKCk7CiAgdmFyIHRlc3QgPSBzdHJ1Y3R1cmVkQ2xvbmVJbXBsZW1lbnRhdGlvbih7CiAgIGE6IGVycm9yLAogICBiOiBlcnJvcgogIH0pOwogIHJldHVybiAhKHRlc3QgJiYgdGVzdC5hID09PSB0ZXN0LmIgJiYgdGVzdC5hIGluc3RhbmNlb2YgJEVycm9yICYmIHRlc3QuYS5zdGFjayA9PT0gZXJyb3Iuc3RhY2spOwogfSk7Cn07CnZhciBjaGVja05ld0Vycm9yc0Nsb25pbmdTZW1hbnRpYyA9IGZ1bmN0aW9uIChzdHJ1Y3R1cmVkQ2xvbmVJbXBsZW1lbnRhdGlvbikgewogcmV0dXJuICFmYWlscyhmdW5jdGlvbiAoKSB7CiAgdmFyIHRlc3QgPSBzdHJ1Y3R1cmVkQ2xvbmVJbXBsZW1lbnRhdGlvbihuZXcgZ2xvYmFsLkFnZ3JlZ2F0ZUVycm9yKFsxXSwgUEVSRk9STUFOQ0VfTUFSSywgeyBjYXVzZTogMyB9KSk7CiAgcmV0dXJuIHRlc3QubmFtZSAhPSAnQWdncmVnYXRlRXJyb3InIHx8IHRlc3QuZXJyb3JzWzBdICE9IDEgfHwgdGVzdC5tZXNzYWdlICE9IFBFUkZPUk1BTkNFX01BUksgfHwgdGVzdC5jYXVzZSAhPSAzOwogfSk7Cn07CnZhciBuYXRpdmVTdHJ1Y3R1cmVkQ2xvbmUgPSBnbG9iYWwuc3RydWN0dXJlZENsb25lOwp2YXIgRk9SQ0VEX1JFUExBQ0VNRU5UID0gSVNfUFVSRSB8fCAhY2hlY2tFcnJvcnNDbG9uaW5nKG5hdGl2ZVN0cnVjdHVyZWRDbG9uZSwgRXJyb3IpIHx8ICFjaGVja0Vycm9yc0Nsb25pbmcobmF0aXZlU3RydWN0dXJlZENsb25lLCBET01FeGNlcHRpb24pIHx8ICFjaGVja05ld0Vycm9yc0Nsb25pbmdTZW1hbnRpYyhuYXRpdmVTdHJ1Y3R1cmVkQ2xvbmUpOwp2YXIgc3RydWN0dXJlZENsb25lRnJvbU1hcmsgPSAhbmF0aXZlU3RydWN0dXJlZENsb25lICYmIGNoZWNrQmFzaWNTZW1hbnRpYyhmdW5jdGlvbiAodmFsdWUpIHsKIHJldHVybiBuZXcgUGVyZm9ybWFuY2VNYXJrKFBFUkZPUk1BTkNFX01BUkssIHsgZGV0YWlsOiB2YWx1ZSB9KS5kZXRhaWw7Cn0pOwp2YXIgbmF0aXZlUmVzdHJpY3RlZFN0cnVjdHVyZWRDbG9uZSA9IGNoZWNrQmFzaWNTZW1hbnRpYyhuYXRpdmVTdHJ1Y3R1cmVkQ2xvbmUpIHx8IHN0cnVjdHVyZWRDbG9uZUZyb21NYXJrOwp2YXIgdGhyb3dVbmNsb25lYWJsZSA9IGZ1bmN0aW9uICh0eXBlKSB7CiB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKCdVbmNsb25lYWJsZSB0eXBlOiAnICsgdHlwZSwgREFUQV9DTE9ORV9FUlJPUik7Cn07CnZhciB0aHJvd1VucG9seWZpbGxhYmxlID0gZnVuY3Rpb24gKHR5cGUsIGtpbmQpIHsKIHRocm93IG5ldyBET01FeGNlcHRpb24oKGtpbmQgfHwgJ0Nsb25pbmcnKSArICcgb2YgJyArIHR5cGUgKyAnIGNhbm5vdCBiZSBwcm9wZXJseSBwb2x5ZmlsbGVkIGluIHRoaXMgZW5naW5lJywgREFUQV9DTE9ORV9FUlJPUik7Cn07CnZhciBzdHJ1Y3R1cmVkQ2xvbmVJbnRlcm5hbCA9IGZ1bmN0aW9uICh2YWx1ZSwgbWFwKSB7CiBpZiAoaXNTeW1ib2wodmFsdWUpKQogIHRocm93VW5jbG9uZWFibGUoJ1N5bWJvbCcpOwogaWYgKCFpc09iamVjdCh2YWx1ZSkpCiAgcmV0dXJuIHZhbHVlOwogaWYgKG1hcCkgewogIGlmIChtYXBIYXMobWFwLCB2YWx1ZSkpCiAgIHJldHVybiBtYXBHZXQobWFwLCB2YWx1ZSk7CiB9IGVsc2UKICBtYXAgPSBuZXcgTWFwKCk7CiB2YXIgdHlwZSA9IGNsYXNzb2YodmFsdWUpOwogdmFyIGRlZXAgPSBmYWxzZTsKIHZhciBDLCBuYW1lLCBjbG9uZWQsIGRhdGFUcmFuc2ZlciwgaSwgbGVuZ3RoLCBrZXlzLCBrZXksIHNvdXJjZSwgdGFyZ2V0Owogc3dpdGNoICh0eXBlKSB7CiBjYXNlICdBcnJheSc6CiAgY2xvbmVkID0gW107CiAgZGVlcCA9IHRydWU7CiAgYnJlYWs7CiBjYXNlICdPYmplY3QnOgogIGNsb25lZCA9IHt9OwogIGRlZXAgPSB0cnVlOwogIGJyZWFrOwogY2FzZSAnTWFwJzoKICBjbG9uZWQgPSBuZXcgTWFwKCk7CiAgZGVlcCA9IHRydWU7CiAgYnJlYWs7CiBjYXNlICdTZXQnOgogIGNsb25lZCA9IG5ldyBTZXQoKTsKICBkZWVwID0gdHJ1ZTsKICBicmVhazsKIGNhc2UgJ1JlZ0V4cCc6CiAgY2xvbmVkID0gbmV3IFJlZ0V4cCh2YWx1ZS5zb3VyY2UsIGdldFJlZ0V4cEZsYWdzKHZhbHVlKSk7CiAgYnJlYWs7CiBjYXNlICdFcnJvcic6CiAgbmFtZSA9IHZhbHVlLm5hbWU7CiAgc3dpdGNoIChuYW1lKSB7CiAgY2FzZSAnQWdncmVnYXRlRXJyb3InOgogICBjbG9uZWQgPSBnZXRCdWlsdGluKCdBZ2dyZWdhdGVFcnJvcicpKFtdKTsKICAgYnJlYWs7CiAgY2FzZSAnRXZhbEVycm9yJzoKICAgY2xvbmVkID0gRXZhbEVycm9yKCk7CiAgIGJyZWFrOwogIGNhc2UgJ1JhbmdlRXJyb3InOgogICBjbG9uZWQgPSBSYW5nZUVycm9yKCk7CiAgIGJyZWFrOwogIGNhc2UgJ1JlZmVyZW5jZUVycm9yJzoKICAgY2xvbmVkID0gUmVmZXJlbmNlRXJyb3IoKTsKICAgYnJlYWs7CiAgY2FzZSAnU3ludGF4RXJyb3InOgogICBjbG9uZWQgPSBTeW50YXhFcnJvcigpOwogICBicmVhazsKICBjYXNlICdUeXBlRXJyb3InOgogICBjbG9uZWQgPSBUeXBlRXJyb3IoKTsKICAgYnJlYWs7CiAgY2FzZSAnVVJJRXJyb3InOgogICBjbG9uZWQgPSBVUklFcnJvcigpOwogICBicmVhazsKICBjYXNlICdDb21waWxlRXJyb3InOgogICBjbG9uZWQgPSBDb21waWxlRXJyb3IoKTsKICAgYnJlYWs7CiAgY2FzZSAnTGlua0Vycm9yJzoKICAgY2xvbmVkID0gTGlua0Vycm9yKCk7CiAgIGJyZWFrOwogIGNhc2UgJ1J1bnRpbWVFcnJvcic6CiAgIGNsb25lZCA9IFJ1bnRpbWVFcnJvcigpOwogICBicmVhazsKICBkZWZhdWx0OgogICBjbG9uZWQgPSBFcnJvcigpOwogIH0KICBkZWVwID0gdHJ1ZTsKICBicmVhazsKIGNhc2UgJ0RPTUV4Y2VwdGlvbic6CiAgY2xvbmVkID0gbmV3IERPTUV4Y2VwdGlvbih2YWx1ZS5tZXNzYWdlLCB2YWx1ZS5uYW1lKTsKICBkZWVwID0gdHJ1ZTsKICBicmVhazsKIGNhc2UgJ0RhdGFWaWV3JzoKIGNhc2UgJ0ludDhBcnJheSc6CiBjYXNlICdVaW50OEFycmF5JzoKIGNhc2UgJ1VpbnQ4Q2xhbXBlZEFycmF5JzoKIGNhc2UgJ0ludDE2QXJyYXknOgogY2FzZSAnVWludDE2QXJyYXknOgogY2FzZSAnSW50MzJBcnJheSc6CiBjYXNlICdVaW50MzJBcnJheSc6CiBjYXNlICdGbG9hdDMyQXJyYXknOgogY2FzZSAnRmxvYXQ2NEFycmF5JzoKIGNhc2UgJ0JpZ0ludDY0QXJyYXknOgogY2FzZSAnQmlnVWludDY0QXJyYXknOgogIEMgPSBnbG9iYWxbdHlwZV07CiAgaWYgKCFpc09iamVjdChDKSkKICAgdGhyb3dVbnBvbHlmaWxsYWJsZSh0eXBlKTsKICBjbG9uZWQgPSBuZXcgQyhzdHJ1Y3R1cmVkQ2xvbmVJbnRlcm5hbCh2YWx1ZS5idWZmZXIsIG1hcCksIHZhbHVlLmJ5dGVPZmZzZXQsIHR5cGUgPT09ICdEYXRhVmlldycgPyB2YWx1ZS5ieXRlTGVuZ3RoIDogdmFsdWUubGVuZ3RoKTsKICBicmVhazsKIGNhc2UgJ0RPTVF1YWQnOgogIHRyeSB7CiAgIGNsb25lZCA9IG5ldyBET01RdWFkKHN0cnVjdHVyZWRDbG9uZUludGVybmFsKHZhbHVlLnAxLCBtYXApLCBzdHJ1Y3R1cmVkQ2xvbmVJbnRlcm5hbCh2YWx1ZS5wMiwgbWFwKSwgc3RydWN0dXJlZENsb25lSW50ZXJuYWwodmFsdWUucDMsIG1hcCksIHN0cnVjdHVyZWRDbG9uZUludGVybmFsKHZhbHVlLnA0LCBtYXApKTsKICB9IGNhdGNoIChlcnJvcikgewogICBpZiAobmF0aXZlUmVzdHJpY3RlZFN0cnVjdHVyZWRDbG9uZSkgewogICAgY2xvbmVkID0gbmF0aXZlUmVzdHJpY3RlZFN0cnVjdHVyZWRDbG9uZSh2YWx1ZSk7CiAgIH0gZWxzZQogICAgdGhyb3dVbnBvbHlmaWxsYWJsZSh0eXBlKTsKICB9CiAgYnJlYWs7CiBjYXNlICdGaWxlTGlzdCc6CiAgQyA9IGdsb2JhbC5EYXRhVHJhbnNmZXI7CiAgaWYgKGlzQ29uc3RydWN0b3IoQykpIHsKICAgZGF0YVRyYW5zZmVyID0gbmV3IEMoKTsKICAgZm9yIChpID0gMCwgbGVuZ3RoID0gbGVuZ3RoT2ZBcnJheUxpa2UodmFsdWUpOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgIGRhdGFUcmFuc2Zlci5pdGVtcy5hZGQoc3RydWN0dXJlZENsb25lSW50ZXJuYWwodmFsdWVbaV0sIG1hcCkpOwogICB9CiAgIGNsb25lZCA9IGRhdGFUcmFuc2Zlci5maWxlczsKICB9IGVsc2UgaWYgKG5hdGl2ZVJlc3RyaWN0ZWRTdHJ1Y3R1cmVkQ2xvbmUpIHsKICAgY2xvbmVkID0gbmF0aXZlUmVzdHJpY3RlZFN0cnVjdHVyZWRDbG9uZSh2YWx1ZSk7CiAgfSBlbHNlCiAgIHRocm93VW5wb2x5ZmlsbGFibGUodHlwZSk7CiAgYnJlYWs7CiBjYXNlICdJbWFnZURhdGEnOgogIHRyeSB7CiAgIGNsb25lZCA9IG5ldyBJbWFnZURhdGEoc3RydWN0dXJlZENsb25lSW50ZXJuYWwodmFsdWUuZGF0YSwgbWFwKSwgdmFsdWUud2lkdGgsIHZhbHVlLmhlaWdodCwgeyBjb2xvclNwYWNlOiB2YWx1ZS5jb2xvclNwYWNlIH0pOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgIGlmIChuYXRpdmVSZXN0cmljdGVkU3RydWN0dXJlZENsb25lKSB7CiAgICBjbG9uZWQgPSBuYXRpdmVSZXN0cmljdGVkU3RydWN0dXJlZENsb25lKHZhbHVlKTsKICAgfSBlbHNlCiAgICB0aHJvd1VucG9seWZpbGxhYmxlKHR5cGUpOwogIH0KICBicmVhazsKIGRlZmF1bHQ6CiAgaWYgKG5hdGl2ZVJlc3RyaWN0ZWRTdHJ1Y3R1cmVkQ2xvbmUpIHsKICAgY2xvbmVkID0gbmF0aXZlUmVzdHJpY3RlZFN0cnVjdHVyZWRDbG9uZSh2YWx1ZSk7CiAgfSBlbHNlCiAgIHN3aXRjaCAodHlwZSkgewogICBjYXNlICdCaWdJbnQnOgogICAgY2xvbmVkID0gT2JqZWN0KHZhbHVlLnZhbHVlT2YoKSk7CiAgICBicmVhazsKICAgY2FzZSAnQm9vbGVhbic6CiAgICBjbG9uZWQgPSBPYmplY3QoYm9vbGVhblZhbHVlT2YodmFsdWUpKTsKICAgIGJyZWFrOwogICBjYXNlICdOdW1iZXInOgogICAgY2xvbmVkID0gT2JqZWN0KG51bWJlclZhbHVlT2YodmFsdWUpKTsKICAgIGJyZWFrOwogICBjYXNlICdTdHJpbmcnOgogICAgY2xvbmVkID0gT2JqZWN0KHN0cmluZ1ZhbHVlT2YodmFsdWUpKTsKICAgIGJyZWFrOwogICBjYXNlICdEYXRlJzoKICAgIGNsb25lZCA9IG5ldyBEYXRlKGdldFRpbWUodmFsdWUpKTsKICAgIGJyZWFrOwogICBjYXNlICdBcnJheUJ1ZmZlcic6CiAgICBDID0gZ2xvYmFsLkRhdGFWaWV3OwogICAgaWYgKCFDICYmIHR5cGVvZiB2YWx1ZS5zbGljZSAhPSAnZnVuY3Rpb24nKQogICAgIHRocm93VW5wb2x5ZmlsbGFibGUodHlwZSk7CiAgICB0cnkgewogICAgIGlmICh0eXBlb2YgdmFsdWUuc2xpY2UgPT0gJ2Z1bmN0aW9uJykgewogICAgICBjbG9uZWQgPSB2YWx1ZS5zbGljZSgwKTsKICAgICB9IGVsc2UgewogICAgICBsZW5ndGggPSB2YWx1ZS5ieXRlTGVuZ3RoOwogICAgICBjbG9uZWQgPSBuZXcgQXJyYXlCdWZmZXIobGVuZ3RoKTsKICAgICAgc291cmNlID0gbmV3IEModmFsdWUpOwogICAgICB0YXJnZXQgPSBuZXcgQyhjbG9uZWQpOwogICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgIHRhcmdldC5zZXRVaW50OChpLCBzb3VyY2UuZ2V0VWludDgoaSkpOwogICAgICB9CiAgICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKCdBcnJheUJ1ZmZlciBpcyBkZXRhY2hlZCcsIERBVEFfQ0xPTkVfRVJST1IpOwogICAgfQogICAgYnJlYWs7CiAgIGNhc2UgJ1NoYXJlZEFycmF5QnVmZmVyJzoKICAgIGNsb25lZCA9IHZhbHVlOwogICAgYnJlYWs7CiAgIGNhc2UgJ0Jsb2InOgogICAgdHJ5IHsKICAgICBjbG9uZWQgPSB2YWx1ZS5zbGljZSgwLCB2YWx1ZS5zaXplLCB2YWx1ZS50eXBlKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgdGhyb3dVbnBvbHlmaWxsYWJsZSh0eXBlKTsKICAgIH0KICAgIGJyZWFrOwogICBjYXNlICdET01Qb2ludCc6CiAgIGNhc2UgJ0RPTVBvaW50UmVhZE9ubHknOgogICAgQyA9IGdsb2JhbFt0eXBlXTsKICAgIHRyeSB7CiAgICAgY2xvbmVkID0gQy5mcm9tUG9pbnQgPyBDLmZyb21Qb2ludCh2YWx1ZSkgOiBuZXcgQyh2YWx1ZS54LCB2YWx1ZS55LCB2YWx1ZS56LCB2YWx1ZS53KTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgdGhyb3dVbnBvbHlmaWxsYWJsZSh0eXBlKTsKICAgIH0KICAgIGJyZWFrOwogICBjYXNlICdET01SZWN0JzoKICAgY2FzZSAnRE9NUmVjdFJlYWRPbmx5JzoKICAgIEMgPSBnbG9iYWxbdHlwZV07CiAgICB0cnkgewogICAgIGNsb25lZCA9IEMuZnJvbVJlY3QgPyBDLmZyb21SZWN0KHZhbHVlKSA6IG5ldyBDKHZhbHVlLngsIHZhbHVlLnksIHZhbHVlLndpZHRoLCB2YWx1ZS5oZWlnaHQpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICB0aHJvd1VucG9seWZpbGxhYmxlKHR5cGUpOwogICAgfQogICAgYnJlYWs7CiAgIGNhc2UgJ0RPTU1hdHJpeCc6CiAgIGNhc2UgJ0RPTU1hdHJpeFJlYWRPbmx5JzoKICAgIEMgPSBnbG9iYWxbdHlwZV07CiAgICB0cnkgewogICAgIGNsb25lZCA9IEMuZnJvbU1hdHJpeCA/IEMuZnJvbU1hdHJpeCh2YWx1ZSkgOiBuZXcgQyh2YWx1ZSk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgIHRocm93VW5wb2x5ZmlsbGFibGUodHlwZSk7CiAgICB9CiAgICBicmVhazsKICAgY2FzZSAnQXVkaW9EYXRhJzoKICAgY2FzZSAnVmlkZW9GcmFtZSc6CiAgICBpZiAoIWlzQ2FsbGFibGUodmFsdWUuY2xvbmUpKQogICAgIHRocm93VW5wb2x5ZmlsbGFibGUodHlwZSk7CiAgICB0cnkgewogICAgIGNsb25lZCA9IHZhbHVlLmNsb25lKCk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgIHRocm93VW5jbG9uZWFibGUodHlwZSk7CiAgICB9CiAgICBicmVhazsKICAgY2FzZSAnRmlsZSc6CiAgICB0cnkgewogICAgIGNsb25lZCA9IG5ldyBGaWxlKFt2YWx1ZV0sIHZhbHVlLm5hbWUsIHZhbHVlKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgdGhyb3dVbnBvbHlmaWxsYWJsZSh0eXBlKTsKICAgIH0KICAgIGJyZWFrOwogICBjYXNlICdDcnlwdG9LZXknOgogICBjYXNlICdHUFVDb21waWxhdGlvbk1lc3NhZ2UnOgogICBjYXNlICdHUFVDb21waWxhdGlvbkluZm8nOgogICBjYXNlICdJbWFnZUJpdG1hcCc6CiAgIGNhc2UgJ1JUQ0NlcnRpZmljYXRlJzoKICAgY2FzZSAnV2ViQXNzZW1ibHkuTW9kdWxlJzoKICAgIHRocm93VW5wb2x5ZmlsbGFibGUodHlwZSk7CiAgIGRlZmF1bHQ6CiAgICB0aHJvd1VuY2xvbmVhYmxlKHR5cGUpOwogICB9CiB9CiBtYXBTZXQobWFwLCB2YWx1ZSwgY2xvbmVkKTsKIGlmIChkZWVwKQogIHN3aXRjaCAodHlwZSkgewogIGNhc2UgJ0FycmF5JzoKICBjYXNlICdPYmplY3QnOgogICBrZXlzID0gb2JqZWN0S2V5cyh2YWx1ZSk7CiAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IGxlbmd0aE9mQXJyYXlMaWtlKGtleXMpOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgIGtleSA9IGtleXNbaV07CiAgICBjcmVhdGVQcm9wZXJ0eShjbG9uZWQsIGtleSwgc3RydWN0dXJlZENsb25lSW50ZXJuYWwodmFsdWVba2V5XSwgbWFwKSk7CiAgIH0KICAgYnJlYWs7CiAgY2FzZSAnTWFwJzoKICAgdmFsdWUuZm9yRWFjaChmdW5jdGlvbiAodiwgaykgewogICAgbWFwU2V0KGNsb25lZCwgc3RydWN0dXJlZENsb25lSW50ZXJuYWwoaywgbWFwKSwgc3RydWN0dXJlZENsb25lSW50ZXJuYWwodiwgbWFwKSk7CiAgIH0pOwogICBicmVhazsKICBjYXNlICdTZXQnOgogICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7CiAgICBzZXRBZGQoY2xvbmVkLCBzdHJ1Y3R1cmVkQ2xvbmVJbnRlcm5hbCh2LCBtYXApKTsKICAgfSk7CiAgIGJyZWFrOwogIGNhc2UgJ0Vycm9yJzoKICAgY3JlYXRlTm9uRW51bWVyYWJsZVByb3BlcnR5KGNsb25lZCwgJ21lc3NhZ2UnLCBzdHJ1Y3R1cmVkQ2xvbmVJbnRlcm5hbCh2YWx1ZS5tZXNzYWdlLCBtYXApKTsKICAgaWYgKGhhc093bih2YWx1ZSwgJ2NhdXNlJykpIHsKICAgIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShjbG9uZWQsICdjYXVzZScsIHN0cnVjdHVyZWRDbG9uZUludGVybmFsKHZhbHVlLmNhdXNlLCBtYXApKTsKICAgfQogICBpZiAobmFtZSA9PSAnQWdncmVnYXRlRXJyb3InKSB7CiAgICBjbG9uZWQuZXJyb3JzID0gc3RydWN0dXJlZENsb25lSW50ZXJuYWwodmFsdWUuZXJyb3JzLCBtYXApOwogICB9CiAgY2FzZSAnRE9NRXhjZXB0aW9uJzoKICAgaWYgKEVSUk9SX1NUQUNLX0lOU1RBTExBQkxFKSB7CiAgICBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkoY2xvbmVkLCAnc3RhY2snLCBzdHJ1Y3R1cmVkQ2xvbmVJbnRlcm5hbCh2YWx1ZS5zdGFjaywgbWFwKSk7CiAgIH0KICB9CiByZXR1cm4gY2xvbmVkOwp9Owp2YXIgUFJPUEVSX1RSQU5TRkVSID0gbmF0aXZlU3RydWN0dXJlZENsb25lICYmICFmYWlscyhmdW5jdGlvbiAoKSB7CiBpZiAoSVNfREVOTyAmJiBWOCA+IDkyIHx8IElTX05PREUgJiYgVjggPiA5NCB8fCBJU19CUk9XU0VSICYmIFY4ID4gOTcpCiAgcmV0dXJuIGZhbHNlOwogdmFyIGJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig4KTsKIHZhciBjbG9uZSA9IG5hdGl2ZVN0cnVjdHVyZWRDbG9uZShidWZmZXIsIHsgdHJhbnNmZXI6IFtidWZmZXJdIH0pOwogcmV0dXJuIGJ1ZmZlci5ieXRlTGVuZ3RoICE9IDAgfHwgY2xvbmUuYnl0ZUxlbmd0aCAhPSA4Owp9KTsKdmFyIHRyeVRvVHJhbnNmZXIgPSBmdW5jdGlvbiAocmF3VHJhbnNmZXIsIG1hcCkgewogaWYgKCFpc09iamVjdChyYXdUcmFuc2ZlcikpCiAgdGhyb3cgVHlwZUVycm9yKCdUcmFuc2ZlciBvcHRpb24gY2Fubm90IGJlIGNvbnZlcnRlZCB0byBhIHNlcXVlbmNlJyk7CiB2YXIgdHJhbnNmZXIgPSBbXTsKIGl0ZXJhdGUocmF3VHJhbnNmZXIsIGZ1bmN0aW9uICh2YWx1ZSkgewogIHB1c2godHJhbnNmZXIsIGFuT2JqZWN0KHZhbHVlKSk7CiB9KTsKIHZhciBpID0gMDsKIHZhciBsZW5ndGggPSBsZW5ndGhPZkFycmF5TGlrZSh0cmFuc2Zlcik7CiB2YXIgdmFsdWUsIHR5cGUsIEMsIHRyYW5zZmVycmVkQXJyYXksIHRyYW5zZmVycmVkLCBjYW52YXMsIGNvbnRleHQ7CiBpZiAoUFJPUEVSX1RSQU5TRkVSKSB7CiAgdHJhbnNmZXJyZWRBcnJheSA9IG5hdGl2ZVN0cnVjdHVyZWRDbG9uZSh0cmFuc2ZlciwgeyB0cmFuc2ZlcjogdHJhbnNmZXIgfSk7CiAgd2hpbGUgKGkgPCBsZW5ndGgpCiAgIG1hcFNldChtYXAsIHRyYW5zZmVyW2ldLCB0cmFuc2ZlcnJlZEFycmF5W2krK10pOwogfSBlbHNlCiAgd2hpbGUgKGkgPCBsZW5ndGgpIHsKICAgdmFsdWUgPSB0cmFuc2ZlcltpKytdOwogICBpZiAobWFwSGFzKG1hcCwgdmFsdWUpKQogICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignRHVwbGljYXRlIHRyYW5zZmVyYWJsZScsIERBVEFfQ0xPTkVfRVJST1IpOwogICB0eXBlID0gY2xhc3NvZih2YWx1ZSk7CiAgIHN3aXRjaCAodHlwZSkgewogICBjYXNlICdJbWFnZUJpdG1hcCc6CiAgICBDID0gZ2xvYmFsLk9mZnNjcmVlbkNhbnZhczsKICAgIGlmICghaXNDb25zdHJ1Y3RvcihDKSkKICAgICB0aHJvd1VucG9seWZpbGxhYmxlKHR5cGUsIFRSQU5TRkVSUklORyk7CiAgICB0cnkgewogICAgIGNhbnZhcyA9IG5ldyBDKHZhbHVlLndpZHRoLCB2YWx1ZS5oZWlnaHQpOwogICAgIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnYml0bWFwcmVuZGVyZXInKTsKICAgICBjb250ZXh0LnRyYW5zZmVyRnJvbUltYWdlQml0bWFwKHZhbHVlKTsKICAgICB0cmFuc2ZlcnJlZCA9IGNhbnZhcy50cmFuc2ZlclRvSW1hZ2VCaXRtYXAoKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICB9CiAgICBicmVhazsKICAgY2FzZSAnQXVkaW9EYXRhJzoKICAgY2FzZSAnVmlkZW9GcmFtZSc6CiAgICBpZiAoIWlzQ2FsbGFibGUodmFsdWUuY2xvbmUpIHx8ICFpc0NhbGxhYmxlKHZhbHVlLmNsb3NlKSkKICAgICB0aHJvd1VucG9seWZpbGxhYmxlKHR5cGUsIFRSQU5TRkVSUklORyk7CiAgICB0cnkgewogICAgIHRyYW5zZmVycmVkID0gdmFsdWUuY2xvbmUoKTsKICAgICB2YWx1ZS5jbG9zZSgpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIH0KICAgIGJyZWFrOwogICBjYXNlICdBcnJheUJ1ZmZlcic6CiAgIGNhc2UgJ01lc3NhZ2VQb3J0JzoKICAgY2FzZSAnT2Zmc2NyZWVuQ2FudmFzJzoKICAgY2FzZSAnUmVhZGFibGVTdHJlYW0nOgogICBjYXNlICdUcmFuc2Zvcm1TdHJlYW0nOgogICBjYXNlICdXcml0YWJsZVN0cmVhbSc6CiAgICB0aHJvd1VucG9seWZpbGxhYmxlKHR5cGUsIFRSQU5TRkVSUklORyk7CiAgIH0KICAgaWYgKHRyYW5zZmVycmVkID09PSB1bmRlZmluZWQpCiAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKCdUaGlzIG9iamVjdCBjYW5ub3QgYmUgdHJhbnNmZXJyZWQ6ICcgKyB0eXBlLCBEQVRBX0NMT05FX0VSUk9SKTsKICAgbWFwU2V0KG1hcCwgdmFsdWUsIHRyYW5zZmVycmVkKTsKICB9Cn07CiQoewogZ2xvYmFsOiB0cnVlLAogZW51bWVyYWJsZTogdHJ1ZSwKIHNoYW06ICFQUk9QRVJfVFJBTlNGRVIsCiBmb3JjZWQ6IEZPUkNFRF9SRVBMQUNFTUVOVAp9LCB7CiBzdHJ1Y3R1cmVkQ2xvbmU6IGZ1bmN0aW9uIHN0cnVjdHVyZWRDbG9uZSh2YWx1ZSkgewogIHZhciBvcHRpb25zID0gdmFsaWRhdGVBcmd1bWVudHNMZW5ndGgoYXJndW1lbnRzLmxlbmd0aCwgMSkgPiAxICYmIGFyZ3VtZW50c1sxXSAhPSBudWxsID8gYW5PYmplY3QoYXJndW1lbnRzWzFdKSA6IHVuZGVmaW5lZDsKICB2YXIgdHJhbnNmZXIgPSBvcHRpb25zID8gb3B0aW9ucy50cmFuc2ZlciA6IHVuZGVmaW5lZDsKICB2YXIgbWFwOwogIGlmICh0cmFuc2ZlciAhPT0gdW5kZWZpbmVkKSB7CiAgIG1hcCA9IG5ldyBNYXAoKTsKICAgdHJ5VG9UcmFuc2Zlcih0cmFuc2ZlciwgbWFwKTsKICB9CiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZUludGVybmFsKHZhbHVlLCBtYXApOwogfQp9KTsKCi8qKiovIH0pLAovKiAxMjEgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIHVuY3VycnlUaGlzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOCk7CnZhciBmYWlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwp2YXIgaXNDYWxsYWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjQpOwp2YXIgY2xhc3NvZiA9IF9fd19wZGZqc19yZXF1aXJlX18oODEpOwp2YXIgZ2V0QnVpbHRJbiA9IF9fd19wZGZqc19yZXF1aXJlX18oMjYpOwp2YXIgaW5zcGVjdFNvdXJjZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNTMpOwp2YXIgbm9vcCA9IGZ1bmN0aW9uICgpIHsKfTsKdmFyIGVtcHR5ID0gW107CnZhciBjb25zdHJ1Y3QgPSBnZXRCdWlsdEluKCdSZWZsZWN0JywgJ2NvbnN0cnVjdCcpOwp2YXIgY29uc3RydWN0b3JSZWdFeHAgPSAvXlxzKig/OmNsYXNzfGZ1bmN0aW9uKVxiLzsKdmFyIGV4ZWMgPSB1bmN1cnJ5VGhpcyhjb25zdHJ1Y3RvclJlZ0V4cC5leGVjKTsKdmFyIElOQ09SUkVDVF9UT19TVFJJTkcgPSAhY29uc3RydWN0b3JSZWdFeHAuZXhlYyhub29wKTsKdmFyIGlzQ29uc3RydWN0b3JNb2Rlcm4gPSBmdW5jdGlvbiBpc0NvbnN0cnVjdG9yKGFyZ3VtZW50KSB7CiBpZiAoIWlzQ2FsbGFibGUoYXJndW1lbnQpKQogIHJldHVybiBmYWxzZTsKIHRyeSB7CiAgY29uc3RydWN0KG5vb3AsIGVtcHR5LCBhcmd1bWVudCk7CiAgcmV0dXJuIHRydWU7CiB9IGNhdGNoIChlcnJvcikgewogIHJldHVybiBmYWxzZTsKIH0KfTsKdmFyIGlzQ29uc3RydWN0b3JMZWdhY3kgPSBmdW5jdGlvbiBpc0NvbnN0cnVjdG9yKGFyZ3VtZW50KSB7CiBpZiAoIWlzQ2FsbGFibGUoYXJndW1lbnQpKQogIHJldHVybiBmYWxzZTsKIHN3aXRjaCAoY2xhc3NvZihhcmd1bWVudCkpIHsKIGNhc2UgJ0FzeW5jRnVuY3Rpb24nOgogY2FzZSAnR2VuZXJhdG9yRnVuY3Rpb24nOgogY2FzZSAnQXN5bmNHZW5lcmF0b3JGdW5jdGlvbic6CiAgcmV0dXJuIGZhbHNlOwogfQogdHJ5IHsKICByZXR1cm4gSU5DT1JSRUNUX1RPX1NUUklORyB8fCAhIWV4ZWMoY29uc3RydWN0b3JSZWdFeHAsIGluc3BlY3RTb3VyY2UoYXJndW1lbnQpKTsKIH0gY2F0Y2ggKGVycm9yKSB7CiAgcmV0dXJuIHRydWU7CiB9Cn07CmlzQ29uc3RydWN0b3JMZWdhY3kuc2hhbSA9IHRydWU7Cm1vZHVsZS5leHBvcnRzID0gIWNvbnN0cnVjdCB8fCBmYWlscyhmdW5jdGlvbiAoKSB7CiB2YXIgY2FsbGVkOwogcmV0dXJuIGlzQ29uc3RydWN0b3JNb2Rlcm4oaXNDb25zdHJ1Y3Rvck1vZGVybi5jYWxsKSB8fCAhaXNDb25zdHJ1Y3Rvck1vZGVybihPYmplY3QpIHx8ICFpc0NvbnN0cnVjdG9yTW9kZXJuKGZ1bmN0aW9uICgpIHsKICBjYWxsZWQgPSB0cnVlOwogfSkgfHwgY2FsbGVkOwp9KSA/IGlzQ29uc3RydWN0b3JMZWdhY3kgOiBpc0NvbnN0cnVjdG9yTW9kZXJuOwoKLyoqKi8gfSksCi8qIDEyMiAqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKdmFyICRUeXBlRXJyb3IgPSBUeXBlRXJyb3I7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHBhc3NlZCwgcmVxdWlyZWQpIHsKIGlmIChwYXNzZWQgPCByZXF1aXJlZCkKICB0aHJvdyAkVHlwZUVycm9yKCdOb3QgZW5vdWdoIGFyZ3VtZW50cycpOwogcmV0dXJuIHBhc3NlZDsKfTsKCi8qKiovIH0pLAovKiAxMjMgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGNhbGwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyKTsKdmFyIGhhc093biA9IF9fd19wZGZqc19yZXF1aXJlX18oNDEpOwp2YXIgaXNQcm90b3R5cGVPZiA9IF9fd19wZGZqc19yZXF1aXJlX18oMjcpOwp2YXIgcmVnRXhwRmxhZ3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyNCk7CnZhciBSZWdFeHBQcm90b3R5cGUgPSBSZWdFeHAucHJvdG90eXBlOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChSKSB7CiB2YXIgZmxhZ3MgPSBSLmZsYWdzOwogcmV0dXJuIGZsYWdzID09PSB1bmRlZmluZWQgJiYgISgnZmxhZ3MnIGluIFJlZ0V4cFByb3RvdHlwZSkgJiYgIWhhc093bihSLCAnZmxhZ3MnKSAmJiBpc1Byb3RvdHlwZU9mKFJlZ0V4cFByb3RvdHlwZSwgUikgPyBjYWxsKHJlZ0V4cEZsYWdzLCBSKSA6IGZsYWdzOwp9OwoKLyoqKi8gfSksCi8qIDEyNCAqLwovKioqLyAoKG1vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7Cgp2YXIgYW5PYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ5KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7CiB2YXIgdGhhdCA9IGFuT2JqZWN0KHRoaXMpOwogdmFyIHJlc3VsdCA9ICcnOwogaWYgKHRoYXQuaGFzSW5kaWNlcykKICByZXN1bHQgKz0gJ2QnOwogaWYgKHRoYXQuZ2xvYmFsKQogIHJlc3VsdCArPSAnZyc7CiBpZiAodGhhdC5pZ25vcmVDYXNlKQogIHJlc3VsdCArPSAnaSc7CiBpZiAodGhhdC5tdWx0aWxpbmUpCiAgcmVzdWx0ICs9ICdtJzsKIGlmICh0aGF0LmRvdEFsbCkKICByZXN1bHQgKz0gJ3MnOwogaWYgKHRoYXQudW5pY29kZSkKICByZXN1bHQgKz0gJ3UnOwogaWYgKHRoYXQudW5pY29kZVNldHMpCiAgcmVzdWx0ICs9ICd2JzsKIGlmICh0aGF0LnN0aWNreSkKICByZXN1bHQgKz0gJ3knOwogcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiAxMjUgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE1KTsKbW9kdWxlLmV4cG9ydHMgPSAhZmFpbHMoZnVuY3Rpb24gKCkgewogdmFyIGVycm9yID0gRXJyb3IoJ2EnKTsKIGlmICghKCdzdGFjaycgaW4gZXJyb3IpKQogIHJldHVybiB0cnVlOwogT2JqZWN0LmRlZmluZVByb3BlcnR5KGVycm9yLCAnc3RhY2snLCBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IoMSwgNykpOwogcmV0dXJuIGVycm9yLnN0YWNrICE9PSA3Owp9KTsKCi8qKiovIH0pLAovKiAxMjYgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIElTX0RFTk8gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyNyk7CnZhciBJU19OT0RFID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjgpOwptb2R1bGUuZXhwb3J0cyA9ICFJU19ERU5PICYmICFJU19OT0RFICYmIHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgdHlwZW9mIGRvY3VtZW50ID09ICdvYmplY3QnOwoKLyoqKi8gfSksCi8qIDEyNyAqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2YgRGVubyA9PSAnb2JqZWN0JyAmJiBEZW5vICYmIHR5cGVvZiBEZW5vLnZlcnNpb24gPT0gJ29iamVjdCc7CgovKioqLyB9KSwKLyogMTI4ICovCi8qKiovICgobW9kdWxlLCBfX3VudXNlZF93ZWJwYWNrX2V4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCnZhciBjbGFzc29mID0gX193X3BkZmpzX3JlcXVpcmVfXygxOSk7CnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgpOwptb2R1bGUuZXhwb3J0cyA9IGNsYXNzb2YoZ2xvYmFsLnByb2Nlc3MpID09ICdwcm9jZXNzJzsKCi8qKiovIH0pLAovKiAxMjkgKi8KLyoqKi8gKChtb2R1bGUsIF9fdW51c2VkX3dlYnBhY2tfZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oOCk7Cm1vZHVsZS5leHBvcnRzID0gZ2xvYmFsOwoKLyoqKi8gfSksCi8qIDEzMCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuUmVmU2V0Q2FjaGUgPSBleHBvcnRzLlJlZlNldCA9IGV4cG9ydHMuUmVmID0gZXhwb3J0cy5OYW1lID0gZXhwb3J0cy5FT0YgPSBleHBvcnRzLkRpY3QgPSBleHBvcnRzLkNtZCA9IGV4cG9ydHMuQ0lSQ1VMQVJfUkVGID0gdm9pZCAwOwpleHBvcnRzLmNsZWFyUHJpbWl0aXZlQ2FjaGVzID0gY2xlYXJQcmltaXRpdmVDYWNoZXM7CmV4cG9ydHMuaXNDbWQgPSBpc0NtZDsKZXhwb3J0cy5pc0RpY3QgPSBpc0RpY3Q7CmV4cG9ydHMuaXNOYW1lID0gaXNOYW1lOwpleHBvcnRzLmlzUmVmc0VxdWFsID0gaXNSZWZzRXF1YWw7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY29uc3QgQ0lSQ1VMQVJfUkVGID0gU3ltYm9sKCJDSVJDVUxBUl9SRUYiKTsKZXhwb3J0cy5DSVJDVUxBUl9SRUYgPSBDSVJDVUxBUl9SRUY7CmNvbnN0IEVPRiA9IFN5bWJvbCgiRU9GIik7CmV4cG9ydHMuRU9GID0gRU9GOwoKY29uc3QgTmFtZSA9IGZ1bmN0aW9uIE5hbWVDbG9zdXJlKCkgewogIGxldCBuYW1lQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICBjbGFzcyBOYW1lIHsKICAgIGNvbnN0cnVjdG9yKG5hbWUpIHsKICAgICAgdGhpcy5uYW1lID0gbmFtZTsKICAgIH0KCiAgICBzdGF0aWMgZ2V0KG5hbWUpIHsKICAgICAgcmV0dXJuIG5hbWVDYWNoZVtuYW1lXSB8fCAobmFtZUNhY2hlW25hbWVdID0gbmV3IE5hbWUobmFtZSkpOwogICAgfQoKICAgIHN0YXRpYyBfY2xlYXJDYWNoZSgpIHsKICAgICAgbmFtZUNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIH0KCiAgfQoKICByZXR1cm4gTmFtZTsKfSgpOwoKZXhwb3J0cy5OYW1lID0gTmFtZTsKCmNvbnN0IENtZCA9IGZ1bmN0aW9uIENtZENsb3N1cmUoKSB7CiAgbGV0IGNtZENhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgY2xhc3MgQ21kIHsKICAgIGNvbnN0cnVjdG9yKGNtZCkgewogICAgICB0aGlzLmNtZCA9IGNtZDsKICAgIH0KCiAgICBzdGF0aWMgZ2V0KGNtZCkgewogICAgICByZXR1cm4gY21kQ2FjaGVbY21kXSB8fCAoY21kQ2FjaGVbY21kXSA9IG5ldyBDbWQoY21kKSk7CiAgICB9CgogICAgc3RhdGljIF9jbGVhckNhY2hlKCkgewogICAgICBjbWRDYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB9CgogIH0KCiAgcmV0dXJuIENtZDsKfSgpOwoKZXhwb3J0cy5DbWQgPSBDbWQ7Cgpjb25zdCBub25TZXJpYWxpemFibGUgPSBmdW5jdGlvbiBub25TZXJpYWxpemFibGVDbG9zdXJlKCkgewogIHJldHVybiBub25TZXJpYWxpemFibGU7Cn07CgpjbGFzcyBEaWN0IHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIGxldCB4cmVmID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsOwogICAgdGhpcy5fbWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMueHJlZiA9IHhyZWY7CiAgICB0aGlzLm9iaklkID0gbnVsbDsKICAgIHRoaXMuc3VwcHJlc3NFbmNyeXB0aW9uID0gZmFsc2U7CiAgICB0aGlzLl9fbm9uU2VyaWFsaXphYmxlX18gPSBub25TZXJpYWxpemFibGU7CiAgfQoKICBhc3NpZ25YcmVmKG5ld1hyZWYpIHsKICAgIHRoaXMueHJlZiA9IG5ld1hyZWY7CiAgfQoKICBnZXQgc2l6ZSgpIHsKICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLl9tYXApLmxlbmd0aDsKICB9CgogIGdldChrZXkxLCBrZXkyLCBrZXkzKSB7CiAgICBsZXQgdmFsdWUgPSB0aGlzLl9tYXBba2V5MV07CgogICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgJiYga2V5MiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhbHVlID0gdGhpcy5fbWFwW2tleTJdOwoKICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgJiYga2V5MyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFsdWUgPSB0aGlzLl9tYXBba2V5M107CiAgICAgIH0KICAgIH0KCiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBSZWYgJiYgdGhpcy54cmVmKSB7CiAgICAgIHJldHVybiB0aGlzLnhyZWYuZmV0Y2godmFsdWUsIHRoaXMuc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgIH0KCiAgICByZXR1cm4gdmFsdWU7CiAgfQoKICBhc3luYyBnZXRBc3luYyhrZXkxLCBrZXkyLCBrZXkzKSB7CiAgICBsZXQgdmFsdWUgPSB0aGlzLl9tYXBba2V5MV07CgogICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgJiYga2V5MiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhbHVlID0gdGhpcy5fbWFwW2tleTJdOwoKICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgJiYga2V5MyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFsdWUgPSB0aGlzLl9tYXBba2V5M107CiAgICAgIH0KICAgIH0KCiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBSZWYgJiYgdGhpcy54cmVmKSB7CiAgICAgIHJldHVybiB0aGlzLnhyZWYuZmV0Y2hBc3luYyh2YWx1ZSwgdGhpcy5zdXBwcmVzc0VuY3J5cHRpb24pOwogICAgfQoKICAgIHJldHVybiB2YWx1ZTsKICB9CgogIGdldEFycmF5KGtleTEsIGtleTIsIGtleTMpIHsKICAgIGxldCB2YWx1ZSA9IHRoaXMuX21hcFtrZXkxXTsKCiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiBrZXkyICE9PSB1bmRlZmluZWQpIHsKICAgICAgdmFsdWUgPSB0aGlzLl9tYXBba2V5Ml07CgogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiBrZXkzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB2YWx1ZSA9IHRoaXMuX21hcFtrZXkzXTsKICAgICAgfQogICAgfQoKICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFJlZiAmJiB0aGlzLnhyZWYpIHsKICAgICAgdmFsdWUgPSB0aGlzLnhyZWYuZmV0Y2godmFsdWUsIHRoaXMuc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgIH0KCiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgdmFsdWUgPSB2YWx1ZS5zbGljZSgpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdmFsdWUubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGlmICh2YWx1ZVtpXSBpbnN0YW5jZW9mIFJlZiAmJiB0aGlzLnhyZWYpIHsKICAgICAgICAgIHZhbHVlW2ldID0gdGhpcy54cmVmLmZldGNoKHZhbHVlW2ldLCB0aGlzLnN1cHByZXNzRW5jcnlwdGlvbik7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHZhbHVlOwogIH0KCiAgZ2V0UmF3KGtleSkgewogICAgcmV0dXJuIHRoaXMuX21hcFtrZXldOwogIH0KCiAgZ2V0S2V5cygpIHsKICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLl9tYXApOwogIH0KCiAgZ2V0UmF3VmFsdWVzKCkgewogICAgcmV0dXJuIE9iamVjdC52YWx1ZXModGhpcy5fbWFwKTsKICB9CgogIHNldChrZXksIHZhbHVlKSB7CiAgICB0aGlzLl9tYXBba2V5XSA9IHZhbHVlOwogIH0KCiAgaGFzKGtleSkgewogICAgcmV0dXJuIHRoaXMuX21hcFtrZXldICE9PSB1bmRlZmluZWQ7CiAgfQoKICBmb3JFYWNoKGNhbGxiYWNrKSB7CiAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLl9tYXApIHsKICAgICAgY2FsbGJhY2soa2V5LCB0aGlzLmdldChrZXkpKTsKICAgIH0KICB9CgogIHN0YXRpYyBnZXQgZW1wdHkoKSB7CiAgICBjb25zdCBlbXB0eURpY3QgPSBuZXcgRGljdChudWxsKTsKCiAgICBlbXB0eURpY3Quc2V0ID0gKGtleSwgdmFsdWUpID0+IHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiU2hvdWxkIG5vdCBjYWxsIGBzZXRgIG9uIHRoZSBlbXB0eSBkaWN0aW9uYXJ5LiIpOwogICAgfTsKCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImVtcHR5IiwgZW1wdHlEaWN0KTsKICB9CgogIHN0YXRpYyBtZXJnZShfcmVmKSB7CiAgICBsZXQgewogICAgICB4cmVmLAogICAgICBkaWN0QXJyYXksCiAgICAgIG1lcmdlU3ViRGljdHMgPSBmYWxzZQogICAgfSA9IF9yZWY7CiAgICBjb25zdCBtZXJnZWREaWN0ID0gbmV3IERpY3QoeHJlZiksCiAgICAgICAgICBwcm9wZXJ0aWVzID0gbmV3IE1hcCgpOwoKICAgIGZvciAoY29uc3QgZGljdCBvZiBkaWN0QXJyYXkpIHsKICAgICAgaWYgKCEoZGljdCBpbnN0YW5jZW9mIERpY3QpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRpY3QuX21hcCkpIHsKICAgICAgICBsZXQgcHJvcGVydHkgPSBwcm9wZXJ0aWVzLmdldChrZXkpOwoKICAgICAgICBpZiAocHJvcGVydHkgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcHJvcGVydHkgPSBbXTsKICAgICAgICAgIHByb3BlcnRpZXMuc2V0KGtleSwgcHJvcGVydHkpOwogICAgICAgIH0gZWxzZSBpZiAoIW1lcmdlU3ViRGljdHMgfHwgISh2YWx1ZSBpbnN0YW5jZW9mIERpY3QpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHByb3BlcnR5LnB1c2godmFsdWUpOwogICAgICB9CiAgICB9CgogICAgZm9yIChjb25zdCBbbmFtZSwgdmFsdWVzXSBvZiBwcm9wZXJ0aWVzKSB7CiAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID09PSAxIHx8ICEodmFsdWVzWzBdIGluc3RhbmNlb2YgRGljdCkpIHsKICAgICAgICBtZXJnZWREaWN0Ll9tYXBbbmFtZV0gPSB2YWx1ZXNbMF07CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHN1YkRpY3QgPSBuZXcgRGljdCh4cmVmKTsKCiAgICAgIGZvciAoY29uc3QgZGljdCBvZiB2YWx1ZXMpIHsKICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhkaWN0Ll9tYXApKSB7CiAgICAgICAgICBpZiAoc3ViRGljdC5fbWFwW2tleV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBzdWJEaWN0Ll9tYXBba2V5XSA9IHZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHN1YkRpY3Quc2l6ZSA+IDApIHsKICAgICAgICBtZXJnZWREaWN0Ll9tYXBbbmFtZV0gPSBzdWJEaWN0OwogICAgICB9CiAgICB9CgogICAgcHJvcGVydGllcy5jbGVhcigpOwogICAgcmV0dXJuIG1lcmdlZERpY3Quc2l6ZSA+IDAgPyBtZXJnZWREaWN0IDogRGljdC5lbXB0eTsKICB9Cgp9CgpleHBvcnRzLkRpY3QgPSBEaWN0OwoKY29uc3QgUmVmID0gZnVuY3Rpb24gUmVmQ2xvc3VyZSgpIHsKICBsZXQgcmVmQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICBjbGFzcyBSZWYgewogICAgY29uc3RydWN0b3IobnVtLCBnZW4pIHsKICAgICAgdGhpcy5udW0gPSBudW07CiAgICAgIHRoaXMuZ2VuID0gZ2VuOwogICAgfQoKICAgIHRvU3RyaW5nKCkgewogICAgICBpZiAodGhpcy5nZW4gPT09IDApIHsKICAgICAgICByZXR1cm4gYCR7dGhpcy5udW19UmA7CiAgICAgIH0KCiAgICAgIHJldHVybiBgJHt0aGlzLm51bX1SJHt0aGlzLmdlbn1gOwogICAgfQoKICAgIHN0YXRpYyBnZXQobnVtLCBnZW4pIHsKICAgICAgY29uc3Qga2V5ID0gZ2VuID09PSAwID8gYCR7bnVtfVJgIDogYCR7bnVtfVIke2dlbn1gOwogICAgICByZXR1cm4gcmVmQ2FjaGVba2V5XSB8fCAocmVmQ2FjaGVba2V5XSA9IG5ldyBSZWYobnVtLCBnZW4pKTsKICAgIH0KCiAgICBzdGF0aWMgX2NsZWFyQ2FjaGUoKSB7CiAgICAgIHJlZkNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIH0KCiAgfQoKICByZXR1cm4gUmVmOwp9KCk7CgpleHBvcnRzLlJlZiA9IFJlZjsKCmNsYXNzIFJlZlNldCB7CiAgY29uc3RydWN0b3IoKSB7CiAgICBsZXQgcGFyZW50ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsOwogICAgdGhpcy5fc2V0ID0gbmV3IFNldChwYXJlbnQgJiYgcGFyZW50Ll9zZXQpOwogIH0KCiAgaGFzKHJlZikgewogICAgcmV0dXJuIHRoaXMuX3NldC5oYXMocmVmLnRvU3RyaW5nKCkpOwogIH0KCiAgcHV0KHJlZikgewogICAgdGhpcy5fc2V0LmFkZChyZWYudG9TdHJpbmcoKSk7CiAgfQoKICByZW1vdmUocmVmKSB7CiAgICB0aGlzLl9zZXQuZGVsZXRlKHJlZi50b1N0cmluZygpKTsKICB9CgogIFtTeW1ib2wuaXRlcmF0b3JdKCkgewogICAgcmV0dXJuIHRoaXMuX3NldC52YWx1ZXMoKTsKICB9CgogIGNsZWFyKCkgewogICAgdGhpcy5fc2V0LmNsZWFyKCk7CiAgfQoKfQoKZXhwb3J0cy5SZWZTZXQgPSBSZWZTZXQ7CgpjbGFzcyBSZWZTZXRDYWNoZSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLl9tYXAgPSBuZXcgTWFwKCk7CiAgfQoKICBnZXQgc2l6ZSgpIHsKICAgIHJldHVybiB0aGlzLl9tYXAuc2l6ZTsKICB9CgogIGdldChyZWYpIHsKICAgIHJldHVybiB0aGlzLl9tYXAuZ2V0KHJlZi50b1N0cmluZygpKTsKICB9CgogIGhhcyhyZWYpIHsKICAgIHJldHVybiB0aGlzLl9tYXAuaGFzKHJlZi50b1N0cmluZygpKTsKICB9CgogIHB1dChyZWYsIG9iaikgewogICAgdGhpcy5fbWFwLnNldChyZWYudG9TdHJpbmcoKSwgb2JqKTsKICB9CgogIHB1dEFsaWFzKHJlZiwgYWxpYXNSZWYpIHsKICAgIHRoaXMuX21hcC5zZXQocmVmLnRvU3RyaW5nKCksIHRoaXMuZ2V0KGFsaWFzUmVmKSk7CiAgfQoKICBbU3ltYm9sLml0ZXJhdG9yXSgpIHsKICAgIHJldHVybiB0aGlzLl9tYXAudmFsdWVzKCk7CiAgfQoKICBjbGVhcigpIHsKICAgIHRoaXMuX21hcC5jbGVhcigpOwogIH0KCn0KCmV4cG9ydHMuUmVmU2V0Q2FjaGUgPSBSZWZTZXRDYWNoZTsKCmZ1bmN0aW9uIGlzTmFtZSh2LCBuYW1lKSB7CiAgcmV0dXJuIHYgaW5zdGFuY2VvZiBOYW1lICYmIChuYW1lID09PSB1bmRlZmluZWQgfHwgdi5uYW1lID09PSBuYW1lKTsKfQoKZnVuY3Rpb24gaXNDbWQodiwgY21kKSB7CiAgcmV0dXJuIHYgaW5zdGFuY2VvZiBDbWQgJiYgKGNtZCA9PT0gdW5kZWZpbmVkIHx8IHYuY21kID09PSBjbWQpOwp9CgpmdW5jdGlvbiBpc0RpY3QodiwgdHlwZSkgewogIHJldHVybiB2IGluc3RhbmNlb2YgRGljdCAmJiAodHlwZSA9PT0gdW5kZWZpbmVkIHx8IGlzTmFtZSh2LmdldCgiVHlwZSIpLCB0eXBlKSk7Cn0KCmZ1bmN0aW9uIGlzUmVmc0VxdWFsKHYxLCB2MikgewogIHJldHVybiB2MS5udW0gPT09IHYyLm51bSAmJiB2MS5nZW4gPT09IHYyLmdlbjsKfQoKZnVuY3Rpb24gY2xlYXJQcmltaXRpdmVDYWNoZXMoKSB7CiAgQ21kLl9jbGVhckNhY2hlKCk7CgogIE5hbWUuX2NsZWFyQ2FjaGUoKTsKCiAgUmVmLl9jbGVhckNhY2hlKCk7Cn0KCi8qKiovIH0pLAovKiAxMzEgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlhSZWZQYXJzZUV4Y2VwdGlvbiA9IGV4cG9ydHMuWFJlZkVudHJ5RXhjZXB0aW9uID0gZXhwb3J0cy5QYXJzZXJFT0ZFeGNlcHRpb24gPSBleHBvcnRzLk1pc3NpbmdEYXRhRXhjZXB0aW9uID0gZXhwb3J0cy5Eb2NTdGF0cyA9IHZvaWQgMDsKZXhwb3J0cy5jb2xsZWN0QWN0aW9ucyA9IGNvbGxlY3RBY3Rpb25zOwpleHBvcnRzLmVuY29kZVRvWG1sU3RyaW5nID0gZW5jb2RlVG9YbWxTdHJpbmc7CmV4cG9ydHMuZXNjYXBlUERGTmFtZSA9IGVzY2FwZVBERk5hbWU7CmV4cG9ydHMuZ2V0QXJyYXlMb29rdXBUYWJsZUZhY3RvcnkgPSBnZXRBcnJheUxvb2t1cFRhYmxlRmFjdG9yeTsKZXhwb3J0cy5nZXRJbmhlcml0YWJsZVByb3BlcnR5ID0gZ2V0SW5oZXJpdGFibGVQcm9wZXJ0eTsKZXhwb3J0cy5nZXRMb29rdXBUYWJsZUZhY3RvcnkgPSBnZXRMb29rdXBUYWJsZUZhY3Rvcnk7CmV4cG9ydHMuZ2V0TmV3QW5ub3RhdGlvbnNNYXAgPSBnZXROZXdBbm5vdGF0aW9uc01hcDsKZXhwb3J0cy5pc1doaXRlU3BhY2UgPSBpc1doaXRlU3BhY2U7CmV4cG9ydHMubG9nMiA9IGxvZzI7CmV4cG9ydHMubnVtYmVyVG9TdHJpbmcgPSBudW1iZXJUb1N0cmluZzsKZXhwb3J0cy5wYXJzZVhGQVBhdGggPSBwYXJzZVhGQVBhdGg7CmV4cG9ydHMucmVhZEludDggPSByZWFkSW50ODsKZXhwb3J0cy5yZWFkVWludDE2ID0gcmVhZFVpbnQxNjsKZXhwb3J0cy5yZWFkVWludDMyID0gcmVhZFVpbnQzMjsKZXhwb3J0cy5yZWNvdmVySnNVUkwgPSByZWNvdmVySnNVUkw7CmV4cG9ydHMudG9Sb21hbk51bWVyYWxzID0gdG9Sb21hbk51bWVyYWxzOwpleHBvcnRzLnZhbGlkYXRlQ1NTRm9udCA9IHZhbGlkYXRlQ1NTRm9udDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMCk7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzIpOwoKZnVuY3Rpb24gZ2V0TG9va3VwVGFibGVGYWN0b3J5KGluaXRpYWxpemVyKSB7CiAgbGV0IGxvb2t1cDsKICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgaWYgKGluaXRpYWxpemVyKSB7CiAgICAgIGxvb2t1cCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgIGluaXRpYWxpemVyKGxvb2t1cCk7CiAgICAgIGluaXRpYWxpemVyID0gbnVsbDsKICAgIH0KCiAgICByZXR1cm4gbG9va3VwOwogIH07Cn0KCmZ1bmN0aW9uIGdldEFycmF5TG9va3VwVGFibGVGYWN0b3J5KGluaXRpYWxpemVyKSB7CiAgbGV0IGxvb2t1cDsKICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgaWYgKGluaXRpYWxpemVyKSB7CiAgICAgIGxldCBhcnIgPSBpbml0aWFsaXplcigpOwogICAgICBpbml0aWFsaXplciA9IG51bGw7CiAgICAgIGxvb2t1cCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBhcnIubGVuZ3RoOyBpIDwgaWk7IGkgKz0gMikgewogICAgICAgIGxvb2t1cFthcnJbaV1dID0gYXJyW2kgKyAxXTsKICAgICAgfQoKICAgICAgYXJyID0gbnVsbDsKICAgIH0KCiAgICByZXR1cm4gbG9va3VwOwogIH07Cn0KCmNsYXNzIE1pc3NpbmdEYXRhRXhjZXB0aW9uIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IoYmVnaW4sIGVuZCkgewogICAgc3VwZXIoYE1pc3NpbmcgZGF0YSBbJHtiZWdpbn0sICR7ZW5kfSlgLCAiTWlzc2luZ0RhdGFFeGNlcHRpb24iKTsKICAgIHRoaXMuYmVnaW4gPSBiZWdpbjsKICAgIHRoaXMuZW5kID0gZW5kOwogIH0KCn0KCmV4cG9ydHMuTWlzc2luZ0RhdGFFeGNlcHRpb24gPSBNaXNzaW5nRGF0YUV4Y2VwdGlvbjsKCmNsYXNzIFBhcnNlckVPRkV4Y2VwdGlvbiBleHRlbmRzIF91dGlsLkJhc2VFeGNlcHRpb24gewogIGNvbnN0cnVjdG9yKG1zZykgewogICAgc3VwZXIobXNnLCAiUGFyc2VyRU9GRXhjZXB0aW9uIik7CiAgfQoKfQoKZXhwb3J0cy5QYXJzZXJFT0ZFeGNlcHRpb24gPSBQYXJzZXJFT0ZFeGNlcHRpb247CgpjbGFzcyBYUmVmRW50cnlFeGNlcHRpb24gZXh0ZW5kcyBfdXRpbC5CYXNlRXhjZXB0aW9uIHsKICBjb25zdHJ1Y3Rvcihtc2cpIHsKICAgIHN1cGVyKG1zZywgIlhSZWZFbnRyeUV4Y2VwdGlvbiIpOwogIH0KCn0KCmV4cG9ydHMuWFJlZkVudHJ5RXhjZXB0aW9uID0gWFJlZkVudHJ5RXhjZXB0aW9uOwoKY2xhc3MgWFJlZlBhcnNlRXhjZXB0aW9uIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihtc2csICJYUmVmUGFyc2VFeGNlcHRpb24iKTsKICB9Cgp9CgpleHBvcnRzLlhSZWZQYXJzZUV4Y2VwdGlvbiA9IFhSZWZQYXJzZUV4Y2VwdGlvbjsKCmNsYXNzIERvY1N0YXRzIHsKICBjb25zdHJ1Y3RvcihoYW5kbGVyKSB7CiAgICB0aGlzLl9oYW5kbGVyID0gaGFuZGxlcjsKICAgIHRoaXMuX3N0cmVhbVR5cGVzID0gbmV3IFNldCgpOwogICAgdGhpcy5fZm9udFR5cGVzID0gbmV3IFNldCgpOwogIH0KCiAgX3NlbmQoKSB7CiAgICBjb25zdCBzdHJlYW1UeXBlcyA9IE9iamVjdC5jcmVhdGUobnVsbCksCiAgICAgICAgICBmb250VHlwZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGZvciAoY29uc3QgdHlwZSBvZiB0aGlzLl9zdHJlYW1UeXBlcykgewogICAgICBzdHJlYW1UeXBlc1t0eXBlXSA9IHRydWU7CiAgICB9CgogICAgZm9yIChjb25zdCB0eXBlIG9mIHRoaXMuX2ZvbnRUeXBlcykgewogICAgICBmb250VHlwZXNbdHlwZV0gPSB0cnVlOwogICAgfQoKICAgIHRoaXMuX2hhbmRsZXIuc2VuZCgiRG9jU3RhdHMiLCB7CiAgICAgIHN0cmVhbVR5cGVzLAogICAgICBmb250VHlwZXMKICAgIH0pOwogIH0KCiAgYWRkU3RyZWFtVHlwZSh0eXBlKSB7CiAgICBpZiAodGhpcy5fc3RyZWFtVHlwZXMuaGFzKHR5cGUpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9zdHJlYW1UeXBlcy5hZGQodHlwZSk7CgogICAgdGhpcy5fc2VuZCgpOwogIH0KCiAgYWRkRm9udFR5cGUodHlwZSkgewogICAgaWYgKHRoaXMuX2ZvbnRUeXBlcy5oYXModHlwZSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuX2ZvbnRUeXBlcy5hZGQodHlwZSk7CgogICAgdGhpcy5fc2VuZCgpOwogIH0KCn0KCmV4cG9ydHMuRG9jU3RhdHMgPSBEb2NTdGF0czsKCmZ1bmN0aW9uIGdldEluaGVyaXRhYmxlUHJvcGVydHkoX3JlZikgewogIGxldCB7CiAgICBkaWN0LAogICAga2V5LAogICAgZ2V0QXJyYXkgPSBmYWxzZSwKICAgIHN0b3BXaGVuRm91bmQgPSB0cnVlCiAgfSA9IF9yZWY7CiAgbGV0IHZhbHVlczsKICBjb25zdCB2aXNpdGVkID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwoKICB3aGlsZSAoZGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgJiYgIShkaWN0Lm9iaklkICYmIHZpc2l0ZWQuaGFzKGRpY3Qub2JqSWQpKSkgewogICAgaWYgKGRpY3Qub2JqSWQpIHsKICAgICAgdmlzaXRlZC5wdXQoZGljdC5vYmpJZCk7CiAgICB9CgogICAgY29uc3QgdmFsdWUgPSBnZXRBcnJheSA/IGRpY3QuZ2V0QXJyYXkoa2V5KSA6IGRpY3QuZ2V0KGtleSk7CgogICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKHN0b3BXaGVuRm91bmQpIHsKICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgIH0KCiAgICAgIGlmICghdmFsdWVzKSB7CiAgICAgICAgdmFsdWVzID0gW107CiAgICAgIH0KCiAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTsKICAgIH0KCiAgICBkaWN0ID0gZGljdC5nZXQoIlBhcmVudCIpOwogIH0KCiAgcmV0dXJuIHZhbHVlczsKfQoKY29uc3QgUk9NQU5fTlVNQkVSX01BUCA9IFsiIiwgIkMiLCAiQ0MiLCAiQ0NDIiwgIkNEIiwgIkQiLCAiREMiLCAiRENDIiwgIkRDQ0MiLCAiQ00iLCAiIiwgIlgiLCAiWFgiLCAiWFhYIiwgIlhMIiwgIkwiLCAiTFgiLCAiTFhYIiwgIkxYWFgiLCAiWEMiLCAiIiwgIkkiLCAiSUkiLCAiSUlJIiwgIklWIiwgIlYiLCAiVkkiLCAiVklJIiwgIlZJSUkiLCAiSVgiXTsKCmZ1bmN0aW9uIHRvUm9tYW5OdW1lcmFscyhudW1iZXIpIHsKICBsZXQgbG93ZXJDYXNlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAoMCwgX3V0aWwuYXNzZXJ0KShOdW1iZXIuaXNJbnRlZ2VyKG51bWJlcikgJiYgbnVtYmVyID4gMCwgIlRoZSBudW1iZXIgc2hvdWxkIGJlIGEgcG9zaXRpdmUgaW50ZWdlci4iKTsKICBjb25zdCByb21hbkJ1ZiA9IFtdOwogIGxldCBwb3M7CgogIHdoaWxlIChudW1iZXIgPj0gMTAwMCkgewogICAgbnVtYmVyIC09IDEwMDA7CiAgICByb21hbkJ1Zi5wdXNoKCJNIik7CiAgfQoKICBwb3MgPSBudW1iZXIgLyAxMDAgfCAwOwogIG51bWJlciAlPSAxMDA7CiAgcm9tYW5CdWYucHVzaChST01BTl9OVU1CRVJfTUFQW3Bvc10pOwogIHBvcyA9IG51bWJlciAvIDEwIHwgMDsKICBudW1iZXIgJT0gMTA7CiAgcm9tYW5CdWYucHVzaChST01BTl9OVU1CRVJfTUFQWzEwICsgcG9zXSk7CiAgcm9tYW5CdWYucHVzaChST01BTl9OVU1CRVJfTUFQWzIwICsgbnVtYmVyXSk7CiAgY29uc3Qgcm9tYW5TdHIgPSByb21hbkJ1Zi5qb2luKCIiKTsKICByZXR1cm4gbG93ZXJDYXNlID8gcm9tYW5TdHIudG9Mb3dlckNhc2UoKSA6IHJvbWFuU3RyOwp9CgpmdW5jdGlvbiBsb2cyKHgpIHsKICBpZiAoeCA8PSAwKSB7CiAgICByZXR1cm4gMDsKICB9CgogIHJldHVybiBNYXRoLmNlaWwoTWF0aC5sb2cyKHgpKTsKfQoKZnVuY3Rpb24gcmVhZEludDgoZGF0YSwgb2Zmc2V0KSB7CiAgcmV0dXJuIGRhdGFbb2Zmc2V0XSA8PCAyNCA+PiAyNDsKfQoKZnVuY3Rpb24gcmVhZFVpbnQxNihkYXRhLCBvZmZzZXQpIHsKICByZXR1cm4gZGF0YVtvZmZzZXRdIDw8IDggfCBkYXRhW29mZnNldCArIDFdOwp9CgpmdW5jdGlvbiByZWFkVWludDMyKGRhdGEsIG9mZnNldCkgewogIHJldHVybiAoZGF0YVtvZmZzZXRdIDw8IDI0IHwgZGF0YVtvZmZzZXQgKyAxXSA8PCAxNiB8IGRhdGFbb2Zmc2V0ICsgMl0gPDwgOCB8IGRhdGFbb2Zmc2V0ICsgM10pID4+PiAwOwp9CgpmdW5jdGlvbiBpc1doaXRlU3BhY2UoY2gpIHsKICByZXR1cm4gY2ggPT09IDB4MjAgfHwgY2ggPT09IDB4MDkgfHwgY2ggPT09IDB4MGQgfHwgY2ggPT09IDB4MGE7Cn0KCmZ1bmN0aW9uIHBhcnNlWEZBUGF0aChwYXRoKSB7CiAgY29uc3QgcG9zaXRpb25QYXR0ZXJuID0gLyguKylcWyhcZCspXF0kLzsKICByZXR1cm4gcGF0aC5zcGxpdCgiLiIpLm1hcChjb21wb25lbnQgPT4gewogICAgY29uc3QgbSA9IGNvbXBvbmVudC5tYXRjaChwb3NpdGlvblBhdHRlcm4pOwoKICAgIGlmIChtKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogbVsxXSwKICAgICAgICBwb3M6IHBhcnNlSW50KG1bMl0sIDEwKQogICAgICB9OwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIG5hbWU6IGNvbXBvbmVudCwKICAgICAgcG9zOiAwCiAgICB9OwogIH0pOwp9CgpmdW5jdGlvbiBlc2NhcGVQREZOYW1lKHN0cikgewogIGNvbnN0IGJ1ZmZlciA9IFtdOwogIGxldCBzdGFydCA9IDA7CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IHN0ci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjaGFyID0gc3RyLmNoYXJDb2RlQXQoaSk7CgogICAgaWYgKGNoYXIgPCAweDIxIHx8IGNoYXIgPiAweDdlIHx8IGNoYXIgPT09IDB4MjMgfHwgY2hhciA9PT0gMHgyOCB8fCBjaGFyID09PSAweDI5IHx8IGNoYXIgPT09IDB4M2MgfHwgY2hhciA9PT0gMHgzZSB8fCBjaGFyID09PSAweDViIHx8IGNoYXIgPT09IDB4NWQgfHwgY2hhciA9PT0gMHg3YiB8fCBjaGFyID09PSAweDdkIHx8IGNoYXIgPT09IDB4MmYgfHwgY2hhciA9PT0gMHgyNSkgewogICAgICBpZiAoc3RhcnQgPCBpKSB7CiAgICAgICAgYnVmZmVyLnB1c2goc3RyLnN1YnN0cmluZyhzdGFydCwgaSkpOwogICAgICB9CgogICAgICBidWZmZXIucHVzaChgIyR7Y2hhci50b1N0cmluZygxNil9YCk7CiAgICAgIHN0YXJ0ID0gaSArIDE7CiAgICB9CiAgfQoKICBpZiAoYnVmZmVyLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuIHN0cjsKICB9CgogIGlmIChzdGFydCA8IHN0ci5sZW5ndGgpIHsKICAgIGJ1ZmZlci5wdXNoKHN0ci5zdWJzdHJpbmcoc3RhcnQsIHN0ci5sZW5ndGgpKTsKICB9CgogIHJldHVybiBidWZmZXIuam9pbigiIik7Cn0KCmZ1bmN0aW9uIF9jb2xsZWN0SlMoZW50cnksIHhyZWYsIGxpc3QsIHBhcmVudHMpIHsKICBpZiAoIWVudHJ5KSB7CiAgICByZXR1cm47CiAgfQoKICBsZXQgcGFyZW50ID0gbnVsbDsKCiAgaWYgKGVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICBpZiAocGFyZW50cy5oYXMoZW50cnkpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBwYXJlbnQgPSBlbnRyeTsKICAgIHBhcmVudHMucHV0KHBhcmVudCk7CiAgICBlbnRyeSA9IHhyZWYuZmV0Y2goZW50cnkpOwogIH0KCiAgaWYgKEFycmF5LmlzQXJyYXkoZW50cnkpKSB7CiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZW50cnkpIHsKICAgICAgX2NvbGxlY3RKUyhlbGVtZW50LCB4cmVmLCBsaXN0LCBwYXJlbnRzKTsKICAgIH0KICB9IGVsc2UgaWYgKGVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGVudHJ5LmdldCgiUyIpLCAiSmF2YVNjcmlwdCIpKSB7CiAgICAgIGNvbnN0IGpzID0gZW50cnkuZ2V0KCJKUyIpOwogICAgICBsZXQgY29kZTsKCiAgICAgIGlmIChqcyBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgICAgY29kZSA9IGpzLmdldFN0cmluZygpOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBqcyA9PT0gInN0cmluZyIpIHsKICAgICAgICBjb2RlID0ganM7CiAgICAgIH0KCiAgICAgIGNvZGUgPSBjb2RlICYmICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoY29kZSkucmVwbGFjZSgvXHUwMDAwL2csICIiKTsKCiAgICAgIGlmIChjb2RlKSB7CiAgICAgICAgbGlzdC5wdXNoKGNvZGUpOwogICAgICB9CiAgICB9CgogICAgX2NvbGxlY3RKUyhlbnRyeS5nZXRSYXcoIk5leHQiKSwgeHJlZiwgbGlzdCwgcGFyZW50cyk7CiAgfQoKICBpZiAocGFyZW50KSB7CiAgICBwYXJlbnRzLnJlbW92ZShwYXJlbnQpOwogIH0KfQoKZnVuY3Rpb24gY29sbGVjdEFjdGlvbnMoeHJlZiwgZGljdCwgZXZlbnRUeXBlKSB7CiAgY29uc3QgYWN0aW9ucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgY29uc3QgYWRkaXRpb25hbEFjdGlvbnNEaWN0cyA9IGdldEluaGVyaXRhYmxlUHJvcGVydHkoewogICAgZGljdCwKICAgIGtleTogIkFBIiwKICAgIHN0b3BXaGVuRm91bmQ6IGZhbHNlCiAgfSk7CgogIGlmIChhZGRpdGlvbmFsQWN0aW9uc0RpY3RzKSB7CiAgICBmb3IgKGxldCBpID0gYWRkaXRpb25hbEFjdGlvbnNEaWN0cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICBjb25zdCBhZGRpdGlvbmFsQWN0aW9ucyA9IGFkZGl0aW9uYWxBY3Rpb25zRGljdHNbaV07CgogICAgICBpZiAoIShhZGRpdGlvbmFsQWN0aW9ucyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZvciAoY29uc3Qga2V5IG9mIGFkZGl0aW9uYWxBY3Rpb25zLmdldEtleXMoKSkgewogICAgICAgIGNvbnN0IGFjdGlvbiA9IGV2ZW50VHlwZVtrZXldOwoKICAgICAgICBpZiAoIWFjdGlvbikgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBhY3Rpb25EaWN0ID0gYWRkaXRpb25hbEFjdGlvbnMuZ2V0UmF3KGtleSk7CiAgICAgICAgY29uc3QgcGFyZW50cyA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXQoKTsKICAgICAgICBjb25zdCBsaXN0ID0gW107CgogICAgICAgIF9jb2xsZWN0SlMoYWN0aW9uRGljdCwgeHJlZiwgbGlzdCwgcGFyZW50cyk7CgogICAgICAgIGlmIChsaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgIGFjdGlvbnNbYWN0aW9uXSA9IGxpc3Q7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBpZiAoZGljdC5oYXMoIkEiKSkgewogICAgY29uc3QgYWN0aW9uRGljdCA9IGRpY3QuZ2V0KCJBIik7CiAgICBjb25zdCBwYXJlbnRzID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogICAgY29uc3QgbGlzdCA9IFtdOwoKICAgIF9jb2xsZWN0SlMoYWN0aW9uRGljdCwgeHJlZiwgbGlzdCwgcGFyZW50cyk7CgogICAgaWYgKGxpc3QubGVuZ3RoID4gMCkgewogICAgICBhY3Rpb25zLkFjdGlvbiA9IGxpc3Q7CiAgICB9CiAgfQoKICByZXR1cm4gKDAsIF91dGlsLm9iamVjdFNpemUpKGFjdGlvbnMpID4gMCA/IGFjdGlvbnMgOiBudWxsOwp9Cgpjb25zdCBYTUxFbnRpdGllcyA9IHsKICAweDNjOiAiJmx0OyIsCiAgMHgzZTogIiZndDsiLAogIDB4MjY6ICImYW1wOyIsCiAgMHgyMjogIiZxdW90OyIsCiAgMHgyNzogIiZhcG9zOyIKfTsKCmZ1bmN0aW9uIGVuY29kZVRvWG1sU3RyaW5nKHN0cikgewogIGNvbnN0IGJ1ZmZlciA9IFtdOwogIGxldCBzdGFydCA9IDA7CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IHN0ci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjaGFyID0gc3RyLmNvZGVQb2ludEF0KGkpOwoKICAgIGlmICgweDIwIDw9IGNoYXIgJiYgY2hhciA8PSAweDdlKSB7CiAgICAgIGNvbnN0IGVudGl0eSA9IFhNTEVudGl0aWVzW2NoYXJdOwoKICAgICAgaWYgKGVudGl0eSkgewogICAgICAgIGlmIChzdGFydCA8IGkpIHsKICAgICAgICAgIGJ1ZmZlci5wdXNoKHN0ci5zdWJzdHJpbmcoc3RhcnQsIGkpKTsKICAgICAgICB9CgogICAgICAgIGJ1ZmZlci5wdXNoKGVudGl0eSk7CiAgICAgICAgc3RhcnQgPSBpICsgMTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKHN0YXJ0IDwgaSkgewogICAgICAgIGJ1ZmZlci5wdXNoKHN0ci5zdWJzdHJpbmcoc3RhcnQsIGkpKTsKICAgICAgfQoKICAgICAgYnVmZmVyLnB1c2goYCYjeCR7Y2hhci50b1N0cmluZygxNikudG9VcHBlckNhc2UoKX07YCk7CgogICAgICBpZiAoY2hhciA+IDB4ZDdmZiAmJiAoY2hhciA8IDB4ZTAwMCB8fCBjaGFyID4gMHhmZmZkKSkgewogICAgICAgIGkrKzsKICAgICAgfQoKICAgICAgc3RhcnQgPSBpICsgMTsKICAgIH0KICB9CgogIGlmIChidWZmZXIubGVuZ3RoID09PSAwKSB7CiAgICByZXR1cm4gc3RyOwogIH0KCiAgaWYgKHN0YXJ0IDwgc3RyLmxlbmd0aCkgewogICAgYnVmZmVyLnB1c2goc3RyLnN1YnN0cmluZyhzdGFydCwgc3RyLmxlbmd0aCkpOwogIH0KCiAgcmV0dXJuIGJ1ZmZlci5qb2luKCIiKTsKfQoKZnVuY3Rpb24gdmFsaWRhdGVDU1NGb250KGNzc0ZvbnRJbmZvKSB7CiAgY29uc3QgREVGQVVMVF9DU1NfRk9OVF9PQkxJUVVFID0gIjE0IjsKICBjb25zdCBERUZBVUxUX0NTU19GT05UX1dFSUdIVCA9ICI0MDAiOwogIGNvbnN0IENTU19GT05UX1dFSUdIVF9WQUxVRVMgPSBuZXcgU2V0KFsiMTAwIiwgIjIwMCIsICIzMDAiLCAiNDAwIiwgIjUwMCIsICI2MDAiLCAiNzAwIiwgIjgwMCIsICI5MDAiLCAiMTAwMCIsICJub3JtYWwiLCAiYm9sZCIsICJib2xkZXIiLCAibGlnaHRlciJdKTsKICBjb25zdCB7CiAgICBmb250RmFtaWx5LAogICAgZm9udFdlaWdodCwKICAgIGl0YWxpY0FuZ2xlCiAgfSA9IGNzc0ZvbnRJbmZvOwoKICBpZiAoL14iLioiJC8udGVzdChmb250RmFtaWx5KSkgewogICAgaWYgKC9bXlxcXSIvLnRlc3QoZm9udEZhbWlseS5zbGljZSgxLCBmb250RmFtaWx5Lmxlbmd0aCAtIDEpKSkgewogICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEZvbnRGYW1pbHkgY29udGFpbnMgc29tZSB1bmVzY2FwZWQgIjogJHtmb250RmFtaWx5fS5gKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0gZWxzZSBpZiAoL14nLionJC8udGVzdChmb250RmFtaWx5KSkgewogICAgaWYgKC9bXlxcXScvLnRlc3QoZm9udEZhbWlseS5zbGljZSgxLCBmb250RmFtaWx5Lmxlbmd0aCAtIDEpKSkgewogICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEZvbnRGYW1pbHkgY29udGFpbnMgc29tZSB1bmVzY2FwZWQgJzogJHtmb250RmFtaWx5fS5gKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0gZWxzZSB7CiAgICBmb3IgKGNvbnN0IGlkZW50IG9mIGZvbnRGYW1pbHkuc3BsaXQoL1sgXHRdKy8pKSB7CiAgICAgIGlmICgvXihcZHwoLShcZHwtKSkpLy50ZXN0KGlkZW50KSB8fCAhL15bXHctXFxdKyQvLnRlc3QoaWRlbnQpKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBGb250RmFtaWx5IGNvbnRhaW5zIHNvbWUgaW52YWxpZCA8Y3VzdG9tLWlkZW50PjogJHtmb250RmFtaWx5fS5gKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9CgogIGNvbnN0IHdlaWdodCA9IGZvbnRXZWlnaHQgPyBmb250V2VpZ2h0LnRvU3RyaW5nKCkgOiAiIjsKICBjc3NGb250SW5mby5mb250V2VpZ2h0ID0gQ1NTX0ZPTlRfV0VJR0hUX1ZBTFVFUy5oYXMod2VpZ2h0KSA/IHdlaWdodCA6IERFRkFVTFRfQ1NTX0ZPTlRfV0VJR0hUOwogIGNvbnN0IGFuZ2xlID0gcGFyc2VGbG9hdChpdGFsaWNBbmdsZSk7CiAgY3NzRm9udEluZm8uaXRhbGljQW5nbGUgPSBpc05hTihhbmdsZSkgfHwgYW5nbGUgPCAtOTAgfHwgYW5nbGUgPiA5MCA/IERFRkFVTFRfQ1NTX0ZPTlRfT0JMSVFVRSA6IGl0YWxpY0FuZ2xlLnRvU3RyaW5nKCk7CiAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIHJlY292ZXJKc1VSTChzdHIpIHsKICBjb25zdCBVUkxfT1BFTl9NRVRIT0RTID0gWyJhcHAubGF1bmNoVVJMIiwgIndpbmRvdy5vcGVuIiwgInhmYS5ob3N0LmdvdG9VUkwiXTsKICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoIl5cXHMqKCIgKyBVUkxfT1BFTl9NRVRIT0RTLmpvaW4oInwiKS5zcGxpdCgiLiIpLmpvaW4oIlxcLiIpICsgIilcXCgoPzonfFwiKShbXidcIl0qKSg/Oid8XCIpKD86LFxccyooXFx3KylcXCl8XFwpKSIsICJpIik7CiAgY29uc3QganNVcmwgPSByZWdleC5leGVjKHN0cik7CgogIGlmIChqc1VybCAmJiBqc1VybFsyXSkgewogICAgY29uc3QgdXJsID0ganNVcmxbMl07CiAgICBsZXQgbmV3V2luZG93ID0gZmFsc2U7CgogICAgaWYgKGpzVXJsWzNdID09PSAidHJ1ZSIgJiYganNVcmxbMV0gPT09ICJhcHAubGF1bmNoVVJMIikgewogICAgICBuZXdXaW5kb3cgPSB0cnVlOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHVybCwKICAgICAgbmV3V2luZG93CiAgICB9OwogIH0KCiAgcmV0dXJuIG51bGw7Cn0KCmZ1bmN0aW9uIG51bWJlclRvU3RyaW5nKHZhbHVlKSB7CiAgaWYgKE51bWJlci5pc0ludGVnZXIodmFsdWUpKSB7CiAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTsKICB9CgogIGNvbnN0IHJvdW5kZWRWYWx1ZSA9IE1hdGgucm91bmQodmFsdWUgKiAxMDApOwoKICBpZiAocm91bmRlZFZhbHVlICUgMTAwID09PSAwKSB7CiAgICByZXR1cm4gKHJvdW5kZWRWYWx1ZSAvIDEwMCkudG9TdHJpbmcoKTsKICB9CgogIGlmIChyb3VuZGVkVmFsdWUgJSAxMCA9PT0gMCkgewogICAgcmV0dXJuIHZhbHVlLnRvRml4ZWQoMSk7CiAgfQoKICByZXR1cm4gdmFsdWUudG9GaXhlZCgyKTsKfQoKZnVuY3Rpb24gZ2V0TmV3QW5ub3RhdGlvbnNNYXAoYW5ub3RhdGlvblN0b3JhZ2UpIHsKICBpZiAoIWFubm90YXRpb25TdG9yYWdlKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IG5ld0Fubm90YXRpb25zQnlQYWdlID0gbmV3IE1hcCgpOwoKICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgaWYgKCFrZXkuc3RhcnRzV2l0aChfdXRpbC5Bbm5vdGF0aW9uRWRpdG9yUHJlZml4KSkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBsZXQgYW5ub3RhdGlvbnMgPSBuZXdBbm5vdGF0aW9uc0J5UGFnZS5nZXQodmFsdWUucGFnZUluZGV4KTsKCiAgICBpZiAoIWFubm90YXRpb25zKSB7CiAgICAgIGFubm90YXRpb25zID0gW107CiAgICAgIG5ld0Fubm90YXRpb25zQnlQYWdlLnNldCh2YWx1ZS5wYWdlSW5kZXgsIGFubm90YXRpb25zKTsKICAgIH0KCiAgICBhbm5vdGF0aW9ucy5wdXNoKHZhbHVlKTsKICB9CgogIHJldHVybiBuZXdBbm5vdGF0aW9uc0J5UGFnZS5zaXplID4gMCA/IG5ld0Fubm90YXRpb25zQnlQYWdlIDogbnVsbDsKfQoKLyoqKi8gfSksCi8qIDEzMiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuQmFzZVN0cmVhbSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpjbGFzcyBCYXNlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBCYXNlU3RyZWFtKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBpbml0aWFsaXplIEJhc2VTdHJlYW0uIik7CiAgICB9CiAgfQoKICBnZXQgbGVuZ3RoKCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgZ2V0dGVyIGBsZW5ndGhgIGFjY2Vzc2VkIik7CiAgfQoKICBnZXQgaXNFbXB0eSgpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IGdldHRlciBgaXNFbXB0eWAgYWNjZXNzZWQiKTsKICB9CgogIGdldCBpc0RhdGFMb2FkZWQoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImlzRGF0YUxvYWRlZCIsIHRydWUpOwogIH0KCiAgZ2V0Qnl0ZSgpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgZ2V0Qnl0ZWAgY2FsbGVkIik7CiAgfQoKICBnZXRCeXRlcyhsZW5ndGgpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgZ2V0Qnl0ZXNgIGNhbGxlZCIpOwogIH0KCiAgcGVla0J5dGUoKSB7CiAgICBjb25zdCBwZWVrZWRCeXRlID0gdGhpcy5nZXRCeXRlKCk7CgogICAgaWYgKHBlZWtlZEJ5dGUgIT09IC0xKSB7CiAgICAgIHRoaXMucG9zLS07CiAgICB9CgogICAgcmV0dXJuIHBlZWtlZEJ5dGU7CiAgfQoKICBwZWVrQnl0ZXMobGVuZ3RoKSB7CiAgICBjb25zdCBieXRlcyA9IHRoaXMuZ2V0Qnl0ZXMobGVuZ3RoKTsKICAgIHRoaXMucG9zIC09IGJ5dGVzLmxlbmd0aDsKICAgIHJldHVybiBieXRlczsKICB9CgogIGdldFVpbnQxNigpIHsKICAgIGNvbnN0IGIwID0gdGhpcy5nZXRCeXRlKCk7CiAgICBjb25zdCBiMSA9IHRoaXMuZ2V0Qnl0ZSgpOwoKICAgIGlmIChiMCA9PT0gLTEgfHwgYjEgPT09IC0xKSB7CiAgICAgIHJldHVybiAtMTsKICAgIH0KCiAgICByZXR1cm4gKGIwIDw8IDgpICsgYjE7CiAgfQoKICBnZXRJbnQzMigpIHsKICAgIGNvbnN0IGIwID0gdGhpcy5nZXRCeXRlKCk7CiAgICBjb25zdCBiMSA9IHRoaXMuZ2V0Qnl0ZSgpOwogICAgY29uc3QgYjIgPSB0aGlzLmdldEJ5dGUoKTsKICAgIGNvbnN0IGIzID0gdGhpcy5nZXRCeXRlKCk7CiAgICByZXR1cm4gKGIwIDw8IDI0KSArIChiMSA8PCAxNikgKyAoYjIgPDwgOCkgKyBiMzsKICB9CgogIGdldEJ5dGVSYW5nZShiZWdpbiwgZW5kKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYGdldEJ5dGVSYW5nZWAgY2FsbGVkIik7CiAgfQoKICBnZXRTdHJpbmcobGVuZ3RoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLmJ5dGVzVG9TdHJpbmcpKHRoaXMuZ2V0Qnl0ZXMobGVuZ3RoKSk7CiAgfQoKICBza2lwKG4pIHsKICAgIHRoaXMucG9zICs9IG4gfHwgMTsKICB9CgogIHJlc2V0KCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgbWV0aG9kIGByZXNldGAgY2FsbGVkIik7CiAgfQoKICBtb3ZlU3RhcnQoKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYG1vdmVTdGFydGAgY2FsbGVkIik7CiAgfQoKICBtYWtlU3ViU3RyZWFtKHN0YXJ0LCBsZW5ndGgpIHsKICAgIGxldCBkaWN0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBudWxsOwogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgbWV0aG9kIGBtYWtlU3ViU3RyZWFtYCBjYWxsZWQiKTsKICB9CgogIGdldEJhc2VTdHJlYW1zKCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKfQoKZXhwb3J0cy5CYXNlU3RyZWFtID0gQmFzZVN0cmVhbTsKCi8qKiovIH0pLAovKiAxMzMgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk5ldHdvcmtQZGZNYW5hZ2VyID0gZXhwb3J0cy5Mb2NhbFBkZk1hbmFnZXIgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jaHVua2VkX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTM0KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMxKTsKCnZhciBfZG9jdW1lbnQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzNik7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTM1KTsKCmZ1bmN0aW9uIHBhcnNlRG9jQmFzZVVybCh1cmwpIHsKICBpZiAodXJsKSB7CiAgICBjb25zdCBhYnNvbHV0ZVVybCA9ICgwLCBfdXRpbC5jcmVhdGVWYWxpZEFic29sdXRlVXJsKSh1cmwpOwoKICAgIGlmIChhYnNvbHV0ZVVybCkgewogICAgICByZXR1cm4gYWJzb2x1dGVVcmwuaHJlZjsKICAgIH0KCiAgICAoMCwgX3V0aWwud2FybikoYEludmFsaWQgYWJzb2x1dGUgZG9jQmFzZVVybDogIiR7dXJsfSIuYCk7CiAgfQoKICByZXR1cm4gbnVsbDsKfQoKY2xhc3MgQmFzZVBkZk1hbmFnZXIgewogIGNvbnN0cnVjdG9yKCkgewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IEJhc2VQZGZNYW5hZ2VyKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBpbml0aWFsaXplIEJhc2VQZGZNYW5hZ2VyLiIpOwogICAgfQogIH0KCiAgZ2V0IGRvY0lkKCkgewogICAgcmV0dXJuIHRoaXMuX2RvY0lkOwogIH0KCiAgZ2V0IHBhc3N3b3JkKCkgewogICAgcmV0dXJuIHRoaXMuX3Bhc3N3b3JkOwogIH0KCiAgZ2V0IGRvY0Jhc2VVcmwoKSB7CiAgICBjb25zdCBjYXRhbG9nID0gdGhpcy5wZGZEb2N1bWVudC5jYXRhbG9nOwogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJkb2NCYXNlVXJsIiwgY2F0YWxvZy5iYXNlVXJsIHx8IHRoaXMuX2RvY0Jhc2VVcmwpOwogIH0KCiAgb25Mb2FkZWRTdHJlYW0oKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYG9uTG9hZGVkU3RyZWFtYCBjYWxsZWQiKTsKICB9CgogIGVuc3VyZURvYyhwcm9wLCBhcmdzKSB7CiAgICByZXR1cm4gdGhpcy5lbnN1cmUodGhpcy5wZGZEb2N1bWVudCwgcHJvcCwgYXJncyk7CiAgfQoKICBlbnN1cmVYUmVmKHByb3AsIGFyZ3MpIHsKICAgIHJldHVybiB0aGlzLmVuc3VyZSh0aGlzLnBkZkRvY3VtZW50LnhyZWYsIHByb3AsIGFyZ3MpOwogIH0KCiAgZW5zdXJlQ2F0YWxvZyhwcm9wLCBhcmdzKSB7CiAgICByZXR1cm4gdGhpcy5lbnN1cmUodGhpcy5wZGZEb2N1bWVudC5jYXRhbG9nLCBwcm9wLCBhcmdzKTsKICB9CgogIGdldFBhZ2UocGFnZUluZGV4KSB7CiAgICByZXR1cm4gdGhpcy5wZGZEb2N1bWVudC5nZXRQYWdlKHBhZ2VJbmRleCk7CiAgfQoKICBmb250RmFsbGJhY2soaWQsIGhhbmRsZXIpIHsKICAgIHJldHVybiB0aGlzLnBkZkRvY3VtZW50LmZvbnRGYWxsYmFjayhpZCwgaGFuZGxlcik7CiAgfQoKICBsb2FkWGZhRm9udHMoaGFuZGxlciwgdGFzaykgewogICAgcmV0dXJuIHRoaXMucGRmRG9jdW1lbnQubG9hZFhmYUZvbnRzKGhhbmRsZXIsIHRhc2spOwogIH0KCiAgbG9hZFhmYUltYWdlcygpIHsKICAgIHJldHVybiB0aGlzLnBkZkRvY3VtZW50LmxvYWRYZmFJbWFnZXMoKTsKICB9CgogIHNlcmlhbGl6ZVhmYURhdGEoYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIHJldHVybiB0aGlzLnBkZkRvY3VtZW50LnNlcmlhbGl6ZVhmYURhdGEoYW5ub3RhdGlvblN0b3JhZ2UpOwogIH0KCiAgY2xlYW51cCgpIHsKICAgIGxldCBtYW51YWxseVRyaWdnZXJlZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CiAgICByZXR1cm4gdGhpcy5wZGZEb2N1bWVudC5jbGVhbnVwKG1hbnVhbGx5VHJpZ2dlcmVkKTsKICB9CgogIGFzeW5jIGVuc3VyZShvYmosIHByb3AsIGFyZ3MpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgZW5zdXJlYCBjYWxsZWQiKTsKICB9CgogIHJlcXVlc3RSYW5nZShiZWdpbiwgZW5kKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYHJlcXVlc3RSYW5nZWAgY2FsbGVkIik7CiAgfQoKICByZXF1ZXN0TG9hZGVkU3RyZWFtKCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgbWV0aG9kIGByZXF1ZXN0TG9hZGVkU3RyZWFtYCBjYWxsZWQiKTsKICB9CgogIHNlbmRQcm9ncmVzc2l2ZURhdGEoY2h1bmspIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgc2VuZFByb2dyZXNzaXZlRGF0YWAgY2FsbGVkIik7CiAgfQoKICB1cGRhdGVQYXNzd29yZChwYXNzd29yZCkgewogICAgdGhpcy5fcGFzc3dvcmQgPSBwYXNzd29yZDsKICB9CgogIHRlcm1pbmF0ZShyZWFzb24pIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgdGVybWluYXRlYCBjYWxsZWQiKTsKICB9Cgp9CgpjbGFzcyBMb2NhbFBkZk1hbmFnZXIgZXh0ZW5kcyBCYXNlUGRmTWFuYWdlciB7CiAgY29uc3RydWN0b3IoZG9jSWQsIGRhdGEsIHBhc3N3b3JkLCBtc2dIYW5kbGVyLCBldmFsdWF0b3JPcHRpb25zLCBlbmFibGVYZmEsIGRvY0Jhc2VVcmwpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLl9kb2NJZCA9IGRvY0lkOwogICAgdGhpcy5fcGFzc3dvcmQgPSBwYXNzd29yZDsKICAgIHRoaXMuX2RvY0Jhc2VVcmwgPSBwYXJzZURvY0Jhc2VVcmwoZG9jQmFzZVVybCk7CiAgICB0aGlzLm1zZ0hhbmRsZXIgPSBtc2dIYW5kbGVyOwogICAgdGhpcy5ldmFsdWF0b3JPcHRpb25zID0gZXZhbHVhdG9yT3B0aW9uczsKICAgIHRoaXMuZW5hYmxlWGZhID0gZW5hYmxlWGZhOwogICAgY29uc3Qgc3RyZWFtID0gbmV3IF9zdHJlYW0uU3RyZWFtKGRhdGEpOwogICAgdGhpcy5wZGZEb2N1bWVudCA9IG5ldyBfZG9jdW1lbnQuUERGRG9jdW1lbnQodGhpcywgc3RyZWFtKTsKICAgIHRoaXMuX2xvYWRlZFN0cmVhbVByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoc3RyZWFtKTsKICB9CgogIGFzeW5jIGVuc3VyZShvYmosIHByb3AsIGFyZ3MpIHsKICAgIGNvbnN0IHZhbHVlID0gb2JqW3Byb3BdOwoKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgcmV0dXJuIHZhbHVlLmFwcGx5KG9iaiwgYXJncyk7CiAgICB9CgogICAgcmV0dXJuIHZhbHVlOwogIH0KCiAgcmVxdWVzdFJhbmdlKGJlZ2luLCBlbmQpIHsKICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICB9CgogIHJlcXVlc3RMb2FkZWRTdHJlYW0oKSB7fQoKICBvbkxvYWRlZFN0cmVhbSgpIHsKICAgIHJldHVybiB0aGlzLl9sb2FkZWRTdHJlYW1Qcm9taXNlOwogIH0KCiAgdGVybWluYXRlKHJlYXNvbikge30KCn0KCmV4cG9ydHMuTG9jYWxQZGZNYW5hZ2VyID0gTG9jYWxQZGZNYW5hZ2VyOwoKY2xhc3MgTmV0d29ya1BkZk1hbmFnZXIgZXh0ZW5kcyBCYXNlUGRmTWFuYWdlciB7CiAgY29uc3RydWN0b3IoZG9jSWQsIHBkZk5ldHdvcmtTdHJlYW0sIGFyZ3MsIGV2YWx1YXRvck9wdGlvbnMsIGVuYWJsZVhmYSwgZG9jQmFzZVVybCkgewogICAgc3VwZXIoKTsKICAgIHRoaXMuX2RvY0lkID0gZG9jSWQ7CiAgICB0aGlzLl9wYXNzd29yZCA9IGFyZ3MucGFzc3dvcmQ7CiAgICB0aGlzLl9kb2NCYXNlVXJsID0gcGFyc2VEb2NCYXNlVXJsKGRvY0Jhc2VVcmwpOwogICAgdGhpcy5tc2dIYW5kbGVyID0gYXJncy5tc2dIYW5kbGVyOwogICAgdGhpcy5ldmFsdWF0b3JPcHRpb25zID0gZXZhbHVhdG9yT3B0aW9uczsKICAgIHRoaXMuZW5hYmxlWGZhID0gZW5hYmxlWGZhOwogICAgdGhpcy5zdHJlYW1NYW5hZ2VyID0gbmV3IF9jaHVua2VkX3N0cmVhbS5DaHVua2VkU3RyZWFtTWFuYWdlcihwZGZOZXR3b3JrU3RyZWFtLCB7CiAgICAgIG1zZ0hhbmRsZXI6IGFyZ3MubXNnSGFuZGxlciwKICAgICAgbGVuZ3RoOiBhcmdzLmxlbmd0aCwKICAgICAgZGlzYWJsZUF1dG9GZXRjaDogYXJncy5kaXNhYmxlQXV0b0ZldGNoLAogICAgICByYW5nZUNodW5rU2l6ZTogYXJncy5yYW5nZUNodW5rU2l6ZQogICAgfSk7CiAgICB0aGlzLnBkZkRvY3VtZW50ID0gbmV3IF9kb2N1bWVudC5QREZEb2N1bWVudCh0aGlzLCB0aGlzLnN0cmVhbU1hbmFnZXIuZ2V0U3RyZWFtKCkpOwogIH0KCiAgYXN5bmMgZW5zdXJlKG9iaiwgcHJvcCwgYXJncykgewogICAgdHJ5IHsKICAgICAgY29uc3QgdmFsdWUgPSBvYmpbcHJvcF07CgogICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlLmFwcGx5KG9iaiwgYXJncyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgIGlmICghKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pKSB7CiAgICAgICAgdGhyb3cgZXg7CiAgICAgIH0KCiAgICAgIGF3YWl0IHRoaXMucmVxdWVzdFJhbmdlKGV4LmJlZ2luLCBleC5lbmQpOwogICAgICByZXR1cm4gdGhpcy5lbnN1cmUob2JqLCBwcm9wLCBhcmdzKTsKICAgIH0KICB9CgogIHJlcXVlc3RSYW5nZShiZWdpbiwgZW5kKSB7CiAgICByZXR1cm4gdGhpcy5zdHJlYW1NYW5hZ2VyLnJlcXVlc3RSYW5nZShiZWdpbiwgZW5kKTsKICB9CgogIHJlcXVlc3RMb2FkZWRTdHJlYW0oKSB7CiAgICB0aGlzLnN0cmVhbU1hbmFnZXIucmVxdWVzdEFsbENodW5rcygpOwogIH0KCiAgc2VuZFByb2dyZXNzaXZlRGF0YShjaHVuaykgewogICAgdGhpcy5zdHJlYW1NYW5hZ2VyLm9uUmVjZWl2ZURhdGEoewogICAgICBjaHVuawogICAgfSk7CiAgfQoKICBvbkxvYWRlZFN0cmVhbSgpIHsKICAgIHJldHVybiB0aGlzLnN0cmVhbU1hbmFnZXIub25Mb2FkZWRTdHJlYW0oKTsKICB9CgogIHRlcm1pbmF0ZShyZWFzb24pIHsKICAgIHRoaXMuc3RyZWFtTWFuYWdlci5hYm9ydChyZWFzb24pOwogIH0KCn0KCmV4cG9ydHMuTmV0d29ya1BkZk1hbmFnZXIgPSBOZXR3b3JrUGRmTWFuYWdlcjsKCi8qKiovIH0pLAovKiAxMzQgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkNodW5rZWRTdHJlYW1NYW5hZ2VyID0gZXhwb3J0cy5DaHVua2VkU3RyZWFtID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMxKTsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzUpOwoKY2xhc3MgQ2h1bmtlZFN0cmVhbSBleHRlbmRzIF9zdHJlYW0uU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihsZW5ndGgsIGNodW5rU2l6ZSwgbWFuYWdlcikgewogICAgc3VwZXIobmV3IFVpbnQ4QXJyYXkobGVuZ3RoKSwgMCwgbGVuZ3RoLCBudWxsKTsKICAgIHRoaXMuY2h1bmtTaXplID0gY2h1bmtTaXplOwogICAgdGhpcy5fbG9hZGVkQ2h1bmtzID0gbmV3IFNldCgpOwogICAgdGhpcy5udW1DaHVua3MgPSBNYXRoLmNlaWwobGVuZ3RoIC8gY2h1bmtTaXplKTsKICAgIHRoaXMubWFuYWdlciA9IG1hbmFnZXI7CiAgICB0aGlzLnByb2dyZXNzaXZlRGF0YUxlbmd0aCA9IDA7CiAgICB0aGlzLmxhc3RTdWNjZXNzZnVsRW5zdXJlQnl0ZUNodW5rID0gLTE7CiAgfQoKICBnZXRNaXNzaW5nQ2h1bmtzKCkgewogICAgY29uc3QgY2h1bmtzID0gW107CgogICAgZm9yIChsZXQgY2h1bmsgPSAwLCBuID0gdGhpcy5udW1DaHVua3M7IGNodW5rIDwgbjsgKytjaHVuaykgewogICAgICBpZiAoIXRoaXMuX2xvYWRlZENodW5rcy5oYXMoY2h1bmspKSB7CiAgICAgICAgY2h1bmtzLnB1c2goY2h1bmspOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGNodW5rczsKICB9CgogIGdldCBudW1DaHVua3NMb2FkZWQoKSB7CiAgICByZXR1cm4gdGhpcy5fbG9hZGVkQ2h1bmtzLnNpemU7CiAgfQoKICBnZXQgaXNEYXRhTG9hZGVkKCkgewogICAgcmV0dXJuIHRoaXMubnVtQ2h1bmtzTG9hZGVkID09PSB0aGlzLm51bUNodW5rczsKICB9CgogIG9uUmVjZWl2ZURhdGEoYmVnaW4sIGNodW5rKSB7CiAgICBjb25zdCBjaHVua1NpemUgPSB0aGlzLmNodW5rU2l6ZTsKCiAgICBpZiAoYmVnaW4gJSBjaHVua1NpemUgIT09IDApIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBCYWQgYmVnaW4gb2Zmc2V0OiAke2JlZ2lufWApOwogICAgfQoKICAgIGNvbnN0IGVuZCA9IGJlZ2luICsgY2h1bmsuYnl0ZUxlbmd0aDsKCiAgICBpZiAoZW5kICUgY2h1bmtTaXplICE9PSAwICYmIGVuZCAhPT0gdGhpcy5ieXRlcy5sZW5ndGgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBCYWQgZW5kIG9mZnNldDogJHtlbmR9YCk7CiAgICB9CgogICAgdGhpcy5ieXRlcy5zZXQobmV3IFVpbnQ4QXJyYXkoY2h1bmspLCBiZWdpbik7CiAgICBjb25zdCBiZWdpbkNodW5rID0gTWF0aC5mbG9vcihiZWdpbiAvIGNodW5rU2l6ZSk7CiAgICBjb25zdCBlbmRDaHVuayA9IE1hdGguZmxvb3IoKGVuZCAtIDEpIC8gY2h1bmtTaXplKSArIDE7CgogICAgZm9yIChsZXQgY3VyQ2h1bmsgPSBiZWdpbkNodW5rOyBjdXJDaHVuayA8IGVuZENodW5rOyArK2N1ckNodW5rKSB7CiAgICAgIHRoaXMuX2xvYWRlZENodW5rcy5hZGQoY3VyQ2h1bmspOwogICAgfQogIH0KCiAgb25SZWNlaXZlUHJvZ3Jlc3NpdmVEYXRhKGRhdGEpIHsKICAgIGxldCBwb3NpdGlvbiA9IHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoOwogICAgY29uc3QgYmVnaW5DaHVuayA9IE1hdGguZmxvb3IocG9zaXRpb24gLyB0aGlzLmNodW5rU2l6ZSk7CiAgICB0aGlzLmJ5dGVzLnNldChuZXcgVWludDhBcnJheShkYXRhKSwgcG9zaXRpb24pOwogICAgcG9zaXRpb24gKz0gZGF0YS5ieXRlTGVuZ3RoOwogICAgdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGggPSBwb3NpdGlvbjsKICAgIGNvbnN0IGVuZENodW5rID0gcG9zaXRpb24gPj0gdGhpcy5lbmQgPyB0aGlzLm51bUNodW5rcyA6IE1hdGguZmxvb3IocG9zaXRpb24gLyB0aGlzLmNodW5rU2l6ZSk7CgogICAgZm9yIChsZXQgY3VyQ2h1bmsgPSBiZWdpbkNodW5rOyBjdXJDaHVuayA8IGVuZENodW5rOyArK2N1ckNodW5rKSB7CiAgICAgIHRoaXMuX2xvYWRlZENodW5rcy5hZGQoY3VyQ2h1bmspOwogICAgfQogIH0KCiAgZW5zdXJlQnl0ZShwb3MpIHsKICAgIGlmIChwb3MgPCB0aGlzLnByb2dyZXNzaXZlRGF0YUxlbmd0aCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgY2h1bmsgPSBNYXRoLmZsb29yKHBvcyAvIHRoaXMuY2h1bmtTaXplKTsKCiAgICBpZiAoY2h1bmsgPiB0aGlzLm51bUNodW5rcykgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGNodW5rID09PSB0aGlzLmxhc3RTdWNjZXNzZnVsRW5zdXJlQnl0ZUNodW5rKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoIXRoaXMuX2xvYWRlZENodW5rcy5oYXMoY2h1bmspKSB7CiAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbihwb3MsIHBvcyArIDEpOwogICAgfQoKICAgIHRoaXMubGFzdFN1Y2Nlc3NmdWxFbnN1cmVCeXRlQ2h1bmsgPSBjaHVuazsKICB9CgogIGVuc3VyZVJhbmdlKGJlZ2luLCBlbmQpIHsKICAgIGlmIChiZWdpbiA+PSBlbmQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChlbmQgPD0gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGgpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGJlZ2luQ2h1bmsgPSBNYXRoLmZsb29yKGJlZ2luIC8gdGhpcy5jaHVua1NpemUpOwoKICAgIGlmIChiZWdpbkNodW5rID4gdGhpcy5udW1DaHVua3MpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGVuZENodW5rID0gTWF0aC5taW4oTWF0aC5mbG9vcigoZW5kIC0gMSkgLyB0aGlzLmNodW5rU2l6ZSkgKyAxLCB0aGlzLm51bUNodW5rcyk7CgogICAgZm9yIChsZXQgY2h1bmsgPSBiZWdpbkNodW5rOyBjaHVuayA8IGVuZENodW5rOyArK2NodW5rKSB7CiAgICAgIGlmICghdGhpcy5fbG9hZGVkQ2h1bmtzLmhhcyhjaHVuaykpIHsKICAgICAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24oYmVnaW4sIGVuZCk7CiAgICAgIH0KICAgIH0KICB9CgogIG5leHRFbXB0eUNodW5rKGJlZ2luQ2h1bmspIHsKICAgIGNvbnN0IG51bUNodW5rcyA9IHRoaXMubnVtQ2h1bmtzOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtQ2h1bmtzOyArK2kpIHsKICAgICAgY29uc3QgY2h1bmsgPSAoYmVnaW5DaHVuayArIGkpICUgbnVtQ2h1bmtzOwoKICAgICAgaWYgKCF0aGlzLl9sb2FkZWRDaHVua3MuaGFzKGNodW5rKSkgewogICAgICAgIHJldHVybiBjaHVuazsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgaGFzQ2h1bmsoY2h1bmspIHsKICAgIHJldHVybiB0aGlzLl9sb2FkZWRDaHVua3MuaGFzKGNodW5rKTsKICB9CgogIGdldEJ5dGUoKSB7CiAgICBjb25zdCBwb3MgPSB0aGlzLnBvczsKCiAgICBpZiAocG9zID49IHRoaXMuZW5kKSB7CiAgICAgIHJldHVybiAtMTsKICAgIH0KCiAgICBpZiAocG9zID49IHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoKSB7CiAgICAgIHRoaXMuZW5zdXJlQnl0ZShwb3MpOwogICAgfQoKICAgIHJldHVybiB0aGlzLmJ5dGVzW3RoaXMucG9zKytdOwogIH0KCiAgZ2V0Qnl0ZXMobGVuZ3RoKSB7CiAgICBjb25zdCBieXRlcyA9IHRoaXMuYnl0ZXM7CiAgICBjb25zdCBwb3MgPSB0aGlzLnBvczsKICAgIGNvbnN0IHN0ckVuZCA9IHRoaXMuZW5kOwoKICAgIGlmICghbGVuZ3RoKSB7CiAgICAgIGlmIChzdHJFbmQgPiB0aGlzLnByb2dyZXNzaXZlRGF0YUxlbmd0aCkgewogICAgICAgIHRoaXMuZW5zdXJlUmFuZ2UocG9zLCBzdHJFbmQpOwogICAgICB9CgogICAgICByZXR1cm4gYnl0ZXMuc3ViYXJyYXkocG9zLCBzdHJFbmQpOwogICAgfQoKICAgIGxldCBlbmQgPSBwb3MgKyBsZW5ndGg7CgogICAgaWYgKGVuZCA+IHN0ckVuZCkgewogICAgICBlbmQgPSBzdHJFbmQ7CiAgICB9CgogICAgaWYgKGVuZCA+IHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoKSB7CiAgICAgIHRoaXMuZW5zdXJlUmFuZ2UocG9zLCBlbmQpOwogICAgfQoKICAgIHRoaXMucG9zID0gZW5kOwogICAgcmV0dXJuIGJ5dGVzLnN1YmFycmF5KHBvcywgZW5kKTsKICB9CgogIGdldEJ5dGVSYW5nZShiZWdpbiwgZW5kKSB7CiAgICBpZiAoYmVnaW4gPCAwKSB7CiAgICAgIGJlZ2luID0gMDsKICAgIH0KCiAgICBpZiAoZW5kID4gdGhpcy5lbmQpIHsKICAgICAgZW5kID0gdGhpcy5lbmQ7CiAgICB9CgogICAgaWYgKGVuZCA+IHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoKSB7CiAgICAgIHRoaXMuZW5zdXJlUmFuZ2UoYmVnaW4sIGVuZCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuYnl0ZXMuc3ViYXJyYXkoYmVnaW4sIGVuZCk7CiAgfQoKICBtYWtlU3ViU3RyZWFtKHN0YXJ0LCBsZW5ndGgpIHsKICAgIGxldCBkaWN0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBudWxsOwoKICAgIGlmIChsZW5ndGgpIHsKICAgICAgaWYgKHN0YXJ0ICsgbGVuZ3RoID4gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGgpIHsKICAgICAgICB0aGlzLmVuc3VyZVJhbmdlKHN0YXJ0LCBzdGFydCArIGxlbmd0aCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChzdGFydCA+PSB0aGlzLnByb2dyZXNzaXZlRGF0YUxlbmd0aCkgewogICAgICAgIHRoaXMuZW5zdXJlQnl0ZShzdGFydCk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBDaHVua2VkU3RyZWFtU3Vic3RyZWFtKCkge30KCiAgICBDaHVua2VkU3RyZWFtU3Vic3RyZWFtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUodGhpcyk7CgogICAgQ2h1bmtlZFN0cmVhbVN1YnN0cmVhbS5wcm90b3R5cGUuZ2V0TWlzc2luZ0NodW5rcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgY29uc3QgY2h1bmtTaXplID0gdGhpcy5jaHVua1NpemU7CiAgICAgIGNvbnN0IGJlZ2luQ2h1bmsgPSBNYXRoLmZsb29yKHRoaXMuc3RhcnQgLyBjaHVua1NpemUpOwogICAgICBjb25zdCBlbmRDaHVuayA9IE1hdGguZmxvb3IoKHRoaXMuZW5kIC0gMSkgLyBjaHVua1NpemUpICsgMTsKICAgICAgY29uc3QgbWlzc2luZ0NodW5rcyA9IFtdOwoKICAgICAgZm9yIChsZXQgY2h1bmsgPSBiZWdpbkNodW5rOyBjaHVuayA8IGVuZENodW5rOyArK2NodW5rKSB7CiAgICAgICAgaWYgKCF0aGlzLl9sb2FkZWRDaHVua3MuaGFzKGNodW5rKSkgewogICAgICAgICAgbWlzc2luZ0NodW5rcy5wdXNoKGNodW5rKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBtaXNzaW5nQ2h1bmtzOwogICAgfTsKCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ2h1bmtlZFN0cmVhbVN1YnN0cmVhbS5wcm90b3R5cGUsICJpc0RhdGFMb2FkZWQiLCB7CiAgICAgIGdldCgpIHsKICAgICAgICBpZiAodGhpcy5udW1DaHVua3NMb2FkZWQgPT09IHRoaXMubnVtQ2h1bmtzKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aGlzLmdldE1pc3NpbmdDaHVua3MoKS5sZW5ndGggPT09IDA7CiAgICAgIH0sCgogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0pOwogICAgY29uc3Qgc3ViU3RyZWFtID0gbmV3IENodW5rZWRTdHJlYW1TdWJzdHJlYW0oKTsKICAgIHN1YlN0cmVhbS5wb3MgPSBzdWJTdHJlYW0uc3RhcnQgPSBzdGFydDsKICAgIHN1YlN0cmVhbS5lbmQgPSBzdGFydCArIGxlbmd0aCB8fCB0aGlzLmVuZDsKICAgIHN1YlN0cmVhbS5kaWN0ID0gZGljdDsKICAgIHJldHVybiBzdWJTdHJlYW07CiAgfQoKICBnZXRCYXNlU3RyZWFtcygpIHsKICAgIHJldHVybiBbdGhpc107CiAgfQoKfQoKZXhwb3J0cy5DaHVua2VkU3RyZWFtID0gQ2h1bmtlZFN0cmVhbTsKCmNsYXNzIENodW5rZWRTdHJlYW1NYW5hZ2VyIHsKICBjb25zdHJ1Y3RvcihwZGZOZXR3b3JrU3RyZWFtLCBhcmdzKSB7CiAgICB0aGlzLmxlbmd0aCA9IGFyZ3MubGVuZ3RoOwogICAgdGhpcy5jaHVua1NpemUgPSBhcmdzLnJhbmdlQ2h1bmtTaXplOwogICAgdGhpcy5zdHJlYW0gPSBuZXcgQ2h1bmtlZFN0cmVhbSh0aGlzLmxlbmd0aCwgdGhpcy5jaHVua1NpemUsIHRoaXMpOwogICAgdGhpcy5wZGZOZXR3b3JrU3RyZWFtID0gcGRmTmV0d29ya1N0cmVhbTsKICAgIHRoaXMuZGlzYWJsZUF1dG9GZXRjaCA9IGFyZ3MuZGlzYWJsZUF1dG9GZXRjaDsKICAgIHRoaXMubXNnSGFuZGxlciA9IGFyZ3MubXNnSGFuZGxlcjsKICAgIHRoaXMuY3VyclJlcXVlc3RJZCA9IDA7CiAgICB0aGlzLl9jaHVua3NOZWVkZWRCeVJlcXVlc3QgPSBuZXcgTWFwKCk7CiAgICB0aGlzLl9yZXF1ZXN0c0J5Q2h1bmsgPSBuZXcgTWFwKCk7CiAgICB0aGlzLl9wcm9taXNlc0J5UmVxdWVzdCA9IG5ldyBNYXAoKTsKICAgIHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoID0gMDsKICAgIHRoaXMuYWJvcnRlZCA9IGZhbHNlOwogICAgdGhpcy5fbG9hZGVkU3RyZWFtQ2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICB9CgogIG9uTG9hZGVkU3RyZWFtKCkgewogICAgcmV0dXJuIHRoaXMuX2xvYWRlZFN0cmVhbUNhcGFiaWxpdHkucHJvbWlzZTsKICB9CgogIHNlbmRSZXF1ZXN0KGJlZ2luLCBlbmQpIHsKICAgIGNvbnN0IHJhbmdlUmVhZGVyID0gdGhpcy5wZGZOZXR3b3JrU3RyZWFtLmdldFJhbmdlUmVhZGVyKGJlZ2luLCBlbmQpOwoKICAgIGlmICghcmFuZ2VSZWFkZXIuaXNTdHJlYW1pbmdTdXBwb3J0ZWQpIHsKICAgICAgcmFuZ2VSZWFkZXIub25Qcm9ncmVzcyA9IHRoaXMub25Qcm9ncmVzcy5iaW5kKHRoaXMpOwogICAgfQoKICAgIGxldCBjaHVua3MgPSBbXSwKICAgICAgICBsb2FkZWQgPSAwOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgY29uc3QgcmVhZENodW5rID0gY2h1bmsgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBpZiAoIWNodW5rLmRvbmUpIHsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IGNodW5rLnZhbHVlOwogICAgICAgICAgICBjaHVua3MucHVzaChkYXRhKTsKICAgICAgICAgICAgbG9hZGVkICs9ICgwLCBfdXRpbC5hcnJheUJ5dGVMZW5ndGgpKGRhdGEpOwoKICAgICAgICAgICAgaWYgKHJhbmdlUmVhZGVyLmlzU3RyZWFtaW5nU3VwcG9ydGVkKSB7CiAgICAgICAgICAgICAgdGhpcy5vblByb2dyZXNzKHsKICAgICAgICAgICAgICAgIGxvYWRlZAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICByYW5nZVJlYWRlci5yZWFkKCkudGhlbihyZWFkQ2h1bmssIHJlamVjdCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBjaHVua0RhdGEgPSAoMCwgX3V0aWwuYXJyYXlzVG9CeXRlcykoY2h1bmtzKTsKICAgICAgICAgIGNodW5rcyA9IG51bGw7CiAgICAgICAgICByZXNvbHZlKGNodW5rRGF0YSk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgcmVqZWN0KGUpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHJhbmdlUmVhZGVyLnJlYWQoKS50aGVuKHJlYWRDaHVuaywgcmVqZWN0KTsKICAgIH0pLnRoZW4oZGF0YSA9PiB7CiAgICAgIGlmICh0aGlzLmFib3J0ZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMub25SZWNlaXZlRGF0YSh7CiAgICAgICAgY2h1bms6IGRhdGEsCiAgICAgICAgYmVnaW4KICAgICAgfSk7CiAgICB9KTsKICB9CgogIHJlcXVlc3RBbGxDaHVua3MoKSB7CiAgICBjb25zdCBtaXNzaW5nQ2h1bmtzID0gdGhpcy5zdHJlYW0uZ2V0TWlzc2luZ0NodW5rcygpOwoKICAgIHRoaXMuX3JlcXVlc3RDaHVua3MobWlzc2luZ0NodW5rcyk7CgogICAgcmV0dXJuIHRoaXMuX2xvYWRlZFN0cmVhbUNhcGFiaWxpdHkucHJvbWlzZTsKICB9CgogIF9yZXF1ZXN0Q2h1bmtzKGNodW5rcykgewogICAgY29uc3QgcmVxdWVzdElkID0gdGhpcy5jdXJyUmVxdWVzdElkKys7CiAgICBjb25zdCBjaHVua3NOZWVkZWQgPSBuZXcgU2V0KCk7CgogICAgdGhpcy5fY2h1bmtzTmVlZGVkQnlSZXF1ZXN0LnNldChyZXF1ZXN0SWQsIGNodW5rc05lZWRlZCk7CgogICAgZm9yIChjb25zdCBjaHVuayBvZiBjaHVua3MpIHsKICAgICAgaWYgKCF0aGlzLnN0cmVhbS5oYXNDaHVuayhjaHVuaykpIHsKICAgICAgICBjaHVua3NOZWVkZWQuYWRkKGNodW5rKTsKICAgICAgfQogICAgfQoKICAgIGlmIChjaHVua3NOZWVkZWQuc2l6ZSA9PT0gMCkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICB9CgogICAgY29uc3QgY2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKCiAgICB0aGlzLl9wcm9taXNlc0J5UmVxdWVzdC5zZXQocmVxdWVzdElkLCBjYXBhYmlsaXR5KTsKCiAgICBjb25zdCBjaHVua3NUb1JlcXVlc3QgPSBbXTsKCiAgICBmb3IgKGNvbnN0IGNodW5rIG9mIGNodW5rc05lZWRlZCkgewogICAgICBsZXQgcmVxdWVzdElkcyA9IHRoaXMuX3JlcXVlc3RzQnlDaHVuay5nZXQoY2h1bmspOwoKICAgICAgaWYgKCFyZXF1ZXN0SWRzKSB7CiAgICAgICAgcmVxdWVzdElkcyA9IFtdOwoKICAgICAgICB0aGlzLl9yZXF1ZXN0c0J5Q2h1bmsuc2V0KGNodW5rLCByZXF1ZXN0SWRzKTsKCiAgICAgICAgY2h1bmtzVG9SZXF1ZXN0LnB1c2goY2h1bmspOwogICAgICB9CgogICAgICByZXF1ZXN0SWRzLnB1c2gocmVxdWVzdElkKTsKICAgIH0KCiAgICBpZiAoY2h1bmtzVG9SZXF1ZXN0Lmxlbmd0aCA+IDApIHsKICAgICAgY29uc3QgZ3JvdXBlZENodW5rc1RvUmVxdWVzdCA9IHRoaXMuZ3JvdXBDaHVua3MoY2h1bmtzVG9SZXF1ZXN0KTsKCiAgICAgIGZvciAoY29uc3QgZ3JvdXBlZENodW5rIG9mIGdyb3VwZWRDaHVua3NUb1JlcXVlc3QpIHsKICAgICAgICBjb25zdCBiZWdpbiA9IGdyb3VwZWRDaHVuay5iZWdpbkNodW5rICogdGhpcy5jaHVua1NpemU7CiAgICAgICAgY29uc3QgZW5kID0gTWF0aC5taW4oZ3JvdXBlZENodW5rLmVuZENodW5rICogdGhpcy5jaHVua1NpemUsIHRoaXMubGVuZ3RoKTsKICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KGJlZ2luLCBlbmQpLmNhdGNoKGNhcGFiaWxpdHkucmVqZWN0KTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2UuY2F0Y2gocmVhc29uID0+IHsKICAgICAgaWYgKHRoaXMuYWJvcnRlZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhyb3cgcmVhc29uOwogICAgfSk7CiAgfQoKICBnZXRTdHJlYW0oKSB7CiAgICByZXR1cm4gdGhpcy5zdHJlYW07CiAgfQoKICByZXF1ZXN0UmFuZ2UoYmVnaW4sIGVuZCkgewogICAgZW5kID0gTWF0aC5taW4oZW5kLCB0aGlzLmxlbmd0aCk7CiAgICBjb25zdCBiZWdpbkNodW5rID0gdGhpcy5nZXRCZWdpbkNodW5rKGJlZ2luKTsKICAgIGNvbnN0IGVuZENodW5rID0gdGhpcy5nZXRFbmRDaHVuayhlbmQpOwogICAgY29uc3QgY2h1bmtzID0gW107CgogICAgZm9yIChsZXQgY2h1bmsgPSBiZWdpbkNodW5rOyBjaHVuayA8IGVuZENodW5rOyArK2NodW5rKSB7CiAgICAgIGNodW5rcy5wdXNoKGNodW5rKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdENodW5rcyhjaHVua3MpOwogIH0KCiAgcmVxdWVzdFJhbmdlcygpIHsKICAgIGxldCByYW5nZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFtdOwogICAgY29uc3QgY2h1bmtzVG9SZXF1ZXN0ID0gW107CgogICAgZm9yIChjb25zdCByYW5nZSBvZiByYW5nZXMpIHsKICAgICAgY29uc3QgYmVnaW5DaHVuayA9IHRoaXMuZ2V0QmVnaW5DaHVuayhyYW5nZS5iZWdpbik7CiAgICAgIGNvbnN0IGVuZENodW5rID0gdGhpcy5nZXRFbmRDaHVuayhyYW5nZS5lbmQpOwoKICAgICAgZm9yIChsZXQgY2h1bmsgPSBiZWdpbkNodW5rOyBjaHVuayA8IGVuZENodW5rOyArK2NodW5rKSB7CiAgICAgICAgaWYgKCFjaHVua3NUb1JlcXVlc3QuaW5jbHVkZXMoY2h1bmspKSB7CiAgICAgICAgICBjaHVua3NUb1JlcXVlc3QucHVzaChjaHVuayk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgY2h1bmtzVG9SZXF1ZXN0LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgcmV0dXJuIGEgLSBiOwogICAgfSk7CiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdENodW5rcyhjaHVua3NUb1JlcXVlc3QpOwogIH0KCiAgZ3JvdXBDaHVua3MoY2h1bmtzKSB7CiAgICBjb25zdCBncm91cGVkQ2h1bmtzID0gW107CiAgICBsZXQgYmVnaW5DaHVuayA9IC0xOwogICAgbGV0IHByZXZDaHVuayA9IC0xOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNodW5rcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIGNvbnN0IGNodW5rID0gY2h1bmtzW2ldOwoKICAgICAgaWYgKGJlZ2luQ2h1bmsgPCAwKSB7CiAgICAgICAgYmVnaW5DaHVuayA9IGNodW5rOwogICAgICB9CgogICAgICBpZiAocHJldkNodW5rID49IDAgJiYgcHJldkNodW5rICsgMSAhPT0gY2h1bmspIHsKICAgICAgICBncm91cGVkQ2h1bmtzLnB1c2goewogICAgICAgICAgYmVnaW5DaHVuaywKICAgICAgICAgIGVuZENodW5rOiBwcmV2Q2h1bmsgKyAxCiAgICAgICAgfSk7CiAgICAgICAgYmVnaW5DaHVuayA9IGNodW5rOwogICAgICB9CgogICAgICBpZiAoaSArIDEgPT09IGNodW5rcy5sZW5ndGgpIHsKICAgICAgICBncm91cGVkQ2h1bmtzLnB1c2goewogICAgICAgICAgYmVnaW5DaHVuaywKICAgICAgICAgIGVuZENodW5rOiBjaHVuayArIDEKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcHJldkNodW5rID0gY2h1bms7CiAgICB9CgogICAgcmV0dXJuIGdyb3VwZWRDaHVua3M7CiAgfQoKICBvblByb2dyZXNzKGFyZ3MpIHsKICAgIHRoaXMubXNnSGFuZGxlci5zZW5kKCJEb2NQcm9ncmVzcyIsIHsKICAgICAgbG9hZGVkOiB0aGlzLnN0cmVhbS5udW1DaHVua3NMb2FkZWQgKiB0aGlzLmNodW5rU2l6ZSArIGFyZ3MubG9hZGVkLAogICAgICB0b3RhbDogdGhpcy5sZW5ndGgKICAgIH0pOwogIH0KCiAgb25SZWNlaXZlRGF0YShhcmdzKSB7CiAgICBjb25zdCBjaHVuayA9IGFyZ3MuY2h1bms7CiAgICBjb25zdCBpc1Byb2dyZXNzaXZlID0gYXJncy5iZWdpbiA9PT0gdW5kZWZpbmVkOwogICAgY29uc3QgYmVnaW4gPSBpc1Byb2dyZXNzaXZlID8gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGggOiBhcmdzLmJlZ2luOwogICAgY29uc3QgZW5kID0gYmVnaW4gKyBjaHVuay5ieXRlTGVuZ3RoOwogICAgY29uc3QgYmVnaW5DaHVuayA9IE1hdGguZmxvb3IoYmVnaW4gLyB0aGlzLmNodW5rU2l6ZSk7CiAgICBjb25zdCBlbmRDaHVuayA9IGVuZCA8IHRoaXMubGVuZ3RoID8gTWF0aC5mbG9vcihlbmQgLyB0aGlzLmNodW5rU2l6ZSkgOiBNYXRoLmNlaWwoZW5kIC8gdGhpcy5jaHVua1NpemUpOwoKICAgIGlmIChpc1Byb2dyZXNzaXZlKSB7CiAgICAgIHRoaXMuc3RyZWFtLm9uUmVjZWl2ZVByb2dyZXNzaXZlRGF0YShjaHVuayk7CiAgICAgIHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoID0gZW5kOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zdHJlYW0ub25SZWNlaXZlRGF0YShiZWdpbiwgY2h1bmspOwogICAgfQoKICAgIGlmICh0aGlzLnN0cmVhbS5pc0RhdGFMb2FkZWQpIHsKICAgICAgdGhpcy5fbG9hZGVkU3RyZWFtQ2FwYWJpbGl0eS5yZXNvbHZlKHRoaXMuc3RyZWFtKTsKICAgIH0KCiAgICBjb25zdCBsb2FkZWRSZXF1ZXN0cyA9IFtdOwoKICAgIGZvciAobGV0IGN1ckNodW5rID0gYmVnaW5DaHVuazsgY3VyQ2h1bmsgPCBlbmRDaHVuazsgKytjdXJDaHVuaykgewogICAgICBjb25zdCByZXF1ZXN0SWRzID0gdGhpcy5fcmVxdWVzdHNCeUNodW5rLmdldChjdXJDaHVuayk7CgogICAgICBpZiAoIXJlcXVlc3RJZHMpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdGhpcy5fcmVxdWVzdHNCeUNodW5rLmRlbGV0ZShjdXJDaHVuayk7CgogICAgICBmb3IgKGNvbnN0IHJlcXVlc3RJZCBvZiByZXF1ZXN0SWRzKSB7CiAgICAgICAgY29uc3QgY2h1bmtzTmVlZGVkID0gdGhpcy5fY2h1bmtzTmVlZGVkQnlSZXF1ZXN0LmdldChyZXF1ZXN0SWQpOwoKICAgICAgICBpZiAoY2h1bmtzTmVlZGVkLmhhcyhjdXJDaHVuaykpIHsKICAgICAgICAgIGNodW5rc05lZWRlZC5kZWxldGUoY3VyQ2h1bmspOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNodW5rc05lZWRlZC5zaXplID4gMCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBsb2FkZWRSZXF1ZXN0cy5wdXNoKHJlcXVlc3RJZCk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXRoaXMuZGlzYWJsZUF1dG9GZXRjaCAmJiB0aGlzLl9yZXF1ZXN0c0J5Q2h1bmsuc2l6ZSA9PT0gMCkgewogICAgICBsZXQgbmV4dEVtcHR5Q2h1bms7CgogICAgICBpZiAodGhpcy5zdHJlYW0ubnVtQ2h1bmtzTG9hZGVkID09PSAxKSB7CiAgICAgICAgY29uc3QgbGFzdENodW5rID0gdGhpcy5zdHJlYW0ubnVtQ2h1bmtzIC0gMTsKCiAgICAgICAgaWYgKCF0aGlzLnN0cmVhbS5oYXNDaHVuayhsYXN0Q2h1bmspKSB7CiAgICAgICAgICBuZXh0RW1wdHlDaHVuayA9IGxhc3RDaHVuazsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV4dEVtcHR5Q2h1bmsgPSB0aGlzLnN0cmVhbS5uZXh0RW1wdHlDaHVuayhlbmRDaHVuayk7CiAgICAgIH0KCiAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKG5leHRFbXB0eUNodW5rKSkgewogICAgICAgIHRoaXMuX3JlcXVlc3RDaHVua3MoW25leHRFbXB0eUNodW5rXSk7CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGNvbnN0IHJlcXVlc3RJZCBvZiBsb2FkZWRSZXF1ZXN0cykgewogICAgICBjb25zdCBjYXBhYmlsaXR5ID0gdGhpcy5fcHJvbWlzZXNCeVJlcXVlc3QuZ2V0KHJlcXVlc3RJZCk7CgogICAgICB0aGlzLl9wcm9taXNlc0J5UmVxdWVzdC5kZWxldGUocmVxdWVzdElkKTsKCiAgICAgIGNhcGFiaWxpdHkucmVzb2x2ZSgpOwogICAgfQoKICAgIHRoaXMubXNnSGFuZGxlci5zZW5kKCJEb2NQcm9ncmVzcyIsIHsKICAgICAgbG9hZGVkOiB0aGlzLnN0cmVhbS5udW1DaHVua3NMb2FkZWQgKiB0aGlzLmNodW5rU2l6ZSwKICAgICAgdG90YWw6IHRoaXMubGVuZ3RoCiAgICB9KTsKICB9CgogIG9uRXJyb3IoZXJyKSB7CiAgICB0aGlzLl9sb2FkZWRTdHJlYW1DYXBhYmlsaXR5LnJlamVjdChlcnIpOwogIH0KCiAgZ2V0QmVnaW5DaHVuayhiZWdpbikgewogICAgcmV0dXJuIE1hdGguZmxvb3IoYmVnaW4gLyB0aGlzLmNodW5rU2l6ZSk7CiAgfQoKICBnZXRFbmRDaHVuayhlbmQpIHsKICAgIHJldHVybiBNYXRoLmZsb29yKChlbmQgLSAxKSAvIHRoaXMuY2h1bmtTaXplKSArIDE7CiAgfQoKICBhYm9ydChyZWFzb24pIHsKICAgIHRoaXMuYWJvcnRlZCA9IHRydWU7CgogICAgaWYgKHRoaXMucGRmTmV0d29ya1N0cmVhbSkgewogICAgICB0aGlzLnBkZk5ldHdvcmtTdHJlYW0uY2FuY2VsQWxsUmVxdWVzdHMocmVhc29uKTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGNhcGFiaWxpdHkgb2YgdGhpcy5fcHJvbWlzZXNCeVJlcXVlc3QudmFsdWVzKCkpIHsKICAgICAgY2FwYWJpbGl0eS5yZWplY3QocmVhc29uKTsKICAgIH0KICB9Cgp9CgpleHBvcnRzLkNodW5rZWRTdHJlYW1NYW5hZ2VyID0gQ2h1bmtlZFN0cmVhbU1hbmFnZXI7CgovKioqLyB9KSwKLyogMTM1ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5TdHJpbmdTdHJlYW0gPSBleHBvcnRzLlN0cmVhbSA9IGV4cG9ydHMuTnVsbFN0cmVhbSA9IHZvaWQgMDsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMik7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY2xhc3MgU3RyZWFtIGV4dGVuZHMgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0gewogIGNvbnN0cnVjdG9yKGFycmF5QnVmZmVyLCBzdGFydCwgbGVuZ3RoLCBkaWN0KSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5ieXRlcyA9IGFycmF5QnVmZmVyIGluc3RhbmNlb2YgVWludDhBcnJheSA/IGFycmF5QnVmZmVyIDogbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIpOwogICAgdGhpcy5zdGFydCA9IHN0YXJ0IHx8IDA7CiAgICB0aGlzLnBvcyA9IHRoaXMuc3RhcnQ7CiAgICB0aGlzLmVuZCA9IHN0YXJ0ICsgbGVuZ3RoIHx8IHRoaXMuYnl0ZXMubGVuZ3RoOwogICAgdGhpcy5kaWN0ID0gZGljdDsKICB9CgogIGdldCBsZW5ndGgoKSB7CiAgICByZXR1cm4gdGhpcy5lbmQgLSB0aGlzLnN0YXJ0OwogIH0KCiAgZ2V0IGlzRW1wdHkoKSB7CiAgICByZXR1cm4gdGhpcy5sZW5ndGggPT09IDA7CiAgfQoKICBnZXRCeXRlKCkgewogICAgaWYgKHRoaXMucG9zID49IHRoaXMuZW5kKSB7CiAgICAgIHJldHVybiAtMTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5ieXRlc1t0aGlzLnBvcysrXTsKICB9CgogIGdldEJ5dGVzKGxlbmd0aCkgewogICAgY29uc3QgYnl0ZXMgPSB0aGlzLmJ5dGVzOwogICAgY29uc3QgcG9zID0gdGhpcy5wb3M7CiAgICBjb25zdCBzdHJFbmQgPSB0aGlzLmVuZDsKCiAgICBpZiAoIWxlbmd0aCkgewogICAgICByZXR1cm4gYnl0ZXMuc3ViYXJyYXkocG9zLCBzdHJFbmQpOwogICAgfQoKICAgIGxldCBlbmQgPSBwb3MgKyBsZW5ndGg7CgogICAgaWYgKGVuZCA+IHN0ckVuZCkgewogICAgICBlbmQgPSBzdHJFbmQ7CiAgICB9CgogICAgdGhpcy5wb3MgPSBlbmQ7CiAgICByZXR1cm4gYnl0ZXMuc3ViYXJyYXkocG9zLCBlbmQpOwogIH0KCiAgZ2V0Qnl0ZVJhbmdlKGJlZ2luLCBlbmQpIHsKICAgIGlmIChiZWdpbiA8IDApIHsKICAgICAgYmVnaW4gPSAwOwogICAgfQoKICAgIGlmIChlbmQgPiB0aGlzLmVuZCkgewogICAgICBlbmQgPSB0aGlzLmVuZDsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5ieXRlcy5zdWJhcnJheShiZWdpbiwgZW5kKTsKICB9CgogIHJlc2V0KCkgewogICAgdGhpcy5wb3MgPSB0aGlzLnN0YXJ0OwogIH0KCiAgbW92ZVN0YXJ0KCkgewogICAgdGhpcy5zdGFydCA9IHRoaXMucG9zOwogIH0KCiAgbWFrZVN1YlN0cmVhbShzdGFydCwgbGVuZ3RoKSB7CiAgICBsZXQgZGljdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogbnVsbDsKICAgIHJldHVybiBuZXcgU3RyZWFtKHRoaXMuYnl0ZXMuYnVmZmVyLCBzdGFydCwgbGVuZ3RoLCBkaWN0KTsKICB9Cgp9CgpleHBvcnRzLlN0cmVhbSA9IFN0cmVhbTsKCmNsYXNzIFN0cmluZ1N0cmVhbSBleHRlbmRzIFN0cmVhbSB7CiAgY29uc3RydWN0b3Ioc3RyKSB7CiAgICBzdXBlcigoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoc3RyKSk7CiAgfQoKfQoKZXhwb3J0cy5TdHJpbmdTdHJlYW0gPSBTdHJpbmdTdHJlYW07CgpjbGFzcyBOdWxsU3RyZWFtIGV4dGVuZHMgU3RyZWFtIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKG5ldyBVaW50OEFycmF5KDApKTsKICB9Cgp9CgpleHBvcnRzLk51bGxTdHJlYW0gPSBOdWxsU3RyZWFtOwoKLyoqKi8gfSksCi8qIDEzNiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuUGFnZSA9IGV4cG9ydHMuUERGRG9jdW1lbnQgPSB2b2lkIDA7Cgp2YXIgX2Fubm90YXRpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzNyk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwoKdmFyIF94ZmFfZm9udHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3Nik7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzIpOwoKdmFyIF9jcnlwdG8gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5Mik7Cgp2YXIgX2NhdGFsb2cgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5NCk7Cgp2YXIgX2NsZWFudXBfaGVscGVyID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTYpOwoKdmFyIF9kYXRhc2V0X3JlYWRlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMjI1KTsKCnZhciBfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDIpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzNSk7Cgp2YXIgX29iamVjdF9sb2FkZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMCk7Cgp2YXIgX29wZXJhdG9yX2xpc3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE4Nyk7Cgp2YXIgX2V2YWx1YXRvciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQwKTsKCnZhciBfZGVjb2RlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ0KTsKCnZhciBfc3RydWN0X3RyZWUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5OSk7Cgp2YXIgX3dyaXRlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkwKTsKCnZhciBfZmFjdG9yeSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAxKTsKCnZhciBfeHJlZiA9IF9fd19wZGZqc19yZXF1aXJlX18oMjI2KTsKCmNvbnN0IERFRkFVTFRfVVNFUl9VTklUID0gMS4wOwpjb25zdCBMRVRURVJfU0laRV9NRURJQUJPWCA9IFswLCAwLCA2MTIsIDc5Ml07CgpjbGFzcyBQYWdlIHsKICBjb25zdHJ1Y3RvcihfcmVmKSB7CiAgICBsZXQgewogICAgICBwZGZNYW5hZ2VyLAogICAgICB4cmVmLAogICAgICBwYWdlSW5kZXgsCiAgICAgIHBhZ2VEaWN0LAogICAgICByZWYsCiAgICAgIGdsb2JhbElkRmFjdG9yeSwKICAgICAgZm9udENhY2hlLAogICAgICBidWlsdEluQ01hcENhY2hlLAogICAgICBzdGFuZGFyZEZvbnREYXRhQ2FjaGUsCiAgICAgIGdsb2JhbEltYWdlQ2FjaGUsCiAgICAgIG5vbkJsZW5kTW9kZXNTZXQsCiAgICAgIHhmYUZhY3RvcnkKICAgIH0gPSBfcmVmOwogICAgdGhpcy5wZGZNYW5hZ2VyID0gcGRmTWFuYWdlcjsKICAgIHRoaXMucGFnZUluZGV4ID0gcGFnZUluZGV4OwogICAgdGhpcy5wYWdlRGljdCA9IHBhZ2VEaWN0OwogICAgdGhpcy54cmVmID0geHJlZjsKICAgIHRoaXMucmVmID0gcmVmOwogICAgdGhpcy5mb250Q2FjaGUgPSBmb250Q2FjaGU7CiAgICB0aGlzLmJ1aWx0SW5DTWFwQ2FjaGUgPSBidWlsdEluQ01hcENhY2hlOwogICAgdGhpcy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUgPSBzdGFuZGFyZEZvbnREYXRhQ2FjaGU7CiAgICB0aGlzLmdsb2JhbEltYWdlQ2FjaGUgPSBnbG9iYWxJbWFnZUNhY2hlOwogICAgdGhpcy5ub25CbGVuZE1vZGVzU2V0ID0gbm9uQmxlbmRNb2Rlc1NldDsKICAgIHRoaXMuZXZhbHVhdG9yT3B0aW9ucyA9IHBkZk1hbmFnZXIuZXZhbHVhdG9yT3B0aW9uczsKICAgIHRoaXMucmVzb3VyY2VzUHJvbWlzZSA9IG51bGw7CiAgICB0aGlzLnhmYUZhY3RvcnkgPSB4ZmFGYWN0b3J5OwogICAgY29uc3QgaWRDb3VudGVycyA9IHsKICAgICAgb2JqOiAwCiAgICB9OwogICAgdGhpcy5fbG9jYWxJZEZhY3RvcnkgPSBjbGFzcyBleHRlbmRzIGdsb2JhbElkRmFjdG9yeSB7CiAgICAgIHN0YXRpYyBjcmVhdGVPYmpJZCgpIHsKICAgICAgICByZXR1cm4gYHAke3BhZ2VJbmRleH1fJHsrK2lkQ291bnRlcnMub2JqfWA7CiAgICAgIH0KCiAgICAgIHN0YXRpYyBnZXRQYWdlT2JqSWQoKSB7CiAgICAgICAgcmV0dXJuIGBwYWdlJHtyZWYudG9TdHJpbmcoKX1gOwogICAgICB9CgogICAgfTsKICB9CgogIF9nZXRJbmhlcml0YWJsZVByb3BlcnR5KGtleSkgewogICAgbGV0IGdldEFycmF5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAgIGNvbnN0IHZhbHVlID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdDogdGhpcy5wYWdlRGljdCwKICAgICAga2V5LAogICAgICBnZXRBcnJheSwKICAgICAgc3RvcFdoZW5Gb3VuZDogZmFsc2UKICAgIH0pOwoKICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQoKICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDEgfHwgISh2YWx1ZVswXSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiB2YWx1ZVswXTsKICAgIH0KCiAgICByZXR1cm4gX3ByaW1pdGl2ZXMuRGljdC5tZXJnZSh7CiAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgZGljdEFycmF5OiB2YWx1ZQogICAgfSk7CiAgfQoKICBnZXQgY29udGVudCgpIHsKICAgIHJldHVybiB0aGlzLnBhZ2VEaWN0LmdldEFycmF5KCJDb250ZW50cyIpOwogIH0KCiAgZ2V0IHJlc291cmNlcygpIHsKICAgIGNvbnN0IHJlc291cmNlcyA9IHRoaXMuX2dldEluaGVyaXRhYmxlUHJvcGVydHkoIlJlc291cmNlcyIpOwoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAicmVzb3VyY2VzIiwgcmVzb3VyY2VzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCA/IHJlc291cmNlcyA6IF9wcmltaXRpdmVzLkRpY3QuZW1wdHkpOwogIH0KCiAgX2dldEJvdW5kaW5nQm94KG5hbWUpIHsKICAgIGlmICh0aGlzLnhmYURhdGEpIHsKICAgICAgcmV0dXJuIHRoaXMueGZhRGF0YS5iYm94OwogICAgfQoKICAgIGNvbnN0IGJveCA9IHRoaXMuX2dldEluaGVyaXRhYmxlUHJvcGVydHkobmFtZSwgdHJ1ZSk7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoYm94KSAmJiBib3gubGVuZ3RoID09PSA0KSB7CiAgICAgIGlmIChib3hbMl0gLSBib3hbMF0gIT09IDAgJiYgYm94WzNdIC0gYm94WzFdICE9PSAwKSB7CiAgICAgICAgcmV0dXJuIGJveDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGBFbXB0eSAvJHtuYW1lfSBlbnRyeS5gKTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGdldCBtZWRpYUJveCgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAibWVkaWFCb3giLCB0aGlzLl9nZXRCb3VuZGluZ0JveCgiTWVkaWFCb3giKSB8fCBMRVRURVJfU0laRV9NRURJQUJPWCk7CiAgfQoKICBnZXQgY3JvcEJveCgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiY3JvcEJveCIsIHRoaXMuX2dldEJvdW5kaW5nQm94KCJDcm9wQm94IikgfHwgdGhpcy5tZWRpYUJveCk7CiAgfQoKICBnZXQgdXNlclVuaXQoKSB7CiAgICBsZXQgb2JqID0gdGhpcy5wYWdlRGljdC5nZXQoIlVzZXJVbml0Iik7CgogICAgaWYgKHR5cGVvZiBvYmogIT09ICJudW1iZXIiIHx8IG9iaiA8PSAwKSB7CiAgICAgIG9iaiA9IERFRkFVTFRfVVNFUl9VTklUOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAidXNlclVuaXQiLCBvYmopOwogIH0KCiAgZ2V0IHZpZXcoKSB7CiAgICBjb25zdCB7CiAgICAgIGNyb3BCb3gsCiAgICAgIG1lZGlhQm94CiAgICB9ID0gdGhpczsKICAgIGxldCB2aWV3OwoKICAgIGlmIChjcm9wQm94ID09PSBtZWRpYUJveCB8fCAoMCwgX3V0aWwuaXNBcnJheUVxdWFsKShjcm9wQm94LCBtZWRpYUJveCkpIHsKICAgICAgdmlldyA9IG1lZGlhQm94OwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgYm94ID0gX3V0aWwuVXRpbC5pbnRlcnNlY3QoY3JvcEJveCwgbWVkaWFCb3gpOwoKICAgICAgaWYgKGJveCAmJiBib3hbMl0gLSBib3hbMF0gIT09IDAgJiYgYm94WzNdIC0gYm94WzFdICE9PSAwKSB7CiAgICAgICAgdmlldyA9IGJveDsKICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIkVtcHR5IC9Dcm9wQm94IGFuZCAvTWVkaWFCb3ggaW50ZXJzZWN0aW9uLiIpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ2aWV3IiwgdmlldyB8fCBtZWRpYUJveCk7CiAgfQoKICBnZXQgcm90YXRlKCkgewogICAgbGV0IHJvdGF0ZSA9IHRoaXMuX2dldEluaGVyaXRhYmxlUHJvcGVydHkoIlJvdGF0ZSIpIHx8IDA7CgogICAgaWYgKHJvdGF0ZSAlIDkwICE9PSAwKSB7CiAgICAgIHJvdGF0ZSA9IDA7CiAgICB9IGVsc2UgaWYgKHJvdGF0ZSA+PSAzNjApIHsKICAgICAgcm90YXRlICU9IDM2MDsKICAgIH0gZWxzZSBpZiAocm90YXRlIDwgMCkgewogICAgICByb3RhdGUgPSAocm90YXRlICUgMzYwICsgMzYwKSAlIDM2MDsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInJvdGF0ZSIsIHJvdGF0ZSk7CiAgfQoKICBfb25TdWJTdHJlYW1FcnJvcihoYW5kbGVyLCByZWFzb24sIG9iaklkKSB7CiAgICBpZiAodGhpcy5ldmFsdWF0b3JPcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICBoYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLmVycm9yQ29udGVudFN1YlN0cmVhbQogICAgICB9KTsKICAgICAgKDAsIF91dGlsLndhcm4pKGBnZXRDb250ZW50U3RyZWFtIC0gaWdub3Jpbmcgc3ViLXN0cmVhbSAoJHtvYmpJZH0pOiAiJHtyZWFzb259Ii5gKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRocm93IHJlYXNvbjsKICB9CgogIGdldENvbnRlbnRTdHJlYW0oaGFuZGxlcikgewogICAgcmV0dXJuIHRoaXMucGRmTWFuYWdlci5lbnN1cmUodGhpcywgImNvbnRlbnQiKS50aGVuKGNvbnRlbnQgPT4gewogICAgICBpZiAoY29udGVudCBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7CiAgICAgIH0KCiAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbnRlbnQpKSB7CiAgICAgICAgcmV0dXJuIG5ldyBfZGVjb2RlX3N0cmVhbS5TdHJlYW1zU2VxdWVuY2VTdHJlYW0oY29udGVudCwgdGhpcy5fb25TdWJTdHJlYW1FcnJvci5iaW5kKHRoaXMsIGhhbmRsZXIpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBfc3RyZWFtLk51bGxTdHJlYW0oKTsKICAgIH0pOwogIH0KCiAgZ2V0IHhmYURhdGEoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInhmYURhdGEiLCB0aGlzLnhmYUZhY3RvcnkgPyB7CiAgICAgIGJib3g6IHRoaXMueGZhRmFjdG9yeS5nZXRCb3VuZGluZ0JveCh0aGlzLnBhZ2VJbmRleCkKICAgIH0gOiBudWxsKTsKICB9CgogIGFzeW5jIHNhdmVOZXdBbm5vdGF0aW9ucyhoYW5kbGVyLCB0YXNrLCBhbm5vdGF0aW9ucykgewogICAgaWYgKHRoaXMueGZhRmFjdG9yeSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIlhGQTogQ2Fubm90IHNhdmUgbmV3IGFubm90YXRpb25zLiIpOwogICAgfQoKICAgIGNvbnN0IHBhcnRpYWxFdmFsdWF0b3IgPSBuZXcgX2V2YWx1YXRvci5QYXJ0aWFsRXZhbHVhdG9yKHsKICAgICAgeHJlZjogdGhpcy54cmVmLAogICAgICBoYW5kbGVyLAogICAgICBwYWdlSW5kZXg6IHRoaXMucGFnZUluZGV4LAogICAgICBpZEZhY3Rvcnk6IHRoaXMuX2xvY2FsSWRGYWN0b3J5LAogICAgICBmb250Q2FjaGU6IHRoaXMuZm9udENhY2hlLAogICAgICBidWlsdEluQ01hcENhY2hlOiB0aGlzLmJ1aWx0SW5DTWFwQ2FjaGUsCiAgICAgIHN0YW5kYXJkRm9udERhdGFDYWNoZTogdGhpcy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUsCiAgICAgIGdsb2JhbEltYWdlQ2FjaGU6IHRoaXMuZ2xvYmFsSW1hZ2VDYWNoZSwKICAgICAgb3B0aW9uczogdGhpcy5ldmFsdWF0b3JPcHRpb25zCiAgICB9KTsKICAgIGNvbnN0IHBhZ2VEaWN0ID0gdGhpcy5wYWdlRGljdDsKICAgIGNvbnN0IGFubm90YXRpb25zQXJyYXkgPSB0aGlzLmFubm90YXRpb25zLnNsaWNlKCk7CiAgICBjb25zdCBuZXdEYXRhID0gYXdhaXQgX2Fubm90YXRpb24uQW5ub3RhdGlvbkZhY3Rvcnkuc2F2ZU5ld0Fubm90YXRpb25zKHBhcnRpYWxFdmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25zKTsKCiAgICBmb3IgKGNvbnN0IHsKICAgICAgcmVmCiAgICB9IG9mIG5ld0RhdGEuYW5ub3RhdGlvbnMpIHsKICAgICAgYW5ub3RhdGlvbnNBcnJheS5wdXNoKHJlZik7CiAgICB9CgogICAgY29uc3Qgc2F2ZWREaWN0ID0gcGFnZURpY3QuZ2V0KCJBbm5vdHMiKTsKICAgIHBhZ2VEaWN0LnNldCgiQW5ub3RzIiwgYW5ub3RhdGlvbnNBcnJheSk7CiAgICBjb25zdCBidWZmZXIgPSBbXTsKICAgIGxldCB0cmFuc2Zvcm0gPSBudWxsOwoKICAgIGlmICh0aGlzLnhyZWYuZW5jcnlwdCkgewogICAgICB0cmFuc2Zvcm0gPSB0aGlzLnhyZWYuZW5jcnlwdC5jcmVhdGVDaXBoZXJUcmFuc2Zvcm0odGhpcy5yZWYubnVtLCB0aGlzLnJlZi5nZW4pOwogICAgfQoKICAgICgwLCBfd3JpdGVyLndyaXRlT2JqZWN0KSh0aGlzLnJlZiwgcGFnZURpY3QsIGJ1ZmZlciwgdHJhbnNmb3JtKTsKCiAgICBpZiAoc2F2ZWREaWN0KSB7CiAgICAgIHBhZ2VEaWN0LnNldCgiQW5ub3RzIiwgc2F2ZWREaWN0KTsKICAgIH0KCiAgICBjb25zdCBvYmplY3RzID0gbmV3RGF0YS5kZXBlbmRlbmNpZXM7CiAgICBvYmplY3RzLnB1c2goewogICAgICByZWY6IHRoaXMucmVmLAogICAgICBkYXRhOiBidWZmZXIuam9pbigiIikKICAgIH0sIC4uLm5ld0RhdGEuYW5ub3RhdGlvbnMpOwogICAgcmV0dXJuIG9iamVjdHM7CiAgfQoKICBzYXZlKGhhbmRsZXIsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBjb25zdCBwYXJ0aWFsRXZhbHVhdG9yID0gbmV3IF9ldmFsdWF0b3IuUGFydGlhbEV2YWx1YXRvcih7CiAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgaGFuZGxlciwKICAgICAgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleCwKICAgICAgaWRGYWN0b3J5OiB0aGlzLl9sb2NhbElkRmFjdG9yeSwKICAgICAgZm9udENhY2hlOiB0aGlzLmZvbnRDYWNoZSwKICAgICAgYnVpbHRJbkNNYXBDYWNoZTogdGhpcy5idWlsdEluQ01hcENhY2hlLAogICAgICBzdGFuZGFyZEZvbnREYXRhQ2FjaGU6IHRoaXMuc3RhbmRhcmRGb250RGF0YUNhY2hlLAogICAgICBnbG9iYWxJbWFnZUNhY2hlOiB0aGlzLmdsb2JhbEltYWdlQ2FjaGUsCiAgICAgIG9wdGlvbnM6IHRoaXMuZXZhbHVhdG9yT3B0aW9ucwogICAgfSk7CiAgICByZXR1cm4gdGhpcy5fcGFyc2VkQW5ub3RhdGlvbnMudGhlbihmdW5jdGlvbiAoYW5ub3RhdGlvbnMpIHsKICAgICAgY29uc3QgbmV3UmVmc1Byb21pc2VzID0gW107CgogICAgICBmb3IgKGNvbnN0IGFubm90YXRpb24gb2YgYW5ub3RhdGlvbnMpIHsKICAgICAgICBpZiAoIWFubm90YXRpb24ubXVzdEJlUHJpbnRlZChhbm5vdGF0aW9uU3RvcmFnZSkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgbmV3UmVmc1Byb21pc2VzLnB1c2goYW5ub3RhdGlvbi5zYXZlKHBhcnRpYWxFdmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoInNhdmUgLSBpZ25vcmluZyBhbm5vdGF0aW9uIGRhdGEgZHVyaW5nICIgKyBgIiR7dGFzay5uYW1lfSIgdGFzazogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9KSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBQcm9taXNlLmFsbChuZXdSZWZzUHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKG5ld1JlZnMpIHsKICAgICAgICByZXR1cm4gbmV3UmVmcy5maWx0ZXIobmV3UmVmID0+ICEhbmV3UmVmKTsKICAgICAgfSk7CiAgICB9KTsKICB9CgogIGxvYWRSZXNvdXJjZXMoa2V5cykgewogICAgaWYgKCF0aGlzLnJlc291cmNlc1Byb21pc2UpIHsKICAgICAgdGhpcy5yZXNvdXJjZXNQcm9taXNlID0gdGhpcy5wZGZNYW5hZ2VyLmVuc3VyZSh0aGlzLCAicmVzb3VyY2VzIik7CiAgICB9CgogICAgcmV0dXJuIHRoaXMucmVzb3VyY2VzUHJvbWlzZS50aGVuKCgpID0+IHsKICAgICAgY29uc3Qgb2JqZWN0TG9hZGVyID0gbmV3IF9vYmplY3RfbG9hZGVyLk9iamVjdExvYWRlcih0aGlzLnJlc291cmNlcywga2V5cywgdGhpcy54cmVmKTsKICAgICAgcmV0dXJuIG9iamVjdExvYWRlci5sb2FkKCk7CiAgICB9KTsKICB9CgogIGdldE9wZXJhdG9yTGlzdChfcmVmMikgewogICAgbGV0IHsKICAgICAgaGFuZGxlciwKICAgICAgc2luaywKICAgICAgdGFzaywKICAgICAgaW50ZW50LAogICAgICBjYWNoZUtleSwKICAgICAgYW5ub3RhdGlvblN0b3JhZ2UgPSBudWxsCiAgICB9ID0gX3JlZjI7CiAgICBjb25zdCBjb250ZW50U3RyZWFtUHJvbWlzZSA9IHRoaXMuZ2V0Q29udGVudFN0cmVhbShoYW5kbGVyKTsKICAgIGNvbnN0IHJlc291cmNlc1Byb21pc2UgPSB0aGlzLmxvYWRSZXNvdXJjZXMoWyJDb2xvclNwYWNlIiwgIkV4dEdTdGF0ZSIsICJGb250IiwgIlBhdHRlcm4iLCAiUHJvcGVydGllcyIsICJTaGFkaW5nIiwgIlhPYmplY3QiXSk7CiAgICBjb25zdCBwYXJ0aWFsRXZhbHVhdG9yID0gbmV3IF9ldmFsdWF0b3IuUGFydGlhbEV2YWx1YXRvcih7CiAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgaGFuZGxlciwKICAgICAgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleCwKICAgICAgaWRGYWN0b3J5OiB0aGlzLl9sb2NhbElkRmFjdG9yeSwKICAgICAgZm9udENhY2hlOiB0aGlzLmZvbnRDYWNoZSwKICAgICAgYnVpbHRJbkNNYXBDYWNoZTogdGhpcy5idWlsdEluQ01hcENhY2hlLAogICAgICBzdGFuZGFyZEZvbnREYXRhQ2FjaGU6IHRoaXMuc3RhbmRhcmRGb250RGF0YUNhY2hlLAogICAgICBnbG9iYWxJbWFnZUNhY2hlOiB0aGlzLmdsb2JhbEltYWdlQ2FjaGUsCiAgICAgIG9wdGlvbnM6IHRoaXMuZXZhbHVhdG9yT3B0aW9ucwogICAgfSk7CiAgICBjb25zdCBuZXdBbm5vdGF0aW9uc0J5UGFnZSA9ICF0aGlzLnhmYUZhY3RvcnkgPyAoMCwgX2NvcmVfdXRpbHMuZ2V0TmV3QW5ub3RhdGlvbnNNYXApKGFubm90YXRpb25TdG9yYWdlKSA6IG51bGw7CiAgICBsZXQgbmV3QW5ub3RhdGlvbnNQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKG51bGwpOwoKICAgIGlmIChuZXdBbm5vdGF0aW9uc0J5UGFnZSkgewogICAgICBjb25zdCBuZXdBbm5vdGF0aW9ucyA9IG5ld0Fubm90YXRpb25zQnlQYWdlLmdldCh0aGlzLnBhZ2VJbmRleCk7CgogICAgICBpZiAobmV3QW5ub3RhdGlvbnMpIHsKICAgICAgICBuZXdBbm5vdGF0aW9uc1Byb21pc2UgPSBfYW5ub3RhdGlvbi5Bbm5vdGF0aW9uRmFjdG9yeS5wcmludE5ld0Fubm90YXRpb25zKHBhcnRpYWxFdmFsdWF0b3IsIHRhc2ssIG5ld0Fubm90YXRpb25zKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGRhdGFQcm9taXNlcyA9IFByb21pc2UuYWxsKFtjb250ZW50U3RyZWFtUHJvbWlzZSwgcmVzb3VyY2VzUHJvbWlzZV0pOwogICAgY29uc3QgcGFnZUxpc3RQcm9taXNlID0gZGF0YVByb21pc2VzLnRoZW4oX3JlZjMgPT4gewogICAgICBsZXQgW2NvbnRlbnRTdHJlYW1dID0gX3JlZjM7CiAgICAgIGNvbnN0IG9wTGlzdCA9IG5ldyBfb3BlcmF0b3JfbGlzdC5PcGVyYXRvckxpc3QoaW50ZW50LCBzaW5rKTsKICAgICAgaGFuZGxlci5zZW5kKCJTdGFydFJlbmRlclBhZ2UiLCB7CiAgICAgICAgdHJhbnNwYXJlbmN5OiBwYXJ0aWFsRXZhbHVhdG9yLmhhc0JsZW5kTW9kZXModGhpcy5yZXNvdXJjZXMsIHRoaXMubm9uQmxlbmRNb2Rlc1NldCksCiAgICAgICAgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleCwKICAgICAgICBjYWNoZUtleQogICAgICB9KTsKICAgICAgcmV0dXJuIHBhcnRpYWxFdmFsdWF0b3IuZ2V0T3BlcmF0b3JMaXN0KHsKICAgICAgICBzdHJlYW06IGNvbnRlbnRTdHJlYW0sCiAgICAgICAgdGFzaywKICAgICAgICByZXNvdXJjZXM6IHRoaXMucmVzb3VyY2VzLAogICAgICAgIG9wZXJhdG9yTGlzdDogb3BMaXN0CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBvcExpc3Q7CiAgICAgIH0pOwogICAgfSk7CiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3BhZ2VMaXN0UHJvbWlzZSwgdGhpcy5fcGFyc2VkQW5ub3RhdGlvbnMsIG5ld0Fubm90YXRpb25zUHJvbWlzZV0pLnRoZW4oZnVuY3Rpb24gKF9yZWY0KSB7CiAgICAgIGxldCBbcGFnZU9wTGlzdCwgYW5ub3RhdGlvbnMsIG5ld0Fubm90YXRpb25zXSA9IF9yZWY0OwoKICAgICAgaWYgKG5ld0Fubm90YXRpb25zKSB7CiAgICAgICAgYW5ub3RhdGlvbnMgPSBhbm5vdGF0aW9ucy5jb25jYXQobmV3QW5ub3RhdGlvbnMpOwogICAgICB9CgogICAgICBpZiAoYW5ub3RhdGlvbnMubGVuZ3RoID09PSAwIHx8IGludGVudCAmIF91dGlsLlJlbmRlcmluZ0ludGVudEZsYWcuQU5OT1RBVElPTlNfRElTQUJMRSkgewogICAgICAgIHBhZ2VPcExpc3QuZmx1c2godHJ1ZSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGxlbmd0aDogcGFnZU9wTGlzdC50b3RhbExlbmd0aAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlbmRlckZvcm1zID0gISEoaW50ZW50ICYgX3V0aWwuUmVuZGVyaW5nSW50ZW50RmxhZy5BTk5PVEFUSU9OU19GT1JNUyksCiAgICAgICAgICAgIGludGVudEFueSA9ICEhKGludGVudCAmIF91dGlsLlJlbmRlcmluZ0ludGVudEZsYWcuQU5ZKSwKICAgICAgICAgICAgaW50ZW50RGlzcGxheSA9ICEhKGludGVudCAmIF91dGlsLlJlbmRlcmluZ0ludGVudEZsYWcuRElTUExBWSksCiAgICAgICAgICAgIGludGVudFByaW50ID0gISEoaW50ZW50ICYgX3V0aWwuUmVuZGVyaW5nSW50ZW50RmxhZy5QUklOVCk7CiAgICAgIGNvbnN0IG9wTGlzdFByb21pc2VzID0gW107CgogICAgICBmb3IgKGNvbnN0IGFubm90YXRpb24gb2YgYW5ub3RhdGlvbnMpIHsKICAgICAgICBpZiAoaW50ZW50QW55IHx8IGludGVudERpc3BsYXkgJiYgYW5ub3RhdGlvbi5tdXN0QmVWaWV3ZWQoYW5ub3RhdGlvblN0b3JhZ2UpIHx8IGludGVudFByaW50ICYmIGFubm90YXRpb24ubXVzdEJlUHJpbnRlZChhbm5vdGF0aW9uU3RvcmFnZSkpIHsKICAgICAgICAgIG9wTGlzdFByb21pc2VzLnB1c2goYW5ub3RhdGlvbi5nZXRPcGVyYXRvckxpc3QocGFydGlhbEV2YWx1YXRvciwgdGFzaywgaW50ZW50LCByZW5kZXJGb3JtcywgYW5ub3RhdGlvblN0b3JhZ2UpLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJnZXRPcGVyYXRvckxpc3QgLSBpZ25vcmluZyBhbm5vdGF0aW9uIGRhdGEgZHVyaW5nICIgKyBgIiR7dGFzay5uYW1lfSIgdGFzazogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIFByb21pc2UuYWxsKG9wTGlzdFByb21pc2VzKS50aGVuKGZ1bmN0aW9uIChvcExpc3RzKSB7CiAgICAgICAgbGV0IGZvcm0gPSBmYWxzZSwKICAgICAgICAgICAgY2FudmFzID0gZmFsc2U7CgogICAgICAgIGZvciAoY29uc3QgewogICAgICAgICAgb3BMaXN0LAogICAgICAgICAgc2VwYXJhdGVGb3JtLAogICAgICAgICAgc2VwYXJhdGVDYW52YXMKICAgICAgICB9IG9mIG9wTGlzdHMpIHsKICAgICAgICAgIHBhZ2VPcExpc3QuYWRkT3BMaXN0KG9wTGlzdCk7CgogICAgICAgICAgaWYgKHNlcGFyYXRlRm9ybSkgewogICAgICAgICAgICBmb3JtID0gc2VwYXJhdGVGb3JtOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChzZXBhcmF0ZUNhbnZhcykgewogICAgICAgICAgICBjYW52YXMgPSBzZXBhcmF0ZUNhbnZhczsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHBhZ2VPcExpc3QuZmx1c2godHJ1ZSwgewogICAgICAgICAgZm9ybSwKICAgICAgICAgIGNhbnZhcwogICAgICAgIH0pOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsZW5ndGg6IHBhZ2VPcExpc3QudG90YWxMZW5ndGgKICAgICAgICB9OwogICAgICB9KTsKICAgIH0pOwogIH0KCiAgZXh0cmFjdFRleHRDb250ZW50KF9yZWY1KSB7CiAgICBsZXQgewogICAgICBoYW5kbGVyLAogICAgICB0YXNrLAogICAgICBpbmNsdWRlTWFya2VkQ29udGVudCwKICAgICAgc2luaywKICAgICAgY29tYmluZVRleHRJdGVtcwogICAgfSA9IF9yZWY1OwogICAgY29uc3QgY29udGVudFN0cmVhbVByb21pc2UgPSB0aGlzLmdldENvbnRlbnRTdHJlYW0oaGFuZGxlcik7CiAgICBjb25zdCByZXNvdXJjZXNQcm9taXNlID0gdGhpcy5sb2FkUmVzb3VyY2VzKFsiRXh0R1N0YXRlIiwgIkZvbnQiLCAiUHJvcGVydGllcyIsICJYT2JqZWN0Il0pOwogICAgY29uc3QgZGF0YVByb21pc2VzID0gUHJvbWlzZS5hbGwoW2NvbnRlbnRTdHJlYW1Qcm9taXNlLCByZXNvdXJjZXNQcm9taXNlXSk7CiAgICByZXR1cm4gZGF0YVByb21pc2VzLnRoZW4oX3JlZjYgPT4gewogICAgICBsZXQgW2NvbnRlbnRTdHJlYW1dID0gX3JlZjY7CiAgICAgIGNvbnN0IHBhcnRpYWxFdmFsdWF0b3IgPSBuZXcgX2V2YWx1YXRvci5QYXJ0aWFsRXZhbHVhdG9yKHsKICAgICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgICAgaGFuZGxlciwKICAgICAgICBwYWdlSW5kZXg6IHRoaXMucGFnZUluZGV4LAogICAgICAgIGlkRmFjdG9yeTogdGhpcy5fbG9jYWxJZEZhY3RvcnksCiAgICAgICAgZm9udENhY2hlOiB0aGlzLmZvbnRDYWNoZSwKICAgICAgICBidWlsdEluQ01hcENhY2hlOiB0aGlzLmJ1aWx0SW5DTWFwQ2FjaGUsCiAgICAgICAgc3RhbmRhcmRGb250RGF0YUNhY2hlOiB0aGlzLnN0YW5kYXJkRm9udERhdGFDYWNoZSwKICAgICAgICBnbG9iYWxJbWFnZUNhY2hlOiB0aGlzLmdsb2JhbEltYWdlQ2FjaGUsCiAgICAgICAgb3B0aW9uczogdGhpcy5ldmFsdWF0b3JPcHRpb25zCiAgICAgIH0pOwogICAgICByZXR1cm4gcGFydGlhbEV2YWx1YXRvci5nZXRUZXh0Q29udGVudCh7CiAgICAgICAgc3RyZWFtOiBjb250ZW50U3RyZWFtLAogICAgICAgIHRhc2ssCiAgICAgICAgcmVzb3VyY2VzOiB0aGlzLnJlc291cmNlcywKICAgICAgICBpbmNsdWRlTWFya2VkQ29udGVudCwKICAgICAgICBjb21iaW5lVGV4dEl0ZW1zLAogICAgICAgIHNpbmssCiAgICAgICAgdmlld0JveDogdGhpcy52aWV3CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBhc3luYyBnZXRTdHJ1Y3RUcmVlKCkgewogICAgY29uc3Qgc3RydWN0VHJlZVJvb3QgPSBhd2FpdCB0aGlzLnBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygic3RydWN0VHJlZVJvb3QiKTsKCiAgICBpZiAoIXN0cnVjdFRyZWVSb290KSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHN0cnVjdFRyZWUgPSBhd2FpdCB0aGlzLnBkZk1hbmFnZXIuZW5zdXJlKHRoaXMsICJfcGFyc2VTdHJ1Y3RUcmVlIiwgW3N0cnVjdFRyZWVSb290XSk7CiAgICByZXR1cm4gc3RydWN0VHJlZS5zZXJpYWxpemFibGU7CiAgfQoKICBfcGFyc2VTdHJ1Y3RUcmVlKHN0cnVjdFRyZWVSb290KSB7CiAgICBjb25zdCB0cmVlID0gbmV3IF9zdHJ1Y3RfdHJlZS5TdHJ1Y3RUcmVlUGFnZShzdHJ1Y3RUcmVlUm9vdCwgdGhpcy5wYWdlRGljdCk7CiAgICB0cmVlLnBhcnNlKCk7CiAgICByZXR1cm4gdHJlZTsKICB9CgogIGFzeW5jIGdldEFubm90YXRpb25zRGF0YShoYW5kbGVyLCB0YXNrLCBpbnRlbnQpIHsKICAgIGNvbnN0IGFubm90YXRpb25zID0gYXdhaXQgdGhpcy5fcGFyc2VkQW5ub3RhdGlvbnM7CgogICAgaWYgKGFubm90YXRpb25zLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gW107CiAgICB9CgogICAgY29uc3QgdGV4dENvbnRlbnRQcm9taXNlcyA9IFtdOwogICAgY29uc3QgYW5ub3RhdGlvbnNEYXRhID0gW107CiAgICBsZXQgcGFydGlhbEV2YWx1YXRvcjsKICAgIGNvbnN0IGludGVudEFueSA9ICEhKGludGVudCAmIF91dGlsLlJlbmRlcmluZ0ludGVudEZsYWcuQU5ZKSwKICAgICAgICAgIGludGVudERpc3BsYXkgPSAhIShpbnRlbnQgJiBfdXRpbC5SZW5kZXJpbmdJbnRlbnRGbGFnLkRJU1BMQVkpLAogICAgICAgICAgaW50ZW50UHJpbnQgPSAhIShpbnRlbnQgJiBfdXRpbC5SZW5kZXJpbmdJbnRlbnRGbGFnLlBSSU5UKTsKCiAgICBmb3IgKGNvbnN0IGFubm90YXRpb24gb2YgYW5ub3RhdGlvbnMpIHsKICAgICAgY29uc3QgaXNWaXNpYmxlID0gaW50ZW50QW55IHx8IGludGVudERpc3BsYXkgJiYgYW5ub3RhdGlvbi52aWV3YWJsZTsKCiAgICAgIGlmIChpc1Zpc2libGUgfHwgaW50ZW50UHJpbnQgJiYgYW5ub3RhdGlvbi5wcmludGFibGUpIHsKICAgICAgICBhbm5vdGF0aW9uc0RhdGEucHVzaChhbm5vdGF0aW9uLmRhdGEpOwogICAgICB9CgogICAgICBpZiAoYW5ub3RhdGlvbi5oYXNUZXh0Q29udGVudCAmJiBpc1Zpc2libGUpIHsKICAgICAgICBpZiAoIXBhcnRpYWxFdmFsdWF0b3IpIHsKICAgICAgICAgIHBhcnRpYWxFdmFsdWF0b3IgPSBuZXcgX2V2YWx1YXRvci5QYXJ0aWFsRXZhbHVhdG9yKHsKICAgICAgICAgICAgeHJlZjogdGhpcy54cmVmLAogICAgICAgICAgICBoYW5kbGVyLAogICAgICAgICAgICBwYWdlSW5kZXg6IHRoaXMucGFnZUluZGV4LAogICAgICAgICAgICBpZEZhY3Rvcnk6IHRoaXMuX2xvY2FsSWRGYWN0b3J5LAogICAgICAgICAgICBmb250Q2FjaGU6IHRoaXMuZm9udENhY2hlLAogICAgICAgICAgICBidWlsdEluQ01hcENhY2hlOiB0aGlzLmJ1aWx0SW5DTWFwQ2FjaGUsCiAgICAgICAgICAgIHN0YW5kYXJkRm9udERhdGFDYWNoZTogdGhpcy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUsCiAgICAgICAgICAgIGdsb2JhbEltYWdlQ2FjaGU6IHRoaXMuZ2xvYmFsSW1hZ2VDYWNoZSwKICAgICAgICAgICAgb3B0aW9uczogdGhpcy5ldmFsdWF0b3JPcHRpb25zCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHRleHRDb250ZW50UHJvbWlzZXMucHVzaChhbm5vdGF0aW9uLmV4dHJhY3RUZXh0Q29udGVudChwYXJ0aWFsRXZhbHVhdG9yLCB0YXNrLCB0aGlzLnZpZXcpLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgZ2V0QW5ub3RhdGlvbnNEYXRhIC0gaWdub3JpbmcgdGV4dENvbnRlbnQgZHVyaW5nICIke3Rhc2submFtZX0iIHRhc2s6ICIke3JlYXNvbn0iLmApOwogICAgICAgIH0pKTsKICAgICAgfQogICAgfQoKICAgIGF3YWl0IFByb21pc2UuYWxsKHRleHRDb250ZW50UHJvbWlzZXMpOwogICAgcmV0dXJuIGFubm90YXRpb25zRGF0YTsKICB9CgogIGdldCBhbm5vdGF0aW9ucygpIHsKICAgIGNvbnN0IGFubm90cyA9IHRoaXMuX2dldEluaGVyaXRhYmxlUHJvcGVydHkoIkFubm90cyIpOwoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYW5ub3RhdGlvbnMiLCBBcnJheS5pc0FycmF5KGFubm90cykgPyBhbm5vdHMgOiBbXSk7CiAgfQoKICBnZXQgX3BhcnNlZEFubm90YXRpb25zKCkgewogICAgY29uc3QgcGFyc2VkQW5ub3RhdGlvbnMgPSB0aGlzLnBkZk1hbmFnZXIuZW5zdXJlKHRoaXMsICJhbm5vdGF0aW9ucyIpLnRoZW4oKCkgPT4gewogICAgICBjb25zdCBhbm5vdGF0aW9uUHJvbWlzZXMgPSBbXTsKCiAgICAgIGZvciAoY29uc3QgYW5ub3RhdGlvblJlZiBvZiB0aGlzLmFubm90YXRpb25zKSB7CiAgICAgICAgYW5ub3RhdGlvblByb21pc2VzLnB1c2goX2Fubm90YXRpb24uQW5ub3RhdGlvbkZhY3RvcnkuY3JlYXRlKHRoaXMueHJlZiwgYW5ub3RhdGlvblJlZiwgdGhpcy5wZGZNYW5hZ2VyLCB0aGlzLl9sb2NhbElkRmFjdG9yeSwgZmFsc2UpLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgX3BhcnNlZEFubm90YXRpb25zOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0pKTsKICAgICAgfQoKICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGFubm90YXRpb25Qcm9taXNlcykudGhlbihmdW5jdGlvbiAoYW5ub3RhdGlvbnMpIHsKICAgICAgICBpZiAoYW5ub3RhdGlvbnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICByZXR1cm4gYW5ub3RhdGlvbnM7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzb3J0ZWRBbm5vdGF0aW9ucyA9IFtdOwogICAgICAgIGxldCBwb3B1cEFubm90YXRpb25zOwoKICAgICAgICBmb3IgKGNvbnN0IGFubm90YXRpb24gb2YgYW5ub3RhdGlvbnMpIHsKICAgICAgICAgIGlmICghYW5ub3RhdGlvbikgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoYW5ub3RhdGlvbiBpbnN0YW5jZW9mIF9hbm5vdGF0aW9uLlBvcHVwQW5ub3RhdGlvbikgewogICAgICAgICAgICBpZiAoIXBvcHVwQW5ub3RhdGlvbnMpIHsKICAgICAgICAgICAgICBwb3B1cEFubm90YXRpb25zID0gW107CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHBvcHVwQW5ub3RhdGlvbnMucHVzaChhbm5vdGF0aW9uKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgc29ydGVkQW5ub3RhdGlvbnMucHVzaChhbm5vdGF0aW9uKTsKICAgICAgICB9CgogICAgICAgIGlmIChwb3B1cEFubm90YXRpb25zKSB7CiAgICAgICAgICBzb3J0ZWRBbm5vdGF0aW9ucy5wdXNoKC4uLnBvcHVwQW5ub3RhdGlvbnMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHNvcnRlZEFubm90YXRpb25zOwogICAgICB9KTsKICAgIH0pOwogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJfcGFyc2VkQW5ub3RhdGlvbnMiLCBwYXJzZWRBbm5vdGF0aW9ucyk7CiAgfQoKICBnZXQganNBY3Rpb25zKCkgewogICAgY29uc3QgYWN0aW9ucyA9ICgwLCBfY29yZV91dGlscy5jb2xsZWN0QWN0aW9ucykodGhpcy54cmVmLCB0aGlzLnBhZ2VEaWN0LCBfdXRpbC5QYWdlQWN0aW9uRXZlbnRUeXBlKTsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAianNBY3Rpb25zIiwgYWN0aW9ucyk7CiAgfQoKfQoKZXhwb3J0cy5QYWdlID0gUGFnZTsKY29uc3QgUERGX0hFQURFUl9TSUdOQVRVUkUgPSBuZXcgVWludDhBcnJheShbMHgyNSwgMHg1MCwgMHg0NCwgMHg0NiwgMHgyZF0pOwpjb25zdCBTVEFSVFhSRUZfU0lHTkFUVVJFID0gbmV3IFVpbnQ4QXJyYXkoWzB4NzMsIDB4NzQsIDB4NjEsIDB4NzIsIDB4NzQsIDB4NzgsIDB4NzIsIDB4NjUsIDB4NjZdKTsKY29uc3QgRU5ET0JKX1NJR05BVFVSRSA9IG5ldyBVaW50OEFycmF5KFsweDY1LCAweDZlLCAweDY0LCAweDZmLCAweDYyLCAweDZhXSk7CmNvbnN0IEZJTkdFUlBSSU5UX0ZJUlNUX0JZVEVTID0gMTAyNDsKY29uc3QgRU1QVFlfRklOR0VSUFJJTlQgPSAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCI7CmNvbnN0IFBERl9IRUFERVJfVkVSU0lPTl9SRUdFWFAgPSAvXlsxLTldXC5cZCQvOwoKZnVuY3Rpb24gZmluZChzdHJlYW0sIHNpZ25hdHVyZSkgewogIGxldCBsaW1pdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogMTAyNDsKICBsZXQgYmFja3dhcmRzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKICBjb25zdCBzaWduYXR1cmVMZW5ndGggPSBzaWduYXR1cmUubGVuZ3RoOwogIGNvbnN0IHNjYW5CeXRlcyA9IHN0cmVhbS5wZWVrQnl0ZXMobGltaXQpOwogIGNvbnN0IHNjYW5MZW5ndGggPSBzY2FuQnl0ZXMubGVuZ3RoIC0gc2lnbmF0dXJlTGVuZ3RoOwoKICBpZiAoc2Nhbkxlbmd0aCA8PSAwKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBpZiAoYmFja3dhcmRzKSB7CiAgICBjb25zdCBzaWduYXR1cmVFbmQgPSBzaWduYXR1cmVMZW5ndGggLSAxOwogICAgbGV0IHBvcyA9IHNjYW5CeXRlcy5sZW5ndGggLSAxOwoKICAgIHdoaWxlIChwb3MgPj0gc2lnbmF0dXJlRW5kKSB7CiAgICAgIGxldCBqID0gMDsKCiAgICAgIHdoaWxlIChqIDwgc2lnbmF0dXJlTGVuZ3RoICYmIHNjYW5CeXRlc1twb3MgLSBqXSA9PT0gc2lnbmF0dXJlW3NpZ25hdHVyZUVuZCAtIGpdKSB7CiAgICAgICAgaisrOwogICAgICB9CgogICAgICBpZiAoaiA+PSBzaWduYXR1cmVMZW5ndGgpIHsKICAgICAgICBzdHJlYW0ucG9zICs9IHBvcyAtIHNpZ25hdHVyZUVuZDsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcG9zLS07CiAgICB9CiAgfSBlbHNlIHsKICAgIGxldCBwb3MgPSAwOwoKICAgIHdoaWxlIChwb3MgPD0gc2Nhbkxlbmd0aCkgewogICAgICBsZXQgaiA9IDA7CgogICAgICB3aGlsZSAoaiA8IHNpZ25hdHVyZUxlbmd0aCAmJiBzY2FuQnl0ZXNbcG9zICsgal0gPT09IHNpZ25hdHVyZVtqXSkgewogICAgICAgIGorKzsKICAgICAgfQoKICAgICAgaWYgKGogPj0gc2lnbmF0dXJlTGVuZ3RoKSB7CiAgICAgICAgc3RyZWFtLnBvcyArPSBwb3M7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHBvcysrOwogICAgfQogIH0KCiAgcmV0dXJuIGZhbHNlOwp9CgpjbGFzcyBQREZEb2N1bWVudCB7CiAgY29uc3RydWN0b3IocGRmTWFuYWdlciwgc3RyZWFtKSB7CiAgICBpZiAoc3RyZWFtLmxlbmd0aCA8PSAwKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5JbnZhbGlkUERGRXhjZXB0aW9uKCJUaGUgUERGIGZpbGUgaXMgZW1wdHksIGkuZS4gaXRzIHNpemUgaXMgemVybyBieXRlcy4iKTsKICAgIH0KCiAgICB0aGlzLnBkZk1hbmFnZXIgPSBwZGZNYW5hZ2VyOwogICAgdGhpcy5zdHJlYW0gPSBzdHJlYW07CiAgICB0aGlzLnhyZWYgPSBuZXcgX3hyZWYuWFJlZihzdHJlYW0sIHBkZk1hbmFnZXIpOwogICAgdGhpcy5fcGFnZVByb21pc2VzID0gbmV3IE1hcCgpOwogICAgdGhpcy5fdmVyc2lvbiA9IG51bGw7CiAgICBjb25zdCBpZENvdW50ZXJzID0gewogICAgICBmb250OiAwCiAgICB9OwogICAgdGhpcy5fZ2xvYmFsSWRGYWN0b3J5ID0gY2xhc3MgewogICAgICBzdGF0aWMgZ2V0RG9jSWQoKSB7CiAgICAgICAgcmV0dXJuIGBnXyR7cGRmTWFuYWdlci5kb2NJZH1gOwogICAgICB9CgogICAgICBzdGF0aWMgY3JlYXRlRm9udElkKCkgewogICAgICAgIHJldHVybiBgZiR7KytpZENvdW50ZXJzLmZvbnR9YDsKICAgICAgfQoKICAgICAgc3RhdGljIGNyZWF0ZU9iaklkKCkgewogICAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgY3JlYXRlT2JqSWRgIGNhbGxlZC4iKTsKICAgICAgfQoKICAgICAgc3RhdGljIGdldFBhZ2VPYmpJZCgpIHsKICAgICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYGdldFBhZ2VPYmpJZGAgY2FsbGVkLiIpOwogICAgICB9CgogICAgfTsKICB9CgogIHBhcnNlKHJlY292ZXJ5TW9kZSkgewogICAgdGhpcy54cmVmLnBhcnNlKHJlY292ZXJ5TW9kZSk7CiAgICB0aGlzLmNhdGFsb2cgPSBuZXcgX2NhdGFsb2cuQ2F0YWxvZyh0aGlzLnBkZk1hbmFnZXIsIHRoaXMueHJlZik7CgogICAgaWYgKHRoaXMuY2F0YWxvZy52ZXJzaW9uKSB7CiAgICAgIHRoaXMuX3ZlcnNpb24gPSB0aGlzLmNhdGFsb2cudmVyc2lvbjsKICAgIH0KICB9CgogIGdldCBsaW5lYXJpemF0aW9uKCkgewogICAgbGV0IGxpbmVhcml6YXRpb24gPSBudWxsOwoKICAgIHRyeSB7CiAgICAgIGxpbmVhcml6YXRpb24gPSBfcGFyc2VyLkxpbmVhcml6YXRpb24uY3JlYXRlKHRoaXMuc3RyZWFtKTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBpZiAoZXJyIGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC5pbmZvKShlcnIpOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAibGluZWFyaXphdGlvbiIsIGxpbmVhcml6YXRpb24pOwogIH0KCiAgZ2V0IHN0YXJ0WFJlZigpIHsKICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuc3RyZWFtOwogICAgbGV0IHN0YXJ0WFJlZiA9IDA7CgogICAgaWYgKHRoaXMubGluZWFyaXphdGlvbikgewogICAgICBzdHJlYW0ucmVzZXQoKTsKCiAgICAgIGlmIChmaW5kKHN0cmVhbSwgRU5ET0JKX1NJR05BVFVSRSkpIHsKICAgICAgICBzdGFydFhSZWYgPSBzdHJlYW0ucG9zICsgNiAtIHN0cmVhbS5zdGFydDsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgY29uc3Qgc3RlcCA9IDEwMjQ7CiAgICAgIGNvbnN0IHN0YXJ0WFJlZkxlbmd0aCA9IFNUQVJUWFJFRl9TSUdOQVRVUkUubGVuZ3RoOwogICAgICBsZXQgZm91bmQgPSBmYWxzZSwKICAgICAgICAgIHBvcyA9IHN0cmVhbS5lbmQ7CgogICAgICB3aGlsZSAoIWZvdW5kICYmIHBvcyA+IDApIHsKICAgICAgICBwb3MgLT0gc3RlcCAtIHN0YXJ0WFJlZkxlbmd0aDsKCiAgICAgICAgaWYgKHBvcyA8IDApIHsKICAgICAgICAgIHBvcyA9IDA7CiAgICAgICAgfQoKICAgICAgICBzdHJlYW0ucG9zID0gcG9zOwogICAgICAgIGZvdW5kID0gZmluZChzdHJlYW0sIFNUQVJUWFJFRl9TSUdOQVRVUkUsIHN0ZXAsIHRydWUpOwogICAgICB9CgogICAgICBpZiAoZm91bmQpIHsKICAgICAgICBzdHJlYW0uc2tpcCg5KTsKICAgICAgICBsZXQgY2g7CgogICAgICAgIGRvIHsKICAgICAgICAgIGNoID0gc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgICB9IHdoaWxlICgoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkpOwoKICAgICAgICBsZXQgc3RyID0gIiI7CgogICAgICAgIHdoaWxlIChjaCA+PSAweDIwICYmIGNoIDw9IDB4MzkpIHsKICAgICAgICAgIHN0ciArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKICAgICAgICAgIGNoID0gc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgICB9CgogICAgICAgIHN0YXJ0WFJlZiA9IHBhcnNlSW50KHN0ciwgMTApOwoKICAgICAgICBpZiAoaXNOYU4oc3RhcnRYUmVmKSkgewogICAgICAgICAgc3RhcnRYUmVmID0gMDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInN0YXJ0WFJlZiIsIHN0YXJ0WFJlZik7CiAgfQoKICBjaGVja0hlYWRlcigpIHsKICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuc3RyZWFtOwogICAgc3RyZWFtLnJlc2V0KCk7CgogICAgaWYgKCFmaW5kKHN0cmVhbSwgUERGX0hFQURFUl9TSUdOQVRVUkUpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzdHJlYW0ubW92ZVN0YXJ0KCk7CiAgICBjb25zdCBNQVhfUERGX1ZFUlNJT05fTEVOR1RIID0gMTI7CiAgICBsZXQgdmVyc2lvbiA9ICIiLAogICAgICAgIGNoOwoKICAgIHdoaWxlICgoY2ggPSBzdHJlYW0uZ2V0Qnl0ZSgpKSA+IDB4MjApIHsKICAgICAgaWYgKHZlcnNpb24ubGVuZ3RoID49IE1BWF9QREZfVkVSU0lPTl9MRU5HVEgpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgdmVyc2lvbiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKICAgIH0KCiAgICBpZiAoIXRoaXMuX3ZlcnNpb24pIHsKICAgICAgdGhpcy5fdmVyc2lvbiA9IHZlcnNpb24uc3Vic3RyaW5nKDUpOwogICAgfQogIH0KCiAgcGFyc2VTdGFydFhSZWYoKSB7CiAgICB0aGlzLnhyZWYuc2V0U3RhcnRYUmVmKHRoaXMuc3RhcnRYUmVmKTsKICB9CgogIGdldCBudW1QYWdlcygpIHsKICAgIGxldCBudW0gPSAwOwoKICAgIGlmICh0aGlzLmNhdGFsb2cuaGFzQWN0dWFsTnVtUGFnZXMpIHsKICAgICAgbnVtID0gdGhpcy5jYXRhbG9nLm51bVBhZ2VzOwogICAgfSBlbHNlIGlmICh0aGlzLnhmYUZhY3RvcnkpIHsKICAgICAgbnVtID0gdGhpcy54ZmFGYWN0b3J5LmdldE51bVBhZ2VzKCk7CiAgICB9IGVsc2UgaWYgKHRoaXMubGluZWFyaXphdGlvbikgewogICAgICBudW0gPSB0aGlzLmxpbmVhcml6YXRpb24ubnVtUGFnZXM7CiAgICB9IGVsc2UgewogICAgICBudW0gPSB0aGlzLmNhdGFsb2cubnVtUGFnZXM7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJudW1QYWdlcyIsIG51bSk7CiAgfQoKICBfaGFzT25seURvY3VtZW50U2lnbmF0dXJlcyhmaWVsZHMpIHsKICAgIGxldCByZWN1cnNpb25EZXB0aCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogMDsKICAgIGNvbnN0IFJFQ1VSU0lPTl9MSU1JVCA9IDEwOwoKICAgIGlmICghQXJyYXkuaXNBcnJheShmaWVsZHMpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gZmllbGRzLmV2ZXJ5KGZpZWxkID0+IHsKICAgICAgZmllbGQgPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZihmaWVsZCk7CgogICAgICBpZiAoIShmaWVsZCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAoZmllbGQuaGFzKCJLaWRzIikpIHsKICAgICAgICBpZiAoKytyZWN1cnNpb25EZXB0aCA+IFJFQ1VSU0lPTl9MSU1JVCkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJfaGFzT25seURvY3VtZW50U2lnbmF0dXJlczogbWF4aW11bSByZWN1cnNpb24gZGVwdGggcmVhY2hlZCIpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXMuX2hhc09ubHlEb2N1bWVudFNpZ25hdHVyZXMoZmllbGQuZ2V0KCJLaWRzIiksIHJlY3Vyc2lvbkRlcHRoKTsKICAgICAgfQoKICAgICAgY29uc3QgaXNTaWduYXR1cmUgPSAoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShmaWVsZC5nZXQoIkZUIiksICJTaWciKTsKICAgICAgY29uc3QgcmVjdGFuZ2xlID0gZmllbGQuZ2V0KCJSZWN0Iik7CiAgICAgIGNvbnN0IGlzSW52aXNpYmxlID0gQXJyYXkuaXNBcnJheShyZWN0YW5nbGUpICYmIHJlY3RhbmdsZS5ldmVyeSh2YWx1ZSA9PiB2YWx1ZSA9PT0gMCk7CiAgICAgIHJldHVybiBpc1NpZ25hdHVyZSAmJiBpc0ludmlzaWJsZTsKICAgIH0pOwogIH0KCiAgZ2V0IF94ZmFTdHJlYW1zKCkgewogICAgY29uc3QgYWNyb0Zvcm0gPSB0aGlzLmNhdGFsb2cuYWNyb0Zvcm07CgogICAgaWYgKCFhY3JvRm9ybSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCB4ZmEgPSBhY3JvRm9ybS5nZXQoIlhGQSIpOwogICAgY29uc3QgZW50cmllcyA9IHsKICAgICAgInhkcDp4ZHAiOiAiIiwKICAgICAgdGVtcGxhdGU6ICIiLAogICAgICBkYXRhc2V0czogIiIsCiAgICAgIGNvbmZpZzogIiIsCiAgICAgIGNvbm5lY3Rpb25TZXQ6ICIiLAogICAgICBsb2NhbGVTZXQ6ICIiLAogICAgICBzdHlsZXNoZWV0OiAiIiwKICAgICAgIi94ZHA6eGRwIjogIiIKICAgIH07CgogICAgaWYgKHhmYSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtICYmICF4ZmEuaXNFbXB0eSkgewogICAgICBlbnRyaWVzWyJ4ZHA6eGRwIl0gPSB4ZmE7CiAgICAgIHJldHVybiBlbnRyaWVzOwogICAgfQoKICAgIGlmICghQXJyYXkuaXNBcnJheSh4ZmEpIHx8IHhmYS5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0geGZhLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHsKICAgICAgbGV0IG5hbWU7CgogICAgICBpZiAoaSA9PT0gMCkgewogICAgICAgIG5hbWUgPSAieGRwOnhkcCI7CiAgICAgIH0gZWxzZSBpZiAoaSA9PT0gaWkgLSAyKSB7CiAgICAgICAgbmFtZSA9ICIveGRwOnhkcCI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmFtZSA9IHhmYVtpXTsKICAgICAgfQoKICAgICAgaWYgKCFlbnRyaWVzLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZih4ZmFbaSArIDFdKTsKCiAgICAgIGlmICghKGRhdGEgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgfHwgZGF0YS5pc0VtcHR5KSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGVudHJpZXNbbmFtZV0gPSBkYXRhOwogICAgfQoKICAgIHJldHVybiBlbnRyaWVzOwogIH0KCiAgZ2V0IHhmYURhdGFzZXRzKCkgewogICAgY29uc3Qgc3RyZWFtcyA9IHRoaXMuX3hmYVN0cmVhbXM7CgogICAgaWYgKCFzdHJlYW1zKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAieGZhRGF0YXNldHMiLCBudWxsKTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGtleSBvZiBbImRhdGFzZXRzIiwgInhkcDp4ZHAiXSkgewogICAgICBjb25zdCBzdHJlYW0gPSBzdHJlYW1zW2tleV07CgogICAgICBpZiAoIXN0cmVhbSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICB0cnkgewogICAgICAgIGNvbnN0IHN0ciA9ICgwLCBfdXRpbC5zdHJpbmdUb1VURjhTdHJpbmcpKHN0cmVhbS5nZXRTdHJpbmcoKSk7CiAgICAgICAgY29uc3QgZGF0YSA9IHsKICAgICAgICAgIFtrZXldOiBzdHIKICAgICAgICB9OwogICAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAieGZhRGF0YXNldHMiLCBuZXcgX2RhdGFzZXRfcmVhZGVyLkRhdGFzZXRSZWFkZXIoZGF0YSkpOwogICAgICB9IGNhdGNoIChfKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBJbnZhbGlkIHV0Zi04IHN0cmluZy4iKTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAieGZhRGF0YXNldHMiLCBudWxsKTsKICB9CgogIGdldCB4ZmFEYXRhKCkgewogICAgY29uc3Qgc3RyZWFtcyA9IHRoaXMuX3hmYVN0cmVhbXM7CgogICAgaWYgKCFzdHJlYW1zKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IGRhdGEgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGZvciAoY29uc3QgW2tleSwgc3RyZWFtXSBvZiBPYmplY3QuZW50cmllcyhzdHJlYW1zKSkgewogICAgICBpZiAoIXN0cmVhbSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICB0cnkgewogICAgICAgIGRhdGFba2V5XSA9ICgwLCBfdXRpbC5zdHJpbmdUb1VURjhTdHJpbmcpKHN0cmVhbS5nZXRTdHJpbmcoKSk7CiAgICAgIH0gY2F0Y2ggKF8pIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIlhGQSAtIEludmFsaWQgdXRmLTggc3RyaW5nLiIpOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGRhdGE7CiAgfQoKICBnZXQgeGZhRmFjdG9yeSgpIHsKICAgIGxldCBkYXRhOwoKICAgIGlmICh0aGlzLnBkZk1hbmFnZXIuZW5hYmxlWGZhICYmIHRoaXMuY2F0YWxvZy5uZWVkc1JlbmRlcmluZyAmJiB0aGlzLmZvcm1JbmZvLmhhc1hmYSAmJiAhdGhpcy5mb3JtSW5mby5oYXNBY3JvRm9ybSkgewogICAgICBkYXRhID0gdGhpcy54ZmFEYXRhOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAieGZhRmFjdG9yeSIsIGRhdGEgPyBuZXcgX2ZhY3RvcnkuWEZBRmFjdG9yeShkYXRhKSA6IG51bGwpOwogIH0KCiAgZ2V0IGlzUHVyZVhmYSgpIHsKICAgIHJldHVybiB0aGlzLnhmYUZhY3RvcnkgPyB0aGlzLnhmYUZhY3RvcnkuaXNWYWxpZCgpIDogZmFsc2U7CiAgfQoKICBnZXQgaHRtbEZvclhmYSgpIHsKICAgIHJldHVybiB0aGlzLnhmYUZhY3RvcnkgPyB0aGlzLnhmYUZhY3RvcnkuZ2V0UGFnZXMoKSA6IG51bGw7CiAgfQoKICBhc3luYyBsb2FkWGZhSW1hZ2VzKCkgewogICAgY29uc3QgeGZhSW1hZ2VzRGljdCA9IGF3YWl0IHRoaXMucGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJ4ZmFJbWFnZXMiKTsKCiAgICBpZiAoIXhmYUltYWdlc0RpY3QpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGtleXMgPSB4ZmFJbWFnZXNEaWN0LmdldEtleXMoKTsKICAgIGNvbnN0IG9iamVjdExvYWRlciA9IG5ldyBfb2JqZWN0X2xvYWRlci5PYmplY3RMb2FkZXIoeGZhSW1hZ2VzRGljdCwga2V5cywgdGhpcy54cmVmKTsKICAgIGF3YWl0IG9iamVjdExvYWRlci5sb2FkKCk7CiAgICBjb25zdCB4ZmFJbWFnZXMgPSBuZXcgTWFwKCk7CgogICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgewogICAgICBjb25zdCBzdHJlYW0gPSB4ZmFJbWFnZXNEaWN0LmdldChrZXkpOwoKICAgICAgaWYgKHN0cmVhbSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgICAgeGZhSW1hZ2VzLnNldChrZXksIHN0cmVhbS5nZXRCeXRlcygpKTsKICAgICAgfQogICAgfQoKICAgIHRoaXMueGZhRmFjdG9yeS5zZXRJbWFnZXMoeGZhSW1hZ2VzKTsKICB9CgogIGFzeW5jIGxvYWRYZmFGb250cyhoYW5kbGVyLCB0YXNrKSB7CiAgICBjb25zdCBhY3JvRm9ybSA9IGF3YWl0IHRoaXMucGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJhY3JvRm9ybSIpOwoKICAgIGlmICghYWNyb0Zvcm0pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHJlc291cmNlcyA9IGF3YWl0IGFjcm9Gb3JtLmdldEFzeW5jKCJEUiIpOwoKICAgIGlmICghKHJlc291cmNlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBvYmplY3RMb2FkZXIgPSBuZXcgX29iamVjdF9sb2FkZXIuT2JqZWN0TG9hZGVyKHJlc291cmNlcywgWyJGb250Il0sIHRoaXMueHJlZik7CiAgICBhd2FpdCBvYmplY3RMb2FkZXIubG9hZCgpOwogICAgY29uc3QgZm9udFJlcyA9IHJlc291cmNlcy5nZXQoIkZvbnQiKTsKCiAgICBpZiAoIShmb250UmVzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUobnVsbCksIHRoaXMucGRmTWFuYWdlci5ldmFsdWF0b3JPcHRpb25zKTsKICAgIG9wdGlvbnMudXNlU3lzdGVtRm9udHMgPSBmYWxzZTsKICAgIGNvbnN0IHBhcnRpYWxFdmFsdWF0b3IgPSBuZXcgX2V2YWx1YXRvci5QYXJ0aWFsRXZhbHVhdG9yKHsKICAgICAgeHJlZjogdGhpcy54cmVmLAogICAgICBoYW5kbGVyLAogICAgICBwYWdlSW5kZXg6IC0xLAogICAgICBpZEZhY3Rvcnk6IHRoaXMuX2dsb2JhbElkRmFjdG9yeSwKICAgICAgZm9udENhY2hlOiB0aGlzLmNhdGFsb2cuZm9udENhY2hlLAogICAgICBidWlsdEluQ01hcENhY2hlOiB0aGlzLmNhdGFsb2cuYnVpbHRJbkNNYXBDYWNoZSwKICAgICAgc3RhbmRhcmRGb250RGF0YUNhY2hlOiB0aGlzLmNhdGFsb2cuc3RhbmRhcmRGb250RGF0YUNhY2hlLAogICAgICBvcHRpb25zCiAgICB9KTsKICAgIGNvbnN0IG9wZXJhdG9yTGlzdCA9IG5ldyBfb3BlcmF0b3JfbGlzdC5PcGVyYXRvckxpc3QoKTsKICAgIGNvbnN0IHBkZkZvbnRzID0gW107CiAgICBjb25zdCBpbml0aWFsU3RhdGUgPSB7CiAgICAgIGdldCBmb250KCkgewogICAgICAgIHJldHVybiBwZGZGb250cy5hdCgtMSk7CiAgICAgIH0sCgogICAgICBzZXQgZm9udChmb250KSB7CiAgICAgICAgcGRmRm9udHMucHVzaChmb250KTsKICAgICAgfSwKCiAgICAgIGNsb25lKCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CgogICAgfTsKICAgIGNvbnN0IGZvbnRzID0gbmV3IE1hcCgpOwogICAgZm9udFJlcy5mb3JFYWNoKChmb250TmFtZSwgZm9udCkgPT4gewogICAgICBmb250cy5zZXQoZm9udE5hbWUsIGZvbnQpOwogICAgfSk7CiAgICBjb25zdCBwcm9taXNlcyA9IFtdOwoKICAgIGZvciAoY29uc3QgW2ZvbnROYW1lLCBmb250XSBvZiBmb250cykgewogICAgICBjb25zdCBkZXNjcmlwdG9yID0gZm9udC5nZXQoIkZvbnREZXNjcmlwdG9yIik7CgogICAgICBpZiAoIShkZXNjcmlwdG9yIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgbGV0IGZvbnRGYW1pbHkgPSBkZXNjcmlwdG9yLmdldCgiRm9udEZhbWlseSIpOwogICAgICBmb250RmFtaWx5ID0gZm9udEZhbWlseS5yZXBsYWNlKC9bIF0rKFxkKS9nLCAiJDEiKTsKICAgICAgY29uc3QgZm9udFdlaWdodCA9IGRlc2NyaXB0b3IuZ2V0KCJGb250V2VpZ2h0Iik7CiAgICAgIGNvbnN0IGl0YWxpY0FuZ2xlID0gLWRlc2NyaXB0b3IuZ2V0KCJJdGFsaWNBbmdsZSIpOwogICAgICBjb25zdCBjc3NGb250SW5mbyA9IHsKICAgICAgICBmb250RmFtaWx5LAogICAgICAgIGZvbnRXZWlnaHQsCiAgICAgICAgaXRhbGljQW5nbGUKICAgICAgfTsKCiAgICAgIGlmICghKDAsIF9jb3JlX3V0aWxzLnZhbGlkYXRlQ1NTRm9udCkoY3NzRm9udEluZm8pKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHByb21pc2VzLnB1c2gocGFydGlhbEV2YWx1YXRvci5oYW5kbGVTZXRGb250KHJlc291cmNlcywgW19wcmltaXRpdmVzLk5hbWUuZ2V0KGZvbnROYW1lKSwgMV0sIG51bGwsIG9wZXJhdG9yTGlzdCwgdGFzaywgaW5pdGlhbFN0YXRlLCBudWxsLCBjc3NGb250SW5mbykuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgbG9hZFhmYUZvbnRzOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfSkpOwogICAgfQoKICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTsKICAgIGNvbnN0IG1pc3NpbmdGb250cyA9IHRoaXMueGZhRmFjdG9yeS5zZXRGb250cyhwZGZGb250cyk7CgogICAgaWYgKCFtaXNzaW5nRm9udHMpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIG9wdGlvbnMuaWdub3JlRXJyb3JzID0gdHJ1ZTsKICAgIHByb21pc2VzLmxlbmd0aCA9IDA7CiAgICBwZGZGb250cy5sZW5ndGggPSAwOwogICAgY29uc3QgcmVhbGx5TWlzc2luZ0ZvbnRzID0gbmV3IFNldCgpOwoKICAgIGZvciAoY29uc3QgbWlzc2luZyBvZiBtaXNzaW5nRm9udHMpIHsKICAgICAgaWYgKCEoMCwgX3hmYV9mb250cy5nZXRYZmFGb250TmFtZSkoYCR7bWlzc2luZ30tUmVndWxhcmApKSB7CiAgICAgICAgcmVhbGx5TWlzc2luZ0ZvbnRzLmFkZChtaXNzaW5nKTsKICAgICAgfQogICAgfQoKICAgIGlmIChyZWFsbHlNaXNzaW5nRm9udHMuc2l6ZSkgewogICAgICBtaXNzaW5nRm9udHMucHVzaCgiUGRmSlMtRmFsbGJhY2siKTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IG1pc3Npbmcgb2YgbWlzc2luZ0ZvbnRzKSB7CiAgICAgIGlmIChyZWFsbHlNaXNzaW5nRm9udHMuaGFzKG1pc3NpbmcpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZvciAoY29uc3QgZm9udEluZm8gb2YgW3sKICAgICAgICBuYW1lOiAiUmVndWxhciIsCiAgICAgICAgZm9udFdlaWdodDogNDAwLAogICAgICAgIGl0YWxpY0FuZ2xlOiAwCiAgICAgIH0sIHsKICAgICAgICBuYW1lOiAiQm9sZCIsCiAgICAgICAgZm9udFdlaWdodDogNzAwLAogICAgICAgIGl0YWxpY0FuZ2xlOiAwCiAgICAgIH0sIHsKICAgICAgICBuYW1lOiAiSXRhbGljIiwKICAgICAgICBmb250V2VpZ2h0OiA0MDAsCiAgICAgICAgaXRhbGljQW5nbGU6IDEyCiAgICAgIH0sIHsKICAgICAgICBuYW1lOiAiQm9sZEl0YWxpYyIsCiAgICAgICAgZm9udFdlaWdodDogNzAwLAogICAgICAgIGl0YWxpY0FuZ2xlOiAxMgogICAgICB9XSkgewogICAgICAgIGNvbnN0IG5hbWUgPSBgJHttaXNzaW5nfS0ke2ZvbnRJbmZvLm5hbWV9YDsKICAgICAgICBjb25zdCBkaWN0ID0gKDAsIF94ZmFfZm9udHMuZ2V0WGZhRm9udERpY3QpKG5hbWUpOwogICAgICAgIHByb21pc2VzLnB1c2gocGFydGlhbEV2YWx1YXRvci5oYW5kbGVTZXRGb250KHJlc291cmNlcywgW19wcmltaXRpdmVzLk5hbWUuZ2V0KG5hbWUpLCAxXSwgbnVsbCwgb3BlcmF0b3JMaXN0LCB0YXNrLCBpbml0aWFsU3RhdGUsIGRpY3QsIHsKICAgICAgICAgIGZvbnRGYW1pbHk6IG1pc3NpbmcsCiAgICAgICAgICBmb250V2VpZ2h0OiBmb250SW5mby5mb250V2VpZ2h0LAogICAgICAgICAgaXRhbGljQW5nbGU6IGZvbnRJbmZvLml0YWxpY0FuZ2xlCiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBsb2FkWGZhRm9udHM6ICIke3JlYXNvbn0iLmApOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSkpOwogICAgICB9CiAgICB9CgogICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpOwogICAgdGhpcy54ZmFGYWN0b3J5LmFwcGVuZEZvbnRzKHBkZkZvbnRzLCByZWFsbHlNaXNzaW5nRm9udHMpOwogIH0KCiAgYXN5bmMgc2VyaWFsaXplWGZhRGF0YShhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgcmV0dXJuIHRoaXMueGZhRmFjdG9yeSA/IHRoaXMueGZhRmFjdG9yeS5zZXJpYWxpemVEYXRhKGFubm90YXRpb25TdG9yYWdlKSA6IG51bGw7CiAgfQoKICBnZXQgZm9ybUluZm8oKSB7CiAgICBjb25zdCBmb3JtSW5mbyA9IHsKICAgICAgaGFzRmllbGRzOiBmYWxzZSwKICAgICAgaGFzQWNyb0Zvcm06IGZhbHNlLAogICAgICBoYXNYZmE6IGZhbHNlLAogICAgICBoYXNTaWduYXR1cmVzOiBmYWxzZQogICAgfTsKICAgIGNvbnN0IGFjcm9Gb3JtID0gdGhpcy5jYXRhbG9nLmFjcm9Gb3JtOwoKICAgIGlmICghYWNyb0Zvcm0pIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJmb3JtSW5mbyIsIGZvcm1JbmZvKTsKICAgIH0KCiAgICB0cnkgewogICAgICBjb25zdCBmaWVsZHMgPSBhY3JvRm9ybS5nZXQoIkZpZWxkcyIpOwogICAgICBjb25zdCBoYXNGaWVsZHMgPSBBcnJheS5pc0FycmF5KGZpZWxkcykgJiYgZmllbGRzLmxlbmd0aCA+IDA7CiAgICAgIGZvcm1JbmZvLmhhc0ZpZWxkcyA9IGhhc0ZpZWxkczsKICAgICAgY29uc3QgeGZhID0gYWNyb0Zvcm0uZ2V0KCJYRkEiKTsKICAgICAgZm9ybUluZm8uaGFzWGZhID0gQXJyYXkuaXNBcnJheSh4ZmEpICYmIHhmYS5sZW5ndGggPiAwIHx8IHhmYSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtICYmICF4ZmEuaXNFbXB0eTsKICAgICAgY29uc3Qgc2lnRmxhZ3MgPSBhY3JvRm9ybS5nZXQoIlNpZ0ZsYWdzIik7CiAgICAgIGNvbnN0IGhhc1NpZ25hdHVyZXMgPSAhIShzaWdGbGFncyAmIDB4MSk7CgogICAgICBjb25zdCBoYXNPbmx5RG9jdW1lbnRTaWduYXR1cmVzID0gaGFzU2lnbmF0dXJlcyAmJiB0aGlzLl9oYXNPbmx5RG9jdW1lbnRTaWduYXR1cmVzKGZpZWxkcyk7CgogICAgICBmb3JtSW5mby5oYXNBY3JvRm9ybSA9IGhhc0ZpZWxkcyAmJiAhaGFzT25seURvY3VtZW50U2lnbmF0dXJlczsKICAgICAgZm9ybUluZm8uaGFzU2lnbmF0dXJlcyA9IGhhc1NpZ25hdHVyZXM7CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGV4OwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoYENhbm5vdCBmZXRjaCBmb3JtIGluZm9ybWF0aW9uOiAiJHtleH0iLmApOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZm9ybUluZm8iLCBmb3JtSW5mbyk7CiAgfQoKICBnZXQgZG9jdW1lbnRJbmZvKCkgewogICAgbGV0IHZlcnNpb24gPSB0aGlzLl92ZXJzaW9uOwoKICAgIGlmICh0eXBlb2YgdmVyc2lvbiAhPT0gInN0cmluZyIgfHwgIVBERl9IRUFERVJfVkVSU0lPTl9SRUdFWFAudGVzdCh2ZXJzaW9uKSkgewogICAgICAoMCwgX3V0aWwud2FybikoYEludmFsaWQgUERGIGhlYWRlciB2ZXJzaW9uIG51bWJlcjogJHt2ZXJzaW9ufWApOwogICAgICB2ZXJzaW9uID0gbnVsbDsKICAgIH0KCiAgICBjb25zdCBkb2NJbmZvID0gewogICAgICBQREZGb3JtYXRWZXJzaW9uOiB2ZXJzaW9uLAogICAgICBMYW5ndWFnZTogdGhpcy5jYXRhbG9nLmxhbmcsCiAgICAgIEVuY3J5cHRGaWx0ZXJOYW1lOiB0aGlzLnhyZWYuZW5jcnlwdCA/IHRoaXMueHJlZi5lbmNyeXB0LmZpbHRlck5hbWUgOiBudWxsLAogICAgICBJc0xpbmVhcml6ZWQ6ICEhdGhpcy5saW5lYXJpemF0aW9uLAogICAgICBJc0Fjcm9Gb3JtUHJlc2VudDogdGhpcy5mb3JtSW5mby5oYXNBY3JvRm9ybSwKICAgICAgSXNYRkFQcmVzZW50OiB0aGlzLmZvcm1JbmZvLmhhc1hmYSwKICAgICAgSXNDb2xsZWN0aW9uUHJlc2VudDogISF0aGlzLmNhdGFsb2cuY29sbGVjdGlvbiwKICAgICAgSXNTaWduYXR1cmVzUHJlc2VudDogdGhpcy5mb3JtSW5mby5oYXNTaWduYXR1cmVzCiAgICB9OwogICAgbGV0IGluZm9EaWN0OwoKICAgIHRyeSB7CiAgICAgIGluZm9EaWN0ID0gdGhpcy54cmVmLnRyYWlsZXIuZ2V0KCJJbmZvIik7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgdGhyb3cgZXJyOwogICAgICB9CgogICAgICAoMCwgX3V0aWwuaW5mbykoIlRoZSBkb2N1bWVudCBpbmZvcm1hdGlvbiBkaWN0aW9uYXJ5IGlzIGludmFsaWQuIik7CiAgICB9CgogICAgaWYgKCEoaW5mb0RpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImRvY3VtZW50SW5mbyIsIGRvY0luZm8pOwogICAgfQoKICAgIGZvciAoY29uc3Qga2V5IG9mIGluZm9EaWN0LmdldEtleXMoKSkgewogICAgICBjb25zdCB2YWx1ZSA9IGluZm9EaWN0LmdldChrZXkpOwoKICAgICAgc3dpdGNoIChrZXkpIHsKICAgICAgICBjYXNlICJUaXRsZSI6CiAgICAgICAgY2FzZSAiQXV0aG9yIjoKICAgICAgICBjYXNlICJTdWJqZWN0IjoKICAgICAgICBjYXNlICJLZXl3b3JkcyI6CiAgICAgICAgY2FzZSAiQ3JlYXRvciI6CiAgICAgICAgY2FzZSAiUHJvZHVjZXIiOgogICAgICAgIGNhc2UgIkNyZWF0aW9uRGF0ZSI6CiAgICAgICAgY2FzZSAiTW9kRGF0ZSI6CiAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgewogICAgICAgICAgICBkb2NJbmZvW2tleV0gPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKHZhbHVlKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlRyYXBwZWQiOgogICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICBkb2NJbmZvW2tleV0gPSB2YWx1ZTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBsZXQgY3VzdG9tVmFsdWU7CgogICAgICAgICAgc3dpdGNoICh0eXBlb2YgdmFsdWUpIHsKICAgICAgICAgICAgY2FzZSAic3RyaW5nIjoKICAgICAgICAgICAgICBjdXN0b21WYWx1ZSA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykodmFsdWUpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjoKICAgICAgICAgICAgY2FzZSAiYm9vbGVhbiI6CiAgICAgICAgICAgICAgY3VzdG9tVmFsdWUgPSB2YWx1ZTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICAgICAgY3VzdG9tVmFsdWUgPSB2YWx1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjdXN0b21WYWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgQmFkIHZhbHVlLCBmb3IgY3VzdG9tIGtleSAiJHtrZXl9IiwgaW4gSW5mbzogJHt2YWx1ZX0uYCk7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghZG9jSW5mby5DdXN0b20pIHsKICAgICAgICAgICAgZG9jSW5mby5DdXN0b20gPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICAgICAgfQoKICAgICAgICAgIGRvY0luZm8uQ3VzdG9tW2tleV0gPSBjdXN0b21WYWx1ZTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoYEJhZCB2YWx1ZSwgZm9yIGtleSAiJHtrZXl9IiwgaW4gSW5mbzogJHt2YWx1ZX0uYCk7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJkb2N1bWVudEluZm8iLCBkb2NJbmZvKTsKICB9CgogIGdldCBmaW5nZXJwcmludHMoKSB7CiAgICBmdW5jdGlvbiB2YWxpZGF0ZShkYXRhKSB7CiAgICAgIHJldHVybiB0eXBlb2YgZGF0YSA9PT0gInN0cmluZyIgJiYgZGF0YS5sZW5ndGggPiAwICYmIGRhdGEgIT09IEVNUFRZX0ZJTkdFUlBSSU5UOwogICAgfQoKICAgIGZ1bmN0aW9uIGhleFN0cmluZyhoYXNoKSB7CiAgICAgIGNvbnN0IGJ1ZiA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gaGFzaC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29uc3QgaGV4ID0gaGFzaFtpXS50b1N0cmluZygxNik7CiAgICAgICAgYnVmLnB1c2goaGV4LnBhZFN0YXJ0KDIsICIwIikpOwogICAgICB9CgogICAgICByZXR1cm4gYnVmLmpvaW4oIiIpOwogICAgfQoKICAgIGNvbnN0IGlkQXJyYXkgPSB0aGlzLnhyZWYudHJhaWxlci5nZXQoIklEIik7CiAgICBsZXQgaGFzaE9yaWdpbmFsLCBoYXNoTW9kaWZpZWQ7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoaWRBcnJheSkgJiYgdmFsaWRhdGUoaWRBcnJheVswXSkpIHsKICAgICAgaGFzaE9yaWdpbmFsID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGlkQXJyYXlbMF0pOwoKICAgICAgaWYgKGlkQXJyYXlbMV0gIT09IGlkQXJyYXlbMF0gJiYgdmFsaWRhdGUoaWRBcnJheVsxXSkpIHsKICAgICAgICBoYXNoTW9kaWZpZWQgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoaWRBcnJheVsxXSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGhhc2hPcmlnaW5hbCA9ICgwLCBfY3J5cHRvLmNhbGN1bGF0ZU1ENSkodGhpcy5zdHJlYW0uZ2V0Qnl0ZVJhbmdlKDAsIEZJTkdFUlBSSU5UX0ZJUlNUX0JZVEVTKSwgMCwgRklOR0VSUFJJTlRfRklSU1RfQllURVMpOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZmluZ2VycHJpbnRzIiwgW2hleFN0cmluZyhoYXNoT3JpZ2luYWwpLCBoYXNoTW9kaWZpZWQgPyBoZXhTdHJpbmcoaGFzaE1vZGlmaWVkKSA6IG51bGxdKTsKICB9CgogIGFzeW5jIF9nZXRMaW5lYXJpemF0aW9uUGFnZShwYWdlSW5kZXgpIHsKICAgIGNvbnN0IHsKICAgICAgY2F0YWxvZywKICAgICAgbGluZWFyaXphdGlvbiwKICAgICAgeHJlZgogICAgfSA9IHRoaXM7CgogICAgY29uc3QgcmVmID0gX3ByaW1pdGl2ZXMuUmVmLmdldChsaW5lYXJpemF0aW9uLm9iamVjdE51bWJlckZpcnN0LCAwKTsKCiAgICB0cnkgewogICAgICBjb25zdCBvYmogPSBhd2FpdCB4cmVmLmZldGNoQXN5bmMocmVmKTsKCiAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgbGV0IHR5cGUgPSBvYmouZ2V0UmF3KCJUeXBlIik7CgogICAgICAgIGlmICh0eXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICB0eXBlID0gYXdhaXQgeHJlZi5mZXRjaEFzeW5jKHR5cGUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHR5cGUsICJQYWdlIikgfHwgIW9iai5oYXMoIlR5cGUiKSAmJiAhb2JqLmhhcygiS2lkcyIpKSB7CiAgICAgICAgICBpZiAoIWNhdGFsb2cucGFnZUtpZHNDb3VudENhY2hlLmhhcyhyZWYpKSB7CiAgICAgICAgICAgIGNhdGFsb2cucGFnZUtpZHNDb3VudENhY2hlLnB1dChyZWYsIDEpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghY2F0YWxvZy5wYWdlSW5kZXhDYWNoZS5oYXMocmVmKSkgewogICAgICAgICAgICBjYXRhbG9nLnBhZ2VJbmRleENhY2hlLnB1dChyZWYsIDApOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBbb2JqLCByZWZdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJUaGUgTGluZWFyaXphdGlvbiBkaWN0aW9uYXJ5IGRvZXNuJ3QgcG9pbnQgdG8gYSB2YWxpZCBQYWdlIGRpY3Rpb25hcnkuIik7CiAgICB9IGNhdGNoIChyZWFzb24pIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBfZ2V0TGluZWFyaXphdGlvblBhZ2U6ICIke3JlYXNvbi5tZXNzYWdlfSIuYCk7CiAgICAgIHJldHVybiBjYXRhbG9nLmdldFBhZ2VEaWN0KHBhZ2VJbmRleCk7CiAgICB9CiAgfQoKICBnZXRQYWdlKHBhZ2VJbmRleCkgewogICAgY29uc3QgY2FjaGVkUHJvbWlzZSA9IHRoaXMuX3BhZ2VQcm9taXNlcy5nZXQocGFnZUluZGV4KTsKCiAgICBpZiAoY2FjaGVkUHJvbWlzZSkgewogICAgICByZXR1cm4gY2FjaGVkUHJvbWlzZTsKICAgIH0KCiAgICBjb25zdCB7CiAgICAgIGNhdGFsb2csCiAgICAgIGxpbmVhcml6YXRpb24sCiAgICAgIHhmYUZhY3RvcnkKICAgIH0gPSB0aGlzOwogICAgbGV0IHByb21pc2U7CgogICAgaWYgKHhmYUZhY3RvcnkpIHsKICAgICAgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShbX3ByaW1pdGl2ZXMuRGljdC5lbXB0eSwgbnVsbF0pOwogICAgfSBlbHNlIGlmIChsaW5lYXJpemF0aW9uICYmIGxpbmVhcml6YXRpb24ucGFnZUZpcnN0ID09PSBwYWdlSW5kZXgpIHsKICAgICAgcHJvbWlzZSA9IHRoaXMuX2dldExpbmVhcml6YXRpb25QYWdlKHBhZ2VJbmRleCk7CiAgICB9IGVsc2UgewogICAgICBwcm9taXNlID0gY2F0YWxvZy5nZXRQYWdlRGljdChwYWdlSW5kZXgpOwogICAgfQoKICAgIHByb21pc2UgPSBwcm9taXNlLnRoZW4oX3JlZjcgPT4gewogICAgICBsZXQgW3BhZ2VEaWN0LCByZWZdID0gX3JlZjc7CiAgICAgIHJldHVybiBuZXcgUGFnZSh7CiAgICAgICAgcGRmTWFuYWdlcjogdGhpcy5wZGZNYW5hZ2VyLAogICAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgICBwYWdlSW5kZXgsCiAgICAgICAgcGFnZURpY3QsCiAgICAgICAgcmVmLAogICAgICAgIGdsb2JhbElkRmFjdG9yeTogdGhpcy5fZ2xvYmFsSWRGYWN0b3J5LAogICAgICAgIGZvbnRDYWNoZTogY2F0YWxvZy5mb250Q2FjaGUsCiAgICAgICAgYnVpbHRJbkNNYXBDYWNoZTogY2F0YWxvZy5idWlsdEluQ01hcENhY2hlLAogICAgICAgIHN0YW5kYXJkRm9udERhdGFDYWNoZTogY2F0YWxvZy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUsCiAgICAgICAgZ2xvYmFsSW1hZ2VDYWNoZTogY2F0YWxvZy5nbG9iYWxJbWFnZUNhY2hlLAogICAgICAgIG5vbkJsZW5kTW9kZXNTZXQ6IGNhdGFsb2cubm9uQmxlbmRNb2Rlc1NldCwKICAgICAgICB4ZmFGYWN0b3J5CiAgICAgIH0pOwogICAgfSk7CgogICAgdGhpcy5fcGFnZVByb21pc2VzLnNldChwYWdlSW5kZXgsIHByb21pc2UpOwoKICAgIHJldHVybiBwcm9taXNlOwogIH0KCiAgYXN5bmMgY2hlY2tGaXJzdFBhZ2UoKSB7CiAgICBsZXQgcmVjb3ZlcnlNb2RlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKCiAgICBpZiAocmVjb3ZlcnlNb2RlKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0cnkgewogICAgICBhd2FpdCB0aGlzLmdldFBhZ2UoMCk7CiAgICB9IGNhdGNoIChyZWFzb24pIHsKICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLlhSZWZFbnRyeUV4Y2VwdGlvbikgewogICAgICAgIHRoaXMuX3BhZ2VQcm9taXNlcy5kZWxldGUoMCk7CgogICAgICAgIGF3YWl0IHRoaXMuY2xlYW51cCgpOwogICAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5YUmVmUGFyc2VFeGNlcHRpb24oKTsKICAgICAgfQogICAgfQogIH0KCiAgYXN5bmMgY2hlY2tMYXN0UGFnZSgpIHsKICAgIGxldCByZWNvdmVyeU1vZGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgY29uc3QgewogICAgICBjYXRhbG9nLAogICAgICBwZGZNYW5hZ2VyCiAgICB9ID0gdGhpczsKICAgIGNhdGFsb2cuc2V0QWN0dWFsTnVtUGFnZXMoKTsKICAgIGxldCBudW1QYWdlczsKCiAgICB0cnkgewogICAgICBhd2FpdCBQcm9taXNlLmFsbChbcGRmTWFuYWdlci5lbnN1cmVEb2MoInhmYUZhY3RvcnkiKSwgcGRmTWFuYWdlci5lbnN1cmVEb2MoImxpbmVhcml6YXRpb24iKSwgcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJudW1QYWdlcyIpXSk7CgogICAgICBpZiAodGhpcy54ZmFGYWN0b3J5KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMubGluZWFyaXphdGlvbikgewogICAgICAgIG51bVBhZ2VzID0gdGhpcy5saW5lYXJpemF0aW9uLm51bVBhZ2VzOwogICAgICB9IGVsc2UgewogICAgICAgIG51bVBhZ2VzID0gY2F0YWxvZy5udW1QYWdlczsKICAgICAgfQoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKG51bVBhZ2VzKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUGFnZSBjb3VudCBpcyBub3QgYW4gaW50ZWdlci4iKTsKICAgICAgfSBlbHNlIGlmIChudW1QYWdlcyA8PSAxKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBhd2FpdCB0aGlzLmdldFBhZ2UobnVtUGFnZXMgLSAxKTsKICAgIH0gY2F0Y2ggKHJlYXNvbikgewogICAgICB0aGlzLl9wYWdlUHJvbWlzZXMuZGVsZXRlKG51bVBhZ2VzIC0gMSk7CgogICAgICBhd2FpdCB0aGlzLmNsZWFudXAoKTsKCiAgICAgIGlmIChyZWFzb24gaW5zdGFuY2VvZiBfY29yZV91dGlscy5YUmVmRW50cnlFeGNlcHRpb24gJiYgIXJlY292ZXJ5TW9kZSkgewogICAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5YUmVmUGFyc2VFeGNlcHRpb24oKTsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGBjaGVja0xhc3RQYWdlIC0gaW52YWxpZCAvUGFnZXMgdHJlZSAvQ291bnQ6ICR7bnVtUGFnZXN9LmApOwogICAgICBsZXQgcGFnZXNUcmVlOwoKICAgICAgdHJ5IHsKICAgICAgICBwYWdlc1RyZWUgPSBhd2FpdCBjYXRhbG9nLmdldEFsbFBhZ2VEaWN0cyhyZWNvdmVyeU1vZGUpOwogICAgICB9IGNhdGNoIChyZWFzb25BbGwpIHsKICAgICAgICBpZiAocmVhc29uQWxsIGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuWFJlZkVudHJ5RXhjZXB0aW9uICYmICFyZWNvdmVyeU1vZGUpIHsKICAgICAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5YUmVmUGFyc2VFeGNlcHRpb24oKTsKICAgICAgICB9CgogICAgICAgIGNhdGFsb2cuc2V0QWN0dWFsTnVtUGFnZXMoMSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBmb3IgKGNvbnN0IFtwYWdlSW5kZXgsIFtwYWdlRGljdCwgcmVmXV0gb2YgcGFnZXNUcmVlKSB7CiAgICAgICAgbGV0IHByb21pc2U7CgogICAgICAgIGlmIChwYWdlRGljdCBpbnN0YW5jZW9mIEVycm9yKSB7CiAgICAgICAgICBwcm9taXNlID0gUHJvbWlzZS5yZWplY3QocGFnZURpY3QpOwogICAgICAgICAgcHJvbWlzZS5jYXRjaCgoKSA9PiB7fSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUobmV3IFBhZ2UoewogICAgICAgICAgICBwZGZNYW5hZ2VyLAogICAgICAgICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgICAgICAgIHBhZ2VJbmRleCwKICAgICAgICAgICAgcGFnZURpY3QsCiAgICAgICAgICAgIHJlZiwKICAgICAgICAgICAgZ2xvYmFsSWRGYWN0b3J5OiB0aGlzLl9nbG9iYWxJZEZhY3RvcnksCiAgICAgICAgICAgIGZvbnRDYWNoZTogY2F0YWxvZy5mb250Q2FjaGUsCiAgICAgICAgICAgIGJ1aWx0SW5DTWFwQ2FjaGU6IGNhdGFsb2cuYnVpbHRJbkNNYXBDYWNoZSwKICAgICAgICAgICAgc3RhbmRhcmRGb250RGF0YUNhY2hlOiBjYXRhbG9nLnN0YW5kYXJkRm9udERhdGFDYWNoZSwKICAgICAgICAgICAgZ2xvYmFsSW1hZ2VDYWNoZTogY2F0YWxvZy5nbG9iYWxJbWFnZUNhY2hlLAogICAgICAgICAgICBub25CbGVuZE1vZGVzU2V0OiBjYXRhbG9nLm5vbkJsZW5kTW9kZXNTZXQsCiAgICAgICAgICAgIHhmYUZhY3Rvcnk6IG51bGwKICAgICAgICAgIH0pKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuX3BhZ2VQcm9taXNlcy5zZXQocGFnZUluZGV4LCBwcm9taXNlKTsKICAgICAgfQoKICAgICAgY2F0YWxvZy5zZXRBY3R1YWxOdW1QYWdlcyhwYWdlc1RyZWUuc2l6ZSk7CiAgICB9CiAgfQoKICBmb250RmFsbGJhY2soaWQsIGhhbmRsZXIpIHsKICAgIHJldHVybiB0aGlzLmNhdGFsb2cuZm9udEZhbGxiYWNrKGlkLCBoYW5kbGVyKTsKICB9CgogIGFzeW5jIGNsZWFudXAoKSB7CiAgICBsZXQgbWFudWFsbHlUcmlnZ2VyZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgcmV0dXJuIHRoaXMuY2F0YWxvZyA/IHRoaXMuY2F0YWxvZy5jbGVhbnVwKG1hbnVhbGx5VHJpZ2dlcmVkKSA6ICgwLCBfY2xlYW51cF9oZWxwZXIuY2xlYXJHbG9iYWxDYWNoZXMpKCk7CiAgfQoKICBfY29sbGVjdEZpZWxkT2JqZWN0cyhuYW1lLCBmaWVsZFJlZiwgcHJvbWlzZXMpIHsKICAgIGNvbnN0IGZpZWxkID0gdGhpcy54cmVmLmZldGNoSWZSZWYoZmllbGRSZWYpOwoKICAgIGlmIChmaWVsZC5oYXMoIlQiKSkgewogICAgICBjb25zdCBwYXJ0TmFtZSA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZmllbGQuZ2V0KCJUIikpOwoKICAgICAgaWYgKG5hbWUgPT09ICIiKSB7CiAgICAgICAgbmFtZSA9IHBhcnROYW1lOwogICAgICB9IGVsc2UgewogICAgICAgIG5hbWUgPSBgJHtuYW1lfS4ke3BhcnROYW1lfWA7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXByb21pc2VzLmhhcyhuYW1lKSkgewogICAgICBwcm9taXNlcy5zZXQobmFtZSwgW10pOwogICAgfQoKICAgIHByb21pc2VzLmdldChuYW1lKS5wdXNoKF9hbm5vdGF0aW9uLkFubm90YXRpb25GYWN0b3J5LmNyZWF0ZSh0aGlzLnhyZWYsIGZpZWxkUmVmLCB0aGlzLnBkZk1hbmFnZXIsIHRoaXMuX2xvY2FsSWRGYWN0b3J5LCB0cnVlKS50aGVuKGFubm90YXRpb24gPT4gYW5ub3RhdGlvbiAmJiBhbm5vdGF0aW9uLmdldEZpZWxkT2JqZWN0KCkpLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBfY29sbGVjdEZpZWxkT2JqZWN0czogIiR7cmVhc29ufSIuYCk7CiAgICAgIHJldHVybiBudWxsOwogICAgfSkpOwoKICAgIGlmIChmaWVsZC5oYXMoIktpZHMiKSkgewogICAgICBjb25zdCBraWRzID0gZmllbGQuZ2V0KCJLaWRzIik7CgogICAgICBmb3IgKGNvbnN0IGtpZCBvZiBraWRzKSB7CiAgICAgICAgdGhpcy5fY29sbGVjdEZpZWxkT2JqZWN0cyhuYW1lLCBraWQsIHByb21pc2VzKTsKICAgICAgfQogICAgfQogIH0KCiAgZ2V0IGZpZWxkT2JqZWN0cygpIHsKICAgIGlmICghdGhpcy5mb3JtSW5mby5oYXNGaWVsZHMpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJmaWVsZE9iamVjdHMiLCBQcm9taXNlLnJlc29sdmUobnVsbCkpOwogICAgfQoKICAgIGNvbnN0IGFsbEZpZWxkcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICBjb25zdCBmaWVsZFByb21pc2VzID0gbmV3IE1hcCgpOwoKICAgIGZvciAoY29uc3QgZmllbGRSZWYgb2YgdGhpcy5jYXRhbG9nLmFjcm9Gb3JtLmdldCgiRmllbGRzIikpIHsKICAgICAgdGhpcy5fY29sbGVjdEZpZWxkT2JqZWN0cygiIiwgZmllbGRSZWYsIGZpZWxkUHJvbWlzZXMpOwogICAgfQoKICAgIGNvbnN0IGFsbFByb21pc2VzID0gW107CgogICAgZm9yIChjb25zdCBbbmFtZSwgcHJvbWlzZXNdIG9mIGZpZWxkUHJvbWlzZXMpIHsKICAgICAgYWxsUHJvbWlzZXMucHVzaChQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmaWVsZHMgPT4gewogICAgICAgIGZpZWxkcyA9IGZpZWxkcy5maWx0ZXIoZmllbGQgPT4gISFmaWVsZCk7CgogICAgICAgIGlmIChmaWVsZHMubGVuZ3RoID4gMCkgewogICAgICAgICAgYWxsRmllbGRzW25hbWVdID0gZmllbGRzOwogICAgICAgIH0KICAgICAgfSkpOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZmllbGRPYmplY3RzIiwgUHJvbWlzZS5hbGwoYWxsUHJvbWlzZXMpLnRoZW4oKCkgPT4gYWxsRmllbGRzKSk7CiAgfQoKICBnZXQgaGFzSlNBY3Rpb25zKCkgewogICAgY29uc3QgcHJvbWlzZSA9IHRoaXMucGRmTWFuYWdlci5lbnN1cmVEb2MoIl9wYXJzZUhhc0pTQWN0aW9ucyIpOwogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJoYXNKU0FjdGlvbnMiLCBwcm9taXNlKTsKICB9CgogIGFzeW5jIF9wYXJzZUhhc0pTQWN0aW9ucygpIHsKICAgIGNvbnN0IFtjYXRhbG9nSnNBY3Rpb25zLCBmaWVsZE9iamVjdHNdID0gYXdhaXQgUHJvbWlzZS5hbGwoW3RoaXMucGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJqc0FjdGlvbnMiKSwgdGhpcy5wZGZNYW5hZ2VyLmVuc3VyZURvYygiZmllbGRPYmplY3RzIildKTsKCiAgICBpZiAoY2F0YWxvZ0pzQWN0aW9ucykgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBpZiAoZmllbGRPYmplY3RzKSB7CiAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKGZpZWxkT2JqZWN0cykuc29tZShmaWVsZE9iamVjdCA9PiBmaWVsZE9iamVjdC5zb21lKG9iamVjdCA9PiBvYmplY3QuYWN0aW9ucyAhPT0gbnVsbCkpOwogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGdldCBjYWxjdWxhdGlvbk9yZGVySWRzKCkgewogICAgY29uc3QgYWNyb0Zvcm0gPSB0aGlzLmNhdGFsb2cuYWNyb0Zvcm07CgogICAgaWYgKCFhY3JvRm9ybSB8fCAhYWNyb0Zvcm0uaGFzKCJDTyIpKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiY2FsY3VsYXRpb25PcmRlcklkcyIsIG51bGwpOwogICAgfQoKICAgIGNvbnN0IGNhbGN1bGF0aW9uT3JkZXIgPSBhY3JvRm9ybS5nZXQoIkNPIik7CgogICAgaWYgKCFBcnJheS5pc0FycmF5KGNhbGN1bGF0aW9uT3JkZXIpIHx8IGNhbGN1bGF0aW9uT3JkZXIubGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiY2FsY3VsYXRpb25PcmRlcklkcyIsIG51bGwpOwogICAgfQoKICAgIGNvbnN0IGlkcyA9IFtdOwoKICAgIGZvciAoY29uc3QgaWQgb2YgY2FsY3VsYXRpb25PcmRlcikgewogICAgICBpZiAoaWQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICBpZHMucHVzaChpZC50b1N0cmluZygpKTsKICAgICAgfQogICAgfQoKICAgIGlmIChpZHMubGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiY2FsY3VsYXRpb25PcmRlcklkcyIsIG51bGwpOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiY2FsY3VsYXRpb25PcmRlcklkcyIsIGlkcyk7CiAgfQoKfQoKZXhwb3J0cy5QREZEb2N1bWVudCA9IFBERkRvY3VtZW50OwoKLyoqKi8gfSksCi8qIDEzNyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuUG9wdXBBbm5vdGF0aW9uID0gZXhwb3J0cy5NYXJrdXBBbm5vdGF0aW9uID0gZXhwb3J0cy5Bbm5vdGF0aW9uRmFjdG9yeSA9IGV4cG9ydHMuQW5ub3RhdGlvbkJvcmRlclN0eWxlID0gZXhwb3J0cy5Bbm5vdGF0aW9uID0gdm9pZCAwOwpleHBvcnRzLmdldFF1YWRQb2ludHMgPSBnZXRRdWFkUG9pbnRzOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMxKTsKCnZhciBfZGVmYXVsdF9hcHBlYXJhbmNlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzgpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwoKdmFyIF93cml0ZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5MCk7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzIpOwoKdmFyIF9iaWRpID0gX193X3BkZmpzX3JlcXVpcmVfXygxODUpOwoKdmFyIF9jYXRhbG9nID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTQpOwoKdmFyIF9jb2xvcnNwYWNlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzkpOwoKdmFyIF9maWxlX3NwZWMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5Nyk7Cgp2YXIgX29iamVjdF9sb2FkZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMCk7Cgp2YXIgX29wZXJhdG9yX2xpc3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE4Nyk7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTM1KTsKCnZhciBfZmFjdG9yeSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAxKTsKCmNsYXNzIEFubm90YXRpb25GYWN0b3J5IHsKICBzdGF0aWMgY3JlYXRlKHhyZWYsIHJlZiwgcGRmTWFuYWdlciwgaWRGYWN0b3J5LCBjb2xsZWN0RmllbGRzKSB7CiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3BkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygiYWNyb0Zvcm0iKSwgcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJiYXNlVXJsIiksIHBkZk1hbmFnZXIuZW5zdXJlRG9jKCJ4ZmFEYXRhc2V0cyIpLCBjb2xsZWN0RmllbGRzID8gdGhpcy5fZ2V0UGFnZUluZGV4KHhyZWYsIHJlZiwgcGRmTWFuYWdlcikgOiAtMV0pLnRoZW4oX3JlZiA9PiB7CiAgICAgIGxldCBbYWNyb0Zvcm0sIGJhc2VVcmwsIHhmYURhdGFzZXRzLCBwYWdlSW5kZXhdID0gX3JlZjsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlKHRoaXMsICJfY3JlYXRlIiwgW3hyZWYsIHJlZiwgcGRmTWFuYWdlciwgaWRGYWN0b3J5LCBhY3JvRm9ybSwgeGZhRGF0YXNldHMsIGNvbGxlY3RGaWVsZHMsIHBhZ2VJbmRleF0pOwogICAgfSk7CiAgfQoKICBzdGF0aWMgX2NyZWF0ZSh4cmVmLCByZWYsIHBkZk1hbmFnZXIsIGlkRmFjdG9yeSwgYWNyb0Zvcm0sIHhmYURhdGFzZXRzLCBjb2xsZWN0RmllbGRzKSB7CiAgICBsZXQgcGFnZUluZGV4ID0gYXJndW1lbnRzLmxlbmd0aCA+IDcgJiYgYXJndW1lbnRzWzddICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbN10gOiAtMTsKICAgIGNvbnN0IGRpY3QgPSB4cmVmLmZldGNoSWZSZWYocmVmKTsKCiAgICBpZiAoIShkaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICBjb25zdCBpZCA9IHJlZiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZiA/IHJlZi50b1N0cmluZygpIDogYGFubm90XyR7aWRGYWN0b3J5LmNyZWF0ZU9iaklkKCl9YDsKICAgIGxldCBzdWJ0eXBlID0gZGljdC5nZXQoIlN1YnR5cGUiKTsKICAgIHN1YnR5cGUgPSBzdWJ0eXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IHN1YnR5cGUubmFtZSA6IG51bGw7CiAgICBjb25zdCBwYXJhbWV0ZXJzID0gewogICAgICB4cmVmLAogICAgICByZWYsCiAgICAgIGRpY3QsCiAgICAgIHN1YnR5cGUsCiAgICAgIGlkLAogICAgICBwZGZNYW5hZ2VyLAogICAgICBhY3JvRm9ybTogYWNyb0Zvcm0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ID8gYWNyb0Zvcm0gOiBfcHJpbWl0aXZlcy5EaWN0LmVtcHR5LAogICAgICB4ZmFEYXRhc2V0cywKICAgICAgY29sbGVjdEZpZWxkcywKICAgICAgcGFnZUluZGV4CiAgICB9OwoKICAgIHN3aXRjaCAoc3VidHlwZSkgewogICAgICBjYXNlICJMaW5rIjoKICAgICAgICByZXR1cm4gbmV3IExpbmtBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiVGV4dCI6CiAgICAgICAgcmV0dXJuIG5ldyBUZXh0QW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgIGNhc2UgIldpZGdldCI6CiAgICAgICAgbGV0IGZpZWxkVHlwZSA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgICAgICBkaWN0LAogICAgICAgICAga2V5OiAiRlQiCiAgICAgICAgfSk7CiAgICAgICAgZmllbGRUeXBlID0gZmllbGRUeXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IGZpZWxkVHlwZS5uYW1lIDogbnVsbDsKCiAgICAgICAgc3dpdGNoIChmaWVsZFR5cGUpIHsKICAgICAgICAgIGNhc2UgIlR4IjoKICAgICAgICAgICAgcmV0dXJuIG5ldyBUZXh0V2lkZ2V0QW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgICBjYXNlICJCdG4iOgogICAgICAgICAgICByZXR1cm4gbmV3IEJ1dHRvbldpZGdldEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICAgICAgY2FzZSAiQ2giOgogICAgICAgICAgICByZXR1cm4gbmV3IENob2ljZVdpZGdldEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICAgICAgY2FzZSAiU2lnIjoKICAgICAgICAgICAgcmV0dXJuIG5ldyBTaWduYXR1cmVXaWRnZXRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwogICAgICAgIH0KCiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBVbmltcGxlbWVudGVkIHdpZGdldCBmaWVsZCB0eXBlICIke2ZpZWxkVHlwZX0iLCBgICsgImZhbGxpbmcgYmFjayB0byBiYXNlIGZpZWxkIHR5cGUuIik7CiAgICAgICAgcmV0dXJuIG5ldyBXaWRnZXRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiUG9wdXAiOgogICAgICAgIHJldHVybiBuZXcgUG9wdXBBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiRnJlZVRleHQiOgogICAgICAgIHJldHVybiBuZXcgRnJlZVRleHRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiTGluZSI6CiAgICAgICAgcmV0dXJuIG5ldyBMaW5lQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgIGNhc2UgIlNxdWFyZSI6CiAgICAgICAgcmV0dXJuIG5ldyBTcXVhcmVBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiQ2lyY2xlIjoKICAgICAgICByZXR1cm4gbmV3IENpcmNsZUFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJQb2x5TGluZSI6CiAgICAgICAgcmV0dXJuIG5ldyBQb2x5bGluZUFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJQb2x5Z29uIjoKICAgICAgICByZXR1cm4gbmV3IFBvbHlnb25Bbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiQ2FyZXQiOgogICAgICAgIHJldHVybiBuZXcgQ2FyZXRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiSW5rIjoKICAgICAgICByZXR1cm4gbmV3IElua0Fubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJIaWdobGlnaHQiOgogICAgICAgIHJldHVybiBuZXcgSGlnaGxpZ2h0QW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgIGNhc2UgIlVuZGVybGluZSI6CiAgICAgICAgcmV0dXJuIG5ldyBVbmRlcmxpbmVBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiU3F1aWdnbHkiOgogICAgICAgIHJldHVybiBuZXcgU3F1aWdnbHlBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiU3RyaWtlT3V0IjoKICAgICAgICByZXR1cm4gbmV3IFN0cmlrZU91dEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJTdGFtcCI6CiAgICAgICAgcmV0dXJuIG5ldyBTdGFtcEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJGaWxlQXR0YWNobWVudCI6CiAgICAgICAgcmV0dXJuIG5ldyBGaWxlQXR0YWNobWVudEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBkZWZhdWx0OgogICAgICAgIGlmICghY29sbGVjdEZpZWxkcykgewogICAgICAgICAgaWYgKCFzdWJ0eXBlKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiQW5ub3RhdGlvbiBpcyBtaXNzaW5nIHRoZSByZXF1aXJlZCAvU3VidHlwZS4iKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgVW5pbXBsZW1lbnRlZCBhbm5vdGF0aW9uIHR5cGUgIiR7c3VidHlwZX0iLCBgICsgImZhbGxpbmcgYmFjayB0byBiYXNlIGFubm90YXRpb24uIik7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3IEFubm90YXRpb24ocGFyYW1ldGVycyk7CiAgICB9CiAgfQoKICBzdGF0aWMgYXN5bmMgX2dldFBhZ2VJbmRleCh4cmVmLCByZWYsIHBkZk1hbmFnZXIpIHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IGFubm90RGljdCA9IGF3YWl0IHhyZWYuZmV0Y2hJZlJlZkFzeW5jKHJlZik7CgogICAgICBpZiAoIShhbm5vdERpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgIHJldHVybiAtMTsKICAgICAgfQoKICAgICAgY29uc3QgcGFnZVJlZiA9IGFubm90RGljdC5nZXRSYXcoIlAiKTsKCiAgICAgIGlmICghKHBhZ2VSZWYgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9CgogICAgICBjb25zdCBwYWdlSW5kZXggPSBhd2FpdCBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coImdldFBhZ2VJbmRleCIsIFtwYWdlUmVmXSk7CiAgICAgIHJldHVybiBwYWdlSW5kZXg7CiAgICB9IGNhdGNoIChleCkgewogICAgICAoMCwgX3V0aWwud2FybikoYF9nZXRQYWdlSW5kZXg6ICIke2V4fSIuYCk7CiAgICAgIHJldHVybiAtMTsKICAgIH0KICB9CgogIHN0YXRpYyBhc3luYyBzYXZlTmV3QW5ub3RhdGlvbnMoZXZhbHVhdG9yLCB0YXNrLCBhbm5vdGF0aW9ucykgewogICAgY29uc3QgeHJlZiA9IGV2YWx1YXRvci54cmVmOwogICAgbGV0IGJhc2VGb250UmVmOwogICAgY29uc3QgZGVwZW5kZW5jaWVzID0gW107CiAgICBjb25zdCBwcm9taXNlcyA9IFtdOwoKICAgIGZvciAoY29uc3QgYW5ub3RhdGlvbiBvZiBhbm5vdGF0aW9ucykgewogICAgICBzd2l0Y2ggKGFubm90YXRpb24uYW5ub3RhdGlvblR5cGUpIHsKICAgICAgICBjYXNlIF91dGlsLkFubm90YXRpb25FZGl0b3JUeXBlLkZSRUVURVhUOgogICAgICAgICAgaWYgKCFiYXNlRm9udFJlZikgewogICAgICAgICAgICBjb25zdCBiYXNlRm9udCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgICAgICAgICBiYXNlRm9udC5zZXQoIkJhc2VGb250IiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkhlbHZldGljYSIpKTsKICAgICAgICAgICAgYmFzZUZvbnQuc2V0KCJUeXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZvbnQiKSk7CiAgICAgICAgICAgIGJhc2VGb250LnNldCgiU3VidHlwZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJUeXBlMSIpKTsKICAgICAgICAgICAgYmFzZUZvbnQuc2V0KCJFbmNvZGluZyIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJXaW5BbnNpRW5jb2RpbmciKSk7CiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IFtdOwogICAgICAgICAgICBiYXNlRm9udFJlZiA9IHhyZWYuZ2V0TmV3UmVmKCk7CiAgICAgICAgICAgICgwLCBfd3JpdGVyLndyaXRlT2JqZWN0KShiYXNlRm9udFJlZiwgYmFzZUZvbnQsIGJ1ZmZlciwgbnVsbCk7CiAgICAgICAgICAgIGRlcGVuZGVuY2llcy5wdXNoKHsKICAgICAgICAgICAgICByZWY6IGJhc2VGb250UmVmLAogICAgICAgICAgICAgIGRhdGE6IGJ1ZmZlci5qb2luKCIiKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBwcm9taXNlcy5wdXNoKEZyZWVUZXh0QW5ub3RhdGlvbi5jcmVhdGVOZXdBbm5vdGF0aW9uKHhyZWYsIGFubm90YXRpb24sIGRlcGVuZGVuY2llcywgewogICAgICAgICAgICBldmFsdWF0b3IsCiAgICAgICAgICAgIHRhc2ssCiAgICAgICAgICAgIGJhc2VGb250UmVmCiAgICAgICAgICB9KSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBfdXRpbC5Bbm5vdGF0aW9uRWRpdG9yVHlwZS5JTks6CiAgICAgICAgICBwcm9taXNlcy5wdXNoKElua0Fubm90YXRpb24uY3JlYXRlTmV3QW5ub3RhdGlvbih4cmVmLCBhbm5vdGF0aW9uLCBkZXBlbmRlbmNpZXMpKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGFubm90YXRpb25zOiBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyksCiAgICAgIGRlcGVuZGVuY2llcwogICAgfTsKICB9CgogIHN0YXRpYyBhc3luYyBwcmludE5ld0Fubm90YXRpb25zKGV2YWx1YXRvciwgdGFzaywgYW5ub3RhdGlvbnMpIHsKICAgIGlmICghYW5ub3RhdGlvbnMpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3QgeHJlZiA9IGV2YWx1YXRvci54cmVmOwogICAgY29uc3QgcHJvbWlzZXMgPSBbXTsKCiAgICBmb3IgKGNvbnN0IGFubm90YXRpb24gb2YgYW5ub3RhdGlvbnMpIHsKICAgICAgc3dpdGNoIChhbm5vdGF0aW9uLmFubm90YXRpb25UeXBlKSB7CiAgICAgICAgY2FzZSBfdXRpbC5Bbm5vdGF0aW9uRWRpdG9yVHlwZS5GUkVFVEVYVDoKICAgICAgICAgIHByb21pc2VzLnB1c2goRnJlZVRleHRBbm5vdGF0aW9uLmNyZWF0ZU5ld1ByaW50QW5ub3RhdGlvbih4cmVmLCBhbm5vdGF0aW9uLCB7CiAgICAgICAgICAgIGV2YWx1YXRvciwKICAgICAgICAgICAgdGFzawogICAgICAgICAgfSkpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgX3V0aWwuQW5ub3RhdGlvbkVkaXRvclR5cGUuSU5LOgogICAgICAgICAgcHJvbWlzZXMucHVzaChJbmtBbm5vdGF0aW9uLmNyZWF0ZU5ld1ByaW50QW5ub3RhdGlvbih4cmVmLCBhbm5vdGF0aW9uKSk7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7CiAgfQoKfQoKZXhwb3J0cy5Bbm5vdGF0aW9uRmFjdG9yeSA9IEFubm90YXRpb25GYWN0b3J5OwoKZnVuY3Rpb24gZ2V0UmdiQ29sb3IoY29sb3IpIHsKICBsZXQgZGVmYXVsdENvbG9yID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBuZXcgVWludDhDbGFtcGVkQXJyYXkoMyk7CgogIGlmICghQXJyYXkuaXNBcnJheShjb2xvcikpIHsKICAgIHJldHVybiBkZWZhdWx0Q29sb3I7CiAgfQoKICBjb25zdCByZ2JDb2xvciA9IGRlZmF1bHRDb2xvciB8fCBuZXcgVWludDhDbGFtcGVkQXJyYXkoMyk7CgogIHN3aXRjaCAoY29sb3IubGVuZ3RoKSB7CiAgICBjYXNlIDA6CiAgICAgIHJldHVybiBudWxsOwoKICAgIGNhc2UgMToKICAgICAgX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmdyYXkuZ2V0UmdiSXRlbShjb2xvciwgMCwgcmdiQ29sb3IsIDApOwoKICAgICAgcmV0dXJuIHJnYkNvbG9yOwoKICAgIGNhc2UgMzoKICAgICAgX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLnJnYi5nZXRSZ2JJdGVtKGNvbG9yLCAwLCByZ2JDb2xvciwgMCk7CgogICAgICByZXR1cm4gcmdiQ29sb3I7CgogICAgY2FzZSA0OgogICAgICBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuY215ay5nZXRSZ2JJdGVtKGNvbG9yLCAwLCByZ2JDb2xvciwgMCk7CgogICAgICByZXR1cm4gcmdiQ29sb3I7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIGRlZmF1bHRDb2xvcjsKICB9Cn0KCmZ1bmN0aW9uIGdldFF1YWRQb2ludHMoZGljdCwgcmVjdCkgewogIGlmICghZGljdC5oYXMoIlF1YWRQb2ludHMiKSkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBjb25zdCBxdWFkUG9pbnRzID0gZGljdC5nZXRBcnJheSgiUXVhZFBvaW50cyIpOwoKICBpZiAoIUFycmF5LmlzQXJyYXkocXVhZFBvaW50cykgfHwgcXVhZFBvaW50cy5sZW5ndGggPT09IDAgfHwgcXVhZFBvaW50cy5sZW5ndGggJSA4ID4gMCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBjb25zdCBxdWFkUG9pbnRzTGlzdHMgPSBbXTsKCiAgZm9yIChsZXQgaSA9IDAsIGlpID0gcXVhZFBvaW50cy5sZW5ndGggLyA4OyBpIDwgaWk7IGkrKykgewogICAgcXVhZFBvaW50c0xpc3RzLnB1c2goW10pOwoKICAgIGZvciAobGV0IGogPSBpICogOCwgamogPSBpICogOCArIDg7IGogPCBqajsgaiArPSAyKSB7CiAgICAgIGNvbnN0IHggPSBxdWFkUG9pbnRzW2pdOwogICAgICBjb25zdCB5ID0gcXVhZFBvaW50c1tqICsgMV07CgogICAgICBpZiAocmVjdCAhPT0gbnVsbCAmJiAoeCA8IHJlY3RbMF0gfHwgeCA+IHJlY3RbMl0gfHwgeSA8IHJlY3RbMV0gfHwgeSA+IHJlY3RbM10pKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHF1YWRQb2ludHNMaXN0c1tpXS5wdXNoKHsKICAgICAgICB4LAogICAgICAgIHkKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gcXVhZFBvaW50c0xpc3RzLm1hcChxdWFkUG9pbnRzTGlzdCA9PiB7CiAgICBjb25zdCBbbWluWCwgbWF4WCwgbWluWSwgbWF4WV0gPSBxdWFkUG9pbnRzTGlzdC5yZWR1Y2UoKF9yZWYyLCBxdWFkUG9pbnQpID0+IHsKICAgICAgbGV0IFttWCwgTVgsIG1ZLCBNWV0gPSBfcmVmMjsKICAgICAgcmV0dXJuIFtNYXRoLm1pbihtWCwgcXVhZFBvaW50LngpLCBNYXRoLm1heChNWCwgcXVhZFBvaW50LngpLCBNYXRoLm1pbihtWSwgcXVhZFBvaW50LnkpLCBNYXRoLm1heChNWSwgcXVhZFBvaW50LnkpXTsKICAgIH0sIFtOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUlOX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUlOX1ZBTFVFXSk7CiAgICByZXR1cm4gW3sKICAgICAgeDogbWluWCwKICAgICAgeTogbWF4WQogICAgfSwgewogICAgICB4OiBtYXhYLAogICAgICB5OiBtYXhZCiAgICB9LCB7CiAgICAgIHg6IG1pblgsCiAgICAgIHk6IG1pblkKICAgIH0sIHsKICAgICAgeDogbWF4WCwKICAgICAgeTogbWluWQogICAgfV07CiAgfSk7Cn0KCmZ1bmN0aW9uIGdldFRyYW5zZm9ybU1hdHJpeChyZWN0LCBiYm94LCBtYXRyaXgpIHsKICBjb25zdCBbbWluWCwgbWluWSwgbWF4WCwgbWF4WV0gPSBfdXRpbC5VdGlsLmdldEF4aWFsQWxpZ25lZEJvdW5kaW5nQm94KGJib3gsIG1hdHJpeCk7CgogIGlmIChtaW5YID09PSBtYXhYIHx8IG1pblkgPT09IG1heFkpIHsKICAgIHJldHVybiBbMSwgMCwgMCwgMSwgcmVjdFswXSwgcmVjdFsxXV07CiAgfQoKICBjb25zdCB4UmF0aW8gPSAocmVjdFsyXSAtIHJlY3RbMF0pIC8gKG1heFggLSBtaW5YKTsKICBjb25zdCB5UmF0aW8gPSAocmVjdFszXSAtIHJlY3RbMV0pIC8gKG1heFkgLSBtaW5ZKTsKICByZXR1cm4gW3hSYXRpbywgMCwgMCwgeVJhdGlvLCByZWN0WzBdIC0gbWluWCAqIHhSYXRpbywgcmVjdFsxXSAtIG1pblkgKiB5UmF0aW9dOwp9CgpjbGFzcyBBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbXMpIHsKICAgIGNvbnN0IGRpY3QgPSBwYXJhbXMuZGljdDsKICAgIHRoaXMuc2V0VGl0bGUoZGljdC5nZXQoIlQiKSk7CiAgICB0aGlzLnNldENvbnRlbnRzKGRpY3QuZ2V0KCJDb250ZW50cyIpKTsKICAgIHRoaXMuc2V0TW9kaWZpY2F0aW9uRGF0ZShkaWN0LmdldCgiTSIpKTsKICAgIHRoaXMuc2V0RmxhZ3MoZGljdC5nZXQoIkYiKSk7CiAgICB0aGlzLnNldFJlY3RhbmdsZShkaWN0LmdldEFycmF5KCJSZWN0IikpOwogICAgdGhpcy5zZXRDb2xvcihkaWN0LmdldEFycmF5KCJDIikpOwogICAgdGhpcy5zZXRCb3JkZXJTdHlsZShkaWN0KTsKICAgIHRoaXMuc2V0QXBwZWFyYW5jZShkaWN0KTsKICAgIHRoaXMuc2V0T3B0aW9uYWxDb250ZW50KGRpY3QpOwogICAgY29uc3QgTUsgPSBkaWN0LmdldCgiTUsiKTsKICAgIHRoaXMuc2V0Qm9yZGVyQW5kQmFja2dyb3VuZENvbG9ycyhNSyk7CiAgICB0aGlzLnNldFJvdGF0aW9uKE1LKTsKICAgIHRoaXMuX3N0cmVhbXMgPSBbXTsKCiAgICBpZiAodGhpcy5hcHBlYXJhbmNlKSB7CiAgICAgIHRoaXMuX3N0cmVhbXMucHVzaCh0aGlzLmFwcGVhcmFuY2UpOwogICAgfQoKICAgIHRoaXMuZGF0YSA9IHsKICAgICAgYW5ub3RhdGlvbkZsYWdzOiB0aGlzLmZsYWdzLAogICAgICBib3JkZXJTdHlsZTogdGhpcy5ib3JkZXJTdHlsZSwKICAgICAgY29sb3I6IHRoaXMuY29sb3IsCiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5iYWNrZ3JvdW5kQ29sb3IsCiAgICAgIGJvcmRlckNvbG9yOiB0aGlzLmJvcmRlckNvbG9yLAogICAgICByb3RhdGlvbjogdGhpcy5yb3RhdGlvbiwKICAgICAgY29udGVudHNPYmo6IHRoaXMuX2NvbnRlbnRzLAogICAgICBoYXNBcHBlYXJhbmNlOiAhIXRoaXMuYXBwZWFyYW5jZSwKICAgICAgaWQ6IHBhcmFtcy5pZCwKICAgICAgbW9kaWZpY2F0aW9uRGF0ZTogdGhpcy5tb2RpZmljYXRpb25EYXRlLAogICAgICByZWN0OiB0aGlzLnJlY3RhbmdsZSwKICAgICAgc3VidHlwZTogcGFyYW1zLnN1YnR5cGUsCiAgICAgIGhhc093bkNhbnZhczogZmFsc2UKICAgIH07CgogICAgaWYgKHBhcmFtcy5jb2xsZWN0RmllbGRzKSB7CiAgICAgIGNvbnN0IGtpZHMgPSBkaWN0LmdldCgiS2lkcyIpOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoa2lkcykpIHsKICAgICAgICBjb25zdCBraWRJZHMgPSBbXTsKCiAgICAgICAgZm9yIChjb25zdCBraWQgb2Yga2lkcykgewogICAgICAgICAgaWYgKGtpZCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICBraWRJZHMucHVzaChraWQudG9TdHJpbmcoKSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoa2lkSWRzLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgdGhpcy5kYXRhLmtpZElkcyA9IGtpZElkczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZGF0YS5hY3Rpb25zID0gKDAsIF9jb3JlX3V0aWxzLmNvbGxlY3RBY3Rpb25zKShwYXJhbXMueHJlZiwgZGljdCwgX3V0aWwuQW5ub3RhdGlvbkFjdGlvbkV2ZW50VHlwZSk7CiAgICAgIHRoaXMuZGF0YS5maWVsZE5hbWUgPSB0aGlzLl9jb25zdHJ1Y3RGaWVsZE5hbWUoZGljdCk7CiAgICAgIHRoaXMuZGF0YS5wYWdlSW5kZXggPSBwYXJhbXMucGFnZUluZGV4OwogICAgfQoKICAgIHRoaXMuX2ZhbGxiYWNrRm9udERpY3QgPSBudWxsOwogIH0KCiAgX2hhc0ZsYWcoZmxhZ3MsIGZsYWcpIHsKICAgIHJldHVybiAhIShmbGFncyAmIGZsYWcpOwogIH0KCiAgX2lzVmlld2FibGUoZmxhZ3MpIHsKICAgIHJldHVybiAhdGhpcy5faGFzRmxhZyhmbGFncywgX3V0aWwuQW5ub3RhdGlvbkZsYWcuSU5WSVNJQkxFKSAmJiAhdGhpcy5faGFzRmxhZyhmbGFncywgX3V0aWwuQW5ub3RhdGlvbkZsYWcuTk9WSUVXKTsKICB9CgogIF9pc1ByaW50YWJsZShmbGFncykgewogICAgcmV0dXJuIHRoaXMuX2hhc0ZsYWcoZmxhZ3MsIF91dGlsLkFubm90YXRpb25GbGFnLlBSSU5UKSAmJiAhdGhpcy5faGFzRmxhZyhmbGFncywgX3V0aWwuQW5ub3RhdGlvbkZsYWcuSU5WSVNJQkxFKTsKICB9CgogIG11c3RCZVZpZXdlZChhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgY29uc3Qgc3RvcmFnZUVudHJ5ID0gYW5ub3RhdGlvblN0b3JhZ2UgJiYgYW5ub3RhdGlvblN0b3JhZ2UuZ2V0KHRoaXMuZGF0YS5pZCk7CgogICAgaWYgKHN0b3JhZ2VFbnRyeSAmJiBzdG9yYWdlRW50cnkuaGlkZGVuICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuICFzdG9yYWdlRW50cnkuaGlkZGVuOwogICAgfQoKICAgIHJldHVybiB0aGlzLnZpZXdhYmxlICYmICF0aGlzLl9oYXNGbGFnKHRoaXMuZmxhZ3MsIF91dGlsLkFubm90YXRpb25GbGFnLkhJRERFTik7CiAgfQoKICBtdXN0QmVQcmludGVkKGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZSAmJiBhbm5vdGF0aW9uU3RvcmFnZS5nZXQodGhpcy5kYXRhLmlkKTsKCiAgICBpZiAoc3RvcmFnZUVudHJ5ICYmIHN0b3JhZ2VFbnRyeS5wcmludCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBzdG9yYWdlRW50cnkucHJpbnQ7CiAgICB9CgogICAgcmV0dXJuIHRoaXMucHJpbnRhYmxlOwogIH0KCiAgZ2V0IHZpZXdhYmxlKCkgewogICAgaWYgKHRoaXMuZGF0YS5xdWFkUG9pbnRzID09PSBudWxsKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAodGhpcy5mbGFncyA9PT0gMCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5faXNWaWV3YWJsZSh0aGlzLmZsYWdzKTsKICB9CgogIGdldCBwcmludGFibGUoKSB7CiAgICBpZiAodGhpcy5kYXRhLnF1YWRQb2ludHMgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmICh0aGlzLmZsYWdzID09PSAwKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5faXNQcmludGFibGUodGhpcy5mbGFncyk7CiAgfQoKICBfcGFyc2VTdHJpbmdIZWxwZXIoZGF0YSkgewogICAgY29uc3Qgc3RyID0gdHlwZW9mIGRhdGEgPT09ICJzdHJpbmciID8gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShkYXRhKSA6ICIiOwogICAgY29uc3QgZGlyID0gc3RyICYmICgwLCBfYmlkaS5iaWRpKShzdHIpLmRpciA9PT0gInJ0bCIgPyAicnRsIiA6ICJsdHIiOwogICAgcmV0dXJuIHsKICAgICAgc3RyLAogICAgICBkaXIKICAgIH07CiAgfQoKICBzZXRUaXRsZSh0aXRsZSkgewogICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9wYXJzZVN0cmluZ0hlbHBlcih0aXRsZSk7CiAgfQoKICBzZXRDb250ZW50cyhjb250ZW50cykgewogICAgdGhpcy5fY29udGVudHMgPSB0aGlzLl9wYXJzZVN0cmluZ0hlbHBlcihjb250ZW50cyk7CiAgfQoKICBzZXRNb2RpZmljYXRpb25EYXRlKG1vZGlmaWNhdGlvbkRhdGUpIHsKICAgIHRoaXMubW9kaWZpY2F0aW9uRGF0ZSA9IHR5cGVvZiBtb2RpZmljYXRpb25EYXRlID09PSAic3RyaW5nIiA/IG1vZGlmaWNhdGlvbkRhdGUgOiBudWxsOwogIH0KCiAgc2V0RmxhZ3MoZmxhZ3MpIHsKICAgIHRoaXMuZmxhZ3MgPSBOdW1iZXIuaXNJbnRlZ2VyKGZsYWdzKSAmJiBmbGFncyA+IDAgPyBmbGFncyA6IDA7CiAgfQoKICBoYXNGbGFnKGZsYWcpIHsKICAgIHJldHVybiB0aGlzLl9oYXNGbGFnKHRoaXMuZmxhZ3MsIGZsYWcpOwogIH0KCiAgc2V0UmVjdGFuZ2xlKHJlY3RhbmdsZSkgewogICAgaWYgKEFycmF5LmlzQXJyYXkocmVjdGFuZ2xlKSAmJiByZWN0YW5nbGUubGVuZ3RoID09PSA0KSB7CiAgICAgIHRoaXMucmVjdGFuZ2xlID0gX3V0aWwuVXRpbC5ub3JtYWxpemVSZWN0KHJlY3RhbmdsZSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnJlY3RhbmdsZSA9IFswLCAwLCAwLCAwXTsKICAgIH0KICB9CgogIHNldENvbG9yKGNvbG9yKSB7CiAgICB0aGlzLmNvbG9yID0gZ2V0UmdiQ29sb3IoY29sb3IpOwogIH0KCiAgc2V0TGluZUVuZGluZ3MobGluZUVuZGluZ3MpIHsKICAgIHRoaXMubGluZUVuZGluZ3MgPSBbIk5vbmUiLCAiTm9uZSJdOwoKICAgIGlmIChBcnJheS5pc0FycmF5KGxpbmVFbmRpbmdzKSAmJiBsaW5lRW5kaW5ncy5sZW5ndGggPT09IDIpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyBpKyspIHsKICAgICAgICBjb25zdCBvYmogPSBsaW5lRW5kaW5nc1tpXTsKCiAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgIHN3aXRjaCAob2JqLm5hbWUpIHsKICAgICAgICAgICAgY2FzZSAiTm9uZSI6CiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICBjYXNlICJTcXVhcmUiOgogICAgICAgICAgICBjYXNlICJDaXJjbGUiOgogICAgICAgICAgICBjYXNlICJEaWFtb25kIjoKICAgICAgICAgICAgY2FzZSAiT3BlbkFycm93IjoKICAgICAgICAgICAgY2FzZSAiQ2xvc2VkQXJyb3ciOgogICAgICAgICAgICBjYXNlICJCdXR0IjoKICAgICAgICAgICAgY2FzZSAiUk9wZW5BcnJvdyI6CiAgICAgICAgICAgIGNhc2UgIlJDbG9zZWRBcnJvdyI6CiAgICAgICAgICAgIGNhc2UgIlNsYXNoIjoKICAgICAgICAgICAgICB0aGlzLmxpbmVFbmRpbmdzW2ldID0gb2JqLm5hbWU7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwud2FybikoYElnbm9yaW5nIGludmFsaWQgbGluZUVuZGluZzogJHtvYmp9YCk7CiAgICAgIH0KICAgIH0KICB9CgogIHNldFJvdGF0aW9uKG1rKSB7CiAgICB0aGlzLnJvdGF0aW9uID0gMDsKCiAgICBpZiAobWsgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIGxldCBhbmdsZSA9IG1rLmdldCgiUiIpIHx8IDA7CgogICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihhbmdsZSkgJiYgYW5nbGUgIT09IDApIHsKICAgICAgICBhbmdsZSAlPSAzNjA7CgogICAgICAgIGlmIChhbmdsZSA8IDApIHsKICAgICAgICAgIGFuZ2xlICs9IDM2MDsKICAgICAgICB9CgogICAgICAgIGlmIChhbmdsZSAlIDkwID09PSAwKSB7CiAgICAgICAgICB0aGlzLnJvdGF0aW9uID0gYW5nbGU7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBzZXRCb3JkZXJBbmRCYWNrZ3JvdW5kQ29sb3JzKG1rKSB7CiAgICBpZiAobWsgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIHRoaXMuYm9yZGVyQ29sb3IgPSBnZXRSZ2JDb2xvcihtay5nZXRBcnJheSgiQkMiKSwgbnVsbCk7CiAgICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gZ2V0UmdiQ29sb3IobWsuZ2V0QXJyYXkoIkJHIiksIG51bGwpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5ib3JkZXJDb2xvciA9IHRoaXMuYmFja2dyb3VuZENvbG9yID0gbnVsbDsKICAgIH0KICB9CgogIHNldEJvcmRlclN0eWxlKGJvcmRlclN0eWxlKSB7CiAgICB0aGlzLmJvcmRlclN0eWxlID0gbmV3IEFubm90YXRpb25Cb3JkZXJTdHlsZSgpOwoKICAgIGlmICghKGJvcmRlclN0eWxlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChib3JkZXJTdHlsZS5oYXMoIkJTIikpIHsKICAgICAgY29uc3QgZGljdCA9IGJvcmRlclN0eWxlLmdldCgiQlMiKTsKICAgICAgY29uc3QgZGljdFR5cGUgPSBkaWN0LmdldCgiVHlwZSIpOwoKICAgICAgaWYgKCFkaWN0VHlwZSB8fCAoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShkaWN0VHlwZSwgIkJvcmRlciIpKSB7CiAgICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXRXaWR0aChkaWN0LmdldCgiVyIpLCB0aGlzLnJlY3RhbmdsZSk7CiAgICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXRTdHlsZShkaWN0LmdldCgiUyIpKTsKICAgICAgICB0aGlzLmJvcmRlclN0eWxlLnNldERhc2hBcnJheShkaWN0LmdldEFycmF5KCJEIikpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGJvcmRlclN0eWxlLmhhcygiQm9yZGVyIikpIHsKICAgICAgY29uc3QgYXJyYXkgPSBib3JkZXJTdHlsZS5nZXRBcnJheSgiQm9yZGVyIik7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShhcnJheSkgJiYgYXJyYXkubGVuZ3RoID49IDMpIHsKICAgICAgICB0aGlzLmJvcmRlclN0eWxlLnNldEhvcml6b250YWxDb3JuZXJSYWRpdXMoYXJyYXlbMF0pOwogICAgICAgIHRoaXMuYm9yZGVyU3R5bGUuc2V0VmVydGljYWxDb3JuZXJSYWRpdXMoYXJyYXlbMV0pOwogICAgICAgIHRoaXMuYm9yZGVyU3R5bGUuc2V0V2lkdGgoYXJyYXlbMl0sIHRoaXMucmVjdGFuZ2xlKTsKCiAgICAgICAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gNCkgewogICAgICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXREYXNoQXJyYXkoYXJyYXlbM10sIHRydWUpOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXRXaWR0aCgwKTsKICAgIH0KICB9CgogIHNldEFwcGVhcmFuY2UoZGljdCkgewogICAgdGhpcy5hcHBlYXJhbmNlID0gbnVsbDsKICAgIGNvbnN0IGFwcGVhcmFuY2VTdGF0ZXMgPSBkaWN0LmdldCgiQVAiKTsKCiAgICBpZiAoIShhcHBlYXJhbmNlU3RhdGVzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG5vcm1hbEFwcGVhcmFuY2VTdGF0ZSA9IGFwcGVhcmFuY2VTdGF0ZXMuZ2V0KCJOIik7CgogICAgaWYgKG5vcm1hbEFwcGVhcmFuY2VTdGF0ZSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgIHRoaXMuYXBwZWFyYW5jZSA9IG5vcm1hbEFwcGVhcmFuY2VTdGF0ZTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICghKG5vcm1hbEFwcGVhcmFuY2VTdGF0ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBhcyA9IGRpY3QuZ2V0KCJBUyIpOwoKICAgIGlmICghKGFzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgfHwgIW5vcm1hbEFwcGVhcmFuY2VTdGF0ZS5oYXMoYXMubmFtZSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuYXBwZWFyYW5jZSA9IG5vcm1hbEFwcGVhcmFuY2VTdGF0ZS5nZXQoYXMubmFtZSk7CiAgfQoKICBzZXRPcHRpb25hbENvbnRlbnQoZGljdCkgewogICAgdGhpcy5vYyA9IG51bGw7CiAgICBjb25zdCBvYyA9IGRpY3QuZ2V0KCJPQyIpOwoKICAgIGlmIChvYyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJzZXRPcHRpb25hbENvbnRlbnQ6IFN1cHBvcnQgZm9yIC9OYW1lLWVudHJ5IGlzIG5vdCBpbXBsZW1lbnRlZC4iKTsKICAgIH0gZWxzZSBpZiAob2MgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIHRoaXMub2MgPSBvYzsKICAgIH0KICB9CgogIGxvYWRSZXNvdXJjZXMoa2V5cywgYXBwZWFyYW5jZSkgewogICAgcmV0dXJuIGFwcGVhcmFuY2UuZGljdC5nZXRBc3luYygiUmVzb3VyY2VzIikudGhlbihyZXNvdXJjZXMgPT4gewogICAgICBpZiAoIXJlc291cmNlcykgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIGNvbnN0IG9iamVjdExvYWRlciA9IG5ldyBfb2JqZWN0X2xvYWRlci5PYmplY3RMb2FkZXIocmVzb3VyY2VzLCBrZXlzLCByZXNvdXJjZXMueHJlZik7CiAgICAgIHJldHVybiBvYmplY3RMb2FkZXIubG9hZCgpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiByZXNvdXJjZXM7CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBhc3luYyBnZXRPcGVyYXRvckxpc3QoZXZhbHVhdG9yLCB0YXNrLCBpbnRlbnQsIHJlbmRlckZvcm1zLCBhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgIGxldCBhcHBlYXJhbmNlID0gdGhpcy5hcHBlYXJhbmNlOwogICAgY29uc3QgaXNVc2luZ093bkNhbnZhcyA9ICEhKHRoaXMuZGF0YS5oYXNPd25DYW52YXMgJiYgaW50ZW50ICYgX3V0aWwuUmVuZGVyaW5nSW50ZW50RmxhZy5ESVNQTEFZKTsKCiAgICBpZiAoIWFwcGVhcmFuY2UpIHsKICAgICAgaWYgKCFpc1VzaW5nT3duQ2FudmFzKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIG9wTGlzdDogbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpLAogICAgICAgICAgc2VwYXJhdGVGb3JtOiBmYWxzZSwKICAgICAgICAgIHNlcGFyYXRlQ2FudmFzOiBmYWxzZQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGFwcGVhcmFuY2UgPSBuZXcgX3N0cmVhbS5TdHJpbmdTdHJlYW0oIiIpOwogICAgICBhcHBlYXJhbmNlLmRpY3QgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCgpOwogICAgfQoKICAgIGNvbnN0IGFwcGVhcmFuY2VEaWN0ID0gYXBwZWFyYW5jZS5kaWN0OwogICAgY29uc3QgcmVzb3VyY2VzID0gYXdhaXQgdGhpcy5sb2FkUmVzb3VyY2VzKFsiRXh0R1N0YXRlIiwgIkNvbG9yU3BhY2UiLCAiUGF0dGVybiIsICJTaGFkaW5nIiwgIlhPYmplY3QiLCAiRm9udCJdLCBhcHBlYXJhbmNlKTsKICAgIGNvbnN0IGJib3ggPSBhcHBlYXJhbmNlRGljdC5nZXRBcnJheSgiQkJveCIpIHx8IFswLCAwLCAxLCAxXTsKICAgIGNvbnN0IG1hdHJpeCA9IGFwcGVhcmFuY2VEaWN0LmdldEFycmF5KCJNYXRyaXgiKSB8fCBbMSwgMCwgMCwgMSwgMCwgMF07CiAgICBjb25zdCB0cmFuc2Zvcm0gPSBnZXRUcmFuc2Zvcm1NYXRyaXgoZGF0YS5yZWN0LCBiYm94LCBtYXRyaXgpOwogICAgY29uc3Qgb3BMaXN0ID0gbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpOwogICAgbGV0IG9wdGlvbmFsQ29udGVudDsKCiAgICBpZiAodGhpcy5vYykgewogICAgICBvcHRpb25hbENvbnRlbnQgPSBhd2FpdCBldmFsdWF0b3IucGFyc2VNYXJrZWRDb250ZW50UHJvcHModGhpcy5vYywgbnVsbCk7CiAgICB9CgogICAgaWYgKG9wdGlvbmFsQ29udGVudCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIG9wTGlzdC5hZGRPcChfdXRpbC5PUFMuYmVnaW5NYXJrZWRDb250ZW50UHJvcHMsIFsiT0MiLCBvcHRpb25hbENvbnRlbnRdKTsKICAgIH0KCiAgICBvcExpc3QuYWRkT3AoX3V0aWwuT1BTLmJlZ2luQW5ub3RhdGlvbiwgW2RhdGEuaWQsIGRhdGEucmVjdCwgdHJhbnNmb3JtLCBtYXRyaXgsIGlzVXNpbmdPd25DYW52YXNdKTsKICAgIGF3YWl0IGV2YWx1YXRvci5nZXRPcGVyYXRvckxpc3QoewogICAgICBzdHJlYW06IGFwcGVhcmFuY2UsCiAgICAgIHRhc2ssCiAgICAgIHJlc291cmNlcywKICAgICAgb3BlcmF0b3JMaXN0OiBvcExpc3QsCiAgICAgIGZhbGxiYWNrRm9udERpY3Q6IHRoaXMuX2ZhbGxiYWNrRm9udERpY3QKICAgIH0pOwogICAgb3BMaXN0LmFkZE9wKF91dGlsLk9QUy5lbmRBbm5vdGF0aW9uLCBbXSk7CgogICAgaWYgKG9wdGlvbmFsQ29udGVudCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIG9wTGlzdC5hZGRPcChfdXRpbC5PUFMuZW5kTWFya2VkQ29udGVudCwgW10pOwogICAgfQoKICAgIHRoaXMucmVzZXQoKTsKICAgIHJldHVybiB7CiAgICAgIG9wTGlzdCwKICAgICAgc2VwYXJhdGVGb3JtOiBmYWxzZSwKICAgICAgc2VwYXJhdGVDYW52YXM6IGlzVXNpbmdPd25DYW52YXMKICAgIH07CiAgfQoKICBhc3luYyBzYXZlKGV2YWx1YXRvciwgdGFzaywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgZ2V0IGhhc1RleHRDb250ZW50KCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgYXN5bmMgZXh0cmFjdFRleHRDb250ZW50KGV2YWx1YXRvciwgdGFzaywgdmlld0JveCkgewogICAgaWYgKCF0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHJlc291cmNlcyA9IGF3YWl0IHRoaXMubG9hZFJlc291cmNlcyhbIkV4dEdTdGF0ZSIsICJGb250IiwgIlByb3BlcnRpZXMiLCAiWE9iamVjdCJdLCB0aGlzLmFwcGVhcmFuY2UpOwogICAgY29uc3QgdGV4dCA9IFtdOwogICAgY29uc3QgYnVmZmVyID0gW107CiAgICBjb25zdCBzaW5rID0gewogICAgICBkZXNpcmVkU2l6ZTogTWF0aC5JbmZpbml0eSwKICAgICAgcmVhZHk6IHRydWUsCgogICAgICBlbnF1ZXVlKGNodW5rLCBzaXplKSB7CiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGNodW5rLml0ZW1zKSB7CiAgICAgICAgICBidWZmZXIucHVzaChpdGVtLnN0cik7CgogICAgICAgICAgaWYgKGl0ZW0uaGFzRU9MKSB7CiAgICAgICAgICAgIHRleHQucHVzaChidWZmZXIuam9pbigiIikpOwogICAgICAgICAgICBidWZmZXIubGVuZ3RoID0gMDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICB9OwogICAgYXdhaXQgZXZhbHVhdG9yLmdldFRleHRDb250ZW50KHsKICAgICAgc3RyZWFtOiB0aGlzLmFwcGVhcmFuY2UsCiAgICAgIHRhc2ssCiAgICAgIHJlc291cmNlcywKICAgICAgaW5jbHVkZU1hcmtlZENvbnRlbnQ6IHRydWUsCiAgICAgIGNvbWJpbmVUZXh0SXRlbXM6IHRydWUsCiAgICAgIHNpbmssCiAgICAgIHZpZXdCb3gKICAgIH0pOwogICAgdGhpcy5yZXNldCgpOwoKICAgIGlmIChidWZmZXIubGVuZ3RoKSB7CiAgICAgIHRleHQucHVzaChidWZmZXIuam9pbigiIikpOwogICAgfQoKICAgIGlmICh0ZXh0Lmxlbmd0aCA+IDApIHsKICAgICAgdGhpcy5kYXRhLnRleHRDb250ZW50ID0gdGV4dDsKICAgIH0KICB9CgogIGdldEZpZWxkT2JqZWN0KCkgewogICAgaWYgKHRoaXMuZGF0YS5raWRJZHMpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBpZDogdGhpcy5kYXRhLmlkLAogICAgICAgIGFjdGlvbnM6IHRoaXMuZGF0YS5hY3Rpb25zLAogICAgICAgIG5hbWU6IHRoaXMuZGF0YS5maWVsZE5hbWUsCiAgICAgICAgc3Ryb2tlQ29sb3I6IHRoaXMuZGF0YS5ib3JkZXJDb2xvciwKICAgICAgICBmaWxsQ29sb3I6IHRoaXMuZGF0YS5iYWNrZ3JvdW5kQ29sb3IsCiAgICAgICAgdHlwZTogIiIsCiAgICAgICAga2lkSWRzOiB0aGlzLmRhdGEua2lkSWRzLAogICAgICAgIHBhZ2U6IHRoaXMuZGF0YS5wYWdlSW5kZXgsCiAgICAgICAgcm90YXRpb246IHRoaXMucm90YXRpb24KICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIHJlc2V0KCkgewogICAgZm9yIChjb25zdCBzdHJlYW0gb2YgdGhpcy5fc3RyZWFtcykgewogICAgICBzdHJlYW0ucmVzZXQoKTsKICAgIH0KICB9CgogIF9jb25zdHJ1Y3RGaWVsZE5hbWUoZGljdCkgewogICAgaWYgKCFkaWN0LmhhcygiVCIpICYmICFkaWN0LmhhcygiUGFyZW50IikpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJVbmtub3duIGZpZWxkIG5hbWUsIGZhbGxpbmcgYmFjayB0byBlbXB0eSBmaWVsZCBuYW1lLiIpOwogICAgICByZXR1cm4gIiI7CiAgICB9CgogICAgaWYgKCFkaWN0LmhhcygiUGFyZW50IikpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZGljdC5nZXQoIlQiKSk7CiAgICB9CgogICAgY29uc3QgZmllbGROYW1lID0gW107CgogICAgaWYgKGRpY3QuaGFzKCJUIikpIHsKICAgICAgZmllbGROYW1lLnVuc2hpZnQoKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShkaWN0LmdldCgiVCIpKSk7CiAgICB9CgogICAgbGV0IGxvb3BEaWN0ID0gZGljdDsKICAgIGNvbnN0IHZpc2l0ZWQgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KCk7CgogICAgaWYgKGRpY3Qub2JqSWQpIHsKICAgICAgdmlzaXRlZC5wdXQoZGljdC5vYmpJZCk7CiAgICB9CgogICAgd2hpbGUgKGxvb3BEaWN0LmhhcygiUGFyZW50IikpIHsKICAgICAgbG9vcERpY3QgPSBsb29wRGljdC5nZXQoIlBhcmVudCIpOwoKICAgICAgaWYgKCEobG9vcERpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB8fCBsb29wRGljdC5vYmpJZCAmJiB2aXNpdGVkLmhhcyhsb29wRGljdC5vYmpJZCkpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKGxvb3BEaWN0Lm9iaklkKSB7CiAgICAgICAgdmlzaXRlZC5wdXQobG9vcERpY3Qub2JqSWQpOwogICAgICB9CgogICAgICBpZiAobG9vcERpY3QuaGFzKCJUIikpIHsKICAgICAgICBmaWVsZE5hbWUudW5zaGlmdCgoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGxvb3BEaWN0LmdldCgiVCIpKSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmllbGROYW1lLmpvaW4oIi4iKTsKICB9Cgp9CgpleHBvcnRzLkFubm90YXRpb24gPSBBbm5vdGF0aW9uOwoKY2xhc3MgQW5ub3RhdGlvbkJvcmRlclN0eWxlIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMud2lkdGggPSAxOwogICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuU09MSUQ7CiAgICB0aGlzLmRhc2hBcnJheSA9IFszXTsKICAgIHRoaXMuaG9yaXpvbnRhbENvcm5lclJhZGl1cyA9IDA7CiAgICB0aGlzLnZlcnRpY2FsQ29ybmVyUmFkaXVzID0gMDsKICB9CgogIHNldFdpZHRoKHdpZHRoKSB7CiAgICBsZXQgcmVjdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogWzAsIDAsIDAsIDBdOwoKICAgIGlmICh3aWR0aCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgdGhpcy53aWR0aCA9IDA7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodHlwZW9mIHdpZHRoID09PSAibnVtYmVyIikgewogICAgICBpZiAod2lkdGggPiAwKSB7CiAgICAgICAgY29uc3QgbWF4V2lkdGggPSAocmVjdFsyXSAtIHJlY3RbMF0pIC8gMjsKICAgICAgICBjb25zdCBtYXhIZWlnaHQgPSAocmVjdFszXSAtIHJlY3RbMV0pIC8gMjsKCiAgICAgICAgaWYgKG1heFdpZHRoID4gMCAmJiBtYXhIZWlnaHQgPiAwICYmICh3aWR0aCA+IG1heFdpZHRoIHx8IHdpZHRoID4gbWF4SGVpZ2h0KSkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBBbm5vdGF0aW9uQm9yZGVyU3R5bGUuc2V0V2lkdGggLSBpZ25vcmluZyB3aWR0aDogJHt3aWR0aH1gKTsKICAgICAgICAgIHdpZHRoID0gMTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKICAgIH0KICB9CgogIHNldFN0eWxlKHN0eWxlKSB7CiAgICBpZiAoIShzdHlsZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzd2l0Y2ggKHN0eWxlLm5hbWUpIHsKICAgICAgY2FzZSAiUyI6CiAgICAgICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuU09MSUQ7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJEIjoKICAgICAgICB0aGlzLnN0eWxlID0gX3V0aWwuQW5ub3RhdGlvbkJvcmRlclN0eWxlVHlwZS5EQVNIRUQ7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJCIjoKICAgICAgICB0aGlzLnN0eWxlID0gX3V0aWwuQW5ub3RhdGlvbkJvcmRlclN0eWxlVHlwZS5CRVZFTEVEOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiSSI6CiAgICAgICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuSU5TRVQ7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJVIjoKICAgICAgICB0aGlzLnN0eWxlID0gX3V0aWwuQW5ub3RhdGlvbkJvcmRlclN0eWxlVHlwZS5VTkRFUkxJTkU7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgc2V0RGFzaEFycmF5KGRhc2hBcnJheSkgewogICAgbGV0IGZvcmNlU3R5bGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwoKICAgIGlmIChBcnJheS5pc0FycmF5KGRhc2hBcnJheSkgJiYgZGFzaEFycmF5Lmxlbmd0aCA+IDApIHsKICAgICAgbGV0IGlzVmFsaWQgPSB0cnVlOwogICAgICBsZXQgYWxsWmVyb3MgPSB0cnVlOwoKICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGRhc2hBcnJheSkgewogICAgICAgIGNvbnN0IHZhbGlkTnVtYmVyID0gK2VsZW1lbnQgPj0gMDsKCiAgICAgICAgaWYgKCF2YWxpZE51bWJlcikgewogICAgICAgICAgaXNWYWxpZCA9IGZhbHNlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50ID4gMCkgewogICAgICAgICAgYWxsWmVyb3MgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChpc1ZhbGlkICYmICFhbGxaZXJvcykgewogICAgICAgIHRoaXMuZGFzaEFycmF5ID0gZGFzaEFycmF5OwoKICAgICAgICBpZiAoZm9yY2VTdHlsZSkgewogICAgICAgICAgdGhpcy5zZXRTdHlsZShfcHJpbWl0aXZlcy5OYW1lLmdldCgiRCIpKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy53aWR0aCA9IDA7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoZGFzaEFycmF5KSB7CiAgICAgIHRoaXMud2lkdGggPSAwOwogICAgfQogIH0KCiAgc2V0SG9yaXpvbnRhbENvcm5lclJhZGl1cyhyYWRpdXMpIHsKICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKHJhZGl1cykpIHsKICAgICAgdGhpcy5ob3Jpem9udGFsQ29ybmVyUmFkaXVzID0gcmFkaXVzOwogICAgfQogIH0KCiAgc2V0VmVydGljYWxDb3JuZXJSYWRpdXMocmFkaXVzKSB7CiAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihyYWRpdXMpKSB7CiAgICAgIHRoaXMudmVydGljYWxDb3JuZXJSYWRpdXMgPSByYWRpdXM7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5Bbm5vdGF0aW9uQm9yZGVyU3R5bGUgPSBBbm5vdGF0aW9uQm9yZGVyU3R5bGU7CgpjbGFzcyBNYXJrdXBBbm5vdGF0aW9uIGV4dGVuZHMgQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICBjb25zdCBkaWN0ID0gcGFyYW1ldGVycy5kaWN0OwoKICAgIGlmIChkaWN0LmhhcygiSVJUIikpIHsKICAgICAgY29uc3QgcmF3SVJUID0gZGljdC5nZXRSYXcoIklSVCIpOwogICAgICB0aGlzLmRhdGEuaW5SZXBseVRvID0gcmF3SVJUIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmID8gcmF3SVJULnRvU3RyaW5nKCkgOiBudWxsOwogICAgICBjb25zdCBydCA9IGRpY3QuZ2V0KCJSVCIpOwogICAgICB0aGlzLmRhdGEucmVwbHlUeXBlID0gcnQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gcnQubmFtZSA6IF91dGlsLkFubm90YXRpb25SZXBseVR5cGUuUkVQTFk7CiAgICB9CgogICAgaWYgKHRoaXMuZGF0YS5yZXBseVR5cGUgPT09IF91dGlsLkFubm90YXRpb25SZXBseVR5cGUuR1JPVVApIHsKICAgICAgY29uc3QgcGFyZW50ID0gZGljdC5nZXQoIklSVCIpOwogICAgICB0aGlzLnNldFRpdGxlKHBhcmVudC5nZXQoIlQiKSk7CiAgICAgIHRoaXMuZGF0YS50aXRsZU9iaiA9IHRoaXMuX3RpdGxlOwogICAgICB0aGlzLnNldENvbnRlbnRzKHBhcmVudC5nZXQoIkNvbnRlbnRzIikpOwogICAgICB0aGlzLmRhdGEuY29udGVudHNPYmogPSB0aGlzLl9jb250ZW50czsKCiAgICAgIGlmICghcGFyZW50LmhhcygiQ3JlYXRpb25EYXRlIikpIHsKICAgICAgICB0aGlzLmRhdGEuY3JlYXRpb25EYXRlID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNldENyZWF0aW9uRGF0ZShwYXJlbnQuZ2V0KCJDcmVhdGlvbkRhdGUiKSk7CiAgICAgICAgdGhpcy5kYXRhLmNyZWF0aW9uRGF0ZSA9IHRoaXMuY3JlYXRpb25EYXRlOwogICAgICB9CgogICAgICBpZiAoIXBhcmVudC5oYXMoIk0iKSkgewogICAgICAgIHRoaXMuZGF0YS5tb2RpZmljYXRpb25EYXRlID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNldE1vZGlmaWNhdGlvbkRhdGUocGFyZW50LmdldCgiTSIpKTsKICAgICAgICB0aGlzLmRhdGEubW9kaWZpY2F0aW9uRGF0ZSA9IHRoaXMubW9kaWZpY2F0aW9uRGF0ZTsKICAgICAgfQoKICAgICAgdGhpcy5kYXRhLmhhc1BvcHVwID0gcGFyZW50LmhhcygiUG9wdXAiKTsKCiAgICAgIGlmICghcGFyZW50LmhhcygiQyIpKSB7CiAgICAgICAgdGhpcy5kYXRhLmNvbG9yID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNldENvbG9yKHBhcmVudC5nZXRBcnJheSgiQyIpKTsKICAgICAgICB0aGlzLmRhdGEuY29sb3IgPSB0aGlzLmNvbG9yOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRhdGEudGl0bGVPYmogPSB0aGlzLl90aXRsZTsKICAgICAgdGhpcy5zZXRDcmVhdGlvbkRhdGUoZGljdC5nZXQoIkNyZWF0aW9uRGF0ZSIpKTsKICAgICAgdGhpcy5kYXRhLmNyZWF0aW9uRGF0ZSA9IHRoaXMuY3JlYXRpb25EYXRlOwogICAgICB0aGlzLmRhdGEuaGFzUG9wdXAgPSBkaWN0LmhhcygiUG9wdXAiKTsKCiAgICAgIGlmICghZGljdC5oYXMoIkMiKSkgewogICAgICAgIHRoaXMuZGF0YS5jb2xvciA9IG51bGw7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoZGljdC5oYXMoIlJDIikpIHsKICAgICAgdGhpcy5kYXRhLnJpY2hUZXh0ID0gX2ZhY3RvcnkuWEZBRmFjdG9yeS5nZXRSaWNoVGV4dEFzSHRtbChkaWN0LmdldCgiUkMiKSk7CiAgICB9CiAgfQoKICBzZXRDcmVhdGlvbkRhdGUoY3JlYXRpb25EYXRlKSB7CiAgICB0aGlzLmNyZWF0aW9uRGF0ZSA9IHR5cGVvZiBjcmVhdGlvbkRhdGUgPT09ICJzdHJpbmciID8gY3JlYXRpb25EYXRlIDogbnVsbDsKICB9CgogIF9zZXREZWZhdWx0QXBwZWFyYW5jZShfcmVmMykgewogICAgbGV0IHsKICAgICAgeHJlZiwKICAgICAgZXh0cmEsCiAgICAgIHN0cm9rZUNvbG9yLAogICAgICBmaWxsQ29sb3IsCiAgICAgIGJsZW5kTW9kZSwKICAgICAgc3Ryb2tlQWxwaGEsCiAgICAgIGZpbGxBbHBoYSwKICAgICAgcG9pbnRzQ2FsbGJhY2sKICAgIH0gPSBfcmVmMzsKICAgIGxldCBtaW5YID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIGxldCBtaW5ZID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIGxldCBtYXhYID0gTnVtYmVyLk1JTl9WQUxVRTsKICAgIGxldCBtYXhZID0gTnVtYmVyLk1JTl9WQUxVRTsKICAgIGNvbnN0IGJ1ZmZlciA9IFsicSJdOwoKICAgIGlmIChleHRyYSkgewogICAgICBidWZmZXIucHVzaChleHRyYSk7CiAgICB9CgogICAgaWYgKHN0cm9rZUNvbG9yKSB7CiAgICAgIGJ1ZmZlci5wdXNoKGAke3N0cm9rZUNvbG9yWzBdfSAke3N0cm9rZUNvbG9yWzFdfSAke3N0cm9rZUNvbG9yWzJdfSBSR2ApOwogICAgfQoKICAgIGlmIChmaWxsQ29sb3IpIHsKICAgICAgYnVmZmVyLnB1c2goYCR7ZmlsbENvbG9yWzBdfSAke2ZpbGxDb2xvclsxXX0gJHtmaWxsQ29sb3JbMl19IHJnYCk7CiAgICB9CgogICAgbGV0IHBvaW50c0FycmF5ID0gdGhpcy5kYXRhLnF1YWRQb2ludHM7CgogICAgaWYgKCFwb2ludHNBcnJheSkgewogICAgICBwb2ludHNBcnJheSA9IFtbewogICAgICAgIHg6IHRoaXMucmVjdGFuZ2xlWzBdLAogICAgICAgIHk6IHRoaXMucmVjdGFuZ2xlWzNdCiAgICAgIH0sIHsKICAgICAgICB4OiB0aGlzLnJlY3RhbmdsZVsyXSwKICAgICAgICB5OiB0aGlzLnJlY3RhbmdsZVszXQogICAgICB9LCB7CiAgICAgICAgeDogdGhpcy5yZWN0YW5nbGVbMF0sCiAgICAgICAgeTogdGhpcy5yZWN0YW5nbGVbMV0KICAgICAgfSwgewogICAgICAgIHg6IHRoaXMucmVjdGFuZ2xlWzJdLAogICAgICAgIHk6IHRoaXMucmVjdGFuZ2xlWzFdCiAgICAgIH1dXTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IHBvaW50cyBvZiBwb2ludHNBcnJheSkgewogICAgICBjb25zdCBbbVgsIE1YLCBtWSwgTVldID0gcG9pbnRzQ2FsbGJhY2soYnVmZmVyLCBwb2ludHMpOwogICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgbVgpOwogICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgTVgpOwogICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgbVkpOwogICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgTVkpOwogICAgfQoKICAgIGJ1ZmZlci5wdXNoKCJRIik7CiAgICBjb25zdCBmb3JtRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgY29uc3QgYXBwZWFyYW5jZVN0cmVhbURpY3QgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh4cmVmKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiU3VidHlwZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJGb3JtIikpOwogICAgY29uc3QgYXBwZWFyYW5jZVN0cmVhbSA9IG5ldyBfc3RyZWFtLlN0cmluZ1N0cmVhbShidWZmZXIuam9pbigiICIpKTsKICAgIGFwcGVhcmFuY2VTdHJlYW0uZGljdCA9IGFwcGVhcmFuY2VTdHJlYW1EaWN0OwogICAgZm9ybURpY3Quc2V0KCJGbTAiLCBhcHBlYXJhbmNlU3RyZWFtKTsKICAgIGNvbnN0IGdzRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwoKICAgIGlmIChibGVuZE1vZGUpIHsKICAgICAgZ3NEaWN0LnNldCgiQk0iLCBfcHJpbWl0aXZlcy5OYW1lLmdldChibGVuZE1vZGUpKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIHN0cm9rZUFscGhhID09PSAibnVtYmVyIikgewogICAgICBnc0RpY3Quc2V0KCJDQSIsIHN0cm9rZUFscGhhKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGZpbGxBbHBoYSA9PT0gIm51bWJlciIpIHsKICAgICAgZ3NEaWN0LnNldCgiY2EiLCBmaWxsQWxwaGEpOwogICAgfQoKICAgIGNvbnN0IHN0YXRlRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgc3RhdGVEaWN0LnNldCgiR1MwIiwgZ3NEaWN0KTsKICAgIGNvbnN0IHJlc291cmNlcyA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgcmVzb3VyY2VzLnNldCgiRXh0R1N0YXRlIiwgc3RhdGVEaWN0KTsKICAgIHJlc291cmNlcy5zZXQoIlhPYmplY3QiLCBmb3JtRGljdCk7CiAgICBjb25zdCBhcHBlYXJhbmNlRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgYXBwZWFyYW5jZURpY3Quc2V0KCJSZXNvdXJjZXMiLCByZXNvdXJjZXMpOwogICAgY29uc3QgYmJveCA9IHRoaXMuZGF0YS5yZWN0ID0gW21pblgsIG1pblksIG1heFgsIG1heFldOwogICAgYXBwZWFyYW5jZURpY3Quc2V0KCJCQm94IiwgYmJveCk7CiAgICB0aGlzLmFwcGVhcmFuY2UgPSBuZXcgX3N0cmVhbS5TdHJpbmdTdHJlYW0oIi9HUzAgZ3MgL0ZtMCBEbyIpOwogICAgdGhpcy5hcHBlYXJhbmNlLmRpY3QgPSBhcHBlYXJhbmNlRGljdDsKCiAgICB0aGlzLl9zdHJlYW1zLnB1c2godGhpcy5hcHBlYXJhbmNlLCBhcHBlYXJhbmNlU3RyZWFtKTsKICB9CgogIHN0YXRpYyBhc3luYyBjcmVhdGVOZXdBbm5vdGF0aW9uKHhyZWYsIGFubm90YXRpb24sIGRlcGVuZGVuY2llcywgcGFyYW1zKSB7CiAgICBjb25zdCBhbm5vdGF0aW9uUmVmID0geHJlZi5nZXROZXdSZWYoKTsKICAgIGNvbnN0IGFwUmVmID0geHJlZi5nZXROZXdSZWYoKTsKICAgIGNvbnN0IGFubm90YXRpb25EaWN0ID0gdGhpcy5jcmVhdGVOZXdEaWN0KGFubm90YXRpb24sIHhyZWYsIHsKICAgICAgYXBSZWYKICAgIH0pOwogICAgY29uc3QgYXAgPSBhd2FpdCB0aGlzLmNyZWF0ZU5ld0FwcGVhcmFuY2VTdHJlYW0oYW5ub3RhdGlvbiwgeHJlZiwgcGFyYW1zKTsKICAgIGNvbnN0IGJ1ZmZlciA9IFtdOwogICAgbGV0IHRyYW5zZm9ybSA9IHhyZWYuZW5jcnlwdCA/IHhyZWYuZW5jcnlwdC5jcmVhdGVDaXBoZXJUcmFuc2Zvcm0oYXBSZWYubnVtLCBhcFJlZi5nZW4pIDogbnVsbDsKICAgICgwLCBfd3JpdGVyLndyaXRlT2JqZWN0KShhcFJlZiwgYXAsIGJ1ZmZlciwgdHJhbnNmb3JtKTsKICAgIGRlcGVuZGVuY2llcy5wdXNoKHsKICAgICAgcmVmOiBhcFJlZiwKICAgICAgZGF0YTogYnVmZmVyLmpvaW4oIiIpCiAgICB9KTsKICAgIGJ1ZmZlci5sZW5ndGggPSAwOwogICAgdHJhbnNmb3JtID0geHJlZi5lbmNyeXB0ID8geHJlZi5lbmNyeXB0LmNyZWF0ZUNpcGhlclRyYW5zZm9ybShhbm5vdGF0aW9uUmVmLm51bSwgYW5ub3RhdGlvblJlZi5nZW4pIDogbnVsbDsKICAgICgwLCBfd3JpdGVyLndyaXRlT2JqZWN0KShhbm5vdGF0aW9uUmVmLCBhbm5vdGF0aW9uRGljdCwgYnVmZmVyLCB0cmFuc2Zvcm0pOwogICAgcmV0dXJuIHsKICAgICAgcmVmOiBhbm5vdGF0aW9uUmVmLAogICAgICBkYXRhOiBidWZmZXIuam9pbigiIikKICAgIH07CiAgfQoKICBzdGF0aWMgYXN5bmMgY3JlYXRlTmV3UHJpbnRBbm5vdGF0aW9uKHhyZWYsIGFubm90YXRpb24sIHBhcmFtcykgewogICAgY29uc3QgYXAgPSBhd2FpdCB0aGlzLmNyZWF0ZU5ld0FwcGVhcmFuY2VTdHJlYW0oYW5ub3RhdGlvbiwgeHJlZiwgcGFyYW1zKTsKICAgIGNvbnN0IGFubm90YXRpb25EaWN0ID0gdGhpcy5jcmVhdGVOZXdEaWN0KGFubm90YXRpb24sIHhyZWYsIHsKICAgICAgYXAKICAgIH0pOwogICAgcmV0dXJuIG5ldyB0aGlzLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcih7CiAgICAgIGRpY3Q6IGFubm90YXRpb25EaWN0LAogICAgICB4cmVmCiAgICB9KTsKICB9Cgp9CgpleHBvcnRzLk1hcmt1cEFubm90YXRpb24gPSBNYXJrdXBBbm5vdGF0aW9uOwoKY2xhc3MgV2lkZ2V0QW5ub3RhdGlvbiBleHRlbmRzIEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtcykgewogICAgc3VwZXIocGFyYW1zKTsKICAgIGNvbnN0IGRpY3QgPSBwYXJhbXMuZGljdDsKICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICB0aGlzLnJlZiA9IHBhcmFtcy5yZWY7CiAgICBkYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuV0lER0VUOwoKICAgIGlmIChkYXRhLmZpZWxkTmFtZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGRhdGEuZmllbGROYW1lID0gdGhpcy5fY29uc3RydWN0RmllbGROYW1lKGRpY3QpOwogICAgfQoKICAgIGlmIChkYXRhLmFjdGlvbnMgPT09IHVuZGVmaW5lZCkgewogICAgICBkYXRhLmFjdGlvbnMgPSAoMCwgX2NvcmVfdXRpbHMuY29sbGVjdEFjdGlvbnMpKHBhcmFtcy54cmVmLCBkaWN0LCBfdXRpbC5Bbm5vdGF0aW9uQWN0aW9uRXZlbnRUeXBlKTsKICAgIH0KCiAgICBsZXQgZmllbGRWYWx1ZSA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3QsCiAgICAgIGtleTogIlYiLAogICAgICBnZXRBcnJheTogdHJ1ZQogICAgfSk7CiAgICBkYXRhLmZpZWxkVmFsdWUgPSB0aGlzLl9kZWNvZGVGb3JtVmFsdWUoZmllbGRWYWx1ZSk7CiAgICBjb25zdCBkZWZhdWx0RmllbGRWYWx1ZSA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3QsCiAgICAgIGtleTogIkRWIiwKICAgICAgZ2V0QXJyYXk6IHRydWUKICAgIH0pOwogICAgZGF0YS5kZWZhdWx0RmllbGRWYWx1ZSA9IHRoaXMuX2RlY29kZUZvcm1WYWx1ZShkZWZhdWx0RmllbGRWYWx1ZSk7CgogICAgaWYgKGZpZWxkVmFsdWUgPT09IHVuZGVmaW5lZCAmJiBwYXJhbXMueGZhRGF0YXNldHMpIHsKICAgICAgY29uc3QgcGF0aCA9IHRoaXMuX3RpdGxlLnN0cjsKCiAgICAgIGlmIChwYXRoKSB7CiAgICAgICAgdGhpcy5faGFzVmFsdWVGcm9tWEZBID0gdHJ1ZTsKICAgICAgICBkYXRhLmZpZWxkVmFsdWUgPSBmaWVsZFZhbHVlID0gcGFyYW1zLnhmYURhdGFzZXRzLmdldFZhbHVlKHBhdGgpOwogICAgICB9CiAgICB9CgogICAgaWYgKGZpZWxkVmFsdWUgPT09IHVuZGVmaW5lZCAmJiBkYXRhLmRlZmF1bHRGaWVsZFZhbHVlICE9PSBudWxsKSB7CiAgICAgIGRhdGEuZmllbGRWYWx1ZSA9IGRhdGEuZGVmYXVsdEZpZWxkVmFsdWU7CiAgICB9CgogICAgZGF0YS5hbHRlcm5hdGl2ZVRleHQgPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGRpY3QuZ2V0KCJUVSIpIHx8ICIiKTsKICAgIGNvbnN0IGRlZmF1bHRBcHBlYXJhbmNlID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdCwKICAgICAga2V5OiAiREEiCiAgICB9KSB8fCBwYXJhbXMuYWNyb0Zvcm0uZ2V0KCJEQSIpOwogICAgdGhpcy5fZGVmYXVsdEFwcGVhcmFuY2UgPSB0eXBlb2YgZGVmYXVsdEFwcGVhcmFuY2UgPT09ICJzdHJpbmciID8gZGVmYXVsdEFwcGVhcmFuY2UgOiAiIjsKICAgIGRhdGEuZGVmYXVsdEFwcGVhcmFuY2VEYXRhID0gKDAsIF9kZWZhdWx0X2FwcGVhcmFuY2UucGFyc2VEZWZhdWx0QXBwZWFyYW5jZSkodGhpcy5fZGVmYXVsdEFwcGVhcmFuY2UpOwogICAgY29uc3QgZmllbGRUeXBlID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdCwKICAgICAga2V5OiAiRlQiCiAgICB9KTsKICAgIGRhdGEuZmllbGRUeXBlID0gZmllbGRUeXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IGZpZWxkVHlwZS5uYW1lIDogbnVsbDsKICAgIGNvbnN0IGxvY2FsUmVzb3VyY2VzID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdCwKICAgICAga2V5OiAiRFIiCiAgICB9KTsKICAgIGNvbnN0IGFjcm9Gb3JtUmVzb3VyY2VzID0gcGFyYW1zLmFjcm9Gb3JtLmdldCgiRFIiKTsKICAgIGNvbnN0IGFwcGVhcmFuY2VSZXNvdXJjZXMgPSB0aGlzLmFwcGVhcmFuY2UgJiYgdGhpcy5hcHBlYXJhbmNlLmRpY3QuZ2V0KCJSZXNvdXJjZXMiKTsKICAgIHRoaXMuX2ZpZWxkUmVzb3VyY2VzID0gewogICAgICBsb2NhbFJlc291cmNlcywKICAgICAgYWNyb0Zvcm1SZXNvdXJjZXMsCiAgICAgIGFwcGVhcmFuY2VSZXNvdXJjZXMsCiAgICAgIG1lcmdlZFJlc291cmNlczogX3ByaW1pdGl2ZXMuRGljdC5tZXJnZSh7CiAgICAgICAgeHJlZjogcGFyYW1zLnhyZWYsCiAgICAgICAgZGljdEFycmF5OiBbbG9jYWxSZXNvdXJjZXMsIGFwcGVhcmFuY2VSZXNvdXJjZXMsIGFjcm9Gb3JtUmVzb3VyY2VzXSwKICAgICAgICBtZXJnZVN1YkRpY3RzOiB0cnVlCiAgICAgIH0pCiAgICB9OwogICAgZGF0YS5maWVsZEZsYWdzID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdCwKICAgICAga2V5OiAiRmYiCiAgICB9KTsKCiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoZGF0YS5maWVsZEZsYWdzKSB8fCBkYXRhLmZpZWxkRmxhZ3MgPCAwKSB7CiAgICAgIGRhdGEuZmllbGRGbGFncyA9IDA7CiAgICB9CgogICAgZGF0YS5yZWFkT25seSA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUkVBRE9OTFkpOwogICAgZGF0YS5yZXF1aXJlZCA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUkVRVUlSRUQpOwogICAgZGF0YS5oaWRkZW4gPSB0aGlzLl9oYXNGbGFnKGRhdGEuYW5ub3RhdGlvbkZsYWdzLCBfdXRpbC5Bbm5vdGF0aW9uRmxhZy5ISURERU4pOwogIH0KCiAgX2RlY29kZUZvcm1WYWx1ZShmb3JtVmFsdWUpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGZvcm1WYWx1ZSkpIHsKICAgICAgcmV0dXJuIGZvcm1WYWx1ZS5maWx0ZXIoaXRlbSA9PiB0eXBlb2YgaXRlbSA9PT0gInN0cmluZyIpLm1hcChpdGVtID0+ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoaXRlbSkpOwogICAgfSBlbHNlIGlmIChmb3JtVmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGZvcm1WYWx1ZS5uYW1lKTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIGZvcm1WYWx1ZSA9PT0gInN0cmluZyIpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZm9ybVZhbHVlKTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGhhc0ZpZWxkRmxhZyhmbGFnKSB7CiAgICByZXR1cm4gISEodGhpcy5kYXRhLmZpZWxkRmxhZ3MgJiBmbGFnKTsKICB9CgogIHN0YXRpYyBfZ2V0Um90YXRpb25NYXRyaXgocm90YXRpb24sIHdpZHRoLCBoZWlnaHQpIHsKICAgIHN3aXRjaCAocm90YXRpb24pIHsKICAgICAgY2FzZSA5MDoKICAgICAgICByZXR1cm4gWzAsIDEsIC0xLCAwLCB3aWR0aCwgMF07CgogICAgICBjYXNlIDE4MDoKICAgICAgICByZXR1cm4gWy0xLCAwLCAwLCAtMSwgd2lkdGgsIGhlaWdodF07CgogICAgICBjYXNlIDI3MDoKICAgICAgICByZXR1cm4gWzAsIC0xLCAxLCAwLCAwLCBoZWlnaHRdOwoKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgcm90YXRpb24iKTsKICAgIH0KICB9CgogIGdldFJvdGF0aW9uTWF0cml4KGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZSA/IGFubm90YXRpb25TdG9yYWdlLmdldCh0aGlzLmRhdGEuaWQpIDogdW5kZWZpbmVkOwogICAgbGV0IHJvdGF0aW9uID0gc3RvcmFnZUVudHJ5ICYmIHN0b3JhZ2VFbnRyeS5yb3RhdGlvbjsKCiAgICBpZiAocm90YXRpb24gPT09IHVuZGVmaW5lZCkgewogICAgICByb3RhdGlvbiA9IHRoaXMucm90YXRpb247CiAgICB9CgogICAgaWYgKHJvdGF0aW9uID09PSAwKSB7CiAgICAgIHJldHVybiBfdXRpbC5JREVOVElUWV9NQVRSSVg7CiAgICB9CgogICAgY29uc3Qgd2lkdGggPSB0aGlzLmRhdGEucmVjdFsyXSAtIHRoaXMuZGF0YS5yZWN0WzBdOwogICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5kYXRhLnJlY3RbM10gLSB0aGlzLmRhdGEucmVjdFsxXTsKICAgIHJldHVybiBXaWRnZXRBbm5vdGF0aW9uLl9nZXRSb3RhdGlvbk1hdHJpeChyb3RhdGlvbiwgd2lkdGgsIGhlaWdodCk7CiAgfQoKICBnZXRCb3JkZXJBbmRCYWNrZ3JvdW5kQXBwZWFyYW5jZXMoYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGNvbnN0IHN0b3JhZ2VFbnRyeSA9IGFubm90YXRpb25TdG9yYWdlID8gYW5ub3RhdGlvblN0b3JhZ2UuZ2V0KHRoaXMuZGF0YS5pZCkgOiB1bmRlZmluZWQ7CiAgICBsZXQgcm90YXRpb24gPSBzdG9yYWdlRW50cnkgJiYgc3RvcmFnZUVudHJ5LnJvdGF0aW9uOwoKICAgIGlmIChyb3RhdGlvbiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJvdGF0aW9uID0gdGhpcy5yb3RhdGlvbjsKICAgIH0KCiAgICBpZiAoIXRoaXMuYmFja2dyb3VuZENvbG9yICYmICF0aGlzLmJvcmRlckNvbG9yKSB7CiAgICAgIHJldHVybiAiIjsKICAgIH0KCiAgICBjb25zdCB3aWR0aCA9IHRoaXMuZGF0YS5yZWN0WzJdIC0gdGhpcy5kYXRhLnJlY3RbMF07CiAgICBjb25zdCBoZWlnaHQgPSB0aGlzLmRhdGEucmVjdFszXSAtIHRoaXMuZGF0YS5yZWN0WzFdOwogICAgY29uc3QgcmVjdCA9IHJvdGF0aW9uID09PSAwIHx8IHJvdGF0aW9uID09PSAxODAgPyBgMCAwICR7d2lkdGh9ICR7aGVpZ2h0fSByZWAgOiBgMCAwICR7aGVpZ2h0fSAke3dpZHRofSByZWA7CiAgICBsZXQgc3RyID0gIiI7CgogICAgaWYgKHRoaXMuYmFja2dyb3VuZENvbG9yKSB7CiAgICAgIHN0ciA9IGAkeygwLCBfZGVmYXVsdF9hcHBlYXJhbmNlLmdldFBkZkNvbG9yKSh0aGlzLmJhY2tncm91bmRDb2xvciwgdHJ1ZSl9ICR7cmVjdH0gZiBgOwogICAgfQoKICAgIGlmICh0aGlzLmJvcmRlckNvbG9yKSB7CiAgICAgIGNvbnN0IGJvcmRlcldpZHRoID0gdGhpcy5ib3JkZXJTdHlsZS53aWR0aCB8fCAxOwogICAgICBzdHIgKz0gYCR7Ym9yZGVyV2lkdGh9IHcgJHsoMCwgX2RlZmF1bHRfYXBwZWFyYW5jZS5nZXRQZGZDb2xvcikodGhpcy5ib3JkZXJDb2xvciwgZmFsc2UpfSAke3JlY3R9IFMgYDsKICAgIH0KCiAgICByZXR1cm4gc3RyOwogIH0KCiAgYXN5bmMgZ2V0T3BlcmF0b3JMaXN0KGV2YWx1YXRvciwgdGFzaywgaW50ZW50LCByZW5kZXJGb3JtcywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGlmIChyZW5kZXJGb3JtcyAmJiAhKHRoaXMgaW5zdGFuY2VvZiBTaWduYXR1cmVXaWRnZXRBbm5vdGF0aW9uKSkgewogICAgICByZXR1cm4gewogICAgICAgIG9wTGlzdDogbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpLAogICAgICAgIHNlcGFyYXRlRm9ybTogdHJ1ZSwKICAgICAgICBzZXBhcmF0ZUNhbnZhczogZmFsc2UKICAgICAgfTsKICAgIH0KCiAgICBpZiAoIXRoaXMuX2hhc1RleHQpIHsKICAgICAgcmV0dXJuIHN1cGVyLmdldE9wZXJhdG9yTGlzdChldmFsdWF0b3IsIHRhc2ssIGludGVudCwgcmVuZGVyRm9ybXMsIGFubm90YXRpb25TdG9yYWdlKTsKICAgIH0KCiAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5fZ2V0QXBwZWFyYW5jZShldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKTsKCiAgICBpZiAodGhpcy5hcHBlYXJhbmNlICYmIGNvbnRlbnQgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIHN1cGVyLmdldE9wZXJhdG9yTGlzdChldmFsdWF0b3IsIHRhc2ssIGludGVudCwgcmVuZGVyRm9ybXMsIGFubm90YXRpb25TdG9yYWdlKTsKICAgIH0KCiAgICBjb25zdCBvcExpc3QgPSBuZXcgX29wZXJhdG9yX2xpc3QuT3BlcmF0b3JMaXN0KCk7CgogICAgaWYgKCF0aGlzLl9kZWZhdWx0QXBwZWFyYW5jZSB8fCBjb250ZW50ID09PSBudWxsKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgb3BMaXN0LAogICAgICAgIHNlcGFyYXRlRm9ybTogZmFsc2UsCiAgICAgICAgc2VwYXJhdGVDYW52YXM6IGZhbHNlCiAgICAgIH07CiAgICB9CgogICAgY29uc3QgbWF0cml4ID0gWzEsIDAsIDAsIDEsIDAsIDBdOwogICAgY29uc3QgYmJveCA9IFswLCAwLCB0aGlzLmRhdGEucmVjdFsyXSAtIHRoaXMuZGF0YS5yZWN0WzBdLCB0aGlzLmRhdGEucmVjdFszXSAtIHRoaXMuZGF0YS5yZWN0WzFdXTsKICAgIGNvbnN0IHRyYW5zZm9ybSA9IGdldFRyYW5zZm9ybU1hdHJpeCh0aGlzLmRhdGEucmVjdCwgYmJveCwgbWF0cml4KTsKICAgIGxldCBvcHRpb25hbENvbnRlbnQ7CgogICAgaWYgKHRoaXMub2MpIHsKICAgICAgb3B0aW9uYWxDb250ZW50ID0gYXdhaXQgZXZhbHVhdG9yLnBhcnNlTWFya2VkQ29udGVudFByb3BzKHRoaXMub2MsIG51bGwpOwogICAgfQoKICAgIGlmIChvcHRpb25hbENvbnRlbnQgIT09IHVuZGVmaW5lZCkgewogICAgICBvcExpc3QuYWRkT3AoX3V0aWwuT1BTLmJlZ2luTWFya2VkQ29udGVudFByb3BzLCBbIk9DIiwgb3B0aW9uYWxDb250ZW50XSk7CiAgICB9CgogICAgb3BMaXN0LmFkZE9wKF91dGlsLk9QUy5iZWdpbkFubm90YXRpb24sIFt0aGlzLmRhdGEuaWQsIHRoaXMuZGF0YS5yZWN0LCB0cmFuc2Zvcm0sIHRoaXMuZ2V0Um90YXRpb25NYXRyaXgoYW5ub3RhdGlvblN0b3JhZ2UpLCBmYWxzZV0pOwogICAgY29uc3Qgc3RyZWFtID0gbmV3IF9zdHJlYW0uU3RyaW5nU3RyZWFtKGNvbnRlbnQpOwogICAgYXdhaXQgZXZhbHVhdG9yLmdldE9wZXJhdG9yTGlzdCh7CiAgICAgIHN0cmVhbSwKICAgICAgdGFzaywKICAgICAgcmVzb3VyY2VzOiB0aGlzLl9maWVsZFJlc291cmNlcy5tZXJnZWRSZXNvdXJjZXMsCiAgICAgIG9wZXJhdG9yTGlzdDogb3BMaXN0CiAgICB9KTsKICAgIG9wTGlzdC5hZGRPcChfdXRpbC5PUFMuZW5kQW5ub3RhdGlvbiwgW10pOwoKICAgIGlmIChvcHRpb25hbENvbnRlbnQgIT09IHVuZGVmaW5lZCkgewogICAgICBvcExpc3QuYWRkT3AoX3V0aWwuT1BTLmVuZE1hcmtlZENvbnRlbnQsIFtdKTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBvcExpc3QsCiAgICAgIHNlcGFyYXRlRm9ybTogZmFsc2UsCiAgICAgIHNlcGFyYXRlQ2FudmFzOiBmYWxzZQogICAgfTsKICB9CgogIF9nZXRNS0RpY3Qocm90YXRpb24pIHsKICAgIGNvbnN0IG1rID0gbmV3IF9wcmltaXRpdmVzLkRpY3QobnVsbCk7CgogICAgaWYgKHJvdGF0aW9uKSB7CiAgICAgIG1rLnNldCgiUiIsIHJvdGF0aW9uKTsKICAgIH0KCiAgICBpZiAodGhpcy5ib3JkZXJDb2xvcikgewogICAgICBtay5zZXQoIkJDIiwgQXJyYXkuZnJvbSh0aGlzLmJvcmRlckNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSk7CiAgICB9CgogICAgaWYgKHRoaXMuYmFja2dyb3VuZENvbG9yKSB7CiAgICAgIG1rLnNldCgiQkciLCBBcnJheS5mcm9tKHRoaXMuYmFja2dyb3VuZENvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSk7CiAgICB9CgogICAgcmV0dXJuIG1rLnNpemUgPiAwID8gbWsgOiBudWxsOwogIH0KCiAgYXN5bmMgc2F2ZShldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZSA/IGFubm90YXRpb25TdG9yYWdlLmdldCh0aGlzLmRhdGEuaWQpIDogdW5kZWZpbmVkOwogICAgbGV0IHZhbHVlID0gc3RvcmFnZUVudHJ5ICYmIHN0b3JhZ2VFbnRyeS52YWx1ZTsKICAgIGxldCByb3RhdGlvbiA9IHN0b3JhZ2VFbnRyeSAmJiBzdG9yYWdlRW50cnkucm90YXRpb247CgogICAgaWYgKHZhbHVlID09PSB0aGlzLmRhdGEuZmllbGRWYWx1ZSB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmICghdGhpcy5faGFzVmFsdWVGcm9tWEZBICYmIHJvdGF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFsdWUgPSB2YWx1ZSB8fCB0aGlzLmRhdGEuZmllbGRWYWx1ZTsKICAgIH0KCiAgICBpZiAocm90YXRpb24gPT09IHVuZGVmaW5lZCAmJiAhdGhpcy5faGFzVmFsdWVGcm9tWEZBICYmIEFycmF5LmlzQXJyYXkodmFsdWUpICYmIEFycmF5LmlzQXJyYXkodGhpcy5kYXRhLmZpZWxkVmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gdGhpcy5kYXRhLmZpZWxkVmFsdWUubGVuZ3RoICYmIHZhbHVlLmV2ZXJ5KCh4LCBpKSA9PiB4ID09PSB0aGlzLmRhdGEuZmllbGRWYWx1ZVtpXSkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgaWYgKHJvdGF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgcm90YXRpb24gPSB0aGlzLnJvdGF0aW9uOwogICAgfQoKICAgIGxldCBhcHBlYXJhbmNlID0gYXdhaXQgdGhpcy5fZ2V0QXBwZWFyYW5jZShldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKTsKCiAgICBpZiAoYXBwZWFyYW5jZSA9PT0gbnVsbCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCB7CiAgICAgIHhyZWYKICAgIH0gPSBldmFsdWF0b3I7CiAgICBjb25zdCBkaWN0ID0geHJlZi5mZXRjaElmUmVmKHRoaXMucmVmKTsKCiAgICBpZiAoIShkaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3QgYmJveCA9IFswLCAwLCB0aGlzLmRhdGEucmVjdFsyXSAtIHRoaXMuZGF0YS5yZWN0WzBdLCB0aGlzLmRhdGEucmVjdFszXSAtIHRoaXMuZGF0YS5yZWN0WzFdXTsKICAgIGNvbnN0IHhmYSA9IHsKICAgICAgcGF0aDogKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShkaWN0LmdldCgiVCIpIHx8ICIiKSwKICAgICAgdmFsdWUKICAgIH07CiAgICBjb25zdCBuZXdSZWYgPSB4cmVmLmdldE5ld1JlZigpOwogICAgY29uc3QgQVAgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh4cmVmKTsKICAgIEFQLnNldCgiTiIsIG5ld1JlZik7CiAgICBjb25zdCBlbmNyeXB0ID0geHJlZi5lbmNyeXB0OwogICAgbGV0IG9yaWdpbmFsVHJhbnNmb3JtID0gbnVsbDsKICAgIGxldCBuZXdUcmFuc2Zvcm0gPSBudWxsOwoKICAgIGlmIChlbmNyeXB0KSB7CiAgICAgIG9yaWdpbmFsVHJhbnNmb3JtID0gZW5jcnlwdC5jcmVhdGVDaXBoZXJUcmFuc2Zvcm0odGhpcy5yZWYubnVtLCB0aGlzLnJlZi5nZW4pOwogICAgICBuZXdUcmFuc2Zvcm0gPSBlbmNyeXB0LmNyZWF0ZUNpcGhlclRyYW5zZm9ybShuZXdSZWYubnVtLCBuZXdSZWYuZ2VuKTsKICAgICAgYXBwZWFyYW5jZSA9IG5ld1RyYW5zZm9ybS5lbmNyeXB0U3RyaW5nKGFwcGVhcmFuY2UpOwogICAgfQoKICAgIGNvbnN0IGVuY29kZXIgPSB2YWwgPT4gKDAsIF91dGlsLmlzQXNjaWkpKHZhbCkgPyB2YWwgOiAoMCwgX3V0aWwuc3RyaW5nVG9VVEYxNkJFU3RyaW5nKSh2YWwpOwoKICAgIGRpY3Quc2V0KCJWIiwgQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZS5tYXAoZW5jb2RlcikgOiBlbmNvZGVyKHZhbHVlKSk7CiAgICBkaWN0LnNldCgiQVAiLCBBUCk7CiAgICBkaWN0LnNldCgiTSIsIGBEOiR7KDAsIF91dGlsLmdldE1vZGlmaWNhdGlvbkRhdGUpKCl9YCk7CgogICAgY29uc3QgbWF5YmVNSyA9IHRoaXMuX2dldE1LRGljdChyb3RhdGlvbik7CgogICAgaWYgKG1heWJlTUspIHsKICAgICAgZGljdC5zZXQoIk1LIiwgbWF5YmVNSyk7CiAgICB9CgogICAgY29uc3QgYXBwZWFyYW5jZURpY3QgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh4cmVmKTsKICAgIGFwcGVhcmFuY2VEaWN0LnNldCgiTGVuZ3RoIiwgYXBwZWFyYW5jZS5sZW5ndGgpOwogICAgYXBwZWFyYW5jZURpY3Quc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZvcm0iKSk7CiAgICBhcHBlYXJhbmNlRGljdC5zZXQoIlJlc291cmNlcyIsIHRoaXMuX2dldFNhdmVGaWVsZFJlc291cmNlcyh4cmVmKSk7CiAgICBhcHBlYXJhbmNlRGljdC5zZXQoIkJCb3giLCBiYm94KTsKICAgIGNvbnN0IHJvdGF0aW9uTWF0cml4ID0gdGhpcy5nZXRSb3RhdGlvbk1hdHJpeChhbm5vdGF0aW9uU3RvcmFnZSk7CgogICAgaWYgKHJvdGF0aW9uTWF0cml4ICE9PSBfdXRpbC5JREVOVElUWV9NQVRSSVgpIHsKICAgICAgYXBwZWFyYW5jZURpY3Quc2V0KCJNYXRyaXgiLCByb3RhdGlvbk1hdHJpeCk7CiAgICB9CgogICAgY29uc3QgYnVmZmVyT3JpZ2luYWwgPSBbYCR7dGhpcy5yZWYubnVtfSAke3RoaXMucmVmLmdlbn0gb2JqXG5gXTsKICAgICgwLCBfd3JpdGVyLndyaXRlRGljdCkoZGljdCwgYnVmZmVyT3JpZ2luYWwsIG9yaWdpbmFsVHJhbnNmb3JtKTsKICAgIGJ1ZmZlck9yaWdpbmFsLnB1c2goIlxuZW5kb2JqXG4iKTsKICAgIGNvbnN0IGJ1ZmZlck5ldyA9IFtgJHtuZXdSZWYubnVtfSAke25ld1JlZi5nZW59IG9ialxuYF07CiAgICAoMCwgX3dyaXRlci53cml0ZURpY3QpKGFwcGVhcmFuY2VEaWN0LCBidWZmZXJOZXcsIG5ld1RyYW5zZm9ybSk7CiAgICBidWZmZXJOZXcucHVzaCgiIHN0cmVhbVxuIiwgYXBwZWFyYW5jZSwgIlxuZW5kc3RyZWFtXG5lbmRvYmpcbiIpOwogICAgcmV0dXJuIFt7CiAgICAgIHJlZjogdGhpcy5yZWYsCiAgICAgIGRhdGE6IGJ1ZmZlck9yaWdpbmFsLmpvaW4oIiIpLAogICAgICB4ZmEKICAgIH0sIHsKICAgICAgcmVmOiBuZXdSZWYsCiAgICAgIGRhdGE6IGJ1ZmZlck5ldy5qb2luKCIiKSwKICAgICAgeGZhOiBudWxsCiAgICB9XTsKICB9CgogIGFzeW5jIF9nZXRBcHBlYXJhbmNlKGV2YWx1YXRvciwgdGFzaywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGNvbnN0IGlzUGFzc3dvcmQgPSB0aGlzLmhhc0ZpZWxkRmxhZyhfdXRpbC5Bbm5vdGF0aW9uRmllbGRGbGFnLlBBU1NXT1JEKTsKCiAgICBpZiAoaXNQYXNzd29yZCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZSA/IGFubm90YXRpb25TdG9yYWdlLmdldCh0aGlzLmRhdGEuaWQpIDogdW5kZWZpbmVkOwogICAgbGV0IHZhbHVlLCByb3RhdGlvbjsKCiAgICBpZiAoc3RvcmFnZUVudHJ5KSB7CiAgICAgIHZhbHVlID0gc3RvcmFnZUVudHJ5LmZvcm1hdHRlZFZhbHVlIHx8IHN0b3JhZ2VFbnRyeS52YWx1ZTsKICAgICAgcm90YXRpb24gPSBzdG9yYWdlRW50cnkucm90YXRpb247CiAgICB9CgogICAgaWYgKHJvdGF0aW9uID09PSB1bmRlZmluZWQgJiYgdmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICBpZiAoIXRoaXMuX2hhc1ZhbHVlRnJvbVhGQSB8fCB0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQoKICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhbHVlID0gdGhpcy5kYXRhLmZpZWxkVmFsdWU7CgogICAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICB9CgogICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gMSkgewogICAgICB2YWx1ZSA9IHZhbHVlWzBdOwogICAgfQoKICAgICgwLCBfdXRpbC5hc3NlcnQpKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIsICJFeHBlY3RlZCBgdmFsdWVgIHRvIGJlIGEgc3RyaW5nLiIpOwogICAgdmFsdWUgPSB2YWx1ZS50cmltKCk7CgogICAgaWYgKHZhbHVlID09PSAiIikgewogICAgICByZXR1cm4gIiI7CiAgICB9CgogICAgaWYgKHJvdGF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgcm90YXRpb24gPSB0aGlzLnJvdGF0aW9uOwogICAgfQoKICAgIGxldCBsaW5lQ291bnQgPSAtMTsKCiAgICBpZiAodGhpcy5kYXRhLm11bHRpTGluZSkgewogICAgICBsaW5lQ291bnQgPSB2YWx1ZS5zcGxpdCgvXHJcbnxccnxcbi8pLmxlbmd0aDsKICAgIH0KCiAgICBjb25zdCBkZWZhdWx0UGFkZGluZyA9IDI7CiAgICBjb25zdCBoUGFkZGluZyA9IGRlZmF1bHRQYWRkaW5nOwogICAgbGV0IHRvdGFsSGVpZ2h0ID0gdGhpcy5kYXRhLnJlY3RbM10gLSB0aGlzLmRhdGEucmVjdFsxXTsKICAgIGxldCB0b3RhbFdpZHRoID0gdGhpcy5kYXRhLnJlY3RbMl0gLSB0aGlzLmRhdGEucmVjdFswXTsKCiAgICBpZiAocm90YXRpb24gPT09IDkwIHx8IHJvdGF0aW9uID09PSAyNzApIHsKICAgICAgW3RvdGFsV2lkdGgsIHRvdGFsSGVpZ2h0XSA9IFt0b3RhbEhlaWdodCwgdG90YWxXaWR0aF07CiAgICB9CgogICAgaWYgKCF0aGlzLl9kZWZhdWx0QXBwZWFyYW5jZSkgewogICAgICB0aGlzLmRhdGEuZGVmYXVsdEFwcGVhcmFuY2VEYXRhID0gKDAsIF9kZWZhdWx0X2FwcGVhcmFuY2UucGFyc2VEZWZhdWx0QXBwZWFyYW5jZSkodGhpcy5fZGVmYXVsdEFwcGVhcmFuY2UgPSAiL0hlbHZldGljYSAwIFRmIDAgZyIpOwogICAgfQoKICAgIGNvbnN0IGZvbnQgPSBhd2FpdCBXaWRnZXRBbm5vdGF0aW9uLl9nZXRGb250RGF0YShldmFsdWF0b3IsIHRhc2ssIHRoaXMuZGF0YS5kZWZhdWx0QXBwZWFyYW5jZURhdGEsIHRoaXMuX2ZpZWxkUmVzb3VyY2VzLm1lcmdlZFJlc291cmNlcyk7CgogICAgY29uc3QgW2RlZmF1bHRBcHBlYXJhbmNlLCBmb250U2l6ZV0gPSB0aGlzLl9jb21wdXRlRm9udFNpemUodG90YWxIZWlnaHQgLSBkZWZhdWx0UGFkZGluZywgdG90YWxXaWR0aCAtIDIgKiBoUGFkZGluZywgdmFsdWUsIGZvbnQsIGxpbmVDb3VudCk7CgogICAgbGV0IGRlc2NlbnQgPSBmb250LmRlc2NlbnQ7CgogICAgaWYgKGlzTmFOKGRlc2NlbnQpKSB7CiAgICAgIGRlc2NlbnQgPSAwOwogICAgfQoKICAgIGNvbnN0IGRlZmF1bHRWUGFkZGluZyA9IE1hdGgubWluKE1hdGguZmxvb3IoKHRvdGFsSGVpZ2h0IC0gZm9udFNpemUpIC8gMiksIGRlZmF1bHRQYWRkaW5nKTsKICAgIGNvbnN0IHZQYWRkaW5nID0gZGVmYXVsdFZQYWRkaW5nICsgTWF0aC5hYnMoZGVzY2VudCkgKiBmb250U2l6ZTsKICAgIGNvbnN0IGFsaWdubWVudCA9IHRoaXMuZGF0YS50ZXh0QWxpZ25tZW50OwoKICAgIGlmICh0aGlzLmRhdGEubXVsdGlMaW5lKSB7CiAgICAgIHJldHVybiB0aGlzLl9nZXRNdWx0aWxpbmVBcHBlYXJhbmNlKGRlZmF1bHRBcHBlYXJhbmNlLCB2YWx1ZSwgZm9udCwgZm9udFNpemUsIHRvdGFsV2lkdGgsIHRvdGFsSGVpZ2h0LCBhbGlnbm1lbnQsIGhQYWRkaW5nLCB2UGFkZGluZywgYW5ub3RhdGlvblN0b3JhZ2UpOwogICAgfQoKICAgIGNvbnN0IGVuY29kZWRTdHJpbmcgPSBmb250LmVuY29kZVN0cmluZyh2YWx1ZSkuam9pbigiIik7CgogICAgaWYgKHRoaXMuZGF0YS5jb21iKSB7CiAgICAgIHJldHVybiB0aGlzLl9nZXRDb21iQXBwZWFyYW5jZShkZWZhdWx0QXBwZWFyYW5jZSwgZm9udCwgZW5jb2RlZFN0cmluZywgdG90YWxXaWR0aCwgaFBhZGRpbmcsIHZQYWRkaW5nLCBhbm5vdGF0aW9uU3RvcmFnZSk7CiAgICB9CgogICAgY29uc3QgY29sb3JzID0gdGhpcy5nZXRCb3JkZXJBbmRCYWNrZ3JvdW5kQXBwZWFyYW5jZXMoYW5ub3RhdGlvblN0b3JhZ2UpOwoKICAgIGlmIChhbGlnbm1lbnQgPT09IDAgfHwgYWxpZ25tZW50ID4gMikgewogICAgICByZXR1cm4gYC9UeCBCTUMgcSAke2NvbG9yc31CVCBgICsgZGVmYXVsdEFwcGVhcmFuY2UgKyBgIDEgMCAwIDEgJHtoUGFkZGluZ30gJHt2UGFkZGluZ30gVG0gKCR7KDAsIF91dGlsLmVzY2FwZVN0cmluZykoZW5jb2RlZFN0cmluZyl9KSBUamAgKyAiIEVUIFEgRU1DIjsKICAgIH0KCiAgICBjb25zdCByZW5kZXJlZFRleHQgPSB0aGlzLl9yZW5kZXJUZXh0KGVuY29kZWRTdHJpbmcsIGZvbnQsIGZvbnRTaXplLCB0b3RhbFdpZHRoLCBhbGlnbm1lbnQsIGhQYWRkaW5nLCB2UGFkZGluZyk7CgogICAgcmV0dXJuIGAvVHggQk1DIHEgJHtjb2xvcnN9QlQgYCArIGRlZmF1bHRBcHBlYXJhbmNlICsgYCAxIDAgMCAxIDAgMCBUbSAke3JlbmRlcmVkVGV4dH1gICsgIiBFVCBRIEVNQyI7CiAgfQoKICBzdGF0aWMgYXN5bmMgX2dldEZvbnREYXRhKGV2YWx1YXRvciwgdGFzaywgYXBwZWFyYW5jZURhdGEsIHJlc291cmNlcykgewogICAgY29uc3Qgb3BlcmF0b3JMaXN0ID0gbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpOwogICAgY29uc3QgaW5pdGlhbFN0YXRlID0gewogICAgICBmb250OiBudWxsLAoKICAgICAgY2xvbmUoKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICB9OwogICAgY29uc3QgewogICAgICBmb250TmFtZSwKICAgICAgZm9udFNpemUKICAgIH0gPSBhcHBlYXJhbmNlRGF0YTsKICAgIGF3YWl0IGV2YWx1YXRvci5oYW5kbGVTZXRGb250KHJlc291cmNlcywgW2ZvbnROYW1lICYmIF9wcmltaXRpdmVzLk5hbWUuZ2V0KGZvbnROYW1lKSwgZm9udFNpemVdLCBudWxsLCBvcGVyYXRvckxpc3QsIHRhc2ssIGluaXRpYWxTdGF0ZSwgbnVsbCk7CiAgICByZXR1cm4gaW5pdGlhbFN0YXRlLmZvbnQ7CiAgfQoKICBfZ2V0VGV4dFdpZHRoKHRleHQsIGZvbnQpIHsKICAgIHJldHVybiBmb250LmNoYXJzVG9HbHlwaHModGV4dCkucmVkdWNlKCh3aWR0aCwgZ2x5cGgpID0+IHdpZHRoICsgZ2x5cGgud2lkdGgsIDApIC8gMTAwMDsKICB9CgogIF9jb21wdXRlRm9udFNpemUoaGVpZ2h0LCB3aWR0aCwgdGV4dCwgZm9udCwgbGluZUNvdW50KSB7CiAgICBsZXQgewogICAgICBmb250U2l6ZQogICAgfSA9IHRoaXMuZGF0YS5kZWZhdWx0QXBwZWFyYW5jZURhdGE7CgogICAgaWYgKCFmb250U2l6ZSkgewogICAgICBjb25zdCByb3VuZFdpdGhUd29EaWdpdHMgPSB4ID0+IE1hdGguZmxvb3IoeCAqIDEwMCkgLyAxMDA7CgogICAgICBpZiAobGluZUNvdW50ID09PSAtMSkgewogICAgICAgIGNvbnN0IHRleHRXaWR0aCA9IHRoaXMuX2dldFRleHRXaWR0aCh0ZXh0LCBmb250KTsKCiAgICAgICAgZm9udFNpemUgPSByb3VuZFdpdGhUd29EaWdpdHMoTWF0aC5taW4oaGVpZ2h0IC8gX3V0aWwuTElORV9GQUNUT1IsIHdpZHRoIC8gdGV4dFdpZHRoKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KC9cclxuP3xcbi8pOwogICAgICAgIGNvbnN0IGNhY2hlZExpbmVzID0gW107CgogICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykgewogICAgICAgICAgY29uc3QgZW5jb2RlZCA9IGZvbnQuZW5jb2RlU3RyaW5nKGxpbmUpLmpvaW4oIiIpOwogICAgICAgICAgY29uc3QgZ2x5cGhzID0gZm9udC5jaGFyc1RvR2x5cGhzKGVuY29kZWQpOwogICAgICAgICAgY29uc3QgcG9zaXRpb25zID0gZm9udC5nZXRDaGFyUG9zaXRpb25zKGVuY29kZWQpOwogICAgICAgICAgY2FjaGVkTGluZXMucHVzaCh7CiAgICAgICAgICAgIGxpbmU6IGVuY29kZWQsCiAgICAgICAgICAgIGdseXBocywKICAgICAgICAgICAgcG9zaXRpb25zCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGlzVG9vQmlnID0gZnNpemUgPT4gewogICAgICAgICAgbGV0IHRvdGFsSGVpZ2h0ID0gMDsKCiAgICAgICAgICBmb3IgKGNvbnN0IGNhY2hlIG9mIGNhY2hlZExpbmVzKSB7CiAgICAgICAgICAgIGNvbnN0IGNodW5rcyA9IHRoaXMuX3NwbGl0TGluZShudWxsLCBmb250LCBmc2l6ZSwgd2lkdGgsIGNhY2hlKTsKCiAgICAgICAgICAgIHRvdGFsSGVpZ2h0ICs9IGNodW5rcy5sZW5ndGggKiBmc2l6ZTsKCiAgICAgICAgICAgIGlmICh0b3RhbEhlaWdodCA+IGhlaWdodCkgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH07CgogICAgICAgIGZvbnRTaXplID0gMTI7CiAgICAgICAgbGV0IGxpbmVIZWlnaHQgPSBmb250U2l6ZSAqIF91dGlsLkxJTkVfRkFDVE9SOwogICAgICAgIGxldCBudW1iZXJPZkxpbmVzID0gTWF0aC5yb3VuZChoZWlnaHQgLyBsaW5lSGVpZ2h0KTsKICAgICAgICBudW1iZXJPZkxpbmVzID0gTWF0aC5tYXgobnVtYmVyT2ZMaW5lcywgbGluZUNvdW50KTsKCiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgIGxpbmVIZWlnaHQgPSBoZWlnaHQgLyBudW1iZXJPZkxpbmVzOwogICAgICAgICAgZm9udFNpemUgPSByb3VuZFdpdGhUd29EaWdpdHMobGluZUhlaWdodCAvIF91dGlsLkxJTkVfRkFDVE9SKTsKCiAgICAgICAgICBpZiAoaXNUb29CaWcoZm9udFNpemUpKSB7CiAgICAgICAgICAgIG51bWJlck9mTGluZXMrKzsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zdCB7CiAgICAgICAgZm9udE5hbWUsCiAgICAgICAgZm9udENvbG9yCiAgICAgIH0gPSB0aGlzLmRhdGEuZGVmYXVsdEFwcGVhcmFuY2VEYXRhOwogICAgICB0aGlzLl9kZWZhdWx0QXBwZWFyYW5jZSA9ICgwLCBfZGVmYXVsdF9hcHBlYXJhbmNlLmNyZWF0ZURlZmF1bHRBcHBlYXJhbmNlKSh7CiAgICAgICAgZm9udFNpemUsCiAgICAgICAgZm9udE5hbWUsCiAgICAgICAgZm9udENvbG9yCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBbdGhpcy5fZGVmYXVsdEFwcGVhcmFuY2UsIGZvbnRTaXplXTsKICB9CgogIF9yZW5kZXJUZXh0KHRleHQsIGZvbnQsIGZvbnRTaXplLCB0b3RhbFdpZHRoLCBhbGlnbm1lbnQsIGhQYWRkaW5nLCB2UGFkZGluZykgewogICAgbGV0IHNoaWZ0OwoKICAgIGlmIChhbGlnbm1lbnQgPT09IDEpIHsKICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLl9nZXRUZXh0V2lkdGgodGV4dCwgZm9udCkgKiBmb250U2l6ZTsKICAgICAgc2hpZnQgPSAodG90YWxXaWR0aCAtIHdpZHRoKSAvIDI7CiAgICB9IGVsc2UgaWYgKGFsaWdubWVudCA9PT0gMikgewogICAgICBjb25zdCB3aWR0aCA9IHRoaXMuX2dldFRleHRXaWR0aCh0ZXh0LCBmb250KSAqIGZvbnRTaXplOwogICAgICBzaGlmdCA9IHRvdGFsV2lkdGggLSB3aWR0aCAtIGhQYWRkaW5nOwogICAgfSBlbHNlIHsKICAgICAgc2hpZnQgPSBoUGFkZGluZzsKICAgIH0KCiAgICBzaGlmdCA9ICgwLCBfY29yZV91dGlscy5udW1iZXJUb1N0cmluZykoc2hpZnQpOwogICAgdlBhZGRpbmcgPSAoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKHZQYWRkaW5nKTsKICAgIHJldHVybiBgJHtzaGlmdH0gJHt2UGFkZGluZ30gVGQgKCR7KDAsIF91dGlsLmVzY2FwZVN0cmluZykodGV4dCl9KSBUamA7CiAgfQoKICBfZ2V0U2F2ZUZpZWxkUmVzb3VyY2VzKHhyZWYpIHsKICAgIGNvbnN0IHsKICAgICAgbG9jYWxSZXNvdXJjZXMsCiAgICAgIGFwcGVhcmFuY2VSZXNvdXJjZXMsCiAgICAgIGFjcm9Gb3JtUmVzb3VyY2VzCiAgICB9ID0gdGhpcy5fZmllbGRSZXNvdXJjZXM7CiAgICBjb25zdCBmb250TmFtZSA9IHRoaXMuZGF0YS5kZWZhdWx0QXBwZWFyYW5jZURhdGEgJiYgdGhpcy5kYXRhLmRlZmF1bHRBcHBlYXJhbmNlRGF0YS5mb250TmFtZTsKCiAgICBpZiAoIWZvbnROYW1lKSB7CiAgICAgIHJldHVybiBsb2NhbFJlc291cmNlcyB8fCBfcHJpbWl0aXZlcy5EaWN0LmVtcHR5OwogICAgfQoKICAgIGZvciAoY29uc3QgcmVzb3VyY2VzIG9mIFtsb2NhbFJlc291cmNlcywgYXBwZWFyYW5jZVJlc291cmNlc10pIHsKICAgICAgaWYgKHJlc291cmNlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICBjb25zdCBsb2NhbEZvbnQgPSByZXNvdXJjZXMuZ2V0KCJGb250Iik7CgogICAgICAgIGlmIChsb2NhbEZvbnQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ICYmIGxvY2FsRm9udC5oYXMoZm9udE5hbWUpKSB7CiAgICAgICAgICByZXR1cm4gcmVzb3VyY2VzOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChhY3JvRm9ybVJlc291cmNlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgY29uc3QgYWNyb0Zvcm1Gb250ID0gYWNyb0Zvcm1SZXNvdXJjZXMuZ2V0KCJGb250Iik7CgogICAgICBpZiAoYWNyb0Zvcm1Gb250IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiBhY3JvRm9ybUZvbnQuaGFzKGZvbnROYW1lKSkgewogICAgICAgIGNvbnN0IHN1YkZvbnREaWN0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICAgICAgc3ViRm9udERpY3Quc2V0KGZvbnROYW1lLCBhY3JvRm9ybUZvbnQuZ2V0UmF3KGZvbnROYW1lKSk7CiAgICAgICAgY29uc3Qgc3ViUmVzb3VyY2VzRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgICAgIHN1YlJlc291cmNlc0RpY3Quc2V0KCJGb250Iiwgc3ViRm9udERpY3QpOwogICAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5EaWN0Lm1lcmdlKHsKICAgICAgICAgIHhyZWYsCiAgICAgICAgICBkaWN0QXJyYXk6IFtzdWJSZXNvdXJjZXNEaWN0LCBsb2NhbFJlc291cmNlc10sCiAgICAgICAgICBtZXJnZVN1YkRpY3RzOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbG9jYWxSZXNvdXJjZXMgfHwgX3ByaW1pdGl2ZXMuRGljdC5lbXB0eTsKICB9CgogIGdldEZpZWxkT2JqZWN0KCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKfQoKY2xhc3MgVGV4dFdpZGdldEFubm90YXRpb24gZXh0ZW5kcyBXaWRnZXRBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbXMpIHsKICAgIHN1cGVyKHBhcmFtcyk7CiAgICB0aGlzLl9oYXNUZXh0ID0gdHJ1ZTsKICAgIGNvbnN0IGRpY3QgPSBwYXJhbXMuZGljdDsKCiAgICBpZiAodHlwZW9mIHRoaXMuZGF0YS5maWVsZFZhbHVlICE9PSAic3RyaW5nIikgewogICAgICB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9ICIiOwogICAgfQoKICAgIGxldCBhbGlnbm1lbnQgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0SW5oZXJpdGFibGVQcm9wZXJ0eSkoewogICAgICBkaWN0LAogICAgICBrZXk6ICJRIgogICAgfSk7CgogICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGFsaWdubWVudCkgfHwgYWxpZ25tZW50IDwgMCB8fCBhbGlnbm1lbnQgPiAyKSB7CiAgICAgIGFsaWdubWVudCA9IG51bGw7CiAgICB9CgogICAgdGhpcy5kYXRhLnRleHRBbGlnbm1lbnQgPSBhbGlnbm1lbnQ7CiAgICBsZXQgbWF4aW11bUxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3QsCiAgICAgIGtleTogIk1heExlbiIKICAgIH0pOwoKICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihtYXhpbXVtTGVuZ3RoKSB8fCBtYXhpbXVtTGVuZ3RoIDwgMCkgewogICAgICBtYXhpbXVtTGVuZ3RoID0gMDsKICAgIH0KCiAgICB0aGlzLmRhdGEubWF4TGVuID0gbWF4aW11bUxlbmd0aDsKICAgIHRoaXMuZGF0YS5tdWx0aUxpbmUgPSB0aGlzLmhhc0ZpZWxkRmxhZyhfdXRpbC5Bbm5vdGF0aW9uRmllbGRGbGFnLk1VTFRJTElORSk7CiAgICB0aGlzLmRhdGEuY29tYiA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuQ09NQikgJiYgIXRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuTVVMVElMSU5FKSAmJiAhdGhpcy5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5QQVNTV09SRCkgJiYgIXRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuRklMRVNFTEVDVCkgJiYgdGhpcy5kYXRhLm1heExlbiAhPT0gMDsKICAgIHRoaXMuZGF0YS5kb05vdFNjcm9sbCA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuRE9OT1RTQ1JPTEwpOwogIH0KCiAgX2dldENvbWJBcHBlYXJhbmNlKGRlZmF1bHRBcHBlYXJhbmNlLCBmb250LCB0ZXh0LCB3aWR0aCwgaFBhZGRpbmcsIHZQYWRkaW5nLCBhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgY29uc3QgY29tYldpZHRoID0gKDAsIF9jb3JlX3V0aWxzLm51bWJlclRvU3RyaW5nKSh3aWR0aCAvIHRoaXMuZGF0YS5tYXhMZW4pOwogICAgY29uc3QgYnVmID0gW107CiAgICBjb25zdCBwb3NpdGlvbnMgPSBmb250LmdldENoYXJQb3NpdGlvbnModGV4dCk7CgogICAgZm9yIChjb25zdCBbc3RhcnQsIGVuZF0gb2YgcG9zaXRpb25zKSB7CiAgICAgIGJ1Zi5wdXNoKGAoJHsoMCwgX3V0aWwuZXNjYXBlU3RyaW5nKSh0ZXh0LnN1YnN0cmluZyhzdGFydCwgZW5kKSl9KSBUamApOwogICAgfQoKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuZ2V0Qm9yZGVyQW5kQmFja2dyb3VuZEFwcGVhcmFuY2VzKGFubm90YXRpb25TdG9yYWdlKTsKICAgIGNvbnN0IHJlbmRlcmVkQ29tYiA9IGJ1Zi5qb2luKGAgJHtjb21iV2lkdGh9IDAgVGQgYCk7CiAgICByZXR1cm4gYC9UeCBCTUMgcSAke2NvbG9yc31CVCBgICsgZGVmYXVsdEFwcGVhcmFuY2UgKyBgIDEgMCAwIDEgJHtoUGFkZGluZ30gJHt2UGFkZGluZ30gVG0gJHtyZW5kZXJlZENvbWJ9YCArICIgRVQgUSBFTUMiOwogIH0KCiAgX2dldE11bHRpbGluZUFwcGVhcmFuY2UoZGVmYXVsdEFwcGVhcmFuY2UsIHRleHQsIGZvbnQsIGZvbnRTaXplLCB3aWR0aCwgaGVpZ2h0LCBhbGlnbm1lbnQsIGhQYWRkaW5nLCB2UGFkZGluZywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGNvbnN0IGxpbmVzID0gdGV4dC5zcGxpdCgvXHJcbj98XG4vKTsKICAgIGNvbnN0IGJ1ZiA9IFtdOwogICAgY29uc3QgdG90YWxXaWR0aCA9IHdpZHRoIC0gMiAqIGhQYWRkaW5nOwoKICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykgewogICAgICBjb25zdCBjaHVua3MgPSB0aGlzLl9zcGxpdExpbmUobGluZSwgZm9udCwgZm9udFNpemUsIHRvdGFsV2lkdGgpOwoKICAgICAgZm9yIChjb25zdCBjaHVuayBvZiBjaHVua3MpIHsKICAgICAgICBjb25zdCBwYWRkaW5nID0gYnVmLmxlbmd0aCA9PT0gMCA/IGhQYWRkaW5nIDogMDsKICAgICAgICBidWYucHVzaCh0aGlzLl9yZW5kZXJUZXh0KGNodW5rLCBmb250LCBmb250U2l6ZSwgd2lkdGgsIGFsaWdubWVudCwgcGFkZGluZywgLWZvbnRTaXplKSk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCByZW5kZXJlZFRleHQgPSBidWYuam9pbigiXG4iKTsKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuZ2V0Qm9yZGVyQW5kQmFja2dyb3VuZEFwcGVhcmFuY2VzKGFubm90YXRpb25TdG9yYWdlKTsKICAgIHJldHVybiBgL1R4IEJNQyBxICR7Y29sb3JzfUJUIGAgKyBkZWZhdWx0QXBwZWFyYW5jZSArIGAgMSAwIDAgMSAwICR7aGVpZ2h0fSBUbSAke3JlbmRlcmVkVGV4dH1gICsgIiBFVCBRIEVNQyI7CiAgfQoKICBfc3BsaXRMaW5lKGxpbmUsIGZvbnQsIGZvbnRTaXplLCB3aWR0aCkgewogICAgbGV0IGNhY2hlID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB7fTsKICAgIGxpbmUgPSBjYWNoZS5saW5lIHx8IGZvbnQuZW5jb2RlU3RyaW5nKGxpbmUpLmpvaW4oIiIpOwogICAgY29uc3QgZ2x5cGhzID0gY2FjaGUuZ2x5cGhzIHx8IGZvbnQuY2hhcnNUb0dseXBocyhsaW5lKTsKCiAgICBpZiAoZ2x5cGhzLmxlbmd0aCA8PSAxKSB7CiAgICAgIHJldHVybiBbbGluZV07CiAgICB9CgogICAgY29uc3QgcG9zaXRpb25zID0gY2FjaGUucG9zaXRpb25zIHx8IGZvbnQuZ2V0Q2hhclBvc2l0aW9ucyhsaW5lKTsKICAgIGNvbnN0IHNjYWxlID0gZm9udFNpemUgLyAxMDAwOwogICAgY29uc3QgY2h1bmtzID0gW107CiAgICBsZXQgbGFzdFNwYWNlUG9zSW5TdHJpbmdTdGFydCA9IC0xLAogICAgICAgIGxhc3RTcGFjZVBvc0luU3RyaW5nRW5kID0gLTEsCiAgICAgICAgbGFzdFNwYWNlUG9zID0gLTEsCiAgICAgICAgc3RhcnRDaHVuayA9IDAsCiAgICAgICAgY3VycmVudFdpZHRoID0gMDsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBnbHlwaHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCBbc3RhcnQsIGVuZF0gPSBwb3NpdGlvbnNbaV07CiAgICAgIGNvbnN0IGdseXBoID0gZ2x5cGhzW2ldOwogICAgICBjb25zdCBnbHlwaFdpZHRoID0gZ2x5cGgud2lkdGggKiBzY2FsZTsKCiAgICAgIGlmIChnbHlwaC51bmljb2RlID09PSAiICIpIHsKICAgICAgICBpZiAoY3VycmVudFdpZHRoICsgZ2x5cGhXaWR0aCA+IHdpZHRoKSB7CiAgICAgICAgICBjaHVua3MucHVzaChsaW5lLnN1YnN0cmluZyhzdGFydENodW5rLCBzdGFydCkpOwogICAgICAgICAgc3RhcnRDaHVuayA9IHN0YXJ0OwogICAgICAgICAgY3VycmVudFdpZHRoID0gZ2x5cGhXaWR0aDsKICAgICAgICAgIGxhc3RTcGFjZVBvc0luU3RyaW5nU3RhcnQgPSAtMTsKICAgICAgICAgIGxhc3RTcGFjZVBvcyA9IC0xOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjdXJyZW50V2lkdGggKz0gZ2x5cGhXaWR0aDsKICAgICAgICAgIGxhc3RTcGFjZVBvc0luU3RyaW5nU3RhcnQgPSBzdGFydDsKICAgICAgICAgIGxhc3RTcGFjZVBvc0luU3RyaW5nRW5kID0gZW5kOwogICAgICAgICAgbGFzdFNwYWNlUG9zID0gaTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGN1cnJlbnRXaWR0aCArIGdseXBoV2lkdGggPiB3aWR0aCkgewogICAgICAgICAgaWYgKGxhc3RTcGFjZVBvc0luU3RyaW5nU3RhcnQgIT09IC0xKSB7CiAgICAgICAgICAgIGNodW5rcy5wdXNoKGxpbmUuc3Vic3RyaW5nKHN0YXJ0Q2h1bmssIGxhc3RTcGFjZVBvc0luU3RyaW5nRW5kKSk7CiAgICAgICAgICAgIHN0YXJ0Q2h1bmsgPSBsYXN0U3BhY2VQb3NJblN0cmluZ0VuZDsKICAgICAgICAgICAgaSA9IGxhc3RTcGFjZVBvcyArIDE7CiAgICAgICAgICAgIGxhc3RTcGFjZVBvc0luU3RyaW5nU3RhcnQgPSAtMTsKICAgICAgICAgICAgY3VycmVudFdpZHRoID0gMDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNodW5rcy5wdXNoKGxpbmUuc3Vic3RyaW5nKHN0YXJ0Q2h1bmssIHN0YXJ0KSk7CiAgICAgICAgICAgIHN0YXJ0Q2h1bmsgPSBzdGFydDsKICAgICAgICAgICAgY3VycmVudFdpZHRoID0gZ2x5cGhXaWR0aDsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3VycmVudFdpZHRoICs9IGdseXBoV2lkdGg7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKHN0YXJ0Q2h1bmsgPCBsaW5lLmxlbmd0aCkgewogICAgICBjaHVua3MucHVzaChsaW5lLnN1YnN0cmluZyhzdGFydENodW5rLCBsaW5lLmxlbmd0aCkpOwogICAgfQoKICAgIHJldHVybiBjaHVua3M7CiAgfQoKICBnZXRGaWVsZE9iamVjdCgpIHsKICAgIHJldHVybiB7CiAgICAgIGlkOiB0aGlzLmRhdGEuaWQsCiAgICAgIHZhbHVlOiB0aGlzLmRhdGEuZmllbGRWYWx1ZSwKICAgICAgZGVmYXVsdFZhbHVlOiB0aGlzLmRhdGEuZGVmYXVsdEZpZWxkVmFsdWUgfHwgIiIsCiAgICAgIG11bHRpbGluZTogdGhpcy5kYXRhLm11bHRpTGluZSwKICAgICAgcGFzc3dvcmQ6IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUEFTU1dPUkQpLAogICAgICBjaGFyTGltaXQ6IHRoaXMuZGF0YS5tYXhMZW4sCiAgICAgIGNvbWI6IHRoaXMuZGF0YS5jb21iLAogICAgICBlZGl0YWJsZTogIXRoaXMuZGF0YS5yZWFkT25seSwKICAgICAgaGlkZGVuOiB0aGlzLmRhdGEuaGlkZGVuLAogICAgICBuYW1lOiB0aGlzLmRhdGEuZmllbGROYW1lLAogICAgICByZWN0OiB0aGlzLmRhdGEucmVjdCwKICAgICAgYWN0aW9uczogdGhpcy5kYXRhLmFjdGlvbnMsCiAgICAgIHBhZ2U6IHRoaXMuZGF0YS5wYWdlSW5kZXgsCiAgICAgIHN0cm9rZUNvbG9yOiB0aGlzLmRhdGEuYm9yZGVyQ29sb3IsCiAgICAgIGZpbGxDb2xvcjogdGhpcy5kYXRhLmJhY2tncm91bmRDb2xvciwKICAgICAgcm90YXRpb246IHRoaXMucm90YXRpb24sCiAgICAgIHR5cGU6ICJ0ZXh0IgogICAgfTsKICB9Cgp9CgpjbGFzcyBCdXR0b25XaWRnZXRBbm5vdGF0aW9uIGV4dGVuZHMgV2lkZ2V0QW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1zKSB7CiAgICBzdXBlcihwYXJhbXMpOwogICAgdGhpcy5jaGVja2VkQXBwZWFyYW5jZSA9IG51bGw7CiAgICB0aGlzLnVuY2hlY2tlZEFwcGVhcmFuY2UgPSBudWxsOwogICAgdGhpcy5kYXRhLmNoZWNrQm94ID0gIXRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUkFESU8pICYmICF0aGlzLmhhc0ZpZWxkRmxhZyhfdXRpbC5Bbm5vdGF0aW9uRmllbGRGbGFnLlBVU0hCVVRUT04pOwogICAgdGhpcy5kYXRhLnJhZGlvQnV0dG9uID0gdGhpcy5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5SQURJTykgJiYgIXRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUFVTSEJVVFRPTik7CiAgICB0aGlzLmRhdGEucHVzaEJ1dHRvbiA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUFVTSEJVVFRPTik7CiAgICB0aGlzLmRhdGEuaXNUb29sdGlwT25seSA9IGZhbHNlOwoKICAgIGlmICh0aGlzLmRhdGEuY2hlY2tCb3gpIHsKICAgICAgdGhpcy5fcHJvY2Vzc0NoZWNrQm94KHBhcmFtcyk7CiAgICB9IGVsc2UgaWYgKHRoaXMuZGF0YS5yYWRpb0J1dHRvbikgewogICAgICB0aGlzLl9wcm9jZXNzUmFkaW9CdXR0b24ocGFyYW1zKTsKICAgIH0gZWxzZSBpZiAodGhpcy5kYXRhLnB1c2hCdXR0b24pIHsKICAgICAgdGhpcy5kYXRhLmhhc093bkNhbnZhcyA9IHRydWU7CgogICAgICB0aGlzLl9wcm9jZXNzUHVzaEJ1dHRvbihwYXJhbXMpOwogICAgfSBlbHNlIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJJbnZhbGlkIGZpZWxkIGZsYWdzIGZvciBidXR0b24gd2lkZ2V0IGFubm90YXRpb24iKTsKICAgIH0KICB9CgogIGFzeW5jIGdldE9wZXJhdG9yTGlzdChldmFsdWF0b3IsIHRhc2ssIGludGVudCwgcmVuZGVyRm9ybXMsIGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBpZiAodGhpcy5kYXRhLnB1c2hCdXR0b24pIHsKICAgICAgcmV0dXJuIHN1cGVyLmdldE9wZXJhdG9yTGlzdChldmFsdWF0b3IsIHRhc2ssIGludGVudCwgZmFsc2UsIGFubm90YXRpb25TdG9yYWdlKTsKICAgIH0KCiAgICBsZXQgdmFsdWUgPSBudWxsOwogICAgbGV0IHJvdGF0aW9uID0gbnVsbDsKCiAgICBpZiAoYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgICAgY29uc3Qgc3RvcmFnZUVudHJ5ID0gYW5ub3RhdGlvblN0b3JhZ2UuZ2V0KHRoaXMuZGF0YS5pZCk7CiAgICAgIHZhbHVlID0gc3RvcmFnZUVudHJ5ID8gc3RvcmFnZUVudHJ5LnZhbHVlIDogbnVsbDsKICAgICAgcm90YXRpb24gPSBzdG9yYWdlRW50cnkgPyBzdG9yYWdlRW50cnkucm90YXRpb24gOiBudWxsOwogICAgfQoKICAgIGlmICh2YWx1ZSA9PT0gbnVsbCAmJiB0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgcmV0dXJuIHN1cGVyLmdldE9wZXJhdG9yTGlzdChldmFsdWF0b3IsIHRhc2ssIGludGVudCwgcmVuZGVyRm9ybXMsIGFubm90YXRpb25TdG9yYWdlKTsKICAgIH0KCiAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICBpZiAodGhpcy5kYXRhLmNoZWNrQm94KSB7CiAgICAgICAgdmFsdWUgPSB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9PT0gdGhpcy5kYXRhLmV4cG9ydFZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgIHZhbHVlID0gdGhpcy5kYXRhLmZpZWxkVmFsdWUgPT09IHRoaXMuZGF0YS5idXR0b25WYWx1ZTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGFwcGVhcmFuY2UgPSB2YWx1ZSA/IHRoaXMuY2hlY2tlZEFwcGVhcmFuY2UgOiB0aGlzLnVuY2hlY2tlZEFwcGVhcmFuY2U7CgogICAgaWYgKGFwcGVhcmFuY2UpIHsKICAgICAgY29uc3Qgc2F2ZWRBcHBlYXJhbmNlID0gdGhpcy5hcHBlYXJhbmNlOwoKICAgICAgY29uc3Qgc2F2ZWRNYXRyaXggPSBhcHBlYXJhbmNlLmRpY3QuZ2V0QXJyYXkoIk1hdHJpeCIpIHx8IF91dGlsLklERU5USVRZX01BVFJJWDsKCiAgICAgIGlmIChyb3RhdGlvbikgewogICAgICAgIGFwcGVhcmFuY2UuZGljdC5zZXQoIk1hdHJpeCIsIHRoaXMuZ2V0Um90YXRpb25NYXRyaXgoYW5ub3RhdGlvblN0b3JhZ2UpKTsKICAgICAgfQoKICAgICAgdGhpcy5hcHBlYXJhbmNlID0gYXBwZWFyYW5jZTsKICAgICAgY29uc3Qgb3BlcmF0b3JMaXN0ID0gc3VwZXIuZ2V0T3BlcmF0b3JMaXN0KGV2YWx1YXRvciwgdGFzaywgaW50ZW50LCByZW5kZXJGb3JtcywgYW5ub3RhdGlvblN0b3JhZ2UpOwogICAgICB0aGlzLmFwcGVhcmFuY2UgPSBzYXZlZEFwcGVhcmFuY2U7CiAgICAgIGFwcGVhcmFuY2UuZGljdC5zZXQoIk1hdHJpeCIsIHNhdmVkTWF0cml4KTsKICAgICAgcmV0dXJuIG9wZXJhdG9yTGlzdDsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBvcExpc3Q6IG5ldyBfb3BlcmF0b3JfbGlzdC5PcGVyYXRvckxpc3QoKSwKICAgICAgc2VwYXJhdGVGb3JtOiBmYWxzZSwKICAgICAgc2VwYXJhdGVDYW52YXM6IGZhbHNlCiAgICB9OwogIH0KCiAgYXN5bmMgc2F2ZShldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBpZiAodGhpcy5kYXRhLmNoZWNrQm94KSB7CiAgICAgIHJldHVybiB0aGlzLl9zYXZlQ2hlY2tib3goZXZhbHVhdG9yLCB0YXNrLCBhbm5vdGF0aW9uU3RvcmFnZSk7CiAgICB9CgogICAgaWYgKHRoaXMuZGF0YS5yYWRpb0J1dHRvbikgewogICAgICByZXR1cm4gdGhpcy5fc2F2ZVJhZGlvQnV0dG9uKGV2YWx1YXRvciwgdGFzaywgYW5ub3RhdGlvblN0b3JhZ2UpOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgYXN5bmMgX3NhdmVDaGVja2JveChldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBpZiAoIWFubm90YXRpb25TdG9yYWdlKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHN0b3JhZ2VFbnRyeSA9IGFubm90YXRpb25TdG9yYWdlLmdldCh0aGlzLmRhdGEuaWQpOwogICAgbGV0IHJvdGF0aW9uID0gc3RvcmFnZUVudHJ5ICYmIHN0b3JhZ2VFbnRyeS5yb3RhdGlvbjsKICAgIGxldCB2YWx1ZSA9IHN0b3JhZ2VFbnRyeSAmJiBzdG9yYWdlRW50cnkudmFsdWU7CgogICAgaWYgKHJvdGF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgY29uc3QgZGVmYXVsdFZhbHVlID0gdGhpcy5kYXRhLmZpZWxkVmFsdWUgPT09IHRoaXMuZGF0YS5leHBvcnRWYWx1ZTsKCiAgICAgIGlmIChkZWZhdWx0VmFsdWUgPT09IHZhbHVlKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBkaWN0ID0gZXZhbHVhdG9yLnhyZWYuZmV0Y2hJZlJlZih0aGlzLnJlZik7CgogICAgaWYgKCEoZGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmIChyb3RhdGlvbiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJvdGF0aW9uID0gdGhpcy5yb3RhdGlvbjsKICAgIH0KCiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICB2YWx1ZSA9IHRoaXMuZGF0YS5maWVsZFZhbHVlID09PSB0aGlzLmRhdGEuZXhwb3J0VmFsdWU7CiAgICB9CgogICAgY29uc3QgeGZhID0gewogICAgICBwYXRoOiAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGRpY3QuZ2V0KCJUIikgfHwgIiIpLAogICAgICB2YWx1ZTogdmFsdWUgPyB0aGlzLmRhdGEuZXhwb3J0VmFsdWUgOiAiIgogICAgfTsKCiAgICBjb25zdCBuYW1lID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQodmFsdWUgPyB0aGlzLmRhdGEuZXhwb3J0VmFsdWUgOiAiT2ZmIik7CgogICAgZGljdC5zZXQoIlYiLCBuYW1lKTsKICAgIGRpY3Quc2V0KCJBUyIsIG5hbWUpOwogICAgZGljdC5zZXQoIk0iLCBgRDokeygwLCBfdXRpbC5nZXRNb2RpZmljYXRpb25EYXRlKSgpfWApOwoKICAgIGNvbnN0IG1heWJlTUsgPSB0aGlzLl9nZXRNS0RpY3Qocm90YXRpb24pOwoKICAgIGlmIChtYXliZU1LKSB7CiAgICAgIGRpY3Quc2V0KCJNSyIsIG1heWJlTUspOwogICAgfQoKICAgIGNvbnN0IGVuY3J5cHQgPSBldmFsdWF0b3IueHJlZi5lbmNyeXB0OwogICAgbGV0IG9yaWdpbmFsVHJhbnNmb3JtID0gbnVsbDsKCiAgICBpZiAoZW5jcnlwdCkgewogICAgICBvcmlnaW5hbFRyYW5zZm9ybSA9IGVuY3J5cHQuY3JlYXRlQ2lwaGVyVHJhbnNmb3JtKHRoaXMucmVmLm51bSwgdGhpcy5yZWYuZ2VuKTsKICAgIH0KCiAgICBjb25zdCBidWZmZXIgPSBbYCR7dGhpcy5yZWYubnVtfSAke3RoaXMucmVmLmdlbn0gb2JqXG5gXTsKICAgICgwLCBfd3JpdGVyLndyaXRlRGljdCkoZGljdCwgYnVmZmVyLCBvcmlnaW5hbFRyYW5zZm9ybSk7CiAgICBidWZmZXIucHVzaCgiXG5lbmRvYmpcbiIpOwogICAgcmV0dXJuIFt7CiAgICAgIHJlZjogdGhpcy5yZWYsCiAgICAgIGRhdGE6IGJ1ZmZlci5qb2luKCIiKSwKICAgICAgeGZhCiAgICB9XTsKICB9CgogIGFzeW5jIF9zYXZlUmFkaW9CdXR0b24oZXZhbHVhdG9yLCB0YXNrLCBhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgaWYgKCFhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZS5nZXQodGhpcy5kYXRhLmlkKTsKICAgIGxldCByb3RhdGlvbiA9IHN0b3JhZ2VFbnRyeSAmJiBzdG9yYWdlRW50cnkucm90YXRpb247CiAgICBsZXQgdmFsdWUgPSBzdG9yYWdlRW50cnkgJiYgc3RvcmFnZUVudHJ5LnZhbHVlOwoKICAgIGlmIChyb3RhdGlvbiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IHRoaXMuZGF0YS5maWVsZFZhbHVlID09PSB0aGlzLmRhdGEuYnV0dG9uVmFsdWU7CgogICAgICBpZiAoZGVmYXVsdFZhbHVlID09PSB2YWx1ZSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9CgogICAgY29uc3QgZGljdCA9IGV2YWx1YXRvci54cmVmLmZldGNoSWZSZWYodGhpcy5yZWYpOwoKICAgIGlmICghKGRpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICB2YWx1ZSA9IHRoaXMuZGF0YS5maWVsZFZhbHVlID09PSB0aGlzLmRhdGEuYnV0dG9uVmFsdWU7CiAgICB9CgogICAgaWYgKHJvdGF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgcm90YXRpb24gPSB0aGlzLnJvdGF0aW9uOwogICAgfQoKICAgIGNvbnN0IHhmYSA9IHsKICAgICAgcGF0aDogKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShkaWN0LmdldCgiVCIpIHx8ICIiKSwKICAgICAgdmFsdWU6IHZhbHVlID8gdGhpcy5kYXRhLmJ1dHRvblZhbHVlIDogIiIKICAgIH07CgogICAgY29uc3QgbmFtZSA9IF9wcmltaXRpdmVzLk5hbWUuZ2V0KHZhbHVlID8gdGhpcy5kYXRhLmJ1dHRvblZhbHVlIDogIk9mZiIpOwoKICAgIGxldCBwYXJlbnRCdWZmZXIgPSBudWxsOwogICAgY29uc3QgZW5jcnlwdCA9IGV2YWx1YXRvci54cmVmLmVuY3J5cHQ7CgogICAgaWYgKHZhbHVlKSB7CiAgICAgIGlmICh0aGlzLnBhcmVudCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgIGNvbnN0IHBhcmVudCA9IGV2YWx1YXRvci54cmVmLmZldGNoKHRoaXMucGFyZW50KTsKICAgICAgICBsZXQgcGFyZW50VHJhbnNmb3JtID0gbnVsbDsKCiAgICAgICAgaWYgKGVuY3J5cHQpIHsKICAgICAgICAgIHBhcmVudFRyYW5zZm9ybSA9IGVuY3J5cHQuY3JlYXRlQ2lwaGVyVHJhbnNmb3JtKHRoaXMucGFyZW50Lm51bSwgdGhpcy5wYXJlbnQuZ2VuKTsKICAgICAgICB9CgogICAgICAgIHBhcmVudC5zZXQoIlYiLCBuYW1lKTsKICAgICAgICBwYXJlbnRCdWZmZXIgPSBbYCR7dGhpcy5wYXJlbnQubnVtfSAke3RoaXMucGFyZW50Lmdlbn0gb2JqXG5gXTsKICAgICAgICAoMCwgX3dyaXRlci53cml0ZURpY3QpKHBhcmVudCwgcGFyZW50QnVmZmVyLCBwYXJlbnRUcmFuc2Zvcm0pOwogICAgICAgIHBhcmVudEJ1ZmZlci5wdXNoKCJcbmVuZG9ialxuIik7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5wYXJlbnQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgdGhpcy5wYXJlbnQuc2V0KCJWIiwgbmFtZSk7CiAgICAgIH0KICAgIH0KCiAgICBkaWN0LnNldCgiQVMiLCBuYW1lKTsKICAgIGRpY3Quc2V0KCJNIiwgYEQ6JHsoMCwgX3V0aWwuZ2V0TW9kaWZpY2F0aW9uRGF0ZSkoKX1gKTsKCiAgICBjb25zdCBtYXliZU1LID0gdGhpcy5fZ2V0TUtEaWN0KHJvdGF0aW9uKTsKCiAgICBpZiAobWF5YmVNSykgewogICAgICBkaWN0LnNldCgiTUsiLCBtYXliZU1LKTsKICAgIH0KCiAgICBsZXQgb3JpZ2luYWxUcmFuc2Zvcm0gPSBudWxsOwoKICAgIGlmIChlbmNyeXB0KSB7CiAgICAgIG9yaWdpbmFsVHJhbnNmb3JtID0gZW5jcnlwdC5jcmVhdGVDaXBoZXJUcmFuc2Zvcm0odGhpcy5yZWYubnVtLCB0aGlzLnJlZi5nZW4pOwogICAgfQoKICAgIGNvbnN0IGJ1ZmZlciA9IFtgJHt0aGlzLnJlZi5udW19ICR7dGhpcy5yZWYuZ2VufSBvYmpcbmBdOwogICAgKDAsIF93cml0ZXIud3JpdGVEaWN0KShkaWN0LCBidWZmZXIsIG9yaWdpbmFsVHJhbnNmb3JtKTsKICAgIGJ1ZmZlci5wdXNoKCJcbmVuZG9ialxuIik7CiAgICBjb25zdCBuZXdSZWZzID0gW3sKICAgICAgcmVmOiB0aGlzLnJlZiwKICAgICAgZGF0YTogYnVmZmVyLmpvaW4oIiIpLAogICAgICB4ZmEKICAgIH1dOwoKICAgIGlmIChwYXJlbnRCdWZmZXIgIT09IG51bGwpIHsKICAgICAgbmV3UmVmcy5wdXNoKHsKICAgICAgICByZWY6IHRoaXMucGFyZW50LAogICAgICAgIGRhdGE6IHBhcmVudEJ1ZmZlci5qb2luKCIiKSwKICAgICAgICB4ZmE6IG51bGwKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIG5ld1JlZnM7CiAgfQoKICBfZ2V0RGVmYXVsdENoZWNrZWRBcHBlYXJhbmNlKHBhcmFtcywgdHlwZSkgewogICAgY29uc3Qgd2lkdGggPSB0aGlzLmRhdGEucmVjdFsyXSAtIHRoaXMuZGF0YS5yZWN0WzBdOwogICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5kYXRhLnJlY3RbM10gLSB0aGlzLmRhdGEucmVjdFsxXTsKICAgIGNvbnN0IGJib3ggPSBbMCwgMCwgd2lkdGgsIGhlaWdodF07CiAgICBjb25zdCBGT05UX1JBVElPID0gMC44OwogICAgY29uc3QgZm9udFNpemUgPSBNYXRoLm1pbih3aWR0aCwgaGVpZ2h0KSAqIEZPTlRfUkFUSU87CiAgICBsZXQgbWV0cmljcywgY2hhcjsKCiAgICBpZiAodHlwZSA9PT0gImNoZWNrIikgewogICAgICBtZXRyaWNzID0gewogICAgICAgIHdpZHRoOiAwLjc1NSAqIGZvbnRTaXplLAogICAgICAgIGhlaWdodDogMC43MDUgKiBmb250U2l6ZQogICAgICB9OwogICAgICBjaGFyID0gIlx4MzMiOwogICAgfSBlbHNlIGlmICh0eXBlID09PSAiZGlzYyIpIHsKICAgICAgbWV0cmljcyA9IHsKICAgICAgICB3aWR0aDogMC43OTEgKiBmb250U2l6ZSwKICAgICAgICBoZWlnaHQ6IDAuNzA1ICogZm9udFNpemUKICAgICAgfTsKICAgICAgY2hhciA9ICJceDZDIjsKICAgIH0gZWxzZSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoYF9nZXREZWZhdWx0Q2hlY2tlZEFwcGVhcmFuY2UgLSB1bnN1cHBvcnRlZCB0eXBlOiAke3R5cGV9YCk7CiAgICB9CgogICAgY29uc3QgeFNoaWZ0ID0gKDAsIF9jb3JlX3V0aWxzLm51bWJlclRvU3RyaW5nKSgod2lkdGggLSBtZXRyaWNzLndpZHRoKSAvIDIpOwogICAgY29uc3QgeVNoaWZ0ID0gKDAsIF9jb3JlX3V0aWxzLm51bWJlclRvU3RyaW5nKSgoaGVpZ2h0IC0gbWV0cmljcy5oZWlnaHQpIC8gMik7CiAgICBjb25zdCBhcHBlYXJhbmNlID0gYHEgQlQgL1BkZkpzWmFEYiAke2ZvbnRTaXplfSBUZiAwIGcgJHt4U2hpZnR9ICR7eVNoaWZ0fSBUZCAoJHtjaGFyfSkgVGogRVQgUWA7CiAgICBjb25zdCBhcHBlYXJhbmNlU3RyZWFtRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHBhcmFtcy54cmVmKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiRm9ybVR5cGUiLCAxKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiU3VidHlwZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJGb3JtIikpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJUeXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIlhPYmplY3QiKSk7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIkJCb3giLCBiYm94KTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiTWF0cml4IiwgWzEsIDAsIDAsIDEsIDAsIDBdKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiTGVuZ3RoIiwgYXBwZWFyYW5jZS5sZW5ndGgpOwogICAgY29uc3QgcmVzb3VyY2VzID0gbmV3IF9wcmltaXRpdmVzLkRpY3QocGFyYW1zLnhyZWYpOwogICAgY29uc3QgZm9udCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHBhcmFtcy54cmVmKTsKICAgIGZvbnQuc2V0KCJQZGZKc1phRGIiLCB0aGlzLmZhbGxiYWNrRm9udERpY3QpOwogICAgcmVzb3VyY2VzLnNldCgiRm9udCIsIGZvbnQpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJSZXNvdXJjZXMiLCByZXNvdXJjZXMpOwogICAgdGhpcy5jaGVja2VkQXBwZWFyYW5jZSA9IG5ldyBfc3RyZWFtLlN0cmluZ1N0cmVhbShhcHBlYXJhbmNlKTsKICAgIHRoaXMuY2hlY2tlZEFwcGVhcmFuY2UuZGljdCA9IGFwcGVhcmFuY2VTdHJlYW1EaWN0OwoKICAgIHRoaXMuX3N0cmVhbXMucHVzaCh0aGlzLmNoZWNrZWRBcHBlYXJhbmNlKTsKICB9CgogIF9wcm9jZXNzQ2hlY2tCb3gocGFyYW1zKSB7CiAgICBjb25zdCBjdXN0b21BcHBlYXJhbmNlID0gcGFyYW1zLmRpY3QuZ2V0KCJBUCIpOwoKICAgIGlmICghKGN1c3RvbUFwcGVhcmFuY2UgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3Qgbm9ybWFsQXBwZWFyYW5jZSA9IGN1c3RvbUFwcGVhcmFuY2UuZ2V0KCJOIik7CgogICAgaWYgKCEobm9ybWFsQXBwZWFyYW5jZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBhc1ZhbHVlID0gdGhpcy5fZGVjb2RlRm9ybVZhbHVlKHBhcmFtcy5kaWN0LmdldCgiQVMiKSk7CgogICAgaWYgKHR5cGVvZiBhc1ZhbHVlID09PSAic3RyaW5nIikgewogICAgICB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9IGFzVmFsdWU7CiAgICB9CgogICAgY29uc3QgeWVzID0gdGhpcy5kYXRhLmZpZWxkVmFsdWUgIT09IG51bGwgJiYgdGhpcy5kYXRhLmZpZWxkVmFsdWUgIT09ICJPZmYiID8gdGhpcy5kYXRhLmZpZWxkVmFsdWUgOiAiWWVzIjsKICAgIGNvbnN0IGV4cG9ydFZhbHVlcyA9IG5vcm1hbEFwcGVhcmFuY2UuZ2V0S2V5cygpOwoKICAgIGlmIChleHBvcnRWYWx1ZXMubGVuZ3RoID09PSAwKSB7CiAgICAgIGV4cG9ydFZhbHVlcy5wdXNoKCJPZmYiLCB5ZXMpOwogICAgfSBlbHNlIGlmIChleHBvcnRWYWx1ZXMubGVuZ3RoID09PSAxKSB7CiAgICAgIGlmIChleHBvcnRWYWx1ZXNbMF0gPT09ICJPZmYiKSB7CiAgICAgICAgZXhwb3J0VmFsdWVzLnB1c2goeWVzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBleHBvcnRWYWx1ZXMudW5zaGlmdCgiT2ZmIik7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoZXhwb3J0VmFsdWVzLmluY2x1ZGVzKHllcykpIHsKICAgICAgZXhwb3J0VmFsdWVzLmxlbmd0aCA9IDA7CiAgICAgIGV4cG9ydFZhbHVlcy5wdXNoKCJPZmYiLCB5ZXMpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3Qgb3RoZXJZZXMgPSBleHBvcnRWYWx1ZXMuZmluZCh2ID0+IHYgIT09ICJPZmYiKTsKICAgICAgZXhwb3J0VmFsdWVzLmxlbmd0aCA9IDA7CiAgICAgIGV4cG9ydFZhbHVlcy5wdXNoKCJPZmYiLCBvdGhlclllcyk7CiAgICB9CgogICAgaWYgKCFleHBvcnRWYWx1ZXMuaW5jbHVkZXModGhpcy5kYXRhLmZpZWxkVmFsdWUpKSB7CiAgICAgIHRoaXMuZGF0YS5maWVsZFZhbHVlID0gIk9mZiI7CiAgICB9CgogICAgdGhpcy5kYXRhLmV4cG9ydFZhbHVlID0gZXhwb3J0VmFsdWVzWzFdOwogICAgdGhpcy5jaGVja2VkQXBwZWFyYW5jZSA9IG5vcm1hbEFwcGVhcmFuY2UuZ2V0KHRoaXMuZGF0YS5leHBvcnRWYWx1ZSkgfHwgbnVsbDsKICAgIHRoaXMudW5jaGVja2VkQXBwZWFyYW5jZSA9IG5vcm1hbEFwcGVhcmFuY2UuZ2V0KCJPZmYiKSB8fCBudWxsOwoKICAgIGlmICh0aGlzLmNoZWNrZWRBcHBlYXJhbmNlKSB7CiAgICAgIHRoaXMuX3N0cmVhbXMucHVzaCh0aGlzLmNoZWNrZWRBcHBlYXJhbmNlKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuX2dldERlZmF1bHRDaGVja2VkQXBwZWFyYW5jZShwYXJhbXMsICJjaGVjayIpOwogICAgfQoKICAgIGlmICh0aGlzLnVuY2hlY2tlZEFwcGVhcmFuY2UpIHsKICAgICAgdGhpcy5fc3RyZWFtcy5wdXNoKHRoaXMudW5jaGVja2VkQXBwZWFyYW5jZSk7CiAgICB9CgogICAgdGhpcy5fZmFsbGJhY2tGb250RGljdCA9IHRoaXMuZmFsbGJhY2tGb250RGljdDsKICB9CgogIF9wcm9jZXNzUmFkaW9CdXR0b24ocGFyYW1zKSB7CiAgICB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9IHRoaXMuZGF0YS5idXR0b25WYWx1ZSA9IG51bGw7CiAgICBjb25zdCBmaWVsZFBhcmVudCA9IHBhcmFtcy5kaWN0LmdldCgiUGFyZW50Iik7CgogICAgaWYgKGZpZWxkUGFyZW50IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICB0aGlzLnBhcmVudCA9IHBhcmFtcy5kaWN0LmdldFJhdygiUGFyZW50Iik7CiAgICAgIGNvbnN0IGZpZWxkUGFyZW50VmFsdWUgPSBmaWVsZFBhcmVudC5nZXQoIlYiKTsKCiAgICAgIGlmIChmaWVsZFBhcmVudFZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgIHRoaXMuZGF0YS5maWVsZFZhbHVlID0gdGhpcy5fZGVjb2RlRm9ybVZhbHVlKGZpZWxkUGFyZW50VmFsdWUpOwogICAgICB9CiAgICB9CgogICAgY29uc3QgYXBwZWFyYW5jZVN0YXRlcyA9IHBhcmFtcy5kaWN0LmdldCgiQVAiKTsKCiAgICBpZiAoIShhcHBlYXJhbmNlU3RhdGVzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG5vcm1hbEFwcGVhcmFuY2UgPSBhcHBlYXJhbmNlU3RhdGVzLmdldCgiTiIpOwoKICAgIGlmICghKG5vcm1hbEFwcGVhcmFuY2UgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgZm9yIChjb25zdCBrZXkgb2Ygbm9ybWFsQXBwZWFyYW5jZS5nZXRLZXlzKCkpIHsKICAgICAgaWYgKGtleSAhPT0gIk9mZiIpIHsKICAgICAgICB0aGlzLmRhdGEuYnV0dG9uVmFsdWUgPSB0aGlzLl9kZWNvZGVGb3JtVmFsdWUoa2V5KTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHRoaXMuY2hlY2tlZEFwcGVhcmFuY2UgPSBub3JtYWxBcHBlYXJhbmNlLmdldCh0aGlzLmRhdGEuYnV0dG9uVmFsdWUpIHx8IG51bGw7CiAgICB0aGlzLnVuY2hlY2tlZEFwcGVhcmFuY2UgPSBub3JtYWxBcHBlYXJhbmNlLmdldCgiT2ZmIikgfHwgbnVsbDsKCiAgICBpZiAodGhpcy5jaGVja2VkQXBwZWFyYW5jZSkgewogICAgICB0aGlzLl9zdHJlYW1zLnB1c2godGhpcy5jaGVja2VkQXBwZWFyYW5jZSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLl9nZXREZWZhdWx0Q2hlY2tlZEFwcGVhcmFuY2UocGFyYW1zLCAiZGlzYyIpOwogICAgfQoKICAgIGlmICh0aGlzLnVuY2hlY2tlZEFwcGVhcmFuY2UpIHsKICAgICAgdGhpcy5fc3RyZWFtcy5wdXNoKHRoaXMudW5jaGVja2VkQXBwZWFyYW5jZSk7CiAgICB9CgogICAgdGhpcy5fZmFsbGJhY2tGb250RGljdCA9IHRoaXMuZmFsbGJhY2tGb250RGljdDsKICB9CgogIF9wcm9jZXNzUHVzaEJ1dHRvbihwYXJhbXMpIHsKICAgIGlmICghcGFyYW1zLmRpY3QuaGFzKCJBIikgJiYgIXBhcmFtcy5kaWN0LmhhcygiQUEiKSAmJiAhdGhpcy5kYXRhLmFsdGVybmF0aXZlVGV4dCkgewogICAgICAoMCwgX3V0aWwud2FybikoIlB1c2ggYnV0dG9ucyB3aXRob3V0IGFjdGlvbiBkaWN0aW9uYXJpZXMgYXJlIG5vdCBzdXBwb3J0ZWQiKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuZGF0YS5pc1Rvb2x0aXBPbmx5ID0gIXBhcmFtcy5kaWN0LmhhcygiQSIpICYmICFwYXJhbXMuZGljdC5oYXMoIkFBIik7CgogICAgX2NhdGFsb2cuQ2F0YWxvZy5wYXJzZURlc3REaWN0aW9uYXJ5KHsKICAgICAgZGVzdERpY3Q6IHBhcmFtcy5kaWN0LAogICAgICByZXN1bHRPYmo6IHRoaXMuZGF0YSwKICAgICAgZG9jQmFzZVVybDogcGFyYW1zLnBkZk1hbmFnZXIuZG9jQmFzZVVybAogICAgfSk7CiAgfQoKICBnZXRGaWVsZE9iamVjdCgpIHsKICAgIGxldCB0eXBlID0gImJ1dHRvbiI7CiAgICBsZXQgZXhwb3J0VmFsdWVzOwoKICAgIGlmICh0aGlzLmRhdGEuY2hlY2tCb3gpIHsKICAgICAgdHlwZSA9ICJjaGVja2JveCI7CiAgICAgIGV4cG9ydFZhbHVlcyA9IHRoaXMuZGF0YS5leHBvcnRWYWx1ZTsKICAgIH0gZWxzZSBpZiAodGhpcy5kYXRhLnJhZGlvQnV0dG9uKSB7CiAgICAgIHR5cGUgPSAicmFkaW9idXR0b24iOwogICAgICBleHBvcnRWYWx1ZXMgPSB0aGlzLmRhdGEuYnV0dG9uVmFsdWU7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgaWQ6IHRoaXMuZGF0YS5pZCwKICAgICAgdmFsdWU6IHRoaXMuZGF0YS5maWVsZFZhbHVlIHx8ICJPZmYiLAogICAgICBkZWZhdWx0VmFsdWU6IHRoaXMuZGF0YS5kZWZhdWx0RmllbGRWYWx1ZSwKICAgICAgZXhwb3J0VmFsdWVzLAogICAgICBlZGl0YWJsZTogIXRoaXMuZGF0YS5yZWFkT25seSwKICAgICAgbmFtZTogdGhpcy5kYXRhLmZpZWxkTmFtZSwKICAgICAgcmVjdDogdGhpcy5kYXRhLnJlY3QsCiAgICAgIGhpZGRlbjogdGhpcy5kYXRhLmhpZGRlbiwKICAgICAgYWN0aW9uczogdGhpcy5kYXRhLmFjdGlvbnMsCiAgICAgIHBhZ2U6IHRoaXMuZGF0YS5wYWdlSW5kZXgsCiAgICAgIHN0cm9rZUNvbG9yOiB0aGlzLmRhdGEuYm9yZGVyQ29sb3IsCiAgICAgIGZpbGxDb2xvcjogdGhpcy5kYXRhLmJhY2tncm91bmRDb2xvciwKICAgICAgcm90YXRpb246IHRoaXMucm90YXRpb24sCiAgICAgIHR5cGUKICAgIH07CiAgfQoKICBnZXQgZmFsbGJhY2tGb250RGljdCgpIHsKICAgIGNvbnN0IGRpY3QgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCgpOwogICAgZGljdC5zZXQoIkJhc2VGb250IiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIlphcGZEaW5nYmF0cyIpKTsKICAgIGRpY3Quc2V0KCJUeXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZhbGxiYWNrVHlwZSIpKTsKICAgIGRpY3Quc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZhbGxiYWNrVHlwZSIpKTsKICAgIGRpY3Quc2V0KCJFbmNvZGluZyIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJaYXBmRGluZ2JhdHNFbmNvZGluZyIpKTsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZmFsbGJhY2tGb250RGljdCIsIGRpY3QpOwogIH0KCn0KCmNsYXNzIENob2ljZVdpZGdldEFubm90YXRpb24gZXh0ZW5kcyBXaWRnZXRBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbXMpIHsKICAgIHN1cGVyKHBhcmFtcyk7CiAgICB0aGlzLmRhdGEub3B0aW9ucyA9IFtdOwogICAgY29uc3Qgb3B0aW9ucyA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3Q6IHBhcmFtcy5kaWN0LAogICAgICBrZXk6ICJPcHQiCiAgICB9KTsKCiAgICBpZiAoQXJyYXkuaXNBcnJheShvcHRpb25zKSkgewogICAgICBjb25zdCB4cmVmID0gcGFyYW1zLnhyZWY7CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBvcHRpb25zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBjb25zdCBvcHRpb24gPSB4cmVmLmZldGNoSWZSZWYob3B0aW9uc1tpXSk7CiAgICAgICAgY29uc3QgaXNPcHRpb25BcnJheSA9IEFycmF5LmlzQXJyYXkob3B0aW9uKTsKICAgICAgICB0aGlzLmRhdGEub3B0aW9uc1tpXSA9IHsKICAgICAgICAgIGV4cG9ydFZhbHVlOiB0aGlzLl9kZWNvZGVGb3JtVmFsdWUoaXNPcHRpb25BcnJheSA/IHhyZWYuZmV0Y2hJZlJlZihvcHRpb25bMF0pIDogb3B0aW9uKSwKICAgICAgICAgIGRpc3BsYXlWYWx1ZTogdGhpcy5fZGVjb2RlRm9ybVZhbHVlKGlzT3B0aW9uQXJyYXkgPyB4cmVmLmZldGNoSWZSZWYob3B0aW9uWzFdKSA6IG9wdGlvbikKICAgICAgICB9OwogICAgICB9CiAgICB9CgogICAgaWYgKHR5cGVvZiB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9PT0gInN0cmluZyIpIHsKICAgICAgdGhpcy5kYXRhLmZpZWxkVmFsdWUgPSBbdGhpcy5kYXRhLmZpZWxkVmFsdWVdOwogICAgfSBlbHNlIGlmICghdGhpcy5kYXRhLmZpZWxkVmFsdWUpIHsKICAgICAgdGhpcy5kYXRhLmZpZWxkVmFsdWUgPSBbXTsKICAgIH0KCiAgICB0aGlzLmRhdGEuY29tYm8gPSB0aGlzLmhhc0ZpZWxkRmxhZyhfdXRpbC5Bbm5vdGF0aW9uRmllbGRGbGFnLkNPTUJPKTsKICAgIHRoaXMuZGF0YS5tdWx0aVNlbGVjdCA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuTVVMVElTRUxFQ1QpOwogICAgdGhpcy5faGFzVGV4dCA9IHRydWU7CiAgfQoKICBnZXRGaWVsZE9iamVjdCgpIHsKICAgIGNvbnN0IHR5cGUgPSB0aGlzLmRhdGEuY29tYm8gPyAiY29tYm9ib3giIDogImxpc3Rib3giOwogICAgY29uc3QgdmFsdWUgPSB0aGlzLmRhdGEuZmllbGRWYWx1ZS5sZW5ndGggPiAwID8gdGhpcy5kYXRhLmZpZWxkVmFsdWVbMF0gOiBudWxsOwogICAgcmV0dXJuIHsKICAgICAgaWQ6IHRoaXMuZGF0YS5pZCwKICAgICAgdmFsdWUsCiAgICAgIGRlZmF1bHRWYWx1ZTogdGhpcy5kYXRhLmRlZmF1bHRGaWVsZFZhbHVlLAogICAgICBlZGl0YWJsZTogIXRoaXMuZGF0YS5yZWFkT25seSwKICAgICAgbmFtZTogdGhpcy5kYXRhLmZpZWxkTmFtZSwKICAgICAgcmVjdDogdGhpcy5kYXRhLnJlY3QsCiAgICAgIG51bUl0ZW1zOiB0aGlzLmRhdGEuZmllbGRWYWx1ZS5sZW5ndGgsCiAgICAgIG11bHRpcGxlU2VsZWN0aW9uOiB0aGlzLmRhdGEubXVsdGlTZWxlY3QsCiAgICAgIGhpZGRlbjogdGhpcy5kYXRhLmhpZGRlbiwKICAgICAgYWN0aW9uczogdGhpcy5kYXRhLmFjdGlvbnMsCiAgICAgIGl0ZW1zOiB0aGlzLmRhdGEub3B0aW9ucywKICAgICAgcGFnZTogdGhpcy5kYXRhLnBhZ2VJbmRleCwKICAgICAgc3Ryb2tlQ29sb3I6IHRoaXMuZGF0YS5ib3JkZXJDb2xvciwKICAgICAgZmlsbENvbG9yOiB0aGlzLmRhdGEuYmFja2dyb3VuZENvbG9yLAogICAgICByb3RhdGlvbjogdGhpcy5yb3RhdGlvbiwKICAgICAgdHlwZQogICAgfTsKICB9CgogIGFzeW5jIF9nZXRBcHBlYXJhbmNlKGV2YWx1YXRvciwgdGFzaywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGlmICh0aGlzLmRhdGEuY29tYm8pIHsKICAgICAgcmV0dXJuIHN1cGVyLl9nZXRBcHBlYXJhbmNlKGV2YWx1YXRvciwgdGFzaywgYW5ub3RhdGlvblN0b3JhZ2UpOwogICAgfQoKICAgIGlmICghYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3Qgc3RvcmFnZUVudHJ5ID0gYW5ub3RhdGlvblN0b3JhZ2UuZ2V0KHRoaXMuZGF0YS5pZCk7CgogICAgaWYgKCFzdG9yYWdlRW50cnkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3Qgcm90YXRpb24gPSBzdG9yYWdlRW50cnkucm90YXRpb247CiAgICBsZXQgZXhwb3J0ZWRWYWx1ZSA9IHN0b3JhZ2VFbnRyeS52YWx1ZTsKCiAgICBpZiAocm90YXRpb24gPT09IHVuZGVmaW5lZCAmJiBleHBvcnRlZFZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgaWYgKGV4cG9ydGVkVmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICBleHBvcnRlZFZhbHVlID0gdGhpcy5kYXRhLmZpZWxkVmFsdWU7CiAgICB9IGVsc2UgaWYgKCFBcnJheS5pc0FycmF5KGV4cG9ydGVkVmFsdWUpKSB7CiAgICAgIGV4cG9ydGVkVmFsdWUgPSBbZXhwb3J0ZWRWYWx1ZV07CiAgICB9CgogICAgY29uc3QgZGVmYXVsdFBhZGRpbmcgPSAyOwogICAgY29uc3QgaFBhZGRpbmcgPSBkZWZhdWx0UGFkZGluZzsKICAgIGxldCB0b3RhbEhlaWdodCA9IHRoaXMuZGF0YS5yZWN0WzNdIC0gdGhpcy5kYXRhLnJlY3RbMV07CiAgICBsZXQgdG90YWxXaWR0aCA9IHRoaXMuZGF0YS5yZWN0WzJdIC0gdGhpcy5kYXRhLnJlY3RbMF07CgogICAgaWYgKHJvdGF0aW9uID09PSA5MCB8fCByb3RhdGlvbiA9PT0gMjcwKSB7CiAgICAgIFt0b3RhbFdpZHRoLCB0b3RhbEhlaWdodF0gPSBbdG90YWxIZWlnaHQsIHRvdGFsV2lkdGhdOwogICAgfQoKICAgIGNvbnN0IGxpbmVDb3VudCA9IHRoaXMuZGF0YS5vcHRpb25zLmxlbmd0aDsKICAgIGNvbnN0IHZhbHVlSW5kaWNlcyA9IFtdOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZUNvdW50OyBpKyspIHsKICAgICAgY29uc3QgewogICAgICAgIGV4cG9ydFZhbHVlCiAgICAgIH0gPSB0aGlzLmRhdGEub3B0aW9uc1tpXTsKCiAgICAgIGlmIChleHBvcnRlZFZhbHVlLmluY2x1ZGVzKGV4cG9ydFZhbHVlKSkgewogICAgICAgIHZhbHVlSW5kaWNlcy5wdXNoKGkpOwogICAgICB9CiAgICB9CgogICAgaWYgKCF0aGlzLl9kZWZhdWx0QXBwZWFyYW5jZSkgewogICAgICB0aGlzLmRhdGEuZGVmYXVsdEFwcGVhcmFuY2VEYXRhID0gKDAsIF9kZWZhdWx0X2FwcGVhcmFuY2UucGFyc2VEZWZhdWx0QXBwZWFyYW5jZSkodGhpcy5fZGVmYXVsdEFwcGVhcmFuY2UgPSAiL0hlbHZldGljYSAwIFRmIDAgZyIpOwogICAgfQoKICAgIGNvbnN0IGZvbnQgPSBhd2FpdCBXaWRnZXRBbm5vdGF0aW9uLl9nZXRGb250RGF0YShldmFsdWF0b3IsIHRhc2ssIHRoaXMuZGF0YS5kZWZhdWx0QXBwZWFyYW5jZURhdGEsIHRoaXMuX2ZpZWxkUmVzb3VyY2VzLm1lcmdlZFJlc291cmNlcyk7CiAgICBsZXQgZGVmYXVsdEFwcGVhcmFuY2U7CiAgICBsZXQgewogICAgICBmb250U2l6ZQogICAgfSA9IHRoaXMuZGF0YS5kZWZhdWx0QXBwZWFyYW5jZURhdGE7CgogICAgaWYgKCFmb250U2l6ZSkgewogICAgICBjb25zdCBsaW5lSGVpZ2h0ID0gKHRvdGFsSGVpZ2h0IC0gZGVmYXVsdFBhZGRpbmcpIC8gbGluZUNvdW50OwogICAgICBsZXQgbGluZVdpZHRoID0gLTE7CiAgICAgIGxldCB2YWx1ZTsKCiAgICAgIGZvciAoY29uc3QgewogICAgICAgIGRpc3BsYXlWYWx1ZQogICAgICB9IG9mIHRoaXMuZGF0YS5vcHRpb25zKSB7CiAgICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLl9nZXRUZXh0V2lkdGgoZGlzcGxheVZhbHVlLCBmb250KTsKCiAgICAgICAgaWYgKHdpZHRoID4gbGluZVdpZHRoKSB7CiAgICAgICAgICBsaW5lV2lkdGggPSB3aWR0aDsKICAgICAgICAgIHZhbHVlID0gZGlzcGxheVZhbHVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgW2RlZmF1bHRBcHBlYXJhbmNlLCBmb250U2l6ZV0gPSB0aGlzLl9jb21wdXRlRm9udFNpemUobGluZUhlaWdodCwgdG90YWxXaWR0aCAtIDIgKiBoUGFkZGluZywgdmFsdWUsIGZvbnQsIC0xKTsKICAgIH0gZWxzZSB7CiAgICAgIGRlZmF1bHRBcHBlYXJhbmNlID0gdGhpcy5fZGVmYXVsdEFwcGVhcmFuY2U7CiAgICB9CgogICAgY29uc3QgbGluZUhlaWdodCA9IGZvbnRTaXplICogX3V0aWwuTElORV9GQUNUT1I7CiAgICBjb25zdCB2UGFkZGluZyA9IChsaW5lSGVpZ2h0IC0gZm9udFNpemUpIC8gMjsKICAgIGNvbnN0IG51bWJlck9mVmlzaWJsZUxpbmVzID0gTWF0aC5mbG9vcih0b3RhbEhlaWdodCAvIGxpbmVIZWlnaHQpOwogICAgbGV0IGZpcnN0SW5kZXg7CgogICAgaWYgKHZhbHVlSW5kaWNlcy5sZW5ndGggPT09IDEpIHsKICAgICAgY29uc3QgdmFsdWVQb3NpdGlvbiA9IHZhbHVlSW5kaWNlc1swXTsKICAgICAgY29uc3QgaW5kZXhJblBhZ2UgPSB2YWx1ZVBvc2l0aW9uICUgbnVtYmVyT2ZWaXNpYmxlTGluZXM7CiAgICAgIGZpcnN0SW5kZXggPSB2YWx1ZVBvc2l0aW9uIC0gaW5kZXhJblBhZ2U7CiAgICB9IGVsc2UgewogICAgICBmaXJzdEluZGV4ID0gdmFsdWVJbmRpY2VzLmxlbmd0aCA/IHZhbHVlSW5kaWNlc1swXSA6IDA7CiAgICB9CgogICAgY29uc3QgZW5kID0gTWF0aC5taW4oZmlyc3RJbmRleCArIG51bWJlck9mVmlzaWJsZUxpbmVzICsgMSwgbGluZUNvdW50KTsKICAgIGNvbnN0IGJ1ZiA9IFsiL1R4IEJNQyBxIiwgYDEgMSAke3RvdGFsV2lkdGh9ICR7dG90YWxIZWlnaHR9IHJlIFcgbmBdOwoKICAgIGlmICh2YWx1ZUluZGljZXMubGVuZ3RoKSB7CiAgICAgIGJ1Zi5wdXNoKCIwLjYwMDAwNiAwLjc1Njg2NiAwLjg1NDkwNCByZyIpOwoKICAgICAgZm9yIChjb25zdCBpbmRleCBvZiB2YWx1ZUluZGljZXMpIHsKICAgICAgICBpZiAoZmlyc3RJbmRleCA8PSBpbmRleCAmJiBpbmRleCA8IGVuZCkgewogICAgICAgICAgYnVmLnB1c2goYDEgJHt0b3RhbEhlaWdodCAtIChpbmRleCAtIGZpcnN0SW5kZXggKyAxKSAqIGxpbmVIZWlnaHR9ICR7dG90YWxXaWR0aH0gJHtsaW5lSGVpZ2h0fSByZSBmYCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgYnVmLnB1c2goIkJUIiwgZGVmYXVsdEFwcGVhcmFuY2UsIGAxIDAgMCAxIDAgJHt0b3RhbEhlaWdodH0gVG1gKTsKCiAgICBmb3IgKGxldCBpID0gZmlyc3RJbmRleDsgaSA8IGVuZDsgaSsrKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBkaXNwbGF5VmFsdWUKICAgICAgfSA9IHRoaXMuZGF0YS5vcHRpb25zW2ldOwogICAgICBjb25zdCBocGFkZGluZyA9IGkgPT09IGZpcnN0SW5kZXggPyBoUGFkZGluZyA6IDA7CiAgICAgIGNvbnN0IHZwYWRkaW5nID0gaSA9PT0gZmlyc3RJbmRleCA/IHZQYWRkaW5nIDogMDsKICAgICAgYnVmLnB1c2godGhpcy5fcmVuZGVyVGV4dChkaXNwbGF5VmFsdWUsIGZvbnQsIGZvbnRTaXplLCB0b3RhbFdpZHRoLCAwLCBocGFkZGluZywgLWxpbmVIZWlnaHQgKyB2cGFkZGluZykpOwogICAgfQoKICAgIGJ1Zi5wdXNoKCJFVCBRIEVNQyIpOwogICAgcmV0dXJuIGJ1Zi5qb2luKCJcbiIpOwogIH0KCn0KCmNsYXNzIFNpZ25hdHVyZVdpZGdldEFubm90YXRpb24gZXh0ZW5kcyBXaWRnZXRBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbXMpIHsKICAgIHN1cGVyKHBhcmFtcyk7CiAgICB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9IG51bGw7CiAgfQoKICBnZXRGaWVsZE9iamVjdCgpIHsKICAgIHJldHVybiB7CiAgICAgIGlkOiB0aGlzLmRhdGEuaWQsCiAgICAgIHZhbHVlOiBudWxsLAogICAgICBwYWdlOiB0aGlzLmRhdGEucGFnZUluZGV4LAogICAgICB0eXBlOiAic2lnbmF0dXJlIgogICAgfTsKICB9Cgp9CgpjbGFzcyBUZXh0QW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IERFRkFVTFRfSUNPTl9TSVpFID0gMjI7CiAgICBzdXBlcihwYXJhbWV0ZXJzKTsKICAgIGNvbnN0IGRpY3QgPSBwYXJhbWV0ZXJzLmRpY3Q7CiAgICB0aGlzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5URVhUOwoKICAgIGlmICh0aGlzLmRhdGEuaGFzQXBwZWFyYW5jZSkgewogICAgICB0aGlzLmRhdGEubmFtZSA9ICJOb0ljb24iOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5kYXRhLnJlY3RbMV0gPSB0aGlzLmRhdGEucmVjdFszXSAtIERFRkFVTFRfSUNPTl9TSVpFOwogICAgICB0aGlzLmRhdGEucmVjdFsyXSA9IHRoaXMuZGF0YS5yZWN0WzBdICsgREVGQVVMVF9JQ09OX1NJWkU7CiAgICAgIHRoaXMuZGF0YS5uYW1lID0gZGljdC5oYXMoIk5hbWUiKSA/IGRpY3QuZ2V0KCJOYW1lIikubmFtZSA6ICJOb3RlIjsKICAgIH0KCiAgICBpZiAoZGljdC5oYXMoIlN0YXRlIikpIHsKICAgICAgdGhpcy5kYXRhLnN0YXRlID0gZGljdC5nZXQoIlN0YXRlIikgfHwgbnVsbDsKICAgICAgdGhpcy5kYXRhLnN0YXRlTW9kZWwgPSBkaWN0LmdldCgiU3RhdGVNb2RlbCIpIHx8IG51bGw7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRhdGEuc3RhdGUgPSBudWxsOwogICAgICB0aGlzLmRhdGEuc3RhdGVNb2RlbCA9IG51bGw7CiAgICB9CiAgfQoKfQoKY2xhc3MgTGlua0Fubm90YXRpb24gZXh0ZW5kcyBBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbXMpIHsKICAgIHN1cGVyKHBhcmFtcyk7CiAgICB0aGlzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5MSU5LOwogICAgY29uc3QgcXVhZFBvaW50cyA9IGdldFF1YWRQb2ludHMocGFyYW1zLmRpY3QsIHRoaXMucmVjdGFuZ2xlKTsKCiAgICBpZiAocXVhZFBvaW50cykgewogICAgICB0aGlzLmRhdGEucXVhZFBvaW50cyA9IHF1YWRQb2ludHM7CiAgICB9CgogICAgdGhpcy5kYXRhLmJvcmRlckNvbG9yID0gdGhpcy5kYXRhLmJvcmRlckNvbG9yIHx8IHRoaXMuZGF0YS5jb2xvcjsKCiAgICBfY2F0YWxvZy5DYXRhbG9nLnBhcnNlRGVzdERpY3Rpb25hcnkoewogICAgICBkZXN0RGljdDogcGFyYW1zLmRpY3QsCiAgICAgIHJlc3VsdE9iajogdGhpcy5kYXRhLAogICAgICBkb2NCYXNlVXJsOiBwYXJhbXMucGRmTWFuYWdlci5kb2NCYXNlVXJsCiAgICB9KTsKICB9Cgp9CgpjbGFzcyBQb3B1cEFubm90YXRpb24gZXh0ZW5kcyBBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcihwYXJhbWV0ZXJzKTsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlBPUFVQOwogICAgbGV0IHBhcmVudEl0ZW0gPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0KCJQYXJlbnQiKTsKCiAgICBpZiAoIXBhcmVudEl0ZW0pIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJQb3B1cCBhbm5vdGF0aW9uIGhhcyBhIG1pc3Npbmcgb3IgaW52YWxpZCBwYXJlbnQgYW5ub3RhdGlvbi4iKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHBhcmVudFN1YnR5cGUgPSBwYXJlbnRJdGVtLmdldCgiU3VidHlwZSIpOwogICAgdGhpcy5kYXRhLnBhcmVudFR5cGUgPSBwYXJlbnRTdWJ0eXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IHBhcmVudFN1YnR5cGUubmFtZSA6IG51bGw7CiAgICBjb25zdCByYXdQYXJlbnQgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0UmF3KCJQYXJlbnQiKTsKICAgIHRoaXMuZGF0YS5wYXJlbnRJZCA9IHJhd1BhcmVudCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZiA/IHJhd1BhcmVudC50b1N0cmluZygpIDogbnVsbDsKICAgIGNvbnN0IHBhcmVudFJlY3QgPSBwYXJlbnRJdGVtLmdldEFycmF5KCJSZWN0Iik7CgogICAgaWYgKEFycmF5LmlzQXJyYXkocGFyZW50UmVjdCkgJiYgcGFyZW50UmVjdC5sZW5ndGggPT09IDQpIHsKICAgICAgdGhpcy5kYXRhLnBhcmVudFJlY3QgPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3QocGFyZW50UmVjdCk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRhdGEucGFyZW50UmVjdCA9IFswLCAwLCAwLCAwXTsKICAgIH0KCiAgICBjb25zdCBydCA9IHBhcmVudEl0ZW0uZ2V0KCJSVCIpOwoKICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShydCwgX3V0aWwuQW5ub3RhdGlvblJlcGx5VHlwZS5HUk9VUCkpIHsKICAgICAgcGFyZW50SXRlbSA9IHBhcmVudEl0ZW0uZ2V0KCJJUlQiKTsKICAgIH0KCiAgICBpZiAoIXBhcmVudEl0ZW0uaGFzKCJNIikpIHsKICAgICAgdGhpcy5kYXRhLm1vZGlmaWNhdGlvbkRhdGUgPSBudWxsOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zZXRNb2RpZmljYXRpb25EYXRlKHBhcmVudEl0ZW0uZ2V0KCJNIikpOwogICAgICB0aGlzLmRhdGEubW9kaWZpY2F0aW9uRGF0ZSA9IHRoaXMubW9kaWZpY2F0aW9uRGF0ZTsKICAgIH0KCiAgICBpZiAoIXBhcmVudEl0ZW0uaGFzKCJDIikpIHsKICAgICAgdGhpcy5kYXRhLmNvbG9yID0gbnVsbDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuc2V0Q29sb3IocGFyZW50SXRlbS5nZXRBcnJheSgiQyIpKTsKICAgICAgdGhpcy5kYXRhLmNvbG9yID0gdGhpcy5jb2xvcjsKICAgIH0KCiAgICBpZiAoIXRoaXMudmlld2FibGUpIHsKICAgICAgY29uc3QgcGFyZW50RmxhZ3MgPSBwYXJlbnRJdGVtLmdldCgiRiIpOwoKICAgICAgaWYgKHRoaXMuX2lzVmlld2FibGUocGFyZW50RmxhZ3MpKSB7CiAgICAgICAgdGhpcy5zZXRGbGFncyhwYXJlbnRGbGFncyk7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLnNldFRpdGxlKHBhcmVudEl0ZW0uZ2V0KCJUIikpOwogICAgdGhpcy5kYXRhLnRpdGxlT2JqID0gdGhpcy5fdGl0bGU7CiAgICB0aGlzLnNldENvbnRlbnRzKHBhcmVudEl0ZW0uZ2V0KCJDb250ZW50cyIpKTsKICAgIHRoaXMuZGF0YS5jb250ZW50c09iaiA9IHRoaXMuX2NvbnRlbnRzOwoKICAgIGlmIChwYXJlbnRJdGVtLmhhcygiUkMiKSkgewogICAgICB0aGlzLmRhdGEucmljaFRleHQgPSBfZmFjdG9yeS5YRkFGYWN0b3J5LmdldFJpY2hUZXh0QXNIdG1sKHBhcmVudEl0ZW0uZ2V0KCJSQyIpKTsKICAgIH0KICB9Cgp9CgpleHBvcnRzLlBvcHVwQW5ub3RhdGlvbiA9IFBvcHVwQW5ub3RhdGlvbjsKCmNsYXNzIEZyZWVUZXh0QW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuRlJFRVRFWFQ7CiAgfQoKICBnZXQgaGFzVGV4dENvbnRlbnQoKSB7CiAgICByZXR1cm4gISF0aGlzLmFwcGVhcmFuY2U7CiAgfQoKICBzdGF0aWMgY3JlYXRlTmV3RGljdChhbm5vdGF0aW9uLCB4cmVmLCBfcmVmNCkgewogICAgbGV0IHsKICAgICAgYXBSZWYsCiAgICAgIGFwCiAgICB9ID0gX3JlZjQ7CiAgICBjb25zdCB7CiAgICAgIGNvbG9yLAogICAgICBmb250U2l6ZSwKICAgICAgcmVjdCwKICAgICAgcm90YXRpb24sCiAgICAgIHVzZXIsCiAgICAgIHZhbHVlCiAgICB9ID0gYW5ub3RhdGlvbjsKICAgIGNvbnN0IGZyZWV0ZXh0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICBmcmVldGV4dC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiQW5ub3QiKSk7CiAgICBmcmVldGV4dC5zZXQoIlN1YnR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRnJlZVRleHQiKSk7CiAgICBmcmVldGV4dC5zZXQoIkNyZWF0aW9uRGF0ZSIsIGBEOiR7KDAsIF91dGlsLmdldE1vZGlmaWNhdGlvbkRhdGUpKCl9YCk7CiAgICBmcmVldGV4dC5zZXQoIlJlY3QiLCByZWN0KTsKICAgIGNvbnN0IGRhID0gYC9IZWx2ICR7Zm9udFNpemV9IFRmICR7KDAsIF9kZWZhdWx0X2FwcGVhcmFuY2UuZ2V0UGRmQ29sb3IpKGNvbG9yLCB0cnVlKX1gOwogICAgZnJlZXRleHQuc2V0KCJEQSIsIGRhKTsKICAgIGZyZWV0ZXh0LnNldCgiQ29udGVudHMiLCB2YWx1ZSk7CiAgICBmcmVldGV4dC5zZXQoIkYiLCA0KTsKICAgIGZyZWV0ZXh0LnNldCgiQm9yZGVyIiwgWzAsIDAsIDBdKTsKICAgIGZyZWV0ZXh0LnNldCgiUm90YXRlIiwgcm90YXRpb24pOwoKICAgIGlmICh1c2VyKSB7CiAgICAgIGZyZWV0ZXh0LnNldCgiVCIsICgwLCBfdXRpbC5zdHJpbmdUb1VURjhTdHJpbmcpKHVzZXIpKTsKICAgIH0KCiAgICBjb25zdCBuID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICBmcmVldGV4dC5zZXQoIkFQIiwgbik7CgogICAgaWYgKGFwUmVmKSB7CiAgICAgIG4uc2V0KCJOIiwgYXBSZWYpOwogICAgfSBlbHNlIHsKICAgICAgbi5zZXQoIk4iLCBhcCk7CiAgICB9CgogICAgcmV0dXJuIGZyZWV0ZXh0OwogIH0KCiAgc3RhdGljIGFzeW5jIGNyZWF0ZU5ld0FwcGVhcmFuY2VTdHJlYW0oYW5ub3RhdGlvbiwgeHJlZiwgcGFyYW1zKSB7CiAgICBjb25zdCB7CiAgICAgIGJhc2VGb250UmVmLAogICAgICBldmFsdWF0b3IsCiAgICAgIHRhc2sKICAgIH0gPSBwYXJhbXM7CiAgICBjb25zdCB7CiAgICAgIGNvbG9yLAogICAgICBmb250U2l6ZSwKICAgICAgcmVjdCwKICAgICAgcm90YXRpb24sCiAgICAgIHZhbHVlCiAgICB9ID0gYW5ub3RhdGlvbjsKICAgIGNvbnN0IHJlc291cmNlcyA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgY29uc3QgZm9udCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwoKICAgIGlmIChiYXNlRm9udFJlZikgewogICAgICBmb250LnNldCgiSGVsdiIsIGJhc2VGb250UmVmKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGJhc2VGb250ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICAgIGJhc2VGb250LnNldCgiQmFzZUZvbnQiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiSGVsdmV0aWNhIikpOwogICAgICBiYXNlRm9udC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRm9udCIpKTsKICAgICAgYmFzZUZvbnQuc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIlR5cGUxIikpOwogICAgICBiYXNlRm9udC5zZXQoIkVuY29kaW5nIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIldpbkFuc2lFbmNvZGluZyIpKTsKICAgICAgZm9udC5zZXQoIkhlbHYiLCBiYXNlRm9udCk7CiAgICB9CgogICAgcmVzb3VyY2VzLnNldCgiRm9udCIsIGZvbnQpOwogICAgY29uc3QgaGVsdiA9IGF3YWl0IFdpZGdldEFubm90YXRpb24uX2dldEZvbnREYXRhKGV2YWx1YXRvciwgdGFzaywgewogICAgICBmb250TmFtZTogIkhlbHZldGljYSIsCiAgICAgIGZvbnRTaXplCiAgICB9LCByZXNvdXJjZXMpOwogICAgY29uc3QgW3gxLCB5MSwgeDIsIHkyXSA9IHJlY3Q7CiAgICBsZXQgdyA9IHgyIC0geDE7CiAgICBsZXQgaCA9IHkyIC0geTE7CgogICAgaWYgKHJvdGF0aW9uICUgMTgwICE9PSAwKSB7CiAgICAgIFt3LCBoXSA9IFtoLCB3XTsKICAgIH0KCiAgICBjb25zdCBsaW5lcyA9IHZhbHVlLnNwbGl0KCJcbiIpOwogICAgY29uc3Qgc2NhbGUgPSBmb250U2l6ZSAvIDEwMDA7CiAgICBsZXQgdG90YWxXaWR0aCA9IC1JbmZpbml0eTsKICAgIGNvbnN0IGVuY29kZWRMaW5lcyA9IFtdOwoKICAgIGZvciAobGV0IGxpbmUgb2YgbGluZXMpIHsKICAgICAgbGluZSA9IGhlbHYuZW5jb2RlU3RyaW5nKGxpbmUpLmpvaW4oIiIpOwogICAgICBlbmNvZGVkTGluZXMucHVzaChsaW5lKTsKICAgICAgbGV0IGxpbmVXaWR0aCA9IDA7CiAgICAgIGNvbnN0IGdseXBocyA9IGhlbHYuY2hhcnNUb0dseXBocyhsaW5lKTsKCiAgICAgIGZvciAoY29uc3QgZ2x5cGggb2YgZ2x5cGhzKSB7CiAgICAgICAgbGluZVdpZHRoICs9IGdseXBoLndpZHRoICogc2NhbGU7CiAgICAgIH0KCiAgICAgIHRvdGFsV2lkdGggPSBNYXRoLm1heCh0b3RhbFdpZHRoLCBsaW5lV2lkdGgpOwogICAgfQoKICAgIGxldCBoc2NhbGUgPSAxOwoKICAgIGlmICh0b3RhbFdpZHRoID4gdykgewogICAgICBoc2NhbGUgPSB3IC8gdG90YWxXaWR0aDsKICAgIH0KCiAgICBsZXQgdnNjYWxlID0gMTsKICAgIGNvbnN0IGxpbmVIZWlnaHQgPSBfdXRpbC5MSU5FX0ZBQ1RPUiAqIGZvbnRTaXplOwogICAgY29uc3QgbGluZURlc2NlbnQgPSBfdXRpbC5MSU5FX0RFU0NFTlRfRkFDVE9SICogZm9udFNpemU7CiAgICBjb25zdCB0b3RhbEhlaWdodCA9IGxpbmVIZWlnaHQgKiBsaW5lcy5sZW5ndGg7CgogICAgaWYgKHRvdGFsSGVpZ2h0ID4gaCkgewogICAgICB2c2NhbGUgPSBoIC8gdG90YWxIZWlnaHQ7CiAgICB9CgogICAgY29uc3QgZnNjYWxlID0gTWF0aC5taW4oaHNjYWxlLCB2c2NhbGUpOwogICAgY29uc3QgbmV3Rm9udFNpemUgPSBmb250U2l6ZSAqIGZzY2FsZTsKICAgIGNvbnN0IGJ1ZmZlciA9IFsicSIsIGAwIDAgJHsoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKHcpfSAkeygwLCBfY29yZV91dGlscy5udW1iZXJUb1N0cmluZykoaCl9IHJlIFcgbmAsIGBCVGAsIGAxIDAgMCAxIDAgJHsoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKGggKyBsaW5lRGVzY2VudCl9IFRtIDAgVGMgJHsoMCwgX2RlZmF1bHRfYXBwZWFyYW5jZS5nZXRQZGZDb2xvcikoY29sb3IsIHRydWUpfWAsIGAvSGVsdiAkeygwLCBfY29yZV91dGlscy5udW1iZXJUb1N0cmluZykobmV3Rm9udFNpemUpfSBUZmBdOwogICAgY29uc3QgdlNoaWZ0ID0gKDAsIF9jb3JlX3V0aWxzLm51bWJlclRvU3RyaW5nKShsaW5lSGVpZ2h0KTsKCiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgZW5jb2RlZExpbmVzKSB7CiAgICAgIGJ1ZmZlci5wdXNoKGAwIC0ke3ZTaGlmdH0gVGQgKCR7KDAsIF91dGlsLmVzY2FwZVN0cmluZykobGluZSl9KSBUamApOwogICAgfQoKICAgIGJ1ZmZlci5wdXNoKCJFVCIsICJRIik7CiAgICBjb25zdCBhcHBlYXJhbmNlID0gYnVmZmVyLmpvaW4oIlxuIik7CiAgICBjb25zdCBhcHBlYXJhbmNlU3RyZWFtRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJGb3JtVHlwZSIsIDEpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZvcm0iKSk7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiWE9iamVjdCIpKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiQkJveCIsIFswLCAwLCB3LCBoXSk7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIkxlbmd0aCIsIGFwcGVhcmFuY2UubGVuZ3RoKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiUmVzb3VyY2VzIiwgcmVzb3VyY2VzKTsKCiAgICBpZiAocm90YXRpb24pIHsKICAgICAgY29uc3QgbWF0cml4ID0gV2lkZ2V0QW5ub3RhdGlvbi5fZ2V0Um90YXRpb25NYXRyaXgocm90YXRpb24sIHcsIGgpOwoKICAgICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJNYXRyaXgiLCBtYXRyaXgpOwogICAgfQoKICAgIGNvbnN0IGFwID0gbmV3IF9zdHJlYW0uU3RyaW5nU3RyZWFtKGFwcGVhcmFuY2UpOwogICAgYXAuZGljdCA9IGFwcGVhcmFuY2VTdHJlYW1EaWN0OwogICAgcmV0dXJuIGFwOwogIH0KCn0KCmNsYXNzIExpbmVBbm5vdGF0aW9uIGV4dGVuZHMgTWFya3VwQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICBjb25zdCB7CiAgICAgIGRpY3QKICAgIH0gPSBwYXJhbWV0ZXJzOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuTElORTsKICAgIGNvbnN0IGxpbmVDb29yZGluYXRlcyA9IGRpY3QuZ2V0QXJyYXkoIkwiKTsKICAgIHRoaXMuZGF0YS5saW5lQ29vcmRpbmF0ZXMgPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3QobGluZUNvb3JkaW5hdGVzKTsKICAgIHRoaXMuc2V0TGluZUVuZGluZ3MoZGljdC5nZXRBcnJheSgiTEUiKSk7CiAgICB0aGlzLmRhdGEubGluZUVuZGluZ3MgPSB0aGlzLmxpbmVFbmRpbmdzOwoKICAgIGlmICghdGhpcy5hcHBlYXJhbmNlKSB7CiAgICAgIGNvbnN0IHN0cm9rZUNvbG9yID0gdGhpcy5jb2xvciA/IEFycmF5LmZyb20odGhpcy5jb2xvcikubWFwKGMgPT4gYyAvIDI1NSkgOiBbMCwgMCwgMF07CiAgICAgIGNvbnN0IHN0cm9rZUFscGhhID0gZGljdC5nZXQoIkNBIik7CiAgICAgIGxldCBmaWxsQ29sb3IgPSBudWxsLAogICAgICAgICAgaW50ZXJpb3JDb2xvciA9IGRpY3QuZ2V0QXJyYXkoIklDIik7CgogICAgICBpZiAoaW50ZXJpb3JDb2xvcikgewogICAgICAgIGludGVyaW9yQ29sb3IgPSBnZXRSZ2JDb2xvcihpbnRlcmlvckNvbG9yLCBudWxsKTsKICAgICAgICBmaWxsQ29sb3IgPSBpbnRlcmlvckNvbG9yID8gQXJyYXkuZnJvbShpbnRlcmlvckNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IGZpbGxBbHBoYSA9IGZpbGxDb2xvciA/IHN0cm9rZUFscGhhIDogbnVsbDsKICAgICAgY29uc3QgYm9yZGVyV2lkdGggPSB0aGlzLmJvcmRlclN0eWxlLndpZHRoIHx8IDEsCiAgICAgICAgICAgIGJvcmRlckFkanVzdCA9IDIgKiBib3JkZXJXaWR0aDsKICAgICAgY29uc3QgYmJveCA9IFt0aGlzLmRhdGEubGluZUNvb3JkaW5hdGVzWzBdIC0gYm9yZGVyQWRqdXN0LCB0aGlzLmRhdGEubGluZUNvb3JkaW5hdGVzWzFdIC0gYm9yZGVyQWRqdXN0LCB0aGlzLmRhdGEubGluZUNvb3JkaW5hdGVzWzJdICsgYm9yZGVyQWRqdXN0LCB0aGlzLmRhdGEubGluZUNvb3JkaW5hdGVzWzNdICsgYm9yZGVyQWRqdXN0XTsKCiAgICAgIGlmICghX3V0aWwuVXRpbC5pbnRlcnNlY3QodGhpcy5yZWN0YW5nbGUsIGJib3gpKSB7CiAgICAgICAgdGhpcy5yZWN0YW5nbGUgPSBiYm94OwogICAgICB9CgogICAgICB0aGlzLl9zZXREZWZhdWx0QXBwZWFyYW5jZSh7CiAgICAgICAgeHJlZjogcGFyYW1ldGVycy54cmVmLAogICAgICAgIGV4dHJhOiBgJHtib3JkZXJXaWR0aH0gd2AsCiAgICAgICAgc3Ryb2tlQ29sb3IsCiAgICAgICAgZmlsbENvbG9yLAogICAgICAgIHN0cm9rZUFscGhhLAogICAgICAgIGZpbGxBbHBoYSwKICAgICAgICBwb2ludHNDYWxsYmFjazogKGJ1ZmZlciwgcG9pbnRzKSA9PiB7CiAgICAgICAgICBidWZmZXIucHVzaChgJHtsaW5lQ29vcmRpbmF0ZXNbMF19ICR7bGluZUNvb3JkaW5hdGVzWzFdfSBtYCwgYCR7bGluZUNvb3JkaW5hdGVzWzJdfSAke2xpbmVDb29yZGluYXRlc1szXX0gbGAsICJTIik7CiAgICAgICAgICByZXR1cm4gW3BvaW50c1swXS54IC0gYm9yZGVyV2lkdGgsIHBvaW50c1sxXS54ICsgYm9yZGVyV2lkdGgsIHBvaW50c1szXS55IC0gYm9yZGVyV2lkdGgsIHBvaW50c1sxXS55ICsgYm9yZGVyV2lkdGhdOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQoKfQoKY2xhc3MgU3F1YXJlQW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuU1FVQVJFOwoKICAgIGlmICghdGhpcy5hcHBlYXJhbmNlKSB7CiAgICAgIGNvbnN0IHN0cm9rZUNvbG9yID0gdGhpcy5jb2xvciA/IEFycmF5LmZyb20odGhpcy5jb2xvcikubWFwKGMgPT4gYyAvIDI1NSkgOiBbMCwgMCwgMF07CiAgICAgIGNvbnN0IHN0cm9rZUFscGhhID0gcGFyYW1ldGVycy5kaWN0LmdldCgiQ0EiKTsKICAgICAgbGV0IGZpbGxDb2xvciA9IG51bGwsCiAgICAgICAgICBpbnRlcmlvckNvbG9yID0gcGFyYW1ldGVycy5kaWN0LmdldEFycmF5KCJJQyIpOwoKICAgICAgaWYgKGludGVyaW9yQ29sb3IpIHsKICAgICAgICBpbnRlcmlvckNvbG9yID0gZ2V0UmdiQ29sb3IoaW50ZXJpb3JDb2xvciwgbnVsbCk7CiAgICAgICAgZmlsbENvbG9yID0gaW50ZXJpb3JDb2xvciA/IEFycmF5LmZyb20oaW50ZXJpb3JDb2xvcikubWFwKGMgPT4gYyAvIDI1NSkgOiBudWxsOwogICAgICB9CgogICAgICBjb25zdCBmaWxsQWxwaGEgPSBmaWxsQ29sb3IgPyBzdHJva2VBbHBoYSA6IG51bGw7CgogICAgICBpZiAodGhpcy5ib3JkZXJTdHlsZS53aWR0aCA9PT0gMCAmJiAhZmlsbENvbG9yKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLl9zZXREZWZhdWx0QXBwZWFyYW5jZSh7CiAgICAgICAgeHJlZjogcGFyYW1ldGVycy54cmVmLAogICAgICAgIGV4dHJhOiBgJHt0aGlzLmJvcmRlclN0eWxlLndpZHRofSB3YCwKICAgICAgICBzdHJva2VDb2xvciwKICAgICAgICBmaWxsQ29sb3IsCiAgICAgICAgc3Ryb2tlQWxwaGEsCiAgICAgICAgZmlsbEFscGhhLAogICAgICAgIHBvaW50c0NhbGxiYWNrOiAoYnVmZmVyLCBwb2ludHMpID0+IHsKICAgICAgICAgIGNvbnN0IHggPSBwb2ludHNbMl0ueCArIHRoaXMuYm9yZGVyU3R5bGUud2lkdGggLyAyOwogICAgICAgICAgY29uc3QgeSA9IHBvaW50c1syXS55ICsgdGhpcy5ib3JkZXJTdHlsZS53aWR0aCAvIDI7CiAgICAgICAgICBjb25zdCB3aWR0aCA9IHBvaW50c1szXS54IC0gcG9pbnRzWzJdLnggLSB0aGlzLmJvcmRlclN0eWxlLndpZHRoOwogICAgICAgICAgY29uc3QgaGVpZ2h0ID0gcG9pbnRzWzFdLnkgLSBwb2ludHNbM10ueSAtIHRoaXMuYm9yZGVyU3R5bGUud2lkdGg7CiAgICAgICAgICBidWZmZXIucHVzaChgJHt4fSAke3l9ICR7d2lkdGh9ICR7aGVpZ2h0fSByZWApOwoKICAgICAgICAgIGlmIChmaWxsQ29sb3IpIHsKICAgICAgICAgICAgYnVmZmVyLnB1c2goIkIiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGJ1ZmZlci5wdXNoKCJTIik7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIFtwb2ludHNbMF0ueCwgcG9pbnRzWzFdLngsIHBvaW50c1szXS55LCBwb2ludHNbMV0ueV07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cgp9CgpjbGFzcyBDaXJjbGVBbm5vdGF0aW9uIGV4dGVuZHMgTWFya3VwQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICB0aGlzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5DSVJDTEU7CgogICAgaWYgKCF0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgY29uc3Qgc3Ryb2tlQ29sb3IgPSB0aGlzLmNvbG9yID8gQXJyYXkuZnJvbSh0aGlzLmNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IFswLCAwLCAwXTsKICAgICAgY29uc3Qgc3Ryb2tlQWxwaGEgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0KCJDQSIpOwogICAgICBsZXQgZmlsbENvbG9yID0gbnVsbDsKICAgICAgbGV0IGludGVyaW9yQ29sb3IgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0QXJyYXkoIklDIik7CgogICAgICBpZiAoaW50ZXJpb3JDb2xvcikgewogICAgICAgIGludGVyaW9yQ29sb3IgPSBnZXRSZ2JDb2xvcihpbnRlcmlvckNvbG9yLCBudWxsKTsKICAgICAgICBmaWxsQ29sb3IgPSBpbnRlcmlvckNvbG9yID8gQXJyYXkuZnJvbShpbnRlcmlvckNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IGZpbGxBbHBoYSA9IGZpbGxDb2xvciA/IHN0cm9rZUFscGhhIDogbnVsbDsKCiAgICAgIGlmICh0aGlzLmJvcmRlclN0eWxlLndpZHRoID09PSAwICYmICFmaWxsQ29sb3IpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGNvbnRyb2xQb2ludHNEaXN0YW5jZSA9IDQgLyAzICogTWF0aC50YW4oTWF0aC5QSSAvICgyICogNCkpOwoKICAgICAgdGhpcy5fc2V0RGVmYXVsdEFwcGVhcmFuY2UoewogICAgICAgIHhyZWY6IHBhcmFtZXRlcnMueHJlZiwKICAgICAgICBleHRyYTogYCR7dGhpcy5ib3JkZXJTdHlsZS53aWR0aH0gd2AsCiAgICAgICAgc3Ryb2tlQ29sb3IsCiAgICAgICAgZmlsbENvbG9yLAogICAgICAgIHN0cm9rZUFscGhhLAogICAgICAgIGZpbGxBbHBoYSwKICAgICAgICBwb2ludHNDYWxsYmFjazogKGJ1ZmZlciwgcG9pbnRzKSA9PiB7CiAgICAgICAgICBjb25zdCB4MCA9IHBvaW50c1swXS54ICsgdGhpcy5ib3JkZXJTdHlsZS53aWR0aCAvIDI7CiAgICAgICAgICBjb25zdCB5MCA9IHBvaW50c1swXS55IC0gdGhpcy5ib3JkZXJTdHlsZS53aWR0aCAvIDI7CiAgICAgICAgICBjb25zdCB4MSA9IHBvaW50c1szXS54IC0gdGhpcy5ib3JkZXJTdHlsZS53aWR0aCAvIDI7CiAgICAgICAgICBjb25zdCB5MSA9IHBvaW50c1szXS55ICsgdGhpcy5ib3JkZXJTdHlsZS53aWR0aCAvIDI7CiAgICAgICAgICBjb25zdCB4TWlkID0geDAgKyAoeDEgLSB4MCkgLyAyOwogICAgICAgICAgY29uc3QgeU1pZCA9IHkwICsgKHkxIC0geTApIC8gMjsKICAgICAgICAgIGNvbnN0IHhPZmZzZXQgPSAoeDEgLSB4MCkgLyAyICogY29udHJvbFBvaW50c0Rpc3RhbmNlOwogICAgICAgICAgY29uc3QgeU9mZnNldCA9ICh5MSAtIHkwKSAvIDIgKiBjb250cm9sUG9pbnRzRGlzdGFuY2U7CiAgICAgICAgICBidWZmZXIucHVzaChgJHt4TWlkfSAke3kxfSBtYCwgYCR7eE1pZCArIHhPZmZzZXR9ICR7eTF9ICR7eDF9ICR7eU1pZCArIHlPZmZzZXR9ICR7eDF9ICR7eU1pZH0gY2AsIGAke3gxfSAke3lNaWQgLSB5T2Zmc2V0fSAke3hNaWQgKyB4T2Zmc2V0fSAke3kwfSAke3hNaWR9ICR7eTB9IGNgLCBgJHt4TWlkIC0geE9mZnNldH0gJHt5MH0gJHt4MH0gJHt5TWlkIC0geU9mZnNldH0gJHt4MH0gJHt5TWlkfSBjYCwgYCR7eDB9ICR7eU1pZCArIHlPZmZzZXR9ICR7eE1pZCAtIHhPZmZzZXR9ICR7eTF9ICR7eE1pZH0gJHt5MX0gY2AsICJoIik7CgogICAgICAgICAgaWYgKGZpbGxDb2xvcikgewogICAgICAgICAgICBidWZmZXIucHVzaCgiQiIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYnVmZmVyLnB1c2goIlMiKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gW3BvaW50c1swXS54LCBwb2ludHNbMV0ueCwgcG9pbnRzWzNdLnksIHBvaW50c1sxXS55XTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KCn0KCmNsYXNzIFBvbHlsaW5lQW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgY29uc3QgewogICAgICBkaWN0CiAgICB9ID0gcGFyYW1ldGVyczsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlBPTFlMSU5FOwogICAgdGhpcy5kYXRhLnZlcnRpY2VzID0gW107CgogICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFBvbHlnb25Bbm5vdGF0aW9uKSkgewogICAgICB0aGlzLnNldExpbmVFbmRpbmdzKGRpY3QuZ2V0QXJyYXkoIkxFIikpOwogICAgICB0aGlzLmRhdGEubGluZUVuZGluZ3MgPSB0aGlzLmxpbmVFbmRpbmdzOwogICAgfQoKICAgIGNvbnN0IHJhd1ZlcnRpY2VzID0gZGljdC5nZXRBcnJheSgiVmVydGljZXMiKTsKCiAgICBpZiAoIUFycmF5LmlzQXJyYXkocmF3VmVydGljZXMpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSByYXdWZXJ0aWNlcy5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7CiAgICAgIHRoaXMuZGF0YS52ZXJ0aWNlcy5wdXNoKHsKICAgICAgICB4OiByYXdWZXJ0aWNlc1tpXSwKICAgICAgICB5OiByYXdWZXJ0aWNlc1tpICsgMV0KICAgICAgfSk7CiAgICB9CgogICAgaWYgKCF0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgY29uc3Qgc3Ryb2tlQ29sb3IgPSB0aGlzLmNvbG9yID8gQXJyYXkuZnJvbSh0aGlzLmNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IFswLCAwLCAwXTsKICAgICAgY29uc3Qgc3Ryb2tlQWxwaGEgPSBkaWN0LmdldCgiQ0EiKTsKICAgICAgY29uc3QgYm9yZGVyV2lkdGggPSB0aGlzLmJvcmRlclN0eWxlLndpZHRoIHx8IDEsCiAgICAgICAgICAgIGJvcmRlckFkanVzdCA9IDIgKiBib3JkZXJXaWR0aDsKICAgICAgY29uc3QgYmJveCA9IFtJbmZpbml0eSwgSW5maW5pdHksIC1JbmZpbml0eSwgLUluZmluaXR5XTsKCiAgICAgIGZvciAoY29uc3QgdmVydGV4IG9mIHRoaXMuZGF0YS52ZXJ0aWNlcykgewogICAgICAgIGJib3hbMF0gPSBNYXRoLm1pbihiYm94WzBdLCB2ZXJ0ZXgueCAtIGJvcmRlckFkanVzdCk7CiAgICAgICAgYmJveFsxXSA9IE1hdGgubWluKGJib3hbMV0sIHZlcnRleC55IC0gYm9yZGVyQWRqdXN0KTsKICAgICAgICBiYm94WzJdID0gTWF0aC5tYXgoYmJveFsyXSwgdmVydGV4LnggKyBib3JkZXJBZGp1c3QpOwogICAgICAgIGJib3hbM10gPSBNYXRoLm1heChiYm94WzNdLCB2ZXJ0ZXgueSArIGJvcmRlckFkanVzdCk7CiAgICAgIH0KCiAgICAgIGlmICghX3V0aWwuVXRpbC5pbnRlcnNlY3QodGhpcy5yZWN0YW5nbGUsIGJib3gpKSB7CiAgICAgICAgdGhpcy5yZWN0YW5nbGUgPSBiYm94OwogICAgICB9CgogICAgICB0aGlzLl9zZXREZWZhdWx0QXBwZWFyYW5jZSh7CiAgICAgICAgeHJlZjogcGFyYW1ldGVycy54cmVmLAogICAgICAgIGV4dHJhOiBgJHtib3JkZXJXaWR0aH0gd2AsCiAgICAgICAgc3Ryb2tlQ29sb3IsCiAgICAgICAgc3Ryb2tlQWxwaGEsCiAgICAgICAgcG9pbnRzQ2FsbGJhY2s6IChidWZmZXIsIHBvaW50cykgPT4gewogICAgICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLmRhdGEudmVydGljZXM7CgogICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdmVydGljZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgICBidWZmZXIucHVzaChgJHt2ZXJ0aWNlc1tpXS54fSAke3ZlcnRpY2VzW2ldLnl9ICR7aSA9PT0gMCA/ICJtIiA6ICJsIn1gKTsKICAgICAgICAgIH0KCiAgICAgICAgICBidWZmZXIucHVzaCgiUyIpOwogICAgICAgICAgcmV0dXJuIFtwb2ludHNbMF0ueCwgcG9pbnRzWzFdLngsIHBvaW50c1szXS55LCBwb2ludHNbMV0ueV07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cgp9CgpjbGFzcyBQb2x5Z29uQW5ub3RhdGlvbiBleHRlbmRzIFBvbHlsaW5lQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICB0aGlzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5QT0xZR09OOwogIH0KCn0KCmNsYXNzIENhcmV0QW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuQ0FSRVQ7CiAgfQoKfQoKY2xhc3MgSW5rQW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuSU5LOwogICAgdGhpcy5kYXRhLmlua0xpc3RzID0gW107CiAgICBjb25zdCByYXdJbmtMaXN0cyA9IHBhcmFtZXRlcnMuZGljdC5nZXRBcnJheSgiSW5rTGlzdCIpOwoKICAgIGlmICghQXJyYXkuaXNBcnJheShyYXdJbmtMaXN0cykpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHhyZWYgPSBwYXJhbWV0ZXJzLnhyZWY7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gcmF3SW5rTGlzdHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICB0aGlzLmRhdGEuaW5rTGlzdHMucHVzaChbXSk7CgogICAgICBmb3IgKGxldCBqID0gMCwgamogPSByYXdJbmtMaXN0c1tpXS5sZW5ndGg7IGogPCBqajsgaiArPSAyKSB7CiAgICAgICAgdGhpcy5kYXRhLmlua0xpc3RzW2ldLnB1c2goewogICAgICAgICAgeDogeHJlZi5mZXRjaElmUmVmKHJhd0lua0xpc3RzW2ldW2pdKSwKICAgICAgICAgIHk6IHhyZWYuZmV0Y2hJZlJlZihyYXdJbmtMaXN0c1tpXVtqICsgMV0pCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXRoaXMuYXBwZWFyYW5jZSkgewogICAgICBjb25zdCBzdHJva2VDb2xvciA9IHRoaXMuY29sb3IgPyBBcnJheS5mcm9tKHRoaXMuY29sb3IpLm1hcChjID0+IGMgLyAyNTUpIDogWzAsIDAsIDBdOwogICAgICBjb25zdCBzdHJva2VBbHBoYSA9IHBhcmFtZXRlcnMuZGljdC5nZXQoIkNBIik7CiAgICAgIGNvbnN0IGJvcmRlcldpZHRoID0gdGhpcy5ib3JkZXJTdHlsZS53aWR0aCB8fCAxLAogICAgICAgICAgICBib3JkZXJBZGp1c3QgPSAyICogYm9yZGVyV2lkdGg7CiAgICAgIGNvbnN0IGJib3ggPSBbSW5maW5pdHksIEluZmluaXR5LCAtSW5maW5pdHksIC1JbmZpbml0eV07CgogICAgICBmb3IgKGNvbnN0IGlua0xpc3RzIG9mIHRoaXMuZGF0YS5pbmtMaXN0cykgewogICAgICAgIGZvciAoY29uc3QgdmVydGV4IG9mIGlua0xpc3RzKSB7CiAgICAgICAgICBiYm94WzBdID0gTWF0aC5taW4oYmJveFswXSwgdmVydGV4LnggLSBib3JkZXJBZGp1c3QpOwogICAgICAgICAgYmJveFsxXSA9IE1hdGgubWluKGJib3hbMV0sIHZlcnRleC55IC0gYm9yZGVyQWRqdXN0KTsKICAgICAgICAgIGJib3hbMl0gPSBNYXRoLm1heChiYm94WzJdLCB2ZXJ0ZXgueCArIGJvcmRlckFkanVzdCk7CiAgICAgICAgICBiYm94WzNdID0gTWF0aC5tYXgoYmJveFszXSwgdmVydGV4LnkgKyBib3JkZXJBZGp1c3QpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCFfdXRpbC5VdGlsLmludGVyc2VjdCh0aGlzLnJlY3RhbmdsZSwgYmJveCkpIHsKICAgICAgICB0aGlzLnJlY3RhbmdsZSA9IGJib3g7CiAgICAgIH0KCiAgICAgIHRoaXMuX3NldERlZmF1bHRBcHBlYXJhbmNlKHsKICAgICAgICB4cmVmOiBwYXJhbWV0ZXJzLnhyZWYsCiAgICAgICAgZXh0cmE6IGAke2JvcmRlcldpZHRofSB3YCwKICAgICAgICBzdHJva2VDb2xvciwKICAgICAgICBzdHJva2VBbHBoYSwKICAgICAgICBwb2ludHNDYWxsYmFjazogKGJ1ZmZlciwgcG9pbnRzKSA9PiB7CiAgICAgICAgICBmb3IgKGNvbnN0IGlua0xpc3Qgb2YgdGhpcy5kYXRhLmlua0xpc3RzKSB7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGlua0xpc3QubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgICAgIGJ1ZmZlci5wdXNoKGAke2lua0xpc3RbaV0ueH0gJHtpbmtMaXN0W2ldLnl9ICR7aSA9PT0gMCA/ICJtIiA6ICJsIn1gKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnVmZmVyLnB1c2goIlMiKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gW3BvaW50c1swXS54LCBwb2ludHNbMV0ueCwgcG9pbnRzWzNdLnksIHBvaW50c1sxXS55XTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KCiAgc3RhdGljIGNyZWF0ZU5ld0RpY3QoYW5ub3RhdGlvbiwgeHJlZiwgX3JlZjUpIHsKICAgIGxldCB7CiAgICAgIGFwUmVmLAogICAgICBhcAogICAgfSA9IF9yZWY1OwogICAgY29uc3QgewogICAgICBwYXRocywKICAgICAgcmVjdCwKICAgICAgcm90YXRpb24KICAgIH0gPSBhbm5vdGF0aW9uOwogICAgY29uc3QgaW5rID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICBpbmsuc2V0KCJUeXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkFubm90IikpOwogICAgaW5rLnNldCgiU3VidHlwZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJJbmsiKSk7CiAgICBpbmsuc2V0KCJDcmVhdGlvbkRhdGUiLCBgRDokeygwLCBfdXRpbC5nZXRNb2RpZmljYXRpb25EYXRlKSgpfWApOwogICAgaW5rLnNldCgiUmVjdCIsIHJlY3QpOwogICAgaW5rLnNldCgiSW5rTGlzdCIsIHBhdGhzLm1hcChwID0+IHAucG9pbnRzKSk7CiAgICBpbmsuc2V0KCJGIiwgNCk7CiAgICBpbmsuc2V0KCJCb3JkZXIiLCBbMCwgMCwgMF0pOwogICAgaW5rLnNldCgiUm90YXRlIiwgcm90YXRpb24pOwogICAgY29uc3QgbiA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgaW5rLnNldCgiQVAiLCBuKTsKCiAgICBpZiAoYXBSZWYpIHsKICAgICAgbi5zZXQoIk4iLCBhcFJlZik7CiAgICB9IGVsc2UgewogICAgICBuLnNldCgiTiIsIGFwKTsKICAgIH0KCiAgICByZXR1cm4gaW5rOwogIH0KCiAgc3RhdGljIGFzeW5jIGNyZWF0ZU5ld0FwcGVhcmFuY2VTdHJlYW0oYW5ub3RhdGlvbiwgeHJlZiwgcGFyYW1zKSB7CiAgICBjb25zdCB7CiAgICAgIGNvbG9yLAogICAgICByZWN0LAogICAgICByb3RhdGlvbiwKICAgICAgcGF0aHMsCiAgICAgIHRoaWNrbmVzcywKICAgICAgb3BhY2l0eQogICAgfSA9IGFubm90YXRpb247CiAgICBjb25zdCBbeDEsIHkxLCB4MiwgeTJdID0gcmVjdDsKICAgIGxldCB3ID0geDIgLSB4MTsKICAgIGxldCBoID0geTIgLSB5MTsKCiAgICBpZiAocm90YXRpb24gJSAxODAgIT09IDApIHsKICAgICAgW3csIGhdID0gW2gsIHddOwogICAgfQoKICAgIGNvbnN0IGFwcGVhcmFuY2VCdWZmZXIgPSBbYCR7dGhpY2tuZXNzfSB3IDEgSiAxIGpgLCBgJHsoMCwgX2RlZmF1bHRfYXBwZWFyYW5jZS5nZXRQZGZDb2xvcikoY29sb3IsIGZhbHNlKX1gXTsKCiAgICBpZiAob3BhY2l0eSAhPT0gMSkgewogICAgICBhcHBlYXJhbmNlQnVmZmVyLnB1c2goIi9SMCBncyIpOwogICAgfQoKICAgIGNvbnN0IGJ1ZmZlciA9IFtdOwoKICAgIGZvciAoY29uc3QgewogICAgICBiZXppZXIKICAgIH0gb2YgcGF0aHMpIHsKICAgICAgYnVmZmVyLmxlbmd0aCA9IDA7CiAgICAgIGJ1ZmZlci5wdXNoKGAkeygwLCBfY29yZV91dGlscy5udW1iZXJUb1N0cmluZykoYmV6aWVyWzBdKX0gJHsoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKGJlemllclsxXSl9IG1gKTsKCiAgICAgIGZvciAobGV0IGkgPSAyLCBpaSA9IGJlemllci5sZW5ndGg7IGkgPCBpaTsgaSArPSA2KSB7CiAgICAgICAgY29uc3QgY3VydmUgPSBiZXppZXIuc2xpY2UoaSwgaSArIDYpLm1hcChfY29yZV91dGlscy5udW1iZXJUb1N0cmluZykuam9pbigiICIpOwogICAgICAgIGJ1ZmZlci5wdXNoKGAke2N1cnZlfSBjYCk7CiAgICAgIH0KCiAgICAgIGJ1ZmZlci5wdXNoKCJTIik7CiAgICAgIGFwcGVhcmFuY2VCdWZmZXIucHVzaChidWZmZXIuam9pbigiXG4iKSk7CiAgICB9CgogICAgY29uc3QgYXBwZWFyYW5jZSA9IGFwcGVhcmFuY2VCdWZmZXIuam9pbigiXG4iKTsKICAgIGNvbnN0IGFwcGVhcmFuY2VTdHJlYW1EaWN0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIkZvcm1UeXBlIiwgMSk7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIlN1YnR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRm9ybSIpKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiVHlwZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJYT2JqZWN0IikpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJCQm94IiwgWzAsIDAsIHcsIGhdKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiTGVuZ3RoIiwgYXBwZWFyYW5jZS5sZW5ndGgpOwoKICAgIGlmIChyb3RhdGlvbikgewogICAgICBjb25zdCBtYXRyaXggPSBXaWRnZXRBbm5vdGF0aW9uLl9nZXRSb3RhdGlvbk1hdHJpeChyb3RhdGlvbiwgdywgaCk7CgogICAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIk1hdHJpeCIsIG1hdHJpeCk7CiAgICB9CgogICAgaWYgKG9wYWNpdHkgIT09IDEpIHsKICAgICAgY29uc3QgcmVzb3VyY2VzID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICAgIGNvbnN0IGV4dEdTdGF0ZSA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgICBjb25zdCByMCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgICByMC5zZXQoIkNBIiwgb3BhY2l0eSk7CiAgICAgIHIwLnNldCgiVHlwZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJFeHRHU3RhdGUiKSk7CiAgICAgIGV4dEdTdGF0ZS5zZXQoIlIwIiwgcjApOwogICAgICByZXNvdXJjZXMuc2V0KCJFeHRHU3RhdGUiLCBleHRHU3RhdGUpOwogICAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIlJlc291cmNlcyIsIHJlc291cmNlcyk7CiAgICB9CgogICAgY29uc3QgYXAgPSBuZXcgX3N0cmVhbS5TdHJpbmdTdHJlYW0oYXBwZWFyYW5jZSk7CiAgICBhcC5kaWN0ID0gYXBwZWFyYW5jZVN0cmVhbURpY3Q7CiAgICByZXR1cm4gYXA7CiAgfQoKfQoKY2xhc3MgSGlnaGxpZ2h0QW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuSElHSExJR0hUOwogICAgY29uc3QgcXVhZFBvaW50cyA9IHRoaXMuZGF0YS5xdWFkUG9pbnRzID0gZ2V0UXVhZFBvaW50cyhwYXJhbWV0ZXJzLmRpY3QsIG51bGwpOwoKICAgIGlmIChxdWFkUG9pbnRzKSB7CiAgICAgIGNvbnN0IHJlc291cmNlcyA9IHRoaXMuYXBwZWFyYW5jZSAmJiB0aGlzLmFwcGVhcmFuY2UuZGljdC5nZXQoIlJlc291cmNlcyIpOwoKICAgICAgaWYgKCF0aGlzLmFwcGVhcmFuY2UgfHwgIShyZXNvdXJjZXMgJiYgcmVzb3VyY2VzLmhhcygiRXh0R1N0YXRlIikpKSB7CiAgICAgICAgaWYgKHRoaXMuYXBwZWFyYW5jZSkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJIaWdobGlnaHRBbm5vdGF0aW9uIC0gaWdub3JpbmcgYnVpbHQtaW4gYXBwZWFyYW5jZSBzdHJlYW0uIik7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBmaWxsQ29sb3IgPSB0aGlzLmNvbG9yID8gQXJyYXkuZnJvbSh0aGlzLmNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IFsxLCAxLCAwXTsKICAgICAgICBjb25zdCBmaWxsQWxwaGEgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0KCJDQSIpOwoKICAgICAgICB0aGlzLl9zZXREZWZhdWx0QXBwZWFyYW5jZSh7CiAgICAgICAgICB4cmVmOiBwYXJhbWV0ZXJzLnhyZWYsCiAgICAgICAgICBmaWxsQ29sb3IsCiAgICAgICAgICBibGVuZE1vZGU6ICJNdWx0aXBseSIsCiAgICAgICAgICBmaWxsQWxwaGEsCiAgICAgICAgICBwb2ludHNDYWxsYmFjazogKGJ1ZmZlciwgcG9pbnRzKSA9PiB7CiAgICAgICAgICAgIGJ1ZmZlci5wdXNoKGAke3BvaW50c1swXS54fSAke3BvaW50c1swXS55fSBtYCwgYCR7cG9pbnRzWzFdLnh9ICR7cG9pbnRzWzFdLnl9IGxgLCBgJHtwb2ludHNbM10ueH0gJHtwb2ludHNbM10ueX0gbGAsIGAke3BvaW50c1syXS54fSAke3BvaW50c1syXS55fSBsYCwgImYiKTsKICAgICAgICAgICAgcmV0dXJuIFtwb2ludHNbMF0ueCwgcG9pbnRzWzFdLngsIHBvaW50c1szXS55LCBwb2ludHNbMV0ueV07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZGF0YS5oYXNQb3B1cCA9IGZhbHNlOwogICAgfQogIH0KCn0KCmNsYXNzIFVuZGVybGluZUFubm90YXRpb24gZXh0ZW5kcyBNYXJrdXBBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcihwYXJhbWV0ZXJzKTsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlVOREVSTElORTsKICAgIGNvbnN0IHF1YWRQb2ludHMgPSB0aGlzLmRhdGEucXVhZFBvaW50cyA9IGdldFF1YWRQb2ludHMocGFyYW1ldGVycy5kaWN0LCBudWxsKTsKCiAgICBpZiAocXVhZFBvaW50cykgewogICAgICBpZiAoIXRoaXMuYXBwZWFyYW5jZSkgewogICAgICAgIGNvbnN0IHN0cm9rZUNvbG9yID0gdGhpcy5jb2xvciA/IEFycmF5LmZyb20odGhpcy5jb2xvcikubWFwKGMgPT4gYyAvIDI1NSkgOiBbMCwgMCwgMF07CiAgICAgICAgY29uc3Qgc3Ryb2tlQWxwaGEgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0KCJDQSIpOwoKICAgICAgICB0aGlzLl9zZXREZWZhdWx0QXBwZWFyYW5jZSh7CiAgICAgICAgICB4cmVmOiBwYXJhbWV0ZXJzLnhyZWYsCiAgICAgICAgICBleHRyYTogIltdIDAgZCAxIHciLAogICAgICAgICAgc3Ryb2tlQ29sb3IsCiAgICAgICAgICBzdHJva2VBbHBoYSwKICAgICAgICAgIHBvaW50c0NhbGxiYWNrOiAoYnVmZmVyLCBwb2ludHMpID0+IHsKICAgICAgICAgICAgYnVmZmVyLnB1c2goYCR7cG9pbnRzWzJdLnh9ICR7cG9pbnRzWzJdLnl9IG1gLCBgJHtwb2ludHNbM10ueH0gJHtwb2ludHNbM10ueX0gbGAsICJTIik7CiAgICAgICAgICAgIHJldHVybiBbcG9pbnRzWzBdLngsIHBvaW50c1sxXS54LCBwb2ludHNbM10ueSwgcG9pbnRzWzFdLnldOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRhdGEuaGFzUG9wdXAgPSBmYWxzZTsKICAgIH0KICB9Cgp9CgpjbGFzcyBTcXVpZ2dseUFubm90YXRpb24gZXh0ZW5kcyBNYXJrdXBBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcihwYXJhbWV0ZXJzKTsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlNRVUlHR0xZOwogICAgY29uc3QgcXVhZFBvaW50cyA9IHRoaXMuZGF0YS5xdWFkUG9pbnRzID0gZ2V0UXVhZFBvaW50cyhwYXJhbWV0ZXJzLmRpY3QsIG51bGwpOwoKICAgIGlmIChxdWFkUG9pbnRzKSB7CiAgICAgIGlmICghdGhpcy5hcHBlYXJhbmNlKSB7CiAgICAgICAgY29uc3Qgc3Ryb2tlQ29sb3IgPSB0aGlzLmNvbG9yID8gQXJyYXkuZnJvbSh0aGlzLmNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IFswLCAwLCAwXTsKICAgICAgICBjb25zdCBzdHJva2VBbHBoYSA9IHBhcmFtZXRlcnMuZGljdC5nZXQoIkNBIik7CgogICAgICAgIHRoaXMuX3NldERlZmF1bHRBcHBlYXJhbmNlKHsKICAgICAgICAgIHhyZWY6IHBhcmFtZXRlcnMueHJlZiwKICAgICAgICAgIGV4dHJhOiAiW10gMCBkIDEgdyIsCiAgICAgICAgICBzdHJva2VDb2xvciwKICAgICAgICAgIHN0cm9rZUFscGhhLAogICAgICAgICAgcG9pbnRzQ2FsbGJhY2s6IChidWZmZXIsIHBvaW50cykgPT4gewogICAgICAgICAgICBjb25zdCBkeSA9IChwb2ludHNbMF0ueSAtIHBvaW50c1syXS55KSAvIDY7CiAgICAgICAgICAgIGxldCBzaGlmdCA9IGR5OwogICAgICAgICAgICBsZXQgeCA9IHBvaW50c1syXS54OwogICAgICAgICAgICBjb25zdCB5ID0gcG9pbnRzWzJdLnk7CiAgICAgICAgICAgIGNvbnN0IHhFbmQgPSBwb2ludHNbM10ueDsKICAgICAgICAgICAgYnVmZmVyLnB1c2goYCR7eH0gJHt5ICsgc2hpZnR9IG1gKTsKCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICB4ICs9IDI7CiAgICAgICAgICAgICAgc2hpZnQgPSBzaGlmdCA9PT0gMCA/IGR5IDogMDsKICAgICAgICAgICAgICBidWZmZXIucHVzaChgJHt4fSAke3kgKyBzaGlmdH0gbGApOwogICAgICAgICAgICB9IHdoaWxlICh4IDwgeEVuZCk7CgogICAgICAgICAgICBidWZmZXIucHVzaCgiUyIpOwogICAgICAgICAgICByZXR1cm4gW3BvaW50c1syXS54LCB4RW5kLCB5IC0gMiAqIGR5LCB5ICsgMiAqIGR5XTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5kYXRhLmhhc1BvcHVwID0gZmFsc2U7CiAgICB9CiAgfQoKfQoKY2xhc3MgU3RyaWtlT3V0QW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuU1RSSUtFT1VUOwogICAgY29uc3QgcXVhZFBvaW50cyA9IHRoaXMuZGF0YS5xdWFkUG9pbnRzID0gZ2V0UXVhZFBvaW50cyhwYXJhbWV0ZXJzLmRpY3QsIG51bGwpOwoKICAgIGlmIChxdWFkUG9pbnRzKSB7CiAgICAgIGlmICghdGhpcy5hcHBlYXJhbmNlKSB7CiAgICAgICAgY29uc3Qgc3Ryb2tlQ29sb3IgPSB0aGlzLmNvbG9yID8gQXJyYXkuZnJvbSh0aGlzLmNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IFswLCAwLCAwXTsKICAgICAgICBjb25zdCBzdHJva2VBbHBoYSA9IHBhcmFtZXRlcnMuZGljdC5nZXQoIkNBIik7CgogICAgICAgIHRoaXMuX3NldERlZmF1bHRBcHBlYXJhbmNlKHsKICAgICAgICAgIHhyZWY6IHBhcmFtZXRlcnMueHJlZiwKICAgICAgICAgIGV4dHJhOiAiW10gMCBkIDEgdyIsCiAgICAgICAgICBzdHJva2VDb2xvciwKICAgICAgICAgIHN0cm9rZUFscGhhLAogICAgICAgICAgcG9pbnRzQ2FsbGJhY2s6IChidWZmZXIsIHBvaW50cykgPT4gewogICAgICAgICAgICBidWZmZXIucHVzaChgJHsocG9pbnRzWzBdLnggKyBwb2ludHNbMl0ueCkgLyAyfSBgICsgYCR7KHBvaW50c1swXS55ICsgcG9pbnRzWzJdLnkpIC8gMn0gbWAsIGAkeyhwb2ludHNbMV0ueCArIHBvaW50c1szXS54KSAvIDJ9IGAgKyBgJHsocG9pbnRzWzFdLnkgKyBwb2ludHNbM10ueSkgLyAyfSBsYCwgIlMiKTsKICAgICAgICAgICAgcmV0dXJuIFtwb2ludHNbMF0ueCwgcG9pbnRzWzFdLngsIHBvaW50c1szXS55LCBwb2ludHNbMV0ueV07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZGF0YS5oYXNQb3B1cCA9IGZhbHNlOwogICAgfQogIH0KCn0KCmNsYXNzIFN0YW1wQW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuU1RBTVA7CiAgfQoKfQoKY2xhc3MgRmlsZUF0dGFjaG1lbnRBbm5vdGF0aW9uIGV4dGVuZHMgTWFya3VwQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICBjb25zdCBmaWxlID0gbmV3IF9maWxlX3NwZWMuRmlsZVNwZWMocGFyYW1ldGVycy5kaWN0LmdldCgiRlMiKSwgcGFyYW1ldGVycy54cmVmKTsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLkZJTEVBVFRBQ0hNRU5UOwogICAgdGhpcy5kYXRhLmZpbGUgPSBmaWxlLnNlcmlhbGl6YWJsZTsKICB9Cgp9CgovKioqLyB9KSwKLyogMTM4ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5jcmVhdGVEZWZhdWx0QXBwZWFyYW5jZSA9IGNyZWF0ZURlZmF1bHRBcHBlYXJhbmNlOwpleHBvcnRzLmdldFBkZkNvbG9yID0gZ2V0UGRmQ29sb3I7CmV4cG9ydHMucGFyc2VEZWZhdWx0QXBwZWFyYW5jZSA9IHBhcnNlRGVmYXVsdEFwcGVhcmFuY2U7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jb2xvcnNwYWNlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzkpOwoKdmFyIF9ldmFsdWF0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0MCk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMCk7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTM1KTsKCmNsYXNzIERlZmF1bHRBcHBlYXJhbmNlRXZhbHVhdG9yIGV4dGVuZHMgX2V2YWx1YXRvci5FdmFsdWF0b3JQcmVwcm9jZXNzb3IgewogIGNvbnN0cnVjdG9yKHN0cikgewogICAgc3VwZXIobmV3IF9zdHJlYW0uU3RyaW5nU3RyZWFtKHN0cikpOwogIH0KCiAgcGFyc2UoKSB7CiAgICBjb25zdCBvcGVyYXRpb24gPSB7CiAgICAgIGZuOiAwLAogICAgICBhcmdzOiBbXQogICAgfTsKICAgIGNvbnN0IHJlc3VsdCA9IHsKICAgICAgZm9udFNpemU6IDAsCiAgICAgIGZvbnROYW1lOiAiIiwKICAgICAgZm9udENvbG9yOiBuZXcgVWludDhDbGFtcGVkQXJyYXkoMykKICAgIH07CgogICAgdHJ5IHsKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBvcGVyYXRpb24uYXJncy5sZW5ndGggPSAwOwoKICAgICAgICBpZiAoIXRoaXMucmVhZChvcGVyYXRpb24pKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnNhdmVkU3RhdGVzRGVwdGggIT09IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgewogICAgICAgICAgZm4sCiAgICAgICAgICBhcmdzCiAgICAgICAgfSA9IG9wZXJhdGlvbjsKCiAgICAgICAgc3dpdGNoIChmbiB8IDApIHsKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZvbnQ6CiAgICAgICAgICAgIGNvbnN0IFtmb250TmFtZSwgZm9udFNpemVdID0gYXJnczsKCiAgICAgICAgICAgIGlmIChmb250TmFtZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgICAgICByZXN1bHQuZm9udE5hbWUgPSBmb250TmFtZS5uYW1lOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodHlwZW9mIGZvbnRTaXplID09PSAibnVtYmVyIiAmJiBmb250U2l6ZSA+IDApIHsKICAgICAgICAgICAgICByZXN1bHQuZm9udFNpemUgPSBmb250U2l6ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yOgogICAgICAgICAgICBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMucmdiLmdldFJnYkl0ZW0oYXJncywgMCwgcmVzdWx0LmZvbnRDb2xvciwgMCk7CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGaWxsR3JheToKICAgICAgICAgICAgX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmdyYXkuZ2V0UmdiSXRlbShhcmdzLCAwLCByZXN1bHQuZm9udENvbG9yLCAwKTsKCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZpbGxDb2xvclNwYWNlOgogICAgICAgICAgICBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuY215ay5nZXRSZ2JJdGVtKGFyZ3MsIDAsIHJlc3VsdC5mb250Q29sb3IsIDApOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9IGNhdGNoIChyZWFzb24pIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBwYXJzZURlZmF1bHRBcHBlYXJhbmNlIC0gaWdub3JpbmcgZXJyb3JzOiAiJHtyZWFzb259Ii5gKTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0OwogIH0KCn0KCmZ1bmN0aW9uIHBhcnNlRGVmYXVsdEFwcGVhcmFuY2Uoc3RyKSB7CiAgcmV0dXJuIG5ldyBEZWZhdWx0QXBwZWFyYW5jZUV2YWx1YXRvcihzdHIpLnBhcnNlKCk7Cn0KCmZ1bmN0aW9uIGdldFBkZkNvbG9yKGNvbG9yLCBpc0ZpbGwpIHsKICBpZiAoY29sb3JbMF0gPT09IGNvbG9yWzFdICYmIGNvbG9yWzFdID09PSBjb2xvclsyXSkgewogICAgY29uc3QgZ3JheSA9IGNvbG9yWzBdIC8gMjU1OwogICAgcmV0dXJuIGAkeygwLCBfY29yZV91dGlscy5udW1iZXJUb1N0cmluZykoZ3JheSl9ICR7aXNGaWxsID8gImciIDogIkcifWA7CiAgfQoKICByZXR1cm4gQXJyYXkuZnJvbShjb2xvcikubWFwKGMgPT4gKDAsIF9jb3JlX3V0aWxzLm51bWJlclRvU3RyaW5nKShjIC8gMjU1KSkuam9pbigiICIpICsgYCAke2lzRmlsbCA/ICJyZyIgOiAiUkcifWA7Cn0KCmZ1bmN0aW9uIGNyZWF0ZURlZmF1bHRBcHBlYXJhbmNlKF9yZWYpIHsKICBsZXQgewogICAgZm9udFNpemUsCiAgICBmb250TmFtZSwKICAgIGZvbnRDb2xvcgogIH0gPSBfcmVmOwogIHJldHVybiBgLyR7KDAsIF9jb3JlX3V0aWxzLmVzY2FwZVBERk5hbWUpKGZvbnROYW1lKX0gJHtmb250U2l6ZX0gVGYgJHtnZXRQZGZDb2xvcihmb250Q29sb3IsIHRydWUpfWA7Cn0KCi8qKiovIH0pLAovKiAxMzkgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkNvbG9yU3BhY2UgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwoKdmFyIF9iYXNlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMyKTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMxKTsKCmZ1bmN0aW9uIHJlc2l6ZVJnYkltYWdlKHNyYywgZGVzdCwgdzEsIGgxLCB3MiwgaDIsIGFscGhhMDEpIHsKICBjb25zdCBDT01QT05FTlRTID0gMzsKICBhbHBoYTAxID0gYWxwaGEwMSAhPT0gMSA/IDAgOiBhbHBoYTAxOwogIGNvbnN0IHhSYXRpbyA9IHcxIC8gdzI7CiAgY29uc3QgeVJhdGlvID0gaDEgLyBoMjsKICBsZXQgbmV3SW5kZXggPSAwLAogICAgICBvbGRJbmRleDsKICBjb25zdCB4U2NhbGVkID0gbmV3IFVpbnQxNkFycmF5KHcyKTsKICBjb25zdCB3MVNjYW5saW5lID0gdzEgKiBDT01QT05FTlRTOwoKICBmb3IgKGxldCBpID0gMDsgaSA8IHcyOyBpKyspIHsKICAgIHhTY2FsZWRbaV0gPSBNYXRoLmZsb29yKGkgKiB4UmF0aW8pICogQ09NUE9ORU5UUzsKICB9CgogIGZvciAobGV0IGkgPSAwOyBpIDwgaDI7IGkrKykgewogICAgY29uc3QgcHkgPSBNYXRoLmZsb29yKGkgKiB5UmF0aW8pICogdzFTY2FubGluZTsKCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHcyOyBqKyspIHsKICAgICAgb2xkSW5kZXggPSBweSArIHhTY2FsZWRbal07CiAgICAgIGRlc3RbbmV3SW5kZXgrK10gPSBzcmNbb2xkSW5kZXgrK107CiAgICAgIGRlc3RbbmV3SW5kZXgrK10gPSBzcmNbb2xkSW5kZXgrK107CiAgICAgIGRlc3RbbmV3SW5kZXgrK10gPSBzcmNbb2xkSW5kZXgrK107CiAgICAgIG5ld0luZGV4ICs9IGFscGhhMDE7CiAgICB9CiAgfQp9CgpjbGFzcyBDb2xvclNwYWNlIHsKICBjb25zdHJ1Y3RvcihuYW1lLCBudW1Db21wcykgewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IENvbG9yU3BhY2UpIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQ2Fubm90IGluaXRpYWxpemUgQ29sb3JTcGFjZS4iKTsKICAgIH0KCiAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgdGhpcy5udW1Db21wcyA9IG51bUNvbXBzOwogIH0KCiAgZ2V0UmdiKHNyYywgc3JjT2Zmc2V0KSB7CiAgICBjb25zdCByZ2IgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoMyk7CiAgICB0aGlzLmdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIHJnYiwgMCk7CiAgICByZXR1cm4gcmdiOwogIH0KCiAgZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiU2hvdWxkIG5vdCBjYWxsIENvbG9yU3BhY2UuZ2V0UmdiSXRlbSIpOwogIH0KCiAgZ2V0UmdiQnVmZmVyKHNyYywgc3JjT2Zmc2V0LCBjb3VudCwgZGVzdCwgZGVzdE9mZnNldCwgYml0cywgYWxwaGEwMSkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiU2hvdWxkIG5vdCBjYWxsIENvbG9yU3BhY2UuZ2V0UmdiQnVmZmVyIik7CiAgfQoKICBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIlNob3VsZCBub3QgY2FsbCBDb2xvclNwYWNlLmdldE91dHB1dExlbmd0aCIpOwogIH0KCiAgaXNQYXNzdGhyb3VnaChiaXRzKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBpc0RlZmF1bHREZWNvZGUoZGVjb2RlTWFwLCBicGMpIHsKICAgIHJldHVybiBDb2xvclNwYWNlLmlzRGVmYXVsdERlY29kZShkZWNvZGVNYXAsIHRoaXMubnVtQ29tcHMpOwogIH0KCiAgZmlsbFJnYihkZXN0LCBvcmlnaW5hbFdpZHRoLCBvcmlnaW5hbEhlaWdodCwgd2lkdGgsIGhlaWdodCwgYWN0dWFsSGVpZ2h0LCBicGMsIGNvbXBzLCBhbHBoYTAxKSB7CiAgICBjb25zdCBjb3VudCA9IG9yaWdpbmFsV2lkdGggKiBvcmlnaW5hbEhlaWdodDsKICAgIGxldCByZ2JCdWYgPSBudWxsOwogICAgY29uc3QgbnVtQ29tcG9uZW50Q29sb3JzID0gMSA8PCBicGM7CiAgICBjb25zdCBuZWVkc1Jlc2l6aW5nID0gb3JpZ2luYWxIZWlnaHQgIT09IGhlaWdodCB8fCBvcmlnaW5hbFdpZHRoICE9PSB3aWR0aDsKCiAgICBpZiAodGhpcy5pc1Bhc3N0aHJvdWdoKGJwYykpIHsKICAgICAgcmdiQnVmID0gY29tcHM7CiAgICB9IGVsc2UgaWYgKHRoaXMubnVtQ29tcHMgPT09IDEgJiYgY291bnQgPiBudW1Db21wb25lbnRDb2xvcnMgJiYgdGhpcy5uYW1lICE9PSAiRGV2aWNlR3JheSIgJiYgdGhpcy5uYW1lICE9PSAiRGV2aWNlUkdCIikgewogICAgICBjb25zdCBhbGxDb2xvcnMgPSBicGMgPD0gOCA/IG5ldyBVaW50OEFycmF5KG51bUNvbXBvbmVudENvbG9ycykgOiBuZXcgVWludDE2QXJyYXkobnVtQ29tcG9uZW50Q29sb3JzKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtQ29tcG9uZW50Q29sb3JzOyBpKyspIHsKICAgICAgICBhbGxDb2xvcnNbaV0gPSBpOwogICAgICB9CgogICAgICBjb25zdCBjb2xvck1hcCA9IG5ldyBVaW50OENsYW1wZWRBcnJheShudW1Db21wb25lbnRDb2xvcnMgKiAzKTsKICAgICAgdGhpcy5nZXRSZ2JCdWZmZXIoYWxsQ29sb3JzLCAwLCBudW1Db21wb25lbnRDb2xvcnMsIGNvbG9yTWFwLCAwLCBicGMsIDApOwoKICAgICAgaWYgKCFuZWVkc1Jlc2l6aW5nKSB7CiAgICAgICAgbGV0IGRlc3RQb3MgPSAwOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyArK2kpIHsKICAgICAgICAgIGNvbnN0IGtleSA9IGNvbXBzW2ldICogMzsKICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IGNvbG9yTWFwW2tleV07CiAgICAgICAgICBkZXN0W2Rlc3RQb3MrK10gPSBjb2xvck1hcFtrZXkgKyAxXTsKICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IGNvbG9yTWFwW2tleSArIDJdOwogICAgICAgICAgZGVzdFBvcyArPSBhbHBoYTAxOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZ2JCdWYgPSBuZXcgVWludDhBcnJheShjb3VudCAqIDMpOwogICAgICAgIGxldCByZ2JQb3MgPSAwOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyArK2kpIHsKICAgICAgICAgIGNvbnN0IGtleSA9IGNvbXBzW2ldICogMzsKICAgICAgICAgIHJnYkJ1ZltyZ2JQb3MrK10gPSBjb2xvck1hcFtrZXldOwogICAgICAgICAgcmdiQnVmW3JnYlBvcysrXSA9IGNvbG9yTWFwW2tleSArIDFdOwogICAgICAgICAgcmdiQnVmW3JnYlBvcysrXSA9IGNvbG9yTWFwW2tleSArIDJdOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKCFuZWVkc1Jlc2l6aW5nKSB7CiAgICAgICAgdGhpcy5nZXRSZ2JCdWZmZXIoY29tcHMsIDAsIHdpZHRoICogYWN0dWFsSGVpZ2h0LCBkZXN0LCAwLCBicGMsIGFscGhhMDEpOwogICAgICB9IGVsc2UgewogICAgICAgIHJnYkJ1ZiA9IG5ldyBVaW50OENsYW1wZWRBcnJheShjb3VudCAqIDMpOwogICAgICAgIHRoaXMuZ2V0UmdiQnVmZmVyKGNvbXBzLCAwLCBjb3VudCwgcmdiQnVmLCAwLCBicGMsIDApOwogICAgICB9CiAgICB9CgogICAgaWYgKHJnYkJ1ZikgewogICAgICBpZiAobmVlZHNSZXNpemluZykgewogICAgICAgIHJlc2l6ZVJnYkltYWdlKHJnYkJ1ZiwgZGVzdCwgb3JpZ2luYWxXaWR0aCwgb3JpZ2luYWxIZWlnaHQsIHdpZHRoLCBoZWlnaHQsIGFscGhhMDEpOwogICAgICB9IGVsc2UgewogICAgICAgIGxldCBkZXN0UG9zID0gMCwKICAgICAgICAgICAgcmdiUG9zID0gMDsKCiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gd2lkdGggKiBhY3R1YWxIZWlnaHQ7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICBkZXN0W2Rlc3RQb3MrK10gPSByZ2JCdWZbcmdiUG9zKytdOwogICAgICAgICAgZGVzdFtkZXN0UG9zKytdID0gcmdiQnVmW3JnYlBvcysrXTsKICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHJnYkJ1ZltyZ2JQb3MrK107CiAgICAgICAgICBkZXN0UG9zICs9IGFscGhhMDE7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBnZXQgdXNlc1plcm9Ub09uZVJhbmdlKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ1c2VzWmVyb1RvT25lUmFuZ2UiLCB0cnVlKTsKICB9CgogIHN0YXRpYyBfY2FjaGUoY2FjaGVLZXksIHhyZWYsIGxvY2FsQ29sb3JTcGFjZUNhY2hlLCBwYXJzZWRDb2xvclNwYWNlKSB7CiAgICBpZiAoIWxvY2FsQ29sb3JTcGFjZUNhY2hlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignQ29sb3JTcGFjZS5fY2FjaGUgLSBleHBlY3RlZCAibG9jYWxDb2xvclNwYWNlQ2FjaGUiIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGlmICghcGFyc2VkQ29sb3JTcGFjZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbG9yU3BhY2UuX2NhY2hlIC0gZXhwZWN0ZWQgInBhcnNlZENvbG9yU3BhY2UiIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGxldCBjc05hbWUsIGNzUmVmOwoKICAgIGlmIChjYWNoZUtleSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICBjc1JlZiA9IGNhY2hlS2V5OwogICAgICBjYWNoZUtleSA9IHhyZWYuZmV0Y2goY2FjaGVLZXkpOwogICAgfQoKICAgIGlmIChjYWNoZUtleSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgY3NOYW1lID0gY2FjaGVLZXkubmFtZTsKICAgIH0KCiAgICBpZiAoY3NOYW1lIHx8IGNzUmVmKSB7CiAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlLnNldChjc05hbWUsIGNzUmVmLCBwYXJzZWRDb2xvclNwYWNlKTsKICAgIH0KICB9CgogIHN0YXRpYyBnZXRDYWNoZWQoY2FjaGVLZXksIHhyZWYsIGxvY2FsQ29sb3JTcGFjZUNhY2hlKSB7CiAgICBpZiAoIWxvY2FsQ29sb3JTcGFjZUNhY2hlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignQ29sb3JTcGFjZS5nZXRDYWNoZWQgLSBleHBlY3RlZCAibG9jYWxDb2xvclNwYWNlQ2FjaGUiIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGlmIChjYWNoZUtleSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICBjb25zdCBsb2NhbENvbG9yU3BhY2UgPSBsb2NhbENvbG9yU3BhY2VDYWNoZS5nZXRCeVJlZihjYWNoZUtleSk7CgogICAgICBpZiAobG9jYWxDb2xvclNwYWNlKSB7CiAgICAgICAgcmV0dXJuIGxvY2FsQ29sb3JTcGFjZTsKICAgICAgfQoKICAgICAgdHJ5IHsKICAgICAgICBjYWNoZUtleSA9IHhyZWYuZmV0Y2goY2FjaGVLZXkpOwogICAgICB9IGNhdGNoIChleCkgewogICAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgICB0aHJvdyBleDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAoY2FjaGVLZXkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIGNvbnN0IGxvY2FsQ29sb3JTcGFjZSA9IGxvY2FsQ29sb3JTcGFjZUNhY2hlLmdldEJ5TmFtZShjYWNoZUtleS5uYW1lKTsKCiAgICAgIGlmIChsb2NhbENvbG9yU3BhY2UpIHsKICAgICAgICByZXR1cm4gbG9jYWxDb2xvclNwYWNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBzdGF0aWMgYXN5bmMgcGFyc2VBc3luYyhfcmVmKSB7CiAgICBsZXQgewogICAgICBjcywKICAgICAgeHJlZiwKICAgICAgcmVzb3VyY2VzID0gbnVsbCwKICAgICAgcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgfSA9IF9yZWY7CgogICAgY29uc3QgcGFyc2VkQ29sb3JTcGFjZSA9IHRoaXMuX3BhcnNlKGNzLCB4cmVmLCByZXNvdXJjZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSk7CgogICAgdGhpcy5fY2FjaGUoY3MsIHhyZWYsIGxvY2FsQ29sb3JTcGFjZUNhY2hlLCBwYXJzZWRDb2xvclNwYWNlKTsKCiAgICByZXR1cm4gcGFyc2VkQ29sb3JTcGFjZTsKICB9CgogIHN0YXRpYyBwYXJzZShfcmVmMikgewogICAgbGV0IHsKICAgICAgY3MsCiAgICAgIHhyZWYsCiAgICAgIHJlc291cmNlcyA9IG51bGwsCiAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeSwKICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgIH0gPSBfcmVmMjsKICAgIGNvbnN0IGNhY2hlZENvbG9yU3BhY2UgPSB0aGlzLmdldENhY2hlZChjcywgeHJlZiwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpOwoKICAgIGlmIChjYWNoZWRDb2xvclNwYWNlKSB7CiAgICAgIHJldHVybiBjYWNoZWRDb2xvclNwYWNlOwogICAgfQoKICAgIGNvbnN0IHBhcnNlZENvbG9yU3BhY2UgPSB0aGlzLl9wYXJzZShjcywgeHJlZiwgcmVzb3VyY2VzLCBwZGZGdW5jdGlvbkZhY3RvcnkpOwoKICAgIHRoaXMuX2NhY2hlKGNzLCB4cmVmLCBsb2NhbENvbG9yU3BhY2VDYWNoZSwgcGFyc2VkQ29sb3JTcGFjZSk7CgogICAgcmV0dXJuIHBhcnNlZENvbG9yU3BhY2U7CiAgfQoKICBzdGF0aWMgX3BhcnNlKGNzLCB4cmVmKSB7CiAgICBsZXQgcmVzb3VyY2VzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBudWxsOwogICAgbGV0IHBkZkZ1bmN0aW9uRmFjdG9yeSA9IGFyZ3VtZW50cy5sZW5ndGggPiAzID8gYXJndW1lbnRzWzNdIDogdW5kZWZpbmVkOwogICAgY3MgPSB4cmVmLmZldGNoSWZSZWYoY3MpOwoKICAgIGlmIChjcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgc3dpdGNoIChjcy5uYW1lKSB7CiAgICAgICAgY2FzZSAiRyI6CiAgICAgICAgY2FzZSAiRGV2aWNlR3JheSI6CiAgICAgICAgICByZXR1cm4gdGhpcy5zaW5nbGV0b25zLmdyYXk7CgogICAgICAgIGNhc2UgIlJHQiI6CiAgICAgICAgY2FzZSAiRGV2aWNlUkdCIjoKICAgICAgICAgIHJldHVybiB0aGlzLnNpbmdsZXRvbnMucmdiOwoKICAgICAgICBjYXNlICJDTVlLIjoKICAgICAgICBjYXNlICJEZXZpY2VDTVlLIjoKICAgICAgICAgIHJldHVybiB0aGlzLnNpbmdsZXRvbnMuY215azsKCiAgICAgICAgY2FzZSAiUGF0dGVybiI6CiAgICAgICAgICByZXR1cm4gbmV3IFBhdHRlcm5DUyhudWxsKTsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGlmIChyZXNvdXJjZXMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgICAgIGNvbnN0IGNvbG9yU3BhY2VzID0gcmVzb3VyY2VzLmdldCgiQ29sb3JTcGFjZSIpOwoKICAgICAgICAgICAgaWYgKGNvbG9yU3BhY2VzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgICAgICAgIGNvbnN0IHJlc291cmNlc0NTID0gY29sb3JTcGFjZXMuZ2V0KGNzLm5hbWUpOwoKICAgICAgICAgICAgICBpZiAocmVzb3VyY2VzQ1MpIHsKICAgICAgICAgICAgICAgIGlmIChyZXNvdXJjZXNDUyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhcnNlKHJlc291cmNlc0NTLCB4cmVmLCByZXNvdXJjZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY3MgPSByZXNvdXJjZXNDUzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgVW5yZWNvZ25pemVkIENvbG9yU3BhY2U6ICR7Y3MubmFtZX1gKTsKICAgICAgfQogICAgfQoKICAgIGlmIChBcnJheS5pc0FycmF5KGNzKSkgewogICAgICBjb25zdCBtb2RlID0geHJlZi5mZXRjaElmUmVmKGNzWzBdKS5uYW1lOwogICAgICBsZXQgcGFyYW1zLCBudW1Db21wcywgYmFzZUNTLCB3aGl0ZVBvaW50LCBibGFja1BvaW50LCBnYW1tYTsKCiAgICAgIHN3aXRjaCAobW9kZSkgewogICAgICAgIGNhc2UgIkciOgogICAgICAgIGNhc2UgIkRldmljZUdyYXkiOgogICAgICAgICAgcmV0dXJuIHRoaXMuc2luZ2xldG9ucy5ncmF5OwoKICAgICAgICBjYXNlICJSR0IiOgogICAgICAgIGNhc2UgIkRldmljZVJHQiI6CiAgICAgICAgICByZXR1cm4gdGhpcy5zaW5nbGV0b25zLnJnYjsKCiAgICAgICAgY2FzZSAiQ01ZSyI6CiAgICAgICAgY2FzZSAiRGV2aWNlQ01ZSyI6CiAgICAgICAgICByZXR1cm4gdGhpcy5zaW5nbGV0b25zLmNteWs7CgogICAgICAgIGNhc2UgIkNhbEdyYXkiOgogICAgICAgICAgcGFyYW1zID0geHJlZi5mZXRjaElmUmVmKGNzWzFdKTsKICAgICAgICAgIHdoaXRlUG9pbnQgPSBwYXJhbXMuZ2V0QXJyYXkoIldoaXRlUG9pbnQiKTsKICAgICAgICAgIGJsYWNrUG9pbnQgPSBwYXJhbXMuZ2V0QXJyYXkoIkJsYWNrUG9pbnQiKTsKICAgICAgICAgIGdhbW1hID0gcGFyYW1zLmdldCgiR2FtbWEiKTsKICAgICAgICAgIHJldHVybiBuZXcgQ2FsR3JheUNTKHdoaXRlUG9pbnQsIGJsYWNrUG9pbnQsIGdhbW1hKTsKCiAgICAgICAgY2FzZSAiQ2FsUkdCIjoKICAgICAgICAgIHBhcmFtcyA9IHhyZWYuZmV0Y2hJZlJlZihjc1sxXSk7CiAgICAgICAgICB3aGl0ZVBvaW50ID0gcGFyYW1zLmdldEFycmF5KCJXaGl0ZVBvaW50Iik7CiAgICAgICAgICBibGFja1BvaW50ID0gcGFyYW1zLmdldEFycmF5KCJCbGFja1BvaW50Iik7CiAgICAgICAgICBnYW1tYSA9IHBhcmFtcy5nZXRBcnJheSgiR2FtbWEiKTsKICAgICAgICAgIGNvbnN0IG1hdHJpeCA9IHBhcmFtcy5nZXRBcnJheSgiTWF0cml4Iik7CiAgICAgICAgICByZXR1cm4gbmV3IENhbFJHQkNTKHdoaXRlUG9pbnQsIGJsYWNrUG9pbnQsIGdhbW1hLCBtYXRyaXgpOwoKICAgICAgICBjYXNlICJJQ0NCYXNlZCI6CiAgICAgICAgICBjb25zdCBzdHJlYW0gPSB4cmVmLmZldGNoSWZSZWYoY3NbMV0pOwogICAgICAgICAgY29uc3QgZGljdCA9IHN0cmVhbS5kaWN0OwogICAgICAgICAgbnVtQ29tcHMgPSBkaWN0LmdldCgiTiIpOwogICAgICAgICAgY29uc3QgYWx0ID0gZGljdC5nZXQoIkFsdGVybmF0ZSIpOwoKICAgICAgICAgIGlmIChhbHQpIHsKICAgICAgICAgICAgY29uc3QgYWx0Q1MgPSB0aGlzLl9wYXJzZShhbHQsIHhyZWYsIHJlc291cmNlcywgcGRmRnVuY3Rpb25GYWN0b3J5KTsKCiAgICAgICAgICAgIGlmIChhbHRDUy5udW1Db21wcyA9PT0gbnVtQ29tcHMpIHsKICAgICAgICAgICAgICByZXR1cm4gYWx0Q1M7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSUNDQmFzZWQgY29sb3Igc3BhY2U6IElnbm9yaW5nIGluY29ycmVjdCAvQWx0ZXJuYXRlIGVudHJ5LiIpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChudW1Db21wcyA9PT0gMSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5zaW5nbGV0b25zLmdyYXk7CiAgICAgICAgICB9IGVsc2UgaWYgKG51bUNvbXBzID09PSAzKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnNpbmdsZXRvbnMucmdiOwogICAgICAgICAgfSBlbHNlIGlmIChudW1Db21wcyA9PT0gNCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5zaW5nbGV0b25zLmNteWs7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlBhdHRlcm4iOgogICAgICAgICAgYmFzZUNTID0gY3NbMV0gfHwgbnVsbDsKCiAgICAgICAgICBpZiAoYmFzZUNTKSB7CiAgICAgICAgICAgIGJhc2VDUyA9IHRoaXMuX3BhcnNlKGJhc2VDUywgeHJlZiwgcmVzb3VyY2VzLCBwZGZGdW5jdGlvbkZhY3RvcnkpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBuZXcgUGF0dGVybkNTKGJhc2VDUyk7CgogICAgICAgIGNhc2UgIkkiOgogICAgICAgIGNhc2UgIkluZGV4ZWQiOgogICAgICAgICAgYmFzZUNTID0gdGhpcy5fcGFyc2UoY3NbMV0sIHhyZWYsIHJlc291cmNlcywgcGRmRnVuY3Rpb25GYWN0b3J5KTsKICAgICAgICAgIGNvbnN0IGhpVmFsID0geHJlZi5mZXRjaElmUmVmKGNzWzJdKSArIDE7CiAgICAgICAgICBjb25zdCBsb29rdXAgPSB4cmVmLmZldGNoSWZSZWYoY3NbM10pOwogICAgICAgICAgcmV0dXJuIG5ldyBJbmRleGVkQ1MoYmFzZUNTLCBoaVZhbCwgbG9va3VwKTsKCiAgICAgICAgY2FzZSAiU2VwYXJhdGlvbiI6CiAgICAgICAgY2FzZSAiRGV2aWNlTiI6CiAgICAgICAgICBjb25zdCBuYW1lID0geHJlZi5mZXRjaElmUmVmKGNzWzFdKTsKICAgICAgICAgIG51bUNvbXBzID0gQXJyYXkuaXNBcnJheShuYW1lKSA/IG5hbWUubGVuZ3RoIDogMTsKICAgICAgICAgIGJhc2VDUyA9IHRoaXMuX3BhcnNlKGNzWzJdLCB4cmVmLCByZXNvdXJjZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSk7CiAgICAgICAgICBjb25zdCB0aW50Rm4gPSBwZGZGdW5jdGlvbkZhY3RvcnkuY3JlYXRlKGNzWzNdKTsKICAgICAgICAgIHJldHVybiBuZXcgQWx0ZXJuYXRlQ1MobnVtQ29tcHMsIGJhc2VDUywgdGludEZuKTsKCiAgICAgICAgY2FzZSAiTGFiIjoKICAgICAgICAgIHBhcmFtcyA9IHhyZWYuZmV0Y2hJZlJlZihjc1sxXSk7CiAgICAgICAgICB3aGl0ZVBvaW50ID0gcGFyYW1zLmdldEFycmF5KCJXaGl0ZVBvaW50Iik7CiAgICAgICAgICBibGFja1BvaW50ID0gcGFyYW1zLmdldEFycmF5KCJCbGFja1BvaW50Iik7CiAgICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5nZXRBcnJheSgiUmFuZ2UiKTsKICAgICAgICAgIHJldHVybiBuZXcgTGFiQ1Mod2hpdGVQb2ludCwgYmxhY2tQb2ludCwgcmFuZ2UpOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBVbmltcGxlbWVudGVkIENvbG9yU3BhY2Ugb2JqZWN0OiAke21vZGV9YCk7CiAgICAgIH0KICAgIH0KCiAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVucmVjb2duaXplZCBDb2xvclNwYWNlIG9iamVjdDogJHtjc31gKTsKICB9CgogIHN0YXRpYyBpc0RlZmF1bHREZWNvZGUoZGVjb2RlLCBudW1Db21wcykgewogICAgaWYgKCFBcnJheS5pc0FycmF5KGRlY29kZSkpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgaWYgKG51bUNvbXBzICogMiAhPT0gZGVjb2RlLmxlbmd0aCkgewogICAgICAoMCwgX3V0aWwud2FybikoIlRoZSBkZWNvZGUgbWFwIGlzIG5vdCB0aGUgY29ycmVjdCBsZW5ndGgiKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGVjb2RlLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHsKICAgICAgaWYgKGRlY29kZVtpXSAhPT0gMCB8fCBkZWNvZGVbaSArIDFdICE9PSAxKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBzdGF0aWMgZ2V0IHNpbmdsZXRvbnMoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInNpbmdsZXRvbnMiLCB7CiAgICAgIGdldCBncmF5KCkgewogICAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZ3JheSIsIG5ldyBEZXZpY2VHcmF5Q1MoKSk7CiAgICAgIH0sCgogICAgICBnZXQgcmdiKCkgewogICAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAicmdiIiwgbmV3IERldmljZVJnYkNTKCkpOwogICAgICB9LAoKICAgICAgZ2V0IGNteWsoKSB7CiAgICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJjbXlrIiwgbmV3IERldmljZUNteWtDUygpKTsKICAgICAgfQoKICAgIH0pOwogIH0KCn0KCmV4cG9ydHMuQ29sb3JTcGFjZSA9IENvbG9yU3BhY2U7CgpjbGFzcyBBbHRlcm5hdGVDUyBleHRlbmRzIENvbG9yU3BhY2UgewogIGNvbnN0cnVjdG9yKG51bUNvbXBzLCBiYXNlLCB0aW50Rm4pIHsKICAgIHN1cGVyKCJBbHRlcm5hdGUiLCBudW1Db21wcyk7CiAgICB0aGlzLmJhc2UgPSBiYXNlOwogICAgdGhpcy50aW50Rm4gPSB0aW50Rm47CiAgICB0aGlzLnRtcEJ1ZiA9IG5ldyBGbG9hdDMyQXJyYXkoYmFzZS5udW1Db21wcyk7CiAgfQoKICBnZXRSZ2JJdGVtKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICBjb25zdCB0bXBCdWYgPSB0aGlzLnRtcEJ1ZjsKICAgIHRoaXMudGludEZuKHNyYywgc3JjT2Zmc2V0LCB0bXBCdWYsIDApOwogICAgdGhpcy5iYXNlLmdldFJnYkl0ZW0odG1wQnVmLCAwLCBkZXN0LCBkZXN0T2Zmc2V0KTsKICB9CgogIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgIGNvbnN0IHRpbnRGbiA9IHRoaXMudGludEZuOwogICAgY29uc3QgYmFzZSA9IHRoaXMuYmFzZTsKICAgIGNvbnN0IHNjYWxlID0gMSAvICgoMSA8PCBiaXRzKSAtIDEpOwogICAgY29uc3QgYmFzZU51bUNvbXBzID0gYmFzZS5udW1Db21wczsKICAgIGNvbnN0IHVzZXNaZXJvVG9PbmVSYW5nZSA9IGJhc2UudXNlc1plcm9Ub09uZVJhbmdlOwogICAgY29uc3QgaXNQYXNzdGhyb3VnaCA9IChiYXNlLmlzUGFzc3Rocm91Z2goOCkgfHwgIXVzZXNaZXJvVG9PbmVSYW5nZSkgJiYgYWxwaGEwMSA9PT0gMDsKICAgIGxldCBwb3MgPSBpc1Bhc3N0aHJvdWdoID8gZGVzdE9mZnNldCA6IDA7CiAgICBjb25zdCBiYXNlQnVmID0gaXNQYXNzdGhyb3VnaCA/IGRlc3QgOiBuZXcgVWludDhDbGFtcGVkQXJyYXkoYmFzZU51bUNvbXBzICogY291bnQpOwogICAgY29uc3QgbnVtQ29tcHMgPSB0aGlzLm51bUNvbXBzOwogICAgY29uc3Qgc2NhbGVkID0gbmV3IEZsb2F0MzJBcnJheShudW1Db21wcyk7CiAgICBjb25zdCB0aW50ZWQgPSBuZXcgRmxvYXQzMkFycmF5KGJhc2VOdW1Db21wcyk7CiAgICBsZXQgaSwgajsKCiAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICBmb3IgKGogPSAwOyBqIDwgbnVtQ29tcHM7IGorKykgewogICAgICAgIHNjYWxlZFtqXSA9IHNyY1tzcmNPZmZzZXQrK10gKiBzY2FsZTsKICAgICAgfQoKICAgICAgdGludEZuKHNjYWxlZCwgMCwgdGludGVkLCAwKTsKCiAgICAgIGlmICh1c2VzWmVyb1RvT25lUmFuZ2UpIHsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgYmFzZU51bUNvbXBzOyBqKyspIHsKICAgICAgICAgIGJhc2VCdWZbcG9zKytdID0gdGludGVkW2pdICogMjU1OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBiYXNlLmdldFJnYkl0ZW0odGludGVkLCAwLCBiYXNlQnVmLCBwb3MpOwogICAgICAgIHBvcyArPSBiYXNlTnVtQ29tcHM7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIWlzUGFzc3Rocm91Z2gpIHsKICAgICAgYmFzZS5nZXRSZ2JCdWZmZXIoYmFzZUJ1ZiwgMCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIDgsIGFscGhhMDEpOwogICAgfQogIH0KCiAgZ2V0T3V0cHV0TGVuZ3RoKGlucHV0TGVuZ3RoLCBhbHBoYTAxKSB7CiAgICByZXR1cm4gdGhpcy5iYXNlLmdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCAqIHRoaXMuYmFzZS5udW1Db21wcyAvIHRoaXMubnVtQ29tcHMsIGFscGhhMDEpOwogIH0KCn0KCmNsYXNzIFBhdHRlcm5DUyBleHRlbmRzIENvbG9yU3BhY2UgewogIGNvbnN0cnVjdG9yKGJhc2VDUykgewogICAgc3VwZXIoIlBhdHRlcm4iLCBudWxsKTsKICAgIHRoaXMuYmFzZSA9IGJhc2VDUzsKICB9CgogIGlzRGVmYXVsdERlY29kZShkZWNvZGVNYXAsIGJwYykgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiU2hvdWxkIG5vdCBjYWxsIFBhdHRlcm5DUy5pc0RlZmF1bHREZWNvZGUiKTsKICB9Cgp9CgpjbGFzcyBJbmRleGVkQ1MgZXh0ZW5kcyBDb2xvclNwYWNlIHsKICBjb25zdHJ1Y3RvcihiYXNlLCBoaWdoVmFsLCBsb29rdXApIHsKICAgIHN1cGVyKCJJbmRleGVkIiwgMSk7CiAgICB0aGlzLmJhc2UgPSBiYXNlOwogICAgdGhpcy5oaWdoVmFsID0gaGlnaFZhbDsKICAgIGNvbnN0IGxlbmd0aCA9IGJhc2UubnVtQ29tcHMgKiBoaWdoVmFsOwogICAgdGhpcy5sb29rdXAgPSBuZXcgVWludDhBcnJheShsZW5ndGgpOwoKICAgIGlmIChsb29rdXAgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICBjb25zdCBieXRlcyA9IGxvb2t1cC5nZXRCeXRlcyhsZW5ndGgpOwogICAgICB0aGlzLmxvb2t1cC5zZXQoYnl0ZXMpOwogICAgfSBlbHNlIGlmICh0eXBlb2YgbG9va3VwID09PSAic3RyaW5nIikgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgICAgdGhpcy5sb29rdXBbaV0gPSBsb29rdXAuY2hhckNvZGVBdChpKSAmIDB4ZmY7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW5kZXhlZENTIC0gdW5yZWNvZ25pemVkIGxvb2t1cCB0YWJsZTogJHtsb29rdXB9YCk7CiAgICB9CiAgfQoKICBnZXRSZ2JJdGVtKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICBjb25zdCBudW1Db21wcyA9IHRoaXMuYmFzZS5udW1Db21wczsKICAgIGNvbnN0IHN0YXJ0ID0gc3JjW3NyY09mZnNldF0gKiBudW1Db21wczsKICAgIHRoaXMuYmFzZS5nZXRSZ2JCdWZmZXIodGhpcy5sb29rdXAsIHN0YXJ0LCAxLCBkZXN0LCBkZXN0T2Zmc2V0LCA4LCAwKTsKICB9CgogIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgIGNvbnN0IGJhc2UgPSB0aGlzLmJhc2U7CiAgICBjb25zdCBudW1Db21wcyA9IGJhc2UubnVtQ29tcHM7CiAgICBjb25zdCBvdXRwdXREZWx0YSA9IGJhc2UuZ2V0T3V0cHV0TGVuZ3RoKG51bUNvbXBzLCBhbHBoYTAxKTsKICAgIGNvbnN0IGxvb2t1cCA9IHRoaXMubG9va3VwOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewogICAgICBjb25zdCBsb29rdXBQb3MgPSBzcmNbc3JjT2Zmc2V0KytdICogbnVtQ29tcHM7CiAgICAgIGJhc2UuZ2V0UmdiQnVmZmVyKGxvb2t1cCwgbG9va3VwUG9zLCAxLCBkZXN0LCBkZXN0T2Zmc2V0LCA4LCBhbHBoYTAxKTsKICAgICAgZGVzdE9mZnNldCArPSBvdXRwdXREZWx0YTsKICAgIH0KICB9CgogIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCwgYWxwaGEwMSkgewogICAgcmV0dXJuIHRoaXMuYmFzZS5nZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGggKiB0aGlzLmJhc2UubnVtQ29tcHMsIGFscGhhMDEpOwogIH0KCiAgaXNEZWZhdWx0RGVjb2RlKGRlY29kZU1hcCwgYnBjKSB7CiAgICBpZiAoIUFycmF5LmlzQXJyYXkoZGVjb2RlTWFwKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBpZiAoZGVjb2RlTWFwLmxlbmd0aCAhPT0gMikgewogICAgICAoMCwgX3V0aWwud2FybikoIkRlY29kZSBtYXAgbGVuZ3RoIGlzIG5vdCBjb3JyZWN0Iik7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihicGMpIHx8IGJwYyA8IDEpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJCaXRzIHBlciBjb21wb25lbnQgaXMgbm90IGNvcnJlY3QiKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGRlY29kZU1hcFswXSA9PT0gMCAmJiBkZWNvZGVNYXBbMV0gPT09ICgxIDw8IGJwYykgLSAxOwogIH0KCn0KCmNsYXNzIERldmljZUdyYXlDUyBleHRlbmRzIENvbG9yU3BhY2UgewogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoIkRldmljZUdyYXkiLCAxKTsKICB9CgogIGdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgIGNvbnN0IGMgPSBzcmNbc3JjT2Zmc2V0XSAqIDI1NTsKICAgIGRlc3RbZGVzdE9mZnNldF0gPSBkZXN0W2Rlc3RPZmZzZXQgKyAxXSA9IGRlc3RbZGVzdE9mZnNldCArIDJdID0gYzsKICB9CgogIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgIGNvbnN0IHNjYWxlID0gMjU1IC8gKCgxIDw8IGJpdHMpIC0gMSk7CiAgICBsZXQgaiA9IHNyY09mZnNldCwKICAgICAgICBxID0gZGVzdE9mZnNldDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyArK2kpIHsKICAgICAgY29uc3QgYyA9IHNjYWxlICogc3JjW2orK107CiAgICAgIGRlc3RbcSsrXSA9IGM7CiAgICAgIGRlc3RbcSsrXSA9IGM7CiAgICAgIGRlc3RbcSsrXSA9IGM7CiAgICAgIHEgKz0gYWxwaGEwMTsKICAgIH0KICB9CgogIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCwgYWxwaGEwMSkgewogICAgcmV0dXJuIGlucHV0TGVuZ3RoICogKDMgKyBhbHBoYTAxKTsKICB9Cgp9CgpjbGFzcyBEZXZpY2VSZ2JDUyBleHRlbmRzIENvbG9yU3BhY2UgewogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoIkRldmljZVJHQiIsIDMpOwogIH0KCiAgZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgZGVzdFtkZXN0T2Zmc2V0XSA9IHNyY1tzcmNPZmZzZXRdICogMjU1OwogICAgZGVzdFtkZXN0T2Zmc2V0ICsgMV0gPSBzcmNbc3JjT2Zmc2V0ICsgMV0gKiAyNTU7CiAgICBkZXN0W2Rlc3RPZmZzZXQgKyAyXSA9IHNyY1tzcmNPZmZzZXQgKyAyXSAqIDI1NTsKICB9CgogIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgIGlmIChiaXRzID09PSA4ICYmIGFscGhhMDEgPT09IDApIHsKICAgICAgZGVzdC5zZXQoc3JjLnN1YmFycmF5KHNyY09mZnNldCwgc3JjT2Zmc2V0ICsgY291bnQgKiAzKSwgZGVzdE9mZnNldCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBzY2FsZSA9IDI1NSAvICgoMSA8PCBiaXRzKSAtIDEpOwogICAgbGV0IGogPSBzcmNPZmZzZXQsCiAgICAgICAgcSA9IGRlc3RPZmZzZXQ7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7CiAgICAgIGRlc3RbcSsrXSA9IHNjYWxlICogc3JjW2orK107CiAgICAgIGRlc3RbcSsrXSA9IHNjYWxlICogc3JjW2orK107CiAgICAgIGRlc3RbcSsrXSA9IHNjYWxlICogc3JjW2orK107CiAgICAgIHEgKz0gYWxwaGEwMTsKICAgIH0KICB9CgogIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCwgYWxwaGEwMSkgewogICAgcmV0dXJuIGlucHV0TGVuZ3RoICogKDMgKyBhbHBoYTAxKSAvIDMgfCAwOwogIH0KCiAgaXNQYXNzdGhyb3VnaChiaXRzKSB7CiAgICByZXR1cm4gYml0cyA9PT0gODsKICB9Cgp9Cgpjb25zdCBEZXZpY2VDbXlrQ1MgPSBmdW5jdGlvbiBEZXZpY2VDbXlrQ1NDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGNvbnZlcnRUb1JnYihzcmMsIHNyY09mZnNldCwgc3JjU2NhbGUsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgIGNvbnN0IGMgPSBzcmNbc3JjT2Zmc2V0XSAqIHNyY1NjYWxlOwogICAgY29uc3QgbSA9IHNyY1tzcmNPZmZzZXQgKyAxXSAqIHNyY1NjYWxlOwogICAgY29uc3QgeSA9IHNyY1tzcmNPZmZzZXQgKyAyXSAqIHNyY1NjYWxlOwogICAgY29uc3QgayA9IHNyY1tzcmNPZmZzZXQgKyAzXSAqIHNyY1NjYWxlOwogICAgZGVzdFtkZXN0T2Zmc2V0XSA9IDI1NSArIGMgKiAoLTQuMzg3MzMyMzg0NjA5OTg4ICogYyArIDU0LjQ4NjE1MTk0MTg5MTc2ICogbSArIDE4LjgyMjkwNTAyMTY1MzAyICogeSArIDIxMi4yNTY2MjQ1MTYzOTU4NSAqIGsgKyAtMjg1LjIzMzEwMjYxMzcwMDQpICsgbSAqICgxLjcxNDk3NjM0NzczNjIxMzQgKiBtIC0gNS42MDk2NzM2OTA0MDQ3MzE1ICogeSArIC0xNy44NzM4NzA4NjE0MTU0NDQgKiBrIC0gNS40OTcwMDY0MjcxOTYzNjYpICsgeSAqICgtMi41MjE3MzQwMTMxNjgzMDMzICogeSAtIDIxLjI0ODkyMzMzNzM1MzA3MyAqIGsgKyAxNy41MTE5MjcwODQxODEzKSArIGsgKiAoLTIxLjg2MTIyMTQ3NDYzNjA1ICogayAtIDE4OS40ODE4MDgzNTkyMjc0Nyk7CiAgICBkZXN0W2Rlc3RPZmZzZXQgKyAxXSA9IDI1NSArIGMgKiAoOC44NDEwNDE0MjIwMzYxNDkgKiBjICsgNjAuMTE4MDI3MDQ1NTk3MzY2ICogbSArIDYuODcxNDI1NTkyMDQ5MDA3ICogeSArIDMxLjE1OTEwMDEzMDA1NTkyMiAqIGsgKyAtNzkuMjk3MDg0NDgxNjU0OCkgKyBtICogKC0xNS4zMTAzNjEzMDY5Njc4MTcgKiBtICsgMTcuNTc1MjUxMjYxMTA5NDgyICogeSArIDEzMS4zNTI1MDkxMjQ5Mzk3NiAqIGsgLSAxOTAuOTQ1MzMwMjU4ODk1MSkgKyB5ICogKDQuNDQ0MzM5MTAyODUyNzM5ICogeSArIDkuODYzMjg2MTQ5MzQwNSAqIGsgLSAyNC44Njc0MTU4MjU1NTg3OCkgKyBrICogKC0yMC43MzczMjU0NzExODEwMzQgKiBrIC0gMTg3LjgwNDUzNzA5NzE5NTc4KTsKICAgIGRlc3RbZGVzdE9mZnNldCArIDJdID0gMjU1ICsgYyAqICgwLjg4NDI1MjI0MzAwMDMyOTYgKiBjICsgOC4wNzg2Nzc1MDMxMTI5MjggKiBtICsgMzAuODk5NzgzMDk3MDM3MjkgKiB5IC0gMC4yMzg4MzIzODY4OTE3ODkzNCAqIGsgKyAtMTQuMTgzNTc2Nzk5NjczMjg2KSArIG0gKiAoMTAuNDk1OTMyNzM0MzIwNzIgKiBtICsgNjMuMDIzNzg0OTQ3NTQwNTIgKiB5ICsgNTAuNjA2OTU3NjU2MzYwNzM0ICogayAtIDExMi4yMzg4NDI1MzcxOTI0OCkgKyB5ICogKDAuMDMyOTYwNDExMTQ4NzMyMTcgKiB5ICsgMTE1LjYwMzg0NDQ5NjQ2NjQxICogayArIC0xOTMuNTgyMDkzNTY4NjE1MDUpICsgayAqICgtMjIuMzM4MTY4MDczMDk4ODYgKiBrIC0gMTgwLjEyNjEzOTc0NzA4MzY3KTsKICB9CgogIGNsYXNzIERldmljZUNteWtDUyBleHRlbmRzIENvbG9yU3BhY2UgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKCJEZXZpY2VDTVlLIiwgNCk7CiAgICB9CgogICAgZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgICBjb252ZXJ0VG9SZ2Ioc3JjLCBzcmNPZmZzZXQsIDEsIGRlc3QsIGRlc3RPZmZzZXQpOwogICAgfQoKICAgIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgICAgY29uc3Qgc2NhbGUgPSAxIC8gKCgxIDw8IGJpdHMpIC0gMSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb252ZXJ0VG9SZ2Ioc3JjLCBzcmNPZmZzZXQsIHNjYWxlLCBkZXN0LCBkZXN0T2Zmc2V0KTsKICAgICAgICBzcmNPZmZzZXQgKz0gNDsKICAgICAgICBkZXN0T2Zmc2V0ICs9IDMgKyBhbHBoYTAxOwogICAgICB9CiAgICB9CgogICAgZ2V0T3V0cHV0TGVuZ3RoKGlucHV0TGVuZ3RoLCBhbHBoYTAxKSB7CiAgICAgIHJldHVybiBpbnB1dExlbmd0aCAvIDQgKiAoMyArIGFscGhhMDEpIHwgMDsKICAgIH0KCiAgfQoKICByZXR1cm4gRGV2aWNlQ215a0NTOwp9KCk7Cgpjb25zdCBDYWxHcmF5Q1MgPSBmdW5jdGlvbiBDYWxHcmF5Q1NDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGNvbnZlcnRUb1JnYihjcywgc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQsIHNjYWxlKSB7CiAgICBjb25zdCBBID0gc3JjW3NyY09mZnNldF0gKiBzY2FsZTsKICAgIGNvbnN0IEFHID0gQSAqKiBjcy5HOwogICAgY29uc3QgTCA9IGNzLllXICogQUc7CiAgICBjb25zdCB2YWwgPSBNYXRoLm1heCgyOTUuOCAqIEwgKiogMC4zMzMzMzMzMzMzMzMzMzMzIC0gNDAuOCwgMCk7CiAgICBkZXN0W2Rlc3RPZmZzZXRdID0gdmFsOwogICAgZGVzdFtkZXN0T2Zmc2V0ICsgMV0gPSB2YWw7CiAgICBkZXN0W2Rlc3RPZmZzZXQgKyAyXSA9IHZhbDsKICB9CgogIGNsYXNzIENhbEdyYXlDUyBleHRlbmRzIENvbG9yU3BhY2UgewogICAgY29uc3RydWN0b3Iod2hpdGVQb2ludCwgYmxhY2tQb2ludCwgZ2FtbWEpIHsKICAgICAgc3VwZXIoIkNhbEdyYXkiLCAxKTsKCiAgICAgIGlmICghd2hpdGVQb2ludCkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiV2hpdGVQb2ludCBtaXNzaW5nIC0gcmVxdWlyZWQgZm9yIGNvbG9yIHNwYWNlIENhbEdyYXkiKTsKICAgICAgfQoKICAgICAgYmxhY2tQb2ludCA9IGJsYWNrUG9pbnQgfHwgWzAsIDAsIDBdOwogICAgICBnYW1tYSA9IGdhbW1hIHx8IDE7CiAgICAgIHRoaXMuWFcgPSB3aGl0ZVBvaW50WzBdOwogICAgICB0aGlzLllXID0gd2hpdGVQb2ludFsxXTsKICAgICAgdGhpcy5aVyA9IHdoaXRlUG9pbnRbMl07CiAgICAgIHRoaXMuWEIgPSBibGFja1BvaW50WzBdOwogICAgICB0aGlzLllCID0gYmxhY2tQb2ludFsxXTsKICAgICAgdGhpcy5aQiA9IGJsYWNrUG9pbnRbMl07CiAgICAgIHRoaXMuRyA9IGdhbW1hOwoKICAgICAgaWYgKHRoaXMuWFcgPCAwIHx8IHRoaXMuWlcgPCAwIHx8IHRoaXMuWVcgIT09IDEpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgV2hpdGVQb2ludCBjb21wb25lbnRzIGZvciAke3RoaXMubmFtZX1gICsgIiwgbm8gZmFsbGJhY2sgYXZhaWxhYmxlIik7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLlhCIDwgMCB8fCB0aGlzLllCIDwgMCB8fCB0aGlzLlpCIDwgMCkgewogICAgICAgICgwLCBfdXRpbC5pbmZvKShgSW52YWxpZCBCbGFja1BvaW50IGZvciAke3RoaXMubmFtZX0sIGZhbGxpbmcgYmFjayB0byBkZWZhdWx0LmApOwogICAgICAgIHRoaXMuWEIgPSB0aGlzLllCID0gdGhpcy5aQiA9IDA7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLlhCICE9PSAwIHx8IHRoaXMuWUIgIT09IDAgfHwgdGhpcy5aQiAhPT0gMCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgJHt0aGlzLm5hbWV9LCBCbGFja1BvaW50OiBYQjogJHt0aGlzLlhCfSwgWUI6ICR7dGhpcy5ZQn0sIGAgKyBgWkI6ICR7dGhpcy5aQn0sIG9ubHkgZGVmYXVsdCB2YWx1ZXMgYXJlIHN1cHBvcnRlZC5gKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuRyA8IDEpIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoYEludmFsaWQgR2FtbWE6ICR7dGhpcy5HfSBmb3IgJHt0aGlzLm5hbWV9LCBgICsgImZhbGxpbmcgYmFjayB0byBkZWZhdWx0LiIpOwogICAgICAgIHRoaXMuRyA9IDE7CiAgICAgIH0KICAgIH0KCiAgICBnZXRSZ2JJdGVtKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgIGNvbnZlcnRUb1JnYih0aGlzLCBzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCwgMSk7CiAgICB9CgogICAgZ2V0UmdiQnVmZmVyKHNyYywgc3JjT2Zmc2V0LCBjb3VudCwgZGVzdCwgZGVzdE9mZnNldCwgYml0cywgYWxwaGEwMSkgewogICAgICBjb25zdCBzY2FsZSA9IDEgLyAoKDEgPDwgYml0cykgLSAxKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewogICAgICAgIGNvbnZlcnRUb1JnYih0aGlzLCBzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCwgc2NhbGUpOwogICAgICAgIHNyY09mZnNldCArPSAxOwogICAgICAgIGRlc3RPZmZzZXQgKz0gMyArIGFscGhhMDE7CiAgICAgIH0KICAgIH0KCiAgICBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgICAgcmV0dXJuIGlucHV0TGVuZ3RoICogKDMgKyBhbHBoYTAxKTsKICAgIH0KCiAgfQoKICByZXR1cm4gQ2FsR3JheUNTOwp9KCk7Cgpjb25zdCBDYWxSR0JDUyA9IGZ1bmN0aW9uIENhbFJHQkNTQ2xvc3VyZSgpIHsKICBjb25zdCBCUkFERk9SRF9TQ0FMRV9NQVRSSVggPSBuZXcgRmxvYXQzMkFycmF5KFswLjg5NTEsIDAuMjY2NCwgLTAuMTYxNCwgLTAuNzUwMiwgMS43MTM1LCAwLjAzNjcsIDAuMDM4OSwgLTAuMDY4NSwgMS4wMjk2XSk7CiAgY29uc3QgQlJBREZPUkRfU0NBTEVfSU5WRVJTRV9NQVRSSVggPSBuZXcgRmxvYXQzMkFycmF5KFswLjk4Njk5MjksIC0wLjE0NzA1NDMsIDAuMTU5OTYyNywgMC40MzIzMDUzLCAwLjUxODM2MDMsIDAuMDQ5MjkxMiwgLTAuMDA4NTI4NywgMC4wNDAwNDI4LCAwLjk2ODQ4NjddKTsKICBjb25zdCBTUkdCX0Q2NV9YWVpfVE9fUkdCX01BVFJJWCA9IG5ldyBGbG9hdDMyQXJyYXkoWzMuMjQwNDU0MiwgLTEuNTM3MTM4NSwgLTAuNDk4NTMxNCwgLTAuOTY5MjY2MCwgMS44NzYwMTA4LCAwLjA0MTU1NjAsIDAuMDU1NjQzNCwgLTAuMjA0MDI1OSwgMS4wNTcyMjUyXSk7CiAgY29uc3QgRkxBVF9XSElURVBPSU5UX01BVFJJWCA9IG5ldyBGbG9hdDMyQXJyYXkoWzEsIDEsIDFdKTsKICBjb25zdCB0ZW1wTm9ybWFsaXplTWF0cml4ID0gbmV3IEZsb2F0MzJBcnJheSgzKTsKICBjb25zdCB0ZW1wQ29udmVydE1hdHJpeDEgPSBuZXcgRmxvYXQzMkFycmF5KDMpOwogIGNvbnN0IHRlbXBDb252ZXJ0TWF0cml4MiA9IG5ldyBGbG9hdDMyQXJyYXkoMyk7CiAgY29uc3QgREVDT0RFX0xfQ09OU1RBTlQgPSAoKDggKyAxNikgLyAxMTYpICoqIDMgLyA4LjA7CgogIGZ1bmN0aW9uIG1hdHJpeFByb2R1Y3QoYSwgYiwgcmVzdWx0KSB7CiAgICByZXN1bHRbMF0gPSBhWzBdICogYlswXSArIGFbMV0gKiBiWzFdICsgYVsyXSAqIGJbMl07CiAgICByZXN1bHRbMV0gPSBhWzNdICogYlswXSArIGFbNF0gKiBiWzFdICsgYVs1XSAqIGJbMl07CiAgICByZXN1bHRbMl0gPSBhWzZdICogYlswXSArIGFbN10gKiBiWzFdICsgYVs4XSAqIGJbMl07CiAgfQoKICBmdW5jdGlvbiBjb252ZXJ0VG9GbGF0KHNvdXJjZVdoaXRlUG9pbnQsIExNUywgcmVzdWx0KSB7CiAgICByZXN1bHRbMF0gPSBMTVNbMF0gKiAxIC8gc291cmNlV2hpdGVQb2ludFswXTsKICAgIHJlc3VsdFsxXSA9IExNU1sxXSAqIDEgLyBzb3VyY2VXaGl0ZVBvaW50WzFdOwogICAgcmVzdWx0WzJdID0gTE1TWzJdICogMSAvIHNvdXJjZVdoaXRlUG9pbnRbMl07CiAgfQoKICBmdW5jdGlvbiBjb252ZXJ0VG9ENjUoc291cmNlV2hpdGVQb2ludCwgTE1TLCByZXN1bHQpIHsKICAgIGNvbnN0IEQ2NVggPSAwLjk1MDQ3OwogICAgY29uc3QgRDY1WSA9IDE7CiAgICBjb25zdCBENjVaID0gMS4wODg4MzsKICAgIHJlc3VsdFswXSA9IExNU1swXSAqIEQ2NVggLyBzb3VyY2VXaGl0ZVBvaW50WzBdOwogICAgcmVzdWx0WzFdID0gTE1TWzFdICogRDY1WSAvIHNvdXJjZVdoaXRlUG9pbnRbMV07CiAgICByZXN1bHRbMl0gPSBMTVNbMl0gKiBENjVaIC8gc291cmNlV2hpdGVQb2ludFsyXTsKICB9CgogIGZ1bmN0aW9uIHNSR0JUcmFuc2ZlckZ1bmN0aW9uKGNvbG9yKSB7CiAgICBpZiAoY29sb3IgPD0gMC4wMDMxMzA4KSB7CiAgICAgIHJldHVybiBhZGp1c3RUb1JhbmdlKDAsIDEsIDEyLjkyICogY29sb3IpOwogICAgfQoKICAgIGlmIChjb2xvciA+PSAwLjk5NTU0NTI1KSB7CiAgICAgIHJldHVybiAxOwogICAgfQoKICAgIHJldHVybiBhZGp1c3RUb1JhbmdlKDAsIDEsICgxICsgMC4wNTUpICogY29sb3IgKiogKDEgLyAyLjQpIC0gMC4wNTUpOwogIH0KCiAgZnVuY3Rpb24gYWRqdXN0VG9SYW5nZShtaW4sIG1heCwgdmFsdWUpIHsKICAgIHJldHVybiBNYXRoLm1heChtaW4sIE1hdGgubWluKG1heCwgdmFsdWUpKTsKICB9CgogIGZ1bmN0aW9uIGRlY29kZUwoTCkgewogICAgaWYgKEwgPCAwKSB7CiAgICAgIHJldHVybiAtZGVjb2RlTCgtTCk7CiAgICB9CgogICAgaWYgKEwgPiA4LjApIHsKICAgICAgcmV0dXJuICgoTCArIDE2KSAvIDExNikgKiogMzsKICAgIH0KCiAgICByZXR1cm4gTCAqIERFQ09ERV9MX0NPTlNUQU5UOwogIH0KCiAgZnVuY3Rpb24gY29tcGVuc2F0ZUJsYWNrUG9pbnQoc291cmNlQmxhY2tQb2ludCwgWFlaX0ZsYXQsIHJlc3VsdCkgewogICAgaWYgKHNvdXJjZUJsYWNrUG9pbnRbMF0gPT09IDAgJiYgc291cmNlQmxhY2tQb2ludFsxXSA9PT0gMCAmJiBzb3VyY2VCbGFja1BvaW50WzJdID09PSAwKSB7CiAgICAgIHJlc3VsdFswXSA9IFhZWl9GbGF0WzBdOwogICAgICByZXN1bHRbMV0gPSBYWVpfRmxhdFsxXTsKICAgICAgcmVzdWx0WzJdID0gWFlaX0ZsYXRbMl07CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCB6ZXJvRGVjb2RlTCA9IGRlY29kZUwoMCk7CiAgICBjb25zdCBYX0RTVCA9IHplcm9EZWNvZGVMOwogICAgY29uc3QgWF9TUkMgPSBkZWNvZGVMKHNvdXJjZUJsYWNrUG9pbnRbMF0pOwogICAgY29uc3QgWV9EU1QgPSB6ZXJvRGVjb2RlTDsKICAgIGNvbnN0IFlfU1JDID0gZGVjb2RlTChzb3VyY2VCbGFja1BvaW50WzFdKTsKICAgIGNvbnN0IFpfRFNUID0gemVyb0RlY29kZUw7CiAgICBjb25zdCBaX1NSQyA9IGRlY29kZUwoc291cmNlQmxhY2tQb2ludFsyXSk7CiAgICBjb25zdCBYX1NjYWxlID0gKDEgLSBYX0RTVCkgLyAoMSAtIFhfU1JDKTsKICAgIGNvbnN0IFhfT2Zmc2V0ID0gMSAtIFhfU2NhbGU7CiAgICBjb25zdCBZX1NjYWxlID0gKDEgLSBZX0RTVCkgLyAoMSAtIFlfU1JDKTsKICAgIGNvbnN0IFlfT2Zmc2V0ID0gMSAtIFlfU2NhbGU7CiAgICBjb25zdCBaX1NjYWxlID0gKDEgLSBaX0RTVCkgLyAoMSAtIFpfU1JDKTsKICAgIGNvbnN0IFpfT2Zmc2V0ID0gMSAtIFpfU2NhbGU7CiAgICByZXN1bHRbMF0gPSBYWVpfRmxhdFswXSAqIFhfU2NhbGUgKyBYX09mZnNldDsKICAgIHJlc3VsdFsxXSA9IFhZWl9GbGF0WzFdICogWV9TY2FsZSArIFlfT2Zmc2V0OwogICAgcmVzdWx0WzJdID0gWFlaX0ZsYXRbMl0gKiBaX1NjYWxlICsgWl9PZmZzZXQ7CiAgfQoKICBmdW5jdGlvbiBub3JtYWxpemVXaGl0ZVBvaW50VG9GbGF0KHNvdXJjZVdoaXRlUG9pbnQsIFhZWl9JbiwgcmVzdWx0KSB7CiAgICBpZiAoc291cmNlV2hpdGVQb2ludFswXSA9PT0gMSAmJiBzb3VyY2VXaGl0ZVBvaW50WzJdID09PSAxKSB7CiAgICAgIHJlc3VsdFswXSA9IFhZWl9JblswXTsKICAgICAgcmVzdWx0WzFdID0gWFlaX0luWzFdOwogICAgICByZXN1bHRbMl0gPSBYWVpfSW5bMl07CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBMTVMgPSByZXN1bHQ7CiAgICBtYXRyaXhQcm9kdWN0KEJSQURGT1JEX1NDQUxFX01BVFJJWCwgWFlaX0luLCBMTVMpOwogICAgY29uc3QgTE1TX0ZsYXQgPSB0ZW1wTm9ybWFsaXplTWF0cml4OwogICAgY29udmVydFRvRmxhdChzb3VyY2VXaGl0ZVBvaW50LCBMTVMsIExNU19GbGF0KTsKICAgIG1hdHJpeFByb2R1Y3QoQlJBREZPUkRfU0NBTEVfSU5WRVJTRV9NQVRSSVgsIExNU19GbGF0LCByZXN1bHQpOwogIH0KCiAgZnVuY3Rpb24gbm9ybWFsaXplV2hpdGVQb2ludFRvRDY1KHNvdXJjZVdoaXRlUG9pbnQsIFhZWl9JbiwgcmVzdWx0KSB7CiAgICBjb25zdCBMTVMgPSByZXN1bHQ7CiAgICBtYXRyaXhQcm9kdWN0KEJSQURGT1JEX1NDQUxFX01BVFJJWCwgWFlaX0luLCBMTVMpOwogICAgY29uc3QgTE1TX0Q2NSA9IHRlbXBOb3JtYWxpemVNYXRyaXg7CiAgICBjb252ZXJ0VG9ENjUoc291cmNlV2hpdGVQb2ludCwgTE1TLCBMTVNfRDY1KTsKICAgIG1hdHJpeFByb2R1Y3QoQlJBREZPUkRfU0NBTEVfSU5WRVJTRV9NQVRSSVgsIExNU19ENjUsIHJlc3VsdCk7CiAgfQoKICBmdW5jdGlvbiBjb252ZXJ0VG9SZ2IoY3MsIHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0LCBzY2FsZSkgewogICAgY29uc3QgQSA9IGFkanVzdFRvUmFuZ2UoMCwgMSwgc3JjW3NyY09mZnNldF0gKiBzY2FsZSk7CiAgICBjb25zdCBCID0gYWRqdXN0VG9SYW5nZSgwLCAxLCBzcmNbc3JjT2Zmc2V0ICsgMV0gKiBzY2FsZSk7CiAgICBjb25zdCBDID0gYWRqdXN0VG9SYW5nZSgwLCAxLCBzcmNbc3JjT2Zmc2V0ICsgMl0gKiBzY2FsZSk7CiAgICBjb25zdCBBR1IgPSBBID09PSAxID8gMSA6IEEgKiogY3MuR1I7CiAgICBjb25zdCBCR0cgPSBCID09PSAxID8gMSA6IEIgKiogY3MuR0c7CiAgICBjb25zdCBDR0IgPSBDID09PSAxID8gMSA6IEMgKiogY3MuR0I7CiAgICBjb25zdCBYID0gY3MuTVhBICogQUdSICsgY3MuTVhCICogQkdHICsgY3MuTVhDICogQ0dCOwogICAgY29uc3QgWSA9IGNzLk1ZQSAqIEFHUiArIGNzLk1ZQiAqIEJHRyArIGNzLk1ZQyAqIENHQjsKICAgIGNvbnN0IFogPSBjcy5NWkEgKiBBR1IgKyBjcy5NWkIgKiBCR0cgKyBjcy5NWkMgKiBDR0I7CiAgICBjb25zdCBYWVogPSB0ZW1wQ29udmVydE1hdHJpeDE7CiAgICBYWVpbMF0gPSBYOwogICAgWFlaWzFdID0gWTsKICAgIFhZWlsyXSA9IFo7CiAgICBjb25zdCBYWVpfRmxhdCA9IHRlbXBDb252ZXJ0TWF0cml4MjsKICAgIG5vcm1hbGl6ZVdoaXRlUG9pbnRUb0ZsYXQoY3Mud2hpdGVQb2ludCwgWFlaLCBYWVpfRmxhdCk7CiAgICBjb25zdCBYWVpfQmxhY2sgPSB0ZW1wQ29udmVydE1hdHJpeDE7CiAgICBjb21wZW5zYXRlQmxhY2tQb2ludChjcy5ibGFja1BvaW50LCBYWVpfRmxhdCwgWFlaX0JsYWNrKTsKICAgIGNvbnN0IFhZWl9ENjUgPSB0ZW1wQ29udmVydE1hdHJpeDI7CiAgICBub3JtYWxpemVXaGl0ZVBvaW50VG9ENjUoRkxBVF9XSElURVBPSU5UX01BVFJJWCwgWFlaX0JsYWNrLCBYWVpfRDY1KTsKICAgIGNvbnN0IFNSR0IgPSB0ZW1wQ29udmVydE1hdHJpeDE7CiAgICBtYXRyaXhQcm9kdWN0KFNSR0JfRDY1X1hZWl9UT19SR0JfTUFUUklYLCBYWVpfRDY1LCBTUkdCKTsKICAgIGRlc3RbZGVzdE9mZnNldF0gPSBzUkdCVHJhbnNmZXJGdW5jdGlvbihTUkdCWzBdKSAqIDI1NTsKICAgIGRlc3RbZGVzdE9mZnNldCArIDFdID0gc1JHQlRyYW5zZmVyRnVuY3Rpb24oU1JHQlsxXSkgKiAyNTU7CiAgICBkZXN0W2Rlc3RPZmZzZXQgKyAyXSA9IHNSR0JUcmFuc2ZlckZ1bmN0aW9uKFNSR0JbMl0pICogMjU1OwogIH0KCiAgY2xhc3MgQ2FsUkdCQ1MgZXh0ZW5kcyBDb2xvclNwYWNlIHsKICAgIGNvbnN0cnVjdG9yKHdoaXRlUG9pbnQsIGJsYWNrUG9pbnQsIGdhbW1hLCBtYXRyaXgpIHsKICAgICAgc3VwZXIoIkNhbFJHQiIsIDMpOwoKICAgICAgaWYgKCF3aGl0ZVBvaW50KSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJXaGl0ZVBvaW50IG1pc3NpbmcgLSByZXF1aXJlZCBmb3IgY29sb3Igc3BhY2UgQ2FsUkdCIik7CiAgICAgIH0KCiAgICAgIGJsYWNrUG9pbnQgPSBibGFja1BvaW50IHx8IG5ldyBGbG9hdDMyQXJyYXkoMyk7CiAgICAgIGdhbW1hID0gZ2FtbWEgfHwgbmV3IEZsb2F0MzJBcnJheShbMSwgMSwgMV0pOwogICAgICBtYXRyaXggPSBtYXRyaXggfHwgbmV3IEZsb2F0MzJBcnJheShbMSwgMCwgMCwgMCwgMSwgMCwgMCwgMCwgMV0pOwogICAgICBjb25zdCBYVyA9IHdoaXRlUG9pbnRbMF07CiAgICAgIGNvbnN0IFlXID0gd2hpdGVQb2ludFsxXTsKICAgICAgY29uc3QgWlcgPSB3aGl0ZVBvaW50WzJdOwogICAgICB0aGlzLndoaXRlUG9pbnQgPSB3aGl0ZVBvaW50OwogICAgICBjb25zdCBYQiA9IGJsYWNrUG9pbnRbMF07CiAgICAgIGNvbnN0IFlCID0gYmxhY2tQb2ludFsxXTsKICAgICAgY29uc3QgWkIgPSBibGFja1BvaW50WzJdOwogICAgICB0aGlzLmJsYWNrUG9pbnQgPSBibGFja1BvaW50OwogICAgICB0aGlzLkdSID0gZ2FtbWFbMF07CiAgICAgIHRoaXMuR0cgPSBnYW1tYVsxXTsKICAgICAgdGhpcy5HQiA9IGdhbW1hWzJdOwogICAgICB0aGlzLk1YQSA9IG1hdHJpeFswXTsKICAgICAgdGhpcy5NWUEgPSBtYXRyaXhbMV07CiAgICAgIHRoaXMuTVpBID0gbWF0cml4WzJdOwogICAgICB0aGlzLk1YQiA9IG1hdHJpeFszXTsKICAgICAgdGhpcy5NWUIgPSBtYXRyaXhbNF07CiAgICAgIHRoaXMuTVpCID0gbWF0cml4WzVdOwogICAgICB0aGlzLk1YQyA9IG1hdHJpeFs2XTsKICAgICAgdGhpcy5NWUMgPSBtYXRyaXhbN107CiAgICAgIHRoaXMuTVpDID0gbWF0cml4WzhdOwoKICAgICAgaWYgKFhXIDwgMCB8fCBaVyA8IDAgfHwgWVcgIT09IDEpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgV2hpdGVQb2ludCBjb21wb25lbnRzIGZvciAke3RoaXMubmFtZX1gICsgIiwgbm8gZmFsbGJhY2sgYXZhaWxhYmxlIik7CiAgICAgIH0KCiAgICAgIGlmIChYQiA8IDAgfHwgWUIgPCAwIHx8IFpCIDwgMCkgewogICAgICAgICgwLCBfdXRpbC5pbmZvKShgSW52YWxpZCBCbGFja1BvaW50IGZvciAke3RoaXMubmFtZX0gWyR7WEJ9LCAke1lCfSwgJHtaQn1dLCBgICsgImZhbGxpbmcgYmFjayB0byBkZWZhdWx0LiIpOwogICAgICAgIHRoaXMuYmxhY2tQb2ludCA9IG5ldyBGbG9hdDMyQXJyYXkoMyk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLkdSIDwgMCB8fCB0aGlzLkdHIDwgMCB8fCB0aGlzLkdCIDwgMCkgewogICAgICAgICgwLCBfdXRpbC5pbmZvKShgSW52YWxpZCBHYW1tYSBbJHt0aGlzLkdSfSwgJHt0aGlzLkdHfSwgJHt0aGlzLkdCfV0gZm9yIGAgKyBgJHt0aGlzLm5hbWV9LCBmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdC5gKTsKICAgICAgICB0aGlzLkdSID0gdGhpcy5HRyA9IHRoaXMuR0IgPSAxOwogICAgICB9CiAgICB9CgogICAgZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgICBjb252ZXJ0VG9SZ2IodGhpcywgc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQsIDEpOwogICAgfQoKICAgIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgICAgY29uc3Qgc2NhbGUgPSAxIC8gKCgxIDw8IGJpdHMpIC0gMSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyArK2kpIHsKICAgICAgICBjb252ZXJ0VG9SZ2IodGhpcywgc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQsIHNjYWxlKTsKICAgICAgICBzcmNPZmZzZXQgKz0gMzsKICAgICAgICBkZXN0T2Zmc2V0ICs9IDMgKyBhbHBoYTAxOwogICAgICB9CiAgICB9CgogICAgZ2V0T3V0cHV0TGVuZ3RoKGlucHV0TGVuZ3RoLCBhbHBoYTAxKSB7CiAgICAgIHJldHVybiBpbnB1dExlbmd0aCAqICgzICsgYWxwaGEwMSkgLyAzIHwgMDsKICAgIH0KCiAgfQoKICByZXR1cm4gQ2FsUkdCQ1M7Cn0oKTsKCmNvbnN0IExhYkNTID0gZnVuY3Rpb24gTGFiQ1NDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGZuX2coeCkgewogICAgbGV0IHJlc3VsdDsKCiAgICBpZiAoeCA+PSA2IC8gMjkpIHsKICAgICAgcmVzdWx0ID0geCAqKiAzOwogICAgfSBlbHNlIHsKICAgICAgcmVzdWx0ID0gMTA4IC8gODQxICogKHggLSA0IC8gMjkpOwogICAgfQoKICAgIHJldHVybiByZXN1bHQ7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGUodmFsdWUsIGhpZ2gxLCBsb3cyLCBoaWdoMikgewogICAgcmV0dXJuIGxvdzIgKyB2YWx1ZSAqIChoaWdoMiAtIGxvdzIpIC8gaGlnaDE7CiAgfQoKICBmdW5jdGlvbiBjb252ZXJ0VG9SZ2IoY3MsIHNyYywgc3JjT2Zmc2V0LCBtYXhWYWwsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgIGxldCBMcyA9IHNyY1tzcmNPZmZzZXRdOwogICAgbGV0IGFzID0gc3JjW3NyY09mZnNldCArIDFdOwogICAgbGV0IGJzID0gc3JjW3NyY09mZnNldCArIDJdOwoKICAgIGlmIChtYXhWYWwgIT09IGZhbHNlKSB7CiAgICAgIExzID0gZGVjb2RlKExzLCBtYXhWYWwsIDAsIDEwMCk7CiAgICAgIGFzID0gZGVjb2RlKGFzLCBtYXhWYWwsIGNzLmFtaW4sIGNzLmFtYXgpOwogICAgICBicyA9IGRlY29kZShicywgbWF4VmFsLCBjcy5ibWluLCBjcy5ibWF4KTsKICAgIH0KCiAgICBpZiAoYXMgPiBjcy5hbWF4KSB7CiAgICAgIGFzID0gY3MuYW1heDsKICAgIH0gZWxzZSBpZiAoYXMgPCBjcy5hbWluKSB7CiAgICAgIGFzID0gY3MuYW1pbjsKICAgIH0KCiAgICBpZiAoYnMgPiBjcy5ibWF4KSB7CiAgICAgIGJzID0gY3MuYm1heDsKICAgIH0gZWxzZSBpZiAoYnMgPCBjcy5ibWluKSB7CiAgICAgIGJzID0gY3MuYm1pbjsKICAgIH0KCiAgICBjb25zdCBNID0gKExzICsgMTYpIC8gMTE2OwogICAgY29uc3QgTCA9IE0gKyBhcyAvIDUwMDsKICAgIGNvbnN0IE4gPSBNIC0gYnMgLyAyMDA7CiAgICBjb25zdCBYID0gY3MuWFcgKiBmbl9nKEwpOwogICAgY29uc3QgWSA9IGNzLllXICogZm5fZyhNKTsKICAgIGNvbnN0IFogPSBjcy5aVyAqIGZuX2coTik7CiAgICBsZXQgciwgZywgYjsKCiAgICBpZiAoY3MuWlcgPCAxKSB7CiAgICAgIHIgPSBYICogMy4xMzM5ICsgWSAqIC0xLjYxNyArIFogKiAtMC40OTA2OwogICAgICBnID0gWCAqIC0wLjk3ODUgKyBZICogMS45MTYgKyBaICogMC4wMzMzOwogICAgICBiID0gWCAqIDAuMDcyICsgWSAqIC0wLjIyOSArIFogKiAxLjQwNTc7CiAgICB9IGVsc2UgewogICAgICByID0gWCAqIDMuMjQwNiArIFkgKiAtMS41MzcyICsgWiAqIC0wLjQ5ODY7CiAgICAgIGcgPSBYICogLTAuOTY4OSArIFkgKiAxLjg3NTggKyBaICogMC4wNDE1OwogICAgICBiID0gWCAqIDAuMDU1NyArIFkgKiAtMC4yMDQgKyBaICogMS4wNTc7CiAgICB9CgogICAgZGVzdFtkZXN0T2Zmc2V0XSA9IE1hdGguc3FydChyKSAqIDI1NTsKICAgIGRlc3RbZGVzdE9mZnNldCArIDFdID0gTWF0aC5zcXJ0KGcpICogMjU1OwogICAgZGVzdFtkZXN0T2Zmc2V0ICsgMl0gPSBNYXRoLnNxcnQoYikgKiAyNTU7CiAgfQoKICBjbGFzcyBMYWJDUyBleHRlbmRzIENvbG9yU3BhY2UgewogICAgY29uc3RydWN0b3Iod2hpdGVQb2ludCwgYmxhY2tQb2ludCwgcmFuZ2UpIHsKICAgICAgc3VwZXIoIkxhYiIsIDMpOwoKICAgICAgaWYgKCF3aGl0ZVBvaW50KSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJXaGl0ZVBvaW50IG1pc3NpbmcgLSByZXF1aXJlZCBmb3IgY29sb3Igc3BhY2UgTGFiIik7CiAgICAgIH0KCiAgICAgIGJsYWNrUG9pbnQgPSBibGFja1BvaW50IHx8IFswLCAwLCAwXTsKICAgICAgcmFuZ2UgPSByYW5nZSB8fCBbLTEwMCwgMTAwLCAtMTAwLCAxMDBdOwogICAgICB0aGlzLlhXID0gd2hpdGVQb2ludFswXTsKICAgICAgdGhpcy5ZVyA9IHdoaXRlUG9pbnRbMV07CiAgICAgIHRoaXMuWlcgPSB3aGl0ZVBvaW50WzJdOwogICAgICB0aGlzLmFtaW4gPSByYW5nZVswXTsKICAgICAgdGhpcy5hbWF4ID0gcmFuZ2VbMV07CiAgICAgIHRoaXMuYm1pbiA9IHJhbmdlWzJdOwogICAgICB0aGlzLmJtYXggPSByYW5nZVszXTsKICAgICAgdGhpcy5YQiA9IGJsYWNrUG9pbnRbMF07CiAgICAgIHRoaXMuWUIgPSBibGFja1BvaW50WzFdOwogICAgICB0aGlzLlpCID0gYmxhY2tQb2ludFsyXTsKCiAgICAgIGlmICh0aGlzLlhXIDwgMCB8fCB0aGlzLlpXIDwgMCB8fCB0aGlzLllXICE9PSAxKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIFdoaXRlUG9pbnQgY29tcG9uZW50cywgbm8gZmFsbGJhY2sgYXZhaWxhYmxlIik7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLlhCIDwgMCB8fCB0aGlzLllCIDwgMCB8fCB0aGlzLlpCIDwgMCkgewogICAgICAgICgwLCBfdXRpbC5pbmZvKSgiSW52YWxpZCBCbGFja1BvaW50LCBmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdCIpOwogICAgICAgIHRoaXMuWEIgPSB0aGlzLllCID0gdGhpcy5aQiA9IDA7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmFtaW4gPiB0aGlzLmFtYXggfHwgdGhpcy5ibWluID4gdGhpcy5ibWF4KSB7CiAgICAgICAgKDAsIF91dGlsLmluZm8pKCJJbnZhbGlkIFJhbmdlLCBmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdHMiKTsKICAgICAgICB0aGlzLmFtaW4gPSAtMTAwOwogICAgICAgIHRoaXMuYW1heCA9IDEwMDsKICAgICAgICB0aGlzLmJtaW4gPSAtMTAwOwogICAgICAgIHRoaXMuYm1heCA9IDEwMDsKICAgICAgfQogICAgfQoKICAgIGdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgY29udmVydFRvUmdiKHRoaXMsIHNyYywgc3JjT2Zmc2V0LCBmYWxzZSwgZGVzdCwgZGVzdE9mZnNldCk7CiAgICB9CgogICAgZ2V0UmdiQnVmZmVyKHNyYywgc3JjT2Zmc2V0LCBjb3VudCwgZGVzdCwgZGVzdE9mZnNldCwgYml0cywgYWxwaGEwMSkgewogICAgICBjb25zdCBtYXhWYWwgPSAoMSA8PCBiaXRzKSAtIDE7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBjb252ZXJ0VG9SZ2IodGhpcywgc3JjLCBzcmNPZmZzZXQsIG1heFZhbCwgZGVzdCwgZGVzdE9mZnNldCk7CiAgICAgICAgc3JjT2Zmc2V0ICs9IDM7CiAgICAgICAgZGVzdE9mZnNldCArPSAzICsgYWxwaGEwMTsKICAgICAgfQogICAgfQoKICAgIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCwgYWxwaGEwMSkgewogICAgICByZXR1cm4gaW5wdXRMZW5ndGggKiAoMyArIGFscGhhMDEpIC8gMyB8IDA7CiAgICB9CgogICAgaXNEZWZhdWx0RGVjb2RlKGRlY29kZU1hcCwgYnBjKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGdldCB1c2VzWmVyb1RvT25lUmFuZ2UoKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAidXNlc1plcm9Ub09uZVJhbmdlIiwgZmFsc2UpOwogICAgfQoKICB9CgogIHJldHVybiBMYWJDUzsKfSgpOwoKLyoqKi8gfSksCi8qIDE0MCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuUGFydGlhbEV2YWx1YXRvciA9IGV4cG9ydHMuRXZhbHVhdG9yUHJlcHJvY2Vzc29yID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfY21hcCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQxKTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMwKTsKCnZhciBfZm9udHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE1OSk7Cgp2YXIgX2ZvbnRzX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjMpOwoKdmFyIF9lbmNvZGluZ3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2Mik7Cgp2YXIgX3N0YW5kYXJkX2ZvbnRzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjYpOwoKdmFyIF91bmljb2RlID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjUpOwoKdmFyIF9wYXR0ZXJuID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzUpOwoKdmFyIF94ZmFfZm9udHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3Nik7Cgp2YXIgX3RvX3VuaWNvZGVfbWFwID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjcpOwoKdmFyIF9mdW5jdGlvbiA9IF9fd19wZGZqc19yZXF1aXJlX18oMTgyKTsKCnZhciBfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDIpOwoKdmFyIF9pbWFnZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTg0KTsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzUpOwoKdmFyIF9iYXNlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMyKTsKCnZhciBfYmlkaSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTg1KTsKCnZhciBfY29sb3JzcGFjZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTM5KTsKCnZhciBfZGVjb2RlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ0KTsKCnZhciBfZ2x5cGhsaXN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjQpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKdmFyIF9tZXRyaWNzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzApOwoKdmFyIF9tdXJtdXJoYXNoID0gX193X3BkZmpzX3JlcXVpcmVfXygxODYpOwoKdmFyIF9vcGVyYXRvcl9saXN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygxODcpOwoKdmFyIF9pbWFnZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTg4KTsKCmNvbnN0IERlZmF1bHRQYXJ0aWFsRXZhbHVhdG9yT3B0aW9ucyA9IE9iamVjdC5mcmVlemUoewogIG1heEltYWdlU2l6ZTogLTEsCiAgZGlzYWJsZUZvbnRGYWNlOiBmYWxzZSwKICBpZ25vcmVFcnJvcnM6IGZhbHNlLAogIGlzRXZhbFN1cHBvcnRlZDogdHJ1ZSwKICBmb250RXh0cmFQcm9wZXJ0aWVzOiBmYWxzZSwKICB1c2VTeXN0ZW1Gb250czogdHJ1ZSwKICBjTWFwVXJsOiBudWxsLAogIHN0YW5kYXJkRm9udERhdGFVcmw6IG51bGwKfSk7CmNvbnN0IFBhdHRlcm5UeXBlID0gewogIFRJTElORzogMSwKICBTSEFESU5HOiAyCn07CmNvbnN0IFRFWFRfQ0hVTktfQkFUQ0hfU0laRSA9IDEwOwpjb25zdCBkZWZlcnJlZCA9IFByb21pc2UucmVzb2x2ZSgpOwoKZnVuY3Rpb24gbm9ybWFsaXplQmxlbmRNb2RlKHZhbHVlKSB7CiAgbGV0IHBhcnNpbmdBcnJheSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CgogIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgewogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdmFsdWUubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCBtYXliZUJNID0gbm9ybWFsaXplQmxlbmRNb2RlKHZhbHVlW2ldLCB0cnVlKTsKCiAgICAgIGlmIChtYXliZUJNKSB7CiAgICAgICAgcmV0dXJuIG1heWJlQk07CiAgICAgIH0KICAgIH0KCiAgICAoMCwgX3V0aWwud2FybikoYFVuc3VwcG9ydGVkIGJsZW5kIG1vZGUgQXJyYXk6ICR7dmFsdWV9YCk7CiAgICByZXR1cm4gInNvdXJjZS1vdmVyIjsKICB9CgogIGlmICghKHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkpIHsKICAgIGlmIChwYXJzaW5nQXJyYXkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgcmV0dXJuICJzb3VyY2Utb3ZlciI7CiAgfQoKICBzd2l0Y2ggKHZhbHVlLm5hbWUpIHsKICAgIGNhc2UgIk5vcm1hbCI6CiAgICBjYXNlICJDb21wYXRpYmxlIjoKICAgICAgcmV0dXJuICJzb3VyY2Utb3ZlciI7CgogICAgY2FzZSAiTXVsdGlwbHkiOgogICAgICByZXR1cm4gIm11bHRpcGx5IjsKCiAgICBjYXNlICJTY3JlZW4iOgogICAgICByZXR1cm4gInNjcmVlbiI7CgogICAgY2FzZSAiT3ZlcmxheSI6CiAgICAgIHJldHVybiAib3ZlcmxheSI7CgogICAgY2FzZSAiRGFya2VuIjoKICAgICAgcmV0dXJuICJkYXJrZW4iOwoKICAgIGNhc2UgIkxpZ2h0ZW4iOgogICAgICByZXR1cm4gImxpZ2h0ZW4iOwoKICAgIGNhc2UgIkNvbG9yRG9kZ2UiOgogICAgICByZXR1cm4gImNvbG9yLWRvZGdlIjsKCiAgICBjYXNlICJDb2xvckJ1cm4iOgogICAgICByZXR1cm4gImNvbG9yLWJ1cm4iOwoKICAgIGNhc2UgIkhhcmRMaWdodCI6CiAgICAgIHJldHVybiAiaGFyZC1saWdodCI7CgogICAgY2FzZSAiU29mdExpZ2h0IjoKICAgICAgcmV0dXJuICJzb2Z0LWxpZ2h0IjsKCiAgICBjYXNlICJEaWZmZXJlbmNlIjoKICAgICAgcmV0dXJuICJkaWZmZXJlbmNlIjsKCiAgICBjYXNlICJFeGNsdXNpb24iOgogICAgICByZXR1cm4gImV4Y2x1c2lvbiI7CgogICAgY2FzZSAiSHVlIjoKICAgICAgcmV0dXJuICJodWUiOwoKICAgIGNhc2UgIlNhdHVyYXRpb24iOgogICAgICByZXR1cm4gInNhdHVyYXRpb24iOwoKICAgIGNhc2UgIkNvbG9yIjoKICAgICAgcmV0dXJuICJjb2xvciI7CgogICAgY2FzZSAiTHVtaW5vc2l0eSI6CiAgICAgIHJldHVybiAibHVtaW5vc2l0eSI7CiAgfQoKICBpZiAocGFyc2luZ0FycmF5KSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogICgwLCBfdXRpbC53YXJuKShgVW5zdXBwb3J0ZWQgYmxlbmQgbW9kZTogJHt2YWx1ZS5uYW1lfWApOwogIHJldHVybiAic291cmNlLW92ZXIiOwp9CgpmdW5jdGlvbiBpbmNyZW1lbnRDYWNoZWRJbWFnZU1hc2tDb3VudChkYXRhKSB7CiAgaWYgKGRhdGEuZm4gPT09IF91dGlsLk9QUy5wYWludEltYWdlTWFza1hPYmplY3QgJiYgZGF0YS5hcmdzWzBdICYmIGRhdGEuYXJnc1swXS5jb3VudCA+IDApIHsKICAgIGRhdGEuYXJnc1swXS5jb3VudCsrOwogIH0KfQoKY2xhc3MgVGltZVNsb3RNYW5hZ2VyIHsKICBzdGF0aWMgZ2V0IFRJTUVfU0xPVF9EVVJBVElPTl9NUygpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiVElNRV9TTE9UX0RVUkFUSU9OX01TIiwgMjApOwogIH0KCiAgc3RhdGljIGdldCBDSEVDS19USU1FX0VWRVJZKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJDSEVDS19USU1FX0VWRVJZIiwgMTAwKTsKICB9CgogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5yZXNldCgpOwogIH0KCiAgY2hlY2soKSB7CiAgICBpZiAoKyt0aGlzLmNoZWNrZWQgPCBUaW1lU2xvdE1hbmFnZXIuQ0hFQ0tfVElNRV9FVkVSWSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdGhpcy5jaGVja2VkID0gMDsKICAgIHJldHVybiB0aGlzLmVuZFRpbWUgPD0gRGF0ZS5ub3coKTsKICB9CgogIHJlc2V0KCkgewogICAgdGhpcy5lbmRUaW1lID0gRGF0ZS5ub3coKSArIFRpbWVTbG90TWFuYWdlci5USU1FX1NMT1RfRFVSQVRJT05fTVM7CiAgICB0aGlzLmNoZWNrZWQgPSAwOwogIH0KCn0KCmNsYXNzIFBhcnRpYWxFdmFsdWF0b3IgewogIGNvbnN0cnVjdG9yKF9yZWYpIHsKICAgIGxldCB7CiAgICAgIHhyZWYsCiAgICAgIGhhbmRsZXIsCiAgICAgIHBhZ2VJbmRleCwKICAgICAgaWRGYWN0b3J5LAogICAgICBmb250Q2FjaGUsCiAgICAgIGJ1aWx0SW5DTWFwQ2FjaGUsCiAgICAgIHN0YW5kYXJkRm9udERhdGFDYWNoZSwKICAgICAgZ2xvYmFsSW1hZ2VDYWNoZSwKICAgICAgb3B0aW9ucyA9IG51bGwKICAgIH0gPSBfcmVmOwogICAgdGhpcy54cmVmID0geHJlZjsKICAgIHRoaXMuaGFuZGxlciA9IGhhbmRsZXI7CiAgICB0aGlzLnBhZ2VJbmRleCA9IHBhZ2VJbmRleDsKICAgIHRoaXMuaWRGYWN0b3J5ID0gaWRGYWN0b3J5OwogICAgdGhpcy5mb250Q2FjaGUgPSBmb250Q2FjaGU7CiAgICB0aGlzLmJ1aWx0SW5DTWFwQ2FjaGUgPSBidWlsdEluQ01hcENhY2hlOwogICAgdGhpcy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUgPSBzdGFuZGFyZEZvbnREYXRhQ2FjaGU7CiAgICB0aGlzLmdsb2JhbEltYWdlQ2FjaGUgPSBnbG9iYWxJbWFnZUNhY2hlOwogICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCBEZWZhdWx0UGFydGlhbEV2YWx1YXRvck9wdGlvbnM7CiAgICB0aGlzLnBhcnNpbmdUeXBlM0ZvbnQgPSBmYWxzZTsKICAgIHRoaXMuX2ZldGNoQnVpbHRJbkNNYXBCb3VuZCA9IHRoaXMuZmV0Y2hCdWlsdEluQ01hcC5iaW5kKHRoaXMpOwogIH0KCiAgZ2V0IF9wZGZGdW5jdGlvbkZhY3RvcnkoKSB7CiAgICBjb25zdCBwZGZGdW5jdGlvbkZhY3RvcnkgPSBuZXcgX2Z1bmN0aW9uLlBERkZ1bmN0aW9uRmFjdG9yeSh7CiAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgaXNFdmFsU3VwcG9ydGVkOiB0aGlzLm9wdGlvbnMuaXNFdmFsU3VwcG9ydGVkCiAgICB9KTsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiX3BkZkZ1bmN0aW9uRmFjdG9yeSIsIHBkZkZ1bmN0aW9uRmFjdG9yeSk7CiAgfQoKICBjbG9uZSgpIHsKICAgIGxldCBuZXdPcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsOwogICAgY29uc3QgbmV3RXZhbHVhdG9yID0gT2JqZWN0LmNyZWF0ZSh0aGlzKTsKICAgIG5ld0V2YWx1YXRvci5vcHRpb25zID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKG51bGwpLCB0aGlzLm9wdGlvbnMsIG5ld09wdGlvbnMpOwogICAgcmV0dXJuIG5ld0V2YWx1YXRvcjsKICB9CgogIGhhc0JsZW5kTW9kZXMocmVzb3VyY2VzLCBub25CbGVuZE1vZGVzU2V0KSB7CiAgICBpZiAoIShyZXNvdXJjZXMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKHJlc291cmNlcy5vYmpJZCAmJiBub25CbGVuZE1vZGVzU2V0LmhhcyhyZXNvdXJjZXMub2JqSWQpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBjb25zdCBwcm9jZXNzZWQgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KG5vbkJsZW5kTW9kZXNTZXQpOwoKICAgIGlmIChyZXNvdXJjZXMub2JqSWQpIHsKICAgICAgcHJvY2Vzc2VkLnB1dChyZXNvdXJjZXMub2JqSWQpOwogICAgfQoKICAgIGNvbnN0IG5vZGVzID0gW3Jlc291cmNlc10sCiAgICAgICAgICB4cmVmID0gdGhpcy54cmVmOwoKICAgIHdoaWxlIChub2Rlcy5sZW5ndGgpIHsKICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzLnNoaWZ0KCk7CiAgICAgIGNvbnN0IGdyYXBoaWNTdGF0ZXMgPSBub2RlLmdldCgiRXh0R1N0YXRlIik7CgogICAgICBpZiAoZ3JhcGhpY1N0YXRlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICBmb3IgKGxldCBncmFwaGljU3RhdGUgb2YgZ3JhcGhpY1N0YXRlcy5nZXRSYXdWYWx1ZXMoKSkgewogICAgICAgICAgaWYgKGdyYXBoaWNTdGF0ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICBpZiAocHJvY2Vzc2VkLmhhcyhncmFwaGljU3RhdGUpKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgZ3JhcGhpY1N0YXRlID0geHJlZi5mZXRjaChncmFwaGljU3RhdGUpOwogICAgICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgICAgIHByb2Nlc3NlZC5wdXQoZ3JhcGhpY1N0YXRlKTsKICAgICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoYGhhc0JsZW5kTW9kZXMgLSBpZ25vcmluZyBFeHRHU3RhdGU6ICIke2V4fSIuYCk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIShncmFwaGljU3RhdGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZ3JhcGhpY1N0YXRlLm9iaklkKSB7CiAgICAgICAgICAgIHByb2Nlc3NlZC5wdXQoZ3JhcGhpY1N0YXRlLm9iaklkKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBibSA9IGdyYXBoaWNTdGF0ZS5nZXQoIkJNIik7CgogICAgICAgICAgaWYgKGJtIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICBpZiAoYm0ubmFtZSAhPT0gIk5vcm1hbCIpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGJtICE9PSB1bmRlZmluZWQgJiYgQXJyYXkuaXNBcnJheShibSkpIHsKICAgICAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGJtKSB7CiAgICAgICAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lICYmIGVsZW1lbnQubmFtZSAhPT0gIk5vcm1hbCIpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgeE9iamVjdHMgPSBub2RlLmdldCgiWE9iamVjdCIpOwoKICAgICAgaWYgKCEoeE9iamVjdHMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBmb3IgKGxldCB4T2JqZWN0IG9mIHhPYmplY3RzLmdldFJhd1ZhbHVlcygpKSB7CiAgICAgICAgaWYgKHhPYmplY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgIGlmIChwcm9jZXNzZWQuaGFzKHhPYmplY3QpKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHhPYmplY3QgPSB4cmVmLmZldGNoKHhPYmplY3QpOwogICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgcHJvY2Vzc2VkLnB1dCh4T2JqZWN0KTsKICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKGBoYXNCbGVuZE1vZGVzIC0gaWdub3JpbmcgWE9iamVjdDogIiR7ZXh9Ii5gKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoISh4T2JqZWN0IGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmICh4T2JqZWN0LmRpY3Qub2JqSWQpIHsKICAgICAgICAgIHByb2Nlc3NlZC5wdXQoeE9iamVjdC5kaWN0Lm9iaklkKTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHhSZXNvdXJjZXMgPSB4T2JqZWN0LmRpY3QuZ2V0KCJSZXNvdXJjZXMiKTsKCiAgICAgICAgaWYgKCEoeFJlc291cmNlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmICh4UmVzb3VyY2VzLm9iaklkICYmIHByb2Nlc3NlZC5oYXMoeFJlc291cmNlcy5vYmpJZCkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgbm9kZXMucHVzaCh4UmVzb3VyY2VzKTsKCiAgICAgICAgaWYgKHhSZXNvdXJjZXMub2JqSWQpIHsKICAgICAgICAgIHByb2Nlc3NlZC5wdXQoeFJlc291cmNlcy5vYmpJZCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZm9yIChjb25zdCByZWYgb2YgcHJvY2Vzc2VkKSB7CiAgICAgIG5vbkJsZW5kTW9kZXNTZXQucHV0KHJlZik7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgYXN5bmMgZmV0Y2hCdWlsdEluQ01hcChuYW1lKSB7CiAgICBjb25zdCBjYWNoZWREYXRhID0gdGhpcy5idWlsdEluQ01hcENhY2hlLmdldChuYW1lKTsKCiAgICBpZiAoY2FjaGVkRGF0YSkgewogICAgICByZXR1cm4gY2FjaGVkRGF0YTsKICAgIH0KCiAgICBsZXQgZGF0YTsKCiAgICBpZiAodGhpcy5vcHRpb25zLmNNYXBVcmwgIT09IG51bGwpIHsKICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5vcHRpb25zLmNNYXBVcmx9JHtuYW1lfS5iY21hcGA7CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTsKCiAgICAgIGlmICghcmVzcG9uc2Uub2spIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGZldGNoQnVpbHRJbkNNYXA6IGZhaWxlZCB0byBmZXRjaCBmaWxlICIke3VybH0iIHdpdGggIiR7cmVzcG9uc2Uuc3RhdHVzVGV4dH0iLmApOwogICAgICB9CgogICAgICBkYXRhID0gewogICAgICAgIGNNYXBEYXRhOiBuZXcgVWludDhBcnJheShhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpKSwKICAgICAgICBjb21wcmVzc2lvblR5cGU6IF91dGlsLkNNYXBDb21wcmVzc2lvblR5cGUuQklOQVJZCiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICBkYXRhID0gYXdhaXQgdGhpcy5oYW5kbGVyLnNlbmRXaXRoUHJvbWlzZSgiRmV0Y2hCdWlsdEluQ01hcCIsIHsKICAgICAgICBuYW1lCiAgICAgIH0pOwogICAgfQoKICAgIGlmIChkYXRhLmNvbXByZXNzaW9uVHlwZSAhPT0gX3V0aWwuQ01hcENvbXByZXNzaW9uVHlwZS5OT05FKSB7CiAgICAgIHRoaXMuYnVpbHRJbkNNYXBDYWNoZS5zZXQobmFtZSwgZGF0YSk7CiAgICB9CgogICAgcmV0dXJuIGRhdGE7CiAgfQoKICBhc3luYyBmZXRjaFN0YW5kYXJkRm9udERhdGEobmFtZSkgewogICAgY29uc3QgY2FjaGVkRGF0YSA9IHRoaXMuc3RhbmRhcmRGb250RGF0YUNhY2hlLmdldChuYW1lKTsKCiAgICBpZiAoY2FjaGVkRGF0YSkgewogICAgICByZXR1cm4gbmV3IF9zdHJlYW0uU3RyZWFtKGNhY2hlZERhdGEpOwogICAgfQoKICAgIGlmICh0aGlzLm9wdGlvbnMudXNlU3lzdGVtRm9udHMgJiYgbmFtZSAhPT0gIlN5bWJvbCIgJiYgbmFtZSAhPT0gIlphcGZEaW5nYmF0cyIpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3Qgc3RhbmRhcmRGb250TmFtZVRvRmlsZU5hbWUgPSAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldEZvbnROYW1lVG9GaWxlTWFwKSgpLAogICAgICAgICAgZmlsZW5hbWUgPSBzdGFuZGFyZEZvbnROYW1lVG9GaWxlTmFtZVtuYW1lXTsKICAgIGxldCBkYXRhOwoKICAgIGlmICh0aGlzLm9wdGlvbnMuc3RhbmRhcmRGb250RGF0YVVybCAhPT0gbnVsbCkgewogICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLm9wdGlvbnMuc3RhbmRhcmRGb250RGF0YVVybH0ke2ZpbGVuYW1lfWA7CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTsKCiAgICAgIGlmICghcmVzcG9uc2Uub2spIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYGZldGNoU3RhbmRhcmRGb250RGF0YTogZmFpbGVkIHRvIGZldGNoIGZpbGUgIiR7dXJsfSIgd2l0aCAiJHtyZXNwb25zZS5zdGF0dXNUZXh0fSIuYCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRyeSB7CiAgICAgICAgZGF0YSA9IGF3YWl0IHRoaXMuaGFuZGxlci5zZW5kV2l0aFByb21pc2UoIkZldGNoU3RhbmRhcmRGb250RGF0YSIsIHsKICAgICAgICAgIGZpbGVuYW1lCiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYGZldGNoU3RhbmRhcmRGb250RGF0YTogZmFpbGVkIHRvIGZldGNoIGZpbGUgIiR7ZmlsZW5hbWV9IiB3aXRoICIke2V9Ii5gKTsKICAgICAgfQogICAgfQoKICAgIGlmICghZGF0YSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICB0aGlzLnN0YW5kYXJkRm9udERhdGFDYWNoZS5zZXQobmFtZSwgZGF0YSk7CiAgICByZXR1cm4gbmV3IF9zdHJlYW0uU3RyZWFtKGRhdGEpOwogIH0KCiAgYXN5bmMgYnVpbGRGb3JtWE9iamVjdChyZXNvdXJjZXMsIHhvYmosIHNtYXNrLCBvcGVyYXRvckxpc3QsIHRhc2ssIGluaXRpYWxTdGF0ZSwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpIHsKICAgIGNvbnN0IGRpY3QgPSB4b2JqLmRpY3Q7CiAgICBjb25zdCBtYXRyaXggPSBkaWN0LmdldEFycmF5KCJNYXRyaXgiKTsKICAgIGxldCBiYm94ID0gZGljdC5nZXRBcnJheSgiQkJveCIpOwoKICAgIGlmIChBcnJheS5pc0FycmF5KGJib3gpICYmIGJib3gubGVuZ3RoID09PSA0KSB7CiAgICAgIGJib3ggPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3QoYmJveCk7CiAgICB9IGVsc2UgewogICAgICBiYm94ID0gbnVsbDsKICAgIH0KCiAgICBsZXQgb3B0aW9uYWxDb250ZW50LCBncm91cE9wdGlvbnM7CgogICAgaWYgKGRpY3QuaGFzKCJPQyIpKSB7CiAgICAgIG9wdGlvbmFsQ29udGVudCA9IGF3YWl0IHRoaXMucGFyc2VNYXJrZWRDb250ZW50UHJvcHMoZGljdC5nZXQoIk9DIiksIHJlc291cmNlcyk7CiAgICB9CgogICAgaWYgKG9wdGlvbmFsQ29udGVudCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuYmVnaW5NYXJrZWRDb250ZW50UHJvcHMsIFsiT0MiLCBvcHRpb25hbENvbnRlbnRdKTsKICAgIH0KCiAgICBjb25zdCBncm91cCA9IGRpY3QuZ2V0KCJHcm91cCIpOwoKICAgIGlmIChncm91cCkgewogICAgICBncm91cE9wdGlvbnMgPSB7CiAgICAgICAgbWF0cml4LAogICAgICAgIGJib3gsCiAgICAgICAgc21hc2ssCiAgICAgICAgaXNvbGF0ZWQ6IGZhbHNlLAogICAgICAgIGtub2Nrb3V0OiBmYWxzZQogICAgICB9OwogICAgICBjb25zdCBncm91cFN1YnR5cGUgPSBncm91cC5nZXQoIlMiKTsKICAgICAgbGV0IGNvbG9yU3BhY2UgPSBudWxsOwoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGdyb3VwU3VidHlwZSwgIlRyYW5zcGFyZW5jeSIpKSB7CiAgICAgICAgZ3JvdXBPcHRpb25zLmlzb2xhdGVkID0gZ3JvdXAuZ2V0KCJJIikgfHwgZmFsc2U7CiAgICAgICAgZ3JvdXBPcHRpb25zLmtub2Nrb3V0ID0gZ3JvdXAuZ2V0KCJLIikgfHwgZmFsc2U7CgogICAgICAgIGlmIChncm91cC5oYXMoIkNTIikpIHsKICAgICAgICAgIGNvbnN0IGNzID0gZ3JvdXAuZ2V0UmF3KCJDUyIpOwoKICAgICAgICAgIGNvbnN0IGNhY2hlZENvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLmdldENhY2hlZChjcywgdGhpcy54cmVmLCBsb2NhbENvbG9yU3BhY2VDYWNoZSk7CgogICAgICAgICAgaWYgKGNhY2hlZENvbG9yU3BhY2UpIHsKICAgICAgICAgICAgY29sb3JTcGFjZSA9IGNhY2hlZENvbG9yU3BhY2U7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb2xvclNwYWNlID0gYXdhaXQgdGhpcy5wYXJzZUNvbG9yU3BhY2UoewogICAgICAgICAgICAgIGNzLAogICAgICAgICAgICAgIHJlc291cmNlcywKICAgICAgICAgICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChzbWFzayAmJiBzbWFzay5iYWNrZHJvcCkgewogICAgICAgIGNvbG9yU3BhY2UgPSBjb2xvclNwYWNlIHx8IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5yZ2I7CiAgICAgICAgc21hc2suYmFja2Ryb3AgPSBjb2xvclNwYWNlLmdldFJnYihzbWFzay5iYWNrZHJvcCwgMCk7CiAgICAgIH0KCiAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuYmVnaW5Hcm91cCwgW2dyb3VwT3B0aW9uc10pOwogICAgfQoKICAgIGNvbnN0IGFyZ3MgPSBncm91cCA/IFttYXRyaXgsIG51bGxdIDogW21hdHJpeCwgYmJveF07CiAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLnBhaW50Rm9ybVhPYmplY3RCZWdpbiwgYXJncyk7CiAgICByZXR1cm4gdGhpcy5nZXRPcGVyYXRvckxpc3QoewogICAgICBzdHJlYW06IHhvYmosCiAgICAgIHRhc2ssCiAgICAgIHJlc291cmNlczogZGljdC5nZXQoIlJlc291cmNlcyIpIHx8IHJlc291cmNlcywKICAgICAgb3BlcmF0b3JMaXN0LAogICAgICBpbml0aWFsU3RhdGUKICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLnBhaW50Rm9ybVhPYmplY3RFbmQsIFtdKTsKCiAgICAgIGlmIChncm91cCkgewogICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuZW5kR3JvdXAsIFtncm91cE9wdGlvbnNdKTsKICAgICAgfQoKICAgICAgaWYgKG9wdGlvbmFsQ29udGVudCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5lbmRNYXJrZWRDb250ZW50LCBbXSk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgX3NlbmRJbWdEYXRhKG9iaklkLCBpbWdEYXRhKSB7CiAgICBsZXQgY2FjaGVHbG9iYWxseSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICBjb25zdCB0cmFuc2ZlcnMgPSBpbWdEYXRhID8gW2ltZ0RhdGEuYml0bWFwIHx8IGltZ0RhdGEuZGF0YS5idWZmZXJdIDogbnVsbDsKCiAgICBpZiAodGhpcy5wYXJzaW5nVHlwZTNGb250IHx8IGNhY2hlR2xvYmFsbHkpIHsKICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlci5zZW5kKCJjb21tb25vYmoiLCBbb2JqSWQsICJJbWFnZSIsIGltZ0RhdGFdLCB0cmFuc2ZlcnMpOwogICAgfQoKICAgIHJldHVybiB0aGlzLmhhbmRsZXIuc2VuZCgib2JqIiwgW29iaklkLCB0aGlzLnBhZ2VJbmRleCwgIkltYWdlIiwgaW1nRGF0YV0sIHRyYW5zZmVycyk7CiAgfQoKICBhc3luYyBidWlsZFBhaW50SW1hZ2VYT2JqZWN0KF9yZWYyKSB7CiAgICBsZXQgewogICAgICByZXNvdXJjZXMsCiAgICAgIGltYWdlLAogICAgICBpc0lubGluZSA9IGZhbHNlLAogICAgICBvcGVyYXRvckxpc3QsCiAgICAgIGNhY2hlS2V5LAogICAgICBsb2NhbEltYWdlQ2FjaGUsCiAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICB9ID0gX3JlZjI7CiAgICBjb25zdCBkaWN0ID0gaW1hZ2UuZGljdDsKICAgIGNvbnN0IGltYWdlUmVmID0gZGljdC5vYmpJZDsKICAgIGNvbnN0IHcgPSBkaWN0LmdldCgiVyIsICJXaWR0aCIpOwogICAgY29uc3QgaCA9IGRpY3QuZ2V0KCJIIiwgIkhlaWdodCIpOwoKICAgIGlmICghKHcgJiYgdHlwZW9mIHcgPT09ICJudW1iZXIiKSB8fCAhKGggJiYgdHlwZW9mIGggPT09ICJudW1iZXIiKSkgewogICAgICAoMCwgX3V0aWwud2FybikoIkltYWdlIGRpbWVuc2lvbnMgYXJlIG1pc3NpbmcsIG9yIG5vdCBudW1iZXJzLiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgbWF4SW1hZ2VTaXplID0gdGhpcy5vcHRpb25zLm1heEltYWdlU2l6ZTsKCiAgICBpZiAobWF4SW1hZ2VTaXplICE9PSAtMSAmJiB3ICogaCA+IG1heEltYWdlU2l6ZSkgewogICAgICBjb25zdCBtc2cgPSAiSW1hZ2UgZXhjZWVkZWQgbWF4aW11bSBhbGxvd2VkIHNpemUgYW5kIHdhcyByZW1vdmVkLiI7CgogICAgICBpZiAodGhpcy5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICgwLCBfdXRpbC53YXJuKShtc2cpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7CiAgICB9CgogICAgbGV0IG9wdGlvbmFsQ29udGVudDsKCiAgICBpZiAoZGljdC5oYXMoIk9DIikpIHsKICAgICAgb3B0aW9uYWxDb250ZW50ID0gYXdhaXQgdGhpcy5wYXJzZU1hcmtlZENvbnRlbnRQcm9wcyhkaWN0LmdldCgiT0MiKSwgcmVzb3VyY2VzKTsKICAgIH0KCiAgICBjb25zdCBpbWFnZU1hc2sgPSBkaWN0LmdldCgiSU0iLCAiSW1hZ2VNYXNrIikgfHwgZmFsc2U7CiAgICBsZXQgaW1nRGF0YSwgYXJnczsKCiAgICBpZiAoaW1hZ2VNYXNrKSB7CiAgICAgIGNvbnN0IGludGVycG9sYXRlID0gZGljdC5nZXQoIkkiLCAiSW50ZXJwb2xhdGUiKTsKICAgICAgY29uc3QgYml0U3RyaWRlTGVuZ3RoID0gdyArIDcgPj4gMzsKICAgICAgY29uc3QgaW1nQXJyYXkgPSBpbWFnZS5nZXRCeXRlcyhiaXRTdHJpZGVMZW5ndGggKiBoKTsKICAgICAgY29uc3QgZGVjb2RlID0gZGljdC5nZXRBcnJheSgiRCIsICJEZWNvZGUiKTsKCiAgICAgIGlmICh0aGlzLnBhcnNpbmdUeXBlM0ZvbnQpIHsKICAgICAgICBpbWdEYXRhID0gX2ltYWdlLlBERkltYWdlLmNyZWF0ZVJhd01hc2soewogICAgICAgICAgaW1nQXJyYXksCiAgICAgICAgICB3aWR0aDogdywKICAgICAgICAgIGhlaWdodDogaCwKICAgICAgICAgIGltYWdlSXNGcm9tRGVjb2RlU3RyZWFtOiBpbWFnZSBpbnN0YW5jZW9mIF9kZWNvZGVfc3RyZWFtLkRlY29kZVN0cmVhbSwKICAgICAgICAgIGludmVyc2VEZWNvZGU6ICEhZGVjb2RlICYmIGRlY29kZVswXSA+IDAsCiAgICAgICAgICBpbnRlcnBvbGF0ZQogICAgICAgIH0pOwogICAgICAgIGltZ0RhdGEuY2FjaGVkID0gISFjYWNoZUtleTsKICAgICAgICBhcmdzID0gW2ltZ0RhdGFdOwogICAgICAgIG9wZXJhdG9yTGlzdC5hZGRJbWFnZU9wcyhfdXRpbC5PUFMucGFpbnRJbWFnZU1hc2tYT2JqZWN0LCBhcmdzLCBvcHRpb25hbENvbnRlbnQpOwoKICAgICAgICBpZiAoY2FjaGVLZXkpIHsKICAgICAgICAgIGxvY2FsSW1hZ2VDYWNoZS5zZXQoY2FjaGVLZXksIGltYWdlUmVmLCB7CiAgICAgICAgICAgIGZuOiBfdXRpbC5PUFMucGFpbnRJbWFnZU1hc2tYT2JqZWN0LAogICAgICAgICAgICBhcmdzLAogICAgICAgICAgICBvcHRpb25hbENvbnRlbnQKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpbWdEYXRhID0gX2ltYWdlLlBERkltYWdlLmNyZWF0ZU1hc2soewogICAgICAgIGltZ0FycmF5LAogICAgICAgIHdpZHRoOiB3LAogICAgICAgIGhlaWdodDogaCwKICAgICAgICBpbWFnZUlzRnJvbURlY29kZVN0cmVhbTogaW1hZ2UgaW5zdGFuY2VvZiBfZGVjb2RlX3N0cmVhbS5EZWNvZGVTdHJlYW0sCiAgICAgICAgaW52ZXJzZURlY29kZTogISFkZWNvZGUgJiYgZGVjb2RlWzBdID4gMCwKICAgICAgICBpbnRlcnBvbGF0ZQogICAgICB9KTsKCiAgICAgIGlmIChpbWdEYXRhLmlzU2luZ2xlT3BhcXVlUGl4ZWwpIHsKICAgICAgICBvcGVyYXRvckxpc3QuYWRkSW1hZ2VPcHMoX3V0aWwuT1BTLnBhaW50U29saWRDb2xvckltYWdlTWFzaywgW10sIG9wdGlvbmFsQ29udGVudCk7CgogICAgICAgIGlmIChjYWNoZUtleSkgewogICAgICAgICAgbG9jYWxJbWFnZUNhY2hlLnNldChjYWNoZUtleSwgaW1hZ2VSZWYsIHsKICAgICAgICAgICAgZm46IF91dGlsLk9QUy5wYWludFNvbGlkQ29sb3JJbWFnZU1hc2ssCiAgICAgICAgICAgIGFyZ3M6IFtdLAogICAgICAgICAgICBvcHRpb25hbENvbnRlbnQKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBvYmpJZCA9IGBtYXNrXyR7dGhpcy5pZEZhY3RvcnkuY3JlYXRlT2JqSWQoKX1gOwogICAgICBvcGVyYXRvckxpc3QuYWRkRGVwZW5kZW5jeShvYmpJZCk7CgogICAgICB0aGlzLl9zZW5kSW1nRGF0YShvYmpJZCwgaW1nRGF0YSk7CgogICAgICBhcmdzID0gW3sKICAgICAgICBkYXRhOiBvYmpJZCwKICAgICAgICB3aWR0aDogaW1nRGF0YS53aWR0aCwKICAgICAgICBoZWlnaHQ6IGltZ0RhdGEuaGVpZ2h0LAogICAgICAgIGludGVycG9sYXRlOiBpbWdEYXRhLmludGVycG9sYXRlLAogICAgICAgIGNvdW50OiAxCiAgICAgIH1dOwogICAgICBvcGVyYXRvckxpc3QuYWRkSW1hZ2VPcHMoX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdCwgYXJncywgb3B0aW9uYWxDb250ZW50KTsKCiAgICAgIGlmIChjYWNoZUtleSkgewogICAgICAgIGxvY2FsSW1hZ2VDYWNoZS5zZXQoY2FjaGVLZXksIGltYWdlUmVmLCB7CiAgICAgICAgICBmbjogX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdCwKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBvcHRpb25hbENvbnRlbnQKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHNvZnRNYXNrID0gZGljdC5nZXQoIlNNIiwgIlNNYXNrIikgfHwgZmFsc2U7CiAgICBjb25zdCBtYXNrID0gZGljdC5nZXQoIk1hc2siKSB8fCBmYWxzZTsKICAgIGNvbnN0IFNNQUxMX0lNQUdFX0RJTUVOU0lPTlMgPSAyMDA7CgogICAgaWYgKGlzSW5saW5lICYmICFzb2Z0TWFzayAmJiAhbWFzayAmJiB3ICsgaCA8IFNNQUxMX0lNQUdFX0RJTUVOU0lPTlMpIHsKICAgICAgY29uc3QgaW1hZ2VPYmogPSBuZXcgX2ltYWdlLlBERkltYWdlKHsKICAgICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgICAgcmVzOiByZXNvdXJjZXMsCiAgICAgICAgaW1hZ2UsCiAgICAgICAgaXNJbmxpbmUsCiAgICAgICAgcGRmRnVuY3Rpb25GYWN0b3J5OiB0aGlzLl9wZGZGdW5jdGlvbkZhY3RvcnksCiAgICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgICAgfSk7CiAgICAgIGltZ0RhdGEgPSBpbWFnZU9iai5jcmVhdGVJbWFnZURhdGEodHJ1ZSk7CiAgICAgIG9wZXJhdG9yTGlzdC5hZGRJbWFnZU9wcyhfdXRpbC5PUFMucGFpbnRJbmxpbmVJbWFnZVhPYmplY3QsIFtpbWdEYXRhXSwgb3B0aW9uYWxDb250ZW50KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBvYmpJZCA9IGBpbWdfJHt0aGlzLmlkRmFjdG9yeS5jcmVhdGVPYmpJZCgpfWAsCiAgICAgICAgY2FjaGVHbG9iYWxseSA9IGZhbHNlOwoKICAgIGlmICh0aGlzLnBhcnNpbmdUeXBlM0ZvbnQpIHsKICAgICAgb2JqSWQgPSBgJHt0aGlzLmlkRmFjdG9yeS5nZXREb2NJZCgpfV90eXBlM18ke29iaklkfWA7CiAgICB9IGVsc2UgaWYgKGltYWdlUmVmKSB7CiAgICAgIGNhY2hlR2xvYmFsbHkgPSB0aGlzLmdsb2JhbEltYWdlQ2FjaGUuc2hvdWxkQ2FjaGUoaW1hZ2VSZWYsIHRoaXMucGFnZUluZGV4KTsKCiAgICAgIGlmIChjYWNoZUdsb2JhbGx5KSB7CiAgICAgICAgb2JqSWQgPSBgJHt0aGlzLmlkRmFjdG9yeS5nZXREb2NJZCgpfV8ke29iaklkfWA7CiAgICAgIH0KICAgIH0KCiAgICBvcGVyYXRvckxpc3QuYWRkRGVwZW5kZW5jeShvYmpJZCk7CiAgICBhcmdzID0gW29iaklkLCB3LCBoXTsKCiAgICBfaW1hZ2UuUERGSW1hZ2UuYnVpbGRJbWFnZSh7CiAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgcmVzOiByZXNvdXJjZXMsCiAgICAgIGltYWdlLAogICAgICBpc0lubGluZSwKICAgICAgcGRmRnVuY3Rpb25GYWN0b3J5OiB0aGlzLl9wZGZGdW5jdGlvbkZhY3RvcnksCiAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICB9KS50aGVuKGltYWdlT2JqID0+IHsKICAgICAgaW1nRGF0YSA9IGltYWdlT2JqLmNyZWF0ZUltYWdlRGF0YShmYWxzZSk7CgogICAgICBpZiAoY2FjaGVLZXkgJiYgaW1hZ2VSZWYgJiYgY2FjaGVHbG9iYWxseSkgewogICAgICAgIHRoaXMuZ2xvYmFsSW1hZ2VDYWNoZS5hZGRCeXRlU2l6ZShpbWFnZVJlZiwgaW1nRGF0YS5kYXRhLmxlbmd0aCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLl9zZW5kSW1nRGF0YShvYmpJZCwgaW1nRGF0YSwgY2FjaGVHbG9iYWxseSk7CiAgICB9KS5jYXRjaChyZWFzb24gPT4gewogICAgICAoMCwgX3V0aWwud2FybikoYFVuYWJsZSB0byBkZWNvZGUgaW1hZ2UgIiR7b2JqSWR9IjogIiR7cmVhc29ufSIuYCk7CiAgICAgIHJldHVybiB0aGlzLl9zZW5kSW1nRGF0YShvYmpJZCwgbnVsbCwgY2FjaGVHbG9iYWxseSk7CiAgICB9KTsKCiAgICBvcGVyYXRvckxpc3QuYWRkSW1hZ2VPcHMoX3V0aWwuT1BTLnBhaW50SW1hZ2VYT2JqZWN0LCBhcmdzLCBvcHRpb25hbENvbnRlbnQpOwoKICAgIGlmIChjYWNoZUtleSkgewogICAgICBsb2NhbEltYWdlQ2FjaGUuc2V0KGNhY2hlS2V5LCBpbWFnZVJlZiwgewogICAgICAgIGZuOiBfdXRpbC5PUFMucGFpbnRJbWFnZVhPYmplY3QsCiAgICAgICAgYXJncywKICAgICAgICBvcHRpb25hbENvbnRlbnQKICAgICAgfSk7CgogICAgICBpZiAoaW1hZ2VSZWYpIHsKICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KSghaXNJbmxpbmUsICJDYW5ub3QgY2FjaGUgYW4gaW5saW5lIGltYWdlIGdsb2JhbGx5LiIpOwogICAgICAgIHRoaXMuZ2xvYmFsSW1hZ2VDYWNoZS5hZGRQYWdlSW5kZXgoaW1hZ2VSZWYsIHRoaXMucGFnZUluZGV4KTsKCiAgICAgICAgaWYgKGNhY2hlR2xvYmFsbHkpIHsKICAgICAgICAgIHRoaXMuZ2xvYmFsSW1hZ2VDYWNoZS5zZXREYXRhKGltYWdlUmVmLCB7CiAgICAgICAgICAgIG9iaklkLAogICAgICAgICAgICBmbjogX3V0aWwuT1BTLnBhaW50SW1hZ2VYT2JqZWN0LAogICAgICAgICAgICBhcmdzLAogICAgICAgICAgICBvcHRpb25hbENvbnRlbnQsCiAgICAgICAgICAgIGJ5dGVTaXplOiAwCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGhhbmRsZVNNYXNrKHNtYXNrLCByZXNvdXJjZXMsIG9wZXJhdG9yTGlzdCwgdGFzaywgc3RhdGVNYW5hZ2VyLCBsb2NhbENvbG9yU3BhY2VDYWNoZSkgewogICAgY29uc3Qgc21hc2tDb250ZW50ID0gc21hc2suZ2V0KCJHIik7CiAgICBjb25zdCBzbWFza09wdGlvbnMgPSB7CiAgICAgIHN1YnR5cGU6IHNtYXNrLmdldCgiUyIpLm5hbWUsCiAgICAgIGJhY2tkcm9wOiBzbWFzay5nZXQoIkJDIikKICAgIH07CiAgICBjb25zdCB0cmFuc2Zlck9iaiA9IHNtYXNrLmdldCgiVFIiKTsKCiAgICBpZiAoKDAsIF9mdW5jdGlvbi5pc1BERkZ1bmN0aW9uKSh0cmFuc2Zlck9iaikpIHsKICAgICAgY29uc3QgdHJhbnNmZXJGbiA9IHRoaXMuX3BkZkZ1bmN0aW9uRmFjdG9yeS5jcmVhdGUodHJhbnNmZXJPYmopOwoKICAgICAgY29uc3QgdHJhbnNmZXJNYXAgPSBuZXcgVWludDhBcnJheSgyNTYpOwogICAgICBjb25zdCB0bXAgPSBuZXcgRmxvYXQzMkFycmF5KDEpOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7IGkrKykgewogICAgICAgIHRtcFswXSA9IGkgLyAyNTU7CiAgICAgICAgdHJhbnNmZXJGbih0bXAsIDAsIHRtcCwgMCk7CiAgICAgICAgdHJhbnNmZXJNYXBbaV0gPSB0bXBbMF0gKiAyNTUgfCAwOwogICAgICB9CgogICAgICBzbWFza09wdGlvbnMudHJhbnNmZXJNYXAgPSB0cmFuc2Zlck1hcDsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5idWlsZEZvcm1YT2JqZWN0KHJlc291cmNlcywgc21hc2tDb250ZW50LCBzbWFza09wdGlvbnMsIG9wZXJhdG9yTGlzdCwgdGFzaywgc3RhdGVNYW5hZ2VyLnN0YXRlLmNsb25lKCksIGxvY2FsQ29sb3JTcGFjZUNhY2hlKTsKICB9CgogIGhhbmRsZVRyYW5zZmVyRnVuY3Rpb24odHIpIHsKICAgIGxldCB0cmFuc2ZlckFycmF5OwoKICAgIGlmIChBcnJheS5pc0FycmF5KHRyKSkgewogICAgICB0cmFuc2ZlckFycmF5ID0gdHI7CiAgICB9IGVsc2UgaWYgKCgwLCBfZnVuY3Rpb24uaXNQREZGdW5jdGlvbikodHIpKSB7CiAgICAgIHRyYW5zZmVyQXJyYXkgPSBbdHJdOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3QgdHJhbnNmZXJNYXBzID0gW107CiAgICBsZXQgbnVtRm5zID0gMCwKICAgICAgICBudW1FZmZlY3RmdWxGbnMgPSAwOwoKICAgIGZvciAoY29uc3QgZW50cnkgb2YgdHJhbnNmZXJBcnJheSkgewogICAgICBjb25zdCB0cmFuc2Zlck9iaiA9IHRoaXMueHJlZi5mZXRjaElmUmVmKGVudHJ5KTsKICAgICAgbnVtRm5zKys7CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkodHJhbnNmZXJPYmosICJJZGVudGl0eSIpKSB7CiAgICAgICAgdHJhbnNmZXJNYXBzLnB1c2gobnVsbCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0gZWxzZSBpZiAoISgwLCBfZnVuY3Rpb24uaXNQREZGdW5jdGlvbikodHJhbnNmZXJPYmopKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IHRyYW5zZmVyRm4gPSB0aGlzLl9wZGZGdW5jdGlvbkZhY3RvcnkuY3JlYXRlKHRyYW5zZmVyT2JqKTsKCiAgICAgIGNvbnN0IHRyYW5zZmVyTWFwID0gbmV3IFVpbnQ4QXJyYXkoMjU2KSwKICAgICAgICAgICAgdG1wID0gbmV3IEZsb2F0MzJBcnJheSgxKTsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMjU2OyBqKyspIHsKICAgICAgICB0bXBbMF0gPSBqIC8gMjU1OwogICAgICAgIHRyYW5zZmVyRm4odG1wLCAwLCB0bXAsIDApOwogICAgICAgIHRyYW5zZmVyTWFwW2pdID0gdG1wWzBdICogMjU1IHwgMDsKICAgICAgfQoKICAgICAgdHJhbnNmZXJNYXBzLnB1c2godHJhbnNmZXJNYXApOwogICAgICBudW1FZmZlY3RmdWxGbnMrKzsKICAgIH0KCiAgICBpZiAoIShudW1GbnMgPT09IDEgfHwgbnVtRm5zID09PSA0KSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBpZiAobnVtRWZmZWN0ZnVsRm5zID09PSAwKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHJldHVybiB0cmFuc2Zlck1hcHM7CiAgfQoKICBoYW5kbGVUaWxpbmdUeXBlKGZuLCBjb2xvciwgcmVzb3VyY2VzLCBwYXR0ZXJuLCBwYXR0ZXJuRGljdCwgb3BlcmF0b3JMaXN0LCB0YXNrLCBsb2NhbFRpbGluZ1BhdHRlcm5DYWNoZSkgewogICAgY29uc3QgdGlsaW5nT3BMaXN0ID0gbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpOwoKICAgIGNvbnN0IHBhdHRlcm5SZXNvdXJjZXMgPSBfcHJpbWl0aXZlcy5EaWN0Lm1lcmdlKHsKICAgICAgeHJlZjogdGhpcy54cmVmLAogICAgICBkaWN0QXJyYXk6IFtwYXR0ZXJuRGljdC5nZXQoIlJlc291cmNlcyIpLCByZXNvdXJjZXNdCiAgICB9KTsKCiAgICByZXR1cm4gdGhpcy5nZXRPcGVyYXRvckxpc3QoewogICAgICBzdHJlYW06IHBhdHRlcm4sCiAgICAgIHRhc2ssCiAgICAgIHJlc291cmNlczogcGF0dGVyblJlc291cmNlcywKICAgICAgb3BlcmF0b3JMaXN0OiB0aWxpbmdPcExpc3QKICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICBjb25zdCBvcGVyYXRvckxpc3RJUiA9IHRpbGluZ09wTGlzdC5nZXRJUigpOwogICAgICBjb25zdCB0aWxpbmdQYXR0ZXJuSVIgPSAoMCwgX3BhdHRlcm4uZ2V0VGlsaW5nUGF0dGVybklSKShvcGVyYXRvckxpc3RJUiwgcGF0dGVybkRpY3QsIGNvbG9yKTsKICAgICAgb3BlcmF0b3JMaXN0LmFkZERlcGVuZGVuY2llcyh0aWxpbmdPcExpc3QuZGVwZW5kZW5jaWVzKTsKICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKGZuLCB0aWxpbmdQYXR0ZXJuSVIpOwoKICAgICAgaWYgKHBhdHRlcm5EaWN0Lm9iaklkKSB7CiAgICAgICAgbG9jYWxUaWxpbmdQYXR0ZXJuQ2FjaGUuc2V0KG51bGwsIHBhdHRlcm5EaWN0Lm9iaklkLCB7CiAgICAgICAgICBvcGVyYXRvckxpc3RJUiwKICAgICAgICAgIGRpY3Q6IHBhdHRlcm5EaWN0CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pLmNhdGNoKHJlYXNvbiA9PiB7CiAgICAgIGlmIChyZWFzb24gaW5zdGFuY2VvZiBfdXRpbC5BYm9ydEV4Y2VwdGlvbikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICB0aGlzLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvclRpbGluZ1BhdHRlcm4KICAgICAgICB9KTsKICAgICAgICAoMCwgX3V0aWwud2FybikoYGhhbmRsZVRpbGluZ1R5cGUgLSBpZ25vcmluZyBwYXR0ZXJuOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRocm93IHJlYXNvbjsKICAgIH0pOwogIH0KCiAgaGFuZGxlU2V0Rm9udChyZXNvdXJjZXMsIGZvbnRBcmdzLCBmb250UmVmLCBvcGVyYXRvckxpc3QsIHRhc2ssIHN0YXRlKSB7CiAgICBsZXQgZmFsbGJhY2tGb250RGljdCA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDogbnVsbDsKICAgIGxldCBjc3NGb250SW5mbyA9IGFyZ3VtZW50cy5sZW5ndGggPiA3ICYmIGFyZ3VtZW50c1s3XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzddIDogbnVsbDsKICAgIGNvbnN0IGZvbnROYW1lID0gZm9udEFyZ3MgJiYgZm9udEFyZ3NbMF0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gZm9udEFyZ3NbMF0ubmFtZSA6IG51bGw7CiAgICByZXR1cm4gdGhpcy5sb2FkRm9udChmb250TmFtZSwgZm9udFJlZiwgcmVzb3VyY2VzLCBmYWxsYmFja0ZvbnREaWN0LCBjc3NGb250SW5mbykudGhlbih0cmFuc2xhdGVkID0+IHsKICAgICAgaWYgKCF0cmFuc2xhdGVkLmZvbnQuaXNUeXBlM0ZvbnQpIHsKICAgICAgICByZXR1cm4gdHJhbnNsYXRlZDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRyYW5zbGF0ZWQubG9hZFR5cGUzRGF0YSh0aGlzLCByZXNvdXJjZXMsIHRhc2spLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIG9wZXJhdG9yTGlzdC5hZGREZXBlbmRlbmNpZXModHJhbnNsYXRlZC50eXBlM0RlcGVuZGVuY2llcyk7CiAgICAgICAgcmV0dXJuIHRyYW5zbGF0ZWQ7CiAgICAgIH0pLmNhdGNoKHJlYXNvbiA9PiB7CiAgICAgICAgdGhpcy5oYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JGb250TG9hZFR5cGUzCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2xhdGVkRm9udCh7CiAgICAgICAgICBsb2FkZWROYW1lOiAiZ19mb250X2Vycm9yIiwKICAgICAgICAgIGZvbnQ6IG5ldyBfZm9udHMuRXJyb3JGb250KGBUeXBlMyBmb250IGxvYWQgZXJyb3I6ICR7cmVhc29ufWApLAogICAgICAgICAgZGljdDogdHJhbnNsYXRlZC5mb250LAogICAgICAgICAgZXZhbHVhdG9yT3B0aW9uczogdGhpcy5vcHRpb25zCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSkudGhlbih0cmFuc2xhdGVkID0+IHsKICAgICAgc3RhdGUuZm9udCA9IHRyYW5zbGF0ZWQuZm9udDsKICAgICAgdHJhbnNsYXRlZC5zZW5kKHRoaXMuaGFuZGxlcik7CiAgICAgIHJldHVybiB0cmFuc2xhdGVkLmxvYWRlZE5hbWU7CiAgICB9KTsKICB9CgogIGhhbmRsZVRleHQoY2hhcnMsIHN0YXRlKSB7CiAgICBjb25zdCBmb250ID0gc3RhdGUuZm9udDsKICAgIGNvbnN0IGdseXBocyA9IGZvbnQuY2hhcnNUb0dseXBocyhjaGFycyk7CgogICAgaWYgKGZvbnQuZGF0YSkgewogICAgICBjb25zdCBpc0FkZFRvUGF0aFNldCA9ICEhKHN0YXRlLnRleHRSZW5kZXJpbmdNb2RlICYgX3V0aWwuVGV4dFJlbmRlcmluZ01vZGUuQUREX1RPX1BBVEhfRkxBRyk7CgogICAgICBpZiAoaXNBZGRUb1BhdGhTZXQgfHwgc3RhdGUuZmlsbENvbG9yU3BhY2UubmFtZSA9PT0gIlBhdHRlcm4iIHx8IGZvbnQuZGlzYWJsZUZvbnRGYWNlIHx8IHRoaXMub3B0aW9ucy5kaXNhYmxlRm9udEZhY2UpIHsKICAgICAgICBQYXJ0aWFsRXZhbHVhdG9yLmJ1aWxkRm9udFBhdGhzKGZvbnQsIGdseXBocywgdGhpcy5oYW5kbGVyLCB0aGlzLm9wdGlvbnMpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGdseXBoczsKICB9CgogIGVuc3VyZVN0YXRlRm9udChzdGF0ZSkgewogICAgaWYgKHN0YXRlLmZvbnQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHJlYXNvbiA9IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTWlzc2luZyBzZXRGb250IChUZikgb3BlcmF0b3IgYmVmb3JlIHRleHQgcmVuZGVyaW5nIG9wZXJhdG9yLiIpOwoKICAgIGlmICh0aGlzLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgIHRoaXMuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvckZvbnRTdGF0ZQogICAgICB9KTsKICAgICAgKDAsIF91dGlsLndhcm4pKGBlbnN1cmVTdGF0ZUZvbnQ6ICIke3JlYXNvbn0iLmApOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhyb3cgcmVhc29uOwogIH0KCiAgYXN5bmMgc2V0R1N0YXRlKF9yZWYzKSB7CiAgICBsZXQgewogICAgICByZXNvdXJjZXMsCiAgICAgIGdTdGF0ZSwKICAgICAgb3BlcmF0b3JMaXN0LAogICAgICBjYWNoZUtleSwKICAgICAgdGFzaywKICAgICAgc3RhdGVNYW5hZ2VyLAogICAgICBsb2NhbEdTdGF0ZUNhY2hlLAogICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgfSA9IF9yZWYzOwogICAgY29uc3QgZ1N0YXRlUmVmID0gZ1N0YXRlLm9iaklkOwogICAgbGV0IGlzU2ltcGxlR1N0YXRlID0gdHJ1ZTsKICAgIGNvbnN0IGdTdGF0ZU9iaiA9IFtdOwogICAgY29uc3QgZ1N0YXRlS2V5cyA9IGdTdGF0ZS5nZXRLZXlzKCk7CiAgICBsZXQgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGdTdGF0ZUtleXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCBrZXkgPSBnU3RhdGVLZXlzW2ldOwogICAgICBjb25zdCB2YWx1ZSA9IGdTdGF0ZS5nZXQoa2V5KTsKCiAgICAgIHN3aXRjaCAoa2V5KSB7CiAgICAgICAgY2FzZSAiVHlwZSI6CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiTFciOgogICAgICAgIGNhc2UgIkxDIjoKICAgICAgICBjYXNlICJMSiI6CiAgICAgICAgY2FzZSAiTUwiOgogICAgICAgIGNhc2UgIkQiOgogICAgICAgIGNhc2UgIlJJIjoKICAgICAgICBjYXNlICJGTCI6CiAgICAgICAgY2FzZSAiQ0EiOgogICAgICAgIGNhc2UgImNhIjoKICAgICAgICAgIGdTdGF0ZU9iai5wdXNoKFtrZXksIHZhbHVlXSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiRm9udCI6CiAgICAgICAgICBpc1NpbXBsZUdTdGF0ZSA9IGZhbHNlOwogICAgICAgICAgcHJvbWlzZSA9IHByb21pc2UudGhlbigoKSA9PiB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZVNldEZvbnQocmVzb3VyY2VzLCBudWxsLCB2YWx1ZVswXSwgb3BlcmF0b3JMaXN0LCB0YXNrLCBzdGF0ZU1hbmFnZXIuc3RhdGUpLnRoZW4oZnVuY3Rpb24gKGxvYWRlZE5hbWUpIHsKICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkRGVwZW5kZW5jeShsb2FkZWROYW1lKTsKICAgICAgICAgICAgICBnU3RhdGVPYmoucHVzaChba2V5LCBbbG9hZGVkTmFtZSwgdmFsdWVbMV1dXSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiQk0iOgogICAgICAgICAgZ1N0YXRlT2JqLnB1c2goW2tleSwgbm9ybWFsaXplQmxlbmRNb2RlKHZhbHVlKV0pOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlNNYXNrIjoKICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKSh2YWx1ZSwgIk5vbmUiKSkgewogICAgICAgICAgICBnU3RhdGVPYmoucHVzaChba2V5LCBmYWxzZV0pOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgICAgIGlzU2ltcGxlR1N0YXRlID0gZmFsc2U7CiAgICAgICAgICAgIHByb21pc2UgPSBwcm9taXNlLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZVNNYXNrKHZhbHVlLCByZXNvdXJjZXMsIG9wZXJhdG9yTGlzdCwgdGFzaywgc3RhdGVNYW5hZ2VyLCBsb2NhbENvbG9yU3BhY2VDYWNoZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBnU3RhdGVPYmoucHVzaChba2V5LCB0cnVlXSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVuc3VwcG9ydGVkIFNNYXNrIHR5cGUiKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiVFIiOgogICAgICAgICAgY29uc3QgdHJhbnNmZXJNYXBzID0gdGhpcy5oYW5kbGVUcmFuc2ZlckZ1bmN0aW9uKHZhbHVlKTsKICAgICAgICAgIGdTdGF0ZU9iai5wdXNoKFtrZXksIHRyYW5zZmVyTWFwc10pOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIk9QIjoKICAgICAgICBjYXNlICJvcCI6CiAgICAgICAgY2FzZSAiT1BNIjoKICAgICAgICBjYXNlICJCRyI6CiAgICAgICAgY2FzZSAiQkcyIjoKICAgICAgICBjYXNlICJVQ1IiOgogICAgICAgIGNhc2UgIlVDUjIiOgogICAgICAgIGNhc2UgIlRSMiI6CiAgICAgICAgY2FzZSAiSFQiOgogICAgICAgIGNhc2UgIlNNIjoKICAgICAgICBjYXNlICJTQSI6CiAgICAgICAgY2FzZSAiQUlTIjoKICAgICAgICBjYXNlICJUSyI6CiAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoImdyYXBoaWMgc3RhdGUgb3BlcmF0b3IgIiArIGtleSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiVW5rbm93biBncmFwaGljIHN0YXRlIG9wZXJhdG9yICIgKyBrZXkpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKGdTdGF0ZU9iai5sZW5ndGggPiAwKSB7CiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5zZXRHU3RhdGUsIFtnU3RhdGVPYmpdKTsKICAgICAgfQoKICAgICAgaWYgKGlzU2ltcGxlR1N0YXRlKSB7CiAgICAgICAgbG9jYWxHU3RhdGVDYWNoZS5zZXQoY2FjaGVLZXksIGdTdGF0ZVJlZiwgZ1N0YXRlT2JqKTsKICAgICAgfQogICAgfSk7CiAgfQoKICBsb2FkRm9udChmb250TmFtZSwgZm9udCwgcmVzb3VyY2VzKSB7CiAgICBsZXQgZmFsbGJhY2tGb250RGljdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogbnVsbDsKICAgIGxldCBjc3NGb250SW5mbyA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogbnVsbDsKCiAgICBjb25zdCBlcnJvckZvbnQgPSBhc3luYyAoKSA9PiB7CiAgICAgIHJldHVybiBuZXcgVHJhbnNsYXRlZEZvbnQoewogICAgICAgIGxvYWRlZE5hbWU6ICJnX2ZvbnRfZXJyb3IiLAogICAgICAgIGZvbnQ6IG5ldyBfZm9udHMuRXJyb3JGb250KGBGb250ICIke2ZvbnROYW1lfSIgaXMgbm90IGF2YWlsYWJsZS5gKSwKICAgICAgICBkaWN0OiBmb250LAogICAgICAgIGV2YWx1YXRvck9wdGlvbnM6IHRoaXMub3B0aW9ucwogICAgICB9KTsKICAgIH07CgogICAgY29uc3QgeHJlZiA9IHRoaXMueHJlZjsKICAgIGxldCBmb250UmVmOwoKICAgIGlmIChmb250KSB7CiAgICAgIGlmIChmb250IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgZm9udFJlZiA9IGZvbnQ7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGZvbnRSZXMgPSByZXNvdXJjZXMuZ2V0KCJGb250Iik7CgogICAgICBpZiAoZm9udFJlcykgewogICAgICAgIGZvbnRSZWYgPSBmb250UmVzLmdldFJhdyhmb250TmFtZSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIWZvbnRSZWYpIHsKICAgICAgY29uc3QgcGFydGlhbE1zZyA9IGBGb250ICIke2ZvbnROYW1lIHx8IGZvbnQgJiYgZm9udC50b1N0cmluZygpfSIgaXMgbm90IGF2YWlsYWJsZWA7CgogICAgICBpZiAoIXRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMgJiYgIXRoaXMucGFyc2luZ1R5cGUzRm9udCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgJHtwYXJ0aWFsTXNnfS5gKTsKICAgICAgICByZXR1cm4gZXJyb3JGb250KCk7CiAgICAgIH0KCiAgICAgIHRoaXMuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvckZvbnRNaXNzaW5nCiAgICAgIH0pOwogICAgICAoMCwgX3V0aWwud2FybikoYCR7cGFydGlhbE1zZ30gLS0gYXR0ZW1wdGluZyB0byBmYWxsYmFjayB0byBhIGRlZmF1bHQgZm9udC5gKTsKCiAgICAgIGlmIChmYWxsYmFja0ZvbnREaWN0KSB7CiAgICAgICAgZm9udFJlZiA9IGZhbGxiYWNrRm9udERpY3Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9udFJlZiA9IFBhcnRpYWxFdmFsdWF0b3IuZmFsbGJhY2tGb250RGljdDsKICAgICAgfQogICAgfQoKICAgIGlmICh0aGlzLnBhcnNpbmdUeXBlM0ZvbnQgJiYgdGhpcy50eXBlM0ZvbnRSZWZzLmhhcyhmb250UmVmKSkgewogICAgICByZXR1cm4gZXJyb3JGb250KCk7CiAgICB9CgogICAgaWYgKHRoaXMuZm9udENhY2hlLmhhcyhmb250UmVmKSkgewogICAgICByZXR1cm4gdGhpcy5mb250Q2FjaGUuZ2V0KGZvbnRSZWYpOwogICAgfQoKICAgIGZvbnQgPSB4cmVmLmZldGNoSWZSZWYoZm9udFJlZik7CgogICAgaWYgKCEoZm9udCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiBlcnJvckZvbnQoKTsKICAgIH0KCiAgICBpZiAoZm9udC5jYWNoZUtleSAmJiB0aGlzLmZvbnRDYWNoZS5oYXMoZm9udC5jYWNoZUtleSkpIHsKICAgICAgcmV0dXJuIHRoaXMuZm9udENhY2hlLmdldChmb250LmNhY2hlS2V5KTsKICAgIH0KCiAgICBjb25zdCBmb250Q2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICAgIGxldCBwcmVFdmFsdWF0ZWRGb250OwoKICAgIHRyeSB7CiAgICAgIHByZUV2YWx1YXRlZEZvbnQgPSB0aGlzLnByZUV2YWx1YXRlRm9udChmb250KTsKICAgICAgcHJlRXZhbHVhdGVkRm9udC5jc3NGb250SW5mbyA9IGNzc0ZvbnRJbmZvOwogICAgfSBjYXRjaCAocmVhc29uKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgbG9hZEZvbnQgLSBwcmVFdmFsdWF0ZUZvbnQgZmFpbGVkOiAiJHtyZWFzb259Ii5gKTsKICAgICAgcmV0dXJuIGVycm9yRm9udCgpOwogICAgfQoKICAgIGNvbnN0IHsKICAgICAgZGVzY3JpcHRvciwKICAgICAgaGFzaAogICAgfSA9IHByZUV2YWx1YXRlZEZvbnQ7CiAgICBjb25zdCBmb250UmVmSXNSZWYgPSBmb250UmVmIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmOwogICAgbGV0IGZvbnRJRDsKCiAgICBpZiAoZm9udFJlZklzUmVmKSB7CiAgICAgIGZvbnRJRCA9IGBmJHtmb250UmVmLnRvU3RyaW5nKCl9YDsKICAgIH0KCiAgICBpZiAoaGFzaCAmJiBkZXNjcmlwdG9yIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBpZiAoIWRlc2NyaXB0b3IuZm9udEFsaWFzZXMpIHsKICAgICAgICBkZXNjcmlwdG9yLmZvbnRBbGlhc2VzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgfQoKICAgICAgY29uc3QgZm9udEFsaWFzZXMgPSBkZXNjcmlwdG9yLmZvbnRBbGlhc2VzOwoKICAgICAgaWYgKGZvbnRBbGlhc2VzW2hhc2hdKSB7CiAgICAgICAgY29uc3QgYWxpYXNGb250UmVmID0gZm9udEFsaWFzZXNbaGFzaF0uYWxpYXNSZWY7CgogICAgICAgIGlmIChmb250UmVmSXNSZWYgJiYgYWxpYXNGb250UmVmICYmIHRoaXMuZm9udENhY2hlLmhhcyhhbGlhc0ZvbnRSZWYpKSB7CiAgICAgICAgICB0aGlzLmZvbnRDYWNoZS5wdXRBbGlhcyhmb250UmVmLCBhbGlhc0ZvbnRSZWYpOwogICAgICAgICAgcmV0dXJuIHRoaXMuZm9udENhY2hlLmdldChmb250UmVmKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9udEFsaWFzZXNbaGFzaF0gPSB7CiAgICAgICAgICBmb250SUQ6IHRoaXMuaWRGYWN0b3J5LmNyZWF0ZUZvbnRJZCgpCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgaWYgKGZvbnRSZWZJc1JlZikgewogICAgICAgIGZvbnRBbGlhc2VzW2hhc2hdLmFsaWFzUmVmID0gZm9udFJlZjsKICAgICAgfQoKICAgICAgZm9udElEID0gZm9udEFsaWFzZXNbaGFzaF0uZm9udElEOwogICAgfQoKICAgIGlmIChmb250UmVmSXNSZWYpIHsKICAgICAgdGhpcy5mb250Q2FjaGUucHV0KGZvbnRSZWYsIGZvbnRDYXBhYmlsaXR5LnByb21pc2UpOwogICAgfSBlbHNlIHsKICAgICAgaWYgKCFmb250SUQpIHsKICAgICAgICBmb250SUQgPSB0aGlzLmlkRmFjdG9yeS5jcmVhdGVGb250SWQoKTsKICAgICAgfQoKICAgICAgZm9udC5jYWNoZUtleSA9IGBjYWNoZUtleV8ke2ZvbnRJRH1gOwogICAgICB0aGlzLmZvbnRDYWNoZS5wdXQoZm9udC5jYWNoZUtleSwgZm9udENhcGFiaWxpdHkucHJvbWlzZSk7CiAgICB9CgogICAgKDAsIF91dGlsLmFzc2VydCkoZm9udElEICYmIGZvbnRJRC5zdGFydHNXaXRoKCJmIiksICdUaGUgImZvbnRJRCIgbXVzdCBiZSAoY29ycmVjdGx5KSBkZWZpbmVkLicpOwogICAgZm9udC5sb2FkZWROYW1lID0gYCR7dGhpcy5pZEZhY3RvcnkuZ2V0RG9jSWQoKX1fJHtmb250SUR9YDsKICAgIHRoaXMudHJhbnNsYXRlRm9udChwcmVFdmFsdWF0ZWRGb250KS50aGVuKHRyYW5zbGF0ZWRGb250ID0+IHsKICAgICAgaWYgKHRyYW5zbGF0ZWRGb250LmZvbnRUeXBlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB4cmVmLnN0YXRzLmFkZEZvbnRUeXBlKHRyYW5zbGF0ZWRGb250LmZvbnRUeXBlKTsKICAgICAgfQoKICAgICAgZm9udENhcGFiaWxpdHkucmVzb2x2ZShuZXcgVHJhbnNsYXRlZEZvbnQoewogICAgICAgIGxvYWRlZE5hbWU6IGZvbnQubG9hZGVkTmFtZSwKICAgICAgICBmb250OiB0cmFuc2xhdGVkRm9udCwKICAgICAgICBkaWN0OiBmb250LAogICAgICAgIGV2YWx1YXRvck9wdGlvbnM6IHRoaXMub3B0aW9ucwogICAgICB9KSk7CiAgICB9KS5jYXRjaChyZWFzb24gPT4gewogICAgICB0aGlzLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JGb250VHJhbnNsYXRlCiAgICAgIH0pOwogICAgICAoMCwgX3V0aWwud2FybikoYGxvYWRGb250IC0gdHJhbnNsYXRlRm9udCBmYWlsZWQ6ICIke3JlYXNvbn0iLmApOwoKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBmb250RmlsZTMgPSBkZXNjcmlwdG9yICYmIGRlc2NyaXB0b3IuZ2V0KCJGb250RmlsZTMiKTsKICAgICAgICBjb25zdCBzdWJ0eXBlID0gZm9udEZpbGUzICYmIGZvbnRGaWxlMy5nZXQoIlN1YnR5cGUiKTsKICAgICAgICBjb25zdCBmb250VHlwZSA9ICgwLCBfZm9udHNfdXRpbHMuZ2V0Rm9udFR5cGUpKHByZUV2YWx1YXRlZEZvbnQudHlwZSwgc3VidHlwZSAmJiBzdWJ0eXBlLm5hbWUpOwoKICAgICAgICBpZiAoZm9udFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgeHJlZi5zdGF0cy5hZGRGb250VHlwZShmb250VHlwZSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChleCkge30KCiAgICAgIGZvbnRDYXBhYmlsaXR5LnJlc29sdmUobmV3IFRyYW5zbGF0ZWRGb250KHsKICAgICAgICBsb2FkZWROYW1lOiBmb250LmxvYWRlZE5hbWUsCiAgICAgICAgZm9udDogbmV3IF9mb250cy5FcnJvckZvbnQocmVhc29uIGluc3RhbmNlb2YgRXJyb3IgPyByZWFzb24ubWVzc2FnZSA6IHJlYXNvbiksCiAgICAgICAgZGljdDogZm9udCwKICAgICAgICBldmFsdWF0b3JPcHRpb25zOiB0aGlzLm9wdGlvbnMKICAgICAgfSkpOwogICAgfSk7CiAgICByZXR1cm4gZm9udENhcGFiaWxpdHkucHJvbWlzZTsKICB9CgogIGJ1aWxkUGF0aChvcGVyYXRvckxpc3QsIGZuLCBhcmdzKSB7CiAgICBsZXQgcGFyc2luZ1RleHQgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgY29uc3QgbGFzdEluZGV4ID0gb3BlcmF0b3JMaXN0Lmxlbmd0aCAtIDE7CgogICAgaWYgKCFhcmdzKSB7CiAgICAgIGFyZ3MgPSBbXTsKICAgIH0KCiAgICBsZXQgbWluTWF4OwoKICAgIGlmIChsYXN0SW5kZXggPCAwIHx8IG9wZXJhdG9yTGlzdC5mbkFycmF5W2xhc3RJbmRleF0gIT09IF91dGlsLk9QUy5jb25zdHJ1Y3RQYXRoKSB7CiAgICAgIGlmIChwYXJzaW5nVGV4dCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgRW5jb3VudGVyZWQgcGF0aCBvcGVyYXRvciAiJHtmbn0iIGluc2lkZSBvZiBhIHRleHQgb2JqZWN0LmApOwogICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuc2F2ZSwgbnVsbCk7CiAgICAgIH0KCiAgICAgIG1pbk1heCA9IFtJbmZpbml0eSwgLUluZmluaXR5LCBJbmZpbml0eSwgLUluZmluaXR5XTsKICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5jb25zdHJ1Y3RQYXRoLCBbW2ZuXSwgYXJncywgbWluTWF4XSk7CgogICAgICBpZiAocGFyc2luZ1RleHQpIHsKICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLnJlc3RvcmUsIG51bGwpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjb25zdCBvcEFyZ3MgPSBvcGVyYXRvckxpc3QuYXJnc0FycmF5W2xhc3RJbmRleF07CiAgICAgIG9wQXJnc1swXS5wdXNoKGZuKTsKICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkob3BBcmdzWzFdLCBhcmdzKTsKICAgICAgbWluTWF4ID0gb3BBcmdzWzJdOwogICAgfQoKICAgIHN3aXRjaCAoZm4pIHsKICAgICAgY2FzZSBfdXRpbC5PUFMucmVjdGFuZ2xlOgogICAgICAgIG1pbk1heFswXSA9IE1hdGgubWluKG1pbk1heFswXSwgYXJnc1swXSwgYXJnc1swXSArIGFyZ3NbMl0pOwogICAgICAgIG1pbk1heFsxXSA9IE1hdGgubWF4KG1pbk1heFsxXSwgYXJnc1swXSwgYXJnc1swXSArIGFyZ3NbMl0pOwogICAgICAgIG1pbk1heFsyXSA9IE1hdGgubWluKG1pbk1heFsyXSwgYXJnc1sxXSwgYXJnc1sxXSArIGFyZ3NbM10pOwogICAgICAgIG1pbk1heFszXSA9IE1hdGgubWF4KG1pbk1heFszXSwgYXJnc1sxXSwgYXJnc1sxXSArIGFyZ3NbM10pOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBfdXRpbC5PUFMubW92ZVRvOgogICAgICBjYXNlIF91dGlsLk9QUy5saW5lVG86CiAgICAgICAgbWluTWF4WzBdID0gTWF0aC5taW4obWluTWF4WzBdLCBhcmdzWzBdKTsKICAgICAgICBtaW5NYXhbMV0gPSBNYXRoLm1heChtaW5NYXhbMV0sIGFyZ3NbMF0pOwogICAgICAgIG1pbk1heFsyXSA9IE1hdGgubWluKG1pbk1heFsyXSwgYXJnc1sxXSk7CiAgICAgICAgbWluTWF4WzNdID0gTWF0aC5tYXgobWluTWF4WzNdLCBhcmdzWzFdKTsKICAgICAgICBicmVhazsKICAgIH0KICB9CgogIHBhcnNlQ29sb3JTcGFjZShfcmVmNCkgewogICAgbGV0IHsKICAgICAgY3MsCiAgICAgIHJlc291cmNlcywKICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgIH0gPSBfcmVmNDsKICAgIHJldHVybiBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnBhcnNlQXN5bmMoewogICAgICBjcywKICAgICAgeHJlZjogdGhpcy54cmVmLAogICAgICByZXNvdXJjZXMsCiAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeTogdGhpcy5fcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgfSkuY2F0Y2gocmVhc29uID0+IHsKICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgdGhpcy5oYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JDb2xvclNwYWNlCiAgICAgICAgfSk7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBwYXJzZUNvbG9yU3BhY2UgLSBpZ25vcmluZyBDb2xvclNwYWNlOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdGhyb3cgcmVhc29uOwogICAgfSk7CiAgfQoKICBwYXJzZVNoYWRpbmcoX3JlZjUpIHsKICAgIGxldCB7CiAgICAgIHNoYWRpbmcsCiAgICAgIHJlc291cmNlcywKICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUsCiAgICAgIGxvY2FsU2hhZGluZ1BhdHRlcm5DYWNoZQogICAgfSA9IF9yZWY1OwogICAgbGV0IGlkID0gbG9jYWxTaGFkaW5nUGF0dGVybkNhY2hlLmdldChzaGFkaW5nKTsKCiAgICBpZiAoIWlkKSB7CiAgICAgIHZhciBzaGFkaW5nRmlsbCA9IF9wYXR0ZXJuLlBhdHRlcm4ucGFyc2VTaGFkaW5nKHNoYWRpbmcsIHRoaXMueHJlZiwgcmVzb3VyY2VzLCB0aGlzLmhhbmRsZXIsIHRoaXMuX3BkZkZ1bmN0aW9uRmFjdG9yeSwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpOwoKICAgICAgY29uc3QgcGF0dGVybklSID0gc2hhZGluZ0ZpbGwuZ2V0SVIoKTsKICAgICAgaWQgPSBgcGF0dGVybl8ke3RoaXMuaWRGYWN0b3J5LmNyZWF0ZU9iaklkKCl9YDsKICAgICAgbG9jYWxTaGFkaW5nUGF0dGVybkNhY2hlLnNldChzaGFkaW5nLCBpZCk7CiAgICAgIHRoaXMuaGFuZGxlci5zZW5kKCJvYmoiLCBbaWQsIHRoaXMucGFnZUluZGV4LCAiUGF0dGVybiIsIHBhdHRlcm5JUl0pOwogICAgfQoKICAgIHJldHVybiBpZDsKICB9CgogIGhhbmRsZUNvbG9yTihvcGVyYXRvckxpc3QsIGZuLCBhcmdzLCBjcywgcGF0dGVybnMsIHJlc291cmNlcywgdGFzaywgbG9jYWxDb2xvclNwYWNlQ2FjaGUsIGxvY2FsVGlsaW5nUGF0dGVybkNhY2hlLCBsb2NhbFNoYWRpbmdQYXR0ZXJuQ2FjaGUpIHsKICAgIGNvbnN0IHBhdHRlcm5OYW1lID0gYXJncy5wb3AoKTsKCiAgICBpZiAocGF0dGVybk5hbWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIGNvbnN0IHJhd1BhdHRlcm4gPSBwYXR0ZXJucy5nZXRSYXcocGF0dGVybk5hbWUubmFtZSk7CiAgICAgIGNvbnN0IGxvY2FsVGlsaW5nUGF0dGVybiA9IHJhd1BhdHRlcm4gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYgJiYgbG9jYWxUaWxpbmdQYXR0ZXJuQ2FjaGUuZ2V0QnlSZWYocmF3UGF0dGVybik7CgogICAgICBpZiAobG9jYWxUaWxpbmdQYXR0ZXJuKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IGNvbG9yID0gY3MuYmFzZSA/IGNzLmJhc2UuZ2V0UmdiKGFyZ3MsIDApIDogbnVsbDsKICAgICAgICAgIGNvbnN0IHRpbGluZ1BhdHRlcm5JUiA9ICgwLCBfcGF0dGVybi5nZXRUaWxpbmdQYXR0ZXJuSVIpKGxvY2FsVGlsaW5nUGF0dGVybi5vcGVyYXRvckxpc3RJUiwgbG9jYWxUaWxpbmdQYXR0ZXJuLmRpY3QsIGNvbG9yKTsKICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChmbiwgdGlsaW5nUGF0dGVybklSKTsKICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgICAgfSBjYXRjaCAoZXgpIHt9CiAgICAgIH0KCiAgICAgIGNvbnN0IHBhdHRlcm4gPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZihyYXdQYXR0ZXJuKTsKCiAgICAgIGlmIChwYXR0ZXJuKSB7CiAgICAgICAgY29uc3QgZGljdCA9IHBhdHRlcm4gaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSA/IHBhdHRlcm4uZGljdCA6IHBhdHRlcm47CiAgICAgICAgY29uc3QgdHlwZU51bSA9IGRpY3QuZ2V0KCJQYXR0ZXJuVHlwZSIpOwoKICAgICAgICBpZiAodHlwZU51bSA9PT0gUGF0dGVyblR5cGUuVElMSU5HKSB7CiAgICAgICAgICBjb25zdCBjb2xvciA9IGNzLmJhc2UgPyBjcy5iYXNlLmdldFJnYihhcmdzLCAwKSA6IG51bGw7CiAgICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVUaWxpbmdUeXBlKGZuLCBjb2xvciwgcmVzb3VyY2VzLCBwYXR0ZXJuLCBkaWN0LCBvcGVyYXRvckxpc3QsIHRhc2ssIGxvY2FsVGlsaW5nUGF0dGVybkNhY2hlKTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGVOdW0gPT09IFBhdHRlcm5UeXBlLlNIQURJTkcpIHsKICAgICAgICAgIGNvbnN0IHNoYWRpbmcgPSBkaWN0LmdldCgiU2hhZGluZyIpOwogICAgICAgICAgY29uc3QgbWF0cml4ID0gZGljdC5nZXRBcnJheSgiTWF0cml4Iik7CiAgICAgICAgICBjb25zdCBvYmpJZCA9IHRoaXMucGFyc2VTaGFkaW5nKHsKICAgICAgICAgICAgc2hhZGluZywKICAgICAgICAgICAgcmVzb3VyY2VzLAogICAgICAgICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZSwKICAgICAgICAgICAgbG9jYWxTaGFkaW5nUGF0dGVybkNhY2hlCiAgICAgICAgICB9KTsKICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChmbiwgWyJTaGFkaW5nIiwgb2JqSWQsIG1hdHJpeF0pOwogICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgICB9CgogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgVW5rbm93biBQYXR0ZXJuVHlwZTogJHt0eXBlTnVtfWApOwogICAgICB9CiAgICB9CgogICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBVbmtub3duIFBhdHRlcm5OYW1lOiAke3BhdHRlcm5OYW1lfWApOwogIH0KCiAgX3BhcnNlVmlzaWJpbGl0eUV4cHJlc3Npb24oYXJyYXksIG5lc3RpbmdDb3VudGVyLCBjdXJyZW50UmVzdWx0KSB7CiAgICBjb25zdCBNQVhfTkVTVElORyA9IDEwOwoKICAgIGlmICgrK25lc3RpbmdDb3VudGVyID4gTUFYX05FU1RJTkcpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJWaXNpYmlsaXR5IGV4cHJlc3Npb24gaXMgdG9vIGRlZXBseSBuZXN0ZWQiKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGxlbmd0aCA9IGFycmF5Lmxlbmd0aDsKICAgIGNvbnN0IG9wZXJhdG9yID0gdGhpcy54cmVmLmZldGNoSWZSZWYoYXJyYXlbMF0pOwoKICAgIGlmIChsZW5ndGggPCAyIHx8ICEob3BlcmF0b3IgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICAoMCwgX3V0aWwud2FybikoIkludmFsaWQgdmlzaWJpbGl0eSBleHByZXNzaW9uIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzd2l0Y2ggKG9wZXJhdG9yLm5hbWUpIHsKICAgICAgY2FzZSAiQW5kIjoKICAgICAgY2FzZSAiT3IiOgogICAgICBjYXNlICJOb3QiOgogICAgICAgIGN1cnJlbnRSZXN1bHQucHVzaChvcGVyYXRvci5uYW1lKTsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBJbnZhbGlkIG9wZXJhdG9yICR7b3BlcmF0b3IubmFtZX0gaW4gdmlzaWJpbGl0eSBleHByZXNzaW9uYCk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgcmF3ID0gYXJyYXlbaV07CiAgICAgIGNvbnN0IG9iamVjdCA9IHRoaXMueHJlZi5mZXRjaElmUmVmKHJhdyk7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShvYmplY3QpKSB7CiAgICAgICAgY29uc3QgbmVzdGVkUmVzdWx0ID0gW107CiAgICAgICAgY3VycmVudFJlc3VsdC5wdXNoKG5lc3RlZFJlc3VsdCk7CgogICAgICAgIHRoaXMuX3BhcnNlVmlzaWJpbGl0eUV4cHJlc3Npb24ob2JqZWN0LCBuZXN0aW5nQ291bnRlciwgbmVzdGVkUmVzdWx0KTsKICAgICAgfSBlbHNlIGlmIChyYXcgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICBjdXJyZW50UmVzdWx0LnB1c2gocmF3LnRvU3RyaW5nKCkpOwogICAgICB9CiAgICB9CiAgfQoKICBhc3luYyBwYXJzZU1hcmtlZENvbnRlbnRQcm9wcyhjb250ZW50UHJvcGVydGllcywgcmVzb3VyY2VzKSB7CiAgICBsZXQgb3B0aW9uYWxDb250ZW50OwoKICAgIGlmIChjb250ZW50UHJvcGVydGllcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgY29uc3QgcHJvcGVydGllcyA9IHJlc291cmNlcy5nZXQoIlByb3BlcnRpZXMiKTsKICAgICAgb3B0aW9uYWxDb250ZW50ID0gcHJvcGVydGllcy5nZXQoY29udGVudFByb3BlcnRpZXMubmFtZSk7CiAgICB9IGVsc2UgaWYgKGNvbnRlbnRQcm9wZXJ0aWVzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBvcHRpb25hbENvbnRlbnQgPSBjb250ZW50UHJvcGVydGllczsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiT3B0aW9uYWwgY29udGVudCBwcm9wZXJ0aWVzIG1hbGZvcm1lZC4iKTsKICAgIH0KCiAgICBjb25zdCBvcHRpb25hbENvbnRlbnRUeXBlID0gb3B0aW9uYWxDb250ZW50LmdldCgiVHlwZSIpLm5hbWU7CgogICAgaWYgKG9wdGlvbmFsQ29udGVudFR5cGUgPT09ICJPQ0ciKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdHlwZTogb3B0aW9uYWxDb250ZW50VHlwZSwKICAgICAgICBpZDogb3B0aW9uYWxDb250ZW50Lm9iaklkCiAgICAgIH07CiAgICB9IGVsc2UgaWYgKG9wdGlvbmFsQ29udGVudFR5cGUgPT09ICJPQ01EIikgewogICAgICBjb25zdCBleHByZXNzaW9uID0gb3B0aW9uYWxDb250ZW50LmdldCgiVkUiKTsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KGV4cHJlc3Npb24pKSB7CiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107CgogICAgICAgIHRoaXMuX3BhcnNlVmlzaWJpbGl0eUV4cHJlc3Npb24oZXhwcmVzc2lvbiwgMCwgcmVzdWx0KTsKCiAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB0eXBlOiAiT0NNRCIsCiAgICAgICAgICAgIGV4cHJlc3Npb246IHJlc3VsdAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IG9wdGlvbmFsQ29udGVudEdyb3VwcyA9IG9wdGlvbmFsQ29udGVudC5nZXQoIk9DR3MiKTsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbmFsQ29udGVudEdyb3VwcykgfHwgb3B0aW9uYWxDb250ZW50R3JvdXBzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgIGNvbnN0IGdyb3VwSWRzID0gW107CgogICAgICAgIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbmFsQ29udGVudEdyb3VwcykpIHsKICAgICAgICAgIGZvciAoY29uc3Qgb2NnIG9mIG9wdGlvbmFsQ29udGVudEdyb3VwcykgewogICAgICAgICAgICBncm91cElkcy5wdXNoKG9jZy50b1N0cmluZygpKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgZ3JvdXBJZHMucHVzaChvcHRpb25hbENvbnRlbnRHcm91cHMub2JqSWQpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHR5cGU6IG9wdGlvbmFsQ29udGVudFR5cGUsCiAgICAgICAgICBpZHM6IGdyb3VwSWRzLAogICAgICAgICAgcG9saWN5OiBvcHRpb25hbENvbnRlbnQuZ2V0KCJQIikgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gb3B0aW9uYWxDb250ZW50LmdldCgiUCIpLm5hbWUgOiBudWxsLAogICAgICAgICAgZXhwcmVzc2lvbjogbnVsbAogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAob3B0aW9uYWxDb250ZW50R3JvdXBzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHR5cGU6IG9wdGlvbmFsQ29udGVudFR5cGUsCiAgICAgICAgICBpZDogb3B0aW9uYWxDb250ZW50R3JvdXBzLnRvU3RyaW5nKCkKICAgICAgICB9OwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBnZXRPcGVyYXRvckxpc3QoX3JlZjYpIHsKICAgIGxldCB7CiAgICAgIHN0cmVhbSwKICAgICAgdGFzaywKICAgICAgcmVzb3VyY2VzLAogICAgICBvcGVyYXRvckxpc3QsCiAgICAgIGluaXRpYWxTdGF0ZSA9IG51bGwsCiAgICAgIGZhbGxiYWNrRm9udERpY3QgPSBudWxsCiAgICB9ID0gX3JlZjY7CiAgICByZXNvdXJjZXMgPSByZXNvdXJjZXMgfHwgX3ByaW1pdGl2ZXMuRGljdC5lbXB0eTsKICAgIGluaXRpYWxTdGF0ZSA9IGluaXRpYWxTdGF0ZSB8fCBuZXcgRXZhbFN0YXRlKCk7CgogICAgaWYgKCFvcGVyYXRvckxpc3QpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdnZXRPcGVyYXRvckxpc3Q6IG1pc3NpbmcgIm9wZXJhdG9yTGlzdCIgcGFyYW1ldGVyJyk7CiAgICB9CgogICAgY29uc3Qgc2VsZiA9IHRoaXM7CiAgICBjb25zdCB4cmVmID0gdGhpcy54cmVmOwogICAgbGV0IHBhcnNpbmdUZXh0ID0gZmFsc2U7CiAgICBjb25zdCBsb2NhbEltYWdlQ2FjaGUgPSBuZXcgX2ltYWdlX3V0aWxzLkxvY2FsSW1hZ2VDYWNoZSgpOwogICAgY29uc3QgbG9jYWxDb2xvclNwYWNlQ2FjaGUgPSBuZXcgX2ltYWdlX3V0aWxzLkxvY2FsQ29sb3JTcGFjZUNhY2hlKCk7CiAgICBjb25zdCBsb2NhbEdTdGF0ZUNhY2hlID0gbmV3IF9pbWFnZV91dGlscy5Mb2NhbEdTdGF0ZUNhY2hlKCk7CiAgICBjb25zdCBsb2NhbFRpbGluZ1BhdHRlcm5DYWNoZSA9IG5ldyBfaW1hZ2VfdXRpbHMuTG9jYWxUaWxpbmdQYXR0ZXJuQ2FjaGUoKTsKICAgIGNvbnN0IGxvY2FsU2hhZGluZ1BhdHRlcm5DYWNoZSA9IG5ldyBNYXAoKTsKCiAgICBjb25zdCB4b2JqcyA9IHJlc291cmNlcy5nZXQoIlhPYmplY3QiKSB8fCBfcHJpbWl0aXZlcy5EaWN0LmVtcHR5OwoKICAgIGNvbnN0IHBhdHRlcm5zID0gcmVzb3VyY2VzLmdldCgiUGF0dGVybiIpIHx8IF9wcmltaXRpdmVzLkRpY3QuZW1wdHk7CgogICAgY29uc3Qgc3RhdGVNYW5hZ2VyID0gbmV3IFN0YXRlTWFuYWdlcihpbml0aWFsU3RhdGUpOwogICAgY29uc3QgcHJlcHJvY2Vzc29yID0gbmV3IEV2YWx1YXRvclByZXByb2Nlc3NvcihzdHJlYW0sIHhyZWYsIHN0YXRlTWFuYWdlcik7CiAgICBjb25zdCB0aW1lU2xvdE1hbmFnZXIgPSBuZXcgVGltZVNsb3RNYW5hZ2VyKCk7CgogICAgZnVuY3Rpb24gY2xvc2VQZW5kaW5nUmVzdG9yZU9QUyhhcmd1bWVudCkgewogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBwcmVwcm9jZXNzb3Iuc2F2ZWRTdGF0ZXNEZXB0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLnJlc3RvcmUsIFtdKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiBwcm9taXNlQm9keShyZXNvbHZlLCByZWplY3QpIHsKICAgICAgY29uc3QgbmV4dCA9IGZ1bmN0aW9uIChwcm9taXNlKSB7CiAgICAgICAgUHJvbWlzZS5hbGwoW3Byb21pc2UsIG9wZXJhdG9yTGlzdC5yZWFkeV0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcHJvbWlzZUJvZHkocmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgICAgIHJlamVjdChleCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfTsKCiAgICAgIHRhc2suZW5zdXJlTm90VGVybWluYXRlZCgpOwogICAgICB0aW1lU2xvdE1hbmFnZXIucmVzZXQoKTsKICAgICAgY29uc3Qgb3BlcmF0aW9uID0ge307CiAgICAgIGxldCBzdG9wLCBpLCBpaSwgY3MsIG5hbWUsIGlzVmFsaWROYW1lOwoKICAgICAgd2hpbGUgKCEoc3RvcCA9IHRpbWVTbG90TWFuYWdlci5jaGVjaygpKSkgewogICAgICAgIG9wZXJhdGlvbi5hcmdzID0gbnVsbDsKCiAgICAgICAgaWYgKCFwcmVwcm9jZXNzb3IucmVhZChvcGVyYXRpb24pKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGxldCBhcmdzID0gb3BlcmF0aW9uLmFyZ3M7CiAgICAgICAgbGV0IGZuID0gb3BlcmF0aW9uLmZuOwoKICAgICAgICBzd2l0Y2ggKGZuIHwgMCkgewogICAgICAgICAgY2FzZSBfdXRpbC5PUFMucGFpbnRYT2JqZWN0OgogICAgICAgICAgICBpc1ZhbGlkTmFtZSA9IGFyZ3NbMF0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lOwogICAgICAgICAgICBuYW1lID0gYXJnc1swXS5uYW1lOwoKICAgICAgICAgICAgaWYgKGlzVmFsaWROYW1lKSB7CiAgICAgICAgICAgICAgY29uc3QgbG9jYWxJbWFnZSA9IGxvY2FsSW1hZ2VDYWNoZS5nZXRCeU5hbWUobmFtZSk7CgogICAgICAgICAgICAgIGlmIChsb2NhbEltYWdlKSB7CiAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkSW1hZ2VPcHMobG9jYWxJbWFnZS5mbiwgbG9jYWxJbWFnZS5hcmdzLCBsb2NhbEltYWdlLm9wdGlvbmFsQ29udGVudCk7CiAgICAgICAgICAgICAgICBpbmNyZW1lbnRDYWNoZWRJbWFnZU1hc2tDb3VudChsb2NhbEltYWdlKTsKICAgICAgICAgICAgICAgIGFyZ3MgPSBudWxsOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlWE9iamVjdCwgcmVqZWN0WE9iamVjdCkgewogICAgICAgICAgICAgIGlmICghaXNWYWxpZE5hbWUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiWE9iamVjdCBtdXN0IGJlIHJlZmVycmVkIHRvIGJ5IG5hbWUuIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBsZXQgeG9iaiA9IHhvYmpzLmdldFJhdyhuYW1lKTsKCiAgICAgICAgICAgICAgaWYgKHhvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGxvY2FsSW1hZ2UgPSBsb2NhbEltYWdlQ2FjaGUuZ2V0QnlSZWYoeG9iaik7CgogICAgICAgICAgICAgICAgaWYgKGxvY2FsSW1hZ2UpIHsKICAgICAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZEltYWdlT3BzKGxvY2FsSW1hZ2UuZm4sIGxvY2FsSW1hZ2UuYXJncywgbG9jYWxJbWFnZS5vcHRpb25hbENvbnRlbnQpOwogICAgICAgICAgICAgICAgICBpbmNyZW1lbnRDYWNoZWRJbWFnZU1hc2tDb3VudChsb2NhbEltYWdlKTsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IGdsb2JhbEltYWdlID0gc2VsZi5nbG9iYWxJbWFnZUNhY2hlLmdldERhdGEoeG9iaiwgc2VsZi5wYWdlSW5kZXgpOwoKICAgICAgICAgICAgICAgIGlmIChnbG9iYWxJbWFnZSkgewogICAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkRGVwZW5kZW5jeShnbG9iYWxJbWFnZS5vYmpJZCk7CiAgICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRJbWFnZU9wcyhnbG9iYWxJbWFnZS5mbiwgZ2xvYmFsSW1hZ2UuYXJncywgZ2xvYmFsSW1hZ2Uub3B0aW9uYWxDb250ZW50KTsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHhvYmogPSB4cmVmLmZldGNoKHhvYmopOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKCEoeG9iaiBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJYT2JqZWN0IHNob3VsZCBiZSBhIHN0cmVhbSIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgdHlwZSA9IHhvYmouZGljdC5nZXQoIlN1YnR5cGUiKTsKCiAgICAgICAgICAgICAgaWYgKCEodHlwZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlhPYmplY3Qgc2hvdWxkIGhhdmUgYSBOYW1lIHN1YnR5cGUiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICh0eXBlLm5hbWUgPT09ICJGb3JtIikgewogICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnNhdmUoKTsKICAgICAgICAgICAgICAgIHNlbGYuYnVpbGRGb3JtWE9iamVjdChyZXNvdXJjZXMsIHhvYmosIG51bGwsIG9wZXJhdG9yTGlzdCwgdGFzaywgc3RhdGVNYW5hZ2VyLnN0YXRlLmNsb25lKCksIGxvY2FsQ29sb3JTcGFjZUNhY2hlKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnJlc3RvcmUoKTsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICAgIH0sIHJlamVjdFhPYmplY3QpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZS5uYW1lID09PSAiSW1hZ2UiKSB7CiAgICAgICAgICAgICAgICBzZWxmLmJ1aWxkUGFpbnRJbWFnZVhPYmplY3QoewogICAgICAgICAgICAgICAgICByZXNvdXJjZXMsCiAgICAgICAgICAgICAgICAgIGltYWdlOiB4b2JqLAogICAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QsCiAgICAgICAgICAgICAgICAgIGNhY2hlS2V5OiBuYW1lLAogICAgICAgICAgICAgICAgICBsb2NhbEltYWdlQ2FjaGUsCiAgICAgICAgICAgICAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICAgICAgICAgICAgICB9KS50aGVuKHJlc29sdmVYT2JqZWN0LCByZWplY3RYT2JqZWN0KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUubmFtZSA9PT0gIlBTIikgewogICAgICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJJZ25vcmVkIFhPYmplY3Qgc3VidHlwZSBQUyIpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVuaGFuZGxlZCBYT2JqZWN0IHN1YnR5cGUgJHt0eXBlLm5hbWV9YCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXNvbHZlWE9iamVjdCgpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICAgICAgICAgc2VsZi5oYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICAgICAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvclhPYmplY3QKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBnZXRPcGVyYXRvckxpc3QgLSBpZ25vcmluZyBYT2JqZWN0OiAiJHtyZWFzb259Ii5gKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0Rm9udDoKICAgICAgICAgICAgdmFyIGZvbnRTaXplID0gYXJnc1sxXTsKICAgICAgICAgICAgbmV4dChzZWxmLmhhbmRsZVNldEZvbnQocmVzb3VyY2VzLCBhcmdzLCBudWxsLCBvcGVyYXRvckxpc3QsIHRhc2ssIHN0YXRlTWFuYWdlci5zdGF0ZSwgZmFsbGJhY2tGb250RGljdCkudGhlbihmdW5jdGlvbiAobG9hZGVkTmFtZSkgewogICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGREZXBlbmRlbmN5KGxvYWRlZE5hbWUpOwogICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuc2V0Rm9udCwgW2xvYWRlZE5hbWUsIGZvbnRTaXplXSk7CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmJlZ2luVGV4dDoKICAgICAgICAgICAgcGFyc2luZ1RleHQgPSB0cnVlOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5lbmRUZXh0OgogICAgICAgICAgICBwYXJzaW5nVGV4dCA9IGZhbHNlOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5lbmRJbmxpbmVJbWFnZToKICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gYXJnc1swXS5jYWNoZUtleTsKCiAgICAgICAgICAgIGlmIChjYWNoZUtleSkgewogICAgICAgICAgICAgIGNvbnN0IGxvY2FsSW1hZ2UgPSBsb2NhbEltYWdlQ2FjaGUuZ2V0QnlOYW1lKGNhY2hlS2V5KTsKCiAgICAgICAgICAgICAgaWYgKGxvY2FsSW1hZ2UpIHsKICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRJbWFnZU9wcyhsb2NhbEltYWdlLmZuLCBsb2NhbEltYWdlLmFyZ3MsIGxvY2FsSW1hZ2Uub3B0aW9uYWxDb250ZW50KTsKICAgICAgICAgICAgICAgIGluY3JlbWVudENhY2hlZEltYWdlTWFza0NvdW50KGxvY2FsSW1hZ2UpOwogICAgICAgICAgICAgICAgYXJncyA9IG51bGw7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5leHQoc2VsZi5idWlsZFBhaW50SW1hZ2VYT2JqZWN0KHsKICAgICAgICAgICAgICByZXNvdXJjZXMsCiAgICAgICAgICAgICAgaW1hZ2U6IGFyZ3NbMF0sCiAgICAgICAgICAgICAgaXNJbmxpbmU6IHRydWUsCiAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LAogICAgICAgICAgICAgIGNhY2hlS2V5LAogICAgICAgICAgICAgIGxvY2FsSW1hZ2VDYWNoZSwKICAgICAgICAgICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zaG93VGV4dDoKICAgICAgICAgICAgaWYgKCFzdGF0ZU1hbmFnZXIuc3RhdGUuZm9udCkgewogICAgICAgICAgICAgIHNlbGYuZW5zdXJlU3RhdGVGb250KHN0YXRlTWFuYWdlci5zdGF0ZSk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFyZ3NbMF0gPSBzZWxmLmhhbmRsZVRleHQoYXJnc1swXSwgc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2hvd1NwYWNlZFRleHQ6CiAgICAgICAgICAgIGlmICghc3RhdGVNYW5hZ2VyLnN0YXRlLmZvbnQpIHsKICAgICAgICAgICAgICBzZWxmLmVuc3VyZVN0YXRlRm9udChzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgYXJyID0gYXJnc1swXTsKICAgICAgICAgICAgdmFyIGNvbWJpbmVkR2x5cGhzID0gW107CiAgICAgICAgICAgIHZhciBhcnJMZW5ndGggPSBhcnIubGVuZ3RoOwogICAgICAgICAgICB2YXIgc3RhdGUgPSBzdGF0ZU1hbmFnZXIuc3RhdGU7CgogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYXJyTGVuZ3RoOyArK2kpIHsKICAgICAgICAgICAgICBjb25zdCBhcnJJdGVtID0gYXJyW2ldOwoKICAgICAgICAgICAgICBpZiAodHlwZW9mIGFyckl0ZW0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShjb21iaW5lZEdseXBocywgc2VsZi5oYW5kbGVUZXh0KGFyckl0ZW0sIHN0YXRlKSk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYXJySXRlbSA9PT0gIm51bWJlciIpIHsKICAgICAgICAgICAgICAgIGNvbWJpbmVkR2x5cGhzLnB1c2goYXJySXRlbSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBhcmdzWzBdID0gY29tYmluZWRHbHlwaHM7CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNob3dUZXh0OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5uZXh0TGluZVNob3dUZXh0OgogICAgICAgICAgICBpZiAoIXN0YXRlTWFuYWdlci5zdGF0ZS5mb250KSB7CiAgICAgICAgICAgICAgc2VsZi5lbnN1cmVTdGF0ZUZvbnQoc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5uZXh0TGluZSk7CiAgICAgICAgICAgIGFyZ3NbMF0gPSBzZWxmLmhhbmRsZVRleHQoYXJnc1swXSwgc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2hvd1RleHQ7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLm5leHRMaW5lU2V0U3BhY2luZ1Nob3dUZXh0OgogICAgICAgICAgICBpZiAoIXN0YXRlTWFuYWdlci5zdGF0ZS5mb250KSB7CiAgICAgICAgICAgICAgc2VsZi5lbnN1cmVTdGF0ZUZvbnQoc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5uZXh0TGluZSk7CiAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuc2V0V29yZFNwYWNpbmcsIFthcmdzLnNoaWZ0KCldKTsKICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5zZXRDaGFyU3BhY2luZywgW2FyZ3Muc2hpZnQoKV0pOwogICAgICAgICAgICBhcmdzWzBdID0gc2VsZi5oYW5kbGVUZXh0KGFyZ3NbMF0sIHN0YXRlTWFuYWdlci5zdGF0ZSk7CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNob3dUZXh0OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRUZXh0UmVuZGVyaW5nTW9kZToKICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLnRleHRSZW5kZXJpbmdNb2RlID0gYXJnc1swXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENvbG9yU3BhY2U6CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb25zdCBjYWNoZWRDb2xvclNwYWNlID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5nZXRDYWNoZWQoYXJnc1swXSwgeHJlZiwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpOwoKICAgICAgICAgICAgICBpZiAoY2FjaGVkQ29sb3JTcGFjZSkgewogICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLmZpbGxDb2xvclNwYWNlID0gY2FjaGVkQ29sb3JTcGFjZTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbmV4dChzZWxmLnBhcnNlQ29sb3JTcGFjZSh7CiAgICAgICAgICAgICAgICBjczogYXJnc1swXSwKICAgICAgICAgICAgICAgIHJlc291cmNlcywKICAgICAgICAgICAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoY29sb3JTcGFjZSkgewogICAgICAgICAgICAgICAgaWYgKGNvbG9yU3BhY2UpIHsKICAgICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLmZpbGxDb2xvclNwYWNlID0gY29sb3JTcGFjZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3JTcGFjZToKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNvbnN0IGNhY2hlZENvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLmdldENhY2hlZChhcmdzWzBdLCB4cmVmLCBsb2NhbENvbG9yU3BhY2VDYWNoZSk7CgogICAgICAgICAgICAgIGlmIChjYWNoZWRDb2xvclNwYWNlKSB7CiAgICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZSA9IGNhY2hlZENvbG9yU3BhY2U7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIG5leHQoc2VsZi5wYXJzZUNvbG9yU3BhY2UoewogICAgICAgICAgICAgICAgY3M6IGFyZ3NbMF0sCiAgICAgICAgICAgICAgICByZXNvdXJjZXMsCiAgICAgICAgICAgICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNvbG9yU3BhY2UpIHsKICAgICAgICAgICAgICAgIGlmIChjb2xvclNwYWNlKSB7CiAgICAgICAgICAgICAgICAgIHN0YXRlTWFuYWdlci5zdGF0ZS5zdHJva2VDb2xvclNwYWNlID0gY29sb3JTcGFjZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENvbG9yOgogICAgICAgICAgICBjcyA9IHN0YXRlTWFuYWdlci5zdGF0ZS5maWxsQ29sb3JTcGFjZTsKICAgICAgICAgICAgYXJncyA9IGNzLmdldFJnYihhcmdzLCAwKTsKICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRTdHJva2VDb2xvcjoKICAgICAgICAgICAgY3MgPSBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZTsKICAgICAgICAgICAgYXJncyA9IGNzLmdldFJnYihhcmdzLCAwKTsKICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2V0U3Ryb2tlUkdCQ29sb3I7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZpbGxHcmF5OgogICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuZmlsbENvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuZ3JheTsKICAgICAgICAgICAgYXJncyA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5ncmF5LmdldFJnYihhcmdzLCAwKTsKICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRTdHJva2VHcmF5OgogICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5ncmF5OwogICAgICAgICAgICBhcmdzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmdyYXkuZ2V0UmdiKGFyZ3MsIDApOwogICAgICAgICAgICBmbiA9IF91dGlsLk9QUy5zZXRTdHJva2VSR0JDb2xvcjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENNWUtDb2xvcjoKICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLmZpbGxDb2xvclNwYWNlID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmNteWs7CiAgICAgICAgICAgIGFyZ3MgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuY215ay5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNldEZpbGxSR0JDb2xvcjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlQ01ZS0NvbG9yOgogICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5jbXlrOwogICAgICAgICAgICBhcmdzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmNteWsuZ2V0UmdiKGFyZ3MsIDApOwogICAgICAgICAgICBmbiA9IF91dGlsLk9QUy5zZXRTdHJva2VSR0JDb2xvcjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yOgogICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuZmlsbENvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMucmdiOwogICAgICAgICAgICBhcmdzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLnJnYi5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFN0cm9rZVJHQkNvbG9yOgogICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5yZ2I7CiAgICAgICAgICAgIGFyZ3MgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMucmdiLmdldFJnYihhcmdzLCAwKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENvbG9yTjoKICAgICAgICAgICAgY3MgPSBzdGF0ZU1hbmFnZXIuc3RhdGUuZmlsbENvbG9yU3BhY2U7CgogICAgICAgICAgICBpZiAoY3MubmFtZSA9PT0gIlBhdHRlcm4iKSB7CiAgICAgICAgICAgICAgbmV4dChzZWxmLmhhbmRsZUNvbG9yTihvcGVyYXRvckxpc3QsIF91dGlsLk9QUy5zZXRGaWxsQ29sb3JOLCBhcmdzLCBjcywgcGF0dGVybnMsIHJlc291cmNlcywgdGFzaywgbG9jYWxDb2xvclNwYWNlQ2FjaGUsIGxvY2FsVGlsaW5nUGF0dGVybkNhY2hlLCBsb2NhbFNoYWRpbmdQYXR0ZXJuQ2FjaGUpKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFyZ3MgPSBjcy5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNldEZpbGxSR0JDb2xvcjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3JOOgogICAgICAgICAgICBjcyA9IHN0YXRlTWFuYWdlci5zdGF0ZS5zdHJva2VDb2xvclNwYWNlOwoKICAgICAgICAgICAgaWYgKGNzLm5hbWUgPT09ICJQYXR0ZXJuIikgewogICAgICAgICAgICAgIG5leHQoc2VsZi5oYW5kbGVDb2xvck4ob3BlcmF0b3JMaXN0LCBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3JOLCBhcmdzLCBjcywgcGF0dGVybnMsIHJlc291cmNlcywgdGFzaywgbG9jYWxDb2xvclNwYWNlQ2FjaGUsIGxvY2FsVGlsaW5nUGF0dGVybkNhY2hlLCBsb2NhbFNoYWRpbmdQYXR0ZXJuQ2FjaGUpKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFyZ3MgPSBjcy5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNldFN0cm9rZVJHQkNvbG9yOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zaGFkaW5nRmlsbDoKICAgICAgICAgICAgdmFyIHNoYWRpbmdSZXMgPSByZXNvdXJjZXMuZ2V0KCJTaGFkaW5nIik7CgogICAgICAgICAgICBpZiAoIXNoYWRpbmdSZXMpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk5vIHNoYWRpbmcgcmVzb3VyY2UgZm91bmQiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHNoYWRpbmcgPSBzaGFkaW5nUmVzLmdldChhcmdzWzBdLm5hbWUpOwoKICAgICAgICAgICAgaWYgKCFzaGFkaW5nKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJObyBzaGFkaW5nIG9iamVjdCBmb3VuZCIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCBwYXR0ZXJuSWQgPSBzZWxmLnBhcnNlU2hhZGluZyh7CiAgICAgICAgICAgICAgc2hhZGluZywKICAgICAgICAgICAgICByZXNvdXJjZXMsCiAgICAgICAgICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUsCiAgICAgICAgICAgICAgbG9jYWxTaGFkaW5nUGF0dGVybkNhY2hlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhcmdzID0gW3BhdHRlcm5JZF07CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNoYWRpbmdGaWxsOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRHU3RhdGU6CiAgICAgICAgICAgIGlzVmFsaWROYW1lID0gYXJnc1swXSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWU7CiAgICAgICAgICAgIG5hbWUgPSBhcmdzWzBdLm5hbWU7CgogICAgICAgICAgICBpZiAoaXNWYWxpZE5hbWUpIHsKICAgICAgICAgICAgICBjb25zdCBsb2NhbEdTdGF0ZU9iaiA9IGxvY2FsR1N0YXRlQ2FjaGUuZ2V0QnlOYW1lKG5hbWUpOwoKICAgICAgICAgICAgICBpZiAobG9jYWxHU3RhdGVPYmopIHsKICAgICAgICAgICAgICAgIGlmIChsb2NhbEdTdGF0ZU9iai5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuc2V0R1N0YXRlLCBbbG9jYWxHU3RhdGVPYmpdKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBhcmdzID0gbnVsbDsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV4dChuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZUdTdGF0ZSwgcmVqZWN0R1N0YXRlKSB7CiAgICAgICAgICAgICAgaWYgKCFpc1ZhbGlkTmFtZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJHU3RhdGUgbXVzdCBiZSByZWZlcnJlZCB0byBieSBuYW1lLiIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgZXh0R1N0YXRlID0gcmVzb3VyY2VzLmdldCgiRXh0R1N0YXRlIik7CgogICAgICAgICAgICAgIGlmICghKGV4dEdTdGF0ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkV4dEdTdGF0ZSBzaG91bGQgYmUgYSBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgZ1N0YXRlID0gZXh0R1N0YXRlLmdldChuYW1lKTsKCiAgICAgICAgICAgICAgaWYgKCEoZ1N0YXRlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiR1N0YXRlIHNob3VsZCBiZSBhIGRpY3Rpb25hcnkuIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzZWxmLnNldEdTdGF0ZSh7CiAgICAgICAgICAgICAgICByZXNvdXJjZXMsCiAgICAgICAgICAgICAgICBnU3RhdGUsCiAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QsCiAgICAgICAgICAgICAgICBjYWNoZUtleTogbmFtZSwKICAgICAgICAgICAgICAgIHRhc2ssCiAgICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXIsCiAgICAgICAgICAgICAgICBsb2NhbEdTdGF0ZUNhY2hlLAogICAgICAgICAgICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgICAgICAgICAgICB9KS50aGVuKHJlc29sdmVHU3RhdGUsIHJlamVjdEdTdGF0ZSk7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgICAgICBpZiAocmVhc29uIGluc3RhbmNlb2YgX3V0aWwuQWJvcnRFeGNlcHRpb24pIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgICAgICAgICBzZWxmLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgICAgICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLmVycm9yRXh0R1N0YXRlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgZ2V0T3BlcmF0b3JMaXN0IC0gaWdub3JpbmcgRXh0R1N0YXRlOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubW92ZVRvOgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubGluZVRvOgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuY3VydmVUbzoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmN1cnZlVG8yOgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuY3VydmVUbzM6CiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5jbG9zZVBhdGg6CiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5yZWN0YW5nbGU6CiAgICAgICAgICAgIHNlbGYuYnVpbGRQYXRoKG9wZXJhdG9yTGlzdCwgZm4sIGFyZ3MsIHBhcnNpbmdUZXh0KTsKICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubWFya1BvaW50OgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubWFya1BvaW50UHJvcHM6CiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5iZWdpbkNvbXBhdDoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmVuZENvbXBhdDoKICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuYmVnaW5NYXJrZWRDb250ZW50UHJvcHM6CiAgICAgICAgICAgIGlmICghKGFyZ3NbMF0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgRXhwZWN0ZWQgbmFtZSBmb3IgYmVnaW5NYXJrZWRDb250ZW50UHJvcHMgYXJnMD0ke2FyZ3NbMF19YCk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChhcmdzWzBdLm5hbWUgPT09ICJPQyIpIHsKICAgICAgICAgICAgICBuZXh0KHNlbGYucGFyc2VNYXJrZWRDb250ZW50UHJvcHMoYXJnc1sxXSwgcmVzb3VyY2VzKS50aGVuKGRhdGEgPT4gewogICAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5iZWdpbk1hcmtlZENvbnRlbnRQcm9wcywgWyJPQyIsIGRhdGFdKTsKICAgICAgICAgICAgICB9KS5jYXRjaChyZWFzb24gPT4gewogICAgICAgICAgICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICAgICAgICAgICBzZWxmLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgICAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JNYXJrZWRDb250ZW50CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoYGdldE9wZXJhdG9yTGlzdCAtIGlnbm9yaW5nIGJlZ2luTWFya2VkQ29udGVudFByb3BzOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhcmdzID0gW2FyZ3NbMF0ubmFtZSwgYXJnc1sxXSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgPyBhcmdzWzFdLmdldCgiTUNJRCIpIDogbnVsbF07CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmJlZ2luTWFya2VkQ29udGVudDoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmVuZE1hcmtlZENvbnRlbnQ6CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBpZiAoYXJncyAhPT0gbnVsbCkgewogICAgICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gYXJncy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoYXJnc1tpXSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoaSA8IGlpKSB7CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoImdldE9wZXJhdG9yTGlzdCAtIGlnbm9yaW5nIG9wZXJhdG9yOiAiICsgZm4pOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgIH0KCiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKGZuLCBhcmdzKTsKICAgICAgfQoKICAgICAgaWYgKHN0b3ApIHsKICAgICAgICBuZXh0KGRlZmVycmVkKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNsb3NlUGVuZGluZ1Jlc3RvcmVPUFMoKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSkuY2F0Y2gocmVhc29uID0+IHsKICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgIHRoaXMuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLmVycm9yT3BlcmF0b3JMaXN0CiAgICAgICAgfSk7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBnZXRPcGVyYXRvckxpc3QgLSBpZ25vcmluZyBlcnJvcnMgZHVyaW5nICIke3Rhc2submFtZX0iIGAgKyBgdGFzazogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgY2xvc2VQZW5kaW5nUmVzdG9yZU9QUygpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhyb3cgcmVhc29uOwogICAgfSk7CiAgfQoKICBnZXRUZXh0Q29udGVudChfcmVmNykgewogICAgbGV0IHsKICAgICAgc3RyZWFtLAogICAgICB0YXNrLAogICAgICByZXNvdXJjZXMsCiAgICAgIHN0YXRlTWFuYWdlciA9IG51bGwsCiAgICAgIGNvbWJpbmVUZXh0SXRlbXMgPSBmYWxzZSwKICAgICAgaW5jbHVkZU1hcmtlZENvbnRlbnQgPSBmYWxzZSwKICAgICAgc2luaywKICAgICAgc2VlblN0eWxlcyA9IG5ldyBTZXQoKSwKICAgICAgdmlld0JveAogICAgfSA9IF9yZWY3OwogICAgcmVzb3VyY2VzID0gcmVzb3VyY2VzIHx8IF9wcmltaXRpdmVzLkRpY3QuZW1wdHk7CiAgICBzdGF0ZU1hbmFnZXIgPSBzdGF0ZU1hbmFnZXIgfHwgbmV3IFN0YXRlTWFuYWdlcihuZXcgVGV4dFN0YXRlKCkpOwogICAgY29uc3QgTm9ybWFsaXplZFVuaWNvZGVzID0gKDAsIF91bmljb2RlLmdldE5vcm1hbGl6ZWRVbmljb2RlcykoKTsKICAgIGNvbnN0IHRleHRDb250ZW50ID0gewogICAgICBpdGVtczogW10sCiAgICAgIHN0eWxlczogT2JqZWN0LmNyZWF0ZShudWxsKQogICAgfTsKICAgIGNvbnN0IHRleHRDb250ZW50SXRlbSA9IHsKICAgICAgaW5pdGlhbGl6ZWQ6IGZhbHNlLAogICAgICBzdHI6IFtdLAogICAgICB0b3RhbFdpZHRoOiAwLAogICAgICB0b3RhbEhlaWdodDogMCwKICAgICAgd2lkdGg6IDAsCiAgICAgIGhlaWdodDogMCwKICAgICAgdmVydGljYWw6IGZhbHNlLAogICAgICBwcmV2VHJhbnNmb3JtOiBudWxsLAogICAgICB0ZXh0QWR2YW5jZVNjYWxlOiAwLAogICAgICBzcGFjZUluRmxvd01pbjogMCwKICAgICAgc3BhY2VJbkZsb3dNYXg6IDAsCiAgICAgIHRyYWNraW5nU3BhY2VNaW46IEluZmluaXR5LAogICAgICBuZWdhdGl2ZVNwYWNlTWF4OiAtSW5maW5pdHksCiAgICAgIG5vdEFTcGFjZTogLUluZmluaXR5LAogICAgICB0cmFuc2Zvcm06IG51bGwsCiAgICAgIGZvbnROYW1lOiBudWxsLAogICAgICBoYXNFT0w6IGZhbHNlCiAgICB9OwogICAgY29uc3QgdHdvTGFzdENoYXJzID0gWyIgIiwgIiAiXTsKICAgIGxldCB0d29MYXN0Q2hhcnNQb3MgPSAwOwoKICAgIGZ1bmN0aW9uIHNhdmVMYXN0Q2hhcihjaGFyKSB7CiAgICAgIGNvbnN0IG5leHRQb3MgPSAodHdvTGFzdENoYXJzUG9zICsgMSkgJSAyOwogICAgICBjb25zdCByZXQgPSB0d29MYXN0Q2hhcnNbdHdvTGFzdENoYXJzUG9zXSAhPT0gIiAiICYmIHR3b0xhc3RDaGFyc1tuZXh0UG9zXSA9PT0gIiAiOwogICAgICB0d29MYXN0Q2hhcnNbdHdvTGFzdENoYXJzUG9zXSA9IGNoYXI7CiAgICAgIHR3b0xhc3RDaGFyc1BvcyA9IG5leHRQb3M7CiAgICAgIHJldHVybiByZXQ7CiAgICB9CgogICAgZnVuY3Rpb24gcmVzZXRMYXN0Q2hhcnMoKSB7CiAgICAgIHR3b0xhc3RDaGFyc1swXSA9IHR3b0xhc3RDaGFyc1sxXSA9ICIgIjsKICAgICAgdHdvTGFzdENoYXJzUG9zID0gMDsKICAgIH0KCiAgICBjb25zdCBUUkFDS0lOR19TUEFDRV9GQUNUT1IgPSAwLjE7CiAgICBjb25zdCBOT1RfQV9TUEFDRV9GQUNUT1IgPSAwLjAzOwogICAgY29uc3QgTkVHQVRJVkVfU1BBQ0VfRkFDVE9SID0gLTAuMjsKICAgIGNvbnN0IFNQQUNFX0lOX0ZMT1dfTUlOX0ZBQ1RPUiA9IDAuMTsKICAgIGNvbnN0IFNQQUNFX0lOX0ZMT1dfTUFYX0ZBQ1RPUiA9IDAuNjsKICAgIGNvbnN0IHNlbGYgPSB0aGlzOwogICAgY29uc3QgeHJlZiA9IHRoaXMueHJlZjsKICAgIGNvbnN0IHNob3dTcGFjZWRUZXh0QnVmZmVyID0gW107CiAgICBsZXQgeG9ianMgPSBudWxsOwogICAgY29uc3QgZW1wdHlYT2JqZWN0Q2FjaGUgPSBuZXcgX2ltYWdlX3V0aWxzLkxvY2FsSW1hZ2VDYWNoZSgpOwogICAgY29uc3QgZW1wdHlHU3RhdGVDYWNoZSA9IG5ldyBfaW1hZ2VfdXRpbHMuTG9jYWxHU3RhdGVDYWNoZSgpOwogICAgY29uc3QgcHJlcHJvY2Vzc29yID0gbmV3IEV2YWx1YXRvclByZXByb2Nlc3NvcihzdHJlYW0sIHhyZWYsIHN0YXRlTWFuYWdlcik7CiAgICBsZXQgdGV4dFN0YXRlOwoKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRUZXh0VHJhbnNmb3JtKCkgewogICAgICBjb25zdCBmb250ID0gdGV4dFN0YXRlLmZvbnQ7CiAgICAgIGNvbnN0IHRzbSA9IFt0ZXh0U3RhdGUuZm9udFNpemUgKiB0ZXh0U3RhdGUudGV4dEhTY2FsZSwgMCwgMCwgdGV4dFN0YXRlLmZvbnRTaXplLCAwLCB0ZXh0U3RhdGUudGV4dFJpc2VdOwoKICAgICAgaWYgKGZvbnQuaXNUeXBlM0ZvbnQgJiYgKHRleHRTdGF0ZS5mb250U2l6ZSA8PSAxIHx8IGZvbnQuaXNDaGFyQkJveCkgJiYgISgwLCBfdXRpbC5pc0FycmF5RXF1YWwpKHRleHRTdGF0ZS5mb250TWF0cml4LCBfdXRpbC5GT05UX0lERU5USVRZX01BVFJJWCkpIHsKICAgICAgICBjb25zdCBnbHlwaEhlaWdodCA9IGZvbnQuYmJveFszXSAtIGZvbnQuYmJveFsxXTsKCiAgICAgICAgaWYgKGdseXBoSGVpZ2h0ID4gMCkgewogICAgICAgICAgdHNtWzNdICo9IGdseXBoSGVpZ2h0ICogdGV4dFN0YXRlLmZvbnRNYXRyaXhbM107CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gX3V0aWwuVXRpbC50cmFuc2Zvcm0odGV4dFN0YXRlLmN0bSwgX3V0aWwuVXRpbC50cmFuc2Zvcm0odGV4dFN0YXRlLnRleHRNYXRyaXgsIHRzbSkpOwogICAgfQoKICAgIGZ1bmN0aW9uIGVuc3VyZVRleHRDb250ZW50SXRlbSgpIHsKICAgICAgaWYgKHRleHRDb250ZW50SXRlbS5pbml0aWFsaXplZCkgewogICAgICAgIHJldHVybiB0ZXh0Q29udGVudEl0ZW07CiAgICAgIH0KCiAgICAgIGNvbnN0IGZvbnQgPSB0ZXh0U3RhdGUuZm9udCwKICAgICAgICAgICAgbG9hZGVkTmFtZSA9IGZvbnQubG9hZGVkTmFtZTsKCiAgICAgIGlmICghc2VlblN0eWxlcy5oYXMobG9hZGVkTmFtZSkpIHsKICAgICAgICBzZWVuU3R5bGVzLmFkZChsb2FkZWROYW1lKTsKICAgICAgICB0ZXh0Q29udGVudC5zdHlsZXNbbG9hZGVkTmFtZV0gPSB7CiAgICAgICAgICBmb250RmFtaWx5OiBmb250LmZhbGxiYWNrTmFtZSwKICAgICAgICAgIGFzY2VudDogZm9udC5hc2NlbnQsCiAgICAgICAgICBkZXNjZW50OiBmb250LmRlc2NlbnQsCiAgICAgICAgICB2ZXJ0aWNhbDogZm9udC52ZXJ0aWNhbAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHRleHRDb250ZW50SXRlbS5mb250TmFtZSA9IGxvYWRlZE5hbWU7CiAgICAgIGNvbnN0IHRybSA9IHRleHRDb250ZW50SXRlbS50cmFuc2Zvcm0gPSBnZXRDdXJyZW50VGV4dFRyYW5zZm9ybSgpOwoKICAgICAgaWYgKCFmb250LnZlcnRpY2FsKSB7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLndpZHRoID0gdGV4dENvbnRlbnRJdGVtLnRvdGFsV2lkdGggPSAwOwogICAgICAgIHRleHRDb250ZW50SXRlbS5oZWlnaHQgPSB0ZXh0Q29udGVudEl0ZW0udG90YWxIZWlnaHQgPSBNYXRoLmh5cG90KHRybVsyXSwgdHJtWzNdKTsKICAgICAgICB0ZXh0Q29udGVudEl0ZW0udmVydGljYWwgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ZXh0Q29udGVudEl0ZW0ud2lkdGggPSB0ZXh0Q29udGVudEl0ZW0udG90YWxXaWR0aCA9IE1hdGguaHlwb3QodHJtWzBdLCB0cm1bMV0pOwogICAgICAgIHRleHRDb250ZW50SXRlbS5oZWlnaHQgPSB0ZXh0Q29udGVudEl0ZW0udG90YWxIZWlnaHQgPSAwOwogICAgICAgIHRleHRDb250ZW50SXRlbS52ZXJ0aWNhbCA9IHRydWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHNjYWxlTGluZVggPSBNYXRoLmh5cG90KHRleHRTdGF0ZS50ZXh0TGluZU1hdHJpeFswXSwgdGV4dFN0YXRlLnRleHRMaW5lTWF0cml4WzFdKTsKICAgICAgY29uc3Qgc2NhbGVDdG1YID0gTWF0aC5oeXBvdCh0ZXh0U3RhdGUuY3RtWzBdLCB0ZXh0U3RhdGUuY3RtWzFdKTsKICAgICAgdGV4dENvbnRlbnRJdGVtLnRleHRBZHZhbmNlU2NhbGUgPSBzY2FsZUN0bVggKiBzY2FsZUxpbmVYOwogICAgICB0ZXh0Q29udGVudEl0ZW0udHJhY2tpbmdTcGFjZU1pbiA9IHRleHRTdGF0ZS5mb250U2l6ZSAqIFRSQUNLSU5HX1NQQUNFX0ZBQ1RPUjsKICAgICAgdGV4dENvbnRlbnRJdGVtLm5vdEFTcGFjZSA9IHRleHRTdGF0ZS5mb250U2l6ZSAqIE5PVF9BX1NQQUNFX0ZBQ1RPUjsKICAgICAgdGV4dENvbnRlbnRJdGVtLm5lZ2F0aXZlU3BhY2VNYXggPSB0ZXh0U3RhdGUuZm9udFNpemUgKiBORUdBVElWRV9TUEFDRV9GQUNUT1I7CiAgICAgIHRleHRDb250ZW50SXRlbS5zcGFjZUluRmxvd01pbiA9IHRleHRTdGF0ZS5mb250U2l6ZSAqIFNQQUNFX0lOX0ZMT1dfTUlOX0ZBQ1RPUjsKICAgICAgdGV4dENvbnRlbnRJdGVtLnNwYWNlSW5GbG93TWF4ID0gdGV4dFN0YXRlLmZvbnRTaXplICogU1BBQ0VfSU5fRkxPV19NQVhfRkFDVE9SOwogICAgICB0ZXh0Q29udGVudEl0ZW0uaGFzRU9MID0gZmFsc2U7CiAgICAgIHRleHRDb250ZW50SXRlbS5pbml0aWFsaXplZCA9IHRydWU7CiAgICAgIHJldHVybiB0ZXh0Q29udGVudEl0ZW07CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlQWR2YW5jZVNjYWxlKCkgewogICAgICBpZiAoIXRleHRDb250ZW50SXRlbS5pbml0aWFsaXplZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgc2NhbGVMaW5lWCA9IE1hdGguaHlwb3QodGV4dFN0YXRlLnRleHRMaW5lTWF0cml4WzBdLCB0ZXh0U3RhdGUudGV4dExpbmVNYXRyaXhbMV0pOwogICAgICBjb25zdCBzY2FsZUN0bVggPSBNYXRoLmh5cG90KHRleHRTdGF0ZS5jdG1bMF0sIHRleHRTdGF0ZS5jdG1bMV0pOwogICAgICBjb25zdCBzY2FsZUZhY3RvciA9IHNjYWxlQ3RtWCAqIHNjYWxlTGluZVg7CgogICAgICBpZiAoc2NhbGVGYWN0b3IgPT09IHRleHRDb250ZW50SXRlbS50ZXh0QWR2YW5jZVNjYWxlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIXRleHRDb250ZW50SXRlbS52ZXJ0aWNhbCkgewogICAgICAgIHRleHRDb250ZW50SXRlbS50b3RhbFdpZHRoICs9IHRleHRDb250ZW50SXRlbS53aWR0aCAqIHRleHRDb250ZW50SXRlbS50ZXh0QWR2YW5jZVNjYWxlOwogICAgICAgIHRleHRDb250ZW50SXRlbS53aWR0aCA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLnRvdGFsSGVpZ2h0ICs9IHRleHRDb250ZW50SXRlbS5oZWlnaHQgKiB0ZXh0Q29udGVudEl0ZW0udGV4dEFkdmFuY2VTY2FsZTsKICAgICAgICB0ZXh0Q29udGVudEl0ZW0uaGVpZ2h0ID0gMDsKICAgICAgfQoKICAgICAgdGV4dENvbnRlbnRJdGVtLnRleHRBZHZhbmNlU2NhbGUgPSBzY2FsZUZhY3RvcjsKICAgIH0KCiAgICBmdW5jdGlvbiBydW5CaWRpVHJhbnNmb3JtKHRleHRDaHVuaykgewogICAgICBjb25zdCB0ZXh0ID0gdGV4dENodW5rLnN0ci5qb2luKCIiKTsKICAgICAgY29uc3QgYmlkaVJlc3VsdCA9ICgwLCBfYmlkaS5iaWRpKSh0ZXh0LCAtMSwgdGV4dENodW5rLnZlcnRpY2FsKTsKICAgICAgcmV0dXJuIHsKICAgICAgICBzdHI6IGJpZGlSZXN1bHQuc3RyLAogICAgICAgIGRpcjogYmlkaVJlc3VsdC5kaXIsCiAgICAgICAgd2lkdGg6IE1hdGguYWJzKHRleHRDaHVuay50b3RhbFdpZHRoKSwKICAgICAgICBoZWlnaHQ6IE1hdGguYWJzKHRleHRDaHVuay50b3RhbEhlaWdodCksCiAgICAgICAgdHJhbnNmb3JtOiB0ZXh0Q2h1bmsudHJhbnNmb3JtLAogICAgICAgIGZvbnROYW1lOiB0ZXh0Q2h1bmsuZm9udE5hbWUsCiAgICAgICAgaGFzRU9MOiB0ZXh0Q2h1bmsuaGFzRU9MCiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gaGFuZGxlU2V0Rm9udChmb250TmFtZSwgZm9udFJlZikgewogICAgICByZXR1cm4gc2VsZi5sb2FkRm9udChmb250TmFtZSwgZm9udFJlZiwgcmVzb3VyY2VzKS50aGVuKGZ1bmN0aW9uICh0cmFuc2xhdGVkKSB7CiAgICAgICAgaWYgKCF0cmFuc2xhdGVkLmZvbnQuaXNUeXBlM0ZvbnQpIHsKICAgICAgICAgIHJldHVybiB0cmFuc2xhdGVkOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRyYW5zbGF0ZWQubG9hZFR5cGUzRGF0YShzZWxmLCByZXNvdXJjZXMsIHRhc2spLmNhdGNoKGZ1bmN0aW9uICgpIHt9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiB0cmFuc2xhdGVkOwogICAgICAgIH0pOwogICAgICB9KS50aGVuKGZ1bmN0aW9uICh0cmFuc2xhdGVkKSB7CiAgICAgICAgdGV4dFN0YXRlLmZvbnQgPSB0cmFuc2xhdGVkLmZvbnQ7CiAgICAgICAgdGV4dFN0YXRlLmZvbnRNYXRyaXggPSB0cmFuc2xhdGVkLmZvbnQuZm9udE1hdHJpeCB8fCBfdXRpbC5GT05UX0lERU5USVRZX01BVFJJWDsKICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwbHlJbnZlcnNlUm90YXRpb24oeCwgeSwgbWF0cml4KSB7CiAgICAgIGNvbnN0IHNjYWxlID0gTWF0aC5oeXBvdChtYXRyaXhbMF0sIG1hdHJpeFsxXSk7CiAgICAgIHJldHVybiBbKG1hdHJpeFswXSAqIHggKyBtYXRyaXhbMV0gKiB5KSAvIHNjYWxlLCAobWF0cml4WzJdICogeCArIG1hdHJpeFszXSAqIHkpIC8gc2NhbGVdOwogICAgfQoKICAgIGZ1bmN0aW9uIGNvbXBhcmVXaXRoTGFzdFBvc2l0aW9uKCkgewogICAgICBjb25zdCBjdXJyZW50VHJhbnNmb3JtID0gZ2V0Q3VycmVudFRleHRUcmFuc2Zvcm0oKTsKICAgICAgbGV0IHBvc1ggPSBjdXJyZW50VHJhbnNmb3JtWzRdOwogICAgICBsZXQgcG9zWSA9IGN1cnJlbnRUcmFuc2Zvcm1bNV07CiAgICAgIGNvbnN0IHNoaWZ0ZWRYID0gcG9zWCAtIHZpZXdCb3hbMF07CiAgICAgIGNvbnN0IHNoaWZ0ZWRZID0gcG9zWSAtIHZpZXdCb3hbMV07CgogICAgICBpZiAoc2hpZnRlZFggPCAwIHx8IHNoaWZ0ZWRYID4gdmlld0JveFsyXSB8fCBzaGlmdGVkWSA8IDAgfHwgc2hpZnRlZFkgPiB2aWV3Qm94WzNdKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAoIWNvbWJpbmVUZXh0SXRlbXMgfHwgIXRleHRTdGF0ZS5mb250IHx8ICF0ZXh0Q29udGVudEl0ZW0ucHJldlRyYW5zZm9ybSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBsZXQgbGFzdFBvc1ggPSB0ZXh0Q29udGVudEl0ZW0ucHJldlRyYW5zZm9ybVs0XTsKICAgICAgbGV0IGxhc3RQb3NZID0gdGV4dENvbnRlbnRJdGVtLnByZXZUcmFuc2Zvcm1bNV07CgogICAgICBpZiAobGFzdFBvc1ggPT09IHBvc1ggJiYgbGFzdFBvc1kgPT09IHBvc1kpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgbGV0IHJvdGF0ZSA9IC0xOwoKICAgICAgaWYgKGN1cnJlbnRUcmFuc2Zvcm1bMF0gJiYgY3VycmVudFRyYW5zZm9ybVsxXSA9PT0gMCAmJiBjdXJyZW50VHJhbnNmb3JtWzJdID09PSAwKSB7CiAgICAgICAgcm90YXRlID0gY3VycmVudFRyYW5zZm9ybVswXSA+IDAgPyAwIDogMTgwOwogICAgICB9IGVsc2UgaWYgKGN1cnJlbnRUcmFuc2Zvcm1bMV0gJiYgY3VycmVudFRyYW5zZm9ybVswXSA9PT0gMCAmJiBjdXJyZW50VHJhbnNmb3JtWzNdID09PSAwKSB7CiAgICAgICAgcm90YXRlID0gY3VycmVudFRyYW5zZm9ybVsxXSA+IDAgPyA5MCA6IDI3MDsKICAgICAgfQoKICAgICAgc3dpdGNoIChyb3RhdGUpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSA5MDoKICAgICAgICAgIFtwb3NYLCBwb3NZXSA9IFtwb3NZLCBwb3NYXTsKICAgICAgICAgIFtsYXN0UG9zWCwgbGFzdFBvc1ldID0gW2xhc3RQb3NZLCBsYXN0UG9zWF07CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxODA6CiAgICAgICAgICBbcG9zWCwgcG9zWSwgbGFzdFBvc1gsIGxhc3RQb3NZXSA9IFstcG9zWCwgLXBvc1ksIC1sYXN0UG9zWCwgLWxhc3RQb3NZXTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI3MDoKICAgICAgICAgIFtwb3NYLCBwb3NZXSA9IFstcG9zWSwgLXBvc1hdOwogICAgICAgICAgW2xhc3RQb3NYLCBsYXN0UG9zWV0gPSBbLWxhc3RQb3NZLCAtbGFzdFBvc1hdOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBbcG9zWCwgcG9zWV0gPSBhcHBseUludmVyc2VSb3RhdGlvbihwb3NYLCBwb3NZLCBjdXJyZW50VHJhbnNmb3JtKTsKICAgICAgICAgIFtsYXN0UG9zWCwgbGFzdFBvc1ldID0gYXBwbHlJbnZlcnNlUm90YXRpb24obGFzdFBvc1gsIGxhc3RQb3NZLCB0ZXh0Q29udGVudEl0ZW0ucHJldlRyYW5zZm9ybSk7CiAgICAgIH0KCiAgICAgIGlmICh0ZXh0U3RhdGUuZm9udC52ZXJ0aWNhbCkgewogICAgICAgIGNvbnN0IGFkdmFuY2VZID0gKGxhc3RQb3NZIC0gcG9zWSkgLyB0ZXh0Q29udGVudEl0ZW0udGV4dEFkdmFuY2VTY2FsZTsKICAgICAgICBjb25zdCBhZHZhbmNlWCA9IHBvc1ggLSBsYXN0UG9zWDsKICAgICAgICBjb25zdCB0ZXh0T3JpZW50YXRpb24gPSBNYXRoLnNpZ24odGV4dENvbnRlbnRJdGVtLmhlaWdodCk7CgogICAgICAgIGlmIChhZHZhbmNlWSA8IHRleHRPcmllbnRhdGlvbiAqIHRleHRDb250ZW50SXRlbS5uZWdhdGl2ZVNwYWNlTWF4KSB7CiAgICAgICAgICBpZiAoTWF0aC5hYnMoYWR2YW5jZVgpID4gMC41ICogdGV4dENvbnRlbnRJdGVtLndpZHRoKSB7CiAgICAgICAgICAgIGFwcGVuZEVPTCgpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXNldExhc3RDaGFycygpOwogICAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKE1hdGguYWJzKGFkdmFuY2VYKSA+IHRleHRDb250ZW50SXRlbS53aWR0aCkgewogICAgICAgICAgYXBwZW5kRU9MKCk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGlmIChhZHZhbmNlWSA8PSB0ZXh0T3JpZW50YXRpb24gKiB0ZXh0Q29udGVudEl0ZW0ubm90QVNwYWNlKSB7CiAgICAgICAgICByZXNldExhc3RDaGFycygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGFkdmFuY2VZIDw9IHRleHRPcmllbnRhdGlvbiAqIHRleHRDb250ZW50SXRlbS50cmFja2luZ1NwYWNlTWluKSB7CiAgICAgICAgICB0ZXh0Q29udGVudEl0ZW0uaGVpZ2h0ICs9IGFkdmFuY2VZOwogICAgICAgIH0gZWxzZSBpZiAoIWFkZEZha2VTcGFjZXMoYWR2YW5jZVksIHRleHRDb250ZW50SXRlbS5wcmV2VHJhbnNmb3JtLCB0ZXh0T3JpZW50YXRpb24pKSB7CiAgICAgICAgICBpZiAodGV4dENvbnRlbnRJdGVtLnN0ci5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgcmVzZXRMYXN0Q2hhcnMoKTsKICAgICAgICAgICAgdGV4dENvbnRlbnQuaXRlbXMucHVzaCh7CiAgICAgICAgICAgICAgc3RyOiAiICIsCiAgICAgICAgICAgICAgZGlyOiAibHRyIiwKICAgICAgICAgICAgICB3aWR0aDogMCwKICAgICAgICAgICAgICBoZWlnaHQ6IE1hdGguYWJzKGFkdmFuY2VZKSwKICAgICAgICAgICAgICB0cmFuc2Zvcm06IHRleHRDb250ZW50SXRlbS5wcmV2VHJhbnNmb3JtLAogICAgICAgICAgICAgIGZvbnROYW1lOiB0ZXh0Q29udGVudEl0ZW0uZm9udE5hbWUsCiAgICAgICAgICAgICAgaGFzRU9MOiBmYWxzZQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRleHRDb250ZW50SXRlbS5oZWlnaHQgKz0gYWR2YW5jZVk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgY29uc3QgYWR2YW5jZVggPSAocG9zWCAtIGxhc3RQb3NYKSAvIHRleHRDb250ZW50SXRlbS50ZXh0QWR2YW5jZVNjYWxlOwogICAgICBjb25zdCBhZHZhbmNlWSA9IHBvc1kgLSBsYXN0UG9zWTsKICAgICAgY29uc3QgdGV4dE9yaWVudGF0aW9uID0gTWF0aC5zaWduKHRleHRDb250ZW50SXRlbS53aWR0aCk7CgogICAgICBpZiAoYWR2YW5jZVggPCB0ZXh0T3JpZW50YXRpb24gKiB0ZXh0Q29udGVudEl0ZW0ubmVnYXRpdmVTcGFjZU1heCkgewogICAgICAgIGlmIChNYXRoLmFicyhhZHZhbmNlWSkgPiAwLjUgKiB0ZXh0Q29udGVudEl0ZW0uaGVpZ2h0KSB7CiAgICAgICAgICBhcHBlbmRFT0woKTsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmVzZXRMYXN0Q2hhcnMoKTsKICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAoTWF0aC5hYnMoYWR2YW5jZVkpID4gdGV4dENvbnRlbnRJdGVtLmhlaWdodCkgewogICAgICAgIGFwcGVuZEVPTCgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAoYWR2YW5jZVggPD0gdGV4dE9yaWVudGF0aW9uICogdGV4dENvbnRlbnRJdGVtLm5vdEFTcGFjZSkgewogICAgICAgIHJlc2V0TGFzdENoYXJzKCk7CiAgICAgIH0KCiAgICAgIGlmIChhZHZhbmNlWCA8PSB0ZXh0T3JpZW50YXRpb24gKiB0ZXh0Q29udGVudEl0ZW0udHJhY2tpbmdTcGFjZU1pbikgewogICAgICAgIHRleHRDb250ZW50SXRlbS53aWR0aCArPSBhZHZhbmNlWDsKICAgICAgfSBlbHNlIGlmICghYWRkRmFrZVNwYWNlcyhhZHZhbmNlWCwgdGV4dENvbnRlbnRJdGVtLnByZXZUcmFuc2Zvcm0sIHRleHRPcmllbnRhdGlvbikpIHsKICAgICAgICBpZiAodGV4dENvbnRlbnRJdGVtLnN0ci5sZW5ndGggPT09IDApIHsKICAgICAgICAgIHJlc2V0TGFzdENoYXJzKCk7CiAgICAgICAgICB0ZXh0Q29udGVudC5pdGVtcy5wdXNoKHsKICAgICAgICAgICAgc3RyOiAiICIsCiAgICAgICAgICAgIGRpcjogImx0ciIsCiAgICAgICAgICAgIHdpZHRoOiBNYXRoLmFicyhhZHZhbmNlWCksCiAgICAgICAgICAgIGhlaWdodDogMCwKICAgICAgICAgICAgdHJhbnNmb3JtOiB0ZXh0Q29udGVudEl0ZW0ucHJldlRyYW5zZm9ybSwKICAgICAgICAgICAgZm9udE5hbWU6IHRleHRDb250ZW50SXRlbS5mb250TmFtZSwKICAgICAgICAgICAgaGFzRU9MOiBmYWxzZQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRleHRDb250ZW50SXRlbS53aWR0aCArPSBhZHZhbmNlWDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIGJ1aWxkVGV4dENvbnRlbnRJdGVtKF9yZWY4KSB7CiAgICAgIGxldCB7CiAgICAgICAgY2hhcnMsCiAgICAgICAgZXh0cmFTcGFjaW5nCiAgICAgIH0gPSBfcmVmODsKICAgICAgY29uc3QgZm9udCA9IHRleHRTdGF0ZS5mb250OwoKICAgICAgaWYgKCFjaGFycykgewogICAgICAgIGNvbnN0IGNoYXJTcGFjaW5nID0gdGV4dFN0YXRlLmNoYXJTcGFjaW5nICsgZXh0cmFTcGFjaW5nOwoKICAgICAgICBpZiAoY2hhclNwYWNpbmcpIHsKICAgICAgICAgIGlmICghZm9udC52ZXJ0aWNhbCkgewogICAgICAgICAgICB0ZXh0U3RhdGUudHJhbnNsYXRlVGV4dE1hdHJpeChjaGFyU3BhY2luZyAqIHRleHRTdGF0ZS50ZXh0SFNjYWxlLCAwKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRleHRTdGF0ZS50cmFuc2xhdGVUZXh0TWF0cml4KDAsIC1jaGFyU3BhY2luZyk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGdseXBocyA9IGZvbnQuY2hhcnNUb0dseXBocyhjaGFycyk7CiAgICAgIGNvbnN0IHNjYWxlID0gdGV4dFN0YXRlLmZvbnRNYXRyaXhbMF0gKiB0ZXh0U3RhdGUuZm9udFNpemU7CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBnbHlwaHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbnN0IGdseXBoID0gZ2x5cGhzW2ldOwoKICAgICAgICBpZiAoZ2x5cGguaXNJbnZpc2libGVGb3JtYXRNYXJrKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGxldCBjaGFyU3BhY2luZyA9IHRleHRTdGF0ZS5jaGFyU3BhY2luZyArIChpICsgMSA9PT0gaWkgPyBleHRyYVNwYWNpbmcgOiAwKTsKICAgICAgICBsZXQgZ2x5cGhXaWR0aCA9IGdseXBoLndpZHRoOwoKICAgICAgICBpZiAoZm9udC52ZXJ0aWNhbCkgewogICAgICAgICAgZ2x5cGhXaWR0aCA9IGdseXBoLnZtZXRyaWMgPyBnbHlwaC52bWV0cmljWzBdIDogLWdseXBoV2lkdGg7CiAgICAgICAgfQoKICAgICAgICBsZXQgc2NhbGVkRGltID0gZ2x5cGhXaWR0aCAqIHNjYWxlOwoKICAgICAgICBpZiAoZ2x5cGguaXNXaGl0ZXNwYWNlKSB7CiAgICAgICAgICBpZiAoIWZvbnQudmVydGljYWwpIHsKICAgICAgICAgICAgY2hhclNwYWNpbmcgKz0gc2NhbGVkRGltICsgdGV4dFN0YXRlLndvcmRTcGFjaW5nOwogICAgICAgICAgICB0ZXh0U3RhdGUudHJhbnNsYXRlVGV4dE1hdHJpeChjaGFyU3BhY2luZyAqIHRleHRTdGF0ZS50ZXh0SFNjYWxlLCAwKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNoYXJTcGFjaW5nICs9IC1zY2FsZWREaW0gKyB0ZXh0U3RhdGUud29yZFNwYWNpbmc7CiAgICAgICAgICAgIHRleHRTdGF0ZS50cmFuc2xhdGVUZXh0TWF0cml4KDAsIC1jaGFyU3BhY2luZyk7CiAgICAgICAgICB9CgogICAgICAgICAgc2F2ZUxhc3RDaGFyKCIgIik7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmICghY29tcGFyZVdpdGhMYXN0UG9zaXRpb24oKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCB0ZXh0Q2h1bmsgPSBlbnN1cmVUZXh0Q29udGVudEl0ZW0oKTsKCiAgICAgICAgaWYgKGdseXBoLmlzWmVyb1dpZHRoRGlhY3JpdGljKSB7CiAgICAgICAgICBzY2FsZWREaW0gPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFmb250LnZlcnRpY2FsKSB7CiAgICAgICAgICBzY2FsZWREaW0gKj0gdGV4dFN0YXRlLnRleHRIU2NhbGU7CiAgICAgICAgICB0ZXh0U3RhdGUudHJhbnNsYXRlVGV4dE1hdHJpeChzY2FsZWREaW0sIDApOwogICAgICAgICAgdGV4dENodW5rLndpZHRoICs9IHNjYWxlZERpbTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGV4dFN0YXRlLnRyYW5zbGF0ZVRleHRNYXRyaXgoMCwgc2NhbGVkRGltKTsKICAgICAgICAgIHNjYWxlZERpbSA9IE1hdGguYWJzKHNjYWxlZERpbSk7CiAgICAgICAgICB0ZXh0Q2h1bmsuaGVpZ2h0ICs9IHNjYWxlZERpbTsKICAgICAgICB9CgogICAgICAgIGlmIChzY2FsZWREaW0pIHsKICAgICAgICAgIHRleHRDaHVuay5wcmV2VHJhbnNmb3JtID0gZ2V0Q3VycmVudFRleHRUcmFuc2Zvcm0oKTsKICAgICAgICB9CgogICAgICAgIGxldCBnbHlwaFVuaWNvZGUgPSBnbHlwaC51bmljb2RlOwogICAgICAgIGdseXBoVW5pY29kZSA9IE5vcm1hbGl6ZWRVbmljb2Rlc1tnbHlwaFVuaWNvZGVdIHx8IGdseXBoVW5pY29kZTsKICAgICAgICBnbHlwaFVuaWNvZGUgPSAoMCwgX3VuaWNvZGUucmV2ZXJzZUlmUnRsKShnbHlwaFVuaWNvZGUpOwoKICAgICAgICBpZiAoc2F2ZUxhc3RDaGFyKGdseXBoVW5pY29kZSkpIHsKICAgICAgICAgIHRleHRDaHVuay5zdHIucHVzaCgiICIpOwogICAgICAgIH0KCiAgICAgICAgdGV4dENodW5rLnN0ci5wdXNoKGdseXBoVW5pY29kZSk7CgogICAgICAgIGlmIChjaGFyU3BhY2luZykgewogICAgICAgICAgaWYgKCFmb250LnZlcnRpY2FsKSB7CiAgICAgICAgICAgIHRleHRTdGF0ZS50cmFuc2xhdGVUZXh0TWF0cml4KGNoYXJTcGFjaW5nICogdGV4dFN0YXRlLnRleHRIU2NhbGUsIDApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGV4dFN0YXRlLnRyYW5zbGF0ZVRleHRNYXRyaXgoMCwgLWNoYXJTcGFjaW5nKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBhcHBlbmRFT0woKSB7CiAgICAgIHJlc2V0TGFzdENoYXJzKCk7CgogICAgICBpZiAodGV4dENvbnRlbnRJdGVtLmluaXRpYWxpemVkKSB7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLmhhc0VPTCA9IHRydWU7CiAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ZXh0Q29udGVudC5pdGVtcy5wdXNoKHsKICAgICAgICAgIHN0cjogIiIsCiAgICAgICAgICBkaXI6ICJsdHIiLAogICAgICAgICAgd2lkdGg6IDAsCiAgICAgICAgICBoZWlnaHQ6IDAsCiAgICAgICAgICB0cmFuc2Zvcm06IGdldEN1cnJlbnRUZXh0VHJhbnNmb3JtKCksCiAgICAgICAgICBmb250TmFtZTogdGV4dFN0YXRlLmZvbnQubG9hZGVkTmFtZSwKICAgICAgICAgIGhhc0VPTDogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYWRkRmFrZVNwYWNlcyh3aWR0aCwgdHJhbnNmLCB0ZXh0T3JpZW50YXRpb24pIHsKICAgICAgaWYgKHRleHRPcmllbnRhdGlvbiAqIHRleHRDb250ZW50SXRlbS5zcGFjZUluRmxvd01pbiA8PSB3aWR0aCAmJiB3aWR0aCA8PSB0ZXh0T3JpZW50YXRpb24gKiB0ZXh0Q29udGVudEl0ZW0uc3BhY2VJbkZsb3dNYXgpIHsKICAgICAgICBpZiAodGV4dENvbnRlbnRJdGVtLmluaXRpYWxpemVkKSB7CiAgICAgICAgICByZXNldExhc3RDaGFycygpOwogICAgICAgICAgdGV4dENvbnRlbnRJdGVtLnN0ci5wdXNoKCIgIik7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGZvbnROYW1lID0gdGV4dENvbnRlbnRJdGVtLmZvbnROYW1lOwogICAgICBsZXQgaGVpZ2h0ID0gMDsKCiAgICAgIGlmICh0ZXh0Q29udGVudEl0ZW0udmVydGljYWwpIHsKICAgICAgICBoZWlnaHQgPSB3aWR0aDsKICAgICAgICB3aWR0aCA9IDA7CiAgICAgIH0KCiAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgIHJlc2V0TGFzdENoYXJzKCk7CiAgICAgIHRleHRDb250ZW50Lml0ZW1zLnB1c2goewogICAgICAgIHN0cjogIiAiLAogICAgICAgIGRpcjogImx0ciIsCiAgICAgICAgd2lkdGg6IE1hdGguYWJzKHdpZHRoKSwKICAgICAgICBoZWlnaHQ6IE1hdGguYWJzKGhlaWdodCksCiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2YgfHwgZ2V0Q3VycmVudFRleHRUcmFuc2Zvcm0oKSwKICAgICAgICBmb250TmFtZSwKICAgICAgICBoYXNFT0w6IGZhbHNlCiAgICAgIH0pOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBmbHVzaFRleHRDb250ZW50SXRlbSgpIHsKICAgICAgaWYgKCF0ZXh0Q29udGVudEl0ZW0uaW5pdGlhbGl6ZWQgfHwgIXRleHRDb250ZW50SXRlbS5zdHIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdGV4dENvbnRlbnRJdGVtLnZlcnRpY2FsKSB7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLnRvdGFsV2lkdGggKz0gdGV4dENvbnRlbnRJdGVtLndpZHRoICogdGV4dENvbnRlbnRJdGVtLnRleHRBZHZhbmNlU2NhbGU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLnRvdGFsSGVpZ2h0ICs9IHRleHRDb250ZW50SXRlbS5oZWlnaHQgKiB0ZXh0Q29udGVudEl0ZW0udGV4dEFkdmFuY2VTY2FsZTsKICAgICAgfQoKICAgICAgdGV4dENvbnRlbnQuaXRlbXMucHVzaChydW5CaWRpVHJhbnNmb3JtKHRleHRDb250ZW50SXRlbSkpOwogICAgICB0ZXh0Q29udGVudEl0ZW0uaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgICAgdGV4dENvbnRlbnRJdGVtLnN0ci5sZW5ndGggPSAwOwogICAgfQoKICAgIGZ1bmN0aW9uIGVucXVldWVDaHVuaygpIHsKICAgICAgbGV0IGJhdGNoID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgICAgY29uc3QgbGVuZ3RoID0gdGV4dENvbnRlbnQuaXRlbXMubGVuZ3RoOwoKICAgICAgaWYgKGxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGJhdGNoICYmIGxlbmd0aCA8IFRFWFRfQ0hVTktfQkFUQ0hfU0laRSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgc2luay5lbnF1ZXVlKHRleHRDb250ZW50LCBsZW5ndGgpOwogICAgICB0ZXh0Q29udGVudC5pdGVtcyA9IFtdOwogICAgICB0ZXh0Q29udGVudC5zdHlsZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgfQoKICAgIGNvbnN0IHRpbWVTbG90TWFuYWdlciA9IG5ldyBUaW1lU2xvdE1hbmFnZXIoKTsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiBwcm9taXNlQm9keShyZXNvbHZlLCByZWplY3QpIHsKICAgICAgY29uc3QgbmV4dCA9IGZ1bmN0aW9uIChwcm9taXNlKSB7CiAgICAgICAgZW5xdWV1ZUNodW5rKHRydWUpOwogICAgICAgIFByb21pc2UuYWxsKFtwcm9taXNlLCBzaW5rLnJlYWR5XSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBwcm9taXNlQm9keShyZXNvbHZlLCByZWplY3QpOwogICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgcmVqZWN0KGV4KTsKICAgICAgICAgIH0KICAgICAgICB9LCByZWplY3QpOwogICAgICB9OwoKICAgICAgdGFzay5lbnN1cmVOb3RUZXJtaW5hdGVkKCk7CiAgICAgIHRpbWVTbG90TWFuYWdlci5yZXNldCgpOwogICAgICBjb25zdCBvcGVyYXRpb24gPSB7fTsKICAgICAgbGV0IHN0b3AsCiAgICAgICAgICBhcmdzID0gW107CgogICAgICB3aGlsZSAoIShzdG9wID0gdGltZVNsb3RNYW5hZ2VyLmNoZWNrKCkpKSB7CiAgICAgICAgYXJncy5sZW5ndGggPSAwOwogICAgICAgIG9wZXJhdGlvbi5hcmdzID0gYXJnczsKCiAgICAgICAgaWYgKCFwcmVwcm9jZXNzb3IucmVhZChvcGVyYXRpb24pKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHRleHRTdGF0ZSA9IHN0YXRlTWFuYWdlci5zdGF0ZTsKICAgICAgICBjb25zdCBmbiA9IG9wZXJhdGlvbi5mbjsKICAgICAgICBhcmdzID0gb3BlcmF0aW9uLmFyZ3M7CgogICAgICAgIHN3aXRjaCAoZm4gfCAwKSB7CiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGb250OgogICAgICAgICAgICB2YXIgZm9udE5hbWVBcmcgPSBhcmdzWzBdLm5hbWUsCiAgICAgICAgICAgICAgICBmb250U2l6ZUFyZyA9IGFyZ3NbMV07CgogICAgICAgICAgICBpZiAodGV4dFN0YXRlLmZvbnQgJiYgZm9udE5hbWVBcmcgPT09IHRleHRTdGF0ZS5mb250TmFtZSAmJiBmb250U2l6ZUFyZyA9PT0gdGV4dFN0YXRlLmZvbnRTaXplKSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgICAgICAgIHRleHRTdGF0ZS5mb250TmFtZSA9IGZvbnROYW1lQXJnOwogICAgICAgICAgICB0ZXh0U3RhdGUuZm9udFNpemUgPSBmb250U2l6ZUFyZzsKICAgICAgICAgICAgbmV4dChoYW5kbGVTZXRGb250KGZvbnROYW1lQXJnLCBudWxsKSk7CiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRUZXh0UmlzZToKICAgICAgICAgICAgdGV4dFN0YXRlLnRleHRSaXNlID0gYXJnc1swXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0SFNjYWxlOgogICAgICAgICAgICB0ZXh0U3RhdGUudGV4dEhTY2FsZSA9IGFyZ3NbMF0gLyAxMDA7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldExlYWRpbmc6CiAgICAgICAgICAgIHRleHRTdGF0ZS5sZWFkaW5nID0gYXJnc1swXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubW92ZVRleHQ6CiAgICAgICAgICAgIHRleHRTdGF0ZS50cmFuc2xhdGVUZXh0TGluZU1hdHJpeChhcmdzWzBdLCBhcmdzWzFdKTsKICAgICAgICAgICAgdGV4dFN0YXRlLnRleHRNYXRyaXggPSB0ZXh0U3RhdGUudGV4dExpbmVNYXRyaXguc2xpY2UoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0TGVhZGluZ01vdmVUZXh0OgogICAgICAgICAgICB0ZXh0U3RhdGUubGVhZGluZyA9IC1hcmdzWzFdOwogICAgICAgICAgICB0ZXh0U3RhdGUudHJhbnNsYXRlVGV4dExpbmVNYXRyaXgoYXJnc1swXSwgYXJnc1sxXSk7CiAgICAgICAgICAgIHRleHRTdGF0ZS50ZXh0TWF0cml4ID0gdGV4dFN0YXRlLnRleHRMaW5lTWF0cml4LnNsaWNlKCk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLm5leHRMaW5lOgogICAgICAgICAgICB0ZXh0U3RhdGUuY2FycmlhZ2VSZXR1cm4oKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0VGV4dE1hdHJpeDoKICAgICAgICAgICAgdGV4dFN0YXRlLnNldFRleHRNYXRyaXgoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSwgYXJnc1s0XSwgYXJnc1s1XSk7CiAgICAgICAgICAgIHRleHRTdGF0ZS5zZXRUZXh0TGluZU1hdHJpeChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdLCBhcmdzWzRdLCBhcmdzWzVdKTsKICAgICAgICAgICAgdXBkYXRlQWR2YW5jZVNjYWxlKCk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldENoYXJTcGFjaW5nOgogICAgICAgICAgICB0ZXh0U3RhdGUuY2hhclNwYWNpbmcgPSBhcmdzWzBdOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRXb3JkU3BhY2luZzoKICAgICAgICAgICAgdGV4dFN0YXRlLndvcmRTcGFjaW5nID0gYXJnc1swXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuYmVnaW5UZXh0OgogICAgICAgICAgICB0ZXh0U3RhdGUudGV4dE1hdHJpeCA9IF91dGlsLklERU5USVRZX01BVFJJWC5zbGljZSgpOwogICAgICAgICAgICB0ZXh0U3RhdGUudGV4dExpbmVNYXRyaXggPSBfdXRpbC5JREVOVElUWV9NQVRSSVguc2xpY2UoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2hvd1NwYWNlZFRleHQ6CiAgICAgICAgICAgIGlmICghc3RhdGVNYW5hZ2VyLnN0YXRlLmZvbnQpIHsKICAgICAgICAgICAgICBzZWxmLmVuc3VyZVN0YXRlRm9udChzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCBzcGFjZUZhY3RvciA9ICh0ZXh0U3RhdGUuZm9udC52ZXJ0aWNhbCA/IDEgOiAtMSkgKiB0ZXh0U3RhdGUuZm9udFNpemUgLyAxMDAwOwogICAgICAgICAgICBjb25zdCBlbGVtZW50cyA9IGFyZ3NbMF07CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBlbGVtZW50cy5sZW5ndGg7IGkgPCBpaSAtIDE7IGkrKykgewogICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBlbGVtZW50c1tpXTsKCiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAic3RyaW5nIikgewogICAgICAgICAgICAgICAgc2hvd1NwYWNlZFRleHRCdWZmZXIucHVzaChpdGVtKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpdGVtID09PSAibnVtYmVyIiAmJiBpdGVtICE9PSAwKSB7CiAgICAgICAgICAgICAgICBjb25zdCBzdHIgPSBzaG93U3BhY2VkVGV4dEJ1ZmZlci5qb2luKCIiKTsKICAgICAgICAgICAgICAgIHNob3dTcGFjZWRUZXh0QnVmZmVyLmxlbmd0aCA9IDA7CiAgICAgICAgICAgICAgICBidWlsZFRleHRDb250ZW50SXRlbSh7CiAgICAgICAgICAgICAgICAgIGNoYXJzOiBzdHIsCiAgICAgICAgICAgICAgICAgIGV4dHJhU3BhY2luZzogaXRlbSAqIHNwYWNlRmFjdG9yCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBlbGVtZW50cy5hdCgtMSk7CgogICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgICAgc2hvd1NwYWNlZFRleHRCdWZmZXIucHVzaChpdGVtKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHNob3dTcGFjZWRUZXh0QnVmZmVyLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICBjb25zdCBzdHIgPSBzaG93U3BhY2VkVGV4dEJ1ZmZlci5qb2luKCIiKTsKICAgICAgICAgICAgICBzaG93U3BhY2VkVGV4dEJ1ZmZlci5sZW5ndGggPSAwOwogICAgICAgICAgICAgIGJ1aWxkVGV4dENvbnRlbnRJdGVtKHsKICAgICAgICAgICAgICAgIGNoYXJzOiBzdHIsCiAgICAgICAgICAgICAgICBleHRyYVNwYWNpbmc6IDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2hvd1RleHQ6CiAgICAgICAgICAgIGlmICghc3RhdGVNYW5hZ2VyLnN0YXRlLmZvbnQpIHsKICAgICAgICAgICAgICBzZWxmLmVuc3VyZVN0YXRlRm9udChzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBidWlsZFRleHRDb250ZW50SXRlbSh7CiAgICAgICAgICAgICAgY2hhcnM6IGFyZ3NbMF0sCiAgICAgICAgICAgICAgZXh0cmFTcGFjaW5nOiAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5uZXh0TGluZVNob3dUZXh0OgogICAgICAgICAgICBpZiAoIXN0YXRlTWFuYWdlci5zdGF0ZS5mb250KSB7CiAgICAgICAgICAgICAgc2VsZi5lbnN1cmVTdGF0ZUZvbnQoc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGV4dFN0YXRlLmNhcnJpYWdlUmV0dXJuKCk7CiAgICAgICAgICAgIGJ1aWxkVGV4dENvbnRlbnRJdGVtKHsKICAgICAgICAgICAgICBjaGFyczogYXJnc1swXSwKICAgICAgICAgICAgICBleHRyYVNwYWNpbmc6IDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLm5leHRMaW5lU2V0U3BhY2luZ1Nob3dUZXh0OgogICAgICAgICAgICBpZiAoIXN0YXRlTWFuYWdlci5zdGF0ZS5mb250KSB7CiAgICAgICAgICAgICAgc2VsZi5lbnN1cmVTdGF0ZUZvbnQoc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGV4dFN0YXRlLndvcmRTcGFjaW5nID0gYXJnc1swXTsKICAgICAgICAgICAgdGV4dFN0YXRlLmNoYXJTcGFjaW5nID0gYXJnc1sxXTsKICAgICAgICAgICAgdGV4dFN0YXRlLmNhcnJpYWdlUmV0dXJuKCk7CiAgICAgICAgICAgIGJ1aWxkVGV4dENvbnRlbnRJdGVtKHsKICAgICAgICAgICAgICBjaGFyczogYXJnc1syXSwKICAgICAgICAgICAgICBleHRyYVNwYWNpbmc6IDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnBhaW50WE9iamVjdDoKICAgICAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKCiAgICAgICAgICAgIGlmICgheG9ianMpIHsKICAgICAgICAgICAgICB4b2JqcyA9IHJlc291cmNlcy5nZXQoIlhPYmplY3QiKSB8fCBfcHJpbWl0aXZlcy5EaWN0LmVtcHR5OwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgaXNWYWxpZE5hbWUgPSBhcmdzWzBdIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZTsKICAgICAgICAgICAgdmFyIG5hbWUgPSBhcmdzWzBdLm5hbWU7CgogICAgICAgICAgICBpZiAoaXNWYWxpZE5hbWUgJiYgZW1wdHlYT2JqZWN0Q2FjaGUuZ2V0QnlOYW1lKG5hbWUpKSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5leHQobmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmVYT2JqZWN0LCByZWplY3RYT2JqZWN0KSB7CiAgICAgICAgICAgICAgaWYgKCFpc1ZhbGlkTmFtZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJYT2JqZWN0IG11c3QgYmUgcmVmZXJyZWQgdG8gYnkgbmFtZS4iKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGxldCB4b2JqID0geG9ianMuZ2V0UmF3KG5hbWUpOwoKICAgICAgICAgICAgICBpZiAoeG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICAgICAgaWYgKGVtcHR5WE9iamVjdENhY2hlLmdldEJ5UmVmKHhvYmopKSB7CiAgICAgICAgICAgICAgICAgIHJlc29sdmVYT2JqZWN0KCk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zdCBnbG9iYWxJbWFnZSA9IHNlbGYuZ2xvYmFsSW1hZ2VDYWNoZS5nZXREYXRhKHhvYmosIHNlbGYucGFnZUluZGV4KTsKCiAgICAgICAgICAgICAgICBpZiAoZ2xvYmFsSW1hZ2UpIHsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHhvYmogPSB4cmVmLmZldGNoKHhvYmopOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKCEoeG9iaiBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJYT2JqZWN0IHNob3VsZCBiZSBhIHN0cmVhbSIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgdHlwZSA9IHhvYmouZGljdC5nZXQoIlN1YnR5cGUiKTsKCiAgICAgICAgICAgICAgaWYgKCEodHlwZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlhPYmplY3Qgc2hvdWxkIGhhdmUgYSBOYW1lIHN1YnR5cGUiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICh0eXBlLm5hbWUgIT09ICJGb3JtIikgewogICAgICAgICAgICAgICAgZW1wdHlYT2JqZWN0Q2FjaGUuc2V0KG5hbWUsIHhvYmouZGljdC5vYmpJZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICByZXNvbHZlWE9iamVjdCgpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgY3VycmVudFN0YXRlID0gc3RhdGVNYW5hZ2VyLnN0YXRlLmNsb25lKCk7CiAgICAgICAgICAgICAgY29uc3QgeE9ialN0YXRlTWFuYWdlciA9IG5ldyBTdGF0ZU1hbmFnZXIoY3VycmVudFN0YXRlKTsKICAgICAgICAgICAgICBjb25zdCBtYXRyaXggPSB4b2JqLmRpY3QuZ2V0QXJyYXkoIk1hdHJpeCIpOwoKICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShtYXRyaXgpICYmIG1hdHJpeC5sZW5ndGggPT09IDYpIHsKICAgICAgICAgICAgICAgIHhPYmpTdGF0ZU1hbmFnZXIudHJhbnNmb3JtKG1hdHJpeCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBlbnF1ZXVlQ2h1bmsoKTsKICAgICAgICAgICAgICBjb25zdCBzaW5rV3JhcHBlciA9IHsKICAgICAgICAgICAgICAgIGVucXVldWVJbnZva2VkOiBmYWxzZSwKCiAgICAgICAgICAgICAgICBlbnF1ZXVlKGNodW5rLCBzaXplKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuZW5xdWV1ZUludm9rZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICBzaW5rLmVucXVldWUoY2h1bmssIHNpemUpOwogICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICAgICBnZXQgZGVzaXJlZFNpemUoKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBzaW5rLmRlc2lyZWRTaXplOwogICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICAgICBnZXQgcmVhZHkoKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBzaW5rLnJlYWR5OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIHNlbGYuZ2V0VGV4dENvbnRlbnQoewogICAgICAgICAgICAgICAgc3RyZWFtOiB4b2JqLAogICAgICAgICAgICAgICAgdGFzaywKICAgICAgICAgICAgICAgIHJlc291cmNlczogeG9iai5kaWN0LmdldCgiUmVzb3VyY2VzIikgfHwgcmVzb3VyY2VzLAogICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyOiB4T2JqU3RhdGVNYW5hZ2VyLAogICAgICAgICAgICAgICAgY29tYmluZVRleHRJdGVtcywKICAgICAgICAgICAgICAgIGluY2x1ZGVNYXJrZWRDb250ZW50LAogICAgICAgICAgICAgICAgc2luazogc2lua1dyYXBwZXIsCiAgICAgICAgICAgICAgICBzZWVuU3R5bGVzLAogICAgICAgICAgICAgICAgdmlld0JveAogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaWYgKCFzaW5rV3JhcHBlci5lbnF1ZXVlSW52b2tlZCkgewogICAgICAgICAgICAgICAgICBlbXB0eVhPYmplY3RDYWNoZS5zZXQobmFtZSwgeG9iai5kaWN0Lm9iaklkLCB0cnVlKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXNvbHZlWE9iamVjdCgpOwogICAgICAgICAgICAgIH0sIHJlamVjdFhPYmplY3QpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBnZXRUZXh0Q29udGVudCAtIGlnbm9yaW5nIFhPYmplY3Q6ICIke3JlYXNvbn0iLmApOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhyb3cgcmVhc29uOwogICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRHU3RhdGU6CiAgICAgICAgICAgIGlzVmFsaWROYW1lID0gYXJnc1swXSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWU7CiAgICAgICAgICAgIG5hbWUgPSBhcmdzWzBdLm5hbWU7CgogICAgICAgICAgICBpZiAoaXNWYWxpZE5hbWUgJiYgZW1wdHlHU3RhdGVDYWNoZS5nZXRCeU5hbWUobmFtZSkpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV4dChuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZUdTdGF0ZSwgcmVqZWN0R1N0YXRlKSB7CiAgICAgICAgICAgICAgaWYgKCFpc1ZhbGlkTmFtZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJHU3RhdGUgbXVzdCBiZSByZWZlcnJlZCB0byBieSBuYW1lLiIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgZXh0R1N0YXRlID0gcmVzb3VyY2VzLmdldCgiRXh0R1N0YXRlIik7CgogICAgICAgICAgICAgIGlmICghKGV4dEdTdGF0ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkV4dEdTdGF0ZSBzaG91bGQgYmUgYSBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgZ1N0YXRlID0gZXh0R1N0YXRlLmdldChuYW1lKTsKCiAgICAgICAgICAgICAgaWYgKCEoZ1N0YXRlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiR1N0YXRlIHNob3VsZCBiZSBhIGRpY3Rpb25hcnkuIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb25zdCBnU3RhdGVGb250ID0gZ1N0YXRlLmdldCgiRm9udCIpOwoKICAgICAgICAgICAgICBpZiAoIWdTdGF0ZUZvbnQpIHsKICAgICAgICAgICAgICAgIGVtcHR5R1N0YXRlQ2FjaGUuc2V0KG5hbWUsIGdTdGF0ZS5vYmpJZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICByZXNvbHZlR1N0YXRlKCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgICAgICAgIHRleHRTdGF0ZS5mb250TmFtZSA9IG51bGw7CiAgICAgICAgICAgICAgdGV4dFN0YXRlLmZvbnRTaXplID0gZ1N0YXRlRm9udFsxXTsKICAgICAgICAgICAgICBoYW5kbGVTZXRGb250KG51bGwsIGdTdGF0ZUZvbnRbMF0pLnRoZW4ocmVzb2x2ZUdTdGF0ZSwgcmVqZWN0R1N0YXRlKTsKICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICAgIGlmIChyZWFzb24gaW5zdGFuY2VvZiBfdXRpbC5BYm9ydEV4Y2VwdGlvbikgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgZ2V0VGV4dENvbnRlbnQgLSBpZ25vcmluZyBFeHRHU3RhdGU6ICIke3JlYXNvbn0iLmApOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhyb3cgcmVhc29uOwogICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5iZWdpbk1hcmtlZENvbnRlbnQ6CiAgICAgICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CgogICAgICAgICAgICBpZiAoaW5jbHVkZU1hcmtlZENvbnRlbnQpIHsKICAgICAgICAgICAgICB0ZXh0Q29udGVudC5pdGVtcy5wdXNoKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJiZWdpbk1hcmtlZENvbnRlbnQiLAogICAgICAgICAgICAgICAgdGFnOiBhcmdzWzBdIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IGFyZ3NbMF0ubmFtZSA6IG51bGwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuYmVnaW5NYXJrZWRDb250ZW50UHJvcHM6CiAgICAgICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CgogICAgICAgICAgICBpZiAoaW5jbHVkZU1hcmtlZENvbnRlbnQpIHsKICAgICAgICAgICAgICBsZXQgbWNpZCA9IG51bGw7CgogICAgICAgICAgICAgIGlmIChhcmdzWzFdIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgICAgICAgICAgbWNpZCA9IGFyZ3NbMV0uZ2V0KCJNQ0lEIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0ZXh0Q29udGVudC5pdGVtcy5wdXNoKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJiZWdpbk1hcmtlZENvbnRlbnRQcm9wcyIsCiAgICAgICAgICAgICAgICBpZDogTnVtYmVyLmlzSW50ZWdlcihtY2lkKSA/IGAke3NlbGYuaWRGYWN0b3J5LmdldFBhZ2VPYmpJZCgpfV9tY2lkJHttY2lkfWAgOiBudWxsLAogICAgICAgICAgICAgICAgdGFnOiBhcmdzWzBdIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IGFyZ3NbMF0ubmFtZSA6IG51bGwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuZW5kTWFya2VkQ29udGVudDoKICAgICAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKCiAgICAgICAgICAgIGlmIChpbmNsdWRlTWFya2VkQ29udGVudCkgewogICAgICAgICAgICAgIHRleHRDb250ZW50Lml0ZW1zLnB1c2goewogICAgICAgICAgICAgICAgdHlwZTogImVuZE1hcmtlZENvbnRlbnQiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRleHRDb250ZW50Lml0ZW1zLmxlbmd0aCA+PSBzaW5rLmRlc2lyZWRTaXplKSB7CiAgICAgICAgICBzdG9wID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHN0b3ApIHsKICAgICAgICBuZXh0KGRlZmVycmVkKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgIGVucXVldWVDaHVuaygpOwogICAgICByZXNvbHZlKCk7CiAgICB9KS5jYXRjaChyZWFzb24gPT4gewogICAgICBpZiAocmVhc29uIGluc3RhbmNlb2YgX3V0aWwuQWJvcnRFeGNlcHRpb24pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBnZXRUZXh0Q29udGVudCAtIGlnbm9yaW5nIGVycm9ycyBkdXJpbmcgIiR7dGFzay5uYW1lfSIgYCArIGB0YXNrOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgIGVucXVldWVDaHVuaygpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhyb3cgcmVhc29uOwogICAgfSk7CiAgfQoKICBleHRyYWN0RGF0YVN0cnVjdHVyZXMoZGljdCwgYmFzZURpY3QsIHByb3BlcnRpZXMpIHsKICAgIGNvbnN0IHhyZWYgPSB0aGlzLnhyZWY7CiAgICBsZXQgY2lkVG9HaWRCeXRlczsKICAgIGNvbnN0IHRvVW5pY29kZVByb21pc2UgPSB0aGlzLnJlYWRUb1VuaWNvZGUocHJvcGVydGllcy50b1VuaWNvZGUgfHwgZGljdC5nZXQoIlRvVW5pY29kZSIpIHx8IGJhc2VEaWN0LmdldCgiVG9Vbmljb2RlIikpOwoKICAgIGlmIChwcm9wZXJ0aWVzLmNvbXBvc2l0ZSkgewogICAgICBjb25zdCBjaWRTeXN0ZW1JbmZvID0gZGljdC5nZXQoIkNJRFN5c3RlbUluZm8iKTsKCiAgICAgIGlmIChjaWRTeXN0ZW1JbmZvIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgIHByb3BlcnRpZXMuY2lkU3lzdGVtSW5mbyA9IHsKICAgICAgICAgIHJlZ2lzdHJ5OiAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGNpZFN5c3RlbUluZm8uZ2V0KCJSZWdpc3RyeSIpKSwKICAgICAgICAgIG9yZGVyaW5nOiAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGNpZFN5c3RlbUluZm8uZ2V0KCJPcmRlcmluZyIpKSwKICAgICAgICAgIHN1cHBsZW1lbnQ6IGNpZFN5c3RlbUluZm8uZ2V0KCJTdXBwbGVtZW50IikKICAgICAgICB9OwogICAgICB9CgogICAgICB0cnkgewogICAgICAgIGNvbnN0IGNpZFRvR2lkTWFwID0gZGljdC5nZXQoIkNJRFRvR0lETWFwIik7CgogICAgICAgIGlmIChjaWRUb0dpZE1hcCBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgICAgICBjaWRUb0dpZEJ5dGVzID0gY2lkVG9HaWRNYXAuZ2V0Qnl0ZXMoKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgICB0aHJvdyBleDsKICAgICAgICB9CgogICAgICAgICgwLCBfdXRpbC53YXJuKShgZXh0cmFjdERhdGFTdHJ1Y3R1cmVzIC0gaWdub3JpbmcgQ0lEVG9HSURNYXAgZGF0YTogIiR7ZXh9Ii5gKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGRpZmZlcmVuY2VzID0gW107CiAgICBsZXQgYmFzZUVuY29kaW5nTmFtZSA9IG51bGw7CiAgICBsZXQgZW5jb2Rpbmc7CgogICAgaWYgKGRpY3QuaGFzKCJFbmNvZGluZyIpKSB7CiAgICAgIGVuY29kaW5nID0gZGljdC5nZXQoIkVuY29kaW5nIik7CgogICAgICBpZiAoZW5jb2RpbmcgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgYmFzZUVuY29kaW5nTmFtZSA9IGVuY29kaW5nLmdldCgiQmFzZUVuY29kaW5nIik7CiAgICAgICAgYmFzZUVuY29kaW5nTmFtZSA9IGJhc2VFbmNvZGluZ05hbWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gYmFzZUVuY29kaW5nTmFtZS5uYW1lIDogbnVsbDsKCiAgICAgICAgaWYgKGVuY29kaW5nLmhhcygiRGlmZmVyZW5jZXMiKSkgewogICAgICAgICAgY29uc3QgZGlmZkVuY29kaW5nID0gZW5jb2RpbmcuZ2V0KCJEaWZmZXJlbmNlcyIpOwogICAgICAgICAgbGV0IGluZGV4ID0gMDsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMCwgamogPSBkaWZmRW5jb2RpbmcubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgICAgICBjb25zdCBkYXRhID0geHJlZi5mZXRjaElmUmVmKGRpZmZFbmNvZGluZ1tqXSk7CgogICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICJudW1iZXIiKSB7CiAgICAgICAgICAgICAgaW5kZXggPSBkYXRhOwogICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgICAgZGlmZmVyZW5jZXNbaW5kZXgrK10gPSBkYXRhLm5hbWU7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBJbnZhbGlkIGVudHJ5IGluICdEaWZmZXJlbmNlcycgYXJyYXk6ICR7ZGF0YX1gKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICBiYXNlRW5jb2RpbmdOYW1lID0gZW5jb2RpbmcubmFtZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBtc2cgPSAiRW5jb2RpbmcgaXMgbm90IGEgTmFtZSBub3IgYSBEaWN0IjsKCiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IobXNnKTsKICAgICAgICB9CgogICAgICAgICgwLCBfdXRpbC53YXJuKShtc2cpOwogICAgICB9CgogICAgICBpZiAoYmFzZUVuY29kaW5nTmFtZSAhPT0gIk1hY1JvbWFuRW5jb2RpbmciICYmIGJhc2VFbmNvZGluZ05hbWUgIT09ICJNYWNFeHBlcnRFbmNvZGluZyIgJiYgYmFzZUVuY29kaW5nTmFtZSAhPT0gIldpbkFuc2lFbmNvZGluZyIpIHsKICAgICAgICBiYXNlRW5jb2RpbmdOYW1lID0gbnVsbDsKICAgICAgfQogICAgfQoKICAgIGlmIChiYXNlRW5jb2RpbmdOYW1lKSB7CiAgICAgIHByb3BlcnRpZXMuZGVmYXVsdEVuY29kaW5nID0gKDAsIF9lbmNvZGluZ3MuZ2V0RW5jb2RpbmcpKGJhc2VFbmNvZGluZ05hbWUpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgaXNTeW1ib2xpY0ZvbnQgPSAhIShwcm9wZXJ0aWVzLmZsYWdzICYgX2ZvbnRzX3V0aWxzLkZvbnRGbGFncy5TeW1ib2xpYyk7CiAgICAgIGNvbnN0IGlzTm9uc3ltYm9saWNGb250ID0gISEocHJvcGVydGllcy5mbGFncyAmIF9mb250c191dGlscy5Gb250RmxhZ3MuTm9uc3ltYm9saWMpOwogICAgICBlbmNvZGluZyA9IF9lbmNvZGluZ3MuU3RhbmRhcmRFbmNvZGluZzsKCiAgICAgIGlmIChwcm9wZXJ0aWVzLnR5cGUgPT09ICJUcnVlVHlwZSIgJiYgIWlzTm9uc3ltYm9saWNGb250KSB7CiAgICAgICAgZW5jb2RpbmcgPSBfZW5jb2RpbmdzLldpbkFuc2lFbmNvZGluZzsKICAgICAgfQoKICAgICAgaWYgKGlzU3ltYm9saWNGb250KSB7CiAgICAgICAgZW5jb2RpbmcgPSBfZW5jb2RpbmdzLk1hY1JvbWFuRW5jb2Rpbmc7CgogICAgICAgIGlmICghcHJvcGVydGllcy5maWxlIHx8IHByb3BlcnRpZXMuaXNJbnRlcm5hbEZvbnQpIHsKICAgICAgICAgIGlmICgvU3ltYm9sL2kudGVzdChwcm9wZXJ0aWVzLm5hbWUpKSB7CiAgICAgICAgICAgIGVuY29kaW5nID0gX2VuY29kaW5ncy5TeW1ib2xTZXRFbmNvZGluZzsKICAgICAgICAgIH0gZWxzZSBpZiAoL0RpbmdiYXRzfFdpbmdkaW5ncy9pLnRlc3QocHJvcGVydGllcy5uYW1lKSkgewogICAgICAgICAgICBlbmNvZGluZyA9IF9lbmNvZGluZ3MuWmFwZkRpbmdiYXRzRW5jb2Rpbmc7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBwcm9wZXJ0aWVzLmRlZmF1bHRFbmNvZGluZyA9IGVuY29kaW5nOwogICAgfQoKICAgIHByb3BlcnRpZXMuZGlmZmVyZW5jZXMgPSBkaWZmZXJlbmNlczsKICAgIHByb3BlcnRpZXMuYmFzZUVuY29kaW5nTmFtZSA9IGJhc2VFbmNvZGluZ05hbWU7CiAgICBwcm9wZXJ0aWVzLmhhc0VuY29kaW5nID0gISFiYXNlRW5jb2RpbmdOYW1lIHx8IGRpZmZlcmVuY2VzLmxlbmd0aCA+IDA7CiAgICBwcm9wZXJ0aWVzLmRpY3QgPSBkaWN0OwogICAgcmV0dXJuIHRvVW5pY29kZVByb21pc2UudGhlbihyZWFkVG9Vbmljb2RlID0+IHsKICAgICAgcHJvcGVydGllcy50b1VuaWNvZGUgPSByZWFkVG9Vbmljb2RlOwogICAgICByZXR1cm4gdGhpcy5idWlsZFRvVW5pY29kZShwcm9wZXJ0aWVzKTsKICAgIH0pLnRoZW4oYnVpbHRUb1VuaWNvZGUgPT4gewogICAgICBwcm9wZXJ0aWVzLnRvVW5pY29kZSA9IGJ1aWx0VG9Vbmljb2RlOwoKICAgICAgaWYgKGNpZFRvR2lkQnl0ZXMpIHsKICAgICAgICBwcm9wZXJ0aWVzLmNpZFRvR2lkTWFwID0gdGhpcy5yZWFkQ2lkVG9HaWRNYXAoY2lkVG9HaWRCeXRlcywgYnVpbHRUb1VuaWNvZGUpOwogICAgICB9CgogICAgICByZXR1cm4gcHJvcGVydGllczsKICAgIH0pOwogIH0KCiAgX3NpbXBsZUZvbnRUb1VuaWNvZGUocHJvcGVydGllcykgewogICAgbGV0IGZvcmNlR2x5cGhzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAgICgwLCBfdXRpbC5hc3NlcnQpKCFwcm9wZXJ0aWVzLmNvbXBvc2l0ZSwgIk11c3QgYmUgYSBzaW1wbGUgZm9udC4iKTsKICAgIGNvbnN0IHRvVW5pY29kZSA9IFtdOwogICAgY29uc3QgZW5jb2RpbmcgPSBwcm9wZXJ0aWVzLmRlZmF1bHRFbmNvZGluZy5zbGljZSgpOwogICAgY29uc3QgYmFzZUVuY29kaW5nTmFtZSA9IHByb3BlcnRpZXMuYmFzZUVuY29kaW5nTmFtZTsKICAgIGNvbnN0IGRpZmZlcmVuY2VzID0gcHJvcGVydGllcy5kaWZmZXJlbmNlczsKCiAgICBmb3IgKGNvbnN0IGNoYXJjb2RlIGluIGRpZmZlcmVuY2VzKSB7CiAgICAgIGNvbnN0IGdseXBoTmFtZSA9IGRpZmZlcmVuY2VzW2NoYXJjb2RlXTsKCiAgICAgIGlmIChnbHlwaE5hbWUgPT09ICIubm90ZGVmIikgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBlbmNvZGluZ1tjaGFyY29kZV0gPSBnbHlwaE5hbWU7CiAgICB9CgogICAgY29uc3QgZ2x5cGhzVW5pY29kZU1hcCA9ICgwLCBfZ2x5cGhsaXN0LmdldEdseXBoc1VuaWNvZGUpKCk7CgogICAgZm9yIChjb25zdCBjaGFyY29kZSBpbiBlbmNvZGluZykgewogICAgICBsZXQgZ2x5cGhOYW1lID0gZW5jb2RpbmdbY2hhcmNvZGVdOwoKICAgICAgaWYgKGdseXBoTmFtZSA9PT0gIiIpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfSBlbHNlIGlmIChnbHlwaHNVbmljb2RlTWFwW2dseXBoTmFtZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgIGxldCBjb2RlID0gMDsKCiAgICAgICAgc3dpdGNoIChnbHlwaE5hbWVbMF0pIHsKICAgICAgICAgIGNhc2UgIkciOgogICAgICAgICAgICBpZiAoZ2x5cGhOYW1lLmxlbmd0aCA9PT0gMykgewogICAgICAgICAgICAgIGNvZGUgPSBwYXJzZUludChnbHlwaE5hbWUuc3Vic3RyaW5nKDEpLCAxNik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImciOgogICAgICAgICAgICBpZiAoZ2x5cGhOYW1lLmxlbmd0aCA9PT0gNSkgewogICAgICAgICAgICAgIGNvZGUgPSBwYXJzZUludChnbHlwaE5hbWUuc3Vic3RyaW5nKDEpLCAxNik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIkMiOgogICAgICAgICAgY2FzZSAiYyI6CiAgICAgICAgICAgIGlmIChnbHlwaE5hbWUubGVuZ3RoID49IDMgJiYgZ2x5cGhOYW1lLmxlbmd0aCA8PSA0KSB7CiAgICAgICAgICAgICAgY29uc3QgY29kZVN0ciA9IGdseXBoTmFtZS5zdWJzdHJpbmcoMSk7CgogICAgICAgICAgICAgIGlmIChmb3JjZUdseXBocykgewogICAgICAgICAgICAgICAgY29kZSA9IHBhcnNlSW50KGNvZGVTdHIsIDE2KTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29kZSA9ICtjb2RlU3RyOwoKICAgICAgICAgICAgICBpZiAoTnVtYmVyLmlzTmFOKGNvZGUpICYmIE51bWJlci5pc0ludGVnZXIocGFyc2VJbnQoY29kZVN0ciwgMTYpKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NpbXBsZUZvbnRUb1VuaWNvZGUocHJvcGVydGllcywgdHJ1ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBjb25zdCB1bmljb2RlID0gKDAsIF91bmljb2RlLmdldFVuaWNvZGVGb3JHbHlwaCkoZ2x5cGhOYW1lLCBnbHlwaHNVbmljb2RlTWFwKTsKCiAgICAgICAgICAgIGlmICh1bmljb2RlICE9PSAtMSkgewogICAgICAgICAgICAgIGNvZGUgPSB1bmljb2RlOwogICAgICAgICAgICB9CgogICAgICAgIH0KCiAgICAgICAgaWYgKGNvZGUgPiAwICYmIGNvZGUgPD0gMHgxMGZmZmYgJiYgTnVtYmVyLmlzSW50ZWdlcihjb2RlKSkgewogICAgICAgICAgaWYgKGJhc2VFbmNvZGluZ05hbWUgJiYgY29kZSA9PT0gK2NoYXJjb2RlKSB7CiAgICAgICAgICAgIGNvbnN0IGJhc2VFbmNvZGluZyA9ICgwLCBfZW5jb2RpbmdzLmdldEVuY29kaW5nKShiYXNlRW5jb2RpbmdOYW1lKTsKCiAgICAgICAgICAgIGlmIChiYXNlRW5jb2RpbmcgJiYgKGdseXBoTmFtZSA9IGJhc2VFbmNvZGluZ1tjaGFyY29kZV0pKSB7CiAgICAgICAgICAgICAgdG9Vbmljb2RlW2NoYXJjb2RlXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZ2x5cGhzVW5pY29kZU1hcFtnbHlwaE5hbWVdKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHRvVW5pY29kZVtjaGFyY29kZV0gPSBTdHJpbmcuZnJvbUNvZGVQb2ludChjb2RlKTsKICAgICAgICB9CgogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICB0b1VuaWNvZGVbY2hhcmNvZGVdID0gU3RyaW5nLmZyb21DaGFyQ29kZShnbHlwaHNVbmljb2RlTWFwW2dseXBoTmFtZV0pOwogICAgfQoKICAgIHJldHVybiB0b1VuaWNvZGU7CiAgfQoKICBhc3luYyBidWlsZFRvVW5pY29kZShwcm9wZXJ0aWVzKSB7CiAgICBwcm9wZXJ0aWVzLmhhc0luY2x1ZGVkVG9Vbmljb2RlTWFwID0gISFwcm9wZXJ0aWVzLnRvVW5pY29kZSAmJiBwcm9wZXJ0aWVzLnRvVW5pY29kZS5sZW5ndGggPiAwOwoKICAgIGlmIChwcm9wZXJ0aWVzLmhhc0luY2x1ZGVkVG9Vbmljb2RlTWFwKSB7CiAgICAgIGlmICghcHJvcGVydGllcy5jb21wb3NpdGUgJiYgcHJvcGVydGllcy5oYXNFbmNvZGluZykgewogICAgICAgIHByb3BlcnRpZXMuZmFsbGJhY2tUb1VuaWNvZGUgPSB0aGlzLl9zaW1wbGVGb250VG9Vbmljb2RlKHByb3BlcnRpZXMpOwogICAgICB9CgogICAgICByZXR1cm4gcHJvcGVydGllcy50b1VuaWNvZGU7CiAgICB9CgogICAgaWYgKCFwcm9wZXJ0aWVzLmNvbXBvc2l0ZSkgewogICAgICByZXR1cm4gbmV3IF90b191bmljb2RlX21hcC5Ub1VuaWNvZGVNYXAodGhpcy5fc2ltcGxlRm9udFRvVW5pY29kZShwcm9wZXJ0aWVzKSk7CiAgICB9CgogICAgaWYgKHByb3BlcnRpZXMuY29tcG9zaXRlICYmIChwcm9wZXJ0aWVzLmNNYXAuYnVpbHRJbkNNYXAgJiYgIShwcm9wZXJ0aWVzLmNNYXAgaW5zdGFuY2VvZiBfY21hcC5JZGVudGl0eUNNYXApIHx8IHByb3BlcnRpZXMuY2lkU3lzdGVtSW5mby5yZWdpc3RyeSA9PT0gIkFkb2JlIiAmJiAocHJvcGVydGllcy5jaWRTeXN0ZW1JbmZvLm9yZGVyaW5nID09PSAiR0IxIiB8fCBwcm9wZXJ0aWVzLmNpZFN5c3RlbUluZm8ub3JkZXJpbmcgPT09ICJDTlMxIiB8fCBwcm9wZXJ0aWVzLmNpZFN5c3RlbUluZm8ub3JkZXJpbmcgPT09ICJKYXBhbjEiIHx8IHByb3BlcnRpZXMuY2lkU3lzdGVtSW5mby5vcmRlcmluZyA9PT0gIktvcmVhMSIpKSkgewogICAgICBjb25zdCB7CiAgICAgICAgcmVnaXN0cnksCiAgICAgICAgb3JkZXJpbmcKICAgICAgfSA9IHByb3BlcnRpZXMuY2lkU3lzdGVtSW5mbzsKCiAgICAgIGNvbnN0IHVjczJDTWFwTmFtZSA9IF9wcmltaXRpdmVzLk5hbWUuZ2V0KGAke3JlZ2lzdHJ5fS0ke29yZGVyaW5nfS1VQ1MyYCk7CgogICAgICBjb25zdCB1Y3MyQ01hcCA9IGF3YWl0IF9jbWFwLkNNYXBGYWN0b3J5LmNyZWF0ZSh7CiAgICAgICAgZW5jb2Rpbmc6IHVjczJDTWFwTmFtZSwKICAgICAgICBmZXRjaEJ1aWx0SW5DTWFwOiB0aGlzLl9mZXRjaEJ1aWx0SW5DTWFwQm91bmQsCiAgICAgICAgdXNlQ01hcDogbnVsbAogICAgICB9KTsKICAgICAgY29uc3QgdG9Vbmljb2RlID0gW107CiAgICAgIHByb3BlcnRpZXMuY01hcC5mb3JFYWNoKGZ1bmN0aW9uIChjaGFyY29kZSwgY2lkKSB7CiAgICAgICAgaWYgKGNpZCA+IDB4ZmZmZikgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJNYXggc2l6ZSBvZiBDSUQgaXMgNjUsNTM1Iik7CiAgICAgICAgfQoKICAgICAgICBjb25zdCB1Y3MyID0gdWNzMkNNYXAubG9va3VwKGNpZCk7CgogICAgICAgIGlmICh1Y3MyKSB7CiAgICAgICAgICB0b1VuaWNvZGVbY2hhcmNvZGVdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgodWNzMi5jaGFyQ29kZUF0KDApIDw8IDgpICsgdWNzMi5jaGFyQ29kZUF0KDEpKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gbmV3IF90b191bmljb2RlX21hcC5Ub1VuaWNvZGVNYXAodG9Vbmljb2RlKTsKICAgIH0KCiAgICByZXR1cm4gbmV3IF90b191bmljb2RlX21hcC5JZGVudGl0eVRvVW5pY29kZU1hcChwcm9wZXJ0aWVzLmZpcnN0Q2hhciwgcHJvcGVydGllcy5sYXN0Q2hhcik7CiAgfQoKICByZWFkVG9Vbmljb2RlKGNtYXBPYmopIHsKICAgIGlmICghY21hcE9iaikgewogICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpOwogICAgfQoKICAgIGlmIChjbWFwT2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICByZXR1cm4gX2NtYXAuQ01hcEZhY3RvcnkuY3JlYXRlKHsKICAgICAgICBlbmNvZGluZzogY21hcE9iaiwKICAgICAgICBmZXRjaEJ1aWx0SW5DTWFwOiB0aGlzLl9mZXRjaEJ1aWx0SW5DTWFwQm91bmQsCiAgICAgICAgdXNlQ01hcDogbnVsbAogICAgICB9KS50aGVuKGZ1bmN0aW9uIChjbWFwKSB7CiAgICAgICAgaWYgKGNtYXAgaW5zdGFuY2VvZiBfY21hcC5JZGVudGl0eUNNYXApIHsKICAgICAgICAgIHJldHVybiBuZXcgX3RvX3VuaWNvZGVfbWFwLklkZW50aXR5VG9Vbmljb2RlTWFwKDAsIDB4ZmZmZik7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3IF90b191bmljb2RlX21hcC5Ub1VuaWNvZGVNYXAoY21hcC5nZXRNYXAoKSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChjbWFwT2JqIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgcmV0dXJuIF9jbWFwLkNNYXBGYWN0b3J5LmNyZWF0ZSh7CiAgICAgICAgZW5jb2Rpbmc6IGNtYXBPYmosCiAgICAgICAgZmV0Y2hCdWlsdEluQ01hcDogdGhpcy5fZmV0Y2hCdWlsdEluQ01hcEJvdW5kLAogICAgICAgIHVzZUNNYXA6IG51bGwKICAgICAgfSkudGhlbihmdW5jdGlvbiAoY21hcCkgewogICAgICAgIGlmIChjbWFwIGluc3RhbmNlb2YgX2NtYXAuSWRlbnRpdHlDTWFwKSB7CiAgICAgICAgICByZXR1cm4gbmV3IF90b191bmljb2RlX21hcC5JZGVudGl0eVRvVW5pY29kZU1hcCgwLCAweGZmZmYpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgbWFwID0gbmV3IEFycmF5KGNtYXAubGVuZ3RoKTsKICAgICAgICBjbWFwLmZvckVhY2goZnVuY3Rpb24gKGNoYXJDb2RlLCB0b2tlbikgewogICAgICAgICAgaWYgKHR5cGVvZiB0b2tlbiA9PT0gIm51bWJlciIpIHsKICAgICAgICAgICAgbWFwW2NoYXJDb2RlXSA9IFN0cmluZy5mcm9tQ29kZVBvaW50KHRva2VuKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IHN0ciA9IFtdOwoKICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgdG9rZW4ubGVuZ3RoOyBrICs9IDIpIHsKICAgICAgICAgICAgY29uc3QgdzEgPSB0b2tlbi5jaGFyQ29kZUF0KGspIDw8IDggfCB0b2tlbi5jaGFyQ29kZUF0KGsgKyAxKTsKCiAgICAgICAgICAgIGlmICgodzEgJiAweGY4MDApICE9PSAweGQ4MDApIHsKICAgICAgICAgICAgICBzdHIucHVzaCh3MSk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGsgKz0gMjsKICAgICAgICAgICAgY29uc3QgdzIgPSB0b2tlbi5jaGFyQ29kZUF0KGspIDw8IDggfCB0b2tlbi5jaGFyQ29kZUF0KGsgKyAxKTsKICAgICAgICAgICAgc3RyLnB1c2goKCh3MSAmIDB4M2ZmKSA8PCAxMCkgKyAodzIgJiAweDNmZikgKyAweDEwMDAwKTsKICAgICAgICAgIH0KCiAgICAgICAgICBtYXBbY2hhckNvZGVdID0gU3RyaW5nLmZyb21Db2RlUG9pbnQoLi4uc3RyKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gbmV3IF90b191bmljb2RlX21hcC5Ub1VuaWNvZGVNYXAobWFwKTsKICAgICAgfSwgcmVhc29uID0+IHsKICAgICAgICBpZiAocmVhc29uIGluc3RhbmNlb2YgX3V0aWwuQWJvcnRFeGNlcHRpb24pIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICAgIHRoaXMuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JGb250VG9Vbmljb2RlCiAgICAgICAgICB9KTsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgcmVhZFRvVW5pY29kZSAtIGlnbm9yaW5nIFRvVW5pY29kZSBkYXRhOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgcmVhc29uOwogICAgICB9KTsKICAgIH0KCiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpOwogIH0KCiAgcmVhZENpZFRvR2lkTWFwKGdseXBoc0RhdGEsIHRvVW5pY29kZSkgewogICAgY29uc3QgcmVzdWx0ID0gW107CgogICAgZm9yIChsZXQgaiA9IDAsIGpqID0gZ2x5cGhzRGF0YS5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgIGNvbnN0IGdseXBoSUQgPSBnbHlwaHNEYXRhW2orK10gPDwgOCB8IGdseXBoc0RhdGFbal07CiAgICAgIGNvbnN0IGNvZGUgPSBqID4+IDE7CgogICAgICBpZiAoZ2x5cGhJRCA9PT0gMCAmJiAhdG9Vbmljb2RlLmhhcyhjb2RlKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICByZXN1bHRbY29kZV0gPSBnbHlwaElEOwogICAgfQoKICAgIHJldHVybiByZXN1bHQ7CiAgfQoKICBleHRyYWN0V2lkdGhzKGRpY3QsIGRlc2NyaXB0b3IsIHByb3BlcnRpZXMpIHsKICAgIGNvbnN0IHhyZWYgPSB0aGlzLnhyZWY7CiAgICBsZXQgZ2x5cGhzV2lkdGhzID0gW107CiAgICBsZXQgZGVmYXVsdFdpZHRoID0gMDsKICAgIGNvbnN0IGdseXBoc1ZNZXRyaWNzID0gW107CiAgICBsZXQgZGVmYXVsdFZNZXRyaWNzOwogICAgbGV0IGksIGlpLCBqLCBqaiwgc3RhcnQsIGNvZGUsIHdpZHRoczsKCiAgICBpZiAocHJvcGVydGllcy5jb21wb3NpdGUpIHsKICAgICAgZGVmYXVsdFdpZHRoID0gZGljdC5oYXMoIkRXIikgPyBkaWN0LmdldCgiRFciKSA6IDEwMDA7CiAgICAgIHdpZHRocyA9IGRpY3QuZ2V0KCJXIik7CgogICAgICBpZiAod2lkdGhzKSB7CiAgICAgICAgZm9yIChpID0gMCwgaWkgPSB3aWR0aHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgc3RhcnQgPSB4cmVmLmZldGNoSWZSZWYod2lkdGhzW2krK10pOwogICAgICAgICAgY29kZSA9IHhyZWYuZmV0Y2hJZlJlZih3aWR0aHNbaV0pOwoKICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvZGUpKSB7CiAgICAgICAgICAgIGZvciAoaiA9IDAsIGpqID0gY29kZS5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICAgICAgZ2x5cGhzV2lkdGhzW3N0YXJ0KytdID0geHJlZi5mZXRjaElmUmVmKGNvZGVbal0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCB3aWR0aCA9IHhyZWYuZmV0Y2hJZlJlZih3aWR0aHNbKytpXSk7CgogICAgICAgICAgICBmb3IgKGogPSBzdGFydDsgaiA8PSBjb2RlOyBqKyspIHsKICAgICAgICAgICAgICBnbHlwaHNXaWR0aHNbal0gPSB3aWR0aDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHByb3BlcnRpZXMudmVydGljYWwpIHsKICAgICAgICBsZXQgdm1ldHJpY3MgPSBkaWN0LmdldEFycmF5KCJEVzIiKSB8fCBbODgwLCAtMTAwMF07CiAgICAgICAgZGVmYXVsdFZNZXRyaWNzID0gW3ZtZXRyaWNzWzFdLCBkZWZhdWx0V2lkdGggKiAwLjUsIHZtZXRyaWNzWzBdXTsKICAgICAgICB2bWV0cmljcyA9IGRpY3QuZ2V0KCJXMiIpOwoKICAgICAgICBpZiAodm1ldHJpY3MpIHsKICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gdm1ldHJpY3MubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgICBzdGFydCA9IHhyZWYuZmV0Y2hJZlJlZih2bWV0cmljc1tpKytdKTsKICAgICAgICAgICAgY29kZSA9IHhyZWYuZmV0Y2hJZlJlZih2bWV0cmljc1tpXSk7CgogICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb2RlKSkgewogICAgICAgICAgICAgIGZvciAoaiA9IDAsIGpqID0gY29kZS5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICAgICAgICBnbHlwaHNWTWV0cmljc1tzdGFydCsrXSA9IFt4cmVmLmZldGNoSWZSZWYoY29kZVtqKytdKSwgeHJlZi5mZXRjaElmUmVmKGNvZGVbaisrXSksIHhyZWYuZmV0Y2hJZlJlZihjb2RlW2pdKV07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnN0IHZtZXRyaWMgPSBbeHJlZi5mZXRjaElmUmVmKHZtZXRyaWNzWysraV0pLCB4cmVmLmZldGNoSWZSZWYodm1ldHJpY3NbKytpXSksIHhyZWYuZmV0Y2hJZlJlZih2bWV0cmljc1srK2ldKV07CgogICAgICAgICAgICAgIGZvciAoaiA9IHN0YXJ0OyBqIDw9IGNvZGU7IGorKykgewogICAgICAgICAgICAgICAgZ2x5cGhzVk1ldHJpY3Nbal0gPSB2bWV0cmljOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgY29uc3QgZmlyc3RDaGFyID0gcHJvcGVydGllcy5maXJzdENoYXI7CiAgICAgIHdpZHRocyA9IGRpY3QuZ2V0KCJXaWR0aHMiKTsKCiAgICAgIGlmICh3aWR0aHMpIHsKICAgICAgICBqID0gZmlyc3RDaGFyOwoKICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHdpZHRocy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICBnbHlwaHNXaWR0aHNbaisrXSA9IHhyZWYuZmV0Y2hJZlJlZih3aWR0aHNbaV0pOwogICAgICAgIH0KCiAgICAgICAgZGVmYXVsdFdpZHRoID0gcGFyc2VGbG9hdChkZXNjcmlwdG9yLmdldCgiTWlzc2luZ1dpZHRoIikpIHx8IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgYmFzZUZvbnROYW1lID0gZGljdC5nZXQoIkJhc2VGb250Iik7CgogICAgICAgIGlmIChiYXNlRm9udE5hbWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICBjb25zdCBtZXRyaWNzID0gdGhpcy5nZXRCYXNlRm9udE1ldHJpY3MoYmFzZUZvbnROYW1lLm5hbWUpOwogICAgICAgICAgZ2x5cGhzV2lkdGhzID0gdGhpcy5idWlsZENoYXJDb2RlVG9XaWR0aChtZXRyaWNzLndpZHRocywgcHJvcGVydGllcyk7CiAgICAgICAgICBkZWZhdWx0V2lkdGggPSBtZXRyaWNzLmRlZmF1bHRXaWR0aDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBsZXQgaXNNb25vc3BhY2UgPSB0cnVlOwogICAgbGV0IGZpcnN0V2lkdGggPSBkZWZhdWx0V2lkdGg7CgogICAgZm9yIChjb25zdCBnbHlwaCBpbiBnbHlwaHNXaWR0aHMpIHsKICAgICAgY29uc3QgZ2x5cGhXaWR0aCA9IGdseXBoc1dpZHRoc1tnbHlwaF07CgogICAgICBpZiAoIWdseXBoV2lkdGgpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKCFmaXJzdFdpZHRoKSB7CiAgICAgICAgZmlyc3RXaWR0aCA9IGdseXBoV2lkdGg7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChmaXJzdFdpZHRoICE9PSBnbHlwaFdpZHRoKSB7CiAgICAgICAgaXNNb25vc3BhY2UgPSBmYWxzZTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGlmIChpc01vbm9zcGFjZSkgewogICAgICBwcm9wZXJ0aWVzLmZsYWdzIHw9IF9mb250c191dGlscy5Gb250RmxhZ3MuRml4ZWRQaXRjaDsKICAgIH0KCiAgICBwcm9wZXJ0aWVzLmRlZmF1bHRXaWR0aCA9IGRlZmF1bHRXaWR0aDsKICAgIHByb3BlcnRpZXMud2lkdGhzID0gZ2x5cGhzV2lkdGhzOwogICAgcHJvcGVydGllcy5kZWZhdWx0Vk1ldHJpY3MgPSBkZWZhdWx0Vk1ldHJpY3M7CiAgICBwcm9wZXJ0aWVzLnZtZXRyaWNzID0gZ2x5cGhzVk1ldHJpY3M7CiAgfQoKICBpc1NlcmlmRm9udChiYXNlRm9udE5hbWUpIHsKICAgIGNvbnN0IGZvbnROYW1lV29TdHlsZSA9IGJhc2VGb250TmFtZS5zcGxpdCgiLSIpWzBdOwogICAgcmV0dXJuIGZvbnROYW1lV29TdHlsZSBpbiAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldFNlcmlmRm9udHMpKCkgfHwgZm9udE5hbWVXb1N0eWxlLnNlYXJjaCgvc2VyaWYvZ2kpICE9PSAtMTsKICB9CgogIGdldEJhc2VGb250TWV0cmljcyhuYW1lKSB7CiAgICBsZXQgZGVmYXVsdFdpZHRoID0gMDsKICAgIGxldCB3aWR0aHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgbGV0IG1vbm9zcGFjZSA9IGZhbHNlOwogICAgY29uc3Qgc3RkRm9udE1hcCA9ICgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0U3RkRm9udE1hcCkoKTsKICAgIGxldCBsb29rdXBOYW1lID0gc3RkRm9udE1hcFtuYW1lXSB8fCBuYW1lOwogICAgY29uc3QgTWV0cmljcyA9ICgwLCBfbWV0cmljcy5nZXRNZXRyaWNzKSgpOwoKICAgIGlmICghKGxvb2t1cE5hbWUgaW4gTWV0cmljcykpIHsKICAgICAgaWYgKHRoaXMuaXNTZXJpZkZvbnQobmFtZSkpIHsKICAgICAgICBsb29rdXBOYW1lID0gIlRpbWVzLVJvbWFuIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBsb29rdXBOYW1lID0gIkhlbHZldGljYSI7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBnbHlwaFdpZHRocyA9IE1ldHJpY3NbbG9va3VwTmFtZV07CgogICAgaWYgKHR5cGVvZiBnbHlwaFdpZHRocyA9PT0gIm51bWJlciIpIHsKICAgICAgZGVmYXVsdFdpZHRoID0gZ2x5cGhXaWR0aHM7CiAgICAgIG1vbm9zcGFjZSA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICB3aWR0aHMgPSBnbHlwaFdpZHRocygpOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGRlZmF1bHRXaWR0aCwKICAgICAgbW9ub3NwYWNlLAogICAgICB3aWR0aHMKICAgIH07CiAgfQoKICBidWlsZENoYXJDb2RlVG9XaWR0aCh3aWR0aHNCeUdseXBoTmFtZSwgcHJvcGVydGllcykgewogICAgY29uc3Qgd2lkdGhzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIGNvbnN0IGRpZmZlcmVuY2VzID0gcHJvcGVydGllcy5kaWZmZXJlbmNlczsKICAgIGNvbnN0IGVuY29kaW5nID0gcHJvcGVydGllcy5kZWZhdWx0RW5jb2Rpbmc7CgogICAgZm9yIChsZXQgY2hhckNvZGUgPSAwOyBjaGFyQ29kZSA8IDI1NjsgY2hhckNvZGUrKykgewogICAgICBpZiAoY2hhckNvZGUgaW4gZGlmZmVyZW5jZXMgJiYgd2lkdGhzQnlHbHlwaE5hbWVbZGlmZmVyZW5jZXNbY2hhckNvZGVdXSkgewogICAgICAgIHdpZHRoc1tjaGFyQ29kZV0gPSB3aWR0aHNCeUdseXBoTmFtZVtkaWZmZXJlbmNlc1tjaGFyQ29kZV1dOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAoY2hhckNvZGUgaW4gZW5jb2RpbmcgJiYgd2lkdGhzQnlHbHlwaE5hbWVbZW5jb2RpbmdbY2hhckNvZGVdXSkgewogICAgICAgIHdpZHRoc1tjaGFyQ29kZV0gPSB3aWR0aHNCeUdseXBoTmFtZVtlbmNvZGluZ1tjaGFyQ29kZV1dOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHdpZHRoczsKICB9CgogIHByZUV2YWx1YXRlRm9udChkaWN0KSB7CiAgICBjb25zdCBiYXNlRGljdCA9IGRpY3Q7CiAgICBsZXQgdHlwZSA9IGRpY3QuZ2V0KCJTdWJ0eXBlIik7CgogICAgaWYgKCEodHlwZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiaW52YWxpZCBmb250IFN1YnR5cGUiKTsKICAgIH0KCiAgICBsZXQgY29tcG9zaXRlID0gZmFsc2U7CiAgICBsZXQgaGFzaCwgdG9Vbmljb2RlOwoKICAgIGlmICh0eXBlLm5hbWUgPT09ICJUeXBlMCIpIHsKICAgICAgY29uc3QgZGYgPSBkaWN0LmdldCgiRGVzY2VuZGFudEZvbnRzIik7CgogICAgICBpZiAoIWRmKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJEZXNjZW5kYW50IGZvbnRzIGFyZSBub3Qgc3BlY2lmaWVkIik7CiAgICAgIH0KCiAgICAgIGRpY3QgPSBBcnJheS5pc0FycmF5KGRmKSA/IHRoaXMueHJlZi5mZXRjaElmUmVmKGRmWzBdKSA6IGRmOwoKICAgICAgaWYgKCEoZGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJEZXNjZW5kYW50IGZvbnQgaXMgbm90IGEgZGljdGlvbmFyeS4iKTsKICAgICAgfQoKICAgICAgdHlwZSA9IGRpY3QuZ2V0KCJTdWJ0eXBlIik7CgogICAgICBpZiAoISh0eXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoImludmFsaWQgZm9udCBTdWJ0eXBlIik7CiAgICAgIH0KCiAgICAgIGNvbXBvc2l0ZSA9IHRydWU7CiAgICB9CgogICAgY29uc3QgZmlyc3RDaGFyID0gZGljdC5nZXQoIkZpcnN0Q2hhciIpIHx8IDAsCiAgICAgICAgICBsYXN0Q2hhciA9IGRpY3QuZ2V0KCJMYXN0Q2hhciIpIHx8IChjb21wb3NpdGUgPyAweGZmZmYgOiAweGZmKTsKICAgIGNvbnN0IGRlc2NyaXB0b3IgPSBkaWN0LmdldCgiRm9udERlc2NyaXB0b3IiKTsKCiAgICBpZiAoZGVzY3JpcHRvcikgewogICAgICBoYXNoID0gbmV3IF9tdXJtdXJoYXNoLk11cm11ckhhc2gzXzY0KCk7CiAgICAgIGNvbnN0IGVuY29kaW5nID0gYmFzZURpY3QuZ2V0UmF3KCJFbmNvZGluZyIpOwoKICAgICAgaWYgKGVuY29kaW5nIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgIGhhc2gudXBkYXRlKGVuY29kaW5nLm5hbWUpOwogICAgICB9IGVsc2UgaWYgKGVuY29kaW5nIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgaGFzaC51cGRhdGUoZW5jb2RpbmcudG9TdHJpbmcoKSk7CiAgICAgIH0gZWxzZSBpZiAoZW5jb2RpbmcgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBlbmNvZGluZy5nZXRSYXdWYWx1ZXMoKSkgewogICAgICAgICAgaWYgKGVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICBoYXNoLnVwZGF0ZShlbnRyeS5uYW1lKTsKICAgICAgICAgIH0gZWxzZSBpZiAoZW50cnkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgICAgaGFzaC51cGRhdGUoZW50cnkudG9TdHJpbmcoKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoZW50cnkpKSB7CiAgICAgICAgICAgIGNvbnN0IGRpZmZMZW5ndGggPSBlbnRyeS5sZW5ndGgsCiAgICAgICAgICAgICAgICAgIGRpZmZCdWYgPSBuZXcgQXJyYXkoZGlmZkxlbmd0aCk7CgogICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGRpZmZMZW5ndGg7IGorKykgewogICAgICAgICAgICAgIGNvbnN0IGRpZmZFbnRyeSA9IGVudHJ5W2pdOwoKICAgICAgICAgICAgICBpZiAoZGlmZkVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICAgICAgZGlmZkJ1ZltqXSA9IGRpZmZFbnRyeS5uYW1lOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGRpZmZFbnRyeSA9PT0gIm51bWJlciIgfHwgZGlmZkVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICAgICAgICBkaWZmQnVmW2pdID0gZGlmZkVudHJ5LnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBoYXNoLnVwZGF0ZShkaWZmQnVmLmpvaW4oKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBoYXNoLnVwZGF0ZShgJHtmaXJzdENoYXJ9LSR7bGFzdENoYXJ9YCk7CiAgICAgIHRvVW5pY29kZSA9IGRpY3QuZ2V0KCJUb1VuaWNvZGUiKSB8fCBiYXNlRGljdC5nZXQoIlRvVW5pY29kZSIpOwoKICAgICAgaWYgKHRvVW5pY29kZSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgICAgY29uc3Qgc3RyZWFtID0gdG9Vbmljb2RlLnN0ciB8fCB0b1VuaWNvZGU7CiAgICAgICAgY29uc3QgdWludDhhcnJheSA9IHN0cmVhbS5idWZmZXIgPyBuZXcgVWludDhBcnJheShzdHJlYW0uYnVmZmVyLmJ1ZmZlciwgMCwgc3RyZWFtLmJ1ZmZlckxlbmd0aCkgOiBuZXcgVWludDhBcnJheShzdHJlYW0uYnl0ZXMuYnVmZmVyLCBzdHJlYW0uc3RhcnQsIHN0cmVhbS5lbmQgLSBzdHJlYW0uc3RhcnQpOwogICAgICAgIGhhc2gudXBkYXRlKHVpbnQ4YXJyYXkpOwogICAgICB9IGVsc2UgaWYgKHRvVW5pY29kZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICBoYXNoLnVwZGF0ZSh0b1VuaWNvZGUubmFtZSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHdpZHRocyA9IGRpY3QuZ2V0KCJXaWR0aHMiKSB8fCBiYXNlRGljdC5nZXQoIldpZHRocyIpOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkod2lkdGhzKSkgewogICAgICAgIGNvbnN0IHdpZHRoc0J1ZiA9IFtdOwoKICAgICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIHdpZHRocykgewogICAgICAgICAgaWYgKHR5cGVvZiBlbnRyeSA9PT0gIm51bWJlciIgfHwgZW50cnkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgICAgd2lkdGhzQnVmLnB1c2goZW50cnkudG9TdHJpbmcoKSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBoYXNoLnVwZGF0ZSh3aWR0aHNCdWYuam9pbigpKTsKICAgICAgfQoKICAgICAgaWYgKGNvbXBvc2l0ZSkgewogICAgICAgIGhhc2gudXBkYXRlKCJjb21wb3NpdGVGb250Iik7CiAgICAgICAgY29uc3QgY29tcG9zaXRlV2lkdGhzID0gZGljdC5nZXQoIlciKSB8fCBiYXNlRGljdC5nZXQoIlciKTsKCiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY29tcG9zaXRlV2lkdGhzKSkgewogICAgICAgICAgY29uc3Qgd2lkdGhzQnVmID0gW107CgogICAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBjb21wb3NpdGVXaWR0aHMpIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiBlbnRyeSA9PT0gIm51bWJlciIgfHwgZW50cnkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgICAgICB3aWR0aHNCdWYucHVzaChlbnRyeS50b1N0cmluZygpKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGVudHJ5KSkgewogICAgICAgICAgICAgIGNvbnN0IHN1YldpZHRoc0J1ZiA9IFtdOwoKICAgICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZW50cnkpIHsKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZWxlbWVudCA9PT0gIm51bWJlciIgfHwgZWxlbWVudCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICAgICAgICBzdWJXaWR0aHNCdWYucHVzaChlbGVtZW50LnRvU3RyaW5nKCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgd2lkdGhzQnVmLnB1c2goYFske3N1YldpZHRoc0J1Zi5qb2luKCl9XWApOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaGFzaC51cGRhdGUod2lkdGhzQnVmLmpvaW4oKSk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBjaWRUb0dpZE1hcCA9IGRpY3QuZ2V0UmF3KCJDSURUb0dJRE1hcCIpIHx8IGJhc2VEaWN0LmdldFJhdygiQ0lEVG9HSURNYXAiKTsKCiAgICAgICAgaWYgKGNpZFRvR2lkTWFwIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgaGFzaC51cGRhdGUoY2lkVG9HaWRNYXAubmFtZSk7CiAgICAgICAgfSBlbHNlIGlmIChjaWRUb0dpZE1hcCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgaGFzaC51cGRhdGUoY2lkVG9HaWRNYXAudG9TdHJpbmcoKSk7CiAgICAgICAgfSBlbHNlIGlmIChjaWRUb0dpZE1hcCBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgICAgICBoYXNoLnVwZGF0ZShjaWRUb0dpZE1hcC5wZWVrQnl0ZXMoKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgZGVzY3JpcHRvciwKICAgICAgZGljdCwKICAgICAgYmFzZURpY3QsCiAgICAgIGNvbXBvc2l0ZSwKICAgICAgdHlwZTogdHlwZS5uYW1lLAogICAgICBmaXJzdENoYXIsCiAgICAgIGxhc3RDaGFyLAogICAgICB0b1VuaWNvZGUsCiAgICAgIGhhc2g6IGhhc2ggPyBoYXNoLmhleGRpZ2VzdCgpIDogIiIKICAgIH07CiAgfQoKICBhc3luYyB0cmFuc2xhdGVGb250KF9yZWY5KSB7CiAgICBsZXQgewogICAgICBkZXNjcmlwdG9yLAogICAgICBkaWN0LAogICAgICBiYXNlRGljdCwKICAgICAgY29tcG9zaXRlLAogICAgICB0eXBlLAogICAgICBmaXJzdENoYXIsCiAgICAgIGxhc3RDaGFyLAogICAgICB0b1VuaWNvZGUsCiAgICAgIGNzc0ZvbnRJbmZvCiAgICB9ID0gX3JlZjk7CiAgICBjb25zdCBpc1R5cGUzRm9udCA9IHR5cGUgPT09ICJUeXBlMyI7CiAgICBsZXQgcHJvcGVydGllczsKCiAgICBpZiAoIWRlc2NyaXB0b3IpIHsKICAgICAgaWYgKGlzVHlwZTNGb250KSB7CiAgICAgICAgZGVzY3JpcHRvciA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KG51bGwpOwogICAgICAgIGRlc2NyaXB0b3Iuc2V0KCJGb250TmFtZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KHR5cGUpKTsKICAgICAgICBkZXNjcmlwdG9yLnNldCgiRm9udEJCb3giLCBkaWN0LmdldEFycmF5KCJGb250QkJveCIpIHx8IFswLCAwLCAwLCAwXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGV0IGJhc2VGb250TmFtZSA9IGRpY3QuZ2V0KCJCYXNlRm9udCIpOwoKICAgICAgICBpZiAoIShiYXNlRm9udE5hbWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYXNlIGZvbnQgaXMgbm90IHNwZWNpZmllZCIpOwogICAgICAgIH0KCiAgICAgICAgYmFzZUZvbnROYW1lID0gYmFzZUZvbnROYW1lLm5hbWUucmVwbGFjZSgvWyxfXS9nLCAiLSIpOwogICAgICAgIGNvbnN0IG1ldHJpY3MgPSB0aGlzLmdldEJhc2VGb250TWV0cmljcyhiYXNlRm9udE5hbWUpOwogICAgICAgIGNvbnN0IGZvbnROYW1lV29TdHlsZSA9IGJhc2VGb250TmFtZS5zcGxpdCgiLSIpWzBdOwogICAgICAgIGNvbnN0IGZsYWdzID0gKHRoaXMuaXNTZXJpZkZvbnQoZm9udE5hbWVXb1N0eWxlKSA/IF9mb250c191dGlscy5Gb250RmxhZ3MuU2VyaWYgOiAwKSB8IChtZXRyaWNzLm1vbm9zcGFjZSA/IF9mb250c191dGlscy5Gb250RmxhZ3MuRml4ZWRQaXRjaCA6IDApIHwgKCgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0U3ltYm9sc0ZvbnRzKSgpW2ZvbnROYW1lV29TdHlsZV0gPyBfZm9udHNfdXRpbHMuRm9udEZsYWdzLlN5bWJvbGljIDogX2ZvbnRzX3V0aWxzLkZvbnRGbGFncy5Ob25zeW1ib2xpYyk7CiAgICAgICAgcHJvcGVydGllcyA9IHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBuYW1lOiBiYXNlRm9udE5hbWUsCiAgICAgICAgICBsb2FkZWROYW1lOiBiYXNlRGljdC5sb2FkZWROYW1lLAogICAgICAgICAgd2lkdGhzOiBtZXRyaWNzLndpZHRocywKICAgICAgICAgIGRlZmF1bHRXaWR0aDogbWV0cmljcy5kZWZhdWx0V2lkdGgsCiAgICAgICAgICBpc1NpbXVsYXRlZEZsYWdzOiB0cnVlLAogICAgICAgICAgZmxhZ3MsCiAgICAgICAgICBmaXJzdENoYXIsCiAgICAgICAgICBsYXN0Q2hhciwKICAgICAgICAgIHRvVW5pY29kZSwKICAgICAgICAgIHhIZWlnaHQ6IDAsCiAgICAgICAgICBjYXBIZWlnaHQ6IDAsCiAgICAgICAgICBpdGFsaWNBbmdsZTogMCwKICAgICAgICAgIGlzVHlwZTNGb250CiAgICAgICAgfTsKICAgICAgICBjb25zdCB3aWR0aHMgPSBkaWN0LmdldCgiV2lkdGhzIik7CiAgICAgICAgY29uc3Qgc3RhbmRhcmRGb250TmFtZSA9ICgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0U3RhbmRhcmRGb250TmFtZSkoYmFzZUZvbnROYW1lKTsKICAgICAgICBsZXQgZmlsZSA9IG51bGw7CgogICAgICAgIGlmIChzdGFuZGFyZEZvbnROYW1lKSB7CiAgICAgICAgICBwcm9wZXJ0aWVzLmlzU3RhbmRhcmRGb250ID0gdHJ1ZTsKICAgICAgICAgIGZpbGUgPSBhd2FpdCB0aGlzLmZldGNoU3RhbmRhcmRGb250RGF0YShzdGFuZGFyZEZvbnROYW1lKTsKICAgICAgICAgIHByb3BlcnRpZXMuaXNJbnRlcm5hbEZvbnQgPSAhIWZpbGU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpcy5leHRyYWN0RGF0YVN0cnVjdHVyZXMoZGljdCwgZGljdCwgcHJvcGVydGllcykudGhlbihuZXdQcm9wZXJ0aWVzID0+IHsKICAgICAgICAgIGlmICh3aWR0aHMpIHsKICAgICAgICAgICAgY29uc3QgZ2x5cGhXaWR0aHMgPSBbXTsKICAgICAgICAgICAgbGV0IGogPSBmaXJzdENoYXI7CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB3aWR0aHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgICAgIGdseXBoV2lkdGhzW2orK10gPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZih3aWR0aHNbaV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXdQcm9wZXJ0aWVzLndpZHRocyA9IGdseXBoV2lkdGhzOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3UHJvcGVydGllcy53aWR0aHMgPSB0aGlzLmJ1aWxkQ2hhckNvZGVUb1dpZHRoKG1ldHJpY3Mud2lkdGhzLCBuZXdQcm9wZXJ0aWVzKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbmV3IF9mb250cy5Gb250KGJhc2VGb250TmFtZSwgZmlsZSwgbmV3UHJvcGVydGllcyk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICBsZXQgZm9udE5hbWUgPSBkZXNjcmlwdG9yLmdldCgiRm9udE5hbWUiKTsKICAgIGxldCBiYXNlRm9udCA9IGRpY3QuZ2V0KCJCYXNlRm9udCIpOwoKICAgIGlmICh0eXBlb2YgZm9udE5hbWUgPT09ICJzdHJpbmciKSB7CiAgICAgIGZvbnROYW1lID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQoZm9udE5hbWUpOwogICAgfQoKICAgIGlmICh0eXBlb2YgYmFzZUZvbnQgPT09ICJzdHJpbmciKSB7CiAgICAgIGJhc2VGb250ID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQoYmFzZUZvbnQpOwogICAgfQoKICAgIGlmICghaXNUeXBlM0ZvbnQpIHsKICAgICAgY29uc3QgZm9udE5hbWVTdHIgPSBmb250TmFtZSAmJiBmb250TmFtZS5uYW1lOwogICAgICBjb25zdCBiYXNlRm9udFN0ciA9IGJhc2VGb250ICYmIGJhc2VGb250Lm5hbWU7CgogICAgICBpZiAoZm9udE5hbWVTdHIgIT09IGJhc2VGb250U3RyKSB7CiAgICAgICAgKDAsIF91dGlsLmluZm8pKGBUaGUgRm9udERlc2NyaXB0b3IncyBGb250TmFtZSBpcyAiJHtmb250TmFtZVN0cn0iIGJ1dCBgICsgYHNob3VsZCBiZSB0aGUgc2FtZSBhcyB0aGUgRm9udCdzIEJhc2VGb250ICIke2Jhc2VGb250U3RyfSIuYCk7CgogICAgICAgIGlmIChmb250TmFtZVN0ciAmJiBiYXNlRm9udFN0ciAmJiBiYXNlRm9udFN0ci5zdGFydHNXaXRoKGZvbnROYW1lU3RyKSkgewogICAgICAgICAgZm9udE5hbWUgPSBiYXNlRm9udDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmb250TmFtZSA9IGZvbnROYW1lIHx8IGJhc2VGb250OwoKICAgIGlmICghKGZvbnROYW1lIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJpbnZhbGlkIGZvbnQgbmFtZSIpOwogICAgfQoKICAgIGxldCBmb250RmlsZSwgc3VidHlwZSwgbGVuZ3RoMSwgbGVuZ3RoMiwgbGVuZ3RoMzsKCiAgICB0cnkgewogICAgICBmb250RmlsZSA9IGRlc2NyaXB0b3IuZ2V0KCJGb250RmlsZSIsICJGb250RmlsZTIiLCAiRm9udEZpbGUzIik7CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoIXRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGB0cmFuc2xhdGVGb250IC0gZmV0Y2hpbmcgIiR7Zm9udE5hbWUubmFtZX0iIGZvbnQgZmlsZTogIiR7ZXh9Ii5gKTsKICAgICAgZm9udEZpbGUgPSBuZXcgX3N0cmVhbS5OdWxsU3RyZWFtKCk7CiAgICB9CgogICAgbGV0IGlzU3RhbmRhcmRGb250ID0gZmFsc2U7CiAgICBsZXQgaXNJbnRlcm5hbEZvbnQgPSBmYWxzZTsKICAgIGxldCBnbHlwaFNjYWxlRmFjdG9ycyA9IG51bGw7CgogICAgaWYgKGZvbnRGaWxlKSB7CiAgICAgIGlmIChmb250RmlsZS5kaWN0KSB7CiAgICAgICAgY29uc3Qgc3VidHlwZUVudHJ5ID0gZm9udEZpbGUuZGljdC5nZXQoIlN1YnR5cGUiKTsKCiAgICAgICAgaWYgKHN1YnR5cGVFbnRyeSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgIHN1YnR5cGUgPSBzdWJ0eXBlRW50cnkubmFtZTsKICAgICAgICB9CgogICAgICAgIGxlbmd0aDEgPSBmb250RmlsZS5kaWN0LmdldCgiTGVuZ3RoMSIpOwogICAgICAgIGxlbmd0aDIgPSBmb250RmlsZS5kaWN0LmdldCgiTGVuZ3RoMiIpOwogICAgICAgIGxlbmd0aDMgPSBmb250RmlsZS5kaWN0LmdldCgiTGVuZ3RoMyIpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGNzc0ZvbnRJbmZvKSB7CiAgICAgIGNvbnN0IHN0YW5kYXJkRm9udE5hbWUgPSAoMCwgX3hmYV9mb250cy5nZXRYZmFGb250TmFtZSkoZm9udE5hbWUubmFtZSk7CgogICAgICBpZiAoc3RhbmRhcmRGb250TmFtZSkgewogICAgICAgIGNzc0ZvbnRJbmZvLmZvbnRGYW1pbHkgPSBgJHtjc3NGb250SW5mby5mb250RmFtaWx5fS1QZGZKUy1YRkFgOwogICAgICAgIGNzc0ZvbnRJbmZvLm1ldHJpY3MgPSBzdGFuZGFyZEZvbnROYW1lLm1ldHJpY3MgfHwgbnVsbDsKICAgICAgICBnbHlwaFNjYWxlRmFjdG9ycyA9IHN0YW5kYXJkRm9udE5hbWUuZmFjdG9ycyB8fCBudWxsOwogICAgICAgIGZvbnRGaWxlID0gYXdhaXQgdGhpcy5mZXRjaFN0YW5kYXJkRm9udERhdGEoc3RhbmRhcmRGb250TmFtZS5uYW1lKTsKICAgICAgICBpc0ludGVybmFsRm9udCA9ICEhZm9udEZpbGU7CiAgICAgICAgYmFzZURpY3QgPSBkaWN0ID0gKDAsIF94ZmFfZm9udHMuZ2V0WGZhRm9udERpY3QpKGZvbnROYW1lLm5hbWUpOwogICAgICAgIGNvbXBvc2l0ZSA9IHRydWU7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoIWlzVHlwZTNGb250KSB7CiAgICAgIGNvbnN0IHN0YW5kYXJkRm9udE5hbWUgPSAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldFN0YW5kYXJkRm9udE5hbWUpKGZvbnROYW1lLm5hbWUpOwoKICAgICAgaWYgKHN0YW5kYXJkRm9udE5hbWUpIHsKICAgICAgICBpc1N0YW5kYXJkRm9udCA9IHRydWU7CiAgICAgICAgZm9udEZpbGUgPSBhd2FpdCB0aGlzLmZldGNoU3RhbmRhcmRGb250RGF0YShzdGFuZGFyZEZvbnROYW1lKTsKICAgICAgICBpc0ludGVybmFsRm9udCA9ICEhZm9udEZpbGU7CiAgICAgIH0KICAgIH0KCiAgICBwcm9wZXJ0aWVzID0gewogICAgICB0eXBlLAogICAgICBuYW1lOiBmb250TmFtZS5uYW1lLAogICAgICBzdWJ0eXBlLAogICAgICBmaWxlOiBmb250RmlsZSwKICAgICAgbGVuZ3RoMSwKICAgICAgbGVuZ3RoMiwKICAgICAgbGVuZ3RoMywKICAgICAgaXNTdGFuZGFyZEZvbnQsCiAgICAgIGlzSW50ZXJuYWxGb250LAogICAgICBsb2FkZWROYW1lOiBiYXNlRGljdC5sb2FkZWROYW1lLAogICAgICBjb21wb3NpdGUsCiAgICAgIGZpeGVkUGl0Y2g6IGZhbHNlLAogICAgICBmb250TWF0cml4OiBkaWN0LmdldEFycmF5KCJGb250TWF0cml4IikgfHwgX3V0aWwuRk9OVF9JREVOVElUWV9NQVRSSVgsCiAgICAgIGZpcnN0Q2hhciwKICAgICAgbGFzdENoYXIsCiAgICAgIHRvVW5pY29kZSwKICAgICAgYmJveDogZGVzY3JpcHRvci5nZXRBcnJheSgiRm9udEJCb3giKSB8fCBkaWN0LmdldEFycmF5KCJGb250QkJveCIpLAogICAgICBhc2NlbnQ6IGRlc2NyaXB0b3IuZ2V0KCJBc2NlbnQiKSwKICAgICAgZGVzY2VudDogZGVzY3JpcHRvci5nZXQoIkRlc2NlbnQiKSwKICAgICAgeEhlaWdodDogZGVzY3JpcHRvci5nZXQoIlhIZWlnaHQiKSB8fCAwLAogICAgICBjYXBIZWlnaHQ6IGRlc2NyaXB0b3IuZ2V0KCJDYXBIZWlnaHQiKSB8fCAwLAogICAgICBmbGFnczogZGVzY3JpcHRvci5nZXQoIkZsYWdzIiksCiAgICAgIGl0YWxpY0FuZ2xlOiBkZXNjcmlwdG9yLmdldCgiSXRhbGljQW5nbGUiKSB8fCAwLAogICAgICBpc1R5cGUzRm9udCwKICAgICAgY3NzRm9udEluZm8sCiAgICAgIHNjYWxlRmFjdG9yczogZ2x5cGhTY2FsZUZhY3RvcnMKICAgIH07CgogICAgaWYgKGNvbXBvc2l0ZSkgewogICAgICBjb25zdCBjaWRFbmNvZGluZyA9IGJhc2VEaWN0LmdldCgiRW5jb2RpbmciKTsKCiAgICAgIGlmIChjaWRFbmNvZGluZyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICBwcm9wZXJ0aWVzLmNpZEVuY29kaW5nID0gY2lkRW5jb2RpbmcubmFtZTsKICAgICAgfQoKICAgICAgY29uc3QgY01hcCA9IGF3YWl0IF9jbWFwLkNNYXBGYWN0b3J5LmNyZWF0ZSh7CiAgICAgICAgZW5jb2Rpbmc6IGNpZEVuY29kaW5nLAogICAgICAgIGZldGNoQnVpbHRJbkNNYXA6IHRoaXMuX2ZldGNoQnVpbHRJbkNNYXBCb3VuZCwKICAgICAgICB1c2VDTWFwOiBudWxsCiAgICAgIH0pOwogICAgICBwcm9wZXJ0aWVzLmNNYXAgPSBjTWFwOwogICAgICBwcm9wZXJ0aWVzLnZlcnRpY2FsID0gcHJvcGVydGllcy5jTWFwLnZlcnRpY2FsOwogICAgfQoKICAgIHJldHVybiB0aGlzLmV4dHJhY3REYXRhU3RydWN0dXJlcyhkaWN0LCBiYXNlRGljdCwgcHJvcGVydGllcykudGhlbihuZXdQcm9wZXJ0aWVzID0+IHsKICAgICAgdGhpcy5leHRyYWN0V2lkdGhzKGRpY3QsIGRlc2NyaXB0b3IsIG5ld1Byb3BlcnRpZXMpOwogICAgICByZXR1cm4gbmV3IF9mb250cy5Gb250KGZvbnROYW1lLm5hbWUsIGZvbnRGaWxlLCBuZXdQcm9wZXJ0aWVzKTsKICAgIH0pOwogIH0KCiAgc3RhdGljIGJ1aWxkRm9udFBhdGhzKGZvbnQsIGdseXBocywgaGFuZGxlciwgZXZhbHVhdG9yT3B0aW9ucykgewogICAgZnVuY3Rpb24gYnVpbGRQYXRoKGZvbnRDaGFyKSB7CiAgICAgIGNvbnN0IGdseXBoTmFtZSA9IGAke2ZvbnQubG9hZGVkTmFtZX1fcGF0aF8ke2ZvbnRDaGFyfWA7CgogICAgICB0cnkgewogICAgICAgIGlmIChmb250LnJlbmRlcmVyLmhhc0J1aWx0UGF0aChmb250Q2hhcikpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGhhbmRsZXIuc2VuZCgiY29tbW9ub2JqIiwgW2dseXBoTmFtZSwgIkZvbnRQYXRoIiwgZm9udC5yZW5kZXJlci5nZXRQYXRoSnMoZm9udENoYXIpXSk7CiAgICAgIH0gY2F0Y2ggKHJlYXNvbikgewogICAgICAgIGlmIChldmFsdWF0b3JPcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICAgaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JGb250QnVpbGRQYXRoCiAgICAgICAgICB9KTsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgYnVpbGRGb250UGF0aHMgLSBpZ25vcmluZyAke2dseXBoTmFtZX0gZ2x5cGg6ICIke3JlYXNvbn0iLmApOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgcmVhc29uOwogICAgICB9CiAgICB9CgogICAgZm9yIChjb25zdCBnbHlwaCBvZiBnbHlwaHMpIHsKICAgICAgYnVpbGRQYXRoKGdseXBoLmZvbnRDaGFyKTsKICAgICAgY29uc3QgYWNjZW50ID0gZ2x5cGguYWNjZW50OwoKICAgICAgaWYgKGFjY2VudCAmJiBhY2NlbnQuZm9udENoYXIpIHsKICAgICAgICBidWlsZFBhdGgoYWNjZW50LmZvbnRDaGFyKTsKICAgICAgfQogICAgfQogIH0KCiAgc3RhdGljIGdldCBmYWxsYmFja0ZvbnREaWN0KCkgewogICAgY29uc3QgZGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KCk7CiAgICBkaWN0LnNldCgiQmFzZUZvbnQiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiUERGSlMtRmFsbGJhY2tGb250IikpOwogICAgZGljdC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRmFsbGJhY2tUeXBlIikpOwogICAgZGljdC5zZXQoIlN1YnR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRmFsbGJhY2tUeXBlIikpOwogICAgZGljdC5zZXQoIkVuY29kaW5nIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIldpbkFuc2lFbmNvZGluZyIpKTsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZmFsbGJhY2tGb250RGljdCIsIGRpY3QpOwogIH0KCn0KCmV4cG9ydHMuUGFydGlhbEV2YWx1YXRvciA9IFBhcnRpYWxFdmFsdWF0b3I7CgpjbGFzcyBUcmFuc2xhdGVkRm9udCB7CiAgY29uc3RydWN0b3IoX3JlZjEwKSB7CiAgICBsZXQgewogICAgICBsb2FkZWROYW1lLAogICAgICBmb250LAogICAgICBkaWN0LAogICAgICBldmFsdWF0b3JPcHRpb25zCiAgICB9ID0gX3JlZjEwOwogICAgdGhpcy5sb2FkZWROYW1lID0gbG9hZGVkTmFtZTsKICAgIHRoaXMuZm9udCA9IGZvbnQ7CiAgICB0aGlzLmRpY3QgPSBkaWN0OwogICAgdGhpcy5fZXZhbHVhdG9yT3B0aW9ucyA9IGV2YWx1YXRvck9wdGlvbnMgfHwgRGVmYXVsdFBhcnRpYWxFdmFsdWF0b3JPcHRpb25zOwogICAgdGhpcy50eXBlM0xvYWRlZCA9IG51bGw7CiAgICB0aGlzLnR5cGUzRGVwZW5kZW5jaWVzID0gZm9udC5pc1R5cGUzRm9udCA/IG5ldyBTZXQoKSA6IG51bGw7CiAgICB0aGlzLnNlbnQgPSBmYWxzZTsKICB9CgogIHNlbmQoaGFuZGxlcikgewogICAgaWYgKHRoaXMuc2VudCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5zZW50ID0gdHJ1ZTsKICAgIGhhbmRsZXIuc2VuZCgiY29tbW9ub2JqIiwgW3RoaXMubG9hZGVkTmFtZSwgIkZvbnQiLCB0aGlzLmZvbnQuZXhwb3J0RGF0YSh0aGlzLl9ldmFsdWF0b3JPcHRpb25zLmZvbnRFeHRyYVByb3BlcnRpZXMpXSk7CiAgfQoKICBmYWxsYmFjayhoYW5kbGVyKSB7CiAgICBpZiAoIXRoaXMuZm9udC5kYXRhKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLmZvbnQuZGlzYWJsZUZvbnRGYWNlID0gdHJ1ZTsKICAgIFBhcnRpYWxFdmFsdWF0b3IuYnVpbGRGb250UGF0aHModGhpcy5mb250LCB0aGlzLmZvbnQuZ2x5cGhDYWNoZVZhbHVlcywgaGFuZGxlciwgdGhpcy5fZXZhbHVhdG9yT3B0aW9ucyk7CiAgfQoKICBsb2FkVHlwZTNEYXRhKGV2YWx1YXRvciwgcmVzb3VyY2VzLCB0YXNrKSB7CiAgICBpZiAodGhpcy50eXBlM0xvYWRlZCkgewogICAgICByZXR1cm4gdGhpcy50eXBlM0xvYWRlZDsKICAgIH0KCiAgICBpZiAoIXRoaXMuZm9udC5pc1R5cGUzRm9udCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIk11c3QgYmUgYSBUeXBlMyBmb250LiIpOwogICAgfQoKICAgIGNvbnN0IHR5cGUzRXZhbHVhdG9yID0gZXZhbHVhdG9yLmNsb25lKHsKICAgICAgaWdub3JlRXJyb3JzOiBmYWxzZQogICAgfSk7CiAgICB0eXBlM0V2YWx1YXRvci5wYXJzaW5nVHlwZTNGb250ID0gdHJ1ZTsKICAgIGNvbnN0IHR5cGUzRm9udFJlZnMgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KGV2YWx1YXRvci50eXBlM0ZvbnRSZWZzKTsKCiAgICBpZiAodGhpcy5kaWN0Lm9iaklkICYmICF0eXBlM0ZvbnRSZWZzLmhhcyh0aGlzLmRpY3Qub2JqSWQpKSB7CiAgICAgIHR5cGUzRm9udFJlZnMucHV0KHRoaXMuZGljdC5vYmpJZCk7CiAgICB9CgogICAgdHlwZTNFdmFsdWF0b3IudHlwZTNGb250UmVmcyA9IHR5cGUzRm9udFJlZnM7CiAgICBjb25zdCB0cmFuc2xhdGVkRm9udCA9IHRoaXMuZm9udCwKICAgICAgICAgIHR5cGUzRGVwZW5kZW5jaWVzID0gdGhpcy50eXBlM0RlcGVuZGVuY2llczsKICAgIGxldCBsb2FkQ2hhclByb2NzUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOwogICAgY29uc3QgY2hhclByb2NzID0gdGhpcy5kaWN0LmdldCgiQ2hhclByb2NzIik7CiAgICBjb25zdCBmb250UmVzb3VyY2VzID0gdGhpcy5kaWN0LmdldCgiUmVzb3VyY2VzIikgfHwgcmVzb3VyY2VzOwogICAgY29uc3QgY2hhclByb2NPcGVyYXRvckxpc3QgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGNvbnN0IGZvbnRCQm94ID0gX3V0aWwuVXRpbC5ub3JtYWxpemVSZWN0KHRyYW5zbGF0ZWRGb250LmJib3ggfHwgWzAsIDAsIDAsIDBdKSwKICAgICAgICAgIHdpZHRoID0gZm9udEJCb3hbMl0gLSBmb250QkJveFswXSwKICAgICAgICAgIGhlaWdodCA9IGZvbnRCQm94WzNdIC0gZm9udEJCb3hbMV07CgogICAgY29uc3QgZm9udEJCb3hTaXplID0gTWF0aC5oeXBvdCh3aWR0aCwgaGVpZ2h0KTsKCiAgICBmb3IgKGNvbnN0IGtleSBvZiBjaGFyUHJvY3MuZ2V0S2V5cygpKSB7CiAgICAgIGxvYWRDaGFyUHJvY3NQcm9taXNlID0gbG9hZENoYXJQcm9jc1Byb21pc2UudGhlbigoKSA9PiB7CiAgICAgICAgY29uc3QgZ2x5cGhTdHJlYW0gPSBjaGFyUHJvY3MuZ2V0KGtleSk7CiAgICAgICAgY29uc3Qgb3BlcmF0b3JMaXN0ID0gbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpOwogICAgICAgIHJldHVybiB0eXBlM0V2YWx1YXRvci5nZXRPcGVyYXRvckxpc3QoewogICAgICAgICAgc3RyZWFtOiBnbHlwaFN0cmVhbSwKICAgICAgICAgIHRhc2ssCiAgICAgICAgICByZXNvdXJjZXM6IGZvbnRSZXNvdXJjZXMsCiAgICAgICAgICBvcGVyYXRvckxpc3QKICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgIGlmIChvcGVyYXRvckxpc3QuZm5BcnJheVswXSA9PT0gX3V0aWwuT1BTLnNldENoYXJXaWR0aEFuZEJvdW5kcykgewogICAgICAgICAgICB0aGlzLl9yZW1vdmVUeXBlM0NvbG9yT3BlcmF0b3JzKG9wZXJhdG9yTGlzdCwgZm9udEJCb3hTaXplKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjaGFyUHJvY09wZXJhdG9yTGlzdFtrZXldID0gb3BlcmF0b3JMaXN0LmdldElSKCk7CgogICAgICAgICAgZm9yIChjb25zdCBkZXBlbmRlbmN5IG9mIG9wZXJhdG9yTGlzdC5kZXBlbmRlbmNpZXMpIHsKICAgICAgICAgICAgdHlwZTNEZXBlbmRlbmNpZXMuYWRkKGRlcGVuZGVuY3kpOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgVHlwZTMgZm9udCByZXNvdXJjZSAiJHtrZXl9IiBpcyBub3QgYXZhaWxhYmxlLmApOwogICAgICAgICAgY29uc3QgZHVtbXlPcGVyYXRvckxpc3QgPSBuZXcgX29wZXJhdG9yX2xpc3QuT3BlcmF0b3JMaXN0KCk7CiAgICAgICAgICBjaGFyUHJvY09wZXJhdG9yTGlzdFtrZXldID0gZHVtbXlPcGVyYXRvckxpc3QuZ2V0SVIoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgdGhpcy50eXBlM0xvYWRlZCA9IGxvYWRDaGFyUHJvY3NQcm9taXNlLnRoZW4oKCkgPT4gewogICAgICB0cmFuc2xhdGVkRm9udC5jaGFyUHJvY09wZXJhdG9yTGlzdCA9IGNoYXJQcm9jT3BlcmF0b3JMaXN0OwoKICAgICAgaWYgKHRoaXMuX2Jib3gpIHsKICAgICAgICB0cmFuc2xhdGVkRm9udC5pc0NoYXJCQm94ID0gdHJ1ZTsKICAgICAgICB0cmFuc2xhdGVkRm9udC5iYm94ID0gdGhpcy5fYmJveDsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gdGhpcy50eXBlM0xvYWRlZDsKICB9CgogIF9yZW1vdmVUeXBlM0NvbG9yT3BlcmF0b3JzKG9wZXJhdG9yTGlzdCkgewogICAgbGV0IGZvbnRCQm94U2l6ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogTmFOOwoKICAgIGNvbnN0IGNoYXJCQm94ID0gX3V0aWwuVXRpbC5ub3JtYWxpemVSZWN0KG9wZXJhdG9yTGlzdC5hcmdzQXJyYXlbMF0uc2xpY2UoMikpLAogICAgICAgICAgd2lkdGggPSBjaGFyQkJveFsyXSAtIGNoYXJCQm94WzBdLAogICAgICAgICAgaGVpZ2h0ID0gY2hhckJCb3hbM10gLSBjaGFyQkJveFsxXTsKCiAgICBjb25zdCBjaGFyQkJveFNpemUgPSBNYXRoLmh5cG90KHdpZHRoLCBoZWlnaHQpOwoKICAgIGlmICh3aWR0aCA9PT0gMCB8fCBoZWlnaHQgPT09IDApIHsKICAgICAgb3BlcmF0b3JMaXN0LmZuQXJyYXkuc3BsaWNlKDAsIDEpOwogICAgICBvcGVyYXRvckxpc3QuYXJnc0FycmF5LnNwbGljZSgwLCAxKTsKICAgIH0gZWxzZSBpZiAoZm9udEJCb3hTaXplID09PSAwIHx8IE1hdGgucm91bmQoY2hhckJCb3hTaXplIC8gZm9udEJCb3hTaXplKSA+PSAxMCkgewogICAgICBpZiAoIXRoaXMuX2Jib3gpIHsKICAgICAgICB0aGlzLl9iYm94ID0gW0luZmluaXR5LCBJbmZpbml0eSwgLUluZmluaXR5LCAtSW5maW5pdHldOwogICAgICB9CgogICAgICB0aGlzLl9iYm94WzBdID0gTWF0aC5taW4odGhpcy5fYmJveFswXSwgY2hhckJCb3hbMF0pOwogICAgICB0aGlzLl9iYm94WzFdID0gTWF0aC5taW4odGhpcy5fYmJveFsxXSwgY2hhckJCb3hbMV0pOwogICAgICB0aGlzLl9iYm94WzJdID0gTWF0aC5tYXgodGhpcy5fYmJveFsyXSwgY2hhckJCb3hbMl0pOwogICAgICB0aGlzLl9iYm94WzNdID0gTWF0aC5tYXgodGhpcy5fYmJveFszXSwgY2hhckJCb3hbM10pOwogICAgfQoKICAgIGxldCBpID0gMCwKICAgICAgICBpaSA9IG9wZXJhdG9yTGlzdC5sZW5ndGg7CgogICAgd2hpbGUgKGkgPCBpaSkgewogICAgICBzd2l0Y2ggKG9wZXJhdG9yTGlzdC5mbkFycmF5W2ldKSB7CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0Q2hhcldpZHRoQW5kQm91bmRzOgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFN0cm9rZUNvbG9yU3BhY2U6CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENvbG9yU3BhY2U6CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3I6CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3JOOgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZpbGxDb2xvcjoKICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGaWxsQ29sb3JOOgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFN0cm9rZUdyYXk6CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbEdyYXk6CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlUkdCQ29sb3I6CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yOgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFN0cm9rZUNNWUtDb2xvcjoKICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGaWxsQ01ZS0NvbG9yOgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnNoYWRpbmdGaWxsOgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFJlbmRlcmluZ0ludGVudDoKICAgICAgICAgIG9wZXJhdG9yTGlzdC5mbkFycmF5LnNwbGljZShpLCAxKTsKICAgICAgICAgIG9wZXJhdG9yTGlzdC5hcmdzQXJyYXkuc3BsaWNlKGksIDEpOwogICAgICAgICAgaWktLTsKICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRHU3RhdGU6CiAgICAgICAgICBjb25zdCBbZ1N0YXRlT2JqXSA9IG9wZXJhdG9yTGlzdC5hcmdzQXJyYXlbaV07CiAgICAgICAgICBsZXQgaiA9IDAsCiAgICAgICAgICAgICAgamogPSBnU3RhdGVPYmoubGVuZ3RoOwoKICAgICAgICAgIHdoaWxlIChqIDwgamopIHsKICAgICAgICAgICAgY29uc3QgW2dTdGF0ZUtleV0gPSBnU3RhdGVPYmpbal07CgogICAgICAgICAgICBzd2l0Y2ggKGdTdGF0ZUtleSkgewogICAgICAgICAgICAgIGNhc2UgIlRSIjoKICAgICAgICAgICAgICBjYXNlICJUUjIiOgogICAgICAgICAgICAgIGNhc2UgIkhUIjoKICAgICAgICAgICAgICBjYXNlICJCRyI6CiAgICAgICAgICAgICAgY2FzZSAiQkcyIjoKICAgICAgICAgICAgICBjYXNlICJVQ1IiOgogICAgICAgICAgICAgIGNhc2UgIlVDUjIiOgogICAgICAgICAgICAgICAgZ1N0YXRlT2JqLnNwbGljZShqLCAxKTsKICAgICAgICAgICAgICAgIGpqLS07CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaisrOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpKys7CiAgICB9CiAgfQoKfQoKY2xhc3MgU3RhdGVNYW5hZ2VyIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIGxldCBpbml0aWFsU3RhdGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IG5ldyBFdmFsU3RhdGUoKTsKICAgIHRoaXMuc3RhdGUgPSBpbml0aWFsU3RhdGU7CiAgICB0aGlzLnN0YXRlU3RhY2sgPSBbXTsKICB9CgogIHNhdmUoKSB7CiAgICBjb25zdCBvbGQgPSB0aGlzLnN0YXRlOwogICAgdGhpcy5zdGF0ZVN0YWNrLnB1c2godGhpcy5zdGF0ZSk7CiAgICB0aGlzLnN0YXRlID0gb2xkLmNsb25lKCk7CiAgfQoKICByZXN0b3JlKCkgewogICAgY29uc3QgcHJldiA9IHRoaXMuc3RhdGVTdGFjay5wb3AoKTsKCiAgICBpZiAocHJldikgewogICAgICB0aGlzLnN0YXRlID0gcHJldjsKICAgIH0KICB9CgogIHRyYW5zZm9ybShhcmdzKSB7CiAgICB0aGlzLnN0YXRlLmN0bSA9IF91dGlsLlV0aWwudHJhbnNmb3JtKHRoaXMuc3RhdGUuY3RtLCBhcmdzKTsKICB9Cgp9CgpjbGFzcyBUZXh0U3RhdGUgewogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5jdG0gPSBuZXcgRmxvYXQzMkFycmF5KF91dGlsLklERU5USVRZX01BVFJJWCk7CiAgICB0aGlzLmZvbnROYW1lID0gbnVsbDsKICAgIHRoaXMuZm9udFNpemUgPSAwOwogICAgdGhpcy5mb250ID0gbnVsbDsKICAgIHRoaXMuZm9udE1hdHJpeCA9IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYOwogICAgdGhpcy50ZXh0TWF0cml4ID0gX3V0aWwuSURFTlRJVFlfTUFUUklYLnNsaWNlKCk7CiAgICB0aGlzLnRleHRMaW5lTWF0cml4ID0gX3V0aWwuSURFTlRJVFlfTUFUUklYLnNsaWNlKCk7CiAgICB0aGlzLmNoYXJTcGFjaW5nID0gMDsKICAgIHRoaXMud29yZFNwYWNpbmcgPSAwOwogICAgdGhpcy5sZWFkaW5nID0gMDsKICAgIHRoaXMudGV4dEhTY2FsZSA9IDE7CiAgICB0aGlzLnRleHRSaXNlID0gMDsKICB9CgogIHNldFRleHRNYXRyaXgoYSwgYiwgYywgZCwgZSwgZikgewogICAgY29uc3QgbSA9IHRoaXMudGV4dE1hdHJpeDsKICAgIG1bMF0gPSBhOwogICAgbVsxXSA9IGI7CiAgICBtWzJdID0gYzsKICAgIG1bM10gPSBkOwogICAgbVs0XSA9IGU7CiAgICBtWzVdID0gZjsKICB9CgogIHNldFRleHRMaW5lTWF0cml4KGEsIGIsIGMsIGQsIGUsIGYpIHsKICAgIGNvbnN0IG0gPSB0aGlzLnRleHRMaW5lTWF0cml4OwogICAgbVswXSA9IGE7CiAgICBtWzFdID0gYjsKICAgIG1bMl0gPSBjOwogICAgbVszXSA9IGQ7CiAgICBtWzRdID0gZTsKICAgIG1bNV0gPSBmOwogIH0KCiAgdHJhbnNsYXRlVGV4dE1hdHJpeCh4LCB5KSB7CiAgICBjb25zdCBtID0gdGhpcy50ZXh0TWF0cml4OwogICAgbVs0XSA9IG1bMF0gKiB4ICsgbVsyXSAqIHkgKyBtWzRdOwogICAgbVs1XSA9IG1bMV0gKiB4ICsgbVszXSAqIHkgKyBtWzVdOwogIH0KCiAgdHJhbnNsYXRlVGV4dExpbmVNYXRyaXgoeCwgeSkgewogICAgY29uc3QgbSA9IHRoaXMudGV4dExpbmVNYXRyaXg7CiAgICBtWzRdID0gbVswXSAqIHggKyBtWzJdICogeSArIG1bNF07CiAgICBtWzVdID0gbVsxXSAqIHggKyBtWzNdICogeSArIG1bNV07CiAgfQoKICBjYXJyaWFnZVJldHVybigpIHsKICAgIHRoaXMudHJhbnNsYXRlVGV4dExpbmVNYXRyaXgoMCwgLXRoaXMubGVhZGluZyk7CiAgICB0aGlzLnRleHRNYXRyaXggPSB0aGlzLnRleHRMaW5lTWF0cml4LnNsaWNlKCk7CiAgfQoKICBjbG9uZSgpIHsKICAgIGNvbnN0IGNsb25lID0gT2JqZWN0LmNyZWF0ZSh0aGlzKTsKICAgIGNsb25lLnRleHRNYXRyaXggPSB0aGlzLnRleHRNYXRyaXguc2xpY2UoKTsKICAgIGNsb25lLnRleHRMaW5lTWF0cml4ID0gdGhpcy50ZXh0TGluZU1hdHJpeC5zbGljZSgpOwogICAgY2xvbmUuZm9udE1hdHJpeCA9IHRoaXMuZm9udE1hdHJpeC5zbGljZSgpOwogICAgcmV0dXJuIGNsb25lOwogIH0KCn0KCmNsYXNzIEV2YWxTdGF0ZSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLmN0bSA9IG5ldyBGbG9hdDMyQXJyYXkoX3V0aWwuSURFTlRJVFlfTUFUUklYKTsKICAgIHRoaXMuZm9udCA9IG51bGw7CiAgICB0aGlzLnRleHRSZW5kZXJpbmdNb2RlID0gX3V0aWwuVGV4dFJlbmRlcmluZ01vZGUuRklMTDsKICAgIHRoaXMuZmlsbENvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuZ3JheTsKICAgIHRoaXMuc3Ryb2tlQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5ncmF5OwogIH0KCiAgY2xvbmUoKSB7CiAgICByZXR1cm4gT2JqZWN0LmNyZWF0ZSh0aGlzKTsKICB9Cgp9CgpjbGFzcyBFdmFsdWF0b3JQcmVwcm9jZXNzb3IgewogIHN0YXRpYyBnZXQgb3BNYXAoKSB7CiAgICBjb25zdCBnZXRPUE1hcCA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICAgIHQudyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldExpbmVXaWR0aCwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5KID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0TGluZUNhcCwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5qID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0TGluZUpvaW4sCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuTSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldE1pdGVyTGltaXQsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuZCA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldERhc2gsCiAgICAgICAgbnVtQXJnczogMiwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQucmkgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRSZW5kZXJpbmdJbnRlbnQsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuaSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldEZsYXRuZXNzLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LmdzID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0R1N0YXRlLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LnEgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zYXZlLAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlEgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5yZXN0b3JlLAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LmNtID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMudHJhbnNmb3JtLAogICAgICAgIG51bUFyZ3M6IDYsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0Lm0gPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5tb3ZlVG8sCiAgICAgICAgbnVtQXJnczogMiwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQubCA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmxpbmVUbywKICAgICAgICBudW1BcmdzOiAyLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5jID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuY3VydmVUbywKICAgICAgICBudW1BcmdzOiA2LAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC52ID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuY3VydmVUbzIsCiAgICAgICAgbnVtQXJnczogNCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQueSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmN1cnZlVG8zLAogICAgICAgIG51bUFyZ3M6IDQsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LmggPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5jbG9zZVBhdGgsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQucmUgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5yZWN0YW5nbGUsCiAgICAgICAgbnVtQXJnczogNCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuUyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnN0cm9rZSwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5zID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuY2xvc2VTdHJva2UsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuZiA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmZpbGwsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuRiA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmZpbGwsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHRbImYqIl0gPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5lb0ZpbGwsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuQiA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmZpbGxTdHJva2UsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHRbIkIqIl0gPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5lb0ZpbGxTdHJva2UsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuYiA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmNsb3NlRmlsbFN0cm9rZSwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdFsiYioiXSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmNsb3NlRU9GaWxsU3Ryb2tlLAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0Lm4gPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5lbmRQYXRoLAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlcgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5jbGlwLAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0WyJXKiJdID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuZW9DbGlwLAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkJUID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuYmVnaW5UZXh0LAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkVUID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuZW5kVGV4dCwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5UYyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldENoYXJTcGFjaW5nLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlR3ID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0V29yZFNwYWNpbmcsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuVHogPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRIU2NhbGUsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuVEwgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRMZWFkaW5nLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlRmID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0Rm9udCwKICAgICAgICBudW1BcmdzOiAyLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5UciA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldFRleHRSZW5kZXJpbmdNb2RlLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlRzID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0VGV4dFJpc2UsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuVGQgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5tb3ZlVGV4dCwKICAgICAgICBudW1BcmdzOiAyLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5URCA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldExlYWRpbmdNb3ZlVGV4dCwKICAgICAgICBudW1BcmdzOiAyLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5UbSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldFRleHRNYXRyaXgsCiAgICAgICAgbnVtQXJnczogNiwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHRbIlQqIl0gPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5uZXh0TGluZSwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5UaiA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNob3dUZXh0LAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlRKID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2hvd1NwYWNlZFRleHQsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHRbIiciXSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLm5leHRMaW5lU2hvd1RleHQsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHRbJyInXSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLm5leHRMaW5lU2V0U3BhY2luZ1Nob3dUZXh0LAogICAgICAgIG51bUFyZ3M6IDMsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LmQwID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0Q2hhcldpZHRoLAogICAgICAgIG51bUFyZ3M6IDIsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LmQxID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0Q2hhcldpZHRoQW5kQm91bmRzLAogICAgICAgIG51bUFyZ3M6IDYsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkNTID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3JTcGFjZSwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5jcyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldEZpbGxDb2xvclNwYWNlLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlNDID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3IsCiAgICAgICAgbnVtQXJnczogNCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IHRydWUKICAgICAgfTsKICAgICAgdC5TQ04gPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRTdHJva2VDb2xvck4sCiAgICAgICAgbnVtQXJnczogMzMsCiAgICAgICAgdmFyaWFibGVBcmdzOiB0cnVlCiAgICAgIH07CiAgICAgIHQuc2MgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRGaWxsQ29sb3IsCiAgICAgICAgbnVtQXJnczogNCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IHRydWUKICAgICAgfTsKICAgICAgdC5zY24gPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRGaWxsQ29sb3JOLAogICAgICAgIG51bUFyZ3M6IDMzLAogICAgICAgIHZhcmlhYmxlQXJnczogdHJ1ZQogICAgICB9OwogICAgICB0LkcgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRTdHJva2VHcmF5LAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LmcgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRGaWxsR3JheSwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5SRyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldFN0cm9rZVJHQkNvbG9yLAogICAgICAgIG51bUFyZ3M6IDMsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LnJnID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yLAogICAgICAgIG51bUFyZ3M6IDMsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LksgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRTdHJva2VDTVlLQ29sb3IsCiAgICAgICAgbnVtQXJnczogNCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuayA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldEZpbGxDTVlLQ29sb3IsCiAgICAgICAgbnVtQXJnczogNCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuc2ggPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zaGFkaW5nRmlsbCwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5CSSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmJlZ2luSW5saW5lSW1hZ2UsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuSUQgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5iZWdpbkltYWdlRGF0YSwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5FSSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmVuZElubGluZUltYWdlLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkRvID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMucGFpbnRYT2JqZWN0LAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0Lk1QID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMubWFya1BvaW50LAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkRQID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMubWFya1BvaW50UHJvcHMsCiAgICAgICAgbnVtQXJnczogMiwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuQk1DID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuYmVnaW5NYXJrZWRDb250ZW50LAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkJEQyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmJlZ2luTWFya2VkQ29udGVudFByb3BzLAogICAgICAgIG51bUFyZ3M6IDIsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkVNQyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmVuZE1hcmtlZENvbnRlbnQsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuQlggPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5iZWdpbkNvbXBhdCwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5FWCA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmVuZENvbXBhdCwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5CTSA9IG51bGw7CiAgICAgIHQuQkQgPSBudWxsOwogICAgICB0LnRydWUgPSBudWxsOwogICAgICB0LmZhID0gbnVsbDsKICAgICAgdC5mYWwgPSBudWxsOwogICAgICB0LmZhbHMgPSBudWxsOwogICAgICB0LmZhbHNlID0gbnVsbDsKICAgICAgdC5udSA9IG51bGw7CiAgICAgIHQubnVsID0gbnVsbDsKICAgICAgdC5udWxsID0gbnVsbDsKICAgIH0pOwogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJvcE1hcCIsIGdldE9QTWFwKCkpOwogIH0KCiAgc3RhdGljIGdldCBNQVhfSU5WQUxJRF9QQVRIX09QUygpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiTUFYX0lOVkFMSURfUEFUSF9PUFMiLCAxMCk7CiAgfQoKICBjb25zdHJ1Y3RvcihzdHJlYW0sIHhyZWYpIHsKICAgIGxldCBzdGF0ZU1hbmFnZXIgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IG5ldyBTdGF0ZU1hbmFnZXIoKTsKICAgIHRoaXMucGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgbGV4ZXI6IG5ldyBfcGFyc2VyLkxleGVyKHN0cmVhbSwgRXZhbHVhdG9yUHJlcHJvY2Vzc29yLm9wTWFwKSwKICAgICAgeHJlZgogICAgfSk7CiAgICB0aGlzLnN0YXRlTWFuYWdlciA9IHN0YXRlTWFuYWdlcjsKICAgIHRoaXMubm9uUHJvY2Vzc2VkQXJncyA9IFtdOwogICAgdGhpcy5faXNQYXRoT3AgPSBmYWxzZTsKICAgIHRoaXMuX251bUludmFsaWRQYXRoT1BTID0gMDsKICB9CgogIGdldCBzYXZlZFN0YXRlc0RlcHRoKCkgewogICAgcmV0dXJuIHRoaXMuc3RhdGVNYW5hZ2VyLnN0YXRlU3RhY2subGVuZ3RoOwogIH0KCiAgcmVhZChvcGVyYXRpb24pIHsKICAgIGxldCBhcmdzID0gb3BlcmF0aW9uLmFyZ3M7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgY29uc3Qgb2JqID0gdGhpcy5wYXJzZXIuZ2V0T2JqKCk7CgogICAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuQ21kKSB7CiAgICAgICAgY29uc3QgY21kID0gb2JqLmNtZDsKICAgICAgICBjb25zdCBvcFNwZWMgPSBFdmFsdWF0b3JQcmVwcm9jZXNzb3Iub3BNYXBbY21kXTsKCiAgICAgICAgaWYgKCFvcFNwZWMpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgVW5rbm93biBjb21tYW5kICIke2NtZH0iLmApOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBmbiA9IG9wU3BlYy5pZDsKICAgICAgICBjb25zdCBudW1BcmdzID0gb3BTcGVjLm51bUFyZ3M7CiAgICAgICAgbGV0IGFyZ3NMZW5ndGggPSBhcmdzICE9PSBudWxsID8gYXJncy5sZW5ndGggOiAwOwoKICAgICAgICBpZiAoIXRoaXMuX2lzUGF0aE9wKSB7CiAgICAgICAgICB0aGlzLl9udW1JbnZhbGlkUGF0aE9QUyA9IDA7CiAgICAgICAgfQoKICAgICAgICB0aGlzLl9pc1BhdGhPcCA9IGZuID49IF91dGlsLk9QUy5tb3ZlVG8gJiYgZm4gPD0gX3V0aWwuT1BTLmVuZFBhdGg7CgogICAgICAgIGlmICghb3BTcGVjLnZhcmlhYmxlQXJncykgewogICAgICAgICAgaWYgKGFyZ3NMZW5ndGggIT09IG51bUFyZ3MpIHsKICAgICAgICAgICAgY29uc3Qgbm9uUHJvY2Vzc2VkQXJncyA9IHRoaXMubm9uUHJvY2Vzc2VkQXJnczsKCiAgICAgICAgICAgIHdoaWxlIChhcmdzTGVuZ3RoID4gbnVtQXJncykgewogICAgICAgICAgICAgIG5vblByb2Nlc3NlZEFyZ3MucHVzaChhcmdzLnNoaWZ0KCkpOwogICAgICAgICAgICAgIGFyZ3NMZW5ndGgtLTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd2hpbGUgKGFyZ3NMZW5ndGggPCBudW1BcmdzICYmIG5vblByb2Nlc3NlZEFyZ3MubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgICAgICAgaWYgKGFyZ3MgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIGFyZ3MgPSBbXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGFyZ3MudW5zaGlmdChub25Qcm9jZXNzZWRBcmdzLnBvcCgpKTsKICAgICAgICAgICAgICBhcmdzTGVuZ3RoKys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoYXJnc0xlbmd0aCA8IG51bUFyZ3MpIHsKICAgICAgICAgICAgY29uc3QgcGFydGlhbE1zZyA9IGBjb21tYW5kICR7Y21kfTogZXhwZWN0ZWQgJHtudW1BcmdzfSBhcmdzLCBgICsgYGJ1dCByZWNlaXZlZCAke2FyZ3NMZW5ndGh9IGFyZ3MuYDsKCiAgICAgICAgICAgIGlmICh0aGlzLl9pc1BhdGhPcCAmJiArK3RoaXMuX251bUludmFsaWRQYXRoT1BTID4gRXZhbHVhdG9yUHJlcHJvY2Vzc29yLk1BWF9JTlZBTElEX1BBVEhfT1BTKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBJbnZhbGlkICR7cGFydGlhbE1zZ31gKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBTa2lwcGluZyAke3BhcnRpYWxNc2d9YCk7CgogICAgICAgICAgICBpZiAoYXJncyAhPT0gbnVsbCkgewogICAgICAgICAgICAgIGFyZ3MubGVuZ3RoID0gMDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChhcmdzTGVuZ3RoID4gbnVtQXJncykgewogICAgICAgICAgKDAsIF91dGlsLmluZm8pKGBDb21tYW5kICR7Y21kfTogZXhwZWN0ZWQgWzAsICR7bnVtQXJnc31dIGFyZ3MsIGAgKyBgYnV0IHJlY2VpdmVkICR7YXJnc0xlbmd0aH0gYXJncy5gKTsKICAgICAgICB9CgogICAgICAgIHRoaXMucHJlcHJvY2Vzc0NvbW1hbmQoZm4sIGFyZ3MpOwogICAgICAgIG9wZXJhdGlvbi5mbiA9IGZuOwogICAgICAgIG9wZXJhdGlvbi5hcmdzID0gYXJnczsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKG9iaiA9PT0gX3ByaW1pdGl2ZXMuRU9GKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAob2JqICE9PSBudWxsKSB7CiAgICAgICAgaWYgKGFyZ3MgPT09IG51bGwpIHsKICAgICAgICAgIGFyZ3MgPSBbXTsKICAgICAgICB9CgogICAgICAgIGFyZ3MucHVzaChvYmopOwoKICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAzMykgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJUb28gbWFueSBhcmd1bWVudHMiKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIHByZXByb2Nlc3NDb21tYW5kKGZuLCBhcmdzKSB7CiAgICBzd2l0Y2ggKGZuIHwgMCkgewogICAgICBjYXNlIF91dGlsLk9QUy5zYXZlOgogICAgICAgIHRoaXMuc3RhdGVNYW5hZ2VyLnNhdmUoKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgX3V0aWwuT1BTLnJlc3RvcmU6CiAgICAgICAgdGhpcy5zdGF0ZU1hbmFnZXIucmVzdG9yZSgpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBfdXRpbC5PUFMudHJhbnNmb3JtOgogICAgICAgIHRoaXMuc3RhdGVNYW5hZ2VyLnRyYW5zZm9ybShhcmdzKTsKICAgICAgICBicmVhazsKICAgIH0KICB9Cgp9CgpleHBvcnRzLkV2YWx1YXRvclByZXByb2Nlc3NvciA9IEV2YWx1YXRvclByZXByb2Nlc3NvcjsKCi8qKiovIH0pLAovKiAxNDEgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLklkZW50aXR5Q01hcCA9IGV4cG9ydHMuQ01hcEZhY3RvcnkgPSBleHBvcnRzLkNNYXAgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwoKdmFyIF9iYXNlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMyKTsKCnZhciBfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDIpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzNSk7Cgpjb25zdCBCVUlMVF9JTl9DTUFQUyA9IFsiQWRvYmUtR0IxLVVDUzIiLCAiQWRvYmUtQ05TMS1VQ1MyIiwgIkFkb2JlLUphcGFuMS1VQ1MyIiwgIkFkb2JlLUtvcmVhMS1VQ1MyIiwgIjc4LUVVQy1IIiwgIjc4LUVVQy1WIiwgIjc4LUgiLCAiNzgtUktTSi1IIiwgIjc4LVJLU0otViIsICI3OC1WIiwgIjc4bXMtUktTSi1IIiwgIjc4bXMtUktTSi1WIiwgIjgzcHYtUktTSi1IIiwgIjkwbXMtUktTSi1IIiwgIjkwbXMtUktTSi1WIiwgIjkwbXNwLVJLU0otSCIsICI5MG1zcC1SS1NKLVYiLCAiOTBwdi1SS1NKLUgiLCAiOTBwdi1SS1NKLVYiLCAiQWRkLUgiLCAiQWRkLVJLU0otSCIsICJBZGQtUktTSi1WIiwgIkFkZC1WIiwgIkFkb2JlLUNOUzEtMCIsICJBZG9iZS1DTlMxLTEiLCAiQWRvYmUtQ05TMS0yIiwgIkFkb2JlLUNOUzEtMyIsICJBZG9iZS1DTlMxLTQiLCAiQWRvYmUtQ05TMS01IiwgIkFkb2JlLUNOUzEtNiIsICJBZG9iZS1HQjEtMCIsICJBZG9iZS1HQjEtMSIsICJBZG9iZS1HQjEtMiIsICJBZG9iZS1HQjEtMyIsICJBZG9iZS1HQjEtNCIsICJBZG9iZS1HQjEtNSIsICJBZG9iZS1KYXBhbjEtMCIsICJBZG9iZS1KYXBhbjEtMSIsICJBZG9iZS1KYXBhbjEtMiIsICJBZG9iZS1KYXBhbjEtMyIsICJBZG9iZS1KYXBhbjEtNCIsICJBZG9iZS1KYXBhbjEtNSIsICJBZG9iZS1KYXBhbjEtNiIsICJBZG9iZS1Lb3JlYTEtMCIsICJBZG9iZS1Lb3JlYTEtMSIsICJBZG9iZS1Lb3JlYTEtMiIsICJCNS1IIiwgIkI1LVYiLCAiQjVwYy1IIiwgIkI1cGMtViIsICJDTlMtRVVDLUgiLCAiQ05TLUVVQy1WIiwgIkNOUzEtSCIsICJDTlMxLVYiLCAiQ05TMi1IIiwgIkNOUzItViIsICJFVEhLLUI1LUgiLCAiRVRISy1CNS1WIiwgIkVUZW4tQjUtSCIsICJFVGVuLUI1LVYiLCAiRVRlbm1zLUI1LUgiLCAiRVRlbm1zLUI1LVYiLCAiRVVDLUgiLCAiRVVDLVYiLCAiRXh0LUgiLCAiRXh0LVJLU0otSCIsICJFeHQtUktTSi1WIiwgIkV4dC1WIiwgIkdCLUVVQy1IIiwgIkdCLUVVQy1WIiwgIkdCLUgiLCAiR0ItViIsICJHQkstRVVDLUgiLCAiR0JLLUVVQy1WIiwgIkdCSzJLLUgiLCAiR0JLMkstViIsICJHQktwLUVVQy1IIiwgIkdCS3AtRVVDLVYiLCAiR0JULUVVQy1IIiwgIkdCVC1FVUMtViIsICJHQlQtSCIsICJHQlQtViIsICJHQlRwYy1FVUMtSCIsICJHQlRwYy1FVUMtViIsICJHQnBjLUVVQy1IIiwgIkdCcGMtRVVDLVYiLCAiSCIsICJIS2RsYS1CNS1IIiwgIkhLZGxhLUI1LVYiLCAiSEtkbGItQjUtSCIsICJIS2RsYi1CNS1WIiwgIkhLZ2Njcy1CNS1IIiwgIkhLZ2Njcy1CNS1WIiwgIkhLbTMxNC1CNS1IIiwgIkhLbTMxNC1CNS1WIiwgIkhLbTQ3MS1CNS1IIiwgIkhLbTQ3MS1CNS1WIiwgIkhLc2NzLUI1LUgiLCAiSEtzY3MtQjUtViIsICJIYW5rYWt1IiwgIkhpcmFnYW5hIiwgIktTQy1FVUMtSCIsICJLU0MtRVVDLVYiLCAiS1NDLUgiLCAiS1NDLUpvaGFiLUgiLCAiS1NDLUpvaGFiLVYiLCAiS1NDLVYiLCAiS1NDbXMtVUhDLUgiLCAiS1NDbXMtVUhDLUhXLUgiLCAiS1NDbXMtVUhDLUhXLVYiLCAiS1NDbXMtVUhDLVYiLCAiS1NDcGMtRVVDLUgiLCAiS1NDcGMtRVVDLVYiLCAiS2F0YWthbmEiLCAiTldQLUgiLCAiTldQLVYiLCAiUktTSi1IIiwgIlJLU0otViIsICJSb21hbiIsICJVbmlDTlMtVUNTMi1IIiwgIlVuaUNOUy1VQ1MyLVYiLCAiVW5pQ05TLVVURjE2LUgiLCAiVW5pQ05TLVVURjE2LVYiLCAiVW5pQ05TLVVURjMyLUgiLCAiVW5pQ05TLVVURjMyLVYiLCAiVW5pQ05TLVVURjgtSCIsICJVbmlDTlMtVVRGOC1WIiwgIlVuaUdCLVVDUzItSCIsICJVbmlHQi1VQ1MyLVYiLCAiVW5pR0ItVVRGMTYtSCIsICJVbmlHQi1VVEYxNi1WIiwgIlVuaUdCLVVURjMyLUgiLCAiVW5pR0ItVVRGMzItViIsICJVbmlHQi1VVEY4LUgiLCAiVW5pR0ItVVRGOC1WIiwgIlVuaUpJUy1VQ1MyLUgiLCAiVW5pSklTLVVDUzItSFctSCIsICJVbmlKSVMtVUNTMi1IVy1WIiwgIlVuaUpJUy1VQ1MyLVYiLCAiVW5pSklTLVVURjE2LUgiLCAiVW5pSklTLVVURjE2LVYiLCAiVW5pSklTLVVURjMyLUgiLCAiVW5pSklTLVVURjMyLVYiLCAiVW5pSklTLVVURjgtSCIsICJVbmlKSVMtVVRGOC1WIiwgIlVuaUpJUzIwMDQtVVRGMTYtSCIsICJVbmlKSVMyMDA0LVVURjE2LVYiLCAiVW5pSklTMjAwNC1VVEYzMi1IIiwgIlVuaUpJUzIwMDQtVVRGMzItViIsICJVbmlKSVMyMDA0LVVURjgtSCIsICJVbmlKSVMyMDA0LVVURjgtViIsICJVbmlKSVNQcm8tVUNTMi1IVy1WIiwgIlVuaUpJU1Byby1VQ1MyLVYiLCAiVW5pSklTUHJvLVVURjgtViIsICJVbmlKSVNYMDIxMy1VVEYzMi1IIiwgIlVuaUpJU1gwMjEzLVVURjMyLVYiLCAiVW5pSklTWDAyMTMyMDA0LVVURjMyLUgiLCAiVW5pSklTWDAyMTMyMDA0LVVURjMyLVYiLCAiVW5pS1MtVUNTMi1IIiwgIlVuaUtTLVVDUzItViIsICJVbmlLUy1VVEYxNi1IIiwgIlVuaUtTLVVURjE2LVYiLCAiVW5pS1MtVVRGMzItSCIsICJVbmlLUy1VVEYzMi1WIiwgIlVuaUtTLVVURjgtSCIsICJVbmlLUy1VVEY4LVYiLCAiViIsICJXUC1TeW1ib2wiXTsKY29uc3QgTUFYX01BUF9SQU5HRSA9IDIgKiogMjQgLSAxOwoKY2xhc3MgQ01hcCB7CiAgY29uc3RydWN0b3IoKSB7CiAgICBsZXQgYnVpbHRJbkNNYXAgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgdGhpcy5jb2Rlc3BhY2VSYW5nZXMgPSBbW10sIFtdLCBbXSwgW11dOwogICAgdGhpcy5udW1Db2Rlc3BhY2VSYW5nZXMgPSAwOwogICAgdGhpcy5fbWFwID0gW107CiAgICB0aGlzLm5hbWUgPSAiIjsKICAgIHRoaXMudmVydGljYWwgPSBmYWxzZTsKICAgIHRoaXMudXNlQ01hcCA9IG51bGw7CiAgICB0aGlzLmJ1aWx0SW5DTWFwID0gYnVpbHRJbkNNYXA7CiAgfQoKICBhZGRDb2Rlc3BhY2VSYW5nZShuLCBsb3csIGhpZ2gpIHsKICAgIHRoaXMuY29kZXNwYWNlUmFuZ2VzW24gLSAxXS5wdXNoKGxvdywgaGlnaCk7CiAgICB0aGlzLm51bUNvZGVzcGFjZVJhbmdlcysrOwogIH0KCiAgbWFwQ2lkUmFuZ2UobG93LCBoaWdoLCBkc3RMb3cpIHsKICAgIGlmIChoaWdoIC0gbG93ID4gTUFYX01BUF9SQU5HRSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIm1hcENpZFJhbmdlIC0gaWdub3JpbmcgZGF0YSBhYm92ZSBNQVhfTUFQX1JBTkdFLiIpOwogICAgfQoKICAgIHdoaWxlIChsb3cgPD0gaGlnaCkgewogICAgICB0aGlzLl9tYXBbbG93KytdID0gZHN0TG93Kys7CiAgICB9CiAgfQoKICBtYXBCZlJhbmdlKGxvdywgaGlnaCwgZHN0TG93KSB7CiAgICBpZiAoaGlnaCAtIGxvdyA+IE1BWF9NQVBfUkFOR0UpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJtYXBCZlJhbmdlIC0gaWdub3JpbmcgZGF0YSBhYm92ZSBNQVhfTUFQX1JBTkdFLiIpOwogICAgfQoKICAgIGNvbnN0IGxhc3RCeXRlID0gZHN0TG93Lmxlbmd0aCAtIDE7CgogICAgd2hpbGUgKGxvdyA8PSBoaWdoKSB7CiAgICAgIHRoaXMuX21hcFtsb3crK10gPSBkc3RMb3c7CiAgICAgIGNvbnN0IG5leHRDaGFyQ29kZSA9IGRzdExvdy5jaGFyQ29kZUF0KGxhc3RCeXRlKSArIDE7CgogICAgICBpZiAobmV4dENoYXJDb2RlID4gMHhmZikgewogICAgICAgIGRzdExvdyA9IGRzdExvdy5zdWJzdHJpbmcoMCwgbGFzdEJ5dGUgLSAxKSArIFN0cmluZy5mcm9tQ2hhckNvZGUoZHN0TG93LmNoYXJDb2RlQXQobGFzdEJ5dGUgLSAxKSArIDEpICsgIlx4MDAiOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBkc3RMb3cgPSBkc3RMb3cuc3Vic3RyaW5nKDAsIGxhc3RCeXRlKSArIFN0cmluZy5mcm9tQ2hhckNvZGUobmV4dENoYXJDb2RlKTsKICAgIH0KICB9CgogIG1hcEJmUmFuZ2VUb0FycmF5KGxvdywgaGlnaCwgYXJyYXkpIHsKICAgIGlmIChoaWdoIC0gbG93ID4gTUFYX01BUF9SQU5HRSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIm1hcEJmUmFuZ2VUb0FycmF5IC0gaWdub3JpbmcgZGF0YSBhYm92ZSBNQVhfTUFQX1JBTkdFLiIpOwogICAgfQoKICAgIGNvbnN0IGlpID0gYXJyYXkubGVuZ3RoOwogICAgbGV0IGkgPSAwOwoKICAgIHdoaWxlIChsb3cgPD0gaGlnaCAmJiBpIDwgaWkpIHsKICAgICAgdGhpcy5fbWFwW2xvd10gPSBhcnJheVtpKytdOwogICAgICArK2xvdzsKICAgIH0KICB9CgogIG1hcE9uZShzcmMsIGRzdCkgewogICAgdGhpcy5fbWFwW3NyY10gPSBkc3Q7CiAgfQoKICBsb29rdXAoY29kZSkgewogICAgcmV0dXJuIHRoaXMuX21hcFtjb2RlXTsKICB9CgogIGNvbnRhaW5zKGNvZGUpIHsKICAgIHJldHVybiB0aGlzLl9tYXBbY29kZV0gIT09IHVuZGVmaW5lZDsKICB9CgogIGZvckVhY2goY2FsbGJhY2spIHsKICAgIGNvbnN0IG1hcCA9IHRoaXMuX21hcDsKICAgIGNvbnN0IGxlbmd0aCA9IG1hcC5sZW5ndGg7CgogICAgaWYgKGxlbmd0aCA8PSAweDEwMDAwKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAobWFwW2ldICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGNhbGxiYWNrKGksIG1hcFtpXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBmb3IgKGNvbnN0IGkgaW4gbWFwKSB7CiAgICAgICAgY2FsbGJhY2soaSwgbWFwW2ldKTsKICAgICAgfQogICAgfQogIH0KCiAgY2hhckNvZGVPZih2YWx1ZSkgewogICAgY29uc3QgbWFwID0gdGhpcy5fbWFwOwoKICAgIGlmIChtYXAubGVuZ3RoIDw9IDB4MTAwMDApIHsKICAgICAgcmV0dXJuIG1hcC5pbmRleE9mKHZhbHVlKTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGNoYXJDb2RlIGluIG1hcCkgewogICAgICBpZiAobWFwW2NoYXJDb2RlXSA9PT0gdmFsdWUpIHsKICAgICAgICByZXR1cm4gY2hhckNvZGUgfCAwOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIC0xOwogIH0KCiAgZ2V0TWFwKCkgewogICAgcmV0dXJuIHRoaXMuX21hcDsKICB9CgogIHJlYWRDaGFyQ29kZShzdHIsIG9mZnNldCwgb3V0KSB7CiAgICBsZXQgYyA9IDA7CiAgICBjb25zdCBjb2Rlc3BhY2VSYW5nZXMgPSB0aGlzLmNvZGVzcGFjZVJhbmdlczsKCiAgICBmb3IgKGxldCBuID0gMCwgbm4gPSBjb2Rlc3BhY2VSYW5nZXMubGVuZ3RoOyBuIDwgbm47IG4rKykgewogICAgICBjID0gKGMgPDwgOCB8IHN0ci5jaGFyQ29kZUF0KG9mZnNldCArIG4pKSA+Pj4gMDsKICAgICAgY29uc3QgY29kZXNwYWNlUmFuZ2UgPSBjb2Rlc3BhY2VSYW5nZXNbbl07CgogICAgICBmb3IgKGxldCBrID0gMCwga2sgPSBjb2Rlc3BhY2VSYW5nZS5sZW5ndGg7IGsgPCBrazspIHsKICAgICAgICBjb25zdCBsb3cgPSBjb2Rlc3BhY2VSYW5nZVtrKytdOwogICAgICAgIGNvbnN0IGhpZ2ggPSBjb2Rlc3BhY2VSYW5nZVtrKytdOwoKICAgICAgICBpZiAoYyA+PSBsb3cgJiYgYyA8PSBoaWdoKSB7CiAgICAgICAgICBvdXQuY2hhcmNvZGUgPSBjOwogICAgICAgICAgb3V0Lmxlbmd0aCA9IG4gKyAxOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG91dC5jaGFyY29kZSA9IDA7CiAgICBvdXQubGVuZ3RoID0gMTsKICB9CgogIGdldENoYXJDb2RlTGVuZ3RoKGNoYXJDb2RlKSB7CiAgICBjb25zdCBjb2Rlc3BhY2VSYW5nZXMgPSB0aGlzLmNvZGVzcGFjZVJhbmdlczsKCiAgICBmb3IgKGxldCBuID0gMCwgbm4gPSBjb2Rlc3BhY2VSYW5nZXMubGVuZ3RoOyBuIDwgbm47IG4rKykgewogICAgICBjb25zdCBjb2Rlc3BhY2VSYW5nZSA9IGNvZGVzcGFjZVJhbmdlc1tuXTsKCiAgICAgIGZvciAobGV0IGsgPSAwLCBrayA9IGNvZGVzcGFjZVJhbmdlLmxlbmd0aDsgayA8IGtrOykgewogICAgICAgIGNvbnN0IGxvdyA9IGNvZGVzcGFjZVJhbmdlW2srK107CiAgICAgICAgY29uc3QgaGlnaCA9IGNvZGVzcGFjZVJhbmdlW2srK107CgogICAgICAgIGlmIChjaGFyQ29kZSA+PSBsb3cgJiYgY2hhckNvZGUgPD0gaGlnaCkgewogICAgICAgICAgcmV0dXJuIG4gKyAxOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiAxOwogIH0KCiAgZ2V0IGxlbmd0aCgpIHsKICAgIHJldHVybiB0aGlzLl9tYXAubGVuZ3RoOwogIH0KCiAgZ2V0IGlzSWRlbnRpdHlDTWFwKCkgewogICAgaWYgKCEodGhpcy5uYW1lID09PSAiSWRlbnRpdHktSCIgfHwgdGhpcy5uYW1lID09PSAiSWRlbnRpdHktViIpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAodGhpcy5fbWFwLmxlbmd0aCAhPT0gMHgxMDAwMCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCAweDEwMDAwOyBpKyspIHsKICAgICAgaWYgKHRoaXMuX21hcFtpXSAhPT0gaSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCmV4cG9ydHMuQ01hcCA9IENNYXA7CgpjbGFzcyBJZGVudGl0eUNNYXAgZXh0ZW5kcyBDTWFwIHsKICBjb25zdHJ1Y3Rvcih2ZXJ0aWNhbCwgbikgewogICAgc3VwZXIoKTsKICAgIHRoaXMudmVydGljYWwgPSB2ZXJ0aWNhbDsKICAgIHRoaXMuYWRkQ29kZXNwYWNlUmFuZ2UobiwgMCwgMHhmZmZmKTsKICB9CgogIG1hcENpZFJhbmdlKGxvdywgaGlnaCwgZHN0TG93KSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJzaG91bGQgbm90IGNhbGwgbWFwQ2lkUmFuZ2UiKTsKICB9CgogIG1hcEJmUmFuZ2UobG93LCBoaWdoLCBkc3RMb3cpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoInNob3VsZCBub3QgY2FsbCBtYXBCZlJhbmdlIik7CiAgfQoKICBtYXBCZlJhbmdlVG9BcnJheShsb3csIGhpZ2gsIGFycmF5KSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJzaG91bGQgbm90IGNhbGwgbWFwQmZSYW5nZVRvQXJyYXkiKTsKICB9CgogIG1hcE9uZShzcmMsIGRzdCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgic2hvdWxkIG5vdCBjYWxsIG1hcENpZE9uZSIpOwogIH0KCiAgbG9va3VwKGNvZGUpIHsKICAgIHJldHVybiBOdW1iZXIuaXNJbnRlZ2VyKGNvZGUpICYmIGNvZGUgPD0gMHhmZmZmID8gY29kZSA6IHVuZGVmaW5lZDsKICB9CgogIGNvbnRhaW5zKGNvZGUpIHsKICAgIHJldHVybiBOdW1iZXIuaXNJbnRlZ2VyKGNvZGUpICYmIGNvZGUgPD0gMHhmZmZmOwogIH0KCiAgZm9yRWFjaChjYWxsYmFjaykgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gMHhmZmZmOyBpKyspIHsKICAgICAgY2FsbGJhY2soaSwgaSk7CiAgICB9CiAgfQoKICBjaGFyQ29kZU9mKHZhbHVlKSB7CiAgICByZXR1cm4gTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSkgJiYgdmFsdWUgPD0gMHhmZmZmID8gdmFsdWUgOiAtMTsKICB9CgogIGdldE1hcCgpIHsKICAgIGNvbnN0IG1hcCA9IG5ldyBBcnJheSgweDEwMDAwKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSAweGZmZmY7IGkrKykgewogICAgICBtYXBbaV0gPSBpOwogICAgfQoKICAgIHJldHVybiBtYXA7CiAgfQoKICBnZXQgbGVuZ3RoKCkgewogICAgcmV0dXJuIDB4MTAwMDA7CiAgfQoKICBnZXQgaXNJZGVudGl0eUNNYXAoKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJzaG91bGQgbm90IGFjY2VzcyAuaXNJZGVudGl0eUNNYXAiKTsKICB9Cgp9CgpleHBvcnRzLklkZW50aXR5Q01hcCA9IElkZW50aXR5Q01hcDsKCmNvbnN0IEJpbmFyeUNNYXBSZWFkZXIgPSBmdW5jdGlvbiBCaW5hcnlDTWFwUmVhZGVyQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBoZXhUb0ludChhLCBzaXplKSB7CiAgICBsZXQgbiA9IDA7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gc2l6ZTsgaSsrKSB7CiAgICAgIG4gPSBuIDw8IDggfCBhW2ldOwogICAgfQoKICAgIHJldHVybiBuID4+PiAwOwogIH0KCiAgZnVuY3Rpb24gaGV4VG9TdHIoYSwgc2l6ZSkgewogICAgaWYgKHNpemUgPT09IDEpIHsKICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoYVswXSwgYVsxXSk7CiAgICB9CgogICAgaWYgKHNpemUgPT09IDMpIHsKICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoYVswXSwgYVsxXSwgYVsyXSwgYVszXSk7CiAgICB9CgogICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgYS5zdWJhcnJheSgwLCBzaXplICsgMSkpOwogIH0KCiAgZnVuY3Rpb24gYWRkSGV4KGEsIGIsIHNpemUpIHsKICAgIGxldCBjID0gMDsKCiAgICBmb3IgKGxldCBpID0gc2l6ZTsgaSA+PSAwOyBpLS0pIHsKICAgICAgYyArPSBhW2ldICsgYltpXTsKICAgICAgYVtpXSA9IGMgJiAyNTU7CiAgICAgIGMgPj49IDg7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBpbmNIZXgoYSwgc2l6ZSkgewogICAgbGV0IGMgPSAxOwoKICAgIGZvciAobGV0IGkgPSBzaXplOyBpID49IDAgJiYgYyA+IDA7IGktLSkgewogICAgICBjICs9IGFbaV07CiAgICAgIGFbaV0gPSBjICYgMjU1OwogICAgICBjID4+PSA4OwogICAgfQogIH0KCiAgY29uc3QgTUFYX05VTV9TSVpFID0gMTY7CiAgY29uc3QgTUFYX0VOQ09ERURfTlVNX1NJWkUgPSAxOTsKCiAgY2xhc3MgQmluYXJ5Q01hcFN0cmVhbSB7CiAgICBjb25zdHJ1Y3RvcihkYXRhKSB7CiAgICAgIHRoaXMuYnVmZmVyID0gZGF0YTsKICAgICAgdGhpcy5wb3MgPSAwOwogICAgICB0aGlzLmVuZCA9IGRhdGEubGVuZ3RoOwogICAgICB0aGlzLnRtcEJ1ZiA9IG5ldyBVaW50OEFycmF5KE1BWF9FTkNPREVEX05VTV9TSVpFKTsKICAgIH0KCiAgICByZWFkQnl0ZSgpIHsKICAgICAgaWYgKHRoaXMucG9zID49IHRoaXMuZW5kKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5idWZmZXJbdGhpcy5wb3MrK107CiAgICB9CgogICAgcmVhZE51bWJlcigpIHsKICAgICAgbGV0IG4gPSAwOwogICAgICBsZXQgbGFzdDsKCiAgICAgIGRvIHsKICAgICAgICBjb25zdCBiID0gdGhpcy5yZWFkQnl0ZSgpOwoKICAgICAgICBpZiAoYiA8IDApIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigidW5leHBlY3RlZCBFT0YgaW4gYmNtYXAiKTsKICAgICAgICB9CgogICAgICAgIGxhc3QgPSAhKGIgJiAweDgwKTsKICAgICAgICBuID0gbiA8PCA3IHwgYiAmIDB4N2Y7CiAgICAgIH0gd2hpbGUgKCFsYXN0KTsKCiAgICAgIHJldHVybiBuOwogICAgfQoKICAgIHJlYWRTaWduZWQoKSB7CiAgICAgIGNvbnN0IG4gPSB0aGlzLnJlYWROdW1iZXIoKTsKICAgICAgcmV0dXJuIG4gJiAxID8gfihuID4+PiAxKSA6IG4gPj4+IDE7CiAgICB9CgogICAgcmVhZEhleChudW0sIHNpemUpIHsKICAgICAgbnVtLnNldCh0aGlzLmJ1ZmZlci5zdWJhcnJheSh0aGlzLnBvcywgdGhpcy5wb3MgKyBzaXplICsgMSkpOwogICAgICB0aGlzLnBvcyArPSBzaXplICsgMTsKICAgIH0KCiAgICByZWFkSGV4TnVtYmVyKG51bSwgc2l6ZSkgewogICAgICBsZXQgbGFzdDsKICAgICAgY29uc3Qgc3RhY2sgPSB0aGlzLnRtcEJ1ZjsKICAgICAgbGV0IHNwID0gMDsKCiAgICAgIGRvIHsKICAgICAgICBjb25zdCBiID0gdGhpcy5yZWFkQnl0ZSgpOwoKICAgICAgICBpZiAoYiA8IDApIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigidW5leHBlY3RlZCBFT0YgaW4gYmNtYXAiKTsKICAgICAgICB9CgogICAgICAgIGxhc3QgPSAhKGIgJiAweDgwKTsKICAgICAgICBzdGFja1tzcCsrXSA9IGIgJiAweDdmOwogICAgICB9IHdoaWxlICghbGFzdCk7CgogICAgICBsZXQgaSA9IHNpemUsCiAgICAgICAgICBidWZmZXIgPSAwLAogICAgICAgICAgYnVmZmVyU2l6ZSA9IDA7CgogICAgICB3aGlsZSAoaSA+PSAwKSB7CiAgICAgICAgd2hpbGUgKGJ1ZmZlclNpemUgPCA4ICYmIHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGJ1ZmZlciB8PSBzdGFja1stLXNwXSA8PCBidWZmZXJTaXplOwogICAgICAgICAgYnVmZmVyU2l6ZSArPSA3OwogICAgICAgIH0KCiAgICAgICAgbnVtW2ldID0gYnVmZmVyICYgMjU1OwogICAgICAgIGktLTsKICAgICAgICBidWZmZXIgPj49IDg7CiAgICAgICAgYnVmZmVyU2l6ZSAtPSA4OwogICAgICB9CiAgICB9CgogICAgcmVhZEhleFNpZ25lZChudW0sIHNpemUpIHsKICAgICAgdGhpcy5yZWFkSGV4TnVtYmVyKG51bSwgc2l6ZSk7CiAgICAgIGNvbnN0IHNpZ24gPSBudW1bc2l6ZV0gJiAxID8gMjU1IDogMDsKICAgICAgbGV0IGMgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gc2l6ZTsgaSsrKSB7CiAgICAgICAgYyA9IChjICYgMSkgPDwgOCB8IG51bVtpXTsKICAgICAgICBudW1baV0gPSBjID4+IDEgXiBzaWduOwogICAgICB9CiAgICB9CgogICAgcmVhZFN0cmluZygpIHsKICAgICAgY29uc3QgbGVuID0gdGhpcy5yZWFkTnVtYmVyKCk7CiAgICAgIGxldCBzID0gIiI7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHRoaXMucmVhZE51bWJlcigpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHM7CiAgICB9CgogIH0KCiAgY2xhc3MgQmluYXJ5Q01hcFJlYWRlciB7CiAgICBhc3luYyBwcm9jZXNzKGRhdGEsIGNNYXAsIGV4dGVuZCkgewogICAgICBjb25zdCBzdHJlYW0gPSBuZXcgQmluYXJ5Q01hcFN0cmVhbShkYXRhKTsKICAgICAgY29uc3QgaGVhZGVyID0gc3RyZWFtLnJlYWRCeXRlKCk7CiAgICAgIGNNYXAudmVydGljYWwgPSAhIShoZWFkZXIgJiAxKTsKICAgICAgbGV0IHVzZUNNYXAgPSBudWxsOwogICAgICBjb25zdCBzdGFydCA9IG5ldyBVaW50OEFycmF5KE1BWF9OVU1fU0laRSk7CiAgICAgIGNvbnN0IGVuZCA9IG5ldyBVaW50OEFycmF5KE1BWF9OVU1fU0laRSk7CiAgICAgIGNvbnN0IGNoYXIgPSBuZXcgVWludDhBcnJheShNQVhfTlVNX1NJWkUpOwogICAgICBjb25zdCBjaGFyQ29kZSA9IG5ldyBVaW50OEFycmF5KE1BWF9OVU1fU0laRSk7CiAgICAgIGNvbnN0IHRtcCA9IG5ldyBVaW50OEFycmF5KE1BWF9OVU1fU0laRSk7CiAgICAgIGxldCBjb2RlOwogICAgICBsZXQgYjsKCiAgICAgIHdoaWxlICgoYiA9IHN0cmVhbS5yZWFkQnl0ZSgpKSA+PSAwKSB7CiAgICAgICAgY29uc3QgdHlwZSA9IGIgPj4gNTsKCiAgICAgICAgaWYgKHR5cGUgPT09IDcpIHsKICAgICAgICAgIHN3aXRjaCAoYiAmIDB4MWYpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHN0cmVhbS5yZWFkU3RyaW5nKCk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgdXNlQ01hcCA9IHN0cmVhbS5yZWFkU3RyaW5nKCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzZXF1ZW5jZSA9ICEhKGIgJiAweDEwKTsKICAgICAgICBjb25zdCBkYXRhU2l6ZSA9IGIgJiAxNTsKCiAgICAgICAgaWYgKGRhdGFTaXplICsgMSA+IE1BWF9OVU1fU0laRSkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJCaW5hcnlDTWFwUmVhZGVyLnByb2Nlc3M6IEludmFsaWQgZGF0YVNpemUuIik7CiAgICAgICAgfQoKICAgICAgICBjb25zdCB1Y3MyRGF0YVNpemUgPSAxOwogICAgICAgIGNvbnN0IHN1Yml0ZW1zQ291bnQgPSBzdHJlYW0ucmVhZE51bWJlcigpOwoKICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXgoc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIGFkZEhleChlbmQsIHN0YXJ0LCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIGNNYXAuYWRkQ29kZXNwYWNlUmFuZ2UoZGF0YVNpemUgKyAxLCBoZXhUb0ludChzdGFydCwgZGF0YVNpemUpLCBoZXhUb0ludChlbmQsIGRhdGFTaXplKSk7CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHN1Yml0ZW1zQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIGluY0hleChlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGFkZEhleChzdGFydCwgZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgYWRkSGV4KGVuZCwgc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBjTWFwLmFkZENvZGVzcGFjZVJhbmdlKGRhdGFTaXplICsgMSwgaGV4VG9JbnQoc3RhcnQsIGRhdGFTaXplKSwgaGV4VG9JbnQoZW5kLCBkYXRhU2l6ZSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KHN0YXJ0LCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKGVuZCwgZGF0YVNpemUpOwogICAgICAgICAgICBhZGRIZXgoZW5kLCBzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICBzdHJlYW0ucmVhZE51bWJlcigpOwoKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzdWJpdGVtc0NvdW50OyBpKyspIHsKICAgICAgICAgICAgICBpbmNIZXgoZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBhZGRIZXgoc3RhcnQsIGVuZCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKGVuZCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGFkZEhleChlbmQsIHN0YXJ0LCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgc3RyZWFtLnJlYWROdW1iZXIoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBzdHJlYW0ucmVhZEhleChjaGFyLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIGNvZGUgPSBzdHJlYW0ucmVhZE51bWJlcigpOwogICAgICAgICAgICBjTWFwLm1hcE9uZShoZXhUb0ludChjaGFyLCBkYXRhU2l6ZSksIGNvZGUpOwoKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzdWJpdGVtc0NvdW50OyBpKyspIHsKICAgICAgICAgICAgICBpbmNIZXgoY2hhciwgZGF0YVNpemUpOwoKICAgICAgICAgICAgICBpZiAoIXNlcXVlbmNlKSB7CiAgICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcih0bXAsIGRhdGFTaXplKTsKICAgICAgICAgICAgICAgIGFkZEhleChjaGFyLCB0bXAsIGRhdGFTaXplKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvZGUgPSBzdHJlYW0ucmVhZFNpZ25lZCgpICsgKGNvZGUgKyAxKTsKICAgICAgICAgICAgICBjTWFwLm1hcE9uZShoZXhUb0ludChjaGFyLCBkYXRhU2l6ZSksIGNvZGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KHN0YXJ0LCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKGVuZCwgZGF0YVNpemUpOwogICAgICAgICAgICBhZGRIZXgoZW5kLCBzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICBjb2RlID0gc3RyZWFtLnJlYWROdW1iZXIoKTsKICAgICAgICAgICAgY01hcC5tYXBDaWRSYW5nZShoZXhUb0ludChzdGFydCwgZGF0YVNpemUpLCBoZXhUb0ludChlbmQsIGRhdGFTaXplKSwgY29kZSk7CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHN1Yml0ZW1zQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIGluY0hleChlbmQsIGRhdGFTaXplKTsKCiAgICAgICAgICAgICAgaWYgKCFzZXF1ZW5jZSkgewogICAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICAgIGFkZEhleChzdGFydCwgZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHN0YXJ0LnNldChlbmQpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgYWRkSGV4KGVuZCwgc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBjb2RlID0gc3RyZWFtLnJlYWROdW1iZXIoKTsKICAgICAgICAgICAgICBjTWFwLm1hcENpZFJhbmdlKGhleFRvSW50KHN0YXJ0LCBkYXRhU2l6ZSksIGhleFRvSW50KGVuZCwgZGF0YVNpemUpLCBjb2RlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBzdHJlYW0ucmVhZEhleChjaGFyLCB1Y3MyRGF0YVNpemUpOwogICAgICAgICAgICBzdHJlYW0ucmVhZEhleChjaGFyQ29kZSwgZGF0YVNpemUpOwogICAgICAgICAgICBjTWFwLm1hcE9uZShoZXhUb0ludChjaGFyLCB1Y3MyRGF0YVNpemUpLCBoZXhUb1N0cihjaGFyQ29kZSwgZGF0YVNpemUpKTsKCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc3ViaXRlbXNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgaW5jSGV4KGNoYXIsIHVjczJEYXRhU2l6ZSk7CgogICAgICAgICAgICAgIGlmICghc2VxdWVuY2UpIHsKICAgICAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKHRtcCwgdWNzMkRhdGFTaXplKTsKICAgICAgICAgICAgICAgIGFkZEhleChjaGFyLCB0bXAsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpbmNIZXgoY2hhckNvZGUsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleFNpZ25lZCh0bXAsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBhZGRIZXgoY2hhckNvZGUsIHRtcCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGNNYXAubWFwT25lKGhleFRvSW50KGNoYXIsIHVjczJEYXRhU2l6ZSksIGhleFRvU3RyKGNoYXJDb2RlLCBkYXRhU2l6ZSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KHN0YXJ0LCB1Y3MyRGF0YVNpemUpOwogICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihlbmQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgIGFkZEhleChlbmQsIHN0YXJ0LCB1Y3MyRGF0YVNpemUpOwogICAgICAgICAgICBzdHJlYW0ucmVhZEhleChjaGFyQ29kZSwgZGF0YVNpemUpOwogICAgICAgICAgICBjTWFwLm1hcEJmUmFuZ2UoaGV4VG9JbnQoc3RhcnQsIHVjczJEYXRhU2l6ZSksIGhleFRvSW50KGVuZCwgdWNzMkRhdGFTaXplKSwgaGV4VG9TdHIoY2hhckNvZGUsIGRhdGFTaXplKSk7CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHN1Yml0ZW1zQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIGluY0hleChlbmQsIHVjczJEYXRhU2l6ZSk7CgogICAgICAgICAgICAgIGlmICghc2VxdWVuY2UpIHsKICAgICAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKHN0YXJ0LCB1Y3MyRGF0YVNpemUpOwogICAgICAgICAgICAgICAgYWRkSGV4KHN0YXJ0LCBlbmQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHN0YXJ0LnNldChlbmQpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoZW5kLCB1Y3MyRGF0YVNpemUpOwogICAgICAgICAgICAgIGFkZEhleChlbmQsIHN0YXJ0LCB1Y3MyRGF0YVNpemUpOwogICAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KGNoYXJDb2RlLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgY01hcC5tYXBCZlJhbmdlKGhleFRvSW50KHN0YXJ0LCB1Y3MyRGF0YVNpemUpLCBoZXhUb0ludChlbmQsIHVjczJEYXRhU2l6ZSksIGhleFRvU3RyKGNoYXJDb2RlLCBkYXRhU2l6ZSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEJpbmFyeUNNYXBSZWFkZXIucHJvY2VzcyAtIHVua25vd24gdHlwZTogJHt0eXBlfWApOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHVzZUNNYXApIHsKICAgICAgICByZXR1cm4gZXh0ZW5kKHVzZUNNYXApOwogICAgICB9CgogICAgICByZXR1cm4gY01hcDsKICAgIH0KCiAgfQoKICByZXR1cm4gQmluYXJ5Q01hcFJlYWRlcjsKfSgpOwoKY29uc3QgQ01hcEZhY3RvcnkgPSBmdW5jdGlvbiBDTWFwRmFjdG9yeUNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gc3RyVG9JbnQoc3RyKSB7CiAgICBsZXQgYSA9IDA7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHsKICAgICAgYSA9IGEgPDwgOCB8IHN0ci5jaGFyQ29kZUF0KGkpOwogICAgfQoKICAgIHJldHVybiBhID4+PiAwOwogIH0KCiAgZnVuY3Rpb24gZXhwZWN0U3RyaW5nKG9iaikgewogICAgaWYgKHR5cGVvZiBvYmogIT09ICJzdHJpbmciKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTWFsZm9ybWVkIENNYXA6IGV4cGVjdGVkIHN0cmluZy4iKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGV4cGVjdEludChvYmopIHsKICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihvYmopKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTWFsZm9ybWVkIENNYXA6IGV4cGVjdGVkIGludC4iKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHBhcnNlQmZDaGFyKGNNYXAsIGxleGVyKSB7CiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBsZXQgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CgogICAgICBpZiAob2JqID09PSBfcHJpbWl0aXZlcy5FT0YpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAiZW5kYmZjaGFyIikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGV4cGVjdFN0cmluZyhvYmopOwogICAgICBjb25zdCBzcmMgPSBzdHJUb0ludChvYmopOwogICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKICAgICAgZXhwZWN0U3RyaW5nKG9iaik7CiAgICAgIGNvbnN0IGRzdCA9IG9iajsKICAgICAgY01hcC5tYXBPbmUoc3JjLCBkc3QpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcGFyc2VCZlJhbmdlKGNNYXAsIGxleGVyKSB7CiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBsZXQgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CgogICAgICBpZiAob2JqID09PSBfcHJpbWl0aXZlcy5FT0YpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAiZW5kYmZyYW5nZSIpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBleHBlY3RTdHJpbmcob2JqKTsKICAgICAgY29uc3QgbG93ID0gc3RyVG9JbnQob2JqKTsKICAgICAgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CiAgICAgIGV4cGVjdFN0cmluZyhvYmopOwogICAgICBjb25zdCBoaWdoID0gc3RyVG9JbnQob2JqKTsKICAgICAgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CgogICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihvYmopIHx8IHR5cGVvZiBvYmogPT09ICJzdHJpbmciKSB7CiAgICAgICAgY29uc3QgZHN0TG93ID0gTnVtYmVyLmlzSW50ZWdlcihvYmopID8gU3RyaW5nLmZyb21DaGFyQ29kZShvYmopIDogb2JqOwogICAgICAgIGNNYXAubWFwQmZSYW5nZShsb3csIGhpZ2gsIGRzdExvdyk7CiAgICAgIH0gZWxzZSBpZiAoKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmosICJbIikpIHsKICAgICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKICAgICAgICBjb25zdCBhcnJheSA9IFtdOwoKICAgICAgICB3aGlsZSAoISgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAiXSIpICYmIG9iaiAhPT0gX3ByaW1pdGl2ZXMuRU9GKSB7CiAgICAgICAgICBhcnJheS5wdXNoKG9iaik7CiAgICAgICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKICAgICAgICB9CgogICAgICAgIGNNYXAubWFwQmZSYW5nZVRvQXJyYXkobG93LCBoaWdoLCBhcnJheSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgYmYgcmFuZ2UuIik7CiAgfQoKICBmdW5jdGlvbiBwYXJzZUNpZENoYXIoY01hcCwgbGV4ZXIpIHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGxldCBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgIGlmIChvYmogPT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmosICJlbmRjaWRjaGFyIikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGV4cGVjdFN0cmluZyhvYmopOwogICAgICBjb25zdCBzcmMgPSBzdHJUb0ludChvYmopOwogICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKICAgICAgZXhwZWN0SW50KG9iaik7CiAgICAgIGNvbnN0IGRzdCA9IG9iajsKICAgICAgY01hcC5tYXBPbmUoc3JjLCBkc3QpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcGFyc2VDaWRSYW5nZShjTWFwLCBsZXhlcikgewogICAgd2hpbGUgKHRydWUpIHsKICAgICAgbGV0IG9iaiA9IGxleGVyLmdldE9iaigpOwoKICAgICAgaWYgKG9iaiA9PT0gX3ByaW1pdGl2ZXMuRU9GKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iaiwgImVuZGNpZHJhbmdlIikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGV4cGVjdFN0cmluZyhvYmopOwogICAgICBjb25zdCBsb3cgPSBzdHJUb0ludChvYmopOwogICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKICAgICAgZXhwZWN0U3RyaW5nKG9iaik7CiAgICAgIGNvbnN0IGhpZ2ggPSBzdHJUb0ludChvYmopOwogICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKICAgICAgZXhwZWN0SW50KG9iaik7CiAgICAgIGNvbnN0IGRzdExvdyA9IG9iajsKICAgICAgY01hcC5tYXBDaWRSYW5nZShsb3csIGhpZ2gsIGRzdExvdyk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwYXJzZUNvZGVzcGFjZVJhbmdlKGNNYXAsIGxleGVyKSB7CiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBsZXQgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CgogICAgICBpZiAob2JqID09PSBfcHJpbWl0aXZlcy5FT0YpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAiZW5kY29kZXNwYWNlcmFuZ2UiKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBvYmogIT09ICJzdHJpbmciKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxvdyA9IHN0clRvSW50KG9iaik7CiAgICAgIG9iaiA9IGxleGVyLmdldE9iaigpOwoKICAgICAgaWYgKHR5cGVvZiBvYmogIT09ICJzdHJpbmciKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGNvbnN0IGhpZ2ggPSBzdHJUb0ludChvYmopOwogICAgICBjTWFwLmFkZENvZGVzcGFjZVJhbmdlKG9iai5sZW5ndGgsIGxvdywgaGlnaCk7CiAgICB9CgogICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIGNvZGVzcGFjZSByYW5nZS4iKTsKICB9CgogIGZ1bmN0aW9uIHBhcnNlV01vZGUoY01hcCwgbGV4ZXIpIHsKICAgIGNvbnN0IG9iaiA9IGxleGVyLmdldE9iaigpOwoKICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKG9iaikpIHsKICAgICAgY01hcC52ZXJ0aWNhbCA9ICEhb2JqOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcGFyc2VDTWFwTmFtZShjTWFwLCBsZXhlcikgewogICAgY29uc3Qgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CgogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgY01hcC5uYW1lID0gb2JqLm5hbWU7CiAgICB9CiAgfQoKICBhc3luYyBmdW5jdGlvbiBwYXJzZUNNYXAoY01hcCwgbGV4ZXIsIGZldGNoQnVpbHRJbkNNYXAsIHVzZUNNYXApIHsKICAgIGxldCBwcmV2aW91cywgZW1iZWRkZWRVc2VDTWFwOwoKICAgIG9iakxvb3A6IHdoaWxlICh0cnVlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3Qgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CgogICAgICAgIGlmIChvYmogPT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfSBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICBpZiAob2JqLm5hbWUgPT09ICJXTW9kZSIpIHsKICAgICAgICAgICAgcGFyc2VXTW9kZShjTWFwLCBsZXhlcik7CiAgICAgICAgICB9IGVsc2UgaWYgKG9iai5uYW1lID09PSAiQ01hcE5hbWUiKSB7CiAgICAgICAgICAgIHBhcnNlQ01hcE5hbWUoY01hcCwgbGV4ZXIpOwogICAgICAgICAgfQoKICAgICAgICAgIHByZXZpb3VzID0gb2JqOwogICAgICAgIH0gZWxzZSBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuQ21kKSB7CiAgICAgICAgICBzd2l0Y2ggKG9iai5jbWQpIHsKICAgICAgICAgICAgY2FzZSAiZW5kY21hcCI6CiAgICAgICAgICAgICAgYnJlYWsgb2JqTG9vcDsKCiAgICAgICAgICAgIGNhc2UgInVzZWNtYXAiOgogICAgICAgICAgICAgIGlmIChwcmV2aW91cyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgICAgICAgIGVtYmVkZGVkVXNlQ01hcCA9IHByZXZpb3VzLm5hbWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgImJlZ2luY29kZXNwYWNlcmFuZ2UiOgogICAgICAgICAgICAgIHBhcnNlQ29kZXNwYWNlUmFuZ2UoY01hcCwgbGV4ZXIpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAiYmVnaW5iZmNoYXIiOgogICAgICAgICAgICAgIHBhcnNlQmZDaGFyKGNNYXAsIGxleGVyKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgImJlZ2luY2lkY2hhciI6CiAgICAgICAgICAgICAgcGFyc2VDaWRDaGFyKGNNYXAsIGxleGVyKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgImJlZ2luYmZyYW5nZSI6CiAgICAgICAgICAgICAgcGFyc2VCZlJhbmdlKGNNYXAsIGxleGVyKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgImJlZ2luY2lkcmFuZ2UiOgogICAgICAgICAgICAgIHBhcnNlQ2lkUmFuZ2UoY01hcCwgbGV4ZXIpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwud2FybikoIkludmFsaWQgY01hcCBkYXRhOiAiICsgZXgpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICB9CgogICAgaWYgKCF1c2VDTWFwICYmIGVtYmVkZGVkVXNlQ01hcCkgewogICAgICB1c2VDTWFwID0gZW1iZWRkZWRVc2VDTWFwOwogICAgfQoKICAgIGlmICh1c2VDTWFwKSB7CiAgICAgIHJldHVybiBleHRlbmRDTWFwKGNNYXAsIGZldGNoQnVpbHRJbkNNYXAsIHVzZUNNYXApOwogICAgfQoKICAgIHJldHVybiBjTWFwOwogIH0KCiAgYXN5bmMgZnVuY3Rpb24gZXh0ZW5kQ01hcChjTWFwLCBmZXRjaEJ1aWx0SW5DTWFwLCB1c2VDTWFwKSB7CiAgICBjTWFwLnVzZUNNYXAgPSBhd2FpdCBjcmVhdGVCdWlsdEluQ01hcCh1c2VDTWFwLCBmZXRjaEJ1aWx0SW5DTWFwKTsKCiAgICBpZiAoY01hcC5udW1Db2Rlc3BhY2VSYW5nZXMgPT09IDApIHsKICAgICAgY29uc3QgdXNlQ29kZXNwYWNlUmFuZ2VzID0gY01hcC51c2VDTWFwLmNvZGVzcGFjZVJhbmdlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXNlQ29kZXNwYWNlUmFuZ2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY01hcC5jb2Rlc3BhY2VSYW5nZXNbaV0gPSB1c2VDb2Rlc3BhY2VSYW5nZXNbaV0uc2xpY2UoKTsKICAgICAgfQoKICAgICAgY01hcC5udW1Db2Rlc3BhY2VSYW5nZXMgPSBjTWFwLnVzZUNNYXAubnVtQ29kZXNwYWNlUmFuZ2VzOwogICAgfQoKICAgIGNNYXAudXNlQ01hcC5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgIGlmICghY01hcC5jb250YWlucyhrZXkpKSB7CiAgICAgICAgY01hcC5tYXBPbmUoa2V5LCBjTWFwLnVzZUNNYXAubG9va3VwKGtleSkpOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiBjTWFwOwogIH0KCiAgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQnVpbHRJbkNNYXAobmFtZSwgZmV0Y2hCdWlsdEluQ01hcCkgewogICAgaWYgKG5hbWUgPT09ICJJZGVudGl0eS1IIikgewogICAgICByZXR1cm4gbmV3IElkZW50aXR5Q01hcChmYWxzZSwgMik7CiAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICJJZGVudGl0eS1WIikgewogICAgICByZXR1cm4gbmV3IElkZW50aXR5Q01hcCh0cnVlLCAyKTsKICAgIH0KCiAgICBpZiAoIUJVSUxUX0lOX0NNQVBTLmluY2x1ZGVzKG5hbWUpKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiVW5rbm93biBDTWFwIG5hbWU6ICIgKyBuYW1lKTsKICAgIH0KCiAgICBpZiAoIWZldGNoQnVpbHRJbkNNYXApIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJCdWlsdC1pbiBDTWFwIHBhcmFtZXRlcnMgYXJlIG5vdCBwcm92aWRlZC4iKTsKICAgIH0KCiAgICBjb25zdCB7CiAgICAgIGNNYXBEYXRhLAogICAgICBjb21wcmVzc2lvblR5cGUKICAgIH0gPSBhd2FpdCBmZXRjaEJ1aWx0SW5DTWFwKG5hbWUpOwogICAgY29uc3QgY01hcCA9IG5ldyBDTWFwKHRydWUpOwoKICAgIGlmIChjb21wcmVzc2lvblR5cGUgPT09IF91dGlsLkNNYXBDb21wcmVzc2lvblR5cGUuQklOQVJZKSB7CiAgICAgIHJldHVybiBuZXcgQmluYXJ5Q01hcFJlYWRlcigpLnByb2Nlc3MoY01hcERhdGEsIGNNYXAsIHVzZUNNYXAgPT4gewogICAgICAgIHJldHVybiBleHRlbmRDTWFwKGNNYXAsIGZldGNoQnVpbHRJbkNNYXAsIHVzZUNNYXApOwogICAgICB9KTsKICAgIH0KCiAgICBpZiAoY29tcHJlc3Npb25UeXBlID09PSBfdXRpbC5DTWFwQ29tcHJlc3Npb25UeXBlLk5PTkUpIHsKICAgICAgY29uc3QgbGV4ZXIgPSBuZXcgX3BhcnNlci5MZXhlcihuZXcgX3N0cmVhbS5TdHJlYW0oY01hcERhdGEpKTsKICAgICAgcmV0dXJuIHBhcnNlQ01hcChjTWFwLCBsZXhlciwgZmV0Y2hCdWlsdEluQ01hcCwgbnVsbCk7CiAgICB9CgogICAgdGhyb3cgbmV3IEVycm9yKCJUT0RPOiBPbmx5IEJJTkFSWS9OT05FIENNYXAgY29tcHJlc3Npb24gaXMgY3VycmVudGx5IHN1cHBvcnRlZC4iKTsKICB9CgogIHJldHVybiB7CiAgICBhc3luYyBjcmVhdGUocGFyYW1zKSB7CiAgICAgIGNvbnN0IGVuY29kaW5nID0gcGFyYW1zLmVuY29kaW5nOwogICAgICBjb25zdCBmZXRjaEJ1aWx0SW5DTWFwID0gcGFyYW1zLmZldGNoQnVpbHRJbkNNYXA7CiAgICAgIGNvbnN0IHVzZUNNYXAgPSBwYXJhbXMudXNlQ01hcDsKCiAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICByZXR1cm4gY3JlYXRlQnVpbHRJbkNNYXAoZW5jb2RpbmcubmFtZSwgZmV0Y2hCdWlsdEluQ01hcCk7CiAgICAgIH0gZWxzZSBpZiAoZW5jb2RpbmcgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgIGNvbnN0IHBhcnNlZENNYXAgPSBhd2FpdCBwYXJzZUNNYXAobmV3IENNYXAoKSwgbmV3IF9wYXJzZXIuTGV4ZXIoZW5jb2RpbmcpLCBmZXRjaEJ1aWx0SW5DTWFwLCB1c2VDTWFwKTsKCiAgICAgICAgaWYgKHBhcnNlZENNYXAuaXNJZGVudGl0eUNNYXApIHsKICAgICAgICAgIHJldHVybiBjcmVhdGVCdWlsdEluQ01hcChwYXJzZWRDTWFwLm5hbWUsIGZldGNoQnVpbHRJbkNNYXApOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHBhcnNlZENNYXA7CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBFcnJvcigiRW5jb2RpbmcgcmVxdWlyZWQuIik7CiAgICB9CgogIH07Cn0oKTsKCmV4cG9ydHMuQ01hcEZhY3RvcnkgPSBDTWFwRmFjdG9yeTsKCi8qKiovIH0pLAovKiAxNDIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlBhcnNlciA9IGV4cG9ydHMuTGluZWFyaXphdGlvbiA9IGV4cG9ydHMuTGV4ZXIgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKdmFyIF9hc2NpaV84NV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0Myk7Cgp2YXIgX2FzY2lpX2hleF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0NSk7Cgp2YXIgX2NjaXR0X3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ2KTsKCnZhciBfZmxhdGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDgpOwoKdmFyIF9qYmlnMl9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0OSk7Cgp2YXIgX2pwZWdfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNTIpOwoKdmFyIF9qcHhfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNTQpOwoKdmFyIF9sendfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNTYpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzNSk7Cgp2YXIgX3ByZWRpY3Rvcl9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE1Nyk7Cgp2YXIgX3J1bl9sZW5ndGhfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNTgpOwoKY29uc3QgTUFYX0xFTkdUSF9UT19DQUNIRSA9IDEwMDA7CmNvbnN0IE1BWF9BRExFUjMyX0xFTkdUSCA9IDU1NTI7CgpmdW5jdGlvbiBjb21wdXRlQWRsZXIzMihieXRlcykgewogIGNvbnN0IGJ5dGVzTGVuZ3RoID0gYnl0ZXMubGVuZ3RoOwogIGxldCBhID0gMSwKICAgICAgYiA9IDA7CgogIGZvciAobGV0IGkgPSAwOyBpIDwgYnl0ZXNMZW5ndGg7ICsraSkgewogICAgYSArPSBieXRlc1tpXSAmIDB4ZmY7CiAgICBiICs9IGE7CiAgfQoKICByZXR1cm4gYiAlIDY1NTIxIDw8IDE2IHwgYSAlIDY1NTIxOwp9CgpjbGFzcyBQYXJzZXIgewogIGNvbnN0cnVjdG9yKF9yZWYpIHsKICAgIGxldCB7CiAgICAgIGxleGVyLAogICAgICB4cmVmLAogICAgICBhbGxvd1N0cmVhbXMgPSBmYWxzZSwKICAgICAgcmVjb3ZlcnlNb2RlID0gZmFsc2UKICAgIH0gPSBfcmVmOwogICAgdGhpcy5sZXhlciA9IGxleGVyOwogICAgdGhpcy54cmVmID0geHJlZjsKICAgIHRoaXMuYWxsb3dTdHJlYW1zID0gYWxsb3dTdHJlYW1zOwogICAgdGhpcy5yZWNvdmVyeU1vZGUgPSByZWNvdmVyeU1vZGU7CiAgICB0aGlzLmltYWdlQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy5yZWZpbGwoKTsKICB9CgogIHJlZmlsbCgpIHsKICAgIHRoaXMuYnVmMSA9IHRoaXMubGV4ZXIuZ2V0T2JqKCk7CiAgICB0aGlzLmJ1ZjIgPSB0aGlzLmxleGVyLmdldE9iaigpOwogIH0KCiAgc2hpZnQoKSB7CiAgICBpZiAodGhpcy5idWYyIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuQ21kICYmIHRoaXMuYnVmMi5jbWQgPT09ICJJRCIpIHsKICAgICAgdGhpcy5idWYxID0gdGhpcy5idWYyOwogICAgICB0aGlzLmJ1ZjIgPSBudWxsOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5idWYxID0gdGhpcy5idWYyOwogICAgICB0aGlzLmJ1ZjIgPSB0aGlzLmxleGVyLmdldE9iaigpOwogICAgfQogIH0KCiAgdHJ5U2hpZnQoKSB7CiAgICB0cnkgewogICAgICB0aGlzLnNoaWZ0KCk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBjYXRjaCAoZSkgewogICAgICBpZiAoZSBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgdGhyb3cgZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KCiAgZ2V0T2JqKCkgewogICAgbGV0IGNpcGhlclRyYW5zZm9ybSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbnVsbDsKICAgIGNvbnN0IGJ1ZjEgPSB0aGlzLmJ1ZjE7CiAgICB0aGlzLnNoaWZ0KCk7CgogICAgaWYgKGJ1ZjEgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5DbWQpIHsKICAgICAgc3dpdGNoIChidWYxLmNtZCkgewogICAgICAgIGNhc2UgIkJJIjoKICAgICAgICAgIHJldHVybiB0aGlzLm1ha2VJbmxpbmVJbWFnZShjaXBoZXJUcmFuc2Zvcm0pOwoKICAgICAgICBjYXNlICJbIjoKICAgICAgICAgIGNvbnN0IGFycmF5ID0gW107CgogICAgICAgICAgd2hpbGUgKCEoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKHRoaXMuYnVmMSwgIl0iKSAmJiB0aGlzLmJ1ZjEgIT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgICAgICBhcnJheS5wdXNoKHRoaXMuZ2V0T2JqKGNpcGhlclRyYW5zZm9ybSkpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLmJ1ZjEgPT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgICAgICBpZiAodGhpcy5yZWNvdmVyeU1vZGUpIHsKICAgICAgICAgICAgICByZXR1cm4gYXJyYXk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5QYXJzZXJFT0ZFeGNlcHRpb24oIkVuZCBvZiBmaWxlIGluc2lkZSBhcnJheS4iKTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnNoaWZ0KCk7CiAgICAgICAgICByZXR1cm4gYXJyYXk7CgogICAgICAgIGNhc2UgIjw8IjoKICAgICAgICAgIGNvbnN0IGRpY3QgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh0aGlzLnhyZWYpOwoKICAgICAgICAgIHdoaWxlICghKDAsIF9wcmltaXRpdmVzLmlzQ21kKSh0aGlzLmJ1ZjEsICI+PiIpICYmIHRoaXMuYnVmMSAhPT0gX3ByaW1pdGl2ZXMuRU9GKSB7CiAgICAgICAgICAgIGlmICghKHRoaXMuYnVmMSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJNYWxmb3JtZWQgZGljdGlvbmFyeToga2V5IG11c3QgYmUgYSBuYW1lIG9iamVjdCIpOwogICAgICAgICAgICAgIHRoaXMuc2hpZnQoKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5idWYxLm5hbWU7CiAgICAgICAgICAgIHRoaXMuc2hpZnQoKTsKCiAgICAgICAgICAgIGlmICh0aGlzLmJ1ZjEgPT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBkaWN0LnNldChrZXksIHRoaXMuZ2V0T2JqKGNpcGhlclRyYW5zZm9ybSkpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLmJ1ZjEgPT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgICAgICBpZiAodGhpcy5yZWNvdmVyeU1vZGUpIHsKICAgICAgICAgICAgICByZXR1cm4gZGljdDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLlBhcnNlckVPRkV4Y2VwdGlvbigiRW5kIG9mIGZpbGUgaW5zaWRlIGRpY3Rpb25hcnkuIik7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkodGhpcy5idWYyLCAic3RyZWFtIikpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWxsb3dTdHJlYW1zID8gdGhpcy5tYWtlU3RyZWFtKGRpY3QsIGNpcGhlclRyYW5zZm9ybSkgOiBkaWN0OwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuc2hpZnQoKTsKICAgICAgICAgIHJldHVybiBkaWN0OwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuIGJ1ZjE7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihidWYxKSkgewogICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcih0aGlzLmJ1ZjEpICYmICgwLCBfcHJpbWl0aXZlcy5pc0NtZCkodGhpcy5idWYyLCAiUiIpKSB7CiAgICAgICAgY29uc3QgcmVmID0gX3ByaW1pdGl2ZXMuUmVmLmdldChidWYxLCB0aGlzLmJ1ZjEpOwoKICAgICAgICB0aGlzLnNoaWZ0KCk7CiAgICAgICAgdGhpcy5zaGlmdCgpOwogICAgICAgIHJldHVybiByZWY7CiAgICAgIH0KCiAgICAgIHJldHVybiBidWYxOwogICAgfQoKICAgIGlmICh0eXBlb2YgYnVmMSA9PT0gInN0cmluZyIpIHsKICAgICAgaWYgKGNpcGhlclRyYW5zZm9ybSkgewogICAgICAgIHJldHVybiBjaXBoZXJUcmFuc2Zvcm0uZGVjcnlwdFN0cmluZyhidWYxKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGJ1ZjE7CiAgICB9CgogICAgcmV0dXJuIGJ1ZjE7CiAgfQoKICBmaW5kRGVmYXVsdElubGluZVN0cmVhbUVuZChzdHJlYW0pIHsKICAgIGNvbnN0IEUgPSAweDQ1LAogICAgICAgICAgSSA9IDB4NDksCiAgICAgICAgICBTUEFDRSA9IDB4MjAsCiAgICAgICAgICBMRiA9IDB4YSwKICAgICAgICAgIENSID0gMHhkLAogICAgICAgICAgTlVMID0gMHgwOwogICAgY29uc3QgbGV4ZXIgPSB0aGlzLmxleGVyLAogICAgICAgICAgc3RhcnRQb3MgPSBzdHJlYW0ucG9zLAogICAgICAgICAgbiA9IDEwOwogICAgbGV0IHN0YXRlID0gMCwKICAgICAgICBjaCwKICAgICAgICBtYXliZUVJUG9zOwoKICAgIHdoaWxlICgoY2ggPSBzdHJlYW0uZ2V0Qnl0ZSgpKSAhPT0gLTEpIHsKICAgICAgaWYgKHN0YXRlID09PSAwKSB7CiAgICAgICAgc3RhdGUgPSBjaCA9PT0gRSA/IDEgOiAwOwogICAgICB9IGVsc2UgaWYgKHN0YXRlID09PSAxKSB7CiAgICAgICAgc3RhdGUgPSBjaCA9PT0gSSA/IDIgOiAwOwogICAgICB9IGVsc2UgewogICAgICAgICgwLCBfdXRpbC5hc3NlcnQpKHN0YXRlID09PSAyLCAiZmluZERlZmF1bHRJbmxpbmVTdHJlYW1FbmQgLSBpbnZhbGlkIHN0YXRlLiIpOwoKICAgICAgICBpZiAoY2ggPT09IFNQQUNFIHx8IGNoID09PSBMRiB8fCBjaCA9PT0gQ1IpIHsKICAgICAgICAgIG1heWJlRUlQb3MgPSBzdHJlYW0ucG9zOwogICAgICAgICAgY29uc3QgZm9sbG93aW5nQnl0ZXMgPSBzdHJlYW0ucGVla0J5dGVzKG4pOwoKICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGZvbGxvd2luZ0J5dGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgICAgY2ggPSBmb2xsb3dpbmdCeXRlc1tpXTsKCiAgICAgICAgICAgIGlmIChjaCA9PT0gTlVMICYmIGZvbGxvd2luZ0J5dGVzW2kgKyAxXSAhPT0gTlVMKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChjaCAhPT0gTEYgJiYgY2ggIT09IENSICYmIChjaCA8IFNQQUNFIHx8IGNoID4gMHg3ZikpIHsKICAgICAgICAgICAgICBzdGF0ZSA9IDA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoc3RhdGUgIT09IDIpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGxleGVyLmtub3duQ29tbWFuZHMpIHsKICAgICAgICAgICAgY29uc3QgbmV4dE9iaiA9IGxleGVyLnBlZWtPYmooKTsKCiAgICAgICAgICAgIGlmIChuZXh0T2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuQ21kICYmICFsZXhlci5rbm93bkNvbW1hbmRzW25leHRPYmouY21kXSkgewogICAgICAgICAgICAgIHN0YXRlID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJmaW5kRGVmYXVsdElubGluZVN0cmVhbUVuZCAtIGBsZXhlci5rbm93bkNvbW1hbmRzYCBpcyB1bmRlZmluZWQuIik7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHN0YXRlID09PSAyKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdGF0ZSA9IDA7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKGNoID09PSAtMSkgewogICAgICAoMCwgX3V0aWwud2FybikoImZpbmREZWZhdWx0SW5saW5lU3RyZWFtRW5kOiAiICsgIlJlYWNoZWQgdGhlIGVuZCBvZiB0aGUgc3RyZWFtIHdpdGhvdXQgZmluZGluZyBhIHZhbGlkIEVJIG1hcmtlciIpOwoKICAgICAgaWYgKG1heWJlRUlQb3MpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoJy4uLiB0cnlpbmcgdG8gcmVjb3ZlciBieSB1c2luZyB0aGUgbGFzdCAiRUkiIG9jY3VycmVuY2UuJyk7CiAgICAgICAgc3RyZWFtLnNraXAoLShzdHJlYW0ucG9zIC0gbWF5YmVFSVBvcykpOwogICAgICB9CiAgICB9CgogICAgbGV0IGVuZE9mZnNldCA9IDQ7CiAgICBzdHJlYW0uc2tpcCgtZW5kT2Zmc2V0KTsKICAgIGNoID0gc3RyZWFtLnBlZWtCeXRlKCk7CiAgICBzdHJlYW0uc2tpcChlbmRPZmZzZXQpOwoKICAgIGlmICghKDAsIF9jb3JlX3V0aWxzLmlzV2hpdGVTcGFjZSkoY2gpKSB7CiAgICAgIGVuZE9mZnNldC0tOwogICAgfQoKICAgIHJldHVybiBzdHJlYW0ucG9zIC0gZW5kT2Zmc2V0IC0gc3RhcnRQb3M7CiAgfQoKICBmaW5kRENURGVjb2RlSW5saW5lU3RyZWFtRW5kKHN0cmVhbSkgewogICAgY29uc3Qgc3RhcnRQb3MgPSBzdHJlYW0ucG9zOwogICAgbGV0IGZvdW5kRU9JID0gZmFsc2UsCiAgICAgICAgYiwKICAgICAgICBtYXJrZXJMZW5ndGg7CgogICAgd2hpbGUgKChiID0gc3RyZWFtLmdldEJ5dGUoKSkgIT09IC0xKSB7CiAgICAgIGlmIChiICE9PSAweGZmKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHN3aXRjaCAoc3RyZWFtLmdldEJ5dGUoKSkgewogICAgICAgIGNhc2UgMHgwMDoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4ZmY6CiAgICAgICAgICBzdHJlYW0uc2tpcCgtMSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweGQ5OgogICAgICAgICAgZm91bmRFT0kgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHhjMDoKICAgICAgICBjYXNlIDB4YzE6CiAgICAgICAgY2FzZSAweGMyOgogICAgICAgIGNhc2UgMHhjMzoKICAgICAgICBjYXNlIDB4YzU6CiAgICAgICAgY2FzZSAweGM2OgogICAgICAgIGNhc2UgMHhjNzoKICAgICAgICBjYXNlIDB4Yzk6CiAgICAgICAgY2FzZSAweGNhOgogICAgICAgIGNhc2UgMHhjYjoKICAgICAgICBjYXNlIDB4Y2Q6CiAgICAgICAgY2FzZSAweGNlOgogICAgICAgIGNhc2UgMHhjZjoKICAgICAgICBjYXNlIDB4YzQ6CiAgICAgICAgY2FzZSAweGNjOgogICAgICAgIGNhc2UgMHhkYToKICAgICAgICBjYXNlIDB4ZGI6CiAgICAgICAgY2FzZSAweGRjOgogICAgICAgIGNhc2UgMHhkZDoKICAgICAgICBjYXNlIDB4ZGU6CiAgICAgICAgY2FzZSAweGRmOgogICAgICAgIGNhc2UgMHhlMDoKICAgICAgICBjYXNlIDB4ZTE6CiAgICAgICAgY2FzZSAweGUyOgogICAgICAgIGNhc2UgMHhlMzoKICAgICAgICBjYXNlIDB4ZTQ6CiAgICAgICAgY2FzZSAweGU1OgogICAgICAgIGNhc2UgMHhlNjoKICAgICAgICBjYXNlIDB4ZTc6CiAgICAgICAgY2FzZSAweGU4OgogICAgICAgIGNhc2UgMHhlOToKICAgICAgICBjYXNlIDB4ZWE6CiAgICAgICAgY2FzZSAweGViOgogICAgICAgIGNhc2UgMHhlYzoKICAgICAgICBjYXNlIDB4ZWQ6CiAgICAgICAgY2FzZSAweGVlOgogICAgICAgIGNhc2UgMHhlZjoKICAgICAgICBjYXNlIDB4ZmU6CiAgICAgICAgICBtYXJrZXJMZW5ndGggPSBzdHJlYW0uZ2V0VWludDE2KCk7CgogICAgICAgICAgaWYgKG1hcmtlckxlbmd0aCA+IDIpIHsKICAgICAgICAgICAgc3RyZWFtLnNraXAobWFya2VyTGVuZ3RoIC0gMik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdHJlYW0uc2tpcCgtMik7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmIChmb3VuZEVPSSkgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgY29uc3QgbGVuZ3RoID0gc3RyZWFtLnBvcyAtIHN0YXJ0UG9zOwoKICAgIGlmIChiID09PSAtMSkgewogICAgICAoMCwgX3V0aWwud2FybikoIklubGluZSBEQ1REZWNvZGUgaW1hZ2Ugc3RyZWFtOiAiICsgIkVPSSBtYXJrZXIgbm90IGZvdW5kLCBzZWFyY2hpbmcgZm9yIC9FSS8gaW5zdGVhZC4iKTsKICAgICAgc3RyZWFtLnNraXAoLWxlbmd0aCk7CiAgICAgIHJldHVybiB0aGlzLmZpbmREZWZhdWx0SW5saW5lU3RyZWFtRW5kKHN0cmVhbSk7CiAgICB9CgogICAgdGhpcy5pbmxpbmVTdHJlYW1Ta2lwRUkoc3RyZWFtKTsKICAgIHJldHVybiBsZW5ndGg7CiAgfQoKICBmaW5kQVNDSUk4NURlY29kZUlubGluZVN0cmVhbUVuZChzdHJlYW0pIHsKICAgIGNvbnN0IFRJTERFID0gMHg3ZSwKICAgICAgICAgIEdUID0gMHgzZTsKICAgIGNvbnN0IHN0YXJ0UG9zID0gc3RyZWFtLnBvczsKICAgIGxldCBjaDsKCiAgICB3aGlsZSAoKGNoID0gc3RyZWFtLmdldEJ5dGUoKSkgIT09IC0xKSB7CiAgICAgIGlmIChjaCA9PT0gVElMREUpIHsKICAgICAgICBjb25zdCB0aWxkZVBvcyA9IHN0cmVhbS5wb3M7CiAgICAgICAgY2ggPSBzdHJlYW0ucGVla0J5dGUoKTsKCiAgICAgICAgd2hpbGUgKCgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGNoKSkgewogICAgICAgICAgc3RyZWFtLnNraXAoKTsKICAgICAgICAgIGNoID0gc3RyZWFtLnBlZWtCeXRlKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoY2ggPT09IEdUKSB7CiAgICAgICAgICBzdHJlYW0uc2tpcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RyZWFtLnBvcyA+IHRpbGRlUG9zKSB7CiAgICAgICAgICBjb25zdCBtYXliZUVJID0gc3RyZWFtLnBlZWtCeXRlcygyKTsKCiAgICAgICAgICBpZiAobWF5YmVFSVswXSA9PT0gMHg0NSAmJiBtYXliZUVJWzFdID09PSAweDQ5KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGNvbnN0IGxlbmd0aCA9IHN0cmVhbS5wb3MgLSBzdGFydFBvczsKCiAgICBpZiAoY2ggPT09IC0xKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKSgiSW5saW5lIEFTQ0lJODVEZWNvZGUgaW1hZ2Ugc3RyZWFtOiAiICsgIkVPRCBtYXJrZXIgbm90IGZvdW5kLCBzZWFyY2hpbmcgZm9yIC9FSS8gaW5zdGVhZC4iKTsKICAgICAgc3RyZWFtLnNraXAoLWxlbmd0aCk7CiAgICAgIHJldHVybiB0aGlzLmZpbmREZWZhdWx0SW5saW5lU3RyZWFtRW5kKHN0cmVhbSk7CiAgICB9CgogICAgdGhpcy5pbmxpbmVTdHJlYW1Ta2lwRUkoc3RyZWFtKTsKICAgIHJldHVybiBsZW5ndGg7CiAgfQoKICBmaW5kQVNDSUlIZXhEZWNvZGVJbmxpbmVTdHJlYW1FbmQoc3RyZWFtKSB7CiAgICBjb25zdCBHVCA9IDB4M2U7CiAgICBjb25zdCBzdGFydFBvcyA9IHN0cmVhbS5wb3M7CiAgICBsZXQgY2g7CgogICAgd2hpbGUgKChjaCA9IHN0cmVhbS5nZXRCeXRlKCkpICE9PSAtMSkgewogICAgICBpZiAoY2ggPT09IEdUKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBsZW5ndGggPSBzdHJlYW0ucG9zIC0gc3RhcnRQb3M7CgogICAgaWYgKGNoID09PSAtMSkgewogICAgICAoMCwgX3V0aWwud2FybikoIklubGluZSBBU0NJSUhleERlY29kZSBpbWFnZSBzdHJlYW06ICIgKyAiRU9EIG1hcmtlciBub3QgZm91bmQsIHNlYXJjaGluZyBmb3IgL0VJLyBpbnN0ZWFkLiIpOwogICAgICBzdHJlYW0uc2tpcCgtbGVuZ3RoKTsKICAgICAgcmV0dXJuIHRoaXMuZmluZERlZmF1bHRJbmxpbmVTdHJlYW1FbmQoc3RyZWFtKTsKICAgIH0KCiAgICB0aGlzLmlubGluZVN0cmVhbVNraXBFSShzdHJlYW0pOwogICAgcmV0dXJuIGxlbmd0aDsKICB9CgogIGlubGluZVN0cmVhbVNraXBFSShzdHJlYW0pIHsKICAgIGNvbnN0IEUgPSAweDQ1LAogICAgICAgICAgSSA9IDB4NDk7CiAgICBsZXQgc3RhdGUgPSAwLAogICAgICAgIGNoOwoKICAgIHdoaWxlICgoY2ggPSBzdHJlYW0uZ2V0Qnl0ZSgpKSAhPT0gLTEpIHsKICAgICAgaWYgKHN0YXRlID09PSAwKSB7CiAgICAgICAgc3RhdGUgPSBjaCA9PT0gRSA/IDEgOiAwOwogICAgICB9IGVsc2UgaWYgKHN0YXRlID09PSAxKSB7CiAgICAgICAgc3RhdGUgPSBjaCA9PT0gSSA/IDIgOiAwOwogICAgICB9IGVsc2UgaWYgKHN0YXRlID09PSAyKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICB9CgogIG1ha2VJbmxpbmVJbWFnZShjaXBoZXJUcmFuc2Zvcm0pIHsKICAgIGNvbnN0IGxleGVyID0gdGhpcy5sZXhlcjsKICAgIGNvbnN0IHN0cmVhbSA9IGxleGVyLnN0cmVhbTsKICAgIGNvbnN0IGRpY3QgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh0aGlzLnhyZWYpOwogICAgbGV0IGRpY3RMZW5ndGg7CgogICAgd2hpbGUgKCEoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKHRoaXMuYnVmMSwgIklEIikgJiYgdGhpcy5idWYxICE9PSBfcHJpbWl0aXZlcy5FT0YpIHsKICAgICAgaWYgKCEodGhpcy5idWYxIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkRpY3Rpb25hcnkga2V5IG11c3QgYmUgYSBuYW1lIG9iamVjdCIpOwogICAgICB9CgogICAgICBjb25zdCBrZXkgPSB0aGlzLmJ1ZjEubmFtZTsKICAgICAgdGhpcy5zaGlmdCgpOwoKICAgICAgaWYgKHRoaXMuYnVmMSA9PT0gX3ByaW1pdGl2ZXMuRU9GKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGRpY3Quc2V0KGtleSwgdGhpcy5nZXRPYmooY2lwaGVyVHJhbnNmb3JtKSk7CiAgICB9CgogICAgaWYgKGxleGVyLmJlZ2luSW5saW5lSW1hZ2VQb3MgIT09IC0xKSB7CiAgICAgIGRpY3RMZW5ndGggPSBzdHJlYW0ucG9zIC0gbGV4ZXIuYmVnaW5JbmxpbmVJbWFnZVBvczsKICAgIH0KCiAgICBjb25zdCBmaWx0ZXIgPSBkaWN0LmdldCgiRiIsICJGaWx0ZXIiKTsKICAgIGxldCBmaWx0ZXJOYW1lOwoKICAgIGlmIChmaWx0ZXIgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIGZpbHRlck5hbWUgPSBmaWx0ZXIubmFtZTsKICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShmaWx0ZXIpKSB7CiAgICAgIGNvbnN0IGZpbHRlclplcm8gPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZihmaWx0ZXJbMF0pOwoKICAgICAgaWYgKGZpbHRlclplcm8gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgZmlsdGVyTmFtZSA9IGZpbHRlclplcm8ubmFtZTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IHN0YXJ0UG9zID0gc3RyZWFtLnBvczsKICAgIGxldCBsZW5ndGg7CgogICAgc3dpdGNoIChmaWx0ZXJOYW1lKSB7CiAgICAgIGNhc2UgIkRDVCI6CiAgICAgIGNhc2UgIkRDVERlY29kZSI6CiAgICAgICAgbGVuZ3RoID0gdGhpcy5maW5kRENURGVjb2RlSW5saW5lU3RyZWFtRW5kKHN0cmVhbSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJBODUiOgogICAgICBjYXNlICJBU0NJSTg1RGVjb2RlIjoKICAgICAgICBsZW5ndGggPSB0aGlzLmZpbmRBU0NJSTg1RGVjb2RlSW5saW5lU3RyZWFtRW5kKHN0cmVhbSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJBSHgiOgogICAgICBjYXNlICJBU0NJSUhleERlY29kZSI6CiAgICAgICAgbGVuZ3RoID0gdGhpcy5maW5kQVNDSUlIZXhEZWNvZGVJbmxpbmVTdHJlYW1FbmQoc3RyZWFtKTsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgbGVuZ3RoID0gdGhpcy5maW5kRGVmYXVsdElubGluZVN0cmVhbUVuZChzdHJlYW0pOwogICAgfQoKICAgIGxldCBpbWFnZVN0cmVhbSA9IHN0cmVhbS5tYWtlU3ViU3RyZWFtKHN0YXJ0UG9zLCBsZW5ndGgsIGRpY3QpOwogICAgbGV0IGNhY2hlS2V5OwoKICAgIGlmIChsZW5ndGggPCBNQVhfTEVOR1RIX1RPX0NBQ0hFICYmIGRpY3RMZW5ndGggPCBNQVhfQURMRVIzMl9MRU5HVEgpIHsKICAgICAgY29uc3QgaW1hZ2VCeXRlcyA9IGltYWdlU3RyZWFtLmdldEJ5dGVzKCk7CiAgICAgIGltYWdlU3RyZWFtLnJlc2V0KCk7CiAgICAgIGNvbnN0IGluaXRpYWxTdHJlYW1Qb3MgPSBzdHJlYW0ucG9zOwogICAgICBzdHJlYW0ucG9zID0gbGV4ZXIuYmVnaW5JbmxpbmVJbWFnZVBvczsKICAgICAgY29uc3QgZGljdEJ5dGVzID0gc3RyZWFtLmdldEJ5dGVzKGRpY3RMZW5ndGgpOwogICAgICBzdHJlYW0ucG9zID0gaW5pdGlhbFN0cmVhbVBvczsKICAgICAgY2FjaGVLZXkgPSBjb21wdXRlQWRsZXIzMihpbWFnZUJ5dGVzKSArICJfIiArIGNvbXB1dGVBZGxlcjMyKGRpY3RCeXRlcyk7CiAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB0aGlzLmltYWdlQ2FjaGVbY2FjaGVLZXldOwoKICAgICAgaWYgKGNhY2hlRW50cnkgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuYnVmMiA9IF9wcmltaXRpdmVzLkNtZC5nZXQoIkVJIik7CiAgICAgICAgdGhpcy5zaGlmdCgpOwogICAgICAgIGNhY2hlRW50cnkucmVzZXQoKTsKICAgICAgICByZXR1cm4gY2FjaGVFbnRyeTsKICAgICAgfQogICAgfQoKICAgIGlmIChjaXBoZXJUcmFuc2Zvcm0pIHsKICAgICAgaW1hZ2VTdHJlYW0gPSBjaXBoZXJUcmFuc2Zvcm0uY3JlYXRlU3RyZWFtKGltYWdlU3RyZWFtLCBsZW5ndGgpOwogICAgfQoKICAgIGltYWdlU3RyZWFtID0gdGhpcy5maWx0ZXIoaW1hZ2VTdHJlYW0sIGRpY3QsIGxlbmd0aCk7CiAgICBpbWFnZVN0cmVhbS5kaWN0ID0gZGljdDsKCiAgICBpZiAoY2FjaGVLZXkgIT09IHVuZGVmaW5lZCkgewogICAgICBpbWFnZVN0cmVhbS5jYWNoZUtleSA9IGBpbmxpbmVfJHtsZW5ndGh9XyR7Y2FjaGVLZXl9YDsKICAgICAgdGhpcy5pbWFnZUNhY2hlW2NhY2hlS2V5XSA9IGltYWdlU3RyZWFtOwogICAgfQoKICAgIHRoaXMuYnVmMiA9IF9wcmltaXRpdmVzLkNtZC5nZXQoIkVJIik7CiAgICB0aGlzLnNoaWZ0KCk7CiAgICByZXR1cm4gaW1hZ2VTdHJlYW07CiAgfQoKICBfZmluZFN0cmVhbUxlbmd0aChzdGFydFBvcywgc2lnbmF0dXJlKSB7CiAgICBjb25zdCB7CiAgICAgIHN0cmVhbQogICAgfSA9IHRoaXMubGV4ZXI7CiAgICBzdHJlYW0ucG9zID0gc3RhcnRQb3M7CiAgICBjb25zdCBTQ0FOX0JMT0NLX0xFTkdUSCA9IDIwNDg7CiAgICBjb25zdCBzaWduYXR1cmVMZW5ndGggPSBzaWduYXR1cmUubGVuZ3RoOwoKICAgIHdoaWxlIChzdHJlYW0ucG9zIDwgc3RyZWFtLmVuZCkgewogICAgICBjb25zdCBzY2FuQnl0ZXMgPSBzdHJlYW0ucGVla0J5dGVzKFNDQU5fQkxPQ0tfTEVOR1RIKTsKICAgICAgY29uc3Qgc2Nhbkxlbmd0aCA9IHNjYW5CeXRlcy5sZW5ndGggLSBzaWduYXR1cmVMZW5ndGg7CgogICAgICBpZiAoc2Nhbkxlbmd0aCA8PSAwKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGxldCBwb3MgPSAwOwoKICAgICAgd2hpbGUgKHBvcyA8IHNjYW5MZW5ndGgpIHsKICAgICAgICBsZXQgaiA9IDA7CgogICAgICAgIHdoaWxlIChqIDwgc2lnbmF0dXJlTGVuZ3RoICYmIHNjYW5CeXRlc1twb3MgKyBqXSA9PT0gc2lnbmF0dXJlW2pdKSB7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBpZiAoaiA+PSBzaWduYXR1cmVMZW5ndGgpIHsKICAgICAgICAgIHN0cmVhbS5wb3MgKz0gcG9zOwogICAgICAgICAgcmV0dXJuIHN0cmVhbS5wb3MgLSBzdGFydFBvczsKICAgICAgICB9CgogICAgICAgIHBvcysrOwogICAgICB9CgogICAgICBzdHJlYW0ucG9zICs9IHNjYW5MZW5ndGg7CiAgICB9CgogICAgcmV0dXJuIC0xOwogIH0KCiAgbWFrZVN0cmVhbShkaWN0LCBjaXBoZXJUcmFuc2Zvcm0pIHsKICAgIGNvbnN0IGxleGVyID0gdGhpcy5sZXhlcjsKICAgIGxldCBzdHJlYW0gPSBsZXhlci5zdHJlYW07CiAgICBsZXhlci5za2lwVG9OZXh0TGluZSgpOwogICAgY29uc3Qgc3RhcnRQb3MgPSBzdHJlYW0ucG9zIC0gMTsKICAgIGxldCBsZW5ndGggPSBkaWN0LmdldCgiTGVuZ3RoIik7CgogICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGxlbmd0aCkpIHsKICAgICAgKDAsIF91dGlsLmluZm8pKGBCYWQgbGVuZ3RoICIke2xlbmd0aCAmJiBsZW5ndGgudG9TdHJpbmcoKX0iIGluIHN0cmVhbS5gKTsKICAgICAgbGVuZ3RoID0gMDsKICAgIH0KCiAgICBzdHJlYW0ucG9zID0gc3RhcnRQb3MgKyBsZW5ndGg7CiAgICBsZXhlci5uZXh0Q2hhcigpOwoKICAgIGlmICh0aGlzLnRyeVNoaWZ0KCkgJiYgKDAsIF9wcmltaXRpdmVzLmlzQ21kKSh0aGlzLmJ1ZjIsICJlbmRzdHJlYW0iKSkgewogICAgICB0aGlzLnNoaWZ0KCk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBFTkRTVFJFQU1fU0lHTkFUVVJFID0gbmV3IFVpbnQ4QXJyYXkoWzB4NjUsIDB4NmUsIDB4NjQsIDB4NzMsIDB4NzQsIDB4NzIsIDB4NjUsIDB4NjEsIDB4NmRdKTsKCiAgICAgIGxldCBhY3R1YWxMZW5ndGggPSB0aGlzLl9maW5kU3RyZWFtTGVuZ3RoKHN0YXJ0UG9zLCBFTkRTVFJFQU1fU0lHTkFUVVJFKTsKCiAgICAgIGlmIChhY3R1YWxMZW5ndGggPCAwKSB7CiAgICAgICAgY29uc3QgTUFYX1RSVU5DQVRJT04gPSAxOwoKICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBNQVhfVFJVTkNBVElPTjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBlbmQgPSBFTkRTVFJFQU1fU0lHTkFUVVJFLmxlbmd0aCAtIGk7CiAgICAgICAgICBjb25zdCBUUlVOQ0FURURfU0lHTkFUVVJFID0gRU5EU1RSRUFNX1NJR05BVFVSRS5zbGljZSgwLCBlbmQpOwoKICAgICAgICAgIGNvbnN0IG1heWJlTGVuZ3RoID0gdGhpcy5fZmluZFN0cmVhbUxlbmd0aChzdGFydFBvcywgVFJVTkNBVEVEX1NJR05BVFVSRSk7CgogICAgICAgICAgaWYgKG1heWJlTGVuZ3RoID49IDApIHsKICAgICAgICAgICAgY29uc3QgbGFzdEJ5dGUgPSBzdHJlYW0ucGVla0J5dGVzKGVuZCArIDEpW2VuZF07CgogICAgICAgICAgICBpZiAoISgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGxhc3RCeXRlKSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoYEZvdW5kICIkeygwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShUUlVOQ0FURURfU0lHTkFUVVJFKX0iIHdoZW4gYCArICJzZWFyY2hpbmcgZm9yIGVuZHN0cmVhbSBjb21tYW5kLiIpOwogICAgICAgICAgICBhY3R1YWxMZW5ndGggPSBtYXliZUxlbmd0aDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoYWN0dWFsTGVuZ3RoIDwgMCkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJNaXNzaW5nIGVuZHN0cmVhbSBjb21tYW5kLiIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgbGVuZ3RoID0gYWN0dWFsTGVuZ3RoOwogICAgICBsZXhlci5uZXh0Q2hhcigpOwogICAgICB0aGlzLnNoaWZ0KCk7CiAgICAgIHRoaXMuc2hpZnQoKTsKICAgIH0KCiAgICB0aGlzLnNoaWZ0KCk7CiAgICBzdHJlYW0gPSBzdHJlYW0ubWFrZVN1YlN0cmVhbShzdGFydFBvcywgbGVuZ3RoLCBkaWN0KTsKCiAgICBpZiAoY2lwaGVyVHJhbnNmb3JtKSB7CiAgICAgIHN0cmVhbSA9IGNpcGhlclRyYW5zZm9ybS5jcmVhdGVTdHJlYW0oc3RyZWFtLCBsZW5ndGgpOwogICAgfQoKICAgIHN0cmVhbSA9IHRoaXMuZmlsdGVyKHN0cmVhbSwgZGljdCwgbGVuZ3RoKTsKICAgIHN0cmVhbS5kaWN0ID0gZGljdDsKICAgIHJldHVybiBzdHJlYW07CiAgfQoKICBmaWx0ZXIoc3RyZWFtLCBkaWN0LCBsZW5ndGgpIHsKICAgIGxldCBmaWx0ZXIgPSBkaWN0LmdldCgiRiIsICJGaWx0ZXIiKTsKICAgIGxldCBwYXJhbXMgPSBkaWN0LmdldCgiRFAiLCAiRGVjb2RlUGFybXMiKTsKCiAgICBpZiAoZmlsdGVyIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXJhbXMpKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCIvRGVjb2RlUGFybXMgc2hvdWxkIG5vdCBiZSBhbiBBcnJheSwgd2hlbiAvRmlsdGVyIGlzIGEgTmFtZS4iKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMubWFrZUZpbHRlcihzdHJlYW0sIGZpbHRlci5uYW1lLCBsZW5ndGgsIHBhcmFtcyk7CiAgICB9CgogICAgbGV0IG1heWJlTGVuZ3RoID0gbGVuZ3RoOwoKICAgIGlmIChBcnJheS5pc0FycmF5KGZpbHRlcikpIHsKICAgICAgY29uc3QgZmlsdGVyQXJyYXkgPSBmaWx0ZXI7CiAgICAgIGNvbnN0IHBhcmFtc0FycmF5ID0gcGFyYW1zOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZmlsdGVyQXJyYXkubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICAgIGZpbHRlciA9IHRoaXMueHJlZi5mZXRjaElmUmVmKGZpbHRlckFycmF5W2ldKTsKCiAgICAgICAgaWYgKCEoZmlsdGVyIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgQmFkIGZpbHRlciBuYW1lICIke2ZpbHRlcn0iYCk7CiAgICAgICAgfQoKICAgICAgICBwYXJhbXMgPSBudWxsOwoKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXJhbXNBcnJheSkgJiYgaSBpbiBwYXJhbXNBcnJheSkgewogICAgICAgICAgcGFyYW1zID0gdGhpcy54cmVmLmZldGNoSWZSZWYocGFyYW1zQXJyYXlbaV0pOwogICAgICAgIH0KCiAgICAgICAgc3RyZWFtID0gdGhpcy5tYWtlRmlsdGVyKHN0cmVhbSwgZmlsdGVyLm5hbWUsIG1heWJlTGVuZ3RoLCBwYXJhbXMpOwogICAgICAgIG1heWJlTGVuZ3RoID0gbnVsbDsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBzdHJlYW07CiAgfQoKICBtYWtlRmlsdGVyKHN0cmVhbSwgbmFtZSwgbWF5YmVMZW5ndGgsIHBhcmFtcykgewogICAgaWYgKG1heWJlTGVuZ3RoID09PSAwKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgRW1wdHkgIiR7bmFtZX0iIHN0cmVhbS5gKTsKICAgICAgcmV0dXJuIG5ldyBfc3RyZWFtLk51bGxTdHJlYW0oKTsKICAgIH0KCiAgICBjb25zdCB4cmVmU3RhdHMgPSB0aGlzLnhyZWYuc3RhdHM7CgogICAgdHJ5IHsKICAgICAgc3dpdGNoIChuYW1lKSB7CiAgICAgICAgY2FzZSAiRmwiOgogICAgICAgIGNhc2UgIkZsYXRlRGVjb2RlIjoKICAgICAgICAgIHhyZWZTdGF0cy5hZGRTdHJlYW1UeXBlKF91dGlsLlN0cmVhbVR5cGUuRkxBVEUpOwoKICAgICAgICAgIGlmIChwYXJhbXMpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBfcHJlZGljdG9yX3N0cmVhbS5QcmVkaWN0b3JTdHJlYW0obmV3IF9mbGF0ZV9zdHJlYW0uRmxhdGVTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCksIG1heWJlTGVuZ3RoLCBwYXJhbXMpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBuZXcgX2ZsYXRlX3N0cmVhbS5GbGF0ZVN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoKTsKCiAgICAgICAgY2FzZSAiTFpXIjoKICAgICAgICBjYXNlICJMWldEZWNvZGUiOgogICAgICAgICAgeHJlZlN0YXRzLmFkZFN0cmVhbVR5cGUoX3V0aWwuU3RyZWFtVHlwZS5MWlcpOwogICAgICAgICAgbGV0IGVhcmx5Q2hhbmdlID0gMTsKCiAgICAgICAgICBpZiAocGFyYW1zKSB7CiAgICAgICAgICAgIGlmIChwYXJhbXMuaGFzKCJFYXJseUNoYW5nZSIpKSB7CiAgICAgICAgICAgICAgZWFybHlDaGFuZ2UgPSBwYXJhbXMuZ2V0KCJFYXJseUNoYW5nZSIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gbmV3IF9wcmVkaWN0b3Jfc3RyZWFtLlByZWRpY3RvclN0cmVhbShuZXcgX2x6d19zdHJlYW0uTFpXU3RyZWFtKHN0cmVhbSwgbWF5YmVMZW5ndGgsIGVhcmx5Q2hhbmdlKSwgbWF5YmVMZW5ndGgsIHBhcmFtcyk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIG5ldyBfbHp3X3N0cmVhbS5MWldTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCwgZWFybHlDaGFuZ2UpOwoKICAgICAgICBjYXNlICJEQ1QiOgogICAgICAgIGNhc2UgIkRDVERlY29kZSI6CiAgICAgICAgICB4cmVmU3RhdHMuYWRkU3RyZWFtVHlwZShfdXRpbC5TdHJlYW1UeXBlLkRDVCk7CiAgICAgICAgICByZXR1cm4gbmV3IF9qcGVnX3N0cmVhbS5KcGVnU3RyZWFtKHN0cmVhbSwgbWF5YmVMZW5ndGgsIHBhcmFtcyk7CgogICAgICAgIGNhc2UgIkpQWCI6CiAgICAgICAgY2FzZSAiSlBYRGVjb2RlIjoKICAgICAgICAgIHhyZWZTdGF0cy5hZGRTdHJlYW1UeXBlKF91dGlsLlN0cmVhbVR5cGUuSlBYKTsKICAgICAgICAgIHJldHVybiBuZXcgX2pweF9zdHJlYW0uSnB4U3RyZWFtKHN0cmVhbSwgbWF5YmVMZW5ndGgsIHBhcmFtcyk7CgogICAgICAgIGNhc2UgIkE4NSI6CiAgICAgICAgY2FzZSAiQVNDSUk4NURlY29kZSI6CiAgICAgICAgICB4cmVmU3RhdHMuYWRkU3RyZWFtVHlwZShfdXRpbC5TdHJlYW1UeXBlLkE4NSk7CiAgICAgICAgICByZXR1cm4gbmV3IF9hc2NpaV84NV9zdHJlYW0uQXNjaWk4NVN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoKTsKCiAgICAgICAgY2FzZSAiQUh4IjoKICAgICAgICBjYXNlICJBU0NJSUhleERlY29kZSI6CiAgICAgICAgICB4cmVmU3RhdHMuYWRkU3RyZWFtVHlwZShfdXRpbC5TdHJlYW1UeXBlLkFIWCk7CiAgICAgICAgICByZXR1cm4gbmV3IF9hc2NpaV9oZXhfc3RyZWFtLkFzY2lpSGV4U3RyZWFtKHN0cmVhbSwgbWF5YmVMZW5ndGgpOwoKICAgICAgICBjYXNlICJDQ0YiOgogICAgICAgIGNhc2UgIkNDSVRURmF4RGVjb2RlIjoKICAgICAgICAgIHhyZWZTdGF0cy5hZGRTdHJlYW1UeXBlKF91dGlsLlN0cmVhbVR5cGUuQ0NGKTsKICAgICAgICAgIHJldHVybiBuZXcgX2NjaXR0X3N0cmVhbS5DQ0lUVEZheFN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoLCBwYXJhbXMpOwoKICAgICAgICBjYXNlICJSTCI6CiAgICAgICAgY2FzZSAiUnVuTGVuZ3RoRGVjb2RlIjoKICAgICAgICAgIHhyZWZTdGF0cy5hZGRTdHJlYW1UeXBlKF91dGlsLlN0cmVhbVR5cGUuUkxYKTsKICAgICAgICAgIHJldHVybiBuZXcgX3J1bl9sZW5ndGhfc3RyZWFtLlJ1bkxlbmd0aFN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoKTsKCiAgICAgICAgY2FzZSAiSkJJRzJEZWNvZGUiOgogICAgICAgICAgeHJlZlN0YXRzLmFkZFN0cmVhbVR5cGUoX3V0aWwuU3RyZWFtVHlwZS5KQklHKTsKICAgICAgICAgIHJldHVybiBuZXcgX2piaWcyX3N0cmVhbS5KYmlnMlN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoLCBwYXJhbXMpOwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoYEZpbHRlciAiJHtuYW1lfSIgaXMgbm90IHN1cHBvcnRlZC5gKTsKICAgICAgcmV0dXJuIHN0cmVhbTsKICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgdGhyb3cgZXg7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC53YXJuKShgSW52YWxpZCBzdHJlYW06ICIke2V4fSJgKTsKICAgICAgcmV0dXJuIG5ldyBfc3RyZWFtLk51bGxTdHJlYW0oKTsKICAgIH0KICB9Cgp9CgpleHBvcnRzLlBhcnNlciA9IFBhcnNlcjsKY29uc3Qgc3BlY2lhbENoYXJzID0gWzEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDAsIDEsIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDAsIDIsIDAsIDAsIDIsIDIsIDAsIDAsIDAsIDAsIDAsIDIsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDIsIDAsIDIsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDIsIDAsIDIsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDIsIDAsIDIsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOwoKZnVuY3Rpb24gdG9IZXhEaWdpdChjaCkgewogIGlmIChjaCA+PSAweDMwICYmIGNoIDw9IDB4MzkpIHsKICAgIHJldHVybiBjaCAmIDB4MGY7CiAgfQoKICBpZiAoY2ggPj0gMHg0MSAmJiBjaCA8PSAweDQ2IHx8IGNoID49IDB4NjEgJiYgY2ggPD0gMHg2NikgewogICAgcmV0dXJuIChjaCAmIDB4MGYpICsgOTsKICB9CgogIHJldHVybiAtMTsKfQoKY2xhc3MgTGV4ZXIgewogIGNvbnN0cnVjdG9yKHN0cmVhbSkgewogICAgbGV0IGtub3duQ29tbWFuZHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IG51bGw7CiAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTsKICAgIHRoaXMubmV4dENoYXIoKTsKICAgIHRoaXMuc3RyQnVmID0gW107CiAgICB0aGlzLmtub3duQ29tbWFuZHMgPSBrbm93bkNvbW1hbmRzOwogICAgdGhpcy5faGV4U3RyaW5nTnVtV2FybiA9IDA7CiAgICB0aGlzLmJlZ2luSW5saW5lSW1hZ2VQb3MgPSAtMTsKICB9CgogIG5leHRDaGFyKCkgewogICAgcmV0dXJuIHRoaXMuY3VycmVudENoYXIgPSB0aGlzLnN0cmVhbS5nZXRCeXRlKCk7CiAgfQoKICBwZWVrQ2hhcigpIHsKICAgIHJldHVybiB0aGlzLnN0cmVhbS5wZWVrQnl0ZSgpOwogIH0KCiAgZ2V0TnVtYmVyKCkgewogICAgbGV0IGNoID0gdGhpcy5jdXJyZW50Q2hhcjsKICAgIGxldCBlTm90YXRpb24gPSBmYWxzZTsKICAgIGxldCBkaXZpZGVCeSA9IDA7CiAgICBsZXQgc2lnbiA9IDA7CgogICAgaWYgKGNoID09PSAweDJkKSB7CiAgICAgIHNpZ24gPSAtMTsKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CgogICAgICBpZiAoY2ggPT09IDB4MmQpIHsKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChjaCA9PT0gMHgyYikgewogICAgICBzaWduID0gMTsKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICB9CgogICAgaWYgKGNoID09PSAweDBhIHx8IGNoID09PSAweDBkKSB7CiAgICAgIGRvIHsKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgfSB3aGlsZSAoY2ggPT09IDB4MGEgfHwgY2ggPT09IDB4MGQpOwogICAgfQoKICAgIGlmIChjaCA9PT0gMHgyZSkgewogICAgICBkaXZpZGVCeSA9IDEwOwogICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgIH0KCiAgICBpZiAoY2ggPCAweDMwIHx8IGNoID4gMHgzOSkgewogICAgICBpZiAoKDAsIF9jb3JlX3V0aWxzLmlzV2hpdGVTcGFjZSkoY2gpIHx8IGNoID09PSAtMSkgewogICAgICAgIGlmIChkaXZpZGVCeSA9PT0gMTAgJiYgc2lnbiA9PT0gMCkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJMZXhlci5nZXROdW1iZXIgLSB0cmVhdGluZyBhIHNpbmdsZSBkZWNpbWFsIHBvaW50IGFzIHplcm8uIik7CiAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIGlmIChkaXZpZGVCeSA9PT0gMCAmJiBzaWduID09PSAtMSkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJMZXhlci5nZXROdW1iZXIgLSB0cmVhdGluZyBhIHNpbmdsZSBtaW51cyBzaWduIGFzIHplcm8uIik7CiAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW52YWxpZCBudW1iZXI6ICR7U3RyaW5nLmZyb21DaGFyQ29kZShjaCl9IChjaGFyQ29kZSAke2NofSlgKTsKICAgIH0KCiAgICBzaWduID0gc2lnbiB8fCAxOwogICAgbGV0IGJhc2VWYWx1ZSA9IGNoIC0gMHgzMDsKICAgIGxldCBwb3dlclZhbHVlID0gMDsKICAgIGxldCBwb3dlclZhbHVlU2lnbiA9IDE7CgogICAgd2hpbGUgKChjaCA9IHRoaXMubmV4dENoYXIoKSkgPj0gMCkgewogICAgICBpZiAoY2ggPj0gMHgzMCAmJiBjaCA8PSAweDM5KSB7CiAgICAgICAgY29uc3QgY3VycmVudERpZ2l0ID0gY2ggLSAweDMwOwoKICAgICAgICBpZiAoZU5vdGF0aW9uKSB7CiAgICAgICAgICBwb3dlclZhbHVlID0gcG93ZXJWYWx1ZSAqIDEwICsgY3VycmVudERpZ2l0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoZGl2aWRlQnkgIT09IDApIHsKICAgICAgICAgICAgZGl2aWRlQnkgKj0gMTA7CiAgICAgICAgICB9CgogICAgICAgICAgYmFzZVZhbHVlID0gYmFzZVZhbHVlICogMTAgKyBjdXJyZW50RGlnaXQ7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGNoID09PSAweDJlKSB7CiAgICAgICAgaWYgKGRpdmlkZUJ5ID09PSAwKSB7CiAgICAgICAgICBkaXZpZGVCeSA9IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgyZCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiQmFkbHkgZm9ybWF0dGVkIG51bWJlcjogbWludXMgc2lnbiBpbiB0aGUgbWlkZGxlIik7CiAgICAgIH0gZWxzZSBpZiAoY2ggPT09IDB4NDUgfHwgY2ggPT09IDB4NjUpIHsKICAgICAgICBjaCA9IHRoaXMucGVla0NoYXIoKTsKCiAgICAgICAgaWYgKGNoID09PSAweDJiIHx8IGNoID09PSAweDJkKSB7CiAgICAgICAgICBwb3dlclZhbHVlU2lnbiA9IGNoID09PSAweDJkID8gLTEgOiAxOwogICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgIH0gZWxzZSBpZiAoY2ggPCAweDMwIHx8IGNoID4gMHgzOSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBlTm90YXRpb24gPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKGRpdmlkZUJ5ICE9PSAwKSB7CiAgICAgIGJhc2VWYWx1ZSAvPSBkaXZpZGVCeTsKICAgIH0KCiAgICBpZiAoZU5vdGF0aW9uKSB7CiAgICAgIGJhc2VWYWx1ZSAqPSAxMCAqKiAocG93ZXJWYWx1ZVNpZ24gKiBwb3dlclZhbHVlKTsKICAgIH0KCiAgICByZXR1cm4gc2lnbiAqIGJhc2VWYWx1ZTsKICB9CgogIGdldFN0cmluZygpIHsKICAgIGxldCBudW1QYXJlbiA9IDE7CiAgICBsZXQgZG9uZSA9IGZhbHNlOwogICAgY29uc3Qgc3RyQnVmID0gdGhpcy5zdHJCdWY7CiAgICBzdHJCdWYubGVuZ3RoID0gMDsKICAgIGxldCBjaCA9IHRoaXMubmV4dENoYXIoKTsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBsZXQgY2hhckJ1ZmZlcmVkID0gZmFsc2U7CgogICAgICBzd2l0Y2ggKGNoIHwgMCkgewogICAgICAgIGNhc2UgLTE6CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVudGVybWluYXRlZCBzdHJpbmciKTsKICAgICAgICAgIGRvbmUgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHgyODoKICAgICAgICAgICsrbnVtUGFyZW47CiAgICAgICAgICBzdHJCdWYucHVzaCgiKCIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHgyOToKICAgICAgICAgIGlmICgtLW51bVBhcmVuID09PSAwKSB7CiAgICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgZG9uZSA9IHRydWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdHJCdWYucHVzaCgiKSIpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4NWM6CiAgICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKCiAgICAgICAgICBzd2l0Y2ggKGNoKSB7CiAgICAgICAgICAgIGNhc2UgLTE6CiAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbnRlcm1pbmF0ZWQgc3RyaW5nIik7CiAgICAgICAgICAgICAgZG9uZSA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NmU6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goIlxuIik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NzI6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goIlxyIik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NzQ6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goIlx0Iik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NjI6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goIlxiIik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NjY6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goIlxmIik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NWM6CiAgICAgICAgICAgIGNhc2UgMHgyODoKICAgICAgICAgICAgY2FzZSAweDI5OgogICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMHgzMDoKICAgICAgICAgICAgY2FzZSAweDMxOgogICAgICAgICAgICBjYXNlIDB4MzI6CiAgICAgICAgICAgIGNhc2UgMHgzMzoKICAgICAgICAgICAgY2FzZSAweDM0OgogICAgICAgICAgICBjYXNlIDB4MzU6CiAgICAgICAgICAgIGNhc2UgMHgzNjoKICAgICAgICAgICAgY2FzZSAweDM3OgogICAgICAgICAgICAgIGxldCB4ID0gY2ggJiAweDBmOwogICAgICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgICAgIGNoYXJCdWZmZXJlZCA9IHRydWU7CgogICAgICAgICAgICAgIGlmIChjaCA+PSAweDMwICYmIGNoIDw9IDB4MzcpIHsKICAgICAgICAgICAgICAgIHggPSAoeCA8PCAzKSArIChjaCAmIDB4MGYpOwogICAgICAgICAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CgogICAgICAgICAgICAgICAgaWYgKGNoID49IDB4MzAgJiYgY2ggPD0gMHgzNykgewogICAgICAgICAgICAgICAgICBjaGFyQnVmZmVyZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgeCA9ICh4IDw8IDMpICsgKGNoICYgMHgwZik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKHgpKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMHgwZDoKICAgICAgICAgICAgICBpZiAodGhpcy5wZWVrQ2hhcigpID09PSAweDBhKSB7CiAgICAgICAgICAgICAgICB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMHgwYToKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmIChkb25lKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmICghY2hhckJ1ZmZlcmVkKSB7CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc3RyQnVmLmpvaW4oIiIpOwogIH0KCiAgZ2V0TmFtZSgpIHsKICAgIGxldCBjaCwgcHJldmlvdXNDaDsKICAgIGNvbnN0IHN0ckJ1ZiA9IHRoaXMuc3RyQnVmOwogICAgc3RyQnVmLmxlbmd0aCA9IDA7CgogICAgd2hpbGUgKChjaCA9IHRoaXMubmV4dENoYXIoKSkgPj0gMCAmJiAhc3BlY2lhbENoYXJzW2NoXSkgewogICAgICBpZiAoY2ggPT09IDB4MjMpIHsKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKCiAgICAgICAgaWYgKHNwZWNpYWxDaGFyc1tjaF0pIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiTGV4ZXJfZ2V0TmFtZTogIiArICJOVU1CRVIgU0lHTiAoIykgc2hvdWxkIGJlIGZvbGxvd2VkIGJ5IGEgaGV4YWRlY2ltYWwgbnVtYmVyLiIpOwogICAgICAgICAgc3RyQnVmLnB1c2goIiMiKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgeCA9IHRvSGV4RGlnaXQoY2gpOwoKICAgICAgICBpZiAoeCAhPT0gLTEpIHsKICAgICAgICAgIHByZXZpb3VzQ2ggPSBjaDsKICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgY29uc3QgeDIgPSB0b0hleERpZ2l0KGNoKTsKCiAgICAgICAgICBpZiAoeDIgPT09IC0xKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgTGV4ZXJfZ2V0TmFtZTogSWxsZWdhbCBkaWdpdCAoJHtTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKX0pIGAgKyAiaW4gaGV4YWRlY2ltYWwgbnVtYmVyLiIpOwogICAgICAgICAgICBzdHJCdWYucHVzaCgiIyIsIFN0cmluZy5mcm9tQ2hhckNvZGUocHJldmlvdXNDaCkpOwoKICAgICAgICAgICAgaWYgKHNwZWNpYWxDaGFyc1tjaF0pIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKHggPDwgNCB8IHgyKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0ckJ1Zi5wdXNoKCIjIiwgU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoc3RyQnVmLmxlbmd0aCA+IDEyNykgewogICAgICAoMCwgX3V0aWwud2FybikoYE5hbWUgdG9rZW4gaXMgbG9uZ2VyIHRoYW4gYWxsb3dlZCBieSB0aGUgc3BlYzogJHtzdHJCdWYubGVuZ3RofWApOwogICAgfQoKICAgIHJldHVybiBfcHJpbWl0aXZlcy5OYW1lLmdldChzdHJCdWYuam9pbigiIikpOwogIH0KCiAgX2hleFN0cmluZ1dhcm4oY2gpIHsKICAgIGNvbnN0IE1BWF9IRVhfU1RSSU5HX05VTV9XQVJOID0gNTsKCiAgICBpZiAodGhpcy5faGV4U3RyaW5nTnVtV2FybisrID09PSBNQVhfSEVYX1NUUklOR19OVU1fV0FSTikgewogICAgICAoMCwgX3V0aWwud2FybikoImdldEhleFN0cmluZyAtIGlnbm9yaW5nIGFkZGl0aW9uYWwgaW52YWxpZCBjaGFyYWN0ZXJzLiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHRoaXMuX2hleFN0cmluZ051bVdhcm4gPiBNQVhfSEVYX1NUUklOR19OVU1fV0FSTikgewogICAgICByZXR1cm47CiAgICB9CgogICAgKDAsIF91dGlsLndhcm4pKGBnZXRIZXhTdHJpbmcgLSBpZ25vcmluZyBpbnZhbGlkIGNoYXJhY3RlcjogJHtjaH1gKTsKICB9CgogIGdldEhleFN0cmluZygpIHsKICAgIGNvbnN0IHN0ckJ1ZiA9IHRoaXMuc3RyQnVmOwogICAgc3RyQnVmLmxlbmd0aCA9IDA7CiAgICBsZXQgY2ggPSB0aGlzLmN1cnJlbnRDaGFyOwogICAgbGV0IGlzRmlyc3RIZXggPSB0cnVlOwogICAgbGV0IGZpcnN0RGlnaXQsIHNlY29uZERpZ2l0OwogICAgdGhpcy5faGV4U3RyaW5nTnVtV2FybiA9IDA7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgaWYgKGNoIDwgMCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiVW50ZXJtaW5hdGVkIGhleCBzdHJpbmciKTsKICAgICAgICBicmVhazsKICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgzZSkgewogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICBicmVhazsKICAgICAgfSBlbHNlIGlmIChzcGVjaWFsQ2hhcnNbY2hdID09PSAxKSB7CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGlzRmlyc3RIZXgpIHsKICAgICAgICAgIGZpcnN0RGlnaXQgPSB0b0hleERpZ2l0KGNoKTsKCiAgICAgICAgICBpZiAoZmlyc3REaWdpdCA9PT0gLTEpIHsKICAgICAgICAgICAgdGhpcy5faGV4U3RyaW5nV2FybihjaCk7CgogICAgICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNlY29uZERpZ2l0ID0gdG9IZXhEaWdpdChjaCk7CgogICAgICAgICAgaWYgKHNlY29uZERpZ2l0ID09PSAtMSkgewogICAgICAgICAgICB0aGlzLl9oZXhTdHJpbmdXYXJuKGNoKTsKCiAgICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGZpcnN0RGlnaXQgPDwgNCB8IHNlY29uZERpZ2l0KSk7CiAgICAgICAgfQoKICAgICAgICBpc0ZpcnN0SGV4ID0gIWlzRmlyc3RIZXg7CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc3RyQnVmLmpvaW4oIiIpOwogIH0KCiAgZ2V0T2JqKCkgewogICAgbGV0IGNvbW1lbnQgPSBmYWxzZTsKICAgIGxldCBjaCA9IHRoaXMuY3VycmVudENoYXI7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgaWYgKGNoIDwgMCkgewogICAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5FT0Y7CiAgICAgIH0KCiAgICAgIGlmIChjb21tZW50KSB7CiAgICAgICAgaWYgKGNoID09PSAweDBhIHx8IGNoID09PSAweDBkKSB7CiAgICAgICAgICBjb21tZW50ID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGNoID09PSAweDI1KSB7CiAgICAgICAgY29tbWVudCA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAoc3BlY2lhbENoYXJzW2NoXSAhPT0gMSkgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgIH0KCiAgICBzd2l0Y2ggKGNoIHwgMCkgewogICAgICBjYXNlIDB4MzA6CiAgICAgIGNhc2UgMHgzMToKICAgICAgY2FzZSAweDMyOgogICAgICBjYXNlIDB4MzM6CiAgICAgIGNhc2UgMHgzNDoKICAgICAgY2FzZSAweDM1OgogICAgICBjYXNlIDB4MzY6CiAgICAgIGNhc2UgMHgzNzoKICAgICAgY2FzZSAweDM4OgogICAgICBjYXNlIDB4Mzk6CiAgICAgIGNhc2UgMHgyYjoKICAgICAgY2FzZSAweDJkOgogICAgICBjYXNlIDB4MmU6CiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TnVtYmVyKCk7CgogICAgICBjYXNlIDB4Mjg6CiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RyaW5nKCk7CgogICAgICBjYXNlIDB4MmY6CiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmFtZSgpOwoKICAgICAgY2FzZSAweDViOgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ21kLmdldCgiWyIpOwoKICAgICAgY2FzZSAweDVkOgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ21kLmdldCgiXSIpOwoKICAgICAgY2FzZSAweDNjOgogICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwoKICAgICAgICBpZiAoY2ggPT09IDB4M2MpIHsKICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5DbWQuZ2V0KCI8PCIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SGV4U3RyaW5nKCk7CgogICAgICBjYXNlIDB4M2U6CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CgogICAgICAgIGlmIChjaCA9PT0gMHgzZSkgewogICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkNtZC5nZXQoIj4+Iik7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ21kLmdldCgiPiIpOwoKICAgICAgY2FzZSAweDdiOgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ21kLmdldCgieyIpOwoKICAgICAgY2FzZSAweDdkOgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ21kLmdldCgifSIpOwoKICAgICAgY2FzZSAweDI5OgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYElsbGVnYWwgY2hhcmFjdGVyOiAke2NofWApOwogICAgfQoKICAgIGxldCBzdHIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKCiAgICBpZiAoY2ggPCAweDIwIHx8IGNoID4gMHg3ZikgewogICAgICBjb25zdCBuZXh0Q2ggPSB0aGlzLnBlZWtDaGFyKCk7CgogICAgICBpZiAobmV4dENoID49IDB4MjAgJiYgbmV4dENoIDw9IDB4N2YpIHsKICAgICAgICB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkNtZC5nZXQoc3RyKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGtub3duQ29tbWFuZHMgPSB0aGlzLmtub3duQ29tbWFuZHM7CiAgICBsZXQga25vd25Db21tYW5kRm91bmQgPSBrbm93bkNvbW1hbmRzICYmIGtub3duQ29tbWFuZHNbc3RyXSAhPT0gdW5kZWZpbmVkOwoKICAgIHdoaWxlICgoY2ggPSB0aGlzLm5leHRDaGFyKCkpID49IDAgJiYgIXNwZWNpYWxDaGFyc1tjaF0pIHsKICAgICAgY29uc3QgcG9zc2libGVDb21tYW5kID0gc3RyICsgU3RyaW5nLmZyb21DaGFyQ29kZShjaCk7CgogICAgICBpZiAoa25vd25Db21tYW5kRm91bmQgJiYga25vd25Db21tYW5kc1twb3NzaWJsZUNvbW1hbmRdID09PSB1bmRlZmluZWQpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKHN0ci5sZW5ndGggPT09IDEyOCkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgQ29tbWFuZCB0b2tlbiB0b28gbG9uZzogJHtzdHIubGVuZ3RofWApOwogICAgICB9CgogICAgICBzdHIgPSBwb3NzaWJsZUNvbW1hbmQ7CiAgICAgIGtub3duQ29tbWFuZEZvdW5kID0ga25vd25Db21tYW5kcyAmJiBrbm93bkNvbW1hbmRzW3N0cl0gIT09IHVuZGVmaW5lZDsKICAgIH0KCiAgICBpZiAoc3RyID09PSAidHJ1ZSIpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgaWYgKHN0ciA9PT0gImZhbHNlIikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKHN0ciA9PT0gIm51bGwiKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmIChzdHIgPT09ICJCSSIpIHsKICAgICAgdGhpcy5iZWdpbklubGluZUltYWdlUG9zID0gdGhpcy5zdHJlYW0ucG9zOwogICAgfQoKICAgIHJldHVybiBfcHJpbWl0aXZlcy5DbWQuZ2V0KHN0cik7CiAgfQoKICBwZWVrT2JqKCkgewogICAgY29uc3Qgc3RyZWFtUG9zID0gdGhpcy5zdHJlYW0ucG9zLAogICAgICAgICAgY3VycmVudENoYXIgPSB0aGlzLmN1cnJlbnRDaGFyLAogICAgICAgICAgYmVnaW5JbmxpbmVJbWFnZVBvcyA9IHRoaXMuYmVnaW5JbmxpbmVJbWFnZVBvczsKICAgIGxldCBuZXh0T2JqOwoKICAgIHRyeSB7CiAgICAgIG5leHRPYmogPSB0aGlzLmdldE9iaigpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGBwZWVrT2JqOiAke2V4fWApOwogICAgfQoKICAgIHRoaXMuc3RyZWFtLnBvcyA9IHN0cmVhbVBvczsKICAgIHRoaXMuY3VycmVudENoYXIgPSBjdXJyZW50Q2hhcjsKICAgIHRoaXMuYmVnaW5JbmxpbmVJbWFnZVBvcyA9IGJlZ2luSW5saW5lSW1hZ2VQb3M7CiAgICByZXR1cm4gbmV4dE9iajsKICB9CgogIHNraXBUb05leHRMaW5lKCkgewogICAgbGV0IGNoID0gdGhpcy5jdXJyZW50Q2hhcjsKCiAgICB3aGlsZSAoY2ggPj0gMCkgewogICAgICBpZiAoY2ggPT09IDB4MGQpIHsKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKCiAgICAgICAgaWYgKGNoID09PSAweDBhKSB7CiAgICAgICAgICB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgwYSkgewogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5MZXhlciA9IExleGVyOwoKY2xhc3MgTGluZWFyaXphdGlvbiB7CiAgc3RhdGljIGNyZWF0ZShzdHJlYW0pIHsKICAgIGZ1bmN0aW9uIGdldEludChsaW5EaWN0LCBuYW1lKSB7CiAgICAgIGxldCBhbGxvd1plcm9WYWx1ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIGNvbnN0IG9iaiA9IGxpbkRpY3QuZ2V0KG5hbWUpOwoKICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIob2JqKSAmJiAoYWxsb3daZXJvVmFsdWUgPyBvYmogPj0gMCA6IG9iaiA+IDApKSB7CiAgICAgICAgcmV0dXJuIG9iajsKICAgICAgfQoKICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgIiR7bmFtZX0iIHBhcmFtZXRlciBpbiB0aGUgbGluZWFyaXphdGlvbiBgICsgImRpY3Rpb25hcnkgaXMgaW52YWxpZC4iKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRIaW50cyhsaW5EaWN0KSB7CiAgICAgIGNvbnN0IGhpbnRzID0gbGluRGljdC5nZXQoIkgiKTsKICAgICAgbGV0IGhpbnRzTGVuZ3RoOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaGludHMpICYmICgoaGludHNMZW5ndGggPSBoaW50cy5sZW5ndGgpID09PSAyIHx8IGhpbnRzTGVuZ3RoID09PSA0KSkgewogICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBoaW50c0xlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgY29uc3QgaGludCA9IGhpbnRzW2luZGV4XTsKCiAgICAgICAgICBpZiAoIShOdW1iZXIuaXNJbnRlZ2VyKGhpbnQpICYmIGhpbnQgPiAwKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhpbnQgKCR7aW5kZXh9KSBpbiB0aGUgbGluZWFyaXphdGlvbiBkaWN0aW9uYXJ5IGlzIGludmFsaWQuYCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaGludHM7CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBFcnJvcigiSGludCBhcnJheSBpbiB0aGUgbGluZWFyaXphdGlvbiBkaWN0aW9uYXJ5IGlzIGludmFsaWQuIik7CiAgICB9CgogICAgY29uc3QgcGFyc2VyID0gbmV3IFBhcnNlcih7CiAgICAgIGxleGVyOiBuZXcgTGV4ZXIoc3RyZWFtKSwKICAgICAgeHJlZjogbnVsbAogICAgfSk7CiAgICBjb25zdCBvYmoxID0gcGFyc2VyLmdldE9iaigpOwogICAgY29uc3Qgb2JqMiA9IHBhcnNlci5nZXRPYmooKTsKICAgIGNvbnN0IG9iajMgPSBwYXJzZXIuZ2V0T2JqKCk7CiAgICBjb25zdCBsaW5EaWN0ID0gcGFyc2VyLmdldE9iaigpOwogICAgbGV0IG9iaiwgbGVuZ3RoOwoKICAgIGlmICghKE51bWJlci5pc0ludGVnZXIob2JqMSkgJiYgTnVtYmVyLmlzSW50ZWdlcihvYmoyKSAmJiAoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iajMsICJvYmoiKSAmJiBsaW5EaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiB0eXBlb2YgKG9iaiA9IGxpbkRpY3QuZ2V0KCJMaW5lYXJpemVkIikpID09PSAibnVtYmVyIiAmJiBvYmogPiAwKSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0gZWxzZSBpZiAoKGxlbmd0aCA9IGdldEludChsaW5EaWN0LCAiTCIpKSAhPT0gc3RyZWFtLmxlbmd0aCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSAiTCIgcGFyYW1ldGVyIGluIHRoZSBsaW5lYXJpemF0aW9uIGRpY3Rpb25hcnkgJyArICJkb2VzIG5vdCBlcXVhbCB0aGUgc3RyZWFtIGxlbmd0aC4iKTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBsZW5ndGgsCiAgICAgIGhpbnRzOiBnZXRIaW50cyhsaW5EaWN0KSwKICAgICAgb2JqZWN0TnVtYmVyRmlyc3Q6IGdldEludChsaW5EaWN0LCAiTyIpLAogICAgICBlbmRGaXJzdDogZ2V0SW50KGxpbkRpY3QsICJFIiksCiAgICAgIG51bVBhZ2VzOiBnZXRJbnQobGluRGljdCwgIk4iKSwKICAgICAgbWFpblhSZWZFbnRyaWVzT2Zmc2V0OiBnZXRJbnQobGluRGljdCwgIlQiKSwKICAgICAgcGFnZUZpcnN0OiBsaW5EaWN0LmhhcygiUCIpID8gZ2V0SW50KGxpbkRpY3QsICJQIiwgdHJ1ZSkgOiAwCiAgICB9OwogIH0KCn0KCmV4cG9ydHMuTGluZWFyaXphdGlvbiA9IExpbmVhcml6YXRpb247CgovKioqLyB9KSwKLyogMTQzICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Bc2NpaTg1U3RyZWFtID0gdm9pZCAwOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDQpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKY2xhc3MgQXNjaWk4NVN0cmVhbSBleHRlbmRzIF9kZWNvZGVfc3RyZWFtLkRlY29kZVN0cmVhbSB7CiAgY29uc3RydWN0b3Ioc3RyLCBtYXliZUxlbmd0aCkgewogICAgaWYgKG1heWJlTGVuZ3RoKSB7CiAgICAgIG1heWJlTGVuZ3RoICo9IDAuODsKICAgIH0KCiAgICBzdXBlcihtYXliZUxlbmd0aCk7CiAgICB0aGlzLnN0ciA9IHN0cjsKICAgIHRoaXMuZGljdCA9IHN0ci5kaWN0OwogICAgdGhpcy5pbnB1dCA9IG5ldyBVaW50OEFycmF5KDUpOwogIH0KCiAgcmVhZEJsb2NrKCkgewogICAgY29uc3QgVElMREFfQ0hBUiA9IDB4N2U7CiAgICBjb25zdCBaX0xPV0VSX0NIQVIgPSAweDdhOwogICAgY29uc3QgRU9GID0gLTE7CiAgICBjb25zdCBzdHIgPSB0aGlzLnN0cjsKICAgIGxldCBjID0gc3RyLmdldEJ5dGUoKTsKCiAgICB3aGlsZSAoKDAsIF9jb3JlX3V0aWxzLmlzV2hpdGVTcGFjZSkoYykpIHsKICAgICAgYyA9IHN0ci5nZXRCeXRlKCk7CiAgICB9CgogICAgaWYgKGMgPT09IEVPRiB8fCBjID09PSBUSUxEQV9DSEFSKSB7CiAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyTGVuZ3RoOwogICAgbGV0IGJ1ZmZlciwgaTsKCiAgICBpZiAoYyA9PT0gWl9MT1dFUl9DSEFSKSB7CiAgICAgIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKGJ1ZmZlckxlbmd0aCArIDQpOwoKICAgICAgZm9yIChpID0gMDsgaSA8IDQ7ICsraSkgewogICAgICAgIGJ1ZmZlcltidWZmZXJMZW5ndGggKyBpXSA9IDA7CiAgICAgIH0KCiAgICAgIHRoaXMuYnVmZmVyTGVuZ3RoICs9IDQ7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBpbnB1dCA9IHRoaXMuaW5wdXQ7CiAgICAgIGlucHV0WzBdID0gYzsKCiAgICAgIGZvciAoaSA9IDE7IGkgPCA1OyArK2kpIHsKICAgICAgICBjID0gc3RyLmdldEJ5dGUoKTsKCiAgICAgICAgd2hpbGUgKCgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGMpKSB7CiAgICAgICAgICBjID0gc3RyLmdldEJ5dGUoKTsKICAgICAgICB9CgogICAgICAgIGlucHV0W2ldID0gYzsKCiAgICAgICAgaWYgKGMgPT09IEVPRiB8fCBjID09PSBUSUxEQV9DSEFSKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKGJ1ZmZlckxlbmd0aCArIGkgLSAxKTsKICAgICAgdGhpcy5idWZmZXJMZW5ndGggKz0gaSAtIDE7CgogICAgICBpZiAoaSA8IDUpIHsKICAgICAgICBmb3IgKDsgaSA8IDU7ICsraSkgewogICAgICAgICAgaW5wdXRbaV0gPSAweDIxICsgODQ7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgIH0KCiAgICAgIGxldCB0ID0gMDsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCA1OyArK2kpIHsKICAgICAgICB0ID0gdCAqIDg1ICsgKGlucHV0W2ldIC0gMHgyMSk7CiAgICAgIH0KCiAgICAgIGZvciAoaSA9IDM7IGkgPj0gMDsgLS1pKSB7CiAgICAgICAgYnVmZmVyW2J1ZmZlckxlbmd0aCArIGldID0gdCAmIDB4ZmY7CiAgICAgICAgdCA+Pj0gODsKICAgICAgfQogICAgfQogIH0KCn0KCmV4cG9ydHMuQXNjaWk4NVN0cmVhbSA9IEFzY2lpODVTdHJlYW07CgovKioqLyB9KSwKLyogMTQ0ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5TdHJlYW1zU2VxdWVuY2VTdHJlYW0gPSBleHBvcnRzLkRlY29kZVN0cmVhbSA9IHZvaWQgMDsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMik7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTM1KTsKCmNvbnN0IGVtcHR5QnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMCk7CgpjbGFzcyBEZWNvZGVTdHJlYW0gZXh0ZW5kcyBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSB7CiAgY29uc3RydWN0b3IobWF5YmVNaW5CdWZmZXJMZW5ndGgpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLl9yYXdNaW5CdWZmZXJMZW5ndGggPSBtYXliZU1pbkJ1ZmZlckxlbmd0aCB8fCAwOwogICAgdGhpcy5wb3MgPSAwOwogICAgdGhpcy5idWZmZXJMZW5ndGggPSAwOwogICAgdGhpcy5lb2YgPSBmYWxzZTsKICAgIHRoaXMuYnVmZmVyID0gZW1wdHlCdWZmZXI7CiAgICB0aGlzLm1pbkJ1ZmZlckxlbmd0aCA9IDUxMjsKCiAgICBpZiAobWF5YmVNaW5CdWZmZXJMZW5ndGgpIHsKICAgICAgd2hpbGUgKHRoaXMubWluQnVmZmVyTGVuZ3RoIDwgbWF5YmVNaW5CdWZmZXJMZW5ndGgpIHsKICAgICAgICB0aGlzLm1pbkJ1ZmZlckxlbmd0aCAqPSAyOwogICAgICB9CiAgICB9CiAgfQoKICBnZXQgaXNFbXB0eSgpIHsKICAgIHdoaWxlICghdGhpcy5lb2YgJiYgdGhpcy5idWZmZXJMZW5ndGggPT09IDApIHsKICAgICAgdGhpcy5yZWFkQmxvY2soKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5idWZmZXJMZW5ndGggPT09IDA7CiAgfQoKICBlbnN1cmVCdWZmZXIocmVxdWVzdGVkKSB7CiAgICBjb25zdCBidWZmZXIgPSB0aGlzLmJ1ZmZlcjsKCiAgICBpZiAocmVxdWVzdGVkIDw9IGJ1ZmZlci5ieXRlTGVuZ3RoKSB7CiAgICAgIHJldHVybiBidWZmZXI7CiAgICB9CgogICAgbGV0IHNpemUgPSB0aGlzLm1pbkJ1ZmZlckxlbmd0aDsKCiAgICB3aGlsZSAoc2l6ZSA8IHJlcXVlc3RlZCkgewogICAgICBzaXplICo9IDI7CiAgICB9CgogICAgY29uc3QgYnVmZmVyMiA9IG5ldyBVaW50OEFycmF5KHNpemUpOwogICAgYnVmZmVyMi5zZXQoYnVmZmVyKTsKICAgIHJldHVybiB0aGlzLmJ1ZmZlciA9IGJ1ZmZlcjI7CiAgfQoKICBnZXRCeXRlKCkgewogICAgY29uc3QgcG9zID0gdGhpcy5wb3M7CgogICAgd2hpbGUgKHRoaXMuYnVmZmVyTGVuZ3RoIDw9IHBvcykgewogICAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KCiAgICAgIHRoaXMucmVhZEJsb2NrKCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuYnVmZmVyW3RoaXMucG9zKytdOwogIH0KCiAgZ2V0Qnl0ZXMobGVuZ3RoKSB7CiAgICBjb25zdCBwb3MgPSB0aGlzLnBvczsKICAgIGxldCBlbmQ7CgogICAgaWYgKGxlbmd0aCkgewogICAgICB0aGlzLmVuc3VyZUJ1ZmZlcihwb3MgKyBsZW5ndGgpOwogICAgICBlbmQgPSBwb3MgKyBsZW5ndGg7CgogICAgICB3aGlsZSAoIXRoaXMuZW9mICYmIHRoaXMuYnVmZmVyTGVuZ3RoIDwgZW5kKSB7CiAgICAgICAgdGhpcy5yZWFkQmxvY2soKTsKICAgICAgfQoKICAgICAgY29uc3QgYnVmRW5kID0gdGhpcy5idWZmZXJMZW5ndGg7CgogICAgICBpZiAoZW5kID4gYnVmRW5kKSB7CiAgICAgICAgZW5kID0gYnVmRW5kOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB3aGlsZSAoIXRoaXMuZW9mKSB7CiAgICAgICAgdGhpcy5yZWFkQmxvY2soKTsKICAgICAgfQoKICAgICAgZW5kID0gdGhpcy5idWZmZXJMZW5ndGg7CiAgICB9CgogICAgdGhpcy5wb3MgPSBlbmQ7CiAgICByZXR1cm4gdGhpcy5idWZmZXIuc3ViYXJyYXkocG9zLCBlbmQpOwogIH0KCiAgcmVzZXQoKSB7CiAgICB0aGlzLnBvcyA9IDA7CiAgfQoKICBtYWtlU3ViU3RyZWFtKHN0YXJ0LCBsZW5ndGgpIHsKICAgIGxldCBkaWN0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBudWxsOwoKICAgIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkgewogICAgICB3aGlsZSAoIXRoaXMuZW9mKSB7CiAgICAgICAgdGhpcy5yZWFkQmxvY2soKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgY29uc3QgZW5kID0gc3RhcnQgKyBsZW5ndGg7CgogICAgICB3aGlsZSAodGhpcy5idWZmZXJMZW5ndGggPD0gZW5kICYmICF0aGlzLmVvZikgewogICAgICAgIHRoaXMucmVhZEJsb2NrKCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbmV3IF9zdHJlYW0uU3RyZWFtKHRoaXMuYnVmZmVyLCBzdGFydCwgbGVuZ3RoLCBkaWN0KTsKICB9CgogIGdldEJhc2VTdHJlYW1zKCkgewogICAgcmV0dXJuIHRoaXMuc3RyID8gdGhpcy5zdHIuZ2V0QmFzZVN0cmVhbXMoKSA6IG51bGw7CiAgfQoKfQoKZXhwb3J0cy5EZWNvZGVTdHJlYW0gPSBEZWNvZGVTdHJlYW07CgpjbGFzcyBTdHJlYW1zU2VxdWVuY2VTdHJlYW0gZXh0ZW5kcyBEZWNvZGVTdHJlYW0gewogIGNvbnN0cnVjdG9yKHN0cmVhbXMpIHsKICAgIGxldCBvbkVycm9yID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsOwogICAgbGV0IG1heWJlTGVuZ3RoID0gMDsKCiAgICBmb3IgKGNvbnN0IHN0cmVhbSBvZiBzdHJlYW1zKSB7CiAgICAgIG1heWJlTGVuZ3RoICs9IHN0cmVhbSBpbnN0YW5jZW9mIERlY29kZVN0cmVhbSA/IHN0cmVhbS5fcmF3TWluQnVmZmVyTGVuZ3RoIDogc3RyZWFtLmxlbmd0aDsKICAgIH0KCiAgICBzdXBlcihtYXliZUxlbmd0aCk7CiAgICB0aGlzLnN0cmVhbXMgPSBzdHJlYW1zOwogICAgdGhpcy5fb25FcnJvciA9IG9uRXJyb3I7CiAgfQoKICByZWFkQmxvY2soKSB7CiAgICBjb25zdCBzdHJlYW1zID0gdGhpcy5zdHJlYW1zOwoKICAgIGlmIChzdHJlYW1zLmxlbmd0aCA9PT0gMCkgewogICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBzdHJlYW0gPSBzdHJlYW1zLnNoaWZ0KCk7CiAgICBsZXQgY2h1bms7CgogICAgdHJ5IHsKICAgICAgY2h1bmsgPSBzdHJlYW0uZ2V0Qnl0ZXMoKTsKICAgIH0gY2F0Y2ggKHJlYXNvbikgewogICAgICBpZiAodGhpcy5fb25FcnJvcikgewogICAgICAgIHRoaXMuX29uRXJyb3IocmVhc29uLCBzdHJlYW0uZGljdCAmJiBzdHJlYW0uZGljdC5vYmpJZCk7CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhyb3cgcmVhc29uOwogICAgfQoKICAgIGNvbnN0IGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyTGVuZ3RoOwogICAgY29uc3QgbmV3TGVuZ3RoID0gYnVmZmVyTGVuZ3RoICsgY2h1bmsubGVuZ3RoOwogICAgY29uc3QgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIobmV3TGVuZ3RoKTsKICAgIGJ1ZmZlci5zZXQoY2h1bmssIGJ1ZmZlckxlbmd0aCk7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IG5ld0xlbmd0aDsKICB9CgogIGdldEJhc2VTdHJlYW1zKCkgewogICAgY29uc3QgYmFzZVN0cmVhbXNCdWYgPSBbXTsKCiAgICBmb3IgKGNvbnN0IHN0cmVhbSBvZiB0aGlzLnN0cmVhbXMpIHsKICAgICAgY29uc3QgYmFzZVN0cmVhbXMgPSBzdHJlYW0uZ2V0QmFzZVN0cmVhbXMoKTsKCiAgICAgIGlmIChiYXNlU3RyZWFtcykgewogICAgICAgIGJhc2VTdHJlYW1zQnVmLnB1c2goLi4uYmFzZVN0cmVhbXMpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGJhc2VTdHJlYW1zQnVmLmxlbmd0aCA+IDAgPyBiYXNlU3RyZWFtc0J1ZiA6IG51bGw7CiAgfQoKfQoKZXhwb3J0cy5TdHJlYW1zU2VxdWVuY2VTdHJlYW0gPSBTdHJlYW1zU2VxdWVuY2VTdHJlYW07CgovKioqLyB9KSwKLyogMTQ1ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Bc2NpaUhleFN0cmVhbSA9IHZvaWQgMDsKCnZhciBfZGVjb2RlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ0KTsKCmNsYXNzIEFzY2lpSGV4U3RyZWFtIGV4dGVuZHMgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHIsIG1heWJlTGVuZ3RoKSB7CiAgICBpZiAobWF5YmVMZW5ndGgpIHsKICAgICAgbWF5YmVMZW5ndGggKj0gMC41OwogICAgfQoKICAgIHN1cGVyKG1heWJlTGVuZ3RoKTsKICAgIHRoaXMuc3RyID0gc3RyOwogICAgdGhpcy5kaWN0ID0gc3RyLmRpY3Q7CiAgICB0aGlzLmZpcnN0RGlnaXQgPSAtMTsKICB9CgogIHJlYWRCbG9jaygpIHsKICAgIGNvbnN0IFVQU1RSRUFNX0JMT0NLX1NJWkUgPSA4MDAwOwogICAgY29uc3QgYnl0ZXMgPSB0aGlzLnN0ci5nZXRCeXRlcyhVUFNUUkVBTV9CTE9DS19TSVpFKTsKCiAgICBpZiAoIWJ5dGVzLmxlbmd0aCkgewogICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBtYXhEZWNvZGVMZW5ndGggPSBieXRlcy5sZW5ndGggKyAxID4+IDE7CiAgICBjb25zdCBidWZmZXIgPSB0aGlzLmVuc3VyZUJ1ZmZlcih0aGlzLmJ1ZmZlckxlbmd0aCArIG1heERlY29kZUxlbmd0aCk7CiAgICBsZXQgYnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXJMZW5ndGg7CiAgICBsZXQgZmlyc3REaWdpdCA9IHRoaXMuZmlyc3REaWdpdDsKCiAgICBmb3IgKGNvbnN0IGNoIG9mIGJ5dGVzKSB7CiAgICAgIGxldCBkaWdpdDsKCiAgICAgIGlmIChjaCA+PSAweDMwICYmIGNoIDw9IDB4MzkpIHsKICAgICAgICBkaWdpdCA9IGNoICYgMHgwZjsKICAgICAgfSBlbHNlIGlmIChjaCA+PSAweDQxICYmIGNoIDw9IDB4NDYgfHwgY2ggPj0gMHg2MSAmJiBjaCA8PSAweDY2KSB7CiAgICAgICAgZGlnaXQgPSAoY2ggJiAweDBmKSArIDk7CiAgICAgIH0gZWxzZSBpZiAoY2ggPT09IDB4M2UpIHsKICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgICAgYnJlYWs7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChmaXJzdERpZ2l0IDwgMCkgewogICAgICAgIGZpcnN0RGlnaXQgPSBkaWdpdDsKICAgICAgfSBlbHNlIHsKICAgICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoKytdID0gZmlyc3REaWdpdCA8PCA0IHwgZGlnaXQ7CiAgICAgICAgZmlyc3REaWdpdCA9IC0xOwogICAgICB9CiAgICB9CgogICAgaWYgKGZpcnN0RGlnaXQgPj0gMCAmJiB0aGlzLmVvZikgewogICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoKytdID0gZmlyc3REaWdpdCA8PCA0OwogICAgICBmaXJzdERpZ2l0ID0gLTE7CiAgICB9CgogICAgdGhpcy5maXJzdERpZ2l0ID0gZmlyc3REaWdpdDsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gYnVmZmVyTGVuZ3RoOwogIH0KCn0KCmV4cG9ydHMuQXNjaWlIZXhTdHJlYW0gPSBBc2NpaUhleFN0cmVhbTsKCi8qKiovIH0pLAovKiAxNDYgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkNDSVRURmF4U3RyZWFtID0gdm9pZCAwOwoKdmFyIF9jY2l0dCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ3KTsKCnZhciBfZGVjb2RlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ0KTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMwKTsKCmNsYXNzIENDSVRURmF4U3RyZWFtIGV4dGVuZHMgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHIsIG1heWJlTGVuZ3RoLCBwYXJhbXMpIHsKICAgIHN1cGVyKG1heWJlTGVuZ3RoKTsKICAgIHRoaXMuc3RyID0gc3RyOwogICAgdGhpcy5kaWN0ID0gc3RyLmRpY3Q7CgogICAgaWYgKCEocGFyYW1zIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcGFyYW1zID0gX3ByaW1pdGl2ZXMuRGljdC5lbXB0eTsKICAgIH0KCiAgICBjb25zdCBzb3VyY2UgPSB7CiAgICAgIG5leHQoKSB7CiAgICAgICAgcmV0dXJuIHN0ci5nZXRCeXRlKCk7CiAgICAgIH0KCiAgICB9OwogICAgdGhpcy5jY2l0dEZheERlY29kZXIgPSBuZXcgX2NjaXR0LkNDSVRURmF4RGVjb2Rlcihzb3VyY2UsIHsKICAgICAgSzogcGFyYW1zLmdldCgiSyIpLAogICAgICBFbmRPZkxpbmU6IHBhcmFtcy5nZXQoIkVuZE9mTGluZSIpLAogICAgICBFbmNvZGVkQnl0ZUFsaWduOiBwYXJhbXMuZ2V0KCJFbmNvZGVkQnl0ZUFsaWduIiksCiAgICAgIENvbHVtbnM6IHBhcmFtcy5nZXQoIkNvbHVtbnMiKSwKICAgICAgUm93czogcGFyYW1zLmdldCgiUm93cyIpLAogICAgICBFbmRPZkJsb2NrOiBwYXJhbXMuZ2V0KCJFbmRPZkJsb2NrIiksCiAgICAgIEJsYWNrSXMxOiBwYXJhbXMuZ2V0KCJCbGFja0lzMSIpCiAgICB9KTsKICB9CgogIHJlYWRCbG9jaygpIHsKICAgIHdoaWxlICghdGhpcy5lb2YpIHsKICAgICAgY29uc3QgYyA9IHRoaXMuY2NpdHRGYXhEZWNvZGVyLnJlYWROZXh0Q2hhcigpOwoKICAgICAgaWYgKGMgPT09IC0xKSB7CiAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5lbnN1cmVCdWZmZXIodGhpcy5idWZmZXJMZW5ndGggKyAxKTsKICAgICAgdGhpcy5idWZmZXJbdGhpcy5idWZmZXJMZW5ndGgrK10gPSBjOwogICAgfQogIH0KCn0KCmV4cG9ydHMuQ0NJVFRGYXhTdHJlYW0gPSBDQ0lUVEZheFN0cmVhbTsKCi8qKiovIH0pLAovKiAxNDcgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkNDSVRURmF4RGVjb2RlciA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgpjb25zdCBjY2l0dEVPTCA9IC0yOwpjb25zdCBjY2l0dEVPRiA9IC0xOwpjb25zdCB0d29EaW1QYXNzID0gMDsKY29uc3QgdHdvRGltSG9yaXogPSAxOwpjb25zdCB0d29EaW1WZXJ0MCA9IDI7CmNvbnN0IHR3b0RpbVZlcnRSMSA9IDM7CmNvbnN0IHR3b0RpbVZlcnRMMSA9IDQ7CmNvbnN0IHR3b0RpbVZlcnRSMiA9IDU7CmNvbnN0IHR3b0RpbVZlcnRMMiA9IDY7CmNvbnN0IHR3b0RpbVZlcnRSMyA9IDc7CmNvbnN0IHR3b0RpbVZlcnRMMyA9IDg7CmNvbnN0IHR3b0RpbVRhYmxlID0gW1stMSwgLTFdLCBbLTEsIC0xXSwgWzcsIHR3b0RpbVZlcnRMM10sIFs3LCB0d29EaW1WZXJ0UjNdLCBbNiwgdHdvRGltVmVydEwyXSwgWzYsIHR3b0RpbVZlcnRMMl0sIFs2LCB0d29EaW1WZXJ0UjJdLCBbNiwgdHdvRGltVmVydFIyXSwgWzQsIHR3b0RpbVBhc3NdLCBbNCwgdHdvRGltUGFzc10sIFs0LCB0d29EaW1QYXNzXSwgWzQsIHR3b0RpbVBhc3NdLCBbNCwgdHdvRGltUGFzc10sIFs0LCB0d29EaW1QYXNzXSwgWzQsIHR3b0RpbVBhc3NdLCBbNCwgdHdvRGltUGFzc10sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1Ib3Jpel0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXSwgWzEsIHR3b0RpbVZlcnQwXV07CmNvbnN0IHdoaXRlVGFibGUxID0gW1stMSwgLTFdLCBbMTIsIGNjaXR0RU9MXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbMTEsIDE3OTJdLCBbMTEsIDE3OTJdLCBbMTIsIDE5ODRdLCBbMTIsIDIwNDhdLCBbMTIsIDIxMTJdLCBbMTIsIDIxNzZdLCBbMTIsIDIyNDBdLCBbMTIsIDIzMDRdLCBbMTEsIDE4NTZdLCBbMTEsIDE4NTZdLCBbMTEsIDE5MjBdLCBbMTEsIDE5MjBdLCBbMTIsIDIzNjhdLCBbMTIsIDI0MzJdLCBbMTIsIDI0OTZdLCBbMTIsIDI1NjBdXTsKY29uc3Qgd2hpdGVUYWJsZTIgPSBbWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFs4LCAyOV0sIFs4LCAyOV0sIFs4LCAzMF0sIFs4LCAzMF0sIFs4LCA0NV0sIFs4LCA0NV0sIFs4LCA0Nl0sIFs4LCA0Nl0sIFs3LCAyMl0sIFs3LCAyMl0sIFs3LCAyMl0sIFs3LCAyMl0sIFs3LCAyM10sIFs3LCAyM10sIFs3LCAyM10sIFs3LCAyM10sIFs4LCA0N10sIFs4LCA0N10sIFs4LCA0OF0sIFs4LCA0OF0sIFs2LCAxM10sIFs2LCAxM10sIFs2LCAxM10sIFs2LCAxM10sIFs2LCAxM10sIFs2LCAxM10sIFs2LCAxM10sIFs2LCAxM10sIFs3LCAyMF0sIFs3LCAyMF0sIFs3LCAyMF0sIFs3LCAyMF0sIFs4LCAzM10sIFs4LCAzM10sIFs4LCAzNF0sIFs4LCAzNF0sIFs4LCAzNV0sIFs4LCAzNV0sIFs4LCAzNl0sIFs4LCAzNl0sIFs4LCAzN10sIFs4LCAzN10sIFs4LCAzOF0sIFs4LCAzOF0sIFs3LCAxOV0sIFs3LCAxOV0sIFs3LCAxOV0sIFs3LCAxOV0sIFs4LCAzMV0sIFs4LCAzMV0sIFs4LCAzMl0sIFs4LCAzMl0sIFs2LCAxXSwgWzYsIDFdLCBbNiwgMV0sIFs2LCAxXSwgWzYsIDFdLCBbNiwgMV0sIFs2LCAxXSwgWzYsIDFdLCBbNiwgMTJdLCBbNiwgMTJdLCBbNiwgMTJdLCBbNiwgMTJdLCBbNiwgMTJdLCBbNiwgMTJdLCBbNiwgMTJdLCBbNiwgMTJdLCBbOCwgNTNdLCBbOCwgNTNdLCBbOCwgNTRdLCBbOCwgNTRdLCBbNywgMjZdLCBbNywgMjZdLCBbNywgMjZdLCBbNywgMjZdLCBbOCwgMzldLCBbOCwgMzldLCBbOCwgNDBdLCBbOCwgNDBdLCBbOCwgNDFdLCBbOCwgNDFdLCBbOCwgNDJdLCBbOCwgNDJdLCBbOCwgNDNdLCBbOCwgNDNdLCBbOCwgNDRdLCBbOCwgNDRdLCBbNywgMjFdLCBbNywgMjFdLCBbNywgMjFdLCBbNywgMjFdLCBbNywgMjhdLCBbNywgMjhdLCBbNywgMjhdLCBbNywgMjhdLCBbOCwgNjFdLCBbOCwgNjFdLCBbOCwgNjJdLCBbOCwgNjJdLCBbOCwgNjNdLCBbOCwgNjNdLCBbOCwgMF0sIFs4LCAwXSwgWzgsIDMyMF0sIFs4LCAzMjBdLCBbOCwgMzg0XSwgWzgsIDM4NF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMF0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs1LCAxMV0sIFs3LCAyN10sIFs3LCAyN10sIFs3LCAyN10sIFs3LCAyN10sIFs4LCA1OV0sIFs4LCA1OV0sIFs4LCA2MF0sIFs4LCA2MF0sIFs5LCAxNDcyXSwgWzksIDE1MzZdLCBbOSwgMTYwMF0sIFs5LCAxNzI4XSwgWzcsIDE4XSwgWzcsIDE4XSwgWzcsIDE4XSwgWzcsIDE4XSwgWzcsIDI0XSwgWzcsIDI0XSwgWzcsIDI0XSwgWzcsIDI0XSwgWzgsIDQ5XSwgWzgsIDQ5XSwgWzgsIDUwXSwgWzgsIDUwXSwgWzgsIDUxXSwgWzgsIDUxXSwgWzgsIDUyXSwgWzgsIDUyXSwgWzcsIDI1XSwgWzcsIDI1XSwgWzcsIDI1XSwgWzcsIDI1XSwgWzgsIDU1XSwgWzgsIDU1XSwgWzgsIDU2XSwgWzgsIDU2XSwgWzgsIDU3XSwgWzgsIDU3XSwgWzgsIDU4XSwgWzgsIDU4XSwgWzYsIDE5Ml0sIFs2LCAxOTJdLCBbNiwgMTkyXSwgWzYsIDE5Ml0sIFs2LCAxOTJdLCBbNiwgMTkyXSwgWzYsIDE5Ml0sIFs2LCAxOTJdLCBbNiwgMTY2NF0sIFs2LCAxNjY0XSwgWzYsIDE2NjRdLCBbNiwgMTY2NF0sIFs2LCAxNjY0XSwgWzYsIDE2NjRdLCBbNiwgMTY2NF0sIFs2LCAxNjY0XSwgWzgsIDQ0OF0sIFs4LCA0NDhdLCBbOCwgNTEyXSwgWzgsIDUxMl0sIFs5LCA3MDRdLCBbOSwgNzY4XSwgWzgsIDY0MF0sIFs4LCA2NDBdLCBbOCwgNTc2XSwgWzgsIDU3Nl0sIFs5LCA4MzJdLCBbOSwgODk2XSwgWzksIDk2MF0sIFs5LCAxMDI0XSwgWzksIDEwODhdLCBbOSwgMTE1Ml0sIFs5LCAxMjE2XSwgWzksIDEyODBdLCBbOSwgMTM0NF0sIFs5LCAxNDA4XSwgWzcsIDI1Nl0sIFs3LCAyNTZdLCBbNywgMjU2XSwgWzcsIDI1Nl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNiwgMTZdLCBbNiwgMTZdLCBbNiwgMTZdLCBbNiwgMTZdLCBbNiwgMTZdLCBbNiwgMTZdLCBbNiwgMTZdLCBbNiwgMTZdLCBbNiwgMTddLCBbNiwgMTddLCBbNiwgMTddLCBbNiwgMTddLCBbNiwgMTddLCBbNiwgMTddLCBbNiwgMTddLCBbNiwgMTddLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs2LCAxNF0sIFs2LCAxNF0sIFs2LCAxNF0sIFs2LCAxNF0sIFs2LCAxNF0sIFs2LCAxNF0sIFs2LCAxNF0sIFs2LCAxNF0sIFs2LCAxNV0sIFs2LCAxNV0sIFs2LCAxNV0sIFs2LCAxNV0sIFs2LCAxNV0sIFs2LCAxNV0sIFs2LCAxNV0sIFs2LCAxNV0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs1LCA2NF0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XV07CmNvbnN0IGJsYWNrVGFibGUxID0gW1stMSwgLTFdLCBbLTEsIC0xXSwgWzEyLCBjY2l0dEVPTF0sIFsxMiwgY2NpdHRFT0xdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWzExLCAxNzkyXSwgWzExLCAxNzkyXSwgWzExLCAxNzkyXSwgWzExLCAxNzkyXSwgWzEyLCAxOTg0XSwgWzEyLCAxOTg0XSwgWzEyLCAyMDQ4XSwgWzEyLCAyMDQ4XSwgWzEyLCAyMTEyXSwgWzEyLCAyMTEyXSwgWzEyLCAyMTc2XSwgWzEyLCAyMTc2XSwgWzEyLCAyMjQwXSwgWzEyLCAyMjQwXSwgWzEyLCAyMzA0XSwgWzEyLCAyMzA0XSwgWzExLCAxODU2XSwgWzExLCAxODU2XSwgWzExLCAxODU2XSwgWzExLCAxODU2XSwgWzExLCAxOTIwXSwgWzExLCAxOTIwXSwgWzExLCAxOTIwXSwgWzExLCAxOTIwXSwgWzEyLCAyMzY4XSwgWzEyLCAyMzY4XSwgWzEyLCAyNDMyXSwgWzEyLCAyNDMyXSwgWzEyLCAyNDk2XSwgWzEyLCAyNDk2XSwgWzEyLCAyNTYwXSwgWzEyLCAyNTYwXSwgWzEwLCAxOF0sIFsxMCwgMThdLCBbMTAsIDE4XSwgWzEwLCAxOF0sIFsxMCwgMThdLCBbMTAsIDE4XSwgWzEwLCAxOF0sIFsxMCwgMThdLCBbMTIsIDUyXSwgWzEyLCA1Ml0sIFsxMywgNjQwXSwgWzEzLCA3MDRdLCBbMTMsIDc2OF0sIFsxMywgODMyXSwgWzEyLCA1NV0sIFsxMiwgNTVdLCBbMTIsIDU2XSwgWzEyLCA1Nl0sIFsxMywgMTI4MF0sIFsxMywgMTM0NF0sIFsxMywgMTQwOF0sIFsxMywgMTQ3Ml0sIFsxMiwgNTldLCBbMTIsIDU5XSwgWzEyLCA2MF0sIFsxMiwgNjBdLCBbMTMsIDE1MzZdLCBbMTMsIDE2MDBdLCBbMTEsIDI0XSwgWzExLCAyNF0sIFsxMSwgMjRdLCBbMTEsIDI0XSwgWzExLCAyNV0sIFsxMSwgMjVdLCBbMTEsIDI1XSwgWzExLCAyNV0sIFsxMywgMTY2NF0sIFsxMywgMTcyOF0sIFsxMiwgMzIwXSwgWzEyLCAzMjBdLCBbMTIsIDM4NF0sIFsxMiwgMzg0XSwgWzEyLCA0NDhdLCBbMTIsIDQ0OF0sIFsxMywgNTEyXSwgWzEzLCA1NzZdLCBbMTIsIDUzXSwgWzEyLCA1M10sIFsxMiwgNTRdLCBbMTIsIDU0XSwgWzEzLCA4OTZdLCBbMTMsIDk2MF0sIFsxMywgMTAyNF0sIFsxMywgMTA4OF0sIFsxMywgMTE1Ml0sIFsxMywgMTIxNl0sIFsxMCwgNjRdLCBbMTAsIDY0XSwgWzEwLCA2NF0sIFsxMCwgNjRdLCBbMTAsIDY0XSwgWzEwLCA2NF0sIFsxMCwgNjRdLCBbMTAsIDY0XV07CmNvbnN0IGJsYWNrVGFibGUyID0gW1s4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFs4LCAxM10sIFsxMSwgMjNdLCBbMTEsIDIzXSwgWzEyLCA1MF0sIFsxMiwgNTFdLCBbMTIsIDQ0XSwgWzEyLCA0NV0sIFsxMiwgNDZdLCBbMTIsIDQ3XSwgWzEyLCA1N10sIFsxMiwgNThdLCBbMTIsIDYxXSwgWzEyLCAyNTZdLCBbMTAsIDE2XSwgWzEwLCAxNl0sIFsxMCwgMTZdLCBbMTAsIDE2XSwgWzEwLCAxN10sIFsxMCwgMTddLCBbMTAsIDE3XSwgWzEwLCAxN10sIFsxMiwgNDhdLCBbMTIsIDQ5XSwgWzEyLCA2Ml0sIFsxMiwgNjNdLCBbMTIsIDMwXSwgWzEyLCAzMV0sIFsxMiwgMzJdLCBbMTIsIDMzXSwgWzEyLCA0MF0sIFsxMiwgNDFdLCBbMTEsIDIyXSwgWzExLCAyMl0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs4LCAxNF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMF0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs3LCAxMV0sIFs5LCAxNV0sIFs5LCAxNV0sIFs5LCAxNV0sIFs5LCAxNV0sIFs5LCAxNV0sIFs5LCAxNV0sIFs5LCAxNV0sIFs5LCAxNV0sIFsxMiwgMTI4XSwgWzEyLCAxOTJdLCBbMTIsIDI2XSwgWzEyLCAyN10sIFsxMiwgMjhdLCBbMTIsIDI5XSwgWzExLCAxOV0sIFsxMSwgMTldLCBbMTEsIDIwXSwgWzExLCAyMF0sIFsxMiwgMzRdLCBbMTIsIDM1XSwgWzEyLCAzNl0sIFsxMiwgMzddLCBbMTIsIDM4XSwgWzEyLCAzOV0sIFsxMSwgMjFdLCBbMTEsIDIxXSwgWzEyLCA0Ml0sIFsxMiwgNDNdLCBbMTAsIDBdLCBbMTAsIDBdLCBbMTAsIDBdLCBbMTAsIDBdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdLCBbNywgMTJdXTsKY29uc3QgYmxhY2tUYWJsZTMgPSBbWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFs2LCA5XSwgWzYsIDhdLCBbNSwgN10sIFs1LCA3XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFszLCAxXSwgWzMsIDFdLCBbMywgMV0sIFszLCAxXSwgWzMsIDFdLCBbMywgMV0sIFszLCAxXSwgWzMsIDFdLCBbMywgNF0sIFszLCA0XSwgWzMsIDRdLCBbMywgNF0sIFszLCA0XSwgWzMsIDRdLCBbMywgNF0sIFszLCA0XSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl1dOwoKY2xhc3MgQ0NJVFRGYXhEZWNvZGVyIHsKICBjb25zdHJ1Y3Rvcihzb3VyY2UpIHsKICAgIGxldCBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKCiAgICBpZiAoIXNvdXJjZSB8fCB0eXBlb2Ygc291cmNlLm5leHQgIT09ICJmdW5jdGlvbiIpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdDQ0lUVEZheERlY29kZXIgLSBpbnZhbGlkICJzb3VyY2UiIHBhcmFtZXRlci4nKTsKICAgIH0KCiAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTsKICAgIHRoaXMuZW9mID0gZmFsc2U7CiAgICB0aGlzLmVuY29kaW5nID0gb3B0aW9ucy5LIHx8IDA7CiAgICB0aGlzLmVvbGluZSA9IG9wdGlvbnMuRW5kT2ZMaW5lIHx8IGZhbHNlOwogICAgdGhpcy5ieXRlQWxpZ24gPSBvcHRpb25zLkVuY29kZWRCeXRlQWxpZ24gfHwgZmFsc2U7CiAgICB0aGlzLmNvbHVtbnMgPSBvcHRpb25zLkNvbHVtbnMgfHwgMTcyODsKICAgIHRoaXMucm93cyA9IG9wdGlvbnMuUm93cyB8fCAwOwogICAgbGV0IGVvYmxvY2sgPSBvcHRpb25zLkVuZE9mQmxvY2s7CgogICAgaWYgKGVvYmxvY2sgPT09IG51bGwgfHwgZW9ibG9jayA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGVvYmxvY2sgPSB0cnVlOwogICAgfQoKICAgIHRoaXMuZW9ibG9jayA9IGVvYmxvY2s7CiAgICB0aGlzLmJsYWNrID0gb3B0aW9ucy5CbGFja0lzMSB8fCBmYWxzZTsKICAgIHRoaXMuY29kaW5nTGluZSA9IG5ldyBVaW50MzJBcnJheSh0aGlzLmNvbHVtbnMgKyAxKTsKICAgIHRoaXMucmVmTGluZSA9IG5ldyBVaW50MzJBcnJheSh0aGlzLmNvbHVtbnMgKyAyKTsKICAgIHRoaXMuY29kaW5nTGluZVswXSA9IHRoaXMuY29sdW1uczsKICAgIHRoaXMuY29kaW5nUG9zID0gMDsKICAgIHRoaXMucm93ID0gMDsKICAgIHRoaXMubmV4dExpbmUyRCA9IHRoaXMuZW5jb2RpbmcgPCAwOwogICAgdGhpcy5pbnB1dEJpdHMgPSAwOwogICAgdGhpcy5pbnB1dEJ1ZiA9IDA7CiAgICB0aGlzLm91dHB1dEJpdHMgPSAwOwogICAgdGhpcy5yb3dzRG9uZSA9IGZhbHNlOwogICAgbGV0IGNvZGUxOwoKICAgIHdoaWxlICgoY29kZTEgPSB0aGlzLl9sb29rQml0cygxMikpID09PSAwKSB7CiAgICAgIHRoaXMuX2VhdEJpdHMoMSk7CiAgICB9CgogICAgaWYgKGNvZGUxID09PSAxKSB7CiAgICAgIHRoaXMuX2VhdEJpdHMoMTIpOwogICAgfQoKICAgIGlmICh0aGlzLmVuY29kaW5nID4gMCkgewogICAgICB0aGlzLm5leHRMaW5lMkQgPSAhdGhpcy5fbG9va0JpdHMoMSk7CgogICAgICB0aGlzLl9lYXRCaXRzKDEpOwogICAgfQogIH0KCiAgcmVhZE5leHRDaGFyKCkgewogICAgaWYgKHRoaXMuZW9mKSB7CiAgICAgIHJldHVybiAtMTsKICAgIH0KCiAgICBjb25zdCByZWZMaW5lID0gdGhpcy5yZWZMaW5lOwogICAgY29uc3QgY29kaW5nTGluZSA9IHRoaXMuY29kaW5nTGluZTsKICAgIGNvbnN0IGNvbHVtbnMgPSB0aGlzLmNvbHVtbnM7CiAgICBsZXQgcmVmUG9zLCBibGFja1BpeGVscywgYml0cywgaTsKCiAgICBpZiAodGhpcy5vdXRwdXRCaXRzID09PSAwKSB7CiAgICAgIGlmICh0aGlzLnJvd3NEb25lKSB7CiAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICB9CgogICAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KCiAgICAgIHRoaXMuZXJyID0gZmFsc2U7CiAgICAgIGxldCBjb2RlMSwgY29kZTIsIGNvZGUzOwoKICAgICAgaWYgKHRoaXMubmV4dExpbmUyRCkgewogICAgICAgIGZvciAoaSA9IDA7IGNvZGluZ0xpbmVbaV0gPCBjb2x1bW5zOyArK2kpIHsKICAgICAgICAgIHJlZkxpbmVbaV0gPSBjb2RpbmdMaW5lW2ldOwogICAgICAgIH0KCiAgICAgICAgcmVmTGluZVtpKytdID0gY29sdW1uczsKICAgICAgICByZWZMaW5lW2ldID0gY29sdW1uczsKICAgICAgICBjb2RpbmdMaW5lWzBdID0gMDsKICAgICAgICB0aGlzLmNvZGluZ1BvcyA9IDA7CiAgICAgICAgcmVmUG9zID0gMDsKICAgICAgICBibGFja1BpeGVscyA9IDA7CgogICAgICAgIHdoaWxlIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgIGNvZGUxID0gdGhpcy5fZ2V0VHdvRGltQ29kZSgpOwoKICAgICAgICAgIHN3aXRjaCAoY29kZTEpIHsKICAgICAgICAgICAgY2FzZSB0d29EaW1QYXNzOgogICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVscyhyZWZMaW5lW3JlZlBvcyArIDFdLCBibGFja1BpeGVscyk7CgogICAgICAgICAgICAgIGlmIChyZWZMaW5lW3JlZlBvcyArIDFdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgcmVmUG9zICs9IDI7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgdHdvRGltSG9yaXo6CiAgICAgICAgICAgICAgY29kZTEgPSBjb2RlMiA9IDA7CgogICAgICAgICAgICAgIGlmIChibGFja1BpeGVscykgewogICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICBjb2RlMSArPSBjb2RlMyA9IHRoaXMuX2dldEJsYWNrQ29kZSgpOwogICAgICAgICAgICAgICAgfSB3aGlsZSAoY29kZTMgPj0gNjQpOwoKICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgY29kZTIgKz0gY29kZTMgPSB0aGlzLl9nZXRXaGl0ZUNvZGUoKTsKICAgICAgICAgICAgICAgIH0gd2hpbGUgKGNvZGUzID49IDY0KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICBjb2RlMSArPSBjb2RlMyA9IHRoaXMuX2dldFdoaXRlQ29kZSgpOwogICAgICAgICAgICAgICAgfSB3aGlsZSAoY29kZTMgPj0gNjQpOwoKICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgY29kZTIgKz0gY29kZTMgPSB0aGlzLl9nZXRCbGFja0NvZGUoKTsKICAgICAgICAgICAgICAgIH0gd2hpbGUgKGNvZGUzID49IDY0KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVscyhjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSArIGNvZGUxLCBibGFja1BpeGVscyk7CgogICAgICAgICAgICAgIGlmIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVscyhjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSArIGNvZGUyLCBibGFja1BpeGVscyBeIDEpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgd2hpbGUgKHJlZkxpbmVbcmVmUG9zXSA8PSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAmJiByZWZMaW5lW3JlZlBvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICByZWZQb3MgKz0gMjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSB0d29EaW1WZXJ0UjM6CiAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzKHJlZkxpbmVbcmVmUG9zXSArIDMsIGJsYWNrUGl4ZWxzKTsKCiAgICAgICAgICAgICAgYmxhY2tQaXhlbHMgXj0gMTsKCiAgICAgICAgICAgICAgaWYgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgKytyZWZQb3M7CgogICAgICAgICAgICAgICAgd2hpbGUgKHJlZkxpbmVbcmVmUG9zXSA8PSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAmJiByZWZMaW5lW3JlZlBvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICAgIHJlZlBvcyArPSAyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIHR3b0RpbVZlcnRSMjoKICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHMocmVmTGluZVtyZWZQb3NdICsgMiwgYmxhY2tQaXhlbHMpOwoKICAgICAgICAgICAgICBibGFja1BpeGVscyBePSAxOwoKICAgICAgICAgICAgICBpZiAoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICArK3JlZlBvczsKCiAgICAgICAgICAgICAgICB3aGlsZSAocmVmTGluZVtyZWZQb3NdIDw9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdICYmIHJlZkxpbmVbcmVmUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgcmVmUG9zICs9IDI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgdHdvRGltVmVydFIxOgogICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVscyhyZWZMaW5lW3JlZlBvc10gKyAxLCBibGFja1BpeGVscyk7CgogICAgICAgICAgICAgIGJsYWNrUGl4ZWxzIF49IDE7CgogICAgICAgICAgICAgIGlmIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICsrcmVmUG9zOwoKICAgICAgICAgICAgICAgIHdoaWxlIChyZWZMaW5lW3JlZlBvc10gPD0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gJiYgcmVmTGluZVtyZWZQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICByZWZQb3MgKz0gMjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSB0d29EaW1WZXJ0MDoKICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHMocmVmTGluZVtyZWZQb3NdLCBibGFja1BpeGVscyk7CgogICAgICAgICAgICAgIGJsYWNrUGl4ZWxzIF49IDE7CgogICAgICAgICAgICAgIGlmIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICsrcmVmUG9zOwoKICAgICAgICAgICAgICAgIHdoaWxlIChyZWZMaW5lW3JlZlBvc10gPD0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gJiYgcmVmTGluZVtyZWZQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICByZWZQb3MgKz0gMjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSB0d29EaW1WZXJ0TDM6CiAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzTmVnKHJlZkxpbmVbcmVmUG9zXSAtIDMsIGJsYWNrUGl4ZWxzKTsKCiAgICAgICAgICAgICAgYmxhY2tQaXhlbHMgXj0gMTsKCiAgICAgICAgICAgICAgaWYgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgaWYgKHJlZlBvcyA+IDApIHsKICAgICAgICAgICAgICAgICAgLS1yZWZQb3M7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICArK3JlZlBvczsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB3aGlsZSAocmVmTGluZVtyZWZQb3NdIDw9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdICYmIHJlZkxpbmVbcmVmUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgcmVmUG9zICs9IDI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgdHdvRGltVmVydEwyOgogICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVsc05lZyhyZWZMaW5lW3JlZlBvc10gLSAyLCBibGFja1BpeGVscyk7CgogICAgICAgICAgICAgIGJsYWNrUGl4ZWxzIF49IDE7CgogICAgICAgICAgICAgIGlmIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgIGlmIChyZWZQb3MgPiAwKSB7CiAgICAgICAgICAgICAgICAgIC0tcmVmUG9zOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgKytyZWZQb3M7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgd2hpbGUgKHJlZkxpbmVbcmVmUG9zXSA8PSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAmJiByZWZMaW5lW3JlZlBvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICAgIHJlZlBvcyArPSAyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIHR3b0RpbVZlcnRMMToKICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHNOZWcocmVmTGluZVtyZWZQb3NdIC0gMSwgYmxhY2tQaXhlbHMpOwoKICAgICAgICAgICAgICBibGFja1BpeGVscyBePSAxOwoKICAgICAgICAgICAgICBpZiAoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICBpZiAocmVmUG9zID4gMCkgewogICAgICAgICAgICAgICAgICAtLXJlZlBvczsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICsrcmVmUG9zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHdoaWxlIChyZWZMaW5lW3JlZlBvc10gPD0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gJiYgcmVmTGluZVtyZWZQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICByZWZQb3MgKz0gMjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBjY2l0dEVPRjoKICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHMoY29sdW1ucywgMCk7CgogICAgICAgICAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJiYWQgMmQgY29kZSIpOwoKICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHMoY29sdW1ucywgMCk7CgogICAgICAgICAgICAgIHRoaXMuZXJyID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29kaW5nTGluZVswXSA9IDA7CiAgICAgICAgdGhpcy5jb2RpbmdQb3MgPSAwOwogICAgICAgIGJsYWNrUGl4ZWxzID0gMDsKCiAgICAgICAgd2hpbGUgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgY29kZTEgPSAwOwoKICAgICAgICAgIGlmIChibGFja1BpeGVscykgewogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgY29kZTEgKz0gY29kZTMgPSB0aGlzLl9nZXRCbGFja0NvZGUoKTsKICAgICAgICAgICAgfSB3aGlsZSAoY29kZTMgPj0gNjQpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgIGNvZGUxICs9IGNvZGUzID0gdGhpcy5fZ2V0V2hpdGVDb2RlKCk7CiAgICAgICAgICAgIH0gd2hpbGUgKGNvZGUzID49IDY0KTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLl9hZGRQaXhlbHMoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gKyBjb2RlMSwgYmxhY2tQaXhlbHMpOwoKICAgICAgICAgIGJsYWNrUGl4ZWxzIF49IDE7CiAgICAgICAgfQogICAgICB9CgogICAgICBsZXQgZ290RU9MID0gZmFsc2U7CgogICAgICBpZiAodGhpcy5ieXRlQWxpZ24pIHsKICAgICAgICB0aGlzLmlucHV0Qml0cyAmPSB+NzsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmVvYmxvY2sgJiYgdGhpcy5yb3cgPT09IHRoaXMucm93cyAtIDEpIHsKICAgICAgICB0aGlzLnJvd3NEb25lID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb2RlMSA9IHRoaXMuX2xvb2tCaXRzKDEyKTsKCiAgICAgICAgaWYgKHRoaXMuZW9saW5lKSB7CiAgICAgICAgICB3aGlsZSAoY29kZTEgIT09IGNjaXR0RU9GICYmIGNvZGUxICE9PSAxKSB7CiAgICAgICAgICAgIHRoaXMuX2VhdEJpdHMoMSk7CgogICAgICAgICAgICBjb2RlMSA9IHRoaXMuX2xvb2tCaXRzKDEyKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgd2hpbGUgKGNvZGUxID09PSAwKSB7CiAgICAgICAgICAgIHRoaXMuX2VhdEJpdHMoMSk7CgogICAgICAgICAgICBjb2RlMSA9IHRoaXMuX2xvb2tCaXRzKDEyKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChjb2RlMSA9PT0gMSkgewogICAgICAgICAgdGhpcy5fZWF0Qml0cygxMik7CgogICAgICAgICAgZ290RU9MID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKGNvZGUxID09PSBjY2l0dEVPRikgewogICAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmVvZiAmJiB0aGlzLmVuY29kaW5nID4gMCAmJiAhdGhpcy5yb3dzRG9uZSkgewogICAgICAgIHRoaXMubmV4dExpbmUyRCA9ICF0aGlzLl9sb29rQml0cygxKTsKCiAgICAgICAgdGhpcy5fZWF0Qml0cygxKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZW9ibG9jayAmJiBnb3RFT0wgJiYgdGhpcy5ieXRlQWxpZ24pIHsKICAgICAgICBjb2RlMSA9IHRoaXMuX2xvb2tCaXRzKDEyKTsKCiAgICAgICAgaWYgKGNvZGUxID09PSAxKSB7CiAgICAgICAgICB0aGlzLl9lYXRCaXRzKDEyKTsKCiAgICAgICAgICBpZiAodGhpcy5lbmNvZGluZyA+IDApIHsKICAgICAgICAgICAgdGhpcy5fbG9va0JpdHMoMSk7CgogICAgICAgICAgICB0aGlzLl9lYXRCaXRzKDEpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLmVuY29kaW5nID49IDApIHsKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDQ7ICsraSkgewogICAgICAgICAgICAgIGNvZGUxID0gdGhpcy5fbG9va0JpdHMoMTIpOwoKICAgICAgICAgICAgICBpZiAoY29kZTEgIT09IDEpIHsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiYmFkIHJ0YyBjb2RlOiAiICsgY29kZTEpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy5fZWF0Qml0cygxMik7CgogICAgICAgICAgICAgIGlmICh0aGlzLmVuY29kaW5nID4gMCkgewogICAgICAgICAgICAgICAgdGhpcy5fbG9va0JpdHMoMSk7CgogICAgICAgICAgICAgICAgdGhpcy5fZWF0Qml0cygxKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuZXJyICYmIHRoaXMuZW9saW5lKSB7CiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgIGNvZGUxID0gdGhpcy5fbG9va0JpdHMoMTMpOwoKICAgICAgICAgIGlmIChjb2RlMSA9PT0gY2NpdHRFT0YpIHsKICAgICAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGNvZGUxID4+IDEgPT09IDEpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5fZWF0Qml0cygxKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuX2VhdEJpdHMoMTIpOwoKICAgICAgICBpZiAodGhpcy5lbmNvZGluZyA+IDApIHsKICAgICAgICAgIHRoaXMuX2VhdEJpdHMoMSk7CgogICAgICAgICAgdGhpcy5uZXh0TGluZTJEID0gIShjb2RlMSAmIDEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGNvZGluZ0xpbmVbMF0gPiAwKSB7CiAgICAgICAgdGhpcy5vdXRwdXRCaXRzID0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1BvcyA9IDBdOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMub3V0cHV0Qml0cyA9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3MgPSAxXTsKICAgICAgfQoKICAgICAgdGhpcy5yb3crKzsKICAgIH0KCiAgICBsZXQgYzsKCiAgICBpZiAodGhpcy5vdXRwdXRCaXRzID49IDgpIHsKICAgICAgYyA9IHRoaXMuY29kaW5nUG9zICYgMSA/IDAgOiAweGZmOwogICAgICB0aGlzLm91dHB1dEJpdHMgLT0gODsKCiAgICAgIGlmICh0aGlzLm91dHB1dEJpdHMgPT09IDAgJiYgY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgdGhpcy5jb2RpbmdQb3MrKzsKICAgICAgICB0aGlzLm91dHB1dEJpdHMgPSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAtIGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3MgLSAxXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgYml0cyA9IDg7CiAgICAgIGMgPSAwOwoKICAgICAgZG8gewogICAgICAgIGlmICh0eXBlb2YgdGhpcy5vdXRwdXRCaXRzICE9PSAibnVtYmVyIikgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCdJbnZhbGlkIC9DQ0lUVEZheERlY29kZSBkYXRhLCAib3V0cHV0Qml0cyIgbXVzdCBiZSBhIG51bWJlci4nKTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm91dHB1dEJpdHMgPiBiaXRzKSB7CiAgICAgICAgICBjIDw8PSBiaXRzOwoKICAgICAgICAgIGlmICghKHRoaXMuY29kaW5nUG9zICYgMSkpIHsKICAgICAgICAgICAgYyB8PSAweGZmID4+IDggLSBiaXRzOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMub3V0cHV0Qml0cyAtPSBiaXRzOwogICAgICAgICAgYml0cyA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGMgPDw9IHRoaXMub3V0cHV0Qml0czsKCiAgICAgICAgICBpZiAoISh0aGlzLmNvZGluZ1BvcyAmIDEpKSB7CiAgICAgICAgICAgIGMgfD0gMHhmZiA+PiA4IC0gdGhpcy5vdXRwdXRCaXRzOwogICAgICAgICAgfQoKICAgICAgICAgIGJpdHMgLT0gdGhpcy5vdXRwdXRCaXRzOwogICAgICAgICAgdGhpcy5vdXRwdXRCaXRzID0gMDsKCiAgICAgICAgICBpZiAoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgIHRoaXMuY29kaW5nUG9zKys7CiAgICAgICAgICAgIHRoaXMub3V0cHV0Qml0cyA9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIC0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1BvcyAtIDFdOwogICAgICAgICAgfSBlbHNlIGlmIChiaXRzID4gMCkgewogICAgICAgICAgICBjIDw8PSBiaXRzOwogICAgICAgICAgICBiaXRzID0gMDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gd2hpbGUgKGJpdHMpOwogICAgfQoKICAgIGlmICh0aGlzLmJsYWNrKSB7CiAgICAgIGMgXj0gMHhmZjsKICAgIH0KCiAgICByZXR1cm4gYzsKICB9CgogIF9hZGRQaXhlbHMoYTEsIGJsYWNrUGl4ZWxzKSB7CiAgICBjb25zdCBjb2RpbmdMaW5lID0gdGhpcy5jb2RpbmdMaW5lOwogICAgbGV0IGNvZGluZ1BvcyA9IHRoaXMuY29kaW5nUG9zOwoKICAgIGlmIChhMSA+IGNvZGluZ0xpbmVbY29kaW5nUG9zXSkgewogICAgICBpZiAoYTEgPiB0aGlzLmNvbHVtbnMpIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoInJvdyBpcyB3cm9uZyBsZW5ndGgiKTsKICAgICAgICB0aGlzLmVyciA9IHRydWU7CiAgICAgICAgYTEgPSB0aGlzLmNvbHVtbnM7CiAgICAgIH0KCiAgICAgIGlmIChjb2RpbmdQb3MgJiAxIF4gYmxhY2tQaXhlbHMpIHsKICAgICAgICArK2NvZGluZ1BvczsKICAgICAgfQoKICAgICAgY29kaW5nTGluZVtjb2RpbmdQb3NdID0gYTE7CiAgICB9CgogICAgdGhpcy5jb2RpbmdQb3MgPSBjb2RpbmdQb3M7CiAgfQoKICBfYWRkUGl4ZWxzTmVnKGExLCBibGFja1BpeGVscykgewogICAgY29uc3QgY29kaW5nTGluZSA9IHRoaXMuY29kaW5nTGluZTsKICAgIGxldCBjb2RpbmdQb3MgPSB0aGlzLmNvZGluZ1BvczsKCiAgICBpZiAoYTEgPiBjb2RpbmdMaW5lW2NvZGluZ1Bvc10pIHsKICAgICAgaWYgKGExID4gdGhpcy5jb2x1bW5zKSB7CiAgICAgICAgKDAsIF91dGlsLmluZm8pKCJyb3cgaXMgd3JvbmcgbGVuZ3RoIik7CiAgICAgICAgdGhpcy5lcnIgPSB0cnVlOwogICAgICAgIGExID0gdGhpcy5jb2x1bW5zOwogICAgICB9CgogICAgICBpZiAoY29kaW5nUG9zICYgMSBeIGJsYWNrUGl4ZWxzKSB7CiAgICAgICAgKytjb2RpbmdQb3M7CiAgICAgIH0KCiAgICAgIGNvZGluZ0xpbmVbY29kaW5nUG9zXSA9IGExOwogICAgfSBlbHNlIGlmIChhMSA8IGNvZGluZ0xpbmVbY29kaW5nUG9zXSkgewogICAgICBpZiAoYTEgPCAwKSB7CiAgICAgICAgKDAsIF91dGlsLmluZm8pKCJpbnZhbGlkIGNvZGUiKTsKICAgICAgICB0aGlzLmVyciA9IHRydWU7CiAgICAgICAgYTEgPSAwOwogICAgICB9CgogICAgICB3aGlsZSAoY29kaW5nUG9zID4gMCAmJiBhMSA8IGNvZGluZ0xpbmVbY29kaW5nUG9zIC0gMV0pIHsKICAgICAgICAtLWNvZGluZ1BvczsKICAgICAgfQoKICAgICAgY29kaW5nTGluZVtjb2RpbmdQb3NdID0gYTE7CiAgICB9CgogICAgdGhpcy5jb2RpbmdQb3MgPSBjb2RpbmdQb3M7CiAgfQoKICBfZmluZFRhYmxlQ29kZShzdGFydCwgZW5kLCB0YWJsZSwgbGltaXQpIHsKICAgIGNvbnN0IGxpbWl0VmFsdWUgPSBsaW1pdCB8fCAwOwoKICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8PSBlbmQ7ICsraSkgewogICAgICBsZXQgY29kZSA9IHRoaXMuX2xvb2tCaXRzKGkpOwoKICAgICAgaWYgKGNvZGUgPT09IGNjaXR0RU9GKSB7CiAgICAgICAgcmV0dXJuIFt0cnVlLCAxLCBmYWxzZV07CiAgICAgIH0KCiAgICAgIGlmIChpIDwgZW5kKSB7CiAgICAgICAgY29kZSA8PD0gZW5kIC0gaTsKICAgICAgfQoKICAgICAgaWYgKCFsaW1pdFZhbHVlIHx8IGNvZGUgPj0gbGltaXRWYWx1ZSkgewogICAgICAgIGNvbnN0IHAgPSB0YWJsZVtjb2RlIC0gbGltaXRWYWx1ZV07CgogICAgICAgIGlmIChwWzBdID09PSBpKSB7CiAgICAgICAgICB0aGlzLl9lYXRCaXRzKGkpOwoKICAgICAgICAgIHJldHVybiBbdHJ1ZSwgcFsxXSwgdHJ1ZV07CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIFtmYWxzZSwgMCwgZmFsc2VdOwogIH0KCiAgX2dldFR3b0RpbUNvZGUoKSB7CiAgICBsZXQgY29kZSA9IDA7CiAgICBsZXQgcDsKCiAgICBpZiAodGhpcy5lb2Jsb2NrKSB7CiAgICAgIGNvZGUgPSB0aGlzLl9sb29rQml0cyg3KTsKICAgICAgcCA9IHR3b0RpbVRhYmxlW2NvZGVdOwoKICAgICAgaWYgKHAgJiYgcFswXSA+IDApIHsKICAgICAgICB0aGlzLl9lYXRCaXRzKHBbMF0pOwoKICAgICAgICByZXR1cm4gcFsxXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5fZmluZFRhYmxlQ29kZSgxLCA3LCB0d29EaW1UYWJsZSk7CgogICAgICBpZiAocmVzdWx0WzBdICYmIHJlc3VsdFsyXSkgewogICAgICAgIHJldHVybiByZXN1bHRbMV07CiAgICAgIH0KICAgIH0KCiAgICAoMCwgX3V0aWwuaW5mbykoIkJhZCB0d28gZGltIGNvZGUiKTsKICAgIHJldHVybiBjY2l0dEVPRjsKICB9CgogIF9nZXRXaGl0ZUNvZGUoKSB7CiAgICBsZXQgY29kZSA9IDA7CiAgICBsZXQgcDsKCiAgICBpZiAodGhpcy5lb2Jsb2NrKSB7CiAgICAgIGNvZGUgPSB0aGlzLl9sb29rQml0cygxMik7CgogICAgICBpZiAoY29kZSA9PT0gY2NpdHRFT0YpIHsKICAgICAgICByZXR1cm4gMTsKICAgICAgfQoKICAgICAgaWYgKGNvZGUgPj4gNSA9PT0gMCkgewogICAgICAgIHAgPSB3aGl0ZVRhYmxlMVtjb2RlXTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwID0gd2hpdGVUYWJsZTJbY29kZSA+PiAzXTsKICAgICAgfQoKICAgICAgaWYgKHBbMF0gPiAwKSB7CiAgICAgICAgdGhpcy5fZWF0Qml0cyhwWzBdKTsKCiAgICAgICAgcmV0dXJuIHBbMV07CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGxldCByZXN1bHQgPSB0aGlzLl9maW5kVGFibGVDb2RlKDEsIDksIHdoaXRlVGFibGUyKTsKCiAgICAgIGlmIChyZXN1bHRbMF0pIHsKICAgICAgICByZXR1cm4gcmVzdWx0WzFdOwogICAgICB9CgogICAgICByZXN1bHQgPSB0aGlzLl9maW5kVGFibGVDb2RlKDExLCAxMiwgd2hpdGVUYWJsZTEpOwoKICAgICAgaWYgKHJlc3VsdFswXSkgewogICAgICAgIHJldHVybiByZXN1bHRbMV07CiAgICAgIH0KICAgIH0KCiAgICAoMCwgX3V0aWwuaW5mbykoImJhZCB3aGl0ZSBjb2RlIik7CgogICAgdGhpcy5fZWF0Qml0cygxKTsKCiAgICByZXR1cm4gMTsKICB9CgogIF9nZXRCbGFja0NvZGUoKSB7CiAgICBsZXQgY29kZSwgcDsKCiAgICBpZiAodGhpcy5lb2Jsb2NrKSB7CiAgICAgIGNvZGUgPSB0aGlzLl9sb29rQml0cygxMyk7CgogICAgICBpZiAoY29kZSA9PT0gY2NpdHRFT0YpIHsKICAgICAgICByZXR1cm4gMTsKICAgICAgfQoKICAgICAgaWYgKGNvZGUgPj4gNyA9PT0gMCkgewogICAgICAgIHAgPSBibGFja1RhYmxlMVtjb2RlXTsKICAgICAgfSBlbHNlIGlmIChjb2RlID4+IDkgPT09IDAgJiYgY29kZSA+PiA3ICE9PSAwKSB7CiAgICAgICAgcCA9IGJsYWNrVGFibGUyWyhjb2RlID4+IDEpIC0gNjRdOwogICAgICB9IGVsc2UgewogICAgICAgIHAgPSBibGFja1RhYmxlM1tjb2RlID4+IDddOwogICAgICB9CgogICAgICBpZiAocFswXSA+IDApIHsKICAgICAgICB0aGlzLl9lYXRCaXRzKHBbMF0pOwoKICAgICAgICByZXR1cm4gcFsxXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbGV0IHJlc3VsdCA9IHRoaXMuX2ZpbmRUYWJsZUNvZGUoMiwgNiwgYmxhY2tUYWJsZTMpOwoKICAgICAgaWYgKHJlc3VsdFswXSkgewogICAgICAgIHJldHVybiByZXN1bHRbMV07CiAgICAgIH0KCiAgICAgIHJlc3VsdCA9IHRoaXMuX2ZpbmRUYWJsZUNvZGUoNywgMTIsIGJsYWNrVGFibGUyLCA2NCk7CgogICAgICBpZiAocmVzdWx0WzBdKSB7CiAgICAgICAgcmV0dXJuIHJlc3VsdFsxXTsKICAgICAgfQoKICAgICAgcmVzdWx0ID0gdGhpcy5fZmluZFRhYmxlQ29kZSgxMCwgMTMsIGJsYWNrVGFibGUxKTsKCiAgICAgIGlmIChyZXN1bHRbMF0pIHsKICAgICAgICByZXR1cm4gcmVzdWx0WzFdOwogICAgICB9CiAgICB9CgogICAgKDAsIF91dGlsLmluZm8pKCJiYWQgYmxhY2sgY29kZSIpOwoKICAgIHRoaXMuX2VhdEJpdHMoMSk7CgogICAgcmV0dXJuIDE7CiAgfQoKICBfbG9va0JpdHMobikgewogICAgbGV0IGM7CgogICAgd2hpbGUgKHRoaXMuaW5wdXRCaXRzIDwgbikgewogICAgICBpZiAoKGMgPSB0aGlzLnNvdXJjZS5uZXh0KCkpID09PSAtMSkgewogICAgICAgIGlmICh0aGlzLmlucHV0Qml0cyA9PT0gMCkgewogICAgICAgICAgcmV0dXJuIGNjaXR0RU9GOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXMuaW5wdXRCdWYgPDwgbiAtIHRoaXMuaW5wdXRCaXRzICYgMHhmZmZmID4+IDE2IC0gbjsKICAgICAgfQoKICAgICAgdGhpcy5pbnB1dEJ1ZiA9IHRoaXMuaW5wdXRCdWYgPDwgOCB8IGM7CiAgICAgIHRoaXMuaW5wdXRCaXRzICs9IDg7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuaW5wdXRCdWYgPj4gdGhpcy5pbnB1dEJpdHMgLSBuICYgMHhmZmZmID4+IDE2IC0gbjsKICB9CgogIF9lYXRCaXRzKG4pIHsKICAgIGlmICgodGhpcy5pbnB1dEJpdHMgLT0gbikgPCAwKSB7CiAgICAgIHRoaXMuaW5wdXRCaXRzID0gMDsKICAgIH0KICB9Cgp9CgpleHBvcnRzLkNDSVRURmF4RGVjb2RlciA9IENDSVRURmF4RGVjb2RlcjsKCi8qKiovIH0pLAovKiAxNDggKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkZsYXRlU3RyZWFtID0gdm9pZCAwOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDQpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNvbnN0IGNvZGVMZW5Db2RlTWFwID0gbmV3IEludDMyQXJyYXkoWzE2LCAxNywgMTgsIDAsIDgsIDcsIDksIDYsIDEwLCA1LCAxMSwgNCwgMTIsIDMsIDEzLCAyLCAxNCwgMSwgMTVdKTsKY29uc3QgbGVuZ3RoRGVjb2RlID0gbmV3IEludDMyQXJyYXkoWzB4MDAwMDMsIDB4MDAwMDQsIDB4MDAwMDUsIDB4MDAwMDYsIDB4MDAwMDcsIDB4MDAwMDgsIDB4MDAwMDksIDB4MDAwMGEsIDB4MTAwMGIsIDB4MTAwMGQsIDB4MTAwMGYsIDB4MTAwMTEsIDB4MjAwMTMsIDB4MjAwMTcsIDB4MjAwMWIsIDB4MjAwMWYsIDB4MzAwMjMsIDB4MzAwMmIsIDB4MzAwMzMsIDB4MzAwM2IsIDB4NDAwNDMsIDB4NDAwNTMsIDB4NDAwNjMsIDB4NDAwNzMsIDB4NTAwODMsIDB4NTAwYTMsIDB4NTAwYzMsIDB4NTAwZTMsIDB4MDAxMDIsIDB4MDAxMDIsIDB4MDAxMDJdKTsKY29uc3QgZGlzdERlY29kZSA9IG5ldyBJbnQzMkFycmF5KFsweDAwMDAxLCAweDAwMDAyLCAweDAwMDAzLCAweDAwMDA0LCAweDEwMDA1LCAweDEwMDA3LCAweDIwMDA5LCAweDIwMDBkLCAweDMwMDExLCAweDMwMDE5LCAweDQwMDIxLCAweDQwMDMxLCAweDUwMDQxLCAweDUwMDYxLCAweDYwMDgxLCAweDYwMGMxLCAweDcwMTAxLCAweDcwMTgxLCAweDgwMjAxLCAweDgwMzAxLCAweDkwNDAxLCAweDkwNjAxLCAweGEwODAxLCAweGEwYzAxLCAweGIxMDAxLCAweGIxODAxLCAweGMyMDAxLCAweGMzMDAxLCAweGQ0MDAxLCAweGQ2MDAxXSk7CmNvbnN0IGZpeGVkTGl0Q29kZVRhYiA9IFtuZXcgSW50MzJBcnJheShbMHg3MDEwMCwgMHg4MDA1MCwgMHg4MDAxMCwgMHg4MDExOCwgMHg3MDExMCwgMHg4MDA3MCwgMHg4MDAzMCwgMHg5MDBjMCwgMHg3MDEwOCwgMHg4MDA2MCwgMHg4MDAyMCwgMHg5MDBhMCwgMHg4MDAwMCwgMHg4MDA4MCwgMHg4MDA0MCwgMHg5MDBlMCwgMHg3MDEwNCwgMHg4MDA1OCwgMHg4MDAxOCwgMHg5MDA5MCwgMHg3MDExNCwgMHg4MDA3OCwgMHg4MDAzOCwgMHg5MDBkMCwgMHg3MDEwYywgMHg4MDA2OCwgMHg4MDAyOCwgMHg5MDBiMCwgMHg4MDAwOCwgMHg4MDA4OCwgMHg4MDA0OCwgMHg5MDBmMCwgMHg3MDEwMiwgMHg4MDA1NCwgMHg4MDAxNCwgMHg4MDExYywgMHg3MDExMiwgMHg4MDA3NCwgMHg4MDAzNCwgMHg5MDBjOCwgMHg3MDEwYSwgMHg4MDA2NCwgMHg4MDAyNCwgMHg5MDBhOCwgMHg4MDAwNCwgMHg4MDA4NCwgMHg4MDA0NCwgMHg5MDBlOCwgMHg3MDEwNiwgMHg4MDA1YywgMHg4MDAxYywgMHg5MDA5OCwgMHg3MDExNiwgMHg4MDA3YywgMHg4MDAzYywgMHg5MDBkOCwgMHg3MDEwZSwgMHg4MDA2YywgMHg4MDAyYywgMHg5MDBiOCwgMHg4MDAwYywgMHg4MDA4YywgMHg4MDA0YywgMHg5MDBmOCwgMHg3MDEwMSwgMHg4MDA1MiwgMHg4MDAxMiwgMHg4MDExYSwgMHg3MDExMSwgMHg4MDA3MiwgMHg4MDAzMiwgMHg5MDBjNCwgMHg3MDEwOSwgMHg4MDA2MiwgMHg4MDAyMiwgMHg5MDBhNCwgMHg4MDAwMiwgMHg4MDA4MiwgMHg4MDA0MiwgMHg5MDBlNCwgMHg3MDEwNSwgMHg4MDA1YSwgMHg4MDAxYSwgMHg5MDA5NCwgMHg3MDExNSwgMHg4MDA3YSwgMHg4MDAzYSwgMHg5MDBkNCwgMHg3MDEwZCwgMHg4MDA2YSwgMHg4MDAyYSwgMHg5MDBiNCwgMHg4MDAwYSwgMHg4MDA4YSwgMHg4MDA0YSwgMHg5MDBmNCwgMHg3MDEwMywgMHg4MDA1NiwgMHg4MDAxNiwgMHg4MDExZSwgMHg3MDExMywgMHg4MDA3NiwgMHg4MDAzNiwgMHg5MDBjYywgMHg3MDEwYiwgMHg4MDA2NiwgMHg4MDAyNiwgMHg5MDBhYywgMHg4MDAwNiwgMHg4MDA4NiwgMHg4MDA0NiwgMHg5MDBlYywgMHg3MDEwNywgMHg4MDA1ZSwgMHg4MDAxZSwgMHg5MDA5YywgMHg3MDExNywgMHg4MDA3ZSwgMHg4MDAzZSwgMHg5MDBkYywgMHg3MDEwZiwgMHg4MDA2ZSwgMHg4MDAyZSwgMHg5MDBiYywgMHg4MDAwZSwgMHg4MDA4ZSwgMHg4MDA0ZSwgMHg5MDBmYywgMHg3MDEwMCwgMHg4MDA1MSwgMHg4MDAxMSwgMHg4MDExOSwgMHg3MDExMCwgMHg4MDA3MSwgMHg4MDAzMSwgMHg5MDBjMiwgMHg3MDEwOCwgMHg4MDA2MSwgMHg4MDAyMSwgMHg5MDBhMiwgMHg4MDAwMSwgMHg4MDA4MSwgMHg4MDA0MSwgMHg5MDBlMiwgMHg3MDEwNCwgMHg4MDA1OSwgMHg4MDAxOSwgMHg5MDA5MiwgMHg3MDExNCwgMHg4MDA3OSwgMHg4MDAzOSwgMHg5MDBkMiwgMHg3MDEwYywgMHg4MDA2OSwgMHg4MDAyOSwgMHg5MDBiMiwgMHg4MDAwOSwgMHg4MDA4OSwgMHg4MDA0OSwgMHg5MDBmMiwgMHg3MDEwMiwgMHg4MDA1NSwgMHg4MDAxNSwgMHg4MDExZCwgMHg3MDExMiwgMHg4MDA3NSwgMHg4MDAzNSwgMHg5MDBjYSwgMHg3MDEwYSwgMHg4MDA2NSwgMHg4MDAyNSwgMHg5MDBhYSwgMHg4MDAwNSwgMHg4MDA4NSwgMHg4MDA0NSwgMHg5MDBlYSwgMHg3MDEwNiwgMHg4MDA1ZCwgMHg4MDAxZCwgMHg5MDA5YSwgMHg3MDExNiwgMHg4MDA3ZCwgMHg4MDAzZCwgMHg5MDBkYSwgMHg3MDEwZSwgMHg4MDA2ZCwgMHg4MDAyZCwgMHg5MDBiYSwgMHg4MDAwZCwgMHg4MDA4ZCwgMHg4MDA0ZCwgMHg5MDBmYSwgMHg3MDEwMSwgMHg4MDA1MywgMHg4MDAxMywgMHg4MDExYiwgMHg3MDExMSwgMHg4MDA3MywgMHg4MDAzMywgMHg5MDBjNiwgMHg3MDEwOSwgMHg4MDA2MywgMHg4MDAyMywgMHg5MDBhNiwgMHg4MDAwMywgMHg4MDA4MywgMHg4MDA0MywgMHg5MDBlNiwgMHg3MDEwNSwgMHg4MDA1YiwgMHg4MDAxYiwgMHg5MDA5NiwgMHg3MDExNSwgMHg4MDA3YiwgMHg4MDAzYiwgMHg5MDBkNiwgMHg3MDEwZCwgMHg4MDA2YiwgMHg4MDAyYiwgMHg5MDBiNiwgMHg4MDAwYiwgMHg4MDA4YiwgMHg4MDA0YiwgMHg5MDBmNiwgMHg3MDEwMywgMHg4MDA1NywgMHg4MDAxNywgMHg4MDExZiwgMHg3MDExMywgMHg4MDA3NywgMHg4MDAzNywgMHg5MDBjZSwgMHg3MDEwYiwgMHg4MDA2NywgMHg4MDAyNywgMHg5MDBhZSwgMHg4MDAwNywgMHg4MDA4NywgMHg4MDA0NywgMHg5MDBlZSwgMHg3MDEwNywgMHg4MDA1ZiwgMHg4MDAxZiwgMHg5MDA5ZSwgMHg3MDExNywgMHg4MDA3ZiwgMHg4MDAzZiwgMHg5MDBkZSwgMHg3MDEwZiwgMHg4MDA2ZiwgMHg4MDAyZiwgMHg5MDBiZSwgMHg4MDAwZiwgMHg4MDA4ZiwgMHg4MDA0ZiwgMHg5MDBmZSwgMHg3MDEwMCwgMHg4MDA1MCwgMHg4MDAxMCwgMHg4MDExOCwgMHg3MDExMCwgMHg4MDA3MCwgMHg4MDAzMCwgMHg5MDBjMSwgMHg3MDEwOCwgMHg4MDA2MCwgMHg4MDAyMCwgMHg5MDBhMSwgMHg4MDAwMCwgMHg4MDA4MCwgMHg4MDA0MCwgMHg5MDBlMSwgMHg3MDEwNCwgMHg4MDA1OCwgMHg4MDAxOCwgMHg5MDA5MSwgMHg3MDExNCwgMHg4MDA3OCwgMHg4MDAzOCwgMHg5MDBkMSwgMHg3MDEwYywgMHg4MDA2OCwgMHg4MDAyOCwgMHg5MDBiMSwgMHg4MDAwOCwgMHg4MDA4OCwgMHg4MDA0OCwgMHg5MDBmMSwgMHg3MDEwMiwgMHg4MDA1NCwgMHg4MDAxNCwgMHg4MDExYywgMHg3MDExMiwgMHg4MDA3NCwgMHg4MDAzNCwgMHg5MDBjOSwgMHg3MDEwYSwgMHg4MDA2NCwgMHg4MDAyNCwgMHg5MDBhOSwgMHg4MDAwNCwgMHg4MDA4NCwgMHg4MDA0NCwgMHg5MDBlOSwgMHg3MDEwNiwgMHg4MDA1YywgMHg4MDAxYywgMHg5MDA5OSwgMHg3MDExNiwgMHg4MDA3YywgMHg4MDAzYywgMHg5MDBkOSwgMHg3MDEwZSwgMHg4MDA2YywgMHg4MDAyYywgMHg5MDBiOSwgMHg4MDAwYywgMHg4MDA4YywgMHg4MDA0YywgMHg5MDBmOSwgMHg3MDEwMSwgMHg4MDA1MiwgMHg4MDAxMiwgMHg4MDExYSwgMHg3MDExMSwgMHg4MDA3MiwgMHg4MDAzMiwgMHg5MDBjNSwgMHg3MDEwOSwgMHg4MDA2MiwgMHg4MDAyMiwgMHg5MDBhNSwgMHg4MDAwMiwgMHg4MDA4MiwgMHg4MDA0MiwgMHg5MDBlNSwgMHg3MDEwNSwgMHg4MDA1YSwgMHg4MDAxYSwgMHg5MDA5NSwgMHg3MDExNSwgMHg4MDA3YSwgMHg4MDAzYSwgMHg5MDBkNSwgMHg3MDEwZCwgMHg4MDA2YSwgMHg4MDAyYSwgMHg5MDBiNSwgMHg4MDAwYSwgMHg4MDA4YSwgMHg4MDA0YSwgMHg5MDBmNSwgMHg3MDEwMywgMHg4MDA1NiwgMHg4MDAxNiwgMHg4MDExZSwgMHg3MDExMywgMHg4MDA3NiwgMHg4MDAzNiwgMHg5MDBjZCwgMHg3MDEwYiwgMHg4MDA2NiwgMHg4MDAyNiwgMHg5MDBhZCwgMHg4MDAwNiwgMHg4MDA4NiwgMHg4MDA0NiwgMHg5MDBlZCwgMHg3MDEwNywgMHg4MDA1ZSwgMHg4MDAxZSwgMHg5MDA5ZCwgMHg3MDExNywgMHg4MDA3ZSwgMHg4MDAzZSwgMHg5MDBkZCwgMHg3MDEwZiwgMHg4MDA2ZSwgMHg4MDAyZSwgMHg5MDBiZCwgMHg4MDAwZSwgMHg4MDA4ZSwgMHg4MDA0ZSwgMHg5MDBmZCwgMHg3MDEwMCwgMHg4MDA1MSwgMHg4MDAxMSwgMHg4MDExOSwgMHg3MDExMCwgMHg4MDA3MSwgMHg4MDAzMSwgMHg5MDBjMywgMHg3MDEwOCwgMHg4MDA2MSwgMHg4MDAyMSwgMHg5MDBhMywgMHg4MDAwMSwgMHg4MDA4MSwgMHg4MDA0MSwgMHg5MDBlMywgMHg3MDEwNCwgMHg4MDA1OSwgMHg4MDAxOSwgMHg5MDA5MywgMHg3MDExNCwgMHg4MDA3OSwgMHg4MDAzOSwgMHg5MDBkMywgMHg3MDEwYywgMHg4MDA2OSwgMHg4MDAyOSwgMHg5MDBiMywgMHg4MDAwOSwgMHg4MDA4OSwgMHg4MDA0OSwgMHg5MDBmMywgMHg3MDEwMiwgMHg4MDA1NSwgMHg4MDAxNSwgMHg4MDExZCwgMHg3MDExMiwgMHg4MDA3NSwgMHg4MDAzNSwgMHg5MDBjYiwgMHg3MDEwYSwgMHg4MDA2NSwgMHg4MDAyNSwgMHg5MDBhYiwgMHg4MDAwNSwgMHg4MDA4NSwgMHg4MDA0NSwgMHg5MDBlYiwgMHg3MDEwNiwgMHg4MDA1ZCwgMHg4MDAxZCwgMHg5MDA5YiwgMHg3MDExNiwgMHg4MDA3ZCwgMHg4MDAzZCwgMHg5MDBkYiwgMHg3MDEwZSwgMHg4MDA2ZCwgMHg4MDAyZCwgMHg5MDBiYiwgMHg4MDAwZCwgMHg4MDA4ZCwgMHg4MDA0ZCwgMHg5MDBmYiwgMHg3MDEwMSwgMHg4MDA1MywgMHg4MDAxMywgMHg4MDExYiwgMHg3MDExMSwgMHg4MDA3MywgMHg4MDAzMywgMHg5MDBjNywgMHg3MDEwOSwgMHg4MDA2MywgMHg4MDAyMywgMHg5MDBhNywgMHg4MDAwMywgMHg4MDA4MywgMHg4MDA0MywgMHg5MDBlNywgMHg3MDEwNSwgMHg4MDA1YiwgMHg4MDAxYiwgMHg5MDA5NywgMHg3MDExNSwgMHg4MDA3YiwgMHg4MDAzYiwgMHg5MDBkNywgMHg3MDEwZCwgMHg4MDA2YiwgMHg4MDAyYiwgMHg5MDBiNywgMHg4MDAwYiwgMHg4MDA4YiwgMHg4MDA0YiwgMHg5MDBmNywgMHg3MDEwMywgMHg4MDA1NywgMHg4MDAxNywgMHg4MDExZiwgMHg3MDExMywgMHg4MDA3NywgMHg4MDAzNywgMHg5MDBjZiwgMHg3MDEwYiwgMHg4MDA2NywgMHg4MDAyNywgMHg5MDBhZiwgMHg4MDAwNywgMHg4MDA4NywgMHg4MDA0NywgMHg5MDBlZiwgMHg3MDEwNywgMHg4MDA1ZiwgMHg4MDAxZiwgMHg5MDA5ZiwgMHg3MDExNywgMHg4MDA3ZiwgMHg4MDAzZiwgMHg5MDBkZiwgMHg3MDEwZiwgMHg4MDA2ZiwgMHg4MDAyZiwgMHg5MDBiZiwgMHg4MDAwZiwgMHg4MDA4ZiwgMHg4MDA0ZiwgMHg5MDBmZl0pLCA5XTsKY29uc3QgZml4ZWREaXN0Q29kZVRhYiA9IFtuZXcgSW50MzJBcnJheShbMHg1MDAwMCwgMHg1MDAxMCwgMHg1MDAwOCwgMHg1MDAxOCwgMHg1MDAwNCwgMHg1MDAxNCwgMHg1MDAwYywgMHg1MDAxYywgMHg1MDAwMiwgMHg1MDAxMiwgMHg1MDAwYSwgMHg1MDAxYSwgMHg1MDAwNiwgMHg1MDAxNiwgMHg1MDAwZSwgMHgwMDAwMCwgMHg1MDAwMSwgMHg1MDAxMSwgMHg1MDAwOSwgMHg1MDAxOSwgMHg1MDAwNSwgMHg1MDAxNSwgMHg1MDAwZCwgMHg1MDAxZCwgMHg1MDAwMywgMHg1MDAxMywgMHg1MDAwYiwgMHg1MDAxYiwgMHg1MDAwNywgMHg1MDAxNywgMHg1MDAwZiwgMHgwMDAwMF0pLCA1XTsKCmNsYXNzIEZsYXRlU3RyZWFtIGV4dGVuZHMgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHIsIG1heWJlTGVuZ3RoKSB7CiAgICBzdXBlcihtYXliZUxlbmd0aCk7CiAgICB0aGlzLnN0ciA9IHN0cjsKICAgIHRoaXMuZGljdCA9IHN0ci5kaWN0OwogICAgY29uc3QgY21mID0gc3RyLmdldEJ5dGUoKTsKICAgIGNvbnN0IGZsZyA9IHN0ci5nZXRCeXRlKCk7CgogICAgaWYgKGNtZiA9PT0gLTEgfHwgZmxnID09PSAtMSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgaGVhZGVyIGluIGZsYXRlIHN0cmVhbTogJHtjbWZ9LCAke2ZsZ31gKTsKICAgIH0KCiAgICBpZiAoKGNtZiAmIDB4MGYpICE9PSAweDA4KSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgVW5rbm93biBjb21wcmVzc2lvbiBtZXRob2QgaW4gZmxhdGUgc3RyZWFtOiAke2NtZn0sICR7ZmxnfWApOwogICAgfQoKICAgIGlmICgoKGNtZiA8PCA4KSArIGZsZykgJSAzMSAhPT0gMCkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEJhZCBGQ0hFQ0sgaW4gZmxhdGUgc3RyZWFtOiAke2NtZn0sICR7ZmxnfWApOwogICAgfQoKICAgIGlmIChmbGcgJiAweDIwKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgRkRJQ1QgYml0IHNldCBpbiBmbGF0ZSBzdHJlYW06ICR7Y21mfSwgJHtmbGd9YCk7CiAgICB9CgogICAgdGhpcy5jb2RlU2l6ZSA9IDA7CiAgICB0aGlzLmNvZGVCdWYgPSAwOwogIH0KCiAgZ2V0Qml0cyhiaXRzKSB7CiAgICBjb25zdCBzdHIgPSB0aGlzLnN0cjsKICAgIGxldCBjb2RlU2l6ZSA9IHRoaXMuY29kZVNpemU7CiAgICBsZXQgY29kZUJ1ZiA9IHRoaXMuY29kZUJ1ZjsKICAgIGxldCBiOwoKICAgIHdoaWxlIChjb2RlU2l6ZSA8IGJpdHMpIHsKICAgICAgaWYgKChiID0gc3RyLmdldEJ5dGUoKSkgPT09IC0xKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYWQgZW5jb2RpbmcgaW4gZmxhdGUgc3RyZWFtIik7CiAgICAgIH0KCiAgICAgIGNvZGVCdWYgfD0gYiA8PCBjb2RlU2l6ZTsKICAgICAgY29kZVNpemUgKz0gODsKICAgIH0KCiAgICBiID0gY29kZUJ1ZiAmICgxIDw8IGJpdHMpIC0gMTsKICAgIHRoaXMuY29kZUJ1ZiA9IGNvZGVCdWYgPj4gYml0czsKICAgIHRoaXMuY29kZVNpemUgPSBjb2RlU2l6ZSAtPSBiaXRzOwogICAgcmV0dXJuIGI7CiAgfQoKICBnZXRDb2RlKHRhYmxlKSB7CiAgICBjb25zdCBzdHIgPSB0aGlzLnN0cjsKICAgIGNvbnN0IGNvZGVzID0gdGFibGVbMF07CiAgICBjb25zdCBtYXhMZW4gPSB0YWJsZVsxXTsKICAgIGxldCBjb2RlU2l6ZSA9IHRoaXMuY29kZVNpemU7CiAgICBsZXQgY29kZUJ1ZiA9IHRoaXMuY29kZUJ1ZjsKICAgIGxldCBiOwoKICAgIHdoaWxlIChjb2RlU2l6ZSA8IG1heExlbikgewogICAgICBpZiAoKGIgPSBzdHIuZ2V0Qnl0ZSgpKSA9PT0gLTEpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY29kZUJ1ZiB8PSBiIDw8IGNvZGVTaXplOwogICAgICBjb2RlU2l6ZSArPSA4OwogICAgfQoKICAgIGNvbnN0IGNvZGUgPSBjb2Rlc1tjb2RlQnVmICYgKDEgPDwgbWF4TGVuKSAtIDFdOwogICAgY29uc3QgY29kZUxlbiA9IGNvZGUgPj4gMTY7CiAgICBjb25zdCBjb2RlVmFsID0gY29kZSAmIDB4ZmZmZjsKCiAgICBpZiAoY29kZUxlbiA8IDEgfHwgY29kZVNpemUgPCBjb2RlTGVuKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQmFkIGVuY29kaW5nIGluIGZsYXRlIHN0cmVhbSIpOwogICAgfQoKICAgIHRoaXMuY29kZUJ1ZiA9IGNvZGVCdWYgPj4gY29kZUxlbjsKICAgIHRoaXMuY29kZVNpemUgPSBjb2RlU2l6ZSAtIGNvZGVMZW47CiAgICByZXR1cm4gY29kZVZhbDsKICB9CgogIGdlbmVyYXRlSHVmZm1hblRhYmxlKGxlbmd0aHMpIHsKICAgIGNvbnN0IG4gPSBsZW5ndGhzLmxlbmd0aDsKICAgIGxldCBtYXhMZW4gPSAwOwogICAgbGV0IGk7CgogICAgZm9yIChpID0gMDsgaSA8IG47ICsraSkgewogICAgICBpZiAobGVuZ3Roc1tpXSA+IG1heExlbikgewogICAgICAgIG1heExlbiA9IGxlbmd0aHNbaV07CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBzaXplID0gMSA8PCBtYXhMZW47CiAgICBjb25zdCBjb2RlcyA9IG5ldyBJbnQzMkFycmF5KHNpemUpOwoKICAgIGZvciAobGV0IGxlbiA9IDEsIGNvZGUgPSAwLCBza2lwID0gMjsgbGVuIDw9IG1heExlbjsgKytsZW4sIGNvZGUgPDw9IDEsIHNraXAgPDw9IDEpIHsKICAgICAgZm9yIChsZXQgdmFsID0gMDsgdmFsIDwgbjsgKyt2YWwpIHsKICAgICAgICBpZiAobGVuZ3Roc1t2YWxdID09PSBsZW4pIHsKICAgICAgICAgIGxldCBjb2RlMiA9IDA7CiAgICAgICAgICBsZXQgdCA9IGNvZGU7CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgKytpKSB7CiAgICAgICAgICAgIGNvZGUyID0gY29kZTIgPDwgMSB8IHQgJiAxOwogICAgICAgICAgICB0ID4+PSAxOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAoaSA9IGNvZGUyOyBpIDwgc2l6ZTsgaSArPSBza2lwKSB7CiAgICAgICAgICAgIGNvZGVzW2ldID0gbGVuIDw8IDE2IHwgdmFsOwogICAgICAgICAgfQoKICAgICAgICAgICsrY29kZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gW2NvZGVzLCBtYXhMZW5dOwogIH0KCiAgcmVhZEJsb2NrKCkgewogICAgbGV0IGJ1ZmZlciwgbGVuOwogICAgY29uc3Qgc3RyID0gdGhpcy5zdHI7CiAgICBsZXQgaGRyID0gdGhpcy5nZXRCaXRzKDMpOwoKICAgIGlmIChoZHIgJiAxKSB7CiAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgIH0KCiAgICBoZHIgPj49IDE7CgogICAgaWYgKGhkciA9PT0gMCkgewogICAgICBsZXQgYjsKCiAgICAgIGlmICgoYiA9IHN0ci5nZXRCeXRlKCkpID09PSAtMSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQmFkIGJsb2NrIGhlYWRlciBpbiBmbGF0ZSBzdHJlYW0iKTsKICAgICAgfQoKICAgICAgbGV0IGJsb2NrTGVuID0gYjsKCiAgICAgIGlmICgoYiA9IHN0ci5nZXRCeXRlKCkpID09PSAtMSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQmFkIGJsb2NrIGhlYWRlciBpbiBmbGF0ZSBzdHJlYW0iKTsKICAgICAgfQoKICAgICAgYmxvY2tMZW4gfD0gYiA8PCA4OwoKICAgICAgaWYgKChiID0gc3RyLmdldEJ5dGUoKSkgPT09IC0xKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYWQgYmxvY2sgaGVhZGVyIGluIGZsYXRlIHN0cmVhbSIpOwogICAgICB9CgogICAgICBsZXQgY2hlY2sgPSBiOwoKICAgICAgaWYgKChiID0gc3RyLmdldEJ5dGUoKSkgPT09IC0xKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYWQgYmxvY2sgaGVhZGVyIGluIGZsYXRlIHN0cmVhbSIpOwogICAgICB9CgogICAgICBjaGVjayB8PSBiIDw8IDg7CgogICAgICBpZiAoY2hlY2sgIT09ICh+YmxvY2tMZW4gJiAweGZmZmYpICYmIChibG9ja0xlbiAhPT0gMCB8fCBjaGVjayAhPT0gMCkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkJhZCB1bmNvbXByZXNzZWQgYmxvY2sgbGVuZ3RoIGluIGZsYXRlIHN0cmVhbSIpOwogICAgICB9CgogICAgICB0aGlzLmNvZGVCdWYgPSAwOwogICAgICB0aGlzLmNvZGVTaXplID0gMDsKICAgICAgY29uc3QgYnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXJMZW5ndGgsCiAgICAgICAgICAgIGVuZCA9IGJ1ZmZlckxlbmd0aCArIGJsb2NrTGVuOwogICAgICBidWZmZXIgPSB0aGlzLmVuc3VyZUJ1ZmZlcihlbmQpOwogICAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGVuZDsKCiAgICAgIGlmIChibG9ja0xlbiA9PT0gMCkgewogICAgICAgIGlmIChzdHIucGVla0J5dGUoKSA9PT0gLTEpIHsKICAgICAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgYmxvY2sgPSBzdHIuZ2V0Qnl0ZXMoYmxvY2tMZW4pOwogICAgICAgIGJ1ZmZlci5zZXQoYmxvY2ssIGJ1ZmZlckxlbmd0aCk7CgogICAgICAgIGlmIChibG9jay5sZW5ndGggPCBibG9ja0xlbikgewogICAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBsaXRDb2RlVGFibGU7CiAgICBsZXQgZGlzdENvZGVUYWJsZTsKCiAgICBpZiAoaGRyID09PSAxKSB7CiAgICAgIGxpdENvZGVUYWJsZSA9IGZpeGVkTGl0Q29kZVRhYjsKICAgICAgZGlzdENvZGVUYWJsZSA9IGZpeGVkRGlzdENvZGVUYWI7CiAgICB9IGVsc2UgaWYgKGhkciA9PT0gMikgewogICAgICBjb25zdCBudW1MaXRDb2RlcyA9IHRoaXMuZ2V0Qml0cyg1KSArIDI1NzsKICAgICAgY29uc3QgbnVtRGlzdENvZGVzID0gdGhpcy5nZXRCaXRzKDUpICsgMTsKICAgICAgY29uc3QgbnVtQ29kZUxlbkNvZGVzID0gdGhpcy5nZXRCaXRzKDQpICsgNDsKICAgICAgY29uc3QgY29kZUxlbkNvZGVMZW5ndGhzID0gbmV3IFVpbnQ4QXJyYXkoY29kZUxlbkNvZGVNYXAubGVuZ3RoKTsKICAgICAgbGV0IGk7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtQ29kZUxlbkNvZGVzOyArK2kpIHsKICAgICAgICBjb2RlTGVuQ29kZUxlbmd0aHNbY29kZUxlbkNvZGVNYXBbaV1dID0gdGhpcy5nZXRCaXRzKDMpOwogICAgICB9CgogICAgICBjb25zdCBjb2RlTGVuQ29kZVRhYiA9IHRoaXMuZ2VuZXJhdGVIdWZmbWFuVGFibGUoY29kZUxlbkNvZGVMZW5ndGhzKTsKICAgICAgbGVuID0gMDsKICAgICAgaSA9IDA7CiAgICAgIGNvbnN0IGNvZGVzID0gbnVtTGl0Q29kZXMgKyBudW1EaXN0Q29kZXM7CiAgICAgIGNvbnN0IGNvZGVMZW5ndGhzID0gbmV3IFVpbnQ4QXJyYXkoY29kZXMpOwogICAgICBsZXQgYml0c0xlbmd0aCwgYml0c09mZnNldCwgd2hhdDsKCiAgICAgIHdoaWxlIChpIDwgY29kZXMpIHsKICAgICAgICBjb25zdCBjb2RlID0gdGhpcy5nZXRDb2RlKGNvZGVMZW5Db2RlVGFiKTsKCiAgICAgICAgaWYgKGNvZGUgPT09IDE2KSB7CiAgICAgICAgICBiaXRzTGVuZ3RoID0gMjsKICAgICAgICAgIGJpdHNPZmZzZXQgPSAzOwogICAgICAgICAgd2hhdCA9IGxlbjsKICAgICAgICB9IGVsc2UgaWYgKGNvZGUgPT09IDE3KSB7CiAgICAgICAgICBiaXRzTGVuZ3RoID0gMzsKICAgICAgICAgIGJpdHNPZmZzZXQgPSAzOwogICAgICAgICAgd2hhdCA9IGxlbiA9IDA7CiAgICAgICAgfSBlbHNlIGlmIChjb2RlID09PSAxOCkgewogICAgICAgICAgYml0c0xlbmd0aCA9IDc7CiAgICAgICAgICBiaXRzT2Zmc2V0ID0gMTE7CiAgICAgICAgICB3aGF0ID0gbGVuID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29kZUxlbmd0aHNbaSsrXSA9IGxlbiA9IGNvZGU7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGxldCByZXBlYXRMZW5ndGggPSB0aGlzLmdldEJpdHMoYml0c0xlbmd0aCkgKyBiaXRzT2Zmc2V0OwoKICAgICAgICB3aGlsZSAocmVwZWF0TGVuZ3RoLS0gPiAwKSB7CiAgICAgICAgICBjb2RlTGVuZ3Roc1tpKytdID0gd2hhdDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGxpdENvZGVUYWJsZSA9IHRoaXMuZ2VuZXJhdGVIdWZmbWFuVGFibGUoY29kZUxlbmd0aHMuc3ViYXJyYXkoMCwgbnVtTGl0Q29kZXMpKTsKICAgICAgZGlzdENvZGVUYWJsZSA9IHRoaXMuZ2VuZXJhdGVIdWZmbWFuVGFibGUoY29kZUxlbmd0aHMuc3ViYXJyYXkobnVtTGl0Q29kZXMsIGNvZGVzKSk7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gYmxvY2sgdHlwZSBpbiBmbGF0ZSBzdHJlYW0iKTsKICAgIH0KCiAgICBidWZmZXIgPSB0aGlzLmJ1ZmZlcjsKICAgIGxldCBsaW1pdCA9IGJ1ZmZlciA/IGJ1ZmZlci5sZW5ndGggOiAwOwogICAgbGV0IHBvcyA9IHRoaXMuYnVmZmVyTGVuZ3RoOwoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGxldCBjb2RlMSA9IHRoaXMuZ2V0Q29kZShsaXRDb2RlVGFibGUpOwoKICAgICAgaWYgKGNvZGUxIDwgMjU2KSB7CiAgICAgICAgaWYgKHBvcyArIDEgPj0gbGltaXQpIHsKICAgICAgICAgIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKHBvcyArIDEpOwogICAgICAgICAgbGltaXQgPSBidWZmZXIubGVuZ3RoOwogICAgICAgIH0KCiAgICAgICAgYnVmZmVyW3BvcysrXSA9IGNvZGUxOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAoY29kZTEgPT09IDI1NikgewogICAgICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gcG9zOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29kZTEgLT0gMjU3OwogICAgICBjb2RlMSA9IGxlbmd0aERlY29kZVtjb2RlMV07CiAgICAgIGxldCBjb2RlMiA9IGNvZGUxID4+IDE2OwoKICAgICAgaWYgKGNvZGUyID4gMCkgewogICAgICAgIGNvZGUyID0gdGhpcy5nZXRCaXRzKGNvZGUyKTsKICAgICAgfQoKICAgICAgbGVuID0gKGNvZGUxICYgMHhmZmZmKSArIGNvZGUyOwogICAgICBjb2RlMSA9IHRoaXMuZ2V0Q29kZShkaXN0Q29kZVRhYmxlKTsKICAgICAgY29kZTEgPSBkaXN0RGVjb2RlW2NvZGUxXTsKICAgICAgY29kZTIgPSBjb2RlMSA+PiAxNjsKCiAgICAgIGlmIChjb2RlMiA+IDApIHsKICAgICAgICBjb2RlMiA9IHRoaXMuZ2V0Qml0cyhjb2RlMik7CiAgICAgIH0KCiAgICAgIGNvbnN0IGRpc3QgPSAoY29kZTEgJiAweGZmZmYpICsgY29kZTI7CgogICAgICBpZiAocG9zICsgbGVuID49IGxpbWl0KSB7CiAgICAgICAgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIocG9zICsgbGVuKTsKICAgICAgICBsaW1pdCA9IGJ1ZmZlci5sZW5ndGg7CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgbGVuOyArK2ssICsrcG9zKSB7CiAgICAgICAgYnVmZmVyW3Bvc10gPSBidWZmZXJbcG9zIC0gZGlzdF07CiAgICAgIH0KICAgIH0KICB9Cgp9CgpleHBvcnRzLkZsYXRlU3RyZWFtID0gRmxhdGVTdHJlYW07CgovKioqLyB9KSwKLyogMTQ5ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5KYmlnMlN0cmVhbSA9IHZvaWQgMDsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMik7Cgp2YXIgX2RlY29kZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0NCk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMCk7Cgp2YXIgX2piaWcgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE1MCk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY2xhc3MgSmJpZzJTdHJlYW0gZXh0ZW5kcyBfZGVjb2RlX3N0cmVhbS5EZWNvZGVTdHJlYW0gewogIGNvbnN0cnVjdG9yKHN0cmVhbSwgbWF5YmVMZW5ndGgsIHBhcmFtcykgewogICAgc3VwZXIobWF5YmVMZW5ndGgpOwogICAgdGhpcy5zdHJlYW0gPSBzdHJlYW07CiAgICB0aGlzLmRpY3QgPSBzdHJlYW0uZGljdDsKICAgIHRoaXMubWF5YmVMZW5ndGggPSBtYXliZUxlbmd0aDsKICAgIHRoaXMucGFyYW1zID0gcGFyYW1zOwogIH0KCiAgZ2V0IGJ5dGVzKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJieXRlcyIsIHRoaXMuc3RyZWFtLmdldEJ5dGVzKHRoaXMubWF5YmVMZW5ndGgpKTsKICB9CgogIGVuc3VyZUJ1ZmZlcihyZXF1ZXN0ZWQpIHt9CgogIHJlYWRCbG9jaygpIHsKICAgIGlmICh0aGlzLmVvZikgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgamJpZzJJbWFnZSA9IG5ldyBfamJpZy5KYmlnMkltYWdlKCk7CiAgICBjb25zdCBjaHVua3MgPSBbXTsKCiAgICBpZiAodGhpcy5wYXJhbXMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIGNvbnN0IGdsb2JhbHNTdHJlYW0gPSB0aGlzLnBhcmFtcy5nZXQoIkpCSUcyR2xvYmFscyIpOwoKICAgICAgaWYgKGdsb2JhbHNTdHJlYW0gaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgIGNvbnN0IGdsb2JhbHMgPSBnbG9iYWxzU3RyZWFtLmdldEJ5dGVzKCk7CiAgICAgICAgY2h1bmtzLnB1c2goewogICAgICAgICAgZGF0YTogZ2xvYmFscywKICAgICAgICAgIHN0YXJ0OiAwLAogICAgICAgICAgZW5kOiBnbG9iYWxzLmxlbmd0aAogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgY2h1bmtzLnB1c2goewogICAgICBkYXRhOiB0aGlzLmJ5dGVzLAogICAgICBzdGFydDogMCwKICAgICAgZW5kOiB0aGlzLmJ5dGVzLmxlbmd0aAogICAgfSk7CiAgICBjb25zdCBkYXRhID0gamJpZzJJbWFnZS5wYXJzZUNodW5rcyhjaHVua3MpOwogICAgY29uc3QgZGF0YUxlbmd0aCA9IGRhdGEubGVuZ3RoOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YUxlbmd0aDsgaSsrKSB7CiAgICAgIGRhdGFbaV0gXj0gMHhmZjsKICAgIH0KCiAgICB0aGlzLmJ1ZmZlciA9IGRhdGE7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGRhdGFMZW5ndGg7CiAgICB0aGlzLmVvZiA9IHRydWU7CiAgfQoKfQoKZXhwb3J0cy5KYmlnMlN0cmVhbSA9IEpiaWcyU3RyZWFtOwoKLyoqKi8gfSksCi8qIDE1MCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuSmJpZzJJbWFnZSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX2FyaXRobWV0aWNfZGVjb2RlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTUxKTsKCnZhciBfY2NpdHQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0Nyk7CgpjbGFzcyBKYmlnMkVycm9yIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihgSkJJRzIgZXJyb3I6ICR7bXNnfWAsICJKYmlnMkVycm9yIik7CiAgfQoKfQoKY2xhc3MgQ29udGV4dENhY2hlIHsKICBnZXRDb250ZXh0cyhpZCkgewogICAgaWYgKGlkIGluIHRoaXMpIHsKICAgICAgcmV0dXJuIHRoaXNbaWRdOwogICAgfQoKICAgIHJldHVybiB0aGlzW2lkXSA9IG5ldyBJbnQ4QXJyYXkoMSA8PCAxNik7CiAgfQoKfQoKY2xhc3MgRGVjb2RpbmdDb250ZXh0IHsKICBjb25zdHJ1Y3RvcihkYXRhLCBzdGFydCwgZW5kKSB7CiAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgdGhpcy5zdGFydCA9IHN0YXJ0OwogICAgdGhpcy5lbmQgPSBlbmQ7CiAgfQoKICBnZXQgZGVjb2RlcigpIHsKICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgX2FyaXRobWV0aWNfZGVjb2Rlci5Bcml0aG1ldGljRGVjb2Rlcih0aGlzLmRhdGEsIHRoaXMuc3RhcnQsIHRoaXMuZW5kKTsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZGVjb2RlciIsIGRlY29kZXIpOwogIH0KCiAgZ2V0IGNvbnRleHRDYWNoZSgpIHsKICAgIGNvbnN0IGNhY2hlID0gbmV3IENvbnRleHRDYWNoZSgpOwogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJjb250ZXh0Q2FjaGUiLCBjYWNoZSk7CiAgfQoKfQoKZnVuY3Rpb24gZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsIHByb2NlZHVyZSwgZGVjb2RlcikgewogIGNvbnN0IGNvbnRleHRzID0gY29udGV4dENhY2hlLmdldENvbnRleHRzKHByb2NlZHVyZSk7CiAgbGV0IHByZXYgPSAxOwoKICBmdW5jdGlvbiByZWFkQml0cyhsZW5ndGgpIHsKICAgIGxldCB2ID0gMDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGJpdCA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgcHJldik7CiAgICAgIHByZXYgPSBwcmV2IDwgMjU2ID8gcHJldiA8PCAxIHwgYml0IDogKHByZXYgPDwgMSB8IGJpdCkgJiA1MTEgfCAyNTY7CiAgICAgIHYgPSB2IDw8IDEgfCBiaXQ7CiAgICB9CgogICAgcmV0dXJuIHYgPj4+IDA7CiAgfQoKICBjb25zdCBzaWduID0gcmVhZEJpdHMoMSk7CiAgY29uc3QgdmFsdWUgPSByZWFkQml0cygxKSA/IHJlYWRCaXRzKDEpID8gcmVhZEJpdHMoMSkgPyByZWFkQml0cygxKSA/IHJlYWRCaXRzKDEpID8gcmVhZEJpdHMoMzIpICsgNDQzNiA6IHJlYWRCaXRzKDEyKSArIDM0MCA6IHJlYWRCaXRzKDgpICsgODQgOiByZWFkQml0cyg2KSArIDIwIDogcmVhZEJpdHMoNCkgKyA0IDogcmVhZEJpdHMoMik7CgogIGlmIChzaWduID09PSAwKSB7CiAgICByZXR1cm4gdmFsdWU7CiAgfSBlbHNlIGlmICh2YWx1ZSA+IDApIHsKICAgIHJldHVybiAtdmFsdWU7CiAgfQoKICByZXR1cm4gbnVsbDsKfQoKZnVuY3Rpb24gZGVjb2RlSUFJRChjb250ZXh0Q2FjaGUsIGRlY29kZXIsIGNvZGVMZW5ndGgpIHsKICBjb25zdCBjb250ZXh0cyA9IGNvbnRleHRDYWNoZS5nZXRDb250ZXh0cygiSUFJRCIpOwogIGxldCBwcmV2ID0gMTsKCiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2RlTGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IGJpdCA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgcHJldik7CiAgICBwcmV2ID0gcHJldiA8PCAxIHwgYml0OwogIH0KCiAgaWYgKGNvZGVMZW5ndGggPCAzMSkgewogICAgcmV0dXJuIHByZXYgJiAoMSA8PCBjb2RlTGVuZ3RoKSAtIDE7CiAgfQoKICByZXR1cm4gcHJldiAmIDB4N2ZmZmZmZmY7Cn0KCmNvbnN0IFNlZ21lbnRUeXBlcyA9IFsiU3ltYm9sRGljdGlvbmFyeSIsIG51bGwsIG51bGwsIG51bGwsICJJbnRlcm1lZGlhdGVUZXh0UmVnaW9uIiwgbnVsbCwgIkltbWVkaWF0ZVRleHRSZWdpb24iLCAiSW1tZWRpYXRlTG9zc2xlc3NUZXh0UmVnaW9uIiwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgIlBhdHRlcm5EaWN0aW9uYXJ5IiwgbnVsbCwgbnVsbCwgbnVsbCwgIkludGVybWVkaWF0ZUhhbGZ0b25lUmVnaW9uIiwgbnVsbCwgIkltbWVkaWF0ZUhhbGZ0b25lUmVnaW9uIiwgIkltbWVkaWF0ZUxvc3NsZXNzSGFsZnRvbmVSZWdpb24iLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCAiSW50ZXJtZWRpYXRlR2VuZXJpY1JlZ2lvbiIsIG51bGwsICJJbW1lZGlhdGVHZW5lcmljUmVnaW9uIiwgIkltbWVkaWF0ZUxvc3NsZXNzR2VuZXJpY1JlZ2lvbiIsICJJbnRlcm1lZGlhdGVHZW5lcmljUmVmaW5lbWVudFJlZ2lvbiIsIG51bGwsICJJbW1lZGlhdGVHZW5lcmljUmVmaW5lbWVudFJlZ2lvbiIsICJJbW1lZGlhdGVMb3NzbGVzc0dlbmVyaWNSZWZpbmVtZW50UmVnaW9uIiwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgIlBhZ2VJbmZvcm1hdGlvbiIsICJFbmRPZlBhZ2UiLCAiRW5kT2ZTdHJpcGUiLCAiRW5kT2ZGaWxlIiwgIlByb2ZpbGVzIiwgIlRhYmxlcyIsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsICJFeHRlbnNpb24iXTsKY29uc3QgQ29kaW5nVGVtcGxhdGVzID0gW1t7CiAgeDogLTEsCiAgeTogLTIKfSwgewogIHg6IDAsCiAgeTogLTIKfSwgewogIHg6IDEsCiAgeTogLTIKfSwgewogIHg6IC0yLAogIHk6IC0xCn0sIHsKICB4OiAtMSwKICB5OiAtMQp9LCB7CiAgeDogMCwKICB5OiAtMQp9LCB7CiAgeDogMSwKICB5OiAtMQp9LCB7CiAgeDogMiwKICB5OiAtMQp9LCB7CiAgeDogLTQsCiAgeTogMAp9LCB7CiAgeDogLTMsCiAgeTogMAp9LCB7CiAgeDogLTIsCiAgeTogMAp9LCB7CiAgeDogLTEsCiAgeTogMAp9XSwgW3sKICB4OiAtMSwKICB5OiAtMgp9LCB7CiAgeDogMCwKICB5OiAtMgp9LCB7CiAgeDogMSwKICB5OiAtMgp9LCB7CiAgeDogMiwKICB5OiAtMgp9LCB7CiAgeDogLTIsCiAgeTogLTEKfSwgewogIHg6IC0xLAogIHk6IC0xCn0sIHsKICB4OiAwLAogIHk6IC0xCn0sIHsKICB4OiAxLAogIHk6IC0xCn0sIHsKICB4OiAyLAogIHk6IC0xCn0sIHsKICB4OiAtMywKICB5OiAwCn0sIHsKICB4OiAtMiwKICB5OiAwCn0sIHsKICB4OiAtMSwKICB5OiAwCn1dLCBbewogIHg6IC0xLAogIHk6IC0yCn0sIHsKICB4OiAwLAogIHk6IC0yCn0sIHsKICB4OiAxLAogIHk6IC0yCn0sIHsKICB4OiAtMiwKICB5OiAtMQp9LCB7CiAgeDogLTEsCiAgeTogLTEKfSwgewogIHg6IDAsCiAgeTogLTEKfSwgewogIHg6IDEsCiAgeTogLTEKfSwgewogIHg6IC0yLAogIHk6IDAKfSwgewogIHg6IC0xLAogIHk6IDAKfV0sIFt7CiAgeDogLTMsCiAgeTogLTEKfSwgewogIHg6IC0yLAogIHk6IC0xCn0sIHsKICB4OiAtMSwKICB5OiAtMQp9LCB7CiAgeDogMCwKICB5OiAtMQp9LCB7CiAgeDogMSwKICB5OiAtMQp9LCB7CiAgeDogLTQsCiAgeTogMAp9LCB7CiAgeDogLTMsCiAgeTogMAp9LCB7CiAgeDogLTIsCiAgeTogMAp9LCB7CiAgeDogLTEsCiAgeTogMAp9XV07CmNvbnN0IFJlZmluZW1lbnRUZW1wbGF0ZXMgPSBbewogIGNvZGluZzogW3sKICAgIHg6IDAsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IC0xLAogICAgeTogMAogIH1dLAogIHJlZmVyZW5jZTogW3sKICAgIHg6IDAsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IC0xLAogICAgeTogMAogIH0sIHsKICAgIHg6IDAsCiAgICB5OiAwCiAgfSwgewogICAgeDogMSwKICAgIHk6IDAKICB9LCB7CiAgICB4OiAtMSwKICAgIHk6IDEKICB9LCB7CiAgICB4OiAwLAogICAgeTogMQogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAxCiAgfV0KfSwgewogIGNvZGluZzogW3sKICAgIHg6IC0xLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAwLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAxLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAtMSwKICAgIHk6IDAKICB9XSwKICByZWZlcmVuY2U6IFt7CiAgICB4OiAwLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAtMSwKICAgIHk6IDAKICB9LCB7CiAgICB4OiAwLAogICAgeTogMAogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAwCiAgfSwgewogICAgeDogMCwKICAgIHk6IDEKICB9LCB7CiAgICB4OiAxLAogICAgeTogMQogIH1dCn1dOwpjb25zdCBSZXVzZWRDb250ZXh0cyA9IFsweDliMjUsIDB4MDc5NSwgMHgwMGU1LCAweDAxOTVdOwpjb25zdCBSZWZpbmVtZW50UmV1c2VkQ29udGV4dHMgPSBbMHgwMDIwLCAweDAwMDhdOwoKZnVuY3Rpb24gZGVjb2RlQml0bWFwVGVtcGxhdGUwKHdpZHRoLCBoZWlnaHQsIGRlY29kaW5nQ29udGV4dCkgewogIGNvbnN0IGRlY29kZXIgPSBkZWNvZGluZ0NvbnRleHQuZGVjb2RlcjsKICBjb25zdCBjb250ZXh0cyA9IGRlY29kaW5nQ29udGV4dC5jb250ZXh0Q2FjaGUuZ2V0Q29udGV4dHMoIkdCIik7CiAgY29uc3QgYml0bWFwID0gW107CiAgbGV0IGNvbnRleHRMYWJlbCwgaSwgaiwgcGl4ZWwsIHJvdywgcm93MSwgcm93MjsKICBjb25zdCBPTERfUElYRUxfTUFTSyA9IDB4N2JmNzsKCiAgZm9yIChpID0gMDsgaSA8IGhlaWdodDsgaSsrKSB7CiAgICByb3cgPSBiaXRtYXBbaV0gPSBuZXcgVWludDhBcnJheSh3aWR0aCk7CiAgICByb3cxID0gaSA8IDEgPyByb3cgOiBiaXRtYXBbaSAtIDFdOwogICAgcm93MiA9IGkgPCAyID8gcm93IDogYml0bWFwW2kgLSAyXTsKICAgIGNvbnRleHRMYWJlbCA9IHJvdzJbMF0gPDwgMTMgfCByb3cyWzFdIDw8IDEyIHwgcm93MlsyXSA8PCAxMSB8IHJvdzFbMF0gPDwgNyB8IHJvdzFbMV0gPDwgNiB8IHJvdzFbMl0gPDwgNSB8IHJvdzFbM10gPDwgNDsKCiAgICBmb3IgKGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICByb3dbal0gPSBwaXhlbCA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgY29udGV4dExhYmVsKTsKICAgICAgY29udGV4dExhYmVsID0gKGNvbnRleHRMYWJlbCAmIE9MRF9QSVhFTF9NQVNLKSA8PCAxIHwgKGogKyAzIDwgd2lkdGggPyByb3cyW2ogKyAzXSA8PCAxMSA6IDApIHwgKGogKyA0IDwgd2lkdGggPyByb3cxW2ogKyA0XSA8PCA0IDogMCkgfCBwaXhlbDsKICAgIH0KICB9CgogIHJldHVybiBiaXRtYXA7Cn0KCmZ1bmN0aW9uIGRlY29kZUJpdG1hcChtbXIsIHdpZHRoLCBoZWlnaHQsIHRlbXBsYXRlSW5kZXgsIHByZWRpY3Rpb24sIHNraXAsIGF0LCBkZWNvZGluZ0NvbnRleHQpIHsKICBpZiAobW1yKSB7CiAgICBjb25zdCBpbnB1dCA9IG5ldyBSZWFkZXIoZGVjb2RpbmdDb250ZXh0LmRhdGEsIGRlY29kaW5nQ29udGV4dC5zdGFydCwgZGVjb2RpbmdDb250ZXh0LmVuZCk7CiAgICByZXR1cm4gZGVjb2RlTU1SQml0bWFwKGlucHV0LCB3aWR0aCwgaGVpZ2h0LCBmYWxzZSk7CiAgfQoKICBpZiAodGVtcGxhdGVJbmRleCA9PT0gMCAmJiAhc2tpcCAmJiAhcHJlZGljdGlvbiAmJiBhdC5sZW5ndGggPT09IDQgJiYgYXRbMF0ueCA9PT0gMyAmJiBhdFswXS55ID09PSAtMSAmJiBhdFsxXS54ID09PSAtMyAmJiBhdFsxXS55ID09PSAtMSAmJiBhdFsyXS54ID09PSAyICYmIGF0WzJdLnkgPT09IC0yICYmIGF0WzNdLnggPT09IC0yICYmIGF0WzNdLnkgPT09IC0yKSB7CiAgICByZXR1cm4gZGVjb2RlQml0bWFwVGVtcGxhdGUwKHdpZHRoLCBoZWlnaHQsIGRlY29kaW5nQ29udGV4dCk7CiAgfQoKICBjb25zdCB1c2Vza2lwID0gISFza2lwOwogIGNvbnN0IHRlbXBsYXRlID0gQ29kaW5nVGVtcGxhdGVzW3RlbXBsYXRlSW5kZXhdLmNvbmNhdChhdCk7CiAgdGVtcGxhdGUuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgcmV0dXJuIGEueSAtIGIueSB8fCBhLnggLSBiLng7CiAgfSk7CiAgY29uc3QgdGVtcGxhdGVMZW5ndGggPSB0ZW1wbGF0ZS5sZW5ndGg7CiAgY29uc3QgdGVtcGxhdGVYID0gbmV3IEludDhBcnJheSh0ZW1wbGF0ZUxlbmd0aCk7CiAgY29uc3QgdGVtcGxhdGVZID0gbmV3IEludDhBcnJheSh0ZW1wbGF0ZUxlbmd0aCk7CiAgY29uc3QgY2hhbmdpbmdUZW1wbGF0ZUVudHJpZXMgPSBbXTsKICBsZXQgcmV1c2VNYXNrID0gMCwKICAgICAgbWluWCA9IDAsCiAgICAgIG1heFggPSAwLAogICAgICBtaW5ZID0gMDsKICBsZXQgYywgazsKCiAgZm9yIChrID0gMDsgayA8IHRlbXBsYXRlTGVuZ3RoOyBrKyspIHsKICAgIHRlbXBsYXRlWFtrXSA9IHRlbXBsYXRlW2tdLng7CiAgICB0ZW1wbGF0ZVlba10gPSB0ZW1wbGF0ZVtrXS55OwogICAgbWluWCA9IE1hdGgubWluKG1pblgsIHRlbXBsYXRlW2tdLngpOwogICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIHRlbXBsYXRlW2tdLngpOwogICAgbWluWSA9IE1hdGgubWluKG1pblksIHRlbXBsYXRlW2tdLnkpOwoKICAgIGlmIChrIDwgdGVtcGxhdGVMZW5ndGggLSAxICYmIHRlbXBsYXRlW2tdLnkgPT09IHRlbXBsYXRlW2sgKyAxXS55ICYmIHRlbXBsYXRlW2tdLnggPT09IHRlbXBsYXRlW2sgKyAxXS54IC0gMSkgewogICAgICByZXVzZU1hc2sgfD0gMSA8PCB0ZW1wbGF0ZUxlbmd0aCAtIDEgLSBrOwogICAgfSBlbHNlIHsKICAgICAgY2hhbmdpbmdUZW1wbGF0ZUVudHJpZXMucHVzaChrKTsKICAgIH0KICB9CgogIGNvbnN0IGNoYW5naW5nRW50cmllc0xlbmd0aCA9IGNoYW5naW5nVGVtcGxhdGVFbnRyaWVzLmxlbmd0aDsKICBjb25zdCBjaGFuZ2luZ1RlbXBsYXRlWCA9IG5ldyBJbnQ4QXJyYXkoY2hhbmdpbmdFbnRyaWVzTGVuZ3RoKTsKICBjb25zdCBjaGFuZ2luZ1RlbXBsYXRlWSA9IG5ldyBJbnQ4QXJyYXkoY2hhbmdpbmdFbnRyaWVzTGVuZ3RoKTsKICBjb25zdCBjaGFuZ2luZ1RlbXBsYXRlQml0ID0gbmV3IFVpbnQxNkFycmF5KGNoYW5naW5nRW50cmllc0xlbmd0aCk7CgogIGZvciAoYyA9IDA7IGMgPCBjaGFuZ2luZ0VudHJpZXNMZW5ndGg7IGMrKykgewogICAgayA9IGNoYW5naW5nVGVtcGxhdGVFbnRyaWVzW2NdOwogICAgY2hhbmdpbmdUZW1wbGF0ZVhbY10gPSB0ZW1wbGF0ZVtrXS54OwogICAgY2hhbmdpbmdUZW1wbGF0ZVlbY10gPSB0ZW1wbGF0ZVtrXS55OwogICAgY2hhbmdpbmdUZW1wbGF0ZUJpdFtjXSA9IDEgPDwgdGVtcGxhdGVMZW5ndGggLSAxIC0gazsKICB9CgogIGNvbnN0IHNiYl9sZWZ0ID0gLW1pblg7CiAgY29uc3Qgc2JiX3RvcCA9IC1taW5ZOwogIGNvbnN0IHNiYl9yaWdodCA9IHdpZHRoIC0gbWF4WDsKICBjb25zdCBwc2V1ZG9QaXhlbENvbnRleHQgPSBSZXVzZWRDb250ZXh0c1t0ZW1wbGF0ZUluZGV4XTsKICBsZXQgcm93ID0gbmV3IFVpbnQ4QXJyYXkod2lkdGgpOwogIGNvbnN0IGJpdG1hcCA9IFtdOwogIGNvbnN0IGRlY29kZXIgPSBkZWNvZGluZ0NvbnRleHQuZGVjb2RlcjsKICBjb25zdCBjb250ZXh0cyA9IGRlY29kaW5nQ29udGV4dC5jb250ZXh0Q2FjaGUuZ2V0Q29udGV4dHMoIkdCIik7CiAgbGV0IGx0cCA9IDAsCiAgICAgIGosCiAgICAgIGkwLAogICAgICBqMCwKICAgICAgY29udGV4dExhYmVsID0gMCwKICAgICAgYml0LAogICAgICBzaGlmdDsKCiAgZm9yIChsZXQgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewogICAgaWYgKHByZWRpY3Rpb24pIHsKICAgICAgY29uc3Qgc2x0cCA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgcHNldWRvUGl4ZWxDb250ZXh0KTsKICAgICAgbHRwIF49IHNsdHA7CgogICAgICBpZiAobHRwKSB7CiAgICAgICAgYml0bWFwLnB1c2gocm93KTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgfQoKICAgIHJvdyA9IG5ldyBVaW50OEFycmF5KHJvdyk7CiAgICBiaXRtYXAucHVzaChyb3cpOwoKICAgIGZvciAoaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CiAgICAgIGlmICh1c2Vza2lwICYmIHNraXBbaV1bal0pIHsKICAgICAgICByb3dbal0gPSAwOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAoaiA+PSBzYmJfbGVmdCAmJiBqIDwgc2JiX3JpZ2h0ICYmIGkgPj0gc2JiX3RvcCkgewogICAgICAgIGNvbnRleHRMYWJlbCA9IGNvbnRleHRMYWJlbCA8PCAxICYgcmV1c2VNYXNrOwoKICAgICAgICBmb3IgKGsgPSAwOyBrIDwgY2hhbmdpbmdFbnRyaWVzTGVuZ3RoOyBrKyspIHsKICAgICAgICAgIGkwID0gaSArIGNoYW5naW5nVGVtcGxhdGVZW2tdOwogICAgICAgICAgajAgPSBqICsgY2hhbmdpbmdUZW1wbGF0ZVhba107CiAgICAgICAgICBiaXQgPSBiaXRtYXBbaTBdW2owXTsKCiAgICAgICAgICBpZiAoYml0KSB7CiAgICAgICAgICAgIGJpdCA9IGNoYW5naW5nVGVtcGxhdGVCaXRba107CiAgICAgICAgICAgIGNvbnRleHRMYWJlbCB8PSBiaXQ7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnRleHRMYWJlbCA9IDA7CiAgICAgICAgc2hpZnQgPSB0ZW1wbGF0ZUxlbmd0aCAtIDE7CgogICAgICAgIGZvciAoayA9IDA7IGsgPCB0ZW1wbGF0ZUxlbmd0aDsgaysrLCBzaGlmdC0tKSB7CiAgICAgICAgICBqMCA9IGogKyB0ZW1wbGF0ZVhba107CgogICAgICAgICAgaWYgKGowID49IDAgJiYgajAgPCB3aWR0aCkgewogICAgICAgICAgICBpMCA9IGkgKyB0ZW1wbGF0ZVlba107CgogICAgICAgICAgICBpZiAoaTAgPj0gMCkgewogICAgICAgICAgICAgIGJpdCA9IGJpdG1hcFtpMF1bajBdOwoKICAgICAgICAgICAgICBpZiAoYml0KSB7CiAgICAgICAgICAgICAgICBjb250ZXh0TGFiZWwgfD0gYml0IDw8IHNoaWZ0OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgcGl4ZWwgPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIGNvbnRleHRMYWJlbCk7CiAgICAgIHJvd1tqXSA9IHBpeGVsOwogICAgfQogIH0KCiAgcmV0dXJuIGJpdG1hcDsKfQoKZnVuY3Rpb24gZGVjb2RlUmVmaW5lbWVudCh3aWR0aCwgaGVpZ2h0LCB0ZW1wbGF0ZUluZGV4LCByZWZlcmVuY2VCaXRtYXAsIG9mZnNldFgsIG9mZnNldFksIHByZWRpY3Rpb24sIGF0LCBkZWNvZGluZ0NvbnRleHQpIHsKICBsZXQgY29kaW5nVGVtcGxhdGUgPSBSZWZpbmVtZW50VGVtcGxhdGVzW3RlbXBsYXRlSW5kZXhdLmNvZGluZzsKCiAgaWYgKHRlbXBsYXRlSW5kZXggPT09IDApIHsKICAgIGNvZGluZ1RlbXBsYXRlID0gY29kaW5nVGVtcGxhdGUuY29uY2F0KFthdFswXV0pOwogIH0KCiAgY29uc3QgY29kaW5nVGVtcGxhdGVMZW5ndGggPSBjb2RpbmdUZW1wbGF0ZS5sZW5ndGg7CiAgY29uc3QgY29kaW5nVGVtcGxhdGVYID0gbmV3IEludDMyQXJyYXkoY29kaW5nVGVtcGxhdGVMZW5ndGgpOwogIGNvbnN0IGNvZGluZ1RlbXBsYXRlWSA9IG5ldyBJbnQzMkFycmF5KGNvZGluZ1RlbXBsYXRlTGVuZ3RoKTsKICBsZXQgazsKCiAgZm9yIChrID0gMDsgayA8IGNvZGluZ1RlbXBsYXRlTGVuZ3RoOyBrKyspIHsKICAgIGNvZGluZ1RlbXBsYXRlWFtrXSA9IGNvZGluZ1RlbXBsYXRlW2tdLng7CiAgICBjb2RpbmdUZW1wbGF0ZVlba10gPSBjb2RpbmdUZW1wbGF0ZVtrXS55OwogIH0KCiAgbGV0IHJlZmVyZW5jZVRlbXBsYXRlID0gUmVmaW5lbWVudFRlbXBsYXRlc1t0ZW1wbGF0ZUluZGV4XS5yZWZlcmVuY2U7CgogIGlmICh0ZW1wbGF0ZUluZGV4ID09PSAwKSB7CiAgICByZWZlcmVuY2VUZW1wbGF0ZSA9IHJlZmVyZW5jZVRlbXBsYXRlLmNvbmNhdChbYXRbMV1dKTsKICB9CgogIGNvbnN0IHJlZmVyZW5jZVRlbXBsYXRlTGVuZ3RoID0gcmVmZXJlbmNlVGVtcGxhdGUubGVuZ3RoOwogIGNvbnN0IHJlZmVyZW5jZVRlbXBsYXRlWCA9IG5ldyBJbnQzMkFycmF5KHJlZmVyZW5jZVRlbXBsYXRlTGVuZ3RoKTsKICBjb25zdCByZWZlcmVuY2VUZW1wbGF0ZVkgPSBuZXcgSW50MzJBcnJheShyZWZlcmVuY2VUZW1wbGF0ZUxlbmd0aCk7CgogIGZvciAoayA9IDA7IGsgPCByZWZlcmVuY2VUZW1wbGF0ZUxlbmd0aDsgaysrKSB7CiAgICByZWZlcmVuY2VUZW1wbGF0ZVhba10gPSByZWZlcmVuY2VUZW1wbGF0ZVtrXS54OwogICAgcmVmZXJlbmNlVGVtcGxhdGVZW2tdID0gcmVmZXJlbmNlVGVtcGxhdGVba10ueTsKICB9CgogIGNvbnN0IHJlZmVyZW5jZVdpZHRoID0gcmVmZXJlbmNlQml0bWFwWzBdLmxlbmd0aDsKICBjb25zdCByZWZlcmVuY2VIZWlnaHQgPSByZWZlcmVuY2VCaXRtYXAubGVuZ3RoOwogIGNvbnN0IHBzZXVkb1BpeGVsQ29udGV4dCA9IFJlZmluZW1lbnRSZXVzZWRDb250ZXh0c1t0ZW1wbGF0ZUluZGV4XTsKICBjb25zdCBiaXRtYXAgPSBbXTsKICBjb25zdCBkZWNvZGVyID0gZGVjb2RpbmdDb250ZXh0LmRlY29kZXI7CiAgY29uc3QgY29udGV4dHMgPSBkZWNvZGluZ0NvbnRleHQuY29udGV4dENhY2hlLmdldENvbnRleHRzKCJHUiIpOwogIGxldCBsdHAgPSAwOwoKICBmb3IgKGxldCBpID0gMDsgaSA8IGhlaWdodDsgaSsrKSB7CiAgICBpZiAocHJlZGljdGlvbikgewogICAgICBjb25zdCBzbHRwID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBwc2V1ZG9QaXhlbENvbnRleHQpOwogICAgICBsdHAgXj0gc2x0cDsKCiAgICAgIGlmIChsdHApIHsKICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigicHJlZGljdGlvbiBpcyBub3Qgc3VwcG9ydGVkIik7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCByb3cgPSBuZXcgVWludDhBcnJheSh3aWR0aCk7CiAgICBiaXRtYXAucHVzaChyb3cpOwoKICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICBsZXQgaTAsIGowOwogICAgICBsZXQgY29udGV4dExhYmVsID0gMDsKCiAgICAgIGZvciAoayA9IDA7IGsgPCBjb2RpbmdUZW1wbGF0ZUxlbmd0aDsgaysrKSB7CiAgICAgICAgaTAgPSBpICsgY29kaW5nVGVtcGxhdGVZW2tdOwogICAgICAgIGowID0gaiArIGNvZGluZ1RlbXBsYXRlWFtrXTsKCiAgICAgICAgaWYgKGkwIDwgMCB8fCBqMCA8IDAgfHwgajAgPj0gd2lkdGgpIHsKICAgICAgICAgIGNvbnRleHRMYWJlbCA8PD0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29udGV4dExhYmVsID0gY29udGV4dExhYmVsIDw8IDEgfCBiaXRtYXBbaTBdW2owXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAoayA9IDA7IGsgPCByZWZlcmVuY2VUZW1wbGF0ZUxlbmd0aDsgaysrKSB7CiAgICAgICAgaTAgPSBpICsgcmVmZXJlbmNlVGVtcGxhdGVZW2tdIC0gb2Zmc2V0WTsKICAgICAgICBqMCA9IGogKyByZWZlcmVuY2VUZW1wbGF0ZVhba10gLSBvZmZzZXRYOwoKICAgICAgICBpZiAoaTAgPCAwIHx8IGkwID49IHJlZmVyZW5jZUhlaWdodCB8fCBqMCA8IDAgfHwgajAgPj0gcmVmZXJlbmNlV2lkdGgpIHsKICAgICAgICAgIGNvbnRleHRMYWJlbCA8PD0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29udGV4dExhYmVsID0gY29udGV4dExhYmVsIDw8IDEgfCByZWZlcmVuY2VCaXRtYXBbaTBdW2owXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHBpeGVsID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBjb250ZXh0TGFiZWwpOwogICAgICByb3dbal0gPSBwaXhlbDsKICAgIH0KICB9CgogIHJldHVybiBiaXRtYXA7Cn0KCmZ1bmN0aW9uIGRlY29kZVN5bWJvbERpY3Rpb25hcnkoaHVmZm1hbiwgcmVmaW5lbWVudCwgc3ltYm9scywgbnVtYmVyT2ZOZXdTeW1ib2xzLCBudW1iZXJPZkV4cG9ydGVkU3ltYm9scywgaHVmZm1hblRhYmxlcywgdGVtcGxhdGVJbmRleCwgYXQsIHJlZmluZW1lbnRUZW1wbGF0ZUluZGV4LCByZWZpbmVtZW50QXQsIGRlY29kaW5nQ29udGV4dCwgaHVmZm1hbklucHV0KSB7CiAgaWYgKGh1ZmZtYW4gJiYgcmVmaW5lbWVudCkgewogICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoInN5bWJvbCByZWZpbmVtZW50IHdpdGggSHVmZm1hbiBpcyBub3Qgc3VwcG9ydGVkIik7CiAgfQoKICBjb25zdCBuZXdTeW1ib2xzID0gW107CiAgbGV0IGN1cnJlbnRIZWlnaHQgPSAwOwogIGxldCBzeW1ib2xDb2RlTGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLmxvZzIpKHN5bWJvbHMubGVuZ3RoICsgbnVtYmVyT2ZOZXdTeW1ib2xzKTsKICBjb25zdCBkZWNvZGVyID0gZGVjb2RpbmdDb250ZXh0LmRlY29kZXI7CiAgY29uc3QgY29udGV4dENhY2hlID0gZGVjb2RpbmdDb250ZXh0LmNvbnRleHRDYWNoZTsKICBsZXQgdGFibGVCMSwgc3ltYm9sV2lkdGhzOwoKICBpZiAoaHVmZm1hbikgewogICAgdGFibGVCMSA9IGdldFN0YW5kYXJkVGFibGUoMSk7CiAgICBzeW1ib2xXaWR0aHMgPSBbXTsKICAgIHN5bWJvbENvZGVMZW5ndGggPSBNYXRoLm1heChzeW1ib2xDb2RlTGVuZ3RoLCAxKTsKICB9CgogIHdoaWxlIChuZXdTeW1ib2xzLmxlbmd0aCA8IG51bWJlck9mTmV3U3ltYm9scykgewogICAgY29uc3QgZGVsdGFIZWlnaHQgPSBodWZmbWFuID8gaHVmZm1hblRhYmxlcy50YWJsZURlbHRhSGVpZ2h0LmRlY29kZShodWZmbWFuSW5wdXQpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQURIIiwgZGVjb2Rlcik7CiAgICBjdXJyZW50SGVpZ2h0ICs9IGRlbHRhSGVpZ2h0OwogICAgbGV0IGN1cnJlbnRXaWR0aCA9IDAsCiAgICAgICAgdG90YWxXaWR0aCA9IDA7CiAgICBjb25zdCBmaXJzdFN5bWJvbCA9IGh1ZmZtYW4gPyBzeW1ib2xXaWR0aHMubGVuZ3RoIDogMDsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBjb25zdCBkZWx0YVdpZHRoID0gaHVmZm1hbiA/IGh1ZmZtYW5UYWJsZXMudGFibGVEZWx0YVdpZHRoLmRlY29kZShodWZmbWFuSW5wdXQpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQURXIiwgZGVjb2Rlcik7CgogICAgICBpZiAoZGVsdGFXaWR0aCA9PT0gbnVsbCkgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBjdXJyZW50V2lkdGggKz0gZGVsdGFXaWR0aDsKICAgICAgdG90YWxXaWR0aCArPSBjdXJyZW50V2lkdGg7CiAgICAgIGxldCBiaXRtYXA7CgogICAgICBpZiAocmVmaW5lbWVudCkgewogICAgICAgIGNvbnN0IG51bWJlck9mSW5zdGFuY2VzID0gZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQUFJIiwgZGVjb2Rlcik7CgogICAgICAgIGlmIChudW1iZXJPZkluc3RhbmNlcyA+IDEpIHsKICAgICAgICAgIGJpdG1hcCA9IGRlY29kZVRleHRSZWdpb24oaHVmZm1hbiwgcmVmaW5lbWVudCwgY3VycmVudFdpZHRoLCBjdXJyZW50SGVpZ2h0LCAwLCBudW1iZXJPZkluc3RhbmNlcywgMSwgc3ltYm9scy5jb25jYXQobmV3U3ltYm9scyksIHN5bWJvbENvZGVMZW5ndGgsIDAsIDAsIDEsIDAsIGh1ZmZtYW5UYWJsZXMsIHJlZmluZW1lbnRUZW1wbGF0ZUluZGV4LCByZWZpbmVtZW50QXQsIGRlY29kaW5nQ29udGV4dCwgMCwgaHVmZm1hbklucHV0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3Qgc3ltYm9sSWQgPSBkZWNvZGVJQUlEKGNvbnRleHRDYWNoZSwgZGVjb2Rlciwgc3ltYm9sQ29kZUxlbmd0aCk7CiAgICAgICAgICBjb25zdCByZHggPSBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBUkRYIiwgZGVjb2Rlcik7CiAgICAgICAgICBjb25zdCByZHkgPSBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBUkRZIiwgZGVjb2Rlcik7CiAgICAgICAgICBjb25zdCBzeW1ib2wgPSBzeW1ib2xJZCA8IHN5bWJvbHMubGVuZ3RoID8gc3ltYm9sc1tzeW1ib2xJZF0gOiBuZXdTeW1ib2xzW3N5bWJvbElkIC0gc3ltYm9scy5sZW5ndGhdOwogICAgICAgICAgYml0bWFwID0gZGVjb2RlUmVmaW5lbWVudChjdXJyZW50V2lkdGgsIGN1cnJlbnRIZWlnaHQsIHJlZmluZW1lbnRUZW1wbGF0ZUluZGV4LCBzeW1ib2wsIHJkeCwgcmR5LCBmYWxzZSwgcmVmaW5lbWVudEF0LCBkZWNvZGluZ0NvbnRleHQpOwogICAgICAgIH0KCiAgICAgICAgbmV3U3ltYm9scy5wdXNoKGJpdG1hcCk7CiAgICAgIH0gZWxzZSBpZiAoaHVmZm1hbikgewogICAgICAgIHN5bWJvbFdpZHRocy5wdXNoKGN1cnJlbnRXaWR0aCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYml0bWFwID0gZGVjb2RlQml0bWFwKGZhbHNlLCBjdXJyZW50V2lkdGgsIGN1cnJlbnRIZWlnaHQsIHRlbXBsYXRlSW5kZXgsIGZhbHNlLCBudWxsLCBhdCwgZGVjb2RpbmdDb250ZXh0KTsKICAgICAgICBuZXdTeW1ib2xzLnB1c2goYml0bWFwKTsKICAgICAgfQogICAgfQoKICAgIGlmIChodWZmbWFuICYmICFyZWZpbmVtZW50KSB7CiAgICAgIGNvbnN0IGJpdG1hcFNpemUgPSBodWZmbWFuVGFibGVzLnRhYmxlQml0bWFwU2l6ZS5kZWNvZGUoaHVmZm1hbklucHV0KTsKICAgICAgaHVmZm1hbklucHV0LmJ5dGVBbGlnbigpOwogICAgICBsZXQgY29sbGVjdGl2ZUJpdG1hcDsKCiAgICAgIGlmIChiaXRtYXBTaXplID09PSAwKSB7CiAgICAgICAgY29sbGVjdGl2ZUJpdG1hcCA9IHJlYWRVbmNvbXByZXNzZWRCaXRtYXAoaHVmZm1hbklucHV0LCB0b3RhbFdpZHRoLCBjdXJyZW50SGVpZ2h0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBvcmlnaW5hbEVuZCA9IGh1ZmZtYW5JbnB1dC5lbmQ7CiAgICAgICAgY29uc3QgYml0bWFwRW5kID0gaHVmZm1hbklucHV0LnBvc2l0aW9uICsgYml0bWFwU2l6ZTsKICAgICAgICBodWZmbWFuSW5wdXQuZW5kID0gYml0bWFwRW5kOwogICAgICAgIGNvbGxlY3RpdmVCaXRtYXAgPSBkZWNvZGVNTVJCaXRtYXAoaHVmZm1hbklucHV0LCB0b3RhbFdpZHRoLCBjdXJyZW50SGVpZ2h0LCBmYWxzZSk7CiAgICAgICAgaHVmZm1hbklucHV0LmVuZCA9IG9yaWdpbmFsRW5kOwogICAgICAgIGh1ZmZtYW5JbnB1dC5wb3NpdGlvbiA9IGJpdG1hcEVuZDsKICAgICAgfQoKICAgICAgY29uc3QgbnVtYmVyT2ZTeW1ib2xzRGVjb2RlZCA9IHN5bWJvbFdpZHRocy5sZW5ndGg7CgogICAgICBpZiAoZmlyc3RTeW1ib2wgPT09IG51bWJlck9mU3ltYm9sc0RlY29kZWQgLSAxKSB7CiAgICAgICAgbmV3U3ltYm9scy5wdXNoKGNvbGxlY3RpdmVCaXRtYXApOwogICAgICB9IGVsc2UgewogICAgICAgIGxldCBpLAogICAgICAgICAgICB5LAogICAgICAgICAgICB4TWluID0gMCwKICAgICAgICAgICAgeE1heCwKICAgICAgICAgICAgYml0bWFwV2lkdGgsCiAgICAgICAgICAgIHN5bWJvbEJpdG1hcDsKCiAgICAgICAgZm9yIChpID0gZmlyc3RTeW1ib2w7IGkgPCBudW1iZXJPZlN5bWJvbHNEZWNvZGVkOyBpKyspIHsKICAgICAgICAgIGJpdG1hcFdpZHRoID0gc3ltYm9sV2lkdGhzW2ldOwogICAgICAgICAgeE1heCA9IHhNaW4gKyBiaXRtYXBXaWR0aDsKICAgICAgICAgIHN5bWJvbEJpdG1hcCA9IFtdOwoKICAgICAgICAgIGZvciAoeSA9IDA7IHkgPCBjdXJyZW50SGVpZ2h0OyB5KyspIHsKICAgICAgICAgICAgc3ltYm9sQml0bWFwLnB1c2goY29sbGVjdGl2ZUJpdG1hcFt5XS5zdWJhcnJheSh4TWluLCB4TWF4KSk7CiAgICAgICAgICB9CgogICAgICAgICAgbmV3U3ltYm9scy5wdXNoKHN5bWJvbEJpdG1hcCk7CiAgICAgICAgICB4TWluID0geE1heDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGNvbnN0IGV4cG9ydGVkU3ltYm9scyA9IFtdLAogICAgICAgIGZsYWdzID0gW107CiAgbGV0IGN1cnJlbnRGbGFnID0gZmFsc2UsCiAgICAgIGksCiAgICAgIGlpOwogIGNvbnN0IHRvdGFsU3ltYm9sc0xlbmd0aCA9IHN5bWJvbHMubGVuZ3RoICsgbnVtYmVyT2ZOZXdTeW1ib2xzOwoKICB3aGlsZSAoZmxhZ3MubGVuZ3RoIDwgdG90YWxTeW1ib2xzTGVuZ3RoKSB7CiAgICBsZXQgcnVuTGVuZ3RoID0gaHVmZm1hbiA/IHRhYmxlQjEuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBRVgiLCBkZWNvZGVyKTsKCiAgICB3aGlsZSAocnVuTGVuZ3RoLS0pIHsKICAgICAgZmxhZ3MucHVzaChjdXJyZW50RmxhZyk7CiAgICB9CgogICAgY3VycmVudEZsYWcgPSAhY3VycmVudEZsYWc7CiAgfQoKICBmb3IgKGkgPSAwLCBpaSA9IHN5bWJvbHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgaWYgKGZsYWdzW2ldKSB7CiAgICAgIGV4cG9ydGVkU3ltYm9scy5wdXNoKHN5bWJvbHNbaV0pOwogICAgfQogIH0KCiAgZm9yIChsZXQgaiA9IDA7IGogPCBudW1iZXJPZk5ld1N5bWJvbHM7IGkrKywgaisrKSB7CiAgICBpZiAoZmxhZ3NbaV0pIHsKICAgICAgZXhwb3J0ZWRTeW1ib2xzLnB1c2gobmV3U3ltYm9sc1tqXSk7CiAgICB9CiAgfQoKICByZXR1cm4gZXhwb3J0ZWRTeW1ib2xzOwp9CgpmdW5jdGlvbiBkZWNvZGVUZXh0UmVnaW9uKGh1ZmZtYW4sIHJlZmluZW1lbnQsIHdpZHRoLCBoZWlnaHQsIGRlZmF1bHRQaXhlbFZhbHVlLCBudW1iZXJPZlN5bWJvbEluc3RhbmNlcywgc3RyaXBTaXplLCBpbnB1dFN5bWJvbHMsIHN5bWJvbENvZGVMZW5ndGgsIHRyYW5zcG9zZWQsIGRzT2Zmc2V0LCByZWZlcmVuY2VDb3JuZXIsIGNvbWJpbmF0aW9uT3BlcmF0b3IsIGh1ZmZtYW5UYWJsZXMsIHJlZmluZW1lbnRUZW1wbGF0ZUluZGV4LCByZWZpbmVtZW50QXQsIGRlY29kaW5nQ29udGV4dCwgbG9nU3RyaXBTaXplLCBodWZmbWFuSW5wdXQpIHsKICBpZiAoaHVmZm1hbiAmJiByZWZpbmVtZW50KSB7CiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigicmVmaW5lbWVudCB3aXRoIEh1ZmZtYW4gaXMgbm90IHN1cHBvcnRlZCIpOwogIH0KCiAgY29uc3QgYml0bWFwID0gW107CiAgbGV0IGksIHJvdzsKCiAgZm9yIChpID0gMDsgaSA8IGhlaWdodDsgaSsrKSB7CiAgICByb3cgPSBuZXcgVWludDhBcnJheSh3aWR0aCk7CgogICAgaWYgKGRlZmF1bHRQaXhlbFZhbHVlKSB7CiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgIHJvd1tqXSA9IGRlZmF1bHRQaXhlbFZhbHVlOwogICAgICB9CiAgICB9CgogICAgYml0bWFwLnB1c2gocm93KTsKICB9CgogIGNvbnN0IGRlY29kZXIgPSBkZWNvZGluZ0NvbnRleHQuZGVjb2RlcjsKICBjb25zdCBjb250ZXh0Q2FjaGUgPSBkZWNvZGluZ0NvbnRleHQuY29udGV4dENhY2hlOwogIGxldCBzdHJpcFQgPSBodWZmbWFuID8gLWh1ZmZtYW5UYWJsZXMudGFibGVEZWx0YVQuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiAtZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQURUIiwgZGVjb2Rlcik7CiAgbGV0IGZpcnN0UyA9IDA7CiAgaSA9IDA7CgogIHdoaWxlIChpIDwgbnVtYmVyT2ZTeW1ib2xJbnN0YW5jZXMpIHsKICAgIGNvbnN0IGRlbHRhVCA9IGh1ZmZtYW4gPyBodWZmbWFuVGFibGVzLnRhYmxlRGVsdGFULmRlY29kZShodWZmbWFuSW5wdXQpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQURUIiwgZGVjb2Rlcik7CiAgICBzdHJpcFQgKz0gZGVsdGFUOwogICAgY29uc3QgZGVsdGFGaXJzdFMgPSBodWZmbWFuID8gaHVmZm1hblRhYmxlcy50YWJsZUZpcnN0Uy5kZWNvZGUoaHVmZm1hbklucHV0KSA6IGRlY29kZUludGVnZXIoY29udGV4dENhY2hlLCAiSUFGUyIsIGRlY29kZXIpOwogICAgZmlyc3RTICs9IGRlbHRhRmlyc3RTOwogICAgbGV0IGN1cnJlbnRTID0gZmlyc3RTOwoKICAgIGRvIHsKICAgICAgbGV0IGN1cnJlbnRUID0gMDsKCiAgICAgIGlmIChzdHJpcFNpemUgPiAxKSB7CiAgICAgICAgY3VycmVudFQgPSBodWZmbWFuID8gaHVmZm1hbklucHV0LnJlYWRCaXRzKGxvZ1N0cmlwU2l6ZSkgOiBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBSVQiLCBkZWNvZGVyKTsKICAgICAgfQoKICAgICAgY29uc3QgdCA9IHN0cmlwU2l6ZSAqIHN0cmlwVCArIGN1cnJlbnRUOwogICAgICBjb25zdCBzeW1ib2xJZCA9IGh1ZmZtYW4gPyBodWZmbWFuVGFibGVzLnN5bWJvbElEVGFibGUuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiBkZWNvZGVJQUlEKGNvbnRleHRDYWNoZSwgZGVjb2Rlciwgc3ltYm9sQ29kZUxlbmd0aCk7CiAgICAgIGNvbnN0IGFwcGx5UmVmaW5lbWVudCA9IHJlZmluZW1lbnQgJiYgKGh1ZmZtYW4gPyBodWZmbWFuSW5wdXQucmVhZEJpdCgpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQVJJIiwgZGVjb2RlcikpOwogICAgICBsZXQgc3ltYm9sQml0bWFwID0gaW5wdXRTeW1ib2xzW3N5bWJvbElkXTsKICAgICAgbGV0IHN5bWJvbFdpZHRoID0gc3ltYm9sQml0bWFwWzBdLmxlbmd0aDsKICAgICAgbGV0IHN5bWJvbEhlaWdodCA9IHN5bWJvbEJpdG1hcC5sZW5ndGg7CgogICAgICBpZiAoYXBwbHlSZWZpbmVtZW50KSB7CiAgICAgICAgY29uc3QgcmR3ID0gZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQVJEVyIsIGRlY29kZXIpOwogICAgICAgIGNvbnN0IHJkaCA9IGRlY29kZUludGVnZXIoY29udGV4dENhY2hlLCAiSUFSREgiLCBkZWNvZGVyKTsKICAgICAgICBjb25zdCByZHggPSBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBUkRYIiwgZGVjb2Rlcik7CiAgICAgICAgY29uc3QgcmR5ID0gZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQVJEWSIsIGRlY29kZXIpOwogICAgICAgIHN5bWJvbFdpZHRoICs9IHJkdzsKICAgICAgICBzeW1ib2xIZWlnaHQgKz0gcmRoOwogICAgICAgIHN5bWJvbEJpdG1hcCA9IGRlY29kZVJlZmluZW1lbnQoc3ltYm9sV2lkdGgsIHN5bWJvbEhlaWdodCwgcmVmaW5lbWVudFRlbXBsYXRlSW5kZXgsIHN5bWJvbEJpdG1hcCwgKHJkdyA+PiAxKSArIHJkeCwgKHJkaCA+PiAxKSArIHJkeSwgZmFsc2UsIHJlZmluZW1lbnRBdCwgZGVjb2RpbmdDb250ZXh0KTsKICAgICAgfQoKICAgICAgY29uc3Qgb2Zmc2V0VCA9IHQgLSAocmVmZXJlbmNlQ29ybmVyICYgMSA/IDAgOiBzeW1ib2xIZWlnaHQgLSAxKTsKICAgICAgY29uc3Qgb2Zmc2V0UyA9IGN1cnJlbnRTIC0gKHJlZmVyZW5jZUNvcm5lciAmIDIgPyBzeW1ib2xXaWR0aCAtIDEgOiAwKTsKICAgICAgbGV0IHMyLCB0Miwgc3ltYm9sUm93OwoKICAgICAgaWYgKHRyYW5zcG9zZWQpIHsKICAgICAgICBmb3IgKHMyID0gMDsgczIgPCBzeW1ib2xIZWlnaHQ7IHMyKyspIHsKICAgICAgICAgIHJvdyA9IGJpdG1hcFtvZmZzZXRTICsgczJdOwoKICAgICAgICAgIGlmICghcm93KSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHN5bWJvbFJvdyA9IHN5bWJvbEJpdG1hcFtzMl07CiAgICAgICAgICBjb25zdCBtYXhXaWR0aCA9IE1hdGgubWluKHdpZHRoIC0gb2Zmc2V0VCwgc3ltYm9sV2lkdGgpOwoKICAgICAgICAgIHN3aXRjaCAoY29tYmluYXRpb25PcGVyYXRvcikgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgZm9yICh0MiA9IDA7IHQyIDwgbWF4V2lkdGg7IHQyKyspIHsKICAgICAgICAgICAgICAgIHJvd1tvZmZzZXRUICsgdDJdIHw9IHN5bWJvbFJvd1t0Ml07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBmb3IgKHQyID0gMDsgdDIgPCBtYXhXaWR0aDsgdDIrKykgewogICAgICAgICAgICAgICAgcm93W29mZnNldFQgKyB0Ml0gXj0gc3ltYm9sUm93W3QyXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcihgb3BlcmF0b3IgJHtjb21iaW5hdGlvbk9wZXJhdG9yfSBpcyBub3Qgc3VwcG9ydGVkYCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50UyArPSBzeW1ib2xIZWlnaHQgLSAxOwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAodDIgPSAwOyB0MiA8IHN5bWJvbEhlaWdodDsgdDIrKykgewogICAgICAgICAgcm93ID0gYml0bWFwW29mZnNldFQgKyB0Ml07CgogICAgICAgICAgaWYgKCFyb3cpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgc3ltYm9sUm93ID0gc3ltYm9sQml0bWFwW3QyXTsKCiAgICAgICAgICBzd2l0Y2ggKGNvbWJpbmF0aW9uT3BlcmF0b3IpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGZvciAoczIgPSAwOyBzMiA8IHN5bWJvbFdpZHRoOyBzMisrKSB7CiAgICAgICAgICAgICAgICByb3dbb2Zmc2V0UyArIHMyXSB8PSBzeW1ib2xSb3dbczJdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgZm9yIChzMiA9IDA7IHMyIDwgc3ltYm9sV2lkdGg7IHMyKyspIHsKICAgICAgICAgICAgICAgIHJvd1tvZmZzZXRTICsgczJdIF49IHN5bWJvbFJvd1tzMl07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoYG9wZXJhdG9yICR7Y29tYmluYXRpb25PcGVyYXRvcn0gaXMgbm90IHN1cHBvcnRlZGApOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY3VycmVudFMgKz0gc3ltYm9sV2lkdGggLSAxOwogICAgICB9CgogICAgICBpKys7CiAgICAgIGNvbnN0IGRlbHRhUyA9IGh1ZmZtYW4gPyBodWZmbWFuVGFibGVzLnRhYmxlRGVsdGFTLmRlY29kZShodWZmbWFuSW5wdXQpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQURTIiwgZGVjb2Rlcik7CgogICAgICBpZiAoZGVsdGFTID09PSBudWxsKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGN1cnJlbnRTICs9IGRlbHRhUyArIGRzT2Zmc2V0OwogICAgfSB3aGlsZSAodHJ1ZSk7CiAgfQoKICByZXR1cm4gYml0bWFwOwp9CgpmdW5jdGlvbiBkZWNvZGVQYXR0ZXJuRGljdGlvbmFyeShtbXIsIHBhdHRlcm5XaWR0aCwgcGF0dGVybkhlaWdodCwgbWF4UGF0dGVybkluZGV4LCB0ZW1wbGF0ZSwgZGVjb2RpbmdDb250ZXh0KSB7CiAgY29uc3QgYXQgPSBbXTsKCiAgaWYgKCFtbXIpIHsKICAgIGF0LnB1c2goewogICAgICB4OiAtcGF0dGVybldpZHRoLAogICAgICB5OiAwCiAgICB9KTsKCiAgICBpZiAodGVtcGxhdGUgPT09IDApIHsKICAgICAgYXQucHVzaCh7CiAgICAgICAgeDogLTMsCiAgICAgICAgeTogLTEKICAgICAgfSwgewogICAgICAgIHg6IDIsCiAgICAgICAgeTogLTIKICAgICAgfSwgewogICAgICAgIHg6IC0yLAogICAgICAgIHk6IC0yCiAgICAgIH0pOwogICAgfQogIH0KCiAgY29uc3QgY29sbGVjdGl2ZVdpZHRoID0gKG1heFBhdHRlcm5JbmRleCArIDEpICogcGF0dGVybldpZHRoOwogIGNvbnN0IGNvbGxlY3RpdmVCaXRtYXAgPSBkZWNvZGVCaXRtYXAobW1yLCBjb2xsZWN0aXZlV2lkdGgsIHBhdHRlcm5IZWlnaHQsIHRlbXBsYXRlLCBmYWxzZSwgbnVsbCwgYXQsIGRlY29kaW5nQ29udGV4dCk7CiAgY29uc3QgcGF0dGVybnMgPSBbXTsKCiAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbWF4UGF0dGVybkluZGV4OyBpKyspIHsKICAgIGNvbnN0IHBhdHRlcm5CaXRtYXAgPSBbXTsKICAgIGNvbnN0IHhNaW4gPSBwYXR0ZXJuV2lkdGggKiBpOwogICAgY29uc3QgeE1heCA9IHhNaW4gKyBwYXR0ZXJuV2lkdGg7CgogICAgZm9yIChsZXQgeSA9IDA7IHkgPCBwYXR0ZXJuSGVpZ2h0OyB5KyspIHsKICAgICAgcGF0dGVybkJpdG1hcC5wdXNoKGNvbGxlY3RpdmVCaXRtYXBbeV0uc3ViYXJyYXkoeE1pbiwgeE1heCkpOwogICAgfQoKICAgIHBhdHRlcm5zLnB1c2gocGF0dGVybkJpdG1hcCk7CiAgfQoKICByZXR1cm4gcGF0dGVybnM7Cn0KCmZ1bmN0aW9uIGRlY29kZUhhbGZ0b25lUmVnaW9uKG1tciwgcGF0dGVybnMsIHRlbXBsYXRlLCByZWdpb25XaWR0aCwgcmVnaW9uSGVpZ2h0LCBkZWZhdWx0UGl4ZWxWYWx1ZSwgZW5hYmxlU2tpcCwgY29tYmluYXRpb25PcGVyYXRvciwgZ3JpZFdpZHRoLCBncmlkSGVpZ2h0LCBncmlkT2Zmc2V0WCwgZ3JpZE9mZnNldFksIGdyaWRWZWN0b3JYLCBncmlkVmVjdG9yWSwgZGVjb2RpbmdDb250ZXh0KSB7CiAgY29uc3Qgc2tpcCA9IG51bGw7CgogIGlmIChlbmFibGVTa2lwKSB7CiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigic2tpcCBpcyBub3Qgc3VwcG9ydGVkIik7CiAgfQoKICBpZiAoY29tYmluYXRpb25PcGVyYXRvciAhPT0gMCkgewogICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoYG9wZXJhdG9yICIke2NvbWJpbmF0aW9uT3BlcmF0b3J9IiBpcyBub3Qgc3VwcG9ydGVkIGluIGhhbGZ0b25lIHJlZ2lvbmApOwogIH0KCiAgY29uc3QgcmVnaW9uQml0bWFwID0gW107CiAgbGV0IGksIGosIHJvdzsKCiAgZm9yIChpID0gMDsgaSA8IHJlZ2lvbkhlaWdodDsgaSsrKSB7CiAgICByb3cgPSBuZXcgVWludDhBcnJheShyZWdpb25XaWR0aCk7CgogICAgaWYgKGRlZmF1bHRQaXhlbFZhbHVlKSB7CiAgICAgIGZvciAoaiA9IDA7IGogPCByZWdpb25XaWR0aDsgaisrKSB7CiAgICAgICAgcm93W2pdID0gZGVmYXVsdFBpeGVsVmFsdWU7CiAgICAgIH0KICAgIH0KCiAgICByZWdpb25CaXRtYXAucHVzaChyb3cpOwogIH0KCiAgY29uc3QgbnVtYmVyT2ZQYXR0ZXJucyA9IHBhdHRlcm5zLmxlbmd0aDsKICBjb25zdCBwYXR0ZXJuMCA9IHBhdHRlcm5zWzBdOwogIGNvbnN0IHBhdHRlcm5XaWR0aCA9IHBhdHRlcm4wWzBdLmxlbmd0aCwKICAgICAgICBwYXR0ZXJuSGVpZ2h0ID0gcGF0dGVybjAubGVuZ3RoOwogIGNvbnN0IGJpdHNQZXJWYWx1ZSA9ICgwLCBfY29yZV91dGlscy5sb2cyKShudW1iZXJPZlBhdHRlcm5zKTsKICBjb25zdCBhdCA9IFtdOwoKICBpZiAoIW1tcikgewogICAgYXQucHVzaCh7CiAgICAgIHg6IHRlbXBsYXRlIDw9IDEgPyAzIDogMiwKICAgICAgeTogLTEKICAgIH0pOwoKICAgIGlmICh0ZW1wbGF0ZSA9PT0gMCkgewogICAgICBhdC5wdXNoKHsKICAgICAgICB4OiAtMywKICAgICAgICB5OiAtMQogICAgICB9LCB7CiAgICAgICAgeDogMiwKICAgICAgICB5OiAtMgogICAgICB9LCB7CiAgICAgICAgeDogLTIsCiAgICAgICAgeTogLTIKICAgICAgfSk7CiAgICB9CiAgfQoKICBjb25zdCBncmF5U2NhbGVCaXRQbGFuZXMgPSBbXTsKICBsZXQgbW1ySW5wdXQsIGJpdG1hcDsKCiAgaWYgKG1tcikgewogICAgbW1ySW5wdXQgPSBuZXcgUmVhZGVyKGRlY29kaW5nQ29udGV4dC5kYXRhLCBkZWNvZGluZ0NvbnRleHQuc3RhcnQsIGRlY29kaW5nQ29udGV4dC5lbmQpOwogIH0KCiAgZm9yIChpID0gYml0c1BlclZhbHVlIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgIGlmIChtbXIpIHsKICAgICAgYml0bWFwID0gZGVjb2RlTU1SQml0bWFwKG1tcklucHV0LCBncmlkV2lkdGgsIGdyaWRIZWlnaHQsIHRydWUpOwogICAgfSBlbHNlIHsKICAgICAgYml0bWFwID0gZGVjb2RlQml0bWFwKGZhbHNlLCBncmlkV2lkdGgsIGdyaWRIZWlnaHQsIHRlbXBsYXRlLCBmYWxzZSwgc2tpcCwgYXQsIGRlY29kaW5nQ29udGV4dCk7CiAgICB9CgogICAgZ3JheVNjYWxlQml0UGxhbmVzW2ldID0gYml0bWFwOwogIH0KCiAgbGV0IG1nLCBuZywgYml0LCBwYXR0ZXJuSW5kZXgsIHBhdHRlcm5CaXRtYXAsIHgsIHksIHBhdHRlcm5Sb3csIHJlZ2lvblJvdzsKCiAgZm9yIChtZyA9IDA7IG1nIDwgZ3JpZEhlaWdodDsgbWcrKykgewogICAgZm9yIChuZyA9IDA7IG5nIDwgZ3JpZFdpZHRoOyBuZysrKSB7CiAgICAgIGJpdCA9IDA7CiAgICAgIHBhdHRlcm5JbmRleCA9IDA7CgogICAgICBmb3IgKGogPSBiaXRzUGVyVmFsdWUgLSAxOyBqID49IDA7IGotLSkgewogICAgICAgIGJpdCBePSBncmF5U2NhbGVCaXRQbGFuZXNbal1bbWddW25nXTsKICAgICAgICBwYXR0ZXJuSW5kZXggfD0gYml0IDw8IGo7CiAgICAgIH0KCiAgICAgIHBhdHRlcm5CaXRtYXAgPSBwYXR0ZXJuc1twYXR0ZXJuSW5kZXhdOwogICAgICB4ID0gZ3JpZE9mZnNldFggKyBtZyAqIGdyaWRWZWN0b3JZICsgbmcgKiBncmlkVmVjdG9yWCA+PiA4OwogICAgICB5ID0gZ3JpZE9mZnNldFkgKyBtZyAqIGdyaWRWZWN0b3JYIC0gbmcgKiBncmlkVmVjdG9yWSA+PiA4OwoKICAgICAgaWYgKHggPj0gMCAmJiB4ICsgcGF0dGVybldpZHRoIDw9IHJlZ2lvbldpZHRoICYmIHkgPj0gMCAmJiB5ICsgcGF0dGVybkhlaWdodCA8PSByZWdpb25IZWlnaHQpIHsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGF0dGVybkhlaWdodDsgaSsrKSB7CiAgICAgICAgICByZWdpb25Sb3cgPSByZWdpb25CaXRtYXBbeSArIGldOwogICAgICAgICAgcGF0dGVyblJvdyA9IHBhdHRlcm5CaXRtYXBbaV07CgogICAgICAgICAgZm9yIChqID0gMDsgaiA8IHBhdHRlcm5XaWR0aDsgaisrKSB7CiAgICAgICAgICAgIHJlZ2lvblJvd1t4ICsgal0gfD0gcGF0dGVyblJvd1tqXTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGV0IHJlZ2lvblgsIHJlZ2lvblk7CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBwYXR0ZXJuSGVpZ2h0OyBpKyspIHsKICAgICAgICAgIHJlZ2lvblkgPSB5ICsgaTsKCiAgICAgICAgICBpZiAocmVnaW9uWSA8IDAgfHwgcmVnaW9uWSA+PSByZWdpb25IZWlnaHQpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgcmVnaW9uUm93ID0gcmVnaW9uQml0bWFwW3JlZ2lvblldOwogICAgICAgICAgcGF0dGVyblJvdyA9IHBhdHRlcm5CaXRtYXBbaV07CgogICAgICAgICAgZm9yIChqID0gMDsgaiA8IHBhdHRlcm5XaWR0aDsgaisrKSB7CiAgICAgICAgICAgIHJlZ2lvblggPSB4ICsgajsKCiAgICAgICAgICAgIGlmIChyZWdpb25YID49IDAgJiYgcmVnaW9uWCA8IHJlZ2lvbldpZHRoKSB7CiAgICAgICAgICAgICAgcmVnaW9uUm93W3JlZ2lvblhdIHw9IHBhdHRlcm5Sb3dbal07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiByZWdpb25CaXRtYXA7Cn0KCmZ1bmN0aW9uIHJlYWRTZWdtZW50SGVhZGVyKGRhdGEsIHN0YXJ0KSB7CiAgY29uc3Qgc2VnbWVudEhlYWRlciA9IHt9OwogIHNlZ21lbnRIZWFkZXIubnVtYmVyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHN0YXJ0KTsKICBjb25zdCBmbGFncyA9IGRhdGFbc3RhcnQgKyA0XTsKICBjb25zdCBzZWdtZW50VHlwZSA9IGZsYWdzICYgMHgzZjsKCiAgaWYgKCFTZWdtZW50VHlwZXNbc2VnbWVudFR5cGVdKSB7CiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCBzZWdtZW50IHR5cGU6ICIgKyBzZWdtZW50VHlwZSk7CiAgfQoKICBzZWdtZW50SGVhZGVyLnR5cGUgPSBzZWdtZW50VHlwZTsKICBzZWdtZW50SGVhZGVyLnR5cGVOYW1lID0gU2VnbWVudFR5cGVzW3NlZ21lbnRUeXBlXTsKICBzZWdtZW50SGVhZGVyLmRlZmVycmVkTm9uUmV0YWluID0gISEoZmxhZ3MgJiAweDgwKTsKICBjb25zdCBwYWdlQXNzb2NpYXRpb25GaWVsZFNpemUgPSAhIShmbGFncyAmIDB4NDApOwogIGNvbnN0IHJlZmVycmVkRmxhZ3MgPSBkYXRhW3N0YXJ0ICsgNV07CiAgbGV0IHJlZmVycmVkVG9Db3VudCA9IHJlZmVycmVkRmxhZ3MgPj4gNSAmIDc7CiAgY29uc3QgcmV0YWluQml0cyA9IFtyZWZlcnJlZEZsYWdzICYgMzFdOwogIGxldCBwb3NpdGlvbiA9IHN0YXJ0ICsgNjsKCiAgaWYgKHJlZmVycmVkRmxhZ3MgPT09IDcpIHsKICAgIHJlZmVycmVkVG9Db3VudCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiAtIDEpICYgMHgxZmZmZmZmZjsKICAgIHBvc2l0aW9uICs9IDM7CiAgICBsZXQgYnl0ZXMgPSByZWZlcnJlZFRvQ291bnQgKyA3ID4+IDM7CiAgICByZXRhaW5CaXRzWzBdID0gZGF0YVtwb3NpdGlvbisrXTsKCiAgICB3aGlsZSAoLS1ieXRlcyA+IDApIHsKICAgICAgcmV0YWluQml0cy5wdXNoKGRhdGFbcG9zaXRpb24rK10pOwogICAgfQogIH0gZWxzZSBpZiAocmVmZXJyZWRGbGFncyA9PT0gNSB8fCByZWZlcnJlZEZsYWdzID09PSA2KSB7CiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCByZWZlcnJlZC10byBmbGFncyIpOwogIH0KCiAgc2VnbWVudEhlYWRlci5yZXRhaW5CaXRzID0gcmV0YWluQml0czsKICBsZXQgcmVmZXJyZWRUb1NlZ21lbnROdW1iZXJTaXplID0gNDsKCiAgaWYgKHNlZ21lbnRIZWFkZXIubnVtYmVyIDw9IDI1NikgewogICAgcmVmZXJyZWRUb1NlZ21lbnROdW1iZXJTaXplID0gMTsKICB9IGVsc2UgaWYgKHNlZ21lbnRIZWFkZXIubnVtYmVyIDw9IDY1NTM2KSB7CiAgICByZWZlcnJlZFRvU2VnbWVudE51bWJlclNpemUgPSAyOwogIH0KCiAgY29uc3QgcmVmZXJyZWRUbyA9IFtdOwogIGxldCBpLCBpaTsKCiAgZm9yIChpID0gMDsgaSA8IHJlZmVycmVkVG9Db3VudDsgaSsrKSB7CiAgICBsZXQgbnVtYmVyOwoKICAgIGlmIChyZWZlcnJlZFRvU2VnbWVudE51bWJlclNpemUgPT09IDEpIHsKICAgICAgbnVtYmVyID0gZGF0YVtwb3NpdGlvbl07CiAgICB9IGVsc2UgaWYgKHJlZmVycmVkVG9TZWdtZW50TnVtYmVyU2l6ZSA9PT0gMikgewogICAgICBudW1iZXIgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgfSBlbHNlIHsKICAgICAgbnVtYmVyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgIH0KCiAgICByZWZlcnJlZFRvLnB1c2gobnVtYmVyKTsKICAgIHBvc2l0aW9uICs9IHJlZmVycmVkVG9TZWdtZW50TnVtYmVyU2l6ZTsKICB9CgogIHNlZ21lbnRIZWFkZXIucmVmZXJyZWRUbyA9IHJlZmVycmVkVG87CgogIGlmICghcGFnZUFzc29jaWF0aW9uRmllbGRTaXplKSB7CiAgICBzZWdtZW50SGVhZGVyLnBhZ2VBc3NvY2lhdGlvbiA9IGRhdGFbcG9zaXRpb24rK107CiAgfSBlbHNlIHsKICAgIHNlZ21lbnRIZWFkZXIucGFnZUFzc29jaWF0aW9uID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgIHBvc2l0aW9uICs9IDQ7CiAgfQoKICBzZWdtZW50SGVhZGVyLmxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbik7CiAgcG9zaXRpb24gKz0gNDsKCiAgaWYgKHNlZ21lbnRIZWFkZXIubGVuZ3RoID09PSAweGZmZmZmZmZmKSB7CiAgICBpZiAoc2VnbWVudFR5cGUgPT09IDM4KSB7CiAgICAgIGNvbnN0IGdlbmVyaWNSZWdpb25JbmZvID0gcmVhZFJlZ2lvblNlZ21lbnRJbmZvcm1hdGlvbihkYXRhLCBwb3NpdGlvbik7CiAgICAgIGNvbnN0IGdlbmVyaWNSZWdpb25TZWdtZW50RmxhZ3MgPSBkYXRhW3Bvc2l0aW9uICsgUmVnaW9uU2VnbWVudEluZm9ybWF0aW9uRmllbGRMZW5ndGhdOwogICAgICBjb25zdCBnZW5lcmljUmVnaW9uTW1yID0gISEoZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyAmIDEpOwogICAgICBjb25zdCBzZWFyY2hQYXR0ZXJuTGVuZ3RoID0gNjsKICAgICAgY29uc3Qgc2VhcmNoUGF0dGVybiA9IG5ldyBVaW50OEFycmF5KHNlYXJjaFBhdHRlcm5MZW5ndGgpOwoKICAgICAgaWYgKCFnZW5lcmljUmVnaW9uTW1yKSB7CiAgICAgICAgc2VhcmNoUGF0dGVyblswXSA9IDB4ZmY7CiAgICAgICAgc2VhcmNoUGF0dGVyblsxXSA9IDB4YWM7CiAgICAgIH0KCiAgICAgIHNlYXJjaFBhdHRlcm5bMl0gPSBnZW5lcmljUmVnaW9uSW5mby5oZWlnaHQgPj4+IDI0ICYgMHhmZjsKICAgICAgc2VhcmNoUGF0dGVyblszXSA9IGdlbmVyaWNSZWdpb25JbmZvLmhlaWdodCA+PiAxNiAmIDB4ZmY7CiAgICAgIHNlYXJjaFBhdHRlcm5bNF0gPSBnZW5lcmljUmVnaW9uSW5mby5oZWlnaHQgPj4gOCAmIDB4ZmY7CiAgICAgIHNlYXJjaFBhdHRlcm5bNV0gPSBnZW5lcmljUmVnaW9uSW5mby5oZWlnaHQgJiAweGZmOwoKICAgICAgZm9yIChpID0gcG9zaXRpb24sIGlpID0gZGF0YS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgbGV0IGogPSAwOwoKICAgICAgICB3aGlsZSAoaiA8IHNlYXJjaFBhdHRlcm5MZW5ndGggJiYgc2VhcmNoUGF0dGVybltqXSA9PT0gZGF0YVtpICsgal0pIHsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGlmIChqID09PSBzZWFyY2hQYXR0ZXJuTGVuZ3RoKSB7CiAgICAgICAgICBzZWdtZW50SGVhZGVyLmxlbmd0aCA9IGkgKyBzZWFyY2hQYXR0ZXJuTGVuZ3RoOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoc2VnbWVudEhlYWRlci5sZW5ndGggPT09IDB4ZmZmZmZmZmYpIHsKICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigic2VnbWVudCBlbmQgd2FzIG5vdCBmb3VuZCIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCB1bmtub3duIHNlZ21lbnQgbGVuZ3RoIik7CiAgICB9CiAgfQoKICBzZWdtZW50SGVhZGVyLmhlYWRlckVuZCA9IHBvc2l0aW9uOwogIHJldHVybiBzZWdtZW50SGVhZGVyOwp9CgpmdW5jdGlvbiByZWFkU2VnbWVudHMoaGVhZGVyLCBkYXRhLCBzdGFydCwgZW5kKSB7CiAgY29uc3Qgc2VnbWVudHMgPSBbXTsKICBsZXQgcG9zaXRpb24gPSBzdGFydDsKCiAgd2hpbGUgKHBvc2l0aW9uIDwgZW5kKSB7CiAgICBjb25zdCBzZWdtZW50SGVhZGVyID0gcmVhZFNlZ21lbnRIZWFkZXIoZGF0YSwgcG9zaXRpb24pOwogICAgcG9zaXRpb24gPSBzZWdtZW50SGVhZGVyLmhlYWRlckVuZDsKICAgIGNvbnN0IHNlZ21lbnQgPSB7CiAgICAgIGhlYWRlcjogc2VnbWVudEhlYWRlciwKICAgICAgZGF0YQogICAgfTsKCiAgICBpZiAoIWhlYWRlci5yYW5kb21BY2Nlc3MpIHsKICAgICAgc2VnbWVudC5zdGFydCA9IHBvc2l0aW9uOwogICAgICBwb3NpdGlvbiArPSBzZWdtZW50SGVhZGVyLmxlbmd0aDsKICAgICAgc2VnbWVudC5lbmQgPSBwb3NpdGlvbjsKICAgIH0KCiAgICBzZWdtZW50cy5wdXNoKHNlZ21lbnQpOwoKICAgIGlmIChzZWdtZW50SGVhZGVyLnR5cGUgPT09IDUxKSB7CiAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgaWYgKGhlYWRlci5yYW5kb21BY2Nlc3MpIHsKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHNlZ21lbnRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgc2VnbWVudHNbaV0uc3RhcnQgPSBwb3NpdGlvbjsKICAgICAgcG9zaXRpb24gKz0gc2VnbWVudHNbaV0uaGVhZGVyLmxlbmd0aDsKICAgICAgc2VnbWVudHNbaV0uZW5kID0gcG9zaXRpb247CiAgICB9CiAgfQoKICByZXR1cm4gc2VnbWVudHM7Cn0KCmZ1bmN0aW9uIHJlYWRSZWdpb25TZWdtZW50SW5mb3JtYXRpb24oZGF0YSwgc3RhcnQpIHsKICByZXR1cm4gewogICAgd2lkdGg6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBzdGFydCksCiAgICBoZWlnaHQ6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBzdGFydCArIDQpLAogICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHN0YXJ0ICsgOCksCiAgICB5OiAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgc3RhcnQgKyAxMiksCiAgICBjb21iaW5hdGlvbk9wZXJhdG9yOiBkYXRhW3N0YXJ0ICsgMTZdICYgNwogIH07Cn0KCmNvbnN0IFJlZ2lvblNlZ21lbnRJbmZvcm1hdGlvbkZpZWxkTGVuZ3RoID0gMTc7CgpmdW5jdGlvbiBwcm9jZXNzU2VnbWVudChzZWdtZW50LCB2aXNpdG9yKSB7CiAgY29uc3QgaGVhZGVyID0gc2VnbWVudC5oZWFkZXI7CiAgY29uc3QgZGF0YSA9IHNlZ21lbnQuZGF0YSwKICAgICAgICBlbmQgPSBzZWdtZW50LmVuZDsKICBsZXQgcG9zaXRpb24gPSBzZWdtZW50LnN0YXJ0OwogIGxldCBhcmdzLCBhdCwgaSwgYXRMZW5ndGg7CgogIHN3aXRjaCAoaGVhZGVyLnR5cGUpIHsKICAgIGNhc2UgMDoKICAgICAgY29uc3QgZGljdGlvbmFyeSA9IHt9OwogICAgICBjb25zdCBkaWN0aW9uYXJ5RmxhZ3MgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICBkaWN0aW9uYXJ5Lmh1ZmZtYW4gPSAhIShkaWN0aW9uYXJ5RmxhZ3MgJiAxKTsKICAgICAgZGljdGlvbmFyeS5yZWZpbmVtZW50ID0gISEoZGljdGlvbmFyeUZsYWdzICYgMik7CiAgICAgIGRpY3Rpb25hcnkuaHVmZm1hbkRIU2VsZWN0b3IgPSBkaWN0aW9uYXJ5RmxhZ3MgPj4gMiAmIDM7CiAgICAgIGRpY3Rpb25hcnkuaHVmZm1hbkRXU2VsZWN0b3IgPSBkaWN0aW9uYXJ5RmxhZ3MgPj4gNCAmIDM7CiAgICAgIGRpY3Rpb25hcnkuYml0bWFwU2l6ZVNlbGVjdG9yID0gZGljdGlvbmFyeUZsYWdzID4+IDYgJiAxOwogICAgICBkaWN0aW9uYXJ5LmFnZ3JlZ2F0aW9uSW5zdGFuY2VzU2VsZWN0b3IgPSBkaWN0aW9uYXJ5RmxhZ3MgPj4gNyAmIDE7CiAgICAgIGRpY3Rpb25hcnkuYml0bWFwQ29kaW5nQ29udGV4dFVzZWQgPSAhIShkaWN0aW9uYXJ5RmxhZ3MgJiAyNTYpOwogICAgICBkaWN0aW9uYXJ5LmJpdG1hcENvZGluZ0NvbnRleHRSZXRhaW5lZCA9ICEhKGRpY3Rpb25hcnlGbGFncyAmIDUxMik7CiAgICAgIGRpY3Rpb25hcnkudGVtcGxhdGUgPSBkaWN0aW9uYXJ5RmxhZ3MgPj4gMTAgJiAzOwogICAgICBkaWN0aW9uYXJ5LnJlZmluZW1lbnRUZW1wbGF0ZSA9IGRpY3Rpb25hcnlGbGFncyA+PiAxMiAmIDE7CiAgICAgIHBvc2l0aW9uICs9IDI7CgogICAgICBpZiAoIWRpY3Rpb25hcnkuaHVmZm1hbikgewogICAgICAgIGF0TGVuZ3RoID0gZGljdGlvbmFyeS50ZW1wbGF0ZSA9PT0gMCA/IDQgOiAxOwogICAgICAgIGF0ID0gW107CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBhdExlbmd0aDsgaSsrKSB7CiAgICAgICAgICBhdC5wdXNoKHsKICAgICAgICAgICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiksCiAgICAgICAgICAgIHk6ICgwLCBfY29yZV91dGlscy5yZWFkSW50OCkoZGF0YSwgcG9zaXRpb24gKyAxKQogICAgICAgICAgfSk7CiAgICAgICAgICBwb3NpdGlvbiArPSAyOwogICAgICAgIH0KCiAgICAgICAgZGljdGlvbmFyeS5hdCA9IGF0OwogICAgICB9CgogICAgICBpZiAoZGljdGlvbmFyeS5yZWZpbmVtZW50ICYmICFkaWN0aW9uYXJ5LnJlZmluZW1lbnRUZW1wbGF0ZSkgewogICAgICAgIGF0ID0gW107CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCAyOyBpKyspIHsKICAgICAgICAgIGF0LnB1c2goewogICAgICAgICAgICB4OiAoMCwgX2NvcmVfdXRpbHMucmVhZEludDgpKGRhdGEsIHBvc2l0aW9uKSwKICAgICAgICAgICAgeTogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiArIDEpCiAgICAgICAgICB9KTsKICAgICAgICAgIHBvc2l0aW9uICs9IDI7CiAgICAgICAgfQoKICAgICAgICBkaWN0aW9uYXJ5LnJlZmluZW1lbnRBdCA9IGF0OwogICAgICB9CgogICAgICBkaWN0aW9uYXJ5Lm51bWJlck9mRXhwb3J0ZWRTeW1ib2xzID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgcG9zaXRpb24gKz0gNDsKICAgICAgZGljdGlvbmFyeS5udW1iZXJPZk5ld1N5bWJvbHMgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSA0OwogICAgICBhcmdzID0gW2RpY3Rpb25hcnksIGhlYWRlci5udW1iZXIsIGhlYWRlci5yZWZlcnJlZFRvLCBkYXRhLCBwb3NpdGlvbiwgZW5kXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA2OgogICAgY2FzZSA3OgogICAgICBjb25zdCB0ZXh0UmVnaW9uID0ge307CiAgICAgIHRleHRSZWdpb24uaW5mbyA9IHJlYWRSZWdpb25TZWdtZW50SW5mb3JtYXRpb24oZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSBSZWdpb25TZWdtZW50SW5mb3JtYXRpb25GaWVsZExlbmd0aDsKICAgICAgY29uc3QgdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgIHBvc2l0aW9uICs9IDI7CiAgICAgIHRleHRSZWdpb24uaHVmZm1hbiA9ICEhKHRleHRSZWdpb25TZWdtZW50RmxhZ3MgJiAxKTsKICAgICAgdGV4dFJlZ2lvbi5yZWZpbmVtZW50ID0gISEodGV4dFJlZ2lvblNlZ21lbnRGbGFncyAmIDIpOwogICAgICB0ZXh0UmVnaW9uLmxvZ1N0cmlwU2l6ZSA9IHRleHRSZWdpb25TZWdtZW50RmxhZ3MgPj4gMiAmIDM7CiAgICAgIHRleHRSZWdpb24uc3RyaXBTaXplID0gMSA8PCB0ZXh0UmVnaW9uLmxvZ1N0cmlwU2l6ZTsKICAgICAgdGV4dFJlZ2lvbi5yZWZlcmVuY2VDb3JuZXIgPSB0ZXh0UmVnaW9uU2VnbWVudEZsYWdzID4+IDQgJiAzOwogICAgICB0ZXh0UmVnaW9uLnRyYW5zcG9zZWQgPSAhISh0ZXh0UmVnaW9uU2VnbWVudEZsYWdzICYgNjQpOwogICAgICB0ZXh0UmVnaW9uLmNvbWJpbmF0aW9uT3BlcmF0b3IgPSB0ZXh0UmVnaW9uU2VnbWVudEZsYWdzID4+IDcgJiAzOwogICAgICB0ZXh0UmVnaW9uLmRlZmF1bHRQaXhlbFZhbHVlID0gdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA+PiA5ICYgMTsKICAgICAgdGV4dFJlZ2lvbi5kc09mZnNldCA9IHRleHRSZWdpb25TZWdtZW50RmxhZ3MgPDwgMTcgPj4gMjc7CiAgICAgIHRleHRSZWdpb24ucmVmaW5lbWVudFRlbXBsYXRlID0gdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA+PiAxNSAmIDE7CgogICAgICBpZiAodGV4dFJlZ2lvbi5odWZmbWFuKSB7CiAgICAgICAgY29uc3QgdGV4dFJlZ2lvbkh1ZmZtYW5GbGFncyA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb24gKz0gMjsKICAgICAgICB0ZXh0UmVnaW9uLmh1ZmZtYW5GUyA9IHRleHRSZWdpb25IdWZmbWFuRmxhZ3MgJiAzOwogICAgICAgIHRleHRSZWdpb24uaHVmZm1hbkRTID0gdGV4dFJlZ2lvbkh1ZmZtYW5GbGFncyA+PiAyICYgMzsKICAgICAgICB0ZXh0UmVnaW9uLmh1ZmZtYW5EVCA9IHRleHRSZWdpb25IdWZmbWFuRmxhZ3MgPj4gNCAmIDM7CiAgICAgICAgdGV4dFJlZ2lvbi5odWZmbWFuUmVmaW5lbWVudERXID0gdGV4dFJlZ2lvbkh1ZmZtYW5GbGFncyA+PiA2ICYgMzsKICAgICAgICB0ZXh0UmVnaW9uLmh1ZmZtYW5SZWZpbmVtZW50REggPSB0ZXh0UmVnaW9uSHVmZm1hbkZsYWdzID4+IDggJiAzOwogICAgICAgIHRleHRSZWdpb24uaHVmZm1hblJlZmluZW1lbnREWCA9IHRleHRSZWdpb25IdWZmbWFuRmxhZ3MgPj4gMTAgJiAzOwogICAgICAgIHRleHRSZWdpb24uaHVmZm1hblJlZmluZW1lbnREWSA9IHRleHRSZWdpb25IdWZmbWFuRmxhZ3MgPj4gMTIgJiAzOwogICAgICAgIHRleHRSZWdpb24uaHVmZm1hblJlZmluZW1lbnRTaXplU2VsZWN0b3IgPSAhISh0ZXh0UmVnaW9uSHVmZm1hbkZsYWdzICYgMHg0MDAwKTsKICAgICAgfQoKICAgICAgaWYgKHRleHRSZWdpb24ucmVmaW5lbWVudCAmJiAhdGV4dFJlZ2lvbi5yZWZpbmVtZW50VGVtcGxhdGUpIHsKICAgICAgICBhdCA9IFtdOwoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMjsgaSsrKSB7CiAgICAgICAgICBhdC5wdXNoKHsKICAgICAgICAgICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiksCiAgICAgICAgICAgIHk6ICgwLCBfY29yZV91dGlscy5yZWFkSW50OCkoZGF0YSwgcG9zaXRpb24gKyAxKQogICAgICAgICAgfSk7CiAgICAgICAgICBwb3NpdGlvbiArPSAyOwogICAgICAgIH0KCiAgICAgICAgdGV4dFJlZ2lvbi5yZWZpbmVtZW50QXQgPSBhdDsKICAgICAgfQoKICAgICAgdGV4dFJlZ2lvbi5udW1iZXJPZlN5bWJvbEluc3RhbmNlcyA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbik7CiAgICAgIHBvc2l0aW9uICs9IDQ7CiAgICAgIGFyZ3MgPSBbdGV4dFJlZ2lvbiwgaGVhZGVyLnJlZmVycmVkVG8sIGRhdGEsIHBvc2l0aW9uLCBlbmRdOwogICAgICBicmVhazsKCiAgICBjYXNlIDE2OgogICAgICBjb25zdCBwYXR0ZXJuRGljdGlvbmFyeSA9IHt9OwogICAgICBjb25zdCBwYXR0ZXJuRGljdGlvbmFyeUZsYWdzID0gZGF0YVtwb3NpdGlvbisrXTsKICAgICAgcGF0dGVybkRpY3Rpb25hcnkubW1yID0gISEocGF0dGVybkRpY3Rpb25hcnlGbGFncyAmIDEpOwogICAgICBwYXR0ZXJuRGljdGlvbmFyeS50ZW1wbGF0ZSA9IHBhdHRlcm5EaWN0aW9uYXJ5RmxhZ3MgPj4gMSAmIDM7CiAgICAgIHBhdHRlcm5EaWN0aW9uYXJ5LnBhdHRlcm5XaWR0aCA9IGRhdGFbcG9zaXRpb24rK107CiAgICAgIHBhdHRlcm5EaWN0aW9uYXJ5LnBhdHRlcm5IZWlnaHQgPSBkYXRhW3Bvc2l0aW9uKytdOwogICAgICBwYXR0ZXJuRGljdGlvbmFyeS5tYXhQYXR0ZXJuSW5kZXggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSA0OwogICAgICBhcmdzID0gW3BhdHRlcm5EaWN0aW9uYXJ5LCBoZWFkZXIubnVtYmVyLCBkYXRhLCBwb3NpdGlvbiwgZW5kXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAyMjoKICAgIGNhc2UgMjM6CiAgICAgIGNvbnN0IGhhbGZ0b25lUmVnaW9uID0ge307CiAgICAgIGhhbGZ0b25lUmVnaW9uLmluZm8gPSByZWFkUmVnaW9uU2VnbWVudEluZm9ybWF0aW9uKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgcG9zaXRpb24gKz0gUmVnaW9uU2VnbWVudEluZm9ybWF0aW9uRmllbGRMZW5ndGg7CiAgICAgIGNvbnN0IGhhbGZ0b25lUmVnaW9uRmxhZ3MgPSBkYXRhW3Bvc2l0aW9uKytdOwogICAgICBoYWxmdG9uZVJlZ2lvbi5tbXIgPSAhIShoYWxmdG9uZVJlZ2lvbkZsYWdzICYgMSk7CiAgICAgIGhhbGZ0b25lUmVnaW9uLnRlbXBsYXRlID0gaGFsZnRvbmVSZWdpb25GbGFncyA+PiAxICYgMzsKICAgICAgaGFsZnRvbmVSZWdpb24uZW5hYmxlU2tpcCA9ICEhKGhhbGZ0b25lUmVnaW9uRmxhZ3MgJiA4KTsKICAgICAgaGFsZnRvbmVSZWdpb24uY29tYmluYXRpb25PcGVyYXRvciA9IGhhbGZ0b25lUmVnaW9uRmxhZ3MgPj4gNCAmIDc7CiAgICAgIGhhbGZ0b25lUmVnaW9uLmRlZmF1bHRQaXhlbFZhbHVlID0gaGFsZnRvbmVSZWdpb25GbGFncyA+PiA3ICYgMTsKICAgICAgaGFsZnRvbmVSZWdpb24uZ3JpZFdpZHRoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgcG9zaXRpb24gKz0gNDsKICAgICAgaGFsZnRvbmVSZWdpb24uZ3JpZEhlaWdodCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbik7CiAgICAgIHBvc2l0aW9uICs9IDQ7CiAgICAgIGhhbGZ0b25lUmVnaW9uLmdyaWRPZmZzZXRYID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKSAmIDB4ZmZmZmZmZmY7CiAgICAgIHBvc2l0aW9uICs9IDQ7CiAgICAgIGhhbGZ0b25lUmVnaW9uLmdyaWRPZmZzZXRZID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKSAmIDB4ZmZmZmZmZmY7CiAgICAgIHBvc2l0aW9uICs9IDQ7CiAgICAgIGhhbGZ0b25lUmVnaW9uLmdyaWRWZWN0b3JYID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgcG9zaXRpb24gKz0gMjsKICAgICAgaGFsZnRvbmVSZWdpb24uZ3JpZFZlY3RvclkgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSAyOwogICAgICBhcmdzID0gW2hhbGZ0b25lUmVnaW9uLCBoZWFkZXIucmVmZXJyZWRUbywgZGF0YSwgcG9zaXRpb24sIGVuZF07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzg6CiAgICBjYXNlIDM5OgogICAgICBjb25zdCBnZW5lcmljUmVnaW9uID0ge307CiAgICAgIGdlbmVyaWNSZWdpb24uaW5mbyA9IHJlYWRSZWdpb25TZWdtZW50SW5mb3JtYXRpb24oZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSBSZWdpb25TZWdtZW50SW5mb3JtYXRpb25GaWVsZExlbmd0aDsKICAgICAgY29uc3QgZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyA9IGRhdGFbcG9zaXRpb24rK107CiAgICAgIGdlbmVyaWNSZWdpb24ubW1yID0gISEoZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyAmIDEpOwogICAgICBnZW5lcmljUmVnaW9uLnRlbXBsYXRlID0gZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyA+PiAxICYgMzsKICAgICAgZ2VuZXJpY1JlZ2lvbi5wcmVkaWN0aW9uID0gISEoZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyAmIDgpOwoKICAgICAgaWYgKCFnZW5lcmljUmVnaW9uLm1tcikgewogICAgICAgIGF0TGVuZ3RoID0gZ2VuZXJpY1JlZ2lvbi50ZW1wbGF0ZSA9PT0gMCA/IDQgOiAxOwogICAgICAgIGF0ID0gW107CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBhdExlbmd0aDsgaSsrKSB7CiAgICAgICAgICBhdC5wdXNoKHsKICAgICAgICAgICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiksCiAgICAgICAgICAgIHk6ICgwLCBfY29yZV91dGlscy5yZWFkSW50OCkoZGF0YSwgcG9zaXRpb24gKyAxKQogICAgICAgICAgfSk7CiAgICAgICAgICBwb3NpdGlvbiArPSAyOwogICAgICAgIH0KCiAgICAgICAgZ2VuZXJpY1JlZ2lvbi5hdCA9IGF0OwogICAgICB9CgogICAgICBhcmdzID0gW2dlbmVyaWNSZWdpb24sIGRhdGEsIHBvc2l0aW9uLCBlbmRdOwogICAgICBicmVhazsKCiAgICBjYXNlIDQ4OgogICAgICBjb25zdCBwYWdlSW5mbyA9IHsKICAgICAgICB3aWR0aDogKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKSwKICAgICAgICBoZWlnaHQ6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDQpLAogICAgICAgIHJlc29sdXRpb25YOiAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyA4KSwKICAgICAgICByZXNvbHV0aW9uWTogKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMTIpCiAgICAgIH07CgogICAgICBpZiAocGFnZUluZm8uaGVpZ2h0ID09PSAweGZmZmZmZmZmKSB7CiAgICAgICAgZGVsZXRlIHBhZ2VJbmZvLmhlaWdodDsKICAgICAgfQoKICAgICAgY29uc3QgcGFnZVNlZ21lbnRGbGFncyA9IGRhdGFbcG9zaXRpb24gKyAxNl07CiAgICAgICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbiArIDE3KTsKICAgICAgcGFnZUluZm8ubG9zc2xlc3MgPSAhIShwYWdlU2VnbWVudEZsYWdzICYgMSk7CiAgICAgIHBhZ2VJbmZvLnJlZmluZW1lbnQgPSAhIShwYWdlU2VnbWVudEZsYWdzICYgMik7CiAgICAgIHBhZ2VJbmZvLmRlZmF1bHRQaXhlbFZhbHVlID0gcGFnZVNlZ21lbnRGbGFncyA+PiAyICYgMTsKICAgICAgcGFnZUluZm8uY29tYmluYXRpb25PcGVyYXRvciA9IHBhZ2VTZWdtZW50RmxhZ3MgPj4gMyAmIDM7CiAgICAgIHBhZ2VJbmZvLnJlcXVpcmVzQnVmZmVyID0gISEocGFnZVNlZ21lbnRGbGFncyAmIDMyKTsKICAgICAgcGFnZUluZm8uY29tYmluYXRpb25PcGVyYXRvck92ZXJyaWRlID0gISEocGFnZVNlZ21lbnRGbGFncyAmIDY0KTsKICAgICAgYXJncyA9IFtwYWdlSW5mb107CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgNDk6CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgNTA6CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgNTE6CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgNTM6CiAgICAgIGFyZ3MgPSBbaGVhZGVyLm51bWJlciwgZGF0YSwgcG9zaXRpb24sIGVuZF07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgNjI6CiAgICAgIGJyZWFrOwoKICAgIGRlZmF1bHQ6CiAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKGBzZWdtZW50IHR5cGUgJHtoZWFkZXIudHlwZU5hbWV9KCR7aGVhZGVyLnR5cGV9KSBpcyBub3QgaW1wbGVtZW50ZWRgKTsKICB9CgogIGNvbnN0IGNhbGxiYWNrTmFtZSA9ICJvbiIgKyBoZWFkZXIudHlwZU5hbWU7CgogIGlmIChjYWxsYmFja05hbWUgaW4gdmlzaXRvcikgewogICAgdmlzaXRvcltjYWxsYmFja05hbWVdLmFwcGx5KHZpc2l0b3IsIGFyZ3MpOwogIH0KfQoKZnVuY3Rpb24gcHJvY2Vzc1NlZ21lbnRzKHNlZ21lbnRzLCB2aXNpdG9yKSB7CiAgZm9yIChsZXQgaSA9IDAsIGlpID0gc2VnbWVudHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgcHJvY2Vzc1NlZ21lbnQoc2VnbWVudHNbaV0sIHZpc2l0b3IpOwogIH0KfQoKZnVuY3Rpb24gcGFyc2VKYmlnMkNodW5rcyhjaHVua3MpIHsKICBjb25zdCB2aXNpdG9yID0gbmV3IFNpbXBsZVNlZ21lbnRWaXNpdG9yKCk7CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IGNodW5rcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjaHVuayA9IGNodW5rc1tpXTsKICAgIGNvbnN0IHNlZ21lbnRzID0gcmVhZFNlZ21lbnRzKHt9LCBjaHVuay5kYXRhLCBjaHVuay5zdGFydCwgY2h1bmsuZW5kKTsKICAgIHByb2Nlc3NTZWdtZW50cyhzZWdtZW50cywgdmlzaXRvcik7CiAgfQoKICByZXR1cm4gdmlzaXRvci5idWZmZXI7Cn0KCmZ1bmN0aW9uIHBhcnNlSmJpZzIoZGF0YSkgewogIHRocm93IG5ldyBFcnJvcigiTm90IGltcGxlbWVudGVkOiBwYXJzZUpiaWcyIik7Cn0KCmNsYXNzIFNpbXBsZVNlZ21lbnRWaXNpdG9yIHsKICBvblBhZ2VJbmZvcm1hdGlvbihpbmZvKSB7CiAgICB0aGlzLmN1cnJlbnRQYWdlSW5mbyA9IGluZm87CiAgICBjb25zdCByb3dTaXplID0gaW5mby53aWR0aCArIDcgPj4gMzsKICAgIGNvbnN0IGJ1ZmZlciA9IG5ldyBVaW50OENsYW1wZWRBcnJheShyb3dTaXplICogaW5mby5oZWlnaHQpOwoKICAgIGlmIChpbmZvLmRlZmF1bHRQaXhlbFZhbHVlKSB7CiAgICAgIGJ1ZmZlci5maWxsKDB4ZmYpOwogICAgfQoKICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyOwogIH0KCiAgZHJhd0JpdG1hcChyZWdpb25JbmZvLCBiaXRtYXApIHsKICAgIGNvbnN0IHBhZ2VJbmZvID0gdGhpcy5jdXJyZW50UGFnZUluZm87CiAgICBjb25zdCB3aWR0aCA9IHJlZ2lvbkluZm8ud2lkdGgsCiAgICAgICAgICBoZWlnaHQgPSByZWdpb25JbmZvLmhlaWdodDsKICAgIGNvbnN0IHJvd1NpemUgPSBwYWdlSW5mby53aWR0aCArIDcgPj4gMzsKICAgIGNvbnN0IGNvbWJpbmF0aW9uT3BlcmF0b3IgPSBwYWdlSW5mby5jb21iaW5hdGlvbk9wZXJhdG9yT3ZlcnJpZGUgPyByZWdpb25JbmZvLmNvbWJpbmF0aW9uT3BlcmF0b3IgOiBwYWdlSW5mby5jb21iaW5hdGlvbk9wZXJhdG9yOwogICAgY29uc3QgYnVmZmVyID0gdGhpcy5idWZmZXI7CiAgICBjb25zdCBtYXNrMCA9IDEyOCA+PiAocmVnaW9uSW5mby54ICYgNyk7CiAgICBsZXQgb2Zmc2V0MCA9IHJlZ2lvbkluZm8ueSAqIHJvd1NpemUgKyAocmVnaW9uSW5mby54ID4+IDMpOwogICAgbGV0IGksIGosIG1hc2ssIG9mZnNldDsKCiAgICBzd2l0Y2ggKGNvbWJpbmF0aW9uT3BlcmF0b3IpIHsKICAgICAgY2FzZSAwOgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewogICAgICAgICAgbWFzayA9IG1hc2swOwogICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0MDsKCiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgICAgICBpZiAoYml0bWFwW2ldW2pdKSB7CiAgICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gfD0gbWFzazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbWFzayA+Pj0gMTsKCiAgICAgICAgICAgIGlmICghbWFzaykgewogICAgICAgICAgICAgIG1hc2sgPSAxMjg7CiAgICAgICAgICAgICAgb2Zmc2V0Kys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBvZmZzZXQwICs9IHJvd1NpemU7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaGVpZ2h0OyBpKyspIHsKICAgICAgICAgIG1hc2sgPSBtYXNrMDsKICAgICAgICAgIG9mZnNldCA9IG9mZnNldDA7CgogICAgICAgICAgZm9yIChqID0gMDsgaiA8IHdpZHRoOyBqKyspIHsKICAgICAgICAgICAgaWYgKGJpdG1hcFtpXVtqXSkgewogICAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXRdIF49IG1hc2s7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1hc2sgPj49IDE7CgogICAgICAgICAgICBpZiAoIW1hc2spIHsKICAgICAgICAgICAgICBtYXNrID0gMTI4OwogICAgICAgICAgICAgIG9mZnNldCsrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgb2Zmc2V0MCArPSByb3dTaXplOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKGBvcGVyYXRvciAke2NvbWJpbmF0aW9uT3BlcmF0b3J9IGlzIG5vdCBzdXBwb3J0ZWRgKTsKICAgIH0KICB9CgogIG9uSW1tZWRpYXRlR2VuZXJpY1JlZ2lvbihyZWdpb24sIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIGNvbnN0IHJlZ2lvbkluZm8gPSByZWdpb24uaW5mbzsKICAgIGNvbnN0IGRlY29kaW5nQ29udGV4dCA9IG5ldyBEZWNvZGluZ0NvbnRleHQoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICBjb25zdCBiaXRtYXAgPSBkZWNvZGVCaXRtYXAocmVnaW9uLm1tciwgcmVnaW9uSW5mby53aWR0aCwgcmVnaW9uSW5mby5oZWlnaHQsIHJlZ2lvbi50ZW1wbGF0ZSwgcmVnaW9uLnByZWRpY3Rpb24sIG51bGwsIHJlZ2lvbi5hdCwgZGVjb2RpbmdDb250ZXh0KTsKICAgIHRoaXMuZHJhd0JpdG1hcChyZWdpb25JbmZvLCBiaXRtYXApOwogIH0KCiAgb25JbW1lZGlhdGVMb3NzbGVzc0dlbmVyaWNSZWdpb24oKSB7CiAgICB0aGlzLm9uSW1tZWRpYXRlR2VuZXJpY1JlZ2lvbiguLi5hcmd1bWVudHMpOwogIH0KCiAgb25TeW1ib2xEaWN0aW9uYXJ5KGRpY3Rpb25hcnksIGN1cnJlbnRTZWdtZW50LCByZWZlcnJlZFNlZ21lbnRzLCBkYXRhLCBzdGFydCwgZW5kKSB7CiAgICBsZXQgaHVmZm1hblRhYmxlcywgaHVmZm1hbklucHV0OwoKICAgIGlmIChkaWN0aW9uYXJ5Lmh1ZmZtYW4pIHsKICAgICAgaHVmZm1hblRhYmxlcyA9IGdldFN5bWJvbERpY3Rpb25hcnlIdWZmbWFuVGFibGVzKGRpY3Rpb25hcnksIHJlZmVycmVkU2VnbWVudHMsIHRoaXMuY3VzdG9tVGFibGVzKTsKICAgICAgaHVmZm1hbklucHV0ID0gbmV3IFJlYWRlcihkYXRhLCBzdGFydCwgZW5kKTsKICAgIH0KCiAgICBsZXQgc3ltYm9scyA9IHRoaXMuc3ltYm9sczsKCiAgICBpZiAoIXN5bWJvbHMpIHsKICAgICAgdGhpcy5zeW1ib2xzID0gc3ltYm9scyA9IHt9OwogICAgfQoKICAgIGNvbnN0IGlucHV0U3ltYm9scyA9IFtdOwoKICAgIGZvciAoY29uc3QgcmVmZXJyZWRTZWdtZW50IG9mIHJlZmVycmVkU2VnbWVudHMpIHsKICAgICAgY29uc3QgcmVmZXJyZWRTeW1ib2xzID0gc3ltYm9sc1tyZWZlcnJlZFNlZ21lbnRdOwoKICAgICAgaWYgKHJlZmVycmVkU3ltYm9scykgewogICAgICAgIGlucHV0U3ltYm9scy5wdXNoKC4uLnJlZmVycmVkU3ltYm9scyk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBkZWNvZGluZ0NvbnRleHQgPSBuZXcgRGVjb2RpbmdDb250ZXh0KGRhdGEsIHN0YXJ0LCBlbmQpOwogICAgc3ltYm9sc1tjdXJyZW50U2VnbWVudF0gPSBkZWNvZGVTeW1ib2xEaWN0aW9uYXJ5KGRpY3Rpb25hcnkuaHVmZm1hbiwgZGljdGlvbmFyeS5yZWZpbmVtZW50LCBpbnB1dFN5bWJvbHMsIGRpY3Rpb25hcnkubnVtYmVyT2ZOZXdTeW1ib2xzLCBkaWN0aW9uYXJ5Lm51bWJlck9mRXhwb3J0ZWRTeW1ib2xzLCBodWZmbWFuVGFibGVzLCBkaWN0aW9uYXJ5LnRlbXBsYXRlLCBkaWN0aW9uYXJ5LmF0LCBkaWN0aW9uYXJ5LnJlZmluZW1lbnRUZW1wbGF0ZSwgZGljdGlvbmFyeS5yZWZpbmVtZW50QXQsIGRlY29kaW5nQ29udGV4dCwgaHVmZm1hbklucHV0KTsKICB9CgogIG9uSW1tZWRpYXRlVGV4dFJlZ2lvbihyZWdpb24sIHJlZmVycmVkU2VnbWVudHMsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIGNvbnN0IHJlZ2lvbkluZm8gPSByZWdpb24uaW5mbzsKICAgIGxldCBodWZmbWFuVGFibGVzLCBodWZmbWFuSW5wdXQ7CiAgICBjb25zdCBzeW1ib2xzID0gdGhpcy5zeW1ib2xzOwogICAgY29uc3QgaW5wdXRTeW1ib2xzID0gW107CgogICAgZm9yIChjb25zdCByZWZlcnJlZFNlZ21lbnQgb2YgcmVmZXJyZWRTZWdtZW50cykgewogICAgICBjb25zdCByZWZlcnJlZFN5bWJvbHMgPSBzeW1ib2xzW3JlZmVycmVkU2VnbWVudF07CgogICAgICBpZiAocmVmZXJyZWRTeW1ib2xzKSB7CiAgICAgICAgaW5wdXRTeW1ib2xzLnB1c2goLi4ucmVmZXJyZWRTeW1ib2xzKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IHN5bWJvbENvZGVMZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMubG9nMikoaW5wdXRTeW1ib2xzLmxlbmd0aCk7CgogICAgaWYgKHJlZ2lvbi5odWZmbWFuKSB7CiAgICAgIGh1ZmZtYW5JbnB1dCA9IG5ldyBSZWFkZXIoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICAgIGh1ZmZtYW5UYWJsZXMgPSBnZXRUZXh0UmVnaW9uSHVmZm1hblRhYmxlcyhyZWdpb24sIHJlZmVycmVkU2VnbWVudHMsIHRoaXMuY3VzdG9tVGFibGVzLCBpbnB1dFN5bWJvbHMubGVuZ3RoLCBodWZmbWFuSW5wdXQpOwogICAgfQoKICAgIGNvbnN0IGRlY29kaW5nQ29udGV4dCA9IG5ldyBEZWNvZGluZ0NvbnRleHQoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICBjb25zdCBiaXRtYXAgPSBkZWNvZGVUZXh0UmVnaW9uKHJlZ2lvbi5odWZmbWFuLCByZWdpb24ucmVmaW5lbWVudCwgcmVnaW9uSW5mby53aWR0aCwgcmVnaW9uSW5mby5oZWlnaHQsIHJlZ2lvbi5kZWZhdWx0UGl4ZWxWYWx1ZSwgcmVnaW9uLm51bWJlck9mU3ltYm9sSW5zdGFuY2VzLCByZWdpb24uc3RyaXBTaXplLCBpbnB1dFN5bWJvbHMsIHN5bWJvbENvZGVMZW5ndGgsIHJlZ2lvbi50cmFuc3Bvc2VkLCByZWdpb24uZHNPZmZzZXQsIHJlZ2lvbi5yZWZlcmVuY2VDb3JuZXIsIHJlZ2lvbi5jb21iaW5hdGlvbk9wZXJhdG9yLCBodWZmbWFuVGFibGVzLCByZWdpb24ucmVmaW5lbWVudFRlbXBsYXRlLCByZWdpb24ucmVmaW5lbWVudEF0LCBkZWNvZGluZ0NvbnRleHQsIHJlZ2lvbi5sb2dTdHJpcFNpemUsIGh1ZmZtYW5JbnB1dCk7CiAgICB0aGlzLmRyYXdCaXRtYXAocmVnaW9uSW5mbywgYml0bWFwKTsKICB9CgogIG9uSW1tZWRpYXRlTG9zc2xlc3NUZXh0UmVnaW9uKCkgewogICAgdGhpcy5vbkltbWVkaWF0ZVRleHRSZWdpb24oLi4uYXJndW1lbnRzKTsKICB9CgogIG9uUGF0dGVybkRpY3Rpb25hcnkoZGljdGlvbmFyeSwgY3VycmVudFNlZ21lbnQsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIGxldCBwYXR0ZXJucyA9IHRoaXMucGF0dGVybnM7CgogICAgaWYgKCFwYXR0ZXJucykgewogICAgICB0aGlzLnBhdHRlcm5zID0gcGF0dGVybnMgPSB7fTsKICAgIH0KCiAgICBjb25zdCBkZWNvZGluZ0NvbnRleHQgPSBuZXcgRGVjb2RpbmdDb250ZXh0KGRhdGEsIHN0YXJ0LCBlbmQpOwogICAgcGF0dGVybnNbY3VycmVudFNlZ21lbnRdID0gZGVjb2RlUGF0dGVybkRpY3Rpb25hcnkoZGljdGlvbmFyeS5tbXIsIGRpY3Rpb25hcnkucGF0dGVybldpZHRoLCBkaWN0aW9uYXJ5LnBhdHRlcm5IZWlnaHQsIGRpY3Rpb25hcnkubWF4UGF0dGVybkluZGV4LCBkaWN0aW9uYXJ5LnRlbXBsYXRlLCBkZWNvZGluZ0NvbnRleHQpOwogIH0KCiAgb25JbW1lZGlhdGVIYWxmdG9uZVJlZ2lvbihyZWdpb24sIHJlZmVycmVkU2VnbWVudHMsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIGNvbnN0IHBhdHRlcm5zID0gdGhpcy5wYXR0ZXJuc1tyZWZlcnJlZFNlZ21lbnRzWzBdXTsKICAgIGNvbnN0IHJlZ2lvbkluZm8gPSByZWdpb24uaW5mbzsKICAgIGNvbnN0IGRlY29kaW5nQ29udGV4dCA9IG5ldyBEZWNvZGluZ0NvbnRleHQoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICBjb25zdCBiaXRtYXAgPSBkZWNvZGVIYWxmdG9uZVJlZ2lvbihyZWdpb24ubW1yLCBwYXR0ZXJucywgcmVnaW9uLnRlbXBsYXRlLCByZWdpb25JbmZvLndpZHRoLCByZWdpb25JbmZvLmhlaWdodCwgcmVnaW9uLmRlZmF1bHRQaXhlbFZhbHVlLCByZWdpb24uZW5hYmxlU2tpcCwgcmVnaW9uLmNvbWJpbmF0aW9uT3BlcmF0b3IsIHJlZ2lvbi5ncmlkV2lkdGgsIHJlZ2lvbi5ncmlkSGVpZ2h0LCByZWdpb24uZ3JpZE9mZnNldFgsIHJlZ2lvbi5ncmlkT2Zmc2V0WSwgcmVnaW9uLmdyaWRWZWN0b3JYLCByZWdpb24uZ3JpZFZlY3RvclksIGRlY29kaW5nQ29udGV4dCk7CiAgICB0aGlzLmRyYXdCaXRtYXAocmVnaW9uSW5mbywgYml0bWFwKTsKICB9CgogIG9uSW1tZWRpYXRlTG9zc2xlc3NIYWxmdG9uZVJlZ2lvbigpIHsKICAgIHRoaXMub25JbW1lZGlhdGVIYWxmdG9uZVJlZ2lvbiguLi5hcmd1bWVudHMpOwogIH0KCiAgb25UYWJsZXMoY3VycmVudFNlZ21lbnQsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIGxldCBjdXN0b21UYWJsZXMgPSB0aGlzLmN1c3RvbVRhYmxlczsKCiAgICBpZiAoIWN1c3RvbVRhYmxlcykgewogICAgICB0aGlzLmN1c3RvbVRhYmxlcyA9IGN1c3RvbVRhYmxlcyA9IHt9OwogICAgfQoKICAgIGN1c3RvbVRhYmxlc1tjdXJyZW50U2VnbWVudF0gPSBkZWNvZGVUYWJsZXNTZWdtZW50KGRhdGEsIHN0YXJ0LCBlbmQpOwogIH0KCn0KCmNsYXNzIEh1ZmZtYW5MaW5lIHsKICBjb25zdHJ1Y3RvcihsaW5lRGF0YSkgewogICAgaWYgKGxpbmVEYXRhLmxlbmd0aCA9PT0gMikgewogICAgICB0aGlzLmlzT09CID0gdHJ1ZTsKICAgICAgdGhpcy5yYW5nZUxvdyA9IDA7CiAgICAgIHRoaXMucHJlZml4TGVuZ3RoID0gbGluZURhdGFbMF07CiAgICAgIHRoaXMucmFuZ2VMZW5ndGggPSAwOwogICAgICB0aGlzLnByZWZpeENvZGUgPSBsaW5lRGF0YVsxXTsKICAgICAgdGhpcy5pc0xvd2VyUmFuZ2UgPSBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaXNPT0IgPSBmYWxzZTsKICAgICAgdGhpcy5yYW5nZUxvdyA9IGxpbmVEYXRhWzBdOwogICAgICB0aGlzLnByZWZpeExlbmd0aCA9IGxpbmVEYXRhWzFdOwogICAgICB0aGlzLnJhbmdlTGVuZ3RoID0gbGluZURhdGFbMl07CiAgICAgIHRoaXMucHJlZml4Q29kZSA9IGxpbmVEYXRhWzNdOwogICAgICB0aGlzLmlzTG93ZXJSYW5nZSA9IGxpbmVEYXRhWzRdID09PSAibG93ZXIiOwogICAgfQogIH0KCn0KCmNsYXNzIEh1ZmZtYW5UcmVlTm9kZSB7CiAgY29uc3RydWN0b3IobGluZSkgewogICAgdGhpcy5jaGlsZHJlbiA9IFtdOwoKICAgIGlmIChsaW5lKSB7CiAgICAgIHRoaXMuaXNMZWFmID0gdHJ1ZTsKICAgICAgdGhpcy5yYW5nZUxlbmd0aCA9IGxpbmUucmFuZ2VMZW5ndGg7CiAgICAgIHRoaXMucmFuZ2VMb3cgPSBsaW5lLnJhbmdlTG93OwogICAgICB0aGlzLmlzTG93ZXJSYW5nZSA9IGxpbmUuaXNMb3dlclJhbmdlOwogICAgICB0aGlzLmlzT09CID0gbGluZS5pc09PQjsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaXNMZWFmID0gZmFsc2U7CiAgICB9CiAgfQoKICBidWlsZFRyZWUobGluZSwgc2hpZnQpIHsKICAgIGNvbnN0IGJpdCA9IGxpbmUucHJlZml4Q29kZSA+PiBzaGlmdCAmIDE7CgogICAgaWYgKHNoaWZ0IDw9IDApIHsKICAgICAgdGhpcy5jaGlsZHJlbltiaXRdID0gbmV3IEh1ZmZtYW5UcmVlTm9kZShsaW5lKTsKICAgIH0gZWxzZSB7CiAgICAgIGxldCBub2RlID0gdGhpcy5jaGlsZHJlbltiaXRdOwoKICAgICAgaWYgKCFub2RlKSB7CiAgICAgICAgdGhpcy5jaGlsZHJlbltiaXRdID0gbm9kZSA9IG5ldyBIdWZmbWFuVHJlZU5vZGUobnVsbCk7CiAgICAgIH0KCiAgICAgIG5vZGUuYnVpbGRUcmVlKGxpbmUsIHNoaWZ0IC0gMSk7CiAgICB9CiAgfQoKICBkZWNvZGVOb2RlKHJlYWRlcikgewogICAgaWYgKHRoaXMuaXNMZWFmKSB7CiAgICAgIGlmICh0aGlzLmlzT09CKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IGh0T2Zmc2V0ID0gcmVhZGVyLnJlYWRCaXRzKHRoaXMucmFuZ2VMZW5ndGgpOwogICAgICByZXR1cm4gdGhpcy5yYW5nZUxvdyArICh0aGlzLmlzTG93ZXJSYW5nZSA/IC1odE9mZnNldCA6IGh0T2Zmc2V0KTsKICAgIH0KCiAgICBjb25zdCBub2RlID0gdGhpcy5jaGlsZHJlbltyZWFkZXIucmVhZEJpdCgpXTsKCiAgICBpZiAoIW5vZGUpIHsKICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoImludmFsaWQgSHVmZm1hbiBkYXRhIik7CiAgICB9CgogICAgcmV0dXJuIG5vZGUuZGVjb2RlTm9kZShyZWFkZXIpOwogIH0KCn0KCmNsYXNzIEh1ZmZtYW5UYWJsZSB7CiAgY29uc3RydWN0b3IobGluZXMsIHByZWZpeENvZGVzRG9uZSkgewogICAgaWYgKCFwcmVmaXhDb2Rlc0RvbmUpIHsKICAgICAgdGhpcy5hc3NpZ25QcmVmaXhDb2RlcyhsaW5lcyk7CiAgICB9CgogICAgdGhpcy5yb290Tm9kZSA9IG5ldyBIdWZmbWFuVHJlZU5vZGUobnVsbCk7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gbGluZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07CgogICAgICBpZiAobGluZS5wcmVmaXhMZW5ndGggPiAwKSB7CiAgICAgICAgdGhpcy5yb290Tm9kZS5idWlsZFRyZWUobGluZSwgbGluZS5wcmVmaXhMZW5ndGggLSAxKTsKICAgICAgfQogICAgfQogIH0KCiAgZGVjb2RlKHJlYWRlcikgewogICAgcmV0dXJuIHRoaXMucm9vdE5vZGUuZGVjb2RlTm9kZShyZWFkZXIpOwogIH0KCiAgYXNzaWduUHJlZml4Q29kZXMobGluZXMpIHsKICAgIGNvbnN0IGxpbmVzTGVuZ3RoID0gbGluZXMubGVuZ3RoOwogICAgbGV0IHByZWZpeExlbmd0aE1heCA9IDA7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lc0xlbmd0aDsgaSsrKSB7CiAgICAgIHByZWZpeExlbmd0aE1heCA9IE1hdGgubWF4KHByZWZpeExlbmd0aE1heCwgbGluZXNbaV0ucHJlZml4TGVuZ3RoKTsKICAgIH0KCiAgICBjb25zdCBoaXN0b2dyYW0gPSBuZXcgVWludDMyQXJyYXkocHJlZml4TGVuZ3RoTWF4ICsgMSk7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lc0xlbmd0aDsgaSsrKSB7CiAgICAgIGhpc3RvZ3JhbVtsaW5lc1tpXS5wcmVmaXhMZW5ndGhdKys7CiAgICB9CgogICAgbGV0IGN1cnJlbnRMZW5ndGggPSAxLAogICAgICAgIGZpcnN0Q29kZSA9IDAsCiAgICAgICAgY3VycmVudENvZGUsCiAgICAgICAgY3VycmVudFRlbXAsCiAgICAgICAgbGluZTsKICAgIGhpc3RvZ3JhbVswXSA9IDA7CgogICAgd2hpbGUgKGN1cnJlbnRMZW5ndGggPD0gcHJlZml4TGVuZ3RoTWF4KSB7CiAgICAgIGZpcnN0Q29kZSA9IGZpcnN0Q29kZSArIGhpc3RvZ3JhbVtjdXJyZW50TGVuZ3RoIC0gMV0gPDwgMTsKICAgICAgY3VycmVudENvZGUgPSBmaXJzdENvZGU7CiAgICAgIGN1cnJlbnRUZW1wID0gMDsKCiAgICAgIHdoaWxlIChjdXJyZW50VGVtcCA8IGxpbmVzTGVuZ3RoKSB7CiAgICAgICAgbGluZSA9IGxpbmVzW2N1cnJlbnRUZW1wXTsKCiAgICAgICAgaWYgKGxpbmUucHJlZml4TGVuZ3RoID09PSBjdXJyZW50TGVuZ3RoKSB7CiAgICAgICAgICBsaW5lLnByZWZpeENvZGUgPSBjdXJyZW50Q29kZTsKICAgICAgICAgIGN1cnJlbnRDb2RlKys7CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50VGVtcCsrOwogICAgICB9CgogICAgICBjdXJyZW50TGVuZ3RoKys7CiAgICB9CiAgfQoKfQoKZnVuY3Rpb24gZGVjb2RlVGFibGVzU2VnbWVudChkYXRhLCBzdGFydCwgZW5kKSB7CiAgY29uc3QgZmxhZ3MgPSBkYXRhW3N0YXJ0XTsKICBjb25zdCBsb3dlc3RWYWx1ZSA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBzdGFydCArIDEpICYgMHhmZmZmZmZmZjsKICBjb25zdCBoaWdoZXN0VmFsdWUgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgc3RhcnQgKyA1KSAmIDB4ZmZmZmZmZmY7CiAgY29uc3QgcmVhZGVyID0gbmV3IFJlYWRlcihkYXRhLCBzdGFydCArIDksIGVuZCk7CiAgY29uc3QgcHJlZml4U2l6ZUJpdHMgPSAoZmxhZ3MgPj4gMSAmIDcpICsgMTsKICBjb25zdCByYW5nZVNpemVCaXRzID0gKGZsYWdzID4+IDQgJiA3KSArIDE7CiAgY29uc3QgbGluZXMgPSBbXTsKICBsZXQgcHJlZml4TGVuZ3RoLAogICAgICByYW5nZUxlbmd0aCwKICAgICAgY3VycmVudFJhbmdlTG93ID0gbG93ZXN0VmFsdWU7CgogIGRvIHsKICAgIHByZWZpeExlbmd0aCA9IHJlYWRlci5yZWFkQml0cyhwcmVmaXhTaXplQml0cyk7CiAgICByYW5nZUxlbmd0aCA9IHJlYWRlci5yZWFkQml0cyhyYW5nZVNpemVCaXRzKTsKICAgIGxpbmVzLnB1c2gobmV3IEh1ZmZtYW5MaW5lKFtjdXJyZW50UmFuZ2VMb3csIHByZWZpeExlbmd0aCwgcmFuZ2VMZW5ndGgsIDBdKSk7CiAgICBjdXJyZW50UmFuZ2VMb3cgKz0gMSA8PCByYW5nZUxlbmd0aDsKICB9IHdoaWxlIChjdXJyZW50UmFuZ2VMb3cgPCBoaWdoZXN0VmFsdWUpOwoKICBwcmVmaXhMZW5ndGggPSByZWFkZXIucmVhZEJpdHMocHJlZml4U2l6ZUJpdHMpOwogIGxpbmVzLnB1c2gobmV3IEh1ZmZtYW5MaW5lKFtsb3dlc3RWYWx1ZSAtIDEsIHByZWZpeExlbmd0aCwgMzIsIDAsICJsb3dlciJdKSk7CiAgcHJlZml4TGVuZ3RoID0gcmVhZGVyLnJlYWRCaXRzKHByZWZpeFNpemVCaXRzKTsKICBsaW5lcy5wdXNoKG5ldyBIdWZmbWFuTGluZShbaGlnaGVzdFZhbHVlLCBwcmVmaXhMZW5ndGgsIDMyLCAwXSkpOwoKICBpZiAoZmxhZ3MgJiAxKSB7CiAgICBwcmVmaXhMZW5ndGggPSByZWFkZXIucmVhZEJpdHMocHJlZml4U2l6ZUJpdHMpOwogICAgbGluZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW3ByZWZpeExlbmd0aCwgMF0pKTsKICB9CgogIHJldHVybiBuZXcgSHVmZm1hblRhYmxlKGxpbmVzLCBmYWxzZSk7Cn0KCmNvbnN0IHN0YW5kYXJkVGFibGVzQ2FjaGUgPSB7fTsKCmZ1bmN0aW9uIGdldFN0YW5kYXJkVGFibGUobnVtYmVyKSB7CiAgbGV0IHRhYmxlID0gc3RhbmRhcmRUYWJsZXNDYWNoZVtudW1iZXJdOwoKICBpZiAodGFibGUpIHsKICAgIHJldHVybiB0YWJsZTsKICB9CgogIGxldCBsaW5lczsKCiAgc3dpdGNoIChudW1iZXIpIHsKICAgIGNhc2UgMToKICAgICAgbGluZXMgPSBbWzAsIDEsIDQsIDB4MF0sIFsxNiwgMiwgOCwgMHgyXSwgWzI3MiwgMywgMTYsIDB4Nl0sIFs2NTgwOCwgMywgMzIsIDB4N11dOwogICAgICBicmVhazsKCiAgICBjYXNlIDI6CiAgICAgIGxpbmVzID0gW1swLCAxLCAwLCAweDBdLCBbMSwgMiwgMCwgMHgyXSwgWzIsIDMsIDAsIDB4Nl0sIFszLCA0LCAzLCAweGVdLCBbMTEsIDUsIDYsIDB4MWVdLCBbNzUsIDYsIDMyLCAweDNlXSwgWzYsIDB4M2ZdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAzOgogICAgICBsaW5lcyA9IFtbLTI1NiwgOCwgOCwgMHhmZV0sIFswLCAxLCAwLCAweDBdLCBbMSwgMiwgMCwgMHgyXSwgWzIsIDMsIDAsIDB4Nl0sIFszLCA0LCAzLCAweGVdLCBbMTEsIDUsIDYsIDB4MWVdLCBbLTI1NywgOCwgMzIsIDB4ZmYsICJsb3dlciJdLCBbNzUsIDcsIDMyLCAweDdlXSwgWzYsIDB4M2VdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA0OgogICAgICBsaW5lcyA9IFtbMSwgMSwgMCwgMHgwXSwgWzIsIDIsIDAsIDB4Ml0sIFszLCAzLCAwLCAweDZdLCBbNCwgNCwgMywgMHhlXSwgWzEyLCA1LCA2LCAweDFlXSwgWzc2LCA1LCAzMiwgMHgxZl1dOwogICAgICBicmVhazsKCiAgICBjYXNlIDU6CiAgICAgIGxpbmVzID0gW1stMjU1LCA3LCA4LCAweDdlXSwgWzEsIDEsIDAsIDB4MF0sIFsyLCAyLCAwLCAweDJdLCBbMywgMywgMCwgMHg2XSwgWzQsIDQsIDMsIDB4ZV0sIFsxMiwgNSwgNiwgMHgxZV0sIFstMjU2LCA3LCAzMiwgMHg3ZiwgImxvd2VyIl0sIFs3NiwgNiwgMzIsIDB4M2VdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA2OgogICAgICBsaW5lcyA9IFtbLTIwNDgsIDUsIDEwLCAweDFjXSwgWy0xMDI0LCA0LCA5LCAweDhdLCBbLTUxMiwgNCwgOCwgMHg5XSwgWy0yNTYsIDQsIDcsIDB4YV0sIFstMTI4LCA1LCA2LCAweDFkXSwgWy02NCwgNSwgNSwgMHgxZV0sIFstMzIsIDQsIDUsIDB4Yl0sIFswLCAyLCA3LCAweDBdLCBbMTI4LCAzLCA3LCAweDJdLCBbMjU2LCAzLCA4LCAweDNdLCBbNTEyLCA0LCA5LCAweGNdLCBbMTAyNCwgNCwgMTAsIDB4ZF0sIFstMjA0OSwgNiwgMzIsIDB4M2UsICJsb3dlciJdLCBbMjA0OCwgNiwgMzIsIDB4M2ZdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA3OgogICAgICBsaW5lcyA9IFtbLTEwMjQsIDQsIDksIDB4OF0sIFstNTEyLCAzLCA4LCAweDBdLCBbLTI1NiwgNCwgNywgMHg5XSwgWy0xMjgsIDUsIDYsIDB4MWFdLCBbLTY0LCA1LCA1LCAweDFiXSwgWy0zMiwgNCwgNSwgMHhhXSwgWzAsIDQsIDUsIDB4Yl0sIFszMiwgNSwgNSwgMHgxY10sIFs2NCwgNSwgNiwgMHgxZF0sIFsxMjgsIDQsIDcsIDB4Y10sIFsyNTYsIDMsIDgsIDB4MV0sIFs1MTIsIDMsIDksIDB4Ml0sIFsxMDI0LCAzLCAxMCwgMHgzXSwgWy0xMDI1LCA1LCAzMiwgMHgxZSwgImxvd2VyIl0sIFsyMDQ4LCA1LCAzMiwgMHgxZl1dOwogICAgICBicmVhazsKCiAgICBjYXNlIDg6CiAgICAgIGxpbmVzID0gW1stMTUsIDgsIDMsIDB4ZmNdLCBbLTcsIDksIDEsIDB4MWZjXSwgWy01LCA4LCAxLCAweGZkXSwgWy0zLCA5LCAwLCAweDFmZF0sIFstMiwgNywgMCwgMHg3Y10sIFstMSwgNCwgMCwgMHhhXSwgWzAsIDIsIDEsIDB4MF0sIFsyLCA1LCAwLCAweDFhXSwgWzMsIDYsIDAsIDB4M2FdLCBbNCwgMywgNCwgMHg0XSwgWzIwLCA2LCAxLCAweDNiXSwgWzIyLCA0LCA0LCAweGJdLCBbMzgsIDQsIDUsIDB4Y10sIFs3MCwgNSwgNiwgMHgxYl0sIFsxMzQsIDUsIDcsIDB4MWNdLCBbMjYyLCA2LCA3LCAweDNjXSwgWzM5MCwgNywgOCwgMHg3ZF0sIFs2NDYsIDYsIDEwLCAweDNkXSwgWy0xNiwgOSwgMzIsIDB4MWZlLCAibG93ZXIiXSwgWzE2NzAsIDksIDMyLCAweDFmZl0sIFsyLCAweDFdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA5OgogICAgICBsaW5lcyA9IFtbLTMxLCA4LCA0LCAweGZjXSwgWy0xNSwgOSwgMiwgMHgxZmNdLCBbLTExLCA4LCAyLCAweGZkXSwgWy03LCA5LCAxLCAweDFmZF0sIFstNSwgNywgMSwgMHg3Y10sIFstMywgNCwgMSwgMHhhXSwgWy0xLCAzLCAxLCAweDJdLCBbMSwgMywgMSwgMHgzXSwgWzMsIDUsIDEsIDB4MWFdLCBbNSwgNiwgMSwgMHgzYV0sIFs3LCAzLCA1LCAweDRdLCBbMzksIDYsIDIsIDB4M2JdLCBbNDMsIDQsIDUsIDB4Yl0sIFs3NSwgNCwgNiwgMHhjXSwgWzEzOSwgNSwgNywgMHgxYl0sIFsyNjcsIDUsIDgsIDB4MWNdLCBbNTIzLCA2LCA4LCAweDNjXSwgWzc3OSwgNywgOSwgMHg3ZF0sIFsxMjkxLCA2LCAxMSwgMHgzZF0sIFstMzIsIDksIDMyLCAweDFmZSwgImxvd2VyIl0sIFszMzM5LCA5LCAzMiwgMHgxZmZdLCBbMiwgMHgwXV07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMTA6CiAgICAgIGxpbmVzID0gW1stMjEsIDcsIDQsIDB4N2FdLCBbLTUsIDgsIDAsIDB4ZmNdLCBbLTQsIDcsIDAsIDB4N2JdLCBbLTMsIDUsIDAsIDB4MThdLCBbLTIsIDIsIDIsIDB4MF0sIFsyLCA1LCAwLCAweDE5XSwgWzMsIDYsIDAsIDB4MzZdLCBbNCwgNywgMCwgMHg3Y10sIFs1LCA4LCAwLCAweGZkXSwgWzYsIDIsIDYsIDB4MV0sIFs3MCwgNSwgNSwgMHgxYV0sIFsxMDIsIDYsIDUsIDB4MzddLCBbMTM0LCA2LCA2LCAweDM4XSwgWzE5OCwgNiwgNywgMHgzOV0sIFszMjYsIDYsIDgsIDB4M2FdLCBbNTgyLCA2LCA5LCAweDNiXSwgWzEwOTQsIDYsIDEwLCAweDNjXSwgWzIxMTgsIDcsIDExLCAweDdkXSwgWy0yMiwgOCwgMzIsIDB4ZmUsICJsb3dlciJdLCBbNDE2NiwgOCwgMzIsIDB4ZmZdLCBbMiwgMHgyXV07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMTE6CiAgICAgIGxpbmVzID0gW1sxLCAxLCAwLCAweDBdLCBbMiwgMiwgMSwgMHgyXSwgWzQsIDQsIDAsIDB4Y10sIFs1LCA0LCAxLCAweGRdLCBbNywgNSwgMSwgMHgxY10sIFs5LCA1LCAyLCAweDFkXSwgWzEzLCA2LCAyLCAweDNjXSwgWzE3LCA3LCAyLCAweDdhXSwgWzIxLCA3LCAzLCAweDdiXSwgWzI5LCA3LCA0LCAweDdjXSwgWzQ1LCA3LCA1LCAweDdkXSwgWzc3LCA3LCA2LCAweDdlXSwgWzE0MSwgNywgMzIsIDB4N2ZdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAxMjoKICAgICAgbGluZXMgPSBbWzEsIDEsIDAsIDB4MF0sIFsyLCAyLCAwLCAweDJdLCBbMywgMywgMSwgMHg2XSwgWzUsIDUsIDAsIDB4MWNdLCBbNiwgNSwgMSwgMHgxZF0sIFs4LCA2LCAxLCAweDNjXSwgWzEwLCA3LCAwLCAweDdhXSwgWzExLCA3LCAxLCAweDdiXSwgWzEzLCA3LCAyLCAweDdjXSwgWzE3LCA3LCAzLCAweDdkXSwgWzI1LCA3LCA0LCAweDdlXSwgWzQxLCA4LCA1LCAweGZlXSwgWzczLCA4LCAzMiwgMHhmZl1dOwogICAgICBicmVhazsKCiAgICBjYXNlIDEzOgogICAgICBsaW5lcyA9IFtbMSwgMSwgMCwgMHgwXSwgWzIsIDMsIDAsIDB4NF0sIFszLCA0LCAwLCAweGNdLCBbNCwgNSwgMCwgMHgxY10sIFs1LCA0LCAxLCAweGRdLCBbNywgMywgMywgMHg1XSwgWzE1LCA2LCAxLCAweDNhXSwgWzE3LCA2LCAyLCAweDNiXSwgWzIxLCA2LCAzLCAweDNjXSwgWzI5LCA2LCA0LCAweDNkXSwgWzQ1LCA2LCA1LCAweDNlXSwgWzc3LCA3LCA2LCAweDdlXSwgWzE0MSwgNywgMzIsIDB4N2ZdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAxNDoKICAgICAgbGluZXMgPSBbWy0yLCAzLCAwLCAweDRdLCBbLTEsIDMsIDAsIDB4NV0sIFswLCAxLCAwLCAweDBdLCBbMSwgMywgMCwgMHg2XSwgWzIsIDMsIDAsIDB4N11dOwogICAgICBicmVhazsKCiAgICBjYXNlIDE1OgogICAgICBsaW5lcyA9IFtbLTI0LCA3LCA0LCAweDdjXSwgWy04LCA2LCAyLCAweDNjXSwgWy00LCA1LCAxLCAweDFjXSwgWy0yLCA0LCAwLCAweGNdLCBbLTEsIDMsIDAsIDB4NF0sIFswLCAxLCAwLCAweDBdLCBbMSwgMywgMCwgMHg1XSwgWzIsIDQsIDAsIDB4ZF0sIFszLCA1LCAxLCAweDFkXSwgWzUsIDYsIDIsIDB4M2RdLCBbOSwgNywgNCwgMHg3ZF0sIFstMjUsIDcsIDMyLCAweDdlLCAibG93ZXIiXSwgWzI1LCA3LCAzMiwgMHg3Zl1dOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcihgc3RhbmRhcmQgdGFibGUgQi4ke251bWJlcn0gZG9lcyBub3QgZXhpc3RgKTsKICB9CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IGxpbmVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgIGxpbmVzW2ldID0gbmV3IEh1ZmZtYW5MaW5lKGxpbmVzW2ldKTsKICB9CgogIHRhYmxlID0gbmV3IEh1ZmZtYW5UYWJsZShsaW5lcywgdHJ1ZSk7CiAgc3RhbmRhcmRUYWJsZXNDYWNoZVtudW1iZXJdID0gdGFibGU7CiAgcmV0dXJuIHRhYmxlOwp9CgpjbGFzcyBSZWFkZXIgewogIGNvbnN0cnVjdG9yKGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7CiAgICB0aGlzLmVuZCA9IGVuZDsKICAgIHRoaXMucG9zaXRpb24gPSBzdGFydDsKICAgIHRoaXMuc2hpZnQgPSAtMTsKICAgIHRoaXMuY3VycmVudEJ5dGUgPSAwOwogIH0KCiAgcmVhZEJpdCgpIHsKICAgIGlmICh0aGlzLnNoaWZ0IDwgMCkgewogICAgICBpZiAodGhpcy5wb3NpdGlvbiA+PSB0aGlzLmVuZCkgewogICAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJlbmQgb2YgZGF0YSB3aGlsZSByZWFkaW5nIGJpdCIpOwogICAgICB9CgogICAgICB0aGlzLmN1cnJlbnRCeXRlID0gdGhpcy5kYXRhW3RoaXMucG9zaXRpb24rK107CiAgICAgIHRoaXMuc2hpZnQgPSA3OwogICAgfQoKICAgIGNvbnN0IGJpdCA9IHRoaXMuY3VycmVudEJ5dGUgPj4gdGhpcy5zaGlmdCAmIDE7CiAgICB0aGlzLnNoaWZ0LS07CiAgICByZXR1cm4gYml0OwogIH0KCiAgcmVhZEJpdHMobnVtQml0cykgewogICAgbGV0IHJlc3VsdCA9IDAsCiAgICAgICAgaTsKCiAgICBmb3IgKGkgPSBudW1CaXRzIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgcmVzdWx0IHw9IHRoaXMucmVhZEJpdCgpIDw8IGk7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIGJ5dGVBbGlnbigpIHsKICAgIHRoaXMuc2hpZnQgPSAtMTsKICB9CgogIG5leHQoKSB7CiAgICBpZiAodGhpcy5wb3NpdGlvbiA+PSB0aGlzLmVuZCkgewogICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuZGF0YVt0aGlzLnBvc2l0aW9uKytdOwogIH0KCn0KCmZ1bmN0aW9uIGdldEN1c3RvbUh1ZmZtYW5UYWJsZShpbmRleCwgcmVmZXJyZWRUbywgY3VzdG9tVGFibGVzKSB7CiAgbGV0IGN1cnJlbnRJbmRleCA9IDA7CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IHJlZmVycmVkVG8ubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgY29uc3QgdGFibGUgPSBjdXN0b21UYWJsZXNbcmVmZXJyZWRUb1tpXV07CgogICAgaWYgKHRhYmxlKSB7CiAgICAgIGlmIChpbmRleCA9PT0gY3VycmVudEluZGV4KSB7CiAgICAgICAgcmV0dXJuIHRhYmxlOwogICAgICB9CgogICAgICBjdXJyZW50SW5kZXgrKzsKICAgIH0KICB9CgogIHRocm93IG5ldyBKYmlnMkVycm9yKCJjYW4ndCBmaW5kIGN1c3RvbSBIdWZmbWFuIHRhYmxlIik7Cn0KCmZ1bmN0aW9uIGdldFRleHRSZWdpb25IdWZmbWFuVGFibGVzKHRleHRSZWdpb24sIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcywgbnVtYmVyT2ZTeW1ib2xzLCByZWFkZXIpIHsKICBjb25zdCBjb2RlcyA9IFtdOwoKICBmb3IgKGxldCBpID0gMDsgaSA8PSAzNDsgaSsrKSB7CiAgICBjb25zdCBjb2RlTGVuZ3RoID0gcmVhZGVyLnJlYWRCaXRzKDQpOwogICAgY29kZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW2ksIGNvZGVMZW5ndGgsIDAsIDBdKSk7CiAgfQoKICBjb25zdCBydW5Db2Rlc1RhYmxlID0gbmV3IEh1ZmZtYW5UYWJsZShjb2RlcywgZmFsc2UpOwogIGNvZGVzLmxlbmd0aCA9IDA7CgogIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtYmVyT2ZTeW1ib2xzOykgewogICAgY29uc3QgY29kZUxlbmd0aCA9IHJ1bkNvZGVzVGFibGUuZGVjb2RlKHJlYWRlcik7CgogICAgaWYgKGNvZGVMZW5ndGggPj0gMzIpIHsKICAgICAgbGV0IHJlcGVhdGVkTGVuZ3RoLCBudW1iZXJPZlJlcGVhdHMsIGo7CgogICAgICBzd2l0Y2ggKGNvZGVMZW5ndGgpIHsKICAgICAgICBjYXNlIDMyOgogICAgICAgICAgaWYgKGkgPT09IDApIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoIm5vIHByZXZpb3VzIHZhbHVlIGluIHN5bWJvbCBJRCB0YWJsZSIpOwogICAgICAgICAgfQoKICAgICAgICAgIG51bWJlck9mUmVwZWF0cyA9IHJlYWRlci5yZWFkQml0cygyKSArIDM7CiAgICAgICAgICByZXBlYXRlZExlbmd0aCA9IGNvZGVzW2kgLSAxXS5wcmVmaXhMZW5ndGg7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzMzoKICAgICAgICAgIG51bWJlck9mUmVwZWF0cyA9IHJlYWRlci5yZWFkQml0cygzKSArIDM7CiAgICAgICAgICByZXBlYXRlZExlbmd0aCA9IDA7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzNDoKICAgICAgICAgIG51bWJlck9mUmVwZWF0cyA9IHJlYWRlci5yZWFkQml0cyg3KSArIDExOwogICAgICAgICAgcmVwZWF0ZWRMZW5ndGggPSAwOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCBjb2RlIGxlbmd0aCBpbiBzeW1ib2wgSUQgdGFibGUiKTsKICAgICAgfQoKICAgICAgZm9yIChqID0gMDsgaiA8IG51bWJlck9mUmVwZWF0czsgaisrKSB7CiAgICAgICAgY29kZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW2ksIHJlcGVhdGVkTGVuZ3RoLCAwLCAwXSkpOwogICAgICAgIGkrKzsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgY29kZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW2ksIGNvZGVMZW5ndGgsIDAsIDBdKSk7CiAgICAgIGkrKzsKICAgIH0KICB9CgogIHJlYWRlci5ieXRlQWxpZ24oKTsKICBjb25zdCBzeW1ib2xJRFRhYmxlID0gbmV3IEh1ZmZtYW5UYWJsZShjb2RlcywgZmFsc2UpOwogIGxldCBjdXN0b21JbmRleCA9IDAsCiAgICAgIHRhYmxlRmlyc3RTLAogICAgICB0YWJsZURlbHRhUywKICAgICAgdGFibGVEZWx0YVQ7CgogIHN3aXRjaCAodGV4dFJlZ2lvbi5odWZmbWFuRlMpIHsKICAgIGNhc2UgMDoKICAgIGNhc2UgMToKICAgICAgdGFibGVGaXJzdFMgPSBnZXRTdGFuZGFyZFRhYmxlKHRleHRSZWdpb24uaHVmZm1hbkZTICsgNik7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzoKICAgICAgdGFibGVGaXJzdFMgPSBnZXRDdXN0b21IdWZmbWFuVGFibGUoY3VzdG9tSW5kZXgsIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcyk7CiAgICAgIGN1c3RvbUluZGV4Kys7CiAgICAgIGJyZWFrOwoKICAgIGRlZmF1bHQ6CiAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJpbnZhbGlkIEh1ZmZtYW4gRlMgc2VsZWN0b3IiKTsKICB9CgogIHN3aXRjaCAodGV4dFJlZ2lvbi5odWZmbWFuRFMpIHsKICAgIGNhc2UgMDoKICAgIGNhc2UgMToKICAgIGNhc2UgMjoKICAgICAgdGFibGVEZWx0YVMgPSBnZXRTdGFuZGFyZFRhYmxlKHRleHRSZWdpb24uaHVmZm1hbkRTICsgOCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzoKICAgICAgdGFibGVEZWx0YVMgPSBnZXRDdXN0b21IdWZmbWFuVGFibGUoY3VzdG9tSW5kZXgsIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcyk7CiAgICAgIGN1c3RvbUluZGV4Kys7CiAgICAgIGJyZWFrOwoKICAgIGRlZmF1bHQ6CiAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJpbnZhbGlkIEh1ZmZtYW4gRFMgc2VsZWN0b3IiKTsKICB9CgogIHN3aXRjaCAodGV4dFJlZ2lvbi5odWZmbWFuRFQpIHsKICAgIGNhc2UgMDoKICAgIGNhc2UgMToKICAgIGNhc2UgMjoKICAgICAgdGFibGVEZWx0YVQgPSBnZXRTdGFuZGFyZFRhYmxlKHRleHRSZWdpb24uaHVmZm1hbkRUICsgMTEpOwogICAgICBicmVhazsKCiAgICBjYXNlIDM6CiAgICAgIHRhYmxlRGVsdGFUID0gZ2V0Q3VzdG9tSHVmZm1hblRhYmxlKGN1c3RvbUluZGV4LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpOwogICAgICBjdXN0b21JbmRleCsrOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCBIdWZmbWFuIERUIHNlbGVjdG9yIik7CiAgfQoKICBpZiAodGV4dFJlZ2lvbi5yZWZpbmVtZW50KSB7CiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigicmVmaW5lbWVudCB3aXRoIEh1ZmZtYW4gaXMgbm90IHN1cHBvcnRlZCIpOwogIH0KCiAgcmV0dXJuIHsKICAgIHN5bWJvbElEVGFibGUsCiAgICB0YWJsZUZpcnN0UywKICAgIHRhYmxlRGVsdGFTLAogICAgdGFibGVEZWx0YVQKICB9Owp9CgpmdW5jdGlvbiBnZXRTeW1ib2xEaWN0aW9uYXJ5SHVmZm1hblRhYmxlcyhkaWN0aW9uYXJ5LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpIHsKICBsZXQgY3VzdG9tSW5kZXggPSAwLAogICAgICB0YWJsZURlbHRhSGVpZ2h0LAogICAgICB0YWJsZURlbHRhV2lkdGg7CgogIHN3aXRjaCAoZGljdGlvbmFyeS5odWZmbWFuREhTZWxlY3RvcikgewogICAgY2FzZSAwOgogICAgY2FzZSAxOgogICAgICB0YWJsZURlbHRhSGVpZ2h0ID0gZ2V0U3RhbmRhcmRUYWJsZShkaWN0aW9uYXJ5Lmh1ZmZtYW5ESFNlbGVjdG9yICsgNCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzoKICAgICAgdGFibGVEZWx0YUhlaWdodCA9IGdldEN1c3RvbUh1ZmZtYW5UYWJsZShjdXN0b21JbmRleCwgcmVmZXJyZWRUbywgY3VzdG9tVGFibGVzKTsKICAgICAgY3VzdG9tSW5kZXgrKzsKICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoImludmFsaWQgSHVmZm1hbiBESCBzZWxlY3RvciIpOwogIH0KCiAgc3dpdGNoIChkaWN0aW9uYXJ5Lmh1ZmZtYW5EV1NlbGVjdG9yKSB7CiAgICBjYXNlIDA6CiAgICBjYXNlIDE6CiAgICAgIHRhYmxlRGVsdGFXaWR0aCA9IGdldFN0YW5kYXJkVGFibGUoZGljdGlvbmFyeS5odWZmbWFuRFdTZWxlY3RvciArIDIpOwogICAgICBicmVhazsKCiAgICBjYXNlIDM6CiAgICAgIHRhYmxlRGVsdGFXaWR0aCA9IGdldEN1c3RvbUh1ZmZtYW5UYWJsZShjdXN0b21JbmRleCwgcmVmZXJyZWRUbywgY3VzdG9tVGFibGVzKTsKICAgICAgY3VzdG9tSW5kZXgrKzsKICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoImludmFsaWQgSHVmZm1hbiBEVyBzZWxlY3RvciIpOwogIH0KCiAgbGV0IHRhYmxlQml0bWFwU2l6ZSwgdGFibGVBZ2dyZWdhdGVJbnN0YW5jZXM7CgogIGlmIChkaWN0aW9uYXJ5LmJpdG1hcFNpemVTZWxlY3RvcikgewogICAgdGFibGVCaXRtYXBTaXplID0gZ2V0Q3VzdG9tSHVmZm1hblRhYmxlKGN1c3RvbUluZGV4LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpOwogICAgY3VzdG9tSW5kZXgrKzsKICB9IGVsc2UgewogICAgdGFibGVCaXRtYXBTaXplID0gZ2V0U3RhbmRhcmRUYWJsZSgxKTsKICB9CgogIGlmIChkaWN0aW9uYXJ5LmFnZ3JlZ2F0aW9uSW5zdGFuY2VzU2VsZWN0b3IpIHsKICAgIHRhYmxlQWdncmVnYXRlSW5zdGFuY2VzID0gZ2V0Q3VzdG9tSHVmZm1hblRhYmxlKGN1c3RvbUluZGV4LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpOwogIH0gZWxzZSB7CiAgICB0YWJsZUFnZ3JlZ2F0ZUluc3RhbmNlcyA9IGdldFN0YW5kYXJkVGFibGUoMSk7CiAgfQoKICByZXR1cm4gewogICAgdGFibGVEZWx0YUhlaWdodCwKICAgIHRhYmxlRGVsdGFXaWR0aCwKICAgIHRhYmxlQml0bWFwU2l6ZSwKICAgIHRhYmxlQWdncmVnYXRlSW5zdGFuY2VzCiAgfTsKfQoKZnVuY3Rpb24gcmVhZFVuY29tcHJlc3NlZEJpdG1hcChyZWFkZXIsIHdpZHRoLCBoZWlnaHQpIHsKICBjb25zdCBiaXRtYXAgPSBbXTsKCiAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykgewogICAgY29uc3Qgcm93ID0gbmV3IFVpbnQ4QXJyYXkod2lkdGgpOwogICAgYml0bWFwLnB1c2gocm93KTsKCiAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgcm93W3hdID0gcmVhZGVyLnJlYWRCaXQoKTsKICAgIH0KCiAgICByZWFkZXIuYnl0ZUFsaWduKCk7CiAgfQoKICByZXR1cm4gYml0bWFwOwp9CgpmdW5jdGlvbiBkZWNvZGVNTVJCaXRtYXAoaW5wdXQsIHdpZHRoLCBoZWlnaHQsIGVuZE9mQmxvY2spIHsKICBjb25zdCBwYXJhbXMgPSB7CiAgICBLOiAtMSwKICAgIENvbHVtbnM6IHdpZHRoLAogICAgUm93czogaGVpZ2h0LAogICAgQmxhY2tJczE6IHRydWUsCiAgICBFbmRPZkJsb2NrOiBlbmRPZkJsb2NrCiAgfTsKICBjb25zdCBkZWNvZGVyID0gbmV3IF9jY2l0dC5DQ0lUVEZheERlY29kZXIoaW5wdXQsIHBhcmFtcyk7CiAgY29uc3QgYml0bWFwID0gW107CiAgbGV0IGN1cnJlbnRCeXRlLAogICAgICBlb2YgPSBmYWxzZTsKCiAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykgewogICAgY29uc3Qgcm93ID0gbmV3IFVpbnQ4QXJyYXkod2lkdGgpOwogICAgYml0bWFwLnB1c2gocm93KTsKICAgIGxldCBzaGlmdCA9IC0xOwoKICAgIGZvciAobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICBpZiAoc2hpZnQgPCAwKSB7CiAgICAgICAgY3VycmVudEJ5dGUgPSBkZWNvZGVyLnJlYWROZXh0Q2hhcigpOwoKICAgICAgICBpZiAoY3VycmVudEJ5dGUgPT09IC0xKSB7CiAgICAgICAgICBjdXJyZW50Qnl0ZSA9IDA7CiAgICAgICAgICBlb2YgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgc2hpZnQgPSA3OwogICAgICB9CgogICAgICByb3dbeF0gPSBjdXJyZW50Qnl0ZSA+PiBzaGlmdCAmIDE7CiAgICAgIHNoaWZ0LS07CiAgICB9CiAgfQoKICBpZiAoZW5kT2ZCbG9jayAmJiAhZW9mKSB7CiAgICBjb25zdCBsb29rRm9yRU9GTGltaXQgPSA1OwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9va0ZvckVPRkxpbWl0OyBpKyspIHsKICAgICAgaWYgKGRlY29kZXIucmVhZE5leHRDaGFyKCkgPT09IC0xKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiBiaXRtYXA7Cn0KCmNsYXNzIEpiaWcySW1hZ2UgewogIHBhcnNlQ2h1bmtzKGNodW5rcykgewogICAgcmV0dXJuIHBhcnNlSmJpZzJDaHVua3MoY2h1bmtzKTsKICB9CgogIHBhcnNlKGRhdGEpIHsKICAgIHRocm93IG5ldyBFcnJvcigiTm90IGltcGxlbWVudGVkOiBKYmlnMkltYWdlLnBhcnNlIik7CiAgfQoKfQoKZXhwb3J0cy5KYmlnMkltYWdlID0gSmJpZzJJbWFnZTsKCi8qKiovIH0pLAovKiAxNTEgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkFyaXRobWV0aWNEZWNvZGVyID0gdm9pZCAwOwpjb25zdCBRZVRhYmxlID0gW3sKICBxZTogMHg1NjAxLAogIG5tcHM6IDEsCiAgbmxwczogMSwKICBzd2l0Y2hGbGFnOiAxCn0sIHsKICBxZTogMHgzNDAxLAogIG5tcHM6IDIsCiAgbmxwczogNiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxODAxLAogIG5tcHM6IDMsCiAgbmxwczogOSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwYWMxLAogIG5tcHM6IDQsCiAgbmxwczogMTIsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDUyMSwKICBubXBzOiA1LAogIG5scHM6IDI5LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAyMjEsCiAgbm1wczogMzgsCiAgbmxwczogMzMsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4NTYwMSwKICBubXBzOiA3LAogIG5scHM6IDYsCiAgc3dpdGNoRmxhZzogMQp9LCB7CiAgcWU6IDB4NTQwMSwKICBubXBzOiA4LAogIG5scHM6IDE0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDQ4MDEsCiAgbm1wczogOSwKICBubHBzOiAxNCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgzODAxLAogIG5tcHM6IDEwLAogIG5scHM6IDE0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDMwMDEsCiAgbm1wczogMTEsCiAgbmxwczogMTcsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MjQwMSwKICBubXBzOiAxMiwKICBubHBzOiAxOCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxYzAxLAogIG5tcHM6IDEzLAogIG5scHM6IDIwLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDE2MDEsCiAgbm1wczogMjksCiAgbmxwczogMjEsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4NTYwMSwKICBubXBzOiAxNSwKICBubHBzOiAxNCwKICBzd2l0Y2hGbGFnOiAxCn0sIHsKICBxZTogMHg1NDAxLAogIG5tcHM6IDE2LAogIG5scHM6IDE0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDUxMDEsCiAgbm1wczogMTcsCiAgbmxwczogMTUsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4NDgwMSwKICBubXBzOiAxOCwKICBubHBzOiAxNiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgzODAxLAogIG5tcHM6IDE5LAogIG5scHM6IDE3LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDM0MDEsCiAgbm1wczogMjAsCiAgbmxwczogMTgsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MzAwMSwKICBubXBzOiAyMSwKICBubHBzOiAxOSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgyODAxLAogIG5tcHM6IDIyLAogIG5scHM6IDE5LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDI0MDEsCiAgbm1wczogMjMsCiAgbmxwczogMjAsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MjIwMSwKICBubXBzOiAyNCwKICBubHBzOiAyMSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxYzAxLAogIG5tcHM6IDI1LAogIG5scHM6IDIyLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDE4MDEsCiAgbm1wczogMjYsCiAgbmxwczogMjMsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MTYwMSwKICBubXBzOiAyNywKICBubHBzOiAyNCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxNDAxLAogIG5tcHM6IDI4LAogIG5scHM6IDI1LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDEyMDEsCiAgbm1wczogMjksCiAgbmxwczogMjYsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MTEwMSwKICBubXBzOiAzMCwKICBubHBzOiAyNywKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwYWMxLAogIG5tcHM6IDMxLAogIG5scHM6IDI4LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDA5YzEsCiAgbm1wczogMzIsCiAgbmxwczogMjksCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDhhMSwKICBubXBzOiAzMywKICBubHBzOiAzMCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwNTIxLAogIG5tcHM6IDM0LAogIG5scHM6IDMxLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDA0NDEsCiAgbm1wczogMzUsCiAgbmxwczogMzIsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDJhMSwKICBubXBzOiAzNiwKICBubHBzOiAzMywKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMjIxLAogIG5tcHM6IDM3LAogIG5scHM6IDM0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAxNDEsCiAgbm1wczogMzgsCiAgbmxwczogMzUsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDExMSwKICBubXBzOiAzOSwKICBubHBzOiAzNiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMDg1LAogIG5tcHM6IDQwLAogIG5scHM6IDM3LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAwNDksCiAgbm1wczogNDEsCiAgbmxwczogMzgsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDAyNSwKICBubXBzOiA0MiwKICBubHBzOiAzOSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMDE1LAogIG5tcHM6IDQzLAogIG5scHM6IDQwLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAwMDksCiAgbm1wczogNDQsCiAgbmxwczogNDEsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDAwNSwKICBubXBzOiA0NSwKICBubHBzOiA0MiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMDAxLAogIG5tcHM6IDQ1LAogIG5scHM6IDQzLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDU2MDEsCiAgbm1wczogNDYsCiAgbmxwczogNDYsCiAgc3dpdGNoRmxhZzogMAp9XTsKCmNsYXNzIEFyaXRobWV0aWNEZWNvZGVyIHsKICBjb25zdHJ1Y3RvcihkYXRhLCBzdGFydCwgZW5kKSB7CiAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgdGhpcy5icCA9IHN0YXJ0OwogICAgdGhpcy5kYXRhRW5kID0gZW5kOwogICAgdGhpcy5jaGlnaCA9IGRhdGFbc3RhcnRdOwogICAgdGhpcy5jbG93ID0gMDsKICAgIHRoaXMuYnl0ZUluKCk7CiAgICB0aGlzLmNoaWdoID0gdGhpcy5jaGlnaCA8PCA3ICYgMHhmZmZmIHwgdGhpcy5jbG93ID4+IDkgJiAweDdmOwogICAgdGhpcy5jbG93ID0gdGhpcy5jbG93IDw8IDcgJiAweGZmZmY7CiAgICB0aGlzLmN0IC09IDc7CiAgICB0aGlzLmEgPSAweDgwMDA7CiAgfQoKICBieXRlSW4oKSB7CiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgbGV0IGJwID0gdGhpcy5icDsKCiAgICBpZiAoZGF0YVticF0gPT09IDB4ZmYpIHsKICAgICAgaWYgKGRhdGFbYnAgKyAxXSA+IDB4OGYpIHsKICAgICAgICB0aGlzLmNsb3cgKz0gMHhmZjAwOwogICAgICAgIHRoaXMuY3QgPSA4OwogICAgICB9IGVsc2UgewogICAgICAgIGJwKys7CiAgICAgICAgdGhpcy5jbG93ICs9IGRhdGFbYnBdIDw8IDk7CiAgICAgICAgdGhpcy5jdCA9IDc7CiAgICAgICAgdGhpcy5icCA9IGJwOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBicCsrOwogICAgICB0aGlzLmNsb3cgKz0gYnAgPCB0aGlzLmRhdGFFbmQgPyBkYXRhW2JwXSA8PCA4IDogMHhmZjAwOwogICAgICB0aGlzLmN0ID0gODsKICAgICAgdGhpcy5icCA9IGJwOwogICAgfQoKICAgIGlmICh0aGlzLmNsb3cgPiAweGZmZmYpIHsKICAgICAgdGhpcy5jaGlnaCArPSB0aGlzLmNsb3cgPj4gMTY7CiAgICAgIHRoaXMuY2xvdyAmPSAweGZmZmY7CiAgICB9CiAgfQoKICByZWFkQml0KGNvbnRleHRzLCBwb3MpIHsKICAgIGxldCBjeF9pbmRleCA9IGNvbnRleHRzW3Bvc10gPj4gMSwKICAgICAgICBjeF9tcHMgPSBjb250ZXh0c1twb3NdICYgMTsKICAgIGNvbnN0IHFlVGFibGVJY3ggPSBRZVRhYmxlW2N4X2luZGV4XTsKICAgIGNvbnN0IHFlSWN4ID0gcWVUYWJsZUljeC5xZTsKICAgIGxldCBkOwogICAgbGV0IGEgPSB0aGlzLmEgLSBxZUljeDsKCiAgICBpZiAodGhpcy5jaGlnaCA8IHFlSWN4KSB7CiAgICAgIGlmIChhIDwgcWVJY3gpIHsKICAgICAgICBhID0gcWVJY3g7CiAgICAgICAgZCA9IGN4X21wczsKICAgICAgICBjeF9pbmRleCA9IHFlVGFibGVJY3gubm1wczsKICAgICAgfSBlbHNlIHsKICAgICAgICBhID0gcWVJY3g7CiAgICAgICAgZCA9IDEgXiBjeF9tcHM7CgogICAgICAgIGlmIChxZVRhYmxlSWN4LnN3aXRjaEZsYWcgPT09IDEpIHsKICAgICAgICAgIGN4X21wcyA9IGQ7CiAgICAgICAgfQoKICAgICAgICBjeF9pbmRleCA9IHFlVGFibGVJY3gubmxwczsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jaGlnaCAtPSBxZUljeDsKCiAgICAgIGlmICgoYSAmIDB4ODAwMCkgIT09IDApIHsKICAgICAgICB0aGlzLmEgPSBhOwogICAgICAgIHJldHVybiBjeF9tcHM7CiAgICAgIH0KCiAgICAgIGlmIChhIDwgcWVJY3gpIHsKICAgICAgICBkID0gMSBeIGN4X21wczsKCiAgICAgICAgaWYgKHFlVGFibGVJY3guc3dpdGNoRmxhZyA9PT0gMSkgewogICAgICAgICAgY3hfbXBzID0gZDsKICAgICAgICB9CgogICAgICAgIGN4X2luZGV4ID0gcWVUYWJsZUljeC5ubHBzOwogICAgICB9IGVsc2UgewogICAgICAgIGQgPSBjeF9tcHM7CiAgICAgICAgY3hfaW5kZXggPSBxZVRhYmxlSWN4Lm5tcHM7CiAgICAgIH0KICAgIH0KCiAgICBkbyB7CiAgICAgIGlmICh0aGlzLmN0ID09PSAwKSB7CiAgICAgICAgdGhpcy5ieXRlSW4oKTsKICAgICAgfQoKICAgICAgYSA8PD0gMTsKICAgICAgdGhpcy5jaGlnaCA9IHRoaXMuY2hpZ2ggPDwgMSAmIDB4ZmZmZiB8IHRoaXMuY2xvdyA+PiAxNSAmIDE7CiAgICAgIHRoaXMuY2xvdyA9IHRoaXMuY2xvdyA8PCAxICYgMHhmZmZmOwogICAgICB0aGlzLmN0LS07CiAgICB9IHdoaWxlICgoYSAmIDB4ODAwMCkgPT09IDApOwoKICAgIHRoaXMuYSA9IGE7CiAgICBjb250ZXh0c1twb3NdID0gY3hfaW5kZXggPDwgMSB8IGN4X21wczsKICAgIHJldHVybiBkOwogIH0KCn0KCmV4cG9ydHMuQXJpdGhtZXRpY0RlY29kZXIgPSBBcml0aG1ldGljRGVjb2RlcjsKCi8qKiovIH0pLAovKiAxNTIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkpwZWdTdHJlYW0gPSB2b2lkIDA7Cgp2YXIgX2RlY29kZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0NCk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMCk7Cgp2YXIgX2pwZyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTUzKTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpjbGFzcyBKcGVnU3RyZWFtIGV4dGVuZHMgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHJlYW0sIG1heWJlTGVuZ3RoLCBwYXJhbXMpIHsKICAgIGxldCBjaDsKCiAgICB3aGlsZSAoKGNoID0gc3RyZWFtLmdldEJ5dGUoKSkgIT09IC0xKSB7CiAgICAgIGlmIChjaCA9PT0gMHhmZikgewogICAgICAgIHN0cmVhbS5za2lwKC0xKTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHN1cGVyKG1heWJlTGVuZ3RoKTsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5kaWN0ID0gc3RyZWFtLmRpY3Q7CiAgICB0aGlzLm1heWJlTGVuZ3RoID0gbWF5YmVMZW5ndGg7CiAgICB0aGlzLnBhcmFtcyA9IHBhcmFtczsKICB9CgogIGdldCBieXRlcygpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYnl0ZXMiLCB0aGlzLnN0cmVhbS5nZXRCeXRlcyh0aGlzLm1heWJlTGVuZ3RoKSk7CiAgfQoKICBlbnN1cmVCdWZmZXIocmVxdWVzdGVkKSB7fQoKICByZWFkQmxvY2soKSB7CiAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGpwZWdPcHRpb25zID0gewogICAgICBkZWNvZGVUcmFuc2Zvcm06IHVuZGVmaW5lZCwKICAgICAgY29sb3JUcmFuc2Zvcm06IHVuZGVmaW5lZAogICAgfTsKICAgIGNvbnN0IGRlY29kZUFyciA9IHRoaXMuZGljdC5nZXRBcnJheSgiRCIsICJEZWNvZGUiKTsKCiAgICBpZiAodGhpcy5mb3JjZVJHQiAmJiBBcnJheS5pc0FycmF5KGRlY29kZUFycikpIHsKICAgICAgY29uc3QgYml0c1BlckNvbXBvbmVudCA9IHRoaXMuZGljdC5nZXQoIkJQQyIsICJCaXRzUGVyQ29tcG9uZW50IikgfHwgODsKICAgICAgY29uc3QgZGVjb2RlQXJyTGVuZ3RoID0gZGVjb2RlQXJyLmxlbmd0aDsKICAgICAgY29uc3QgdHJhbnNmb3JtID0gbmV3IEludDMyQXJyYXkoZGVjb2RlQXJyTGVuZ3RoKTsKICAgICAgbGV0IHRyYW5zZm9ybU5lZWRlZCA9IGZhbHNlOwogICAgICBjb25zdCBtYXhWYWx1ZSA9ICgxIDw8IGJpdHNQZXJDb21wb25lbnQpIC0gMTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGVjb2RlQXJyTGVuZ3RoOyBpICs9IDIpIHsKICAgICAgICB0cmFuc2Zvcm1baV0gPSAoZGVjb2RlQXJyW2kgKyAxXSAtIGRlY29kZUFycltpXSkgKiAyNTYgfCAwOwogICAgICAgIHRyYW5zZm9ybVtpICsgMV0gPSBkZWNvZGVBcnJbaV0gKiBtYXhWYWx1ZSB8IDA7CgogICAgICAgIGlmICh0cmFuc2Zvcm1baV0gIT09IDI1NiB8fCB0cmFuc2Zvcm1baSArIDFdICE9PSAwKSB7CiAgICAgICAgICB0cmFuc2Zvcm1OZWVkZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRyYW5zZm9ybU5lZWRlZCkgewogICAgICAgIGpwZWdPcHRpb25zLmRlY29kZVRyYW5zZm9ybSA9IHRyYW5zZm9ybTsKICAgICAgfQogICAgfQoKICAgIGlmICh0aGlzLnBhcmFtcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgY29uc3QgY29sb3JUcmFuc2Zvcm0gPSB0aGlzLnBhcmFtcy5nZXQoIkNvbG9yVHJhbnNmb3JtIik7CgogICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihjb2xvclRyYW5zZm9ybSkpIHsKICAgICAgICBqcGVnT3B0aW9ucy5jb2xvclRyYW5zZm9ybSA9IGNvbG9yVHJhbnNmb3JtOwogICAgICB9CiAgICB9CgogICAgY29uc3QganBlZ0ltYWdlID0gbmV3IF9qcGcuSnBlZ0ltYWdlKGpwZWdPcHRpb25zKTsKICAgIGpwZWdJbWFnZS5wYXJzZSh0aGlzLmJ5dGVzKTsKICAgIGNvbnN0IGRhdGEgPSBqcGVnSW1hZ2UuZ2V0RGF0YSh7CiAgICAgIHdpZHRoOiB0aGlzLmRyYXdXaWR0aCwKICAgICAgaGVpZ2h0OiB0aGlzLmRyYXdIZWlnaHQsCiAgICAgIGZvcmNlUkdCOiB0aGlzLmZvcmNlUkdCLAogICAgICBpc1NvdXJjZVBERjogdHJ1ZQogICAgfSk7CiAgICB0aGlzLmJ1ZmZlciA9IGRhdGE7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGRhdGEubGVuZ3RoOwogICAgdGhpcy5lb2YgPSB0cnVlOwogIH0KCn0KCmV4cG9ydHMuSnBlZ1N0cmVhbSA9IEpwZWdTdHJlYW07CgovKioqLyB9KSwKLyogMTUzICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5KcGVnSW1hZ2UgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKY2xhc3MgSnBlZ0Vycm9yIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihgSlBFRyBlcnJvcjogJHttc2d9YCwgIkpwZWdFcnJvciIpOwogIH0KCn0KCmNsYXNzIEROTE1hcmtlckVycm9yIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobWVzc2FnZSwgc2NhbkxpbmVzKSB7CiAgICBzdXBlcihtZXNzYWdlLCAiRE5MTWFya2VyRXJyb3IiKTsKICAgIHRoaXMuc2NhbkxpbmVzID0gc2NhbkxpbmVzOwogIH0KCn0KCmNsYXNzIEVPSU1hcmtlckVycm9yIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihtc2csICJFT0lNYXJrZXJFcnJvciIpOwogIH0KCn0KCmNvbnN0IGRjdFppZ1phZyA9IG5ldyBVaW50OEFycmF5KFswLCAxLCA4LCAxNiwgOSwgMiwgMywgMTAsIDE3LCAyNCwgMzIsIDI1LCAxOCwgMTEsIDQsIDUsIDEyLCAxOSwgMjYsIDMzLCA0MCwgNDgsIDQxLCAzNCwgMjcsIDIwLCAxMywgNiwgNywgMTQsIDIxLCAyOCwgMzUsIDQyLCA0OSwgNTYsIDU3LCA1MCwgNDMsIDM2LCAyOSwgMjIsIDE1LCAyMywgMzAsIDM3LCA0NCwgNTEsIDU4LCA1OSwgNTIsIDQ1LCAzOCwgMzEsIDM5LCA0NiwgNTMsIDYwLCA2MSwgNTQsIDQ3LCA1NSwgNjIsIDYzXSk7CmNvbnN0IGRjdENvczEgPSA0MDE3Owpjb25zdCBkY3RTaW4xID0gNzk5Owpjb25zdCBkY3RDb3MzID0gMzQwNjsKY29uc3QgZGN0U2luMyA9IDIyNzY7CmNvbnN0IGRjdENvczYgPSAxNTY3Owpjb25zdCBkY3RTaW42ID0gMzc4NDsKY29uc3QgZGN0U3FydDIgPSA1NzkzOwpjb25zdCBkY3RTcXJ0MWQyID0gMjg5NjsKCmZ1bmN0aW9uIGJ1aWxkSHVmZm1hblRhYmxlKGNvZGVMZW5ndGhzLCB2YWx1ZXMpIHsKICBsZXQgayA9IDAsCiAgICAgIGksCiAgICAgIGosCiAgICAgIGxlbmd0aCA9IDE2OwoKICB3aGlsZSAobGVuZ3RoID4gMCAmJiAhY29kZUxlbmd0aHNbbGVuZ3RoIC0gMV0pIHsKICAgIGxlbmd0aC0tOwogIH0KCiAgY29uc3QgY29kZSA9IFt7CiAgICBjaGlsZHJlbjogW10sCiAgICBpbmRleDogMAogIH1dOwogIGxldCBwID0gY29kZVswXSwKICAgICAgcTsKCiAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICBmb3IgKGogPSAwOyBqIDwgY29kZUxlbmd0aHNbaV07IGorKykgewogICAgICBwID0gY29kZS5wb3AoKTsKICAgICAgcC5jaGlsZHJlbltwLmluZGV4XSA9IHZhbHVlc1trXTsKCiAgICAgIHdoaWxlIChwLmluZGV4ID4gMCkgewogICAgICAgIHAgPSBjb2RlLnBvcCgpOwogICAgICB9CgogICAgICBwLmluZGV4Kys7CiAgICAgIGNvZGUucHVzaChwKTsKCiAgICAgIHdoaWxlIChjb2RlLmxlbmd0aCA8PSBpKSB7CiAgICAgICAgY29kZS5wdXNoKHEgPSB7CiAgICAgICAgICBjaGlsZHJlbjogW10sCiAgICAgICAgICBpbmRleDogMAogICAgICAgIH0pOwogICAgICAgIHAuY2hpbGRyZW5bcC5pbmRleF0gPSBxLmNoaWxkcmVuOwogICAgICAgIHAgPSBxOwogICAgICB9CgogICAgICBrKys7CiAgICB9CgogICAgaWYgKGkgKyAxIDwgbGVuZ3RoKSB7CiAgICAgIGNvZGUucHVzaChxID0gewogICAgICAgIGNoaWxkcmVuOiBbXSwKICAgICAgICBpbmRleDogMAogICAgICB9KTsKICAgICAgcC5jaGlsZHJlbltwLmluZGV4XSA9IHEuY2hpbGRyZW47CiAgICAgIHAgPSBxOwogICAgfQogIH0KCiAgcmV0dXJuIGNvZGVbMF0uY2hpbGRyZW47Cn0KCmZ1bmN0aW9uIGdldEJsb2NrQnVmZmVyT2Zmc2V0KGNvbXBvbmVudCwgcm93LCBjb2wpIHsKICByZXR1cm4gNjQgKiAoKGNvbXBvbmVudC5ibG9ja3NQZXJMaW5lICsgMSkgKiByb3cgKyBjb2wpOwp9CgpmdW5jdGlvbiBkZWNvZGVTY2FuKGRhdGEsIG9mZnNldCwgZnJhbWUsIGNvbXBvbmVudHMsIHJlc2V0SW50ZXJ2YWwsIHNwZWN0cmFsU3RhcnQsIHNwZWN0cmFsRW5kLCBzdWNjZXNzaXZlUHJldiwgc3VjY2Vzc2l2ZSkgewogIGxldCBwYXJzZUROTE1hcmtlciA9IGFyZ3VtZW50cy5sZW5ndGggPiA5ICYmIGFyZ3VtZW50c1s5XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzldIDogZmFsc2U7CiAgY29uc3QgbWN1c1BlckxpbmUgPSBmcmFtZS5tY3VzUGVyTGluZTsKICBjb25zdCBwcm9ncmVzc2l2ZSA9IGZyYW1lLnByb2dyZXNzaXZlOwogIGNvbnN0IHN0YXJ0T2Zmc2V0ID0gb2Zmc2V0OwogIGxldCBiaXRzRGF0YSA9IDAsCiAgICAgIGJpdHNDb3VudCA9IDA7CgogIGZ1bmN0aW9uIHJlYWRCaXQoKSB7CiAgICBpZiAoYml0c0NvdW50ID4gMCkgewogICAgICBiaXRzQ291bnQtLTsKICAgICAgcmV0dXJuIGJpdHNEYXRhID4+IGJpdHNDb3VudCAmIDE7CiAgICB9CgogICAgYml0c0RhdGEgPSBkYXRhW29mZnNldCsrXTsKCiAgICBpZiAoYml0c0RhdGEgPT09IDB4ZmYpIHsKICAgICAgY29uc3QgbmV4dEJ5dGUgPSBkYXRhW29mZnNldCsrXTsKCiAgICAgIGlmIChuZXh0Qnl0ZSkgewogICAgICAgIGlmIChuZXh0Qnl0ZSA9PT0gMHhkYyAmJiBwYXJzZUROTE1hcmtlcikgewogICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICBjb25zdCBzY2FuTGluZXMgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgb2Zmc2V0KTsKICAgICAgICAgIG9mZnNldCArPSAyOwoKICAgICAgICAgIGlmIChzY2FuTGluZXMgPiAwICYmIHNjYW5MaW5lcyAhPT0gZnJhbWUuc2NhbkxpbmVzKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBETkxNYXJrZXJFcnJvcigiRm91bmQgRE5MIG1hcmtlciAoMHhGRkRDKSB3aGlsZSBwYXJzaW5nIHNjYW4gZGF0YSIsIHNjYW5MaW5lcyk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChuZXh0Qnl0ZSA9PT0gMHhkOSkgewogICAgICAgICAgaWYgKHBhcnNlRE5MTWFya2VyKSB7CiAgICAgICAgICAgIGNvbnN0IG1heWJlU2NhbkxpbmVzID0gYmxvY2tSb3cgKiAoZnJhbWUucHJlY2lzaW9uID09PSA4ID8gOCA6IDApOwoKICAgICAgICAgICAgaWYgKG1heWJlU2NhbkxpbmVzID4gMCAmJiBNYXRoLnJvdW5kKGZyYW1lLnNjYW5MaW5lcyAvIG1heWJlU2NhbkxpbmVzKSA+PSAxMCkgewogICAgICAgICAgICAgIHRocm93IG5ldyBETkxNYXJrZXJFcnJvcigiRm91bmQgRU9JIG1hcmtlciAoMHhGRkQ5KSB3aGlsZSBwYXJzaW5nIHNjYW4gZGF0YSwgIiArICJwb3NzaWJseSBjYXVzZWQgYnkgaW5jb3JyZWN0IGBzY2FuTGluZXNgIHBhcmFtZXRlciIsIG1heWJlU2NhbkxpbmVzKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHRocm93IG5ldyBFT0lNYXJrZXJFcnJvcigiRm91bmQgRU9JIG1hcmtlciAoMHhGRkQ5KSB3aGlsZSBwYXJzaW5nIHNjYW4gZGF0YSIpOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgbmV3IEpwZWdFcnJvcihgdW5leHBlY3RlZCBtYXJrZXIgJHsoYml0c0RhdGEgPDwgOCB8IG5leHRCeXRlKS50b1N0cmluZygxNil9YCk7CiAgICAgIH0KICAgIH0KCiAgICBiaXRzQ291bnQgPSA3OwogICAgcmV0dXJuIGJpdHNEYXRhID4+PiA3OwogIH0KCiAgZnVuY3Rpb24gZGVjb2RlSHVmZm1hbih0cmVlKSB7CiAgICBsZXQgbm9kZSA9IHRyZWU7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgbm9kZSA9IG5vZGVbcmVhZEJpdCgpXTsKCiAgICAgIHN3aXRjaCAodHlwZW9mIG5vZGUpIHsKICAgICAgICBjYXNlICJudW1iZXIiOgogICAgICAgICAgcmV0dXJuIG5vZGU7CgogICAgICAgIGNhc2UgIm9iamVjdCI6CiAgICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdGhyb3cgbmV3IEpwZWdFcnJvcigiaW52YWxpZCBodWZmbWFuIHNlcXVlbmNlIik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZWNlaXZlKGxlbmd0aCkgewogICAgbGV0IG4gPSAwOwoKICAgIHdoaWxlIChsZW5ndGggPiAwKSB7CiAgICAgIG4gPSBuIDw8IDEgfCByZWFkQml0KCk7CiAgICAgIGxlbmd0aC0tOwogICAgfQoKICAgIHJldHVybiBuOwogIH0KCiAgZnVuY3Rpb24gcmVjZWl2ZUFuZEV4dGVuZChsZW5ndGgpIHsKICAgIGlmIChsZW5ndGggPT09IDEpIHsKICAgICAgcmV0dXJuIHJlYWRCaXQoKSA9PT0gMSA/IDEgOiAtMTsKICAgIH0KCiAgICBjb25zdCBuID0gcmVjZWl2ZShsZW5ndGgpOwoKICAgIGlmIChuID49IDEgPDwgbGVuZ3RoIC0gMSkgewogICAgICByZXR1cm4gbjsKICAgIH0KCiAgICByZXR1cm4gbiArICgtMSA8PCBsZW5ndGgpICsgMTsKICB9CgogIGZ1bmN0aW9uIGRlY29kZUJhc2VsaW5lKGNvbXBvbmVudCwgYmxvY2tPZmZzZXQpIHsKICAgIGNvbnN0IHQgPSBkZWNvZGVIdWZmbWFuKGNvbXBvbmVudC5odWZmbWFuVGFibGVEQyk7CiAgICBjb25zdCBkaWZmID0gdCA9PT0gMCA/IDAgOiByZWNlaXZlQW5kRXh0ZW5kKHQpOwogICAgY29tcG9uZW50LmJsb2NrRGF0YVtibG9ja09mZnNldF0gPSBjb21wb25lbnQucHJlZCArPSBkaWZmOwogICAgbGV0IGsgPSAxOwoKICAgIHdoaWxlIChrIDwgNjQpIHsKICAgICAgY29uc3QgcnMgPSBkZWNvZGVIdWZmbWFuKGNvbXBvbmVudC5odWZmbWFuVGFibGVBQyk7CiAgICAgIGNvbnN0IHMgPSBycyAmIDE1LAogICAgICAgICAgICByID0gcnMgPj4gNDsKCiAgICAgIGlmIChzID09PSAwKSB7CiAgICAgICAgaWYgKHIgPCAxNSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBrICs9IDE2OwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBrICs9IHI7CiAgICAgIGNvbnN0IHogPSBkY3RaaWdaYWdba107CiAgICAgIGNvbXBvbmVudC5ibG9ja0RhdGFbYmxvY2tPZmZzZXQgKyB6XSA9IHJlY2VpdmVBbmRFeHRlbmQocyk7CiAgICAgIGsrKzsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGRlY29kZURDRmlyc3QoY29tcG9uZW50LCBibG9ja09mZnNldCkgewogICAgY29uc3QgdCA9IGRlY29kZUh1ZmZtYW4oY29tcG9uZW50Lmh1ZmZtYW5UYWJsZURDKTsKICAgIGNvbnN0IGRpZmYgPSB0ID09PSAwID8gMCA6IHJlY2VpdmVBbmRFeHRlbmQodCkgPDwgc3VjY2Vzc2l2ZTsKICAgIGNvbXBvbmVudC5ibG9ja0RhdGFbYmxvY2tPZmZzZXRdID0gY29tcG9uZW50LnByZWQgKz0gZGlmZjsKICB9CgogIGZ1bmN0aW9uIGRlY29kZURDU3VjY2Vzc2l2ZShjb21wb25lbnQsIGJsb2NrT2Zmc2V0KSB7CiAgICBjb21wb25lbnQuYmxvY2tEYXRhW2Jsb2NrT2Zmc2V0XSB8PSByZWFkQml0KCkgPDwgc3VjY2Vzc2l2ZTsKICB9CgogIGxldCBlb2JydW4gPSAwOwoKICBmdW5jdGlvbiBkZWNvZGVBQ0ZpcnN0KGNvbXBvbmVudCwgYmxvY2tPZmZzZXQpIHsKICAgIGlmIChlb2JydW4gPiAwKSB7CiAgICAgIGVvYnJ1bi0tOwogICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IGsgPSBzcGVjdHJhbFN0YXJ0OwogICAgY29uc3QgZSA9IHNwZWN0cmFsRW5kOwoKICAgIHdoaWxlIChrIDw9IGUpIHsKICAgICAgY29uc3QgcnMgPSBkZWNvZGVIdWZmbWFuKGNvbXBvbmVudC5odWZmbWFuVGFibGVBQyk7CiAgICAgIGNvbnN0IHMgPSBycyAmIDE1LAogICAgICAgICAgICByID0gcnMgPj4gNDsKCiAgICAgIGlmIChzID09PSAwKSB7CiAgICAgICAgaWYgKHIgPCAxNSkgewogICAgICAgICAgZW9icnVuID0gcmVjZWl2ZShyKSArICgxIDw8IHIpIC0gMTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgayArPSAxNjsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgayArPSByOwogICAgICBjb25zdCB6ID0gZGN0WmlnWmFnW2tdOwogICAgICBjb21wb25lbnQuYmxvY2tEYXRhW2Jsb2NrT2Zmc2V0ICsgel0gPSByZWNlaXZlQW5kRXh0ZW5kKHMpICogKDEgPDwgc3VjY2Vzc2l2ZSk7CiAgICAgIGsrKzsKICAgIH0KICB9CgogIGxldCBzdWNjZXNzaXZlQUNTdGF0ZSA9IDAsCiAgICAgIHN1Y2Nlc3NpdmVBQ05leHRWYWx1ZTsKCiAgZnVuY3Rpb24gZGVjb2RlQUNTdWNjZXNzaXZlKGNvbXBvbmVudCwgYmxvY2tPZmZzZXQpIHsKICAgIGxldCBrID0gc3BlY3RyYWxTdGFydDsKICAgIGNvbnN0IGUgPSBzcGVjdHJhbEVuZDsKICAgIGxldCByID0gMDsKICAgIGxldCBzOwogICAgbGV0IHJzOwoKICAgIHdoaWxlIChrIDw9IGUpIHsKICAgICAgY29uc3Qgb2Zmc2V0WiA9IGJsb2NrT2Zmc2V0ICsgZGN0WmlnWmFnW2tdOwogICAgICBjb25zdCBzaWduID0gY29tcG9uZW50LmJsb2NrRGF0YVtvZmZzZXRaXSA8IDAgPyAtMSA6IDE7CgogICAgICBzd2l0Y2ggKHN1Y2Nlc3NpdmVBQ1N0YXRlKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcnMgPSBkZWNvZGVIdWZmbWFuKGNvbXBvbmVudC5odWZmbWFuVGFibGVBQyk7CiAgICAgICAgICBzID0gcnMgJiAxNTsKICAgICAgICAgIHIgPSBycyA+PiA0OwoKICAgICAgICAgIGlmIChzID09PSAwKSB7CiAgICAgICAgICAgIGlmIChyIDwgMTUpIHsKICAgICAgICAgICAgICBlb2JydW4gPSByZWNlaXZlKHIpICsgKDEgPDwgcik7CiAgICAgICAgICAgICAgc3VjY2Vzc2l2ZUFDU3RhdGUgPSA0OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHIgPSAxNjsKICAgICAgICAgICAgICBzdWNjZXNzaXZlQUNTdGF0ZSA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChzICE9PSAxKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpwZWdFcnJvcigiaW52YWxpZCBBQ24gZW5jb2RpbmciKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3VjY2Vzc2l2ZUFDTmV4dFZhbHVlID0gcmVjZWl2ZUFuZEV4dGVuZChzKTsKICAgICAgICAgICAgc3VjY2Vzc2l2ZUFDU3RhdGUgPSByID8gMiA6IDM7CiAgICAgICAgICB9CgogICAgICAgICAgY29udGludWU7CgogICAgICAgIGNhc2UgMToKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBpZiAoY29tcG9uZW50LmJsb2NrRGF0YVtvZmZzZXRaXSkgewogICAgICAgICAgICBjb21wb25lbnQuYmxvY2tEYXRhW29mZnNldFpdICs9IHNpZ24gKiAocmVhZEJpdCgpIDw8IHN1Y2Nlc3NpdmUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgci0tOwoKICAgICAgICAgICAgaWYgKHIgPT09IDApIHsKICAgICAgICAgICAgICBzdWNjZXNzaXZlQUNTdGF0ZSA9IHN1Y2Nlc3NpdmVBQ1N0YXRlID09PSAyID8gMyA6IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzOgogICAgICAgICAgaWYgKGNvbXBvbmVudC5ibG9ja0RhdGFbb2Zmc2V0Wl0pIHsKICAgICAgICAgICAgY29tcG9uZW50LmJsb2NrRGF0YVtvZmZzZXRaXSArPSBzaWduICogKHJlYWRCaXQoKSA8PCBzdWNjZXNzaXZlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbXBvbmVudC5ibG9ja0RhdGFbb2Zmc2V0Wl0gPSBzdWNjZXNzaXZlQUNOZXh0VmFsdWUgPDwgc3VjY2Vzc2l2ZTsKICAgICAgICAgICAgc3VjY2Vzc2l2ZUFDU3RhdGUgPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBpZiAoY29tcG9uZW50LmJsb2NrRGF0YVtvZmZzZXRaXSkgewogICAgICAgICAgICBjb21wb25lbnQuYmxvY2tEYXRhW29mZnNldFpdICs9IHNpZ24gKiAocmVhZEJpdCgpIDw8IHN1Y2Nlc3NpdmUpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBrKys7CiAgICB9CgogICAgaWYgKHN1Y2Nlc3NpdmVBQ1N0YXRlID09PSA0KSB7CiAgICAgIGVvYnJ1bi0tOwoKICAgICAgaWYgKGVvYnJ1biA9PT0gMCkgewogICAgICAgIHN1Y2Nlc3NpdmVBQ1N0YXRlID0gMDsKICAgICAgfQogICAgfQogIH0KCiAgbGV0IGJsb2NrUm93ID0gMDsKCiAgZnVuY3Rpb24gZGVjb2RlTWN1KGNvbXBvbmVudCwgZGVjb2RlLCBtY3UsIHJvdywgY29sKSB7CiAgICBjb25zdCBtY3VSb3cgPSBtY3UgLyBtY3VzUGVyTGluZSB8IDA7CiAgICBjb25zdCBtY3VDb2wgPSBtY3UgJSBtY3VzUGVyTGluZTsKICAgIGJsb2NrUm93ID0gbWN1Um93ICogY29tcG9uZW50LnYgKyByb3c7CiAgICBjb25zdCBibG9ja0NvbCA9IG1jdUNvbCAqIGNvbXBvbmVudC5oICsgY29sOwogICAgY29uc3QgYmxvY2tPZmZzZXQgPSBnZXRCbG9ja0J1ZmZlck9mZnNldChjb21wb25lbnQsIGJsb2NrUm93LCBibG9ja0NvbCk7CiAgICBkZWNvZGUoY29tcG9uZW50LCBibG9ja09mZnNldCk7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVCbG9jayhjb21wb25lbnQsIGRlY29kZSwgbWN1KSB7CiAgICBibG9ja1JvdyA9IG1jdSAvIGNvbXBvbmVudC5ibG9ja3NQZXJMaW5lIHwgMDsKICAgIGNvbnN0IGJsb2NrQ29sID0gbWN1ICUgY29tcG9uZW50LmJsb2Nrc1BlckxpbmU7CiAgICBjb25zdCBibG9ja09mZnNldCA9IGdldEJsb2NrQnVmZmVyT2Zmc2V0KGNvbXBvbmVudCwgYmxvY2tSb3csIGJsb2NrQ29sKTsKICAgIGRlY29kZShjb21wb25lbnQsIGJsb2NrT2Zmc2V0KTsKICB9CgogIGNvbnN0IGNvbXBvbmVudHNMZW5ndGggPSBjb21wb25lbnRzLmxlbmd0aDsKICBsZXQgY29tcG9uZW50LCBpLCBqLCBrLCBuOwogIGxldCBkZWNvZGVGbjsKCiAgaWYgKHByb2dyZXNzaXZlKSB7CiAgICBpZiAoc3BlY3RyYWxTdGFydCA9PT0gMCkgewogICAgICBkZWNvZGVGbiA9IHN1Y2Nlc3NpdmVQcmV2ID09PSAwID8gZGVjb2RlRENGaXJzdCA6IGRlY29kZURDU3VjY2Vzc2l2ZTsKICAgIH0gZWxzZSB7CiAgICAgIGRlY29kZUZuID0gc3VjY2Vzc2l2ZVByZXYgPT09IDAgPyBkZWNvZGVBQ0ZpcnN0IDogZGVjb2RlQUNTdWNjZXNzaXZlOwogICAgfQogIH0gZWxzZSB7CiAgICBkZWNvZGVGbiA9IGRlY29kZUJhc2VsaW5lOwogIH0KCiAgbGV0IG1jdSA9IDAsCiAgICAgIGZpbGVNYXJrZXI7CiAgbGV0IG1jdUV4cGVjdGVkOwoKICBpZiAoY29tcG9uZW50c0xlbmd0aCA9PT0gMSkgewogICAgbWN1RXhwZWN0ZWQgPSBjb21wb25lbnRzWzBdLmJsb2Nrc1BlckxpbmUgKiBjb21wb25lbnRzWzBdLmJsb2Nrc1BlckNvbHVtbjsKICB9IGVsc2UgewogICAgbWN1RXhwZWN0ZWQgPSBtY3VzUGVyTGluZSAqIGZyYW1lLm1jdXNQZXJDb2x1bW47CiAgfQoKICBsZXQgaCwgdjsKCiAgd2hpbGUgKG1jdSA8PSBtY3VFeHBlY3RlZCkgewogICAgY29uc3QgbWN1VG9SZWFkID0gcmVzZXRJbnRlcnZhbCA/IE1hdGgubWluKG1jdUV4cGVjdGVkIC0gbWN1LCByZXNldEludGVydmFsKSA6IG1jdUV4cGVjdGVkOwoKICAgIGlmIChtY3VUb1JlYWQgPiAwKSB7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBjb21wb25lbnRzTGVuZ3RoOyBpKyspIHsKICAgICAgICBjb21wb25lbnRzW2ldLnByZWQgPSAwOwogICAgICB9CgogICAgICBlb2JydW4gPSAwOwoKICAgICAgaWYgKGNvbXBvbmVudHNMZW5ndGggPT09IDEpIHsKICAgICAgICBjb21wb25lbnQgPSBjb21wb25lbnRzWzBdOwoKICAgICAgICBmb3IgKG4gPSAwOyBuIDwgbWN1VG9SZWFkOyBuKyspIHsKICAgICAgICAgIGRlY29kZUJsb2NrKGNvbXBvbmVudCwgZGVjb2RlRm4sIG1jdSk7CiAgICAgICAgICBtY3UrKzsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChuID0gMDsgbiA8IG1jdVRvUmVhZDsgbisrKSB7CiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY29tcG9uZW50c0xlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbXBvbmVudCA9IGNvbXBvbmVudHNbaV07CiAgICAgICAgICAgIGggPSBjb21wb25lbnQuaDsKICAgICAgICAgICAgdiA9IGNvbXBvbmVudC52OwoKICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IHY7IGorKykgewogICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBoOyBrKyspIHsKICAgICAgICAgICAgICAgIGRlY29kZU1jdShjb21wb25lbnQsIGRlY29kZUZuLCBtY3UsIGosIGspOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIG1jdSsrOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGJpdHNDb3VudCA9IDA7CiAgICBmaWxlTWFya2VyID0gZmluZE5leHRGaWxlTWFya2VyKGRhdGEsIG9mZnNldCk7CgogICAgaWYgKCFmaWxlTWFya2VyKSB7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGlmIChmaWxlTWFya2VyLmludmFsaWQpIHsKICAgICAgY29uc3QgcGFydGlhbE1zZyA9IG1jdVRvUmVhZCA+IDAgPyAidW5leHBlY3RlZCIgOiAiZXhjZXNzaXZlIjsKICAgICAgKDAsIF91dGlsLndhcm4pKGBkZWNvZGVTY2FuIC0gJHtwYXJ0aWFsTXNnfSBNQ1UgZGF0YSwgY3VycmVudCBtYXJrZXIgaXM6ICR7ZmlsZU1hcmtlci5pbnZhbGlkfWApOwogICAgICBvZmZzZXQgPSBmaWxlTWFya2VyLm9mZnNldDsKICAgIH0KCiAgICBpZiAoZmlsZU1hcmtlci5tYXJrZXIgPj0gMHhmZmQwICYmIGZpbGVNYXJrZXIubWFya2VyIDw9IDB4ZmZkNykgewogICAgICBvZmZzZXQgKz0gMjsKICAgIH0gZWxzZSB7CiAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgcmV0dXJuIG9mZnNldCAtIHN0YXJ0T2Zmc2V0Owp9CgpmdW5jdGlvbiBxdWFudGl6ZUFuZEludmVyc2UoY29tcG9uZW50LCBibG9ja0J1ZmZlck9mZnNldCwgcCkgewogIGNvbnN0IHF0ID0gY29tcG9uZW50LnF1YW50aXphdGlvblRhYmxlLAogICAgICAgIGJsb2NrRGF0YSA9IGNvbXBvbmVudC5ibG9ja0RhdGE7CiAgbGV0IHYwLCB2MSwgdjIsIHYzLCB2NCwgdjUsIHY2LCB2NzsKICBsZXQgcDAsIHAxLCBwMiwgcDMsIHA0LCBwNSwgcDYsIHA3OwogIGxldCB0OwoKICBpZiAoIXF0KSB7CiAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJtaXNzaW5nIHJlcXVpcmVkIFF1YW50aXphdGlvbiBUYWJsZS4iKTsKICB9CgogIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IDY0OyByb3cgKz0gOCkgewogICAgcDAgPSBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyByb3ddOwogICAgcDEgPSBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyByb3cgKyAxXTsKICAgIHAyID0gYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgcm93ICsgMl07CiAgICBwMyA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDNdOwogICAgcDQgPSBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyByb3cgKyA0XTsKICAgIHA1ID0gYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgcm93ICsgNV07CiAgICBwNiA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDZdOwogICAgcDcgPSBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyByb3cgKyA3XTsKICAgIHAwICo9IHF0W3Jvd107CgogICAgaWYgKChwMSB8IHAyIHwgcDMgfCBwNCB8IHA1IHwgcDYgfCBwNykgPT09IDApIHsKICAgICAgdCA9IGRjdFNxcnQyICogcDAgKyA1MTIgPj4gMTA7CiAgICAgIHBbcm93XSA9IHQ7CiAgICAgIHBbcm93ICsgMV0gPSB0OwogICAgICBwW3JvdyArIDJdID0gdDsKICAgICAgcFtyb3cgKyAzXSA9IHQ7CiAgICAgIHBbcm93ICsgNF0gPSB0OwogICAgICBwW3JvdyArIDVdID0gdDsKICAgICAgcFtyb3cgKyA2XSA9IHQ7CiAgICAgIHBbcm93ICsgN10gPSB0OwogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBwMSAqPSBxdFtyb3cgKyAxXTsKICAgIHAyICo9IHF0W3JvdyArIDJdOwogICAgcDMgKj0gcXRbcm93ICsgM107CiAgICBwNCAqPSBxdFtyb3cgKyA0XTsKICAgIHA1ICo9IHF0W3JvdyArIDVdOwogICAgcDYgKj0gcXRbcm93ICsgNl07CiAgICBwNyAqPSBxdFtyb3cgKyA3XTsKICAgIHYwID0gZGN0U3FydDIgKiBwMCArIDEyOCA+PiA4OwogICAgdjEgPSBkY3RTcXJ0MiAqIHA0ICsgMTI4ID4+IDg7CiAgICB2MiA9IHAyOwogICAgdjMgPSBwNjsKICAgIHY0ID0gZGN0U3FydDFkMiAqIChwMSAtIHA3KSArIDEyOCA+PiA4OwogICAgdjcgPSBkY3RTcXJ0MWQyICogKHAxICsgcDcpICsgMTI4ID4+IDg7CiAgICB2NSA9IHAzIDw8IDQ7CiAgICB2NiA9IHA1IDw8IDQ7CiAgICB2MCA9IHYwICsgdjEgKyAxID4+IDE7CiAgICB2MSA9IHYwIC0gdjE7CiAgICB0ID0gdjIgKiBkY3RTaW42ICsgdjMgKiBkY3RDb3M2ICsgMTI4ID4+IDg7CiAgICB2MiA9IHYyICogZGN0Q29zNiAtIHYzICogZGN0U2luNiArIDEyOCA+PiA4OwogICAgdjMgPSB0OwogICAgdjQgPSB2NCArIHY2ICsgMSA+PiAxOwogICAgdjYgPSB2NCAtIHY2OwogICAgdjcgPSB2NyArIHY1ICsgMSA+PiAxOwogICAgdjUgPSB2NyAtIHY1OwogICAgdjAgPSB2MCArIHYzICsgMSA+PiAxOwogICAgdjMgPSB2MCAtIHYzOwogICAgdjEgPSB2MSArIHYyICsgMSA+PiAxOwogICAgdjIgPSB2MSAtIHYyOwogICAgdCA9IHY0ICogZGN0U2luMyArIHY3ICogZGN0Q29zMyArIDIwNDggPj4gMTI7CiAgICB2NCA9IHY0ICogZGN0Q29zMyAtIHY3ICogZGN0U2luMyArIDIwNDggPj4gMTI7CiAgICB2NyA9IHQ7CiAgICB0ID0gdjUgKiBkY3RTaW4xICsgdjYgKiBkY3RDb3MxICsgMjA0OCA+PiAxMjsKICAgIHY1ID0gdjUgKiBkY3RDb3MxIC0gdjYgKiBkY3RTaW4xICsgMjA0OCA+PiAxMjsKICAgIHY2ID0gdDsKICAgIHBbcm93XSA9IHYwICsgdjc7CiAgICBwW3JvdyArIDddID0gdjAgLSB2NzsKICAgIHBbcm93ICsgMV0gPSB2MSArIHY2OwogICAgcFtyb3cgKyA2XSA9IHYxIC0gdjY7CiAgICBwW3JvdyArIDJdID0gdjIgKyB2NTsKICAgIHBbcm93ICsgNV0gPSB2MiAtIHY1OwogICAgcFtyb3cgKyAzXSA9IHYzICsgdjQ7CiAgICBwW3JvdyArIDRdID0gdjMgLSB2NDsKICB9CgogIGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IDg7ICsrY29sKSB7CiAgICBwMCA9IHBbY29sXTsKICAgIHAxID0gcFtjb2wgKyA4XTsKICAgIHAyID0gcFtjb2wgKyAxNl07CiAgICBwMyA9IHBbY29sICsgMjRdOwogICAgcDQgPSBwW2NvbCArIDMyXTsKICAgIHA1ID0gcFtjb2wgKyA0MF07CiAgICBwNiA9IHBbY29sICsgNDhdOwogICAgcDcgPSBwW2NvbCArIDU2XTsKCiAgICBpZiAoKHAxIHwgcDIgfCBwMyB8IHA0IHwgcDUgfCBwNiB8IHA3KSA9PT0gMCkgewogICAgICB0ID0gZGN0U3FydDIgKiBwMCArIDgxOTIgPj4gMTQ7CgogICAgICBpZiAodCA8IC0yMDQwKSB7CiAgICAgICAgdCA9IDA7CiAgICAgIH0gZWxzZSBpZiAodCA+PSAyMDI0KSB7CiAgICAgICAgdCA9IDI1NTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ID0gdCArIDIwNTYgPj4gNDsKICAgICAgfQoKICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sXSA9IHQ7CiAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDhdID0gdDsKICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgMTZdID0gdDsKICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgMjRdID0gdDsKICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgMzJdID0gdDsKICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgNDBdID0gdDsKICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgNDhdID0gdDsKICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgNTZdID0gdDsKICAgICAgY29udGludWU7CiAgICB9CgogICAgdjAgPSBkY3RTcXJ0MiAqIHAwICsgMjA0OCA+PiAxMjsKICAgIHYxID0gZGN0U3FydDIgKiBwNCArIDIwNDggPj4gMTI7CiAgICB2MiA9IHAyOwogICAgdjMgPSBwNjsKICAgIHY0ID0gZGN0U3FydDFkMiAqIChwMSAtIHA3KSArIDIwNDggPj4gMTI7CiAgICB2NyA9IGRjdFNxcnQxZDIgKiAocDEgKyBwNykgKyAyMDQ4ID4+IDEyOwogICAgdjUgPSBwMzsKICAgIHY2ID0gcDU7CiAgICB2MCA9ICh2MCArIHYxICsgMSA+PiAxKSArIDQxMTI7CiAgICB2MSA9IHYwIC0gdjE7CiAgICB0ID0gdjIgKiBkY3RTaW42ICsgdjMgKiBkY3RDb3M2ICsgMjA0OCA+PiAxMjsKICAgIHYyID0gdjIgKiBkY3RDb3M2IC0gdjMgKiBkY3RTaW42ICsgMjA0OCA+PiAxMjsKICAgIHYzID0gdDsKICAgIHY0ID0gdjQgKyB2NiArIDEgPj4gMTsKICAgIHY2ID0gdjQgLSB2NjsKICAgIHY3ID0gdjcgKyB2NSArIDEgPj4gMTsKICAgIHY1ID0gdjcgLSB2NTsKICAgIHYwID0gdjAgKyB2MyArIDEgPj4gMTsKICAgIHYzID0gdjAgLSB2MzsKICAgIHYxID0gdjEgKyB2MiArIDEgPj4gMTsKICAgIHYyID0gdjEgLSB2MjsKICAgIHQgPSB2NCAqIGRjdFNpbjMgKyB2NyAqIGRjdENvczMgKyAyMDQ4ID4+IDEyOwogICAgdjQgPSB2NCAqIGRjdENvczMgLSB2NyAqIGRjdFNpbjMgKyAyMDQ4ID4+IDEyOwogICAgdjcgPSB0OwogICAgdCA9IHY1ICogZGN0U2luMSArIHY2ICogZGN0Q29zMSArIDIwNDggPj4gMTI7CiAgICB2NSA9IHY1ICogZGN0Q29zMSAtIHY2ICogZGN0U2luMSArIDIwNDggPj4gMTI7CiAgICB2NiA9IHQ7CiAgICBwMCA9IHYwICsgdjc7CiAgICBwNyA9IHYwIC0gdjc7CiAgICBwMSA9IHYxICsgdjY7CiAgICBwNiA9IHYxIC0gdjY7CiAgICBwMiA9IHYyICsgdjU7CiAgICBwNSA9IHYyIC0gdjU7CiAgICBwMyA9IHYzICsgdjQ7CiAgICBwNCA9IHYzIC0gdjQ7CgogICAgaWYgKHAwIDwgMTYpIHsKICAgICAgcDAgPSAwOwogICAgfSBlbHNlIGlmIChwMCA+PSA0MDgwKSB7CiAgICAgIHAwID0gMjU1OwogICAgfSBlbHNlIHsKICAgICAgcDAgPj49IDQ7CiAgICB9CgogICAgaWYgKHAxIDwgMTYpIHsKICAgICAgcDEgPSAwOwogICAgfSBlbHNlIGlmIChwMSA+PSA0MDgwKSB7CiAgICAgIHAxID0gMjU1OwogICAgfSBlbHNlIHsKICAgICAgcDEgPj49IDQ7CiAgICB9CgogICAgaWYgKHAyIDwgMTYpIHsKICAgICAgcDIgPSAwOwogICAgfSBlbHNlIGlmIChwMiA+PSA0MDgwKSB7CiAgICAgIHAyID0gMjU1OwogICAgfSBlbHNlIHsKICAgICAgcDIgPj49IDQ7CiAgICB9CgogICAgaWYgKHAzIDwgMTYpIHsKICAgICAgcDMgPSAwOwogICAgfSBlbHNlIGlmIChwMyA+PSA0MDgwKSB7CiAgICAgIHAzID0gMjU1OwogICAgfSBlbHNlIHsKICAgICAgcDMgPj49IDQ7CiAgICB9CgogICAgaWYgKHA0IDwgMTYpIHsKICAgICAgcDQgPSAwOwogICAgfSBlbHNlIGlmIChwNCA+PSA0MDgwKSB7CiAgICAgIHA0ID0gMjU1OwogICAgfSBlbHNlIHsKICAgICAgcDQgPj49IDQ7CiAgICB9CgogICAgaWYgKHA1IDwgMTYpIHsKICAgICAgcDUgPSAwOwogICAgfSBlbHNlIGlmIChwNSA+PSA0MDgwKSB7CiAgICAgIHA1ID0gMjU1OwogICAgfSBlbHNlIHsKICAgICAgcDUgPj49IDQ7CiAgICB9CgogICAgaWYgKHA2IDwgMTYpIHsKICAgICAgcDYgPSAwOwogICAgfSBlbHNlIGlmIChwNiA+PSA0MDgwKSB7CiAgICAgIHA2ID0gMjU1OwogICAgfSBlbHNlIHsKICAgICAgcDYgPj49IDQ7CiAgICB9CgogICAgaWYgKHA3IDwgMTYpIHsKICAgICAgcDcgPSAwOwogICAgfSBlbHNlIGlmIChwNyA+PSA0MDgwKSB7CiAgICAgIHA3ID0gMjU1OwogICAgfSBlbHNlIHsKICAgICAgcDcgPj49IDQ7CiAgICB9CgogICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sXSA9IHAwOwogICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgOF0gPSBwMTsKICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDE2XSA9IHAyOwogICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgMjRdID0gcDM7CiAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyAzMl0gPSBwNDsKICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDQwXSA9IHA1OwogICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgNDhdID0gcDY7CiAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyA1Nl0gPSBwNzsKICB9Cn0KCmZ1bmN0aW9uIGJ1aWxkQ29tcG9uZW50RGF0YShmcmFtZSwgY29tcG9uZW50KSB7CiAgY29uc3QgYmxvY2tzUGVyTGluZSA9IGNvbXBvbmVudC5ibG9ja3NQZXJMaW5lOwogIGNvbnN0IGJsb2Nrc1BlckNvbHVtbiA9IGNvbXBvbmVudC5ibG9ja3NQZXJDb2x1bW47CiAgY29uc3QgY29tcHV0YXRpb25CdWZmZXIgPSBuZXcgSW50MTZBcnJheSg2NCk7CgogIGZvciAobGV0IGJsb2NrUm93ID0gMDsgYmxvY2tSb3cgPCBibG9ja3NQZXJDb2x1bW47IGJsb2NrUm93KyspIHsKICAgIGZvciAobGV0IGJsb2NrQ29sID0gMDsgYmxvY2tDb2wgPCBibG9ja3NQZXJMaW5lOyBibG9ja0NvbCsrKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IGdldEJsb2NrQnVmZmVyT2Zmc2V0KGNvbXBvbmVudCwgYmxvY2tSb3csIGJsb2NrQ29sKTsKICAgICAgcXVhbnRpemVBbmRJbnZlcnNlKGNvbXBvbmVudCwgb2Zmc2V0LCBjb21wdXRhdGlvbkJ1ZmZlcik7CiAgICB9CiAgfQoKICByZXR1cm4gY29tcG9uZW50LmJsb2NrRGF0YTsKfQoKZnVuY3Rpb24gZmluZE5leHRGaWxlTWFya2VyKGRhdGEsIGN1cnJlbnRQb3MpIHsKICBsZXQgc3RhcnRQb3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGN1cnJlbnRQb3M7CiAgY29uc3QgbWF4UG9zID0gZGF0YS5sZW5ndGggLSAxOwogIGxldCBuZXdQb3MgPSBzdGFydFBvcyA8IGN1cnJlbnRQb3MgPyBzdGFydFBvcyA6IGN1cnJlbnRQb3M7CgogIGlmIChjdXJyZW50UG9zID49IG1heFBvcykgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBjb25zdCBjdXJyZW50TWFya2VyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIGN1cnJlbnRQb3MpOwoKICBpZiAoY3VycmVudE1hcmtlciA+PSAweGZmYzAgJiYgY3VycmVudE1hcmtlciA8PSAweGZmZmUpIHsKICAgIHJldHVybiB7CiAgICAgIGludmFsaWQ6IG51bGwsCiAgICAgIG1hcmtlcjogY3VycmVudE1hcmtlciwKICAgICAgb2Zmc2V0OiBjdXJyZW50UG9zCiAgICB9OwogIH0KCiAgbGV0IG5ld01hcmtlciA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBuZXdQb3MpOwoKICB3aGlsZSAoIShuZXdNYXJrZXIgPj0gMHhmZmMwICYmIG5ld01hcmtlciA8PSAweGZmZmUpKSB7CiAgICBpZiAoKytuZXdQb3MgPj0gbWF4UG9zKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIG5ld01hcmtlciA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBuZXdQb3MpOwogIH0KCiAgcmV0dXJuIHsKICAgIGludmFsaWQ6IGN1cnJlbnRNYXJrZXIudG9TdHJpbmcoMTYpLAogICAgbWFya2VyOiBuZXdNYXJrZXIsCiAgICBvZmZzZXQ6IG5ld1BvcwogIH07Cn0KCmNsYXNzIEpwZWdJbWFnZSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICBsZXQgewogICAgICBkZWNvZGVUcmFuc2Zvcm0gPSBudWxsLAogICAgICBjb2xvclRyYW5zZm9ybSA9IC0xCiAgICB9ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKICAgIHRoaXMuX2RlY29kZVRyYW5zZm9ybSA9IGRlY29kZVRyYW5zZm9ybTsKICAgIHRoaXMuX2NvbG9yVHJhbnNmb3JtID0gY29sb3JUcmFuc2Zvcm07CiAgfQoKICBwYXJzZShkYXRhKSB7CiAgICBsZXQgewogICAgICBkbmxTY2FuTGluZXMgPSBudWxsCiAgICB9ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKCiAgICBmdW5jdGlvbiByZWFkRGF0YUJsb2NrKCkgewogICAgICBjb25zdCBsZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgb2Zmc2V0KTsKICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgIGxldCBlbmRPZmZzZXQgPSBvZmZzZXQgKyBsZW5ndGggLSAyOwogICAgICBjb25zdCBmaWxlTWFya2VyID0gZmluZE5leHRGaWxlTWFya2VyKGRhdGEsIGVuZE9mZnNldCwgb2Zmc2V0KTsKCiAgICAgIGlmIChmaWxlTWFya2VyICYmIGZpbGVNYXJrZXIuaW52YWxpZCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgicmVhZERhdGFCbG9jayAtIGluY29ycmVjdCBsZW5ndGgsIGN1cnJlbnQgbWFya2VyIGlzOiAiICsgZmlsZU1hcmtlci5pbnZhbGlkKTsKICAgICAgICBlbmRPZmZzZXQgPSBmaWxlTWFya2VyLm9mZnNldDsKICAgICAgfQoKICAgICAgY29uc3QgYXJyYXkgPSBkYXRhLnN1YmFycmF5KG9mZnNldCwgZW5kT2Zmc2V0KTsKICAgICAgb2Zmc2V0ICs9IGFycmF5Lmxlbmd0aDsKICAgICAgcmV0dXJuIGFycmF5OwogICAgfQoKICAgIGZ1bmN0aW9uIHByZXBhcmVDb21wb25lbnRzKGZyYW1lKSB7CiAgICAgIGNvbnN0IG1jdXNQZXJMaW5lID0gTWF0aC5jZWlsKGZyYW1lLnNhbXBsZXNQZXJMaW5lIC8gOCAvIGZyYW1lLm1heEgpOwogICAgICBjb25zdCBtY3VzUGVyQ29sdW1uID0gTWF0aC5jZWlsKGZyYW1lLnNjYW5MaW5lcyAvIDggLyBmcmFtZS5tYXhWKTsKCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGZyYW1lLmNvbXBvbmVudHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGZyYW1lLmNvbXBvbmVudHNbaV07CiAgICAgICAgY29uc3QgYmxvY2tzUGVyTGluZSA9IE1hdGguY2VpbChNYXRoLmNlaWwoZnJhbWUuc2FtcGxlc1BlckxpbmUgLyA4KSAqIGNvbXBvbmVudC5oIC8gZnJhbWUubWF4SCk7CiAgICAgICAgY29uc3QgYmxvY2tzUGVyQ29sdW1uID0gTWF0aC5jZWlsKE1hdGguY2VpbChmcmFtZS5zY2FuTGluZXMgLyA4KSAqIGNvbXBvbmVudC52IC8gZnJhbWUubWF4Vik7CiAgICAgICAgY29uc3QgYmxvY2tzUGVyTGluZUZvck1jdSA9IG1jdXNQZXJMaW5lICogY29tcG9uZW50Lmg7CiAgICAgICAgY29uc3QgYmxvY2tzUGVyQ29sdW1uRm9yTWN1ID0gbWN1c1BlckNvbHVtbiAqIGNvbXBvbmVudC52OwogICAgICAgIGNvbnN0IGJsb2Nrc0J1ZmZlclNpemUgPSA2NCAqIGJsb2Nrc1BlckNvbHVtbkZvck1jdSAqIChibG9ja3NQZXJMaW5lRm9yTWN1ICsgMSk7CiAgICAgICAgY29tcG9uZW50LmJsb2NrRGF0YSA9IG5ldyBJbnQxNkFycmF5KGJsb2Nrc0J1ZmZlclNpemUpOwogICAgICAgIGNvbXBvbmVudC5ibG9ja3NQZXJMaW5lID0gYmxvY2tzUGVyTGluZTsKICAgICAgICBjb21wb25lbnQuYmxvY2tzUGVyQ29sdW1uID0gYmxvY2tzUGVyQ29sdW1uOwogICAgICB9CgogICAgICBmcmFtZS5tY3VzUGVyTGluZSA9IG1jdXNQZXJMaW5lOwogICAgICBmcmFtZS5tY3VzUGVyQ29sdW1uID0gbWN1c1BlckNvbHVtbjsKICAgIH0KCiAgICBsZXQgb2Zmc2V0ID0gMDsKICAgIGxldCBqZmlmID0gbnVsbDsKICAgIGxldCBhZG9iZSA9IG51bGw7CiAgICBsZXQgZnJhbWUsIHJlc2V0SW50ZXJ2YWw7CiAgICBsZXQgbnVtU09TTWFya2VycyA9IDA7CiAgICBjb25zdCBxdWFudGl6YXRpb25UYWJsZXMgPSBbXTsKICAgIGNvbnN0IGh1ZmZtYW5UYWJsZXNBQyA9IFtdLAogICAgICAgICAgaHVmZm1hblRhYmxlc0RDID0gW107CiAgICBsZXQgZmlsZU1hcmtlciA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgb2Zmc2V0ICs9IDI7CgogICAgaWYgKGZpbGVNYXJrZXIgIT09IDB4ZmZkOCkgewogICAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJTT0kgbm90IGZvdW5kIik7CiAgICB9CgogICAgZmlsZU1hcmtlciA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgb2Zmc2V0ICs9IDI7CgogICAgbWFya2VyTG9vcDogd2hpbGUgKGZpbGVNYXJrZXIgIT09IDB4ZmZkOSkgewogICAgICBsZXQgaSwgaiwgbDsKCiAgICAgIHN3aXRjaCAoZmlsZU1hcmtlcikgewogICAgICAgIGNhc2UgMHhmZmUwOgogICAgICAgIGNhc2UgMHhmZmUxOgogICAgICAgIGNhc2UgMHhmZmUyOgogICAgICAgIGNhc2UgMHhmZmUzOgogICAgICAgIGNhc2UgMHhmZmU0OgogICAgICAgIGNhc2UgMHhmZmU1OgogICAgICAgIGNhc2UgMHhmZmU2OgogICAgICAgIGNhc2UgMHhmZmU3OgogICAgICAgIGNhc2UgMHhmZmU4OgogICAgICAgIGNhc2UgMHhmZmU5OgogICAgICAgIGNhc2UgMHhmZmVhOgogICAgICAgIGNhc2UgMHhmZmViOgogICAgICAgIGNhc2UgMHhmZmVjOgogICAgICAgIGNhc2UgMHhmZmVkOgogICAgICAgIGNhc2UgMHhmZmVlOgogICAgICAgIGNhc2UgMHhmZmVmOgogICAgICAgIGNhc2UgMHhmZmZlOgogICAgICAgICAgY29uc3QgYXBwRGF0YSA9IHJlYWREYXRhQmxvY2soKTsKCiAgICAgICAgICBpZiAoZmlsZU1hcmtlciA9PT0gMHhmZmUwKSB7CiAgICAgICAgICAgIGlmIChhcHBEYXRhWzBdID09PSAweDRhICYmIGFwcERhdGFbMV0gPT09IDB4NDYgJiYgYXBwRGF0YVsyXSA9PT0gMHg0OSAmJiBhcHBEYXRhWzNdID09PSAweDQ2ICYmIGFwcERhdGFbNF0gPT09IDApIHsKICAgICAgICAgICAgICBqZmlmID0gewogICAgICAgICAgICAgICAgdmVyc2lvbjogewogICAgICAgICAgICAgICAgICBtYWpvcjogYXBwRGF0YVs1XSwKICAgICAgICAgICAgICAgICAgbWlub3I6IGFwcERhdGFbNl0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBkZW5zaXR5VW5pdHM6IGFwcERhdGFbN10sCiAgICAgICAgICAgICAgICB4RGVuc2l0eTogYXBwRGF0YVs4XSA8PCA4IHwgYXBwRGF0YVs5XSwKICAgICAgICAgICAgICAgIHlEZW5zaXR5OiBhcHBEYXRhWzEwXSA8PCA4IHwgYXBwRGF0YVsxMV0sCiAgICAgICAgICAgICAgICB0aHVtYldpZHRoOiBhcHBEYXRhWzEyXSwKICAgICAgICAgICAgICAgIHRodW1iSGVpZ2h0OiBhcHBEYXRhWzEzXSwKICAgICAgICAgICAgICAgIHRodW1iRGF0YTogYXBwRGF0YS5zdWJhcnJheSgxNCwgMTQgKyAzICogYXBwRGF0YVsxMl0gKiBhcHBEYXRhWzEzXSkKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGZpbGVNYXJrZXIgPT09IDB4ZmZlZSkgewogICAgICAgICAgICBpZiAoYXBwRGF0YVswXSA9PT0gMHg0MSAmJiBhcHBEYXRhWzFdID09PSAweDY0ICYmIGFwcERhdGFbMl0gPT09IDB4NmYgJiYgYXBwRGF0YVszXSA9PT0gMHg2MiAmJiBhcHBEYXRhWzRdID09PSAweDY1KSB7CiAgICAgICAgICAgICAgYWRvYmUgPSB7CiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBhcHBEYXRhWzVdIDw8IDggfCBhcHBEYXRhWzZdLAogICAgICAgICAgICAgICAgZmxhZ3MwOiBhcHBEYXRhWzddIDw8IDggfCBhcHBEYXRhWzhdLAogICAgICAgICAgICAgICAgZmxhZ3MxOiBhcHBEYXRhWzldIDw8IDggfCBhcHBEYXRhWzEwXSwKICAgICAgICAgICAgICAgIHRyYW5zZm9ybUNvZGU6IGFwcERhdGFbMTFdCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4ZmZkYjoKICAgICAgICAgIGNvbnN0IHF1YW50aXphdGlvblRhYmxlc0xlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICBjb25zdCBxdWFudGl6YXRpb25UYWJsZXNFbmQgPSBxdWFudGl6YXRpb25UYWJsZXNMZW5ndGggKyBvZmZzZXQgLSAyOwogICAgICAgICAgbGV0IHo7CgogICAgICAgICAgd2hpbGUgKG9mZnNldCA8IHF1YW50aXphdGlvblRhYmxlc0VuZCkgewogICAgICAgICAgICBjb25zdCBxdWFudGl6YXRpb25UYWJsZVNwZWMgPSBkYXRhW29mZnNldCsrXTsKICAgICAgICAgICAgY29uc3QgdGFibGVEYXRhID0gbmV3IFVpbnQxNkFycmF5KDY0KTsKCiAgICAgICAgICAgIGlmIChxdWFudGl6YXRpb25UYWJsZVNwZWMgPj4gNCA9PT0gMCkgewogICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCA2NDsgaisrKSB7CiAgICAgICAgICAgICAgICB6ID0gZGN0WmlnWmFnW2pdOwogICAgICAgICAgICAgICAgdGFibGVEYXRhW3pdID0gZGF0YVtvZmZzZXQrK107CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKHF1YW50aXphdGlvblRhYmxlU3BlYyA+PiA0ID09PSAxKSB7CiAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IDY0OyBqKyspIHsKICAgICAgICAgICAgICAgIHogPSBkY3RaaWdaYWdbal07CiAgICAgICAgICAgICAgICB0YWJsZURhdGFbel0gPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgb2Zmc2V0KTsKICAgICAgICAgICAgICAgIG9mZnNldCArPSAyOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJEUVQgLSBpbnZhbGlkIHRhYmxlIHNwZWMiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcXVhbnRpemF0aW9uVGFibGVzW3F1YW50aXphdGlvblRhYmxlU3BlYyAmIDE1XSA9IHRhYmxlRGF0YTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweGZmYzA6CiAgICAgICAgY2FzZSAweGZmYzE6CiAgICAgICAgY2FzZSAweGZmYzI6CiAgICAgICAgICBpZiAoZnJhbWUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEpwZWdFcnJvcigiT25seSBzaW5nbGUgZnJhbWUgSlBFR3Mgc3VwcG9ydGVkIik7CiAgICAgICAgICB9CgogICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICBmcmFtZSA9IHt9OwogICAgICAgICAgZnJhbWUuZXh0ZW5kZWQgPSBmaWxlTWFya2VyID09PSAweGZmYzE7CiAgICAgICAgICBmcmFtZS5wcm9ncmVzc2l2ZSA9IGZpbGVNYXJrZXIgPT09IDB4ZmZjMjsKICAgICAgICAgIGZyYW1lLnByZWNpc2lvbiA9IGRhdGFbb2Zmc2V0KytdOwogICAgICAgICAgY29uc3Qgc29mU2NhbkxpbmVzID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICAgICAgICBvZmZzZXQgKz0gMjsKICAgICAgICAgIGZyYW1lLnNjYW5MaW5lcyA9IGRubFNjYW5MaW5lcyB8fCBzb2ZTY2FuTGluZXM7CiAgICAgICAgICBmcmFtZS5zYW1wbGVzUGVyTGluZSA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICBmcmFtZS5jb21wb25lbnRzID0gW107CiAgICAgICAgICBmcmFtZS5jb21wb25lbnRJZHMgPSB7fTsKICAgICAgICAgIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IGRhdGFbb2Zmc2V0KytdOwogICAgICAgICAgbGV0IG1heEggPSAwLAogICAgICAgICAgICAgIG1heFYgPSAwOwoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb21wb25lbnRzQ291bnQ7IGkrKykgewogICAgICAgICAgICBjb25zdCBjb21wb25lbnRJZCA9IGRhdGFbb2Zmc2V0XTsKICAgICAgICAgICAgY29uc3QgaCA9IGRhdGFbb2Zmc2V0ICsgMV0gPj4gNDsKICAgICAgICAgICAgY29uc3QgdiA9IGRhdGFbb2Zmc2V0ICsgMV0gJiAxNTsKCiAgICAgICAgICAgIGlmIChtYXhIIDwgaCkgewogICAgICAgICAgICAgIG1heEggPSBoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobWF4ViA8IHYpIHsKICAgICAgICAgICAgICBtYXhWID0gdjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgcUlkID0gZGF0YVtvZmZzZXQgKyAyXTsKICAgICAgICAgICAgbCA9IGZyYW1lLmNvbXBvbmVudHMucHVzaCh7CiAgICAgICAgICAgICAgaCwKICAgICAgICAgICAgICB2LAogICAgICAgICAgICAgIHF1YW50aXphdGlvbklkOiBxSWQsCiAgICAgICAgICAgICAgcXVhbnRpemF0aW9uVGFibGU6IG51bGwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGZyYW1lLmNvbXBvbmVudElkc1tjb21wb25lbnRJZF0gPSBsIC0gMTsKICAgICAgICAgICAgb2Zmc2V0ICs9IDM7CiAgICAgICAgICB9CgogICAgICAgICAgZnJhbWUubWF4SCA9IG1heEg7CiAgICAgICAgICBmcmFtZS5tYXhWID0gbWF4VjsKICAgICAgICAgIHByZXBhcmVDb21wb25lbnRzKGZyYW1lKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4ZmZjNDoKICAgICAgICAgIGNvbnN0IGh1ZmZtYW5MZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgb2Zmc2V0KTsKICAgICAgICAgIG9mZnNldCArPSAyOwoKICAgICAgICAgIGZvciAoaSA9IDI7IGkgPCBodWZmbWFuTGVuZ3RoOykgewogICAgICAgICAgICBjb25zdCBodWZmbWFuVGFibGVTcGVjID0gZGF0YVtvZmZzZXQrK107CiAgICAgICAgICAgIGNvbnN0IGNvZGVMZW5ndGhzID0gbmV3IFVpbnQ4QXJyYXkoMTYpOwogICAgICAgICAgICBsZXQgY29kZUxlbmd0aFN1bSA9IDA7CgogICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgMTY7IGorKywgb2Zmc2V0KyspIHsKICAgICAgICAgICAgICBjb2RlTGVuZ3RoU3VtICs9IGNvZGVMZW5ndGhzW2pdID0gZGF0YVtvZmZzZXRdOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCBodWZmbWFuVmFsdWVzID0gbmV3IFVpbnQ4QXJyYXkoY29kZUxlbmd0aFN1bSk7CgogICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgY29kZUxlbmd0aFN1bTsgaisrLCBvZmZzZXQrKykgewogICAgICAgICAgICAgIGh1ZmZtYW5WYWx1ZXNbal0gPSBkYXRhW29mZnNldF07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGkgKz0gMTcgKyBjb2RlTGVuZ3RoU3VtOwogICAgICAgICAgICAoaHVmZm1hblRhYmxlU3BlYyA+PiA0ID09PSAwID8gaHVmZm1hblRhYmxlc0RDIDogaHVmZm1hblRhYmxlc0FDKVtodWZmbWFuVGFibGVTcGVjICYgMTVdID0gYnVpbGRIdWZmbWFuVGFibGUoY29kZUxlbmd0aHMsIGh1ZmZtYW5WYWx1ZXMpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4ZmZkZDoKICAgICAgICAgIG9mZnNldCArPSAyOwogICAgICAgICAgcmVzZXRJbnRlcnZhbCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweGZmZGE6CiAgICAgICAgICBjb25zdCBwYXJzZUROTE1hcmtlciA9ICsrbnVtU09TTWFya2VycyA9PT0gMSAmJiAhZG5sU2NhbkxpbmVzOwogICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICBjb25zdCBzZWxlY3RvcnNDb3VudCA9IGRhdGFbb2Zmc2V0KytdLAogICAgICAgICAgICAgICAgY29tcG9uZW50cyA9IFtdOwoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzZWxlY3RvcnNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gZGF0YVtvZmZzZXQrK107CiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudEluZGV4ID0gZnJhbWUuY29tcG9uZW50SWRzW2luZGV4XTsKICAgICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gZnJhbWUuY29tcG9uZW50c1tjb21wb25lbnRJbmRleF07CiAgICAgICAgICAgIGNvbXBvbmVudC5pbmRleCA9IGluZGV4OwogICAgICAgICAgICBjb25zdCB0YWJsZVNwZWMgPSBkYXRhW29mZnNldCsrXTsKICAgICAgICAgICAgY29tcG9uZW50Lmh1ZmZtYW5UYWJsZURDID0gaHVmZm1hblRhYmxlc0RDW3RhYmxlU3BlYyA+PiA0XTsKICAgICAgICAgICAgY29tcG9uZW50Lmh1ZmZtYW5UYWJsZUFDID0gaHVmZm1hblRhYmxlc0FDW3RhYmxlU3BlYyAmIDE1XTsKICAgICAgICAgICAgY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3Qgc3BlY3RyYWxTdGFydCA9IGRhdGFbb2Zmc2V0KytdLAogICAgICAgICAgICAgICAgc3BlY3RyYWxFbmQgPSBkYXRhW29mZnNldCsrXSwKICAgICAgICAgICAgICAgIHN1Y2Nlc3NpdmVBcHByb3hpbWF0aW9uID0gZGF0YVtvZmZzZXQrK107CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgcHJvY2Vzc2VkID0gZGVjb2RlU2NhbihkYXRhLCBvZmZzZXQsIGZyYW1lLCBjb21wb25lbnRzLCByZXNldEludGVydmFsLCBzcGVjdHJhbFN0YXJ0LCBzcGVjdHJhbEVuZCwgc3VjY2Vzc2l2ZUFwcHJveGltYXRpb24gPj4gNCwgc3VjY2Vzc2l2ZUFwcHJveGltYXRpb24gJiAxNSwgcGFyc2VETkxNYXJrZXIpOwogICAgICAgICAgICBvZmZzZXQgKz0gcHJvY2Vzc2VkOwogICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgaWYgKGV4IGluc3RhbmNlb2YgRE5MTWFya2VyRXJyb3IpIHsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoYCR7ZXgubWVzc2FnZX0gLS0gYXR0ZW1wdGluZyB0byByZS1wYXJzZSB0aGUgSlBFRyBpbWFnZS5gKTsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZShkYXRhLCB7CiAgICAgICAgICAgICAgICBkbmxTY2FuTGluZXM6IGV4LnNjYW5MaW5lcwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKGV4IGluc3RhbmNlb2YgRU9JTWFya2VyRXJyb3IpIHsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoYCR7ZXgubWVzc2FnZX0gLS0gaWdub3JpbmcgdGhlIHJlc3Qgb2YgdGhlIGltYWdlIGRhdGEuYCk7CiAgICAgICAgICAgICAgYnJlYWsgbWFya2VyTG9vcDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHhmZmRjOgogICAgICAgICAgb2Zmc2V0ICs9IDQ7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweGZmZmY6CiAgICAgICAgICBpZiAoZGF0YVtvZmZzZXRdICE9PSAweGZmKSB7CiAgICAgICAgICAgIG9mZnNldC0tOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgY29uc3QgbmV4dEZpbGVNYXJrZXIgPSBmaW5kTmV4dEZpbGVNYXJrZXIoZGF0YSwgb2Zmc2V0IC0gMiwgb2Zmc2V0IC0gMyk7CgogICAgICAgICAgaWYgKG5leHRGaWxlTWFya2VyICYmIG5leHRGaWxlTWFya2VyLmludmFsaWQpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJKcGVnSW1hZ2UucGFyc2UgLSB1bmV4cGVjdGVkIGRhdGEsIGN1cnJlbnQgbWFya2VyIGlzOiAiICsgbmV4dEZpbGVNYXJrZXIuaW52YWxpZCk7CiAgICAgICAgICAgIG9mZnNldCA9IG5leHRGaWxlTWFya2VyLm9mZnNldDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFuZXh0RmlsZU1hcmtlciB8fCBvZmZzZXQgPj0gZGF0YS5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSnBlZ0ltYWdlLnBhcnNlIC0gcmVhY2hlZCB0aGUgZW5kIG9mIHRoZSBpbWFnZSBkYXRhICIgKyAid2l0aG91dCBmaW5kaW5nIGFuIEVPSSBtYXJrZXIgKDB4RkZEOSkuIik7CiAgICAgICAgICAgIGJyZWFrIG1hcmtlckxvb3A7CiAgICAgICAgICB9CgogICAgICAgICAgdGhyb3cgbmV3IEpwZWdFcnJvcigiSnBlZ0ltYWdlLnBhcnNlIC0gdW5rbm93biBtYXJrZXI6ICIgKyBmaWxlTWFya2VyLnRvU3RyaW5nKDE2KSk7CiAgICAgIH0KCiAgICAgIGZpbGVNYXJrZXIgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgb2Zmc2V0KTsKICAgICAgb2Zmc2V0ICs9IDI7CiAgICB9CgogICAgdGhpcy53aWR0aCA9IGZyYW1lLnNhbXBsZXNQZXJMaW5lOwogICAgdGhpcy5oZWlnaHQgPSBmcmFtZS5zY2FuTGluZXM7CiAgICB0aGlzLmpmaWYgPSBqZmlmOwogICAgdGhpcy5hZG9iZSA9IGFkb2JlOwogICAgdGhpcy5jb21wb25lbnRzID0gW107CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZnJhbWUuY29tcG9uZW50cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGZyYW1lLmNvbXBvbmVudHNbaV07CiAgICAgIGNvbnN0IHF1YW50aXphdGlvblRhYmxlID0gcXVhbnRpemF0aW9uVGFibGVzW2NvbXBvbmVudC5xdWFudGl6YXRpb25JZF07CgogICAgICBpZiAocXVhbnRpemF0aW9uVGFibGUpIHsKICAgICAgICBjb21wb25lbnQucXVhbnRpemF0aW9uVGFibGUgPSBxdWFudGl6YXRpb25UYWJsZTsKICAgICAgfQoKICAgICAgdGhpcy5jb21wb25lbnRzLnB1c2goewogICAgICAgIGluZGV4OiBjb21wb25lbnQuaW5kZXgsCiAgICAgICAgb3V0cHV0OiBidWlsZENvbXBvbmVudERhdGEoZnJhbWUsIGNvbXBvbmVudCksCiAgICAgICAgc2NhbGVYOiBjb21wb25lbnQuaCAvIGZyYW1lLm1heEgsCiAgICAgICAgc2NhbGVZOiBjb21wb25lbnQudiAvIGZyYW1lLm1heFYsCiAgICAgICAgYmxvY2tzUGVyTGluZTogY29tcG9uZW50LmJsb2Nrc1BlckxpbmUsCiAgICAgICAgYmxvY2tzUGVyQ29sdW1uOiBjb21wb25lbnQuYmxvY2tzUGVyQ29sdW1uCiAgICAgIH0pOwogICAgfQoKICAgIHRoaXMubnVtQ29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cy5sZW5ndGg7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgX2dldExpbmVhcml6ZWRCbG9ja0RhdGEod2lkdGgsIGhlaWdodCkgewogICAgbGV0IGlzU291cmNlUERGID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKICAgIGNvbnN0IHNjYWxlWCA9IHRoaXMud2lkdGggLyB3aWR0aCwKICAgICAgICAgIHNjYWxlWSA9IHRoaXMuaGVpZ2h0IC8gaGVpZ2h0OwogICAgbGV0IGNvbXBvbmVudCwgY29tcG9uZW50U2NhbGVYLCBjb21wb25lbnRTY2FsZVksIGJsb2Nrc1BlclNjYW5saW5lOwogICAgbGV0IHgsIHksIGksIGosIGs7CiAgICBsZXQgaW5kZXg7CiAgICBsZXQgb2Zmc2V0ID0gMDsKICAgIGxldCBvdXRwdXQ7CiAgICBjb25zdCBudW1Db21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLmxlbmd0aDsKICAgIGNvbnN0IGRhdGFMZW5ndGggPSB3aWR0aCAqIGhlaWdodCAqIG51bUNvbXBvbmVudHM7CiAgICBjb25zdCBkYXRhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGRhdGFMZW5ndGgpOwogICAgY29uc3QgeFNjYWxlQmxvY2tPZmZzZXQgPSBuZXcgVWludDMyQXJyYXkod2lkdGgpOwogICAgY29uc3QgbWFzazNMU0IgPSAweGZmZmZmZmY4OwogICAgbGV0IGxhc3RDb21wb25lbnRTY2FsZVg7CgogICAgZm9yIChpID0gMDsgaSA8IG51bUNvbXBvbmVudHM7IGkrKykgewogICAgICBjb21wb25lbnQgPSB0aGlzLmNvbXBvbmVudHNbaV07CiAgICAgIGNvbXBvbmVudFNjYWxlWCA9IGNvbXBvbmVudC5zY2FsZVggKiBzY2FsZVg7CiAgICAgIGNvbXBvbmVudFNjYWxlWSA9IGNvbXBvbmVudC5zY2FsZVkgKiBzY2FsZVk7CiAgICAgIG9mZnNldCA9IGk7CiAgICAgIG91dHB1dCA9IGNvbXBvbmVudC5vdXRwdXQ7CiAgICAgIGJsb2Nrc1BlclNjYW5saW5lID0gY29tcG9uZW50LmJsb2Nrc1BlckxpbmUgKyAxIDw8IDM7CgogICAgICBpZiAoY29tcG9uZW50U2NhbGVYICE9PSBsYXN0Q29tcG9uZW50U2NhbGVYKSB7CiAgICAgICAgZm9yICh4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgICAgIGogPSAwIHwgeCAqIGNvbXBvbmVudFNjYWxlWDsKICAgICAgICAgIHhTY2FsZUJsb2NrT2Zmc2V0W3hdID0gKGogJiBtYXNrM0xTQikgPDwgMyB8IGogJiA3OwogICAgICAgIH0KCiAgICAgICAgbGFzdENvbXBvbmVudFNjYWxlWCA9IGNvbXBvbmVudFNjYWxlWDsKICAgICAgfQoKICAgICAgZm9yICh5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CiAgICAgICAgaiA9IDAgfCB5ICogY29tcG9uZW50U2NhbGVZOwogICAgICAgIGluZGV4ID0gYmxvY2tzUGVyU2NhbmxpbmUgKiAoaiAmIG1hc2szTFNCKSB8IChqICYgNykgPDwgMzsKCiAgICAgICAgZm9yICh4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgICAgIGRhdGFbb2Zmc2V0XSA9IG91dHB1dFtpbmRleCArIHhTY2FsZUJsb2NrT2Zmc2V0W3hdXTsKICAgICAgICAgIG9mZnNldCArPSBudW1Db21wb25lbnRzOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGxldCB0cmFuc2Zvcm0gPSB0aGlzLl9kZWNvZGVUcmFuc2Zvcm07CgogICAgaWYgKCFpc1NvdXJjZVBERiAmJiBudW1Db21wb25lbnRzID09PSA0ICYmICF0cmFuc2Zvcm0pIHsKICAgICAgdHJhbnNmb3JtID0gbmV3IEludDMyQXJyYXkoWy0yNTYsIDI1NSwgLTI1NiwgMjU1LCAtMjU2LCAyNTUsIC0yNTYsIDI1NV0pOwogICAgfQoKICAgIGlmICh0cmFuc2Zvcm0pIHsKICAgICAgZm9yIChpID0gMDsgaSA8IGRhdGFMZW5ndGg7KSB7CiAgICAgICAgZm9yIChqID0gMCwgayA9IDA7IGogPCBudW1Db21wb25lbnRzOyBqKyssIGkrKywgayArPSAyKSB7CiAgICAgICAgICBkYXRhW2ldID0gKGRhdGFbaV0gKiB0cmFuc2Zvcm1ba10gPj4gOCkgKyB0cmFuc2Zvcm1bayArIDFdOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiBkYXRhOwogIH0KCiAgZ2V0IF9pc0NvbG9yQ29udmVyc2lvbk5lZWRlZCgpIHsKICAgIGlmICh0aGlzLmFkb2JlKSB7CiAgICAgIHJldHVybiAhIXRoaXMuYWRvYmUudHJhbnNmb3JtQ29kZTsKICAgIH0KCiAgICBpZiAodGhpcy5udW1Db21wb25lbnRzID09PSAzKSB7CiAgICAgIGlmICh0aGlzLl9jb2xvclRyYW5zZm9ybSA9PT0gMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmNvbXBvbmVudHNbMF0uaW5kZXggPT09IDB4NTIgJiYgdGhpcy5jb21wb25lbnRzWzFdLmluZGV4ID09PSAweDQ3ICYmIHRoaXMuY29tcG9uZW50c1syXS5pbmRleCA9PT0gMHg0MikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgaWYgKHRoaXMuX2NvbG9yVHJhbnNmb3JtID09PSAxKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIF9jb252ZXJ0WWNjVG9SZ2IoZGF0YSkgewogICAgbGV0IFksIENiLCBDcjsKCiAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gZGF0YS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkgKz0gMykgewogICAgICBZID0gZGF0YVtpXTsKICAgICAgQ2IgPSBkYXRhW2kgKyAxXTsKICAgICAgQ3IgPSBkYXRhW2kgKyAyXTsKICAgICAgZGF0YVtpXSA9IFkgLSAxNzkuNDU2ICsgMS40MDIgKiBDcjsKICAgICAgZGF0YVtpICsgMV0gPSBZICsgMTM1LjQ1OSAtIDAuMzQ0ICogQ2IgLSAwLjcxNCAqIENyOwogICAgICBkYXRhW2kgKyAyXSA9IFkgLSAyMjYuODE2ICsgMS43NzIgKiBDYjsKICAgIH0KCiAgICByZXR1cm4gZGF0YTsKICB9CgogIF9jb252ZXJ0WWNja1RvUmdiKGRhdGEpIHsKICAgIGxldCBZLCBDYiwgQ3IsIGs7CiAgICBsZXQgb2Zmc2V0ID0gMDsKCiAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gZGF0YS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkgKz0gNCkgewogICAgICBZID0gZGF0YVtpXTsKICAgICAgQ2IgPSBkYXRhW2kgKyAxXTsKICAgICAgQ3IgPSBkYXRhW2kgKyAyXTsKICAgICAgayA9IGRhdGFbaSArIDNdOwogICAgICBkYXRhW29mZnNldCsrXSA9IC0xMjIuNjcxOTU0MDY4OTQgKyBDYiAqICgtNi42MDYzNTY2OTQyMDM2NGUtNSAqIENiICsgMC4wMDA0MzcxMzA0NzU5MjYyMzIgKiBDciAtIDUuNDA4MDYxMDA2NDU5OWUtNSAqIFkgKyAwLjAwMDQ4NDQ5Nzk3MTIwMjgxICogayAtIDAuMTU0MzYyMTUxODcxMTI2KSArIENyICogKC0wLjAwMDk1Nzk2NDM3ODQ0NTc3MyAqIENyICsgMC4wMDA4MTcwNzY5MTEzNDY2MjUgKiBZIC0gMC4wMDQ3NzI3MTQwNTQwODc0NyAqIGsgKyAxLjUzMzgwMjUzMjIxNzM0KSArIFkgKiAoMC4wMDA5NjEyNTAxODQxMzA2ODggKiBZIC0gMC4wMDI2NjI1NzMzMjI4MzkzMyAqIGsgKyAwLjQ4MzU3MDg4NDUxMjY1KSArIGsgKiAoLTAuMDAwMzM2MTk3MTc3NjE4Mzk0ICogayArIDAuNDg0NzkxNTYxNDkwNzc2KTsKICAgICAgZGF0YVtvZmZzZXQrK10gPSAxMDcuMjY4MDM5Mzk3NzI0ICsgQ2IgKiAoMi4xOTkyNzEwNDUyNTc0MWUtNSAqIENiIC0gMC4wMDA2NDA5OTIwMTgyOTc5NDUgKiBDciArIDAuMDAwNjU5Mzk3MDAxMjQ1NTc3ICogWSArIDAuMDAwNDI2MTA1NjUyOTM4ODM3ICogayAtIDAuMTc2NDkxNzkyNDYyODc1KSArIENyICogKC0wLjAwMDc3ODI2OTk0MTUxMzY4MyAqIENyICsgMC4wMDEzMDg3MjI2MTQwODI3NSAqIFkgKyAwLjAwMDc3MDQ4MjYzMTgwMTEzMiAqIGsgLSAwLjE1MTA1MTQ5Mjc3NTU2MikgKyBZICogKDAuMDAxMjY5MzUzNjgxMTQ4NDMgKiBZIC0gMC4wMDI2NTA5MDE4OTAxMDg5OCAqIGsgKyAwLjI1ODAyOTEwMjA2ODQ1KSArIGsgKiAoLTAuMDAwMzE4OTEzMTE3NTg4MzI4ICogayAtIDAuMjEzNzQyNDAwMzIzNjY1KTsKICAgICAgZGF0YVtvZmZzZXQrK10gPSAtMjAuODEwMDEyNTQ2OTQ3ICsgQ2IgKiAoLTAuMDAwNTcwMTE1MTk2OTczNjc3ICogQ2IgLSAyLjYzNDA5MDUxMDA0NTg5ZS01ICogQ3IgKyAwLjAwMjA3NDEwODgxMTUwMTIgKiBZIC0gMC4wMDI4ODI2MDIzNjg1MzQ0MiAqIGsgKyAwLjgxNDI3Mjk2ODM1OTI5NSkgKyBDciAqICgtMS41MzQ5NjA1NzQ0MDk3NWUtNSAqIENyIC0gMC4wMDAxMzI2ODkwNDM5NjE0NDYgKiBZICsgMC4wMDA1NjA4MzM2OTEyNDI4MTIgKiBrIC0gMC4xOTUxNTIwMjc1MzQwNDkpICsgWSAqICgwLjAwMTc0NDE4MTMyOTI3NTgyICogWSAtIDAuMDAyNTUyNDMzMjE0MzkzNDcgKiBrICsgMC4xMTY5MzUwMjA0NjUxNDUpICsgayAqICgtMC4wMDAzNDM1MzE5OTY1MTA1NTUgKiBrICsgMC4yNDE2NTI2MDIzMjQwNyk7CiAgICB9CgogICAgcmV0dXJuIGRhdGEuc3ViYXJyYXkoMCwgb2Zmc2V0KTsKICB9CgogIF9jb252ZXJ0WWNja1RvQ215ayhkYXRhKSB7CiAgICBsZXQgWSwgQ2IsIENyOwoKICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBkYXRhLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSArPSA0KSB7CiAgICAgIFkgPSBkYXRhW2ldOwogICAgICBDYiA9IGRhdGFbaSArIDFdOwogICAgICBDciA9IGRhdGFbaSArIDJdOwogICAgICBkYXRhW2ldID0gNDM0LjQ1NiAtIFkgLSAxLjQwMiAqIENyOwogICAgICBkYXRhW2kgKyAxXSA9IDExOS41NDEgLSBZICsgMC4zNDQgKiBDYiArIDAuNzE0ICogQ3I7CiAgICAgIGRhdGFbaSArIDJdID0gNDgxLjgxNiAtIFkgLSAxLjc3MiAqIENiOwogICAgfQoKICAgIHJldHVybiBkYXRhOwogIH0KCiAgX2NvbnZlcnRDbXlrVG9SZ2IoZGF0YSkgewogICAgbGV0IGMsIG0sIHksIGs7CiAgICBsZXQgb2Zmc2V0ID0gMDsKCiAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gZGF0YS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkgKz0gNCkgewogICAgICBjID0gZGF0YVtpXTsKICAgICAgbSA9IGRhdGFbaSArIDFdOwogICAgICB5ID0gZGF0YVtpICsgMl07CiAgICAgIGsgPSBkYXRhW2kgKyAzXTsKICAgICAgZGF0YVtvZmZzZXQrK10gPSAyNTUgKyBjICogKC0wLjAwMDA2NzQ3MTQ3MDczNjAyNDQxICogYyArIDAuMDAwODM3OTI2MjEyMTAxMzcyNyAqIG0gKyAwLjAwMDI4OTQ3MTgxODg2NDMyOTQgKiB5ICsgMC4wMDMyNjQyMzEwNTc1Mzc4MDYgKiBrIC0gMS4xMTg1NjExODY3MjAzOTM3KSArIG0gKiAoMC4wMDAwMjYzNzQxMDc2MTYwODk0MDUgKiBtIC0gMC4wMDAwODYyNjk0OTE1ODYzODU3MiAqIHkgLSAwLjAwMDI3NDg3NjkwNjc0OTk0OTEgKiBrIC0gMC4wMjE1NTY4ODc5NDk3ODk2NykgKyB5ICogKC0wLjAwMDAzODc4MDk5MjEyODY5MzYzICogeSAtIDAuMDAwMzI2NzgwODI3OTQ4NTI4NiAqIGsgKyAwLjA2ODY3NDIyMzg1OTUzNDUpIC0gayAqICgwLjAwMDMzNjE5NzE3NzYxODM5MzcgKiBrICsgMC43NDMwNjU5MTUxMzQyMjU0KTsKICAgICAgZGF0YVtvZmZzZXQrK10gPSAyNTUgKyBjICogKDAuMDAwMTM1OTYzNzI4MTM1ODg4NDggKiBjICsgMC4wMDA5MjQ1MzcxMzI1NzM1ODUgKiBtICsgMC4wMDAxMDU2NzM1OTYxODY4MzU5MyAqIHkgKyAwLjAwMDQ3OTE4NjQ2ODc0MzY1MTIgKiBrIC0gMC4zMTA5Njg5NTg3NTE1ODc1KSArIG0gKiAoLTAuMDAwMjM1NDUzNDYxMDgzNzAzNDQgKiBtICsgMC4wMDAyNzAyODQ1MjUzNTM0NzE0ICogeSArIDAuMDAyMDIwMDMwODk3NzMwNzE1NiAqIGsgLSAwLjc0ODgwNTIxNjcwMTU0OTQpICsgeSAqICgwLjAwMDA2ODM0ODE1OTk4MjM1NjYyICogeSArIDAuMDAwMTUxNjg0NTIzNjM0NjA5NzMgKiBrIC0gMC4wOTc1MTkyNzc3NDcyODkzMykgLSBrICogKDAuMDAwMzE4OTEzMTE3NTg4MzI4MSAqIGsgKyAwLjczNjQ4ODM4MDc3MzMxNjgpOwogICAgICBkYXRhW29mZnNldCsrXSA9IDI1NSArIGMgKiAoMC4wMDAwMTM1OTg2NTA0MTEzODUzMDcgKiBjICsgMC4wMDAxMjQyMzk1NjE3NTQ5MDg1MSAqIG0gKyAwLjAwMDQ3NTE5ODUwOTc1ODM1ODkgKiB5IC0gMC4wMDAwMDM2NzI5MzE3NDc2NjMwNDIyICogayAtIDAuMDU1NjIxODY5ODAyNjQwMzQpICsgbSAqICgwLjAwMDE2MTQxMzgwNTk4NzI0Njc2ICogbSArIDAuMDAwOTY5MjIzOTEzMDcyNTE4NiAqIHkgKyAwLjAwMDc3ODI2OTI0NTAwMzYyNTMgKiBrIC0gMC40NDAxNTIzMjM2NzUyNjQ2MykgKyB5ICogKDUuMDY4ODgyOTE0MDY4NzY5ZS03ICogeSArIDAuMDAxNzc3ODM2OTAxMTM3NTA3MSAqIGsgLSAwLjc1OTE0NTQ2NDk3NDk2MDkpIC0gayAqICgwLjAwMDM0MzUzMTk5NjUxMDU1NTMgKiBrICsgMC43MDYzNzcwMTg2MTYwMTQ0KTsKICAgIH0KCiAgICByZXR1cm4gZGF0YS5zdWJhcnJheSgwLCBvZmZzZXQpOwogIH0KCiAgZ2V0RGF0YShfcmVmKSB7CiAgICBsZXQgewogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICBmb3JjZVJHQiA9IGZhbHNlLAogICAgICBpc1NvdXJjZVBERiA9IGZhbHNlCiAgICB9ID0gX3JlZjsKCiAgICBpZiAodGhpcy5udW1Db21wb25lbnRzID4gNCkgewogICAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJVbnN1cHBvcnRlZCBjb2xvciBtb2RlIik7CiAgICB9CgogICAgY29uc3QgZGF0YSA9IHRoaXMuX2dldExpbmVhcml6ZWRCbG9ja0RhdGEod2lkdGgsIGhlaWdodCwgaXNTb3VyY2VQREYpOwoKICAgIGlmICh0aGlzLm51bUNvbXBvbmVudHMgPT09IDEgJiYgZm9yY2VSR0IpIHsKICAgICAgY29uc3QgZGF0YUxlbmd0aCA9IGRhdGEubGVuZ3RoOwogICAgICBjb25zdCByZ2JEYXRhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGRhdGFMZW5ndGggKiAzKTsKICAgICAgbGV0IG9mZnNldCA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGFMZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGdyYXlDb2xvciA9IGRhdGFbaV07CiAgICAgICAgcmdiRGF0YVtvZmZzZXQrK10gPSBncmF5Q29sb3I7CiAgICAgICAgcmdiRGF0YVtvZmZzZXQrK10gPSBncmF5Q29sb3I7CiAgICAgICAgcmdiRGF0YVtvZmZzZXQrK10gPSBncmF5Q29sb3I7CiAgICAgIH0KCiAgICAgIHJldHVybiByZ2JEYXRhOwogICAgfSBlbHNlIGlmICh0aGlzLm51bUNvbXBvbmVudHMgPT09IDMgJiYgdGhpcy5faXNDb2xvckNvbnZlcnNpb25OZWVkZWQpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NvbnZlcnRZY2NUb1JnYihkYXRhKTsKICAgIH0gZWxzZSBpZiAodGhpcy5udW1Db21wb25lbnRzID09PSA0KSB7CiAgICAgIGlmICh0aGlzLl9pc0NvbG9yQ29udmVyc2lvbk5lZWRlZCkgewogICAgICAgIGlmIChmb3JjZVJHQikgewogICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnZlcnRZY2NrVG9SZ2IoZGF0YSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpcy5fY29udmVydFljY2tUb0NteWsoZGF0YSk7CiAgICAgIH0gZWxzZSBpZiAoZm9yY2VSR0IpIHsKICAgICAgICByZXR1cm4gdGhpcy5fY29udmVydENteWtUb1JnYihkYXRhKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBkYXRhOwogIH0KCn0KCmV4cG9ydHMuSnBlZ0ltYWdlID0gSnBlZ0ltYWdlOwoKLyoqKi8gfSksCi8qIDE1NCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuSnB4U3RyZWFtID0gdm9pZCAwOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDQpOwoKdmFyIF9qcHggPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE1NSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY2xhc3MgSnB4U3RyZWFtIGV4dGVuZHMgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHJlYW0sIG1heWJlTGVuZ3RoLCBwYXJhbXMpIHsKICAgIHN1cGVyKG1heWJlTGVuZ3RoKTsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5kaWN0ID0gc3RyZWFtLmRpY3Q7CiAgICB0aGlzLm1heWJlTGVuZ3RoID0gbWF5YmVMZW5ndGg7CiAgICB0aGlzLnBhcmFtcyA9IHBhcmFtczsKICB9CgogIGdldCBieXRlcygpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYnl0ZXMiLCB0aGlzLnN0cmVhbS5nZXRCeXRlcyh0aGlzLm1heWJlTGVuZ3RoKSk7CiAgfQoKICBlbnN1cmVCdWZmZXIocmVxdWVzdGVkKSB7fQoKICByZWFkQmxvY2soKSB7CiAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGpweEltYWdlID0gbmV3IF9qcHguSnB4SW1hZ2UoKTsKICAgIGpweEltYWdlLnBhcnNlKHRoaXMuYnl0ZXMpOwogICAgY29uc3Qgd2lkdGggPSBqcHhJbWFnZS53aWR0aDsKICAgIGNvbnN0IGhlaWdodCA9IGpweEltYWdlLmhlaWdodDsKICAgIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IGpweEltYWdlLmNvbXBvbmVudHNDb3VudDsKICAgIGNvbnN0IHRpbGVDb3VudCA9IGpweEltYWdlLnRpbGVzLmxlbmd0aDsKCiAgICBpZiAodGlsZUNvdW50ID09PSAxKSB7CiAgICAgIHRoaXMuYnVmZmVyID0ganB4SW1hZ2UudGlsZXNbMF0uaXRlbXM7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBkYXRhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHdpZHRoICogaGVpZ2h0ICogY29tcG9uZW50c0NvdW50KTsKCiAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgdGlsZUNvdW50OyBrKyspIHsKICAgICAgICBjb25zdCB0aWxlQ29tcG9uZW50cyA9IGpweEltYWdlLnRpbGVzW2tdOwogICAgICAgIGNvbnN0IHRpbGVXaWR0aCA9IHRpbGVDb21wb25lbnRzLndpZHRoOwogICAgICAgIGNvbnN0IHRpbGVIZWlnaHQgPSB0aWxlQ29tcG9uZW50cy5oZWlnaHQ7CiAgICAgICAgY29uc3QgdGlsZUxlZnQgPSB0aWxlQ29tcG9uZW50cy5sZWZ0OwogICAgICAgIGNvbnN0IHRpbGVUb3AgPSB0aWxlQ29tcG9uZW50cy50b3A7CiAgICAgICAgY29uc3Qgc3JjID0gdGlsZUNvbXBvbmVudHMuaXRlbXM7CiAgICAgICAgbGV0IHNyY1Bvc2l0aW9uID0gMDsKICAgICAgICBsZXQgZGF0YVBvc2l0aW9uID0gKHdpZHRoICogdGlsZVRvcCArIHRpbGVMZWZ0KSAqIGNvbXBvbmVudHNDb3VudDsKICAgICAgICBjb25zdCBpbWdSb3dTaXplID0gd2lkdGggKiBjb21wb25lbnRzQ291bnQ7CiAgICAgICAgY29uc3QgdGlsZVJvd1NpemUgPSB0aWxlV2lkdGggKiBjb21wb25lbnRzQ291bnQ7CgogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGlsZUhlaWdodDsgaisrKSB7CiAgICAgICAgICBjb25zdCByb3dCeXRlcyA9IHNyYy5zdWJhcnJheShzcmNQb3NpdGlvbiwgc3JjUG9zaXRpb24gKyB0aWxlUm93U2l6ZSk7CiAgICAgICAgICBkYXRhLnNldChyb3dCeXRlcywgZGF0YVBvc2l0aW9uKTsKICAgICAgICAgIHNyY1Bvc2l0aW9uICs9IHRpbGVSb3dTaXplOwogICAgICAgICAgZGF0YVBvc2l0aW9uICs9IGltZ1Jvd1NpemU7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJ1ZmZlciA9IGRhdGE7CiAgICB9CgogICAgdGhpcy5idWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlci5sZW5ndGg7CiAgICB0aGlzLmVvZiA9IHRydWU7CiAgfQoKfQoKZXhwb3J0cy5KcHhTdHJlYW0gPSBKcHhTdHJlYW07CgovKioqLyB9KSwKLyogMTU1ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5KcHhJbWFnZSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX2FyaXRobWV0aWNfZGVjb2RlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTUxKTsKCmNsYXNzIEpweEVycm9yIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihgSlBYIGVycm9yOiAke21zZ31gLCAiSnB4RXJyb3IiKTsKICB9Cgp9Cgpjb25zdCBTdWJiYW5kc0dhaW5Mb2cyID0gewogIExMOiAwLAogIExIOiAxLAogIEhMOiAxLAogIEhIOiAyCn07CgpjbGFzcyBKcHhJbWFnZSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLmZhaWxPbkNvcnJ1cHRlZEltYWdlID0gZmFsc2U7CiAgfQoKICBwYXJzZShkYXRhKSB7CiAgICBjb25zdCBoZWFkID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIDApOwoKICAgIGlmIChoZWFkID09PSAweGZmNGYpIHsKICAgICAgdGhpcy5wYXJzZUNvZGVzdHJlYW0oZGF0YSwgMCwgZGF0YS5sZW5ndGgpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgbGVuZ3RoID0gZGF0YS5sZW5ndGg7CiAgICBsZXQgcG9zaXRpb24gPSAwOwoKICAgIHdoaWxlIChwb3NpdGlvbiA8IGxlbmd0aCkgewogICAgICBsZXQgaGVhZGVyU2l6ZSA9IDg7CiAgICAgIGxldCBsYm94ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgY29uc3QgdGJveCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDQpOwogICAgICBwb3NpdGlvbiArPSBoZWFkZXJTaXplOwoKICAgICAgaWYgKGxib3ggPT09IDEpIHsKICAgICAgICBsYm94ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKSAqIDQyOTQ5NjcyOTYgKyAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyA0KTsKICAgICAgICBwb3NpdGlvbiArPSA4OwogICAgICAgIGhlYWRlclNpemUgKz0gODsKICAgICAgfQoKICAgICAgaWYgKGxib3ggPT09IDApIHsKICAgICAgICBsYm94ID0gbGVuZ3RoIC0gcG9zaXRpb24gKyBoZWFkZXJTaXplOwogICAgICB9CgogICAgICBpZiAobGJveCA8IGhlYWRlclNpemUpIHsKICAgICAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIkludmFsaWQgYm94IGZpZWxkIHNpemUiKTsKICAgICAgfQoKICAgICAgY29uc3QgZGF0YUxlbmd0aCA9IGxib3ggLSBoZWFkZXJTaXplOwogICAgICBsZXQganVtcERhdGFMZW5ndGggPSB0cnVlOwoKICAgICAgc3dpdGNoICh0Ym94KSB7CiAgICAgICAgY2FzZSAweDZhNzAzMjY4OgogICAgICAgICAganVtcERhdGFMZW5ndGggPSBmYWxzZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4NjM2ZjZjNzI6CiAgICAgICAgICBjb25zdCBtZXRob2QgPSBkYXRhW3Bvc2l0aW9uXTsKCiAgICAgICAgICBpZiAobWV0aG9kID09PSAxKSB7CiAgICAgICAgICAgIGNvbnN0IGNvbG9yc3BhY2UgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyAzKTsKCiAgICAgICAgICAgIHN3aXRjaCAoY29sb3JzcGFjZSkgewogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVua25vd24gY29sb3JzcGFjZSAiICsgY29sb3JzcGFjZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IDIpIHsKICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJJQ0MgcHJvZmlsZSBub3Qgc3VwcG9ydGVkIik7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHg2YTcwMzI2MzoKICAgICAgICAgIHRoaXMucGFyc2VDb2Rlc3RyZWFtKGRhdGEsIHBvc2l0aW9uLCBwb3NpdGlvbiArIGRhdGFMZW5ndGgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHg2YTUwMjAyMDoKICAgICAgICAgIGlmICgoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24pICE9PSAweDBkMGE4NzBhKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSW52YWxpZCBKUDIgc2lnbmF0dXJlIik7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHg2YTUwMWExYToKICAgICAgICBjYXNlIDB4NjY3NDc5NzA6CiAgICAgICAgY2FzZSAweDcyNzI2NTcxOgogICAgICAgIGNhc2UgMHg3MjY1NzMyMDoKICAgICAgICBjYXNlIDB4Njk2ODY0NzI6CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGNvbnN0IGhlYWRlclR5cGUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHRib3ggPj4gMjQgJiAweGZmLCB0Ym94ID4+IDE2ICYgMHhmZiwgdGJveCA+PiA4ICYgMHhmZiwgdGJveCAmIDB4ZmYpOwogICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBVbnN1cHBvcnRlZCBoZWFkZXIgdHlwZSAke3Rib3h9ICgke2hlYWRlclR5cGV9KS5gKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAoanVtcERhdGFMZW5ndGgpIHsKICAgICAgICBwb3NpdGlvbiArPSBkYXRhTGVuZ3RoOwogICAgICB9CiAgICB9CiAgfQoKICBwYXJzZUltYWdlUHJvcGVydGllcyhzdHJlYW0pIHsKICAgIGxldCBuZXdCeXRlID0gc3RyZWFtLmdldEJ5dGUoKTsKCiAgICB3aGlsZSAobmV3Qnl0ZSA+PSAwKSB7CiAgICAgIGNvbnN0IG9sZEJ5dGUgPSBuZXdCeXRlOwogICAgICBuZXdCeXRlID0gc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgY29uc3QgY29kZSA9IG9sZEJ5dGUgPDwgOCB8IG5ld0J5dGU7CgogICAgICBpZiAoY29kZSA9PT0gMHhmZjUxKSB7CiAgICAgICAgc3RyZWFtLnNraXAoNCk7CiAgICAgICAgY29uc3QgWHNpeiA9IHN0cmVhbS5nZXRJbnQzMigpID4+PiAwOwogICAgICAgIGNvbnN0IFlzaXogPSBzdHJlYW0uZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgICBjb25zdCBYT3NpeiA9IHN0cmVhbS5nZXRJbnQzMigpID4+PiAwOwogICAgICAgIGNvbnN0IFlPc2l6ID0gc3RyZWFtLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgc3RyZWFtLnNraXAoMTYpOwogICAgICAgIGNvbnN0IENzaXogPSBzdHJlYW0uZ2V0VWludDE2KCk7CiAgICAgICAgdGhpcy53aWR0aCA9IFhzaXogLSBYT3NpejsKICAgICAgICB0aGlzLmhlaWdodCA9IFlzaXogLSBZT3NpejsKICAgICAgICB0aGlzLmNvbXBvbmVudHNDb3VudCA9IENzaXo7CiAgICAgICAgdGhpcy5iaXRzUGVyQ29tcG9uZW50ID0gODsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KCiAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIk5vIHNpemUgbWFya2VyIGZvdW5kIGluIEpQWCBzdHJlYW0iKTsKICB9CgogIHBhcnNlQ29kZXN0cmVhbShkYXRhLCBzdGFydCwgZW5kKSB7CiAgICBjb25zdCBjb250ZXh0ID0ge307CiAgICBsZXQgZG9Ob3RSZWNvdmVyID0gZmFsc2U7CgogICAgdHJ5IHsKICAgICAgbGV0IHBvc2l0aW9uID0gc3RhcnQ7CgogICAgICB3aGlsZSAocG9zaXRpb24gKyAxIDwgZW5kKSB7CiAgICAgICAgY29uc3QgY29kZSA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb24gKz0gMjsKICAgICAgICBsZXQgbGVuZ3RoID0gMCwKICAgICAgICAgICAgaiwKICAgICAgICAgICAgc3FjZCwKICAgICAgICAgICAgc3BxY2RzLAogICAgICAgICAgICBzcHFjZFNpemUsCiAgICAgICAgICAgIHNjYWxhckV4cG91bmRlZCwKICAgICAgICAgICAgdGlsZTsKCiAgICAgICAgc3dpdGNoIChjb2RlKSB7CiAgICAgICAgICBjYXNlIDB4ZmY0ZjoKICAgICAgICAgICAgY29udGV4dC5tYWluSGVhZGVyID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGZmZDk6CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHhmZjUxOgogICAgICAgICAgICBsZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICAgICAgICBjb25zdCBzaXogPSB7fTsKICAgICAgICAgICAgc2l6LlhzaXogPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyA0KTsKICAgICAgICAgICAgc2l6LllzaXogPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyA4KTsKICAgICAgICAgICAgc2l6LlhPc2l6ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMTIpOwogICAgICAgICAgICBzaXouWU9zaXogPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyAxNik7CiAgICAgICAgICAgIHNpei5YVHNpeiA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDIwKTsKICAgICAgICAgICAgc2l6LllUc2l6ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMjQpOwogICAgICAgICAgICBzaXouWFRPc2l6ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMjgpOwogICAgICAgICAgICBzaXouWVRPc2l6ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMzIpOwogICAgICAgICAgICBjb25zdCBjb21wb25lbnRzQ291bnQgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24gKyAzNik7CiAgICAgICAgICAgIHNpei5Dc2l6ID0gY29tcG9uZW50c0NvdW50OwogICAgICAgICAgICBjb25zdCBjb21wb25lbnRzID0gW107CiAgICAgICAgICAgIGogPSBwb3NpdGlvbiArIDM4OwoKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb21wb25lbnRzQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHsKICAgICAgICAgICAgICAgIHByZWNpc2lvbjogKGRhdGFbal0gJiAweDdmKSArIDEsCiAgICAgICAgICAgICAgICBpc1NpZ25lZDogISEoZGF0YVtqXSAmIDB4ODApLAogICAgICAgICAgICAgICAgWFJzaXo6IGRhdGFbaiArIDFdLAogICAgICAgICAgICAgICAgWVJzaXo6IGRhdGFbaiArIDJdCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBqICs9IDM7CiAgICAgICAgICAgICAgY2FsY3VsYXRlQ29tcG9uZW50RGltZW5zaW9ucyhjb21wb25lbnQsIHNpeik7CiAgICAgICAgICAgICAgY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnRleHQuU0laID0gc2l6OwogICAgICAgICAgICBjb250ZXh0LmNvbXBvbmVudHMgPSBjb21wb25lbnRzOwogICAgICAgICAgICBjYWxjdWxhdGVUaWxlR3JpZHMoY29udGV4dCwgY29tcG9uZW50cyk7CiAgICAgICAgICAgIGNvbnRleHQuUUNDID0gW107CiAgICAgICAgICAgIGNvbnRleHQuQ09DID0gW107CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHhmZjVjOgogICAgICAgICAgICBsZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICAgICAgICBjb25zdCBxY2QgPSB7fTsKICAgICAgICAgICAgaiA9IHBvc2l0aW9uICsgMjsKICAgICAgICAgICAgc3FjZCA9IGRhdGFbaisrXTsKCiAgICAgICAgICAgIHN3aXRjaCAoc3FjZCAmIDB4MWYpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBzcHFjZFNpemUgPSA4OwogICAgICAgICAgICAgICAgc2NhbGFyRXhwb3VuZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICBzcHFjZFNpemUgPSAxNjsKICAgICAgICAgICAgICAgIHNjYWxhckV4cG91bmRlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHNwcWNkU2l6ZSA9IDE2OwogICAgICAgICAgICAgICAgc2NhbGFyRXhwb3VuZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIFNRY2QgdmFsdWUgIiArIHNxY2QpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBxY2Qubm9RdWFudGl6YXRpb24gPSBzcHFjZFNpemUgPT09IDg7CiAgICAgICAgICAgIHFjZC5zY2FsYXJFeHBvdW5kZWQgPSBzY2FsYXJFeHBvdW5kZWQ7CiAgICAgICAgICAgIHFjZC5ndWFyZEJpdHMgPSBzcWNkID4+IDU7CiAgICAgICAgICAgIHNwcWNkcyA9IFtdOwoKICAgICAgICAgICAgd2hpbGUgKGogPCBsZW5ndGggKyBwb3NpdGlvbikgewogICAgICAgICAgICAgIGNvbnN0IHNwcWNkID0ge307CgogICAgICAgICAgICAgIGlmIChzcHFjZFNpemUgPT09IDgpIHsKICAgICAgICAgICAgICAgIHNwcWNkLmVwc2lsb24gPSBkYXRhW2orK10gPj4gMzsKICAgICAgICAgICAgICAgIHNwcWNkLm11ID0gMDsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3BxY2QuZXBzaWxvbiA9IGRhdGFbal0gPj4gMzsKICAgICAgICAgICAgICAgIHNwcWNkLm11ID0gKGRhdGFbal0gJiAweDcpIDw8IDggfCBkYXRhW2ogKyAxXTsKICAgICAgICAgICAgICAgIGogKz0gMjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNwcWNkcy5wdXNoKHNwcWNkKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcWNkLlNQcWNkcyA9IHNwcWNkczsKCiAgICAgICAgICAgIGlmIChjb250ZXh0Lm1haW5IZWFkZXIpIHsKICAgICAgICAgICAgICBjb250ZXh0LlFDRCA9IHFjZDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUaWxlLlFDRCA9IHFjZDsKICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUaWxlLlFDQyA9IFtdOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4ZmY1ZDoKICAgICAgICAgICAgbGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICAgICAgY29uc3QgcWNjID0ge307CiAgICAgICAgICAgIGogPSBwb3NpdGlvbiArIDI7CiAgICAgICAgICAgIGxldCBjcWNjOwoKICAgICAgICAgICAgaWYgKGNvbnRleHQuU0laLkNzaXogPCAyNTcpIHsKICAgICAgICAgICAgICBjcWNjID0gZGF0YVtqKytdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNxY2MgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgaik7CiAgICAgICAgICAgICAgaiArPSAyOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzcWNkID0gZGF0YVtqKytdOwoKICAgICAgICAgICAgc3dpdGNoIChzcWNkICYgMHgxZikgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHNwcWNkU2l6ZSA9IDg7CiAgICAgICAgICAgICAgICBzY2FsYXJFeHBvdW5kZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIHNwcWNkU2l6ZSA9IDE2OwogICAgICAgICAgICAgICAgc2NhbGFyRXhwb3VuZGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgc3BxY2RTaXplID0gMTY7CiAgICAgICAgICAgICAgICBzY2FsYXJFeHBvdW5kZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgU1FjZCB2YWx1ZSAiICsgc3FjZCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHFjYy5ub1F1YW50aXphdGlvbiA9IHNwcWNkU2l6ZSA9PT0gODsKICAgICAgICAgICAgcWNjLnNjYWxhckV4cG91bmRlZCA9IHNjYWxhckV4cG91bmRlZDsKICAgICAgICAgICAgcWNjLmd1YXJkQml0cyA9IHNxY2QgPj4gNTsKICAgICAgICAgICAgc3BxY2RzID0gW107CgogICAgICAgICAgICB3aGlsZSAoaiA8IGxlbmd0aCArIHBvc2l0aW9uKSB7CiAgICAgICAgICAgICAgY29uc3Qgc3BxY2QgPSB7fTsKCiAgICAgICAgICAgICAgaWYgKHNwcWNkU2l6ZSA9PT0gOCkgewogICAgICAgICAgICAgICAgc3BxY2QuZXBzaWxvbiA9IGRhdGFbaisrXSA+PiAzOwogICAgICAgICAgICAgICAgc3BxY2QubXUgPSAwOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzcHFjZC5lcHNpbG9uID0gZGF0YVtqXSA+PiAzOwogICAgICAgICAgICAgICAgc3BxY2QubXUgPSAoZGF0YVtqXSAmIDB4NykgPDwgOCB8IGRhdGFbaiArIDFdOwogICAgICAgICAgICAgICAgaiArPSAyOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc3BxY2RzLnB1c2goc3BxY2QpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBxY2MuU1BxY2RzID0gc3BxY2RzOwoKICAgICAgICAgICAgaWYgKGNvbnRleHQubWFpbkhlYWRlcikgewogICAgICAgICAgICAgIGNvbnRleHQuUUNDW2NxY2NdID0gcWNjOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnRleHQuY3VycmVudFRpbGUuUUNDW2NxY2NdID0gcWNjOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4ZmY1MjoKICAgICAgICAgICAgbGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICAgICAgY29uc3QgY29kID0ge307CiAgICAgICAgICAgIGogPSBwb3NpdGlvbiArIDI7CiAgICAgICAgICAgIGNvbnN0IHNjb2QgPSBkYXRhW2orK107CiAgICAgICAgICAgIGNvZC5lbnRyb3B5Q29kZXJXaXRoQ3VzdG9tUHJlY2luY3RzID0gISEoc2NvZCAmIDEpOwogICAgICAgICAgICBjb2Quc29wTWFya2VyVXNlZCA9ICEhKHNjb2QgJiAyKTsKICAgICAgICAgICAgY29kLmVwaE1hcmtlclVzZWQgPSAhIShzY29kICYgNCk7CiAgICAgICAgICAgIGNvZC5wcm9ncmVzc2lvbk9yZGVyID0gZGF0YVtqKytdOwogICAgICAgICAgICBjb2QubGF5ZXJzQ291bnQgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgaik7CiAgICAgICAgICAgIGogKz0gMjsKICAgICAgICAgICAgY29kLm11bHRpcGxlQ29tcG9uZW50VHJhbnNmb3JtID0gZGF0YVtqKytdOwogICAgICAgICAgICBjb2QuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gZGF0YVtqKytdOwogICAgICAgICAgICBjb2QueGNiID0gKGRhdGFbaisrXSAmIDB4ZikgKyAyOwogICAgICAgICAgICBjb2QueWNiID0gKGRhdGFbaisrXSAmIDB4ZikgKyAyOwogICAgICAgICAgICBjb25zdCBibG9ja1N0eWxlID0gZGF0YVtqKytdOwogICAgICAgICAgICBjb2Quc2VsZWN0aXZlQXJpdGhtZXRpY0NvZGluZ0J5cGFzcyA9ICEhKGJsb2NrU3R5bGUgJiAxKTsKICAgICAgICAgICAgY29kLnJlc2V0Q29udGV4dFByb2JhYmlsaXRpZXMgPSAhIShibG9ja1N0eWxlICYgMik7CiAgICAgICAgICAgIGNvZC50ZXJtaW5hdGlvbk9uRWFjaENvZGluZ1Bhc3MgPSAhIShibG9ja1N0eWxlICYgNCk7CiAgICAgICAgICAgIGNvZC52ZXJ0aWNhbGx5U3RyaXBlID0gISEoYmxvY2tTdHlsZSAmIDgpOwogICAgICAgICAgICBjb2QucHJlZGljdGFibGVUZXJtaW5hdGlvbiA9ICEhKGJsb2NrU3R5bGUgJiAxNik7CiAgICAgICAgICAgIGNvZC5zZWdtZW50YXRpb25TeW1ib2xVc2VkID0gISEoYmxvY2tTdHlsZSAmIDMyKTsKICAgICAgICAgICAgY29kLnJldmVyc2libGVUcmFuc2Zvcm1hdGlvbiA9IGRhdGFbaisrXTsKCiAgICAgICAgICAgIGlmIChjb2QuZW50cm9weUNvZGVyV2l0aEN1c3RvbVByZWNpbmN0cykgewogICAgICAgICAgICAgIGNvbnN0IHByZWNpbmN0c1NpemVzID0gW107CgogICAgICAgICAgICAgIHdoaWxlIChqIDwgbGVuZ3RoICsgcG9zaXRpb24pIHsKICAgICAgICAgICAgICAgIGNvbnN0IHByZWNpbmN0c1NpemUgPSBkYXRhW2orK107CiAgICAgICAgICAgICAgICBwcmVjaW5jdHNTaXplcy5wdXNoKHsKICAgICAgICAgICAgICAgICAgUFB4OiBwcmVjaW5jdHNTaXplICYgMHhmLAogICAgICAgICAgICAgICAgICBQUHk6IHByZWNpbmN0c1NpemUgPj4gNAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb2QucHJlY2luY3RzU2l6ZXMgPSBwcmVjaW5jdHNTaXplczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgdW5zdXBwb3J0ZWQgPSBbXTsKCiAgICAgICAgICAgIGlmIChjb2Quc2VsZWN0aXZlQXJpdGhtZXRpY0NvZGluZ0J5cGFzcykgewogICAgICAgICAgICAgIHVuc3VwcG9ydGVkLnB1c2goInNlbGVjdGl2ZUFyaXRobWV0aWNDb2RpbmdCeXBhc3MiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGNvZC50ZXJtaW5hdGlvbk9uRWFjaENvZGluZ1Bhc3MpIHsKICAgICAgICAgICAgICB1bnN1cHBvcnRlZC5wdXNoKCJ0ZXJtaW5hdGlvbk9uRWFjaENvZGluZ1Bhc3MiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGNvZC52ZXJ0aWNhbGx5U3RyaXBlKSB7CiAgICAgICAgICAgICAgdW5zdXBwb3J0ZWQucHVzaCgidmVydGljYWxseVN0cmlwZSIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY29kLnByZWRpY3RhYmxlVGVybWluYXRpb24pIHsKICAgICAgICAgICAgICB1bnN1cHBvcnRlZC5wdXNoKCJwcmVkaWN0YWJsZVRlcm1pbmF0aW9uIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh1bnN1cHBvcnRlZC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgZG9Ob3RSZWNvdmVyID0gdHJ1ZTsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoYEpQWDogVW5zdXBwb3J0ZWQgQ09EIG9wdGlvbnMgKCR7dW5zdXBwb3J0ZWQuam9pbigiLCAiKX0pLmApOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY29udGV4dC5tYWluSGVhZGVyKSB7CiAgICAgICAgICAgICAgY29udGV4dC5DT0QgPSBjb2Q7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGlsZS5DT0QgPSBjb2Q7CiAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGlsZS5DT0MgPSBbXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGZmOTA6CiAgICAgICAgICAgIGxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgICAgIHRpbGUgPSB7fTsKICAgICAgICAgICAgdGlsZS5pbmRleCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbiArIDIpOwogICAgICAgICAgICB0aWxlLmxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDQpOwogICAgICAgICAgICB0aWxlLmRhdGFFbmQgPSB0aWxlLmxlbmd0aCArIHBvc2l0aW9uIC0gMjsKICAgICAgICAgICAgdGlsZS5wYXJ0SW5kZXggPSBkYXRhW3Bvc2l0aW9uICsgOF07CiAgICAgICAgICAgIHRpbGUucGFydHNDb3VudCA9IGRhdGFbcG9zaXRpb24gKyA5XTsKICAgICAgICAgICAgY29udGV4dC5tYWluSGVhZGVyID0gZmFsc2U7CgogICAgICAgICAgICBpZiAodGlsZS5wYXJ0SW5kZXggPT09IDApIHsKICAgICAgICAgICAgICB0aWxlLkNPRCA9IGNvbnRleHQuQ09EOwogICAgICAgICAgICAgIHRpbGUuQ09DID0gY29udGV4dC5DT0Muc2xpY2UoMCk7CiAgICAgICAgICAgICAgdGlsZS5RQ0QgPSBjb250ZXh0LlFDRDsKICAgICAgICAgICAgICB0aWxlLlFDQyA9IGNvbnRleHQuUUNDLnNsaWNlKDApOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUaWxlID0gdGlsZTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGZmOTM6CiAgICAgICAgICAgIHRpbGUgPSBjb250ZXh0LmN1cnJlbnRUaWxlOwoKICAgICAgICAgICAgaWYgKHRpbGUucGFydEluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgaW5pdGlhbGl6ZVRpbGUoY29udGV4dCwgdGlsZS5pbmRleCk7CiAgICAgICAgICAgICAgYnVpbGRQYWNrZXRzKGNvbnRleHQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsZW5ndGggPSB0aWxlLmRhdGFFbmQgLSBwb3NpdGlvbjsKICAgICAgICAgICAgcGFyc2VUaWxlUGFja2V0cyhjb250ZXh0LCBkYXRhLCBwb3NpdGlvbiwgbGVuZ3RoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGZmNTM6CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSlBYOiBDb2Rlc3RyZWFtIGNvZGUgMHhGRjUzIChDT0MpIGlzIG5vdCBpbXBsZW1lbnRlZC4iKTsKCiAgICAgICAgICBjYXNlIDB4ZmY1NToKICAgICAgICAgIGNhc2UgMHhmZjU3OgogICAgICAgICAgY2FzZSAweGZmNTg6CiAgICAgICAgICBjYXNlIDB4ZmY2NDoKICAgICAgICAgICAgbGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmtub3duIGNvZGVzdHJlYW0gY29kZTogIiArIGNvZGUudG9TdHJpbmcoMTYpKTsKICAgICAgICB9CgogICAgICAgIHBvc2l0aW9uICs9IGxlbmd0aDsKICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICBpZiAoZG9Ob3RSZWNvdmVyIHx8IHRoaXMuZmFpbE9uQ29ycnVwdGVkSW1hZ2UpIHsKICAgICAgICB0aHJvdyBuZXcgSnB4RXJyb3IoZS5tZXNzYWdlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYEpQWDogVHJ5aW5nIHRvIHJlY292ZXIgZnJvbTogIiR7ZS5tZXNzYWdlfSIuYCk7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLnRpbGVzID0gdHJhbnNmb3JtQ29tcG9uZW50cyhjb250ZXh0KTsKICAgIHRoaXMud2lkdGggPSBjb250ZXh0LlNJWi5Yc2l6IC0gY29udGV4dC5TSVouWE9zaXo7CiAgICB0aGlzLmhlaWdodCA9IGNvbnRleHQuU0laLllzaXogLSBjb250ZXh0LlNJWi5ZT3NpejsKICAgIHRoaXMuY29tcG9uZW50c0NvdW50ID0gY29udGV4dC5TSVouQ3NpejsKICB9Cgp9CgpleHBvcnRzLkpweEltYWdlID0gSnB4SW1hZ2U7CgpmdW5jdGlvbiBjYWxjdWxhdGVDb21wb25lbnREaW1lbnNpb25zKGNvbXBvbmVudCwgc2l6KSB7CiAgY29tcG9uZW50LngwID0gTWF0aC5jZWlsKHNpei5YT3NpeiAvIGNvbXBvbmVudC5YUnNpeik7CiAgY29tcG9uZW50LngxID0gTWF0aC5jZWlsKHNpei5Yc2l6IC8gY29tcG9uZW50LlhSc2l6KTsKICBjb21wb25lbnQueTAgPSBNYXRoLmNlaWwoc2l6LllPc2l6IC8gY29tcG9uZW50LllSc2l6KTsKICBjb21wb25lbnQueTEgPSBNYXRoLmNlaWwoc2l6LllzaXogLyBjb21wb25lbnQuWVJzaXopOwogIGNvbXBvbmVudC53aWR0aCA9IGNvbXBvbmVudC54MSAtIGNvbXBvbmVudC54MDsKICBjb21wb25lbnQuaGVpZ2h0ID0gY29tcG9uZW50LnkxIC0gY29tcG9uZW50LnkwOwp9CgpmdW5jdGlvbiBjYWxjdWxhdGVUaWxlR3JpZHMoY29udGV4dCwgY29tcG9uZW50cykgewogIGNvbnN0IHNpeiA9IGNvbnRleHQuU0laOwogIGNvbnN0IHRpbGVzID0gW107CiAgbGV0IHRpbGU7CiAgY29uc3QgbnVtWHRpbGVzID0gTWF0aC5jZWlsKChzaXouWHNpeiAtIHNpei5YVE9zaXopIC8gc2l6LlhUc2l6KTsKICBjb25zdCBudW1ZdGlsZXMgPSBNYXRoLmNlaWwoKHNpei5Zc2l6IC0gc2l6LllUT3NpeikgLyBzaXouWVRzaXopOwoKICBmb3IgKGxldCBxID0gMDsgcSA8IG51bVl0aWxlczsgcSsrKSB7CiAgICBmb3IgKGxldCBwID0gMDsgcCA8IG51bVh0aWxlczsgcCsrKSB7CiAgICAgIHRpbGUgPSB7fTsKICAgICAgdGlsZS50eDAgPSBNYXRoLm1heChzaXouWFRPc2l6ICsgcCAqIHNpei5YVHNpeiwgc2l6LlhPc2l6KTsKICAgICAgdGlsZS50eTAgPSBNYXRoLm1heChzaXouWVRPc2l6ICsgcSAqIHNpei5ZVHNpeiwgc2l6LllPc2l6KTsKICAgICAgdGlsZS50eDEgPSBNYXRoLm1pbihzaXouWFRPc2l6ICsgKHAgKyAxKSAqIHNpei5YVHNpeiwgc2l6LlhzaXopOwogICAgICB0aWxlLnR5MSA9IE1hdGgubWluKHNpei5ZVE9zaXogKyAocSArIDEpICogc2l6LllUc2l6LCBzaXouWXNpeik7CiAgICAgIHRpbGUud2lkdGggPSB0aWxlLnR4MSAtIHRpbGUudHgwOwogICAgICB0aWxlLmhlaWdodCA9IHRpbGUudHkxIC0gdGlsZS50eTA7CiAgICAgIHRpbGUuY29tcG9uZW50cyA9IFtdOwogICAgICB0aWxlcy5wdXNoKHRpbGUpOwogICAgfQogIH0KCiAgY29udGV4dC50aWxlcyA9IHRpbGVzOwogIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwoKICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb21wb25lbnRzQ291bnQ7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjb21wb25lbnQgPSBjb21wb25lbnRzW2ldOwoKICAgIGZvciAobGV0IGogPSAwLCBqaiA9IHRpbGVzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgY29uc3QgdGlsZUNvbXBvbmVudCA9IHt9OwogICAgICB0aWxlID0gdGlsZXNbal07CiAgICAgIHRpbGVDb21wb25lbnQudGN4MCA9IE1hdGguY2VpbCh0aWxlLnR4MCAvIGNvbXBvbmVudC5YUnNpeik7CiAgICAgIHRpbGVDb21wb25lbnQudGN5MCA9IE1hdGguY2VpbCh0aWxlLnR5MCAvIGNvbXBvbmVudC5ZUnNpeik7CiAgICAgIHRpbGVDb21wb25lbnQudGN4MSA9IE1hdGguY2VpbCh0aWxlLnR4MSAvIGNvbXBvbmVudC5YUnNpeik7CiAgICAgIHRpbGVDb21wb25lbnQudGN5MSA9IE1hdGguY2VpbCh0aWxlLnR5MSAvIGNvbXBvbmVudC5ZUnNpeik7CiAgICAgIHRpbGVDb21wb25lbnQud2lkdGggPSB0aWxlQ29tcG9uZW50LnRjeDEgLSB0aWxlQ29tcG9uZW50LnRjeDA7CiAgICAgIHRpbGVDb21wb25lbnQuaGVpZ2h0ID0gdGlsZUNvbXBvbmVudC50Y3kxIC0gdGlsZUNvbXBvbmVudC50Y3kwOwogICAgICB0aWxlLmNvbXBvbmVudHNbaV0gPSB0aWxlQ29tcG9uZW50OwogICAgfQogIH0KfQoKZnVuY3Rpb24gZ2V0QmxvY2tzRGltZW5zaW9ucyhjb250ZXh0LCBjb21wb25lbnQsIHIpIHsKICBjb25zdCBjb2RPckNvYyA9IGNvbXBvbmVudC5jb2RpbmdTdHlsZVBhcmFtZXRlcnM7CiAgY29uc3QgcmVzdWx0ID0ge307CgogIGlmICghY29kT3JDb2MuZW50cm9weUNvZGVyV2l0aEN1c3RvbVByZWNpbmN0cykgewogICAgcmVzdWx0LlBQeCA9IDE1OwogICAgcmVzdWx0LlBQeSA9IDE1OwogIH0gZWxzZSB7CiAgICByZXN1bHQuUFB4ID0gY29kT3JDb2MucHJlY2luY3RzU2l6ZXNbcl0uUFB4OwogICAgcmVzdWx0LlBQeSA9IGNvZE9yQ29jLnByZWNpbmN0c1NpemVzW3JdLlBQeTsKICB9CgogIHJlc3VsdC54Y2JfID0gciA+IDAgPyBNYXRoLm1pbihjb2RPckNvYy54Y2IsIHJlc3VsdC5QUHggLSAxKSA6IE1hdGgubWluKGNvZE9yQ29jLnhjYiwgcmVzdWx0LlBQeCk7CiAgcmVzdWx0LnljYl8gPSByID4gMCA/IE1hdGgubWluKGNvZE9yQ29jLnljYiwgcmVzdWx0LlBQeSAtIDEpIDogTWF0aC5taW4oY29kT3JDb2MueWNiLCByZXN1bHQuUFB5KTsKICByZXR1cm4gcmVzdWx0Owp9CgpmdW5jdGlvbiBidWlsZFByZWNpbmN0cyhjb250ZXh0LCByZXNvbHV0aW9uLCBkaW1lbnNpb25zKSB7CiAgY29uc3QgcHJlY2luY3RXaWR0aCA9IDEgPDwgZGltZW5zaW9ucy5QUHg7CiAgY29uc3QgcHJlY2luY3RIZWlnaHQgPSAxIDw8IGRpbWVuc2lvbnMuUFB5OwogIGNvbnN0IGlzWmVyb1JlcyA9IHJlc29sdXRpb24ucmVzTGV2ZWwgPT09IDA7CiAgY29uc3QgcHJlY2luY3RXaWR0aEluU3ViYmFuZCA9IDEgPDwgZGltZW5zaW9ucy5QUHggKyAoaXNaZXJvUmVzID8gMCA6IC0xKTsKICBjb25zdCBwcmVjaW5jdEhlaWdodEluU3ViYmFuZCA9IDEgPDwgZGltZW5zaW9ucy5QUHkgKyAoaXNaZXJvUmVzID8gMCA6IC0xKTsKICBjb25zdCBudW1wcmVjaW5jdHN3aWRlID0gcmVzb2x1dGlvbi50cngxID4gcmVzb2x1dGlvbi50cngwID8gTWF0aC5jZWlsKHJlc29sdXRpb24udHJ4MSAvIHByZWNpbmN0V2lkdGgpIC0gTWF0aC5mbG9vcihyZXNvbHV0aW9uLnRyeDAgLyBwcmVjaW5jdFdpZHRoKSA6IDA7CiAgY29uc3QgbnVtcHJlY2luY3RzaGlnaCA9IHJlc29sdXRpb24udHJ5MSA+IHJlc29sdXRpb24udHJ5MCA/IE1hdGguY2VpbChyZXNvbHV0aW9uLnRyeTEgLyBwcmVjaW5jdEhlaWdodCkgLSBNYXRoLmZsb29yKHJlc29sdXRpb24udHJ5MCAvIHByZWNpbmN0SGVpZ2h0KSA6IDA7CiAgY29uc3QgbnVtcHJlY2luY3RzID0gbnVtcHJlY2luY3Rzd2lkZSAqIG51bXByZWNpbmN0c2hpZ2g7CiAgcmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnMgPSB7CiAgICBwcmVjaW5jdFdpZHRoLAogICAgcHJlY2luY3RIZWlnaHQsCiAgICBudW1wcmVjaW5jdHN3aWRlLAogICAgbnVtcHJlY2luY3RzaGlnaCwKICAgIG51bXByZWNpbmN0cywKICAgIHByZWNpbmN0V2lkdGhJblN1YmJhbmQsCiAgICBwcmVjaW5jdEhlaWdodEluU3ViYmFuZAogIH07Cn0KCmZ1bmN0aW9uIGJ1aWxkQ29kZWJsb2Nrcyhjb250ZXh0LCBzdWJiYW5kLCBkaW1lbnNpb25zKSB7CiAgY29uc3QgeGNiXyA9IGRpbWVuc2lvbnMueGNiXzsKICBjb25zdCB5Y2JfID0gZGltZW5zaW9ucy55Y2JfOwogIGNvbnN0IGNvZGVibG9ja1dpZHRoID0gMSA8PCB4Y2JfOwogIGNvbnN0IGNvZGVibG9ja0hlaWdodCA9IDEgPDwgeWNiXzsKICBjb25zdCBjYngwID0gc3ViYmFuZC50YngwID4+IHhjYl87CiAgY29uc3QgY2J5MCA9IHN1YmJhbmQudGJ5MCA+PiB5Y2JfOwogIGNvbnN0IGNieDEgPSBzdWJiYW5kLnRieDEgKyBjb2RlYmxvY2tXaWR0aCAtIDEgPj4geGNiXzsKICBjb25zdCBjYnkxID0gc3ViYmFuZC50YnkxICsgY29kZWJsb2NrSGVpZ2h0IC0gMSA+PiB5Y2JfOwogIGNvbnN0IHByZWNpbmN0UGFyYW1ldGVycyA9IHN1YmJhbmQucmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnM7CiAgY29uc3QgY29kZWJsb2NrcyA9IFtdOwogIGNvbnN0IHByZWNpbmN0cyA9IFtdOwogIGxldCBpLCBqLCBjb2RlYmxvY2ssIHByZWNpbmN0TnVtYmVyOwoKICBmb3IgKGogPSBjYnkwOyBqIDwgY2J5MTsgaisrKSB7CiAgICBmb3IgKGkgPSBjYngwOyBpIDwgY2J4MTsgaSsrKSB7CiAgICAgIGNvZGVibG9jayA9IHsKICAgICAgICBjYng6IGksCiAgICAgICAgY2J5OiBqLAogICAgICAgIHRieDA6IGNvZGVibG9ja1dpZHRoICogaSwKICAgICAgICB0YnkwOiBjb2RlYmxvY2tIZWlnaHQgKiBqLAogICAgICAgIHRieDE6IGNvZGVibG9ja1dpZHRoICogKGkgKyAxKSwKICAgICAgICB0YnkxOiBjb2RlYmxvY2tIZWlnaHQgKiAoaiArIDEpCiAgICAgIH07CiAgICAgIGNvZGVibG9jay50YngwXyA9IE1hdGgubWF4KHN1YmJhbmQudGJ4MCwgY29kZWJsb2NrLnRieDApOwogICAgICBjb2RlYmxvY2sudGJ5MF8gPSBNYXRoLm1heChzdWJiYW5kLnRieTAsIGNvZGVibG9jay50YnkwKTsKICAgICAgY29kZWJsb2NrLnRieDFfID0gTWF0aC5taW4oc3ViYmFuZC50YngxLCBjb2RlYmxvY2sudGJ4MSk7CiAgICAgIGNvZGVibG9jay50YnkxXyA9IE1hdGgubWluKHN1YmJhbmQudGJ5MSwgY29kZWJsb2NrLnRieTEpOwogICAgICBjb25zdCBwaSA9IE1hdGguZmxvb3IoKGNvZGVibG9jay50YngwXyAtIHN1YmJhbmQudGJ4MCkgLyBwcmVjaW5jdFBhcmFtZXRlcnMucHJlY2luY3RXaWR0aEluU3ViYmFuZCk7CiAgICAgIGNvbnN0IHBqID0gTWF0aC5mbG9vcigoY29kZWJsb2NrLnRieTBfIC0gc3ViYmFuZC50YnkwKSAvIHByZWNpbmN0UGFyYW1ldGVycy5wcmVjaW5jdEhlaWdodEluU3ViYmFuZCk7CiAgICAgIHByZWNpbmN0TnVtYmVyID0gcGkgKyBwaiAqIHByZWNpbmN0UGFyYW1ldGVycy5udW1wcmVjaW5jdHN3aWRlOwogICAgICBjb2RlYmxvY2sucHJlY2luY3ROdW1iZXIgPSBwcmVjaW5jdE51bWJlcjsKICAgICAgY29kZWJsb2NrLnN1YmJhbmRUeXBlID0gc3ViYmFuZC50eXBlOwogICAgICBjb2RlYmxvY2suTGJsb2NrID0gMzsKCiAgICAgIGlmIChjb2RlYmxvY2sudGJ4MV8gPD0gY29kZWJsb2NrLnRieDBfIHx8IGNvZGVibG9jay50YnkxXyA8PSBjb2RlYmxvY2sudGJ5MF8pIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29kZWJsb2Nrcy5wdXNoKGNvZGVibG9jayk7CiAgICAgIGxldCBwcmVjaW5jdCA9IHByZWNpbmN0c1twcmVjaW5jdE51bWJlcl07CgogICAgICBpZiAocHJlY2luY3QgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGlmIChpIDwgcHJlY2luY3QuY2J4TWluKSB7CiAgICAgICAgICBwcmVjaW5jdC5jYnhNaW4gPSBpOwogICAgICAgIH0gZWxzZSBpZiAoaSA+IHByZWNpbmN0LmNieE1heCkgewogICAgICAgICAgcHJlY2luY3QuY2J4TWF4ID0gaTsKICAgICAgICB9CgogICAgICAgIGlmIChqIDwgcHJlY2luY3QuY2J5TWluKSB7CiAgICAgICAgICBwcmVjaW5jdC5jYnhNaW4gPSBqOwogICAgICAgIH0gZWxzZSBpZiAoaiA+IHByZWNpbmN0LmNieU1heCkgewogICAgICAgICAgcHJlY2luY3QuY2J5TWF4ID0gajsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcHJlY2luY3RzW3ByZWNpbmN0TnVtYmVyXSA9IHByZWNpbmN0ID0gewogICAgICAgICAgY2J4TWluOiBpLAogICAgICAgICAgY2J5TWluOiBqLAogICAgICAgICAgY2J4TWF4OiBpLAogICAgICAgICAgY2J5TWF4OiBqCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgY29kZWJsb2NrLnByZWNpbmN0ID0gcHJlY2luY3Q7CiAgICB9CiAgfQoKICBzdWJiYW5kLmNvZGVibG9ja1BhcmFtZXRlcnMgPSB7CiAgICBjb2RlYmxvY2tXaWR0aDogeGNiXywKICAgIGNvZGVibG9ja0hlaWdodDogeWNiXywKICAgIG51bWNvZGVibG9ja3dpZGU6IGNieDEgLSBjYngwICsgMSwKICAgIG51bWNvZGVibG9ja2hpZ2g6IGNieTEgLSBjYnkwICsgMQogIH07CiAgc3ViYmFuZC5jb2RlYmxvY2tzID0gY29kZWJsb2NrczsKICBzdWJiYW5kLnByZWNpbmN0cyA9IHByZWNpbmN0czsKfQoKZnVuY3Rpb24gY3JlYXRlUGFja2V0KHJlc29sdXRpb24sIHByZWNpbmN0TnVtYmVyLCBsYXllck51bWJlcikgewogIGNvbnN0IHByZWNpbmN0Q29kZWJsb2NrcyA9IFtdOwogIGNvbnN0IHN1YmJhbmRzID0gcmVzb2x1dGlvbi5zdWJiYW5kczsKCiAgZm9yIChsZXQgaSA9IDAsIGlpID0gc3ViYmFuZHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgY29uc3Qgc3ViYmFuZCA9IHN1YmJhbmRzW2ldOwogICAgY29uc3QgY29kZWJsb2NrcyA9IHN1YmJhbmQuY29kZWJsb2NrczsKCiAgICBmb3IgKGxldCBqID0gMCwgamogPSBjb2RlYmxvY2tzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgY29uc3QgY29kZWJsb2NrID0gY29kZWJsb2Nrc1tqXTsKCiAgICAgIGlmIChjb2RlYmxvY2sucHJlY2luY3ROdW1iZXIgIT09IHByZWNpbmN0TnVtYmVyKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHByZWNpbmN0Q29kZWJsb2Nrcy5wdXNoKGNvZGVibG9jayk7CiAgICB9CiAgfQoKICByZXR1cm4gewogICAgbGF5ZXJOdW1iZXIsCiAgICBjb2RlYmxvY2tzOiBwcmVjaW5jdENvZGVibG9ja3MKICB9Owp9CgpmdW5jdGlvbiBMYXllclJlc29sdXRpb25Db21wb25lbnRQb3NpdGlvbkl0ZXJhdG9yKGNvbnRleHQpIHsKICBjb25zdCBzaXogPSBjb250ZXh0LlNJWjsKICBjb25zdCB0aWxlSW5kZXggPSBjb250ZXh0LmN1cnJlbnRUaWxlLmluZGV4OwogIGNvbnN0IHRpbGUgPSBjb250ZXh0LnRpbGVzW3RpbGVJbmRleF07CiAgY29uc3QgbGF5ZXJzQ291bnQgPSB0aWxlLmNvZGluZ1N0eWxlRGVmYXVsdFBhcmFtZXRlcnMubGF5ZXJzQ291bnQ7CiAgY29uc3QgY29tcG9uZW50c0NvdW50ID0gc2l6LkNzaXo7CiAgbGV0IG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IDA7CgogIGZvciAobGV0IHEgPSAwOyBxIDwgY29tcG9uZW50c0NvdW50OyBxKyspIHsKICAgIG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IE1hdGgubWF4KG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCwgdGlsZS5jb21wb25lbnRzW3FdLmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQpOwogIH0KCiAgbGV0IGwgPSAwLAogICAgICByID0gMCwKICAgICAgaSA9IDAsCiAgICAgIGsgPSAwOwoKICB0aGlzLm5leHRQYWNrZXQgPSBmdW5jdGlvbiBKcHhJbWFnZV9uZXh0UGFja2V0KCkgewogICAgZm9yICg7IGwgPCBsYXllcnNDb3VudDsgbCsrKSB7CiAgICAgIGZvciAoOyByIDw9IG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudDsgcisrKSB7CiAgICAgICAgZm9yICg7IGkgPCBjb21wb25lbnRzQ291bnQ7IGkrKykgewogICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGlsZS5jb21wb25lbnRzW2ldOwoKICAgICAgICAgIGlmIChyID4gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgcmVzb2x1dGlvbiA9IGNvbXBvbmVudC5yZXNvbHV0aW9uc1tyXTsKICAgICAgICAgIGNvbnN0IG51bXByZWNpbmN0cyA9IHJlc29sdXRpb24ucHJlY2luY3RQYXJhbWV0ZXJzLm51bXByZWNpbmN0czsKCiAgICAgICAgICBmb3IgKDsgayA8IG51bXByZWNpbmN0czspIHsKICAgICAgICAgICAgY29uc3QgcGFja2V0ID0gY3JlYXRlUGFja2V0KHJlc29sdXRpb24sIGssIGwpOwogICAgICAgICAgICBrKys7CiAgICAgICAgICAgIHJldHVybiBwYWNrZXQ7CiAgICAgICAgICB9CgogICAgICAgICAgayA9IDA7CiAgICAgICAgfQoKICAgICAgICBpID0gMDsKICAgICAgfQoKICAgICAgciA9IDA7CiAgICB9CgogICAgdGhyb3cgbmV3IEpweEVycm9yKCJPdXQgb2YgcGFja2V0cyIpOwogIH07Cn0KCmZ1bmN0aW9uIFJlc29sdXRpb25MYXllckNvbXBvbmVudFBvc2l0aW9uSXRlcmF0b3IoY29udGV4dCkgewogIGNvbnN0IHNpeiA9IGNvbnRleHQuU0laOwogIGNvbnN0IHRpbGVJbmRleCA9IGNvbnRleHQuY3VycmVudFRpbGUuaW5kZXg7CiAgY29uc3QgdGlsZSA9IGNvbnRleHQudGlsZXNbdGlsZUluZGV4XTsKICBjb25zdCBsYXllcnNDb3VudCA9IHRpbGUuY29kaW5nU3R5bGVEZWZhdWx0UGFyYW1ldGVycy5sYXllcnNDb3VudDsKICBjb25zdCBjb21wb25lbnRzQ291bnQgPSBzaXouQ3NpejsKICBsZXQgbWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gMDsKCiAgZm9yIChsZXQgcSA9IDA7IHEgPCBjb21wb25lbnRzQ291bnQ7IHErKykgewogICAgbWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gTWF0aC5tYXgobWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50LCB0aWxlLmNvbXBvbmVudHNbcV0uY29kaW5nU3R5bGVQYXJhbWV0ZXJzLmRlY29tcG9zaXRpb25MZXZlbHNDb3VudCk7CiAgfQoKICBsZXQgciA9IDAsCiAgICAgIGwgPSAwLAogICAgICBpID0gMCwKICAgICAgayA9IDA7CgogIHRoaXMubmV4dFBhY2tldCA9IGZ1bmN0aW9uIEpweEltYWdlX25leHRQYWNrZXQoKSB7CiAgICBmb3IgKDsgciA8PSBtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7IHIrKykgewogICAgICBmb3IgKDsgbCA8IGxheWVyc0NvdW50OyBsKyspIHsKICAgICAgICBmb3IgKDsgaSA8IGNvbXBvbmVudHNDb3VudDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSB0aWxlLmNvbXBvbmVudHNbaV07CgogICAgICAgICAgaWYgKHIgPiBjb21wb25lbnQuY29kaW5nU3R5bGVQYXJhbWV0ZXJzLmRlY29tcG9zaXRpb25MZXZlbHNDb3VudCkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCByZXNvbHV0aW9uID0gY29tcG9uZW50LnJlc29sdXRpb25zW3JdOwogICAgICAgICAgY29uc3QgbnVtcHJlY2luY3RzID0gcmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnMubnVtcHJlY2luY3RzOwoKICAgICAgICAgIGZvciAoOyBrIDwgbnVtcHJlY2luY3RzOykgewogICAgICAgICAgICBjb25zdCBwYWNrZXQgPSBjcmVhdGVQYWNrZXQocmVzb2x1dGlvbiwgaywgbCk7CiAgICAgICAgICAgIGsrKzsKICAgICAgICAgICAgcmV0dXJuIHBhY2tldDsKICAgICAgICAgIH0KCiAgICAgICAgICBrID0gMDsKICAgICAgICB9CgogICAgICAgIGkgPSAwOwogICAgICB9CgogICAgICBsID0gMDsKICAgIH0KCiAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIk91dCBvZiBwYWNrZXRzIik7CiAgfTsKfQoKZnVuY3Rpb24gUmVzb2x1dGlvblBvc2l0aW9uQ29tcG9uZW50TGF5ZXJJdGVyYXRvcihjb250ZXh0KSB7CiAgY29uc3Qgc2l6ID0gY29udGV4dC5TSVo7CiAgY29uc3QgdGlsZUluZGV4ID0gY29udGV4dC5jdXJyZW50VGlsZS5pbmRleDsKICBjb25zdCB0aWxlID0gY29udGV4dC50aWxlc1t0aWxlSW5kZXhdOwogIGNvbnN0IGxheWVyc0NvdW50ID0gdGlsZS5jb2RpbmdTdHlsZURlZmF1bHRQYXJhbWV0ZXJzLmxheWVyc0NvdW50OwogIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwogIGxldCBsLCByLCBjLCBwOwogIGxldCBtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgPSAwOwoKICBmb3IgKGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgIGNvbnN0IGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKICAgIG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IE1hdGgubWF4KG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCwgY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQpOwogIH0KCiAgY29uc3QgbWF4TnVtUHJlY2luY3RzSW5MZXZlbCA9IG5ldyBJbnQzMkFycmF5KG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCArIDEpOwoKICBmb3IgKHIgPSAwOyByIDw9IG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudDsgKytyKSB7CiAgICBsZXQgbWF4TnVtUHJlY2luY3RzID0gMDsKCiAgICBmb3IgKGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyArK2MpIHsKICAgICAgY29uc3QgcmVzb2x1dGlvbnMgPSB0aWxlLmNvbXBvbmVudHNbY10ucmVzb2x1dGlvbnM7CgogICAgICBpZiAociA8IHJlc29sdXRpb25zLmxlbmd0aCkgewogICAgICAgIG1heE51bVByZWNpbmN0cyA9IE1hdGgubWF4KG1heE51bVByZWNpbmN0cywgcmVzb2x1dGlvbnNbcl0ucHJlY2luY3RQYXJhbWV0ZXJzLm51bXByZWNpbmN0cyk7CiAgICAgIH0KICAgIH0KCiAgICBtYXhOdW1QcmVjaW5jdHNJbkxldmVsW3JdID0gbWF4TnVtUHJlY2luY3RzOwogIH0KCiAgbCA9IDA7CiAgciA9IDA7CiAgYyA9IDA7CiAgcCA9IDA7CgogIHRoaXMubmV4dFBhY2tldCA9IGZ1bmN0aW9uIEpweEltYWdlX25leHRQYWNrZXQoKSB7CiAgICBmb3IgKDsgciA8PSBtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7IHIrKykgewogICAgICBmb3IgKDsgcCA8IG1heE51bVByZWNpbmN0c0luTGV2ZWxbcl07IHArKykgewogICAgICAgIGZvciAoOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKCiAgICAgICAgICBpZiAociA+IGNvbXBvbmVudC5jb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50KSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IHJlc29sdXRpb24gPSBjb21wb25lbnQucmVzb2x1dGlvbnNbcl07CiAgICAgICAgICBjb25zdCBudW1wcmVjaW5jdHMgPSByZXNvbHV0aW9uLnByZWNpbmN0UGFyYW1ldGVycy5udW1wcmVjaW5jdHM7CgogICAgICAgICAgaWYgKHAgPj0gbnVtcHJlY2luY3RzKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAoOyBsIDwgbGF5ZXJzQ291bnQ7KSB7CiAgICAgICAgICAgIGNvbnN0IHBhY2tldCA9IGNyZWF0ZVBhY2tldChyZXNvbHV0aW9uLCBwLCBsKTsKICAgICAgICAgICAgbCsrOwogICAgICAgICAgICByZXR1cm4gcGFja2V0OwogICAgICAgICAgfQoKICAgICAgICAgIGwgPSAwOwogICAgICAgIH0KCiAgICAgICAgYyA9IDA7CiAgICAgIH0KCiAgICAgIHAgPSAwOwogICAgfQoKICAgIHRocm93IG5ldyBKcHhFcnJvcigiT3V0IG9mIHBhY2tldHMiKTsKICB9Owp9CgpmdW5jdGlvbiBQb3NpdGlvbkNvbXBvbmVudFJlc29sdXRpb25MYXllckl0ZXJhdG9yKGNvbnRleHQpIHsKICBjb25zdCBzaXogPSBjb250ZXh0LlNJWjsKICBjb25zdCB0aWxlSW5kZXggPSBjb250ZXh0LmN1cnJlbnRUaWxlLmluZGV4OwogIGNvbnN0IHRpbGUgPSBjb250ZXh0LnRpbGVzW3RpbGVJbmRleF07CiAgY29uc3QgbGF5ZXJzQ291bnQgPSB0aWxlLmNvZGluZ1N0eWxlRGVmYXVsdFBhcmFtZXRlcnMubGF5ZXJzQ291bnQ7CiAgY29uc3QgY29tcG9uZW50c0NvdW50ID0gc2l6LkNzaXo7CiAgY29uc3QgcHJlY2luY3RzU2l6ZXMgPSBnZXRQcmVjaW5jdFNpemVzSW5JbWFnZVNjYWxlKHRpbGUpOwogIGNvbnN0IHByZWNpbmN0c0l0ZXJhdGlvblNpemVzID0gcHJlY2luY3RzU2l6ZXM7CiAgbGV0IGwgPSAwLAogICAgICByID0gMCwKICAgICAgYyA9IDAsCiAgICAgIHB4ID0gMCwKICAgICAgcHkgPSAwOwoKICB0aGlzLm5leHRQYWNrZXQgPSBmdW5jdGlvbiBKcHhJbWFnZV9uZXh0UGFja2V0KCkgewogICAgZm9yICg7IHB5IDwgcHJlY2luY3RzSXRlcmF0aW9uU2l6ZXMubWF4TnVtSGlnaDsgcHkrKykgewogICAgICBmb3IgKDsgcHggPCBwcmVjaW5jdHNJdGVyYXRpb25TaXplcy5tYXhOdW1XaWRlOyBweCsrKSB7CiAgICAgICAgZm9yICg7IGMgPCBjb21wb25lbnRzQ291bnQ7IGMrKykgewogICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGlsZS5jb21wb25lbnRzW2NdOwogICAgICAgICAgY29uc3QgZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7CgogICAgICAgICAgZm9yICg7IHIgPD0gZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByKyspIHsKICAgICAgICAgICAgY29uc3QgcmVzb2x1dGlvbiA9IGNvbXBvbmVudC5yZXNvbHV0aW9uc1tyXTsKICAgICAgICAgICAgY29uc3Qgc2l6ZUluSW1hZ2VTY2FsZSA9IHByZWNpbmN0c1NpemVzLmNvbXBvbmVudHNbY10ucmVzb2x1dGlvbnNbcl07CiAgICAgICAgICAgIGNvbnN0IGsgPSBnZXRQcmVjaW5jdEluZGV4SWZFeGlzdChweCwgcHksIHNpemVJbkltYWdlU2NhbGUsIHByZWNpbmN0c0l0ZXJhdGlvblNpemVzLCByZXNvbHV0aW9uKTsKCiAgICAgICAgICAgIGlmIChrID09PSBudWxsKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvciAoOyBsIDwgbGF5ZXJzQ291bnQ7KSB7CiAgICAgICAgICAgICAgY29uc3QgcGFja2V0ID0gY3JlYXRlUGFja2V0KHJlc29sdXRpb24sIGssIGwpOwogICAgICAgICAgICAgIGwrKzsKICAgICAgICAgICAgICByZXR1cm4gcGFja2V0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBsID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICByID0gMDsKICAgICAgICB9CgogICAgICAgIGMgPSAwOwogICAgICB9CgogICAgICBweCA9IDA7CiAgICB9CgogICAgdGhyb3cgbmV3IEpweEVycm9yKCJPdXQgb2YgcGFja2V0cyIpOwogIH07Cn0KCmZ1bmN0aW9uIENvbXBvbmVudFBvc2l0aW9uUmVzb2x1dGlvbkxheWVySXRlcmF0b3IoY29udGV4dCkgewogIGNvbnN0IHNpeiA9IGNvbnRleHQuU0laOwogIGNvbnN0IHRpbGVJbmRleCA9IGNvbnRleHQuY3VycmVudFRpbGUuaW5kZXg7CiAgY29uc3QgdGlsZSA9IGNvbnRleHQudGlsZXNbdGlsZUluZGV4XTsKICBjb25zdCBsYXllcnNDb3VudCA9IHRpbGUuY29kaW5nU3R5bGVEZWZhdWx0UGFyYW1ldGVycy5sYXllcnNDb3VudDsKICBjb25zdCBjb21wb25lbnRzQ291bnQgPSBzaXouQ3NpejsKICBjb25zdCBwcmVjaW5jdHNTaXplcyA9IGdldFByZWNpbmN0U2l6ZXNJbkltYWdlU2NhbGUodGlsZSk7CiAgbGV0IGwgPSAwLAogICAgICByID0gMCwKICAgICAgYyA9IDAsCiAgICAgIHB4ID0gMCwKICAgICAgcHkgPSAwOwoKICB0aGlzLm5leHRQYWNrZXQgPSBmdW5jdGlvbiBKcHhJbWFnZV9uZXh0UGFja2V0KCkgewogICAgZm9yICg7IGMgPCBjb21wb25lbnRzQ291bnQ7ICsrYykgewogICAgICBjb25zdCBjb21wb25lbnQgPSB0aWxlLmNvbXBvbmVudHNbY107CiAgICAgIGNvbnN0IHByZWNpbmN0c0l0ZXJhdGlvblNpemVzID0gcHJlY2luY3RzU2l6ZXMuY29tcG9uZW50c1tjXTsKICAgICAgY29uc3QgZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7CgogICAgICBmb3IgKDsgcHkgPCBwcmVjaW5jdHNJdGVyYXRpb25TaXplcy5tYXhOdW1IaWdoOyBweSsrKSB7CiAgICAgICAgZm9yICg7IHB4IDwgcHJlY2luY3RzSXRlcmF0aW9uU2l6ZXMubWF4TnVtV2lkZTsgcHgrKykgewogICAgICAgICAgZm9yICg7IHIgPD0gZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByKyspIHsKICAgICAgICAgICAgY29uc3QgcmVzb2x1dGlvbiA9IGNvbXBvbmVudC5yZXNvbHV0aW9uc1tyXTsKICAgICAgICAgICAgY29uc3Qgc2l6ZUluSW1hZ2VTY2FsZSA9IHByZWNpbmN0c0l0ZXJhdGlvblNpemVzLnJlc29sdXRpb25zW3JdOwogICAgICAgICAgICBjb25zdCBrID0gZ2V0UHJlY2luY3RJbmRleElmRXhpc3QocHgsIHB5LCBzaXplSW5JbWFnZVNjYWxlLCBwcmVjaW5jdHNJdGVyYXRpb25TaXplcywgcmVzb2x1dGlvbik7CgogICAgICAgICAgICBpZiAoayA9PT0gbnVsbCkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IgKDsgbCA8IGxheWVyc0NvdW50OykgewogICAgICAgICAgICAgIGNvbnN0IHBhY2tldCA9IGNyZWF0ZVBhY2tldChyZXNvbHV0aW9uLCBrLCBsKTsKICAgICAgICAgICAgICBsKys7CiAgICAgICAgICAgICAgcmV0dXJuIHBhY2tldDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbCA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgciA9IDA7CiAgICAgICAgfQoKICAgICAgICBweCA9IDA7CiAgICAgIH0KCiAgICAgIHB5ID0gMDsKICAgIH0KCiAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIk91dCBvZiBwYWNrZXRzIik7CiAgfTsKfQoKZnVuY3Rpb24gZ2V0UHJlY2luY3RJbmRleElmRXhpc3QocHhJbmRleCwgcHlJbmRleCwgc2l6ZUluSW1hZ2VTY2FsZSwgcHJlY2luY3RJdGVyYXRpb25TaXplcywgcmVzb2x1dGlvbikgewogIGNvbnN0IHBvc1ggPSBweEluZGV4ICogcHJlY2luY3RJdGVyYXRpb25TaXplcy5taW5XaWR0aDsKICBjb25zdCBwb3NZID0gcHlJbmRleCAqIHByZWNpbmN0SXRlcmF0aW9uU2l6ZXMubWluSGVpZ2h0OwoKICBpZiAocG9zWCAlIHNpemVJbkltYWdlU2NhbGUud2lkdGggIT09IDAgfHwgcG9zWSAlIHNpemVJbkltYWdlU2NhbGUuaGVpZ2h0ICE9PSAwKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IHN0YXJ0UHJlY2luY3RSb3dJbmRleCA9IHBvc1kgLyBzaXplSW5JbWFnZVNjYWxlLndpZHRoICogcmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnMubnVtcHJlY2luY3Rzd2lkZTsKICByZXR1cm4gcG9zWCAvIHNpemVJbkltYWdlU2NhbGUuaGVpZ2h0ICsgc3RhcnRQcmVjaW5jdFJvd0luZGV4Owp9CgpmdW5jdGlvbiBnZXRQcmVjaW5jdFNpemVzSW5JbWFnZVNjYWxlKHRpbGUpIHsKICBjb25zdCBjb21wb25lbnRzQ291bnQgPSB0aWxlLmNvbXBvbmVudHMubGVuZ3RoOwogIGxldCBtaW5XaWR0aCA9IE51bWJlci5NQVhfVkFMVUU7CiAgbGV0IG1pbkhlaWdodCA9IE51bWJlci5NQVhfVkFMVUU7CiAgbGV0IG1heE51bVdpZGUgPSAwOwogIGxldCBtYXhOdW1IaWdoID0gMDsKICBjb25zdCBzaXplUGVyQ29tcG9uZW50ID0gbmV3IEFycmF5KGNvbXBvbmVudHNDb3VudCk7CgogIGZvciAobGV0IGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgIGNvbnN0IGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKICAgIGNvbnN0IGRlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IGNvbXBvbmVudC5jb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OwogICAgY29uc3Qgc2l6ZVBlclJlc29sdXRpb24gPSBuZXcgQXJyYXkoZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ICsgMSk7CiAgICBsZXQgbWluV2lkdGhDdXJyZW50Q29tcG9uZW50ID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIGxldCBtaW5IZWlnaHRDdXJyZW50Q29tcG9uZW50ID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIGxldCBtYXhOdW1XaWRlQ3VycmVudENvbXBvbmVudCA9IDA7CiAgICBsZXQgbWF4TnVtSGlnaEN1cnJlbnRDb21wb25lbnQgPSAwOwogICAgbGV0IHNjYWxlID0gMTsKCiAgICBmb3IgKGxldCByID0gZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByID49IDA7IC0tcikgewogICAgICBjb25zdCByZXNvbHV0aW9uID0gY29tcG9uZW50LnJlc29sdXRpb25zW3JdOwogICAgICBjb25zdCB3aWR0aEN1cnJlbnRSZXNvbHV0aW9uID0gc2NhbGUgKiByZXNvbHV0aW9uLnByZWNpbmN0UGFyYW1ldGVycy5wcmVjaW5jdFdpZHRoOwogICAgICBjb25zdCBoZWlnaHRDdXJyZW50UmVzb2x1dGlvbiA9IHNjYWxlICogcmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnMucHJlY2luY3RIZWlnaHQ7CiAgICAgIG1pbldpZHRoQ3VycmVudENvbXBvbmVudCA9IE1hdGgubWluKG1pbldpZHRoQ3VycmVudENvbXBvbmVudCwgd2lkdGhDdXJyZW50UmVzb2x1dGlvbik7CiAgICAgIG1pbkhlaWdodEN1cnJlbnRDb21wb25lbnQgPSBNYXRoLm1pbihtaW5IZWlnaHRDdXJyZW50Q29tcG9uZW50LCBoZWlnaHRDdXJyZW50UmVzb2x1dGlvbik7CiAgICAgIG1heE51bVdpZGVDdXJyZW50Q29tcG9uZW50ID0gTWF0aC5tYXgobWF4TnVtV2lkZUN1cnJlbnRDb21wb25lbnQsIHJlc29sdXRpb24ucHJlY2luY3RQYXJhbWV0ZXJzLm51bXByZWNpbmN0c3dpZGUpOwogICAgICBtYXhOdW1IaWdoQ3VycmVudENvbXBvbmVudCA9IE1hdGgubWF4KG1heE51bUhpZ2hDdXJyZW50Q29tcG9uZW50LCByZXNvbHV0aW9uLnByZWNpbmN0UGFyYW1ldGVycy5udW1wcmVjaW5jdHNoaWdoKTsKICAgICAgc2l6ZVBlclJlc29sdXRpb25bcl0gPSB7CiAgICAgICAgd2lkdGg6IHdpZHRoQ3VycmVudFJlc29sdXRpb24sCiAgICAgICAgaGVpZ2h0OiBoZWlnaHRDdXJyZW50UmVzb2x1dGlvbgogICAgICB9OwogICAgICBzY2FsZSA8PD0gMTsKICAgIH0KCiAgICBtaW5XaWR0aCA9IE1hdGgubWluKG1pbldpZHRoLCBtaW5XaWR0aEN1cnJlbnRDb21wb25lbnQpOwogICAgbWluSGVpZ2h0ID0gTWF0aC5taW4obWluSGVpZ2h0LCBtaW5IZWlnaHRDdXJyZW50Q29tcG9uZW50KTsKICAgIG1heE51bVdpZGUgPSBNYXRoLm1heChtYXhOdW1XaWRlLCBtYXhOdW1XaWRlQ3VycmVudENvbXBvbmVudCk7CiAgICBtYXhOdW1IaWdoID0gTWF0aC5tYXgobWF4TnVtSGlnaCwgbWF4TnVtSGlnaEN1cnJlbnRDb21wb25lbnQpOwogICAgc2l6ZVBlckNvbXBvbmVudFtjXSA9IHsKICAgICAgcmVzb2x1dGlvbnM6IHNpemVQZXJSZXNvbHV0aW9uLAogICAgICBtaW5XaWR0aDogbWluV2lkdGhDdXJyZW50Q29tcG9uZW50LAogICAgICBtaW5IZWlnaHQ6IG1pbkhlaWdodEN1cnJlbnRDb21wb25lbnQsCiAgICAgIG1heE51bVdpZGU6IG1heE51bVdpZGVDdXJyZW50Q29tcG9uZW50LAogICAgICBtYXhOdW1IaWdoOiBtYXhOdW1IaWdoQ3VycmVudENvbXBvbmVudAogICAgfTsKICB9CgogIHJldHVybiB7CiAgICBjb21wb25lbnRzOiBzaXplUGVyQ29tcG9uZW50LAogICAgbWluV2lkdGgsCiAgICBtaW5IZWlnaHQsCiAgICBtYXhOdW1XaWRlLAogICAgbWF4TnVtSGlnaAogIH07Cn0KCmZ1bmN0aW9uIGJ1aWxkUGFja2V0cyhjb250ZXh0KSB7CiAgY29uc3Qgc2l6ID0gY29udGV4dC5TSVo7CiAgY29uc3QgdGlsZUluZGV4ID0gY29udGV4dC5jdXJyZW50VGlsZS5pbmRleDsKICBjb25zdCB0aWxlID0gY29udGV4dC50aWxlc1t0aWxlSW5kZXhdOwogIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwoKICBmb3IgKGxldCBjID0gMDsgYyA8IGNvbXBvbmVudHNDb3VudDsgYysrKSB7CiAgICBjb25zdCBjb21wb25lbnQgPSB0aWxlLmNvbXBvbmVudHNbY107CiAgICBjb25zdCBkZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgPSBjb21wb25lbnQuY29kaW5nU3R5bGVQYXJhbWV0ZXJzLmRlY29tcG9zaXRpb25MZXZlbHNDb3VudDsKICAgIGNvbnN0IHJlc29sdXRpb25zID0gW107CiAgICBjb25zdCBzdWJiYW5kcyA9IFtdOwoKICAgIGZvciAobGV0IHIgPSAwOyByIDw9IGRlY29tcG9zaXRpb25MZXZlbHNDb3VudDsgcisrKSB7CiAgICAgIGNvbnN0IGJsb2Nrc0RpbWVuc2lvbnMgPSBnZXRCbG9ja3NEaW1lbnNpb25zKGNvbnRleHQsIGNvbXBvbmVudCwgcik7CiAgICAgIGNvbnN0IHJlc29sdXRpb24gPSB7fTsKICAgICAgY29uc3Qgc2NhbGUgPSAxIDw8IGRlY29tcG9zaXRpb25MZXZlbHNDb3VudCAtIHI7CiAgICAgIHJlc29sdXRpb24udHJ4MCA9IE1hdGguY2VpbChjb21wb25lbnQudGN4MCAvIHNjYWxlKTsKICAgICAgcmVzb2x1dGlvbi50cnkwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kwIC8gc2NhbGUpOwogICAgICByZXNvbHV0aW9uLnRyeDEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDEgLyBzY2FsZSk7CiAgICAgIHJlc29sdXRpb24udHJ5MSA9IE1hdGguY2VpbChjb21wb25lbnQudGN5MSAvIHNjYWxlKTsKICAgICAgcmVzb2x1dGlvbi5yZXNMZXZlbCA9IHI7CiAgICAgIGJ1aWxkUHJlY2luY3RzKGNvbnRleHQsIHJlc29sdXRpb24sIGJsb2Nrc0RpbWVuc2lvbnMpOwogICAgICByZXNvbHV0aW9ucy5wdXNoKHJlc29sdXRpb24pOwogICAgICBsZXQgc3ViYmFuZDsKCiAgICAgIGlmIChyID09PSAwKSB7CiAgICAgICAgc3ViYmFuZCA9IHt9OwogICAgICAgIHN1YmJhbmQudHlwZSA9ICJMTCI7CiAgICAgICAgc3ViYmFuZC50YngwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3gwIC8gc2NhbGUpOwogICAgICAgIHN1YmJhbmQudGJ5MCA9IE1hdGguY2VpbChjb21wb25lbnQudGN5MCAvIHNjYWxlKTsKICAgICAgICBzdWJiYW5kLnRieDEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDEgLyBzY2FsZSk7CiAgICAgICAgc3ViYmFuZC50YnkxID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kxIC8gc2NhbGUpOwogICAgICAgIHN1YmJhbmQucmVzb2x1dGlvbiA9IHJlc29sdXRpb247CiAgICAgICAgYnVpbGRDb2RlYmxvY2tzKGNvbnRleHQsIHN1YmJhbmQsIGJsb2Nrc0RpbWVuc2lvbnMpOwogICAgICAgIHN1YmJhbmRzLnB1c2goc3ViYmFuZCk7CiAgICAgICAgcmVzb2x1dGlvbi5zdWJiYW5kcyA9IFtzdWJiYW5kXTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBic2NhbGUgPSAxIDw8IGRlY29tcG9zaXRpb25MZXZlbHNDb3VudCAtIHIgKyAxOwogICAgICAgIGNvbnN0IHJlc29sdXRpb25TdWJiYW5kcyA9IFtdOwogICAgICAgIHN1YmJhbmQgPSB7fTsKICAgICAgICBzdWJiYW5kLnR5cGUgPSAiSEwiOwogICAgICAgIHN1YmJhbmQudGJ4MCA9IE1hdGguY2VpbChjb21wb25lbnQudGN4MCAvIGJzY2FsZSAtIDAuNSk7CiAgICAgICAgc3ViYmFuZC50YnkwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kwIC8gYnNjYWxlKTsKICAgICAgICBzdWJiYW5kLnRieDEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDEgLyBic2NhbGUgLSAwLjUpOwogICAgICAgIHN1YmJhbmQudGJ5MSA9IE1hdGguY2VpbChjb21wb25lbnQudGN5MSAvIGJzY2FsZSk7CiAgICAgICAgc3ViYmFuZC5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbjsKICAgICAgICBidWlsZENvZGVibG9ja3MoY29udGV4dCwgc3ViYmFuZCwgYmxvY2tzRGltZW5zaW9ucyk7CiAgICAgICAgc3ViYmFuZHMucHVzaChzdWJiYW5kKTsKICAgICAgICByZXNvbHV0aW9uU3ViYmFuZHMucHVzaChzdWJiYW5kKTsKICAgICAgICBzdWJiYW5kID0ge307CiAgICAgICAgc3ViYmFuZC50eXBlID0gIkxIIjsKICAgICAgICBzdWJiYW5kLnRieDAgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDAgLyBic2NhbGUpOwogICAgICAgIHN1YmJhbmQudGJ5MCA9IE1hdGguY2VpbChjb21wb25lbnQudGN5MCAvIGJzY2FsZSAtIDAuNSk7CiAgICAgICAgc3ViYmFuZC50YngxID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3gxIC8gYnNjYWxlKTsKICAgICAgICBzdWJiYW5kLnRieTEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeTEgLyBic2NhbGUgLSAwLjUpOwogICAgICAgIHN1YmJhbmQucmVzb2x1dGlvbiA9IHJlc29sdXRpb247CiAgICAgICAgYnVpbGRDb2RlYmxvY2tzKGNvbnRleHQsIHN1YmJhbmQsIGJsb2Nrc0RpbWVuc2lvbnMpOwogICAgICAgIHN1YmJhbmRzLnB1c2goc3ViYmFuZCk7CiAgICAgICAgcmVzb2x1dGlvblN1YmJhbmRzLnB1c2goc3ViYmFuZCk7CiAgICAgICAgc3ViYmFuZCA9IHt9OwogICAgICAgIHN1YmJhbmQudHlwZSA9ICJISCI7CiAgICAgICAgc3ViYmFuZC50YngwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3gwIC8gYnNjYWxlIC0gMC41KTsKICAgICAgICBzdWJiYW5kLnRieTAgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeTAgLyBic2NhbGUgLSAwLjUpOwogICAgICAgIHN1YmJhbmQudGJ4MSA9IE1hdGguY2VpbChjb21wb25lbnQudGN4MSAvIGJzY2FsZSAtIDAuNSk7CiAgICAgICAgc3ViYmFuZC50YnkxID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kxIC8gYnNjYWxlIC0gMC41KTsKICAgICAgICBzdWJiYW5kLnJlc29sdXRpb24gPSByZXNvbHV0aW9uOwogICAgICAgIGJ1aWxkQ29kZWJsb2Nrcyhjb250ZXh0LCBzdWJiYW5kLCBibG9ja3NEaW1lbnNpb25zKTsKICAgICAgICBzdWJiYW5kcy5wdXNoKHN1YmJhbmQpOwogICAgICAgIHJlc29sdXRpb25TdWJiYW5kcy5wdXNoKHN1YmJhbmQpOwogICAgICAgIHJlc29sdXRpb24uc3ViYmFuZHMgPSByZXNvbHV0aW9uU3ViYmFuZHM7CiAgICAgIH0KICAgIH0KCiAgICBjb21wb25lbnQucmVzb2x1dGlvbnMgPSByZXNvbHV0aW9uczsKICAgIGNvbXBvbmVudC5zdWJiYW5kcyA9IHN1YmJhbmRzOwogIH0KCiAgY29uc3QgcHJvZ3Jlc3Npb25PcmRlciA9IHRpbGUuY29kaW5nU3R5bGVEZWZhdWx0UGFyYW1ldGVycy5wcm9ncmVzc2lvbk9yZGVyOwoKICBzd2l0Y2ggKHByb2dyZXNzaW9uT3JkZXIpIHsKICAgIGNhc2UgMDoKICAgICAgdGlsZS5wYWNrZXRzSXRlcmF0b3IgPSBuZXcgTGF5ZXJSZXNvbHV0aW9uQ29tcG9uZW50UG9zaXRpb25JdGVyYXRvcihjb250ZXh0KTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAxOgogICAgICB0aWxlLnBhY2tldHNJdGVyYXRvciA9IG5ldyBSZXNvbHV0aW9uTGF5ZXJDb21wb25lbnRQb3NpdGlvbkl0ZXJhdG9yKGNvbnRleHQpOwogICAgICBicmVhazsKCiAgICBjYXNlIDI6CiAgICAgIHRpbGUucGFja2V0c0l0ZXJhdG9yID0gbmV3IFJlc29sdXRpb25Qb3NpdGlvbkNvbXBvbmVudExheWVySXRlcmF0b3IoY29udGV4dCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzoKICAgICAgdGlsZS5wYWNrZXRzSXRlcmF0b3IgPSBuZXcgUG9zaXRpb25Db21wb25lbnRSZXNvbHV0aW9uTGF5ZXJJdGVyYXRvcihjb250ZXh0KTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA0OgogICAgICB0aWxlLnBhY2tldHNJdGVyYXRvciA9IG5ldyBDb21wb25lbnRQb3NpdGlvblJlc29sdXRpb25MYXllckl0ZXJhdG9yKGNvbnRleHQpOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICB0aHJvdyBuZXcgSnB4RXJyb3IoYFVuc3VwcG9ydGVkIHByb2dyZXNzaW9uIG9yZGVyICR7cHJvZ3Jlc3Npb25PcmRlcn1gKTsKICB9Cn0KCmZ1bmN0aW9uIHBhcnNlVGlsZVBhY2tldHMoY29udGV4dCwgZGF0YSwgb2Zmc2V0LCBkYXRhTGVuZ3RoKSB7CiAgbGV0IHBvc2l0aW9uID0gMDsKICBsZXQgYnVmZmVyLAogICAgICBidWZmZXJTaXplID0gMCwKICAgICAgc2tpcE5leHRCaXQgPSBmYWxzZTsKCiAgZnVuY3Rpb24gcmVhZEJpdHMoY291bnQpIHsKICAgIHdoaWxlIChidWZmZXJTaXplIDwgY291bnQpIHsKICAgICAgY29uc3QgYiA9IGRhdGFbb2Zmc2V0ICsgcG9zaXRpb25dOwogICAgICBwb3NpdGlvbisrOwoKICAgICAgaWYgKHNraXBOZXh0Qml0KSB7CiAgICAgICAgYnVmZmVyID0gYnVmZmVyIDw8IDcgfCBiOwogICAgICAgIGJ1ZmZlclNpemUgKz0gNzsKICAgICAgICBza2lwTmV4dEJpdCA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIGJ1ZmZlciA9IGJ1ZmZlciA8PCA4IHwgYjsKICAgICAgICBidWZmZXJTaXplICs9IDg7CiAgICAgIH0KCiAgICAgIGlmIChiID09PSAweGZmKSB7CiAgICAgICAgc2tpcE5leHRCaXQgPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgYnVmZmVyU2l6ZSAtPSBjb3VudDsKICAgIHJldHVybiBidWZmZXIgPj4+IGJ1ZmZlclNpemUgJiAoMSA8PCBjb3VudCkgLSAxOwogIH0KCiAgZnVuY3Rpb24gc2tpcE1hcmtlcklmRXF1YWwodmFsdWUpIHsKICAgIGlmIChkYXRhW29mZnNldCArIHBvc2l0aW9uIC0gMV0gPT09IDB4ZmYgJiYgZGF0YVtvZmZzZXQgKyBwb3NpdGlvbl0gPT09IHZhbHVlKSB7CiAgICAgIHNraXBCeXRlcygxKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgaWYgKGRhdGFbb2Zmc2V0ICsgcG9zaXRpb25dID09PSAweGZmICYmIGRhdGFbb2Zmc2V0ICsgcG9zaXRpb24gKyAxXSA9PT0gdmFsdWUpIHsKICAgICAgc2tpcEJ5dGVzKDIpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBza2lwQnl0ZXMoY291bnQpIHsKICAgIHBvc2l0aW9uICs9IGNvdW50OwogIH0KCiAgZnVuY3Rpb24gYWxpZ25Ub0J5dGUoKSB7CiAgICBidWZmZXJTaXplID0gMDsKCiAgICBpZiAoc2tpcE5leHRCaXQpIHsKICAgICAgcG9zaXRpb24rKzsKICAgICAgc2tpcE5leHRCaXQgPSBmYWxzZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHJlYWRDb2RpbmdwYXNzZXMoKSB7CiAgICBpZiAocmVhZEJpdHMoMSkgPT09IDApIHsKICAgICAgcmV0dXJuIDE7CiAgICB9CgogICAgaWYgKHJlYWRCaXRzKDEpID09PSAwKSB7CiAgICAgIHJldHVybiAyOwogICAgfQoKICAgIGxldCB2YWx1ZSA9IHJlYWRCaXRzKDIpOwoKICAgIGlmICh2YWx1ZSA8IDMpIHsKICAgICAgcmV0dXJuIHZhbHVlICsgMzsKICAgIH0KCiAgICB2YWx1ZSA9IHJlYWRCaXRzKDUpOwoKICAgIGlmICh2YWx1ZSA8IDMxKSB7CiAgICAgIHJldHVybiB2YWx1ZSArIDY7CiAgICB9CgogICAgdmFsdWUgPSByZWFkQml0cyg3KTsKICAgIHJldHVybiB2YWx1ZSArIDM3OwogIH0KCiAgY29uc3QgdGlsZUluZGV4ID0gY29udGV4dC5jdXJyZW50VGlsZS5pbmRleDsKICBjb25zdCB0aWxlID0gY29udGV4dC50aWxlc1t0aWxlSW5kZXhdOwogIGNvbnN0IHNvcE1hcmtlclVzZWQgPSBjb250ZXh0LkNPRC5zb3BNYXJrZXJVc2VkOwogIGNvbnN0IGVwaE1hcmtlclVzZWQgPSBjb250ZXh0LkNPRC5lcGhNYXJrZXJVc2VkOwogIGNvbnN0IHBhY2tldHNJdGVyYXRvciA9IHRpbGUucGFja2V0c0l0ZXJhdG9yOwoKICB3aGlsZSAocG9zaXRpb24gPCBkYXRhTGVuZ3RoKSB7CiAgICBhbGlnblRvQnl0ZSgpOwoKICAgIGlmIChzb3BNYXJrZXJVc2VkICYmIHNraXBNYXJrZXJJZkVxdWFsKDB4OTEpKSB7CiAgICAgIHNraXBCeXRlcyg0KTsKICAgIH0KCiAgICBjb25zdCBwYWNrZXQgPSBwYWNrZXRzSXRlcmF0b3IubmV4dFBhY2tldCgpOwoKICAgIGlmICghcmVhZEJpdHMoMSkpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgY29uc3QgbGF5ZXJOdW1iZXIgPSBwYWNrZXQubGF5ZXJOdW1iZXIsCiAgICAgICAgICBxdWV1ZSA9IFtdOwogICAgbGV0IGNvZGVibG9jazsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBwYWNrZXQuY29kZWJsb2Nrcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvZGVibG9jayA9IHBhY2tldC5jb2RlYmxvY2tzW2ldOwogICAgICBsZXQgcHJlY2luY3QgPSBjb2RlYmxvY2sucHJlY2luY3Q7CiAgICAgIGNvbnN0IGNvZGVibG9ja0NvbHVtbiA9IGNvZGVibG9jay5jYnggLSBwcmVjaW5jdC5jYnhNaW47CiAgICAgIGNvbnN0IGNvZGVibG9ja1JvdyA9IGNvZGVibG9jay5jYnkgLSBwcmVjaW5jdC5jYnlNaW47CiAgICAgIGxldCBjb2RlYmxvY2tJbmNsdWRlZCA9IGZhbHNlOwogICAgICBsZXQgZmlyc3RUaW1lSW5jbHVzaW9uID0gZmFsc2U7CiAgICAgIGxldCB2YWx1ZVJlYWR5LCB6ZXJvQml0UGxhbmVzVHJlZTsKCiAgICAgIGlmIChjb2RlYmxvY2suaW5jbHVkZWQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvZGVibG9ja0luY2x1ZGVkID0gISFyZWFkQml0cygxKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwcmVjaW5jdCA9IGNvZGVibG9jay5wcmVjaW5jdDsKICAgICAgICBsZXQgaW5jbHVzaW9uVHJlZTsKCiAgICAgICAgaWYgKHByZWNpbmN0LmluY2x1c2lvblRyZWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgaW5jbHVzaW9uVHJlZSA9IHByZWNpbmN0LmluY2x1c2lvblRyZWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IHdpZHRoID0gcHJlY2luY3QuY2J4TWF4IC0gcHJlY2luY3QuY2J4TWluICsgMTsKICAgICAgICAgIGNvbnN0IGhlaWdodCA9IHByZWNpbmN0LmNieU1heCAtIHByZWNpbmN0LmNieU1pbiArIDE7CiAgICAgICAgICBpbmNsdXNpb25UcmVlID0gbmV3IEluY2x1c2lvblRyZWUod2lkdGgsIGhlaWdodCwgbGF5ZXJOdW1iZXIpOwogICAgICAgICAgemVyb0JpdFBsYW5lc1RyZWUgPSBuZXcgVGFnVHJlZSh3aWR0aCwgaGVpZ2h0KTsKICAgICAgICAgIHByZWNpbmN0LmluY2x1c2lvblRyZWUgPSBpbmNsdXNpb25UcmVlOwogICAgICAgICAgcHJlY2luY3QuemVyb0JpdFBsYW5lc1RyZWUgPSB6ZXJvQml0UGxhbmVzVHJlZTsKCiAgICAgICAgICBmb3IgKGxldCBsID0gMDsgbCA8IGxheWVyTnVtYmVyOyBsKyspIHsKICAgICAgICAgICAgaWYgKHJlYWRCaXRzKDEpICE9PSAwKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpweEVycm9yKCJJbnZhbGlkIHRhZyB0cmVlIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChpbmNsdXNpb25UcmVlLnJlc2V0KGNvZGVibG9ja0NvbHVtbiwgY29kZWJsb2NrUm93LCBsYXllck51bWJlcikpIHsKICAgICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIGlmIChyZWFkQml0cygxKSkgewogICAgICAgICAgICAgIHZhbHVlUmVhZHkgPSAhaW5jbHVzaW9uVHJlZS5uZXh0TGV2ZWwoKTsKCiAgICAgICAgICAgICAgaWYgKHZhbHVlUmVhZHkpIHsKICAgICAgICAgICAgICAgIGNvZGVibG9jay5pbmNsdWRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjb2RlYmxvY2tJbmNsdWRlZCA9IGZpcnN0VGltZUluY2x1c2lvbiA9IHRydWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaW5jbHVzaW9uVHJlZS5pbmNyZW1lbnRWYWx1ZShsYXllck51bWJlcik7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghY29kZWJsb2NrSW5jbHVkZWQpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKGZpcnN0VGltZUluY2x1c2lvbikgewogICAgICAgIHplcm9CaXRQbGFuZXNUcmVlID0gcHJlY2luY3QuemVyb0JpdFBsYW5lc1RyZWU7CiAgICAgICAgemVyb0JpdFBsYW5lc1RyZWUucmVzZXQoY29kZWJsb2NrQ29sdW1uLCBjb2RlYmxvY2tSb3cpOwoKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgaWYgKHJlYWRCaXRzKDEpKSB7CiAgICAgICAgICAgIHZhbHVlUmVhZHkgPSAhemVyb0JpdFBsYW5lc1RyZWUubmV4dExldmVsKCk7CgogICAgICAgICAgICBpZiAodmFsdWVSZWFkeSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB6ZXJvQml0UGxhbmVzVHJlZS5pbmNyZW1lbnRWYWx1ZSgpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29kZWJsb2NrLnplcm9CaXRQbGFuZXMgPSB6ZXJvQml0UGxhbmVzVHJlZS52YWx1ZTsKICAgICAgfQoKICAgICAgY29uc3QgY29kaW5ncGFzc2VzID0gcmVhZENvZGluZ3Bhc3NlcygpOwoKICAgICAgd2hpbGUgKHJlYWRCaXRzKDEpKSB7CiAgICAgICAgY29kZWJsb2NrLkxibG9jaysrOwogICAgICB9CgogICAgICBjb25zdCBjb2RpbmdwYXNzZXNMb2cyID0gKDAsIF9jb3JlX3V0aWxzLmxvZzIpKGNvZGluZ3Bhc3Nlcyk7CiAgICAgIGNvbnN0IGJpdHMgPSAoY29kaW5ncGFzc2VzIDwgMSA8PCBjb2RpbmdwYXNzZXNMb2cyID8gY29kaW5ncGFzc2VzTG9nMiAtIDEgOiBjb2RpbmdwYXNzZXNMb2cyKSArIGNvZGVibG9jay5MYmxvY2s7CiAgICAgIGNvbnN0IGNvZGVkRGF0YUxlbmd0aCA9IHJlYWRCaXRzKGJpdHMpOwogICAgICBxdWV1ZS5wdXNoKHsKICAgICAgICBjb2RlYmxvY2ssCiAgICAgICAgY29kaW5ncGFzc2VzLAogICAgICAgIGRhdGFMZW5ndGg6IGNvZGVkRGF0YUxlbmd0aAogICAgICB9KTsKICAgIH0KCiAgICBhbGlnblRvQnl0ZSgpOwoKICAgIGlmIChlcGhNYXJrZXJVc2VkKSB7CiAgICAgIHNraXBNYXJrZXJJZkVxdWFsKDB4OTIpOwogICAgfQoKICAgIHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwKSB7CiAgICAgIGNvbnN0IHBhY2tldEl0ZW0gPSBxdWV1ZS5zaGlmdCgpOwogICAgICBjb2RlYmxvY2sgPSBwYWNrZXRJdGVtLmNvZGVibG9jazsKCiAgICAgIGlmIChjb2RlYmxvY2suZGF0YSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29kZWJsb2NrLmRhdGEgPSBbXTsKICAgICAgfQoKICAgICAgY29kZWJsb2NrLmRhdGEucHVzaCh7CiAgICAgICAgZGF0YSwKICAgICAgICBzdGFydDogb2Zmc2V0ICsgcG9zaXRpb24sCiAgICAgICAgZW5kOiBvZmZzZXQgKyBwb3NpdGlvbiArIHBhY2tldEl0ZW0uZGF0YUxlbmd0aCwKICAgICAgICBjb2RpbmdwYXNzZXM6IHBhY2tldEl0ZW0uY29kaW5ncGFzc2VzCiAgICAgIH0pOwogICAgICBwb3NpdGlvbiArPSBwYWNrZXRJdGVtLmRhdGFMZW5ndGg7CiAgICB9CiAgfQoKICByZXR1cm4gcG9zaXRpb247Cn0KCmZ1bmN0aW9uIGNvcHlDb2VmZmljaWVudHMoY29lZmZpY2llbnRzLCBsZXZlbFdpZHRoLCBsZXZlbEhlaWdodCwgc3ViYmFuZCwgZGVsdGEsIG1iLCByZXZlcnNpYmxlLCBzZWdtZW50YXRpb25TeW1ib2xVc2VkLCByZXNldENvbnRleHRQcm9iYWJpbGl0aWVzKSB7CiAgY29uc3QgeDAgPSBzdWJiYW5kLnRieDA7CiAgY29uc3QgeTAgPSBzdWJiYW5kLnRieTA7CiAgY29uc3Qgd2lkdGggPSBzdWJiYW5kLnRieDEgLSBzdWJiYW5kLnRieDA7CiAgY29uc3QgY29kZWJsb2NrcyA9IHN1YmJhbmQuY29kZWJsb2NrczsKICBjb25zdCByaWdodCA9IHN1YmJhbmQudHlwZS5jaGFyQXQoMCkgPT09ICJIIiA/IDEgOiAwOwogIGNvbnN0IGJvdHRvbSA9IHN1YmJhbmQudHlwZS5jaGFyQXQoMSkgPT09ICJIIiA/IGxldmVsV2lkdGggOiAwOwoKICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb2RlYmxvY2tzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgIGNvbnN0IGNvZGVibG9jayA9IGNvZGVibG9ja3NbaV07CiAgICBjb25zdCBibG9ja1dpZHRoID0gY29kZWJsb2NrLnRieDFfIC0gY29kZWJsb2NrLnRieDBfOwogICAgY29uc3QgYmxvY2tIZWlnaHQgPSBjb2RlYmxvY2sudGJ5MV8gLSBjb2RlYmxvY2sudGJ5MF87CgogICAgaWYgKGJsb2NrV2lkdGggPT09IDAgfHwgYmxvY2tIZWlnaHQgPT09IDApIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgaWYgKGNvZGVibG9jay5kYXRhID09PSB1bmRlZmluZWQpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgY29uc3QgYml0TW9kZWwgPSBuZXcgQml0TW9kZWwoYmxvY2tXaWR0aCwgYmxvY2tIZWlnaHQsIGNvZGVibG9jay5zdWJiYW5kVHlwZSwgY29kZWJsb2NrLnplcm9CaXRQbGFuZXMsIG1iKTsKICAgIGxldCBjdXJyZW50Q29kaW5ncGFzc1R5cGUgPSAyOwogICAgY29uc3QgZGF0YSA9IGNvZGVibG9jay5kYXRhOwogICAgbGV0IHRvdGFsTGVuZ3RoID0gMCwKICAgICAgICBjb2RpbmdwYXNzZXMgPSAwOwogICAgbGV0IGosIGpqLCBkYXRhSXRlbTsKCiAgICBmb3IgKGogPSAwLCBqaiA9IGRhdGEubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICBkYXRhSXRlbSA9IGRhdGFbal07CiAgICAgIHRvdGFsTGVuZ3RoICs9IGRhdGFJdGVtLmVuZCAtIGRhdGFJdGVtLnN0YXJ0OwogICAgICBjb2RpbmdwYXNzZXMgKz0gZGF0YUl0ZW0uY29kaW5ncGFzc2VzOwogICAgfQoKICAgIGNvbnN0IGVuY29kZWREYXRhID0gbmV3IFVpbnQ4QXJyYXkodG90YWxMZW5ndGgpOwogICAgbGV0IHBvc2l0aW9uID0gMDsKCiAgICBmb3IgKGogPSAwLCBqaiA9IGRhdGEubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICBkYXRhSXRlbSA9IGRhdGFbal07CiAgICAgIGNvbnN0IGNodW5rID0gZGF0YUl0ZW0uZGF0YS5zdWJhcnJheShkYXRhSXRlbS5zdGFydCwgZGF0YUl0ZW0uZW5kKTsKICAgICAgZW5jb2RlZERhdGEuc2V0KGNodW5rLCBwb3NpdGlvbik7CiAgICAgIHBvc2l0aW9uICs9IGNodW5rLmxlbmd0aDsKICAgIH0KCiAgICBjb25zdCBkZWNvZGVyID0gbmV3IF9hcml0aG1ldGljX2RlY29kZXIuQXJpdGhtZXRpY0RlY29kZXIoZW5jb2RlZERhdGEsIDAsIHRvdGFsTGVuZ3RoKTsKICAgIGJpdE1vZGVsLnNldERlY29kZXIoZGVjb2Rlcik7CgogICAgZm9yIChqID0gMDsgaiA8IGNvZGluZ3Bhc3NlczsgaisrKSB7CiAgICAgIHN3aXRjaCAoY3VycmVudENvZGluZ3Bhc3NUeXBlKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgYml0TW9kZWwucnVuU2lnbmlmaWNhbmNlUHJvcGFnYXRpb25QYXNzKCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxOgogICAgICAgICAgYml0TW9kZWwucnVuTWFnbml0dWRlUmVmaW5lbWVudFBhc3MoKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBiaXRNb2RlbC5ydW5DbGVhbnVwUGFzcygpOwoKICAgICAgICAgIGlmIChzZWdtZW50YXRpb25TeW1ib2xVc2VkKSB7CiAgICAgICAgICAgIGJpdE1vZGVsLmNoZWNrU2VnbWVudGF0aW9uU3ltYm9sKCk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmIChyZXNldENvbnRleHRQcm9iYWJpbGl0aWVzKSB7CiAgICAgICAgYml0TW9kZWwucmVzZXQoKTsKICAgICAgfQoKICAgICAgY3VycmVudENvZGluZ3Bhc3NUeXBlID0gKGN1cnJlbnRDb2RpbmdwYXNzVHlwZSArIDEpICUgMzsKICAgIH0KCiAgICBsZXQgb2Zmc2V0ID0gY29kZWJsb2NrLnRieDBfIC0geDAgKyAoY29kZWJsb2NrLnRieTBfIC0geTApICogd2lkdGg7CiAgICBjb25zdCBzaWduID0gYml0TW9kZWwuY29lZmZpY2VudHNTaWduOwogICAgY29uc3QgbWFnbml0dWRlID0gYml0TW9kZWwuY29lZmZpY2VudHNNYWduaXR1ZGU7CiAgICBjb25zdCBiaXRzRGVjb2RlZCA9IGJpdE1vZGVsLmJpdHNEZWNvZGVkOwogICAgY29uc3QgbWFnbml0dWRlQ29ycmVjdGlvbiA9IHJldmVyc2libGUgPyAwIDogMC41OwogICAgbGV0IGssIG4sIG5iOwogICAgcG9zaXRpb24gPSAwOwogICAgY29uc3QgaW50ZXJsZWF2ZSA9IHN1YmJhbmQudHlwZSAhPT0gIkxMIjsKCiAgICBmb3IgKGogPSAwOyBqIDwgYmxvY2tIZWlnaHQ7IGorKykgewogICAgICBjb25zdCByb3cgPSBvZmZzZXQgLyB3aWR0aCB8IDA7CiAgICAgIGNvbnN0IGxldmVsT2Zmc2V0ID0gMiAqIHJvdyAqIChsZXZlbFdpZHRoIC0gd2lkdGgpICsgcmlnaHQgKyBib3R0b207CgogICAgICBmb3IgKGsgPSAwOyBrIDwgYmxvY2tXaWR0aDsgaysrKSB7CiAgICAgICAgbiA9IG1hZ25pdHVkZVtwb3NpdGlvbl07CgogICAgICAgIGlmIChuICE9PSAwKSB7CiAgICAgICAgICBuID0gKG4gKyBtYWduaXR1ZGVDb3JyZWN0aW9uKSAqIGRlbHRhOwoKICAgICAgICAgIGlmIChzaWduW3Bvc2l0aW9uXSAhPT0gMCkgewogICAgICAgICAgICBuID0gLW47CiAgICAgICAgICB9CgogICAgICAgICAgbmIgPSBiaXRzRGVjb2RlZFtwb3NpdGlvbl07CiAgICAgICAgICBjb25zdCBwb3MgPSBpbnRlcmxlYXZlID8gbGV2ZWxPZmZzZXQgKyAob2Zmc2V0IDw8IDEpIDogb2Zmc2V0OwoKICAgICAgICAgIGlmIChyZXZlcnNpYmxlICYmIG5iID49IG1iKSB7CiAgICAgICAgICAgIGNvZWZmaWNpZW50c1twb3NdID0gbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvZWZmaWNpZW50c1twb3NdID0gbiAqICgxIDw8IG1iIC0gbmIpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgb2Zmc2V0Kys7CiAgICAgICAgcG9zaXRpb24rKzsKICAgICAgfQoKICAgICAgb2Zmc2V0ICs9IHdpZHRoIC0gYmxvY2tXaWR0aDsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIHRyYW5zZm9ybVRpbGUoY29udGV4dCwgdGlsZSwgYykgewogIGNvbnN0IGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKICBjb25zdCBjb2RpbmdTdHlsZVBhcmFtZXRlcnMgPSBjb21wb25lbnQuY29kaW5nU3R5bGVQYXJhbWV0ZXJzOwogIGNvbnN0IHF1YW50aXphdGlvblBhcmFtZXRlcnMgPSBjb21wb25lbnQucXVhbnRpemF0aW9uUGFyYW1ldGVyczsKICBjb25zdCBkZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgPSBjb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OwogIGNvbnN0IHNwcWNkcyA9IHF1YW50aXphdGlvblBhcmFtZXRlcnMuU1BxY2RzOwogIGNvbnN0IHNjYWxhckV4cG91bmRlZCA9IHF1YW50aXphdGlvblBhcmFtZXRlcnMuc2NhbGFyRXhwb3VuZGVkOwogIGNvbnN0IGd1YXJkQml0cyA9IHF1YW50aXphdGlvblBhcmFtZXRlcnMuZ3VhcmRCaXRzOwogIGNvbnN0IHNlZ21lbnRhdGlvblN5bWJvbFVzZWQgPSBjb2RpbmdTdHlsZVBhcmFtZXRlcnMuc2VnbWVudGF0aW9uU3ltYm9sVXNlZDsKICBjb25zdCByZXNldENvbnRleHRQcm9iYWJpbGl0aWVzID0gY29kaW5nU3R5bGVQYXJhbWV0ZXJzLnJlc2V0Q29udGV4dFByb2JhYmlsaXRpZXM7CiAgY29uc3QgcHJlY2lzaW9uID0gY29udGV4dC5jb21wb25lbnRzW2NdLnByZWNpc2lvbjsKICBjb25zdCByZXZlcnNpYmxlID0gY29kaW5nU3R5bGVQYXJhbWV0ZXJzLnJldmVyc2libGVUcmFuc2Zvcm1hdGlvbjsKICBjb25zdCB0cmFuc2Zvcm0gPSByZXZlcnNpYmxlID8gbmV3IFJldmVyc2libGVUcmFuc2Zvcm0oKSA6IG5ldyBJcnJldmVyc2libGVUcmFuc2Zvcm0oKTsKICBjb25zdCBzdWJiYW5kQ29lZmZpY2llbnRzID0gW107CiAgbGV0IGIgPSAwOwoKICBmb3IgKGxldCBpID0gMDsgaSA8PSBkZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7IGkrKykgewogICAgY29uc3QgcmVzb2x1dGlvbiA9IGNvbXBvbmVudC5yZXNvbHV0aW9uc1tpXTsKICAgIGNvbnN0IHdpZHRoID0gcmVzb2x1dGlvbi50cngxIC0gcmVzb2x1dGlvbi50cngwOwogICAgY29uc3QgaGVpZ2h0ID0gcmVzb2x1dGlvbi50cnkxIC0gcmVzb2x1dGlvbi50cnkwOwogICAgY29uc3QgY29lZmZpY2llbnRzID0gbmV3IEZsb2F0MzJBcnJheSh3aWR0aCAqIGhlaWdodCk7CgogICAgZm9yIChsZXQgaiA9IDAsIGpqID0gcmVzb2x1dGlvbi5zdWJiYW5kcy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgIGxldCBtdSwgZXBzaWxvbjsKCiAgICAgIGlmICghc2NhbGFyRXhwb3VuZGVkKSB7CiAgICAgICAgbXUgPSBzcHFjZHNbMF0ubXU7CiAgICAgICAgZXBzaWxvbiA9IHNwcWNkc1swXS5lcHNpbG9uICsgKGkgPiAwID8gMSAtIGkgOiAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtdSA9IHNwcWNkc1tiXS5tdTsKICAgICAgICBlcHNpbG9uID0gc3BxY2RzW2JdLmVwc2lsb247CiAgICAgICAgYisrOwogICAgICB9CgogICAgICBjb25zdCBzdWJiYW5kID0gcmVzb2x1dGlvbi5zdWJiYW5kc1tqXTsKICAgICAgY29uc3QgZ2FpbkxvZzIgPSBTdWJiYW5kc0dhaW5Mb2cyW3N1YmJhbmQudHlwZV07CiAgICAgIGNvbnN0IGRlbHRhID0gcmV2ZXJzaWJsZSA/IDEgOiAyICoqIChwcmVjaXNpb24gKyBnYWluTG9nMiAtIGVwc2lsb24pICogKDEgKyBtdSAvIDIwNDgpOwogICAgICBjb25zdCBtYiA9IGd1YXJkQml0cyArIGVwc2lsb24gLSAxOwogICAgICBjb3B5Q29lZmZpY2llbnRzKGNvZWZmaWNpZW50cywgd2lkdGgsIGhlaWdodCwgc3ViYmFuZCwgZGVsdGEsIG1iLCByZXZlcnNpYmxlLCBzZWdtZW50YXRpb25TeW1ib2xVc2VkLCByZXNldENvbnRleHRQcm9iYWJpbGl0aWVzKTsKICAgIH0KCiAgICBzdWJiYW5kQ29lZmZpY2llbnRzLnB1c2goewogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICBpdGVtczogY29lZmZpY2llbnRzCiAgICB9KTsKICB9CgogIGNvbnN0IHJlc3VsdCA9IHRyYW5zZm9ybS5jYWxjdWxhdGUoc3ViYmFuZENvZWZmaWNpZW50cywgY29tcG9uZW50LnRjeDAsIGNvbXBvbmVudC50Y3kwKTsKICByZXR1cm4gewogICAgbGVmdDogY29tcG9uZW50LnRjeDAsCiAgICB0b3A6IGNvbXBvbmVudC50Y3kwLAogICAgd2lkdGg6IHJlc3VsdC53aWR0aCwKICAgIGhlaWdodDogcmVzdWx0LmhlaWdodCwKICAgIGl0ZW1zOiByZXN1bHQuaXRlbXMKICB9Owp9CgpmdW5jdGlvbiB0cmFuc2Zvcm1Db21wb25lbnRzKGNvbnRleHQpIHsKICBjb25zdCBzaXogPSBjb250ZXh0LlNJWjsKICBjb25zdCBjb21wb25lbnRzID0gY29udGV4dC5jb21wb25lbnRzOwogIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwogIGNvbnN0IHJlc3VsdEltYWdlcyA9IFtdOwoKICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb250ZXh0LnRpbGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgIGNvbnN0IHRpbGUgPSBjb250ZXh0LnRpbGVzW2ldOwogICAgY29uc3QgdHJhbnNmb3JtZWRUaWxlcyA9IFtdOwoKICAgIGZvciAobGV0IGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgICAgdHJhbnNmb3JtZWRUaWxlc1tjXSA9IHRyYW5zZm9ybVRpbGUoY29udGV4dCwgdGlsZSwgYyk7CiAgICB9CgogICAgY29uc3QgdGlsZTAgPSB0cmFuc2Zvcm1lZFRpbGVzWzBdOwogICAgY29uc3Qgb3V0ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRpbGUwLml0ZW1zLmxlbmd0aCAqIGNvbXBvbmVudHNDb3VudCk7CiAgICBjb25zdCByZXN1bHQgPSB7CiAgICAgIGxlZnQ6IHRpbGUwLmxlZnQsCiAgICAgIHRvcDogdGlsZTAudG9wLAogICAgICB3aWR0aDogdGlsZTAud2lkdGgsCiAgICAgIGhlaWdodDogdGlsZTAuaGVpZ2h0LAogICAgICBpdGVtczogb3V0CiAgICB9OwogICAgbGV0IHNoaWZ0LCBvZmZzZXQ7CiAgICBsZXQgcG9zID0gMCwKICAgICAgICBqLAogICAgICAgIGpqLAogICAgICAgIHkwLAogICAgICAgIHkxLAogICAgICAgIHkyOwoKICAgIGlmICh0aWxlLmNvZGluZ1N0eWxlRGVmYXVsdFBhcmFtZXRlcnMubXVsdGlwbGVDb21wb25lbnRUcmFuc2Zvcm0pIHsKICAgICAgY29uc3QgZm91ckNvbXBvbmVudHMgPSBjb21wb25lbnRzQ291bnQgPT09IDQ7CiAgICAgIGNvbnN0IHkwaXRlbXMgPSB0cmFuc2Zvcm1lZFRpbGVzWzBdLml0ZW1zOwogICAgICBjb25zdCB5MWl0ZW1zID0gdHJhbnNmb3JtZWRUaWxlc1sxXS5pdGVtczsKICAgICAgY29uc3QgeTJpdGVtcyA9IHRyYW5zZm9ybWVkVGlsZXNbMl0uaXRlbXM7CiAgICAgIGNvbnN0IHkzaXRlbXMgPSBmb3VyQ29tcG9uZW50cyA/IHRyYW5zZm9ybWVkVGlsZXNbM10uaXRlbXMgOiBudWxsOwogICAgICBzaGlmdCA9IGNvbXBvbmVudHNbMF0ucHJlY2lzaW9uIC0gODsKICAgICAgb2Zmc2V0ID0gKDEyOCA8PCBzaGlmdCkgKyAwLjU7CiAgICAgIGNvbnN0IGNvbXBvbmVudDAgPSB0aWxlLmNvbXBvbmVudHNbMF07CiAgICAgIGNvbnN0IGFscGhhMDEgPSBjb21wb25lbnRzQ291bnQgLSAzOwogICAgICBqaiA9IHkwaXRlbXMubGVuZ3RoOwoKICAgICAgaWYgKCFjb21wb25lbnQwLmNvZGluZ1N0eWxlUGFyYW1ldGVycy5yZXZlcnNpYmxlVHJhbnNmb3JtYXRpb24pIHsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgamo7IGorKywgcG9zICs9IGFscGhhMDEpIHsKICAgICAgICAgIHkwID0geTBpdGVtc1tqXSArIG9mZnNldDsKICAgICAgICAgIHkxID0geTFpdGVtc1tqXTsKICAgICAgICAgIHkyID0geTJpdGVtc1tqXTsKICAgICAgICAgIG91dFtwb3MrK10gPSB5MCArIDEuNDAyICogeTIgPj4gc2hpZnQ7CiAgICAgICAgICBvdXRbcG9zKytdID0geTAgLSAwLjM0NDEzICogeTEgLSAwLjcxNDE0ICogeTIgPj4gc2hpZnQ7CiAgICAgICAgICBvdXRbcG9zKytdID0geTAgKyAxLjc3MiAqIHkxID4+IHNoaWZ0OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgamo7IGorKywgcG9zICs9IGFscGhhMDEpIHsKICAgICAgICAgIHkwID0geTBpdGVtc1tqXSArIG9mZnNldDsKICAgICAgICAgIHkxID0geTFpdGVtc1tqXTsKICAgICAgICAgIHkyID0geTJpdGVtc1tqXTsKICAgICAgICAgIGNvbnN0IGcgPSB5MCAtICh5MiArIHkxID4+IDIpOwogICAgICAgICAgb3V0W3BvcysrXSA9IGcgKyB5MiA+PiBzaGlmdDsKICAgICAgICAgIG91dFtwb3MrK10gPSBnID4+IHNoaWZ0OwogICAgICAgICAgb3V0W3BvcysrXSA9IGcgKyB5MSA+PiBzaGlmdDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChmb3VyQ29tcG9uZW50cykgewogICAgICAgIGZvciAoaiA9IDAsIHBvcyA9IDM7IGogPCBqajsgaisrLCBwb3MgKz0gNCkgewogICAgICAgICAgb3V0W3Bvc10gPSB5M2l0ZW1zW2pdICsgb2Zmc2V0ID4+IHNoaWZ0OwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBjb21wb25lbnRzQ291bnQ7IGMrKykgewogICAgICAgIGNvbnN0IGl0ZW1zID0gdHJhbnNmb3JtZWRUaWxlc1tjXS5pdGVtczsKICAgICAgICBzaGlmdCA9IGNvbXBvbmVudHNbY10ucHJlY2lzaW9uIC0gODsKICAgICAgICBvZmZzZXQgPSAoMTI4IDw8IHNoaWZ0KSArIDAuNTsKCiAgICAgICAgZm9yIChwb3MgPSBjLCBqID0gMCwgamogPSBpdGVtcy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICBvdXRbcG9zXSA9IGl0ZW1zW2pdICsgb2Zmc2V0ID4+IHNoaWZ0OwogICAgICAgICAgcG9zICs9IGNvbXBvbmVudHNDb3VudDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXN1bHRJbWFnZXMucHVzaChyZXN1bHQpOwogIH0KCiAgcmV0dXJuIHJlc3VsdEltYWdlczsKfQoKZnVuY3Rpb24gaW5pdGlhbGl6ZVRpbGUoY29udGV4dCwgdGlsZUluZGV4KSB7CiAgY29uc3Qgc2l6ID0gY29udGV4dC5TSVo7CiAgY29uc3QgY29tcG9uZW50c0NvdW50ID0gc2l6LkNzaXo7CiAgY29uc3QgdGlsZSA9IGNvbnRleHQudGlsZXNbdGlsZUluZGV4XTsKCiAgZm9yIChsZXQgYyA9IDA7IGMgPCBjb21wb25lbnRzQ291bnQ7IGMrKykgewogICAgY29uc3QgY29tcG9uZW50ID0gdGlsZS5jb21wb25lbnRzW2NdOwogICAgY29uc3QgcWNkT3JRY2MgPSBjb250ZXh0LmN1cnJlbnRUaWxlLlFDQ1tjXSAhPT0gdW5kZWZpbmVkID8gY29udGV4dC5jdXJyZW50VGlsZS5RQ0NbY10gOiBjb250ZXh0LmN1cnJlbnRUaWxlLlFDRDsKICAgIGNvbXBvbmVudC5xdWFudGl6YXRpb25QYXJhbWV0ZXJzID0gcWNkT3JRY2M7CiAgICBjb25zdCBjb2RPckNvYyA9IGNvbnRleHQuY3VycmVudFRpbGUuQ09DW2NdICE9PSB1bmRlZmluZWQgPyBjb250ZXh0LmN1cnJlbnRUaWxlLkNPQ1tjXSA6IGNvbnRleHQuY3VycmVudFRpbGUuQ09EOwogICAgY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycyA9IGNvZE9yQ29jOwogIH0KCiAgdGlsZS5jb2RpbmdTdHlsZURlZmF1bHRQYXJhbWV0ZXJzID0gY29udGV4dC5jdXJyZW50VGlsZS5DT0Q7Cn0KCmNsYXNzIFRhZ1RyZWUgewogIGNvbnN0cnVjdG9yKHdpZHRoLCBoZWlnaHQpIHsKICAgIGNvbnN0IGxldmVsc0xlbmd0aCA9ICgwLCBfY29yZV91dGlscy5sb2cyKShNYXRoLm1heCh3aWR0aCwgaGVpZ2h0KSkgKyAxOwogICAgdGhpcy5sZXZlbHMgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxldmVsc0xlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGxldmVsID0gewogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBpdGVtczogW10KICAgICAgfTsKICAgICAgdGhpcy5sZXZlbHMucHVzaChsZXZlbCk7CiAgICAgIHdpZHRoID0gTWF0aC5jZWlsKHdpZHRoIC8gMik7CiAgICAgIGhlaWdodCA9IE1hdGguY2VpbChoZWlnaHQgLyAyKTsKICAgIH0KICB9CgogIHJlc2V0KGksIGopIHsKICAgIGxldCBjdXJyZW50TGV2ZWwgPSAwLAogICAgICAgIHZhbHVlID0gMCwKICAgICAgICBsZXZlbDsKCiAgICB3aGlsZSAoY3VycmVudExldmVsIDwgdGhpcy5sZXZlbHMubGVuZ3RoKSB7CiAgICAgIGxldmVsID0gdGhpcy5sZXZlbHNbY3VycmVudExldmVsXTsKICAgICAgY29uc3QgaW5kZXggPSBpICsgaiAqIGxldmVsLndpZHRoOwoKICAgICAgaWYgKGxldmVsLml0ZW1zW2luZGV4XSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFsdWUgPSBsZXZlbC5pdGVtc1tpbmRleF07CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGxldmVsLmluZGV4ID0gaW5kZXg7CiAgICAgIGkgPj49IDE7CiAgICAgIGogPj49IDE7CiAgICAgIGN1cnJlbnRMZXZlbCsrOwogICAgfQoKICAgIGN1cnJlbnRMZXZlbC0tOwogICAgbGV2ZWwgPSB0aGlzLmxldmVsc1tjdXJyZW50TGV2ZWxdOwogICAgbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdID0gdmFsdWU7CiAgICB0aGlzLmN1cnJlbnRMZXZlbCA9IGN1cnJlbnRMZXZlbDsKICAgIGRlbGV0ZSB0aGlzLnZhbHVlOwogIH0KCiAgaW5jcmVtZW50VmFsdWUoKSB7CiAgICBjb25zdCBsZXZlbCA9IHRoaXMubGV2ZWxzW3RoaXMuY3VycmVudExldmVsXTsKICAgIGxldmVsLml0ZW1zW2xldmVsLmluZGV4XSsrOwogIH0KCiAgbmV4dExldmVsKCkgewogICAgbGV0IGN1cnJlbnRMZXZlbCA9IHRoaXMuY3VycmVudExldmVsOwogICAgbGV0IGxldmVsID0gdGhpcy5sZXZlbHNbY3VycmVudExldmVsXTsKICAgIGNvbnN0IHZhbHVlID0gbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdOwogICAgY3VycmVudExldmVsLS07CgogICAgaWYgKGN1cnJlbnRMZXZlbCA8IDApIHsKICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdGhpcy5jdXJyZW50TGV2ZWwgPSBjdXJyZW50TGV2ZWw7CiAgICBsZXZlbCA9IHRoaXMubGV2ZWxzW2N1cnJlbnRMZXZlbF07CiAgICBsZXZlbC5pdGVtc1tsZXZlbC5pbmRleF0gPSB2YWx1ZTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCmNsYXNzIEluY2x1c2lvblRyZWUgewogIGNvbnN0cnVjdG9yKHdpZHRoLCBoZWlnaHQsIGRlZmF1bHRWYWx1ZSkgewogICAgY29uc3QgbGV2ZWxzTGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLmxvZzIpKE1hdGgubWF4KHdpZHRoLCBoZWlnaHQpKSArIDE7CiAgICB0aGlzLmxldmVscyA9IFtdOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGV2ZWxzTGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgaXRlbXMgPSBuZXcgVWludDhBcnJheSh3aWR0aCAqIGhlaWdodCk7CgogICAgICBmb3IgKGxldCBqID0gMCwgamogPSBpdGVtcy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgaXRlbXNbal0gPSBkZWZhdWx0VmFsdWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxldmVsID0gewogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBpdGVtcwogICAgICB9OwogICAgICB0aGlzLmxldmVscy5wdXNoKGxldmVsKTsKICAgICAgd2lkdGggPSBNYXRoLmNlaWwod2lkdGggLyAyKTsKICAgICAgaGVpZ2h0ID0gTWF0aC5jZWlsKGhlaWdodCAvIDIpOwogICAgfQogIH0KCiAgcmVzZXQoaSwgaiwgc3RvcFZhbHVlKSB7CiAgICBsZXQgY3VycmVudExldmVsID0gMDsKCiAgICB3aGlsZSAoY3VycmVudExldmVsIDwgdGhpcy5sZXZlbHMubGVuZ3RoKSB7CiAgICAgIGNvbnN0IGxldmVsID0gdGhpcy5sZXZlbHNbY3VycmVudExldmVsXTsKICAgICAgY29uc3QgaW5kZXggPSBpICsgaiAqIGxldmVsLndpZHRoOwogICAgICBsZXZlbC5pbmRleCA9IGluZGV4OwogICAgICBjb25zdCB2YWx1ZSA9IGxldmVsLml0ZW1zW2luZGV4XTsKCiAgICAgIGlmICh2YWx1ZSA9PT0gMHhmZikgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAodmFsdWUgPiBzdG9wVmFsdWUpIHsKICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbCA9IGN1cnJlbnRMZXZlbDsKICAgICAgICB0aGlzLnByb3BhZ2F0ZVZhbHVlcygpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaSA+Pj0gMTsKICAgICAgaiA+Pj0gMTsKICAgICAgY3VycmVudExldmVsKys7CiAgICB9CgogICAgdGhpcy5jdXJyZW50TGV2ZWwgPSBjdXJyZW50TGV2ZWwgLSAxOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBpbmNyZW1lbnRWYWx1ZShzdG9wVmFsdWUpIHsKICAgIGNvbnN0IGxldmVsID0gdGhpcy5sZXZlbHNbdGhpcy5jdXJyZW50TGV2ZWxdOwogICAgbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdID0gc3RvcFZhbHVlICsgMTsKICAgIHRoaXMucHJvcGFnYXRlVmFsdWVzKCk7CiAgfQoKICBwcm9wYWdhdGVWYWx1ZXMoKSB7CiAgICBsZXQgbGV2ZWxJbmRleCA9IHRoaXMuY3VycmVudExldmVsOwogICAgbGV0IGxldmVsID0gdGhpcy5sZXZlbHNbbGV2ZWxJbmRleF07CiAgICBjb25zdCBjdXJyZW50VmFsdWUgPSBsZXZlbC5pdGVtc1tsZXZlbC5pbmRleF07CgogICAgd2hpbGUgKC0tbGV2ZWxJbmRleCA+PSAwKSB7CiAgICAgIGxldmVsID0gdGhpcy5sZXZlbHNbbGV2ZWxJbmRleF07CiAgICAgIGxldmVsLml0ZW1zW2xldmVsLmluZGV4XSA9IGN1cnJlbnRWYWx1ZTsKICAgIH0KICB9CgogIG5leHRMZXZlbCgpIHsKICAgIGxldCBjdXJyZW50TGV2ZWwgPSB0aGlzLmN1cnJlbnRMZXZlbDsKICAgIGxldCBsZXZlbCA9IHRoaXMubGV2ZWxzW2N1cnJlbnRMZXZlbF07CiAgICBjb25zdCB2YWx1ZSA9IGxldmVsLml0ZW1zW2xldmVsLmluZGV4XTsKICAgIGxldmVsLml0ZW1zW2xldmVsLmluZGV4XSA9IDB4ZmY7CiAgICBjdXJyZW50TGV2ZWwtLTsKCiAgICBpZiAoY3VycmVudExldmVsIDwgMCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdGhpcy5jdXJyZW50TGV2ZWwgPSBjdXJyZW50TGV2ZWw7CiAgICBsZXZlbCA9IHRoaXMubGV2ZWxzW2N1cnJlbnRMZXZlbF07CiAgICBsZXZlbC5pdGVtc1tsZXZlbC5pbmRleF0gPSB2YWx1ZTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCmNvbnN0IEJpdE1vZGVsID0gZnVuY3Rpb24gQml0TW9kZWxDbG9zdXJlKCkgewogIGNvbnN0IFVOSUZPUk1fQ09OVEVYVCA9IDE3OwogIGNvbnN0IFJVTkxFTkdUSF9DT05URVhUID0gMTg7CiAgY29uc3QgTExBbmRMSENvbnRleHRzTGFiZWwgPSBuZXcgVWludDhBcnJheShbMCwgNSwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMSwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMiwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMiwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMiwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOF0pOwogIGNvbnN0IEhMQ29udGV4dExhYmVsID0gbmV3IFVpbnQ4QXJyYXkoWzAsIDMsIDQsIDAsIDUsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDEsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDIsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDIsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDIsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDhdKTsKICBjb25zdCBISENvbnRleHRMYWJlbCA9IG5ldyBVaW50OEFycmF5KFswLCAxLCAyLCAwLCAxLCAyLCAyLCAwLCAyLCAyLCAyLCAwLCAwLCAwLCAwLCAwLCAzLCA0LCA1LCAwLCA0LCA1LCA1LCAwLCA1LCA1LCA1LCAwLCAwLCAwLCAwLCAwLCA2LCA3LCA3LCAwLCA3LCA3LCA3LCAwLCA3LCA3LCA3LCAwLCAwLCAwLCAwLCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4LCAwLCAwLCAwLCAwLCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4XSk7CgogIGNsYXNzIEJpdE1vZGVsIHsKICAgIGNvbnN0cnVjdG9yKHdpZHRoLCBoZWlnaHQsIHN1YmJhbmQsIHplcm9CaXRQbGFuZXMsIG1iKSB7CiAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIGxldCBjb250ZXh0TGFiZWxUYWJsZTsKCiAgICAgIGlmIChzdWJiYW5kID09PSAiSEgiKSB7CiAgICAgICAgY29udGV4dExhYmVsVGFibGUgPSBISENvbnRleHRMYWJlbDsKICAgICAgfSBlbHNlIGlmIChzdWJiYW5kID09PSAiSEwiKSB7CiAgICAgICAgY29udGV4dExhYmVsVGFibGUgPSBITENvbnRleHRMYWJlbDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb250ZXh0TGFiZWxUYWJsZSA9IExMQW5kTEhDb250ZXh0c0xhYmVsOwogICAgICB9CgogICAgICB0aGlzLmNvbnRleHRMYWJlbFRhYmxlID0gY29udGV4dExhYmVsVGFibGU7CiAgICAgIGNvbnN0IGNvZWZmaWNpZW50Q291bnQgPSB3aWR0aCAqIGhlaWdodDsKICAgICAgdGhpcy5uZWlnaGJvcnNTaWduaWZpY2FuY2UgPSBuZXcgVWludDhBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgdGhpcy5jb2VmZmljZW50c1NpZ24gPSBuZXcgVWludDhBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgbGV0IGNvZWZmaWNlbnRzTWFnbml0dWRlOwoKICAgICAgaWYgKG1iID4gMTQpIHsKICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZSA9IG5ldyBVaW50MzJBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgfSBlbHNlIGlmIChtYiA+IDYpIHsKICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZSA9IG5ldyBVaW50MTZBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZSA9IG5ldyBVaW50OEFycmF5KGNvZWZmaWNpZW50Q291bnQpOwogICAgICB9CgogICAgICB0aGlzLmNvZWZmaWNlbnRzTWFnbml0dWRlID0gY29lZmZpY2VudHNNYWduaXR1ZGU7CiAgICAgIHRoaXMucHJvY2Vzc2luZ0ZsYWdzID0gbmV3IFVpbnQ4QXJyYXkoY29lZmZpY2llbnRDb3VudCk7CiAgICAgIGNvbnN0IGJpdHNEZWNvZGVkID0gbmV3IFVpbnQ4QXJyYXkoY29lZmZpY2llbnRDb3VudCk7CgogICAgICBpZiAoemVyb0JpdFBsYW5lcyAhPT0gMCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29lZmZpY2llbnRDb3VudDsgaSsrKSB7CiAgICAgICAgICBiaXRzRGVjb2RlZFtpXSA9IHplcm9CaXRQbGFuZXM7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJpdHNEZWNvZGVkID0gYml0c0RlY29kZWQ7CiAgICAgIHRoaXMucmVzZXQoKTsKICAgIH0KCiAgICBzZXREZWNvZGVyKGRlY29kZXIpIHsKICAgICAgdGhpcy5kZWNvZGVyID0gZGVjb2RlcjsKICAgIH0KCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5jb250ZXh0cyA9IG5ldyBJbnQ4QXJyYXkoMTkpOwogICAgICB0aGlzLmNvbnRleHRzWzBdID0gNCA8PCAxIHwgMDsKICAgICAgdGhpcy5jb250ZXh0c1tVTklGT1JNX0NPTlRFWFRdID0gNDYgPDwgMSB8IDA7CiAgICAgIHRoaXMuY29udGV4dHNbUlVOTEVOR1RIX0NPTlRFWFRdID0gMyA8PCAxIHwgMDsKICAgIH0KCiAgICBzZXROZWlnaGJvcnNTaWduaWZpY2FuY2Uocm93LCBjb2x1bW4sIGluZGV4KSB7CiAgICAgIGNvbnN0IG5laWdoYm9yc1NpZ25pZmljYW5jZSA9IHRoaXMubmVpZ2hib3JzU2lnbmlmaWNhbmNlOwogICAgICBjb25zdCB3aWR0aCA9IHRoaXMud2lkdGgsCiAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgICBjb25zdCBsZWZ0ID0gY29sdW1uID4gMDsKICAgICAgY29uc3QgcmlnaHQgPSBjb2x1bW4gKyAxIDwgd2lkdGg7CiAgICAgIGxldCBpOwoKICAgICAgaWYgKHJvdyA+IDApIHsKICAgICAgICBpID0gaW5kZXggLSB3aWR0aDsKCiAgICAgICAgaWYgKGxlZnQpIHsKICAgICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpIC0gMV0gKz0gMHgxMDsKICAgICAgICB9CgogICAgICAgIGlmIChyaWdodCkgewogICAgICAgICAgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2kgKyAxXSArPSAweDEwOwogICAgICAgIH0KCiAgICAgICAgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2ldICs9IDB4MDQ7CiAgICAgIH0KCiAgICAgIGlmIChyb3cgKyAxIDwgaGVpZ2h0KSB7CiAgICAgICAgaSA9IGluZGV4ICsgd2lkdGg7CgogICAgICAgIGlmIChsZWZ0KSB7CiAgICAgICAgICBuZWlnaGJvcnNTaWduaWZpY2FuY2VbaSAtIDFdICs9IDB4MTA7CiAgICAgICAgfQoKICAgICAgICBpZiAocmlnaHQpIHsKICAgICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpICsgMV0gKz0gMHgxMDsKICAgICAgICB9CgogICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpXSArPSAweDA0OwogICAgICB9CgogICAgICBpZiAobGVmdCkgewogICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleCAtIDFdICs9IDB4MDE7CiAgICAgIH0KCiAgICAgIGlmIChyaWdodCkgewogICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleCArIDFdICs9IDB4MDE7CiAgICAgIH0KCiAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleF0gfD0gMHg4MDsKICAgIH0KCiAgICBydW5TaWduaWZpY2FuY2VQcm9wYWdhdGlvblBhc3MoKSB7CiAgICAgIGNvbnN0IGRlY29kZXIgPSB0aGlzLmRlY29kZXI7CiAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy53aWR0aCwKICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7CiAgICAgIGNvbnN0IGNvZWZmaWNlbnRzTWFnbml0dWRlID0gdGhpcy5jb2VmZmljZW50c01hZ25pdHVkZTsKICAgICAgY29uc3QgY29lZmZpY2VudHNTaWduID0gdGhpcy5jb2VmZmljZW50c1NpZ247CiAgICAgIGNvbnN0IG5laWdoYm9yc1NpZ25pZmljYW5jZSA9IHRoaXMubmVpZ2hib3JzU2lnbmlmaWNhbmNlOwogICAgICBjb25zdCBwcm9jZXNzaW5nRmxhZ3MgPSB0aGlzLnByb2Nlc3NpbmdGbGFnczsKICAgICAgY29uc3QgY29udGV4dHMgPSB0aGlzLmNvbnRleHRzOwogICAgICBjb25zdCBsYWJlbHMgPSB0aGlzLmNvbnRleHRMYWJlbFRhYmxlOwogICAgICBjb25zdCBiaXRzRGVjb2RlZCA9IHRoaXMuYml0c0RlY29kZWQ7CiAgICAgIGNvbnN0IHByb2Nlc3NlZEludmVyc2VNYXNrID0gfjE7CiAgICAgIGNvbnN0IHByb2Nlc3NlZE1hc2sgPSAxOwogICAgICBjb25zdCBmaXJzdE1hZ25pdHVkZUJpdE1hc2sgPSAyOwoKICAgICAgZm9yIChsZXQgaTAgPSAwOyBpMCA8IGhlaWdodDsgaTAgKz0gNCkgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgICAgbGV0IGluZGV4ID0gaTAgKiB3aWR0aCArIGo7CgogICAgICAgICAgZm9yIChsZXQgaTEgPSAwOyBpMSA8IDQ7IGkxKyssIGluZGV4ICs9IHdpZHRoKSB7CiAgICAgICAgICAgIGNvbnN0IGkgPSBpMCArIGkxOwoKICAgICAgICAgICAgaWYgKGkgPj0gaGVpZ2h0KSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gJj0gcHJvY2Vzc2VkSW52ZXJzZU1hc2s7CgogICAgICAgICAgICBpZiAoY29lZmZpY2VudHNNYWduaXR1ZGVbaW5kZXhdIHx8ICFuZWlnaGJvcnNTaWduaWZpY2FuY2VbaW5kZXhdKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGNvbnRleHRMYWJlbCA9IGxhYmVsc1tuZWlnaGJvcnNTaWduaWZpY2FuY2VbaW5kZXhdXTsKICAgICAgICAgICAgY29uc3QgZGVjaXNpb24gPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIGNvbnRleHRMYWJlbCk7CgogICAgICAgICAgICBpZiAoZGVjaXNpb24pIHsKICAgICAgICAgICAgICBjb25zdCBzaWduID0gdGhpcy5kZWNvZGVTaWduQml0KGksIGosIGluZGV4KTsKICAgICAgICAgICAgICBjb2VmZmljZW50c1NpZ25baW5kZXhdID0gc2lnbjsKICAgICAgICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gPSAxOwogICAgICAgICAgICAgIHRoaXMuc2V0TmVpZ2hib3JzU2lnbmlmaWNhbmNlKGksIGosIGluZGV4KTsKICAgICAgICAgICAgICBwcm9jZXNzaW5nRmxhZ3NbaW5kZXhdIHw9IGZpcnN0TWFnbml0dWRlQml0TWFzazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYml0c0RlY29kZWRbaW5kZXhdKys7CiAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gfD0gcHJvY2Vzc2VkTWFzazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBkZWNvZGVTaWduQml0KHJvdywgY29sdW1uLCBpbmRleCkgewogICAgICBjb25zdCB3aWR0aCA9IHRoaXMud2lkdGgsCiAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgICBjb25zdCBjb2VmZmljZW50c01hZ25pdHVkZSA9IHRoaXMuY29lZmZpY2VudHNNYWduaXR1ZGU7CiAgICAgIGNvbnN0IGNvZWZmaWNlbnRzU2lnbiA9IHRoaXMuY29lZmZpY2VudHNTaWduOwogICAgICBsZXQgY29udHJpYnV0aW9uLCBzaWduMCwgc2lnbjEsIHNpZ25pZmljYW5jZTE7CiAgICAgIGxldCBjb250ZXh0TGFiZWwsIGRlY29kZWQ7CiAgICAgIHNpZ25pZmljYW5jZTEgPSBjb2x1bW4gPiAwICYmIGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4IC0gMV0gIT09IDA7CgogICAgICBpZiAoY29sdW1uICsgMSA8IHdpZHRoICYmIGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4ICsgMV0gIT09IDApIHsKICAgICAgICBzaWduMSA9IGNvZWZmaWNlbnRzU2lnbltpbmRleCArIDFdOwoKICAgICAgICBpZiAoc2lnbmlmaWNhbmNlMSkgewogICAgICAgICAgc2lnbjAgPSBjb2VmZmljZW50c1NpZ25baW5kZXggLSAxXTsKICAgICAgICAgIGNvbnRyaWJ1dGlvbiA9IDEgLSBzaWduMSAtIHNpZ24wOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb250cmlidXRpb24gPSAxIC0gc2lnbjEgLSBzaWduMTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoc2lnbmlmaWNhbmNlMSkgewogICAgICAgIHNpZ24wID0gY29lZmZpY2VudHNTaWduW2luZGV4IC0gMV07CiAgICAgICAgY29udHJpYnV0aW9uID0gMSAtIHNpZ24wIC0gc2lnbjA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udHJpYnV0aW9uID0gMDsKICAgICAgfQoKICAgICAgY29uc3QgaG9yaXpvbnRhbENvbnRyaWJ1dGlvbiA9IDMgKiBjb250cmlidXRpb247CiAgICAgIHNpZ25pZmljYW5jZTEgPSByb3cgPiAwICYmIGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4IC0gd2lkdGhdICE9PSAwOwoKICAgICAgaWYgKHJvdyArIDEgPCBoZWlnaHQgJiYgY29lZmZpY2VudHNNYWduaXR1ZGVbaW5kZXggKyB3aWR0aF0gIT09IDApIHsKICAgICAgICBzaWduMSA9IGNvZWZmaWNlbnRzU2lnbltpbmRleCArIHdpZHRoXTsKCiAgICAgICAgaWYgKHNpZ25pZmljYW5jZTEpIHsKICAgICAgICAgIHNpZ24wID0gY29lZmZpY2VudHNTaWduW2luZGV4IC0gd2lkdGhdOwogICAgICAgICAgY29udHJpYnV0aW9uID0gMSAtIHNpZ24xIC0gc2lnbjAgKyBob3Jpem9udGFsQ29udHJpYnV0aW9uOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb250cmlidXRpb24gPSAxIC0gc2lnbjEgLSBzaWduMSArIGhvcml6b250YWxDb250cmlidXRpb247CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHNpZ25pZmljYW5jZTEpIHsKICAgICAgICBzaWduMCA9IGNvZWZmaWNlbnRzU2lnbltpbmRleCAtIHdpZHRoXTsKICAgICAgICBjb250cmlidXRpb24gPSAxIC0gc2lnbjAgLSBzaWduMCArIGhvcml6b250YWxDb250cmlidXRpb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udHJpYnV0aW9uID0gaG9yaXpvbnRhbENvbnRyaWJ1dGlvbjsKICAgICAgfQoKICAgICAgaWYgKGNvbnRyaWJ1dGlvbiA+PSAwKSB7CiAgICAgICAgY29udGV4dExhYmVsID0gOSArIGNvbnRyaWJ1dGlvbjsKICAgICAgICBkZWNvZGVkID0gdGhpcy5kZWNvZGVyLnJlYWRCaXQodGhpcy5jb250ZXh0cywgY29udGV4dExhYmVsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb250ZXh0TGFiZWwgPSA5IC0gY29udHJpYnV0aW9uOwogICAgICAgIGRlY29kZWQgPSB0aGlzLmRlY29kZXIucmVhZEJpdCh0aGlzLmNvbnRleHRzLCBjb250ZXh0TGFiZWwpIF4gMTsKICAgICAgfQoKICAgICAgcmV0dXJuIGRlY29kZWQ7CiAgICB9CgogICAgcnVuTWFnbml0dWRlUmVmaW5lbWVudFBhc3MoKSB7CiAgICAgIGNvbnN0IGRlY29kZXIgPSB0aGlzLmRlY29kZXI7CiAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy53aWR0aCwKICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7CiAgICAgIGNvbnN0IGNvZWZmaWNlbnRzTWFnbml0dWRlID0gdGhpcy5jb2VmZmljZW50c01hZ25pdHVkZTsKICAgICAgY29uc3QgbmVpZ2hib3JzU2lnbmlmaWNhbmNlID0gdGhpcy5uZWlnaGJvcnNTaWduaWZpY2FuY2U7CiAgICAgIGNvbnN0IGNvbnRleHRzID0gdGhpcy5jb250ZXh0czsKICAgICAgY29uc3QgYml0c0RlY29kZWQgPSB0aGlzLmJpdHNEZWNvZGVkOwogICAgICBjb25zdCBwcm9jZXNzaW5nRmxhZ3MgPSB0aGlzLnByb2Nlc3NpbmdGbGFnczsKICAgICAgY29uc3QgcHJvY2Vzc2VkTWFzayA9IDE7CiAgICAgIGNvbnN0IGZpcnN0TWFnbml0dWRlQml0TWFzayA9IDI7CiAgICAgIGNvbnN0IGxlbmd0aCA9IHdpZHRoICogaGVpZ2h0OwogICAgICBjb25zdCB3aWR0aDQgPSB3aWR0aCAqIDQ7CgogICAgICBmb3IgKGxldCBpbmRleDAgPSAwLCBpbmRleE5leHQ7IGluZGV4MCA8IGxlbmd0aDsgaW5kZXgwID0gaW5kZXhOZXh0KSB7CiAgICAgICAgaW5kZXhOZXh0ID0gTWF0aC5taW4obGVuZ3RoLCBpbmRleDAgKyB3aWR0aDQpOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHdpZHRoOyBqKyspIHsKICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gaW5kZXgwICsgajsgaW5kZXggPCBpbmRleE5leHQ7IGluZGV4ICs9IHdpZHRoKSB7CiAgICAgICAgICAgIGlmICghY29lZmZpY2VudHNNYWduaXR1ZGVbaW5kZXhdIHx8IChwcm9jZXNzaW5nRmxhZ3NbaW5kZXhdICYgcHJvY2Vzc2VkTWFzaykgIT09IDApIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGNvbnRleHRMYWJlbCA9IDE2OwoKICAgICAgICAgICAgaWYgKChwcm9jZXNzaW5nRmxhZ3NbaW5kZXhdICYgZmlyc3RNYWduaXR1ZGVCaXRNYXNrKSAhPT0gMCkgewogICAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gXj0gZmlyc3RNYWduaXR1ZGVCaXRNYXNrOwogICAgICAgICAgICAgIGNvbnN0IHNpZ25pZmljYW5jZSA9IG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleF0gJiAxMjc7CiAgICAgICAgICAgICAgY29udGV4dExhYmVsID0gc2lnbmlmaWNhbmNlID09PSAwID8gMTUgOiAxNDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgYml0ID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBjb250ZXh0TGFiZWwpOwogICAgICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gPSBjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gPDwgMSB8IGJpdDsKICAgICAgICAgICAgYml0c0RlY29kZWRbaW5kZXhdKys7CiAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gfD0gcHJvY2Vzc2VkTWFzazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBydW5DbGVhbnVwUGFzcygpIHsKICAgICAgY29uc3QgZGVjb2RlciA9IHRoaXMuZGVjb2RlcjsKICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLndpZHRoLAogICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmhlaWdodDsKICAgICAgY29uc3QgbmVpZ2hib3JzU2lnbmlmaWNhbmNlID0gdGhpcy5uZWlnaGJvcnNTaWduaWZpY2FuY2U7CiAgICAgIGNvbnN0IGNvZWZmaWNlbnRzTWFnbml0dWRlID0gdGhpcy5jb2VmZmljZW50c01hZ25pdHVkZTsKICAgICAgY29uc3QgY29lZmZpY2VudHNTaWduID0gdGhpcy5jb2VmZmljZW50c1NpZ247CiAgICAgIGNvbnN0IGNvbnRleHRzID0gdGhpcy5jb250ZXh0czsKICAgICAgY29uc3QgbGFiZWxzID0gdGhpcy5jb250ZXh0TGFiZWxUYWJsZTsKICAgICAgY29uc3QgYml0c0RlY29kZWQgPSB0aGlzLmJpdHNEZWNvZGVkOwogICAgICBjb25zdCBwcm9jZXNzaW5nRmxhZ3MgPSB0aGlzLnByb2Nlc3NpbmdGbGFnczsKICAgICAgY29uc3QgcHJvY2Vzc2VkTWFzayA9IDE7CiAgICAgIGNvbnN0IGZpcnN0TWFnbml0dWRlQml0TWFzayA9IDI7CiAgICAgIGNvbnN0IG9uZVJvd0Rvd24gPSB3aWR0aDsKICAgICAgY29uc3QgdHdvUm93c0Rvd24gPSB3aWR0aCAqIDI7CiAgICAgIGNvbnN0IHRocmVlUm93c0Rvd24gPSB3aWR0aCAqIDM7CiAgICAgIGxldCBpTmV4dDsKCiAgICAgIGZvciAobGV0IGkwID0gMDsgaTAgPCBoZWlnaHQ7IGkwID0gaU5leHQpIHsKICAgICAgICBpTmV4dCA9IE1hdGgubWluKGkwICsgNCwgaGVpZ2h0KTsKICAgICAgICBjb25zdCBpbmRleEJhc2UgPSBpMCAqIHdpZHRoOwogICAgICAgIGNvbnN0IGNoZWNrQWxsRW1wdHkgPSBpMCArIDMgPCBoZWlnaHQ7CgogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgICAgY29uc3QgaW5kZXgwID0gaW5kZXhCYXNlICsgajsKICAgICAgICAgIGNvbnN0IGFsbEVtcHR5ID0gY2hlY2tBbGxFbXB0eSAmJiBwcm9jZXNzaW5nRmxhZ3NbaW5kZXgwXSA9PT0gMCAmJiBwcm9jZXNzaW5nRmxhZ3NbaW5kZXgwICsgb25lUm93RG93bl0gPT09IDAgJiYgcHJvY2Vzc2luZ0ZsYWdzW2luZGV4MCArIHR3b1Jvd3NEb3duXSA9PT0gMCAmJiBwcm9jZXNzaW5nRmxhZ3NbaW5kZXgwICsgdGhyZWVSb3dzRG93bl0gPT09IDAgJiYgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2luZGV4MF0gPT09IDAgJiYgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2luZGV4MCArIG9uZVJvd0Rvd25dID09PSAwICYmIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleDAgKyB0d29Sb3dzRG93bl0gPT09IDAgJiYgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2luZGV4MCArIHRocmVlUm93c0Rvd25dID09PSAwOwogICAgICAgICAgbGV0IGkxID0gMCwKICAgICAgICAgICAgICBpbmRleCA9IGluZGV4MDsKICAgICAgICAgIGxldCBpID0gaTAsCiAgICAgICAgICAgICAgc2lnbjsKCiAgICAgICAgICBpZiAoYWxsRW1wdHkpIHsKICAgICAgICAgICAgY29uc3QgaGFzU2lnbmlmaWNhbnRDb2VmZmljZW50ID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBSVU5MRU5HVEhfQ09OVEVYVCk7CgogICAgICAgICAgICBpZiAoIWhhc1NpZ25pZmljYW50Q29lZmZpY2VudCkgewogICAgICAgICAgICAgIGJpdHNEZWNvZGVkW2luZGV4MF0rKzsKICAgICAgICAgICAgICBiaXRzRGVjb2RlZFtpbmRleDAgKyBvbmVSb3dEb3duXSsrOwogICAgICAgICAgICAgIGJpdHNEZWNvZGVkW2luZGV4MCArIHR3b1Jvd3NEb3duXSsrOwogICAgICAgICAgICAgIGJpdHNEZWNvZGVkW2luZGV4MCArIHRocmVlUm93c0Rvd25dKys7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGkxID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBVTklGT1JNX0NPTlRFWFQpIDw8IDEgfCBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIFVOSUZPUk1fQ09OVEVYVCk7CgogICAgICAgICAgICBpZiAoaTEgIT09IDApIHsKICAgICAgICAgICAgICBpID0gaTAgKyBpMTsKICAgICAgICAgICAgICBpbmRleCArPSBpMSAqIHdpZHRoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzaWduID0gdGhpcy5kZWNvZGVTaWduQml0KGksIGosIGluZGV4KTsKICAgICAgICAgICAgY29lZmZpY2VudHNTaWduW2luZGV4XSA9IHNpZ247CiAgICAgICAgICAgIGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4XSA9IDE7CiAgICAgICAgICAgIHRoaXMuc2V0TmVpZ2hib3JzU2lnbmlmaWNhbmNlKGksIGosIGluZGV4KTsKICAgICAgICAgICAgcHJvY2Vzc2luZ0ZsYWdzW2luZGV4XSB8PSBmaXJzdE1hZ25pdHVkZUJpdE1hc2s7CiAgICAgICAgICAgIGluZGV4ID0gaW5kZXgwOwoKICAgICAgICAgICAgZm9yIChsZXQgaTIgPSBpMDsgaTIgPD0gaTsgaTIrKywgaW5kZXggKz0gd2lkdGgpIHsKICAgICAgICAgICAgICBiaXRzRGVjb2RlZFtpbmRleF0rKzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaTErKzsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKGkgPSBpMCArIGkxOyBpIDwgaU5leHQ7IGkrKywgaW5kZXggKz0gd2lkdGgpIHsKICAgICAgICAgICAgaWYgKGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4XSB8fCAocHJvY2Vzc2luZ0ZsYWdzW2luZGV4XSAmIHByb2Nlc3NlZE1hc2spICE9PSAwKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGNvbnRleHRMYWJlbCA9IGxhYmVsc1tuZWlnaGJvcnNTaWduaWZpY2FuY2VbaW5kZXhdXTsKICAgICAgICAgICAgY29uc3QgZGVjaXNpb24gPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIGNvbnRleHRMYWJlbCk7CgogICAgICAgICAgICBpZiAoZGVjaXNpb24gPT09IDEpIHsKICAgICAgICAgICAgICBzaWduID0gdGhpcy5kZWNvZGVTaWduQml0KGksIGosIGluZGV4KTsKICAgICAgICAgICAgICBjb2VmZmljZW50c1NpZ25baW5kZXhdID0gc2lnbjsKICAgICAgICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gPSAxOwogICAgICAgICAgICAgIHRoaXMuc2V0TmVpZ2hib3JzU2lnbmlmaWNhbmNlKGksIGosIGluZGV4KTsKICAgICAgICAgICAgICBwcm9jZXNzaW5nRmxhZ3NbaW5kZXhdIHw9IGZpcnN0TWFnbml0dWRlQml0TWFzazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYml0c0RlY29kZWRbaW5kZXhdKys7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgY2hlY2tTZWdtZW50YXRpb25TeW1ib2woKSB7CiAgICAgIGNvbnN0IGRlY29kZXIgPSB0aGlzLmRlY29kZXI7CiAgICAgIGNvbnN0IGNvbnRleHRzID0gdGhpcy5jb250ZXh0czsKICAgICAgY29uc3Qgc3ltYm9sID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBVTklGT1JNX0NPTlRFWFQpIDw8IDMgfCBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIFVOSUZPUk1fQ09OVEVYVCkgPDwgMiB8IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgVU5JRk9STV9DT05URVhUKSA8PCAxIHwgZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBVTklGT1JNX0NPTlRFWFQpOwoKICAgICAgaWYgKHN5bWJvbCAhPT0gMHhhKSB7CiAgICAgICAgdGhyb3cgbmV3IEpweEVycm9yKCJJbnZhbGlkIHNlZ21lbnRhdGlvbiBzeW1ib2wiKTsKICAgICAgfQogICAgfQoKICB9CgogIHJldHVybiBCaXRNb2RlbDsKfSgpOwoKY2xhc3MgVHJhbnNmb3JtIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBUcmFuc2Zvcm0pIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQ2Fubm90IGluaXRpYWxpemUgVHJhbnNmb3JtLiIpOwogICAgfQogIH0KCiAgY2FsY3VsYXRlKHN1YmJhbmRzLCB1MCwgdjApIHsKICAgIGxldCBsbCA9IHN1YmJhbmRzWzBdOwoKICAgIGZvciAobGV0IGkgPSAxLCBpaSA9IHN1YmJhbmRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgbGwgPSB0aGlzLml0ZXJhdGUobGwsIHN1YmJhbmRzW2ldLCB1MCwgdjApOwogICAgfQoKICAgIHJldHVybiBsbDsKICB9CgogIGV4dGVuZChidWZmZXIsIG9mZnNldCwgc2l6ZSkgewogICAgbGV0IGkxID0gb2Zmc2V0IC0gMSwKICAgICAgICBqMSA9IG9mZnNldCArIDE7CiAgICBsZXQgaTIgPSBvZmZzZXQgKyBzaXplIC0gMiwKICAgICAgICBqMiA9IG9mZnNldCArIHNpemU7CiAgICBidWZmZXJbaTEtLV0gPSBidWZmZXJbajErK107CiAgICBidWZmZXJbajIrK10gPSBidWZmZXJbaTItLV07CiAgICBidWZmZXJbaTEtLV0gPSBidWZmZXJbajErK107CiAgICBidWZmZXJbajIrK10gPSBidWZmZXJbaTItLV07CiAgICBidWZmZXJbaTEtLV0gPSBidWZmZXJbajErK107CiAgICBidWZmZXJbajIrK10gPSBidWZmZXJbaTItLV07CiAgICBidWZmZXJbaTFdID0gYnVmZmVyW2oxXTsKICAgIGJ1ZmZlcltqMl0gPSBidWZmZXJbaTJdOwogIH0KCiAgZmlsdGVyKHgsIG9mZnNldCwgbGVuZ3RoKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYGZpbHRlcmAgY2FsbGVkIik7CiAgfQoKICBpdGVyYXRlKGxsLCBobF9saF9oaCwgdTAsIHYwKSB7CiAgICBjb25zdCBsbFdpZHRoID0gbGwud2lkdGgsCiAgICAgICAgICBsbEhlaWdodCA9IGxsLmhlaWdodDsKICAgIGxldCBsbEl0ZW1zID0gbGwuaXRlbXM7CiAgICBjb25zdCB3aWR0aCA9IGhsX2xoX2hoLndpZHRoOwogICAgY29uc3QgaGVpZ2h0ID0gaGxfbGhfaGguaGVpZ2h0OwogICAgY29uc3QgaXRlbXMgPSBobF9saF9oaC5pdGVtczsKICAgIGxldCBpLCBqLCBrLCBsLCB1LCB2OwoKICAgIGZvciAoayA9IDAsIGkgPSAwOyBpIDwgbGxIZWlnaHQ7IGkrKykgewogICAgICBsID0gaSAqIDIgKiB3aWR0aDsKCiAgICAgIGZvciAoaiA9IDA7IGogPCBsbFdpZHRoOyBqKyssIGsrKywgbCArPSAyKSB7CiAgICAgICAgaXRlbXNbbF0gPSBsbEl0ZW1zW2tdOwogICAgICB9CiAgICB9CgogICAgbGxJdGVtcyA9IGxsLml0ZW1zID0gbnVsbDsKICAgIGNvbnN0IGJ1ZmZlclBhZGRpbmcgPSA0OwogICAgY29uc3Qgcm93QnVmZmVyID0gbmV3IEZsb2F0MzJBcnJheSh3aWR0aCArIDIgKiBidWZmZXJQYWRkaW5nKTsKCiAgICBpZiAod2lkdGggPT09IDEpIHsKICAgICAgaWYgKCh1MCAmIDEpICE9PSAwKSB7CiAgICAgICAgZm9yICh2ID0gMCwgayA9IDA7IHYgPCBoZWlnaHQ7IHYrKywgayArPSB3aWR0aCkgewogICAgICAgICAgaXRlbXNba10gKj0gMC41OwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZm9yICh2ID0gMCwgayA9IDA7IHYgPCBoZWlnaHQ7IHYrKywgayArPSB3aWR0aCkgewogICAgICAgIHJvd0J1ZmZlci5zZXQoaXRlbXMuc3ViYXJyYXkoaywgayArIHdpZHRoKSwgYnVmZmVyUGFkZGluZyk7CiAgICAgICAgdGhpcy5leHRlbmQocm93QnVmZmVyLCBidWZmZXJQYWRkaW5nLCB3aWR0aCk7CiAgICAgICAgdGhpcy5maWx0ZXIocm93QnVmZmVyLCBidWZmZXJQYWRkaW5nLCB3aWR0aCk7CiAgICAgICAgaXRlbXMuc2V0KHJvd0J1ZmZlci5zdWJhcnJheShidWZmZXJQYWRkaW5nLCBidWZmZXJQYWRkaW5nICsgd2lkdGgpLCBrKTsKICAgICAgfQogICAgfQoKICAgIGxldCBudW1CdWZmZXJzID0gMTY7CiAgICBjb25zdCBjb2xCdWZmZXJzID0gW107CgogICAgZm9yIChpID0gMDsgaSA8IG51bUJ1ZmZlcnM7IGkrKykgewogICAgICBjb2xCdWZmZXJzLnB1c2gobmV3IEZsb2F0MzJBcnJheShoZWlnaHQgKyAyICogYnVmZmVyUGFkZGluZykpOwogICAgfQoKICAgIGxldCBiLAogICAgICAgIGN1cnJlbnRCdWZmZXIgPSAwOwogICAgbGwgPSBidWZmZXJQYWRkaW5nICsgaGVpZ2h0OwoKICAgIGlmIChoZWlnaHQgPT09IDEpIHsKICAgICAgaWYgKCh2MCAmIDEpICE9PSAwKSB7CiAgICAgICAgZm9yICh1ID0gMDsgdSA8IHdpZHRoOyB1KyspIHsKICAgICAgICAgIGl0ZW1zW3VdICo9IDAuNTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGZvciAodSA9IDA7IHUgPCB3aWR0aDsgdSsrKSB7CiAgICAgICAgaWYgKGN1cnJlbnRCdWZmZXIgPT09IDApIHsKICAgICAgICAgIG51bUJ1ZmZlcnMgPSBNYXRoLm1pbih3aWR0aCAtIHUsIG51bUJ1ZmZlcnMpOwoKICAgICAgICAgIGZvciAoayA9IHUsIGwgPSBidWZmZXJQYWRkaW5nOyBsIDwgbGw7IGsgKz0gd2lkdGgsIGwrKykgewogICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgbnVtQnVmZmVyczsgYisrKSB7CiAgICAgICAgICAgICAgY29sQnVmZmVyc1tiXVtsXSA9IGl0ZW1zW2sgKyBiXTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGN1cnJlbnRCdWZmZXIgPSBudW1CdWZmZXJzOwogICAgICAgIH0KCiAgICAgICAgY3VycmVudEJ1ZmZlci0tOwogICAgICAgIGNvbnN0IGJ1ZmZlciA9IGNvbEJ1ZmZlcnNbY3VycmVudEJ1ZmZlcl07CiAgICAgICAgdGhpcy5leHRlbmQoYnVmZmVyLCBidWZmZXJQYWRkaW5nLCBoZWlnaHQpOwogICAgICAgIHRoaXMuZmlsdGVyKGJ1ZmZlciwgYnVmZmVyUGFkZGluZywgaGVpZ2h0KTsKCiAgICAgICAgaWYgKGN1cnJlbnRCdWZmZXIgPT09IDApIHsKICAgICAgICAgIGsgPSB1IC0gbnVtQnVmZmVycyArIDE7CgogICAgICAgICAgZm9yIChsID0gYnVmZmVyUGFkZGluZzsgbCA8IGxsOyBrICs9IHdpZHRoLCBsKyspIHsKICAgICAgICAgICAgZm9yIChiID0gMDsgYiA8IG51bUJ1ZmZlcnM7IGIrKykgewogICAgICAgICAgICAgIGl0ZW1zW2sgKyBiXSA9IGNvbEJ1ZmZlcnNbYl1bbF07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gewogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICBpdGVtcwogICAgfTsKICB9Cgp9CgpjbGFzcyBJcnJldmVyc2libGVUcmFuc2Zvcm0gZXh0ZW5kcyBUcmFuc2Zvcm0gewogIGZpbHRlcih4LCBvZmZzZXQsIGxlbmd0aCkgewogICAgY29uc3QgbGVuID0gbGVuZ3RoID4+IDE7CiAgICBvZmZzZXQgfD0gMDsKICAgIGxldCBqLCBuLCBjdXJyZW50LCBuZXh0OwogICAgY29uc3QgYWxwaGEgPSAtMS41ODYxMzQzNDIwNTk5MjQ7CiAgICBjb25zdCBiZXRhID0gLTAuMDUyOTgwMTE4NTcyOTYxOwogICAgY29uc3QgZ2FtbWEgPSAwLjg4MjkxMTA3NTUzMDkzNDsKICAgIGNvbnN0IGRlbHRhID0gMC40NDM1MDY4NTIwNDM5NzE7CiAgICBjb25zdCBLID0gMS4yMzAxNzQxMDQ5MTQwMDE7CiAgICBjb25zdCBLXyA9IDEgLyBLOwogICAgaiA9IG9mZnNldCAtIDM7CgogICAgZm9yIChuID0gbGVuICsgNDsgbi0tOyBqICs9IDIpIHsKICAgICAgeFtqXSAqPSBLXzsKICAgIH0KCiAgICBqID0gb2Zmc2V0IC0gMjsKICAgIGN1cnJlbnQgPSBkZWx0YSAqIHhbaiAtIDFdOwoKICAgIGZvciAobiA9IGxlbiArIDM7IG4tLTsgaiArPSAyKSB7CiAgICAgIG5leHQgPSBkZWx0YSAqIHhbaiArIDFdOwogICAgICB4W2pdID0gSyAqIHhbal0gLSBjdXJyZW50IC0gbmV4dDsKCiAgICAgIGlmIChuLS0pIHsKICAgICAgICBqICs9IDI7CiAgICAgICAgY3VycmVudCA9IGRlbHRhICogeFtqICsgMV07CiAgICAgICAgeFtqXSA9IEsgKiB4W2pdIC0gY3VycmVudCAtIG5leHQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBqID0gb2Zmc2V0IC0gMTsKICAgIGN1cnJlbnQgPSBnYW1tYSAqIHhbaiAtIDFdOwoKICAgIGZvciAobiA9IGxlbiArIDI7IG4tLTsgaiArPSAyKSB7CiAgICAgIG5leHQgPSBnYW1tYSAqIHhbaiArIDFdOwogICAgICB4W2pdIC09IGN1cnJlbnQgKyBuZXh0OwoKICAgICAgaWYgKG4tLSkgewogICAgICAgIGogKz0gMjsKICAgICAgICBjdXJyZW50ID0gZ2FtbWEgKiB4W2ogKyAxXTsKICAgICAgICB4W2pdIC09IGN1cnJlbnQgKyBuZXh0OwogICAgICB9IGVsc2UgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaiA9IG9mZnNldDsKICAgIGN1cnJlbnQgPSBiZXRhICogeFtqIC0gMV07CgogICAgZm9yIChuID0gbGVuICsgMTsgbi0tOyBqICs9IDIpIHsKICAgICAgbmV4dCA9IGJldGEgKiB4W2ogKyAxXTsKICAgICAgeFtqXSAtPSBjdXJyZW50ICsgbmV4dDsKCiAgICAgIGlmIChuLS0pIHsKICAgICAgICBqICs9IDI7CiAgICAgICAgY3VycmVudCA9IGJldGEgKiB4W2ogKyAxXTsKICAgICAgICB4W2pdIC09IGN1cnJlbnQgKyBuZXh0OwogICAgICB9IGVsc2UgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKGxlbiAhPT0gMCkgewogICAgICBqID0gb2Zmc2V0ICsgMTsKICAgICAgY3VycmVudCA9IGFscGhhICogeFtqIC0gMV07CgogICAgICBmb3IgKG4gPSBsZW47IG4tLTsgaiArPSAyKSB7CiAgICAgICAgbmV4dCA9IGFscGhhICogeFtqICsgMV07CiAgICAgICAgeFtqXSAtPSBjdXJyZW50ICsgbmV4dDsKCiAgICAgICAgaWYgKG4tLSkgewogICAgICAgICAgaiArPSAyOwogICAgICAgICAgY3VycmVudCA9IGFscGhhICogeFtqICsgMV07CiAgICAgICAgICB4W2pdIC09IGN1cnJlbnQgKyBuZXh0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cgp9CgpjbGFzcyBSZXZlcnNpYmxlVHJhbnNmb3JtIGV4dGVuZHMgVHJhbnNmb3JtIHsKICBmaWx0ZXIoeCwgb2Zmc2V0LCBsZW5ndGgpIHsKICAgIGNvbnN0IGxlbiA9IGxlbmd0aCA+PiAxOwogICAgb2Zmc2V0IHw9IDA7CiAgICBsZXQgaiwgbjsKCiAgICBmb3IgKGogPSBvZmZzZXQsIG4gPSBsZW4gKyAxOyBuLS07IGogKz0gMikgewogICAgICB4W2pdIC09IHhbaiAtIDFdICsgeFtqICsgMV0gKyAyID4+IDI7CiAgICB9CgogICAgZm9yIChqID0gb2Zmc2V0ICsgMSwgbiA9IGxlbjsgbi0tOyBqICs9IDIpIHsKICAgICAgeFtqXSArPSB4W2ogLSAxXSArIHhbaiArIDFdID4+IDE7CiAgICB9CiAgfQoKfQoKLyoqKi8gfSksCi8qIDE1NiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTFpXU3RyZWFtID0gdm9pZCAwOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDQpOwoKY2xhc3MgTFpXU3RyZWFtIGV4dGVuZHMgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHIsIG1heWJlTGVuZ3RoLCBlYXJseUNoYW5nZSkgewogICAgc3VwZXIobWF5YmVMZW5ndGgpOwogICAgdGhpcy5zdHIgPSBzdHI7CiAgICB0aGlzLmRpY3QgPSBzdHIuZGljdDsKICAgIHRoaXMuY2FjaGVkRGF0YSA9IDA7CiAgICB0aGlzLmJpdHNDYWNoZWQgPSAwOwogICAgY29uc3QgbWF4THp3RGljdGlvbmFyeVNpemUgPSA0MDk2OwogICAgY29uc3QgbHp3U3RhdGUgPSB7CiAgICAgIGVhcmx5Q2hhbmdlLAogICAgICBjb2RlTGVuZ3RoOiA5LAogICAgICBuZXh0Q29kZTogMjU4LAogICAgICBkaWN0aW9uYXJ5VmFsdWVzOiBuZXcgVWludDhBcnJheShtYXhMendEaWN0aW9uYXJ5U2l6ZSksCiAgICAgIGRpY3Rpb25hcnlMZW5ndGhzOiBuZXcgVWludDE2QXJyYXkobWF4THp3RGljdGlvbmFyeVNpemUpLAogICAgICBkaWN0aW9uYXJ5UHJldkNvZGVzOiBuZXcgVWludDE2QXJyYXkobWF4THp3RGljdGlvbmFyeVNpemUpLAogICAgICBjdXJyZW50U2VxdWVuY2U6IG5ldyBVaW50OEFycmF5KG1heEx6d0RpY3Rpb25hcnlTaXplKSwKICAgICAgY3VycmVudFNlcXVlbmNlTGVuZ3RoOiAwCiAgICB9OwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpIHsKICAgICAgbHp3U3RhdGUuZGljdGlvbmFyeVZhbHVlc1tpXSA9IGk7CiAgICAgIGx6d1N0YXRlLmRpY3Rpb25hcnlMZW5ndGhzW2ldID0gMTsKICAgIH0KCiAgICB0aGlzLmx6d1N0YXRlID0gbHp3U3RhdGU7CiAgfQoKICByZWFkQml0cyhuKSB7CiAgICBsZXQgYml0c0NhY2hlZCA9IHRoaXMuYml0c0NhY2hlZDsKICAgIGxldCBjYWNoZWREYXRhID0gdGhpcy5jYWNoZWREYXRhOwoKICAgIHdoaWxlIChiaXRzQ2FjaGVkIDwgbikgewogICAgICBjb25zdCBjID0gdGhpcy5zdHIuZ2V0Qnl0ZSgpOwoKICAgICAgaWYgKGMgPT09IC0xKSB7CiAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBjYWNoZWREYXRhID0gY2FjaGVkRGF0YSA8PCA4IHwgYzsKICAgICAgYml0c0NhY2hlZCArPSA4OwogICAgfQoKICAgIHRoaXMuYml0c0NhY2hlZCA9IGJpdHNDYWNoZWQgLT0gbjsKICAgIHRoaXMuY2FjaGVkRGF0YSA9IGNhY2hlZERhdGE7CiAgICB0aGlzLmxhc3RDb2RlID0gbnVsbDsKICAgIHJldHVybiBjYWNoZWREYXRhID4+PiBiaXRzQ2FjaGVkICYgKDEgPDwgbikgLSAxOwogIH0KCiAgcmVhZEJsb2NrKCkgewogICAgY29uc3QgYmxvY2tTaXplID0gNTEyLAogICAgICAgICAgZGVjb2RlZFNpemVEZWx0YSA9IGJsb2NrU2l6ZTsKICAgIGxldCBlc3RpbWF0ZWREZWNvZGVkU2l6ZSA9IGJsb2NrU2l6ZSAqIDI7CiAgICBsZXQgaSwgaiwgcTsKICAgIGNvbnN0IGx6d1N0YXRlID0gdGhpcy5sendTdGF0ZTsKCiAgICBpZiAoIWx6d1N0YXRlKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBlYXJseUNoYW5nZSA9IGx6d1N0YXRlLmVhcmx5Q2hhbmdlOwogICAgbGV0IG5leHRDb2RlID0gbHp3U3RhdGUubmV4dENvZGU7CiAgICBjb25zdCBkaWN0aW9uYXJ5VmFsdWVzID0gbHp3U3RhdGUuZGljdGlvbmFyeVZhbHVlczsKICAgIGNvbnN0IGRpY3Rpb25hcnlMZW5ndGhzID0gbHp3U3RhdGUuZGljdGlvbmFyeUxlbmd0aHM7CiAgICBjb25zdCBkaWN0aW9uYXJ5UHJldkNvZGVzID0gbHp3U3RhdGUuZGljdGlvbmFyeVByZXZDb2RlczsKICAgIGxldCBjb2RlTGVuZ3RoID0gbHp3U3RhdGUuY29kZUxlbmd0aDsKICAgIGxldCBwcmV2Q29kZSA9IGx6d1N0YXRlLnByZXZDb2RlOwogICAgY29uc3QgY3VycmVudFNlcXVlbmNlID0gbHp3U3RhdGUuY3VycmVudFNlcXVlbmNlOwogICAgbGV0IGN1cnJlbnRTZXF1ZW5jZUxlbmd0aCA9IGx6d1N0YXRlLmN1cnJlbnRTZXF1ZW5jZUxlbmd0aDsKICAgIGxldCBkZWNvZGVkTGVuZ3RoID0gMDsKICAgIGxldCBjdXJyZW50QnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXJMZW5ndGg7CiAgICBsZXQgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIodGhpcy5idWZmZXJMZW5ndGggKyBlc3RpbWF0ZWREZWNvZGVkU2l6ZSk7CgogICAgZm9yIChpID0gMDsgaSA8IGJsb2NrU2l6ZTsgaSsrKSB7CiAgICAgIGNvbnN0IGNvZGUgPSB0aGlzLnJlYWRCaXRzKGNvZGVMZW5ndGgpOwogICAgICBjb25zdCBoYXNQcmV2ID0gY3VycmVudFNlcXVlbmNlTGVuZ3RoID4gMDsKCiAgICAgIGlmIChjb2RlIDwgMjU2KSB7CiAgICAgICAgY3VycmVudFNlcXVlbmNlWzBdID0gY29kZTsKICAgICAgICBjdXJyZW50U2VxdWVuY2VMZW5ndGggPSAxOwogICAgICB9IGVsc2UgaWYgKGNvZGUgPj0gMjU4KSB7CiAgICAgICAgaWYgKGNvZGUgPCBuZXh0Q29kZSkgewogICAgICAgICAgY3VycmVudFNlcXVlbmNlTGVuZ3RoID0gZGljdGlvbmFyeUxlbmd0aHNbY29kZV07CgogICAgICAgICAgZm9yIChqID0gY3VycmVudFNlcXVlbmNlTGVuZ3RoIC0gMSwgcSA9IGNvZGU7IGogPj0gMDsgai0tKSB7CiAgICAgICAgICAgIGN1cnJlbnRTZXF1ZW5jZVtqXSA9IGRpY3Rpb25hcnlWYWx1ZXNbcV07CiAgICAgICAgICAgIHEgPSBkaWN0aW9uYXJ5UHJldkNvZGVzW3FdOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjdXJyZW50U2VxdWVuY2VbY3VycmVudFNlcXVlbmNlTGVuZ3RoKytdID0gY3VycmVudFNlcXVlbmNlWzBdOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChjb2RlID09PSAyNTYpIHsKICAgICAgICBjb2RlTGVuZ3RoID0gOTsKICAgICAgICBuZXh0Q29kZSA9IDI1ODsKICAgICAgICBjdXJyZW50U2VxdWVuY2VMZW5ndGggPSAwOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgICBkZWxldGUgdGhpcy5sendTdGF0ZTsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKGhhc1ByZXYpIHsKICAgICAgICBkaWN0aW9uYXJ5UHJldkNvZGVzW25leHRDb2RlXSA9IHByZXZDb2RlOwogICAgICAgIGRpY3Rpb25hcnlMZW5ndGhzW25leHRDb2RlXSA9IGRpY3Rpb25hcnlMZW5ndGhzW3ByZXZDb2RlXSArIDE7CiAgICAgICAgZGljdGlvbmFyeVZhbHVlc1tuZXh0Q29kZV0gPSBjdXJyZW50U2VxdWVuY2VbMF07CiAgICAgICAgbmV4dENvZGUrKzsKICAgICAgICBjb2RlTGVuZ3RoID0gbmV4dENvZGUgKyBlYXJseUNoYW5nZSAmIG5leHRDb2RlICsgZWFybHlDaGFuZ2UgLSAxID8gY29kZUxlbmd0aCA6IE1hdGgubWluKE1hdGgubG9nKG5leHRDb2RlICsgZWFybHlDaGFuZ2UpIC8gMC42OTMxNDcxODA1NTk5NDUzICsgMSwgMTIpIHwgMDsKICAgICAgfQoKICAgICAgcHJldkNvZGUgPSBjb2RlOwogICAgICBkZWNvZGVkTGVuZ3RoICs9IGN1cnJlbnRTZXF1ZW5jZUxlbmd0aDsKCiAgICAgIGlmIChlc3RpbWF0ZWREZWNvZGVkU2l6ZSA8IGRlY29kZWRMZW5ndGgpIHsKICAgICAgICBkbyB7CiAgICAgICAgICBlc3RpbWF0ZWREZWNvZGVkU2l6ZSArPSBkZWNvZGVkU2l6ZURlbHRhOwogICAgICAgIH0gd2hpbGUgKGVzdGltYXRlZERlY29kZWRTaXplIDwgZGVjb2RlZExlbmd0aCk7CgogICAgICAgIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKHRoaXMuYnVmZmVyTGVuZ3RoICsgZXN0aW1hdGVkRGVjb2RlZFNpemUpOwogICAgICB9CgogICAgICBmb3IgKGogPSAwOyBqIDwgY3VycmVudFNlcXVlbmNlTGVuZ3RoOyBqKyspIHsKICAgICAgICBidWZmZXJbY3VycmVudEJ1ZmZlckxlbmd0aCsrXSA9IGN1cnJlbnRTZXF1ZW5jZVtqXTsKICAgICAgfQogICAgfQoKICAgIGx6d1N0YXRlLm5leHRDb2RlID0gbmV4dENvZGU7CiAgICBsendTdGF0ZS5jb2RlTGVuZ3RoID0gY29kZUxlbmd0aDsKICAgIGx6d1N0YXRlLnByZXZDb2RlID0gcHJldkNvZGU7CiAgICBsendTdGF0ZS5jdXJyZW50U2VxdWVuY2VMZW5ndGggPSBjdXJyZW50U2VxdWVuY2VMZW5ndGg7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGN1cnJlbnRCdWZmZXJMZW5ndGg7CiAgfQoKfQoKZXhwb3J0cy5MWldTdHJlYW0gPSBMWldTdHJlYW07CgovKioqLyB9KSwKLyogMTU3ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5QcmVkaWN0b3JTdHJlYW0gPSB2b2lkIDA7Cgp2YXIgX2RlY29kZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0NCk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMCk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY2xhc3MgUHJlZGljdG9yU3RyZWFtIGV4dGVuZHMgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHIsIG1heWJlTGVuZ3RoLCBwYXJhbXMpIHsKICAgIHN1cGVyKG1heWJlTGVuZ3RoKTsKCiAgICBpZiAoIShwYXJhbXMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm4gc3RyOwogICAgfQoKICAgIGNvbnN0IHByZWRpY3RvciA9IHRoaXMucHJlZGljdG9yID0gcGFyYW1zLmdldCgiUHJlZGljdG9yIikgfHwgMTsKCiAgICBpZiAocHJlZGljdG9yIDw9IDEpIHsKICAgICAgcmV0dXJuIHN0cjsKICAgIH0KCiAgICBpZiAocHJlZGljdG9yICE9PSAyICYmIChwcmVkaWN0b3IgPCAxMCB8fCBwcmVkaWN0b3IgPiAxNSkpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBVbnN1cHBvcnRlZCBwcmVkaWN0b3I6ICR7cHJlZGljdG9yfWApOwogICAgfQoKICAgIGlmIChwcmVkaWN0b3IgPT09IDIpIHsKICAgICAgdGhpcy5yZWFkQmxvY2sgPSB0aGlzLnJlYWRCbG9ja1RpZmY7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnJlYWRCbG9jayA9IHRoaXMucmVhZEJsb2NrUG5nOwogICAgfQoKICAgIHRoaXMuc3RyID0gc3RyOwogICAgdGhpcy5kaWN0ID0gc3RyLmRpY3Q7CiAgICBjb25zdCBjb2xvcnMgPSB0aGlzLmNvbG9ycyA9IHBhcmFtcy5nZXQoIkNvbG9ycyIpIHx8IDE7CiAgICBjb25zdCBiaXRzID0gdGhpcy5iaXRzID0gcGFyYW1zLmdldCgiQlBDIiwgIkJpdHNQZXJDb21wb25lbnQiKSB8fCA4OwogICAgY29uc3QgY29sdW1ucyA9IHRoaXMuY29sdW1ucyA9IHBhcmFtcy5nZXQoIkNvbHVtbnMiKSB8fCAxOwogICAgdGhpcy5waXhCeXRlcyA9IGNvbG9ycyAqIGJpdHMgKyA3ID4+IDM7CiAgICB0aGlzLnJvd0J5dGVzID0gY29sdW1ucyAqIGNvbG9ycyAqIGJpdHMgKyA3ID4+IDM7CiAgICByZXR1cm4gdGhpczsKICB9CgogIHJlYWRCbG9ja1RpZmYoKSB7CiAgICBjb25zdCByb3dCeXRlcyA9IHRoaXMucm93Qnl0ZXM7CiAgICBjb25zdCBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIGNvbnN0IGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKGJ1ZmZlckxlbmd0aCArIHJvd0J5dGVzKTsKICAgIGNvbnN0IGJpdHMgPSB0aGlzLmJpdHM7CiAgICBjb25zdCBjb2xvcnMgPSB0aGlzLmNvbG9yczsKICAgIGNvbnN0IHJhd0J5dGVzID0gdGhpcy5zdHIuZ2V0Qnl0ZXMocm93Qnl0ZXMpOwogICAgdGhpcy5lb2YgPSAhcmF3Qnl0ZXMubGVuZ3RoOwoKICAgIGlmICh0aGlzLmVvZikgewogICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IGluYnVmID0gMCwKICAgICAgICBvdXRidWYgPSAwOwogICAgbGV0IGluYml0cyA9IDAsCiAgICAgICAgb3V0Yml0cyA9IDA7CiAgICBsZXQgcG9zID0gYnVmZmVyTGVuZ3RoOwogICAgbGV0IGk7CgogICAgaWYgKGJpdHMgPT09IDEgJiYgY29sb3JzID09PSAxKSB7CiAgICAgIGZvciAoaSA9IDA7IGkgPCByb3dCeXRlczsgKytpKSB7CiAgICAgICAgbGV0IGMgPSByYXdCeXRlc1tpXSBeIGluYnVmOwogICAgICAgIGMgXj0gYyA+PiAxOwogICAgICAgIGMgXj0gYyA+PiAyOwogICAgICAgIGMgXj0gYyA+PiA0OwogICAgICAgIGluYnVmID0gKGMgJiAxKSA8PCA3OwogICAgICAgIGJ1ZmZlcltwb3MrK10gPSBjOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGJpdHMgPT09IDgpIHsKICAgICAgZm9yIChpID0gMDsgaSA8IGNvbG9yczsgKytpKSB7CiAgICAgICAgYnVmZmVyW3BvcysrXSA9IHJhd0J5dGVzW2ldOwogICAgICB9CgogICAgICBmb3IgKDsgaSA8IHJvd0J5dGVzOyArK2kpIHsKICAgICAgICBidWZmZXJbcG9zXSA9IGJ1ZmZlcltwb3MgLSBjb2xvcnNdICsgcmF3Qnl0ZXNbaV07CiAgICAgICAgcG9zKys7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoYml0cyA9PT0gMTYpIHsKICAgICAgY29uc3QgYnl0ZXNQZXJQaXhlbCA9IGNvbG9ycyAqIDI7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgYnl0ZXNQZXJQaXhlbDsgKytpKSB7CiAgICAgICAgYnVmZmVyW3BvcysrXSA9IHJhd0J5dGVzW2ldOwogICAgICB9CgogICAgICBmb3IgKDsgaSA8IHJvd0J5dGVzOyBpICs9IDIpIHsKICAgICAgICBjb25zdCBzdW0gPSAoKHJhd0J5dGVzW2ldICYgMHhmZikgPDwgOCkgKyAocmF3Qnl0ZXNbaSArIDFdICYgMHhmZikgKyAoKGJ1ZmZlcltwb3MgLSBieXRlc1BlclBpeGVsXSAmIDB4ZmYpIDw8IDgpICsgKGJ1ZmZlcltwb3MgLSBieXRlc1BlclBpeGVsICsgMV0gJiAweGZmKTsKICAgICAgICBidWZmZXJbcG9zKytdID0gc3VtID4+IDggJiAweGZmOwogICAgICAgIGJ1ZmZlcltwb3MrK10gPSBzdW0gJiAweGZmOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjb25zdCBjb21wQXJyYXkgPSBuZXcgVWludDhBcnJheShjb2xvcnMgKyAxKTsKICAgICAgY29uc3QgYml0TWFzayA9ICgxIDw8IGJpdHMpIC0gMTsKICAgICAgbGV0IGogPSAwLAogICAgICAgICAgayA9IGJ1ZmZlckxlbmd0aDsKICAgICAgY29uc3QgY29sdW1ucyA9IHRoaXMuY29sdW1uczsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBjb2x1bW5zOyArK2kpIHsKICAgICAgICBmb3IgKGxldCBrayA9IDA7IGtrIDwgY29sb3JzOyArK2trKSB7CiAgICAgICAgICBpZiAoaW5iaXRzIDwgYml0cykgewogICAgICAgICAgICBpbmJ1ZiA9IGluYnVmIDw8IDggfCByYXdCeXRlc1tqKytdICYgMHhmZjsKICAgICAgICAgICAgaW5iaXRzICs9IDg7CiAgICAgICAgICB9CgogICAgICAgICAgY29tcEFycmF5W2trXSA9IGNvbXBBcnJheVtra10gKyAoaW5idWYgPj4gaW5iaXRzIC0gYml0cykgJiBiaXRNYXNrOwogICAgICAgICAgaW5iaXRzIC09IGJpdHM7CiAgICAgICAgICBvdXRidWYgPSBvdXRidWYgPDwgYml0cyB8IGNvbXBBcnJheVtra107CiAgICAgICAgICBvdXRiaXRzICs9IGJpdHM7CgogICAgICAgICAgaWYgKG91dGJpdHMgPj0gOCkgewogICAgICAgICAgICBidWZmZXJbaysrXSA9IG91dGJ1ZiA+PiBvdXRiaXRzIC0gOCAmIDB4ZmY7CiAgICAgICAgICAgIG91dGJpdHMgLT0gODsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChvdXRiaXRzID4gMCkgewogICAgICAgIGJ1ZmZlcltrKytdID0gKG91dGJ1ZiA8PCA4IC0gb3V0Yml0cykgKyAoaW5idWYgJiAoMSA8PCA4IC0gb3V0Yml0cykgLSAxKTsKICAgICAgfQogICAgfQoKICAgIHRoaXMuYnVmZmVyTGVuZ3RoICs9IHJvd0J5dGVzOwogIH0KCiAgcmVhZEJsb2NrUG5nKCkgewogICAgY29uc3Qgcm93Qnl0ZXMgPSB0aGlzLnJvd0J5dGVzOwogICAgY29uc3QgcGl4Qnl0ZXMgPSB0aGlzLnBpeEJ5dGVzOwogICAgY29uc3QgcHJlZGljdG9yID0gdGhpcy5zdHIuZ2V0Qnl0ZSgpOwogICAgY29uc3QgcmF3Qnl0ZXMgPSB0aGlzLnN0ci5nZXRCeXRlcyhyb3dCeXRlcyk7CiAgICB0aGlzLmVvZiA9ICFyYXdCeXRlcy5sZW5ndGg7CgogICAgaWYgKHRoaXMuZW9mKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIGNvbnN0IGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKGJ1ZmZlckxlbmd0aCArIHJvd0J5dGVzKTsKICAgIGxldCBwcmV2Um93ID0gYnVmZmVyLnN1YmFycmF5KGJ1ZmZlckxlbmd0aCAtIHJvd0J5dGVzLCBidWZmZXJMZW5ndGgpOwoKICAgIGlmIChwcmV2Um93Lmxlbmd0aCA9PT0gMCkgewogICAgICBwcmV2Um93ID0gbmV3IFVpbnQ4QXJyYXkocm93Qnl0ZXMpOwogICAgfQoKICAgIGxldCBpLAogICAgICAgIGogPSBidWZmZXJMZW5ndGgsCiAgICAgICAgdXAsCiAgICAgICAgYzsKCiAgICBzd2l0Y2ggKHByZWRpY3RvcikgewogICAgICBjYXNlIDA6CiAgICAgICAgZm9yIChpID0gMDsgaSA8IHJvd0J5dGVzOyArK2kpIHsKICAgICAgICAgIGJ1ZmZlcltqKytdID0gcmF3Qnl0ZXNbaV07CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMToKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGl4Qnl0ZXM7ICsraSkgewogICAgICAgICAgYnVmZmVyW2orK10gPSByYXdCeXRlc1tpXTsKICAgICAgICB9CgogICAgICAgIGZvciAoOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgICAgYnVmZmVyW2pdID0gYnVmZmVyW2ogLSBwaXhCeXRlc10gKyByYXdCeXRlc1tpXSAmIDB4ZmY7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgICAgYnVmZmVyW2orK10gPSBwcmV2Um93W2ldICsgcmF3Qnl0ZXNbaV0gJiAweGZmOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDM6CiAgICAgICAgZm9yIChpID0gMDsgaSA8IHBpeEJ5dGVzOyArK2kpIHsKICAgICAgICAgIGJ1ZmZlcltqKytdID0gKHByZXZSb3dbaV0gPj4gMSkgKyByYXdCeXRlc1tpXTsKICAgICAgICB9CgogICAgICAgIGZvciAoOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgICAgYnVmZmVyW2pdID0gKHByZXZSb3dbaV0gKyBidWZmZXJbaiAtIHBpeEJ5dGVzXSA+PiAxKSArIHJhd0J5dGVzW2ldICYgMHhmZjsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA0OgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBwaXhCeXRlczsgKytpKSB7CiAgICAgICAgICB1cCA9IHByZXZSb3dbaV07CiAgICAgICAgICBjID0gcmF3Qnl0ZXNbaV07CiAgICAgICAgICBidWZmZXJbaisrXSA9IHVwICsgYzsKICAgICAgICB9CgogICAgICAgIGZvciAoOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgICAgdXAgPSBwcmV2Um93W2ldOwogICAgICAgICAgY29uc3QgdXBMZWZ0ID0gcHJldlJvd1tpIC0gcGl4Qnl0ZXNdOwogICAgICAgICAgY29uc3QgbGVmdCA9IGJ1ZmZlcltqIC0gcGl4Qnl0ZXNdOwogICAgICAgICAgY29uc3QgcCA9IGxlZnQgKyB1cCAtIHVwTGVmdDsKICAgICAgICAgIGxldCBwYSA9IHAgLSBsZWZ0OwoKICAgICAgICAgIGlmIChwYSA8IDApIHsKICAgICAgICAgICAgcGEgPSAtcGE7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IHBiID0gcCAtIHVwOwoKICAgICAgICAgIGlmIChwYiA8IDApIHsKICAgICAgICAgICAgcGIgPSAtcGI7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IHBjID0gcCAtIHVwTGVmdDsKCiAgICAgICAgICBpZiAocGMgPCAwKSB7CiAgICAgICAgICAgIHBjID0gLXBjOwogICAgICAgICAgfQoKICAgICAgICAgIGMgPSByYXdCeXRlc1tpXTsKCiAgICAgICAgICBpZiAocGEgPD0gcGIgJiYgcGEgPD0gcGMpIHsKICAgICAgICAgICAgYnVmZmVyW2orK10gPSBsZWZ0ICsgYzsKICAgICAgICAgIH0gZWxzZSBpZiAocGIgPD0gcGMpIHsKICAgICAgICAgICAgYnVmZmVyW2orK10gPSB1cCArIGM7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBidWZmZXJbaisrXSA9IHVwTGVmdCArIGM7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBVbnN1cHBvcnRlZCBwcmVkaWN0b3I6ICR7cHJlZGljdG9yfWApOwogICAgfQoKICAgIHRoaXMuYnVmZmVyTGVuZ3RoICs9IHJvd0J5dGVzOwogIH0KCn0KCmV4cG9ydHMuUHJlZGljdG9yU3RyZWFtID0gUHJlZGljdG9yU3RyZWFtOwoKLyoqKi8gfSksCi8qIDE1OCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuUnVuTGVuZ3RoU3RyZWFtID0gdm9pZCAwOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDQpOwoKY2xhc3MgUnVuTGVuZ3RoU3RyZWFtIGV4dGVuZHMgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHIsIG1heWJlTGVuZ3RoKSB7CiAgICBzdXBlcihtYXliZUxlbmd0aCk7CiAgICB0aGlzLnN0ciA9IHN0cjsKICAgIHRoaXMuZGljdCA9IHN0ci5kaWN0OwogIH0KCiAgcmVhZEJsb2NrKCkgewogICAgY29uc3QgcmVwZWF0SGVhZGVyID0gdGhpcy5zdHIuZ2V0Qnl0ZXMoMik7CgogICAgaWYgKCFyZXBlYXRIZWFkZXIgfHwgcmVwZWF0SGVhZGVyLmxlbmd0aCA8IDIgfHwgcmVwZWF0SGVhZGVyWzBdID09PSAxMjgpIHsKICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IGJ1ZmZlcjsKICAgIGxldCBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIGxldCBuID0gcmVwZWF0SGVhZGVyWzBdOwoKICAgIGlmIChuIDwgMTI4KSB7CiAgICAgIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKGJ1ZmZlckxlbmd0aCArIG4gKyAxKTsKICAgICAgYnVmZmVyW2J1ZmZlckxlbmd0aCsrXSA9IHJlcGVhdEhlYWRlclsxXTsKCiAgICAgIGlmIChuID4gMCkgewogICAgICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMuc3RyLmdldEJ5dGVzKG4pOwogICAgICAgIGJ1ZmZlci5zZXQoc291cmNlLCBidWZmZXJMZW5ndGgpOwogICAgICAgIGJ1ZmZlckxlbmd0aCArPSBuOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBuID0gMjU3IC0gbjsKICAgICAgY29uc3QgYiA9IHJlcGVhdEhlYWRlclsxXTsKICAgICAgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIoYnVmZmVyTGVuZ3RoICsgbiArIDEpOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoKytdID0gYjsKICAgICAgfQogICAgfQoKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gYnVmZmVyTGVuZ3RoOwogIH0KCn0KCmV4cG9ydHMuUnVuTGVuZ3RoU3RyZWFtID0gUnVuTGVuZ3RoU3RyZWFtOwoKLyoqKi8gfSksCi8qIDE1OSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuRm9udCA9IGV4cG9ydHMuRXJyb3JGb250ID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfY2ZmX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTYwKTsKCnZhciBfZm9udHNfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2Myk7Cgp2YXIgX3VuaWNvZGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2NSk7Cgp2YXIgX2dseXBobGlzdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTY0KTsKCnZhciBfZW5jb2RpbmdzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjIpOwoKdmFyIF9zdGFuZGFyZF9mb250cyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTY2KTsKCnZhciBfdG9fdW5pY29kZV9tYXAgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2Nyk7Cgp2YXIgX2NmZl9mb250ID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjgpOwoKdmFyIF9mb250X3JlbmRlcmVyID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjkpOwoKdmFyIF9tZXRyaWNzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzApOwoKdmFyIF9nbHlmID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzEpOwoKdmFyIF9jbWFwID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDEpOwoKdmFyIF9vcGVudHlwZV9maWxlX2J1aWxkZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3Mik7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTM1KTsKCnZhciBfdHlwZTFfZm9udCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTczKTsKCmNvbnN0IFBSSVZBVEVfVVNFX0FSRUFTID0gW1sweGUwMDAsIDB4ZjhmZl0sIFsweDEwMDAwMCwgMHgxMGZmZmRdXTsKY29uc3QgUERGX0dMWVBIX1NQQUNFX1VOSVRTID0gMTAwMDsKY29uc3QgRVhQT1JUX0RBVEFfUFJPUEVSVElFUyA9IFsiYXNjZW50IiwgImJib3giLCAiYmxhY2siLCAiYm9sZCIsICJjaGFyUHJvY09wZXJhdG9yTGlzdCIsICJjb21wb3NpdGUiLCAiY3NzRm9udEluZm8iLCAiZGF0YSIsICJkZWZhdWx0Vk1ldHJpY3MiLCAiZGVmYXVsdFdpZHRoIiwgImRlc2NlbnQiLCAiZmFsbGJhY2tOYW1lIiwgImZvbnRNYXRyaXgiLCAiZm9udFR5cGUiLCAiaXNUeXBlM0ZvbnQiLCAiaXRhbGljIiwgImxvYWRlZE5hbWUiLCAibWltZXR5cGUiLCAibWlzc2luZ0ZpbGUiLCAibmFtZSIsICJyZW1lYXN1cmUiLCAic3VidHlwZSIsICJ0eXBlIiwgInZlcnRpY2FsIl07CmNvbnN0IEVYUE9SVF9EQVRBX0VYVFJBX1BST1BFUlRJRVMgPSBbImNNYXAiLCAiZGVmYXVsdEVuY29kaW5nIiwgImRpZmZlcmVuY2VzIiwgImlzTW9ub3NwYWNlIiwgImlzU2VyaWZGb250IiwgImlzU3ltYm9saWNGb250IiwgInNlYWNNYXAiLCAidG9Gb250Q2hhciIsICJ0b1VuaWNvZGUiLCAidm1ldHJpY3MiLCAid2lkdGhzIl07CgpmdW5jdGlvbiBhZGp1c3RXaWR0aHMocHJvcGVydGllcykgewogIGlmICghcHJvcGVydGllcy5mb250TWF0cml4KSB7CiAgICByZXR1cm47CiAgfQoKICBpZiAocHJvcGVydGllcy5mb250TWF0cml4WzBdID09PSBfdXRpbC5GT05UX0lERU5USVRZX01BVFJJWFswXSkgewogICAgcmV0dXJuOwogIH0KCiAgY29uc3Qgc2NhbGUgPSAwLjAwMSAvIHByb3BlcnRpZXMuZm9udE1hdHJpeFswXTsKICBjb25zdCBnbHlwaHNXaWR0aHMgPSBwcm9wZXJ0aWVzLndpZHRoczsKCiAgZm9yIChjb25zdCBnbHlwaCBpbiBnbHlwaHNXaWR0aHMpIHsKICAgIGdseXBoc1dpZHRoc1tnbHlwaF0gKj0gc2NhbGU7CiAgfQoKICBwcm9wZXJ0aWVzLmRlZmF1bHRXaWR0aCAqPSBzY2FsZTsKfQoKZnVuY3Rpb24gYWRqdXN0VG9Vbmljb2RlKHByb3BlcnRpZXMsIGJ1aWx0SW5FbmNvZGluZykgewogIGlmIChwcm9wZXJ0aWVzLmlzSW50ZXJuYWxGb250KSB7CiAgICByZXR1cm47CiAgfQoKICBpZiAoYnVpbHRJbkVuY29kaW5nID09PSBwcm9wZXJ0aWVzLmRlZmF1bHRFbmNvZGluZykgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKHByb3BlcnRpZXMudG9Vbmljb2RlIGluc3RhbmNlb2YgX3RvX3VuaWNvZGVfbWFwLklkZW50aXR5VG9Vbmljb2RlTWFwKSB7CiAgICByZXR1cm47CiAgfQoKICBjb25zdCB0b1VuaWNvZGUgPSBbXSwKICAgICAgICBnbHlwaHNVbmljb2RlTWFwID0gKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKTsKCiAgZm9yIChjb25zdCBjaGFyQ29kZSBpbiBidWlsdEluRW5jb2RpbmcpIHsKICAgIGlmIChwcm9wZXJ0aWVzLmhhc0luY2x1ZGVkVG9Vbmljb2RlTWFwKSB7CiAgICAgIGlmIChwcm9wZXJ0aWVzLnRvVW5pY29kZS5oYXMoY2hhckNvZGUpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAocHJvcGVydGllcy5oYXNFbmNvZGluZykgewogICAgICBpZiAocHJvcGVydGllcy5kaWZmZXJlbmNlcy5sZW5ndGggPT09IDAgfHwgcHJvcGVydGllcy5kaWZmZXJlbmNlc1tjaGFyQ29kZV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICB9CgogICAgY29uc3QgZ2x5cGhOYW1lID0gYnVpbHRJbkVuY29kaW5nW2NoYXJDb2RlXTsKICAgIGNvbnN0IHVuaWNvZGUgPSAoMCwgX3VuaWNvZGUuZ2V0VW5pY29kZUZvckdseXBoKShnbHlwaE5hbWUsIGdseXBoc1VuaWNvZGVNYXApOwoKICAgIGlmICh1bmljb2RlICE9PSAtMSkgewogICAgICB0b1VuaWNvZGVbY2hhckNvZGVdID0gU3RyaW5nLmZyb21DaGFyQ29kZSh1bmljb2RlKTsKICAgIH0KICB9CgogIGlmICh0b1VuaWNvZGUubGVuZ3RoID4gMCkgewogICAgcHJvcGVydGllcy50b1VuaWNvZGUuYW1lbmQodG9Vbmljb2RlKTsKICB9Cn0KCmZ1bmN0aW9uIGFtZW5kRmFsbGJhY2tUb1VuaWNvZGUocHJvcGVydGllcykgewogIGlmICghcHJvcGVydGllcy5mYWxsYmFja1RvVW5pY29kZSkgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKHByb3BlcnRpZXMudG9Vbmljb2RlIGluc3RhbmNlb2YgX3RvX3VuaWNvZGVfbWFwLklkZW50aXR5VG9Vbmljb2RlTWFwKSB7CiAgICByZXR1cm47CiAgfQoKICBjb25zdCB0b1VuaWNvZGUgPSBbXTsKCiAgZm9yIChjb25zdCBjaGFyQ29kZSBpbiBwcm9wZXJ0aWVzLmZhbGxiYWNrVG9Vbmljb2RlKSB7CiAgICBpZiAocHJvcGVydGllcy50b1VuaWNvZGUuaGFzKGNoYXJDb2RlKSkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICB0b1VuaWNvZGVbY2hhckNvZGVdID0gcHJvcGVydGllcy5mYWxsYmFja1RvVW5pY29kZVtjaGFyQ29kZV07CiAgfQoKICBpZiAodG9Vbmljb2RlLmxlbmd0aCA+IDApIHsKICAgIHByb3BlcnRpZXMudG9Vbmljb2RlLmFtZW5kKHRvVW5pY29kZSk7CiAgfQp9CgpjbGFzcyBHbHlwaCB7CiAgY29uc3RydWN0b3Iob3JpZ2luYWxDaGFyQ29kZSwgZm9udENoYXIsIHVuaWNvZGUsIGFjY2VudCwgd2lkdGgsIHZtZXRyaWMsIG9wZXJhdG9yTGlzdElkLCBpc1NwYWNlLCBpc0luRm9udCkgewogICAgdGhpcy5vcmlnaW5hbENoYXJDb2RlID0gb3JpZ2luYWxDaGFyQ29kZTsKICAgIHRoaXMuZm9udENoYXIgPSBmb250Q2hhcjsKICAgIHRoaXMudW5pY29kZSA9IHVuaWNvZGU7CiAgICB0aGlzLmFjY2VudCA9IGFjY2VudDsKICAgIHRoaXMud2lkdGggPSB3aWR0aDsKICAgIHRoaXMudm1ldHJpYyA9IHZtZXRyaWM7CiAgICB0aGlzLm9wZXJhdG9yTGlzdElkID0gb3BlcmF0b3JMaXN0SWQ7CiAgICB0aGlzLmlzU3BhY2UgPSBpc1NwYWNlOwogICAgdGhpcy5pc0luRm9udCA9IGlzSW5Gb250OwogICAgY29uc3QgY2F0ZWdvcnkgPSAoMCwgX3VuaWNvZGUuZ2V0Q2hhclVuaWNvZGVDYXRlZ29yeSkodW5pY29kZSk7CiAgICB0aGlzLmlzV2hpdGVzcGFjZSA9IGNhdGVnb3J5LmlzV2hpdGVzcGFjZTsKICAgIHRoaXMuaXNaZXJvV2lkdGhEaWFjcml0aWMgPSBjYXRlZ29yeS5pc1plcm9XaWR0aERpYWNyaXRpYzsKICAgIHRoaXMuaXNJbnZpc2libGVGb3JtYXRNYXJrID0gY2F0ZWdvcnkuaXNJbnZpc2libGVGb3JtYXRNYXJrOwogIH0KCiAgbWF0Y2hlc0ZvckNhY2hlKG9yaWdpbmFsQ2hhckNvZGUsIGZvbnRDaGFyLCB1bmljb2RlLCBhY2NlbnQsIHdpZHRoLCB2bWV0cmljLCBvcGVyYXRvckxpc3RJZCwgaXNTcGFjZSwgaXNJbkZvbnQpIHsKICAgIHJldHVybiB0aGlzLm9yaWdpbmFsQ2hhckNvZGUgPT09IG9yaWdpbmFsQ2hhckNvZGUgJiYgdGhpcy5mb250Q2hhciA9PT0gZm9udENoYXIgJiYgdGhpcy51bmljb2RlID09PSB1bmljb2RlICYmIHRoaXMuYWNjZW50ID09PSBhY2NlbnQgJiYgdGhpcy53aWR0aCA9PT0gd2lkdGggJiYgdGhpcy52bWV0cmljID09PSB2bWV0cmljICYmIHRoaXMub3BlcmF0b3JMaXN0SWQgPT09IG9wZXJhdG9yTGlzdElkICYmIHRoaXMuaXNTcGFjZSA9PT0gaXNTcGFjZSAmJiB0aGlzLmlzSW5Gb250ID09PSBpc0luRm9udDsKICB9Cgp9CgpmdW5jdGlvbiBpbnQxNihiMCwgYjEpIHsKICByZXR1cm4gKGIwIDw8IDgpICsgYjE7Cn0KCmZ1bmN0aW9uIHdyaXRlU2lnbmVkSW50MTYoYnl0ZXMsIGluZGV4LCB2YWx1ZSkgewogIGJ5dGVzW2luZGV4ICsgMV0gPSB2YWx1ZTsKICBieXRlc1tpbmRleF0gPSB2YWx1ZSA+Pj4gODsKfQoKZnVuY3Rpb24gc2lnbmVkSW50MTYoYjAsIGIxKSB7CiAgY29uc3QgdmFsdWUgPSAoYjAgPDwgOCkgKyBiMTsKICByZXR1cm4gdmFsdWUgJiAxIDw8IDE1ID8gdmFsdWUgLSAweDEwMDAwIDogdmFsdWU7Cn0KCmZ1bmN0aW9uIGludDMyKGIwLCBiMSwgYjIsIGIzKSB7CiAgcmV0dXJuIChiMCA8PCAyNCkgKyAoYjEgPDwgMTYpICsgKGIyIDw8IDgpICsgYjM7Cn0KCmZ1bmN0aW9uIHN0cmluZzE2KHZhbHVlKSB7CiAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUodmFsdWUgPj4gOCAmIDB4ZmYsIHZhbHVlICYgMHhmZik7Cn0KCmZ1bmN0aW9uIHNhZmVTdHJpbmcxNih2YWx1ZSkgewogIGlmICh2YWx1ZSA+IDB4N2ZmZikgewogICAgdmFsdWUgPSAweDdmZmY7CiAgfSBlbHNlIGlmICh2YWx1ZSA8IC0weDgwMDApIHsKICAgIHZhbHVlID0gLTB4ODAwMDsKICB9CgogIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHZhbHVlID4+IDggJiAweGZmLCB2YWx1ZSAmIDB4ZmYpOwp9CgpmdW5jdGlvbiBpc1RydWVUeXBlRmlsZShmaWxlKSB7CiAgY29uc3QgaGVhZGVyID0gZmlsZS5wZWVrQnl0ZXMoNCk7CiAgcmV0dXJuICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShoZWFkZXIsIDApID09PSAweDAwMDEwMDAwIHx8ICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShoZWFkZXIpID09PSAidHJ1ZSI7Cn0KCmZ1bmN0aW9uIGlzVHJ1ZVR5cGVDb2xsZWN0aW9uRmlsZShmaWxlKSB7CiAgY29uc3QgaGVhZGVyID0gZmlsZS5wZWVrQnl0ZXMoNCk7CiAgcmV0dXJuICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShoZWFkZXIpID09PSAidHRjZiI7Cn0KCmZ1bmN0aW9uIGlzT3BlblR5cGVGaWxlKGZpbGUpIHsKICBjb25zdCBoZWFkZXIgPSBmaWxlLnBlZWtCeXRlcyg0KTsKICByZXR1cm4gKDAsIF91dGlsLmJ5dGVzVG9TdHJpbmcpKGhlYWRlcikgPT09ICJPVFRPIjsKfQoKZnVuY3Rpb24gaXNUeXBlMUZpbGUoZmlsZSkgewogIGNvbnN0IGhlYWRlciA9IGZpbGUucGVla0J5dGVzKDIpOwoKICBpZiAoaGVhZGVyWzBdID09PSAweDI1ICYmIGhlYWRlclsxXSA9PT0gMHgyMSkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBpZiAoaGVhZGVyWzBdID09PSAweDgwICYmIGhlYWRlclsxXSA9PT0gMHgwMSkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICByZXR1cm4gZmFsc2U7Cn0KCmZ1bmN0aW9uIGlzQ0ZGRmlsZShmaWxlKSB7CiAgY29uc3QgaGVhZGVyID0gZmlsZS5wZWVrQnl0ZXMoNCk7CgogIGlmIChoZWFkZXJbMF0gPj0gMSAmJiBoZWFkZXJbM10gPj0gMSAmJiBoZWFkZXJbM10gPD0gNCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICByZXR1cm4gZmFsc2U7Cn0KCmZ1bmN0aW9uIGdldEZvbnRGaWxlVHlwZShmaWxlLCBfcmVmKSB7CiAgbGV0IHsKICAgIHR5cGUsCiAgICBzdWJ0eXBlLAogICAgY29tcG9zaXRlCiAgfSA9IF9yZWY7CiAgbGV0IGZpbGVUeXBlLCBmaWxlU3VidHlwZTsKCiAgaWYgKGlzVHJ1ZVR5cGVGaWxlKGZpbGUpIHx8IGlzVHJ1ZVR5cGVDb2xsZWN0aW9uRmlsZShmaWxlKSkgewogICAgaWYgKGNvbXBvc2l0ZSkgewogICAgICBmaWxlVHlwZSA9ICJDSURGb250VHlwZTIiOwogICAgfSBlbHNlIHsKICAgICAgZmlsZVR5cGUgPSAiVHJ1ZVR5cGUiOwogICAgfQogIH0gZWxzZSBpZiAoaXNPcGVuVHlwZUZpbGUoZmlsZSkpIHsKICAgIGlmIChjb21wb3NpdGUpIHsKICAgICAgZmlsZVR5cGUgPSAiQ0lERm9udFR5cGUyIjsKICAgIH0gZWxzZSB7CiAgICAgIGZpbGVUeXBlID0gIk9wZW5UeXBlIjsKICAgIH0KICB9IGVsc2UgaWYgKGlzVHlwZTFGaWxlKGZpbGUpKSB7CiAgICBpZiAoY29tcG9zaXRlKSB7CiAgICAgIGZpbGVUeXBlID0gIkNJREZvbnRUeXBlMCI7CiAgICB9IGVsc2UgewogICAgICBmaWxlVHlwZSA9IHR5cGUgPT09ICJNTVR5cGUxIiA/ICJNTVR5cGUxIiA6ICJUeXBlMSI7CiAgICB9CiAgfSBlbHNlIGlmIChpc0NGRkZpbGUoZmlsZSkpIHsKICAgIGlmIChjb21wb3NpdGUpIHsKICAgICAgZmlsZVR5cGUgPSAiQ0lERm9udFR5cGUwIjsKICAgICAgZmlsZVN1YnR5cGUgPSAiQ0lERm9udFR5cGUwQyI7CiAgICB9IGVsc2UgewogICAgICBmaWxlVHlwZSA9IHR5cGUgPT09ICJNTVR5cGUxIiA/ICJNTVR5cGUxIiA6ICJUeXBlMSI7CiAgICAgIGZpbGVTdWJ0eXBlID0gIlR5cGUxQyI7CiAgICB9CiAgfSBlbHNlIHsKICAgICgwLCBfdXRpbC53YXJuKSgiZ2V0Rm9udEZpbGVUeXBlOiBVbmFibGUgdG8gZGV0ZWN0IGNvcnJlY3QgZm9udCBmaWxlIFR5cGUvU3VidHlwZS4iKTsKICAgIGZpbGVUeXBlID0gdHlwZTsKICAgIGZpbGVTdWJ0eXBlID0gc3VidHlwZTsKICB9CgogIHJldHVybiBbZmlsZVR5cGUsIGZpbGVTdWJ0eXBlXTsKfQoKZnVuY3Rpb24gYXBwbHlTdGFuZGFyZEZvbnRHbHlwaE1hcChtYXAsIGdseXBoTWFwKSB7CiAgZm9yIChjb25zdCBjaGFyQ29kZSBpbiBnbHlwaE1hcCkgewogICAgbWFwWytjaGFyQ29kZV0gPSBnbHlwaE1hcFtjaGFyQ29kZV07CiAgfQp9CgpmdW5jdGlvbiBidWlsZFRvRm9udENoYXIoZW5jb2RpbmcsIGdseXBoc1VuaWNvZGVNYXAsIGRpZmZlcmVuY2VzKSB7CiAgY29uc3QgdG9Gb250Q2hhciA9IFtdOwogIGxldCB1bmljb2RlOwoKICBmb3IgKGxldCBpID0gMCwgaWkgPSBlbmNvZGluZy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICB1bmljb2RlID0gKDAsIF91bmljb2RlLmdldFVuaWNvZGVGb3JHbHlwaCkoZW5jb2RpbmdbaV0sIGdseXBoc1VuaWNvZGVNYXApOwoKICAgIGlmICh1bmljb2RlICE9PSAtMSkgewogICAgICB0b0ZvbnRDaGFyW2ldID0gdW5pY29kZTsKICAgIH0KICB9CgogIGZvciAoY29uc3QgY2hhckNvZGUgaW4gZGlmZmVyZW5jZXMpIHsKICAgIHVuaWNvZGUgPSAoMCwgX3VuaWNvZGUuZ2V0VW5pY29kZUZvckdseXBoKShkaWZmZXJlbmNlc1tjaGFyQ29kZV0sIGdseXBoc1VuaWNvZGVNYXApOwoKICAgIGlmICh1bmljb2RlICE9PSAtMSkgewogICAgICB0b0ZvbnRDaGFyWytjaGFyQ29kZV0gPSB1bmljb2RlOwogICAgfQogIH0KCiAgcmV0dXJuIHRvRm9udENoYXI7Cn0KCmZ1bmN0aW9uIGNvbnZlcnRDaWRTdHJpbmcoY2hhckNvZGUsIGNpZCkgewogIGxldCBzaG91bGRUaHJvdyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CgogIHN3aXRjaCAoY2lkLmxlbmd0aCkgewogICAgY2FzZSAxOgogICAgICByZXR1cm4gY2lkLmNoYXJDb2RlQXQoMCk7CgogICAgY2FzZSAyOgogICAgICByZXR1cm4gY2lkLmNoYXJDb2RlQXQoMCkgPDwgOCB8IGNpZC5jaGFyQ29kZUF0KDEpOwogIH0KCiAgY29uc3QgbXNnID0gYFVuc3VwcG9ydGVkIENJRCBzdHJpbmcgKGNoYXJDb2RlICR7Y2hhckNvZGV9KTogIiR7Y2lkfSIuYDsKCiAgaWYgKHNob3VsZFRocm93KSB7CiAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IobXNnKTsKICB9CgogICgwLCBfdXRpbC53YXJuKShtc2cpOwogIHJldHVybiBjaWQ7Cn0KCmZ1bmN0aW9uIGFkanVzdE1hcHBpbmcoY2hhckNvZGVUb0dseXBoSWQsIGhhc0dseXBoLCBuZXdHbHlwaFplcm9JZCwgdG9Vbmljb2RlKSB7CiAgY29uc3QgbmV3TWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICBjb25zdCB0b1VuaWNvZGVFeHRyYU1hcCA9IG5ldyBNYXAoKTsKICBjb25zdCB0b0ZvbnRDaGFyID0gW107CiAgY29uc3QgdXNlZEdseXBoSWRzID0gbmV3IFNldCgpOwogIGxldCBwcml2YXRlVXNlQXJlYUluZGV4ID0gMDsKICBjb25zdCBwcml2YXRlVXNlT2ZmZXRTdGFydCA9IFBSSVZBVEVfVVNFX0FSRUFTW3ByaXZhdGVVc2VBcmVhSW5kZXhdWzBdOwogIGxldCBuZXh0QXZhaWxhYmxlRm9udENoYXJDb2RlID0gcHJpdmF0ZVVzZU9mZmV0U3RhcnQ7CiAgbGV0IHByaXZhdGVVc2VPZmZldEVuZCA9IFBSSVZBVEVfVVNFX0FSRUFTW3ByaXZhdGVVc2VBcmVhSW5kZXhdWzFdOwoKICBmb3IgKGxldCBvcmlnaW5hbENoYXJDb2RlIGluIGNoYXJDb2RlVG9HbHlwaElkKSB7CiAgICBvcmlnaW5hbENoYXJDb2RlIHw9IDA7CiAgICBsZXQgZ2x5cGhJZCA9IGNoYXJDb2RlVG9HbHlwaElkW29yaWdpbmFsQ2hhckNvZGVdOwoKICAgIGlmICghaGFzR2x5cGgoZ2x5cGhJZCkpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgaWYgKG5leHRBdmFpbGFibGVGb250Q2hhckNvZGUgPiBwcml2YXRlVXNlT2ZmZXRFbmQpIHsKICAgICAgcHJpdmF0ZVVzZUFyZWFJbmRleCsrOwoKICAgICAgaWYgKHByaXZhdGVVc2VBcmVhSW5kZXggPj0gUFJJVkFURV9VU0VfQVJFQVMubGVuZ3RoKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJSYW4gb3V0IG9mIHNwYWNlIGluIGZvbnQgcHJpdmF0ZSB1c2UgYXJlYS4iKTsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgbmV4dEF2YWlsYWJsZUZvbnRDaGFyQ29kZSA9IFBSSVZBVEVfVVNFX0FSRUFTW3ByaXZhdGVVc2VBcmVhSW5kZXhdWzBdOwogICAgICBwcml2YXRlVXNlT2ZmZXRFbmQgPSBQUklWQVRFX1VTRV9BUkVBU1twcml2YXRlVXNlQXJlYUluZGV4XVsxXTsKICAgIH0KCiAgICBjb25zdCBmb250Q2hhckNvZGUgPSBuZXh0QXZhaWxhYmxlRm9udENoYXJDb2RlKys7CgogICAgaWYgKGdseXBoSWQgPT09IDApIHsKICAgICAgZ2x5cGhJZCA9IG5ld0dseXBoWmVyb0lkOwogICAgfQoKICAgIGxldCB1bmljb2RlID0gdG9Vbmljb2RlLmdldChvcmlnaW5hbENoYXJDb2RlKTsKCiAgICBpZiAodHlwZW9mIHVuaWNvZGUgPT09ICJzdHJpbmciKSB7CiAgICAgIHVuaWNvZGUgPSB1bmljb2RlLmNvZGVQb2ludEF0KDApOwogICAgfQoKICAgIGlmICh1bmljb2RlICYmIHVuaWNvZGUgPCBwcml2YXRlVXNlT2ZmZXRTdGFydCAmJiAhdXNlZEdseXBoSWRzLmhhcyhnbHlwaElkKSkgewogICAgICB0b1VuaWNvZGVFeHRyYU1hcC5zZXQodW5pY29kZSwgZ2x5cGhJZCk7CiAgICAgIHVzZWRHbHlwaElkcy5hZGQoZ2x5cGhJZCk7CiAgICB9CgogICAgbmV3TWFwW2ZvbnRDaGFyQ29kZV0gPSBnbHlwaElkOwogICAgdG9Gb250Q2hhcltvcmlnaW5hbENoYXJDb2RlXSA9IGZvbnRDaGFyQ29kZTsKICB9CgogIHJldHVybiB7CiAgICB0b0ZvbnRDaGFyLAogICAgY2hhckNvZGVUb0dseXBoSWQ6IG5ld01hcCwKICAgIHRvVW5pY29kZUV4dHJhTWFwLAogICAgbmV4dEF2YWlsYWJsZUZvbnRDaGFyQ29kZQogIH07Cn0KCmZ1bmN0aW9uIGdldFJhbmdlcyhnbHlwaHMsIHRvVW5pY29kZUV4dHJhTWFwLCBudW1HbHlwaHMpIHsKICBjb25zdCBjb2RlcyA9IFtdOwoKICBmb3IgKGNvbnN0IGNoYXJDb2RlIGluIGdseXBocykgewogICAgaWYgKGdseXBoc1tjaGFyQ29kZV0gPj0gbnVtR2x5cGhzKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGNvZGVzLnB1c2goewogICAgICBmb250Q2hhckNvZGU6IGNoYXJDb2RlIHwgMCwKICAgICAgZ2x5cGhJZDogZ2x5cGhzW2NoYXJDb2RlXQogICAgfSk7CiAgfQoKICBpZiAodG9Vbmljb2RlRXh0cmFNYXApIHsKICAgIGZvciAoY29uc3QgW3VuaWNvZGUsIGdseXBoSWRdIG9mIHRvVW5pY29kZUV4dHJhTWFwKSB7CiAgICAgIGlmIChnbHlwaElkID49IG51bUdseXBocykgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb2Rlcy5wdXNoKHsKICAgICAgICBmb250Q2hhckNvZGU6IHVuaWNvZGUsCiAgICAgICAgZ2x5cGhJZAogICAgICB9KTsKICAgIH0KICB9CgogIGlmIChjb2Rlcy5sZW5ndGggPT09IDApIHsKICAgIGNvZGVzLnB1c2goewogICAgICBmb250Q2hhckNvZGU6IDAsCiAgICAgIGdseXBoSWQ6IDAKICAgIH0pOwogIH0KCiAgY29kZXMuc29ydChmdW5jdGlvbiBmb250R2V0UmFuZ2VzU29ydChhLCBiKSB7CiAgICByZXR1cm4gYS5mb250Q2hhckNvZGUgLSBiLmZvbnRDaGFyQ29kZTsKICB9KTsKICBjb25zdCByYW5nZXMgPSBbXTsKICBjb25zdCBsZW5ndGggPSBjb2Rlcy5sZW5ndGg7CgogIGZvciAobGV0IG4gPSAwOyBuIDwgbGVuZ3RoOykgewogICAgY29uc3Qgc3RhcnQgPSBjb2Rlc1tuXS5mb250Q2hhckNvZGU7CiAgICBjb25zdCBjb2RlSW5kaWNlcyA9IFtjb2Rlc1tuXS5nbHlwaElkXTsKICAgICsrbjsKICAgIGxldCBlbmQgPSBzdGFydDsKCiAgICB3aGlsZSAobiA8IGxlbmd0aCAmJiBlbmQgKyAxID09PSBjb2Rlc1tuXS5mb250Q2hhckNvZGUpIHsKICAgICAgY29kZUluZGljZXMucHVzaChjb2Rlc1tuXS5nbHlwaElkKTsKICAgICAgKytlbmQ7CiAgICAgICsrbjsKCiAgICAgIGlmIChlbmQgPT09IDB4ZmZmZikgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgcmFuZ2VzLnB1c2goW3N0YXJ0LCBlbmQsIGNvZGVJbmRpY2VzXSk7CiAgfQoKICByZXR1cm4gcmFuZ2VzOwp9CgpmdW5jdGlvbiBjcmVhdGVDbWFwVGFibGUoZ2x5cGhzLCB0b1VuaWNvZGVFeHRyYU1hcCwgbnVtR2x5cGhzKSB7CiAgY29uc3QgcmFuZ2VzID0gZ2V0UmFuZ2VzKGdseXBocywgdG9Vbmljb2RlRXh0cmFNYXAsIG51bUdseXBocyk7CiAgY29uc3QgbnVtVGFibGVzID0gcmFuZ2VzLmF0KC0xKVsxXSA+IDB4ZmZmZiA/IDIgOiAxOwogIGxldCBjbWFwID0gIlx4MDBceDAwIiArIHN0cmluZzE2KG51bVRhYmxlcykgKyAiXHgwMFx4MDMiICsgIlx4MDBceDAxIiArICgwLCBfdXRpbC5zdHJpbmczMikoNCArIG51bVRhYmxlcyAqIDgpOwogIGxldCBpLCBpaSwgaiwgamo7CgogIGZvciAoaSA9IHJhbmdlcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkgewogICAgaWYgKHJhbmdlc1tpXVswXSA8PSAweGZmZmYpIHsKICAgICAgYnJlYWs7CiAgICB9CiAgfQoKICBjb25zdCBibXBMZW5ndGggPSBpICsgMTsKCiAgaWYgKHJhbmdlc1tpXVswXSA8IDB4ZmZmZiAmJiByYW5nZXNbaV1bMV0gPT09IDB4ZmZmZikgewogICAgcmFuZ2VzW2ldWzFdID0gMHhmZmZlOwogIH0KCiAgY29uc3QgdHJhaWxpbmdSYW5nZXNDb3VudCA9IHJhbmdlc1tpXVsxXSA8IDB4ZmZmZiA/IDEgOiAwOwogIGNvbnN0IHNlZ0NvdW50ID0gYm1wTGVuZ3RoICsgdHJhaWxpbmdSYW5nZXNDb3VudDsKCiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gX29wZW50eXBlX2ZpbGVfYnVpbGRlci5PcGVuVHlwZUZpbGVCdWlsZGVyLmdldFNlYXJjaFBhcmFtcyhzZWdDb3VudCwgMik7CgogIGxldCBzdGFydENvdW50ID0gIiI7CiAgbGV0IGVuZENvdW50ID0gIiI7CiAgbGV0IGlkRGVsdGFzID0gIiI7CiAgbGV0IGlkUmFuZ2VPZmZzZXRzID0gIiI7CiAgbGV0IGdseXBoc0lkcyA9ICIiOwogIGxldCBiaWFzID0gMDsKICBsZXQgcmFuZ2UsIHN0YXJ0LCBlbmQsIGNvZGVzOwoKICBmb3IgKGkgPSAwLCBpaSA9IGJtcExlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgIHJhbmdlID0gcmFuZ2VzW2ldOwogICAgc3RhcnQgPSByYW5nZVswXTsKICAgIGVuZCA9IHJhbmdlWzFdOwogICAgc3RhcnRDb3VudCArPSBzdHJpbmcxNihzdGFydCk7CiAgICBlbmRDb3VudCArPSBzdHJpbmcxNihlbmQpOwogICAgY29kZXMgPSByYW5nZVsyXTsKICAgIGxldCBjb250aWd1b3VzID0gdHJ1ZTsKCiAgICBmb3IgKGogPSAxLCBqaiA9IGNvZGVzLmxlbmd0aDsgaiA8IGpqOyArK2opIHsKICAgICAgaWYgKGNvZGVzW2pdICE9PSBjb2Rlc1tqIC0gMV0gKyAxKSB7CiAgICAgICAgY29udGlndW91cyA9IGZhbHNlOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKCFjb250aWd1b3VzKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IChzZWdDb3VudCAtIGkpICogMiArIGJpYXMgKiAyOwogICAgICBiaWFzICs9IGVuZCAtIHN0YXJ0ICsgMTsKICAgICAgaWREZWx0YXMgKz0gc3RyaW5nMTYoMCk7CiAgICAgIGlkUmFuZ2VPZmZzZXRzICs9IHN0cmluZzE2KG9mZnNldCk7CgogICAgICBmb3IgKGogPSAwLCBqaiA9IGNvZGVzLmxlbmd0aDsgaiA8IGpqOyArK2opIHsKICAgICAgICBnbHlwaHNJZHMgKz0gc3RyaW5nMTYoY29kZXNbal0pOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjb25zdCBzdGFydENvZGUgPSBjb2Rlc1swXTsKICAgICAgaWREZWx0YXMgKz0gc3RyaW5nMTYoc3RhcnRDb2RlIC0gc3RhcnQgJiAweGZmZmYpOwogICAgICBpZFJhbmdlT2Zmc2V0cyArPSBzdHJpbmcxNigwKTsKICAgIH0KICB9CgogIGlmICh0cmFpbGluZ1Jhbmdlc0NvdW50ID4gMCkgewogICAgZW5kQ291bnQgKz0gIlx4RkZceEZGIjsKICAgIHN0YXJ0Q291bnQgKz0gIlx4RkZceEZGIjsKICAgIGlkRGVsdGFzICs9ICJceDAwXHgwMSI7CiAgICBpZFJhbmdlT2Zmc2V0cyArPSAiXHgwMFx4MDAiOwogIH0KCiAgY29uc3QgZm9ybWF0MzE0ID0gIlx4MDBceDAwIiArIHN0cmluZzE2KDIgKiBzZWdDb3VudCkgKyBzdHJpbmcxNihzZWFyY2hQYXJhbXMucmFuZ2UpICsgc3RyaW5nMTYoc2VhcmNoUGFyYW1zLmVudHJ5KSArIHN0cmluZzE2KHNlYXJjaFBhcmFtcy5yYW5nZVNoaWZ0KSArIGVuZENvdW50ICsgIlx4MDBceDAwIiArIHN0YXJ0Q291bnQgKyBpZERlbHRhcyArIGlkUmFuZ2VPZmZzZXRzICsgZ2x5cGhzSWRzOwogIGxldCBmb3JtYXQzMTAxMiA9ICIiOwogIGxldCBoZWFkZXIzMTAxMiA9ICIiOwoKICBpZiAobnVtVGFibGVzID4gMSkgewogICAgY21hcCArPSAiXHgwMFx4MDMiICsgIlx4MDBceDBBIiArICgwLCBfdXRpbC5zdHJpbmczMikoNCArIG51bVRhYmxlcyAqIDggKyA0ICsgZm9ybWF0MzE0Lmxlbmd0aCk7CiAgICBmb3JtYXQzMTAxMiA9ICIiOwoKICAgIGZvciAoaSA9IDAsIGlpID0gcmFuZ2VzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgcmFuZ2UgPSByYW5nZXNbaV07CiAgICAgIHN0YXJ0ID0gcmFuZ2VbMF07CiAgICAgIGNvZGVzID0gcmFuZ2VbMl07CiAgICAgIGxldCBjb2RlID0gY29kZXNbMF07CgogICAgICBmb3IgKGogPSAxLCBqaiA9IGNvZGVzLmxlbmd0aDsgaiA8IGpqOyArK2opIHsKICAgICAgICBpZiAoY29kZXNbal0gIT09IGNvZGVzW2ogLSAxXSArIDEpIHsKICAgICAgICAgIGVuZCA9IHJhbmdlWzBdICsgaiAtIDE7CiAgICAgICAgICBmb3JtYXQzMTAxMiArPSAoMCwgX3V0aWwuc3RyaW5nMzIpKHN0YXJ0KSArICgwLCBfdXRpbC5zdHJpbmczMikoZW5kKSArICgwLCBfdXRpbC5zdHJpbmczMikoY29kZSk7CiAgICAgICAgICBzdGFydCA9IGVuZCArIDE7CiAgICAgICAgICBjb2RlID0gY29kZXNbal07CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3JtYXQzMTAxMiArPSAoMCwgX3V0aWwuc3RyaW5nMzIpKHN0YXJ0KSArICgwLCBfdXRpbC5zdHJpbmczMikocmFuZ2VbMV0pICsgKDAsIF91dGlsLnN0cmluZzMyKShjb2RlKTsKICAgIH0KCiAgICBoZWFkZXIzMTAxMiA9ICJceDAwXHgwQyIgKyAiXHgwMFx4MDAiICsgKDAsIF91dGlsLnN0cmluZzMyKShmb3JtYXQzMTAxMi5sZW5ndGggKyAxNikgKyAiXHgwMFx4MDBceDAwXHgwMCIgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKGZvcm1hdDMxMDEyLmxlbmd0aCAvIDEyKTsKICB9CgogIHJldHVybiBjbWFwICsgIlx4MDBceDA0IiArIHN0cmluZzE2KGZvcm1hdDMxNC5sZW5ndGggKyA0KSArIGZvcm1hdDMxNCArIGhlYWRlcjMxMDEyICsgZm9ybWF0MzEwMTI7Cn0KCmZ1bmN0aW9uIHZhbGlkYXRlT1MyVGFibGUob3MyLCBmaWxlKSB7CiAgZmlsZS5wb3MgPSAoZmlsZS5zdGFydCB8fCAwKSArIG9zMi5vZmZzZXQ7CiAgY29uc3QgdmVyc2lvbiA9IGZpbGUuZ2V0VWludDE2KCk7CiAgZmlsZS5za2lwKDYwKTsKICBjb25zdCBzZWxlY3Rpb24gPSBmaWxlLmdldFVpbnQxNigpOwoKICBpZiAodmVyc2lvbiA8IDQgJiYgc2VsZWN0aW9uICYgMHgwMzAwKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBjb25zdCBmaXJzdENoYXIgPSBmaWxlLmdldFVpbnQxNigpOwogIGNvbnN0IGxhc3RDaGFyID0gZmlsZS5nZXRVaW50MTYoKTsKCiAgaWYgKGZpcnN0Q2hhciA+IGxhc3RDaGFyKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBmaWxlLnNraXAoNik7CiAgY29uc3QgdXNXaW5Bc2NlbnQgPSBmaWxlLmdldFVpbnQxNigpOwoKICBpZiAodXNXaW5Bc2NlbnQgPT09IDApIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIG9zMi5kYXRhWzhdID0gb3MyLmRhdGFbOV0gPSAwOwogIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBjcmVhdGVPUzJUYWJsZShwcm9wZXJ0aWVzLCBjaGFyc3RyaW5ncywgb3ZlcnJpZGUpIHsKICBvdmVycmlkZSA9IG92ZXJyaWRlIHx8IHsKICAgIHVuaXRzUGVyRW06IDAsCiAgICB5TWF4OiAwLAogICAgeU1pbjogMCwKICAgIGFzY2VudDogMCwKICAgIGRlc2NlbnQ6IDAKICB9OwogIGxldCB1bFVuaWNvZGVSYW5nZTEgPSAwOwogIGxldCB1bFVuaWNvZGVSYW5nZTIgPSAwOwogIGxldCB1bFVuaWNvZGVSYW5nZTMgPSAwOwogIGxldCB1bFVuaWNvZGVSYW5nZTQgPSAwOwogIGxldCBmaXJzdENoYXJJbmRleCA9IG51bGw7CiAgbGV0IGxhc3RDaGFySW5kZXggPSAwOwoKICBpZiAoY2hhcnN0cmluZ3MpIHsKICAgIGZvciAobGV0IGNvZGUgaW4gY2hhcnN0cmluZ3MpIHsKICAgICAgY29kZSB8PSAwOwoKICAgICAgaWYgKGZpcnN0Q2hhckluZGV4ID4gY29kZSB8fCAhZmlyc3RDaGFySW5kZXgpIHsKICAgICAgICBmaXJzdENoYXJJbmRleCA9IGNvZGU7CiAgICAgIH0KCiAgICAgIGlmIChsYXN0Q2hhckluZGV4IDwgY29kZSkgewogICAgICAgIGxhc3RDaGFySW5kZXggPSBjb2RlOwogICAgICB9CgogICAgICBjb25zdCBwb3NpdGlvbiA9ICgwLCBfdW5pY29kZS5nZXRVbmljb2RlUmFuZ2VGb3IpKGNvZGUpOwoKICAgICAgaWYgKHBvc2l0aW9uIDwgMzIpIHsKICAgICAgICB1bFVuaWNvZGVSYW5nZTEgfD0gMSA8PCBwb3NpdGlvbjsKICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA8IDY0KSB7CiAgICAgICAgdWxVbmljb2RlUmFuZ2UyIHw9IDEgPDwgcG9zaXRpb24gLSAzMjsKICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA8IDk2KSB7CiAgICAgICAgdWxVbmljb2RlUmFuZ2UzIHw9IDEgPDwgcG9zaXRpb24gLSA2NDsKICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA8IDEyMykgewogICAgICAgIHVsVW5pY29kZVJhbmdlNCB8PSAxIDw8IHBvc2l0aW9uIC0gOTY7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbmljb2RlIHJhbmdlcyBCaXRzID4gMTIzIGFyZSByZXNlcnZlZCBmb3IgaW50ZXJuYWwgdXNhZ2UiKTsKICAgICAgfQogICAgfQoKICAgIGlmIChsYXN0Q2hhckluZGV4ID4gMHhmZmZmKSB7CiAgICAgIGxhc3RDaGFySW5kZXggPSAweGZmZmY7CiAgICB9CiAgfSBlbHNlIHsKICAgIGZpcnN0Q2hhckluZGV4ID0gMDsKICAgIGxhc3RDaGFySW5kZXggPSAyNTU7CiAgfQoKICBjb25zdCBiYm94ID0gcHJvcGVydGllcy5iYm94IHx8IFswLCAwLCAwLCAwXTsKICBjb25zdCB1bml0c1BlckVtID0gb3ZlcnJpZGUudW5pdHNQZXJFbSB8fCAxIC8gKHByb3BlcnRpZXMuZm9udE1hdHJpeCB8fCBfdXRpbC5GT05UX0lERU5USVRZX01BVFJJWClbMF07CiAgY29uc3Qgc2NhbGUgPSBwcm9wZXJ0aWVzLmFzY2VudFNjYWxlZCA/IDEuMCA6IHVuaXRzUGVyRW0gLyBQREZfR0xZUEhfU1BBQ0VfVU5JVFM7CiAgY29uc3QgdHlwb0FzY2VudCA9IG92ZXJyaWRlLmFzY2VudCB8fCBNYXRoLnJvdW5kKHNjYWxlICogKHByb3BlcnRpZXMuYXNjZW50IHx8IGJib3hbM10pKTsKICBsZXQgdHlwb0Rlc2NlbnQgPSBvdmVycmlkZS5kZXNjZW50IHx8IE1hdGgucm91bmQoc2NhbGUgKiAocHJvcGVydGllcy5kZXNjZW50IHx8IGJib3hbMV0pKTsKCiAgaWYgKHR5cG9EZXNjZW50ID4gMCAmJiBwcm9wZXJ0aWVzLmRlc2NlbnQgPiAwICYmIGJib3hbMV0gPCAwKSB7CiAgICB0eXBvRGVzY2VudCA9IC10eXBvRGVzY2VudDsKICB9CgogIGNvbnN0IHdpbkFzY2VudCA9IG92ZXJyaWRlLnlNYXggfHwgdHlwb0FzY2VudDsKICBjb25zdCB3aW5EZXNjZW50ID0gLW92ZXJyaWRlLnlNaW4gfHwgLXR5cG9EZXNjZW50OwogIHJldHVybiAiXHgwMFx4MDMiICsgIlx4MDJceDI0IiArICJceDAxXHhGNCIgKyAiXHgwMFx4MDUiICsgIlx4MDBceDAwIiArICJceDAyXHg4QSIgKyAiXHgwMlx4QkIiICsgIlx4MDBceDAwIiArICJceDAwXHg4QyIgKyAiXHgwMlx4OEEiICsgIlx4MDJceEJCIiArICJceDAwXHgwMCIgKyAiXHgwMVx4REYiICsgIlx4MDBceDMxIiArICJceDAxXHgwMiIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwXHgwNiIgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKHByb3BlcnRpZXMuZml4ZWRQaXRjaCA/IDB4MDkgOiAweDAwKSArICJceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiICsgKDAsIF91dGlsLnN0cmluZzMyKSh1bFVuaWNvZGVSYW5nZTEpICsgKDAsIF91dGlsLnN0cmluZzMyKSh1bFVuaWNvZGVSYW5nZTIpICsgKDAsIF91dGlsLnN0cmluZzMyKSh1bFVuaWNvZGVSYW5nZTMpICsgKDAsIF91dGlsLnN0cmluZzMyKSh1bFVuaWNvZGVSYW5nZTQpICsgIlx4MkFceDMyXHgzMVx4MkEiICsgc3RyaW5nMTYocHJvcGVydGllcy5pdGFsaWNBbmdsZSA/IDEgOiAwKSArIHN0cmluZzE2KGZpcnN0Q2hhckluZGV4IHx8IHByb3BlcnRpZXMuZmlyc3RDaGFyKSArIHN0cmluZzE2KGxhc3RDaGFySW5kZXggfHwgcHJvcGVydGllcy5sYXN0Q2hhcikgKyBzdHJpbmcxNih0eXBvQXNjZW50KSArIHN0cmluZzE2KHR5cG9EZXNjZW50KSArICJceDAwXHg2NCIgKyBzdHJpbmcxNih3aW5Bc2NlbnQpICsgc3RyaW5nMTYod2luRGVzY2VudCkgKyAiXHgwMFx4MDBceDAwXHgwMCIgKyAiXHgwMFx4MDBceDAwXHgwMCIgKyBzdHJpbmcxNihwcm9wZXJ0aWVzLnhIZWlnaHQpICsgc3RyaW5nMTYocHJvcGVydGllcy5jYXBIZWlnaHQpICsgc3RyaW5nMTYoMCkgKyBzdHJpbmcxNihmaXJzdENoYXJJbmRleCB8fCBwcm9wZXJ0aWVzLmZpcnN0Q2hhcikgKyAiXHgwMFx4MDMiOwp9CgpmdW5jdGlvbiBjcmVhdGVQb3N0VGFibGUocHJvcGVydGllcykgewogIGNvbnN0IGFuZ2xlID0gTWF0aC5mbG9vcihwcm9wZXJ0aWVzLml0YWxpY0FuZ2xlICogMiAqKiAxNik7CiAgcmV0dXJuICJceDAwXHgwM1x4MDBceDAwIiArICgwLCBfdXRpbC5zdHJpbmczMikoYW5nbGUpICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKHByb3BlcnRpZXMuZml4ZWRQaXRjaCA/IDEgOiAwKSArICJceDAwXHgwMFx4MDBceDAwIiArICJceDAwXHgwMFx4MDBceDAwIiArICJceDAwXHgwMFx4MDBceDAwIiArICJceDAwXHgwMFx4MDBceDAwIjsKfQoKZnVuY3Rpb24gY3JlYXRlUG9zdHNjcmlwdE5hbWUobmFtZSkgewogIHJldHVybiBuYW1lLnJlcGxhY2UoL1teXHgyMS1ceDdFXXxbW1xdKCl7fTw+LyVdL2csICIiKS5zbGljZSgwLCA2Myk7Cn0KCmZ1bmN0aW9uIGNyZWF0ZU5hbWVUYWJsZShuYW1lLCBwcm90bykgewogIGlmICghcHJvdG8pIHsKICAgIHByb3RvID0gW1tdLCBbXV07CiAgfQoKICBjb25zdCBzdHJpbmdzID0gW3Byb3RvWzBdWzBdIHx8ICJPcmlnaW5hbCBsaWNlbmNlIiwgcHJvdG9bMF1bMV0gfHwgbmFtZSwgcHJvdG9bMF1bMl0gfHwgIlVua25vd24iLCBwcm90b1swXVszXSB8fCAidW5pcXVlSUQiLCBwcm90b1swXVs0XSB8fCBuYW1lLCBwcm90b1swXVs1XSB8fCAiVmVyc2lvbiAwLjExIiwgcHJvdG9bMF1bNl0gfHwgY3JlYXRlUG9zdHNjcmlwdE5hbWUobmFtZSksIHByb3RvWzBdWzddIHx8ICJVbmtub3duIiwgcHJvdG9bMF1bOF0gfHwgIlVua25vd24iLCBwcm90b1swXVs5XSB8fCAiVW5rbm93biJdOwogIGNvbnN0IHN0cmluZ3NVbmljb2RlID0gW107CiAgbGV0IGksIGlpLCBqLCBqaiwgc3RyOwoKICBmb3IgKGkgPSAwLCBpaSA9IHN0cmluZ3MubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgc3RyID0gcHJvdG9bMV1baV0gfHwgc3RyaW5nc1tpXTsKICAgIGNvbnN0IHN0ckJ1ZlVuaWNvZGUgPSBbXTsKCiAgICBmb3IgKGogPSAwLCBqaiA9IHN0ci5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgIHN0ckJ1ZlVuaWNvZGUucHVzaChzdHJpbmcxNihzdHIuY2hhckNvZGVBdChqKSkpOwogICAgfQoKICAgIHN0cmluZ3NVbmljb2RlLnB1c2goc3RyQnVmVW5pY29kZS5qb2luKCIiKSk7CiAgfQoKICBjb25zdCBuYW1lcyA9IFtzdHJpbmdzLCBzdHJpbmdzVW5pY29kZV07CiAgY29uc3QgcGxhdGZvcm1zID0gWyJceDAwXHgwMSIsICJceDAwXHgwMyJdOwogIGNvbnN0IGVuY29kaW5ncyA9IFsiXHgwMFx4MDAiLCAiXHgwMFx4MDEiXTsKICBjb25zdCBsYW5ndWFnZXMgPSBbIlx4MDBceDAwIiwgIlx4MDRceDA5Il07CiAgY29uc3QgbmFtZXNSZWNvcmRDb3VudCA9IHN0cmluZ3MubGVuZ3RoICogcGxhdGZvcm1zLmxlbmd0aDsKICBsZXQgbmFtZVRhYmxlID0gIlx4MDBceDAwIiArIHN0cmluZzE2KG5hbWVzUmVjb3JkQ291bnQpICsgc3RyaW5nMTYobmFtZXNSZWNvcmRDb3VudCAqIDEyICsgNik7CiAgbGV0IHN0ck9mZnNldCA9IDA7CgogIGZvciAoaSA9IDAsIGlpID0gcGxhdGZvcm1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgIGNvbnN0IHN0cnMgPSBuYW1lc1tpXTsKCiAgICBmb3IgKGogPSAwLCBqaiA9IHN0cnMubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICBzdHIgPSBzdHJzW2pdOwogICAgICBjb25zdCBuYW1lUmVjb3JkID0gcGxhdGZvcm1zW2ldICsgZW5jb2RpbmdzW2ldICsgbGFuZ3VhZ2VzW2ldICsgc3RyaW5nMTYoaikgKyBzdHJpbmcxNihzdHIubGVuZ3RoKSArIHN0cmluZzE2KHN0ck9mZnNldCk7CiAgICAgIG5hbWVUYWJsZSArPSBuYW1lUmVjb3JkOwogICAgICBzdHJPZmZzZXQgKz0gc3RyLmxlbmd0aDsKICAgIH0KICB9CgogIG5hbWVUYWJsZSArPSBzdHJpbmdzLmpvaW4oIiIpICsgc3RyaW5nc1VuaWNvZGUuam9pbigiIik7CiAgcmV0dXJuIG5hbWVUYWJsZTsKfQoKY2xhc3MgRm9udCB7CiAgY29uc3RydWN0b3IobmFtZSwgZmlsZSwgcHJvcGVydGllcykgewogICAgdGhpcy5uYW1lID0gbmFtZTsKICAgIHRoaXMucHNOYW1lID0gbnVsbDsKICAgIHRoaXMubWltZXR5cGUgPSBudWxsOwogICAgdGhpcy5kaXNhYmxlRm9udEZhY2UgPSBmYWxzZTsKICAgIHRoaXMubG9hZGVkTmFtZSA9IHByb3BlcnRpZXMubG9hZGVkTmFtZTsKICAgIHRoaXMuaXNUeXBlM0ZvbnQgPSBwcm9wZXJ0aWVzLmlzVHlwZTNGb250OwogICAgdGhpcy5taXNzaW5nRmlsZSA9IGZhbHNlOwogICAgdGhpcy5jc3NGb250SW5mbyA9IHByb3BlcnRpZXMuY3NzRm9udEluZm87CiAgICB0aGlzLl9jaGFyc0NhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMuX2dseXBoQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgbGV0IGlzU2VyaWZGb250ID0gISEocHJvcGVydGllcy5mbGFncyAmIF9mb250c191dGlscy5Gb250RmxhZ3MuU2VyaWYpOwoKICAgIGlmICghaXNTZXJpZkZvbnQgJiYgIXByb3BlcnRpZXMuaXNTaW11bGF0ZWRGbGFncykgewogICAgICBjb25zdCBiYXNlTmFtZSA9IG5hbWUucmVwbGFjZSgvWyxfXS9nLCAiLSIpLnNwbGl0KCItIilbMF0sCiAgICAgICAgICAgIHNlcmlmRm9udHMgPSAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldFNlcmlmRm9udHMpKCk7CgogICAgICBmb3IgKGNvbnN0IG5hbWVQYXJ0IG9mIGJhc2VOYW1lLnNwbGl0KCIrIikpIHsKICAgICAgICBpZiAoc2VyaWZGb250c1tuYW1lUGFydF0pIHsKICAgICAgICAgIGlzU2VyaWZGb250ID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHRoaXMuaXNTZXJpZkZvbnQgPSBpc1NlcmlmRm9udDsKICAgIHRoaXMuaXNTeW1ib2xpY0ZvbnQgPSAhIShwcm9wZXJ0aWVzLmZsYWdzICYgX2ZvbnRzX3V0aWxzLkZvbnRGbGFncy5TeW1ib2xpYyk7CiAgICB0aGlzLmlzTW9ub3NwYWNlID0gISEocHJvcGVydGllcy5mbGFncyAmIF9mb250c191dGlscy5Gb250RmxhZ3MuRml4ZWRQaXRjaCk7CiAgICBsZXQgdHlwZSA9IHByb3BlcnRpZXMudHlwZTsKICAgIGxldCBzdWJ0eXBlID0gcHJvcGVydGllcy5zdWJ0eXBlOwogICAgdGhpcy50eXBlID0gdHlwZTsKICAgIHRoaXMuc3VidHlwZSA9IHN1YnR5cGU7CiAgICBsZXQgZmFsbGJhY2tOYW1lID0gInNhbnMtc2VyaWYiOwoKICAgIGlmICh0aGlzLmlzTW9ub3NwYWNlKSB7CiAgICAgIGZhbGxiYWNrTmFtZSA9ICJtb25vc3BhY2UiOwogICAgfSBlbHNlIGlmICh0aGlzLmlzU2VyaWZGb250KSB7CiAgICAgIGZhbGxiYWNrTmFtZSA9ICJzZXJpZiI7CiAgICB9CgogICAgdGhpcy5mYWxsYmFja05hbWUgPSBmYWxsYmFja05hbWU7CiAgICB0aGlzLmRpZmZlcmVuY2VzID0gcHJvcGVydGllcy5kaWZmZXJlbmNlczsKICAgIHRoaXMud2lkdGhzID0gcHJvcGVydGllcy53aWR0aHM7CiAgICB0aGlzLmRlZmF1bHRXaWR0aCA9IHByb3BlcnRpZXMuZGVmYXVsdFdpZHRoOwogICAgdGhpcy5jb21wb3NpdGUgPSBwcm9wZXJ0aWVzLmNvbXBvc2l0ZTsKICAgIHRoaXMuY01hcCA9IHByb3BlcnRpZXMuY01hcDsKICAgIHRoaXMuY2FwSGVpZ2h0ID0gcHJvcGVydGllcy5jYXBIZWlnaHQgLyBQREZfR0xZUEhfU1BBQ0VfVU5JVFM7CiAgICB0aGlzLmFzY2VudCA9IHByb3BlcnRpZXMuYXNjZW50IC8gUERGX0dMWVBIX1NQQUNFX1VOSVRTOwogICAgdGhpcy5kZXNjZW50ID0gcHJvcGVydGllcy5kZXNjZW50IC8gUERGX0dMWVBIX1NQQUNFX1VOSVRTOwogICAgdGhpcy5saW5lSGVpZ2h0ID0gdGhpcy5hc2NlbnQgLSB0aGlzLmRlc2NlbnQ7CiAgICB0aGlzLmZvbnRNYXRyaXggPSBwcm9wZXJ0aWVzLmZvbnRNYXRyaXg7CiAgICB0aGlzLmJib3ggPSBwcm9wZXJ0aWVzLmJib3g7CiAgICB0aGlzLmRlZmF1bHRFbmNvZGluZyA9IHByb3BlcnRpZXMuZGVmYXVsdEVuY29kaW5nOwogICAgdGhpcy50b1VuaWNvZGUgPSBwcm9wZXJ0aWVzLnRvVW5pY29kZTsKICAgIHRoaXMudG9Gb250Q2hhciA9IFtdOwoKICAgIGlmIChwcm9wZXJ0aWVzLnR5cGUgPT09ICJUeXBlMyIpIHsKICAgICAgZm9yIChsZXQgY2hhckNvZGUgPSAwOyBjaGFyQ29kZSA8IDI1NjsgY2hhckNvZGUrKykgewogICAgICAgIHRoaXMudG9Gb250Q2hhcltjaGFyQ29kZV0gPSB0aGlzLmRpZmZlcmVuY2VzW2NoYXJDb2RlXSB8fCBwcm9wZXJ0aWVzLmRlZmF1bHRFbmNvZGluZ1tjaGFyQ29kZV07CiAgICAgIH0KCiAgICAgIHRoaXMuZm9udFR5cGUgPSBfdXRpbC5Gb250VHlwZS5UWVBFMzsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuY2lkRW5jb2RpbmcgPSBwcm9wZXJ0aWVzLmNpZEVuY29kaW5nIHx8ICIiOwogICAgdGhpcy52ZXJ0aWNhbCA9ICEhcHJvcGVydGllcy52ZXJ0aWNhbDsKCiAgICBpZiAodGhpcy52ZXJ0aWNhbCkgewogICAgICB0aGlzLnZtZXRyaWNzID0gcHJvcGVydGllcy52bWV0cmljczsKICAgICAgdGhpcy5kZWZhdWx0Vk1ldHJpY3MgPSBwcm9wZXJ0aWVzLmRlZmF1bHRWTWV0cmljczsKICAgIH0KCiAgICBpZiAoIWZpbGUgfHwgZmlsZS5pc0VtcHR5KSB7CiAgICAgIGlmIChmaWxlKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCdGb250IGZpbGUgaXMgZW1wdHkgaW4gIicgKyBuYW1lICsgJyIgKCcgKyB0aGlzLmxvYWRlZE5hbWUgKyAiKSIpOwogICAgICB9CgogICAgICB0aGlzLmZhbGxiYWNrVG9TeXN0ZW1Gb250KHByb3BlcnRpZXMpOwogICAgICByZXR1cm47CiAgICB9CgogICAgW3R5cGUsIHN1YnR5cGVdID0gZ2V0Rm9udEZpbGVUeXBlKGZpbGUsIHByb3BlcnRpZXMpOwoKICAgIGlmICh0eXBlICE9PSB0aGlzLnR5cGUgfHwgc3VidHlwZSAhPT0gdGhpcy5zdWJ0eXBlKSB7CiAgICAgICgwLCBfdXRpbC5pbmZvKSgiSW5jb25zaXN0ZW50IGZvbnQgZmlsZSBUeXBlL1N1YlR5cGUsIGV4cGVjdGVkOiAiICsgYCR7dGhpcy50eXBlfS8ke3RoaXMuc3VidHlwZX0gYnV0IGZvdW5kOiAke3R5cGV9LyR7c3VidHlwZX0uYCk7CiAgICB9CgogICAgbGV0IGRhdGE7CgogICAgdHJ5IHsKICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgY2FzZSAiTU1UeXBlMSI6CiAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoIk1NVHlwZTEgZm9udCAoIiArIG5hbWUgKyAiKSwgZmFsbGluZyBiYWNrIHRvIFR5cGUxLiIpOwoKICAgICAgICBjYXNlICJUeXBlMSI6CiAgICAgICAgY2FzZSAiQ0lERm9udFR5cGUwIjoKICAgICAgICAgIHRoaXMubWltZXR5cGUgPSAiZm9udC9vcGVudHlwZSI7CiAgICAgICAgICBjb25zdCBjZmYgPSBzdWJ0eXBlID09PSAiVHlwZTFDIiB8fCBzdWJ0eXBlID09PSAiQ0lERm9udFR5cGUwQyIgPyBuZXcgX2NmZl9mb250LkNGRkZvbnQoZmlsZSwgcHJvcGVydGllcykgOiBuZXcgX3R5cGUxX2ZvbnQuVHlwZTFGb250KG5hbWUsIGZpbGUsIHByb3BlcnRpZXMpOwogICAgICAgICAgYWRqdXN0V2lkdGhzKHByb3BlcnRpZXMpOwogICAgICAgICAgZGF0YSA9IHRoaXMuY29udmVydChuYW1lLCBjZmYsIHByb3BlcnRpZXMpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIk9wZW5UeXBlIjoKICAgICAgICBjYXNlICJUcnVlVHlwZSI6CiAgICAgICAgY2FzZSAiQ0lERm9udFR5cGUyIjoKICAgICAgICAgIHRoaXMubWltZXR5cGUgPSAiZm9udC9vcGVudHlwZSI7CiAgICAgICAgICBkYXRhID0gdGhpcy5jaGVja0FuZFJlcGFpcihuYW1lLCBmaWxlLCBwcm9wZXJ0aWVzKTsKCiAgICAgICAgICBpZiAodGhpcy5pc09wZW5UeXBlKSB7CiAgICAgICAgICAgIGFkanVzdFdpZHRocyhwcm9wZXJ0aWVzKTsKICAgICAgICAgICAgdHlwZSA9ICJPcGVuVHlwZSI7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEZvbnQgJHt0eXBlfSBpcyBub3Qgc3VwcG9ydGVkYCk7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGUpOwogICAgICB0aGlzLmZhbGxiYWNrVG9TeXN0ZW1Gb250KHByb3BlcnRpZXMpOwogICAgICByZXR1cm47CiAgICB9CgogICAgYW1lbmRGYWxsYmFja1RvVW5pY29kZShwcm9wZXJ0aWVzKTsKICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICB0aGlzLmZvbnRUeXBlID0gKDAsIF9mb250c191dGlscy5nZXRGb250VHlwZSkodHlwZSwgc3VidHlwZSwgcHJvcGVydGllcy5pc1N0YW5kYXJkRm9udCk7CiAgICB0aGlzLmZvbnRNYXRyaXggPSBwcm9wZXJ0aWVzLmZvbnRNYXRyaXg7CiAgICB0aGlzLndpZHRocyA9IHByb3BlcnRpZXMud2lkdGhzOwogICAgdGhpcy5kZWZhdWx0V2lkdGggPSBwcm9wZXJ0aWVzLmRlZmF1bHRXaWR0aDsKICAgIHRoaXMudG9Vbmljb2RlID0gcHJvcGVydGllcy50b1VuaWNvZGU7CiAgICB0aGlzLnNlYWNNYXAgPSBwcm9wZXJ0aWVzLnNlYWNNYXA7CiAgfQoKICBnZXQgcmVuZGVyZXIoKSB7CiAgICBjb25zdCByZW5kZXJlciA9IF9mb250X3JlbmRlcmVyLkZvbnRSZW5kZXJlckZhY3RvcnkuY3JlYXRlKHRoaXMsIF9mb250c191dGlscy5TRUFDX0FOQUxZU0lTX0VOQUJMRUQpOwoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAicmVuZGVyZXIiLCByZW5kZXJlcik7CiAgfQoKICBleHBvcnREYXRhKCkgewogICAgbGV0IGV4dHJhUHJvcGVydGllcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CiAgICBjb25zdCBleHBvcnREYXRhUHJvcGVydGllcyA9IGV4dHJhUHJvcGVydGllcyA/IFsuLi5FWFBPUlRfREFUQV9QUk9QRVJUSUVTLCAuLi5FWFBPUlRfREFUQV9FWFRSQV9QUk9QRVJUSUVTXSA6IEVYUE9SVF9EQVRBX1BST1BFUlRJRVM7CiAgICBjb25zdCBkYXRhID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIGxldCBwcm9wZXJ0eSwgdmFsdWU7CgogICAgZm9yIChwcm9wZXJ0eSBvZiBleHBvcnREYXRhUHJvcGVydGllcykgewogICAgICB2YWx1ZSA9IHRoaXNbcHJvcGVydHldOwoKICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBkYXRhW3Byb3BlcnR5XSA9IHZhbHVlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGRhdGE7CiAgfQoKICBmYWxsYmFja1RvU3lzdGVtRm9udChwcm9wZXJ0aWVzKSB7CiAgICB0aGlzLm1pc3NpbmdGaWxlID0gdHJ1ZTsKICAgIGNvbnN0IG5hbWUgPSB0aGlzLm5hbWU7CiAgICBjb25zdCB0eXBlID0gdGhpcy50eXBlOwogICAgY29uc3Qgc3VidHlwZSA9IHRoaXMuc3VidHlwZTsKICAgIGxldCBmb250TmFtZSA9ICgwLCBfZm9udHNfdXRpbHMubm9ybWFsaXplRm9udE5hbWUpKG5hbWUpOwogICAgY29uc3Qgc3RkRm9udE1hcCA9ICgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0U3RkRm9udE1hcCkoKSwKICAgICAgICAgIG5vblN0ZEZvbnRNYXAgPSAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldE5vblN0ZEZvbnRNYXApKCk7CiAgICBjb25zdCBpc1N0YW5kYXJkRm9udCA9ICEhc3RkRm9udE1hcFtmb250TmFtZV07CiAgICBjb25zdCBpc01hcHBlZFRvU3RhbmRhcmRGb250ID0gISEobm9uU3RkRm9udE1hcFtmb250TmFtZV0gJiYgc3RkRm9udE1hcFtub25TdGRGb250TWFwW2ZvbnROYW1lXV0pOwogICAgZm9udE5hbWUgPSBzdGRGb250TWFwW2ZvbnROYW1lXSB8fCBub25TdGRGb250TWFwW2ZvbnROYW1lXSB8fCBmb250TmFtZTsKICAgIGNvbnN0IGZvbnRCYXNpY01ldHJpY3NNYXAgPSAoMCwgX21ldHJpY3MuZ2V0Rm9udEJhc2ljTWV0cmljcykoKTsKICAgIGNvbnN0IG1ldHJpY3MgPSBmb250QmFzaWNNZXRyaWNzTWFwW2ZvbnROYW1lXTsKCiAgICBpZiAobWV0cmljcykgewogICAgICBpZiAoaXNOYU4odGhpcy5hc2NlbnQpKSB7CiAgICAgICAgdGhpcy5hc2NlbnQgPSBtZXRyaWNzLmFzY2VudCAvIFBERl9HTFlQSF9TUEFDRV9VTklUUzsKICAgICAgfQoKICAgICAgaWYgKGlzTmFOKHRoaXMuZGVzY2VudCkpIHsKICAgICAgICB0aGlzLmRlc2NlbnQgPSBtZXRyaWNzLmRlc2NlbnQgLyBQREZfR0xZUEhfU1BBQ0VfVU5JVFM7CiAgICAgIH0KCiAgICAgIGlmIChpc05hTih0aGlzLmNhcEhlaWdodCkpIHsKICAgICAgICB0aGlzLmNhcEhlaWdodCA9IG1ldHJpY3MuY2FwSGVpZ2h0IC8gUERGX0dMWVBIX1NQQUNFX1VOSVRTOwogICAgICB9CiAgICB9CgogICAgdGhpcy5ib2xkID0gZm9udE5hbWUuc2VhcmNoKC9ib2xkL2dpKSAhPT0gLTE7CiAgICB0aGlzLml0YWxpYyA9IGZvbnROYW1lLnNlYXJjaCgvb2JsaXF1ZS9naSkgIT09IC0xIHx8IGZvbnROYW1lLnNlYXJjaCgvaXRhbGljL2dpKSAhPT0gLTE7CiAgICB0aGlzLmJsYWNrID0gbmFtZS5zZWFyY2goL0JsYWNrL2cpICE9PSAtMTsKICAgIGNvbnN0IGlzTmFycm93ID0gbmFtZS5zZWFyY2goL05hcnJvdy9nKSAhPT0gLTE7CiAgICB0aGlzLnJlbWVhc3VyZSA9ICghaXNTdGFuZGFyZEZvbnQgfHwgaXNOYXJyb3cpICYmIE9iamVjdC5rZXlzKHRoaXMud2lkdGhzKS5sZW5ndGggPiAwOwoKICAgIGlmICgoaXNTdGFuZGFyZEZvbnQgfHwgaXNNYXBwZWRUb1N0YW5kYXJkRm9udCkgJiYgdHlwZSA9PT0gIkNJREZvbnRUeXBlMiIgJiYgdGhpcy5jaWRFbmNvZGluZy5zdGFydHNXaXRoKCJJZGVudGl0eS0iKSkgewogICAgICBjb25zdCBjaWRUb0dpZE1hcCA9IHByb3BlcnRpZXMuY2lkVG9HaWRNYXA7CiAgICAgIGNvbnN0IG1hcCA9IFtdOwogICAgICBhcHBseVN0YW5kYXJkRm9udEdseXBoTWFwKG1hcCwgKDAsIF9zdGFuZGFyZF9mb250cy5nZXRHbHlwaE1hcEZvclN0YW5kYXJkRm9udHMpKCkpOwoKICAgICAgaWYgKC9BcmlhbC0/QmxhY2svaS50ZXN0KG5hbWUpKSB7CiAgICAgICAgYXBwbHlTdGFuZGFyZEZvbnRHbHlwaE1hcChtYXAsICgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0U3VwcGxlbWVudGFsR2x5cGhNYXBGb3JBcmlhbEJsYWNrKSgpKTsKICAgICAgfSBlbHNlIGlmICgvQ2FsaWJyaS9pLnRlc3QobmFtZSkpIHsKICAgICAgICBhcHBseVN0YW5kYXJkRm9udEdseXBoTWFwKG1hcCwgKDAsIF9zdGFuZGFyZF9mb250cy5nZXRTdXBwbGVtZW50YWxHbHlwaE1hcEZvckNhbGlicmkpKCkpOwogICAgICB9CgogICAgICBpZiAoY2lkVG9HaWRNYXApIHsKICAgICAgICBmb3IgKGNvbnN0IGNoYXJDb2RlIGluIG1hcCkgewogICAgICAgICAgY29uc3QgY2lkID0gbWFwW2NoYXJDb2RlXTsKCiAgICAgICAgICBpZiAoY2lkVG9HaWRNYXBbY2lkXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIG1hcFsrY2hhckNvZGVdID0gY2lkVG9HaWRNYXBbY2lkXTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChjaWRUb0dpZE1hcC5sZW5ndGggIT09IHRoaXMudG9Vbmljb2RlLmxlbmd0aCAmJiBwcm9wZXJ0aWVzLmhhc0luY2x1ZGVkVG9Vbmljb2RlTWFwICYmIHRoaXMudG9Vbmljb2RlIGluc3RhbmNlb2YgX3RvX3VuaWNvZGVfbWFwLklkZW50aXR5VG9Vbmljb2RlTWFwKSB7CiAgICAgICAgICB0aGlzLnRvVW5pY29kZS5mb3JFYWNoKGZ1bmN0aW9uIChjaGFyQ29kZSwgdW5pY29kZUNoYXJDb2RlKSB7CiAgICAgICAgICAgIGNvbnN0IGNpZCA9IG1hcFtjaGFyQ29kZV07CgogICAgICAgICAgICBpZiAoY2lkVG9HaWRNYXBbY2lkXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgbWFwWytjaGFyQ29kZV0gPSB1bmljb2RlQ2hhckNvZGU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCEodGhpcy50b1VuaWNvZGUgaW5zdGFuY2VvZiBfdG9fdW5pY29kZV9tYXAuSWRlbnRpdHlUb1VuaWNvZGVNYXApKSB7CiAgICAgICAgdGhpcy50b1VuaWNvZGUuZm9yRWFjaChmdW5jdGlvbiAoY2hhckNvZGUsIHVuaWNvZGVDaGFyQ29kZSkgewogICAgICAgICAgbWFwWytjaGFyQ29kZV0gPSB1bmljb2RlQ2hhckNvZGU7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMudG9Gb250Q2hhciA9IG1hcDsKICAgICAgdGhpcy50b1VuaWNvZGUgPSBuZXcgX3RvX3VuaWNvZGVfbWFwLlRvVW5pY29kZU1hcChtYXApOwogICAgfSBlbHNlIGlmICgvU3ltYm9sL2kudGVzdChmb250TmFtZSkpIHsKICAgICAgdGhpcy50b0ZvbnRDaGFyID0gYnVpbGRUb0ZvbnRDaGFyKF9lbmNvZGluZ3MuU3ltYm9sU2V0RW5jb2RpbmcsICgwLCBfZ2x5cGhsaXN0LmdldEdseXBoc1VuaWNvZGUpKCksIHRoaXMuZGlmZmVyZW5jZXMpOwogICAgfSBlbHNlIGlmICgvRGluZ2JhdHMvaS50ZXN0KGZvbnROYW1lKSkgewogICAgICBpZiAoL1dpbmdkaW5ncy9pLnRlc3QobmFtZSkpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIk5vbi1lbWJlZGRlZCBXaW5nZGluZ3MgZm9udCwgZmFsbGluZyBiYWNrIHRvIFphcGZEaW5nYmF0cy4iKTsKICAgICAgfQoKICAgICAgdGhpcy50b0ZvbnRDaGFyID0gYnVpbGRUb0ZvbnRDaGFyKF9lbmNvZGluZ3MuWmFwZkRpbmdiYXRzRW5jb2RpbmcsICgwLCBfZ2x5cGhsaXN0LmdldERpbmdiYXRzR2x5cGhzVW5pY29kZSkoKSwgdGhpcy5kaWZmZXJlbmNlcyk7CiAgICB9IGVsc2UgaWYgKGlzU3RhbmRhcmRGb250KSB7CiAgICAgIGNvbnN0IG1hcCA9IGJ1aWxkVG9Gb250Q2hhcih0aGlzLmRlZmF1bHRFbmNvZGluZywgKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKSwgdGhpcy5kaWZmZXJlbmNlcyk7CgogICAgICBpZiAodHlwZSA9PT0gIkNJREZvbnRUeXBlMiIgJiYgIXRoaXMuY2lkRW5jb2Rpbmcuc3RhcnRzV2l0aCgiSWRlbnRpdHktIikgJiYgISh0aGlzLnRvVW5pY29kZSBpbnN0YW5jZW9mIF90b191bmljb2RlX21hcC5JZGVudGl0eVRvVW5pY29kZU1hcCkpIHsKICAgICAgICB0aGlzLnRvVW5pY29kZS5mb3JFYWNoKGZ1bmN0aW9uIChjaGFyQ29kZSwgdW5pY29kZUNoYXJDb2RlKSB7CiAgICAgICAgICBtYXBbK2NoYXJDb2RlXSA9IHVuaWNvZGVDaGFyQ29kZTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdGhpcy50b0ZvbnRDaGFyID0gbWFwOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgZ2x5cGhzVW5pY29kZU1hcCA9ICgwLCBfZ2x5cGhsaXN0LmdldEdseXBoc1VuaWNvZGUpKCk7CiAgICAgIGNvbnN0IG1hcCA9IFtdOwogICAgICB0aGlzLnRvVW5pY29kZS5mb3JFYWNoKChjaGFyQ29kZSwgdW5pY29kZUNoYXJDb2RlKSA9PiB7CiAgICAgICAgaWYgKCF0aGlzLmNvbXBvc2l0ZSkgewogICAgICAgICAgY29uc3QgZ2x5cGhOYW1lID0gdGhpcy5kaWZmZXJlbmNlc1tjaGFyQ29kZV0gfHwgdGhpcy5kZWZhdWx0RW5jb2RpbmdbY2hhckNvZGVdOwogICAgICAgICAgY29uc3QgdW5pY29kZSA9ICgwLCBfdW5pY29kZS5nZXRVbmljb2RlRm9yR2x5cGgpKGdseXBoTmFtZSwgZ2x5cGhzVW5pY29kZU1hcCk7CgogICAgICAgICAgaWYgKHVuaWNvZGUgIT09IC0xKSB7CiAgICAgICAgICAgIHVuaWNvZGVDaGFyQ29kZSA9IHVuaWNvZGU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBtYXBbK2NoYXJDb2RlXSA9IHVuaWNvZGVDaGFyQ29kZTsKICAgICAgfSk7CgogICAgICBpZiAodGhpcy5jb21wb3NpdGUgJiYgdGhpcy50b1VuaWNvZGUgaW5zdGFuY2VvZiBfdG9fdW5pY29kZV9tYXAuSWRlbnRpdHlUb1VuaWNvZGVNYXApIHsKICAgICAgICBpZiAoL1ZlcmRhbmEvaS50ZXN0KG5hbWUpKSB7CiAgICAgICAgICBhcHBseVN0YW5kYXJkRm9udEdseXBoTWFwKG1hcCwgKDAsIF9zdGFuZGFyZF9mb250cy5nZXRHbHlwaE1hcEZvclN0YW5kYXJkRm9udHMpKCkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy50b0ZvbnRDaGFyID0gbWFwOwogICAgfQoKICAgIGFtZW5kRmFsbGJhY2tUb1VuaWNvZGUocHJvcGVydGllcyk7CiAgICB0aGlzLmxvYWRlZE5hbWUgPSBmb250TmFtZS5zcGxpdCgiLSIpWzBdOwogICAgdGhpcy5mb250VHlwZSA9ICgwLCBfZm9udHNfdXRpbHMuZ2V0Rm9udFR5cGUpKHR5cGUsIHN1YnR5cGUsIHByb3BlcnRpZXMuaXNTdGFuZGFyZEZvbnQpOwogIH0KCiAgY2hlY2tBbmRSZXBhaXIobmFtZSwgZm9udCwgcHJvcGVydGllcykgewogICAgY29uc3QgVkFMSURfVEFCTEVTID0gWyJPUy8yIiwgImNtYXAiLCAiaGVhZCIsICJoaGVhIiwgImhtdHgiLCAibWF4cCIsICJuYW1lIiwgInBvc3QiLCAibG9jYSIsICJnbHlmIiwgImZwZ20iLCAicHJlcCIsICJjdnQgIiwgIkNGRiAiXTsKCiAgICBmdW5jdGlvbiByZWFkVGFibGVzKGZpbGUsIG51bVRhYmxlcykgewogICAgICBjb25zdCB0YWJsZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICB0YWJsZXNbIk9TLzIiXSA9IG51bGw7CiAgICAgIHRhYmxlcy5jbWFwID0gbnVsbDsKICAgICAgdGFibGVzLmhlYWQgPSBudWxsOwogICAgICB0YWJsZXMuaGhlYSA9IG51bGw7CiAgICAgIHRhYmxlcy5obXR4ID0gbnVsbDsKICAgICAgdGFibGVzLm1heHAgPSBudWxsOwogICAgICB0YWJsZXMubmFtZSA9IG51bGw7CiAgICAgIHRhYmxlcy5wb3N0ID0gbnVsbDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtVGFibGVzOyBpKyspIHsKICAgICAgICBjb25zdCB0YWJsZSA9IHJlYWRUYWJsZUVudHJ5KGZpbGUpOwoKICAgICAgICBpZiAoIVZBTElEX1RBQkxFUy5pbmNsdWRlcyh0YWJsZS50YWcpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmICh0YWJsZS5sZW5ndGggPT09IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdGFibGVzW3RhYmxlLnRhZ10gPSB0YWJsZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhYmxlczsKICAgIH0KCiAgICBmdW5jdGlvbiByZWFkVGFibGVFbnRyeShmaWxlKSB7CiAgICAgIGNvbnN0IHRhZyA9IGZpbGUuZ2V0U3RyaW5nKDQpOwogICAgICBjb25zdCBjaGVja3N1bSA9IGZpbGUuZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgY29uc3Qgb2Zmc2V0ID0gZmlsZS5nZXRJbnQzMigpID4+PiAwOwogICAgICBjb25zdCBsZW5ndGggPSBmaWxlLmdldEludDMyKCkgPj4+IDA7CiAgICAgIGNvbnN0IHByZXZpb3VzUG9zaXRpb24gPSBmaWxlLnBvczsKICAgICAgZmlsZS5wb3MgPSBmaWxlLnN0YXJ0IHx8IDA7CiAgICAgIGZpbGUuc2tpcChvZmZzZXQpOwogICAgICBjb25zdCBkYXRhID0gZmlsZS5nZXRCeXRlcyhsZW5ndGgpOwogICAgICBmaWxlLnBvcyA9IHByZXZpb3VzUG9zaXRpb247CgogICAgICBpZiAodGFnID09PSAiaGVhZCIpIHsKICAgICAgICBkYXRhWzhdID0gZGF0YVs5XSA9IGRhdGFbMTBdID0gZGF0YVsxMV0gPSAwOwogICAgICAgIGRhdGFbMTddIHw9IDB4MjA7CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgdGFnLAogICAgICAgIGNoZWNrc3VtLAogICAgICAgIGxlbmd0aCwKICAgICAgICBvZmZzZXQsCiAgICAgICAgZGF0YQogICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIHJlYWRPcGVuVHlwZUhlYWRlcih0dGYpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB2ZXJzaW9uOiB0dGYuZ2V0U3RyaW5nKDQpLAogICAgICAgIG51bVRhYmxlczogdHRmLmdldFVpbnQxNigpLAogICAgICAgIHNlYXJjaFJhbmdlOiB0dGYuZ2V0VWludDE2KCksCiAgICAgICAgZW50cnlTZWxlY3RvcjogdHRmLmdldFVpbnQxNigpLAogICAgICAgIHJhbmdlU2hpZnQ6IHR0Zi5nZXRVaW50MTYoKQogICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIHJlYWRUcnVlVHlwZUNvbGxlY3Rpb25IZWFkZXIodHRjKSB7CiAgICAgIGNvbnN0IHR0Y1RhZyA9IHR0Yy5nZXRTdHJpbmcoNCk7CiAgICAgICgwLCBfdXRpbC5hc3NlcnQpKHR0Y1RhZyA9PT0gInR0Y2YiLCAiTXVzdCBiZSBhIFRydWVUeXBlIENvbGxlY3Rpb24gZm9udC4iKTsKICAgICAgY29uc3QgbWFqb3JWZXJzaW9uID0gdHRjLmdldFVpbnQxNigpOwogICAgICBjb25zdCBtaW5vclZlcnNpb24gPSB0dGMuZ2V0VWludDE2KCk7CiAgICAgIGNvbnN0IG51bUZvbnRzID0gdHRjLmdldEludDMyKCkgPj4+IDA7CiAgICAgIGNvbnN0IG9mZnNldFRhYmxlID0gW107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZvbnRzOyBpKyspIHsKICAgICAgICBvZmZzZXRUYWJsZS5wdXNoKHR0Yy5nZXRJbnQzMigpID4+PiAwKTsKICAgICAgfQoKICAgICAgY29uc3QgaGVhZGVyID0gewogICAgICAgIHR0Y1RhZywKICAgICAgICBtYWpvclZlcnNpb24sCiAgICAgICAgbWlub3JWZXJzaW9uLAogICAgICAgIG51bUZvbnRzLAogICAgICAgIG9mZnNldFRhYmxlCiAgICAgIH07CgogICAgICBzd2l0Y2ggKG1ham9yVmVyc2lvbikgewogICAgICAgIGNhc2UgMToKICAgICAgICAgIHJldHVybiBoZWFkZXI7CgogICAgICAgIGNhc2UgMjoKICAgICAgICAgIGhlYWRlci5kc2lnVGFnID0gdHRjLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgICBoZWFkZXIuZHNpZ0xlbmd0aCA9IHR0Yy5nZXRJbnQzMigpID4+PiAwOwogICAgICAgICAgaGVhZGVyLmRzaWdPZmZzZXQgPSB0dGMuZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgICAgIHJldHVybiBoZWFkZXI7CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW52YWxpZCBUcnVlVHlwZSBDb2xsZWN0aW9uIG1ham9yVmVyc2lvbjogJHttYWpvclZlcnNpb259LmApOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlYWRUcnVlVHlwZUNvbGxlY3Rpb25EYXRhKHR0YywgZm9udE5hbWUpIHsKICAgICAgY29uc3QgewogICAgICAgIG51bUZvbnRzLAogICAgICAgIG9mZnNldFRhYmxlCiAgICAgIH0gPSByZWFkVHJ1ZVR5cGVDb2xsZWN0aW9uSGVhZGVyKHR0Yyk7CiAgICAgIGNvbnN0IGZvbnROYW1lUGFydHMgPSBmb250TmFtZS5zcGxpdCgiKyIpOwogICAgICBsZXQgZmFsbGJhY2tEYXRhOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1Gb250czsgaSsrKSB7CiAgICAgICAgdHRjLnBvcyA9ICh0dGMuc3RhcnQgfHwgMCkgKyBvZmZzZXRUYWJsZVtpXTsKICAgICAgICBjb25zdCBwb3RlbnRpYWxIZWFkZXIgPSByZWFkT3BlblR5cGVIZWFkZXIodHRjKTsKICAgICAgICBjb25zdCBwb3RlbnRpYWxUYWJsZXMgPSByZWFkVGFibGVzKHR0YywgcG90ZW50aWFsSGVhZGVyLm51bVRhYmxlcyk7CgogICAgICAgIGlmICghcG90ZW50aWFsVGFibGVzLm5hbWUpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcignVHJ1ZVR5cGUgQ29sbGVjdGlvbiBmb250IG11c3QgY29udGFpbiBhICJuYW1lIiB0YWJsZS4nKTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IG5hbWVUYWJsZSA9IHJlYWROYW1lVGFibGUocG90ZW50aWFsVGFibGVzLm5hbWUpOwoKICAgICAgICBmb3IgKGxldCBqID0gMCwgamogPSBuYW1lVGFibGUubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgICAgZm9yIChsZXQgayA9IDAsIGtrID0gbmFtZVRhYmxlW2pdLmxlbmd0aDsgayA8IGtrOyBrKyspIHsKICAgICAgICAgICAgY29uc3QgbmFtZUVudHJ5ID0gbmFtZVRhYmxlW2pdW2tdICYmIG5hbWVUYWJsZVtqXVtrXS5yZXBsYWNlKC9ccy9nLCAiIik7CgogICAgICAgICAgICBpZiAoIW5hbWVFbnRyeSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobmFtZUVudHJ5ID09PSBmb250TmFtZSkgewogICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBoZWFkZXI6IHBvdGVudGlhbEhlYWRlciwKICAgICAgICAgICAgICAgIHRhYmxlczogcG90ZW50aWFsVGFibGVzCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGZvbnROYW1lUGFydHMubGVuZ3RoIDwgMikgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgZm9udE5hbWVQYXJ0cykgewogICAgICAgICAgICAgIGlmIChuYW1lRW50cnkgPT09IHBhcnQpIHsKICAgICAgICAgICAgICAgIGZhbGxiYWNrRGF0YSA9IHsKICAgICAgICAgICAgICAgICAgbmFtZTogcGFydCwKICAgICAgICAgICAgICAgICAgaGVhZGVyOiBwb3RlbnRpYWxIZWFkZXIsCiAgICAgICAgICAgICAgICAgIHRhYmxlczogcG90ZW50aWFsVGFibGVzCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGZhbGxiYWNrRGF0YSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgVHJ1ZVR5cGUgQ29sbGVjdGlvbiBkb2VzIG5vdCBjb250YWluICIke2ZvbnROYW1lfSIgZm9udCwgYCArIGBmYWxsaW5nIGJhY2sgdG8gIiR7ZmFsbGJhY2tEYXRhLm5hbWV9IiBmb250IGluc3RlYWQuYCk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGhlYWRlcjogZmFsbGJhY2tEYXRhLmhlYWRlciwKICAgICAgICAgIHRhYmxlczogZmFsbGJhY2tEYXRhLnRhYmxlcwogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgVHJ1ZVR5cGUgQ29sbGVjdGlvbiBkb2VzIG5vdCBjb250YWluICIke2ZvbnROYW1lfSIgZm9udC5gKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZWFkQ21hcFRhYmxlKGNtYXAsIGZpbGUsIGlzU3ltYm9saWNGb250LCBoYXNFbmNvZGluZykgewogICAgICBpZiAoIWNtYXApIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIk5vIGNtYXAgdGFibGUgYXZhaWxhYmxlLiIpOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICBwbGF0Zm9ybUlkOiAtMSwKICAgICAgICAgIGVuY29kaW5nSWQ6IC0xLAogICAgICAgICAgbWFwcGluZ3M6IFtdLAogICAgICAgICAgaGFzU2hvcnRDbWFwOiBmYWxzZQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGxldCBzZWdtZW50OwogICAgICBsZXQgc3RhcnQgPSAoZmlsZS5zdGFydCB8fCAwKSArIGNtYXAub2Zmc2V0OwogICAgICBmaWxlLnBvcyA9IHN0YXJ0OwogICAgICBmaWxlLnNraXAoMik7CiAgICAgIGNvbnN0IG51bVRhYmxlcyA9IGZpbGUuZ2V0VWludDE2KCk7CiAgICAgIGxldCBwb3RlbnRpYWxUYWJsZTsKICAgICAgbGV0IGNhbkJyZWFrID0gZmFsc2U7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVRhYmxlczsgaSsrKSB7CiAgICAgICAgY29uc3QgcGxhdGZvcm1JZCA9IGZpbGUuZ2V0VWludDE2KCk7CiAgICAgICAgY29uc3QgZW5jb2RpbmdJZCA9IGZpbGUuZ2V0VWludDE2KCk7CiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gZmlsZS5nZXRJbnQzMigpID4+PiAwOwogICAgICAgIGxldCB1c2VUYWJsZSA9IGZhbHNlOwoKICAgICAgICBpZiAocG90ZW50aWFsVGFibGUgJiYgcG90ZW50aWFsVGFibGUucGxhdGZvcm1JZCA9PT0gcGxhdGZvcm1JZCAmJiBwb3RlbnRpYWxUYWJsZS5lbmNvZGluZ0lkID09PSBlbmNvZGluZ0lkKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmIChwbGF0Zm9ybUlkID09PSAwICYmIChlbmNvZGluZ0lkID09PSAwIHx8IGVuY29kaW5nSWQgPT09IDEgfHwgZW5jb2RpbmdJZCA9PT0gMykpIHsKICAgICAgICAgIHVzZVRhYmxlID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKHBsYXRmb3JtSWQgPT09IDEgJiYgZW5jb2RpbmdJZCA9PT0gMCkgewogICAgICAgICAgdXNlVGFibGUgPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAocGxhdGZvcm1JZCA9PT0gMyAmJiBlbmNvZGluZ0lkID09PSAxICYmIChoYXNFbmNvZGluZyB8fCAhcG90ZW50aWFsVGFibGUpKSB7CiAgICAgICAgICB1c2VUYWJsZSA9IHRydWU7CgogICAgICAgICAgaWYgKCFpc1N5bWJvbGljRm9udCkgewogICAgICAgICAgICBjYW5CcmVhayA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChpc1N5bWJvbGljRm9udCAmJiBwbGF0Zm9ybUlkID09PSAzICYmIGVuY29kaW5nSWQgPT09IDApIHsKICAgICAgICAgIHVzZVRhYmxlID0gdHJ1ZTsKICAgICAgICAgIGxldCBjb3JyZWN0bHlTb3J0ZWQgPSB0cnVlOwoKICAgICAgICAgIGlmIChpIDwgbnVtVGFibGVzIC0gMSkgewogICAgICAgICAgICBjb25zdCBuZXh0Qnl0ZXMgPSBmaWxlLnBlZWtCeXRlcygyKSwKICAgICAgICAgICAgICAgICAgbmV4dFBsYXRmb3JtSWQgPSBpbnQxNihuZXh0Qnl0ZXNbMF0sIG5leHRCeXRlc1sxXSk7CgogICAgICAgICAgICBpZiAobmV4dFBsYXRmb3JtSWQgPCBwbGF0Zm9ybUlkKSB7CiAgICAgICAgICAgICAgY29ycmVjdGx5U29ydGVkID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY29ycmVjdGx5U29ydGVkKSB7CiAgICAgICAgICAgIGNhbkJyZWFrID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh1c2VUYWJsZSkgewogICAgICAgICAgcG90ZW50aWFsVGFibGUgPSB7CiAgICAgICAgICAgIHBsYXRmb3JtSWQsCiAgICAgICAgICAgIGVuY29kaW5nSWQsCiAgICAgICAgICAgIG9mZnNldAogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIGlmIChjYW5CcmVhaykgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAocG90ZW50aWFsVGFibGUpIHsKICAgICAgICBmaWxlLnBvcyA9IHN0YXJ0ICsgcG90ZW50aWFsVGFibGUub2Zmc2V0OwogICAgICB9CgogICAgICBpZiAoIXBvdGVudGlhbFRhYmxlIHx8IGZpbGUucGVla0J5dGUoKSA9PT0gLTEpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIkNvdWxkIG5vdCBmaW5kIGEgcHJlZmVycmVkIGNtYXAgdGFibGUuIik7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHBsYXRmb3JtSWQ6IC0xLAogICAgICAgICAgZW5jb2RpbmdJZDogLTEsCiAgICAgICAgICBtYXBwaW5nczogW10sCiAgICAgICAgICBoYXNTaG9ydENtYXA6IGZhbHNlCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgY29uc3QgZm9ybWF0ID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgbGV0IGhhc1Nob3J0Q21hcCA9IGZhbHNlOwogICAgICBjb25zdCBtYXBwaW5ncyA9IFtdOwogICAgICBsZXQgaiwgZ2x5cGhJZDsKCiAgICAgIGlmIChmb3JtYXQgPT09IDApIHsKICAgICAgICBmaWxlLnNraXAoMiArIDIpOwoKICAgICAgICBmb3IgKGogPSAwOyBqIDwgMjU2OyBqKyspIHsKICAgICAgICAgIGNvbnN0IGluZGV4ID0gZmlsZS5nZXRCeXRlKCk7CgogICAgICAgICAgaWYgKCFpbmRleCkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBtYXBwaW5ncy5wdXNoKHsKICAgICAgICAgICAgY2hhckNvZGU6IGosCiAgICAgICAgICAgIGdseXBoSWQ6IGluZGV4CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGhhc1Nob3J0Q21hcCA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAyKSB7CiAgICAgICAgZmlsZS5za2lwKDIgKyAyKTsKICAgICAgICBjb25zdCBzdWJIZWFkZXJLZXlzID0gW107CiAgICAgICAgbGV0IG1heFN1YkhlYWRlcktleSA9IDA7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyBpKyspIHsKICAgICAgICAgIGNvbnN0IHN1YkhlYWRlcktleSA9IGZpbGUuZ2V0VWludDE2KCkgPj4gMzsKICAgICAgICAgIHN1YkhlYWRlcktleXMucHVzaChzdWJIZWFkZXJLZXkpOwogICAgICAgICAgbWF4U3ViSGVhZGVyS2V5ID0gTWF0aC5tYXgoc3ViSGVhZGVyS2V5LCBtYXhTdWJIZWFkZXJLZXkpOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgc3ViSGVhZGVycyA9IFtdOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBtYXhTdWJIZWFkZXJLZXk7IGkrKykgewogICAgICAgICAgc3ViSGVhZGVycy5wdXNoKHsKICAgICAgICAgICAgZmlyc3RDb2RlOiBmaWxlLmdldFVpbnQxNigpLAogICAgICAgICAgICBlbnRyeUNvdW50OiBmaWxlLmdldFVpbnQxNigpLAogICAgICAgICAgICBpZERlbHRhOiBzaWduZWRJbnQxNihmaWxlLmdldEJ5dGUoKSwgZmlsZS5nZXRCeXRlKCkpLAogICAgICAgICAgICBpZFJhbmdlUG9zOiBmaWxlLnBvcyArIGZpbGUuZ2V0VWludDE2KCkKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7IGkrKykgewogICAgICAgICAgaWYgKHN1YkhlYWRlcktleXNbaV0gPT09IDApIHsKICAgICAgICAgICAgZmlsZS5wb3MgPSBzdWJIZWFkZXJzWzBdLmlkUmFuZ2VQb3MgKyAyICogaTsKICAgICAgICAgICAgZ2x5cGhJZCA9IGZpbGUuZ2V0VWludDE2KCk7CiAgICAgICAgICAgIG1hcHBpbmdzLnB1c2goewogICAgICAgICAgICAgIGNoYXJDb2RlOiBpLAogICAgICAgICAgICAgIGdseXBoSWQKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBzID0gc3ViSGVhZGVyc1tzdWJIZWFkZXJLZXlzW2ldXTsKCiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBzLmVudHJ5Q291bnQ7IGorKykgewogICAgICAgICAgICAgIGNvbnN0IGNoYXJDb2RlID0gKGkgPDwgOCkgKyBqICsgcy5maXJzdENvZGU7CiAgICAgICAgICAgICAgZmlsZS5wb3MgPSBzLmlkUmFuZ2VQb3MgKyAyICogajsKICAgICAgICAgICAgICBnbHlwaElkID0gZmlsZS5nZXRVaW50MTYoKTsKCiAgICAgICAgICAgICAgaWYgKGdseXBoSWQgIT09IDApIHsKICAgICAgICAgICAgICAgIGdseXBoSWQgPSAoZ2x5cGhJZCArIHMuaWREZWx0YSkgJSA2NTUzNjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIG1hcHBpbmdzLnB1c2goewogICAgICAgICAgICAgICAgY2hhckNvZGUsCiAgICAgICAgICAgICAgICBnbHlwaElkCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSA0KSB7CiAgICAgICAgZmlsZS5za2lwKDIgKyAyKTsKICAgICAgICBjb25zdCBzZWdDb3VudCA9IGZpbGUuZ2V0VWludDE2KCkgPj4gMTsKICAgICAgICBmaWxlLnNraXAoNik7CiAgICAgICAgY29uc3Qgc2VnbWVudHMgPSBbXTsKICAgICAgICBsZXQgc2VnSW5kZXg7CgogICAgICAgIGZvciAoc2VnSW5kZXggPSAwOyBzZWdJbmRleCA8IHNlZ0NvdW50OyBzZWdJbmRleCsrKSB7CiAgICAgICAgICBzZWdtZW50cy5wdXNoKHsKICAgICAgICAgICAgZW5kOiBmaWxlLmdldFVpbnQxNigpCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZpbGUuc2tpcCgyKTsKCiAgICAgICAgZm9yIChzZWdJbmRleCA9IDA7IHNlZ0luZGV4IDwgc2VnQ291bnQ7IHNlZ0luZGV4KyspIHsKICAgICAgICAgIHNlZ21lbnRzW3NlZ0luZGV4XS5zdGFydCA9IGZpbGUuZ2V0VWludDE2KCk7CiAgICAgICAgfQoKICAgICAgICBmb3IgKHNlZ0luZGV4ID0gMDsgc2VnSW5kZXggPCBzZWdDb3VudDsgc2VnSW5kZXgrKykgewogICAgICAgICAgc2VnbWVudHNbc2VnSW5kZXhdLmRlbHRhID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICB9CgogICAgICAgIGxldCBvZmZzZXRzQ291bnQgPSAwLAogICAgICAgICAgICBvZmZzZXRJbmRleDsKCiAgICAgICAgZm9yIChzZWdJbmRleCA9IDA7IHNlZ0luZGV4IDwgc2VnQ291bnQ7IHNlZ0luZGV4KyspIHsKICAgICAgICAgIHNlZ21lbnQgPSBzZWdtZW50c1tzZWdJbmRleF07CiAgICAgICAgICBjb25zdCByYW5nZU9mZnNldCA9IGZpbGUuZ2V0VWludDE2KCk7CgogICAgICAgICAgaWYgKCFyYW5nZU9mZnNldCkgewogICAgICAgICAgICBzZWdtZW50Lm9mZnNldEluZGV4ID0gLTE7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIG9mZnNldEluZGV4ID0gKHJhbmdlT2Zmc2V0ID4+IDEpIC0gKHNlZ0NvdW50IC0gc2VnSW5kZXgpOwogICAgICAgICAgc2VnbWVudC5vZmZzZXRJbmRleCA9IG9mZnNldEluZGV4OwogICAgICAgICAgb2Zmc2V0c0NvdW50ID0gTWF0aC5tYXgob2Zmc2V0c0NvdW50LCBvZmZzZXRJbmRleCArIHNlZ21lbnQuZW5kIC0gc2VnbWVudC5zdGFydCArIDEpOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgb2Zmc2V0cyA9IFtdOwoKICAgICAgICBmb3IgKGogPSAwOyBqIDwgb2Zmc2V0c0NvdW50OyBqKyspIHsKICAgICAgICAgIG9mZnNldHMucHVzaChmaWxlLmdldFVpbnQxNigpKTsKICAgICAgICB9CgogICAgICAgIGZvciAoc2VnSW5kZXggPSAwOyBzZWdJbmRleCA8IHNlZ0NvdW50OyBzZWdJbmRleCsrKSB7CiAgICAgICAgICBzZWdtZW50ID0gc2VnbWVudHNbc2VnSW5kZXhdOwogICAgICAgICAgc3RhcnQgPSBzZWdtZW50LnN0YXJ0OwogICAgICAgICAgY29uc3QgZW5kID0gc2VnbWVudC5lbmQ7CiAgICAgICAgICBjb25zdCBkZWx0YSA9IHNlZ21lbnQuZGVsdGE7CiAgICAgICAgICBvZmZzZXRJbmRleCA9IHNlZ21lbnQub2Zmc2V0SW5kZXg7CgogICAgICAgICAgZm9yIChqID0gc3RhcnQ7IGogPD0gZW5kOyBqKyspIHsKICAgICAgICAgICAgaWYgKGogPT09IDB4ZmZmZikgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBnbHlwaElkID0gb2Zmc2V0SW5kZXggPCAwID8gaiA6IG9mZnNldHNbb2Zmc2V0SW5kZXggKyBqIC0gc3RhcnRdOwogICAgICAgICAgICBnbHlwaElkID0gZ2x5cGhJZCArIGRlbHRhICYgMHhmZmZmOwogICAgICAgICAgICBtYXBwaW5ncy5wdXNoKHsKICAgICAgICAgICAgICBjaGFyQ29kZTogaiwKICAgICAgICAgICAgICBnbHlwaElkCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09IDYpIHsKICAgICAgICBmaWxlLnNraXAoMiArIDIpOwogICAgICAgIGNvbnN0IGZpcnN0Q29kZSA9IGZpbGUuZ2V0VWludDE2KCk7CiAgICAgICAgY29uc3QgZW50cnlDb3VudCA9IGZpbGUuZ2V0VWludDE2KCk7CgogICAgICAgIGZvciAoaiA9IDA7IGogPCBlbnRyeUNvdW50OyBqKyspIHsKICAgICAgICAgIGdseXBoSWQgPSBmaWxlLmdldFVpbnQxNigpOwogICAgICAgICAgY29uc3QgY2hhckNvZGUgPSBmaXJzdENvZGUgKyBqOwogICAgICAgICAgbWFwcGluZ3MucHVzaCh7CiAgICAgICAgICAgIGNoYXJDb2RlLAogICAgICAgICAgICBnbHlwaElkCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAxMikgewogICAgICAgIGZpbGUuc2tpcCgyICsgNCArIDQpOwogICAgICAgIGNvbnN0IG5Hcm91cHMgPSBmaWxlLmdldEludDMyKCkgPj4+IDA7CgogICAgICAgIGZvciAoaiA9IDA7IGogPCBuR3JvdXBzOyBqKyspIHsKICAgICAgICAgIGNvbnN0IHN0YXJ0Q2hhckNvZGUgPSBmaWxlLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgICBjb25zdCBlbmRDaGFyQ29kZSA9IGZpbGUuZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgICAgIGxldCBnbHlwaENvZGUgPSBmaWxlLmdldEludDMyKCkgPj4+IDA7CgogICAgICAgICAgZm9yIChsZXQgY2hhckNvZGUgPSBzdGFydENoYXJDb2RlOyBjaGFyQ29kZSA8PSBlbmRDaGFyQ29kZTsgY2hhckNvZGUrKykgewogICAgICAgICAgICBtYXBwaW5ncy5wdXNoKHsKICAgICAgICAgICAgICBjaGFyQ29kZSwKICAgICAgICAgICAgICBnbHlwaElkOiBnbHlwaENvZGUrKwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJjbWFwIHRhYmxlIGhhcyB1bnN1cHBvcnRlZCBmb3JtYXQ6ICIgKyBmb3JtYXQpOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICBwbGF0Zm9ybUlkOiAtMSwKICAgICAgICAgIGVuY29kaW5nSWQ6IC0xLAogICAgICAgICAgbWFwcGluZ3M6IFtdLAogICAgICAgICAgaGFzU2hvcnRDbWFwOiBmYWxzZQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIG1hcHBpbmdzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICByZXR1cm4gYS5jaGFyQ29kZSAtIGIuY2hhckNvZGU7CiAgICAgIH0pOwoKICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBtYXBwaW5ncy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChtYXBwaW5nc1tpIC0gMV0uY2hhckNvZGUgPT09IG1hcHBpbmdzW2ldLmNoYXJDb2RlKSB7CiAgICAgICAgICBtYXBwaW5ncy5zcGxpY2UoaSwgMSk7CiAgICAgICAgICBpLS07CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIHBsYXRmb3JtSWQ6IHBvdGVudGlhbFRhYmxlLnBsYXRmb3JtSWQsCiAgICAgICAgZW5jb2RpbmdJZDogcG90ZW50aWFsVGFibGUuZW5jb2RpbmdJZCwKICAgICAgICBtYXBwaW5ncywKICAgICAgICBoYXNTaG9ydENtYXAKICAgICAgfTsKICAgIH0KCiAgICBmdW5jdGlvbiBzYW5pdGl6ZU1ldHJpY3MoZmlsZSwgaGVhZGVyLCBtZXRyaWNzLCBoZWFkVGFibGUsIG51bUdseXBocywgZHVwRmlyc3RFbnRyeSkgewogICAgICBpZiAoIWhlYWRlcikgewogICAgICAgIGlmIChtZXRyaWNzKSB7CiAgICAgICAgICBtZXRyaWNzLmRhdGEgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBmaWxlLnBvcyA9IChmaWxlLnN0YXJ0IHx8IDApICsgaGVhZGVyLm9mZnNldDsKICAgICAgZmlsZS5wb3MgKz0gNDsKICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgY29uc3QgY2FyZXRPZmZzZXQgPSBmaWxlLmdldFVpbnQxNigpOwogICAgICBmaWxlLnBvcyArPSA4OwogICAgICBmaWxlLnBvcyArPSAyOwogICAgICBsZXQgbnVtT2ZNZXRyaWNzID0gZmlsZS5nZXRVaW50MTYoKTsKCiAgICAgIGlmIChjYXJldE9mZnNldCAhPT0gMCkgewogICAgICAgIGNvbnN0IG1hY1N0eWxlID0gaW50MTYoaGVhZFRhYmxlLmRhdGFbNDRdLCBoZWFkVGFibGUuZGF0YVs0NV0pOwoKICAgICAgICBpZiAoIShtYWNTdHlsZSAmIDIpKSB7CiAgICAgICAgICBoZWFkZXIuZGF0YVsyMl0gPSAwOwogICAgICAgICAgaGVhZGVyLmRhdGFbMjNdID0gMDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChudW1PZk1ldHJpY3MgPiBudW1HbHlwaHMpIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoYFRoZSBudW1PZk1ldHJpY3MgKCR7bnVtT2ZNZXRyaWNzfSkgc2hvdWxkIG5vdCBiZSBgICsgYGdyZWF0ZXIgdGhhbiB0aGUgbnVtR2x5cGhzICgke251bUdseXBoc30pLmApOwogICAgICAgIG51bU9mTWV0cmljcyA9IG51bUdseXBoczsKICAgICAgICBoZWFkZXIuZGF0YVszNF0gPSAobnVtT2ZNZXRyaWNzICYgMHhmZjAwKSA+PiA4OwogICAgICAgIGhlYWRlci5kYXRhWzM1XSA9IG51bU9mTWV0cmljcyAmIDB4MDBmZjsKICAgICAgfQoKICAgICAgY29uc3QgbnVtT2ZTaWRlYmVhcmluZ3MgPSBudW1HbHlwaHMgLSBudW1PZk1ldHJpY3M7CiAgICAgIGNvbnN0IG51bU1pc3NpbmcgPSBudW1PZlNpZGViZWFyaW5ncyAtIChtZXRyaWNzLmxlbmd0aCAtIG51bU9mTWV0cmljcyAqIDQgPj4gMSk7CgogICAgICBpZiAobnVtTWlzc2luZyA+IDApIHsKICAgICAgICBjb25zdCBlbnRyaWVzID0gbmV3IFVpbnQ4QXJyYXkobWV0cmljcy5sZW5ndGggKyBudW1NaXNzaW5nICogMik7CiAgICAgICAgZW50cmllcy5zZXQobWV0cmljcy5kYXRhKTsKCiAgICAgICAgaWYgKGR1cEZpcnN0RW50cnkpIHsKICAgICAgICAgIGVudHJpZXNbbWV0cmljcy5sZW5ndGhdID0gbWV0cmljcy5kYXRhWzJdOwogICAgICAgICAgZW50cmllc1ttZXRyaWNzLmxlbmd0aCArIDFdID0gbWV0cmljcy5kYXRhWzNdOwogICAgICAgIH0KCiAgICAgICAgbWV0cmljcy5kYXRhID0gZW50cmllczsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNhbml0aXplR2x5cGgoc291cmNlLCBzb3VyY2VTdGFydCwgc291cmNlRW5kLCBkZXN0LCBkZXN0U3RhcnQsIGhpbnRzVmFsaWQpIHsKICAgICAgY29uc3QgZ2x5cGhQcm9maWxlID0gewogICAgICAgIGxlbmd0aDogMCwKICAgICAgICBzaXplT2ZJbnN0cnVjdGlvbnM6IDAKICAgICAgfTsKCiAgICAgIGlmIChzb3VyY2VFbmQgLSBzb3VyY2VTdGFydCA8PSAxMikgewogICAgICAgIHJldHVybiBnbHlwaFByb2ZpbGU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGdseWYgPSBzb3VyY2Uuc3ViYXJyYXkoc291cmNlU3RhcnQsIHNvdXJjZUVuZCk7CiAgICAgIGxldCBjb250b3Vyc0NvdW50ID0gc2lnbmVkSW50MTYoZ2x5ZlswXSwgZ2x5ZlsxXSk7CgogICAgICBpZiAoY29udG91cnNDb3VudCA8IDApIHsKICAgICAgICBjb250b3Vyc0NvdW50ID0gLTE7CiAgICAgICAgd3JpdGVTaWduZWRJbnQxNihnbHlmLCAwLCBjb250b3Vyc0NvdW50KTsKICAgICAgICBkZXN0LnNldChnbHlmLCBkZXN0U3RhcnQpOwogICAgICAgIGdseXBoUHJvZmlsZS5sZW5ndGggPSBnbHlmLmxlbmd0aDsKICAgICAgICByZXR1cm4gZ2x5cGhQcm9maWxlOwogICAgICB9CgogICAgICBsZXQgaSwKICAgICAgICAgIGogPSAxMCwKICAgICAgICAgIGZsYWdzQ291bnQgPSAwOwoKICAgICAgZm9yIChpID0gMDsgaSA8IGNvbnRvdXJzQ291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IGVuZFBvaW50ID0gZ2x5ZltqXSA8PCA4IHwgZ2x5ZltqICsgMV07CiAgICAgICAgZmxhZ3NDb3VudCA9IGVuZFBvaW50ICsgMTsKICAgICAgICBqICs9IDI7CiAgICAgIH0KCiAgICAgIGNvbnN0IGluc3RydWN0aW9uc1N0YXJ0ID0gajsKICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25zTGVuZ3RoID0gZ2x5ZltqXSA8PCA4IHwgZ2x5ZltqICsgMV07CiAgICAgIGdseXBoUHJvZmlsZS5zaXplT2ZJbnN0cnVjdGlvbnMgPSBpbnN0cnVjdGlvbnNMZW5ndGg7CiAgICAgIGogKz0gMiArIGluc3RydWN0aW9uc0xlbmd0aDsKICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25zRW5kID0gajsKICAgICAgbGV0IGNvb3JkaW5hdGVzTGVuZ3RoID0gMDsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBmbGFnc0NvdW50OyBpKyspIHsKICAgICAgICBjb25zdCBmbGFnID0gZ2x5ZltqKytdOwoKICAgICAgICBpZiAoZmxhZyAmIDB4YzApIHsKICAgICAgICAgIGdseWZbaiAtIDFdID0gZmxhZyAmIDB4M2Y7CiAgICAgICAgfQoKICAgICAgICBsZXQgeExlbmd0aCA9IDI7CgogICAgICAgIGlmIChmbGFnICYgMikgewogICAgICAgICAgeExlbmd0aCA9IDE7CiAgICAgICAgfSBlbHNlIGlmIChmbGFnICYgMTYpIHsKICAgICAgICAgIHhMZW5ndGggPSAwOwogICAgICAgIH0KCiAgICAgICAgbGV0IHlMZW5ndGggPSAyOwoKICAgICAgICBpZiAoZmxhZyAmIDQpIHsKICAgICAgICAgIHlMZW5ndGggPSAxOwogICAgICAgIH0gZWxzZSBpZiAoZmxhZyAmIDMyKSB7CiAgICAgICAgICB5TGVuZ3RoID0gMDsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHh5TGVuZ3RoID0geExlbmd0aCArIHlMZW5ndGg7CiAgICAgICAgY29vcmRpbmF0ZXNMZW5ndGggKz0geHlMZW5ndGg7CgogICAgICAgIGlmIChmbGFnICYgOCkgewogICAgICAgICAgY29uc3QgcmVwZWF0ID0gZ2x5ZltqKytdOwogICAgICAgICAgaSArPSByZXBlYXQ7CiAgICAgICAgICBjb29yZGluYXRlc0xlbmd0aCArPSByZXBlYXQgKiB4eUxlbmd0aDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChjb29yZGluYXRlc0xlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiBnbHlwaFByb2ZpbGU7CiAgICAgIH0KCiAgICAgIGxldCBnbHlwaERhdGFMZW5ndGggPSBqICsgY29vcmRpbmF0ZXNMZW5ndGg7CgogICAgICBpZiAoZ2x5cGhEYXRhTGVuZ3RoID4gZ2x5Zi5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gZ2x5cGhQcm9maWxlOwogICAgICB9CgogICAgICBpZiAoIWhpbnRzVmFsaWQgJiYgaW5zdHJ1Y3Rpb25zTGVuZ3RoID4gMCkgewogICAgICAgIGRlc3Quc2V0KGdseWYuc3ViYXJyYXkoMCwgaW5zdHJ1Y3Rpb25zU3RhcnQpLCBkZXN0U3RhcnQpOwogICAgICAgIGRlc3Quc2V0KFswLCAwXSwgZGVzdFN0YXJ0ICsgaW5zdHJ1Y3Rpb25zU3RhcnQpOwogICAgICAgIGRlc3Quc2V0KGdseWYuc3ViYXJyYXkoaW5zdHJ1Y3Rpb25zRW5kLCBnbHlwaERhdGFMZW5ndGgpLCBkZXN0U3RhcnQgKyBpbnN0cnVjdGlvbnNTdGFydCArIDIpOwogICAgICAgIGdseXBoRGF0YUxlbmd0aCAtPSBpbnN0cnVjdGlvbnNMZW5ndGg7CgogICAgICAgIGlmIChnbHlmLmxlbmd0aCAtIGdseXBoRGF0YUxlbmd0aCA+IDMpIHsKICAgICAgICAgIGdseXBoRGF0YUxlbmd0aCA9IGdseXBoRGF0YUxlbmd0aCArIDMgJiB+MzsKICAgICAgICB9CgogICAgICAgIGdseXBoUHJvZmlsZS5sZW5ndGggPSBnbHlwaERhdGFMZW5ndGg7CiAgICAgICAgcmV0dXJuIGdseXBoUHJvZmlsZTsKICAgICAgfQoKICAgICAgaWYgKGdseWYubGVuZ3RoIC0gZ2x5cGhEYXRhTGVuZ3RoID4gMykgewogICAgICAgIGdseXBoRGF0YUxlbmd0aCA9IGdseXBoRGF0YUxlbmd0aCArIDMgJiB+MzsKICAgICAgICBkZXN0LnNldChnbHlmLnN1YmFycmF5KDAsIGdseXBoRGF0YUxlbmd0aCksIGRlc3RTdGFydCk7CiAgICAgICAgZ2x5cGhQcm9maWxlLmxlbmd0aCA9IGdseXBoRGF0YUxlbmd0aDsKICAgICAgICByZXR1cm4gZ2x5cGhQcm9maWxlOwogICAgICB9CgogICAgICBkZXN0LnNldChnbHlmLCBkZXN0U3RhcnQpOwogICAgICBnbHlwaFByb2ZpbGUubGVuZ3RoID0gZ2x5Zi5sZW5ndGg7CiAgICAgIHJldHVybiBnbHlwaFByb2ZpbGU7CiAgICB9CgogICAgZnVuY3Rpb24gc2FuaXRpemVIZWFkKGhlYWQsIG51bUdseXBocywgbG9jYUxlbmd0aCkgewogICAgICBjb25zdCBkYXRhID0gaGVhZC5kYXRhOwogICAgICBjb25zdCB2ZXJzaW9uID0gaW50MzIoZGF0YVswXSwgZGF0YVsxXSwgZGF0YVsyXSwgZGF0YVszXSk7CgogICAgICBpZiAodmVyc2lvbiA+PiAxNiAhPT0gMSkgewogICAgICAgICgwLCBfdXRpbC5pbmZvKSgiQXR0ZW1wdGluZyB0byBmaXggaW52YWxpZCB2ZXJzaW9uIGluIGhlYWQgdGFibGU6ICIgKyB2ZXJzaW9uKTsKICAgICAgICBkYXRhWzBdID0gMDsKICAgICAgICBkYXRhWzFdID0gMTsKICAgICAgICBkYXRhWzJdID0gMDsKICAgICAgICBkYXRhWzNdID0gMDsKICAgICAgfQoKICAgICAgY29uc3QgaW5kZXhUb0xvY0Zvcm1hdCA9IGludDE2KGRhdGFbNTBdLCBkYXRhWzUxXSk7CgogICAgICBpZiAoaW5kZXhUb0xvY0Zvcm1hdCA8IDAgfHwgaW5kZXhUb0xvY0Zvcm1hdCA+IDEpIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkF0dGVtcHRpbmcgdG8gZml4IGludmFsaWQgaW5kZXhUb0xvY0Zvcm1hdCBpbiBoZWFkIHRhYmxlOiAiICsgaW5kZXhUb0xvY0Zvcm1hdCk7CiAgICAgICAgY29uc3QgbnVtR2x5cGhzUGx1c09uZSA9IG51bUdseXBocyArIDE7CgogICAgICAgIGlmIChsb2NhTGVuZ3RoID09PSBudW1HbHlwaHNQbHVzT25lIDw8IDEpIHsKICAgICAgICAgIGRhdGFbNTBdID0gMDsKICAgICAgICAgIGRhdGFbNTFdID0gMDsKICAgICAgICB9IGVsc2UgaWYgKGxvY2FMZW5ndGggPT09IG51bUdseXBoc1BsdXNPbmUgPDwgMikgewogICAgICAgICAgZGF0YVs1MF0gPSAwOwogICAgICAgICAgZGF0YVs1MV0gPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkNvdWxkIG5vdCBmaXggaW5kZXhUb0xvY0Zvcm1hdDogIiArIGluZGV4VG9Mb2NGb3JtYXQpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNhbml0aXplR2x5cGhMb2NhdGlvbnMobG9jYSwgZ2x5ZiwgbnVtR2x5cGhzLCBpc0dseXBoTG9jYXRpb25zTG9uZywgaGludHNWYWxpZCwgZHVwRmlyc3RFbnRyeSwgbWF4U2l6ZU9mSW5zdHJ1Y3Rpb25zKSB7CiAgICAgIGxldCBpdGVtU2l6ZSwgaXRlbURlY29kZSwgaXRlbUVuY29kZTsKCiAgICAgIGlmIChpc0dseXBoTG9jYXRpb25zTG9uZykgewogICAgICAgIGl0ZW1TaXplID0gNDsKCiAgICAgICAgaXRlbURlY29kZSA9IGZ1bmN0aW9uIGZvbnRJdGVtRGVjb2RlTG9uZyhkYXRhLCBvZmZzZXQpIHsKICAgICAgICAgIHJldHVybiBkYXRhW29mZnNldF0gPDwgMjQgfCBkYXRhW29mZnNldCArIDFdIDw8IDE2IHwgZGF0YVtvZmZzZXQgKyAyXSA8PCA4IHwgZGF0YVtvZmZzZXQgKyAzXTsKICAgICAgICB9OwoKICAgICAgICBpdGVtRW5jb2RlID0gZnVuY3Rpb24gZm9udEl0ZW1FbmNvZGVMb25nKGRhdGEsIG9mZnNldCwgdmFsdWUpIHsKICAgICAgICAgIGRhdGFbb2Zmc2V0XSA9IHZhbHVlID4+PiAyNCAmIDB4ZmY7CiAgICAgICAgICBkYXRhW29mZnNldCArIDFdID0gdmFsdWUgPj4gMTYgJiAweGZmOwogICAgICAgICAgZGF0YVtvZmZzZXQgKyAyXSA9IHZhbHVlID4+IDggJiAweGZmOwogICAgICAgICAgZGF0YVtvZmZzZXQgKyAzXSA9IHZhbHVlICYgMHhmZjsKICAgICAgICB9OwogICAgICB9IGVsc2UgewogICAgICAgIGl0ZW1TaXplID0gMjsKCiAgICAgICAgaXRlbURlY29kZSA9IGZ1bmN0aW9uIGZvbnRJdGVtRGVjb2RlKGRhdGEsIG9mZnNldCkgewogICAgICAgICAgcmV0dXJuIGRhdGFbb2Zmc2V0XSA8PCA5IHwgZGF0YVtvZmZzZXQgKyAxXSA8PCAxOwogICAgICAgIH07CgogICAgICAgIGl0ZW1FbmNvZGUgPSBmdW5jdGlvbiBmb250SXRlbUVuY29kZShkYXRhLCBvZmZzZXQsIHZhbHVlKSB7CiAgICAgICAgICBkYXRhW29mZnNldF0gPSB2YWx1ZSA+PiA5ICYgMHhmZjsKICAgICAgICAgIGRhdGFbb2Zmc2V0ICsgMV0gPSB2YWx1ZSA+PiAxICYgMHhmZjsKICAgICAgICB9OwogICAgICB9CgogICAgICBjb25zdCBudW1HbHlwaHNPdXQgPSBkdXBGaXJzdEVudHJ5ID8gbnVtR2x5cGhzICsgMSA6IG51bUdseXBoczsKICAgICAgY29uc3QgbG9jYURhdGFTaXplID0gaXRlbVNpemUgKiAoMSArIG51bUdseXBoc091dCk7CiAgICAgIGNvbnN0IGxvY2FEYXRhID0gbmV3IFVpbnQ4QXJyYXkobG9jYURhdGFTaXplKTsKICAgICAgbG9jYURhdGEuc2V0KGxvY2EuZGF0YS5zdWJhcnJheSgwLCBsb2NhRGF0YVNpemUpKTsKICAgICAgbG9jYS5kYXRhID0gbG9jYURhdGE7CiAgICAgIGNvbnN0IG9sZEdseWZEYXRhID0gZ2x5Zi5kYXRhOwogICAgICBjb25zdCBvbGRHbHlmRGF0YUxlbmd0aCA9IG9sZEdseWZEYXRhLmxlbmd0aDsKICAgICAgY29uc3QgbmV3R2x5ZkRhdGEgPSBuZXcgVWludDhBcnJheShvbGRHbHlmRGF0YUxlbmd0aCk7CiAgICAgIGxldCBpLCBqOwogICAgICBjb25zdCBsb2NhRW50cmllcyA9IFtdOwoKICAgICAgZm9yIChpID0gMCwgaiA9IDA7IGkgPCBudW1HbHlwaHMgKyAxOyBpKyssIGogKz0gaXRlbVNpemUpIHsKICAgICAgICBsZXQgb2Zmc2V0ID0gaXRlbURlY29kZShsb2NhRGF0YSwgaik7CgogICAgICAgIGlmIChvZmZzZXQgPiBvbGRHbHlmRGF0YUxlbmd0aCkgewogICAgICAgICAgb2Zmc2V0ID0gb2xkR2x5ZkRhdGFMZW5ndGg7CiAgICAgICAgfQoKICAgICAgICBsb2NhRW50cmllcy5wdXNoKHsKICAgICAgICAgIGluZGV4OiBpLAogICAgICAgICAgb2Zmc2V0LAogICAgICAgICAgZW5kT2Zmc2V0OiAwCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGxvY2FFbnRyaWVzLnNvcnQoKGEsIGIpID0+IHsKICAgICAgICByZXR1cm4gYS5vZmZzZXQgLSBiLm9mZnNldDsKICAgICAgfSk7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtR2x5cGhzOyBpKyspIHsKICAgICAgICBsb2NhRW50cmllc1tpXS5lbmRPZmZzZXQgPSBsb2NhRW50cmllc1tpICsgMV0ub2Zmc2V0OwogICAgICB9CgogICAgICBsb2NhRW50cmllcy5zb3J0KChhLCBiKSA9PiB7CiAgICAgICAgcmV0dXJuIGEuaW5kZXggLSBiLmluZGV4OwogICAgICB9KTsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBudW1HbHlwaHM7IGkrKykgewogICAgICAgIGNvbnN0IHsKICAgICAgICAgIG9mZnNldCwKICAgICAgICAgIGVuZE9mZnNldAogICAgICAgIH0gPSBsb2NhRW50cmllc1tpXTsKCiAgICAgICAgaWYgKG9mZnNldCAhPT0gMCB8fCBlbmRPZmZzZXQgIT09IDApIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgbmV4dE9mZnNldCA9IGxvY2FFbnRyaWVzW2kgKyAxXS5vZmZzZXQ7CgogICAgICAgIGlmIChuZXh0T2Zmc2V0ID09PSAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGxvY2FFbnRyaWVzW2ldLmVuZE9mZnNldCA9IG5leHRPZmZzZXQ7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGNvbnN0IG1pc3NpbmdHbHlwaHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICBsZXQgd3JpdGVPZmZzZXQgPSAwOwogICAgICBpdGVtRW5jb2RlKGxvY2FEYXRhLCAwLCB3cml0ZU9mZnNldCk7CgogICAgICBmb3IgKGkgPSAwLCBqID0gaXRlbVNpemU7IGkgPCBudW1HbHlwaHM7IGkrKywgaiArPSBpdGVtU2l6ZSkgewogICAgICAgIGNvbnN0IGdseXBoUHJvZmlsZSA9IHNhbml0aXplR2x5cGgob2xkR2x5ZkRhdGEsIGxvY2FFbnRyaWVzW2ldLm9mZnNldCwgbG9jYUVudHJpZXNbaV0uZW5kT2Zmc2V0LCBuZXdHbHlmRGF0YSwgd3JpdGVPZmZzZXQsIGhpbnRzVmFsaWQpOwogICAgICAgIGNvbnN0IG5ld0xlbmd0aCA9IGdseXBoUHJvZmlsZS5sZW5ndGg7CgogICAgICAgIGlmIChuZXdMZW5ndGggPT09IDApIHsKICAgICAgICAgIG1pc3NpbmdHbHlwaHNbaV0gPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGdseXBoUHJvZmlsZS5zaXplT2ZJbnN0cnVjdGlvbnMgPiBtYXhTaXplT2ZJbnN0cnVjdGlvbnMpIHsKICAgICAgICAgIG1heFNpemVPZkluc3RydWN0aW9ucyA9IGdseXBoUHJvZmlsZS5zaXplT2ZJbnN0cnVjdGlvbnM7CiAgICAgICAgfQoKICAgICAgICB3cml0ZU9mZnNldCArPSBuZXdMZW5ndGg7CiAgICAgICAgaXRlbUVuY29kZShsb2NhRGF0YSwgaiwgd3JpdGVPZmZzZXQpOwogICAgICB9CgogICAgICBpZiAod3JpdGVPZmZzZXQgPT09IDApIHsKICAgICAgICBjb25zdCBzaW1wbGVHbHlwaCA9IG5ldyBVaW50OEFycmF5KFswLCAxLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCA0OSwgMF0pOwoKICAgICAgICBmb3IgKGkgPSAwLCBqID0gaXRlbVNpemU7IGkgPCBudW1HbHlwaHNPdXQ7IGkrKywgaiArPSBpdGVtU2l6ZSkgewogICAgICAgICAgaXRlbUVuY29kZShsb2NhRGF0YSwgaiwgc2ltcGxlR2x5cGgubGVuZ3RoKTsKICAgICAgICB9CgogICAgICAgIGdseWYuZGF0YSA9IHNpbXBsZUdseXBoOwogICAgICB9IGVsc2UgaWYgKGR1cEZpcnN0RW50cnkpIHsKICAgICAgICBjb25zdCBmaXJzdEVudHJ5TGVuZ3RoID0gaXRlbURlY29kZShsb2NhRGF0YSwgaXRlbVNpemUpOwoKICAgICAgICBpZiAobmV3R2x5ZkRhdGEubGVuZ3RoID4gZmlyc3RFbnRyeUxlbmd0aCArIHdyaXRlT2Zmc2V0KSB7CiAgICAgICAgICBnbHlmLmRhdGEgPSBuZXdHbHlmRGF0YS5zdWJhcnJheSgwLCBmaXJzdEVudHJ5TGVuZ3RoICsgd3JpdGVPZmZzZXQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBnbHlmLmRhdGEgPSBuZXcgVWludDhBcnJheShmaXJzdEVudHJ5TGVuZ3RoICsgd3JpdGVPZmZzZXQpOwogICAgICAgICAgZ2x5Zi5kYXRhLnNldChuZXdHbHlmRGF0YS5zdWJhcnJheSgwLCB3cml0ZU9mZnNldCkpOwogICAgICAgIH0KCiAgICAgICAgZ2x5Zi5kYXRhLnNldChuZXdHbHlmRGF0YS5zdWJhcnJheSgwLCBmaXJzdEVudHJ5TGVuZ3RoKSwgd3JpdGVPZmZzZXQpOwogICAgICAgIGl0ZW1FbmNvZGUobG9jYS5kYXRhLCBsb2NhRGF0YS5sZW5ndGggLSBpdGVtU2l6ZSwgd3JpdGVPZmZzZXQgKyBmaXJzdEVudHJ5TGVuZ3RoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBnbHlmLmRhdGEgPSBuZXdHbHlmRGF0YS5zdWJhcnJheSgwLCB3cml0ZU9mZnNldCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgbWlzc2luZ0dseXBocywKICAgICAgICBtYXhTaXplT2ZJbnN0cnVjdGlvbnMKICAgICAgfTsKICAgIH0KCiAgICBmdW5jdGlvbiByZWFkUG9zdFNjcmlwdFRhYmxlKHBvc3QsIHByb3BlcnRpZXNPYmosIG1heHBOdW1HbHlwaHMpIHsKICAgICAgY29uc3Qgc3RhcnQgPSAoZm9udC5zdGFydCB8fCAwKSArIHBvc3Qub2Zmc2V0OwogICAgICBmb250LnBvcyA9IHN0YXJ0OwogICAgICBjb25zdCBsZW5ndGggPSBwb3N0Lmxlbmd0aCwKICAgICAgICAgICAgZW5kID0gc3RhcnQgKyBsZW5ndGg7CiAgICAgIGNvbnN0IHZlcnNpb24gPSBmb250LmdldEludDMyKCk7CiAgICAgIGZvbnQuc2tpcCgyOCk7CiAgICAgIGxldCBnbHlwaE5hbWVzOwogICAgICBsZXQgdmFsaWQgPSB0cnVlOwogICAgICBsZXQgaTsKCiAgICAgIHN3aXRjaCAodmVyc2lvbikgewogICAgICAgIGNhc2UgMHgwMDAxMDAwMDoKICAgICAgICAgIGdseXBoTmFtZXMgPSBfZm9udHNfdXRpbHMuTWFjU3RhbmRhcmRHbHlwaE9yZGVyaW5nOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHgwMDAyMDAwMDoKICAgICAgICAgIGNvbnN0IG51bUdseXBocyA9IGZvbnQuZ2V0VWludDE2KCk7CgogICAgICAgICAgaWYgKG51bUdseXBocyAhPT0gbWF4cE51bUdseXBocykgewogICAgICAgICAgICB2YWxpZCA9IGZhbHNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBnbHlwaE5hbWVJbmRleGVzID0gW107CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IG51bUdseXBoczsgKytpKSB7CiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gZm9udC5nZXRVaW50MTYoKTsKCiAgICAgICAgICAgIGlmIChpbmRleCA+PSAzMjc2OCkgewogICAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGdseXBoTmFtZUluZGV4ZXMucHVzaChpbmRleCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCF2YWxpZCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBjdXN0b21OYW1lcyA9IFtdLAogICAgICAgICAgICAgICAgc3RyQnVmID0gW107CgogICAgICAgICAgd2hpbGUgKGZvbnQucG9zIDwgZW5kKSB7CiAgICAgICAgICAgIGNvbnN0IHN0cmluZ0xlbmd0aCA9IGZvbnQuZ2V0Qnl0ZSgpOwogICAgICAgICAgICBzdHJCdWYubGVuZ3RoID0gc3RyaW5nTGVuZ3RoOwoKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHN0cmluZ0xlbmd0aDsgKytpKSB7CiAgICAgICAgICAgICAgc3RyQnVmW2ldID0gU3RyaW5nLmZyb21DaGFyQ29kZShmb250LmdldEJ5dGUoKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGN1c3RvbU5hbWVzLnB1c2goc3RyQnVmLmpvaW4oIiIpKTsKICAgICAgICAgIH0KCiAgICAgICAgICBnbHlwaE5hbWVzID0gW107CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IG51bUdseXBoczsgKytpKSB7CiAgICAgICAgICAgIGNvbnN0IGogPSBnbHlwaE5hbWVJbmRleGVzW2ldOwoKICAgICAgICAgICAgaWYgKGogPCAyNTgpIHsKICAgICAgICAgICAgICBnbHlwaE5hbWVzLnB1c2goX2ZvbnRzX3V0aWxzLk1hY1N0YW5kYXJkR2x5cGhPcmRlcmluZ1tqXSk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGdseXBoTmFtZXMucHVzaChjdXN0b21OYW1lc1tqIC0gMjU4XSk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHgwMDAzMDAwMDoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbmtub3duL3Vuc3VwcG9ydGVkIHBvc3QgdGFibGUgdmVyc2lvbiAiICsgdmVyc2lvbik7CiAgICAgICAgICB2YWxpZCA9IGZhbHNlOwoKICAgICAgICAgIGlmIChwcm9wZXJ0aWVzT2JqLmRlZmF1bHRFbmNvZGluZykgewogICAgICAgICAgICBnbHlwaE5hbWVzID0gcHJvcGVydGllc09iai5kZWZhdWx0RW5jb2Rpbmc7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHByb3BlcnRpZXNPYmouZ2x5cGhOYW1lcyA9IGdseXBoTmFtZXM7CiAgICAgIHJldHVybiB2YWxpZDsKICAgIH0KCiAgICBmdW5jdGlvbiByZWFkTmFtZVRhYmxlKG5hbWVUYWJsZSkgewogICAgICBjb25zdCBzdGFydCA9IChmb250LnN0YXJ0IHx8IDApICsgbmFtZVRhYmxlLm9mZnNldDsKICAgICAgZm9udC5wb3MgPSBzdGFydDsKICAgICAgY29uc3QgbmFtZXMgPSBbW10sIFtdXTsKICAgICAgY29uc3QgbGVuZ3RoID0gbmFtZVRhYmxlLmxlbmd0aCwKICAgICAgICAgICAgZW5kID0gc3RhcnQgKyBsZW5ndGg7CiAgICAgIGNvbnN0IGZvcm1hdCA9IGZvbnQuZ2V0VWludDE2KCk7CiAgICAgIGNvbnN0IEZPUk1BVF8wX0hFQURFUl9MRU5HVEggPSA2OwoKICAgICAgaWYgKGZvcm1hdCAhPT0gMCB8fCBsZW5ndGggPCBGT1JNQVRfMF9IRUFERVJfTEVOR1RIKSB7CiAgICAgICAgcmV0dXJuIG5hbWVzOwogICAgICB9CgogICAgICBjb25zdCBudW1SZWNvcmRzID0gZm9udC5nZXRVaW50MTYoKTsKICAgICAgY29uc3Qgc3RyaW5nc1N0YXJ0ID0gZm9udC5nZXRVaW50MTYoKTsKICAgICAgY29uc3QgcmVjb3JkcyA9IFtdOwogICAgICBjb25zdCBOQU1FX1JFQ09SRF9MRU5HVEggPSAxMjsKICAgICAgbGV0IGksIGlpOwoKICAgICAgZm9yIChpID0gMDsgaSA8IG51bVJlY29yZHMgJiYgZm9udC5wb3MgKyBOQU1FX1JFQ09SRF9MRU5HVEggPD0gZW5kOyBpKyspIHsKICAgICAgICBjb25zdCByID0gewogICAgICAgICAgcGxhdGZvcm06IGZvbnQuZ2V0VWludDE2KCksCiAgICAgICAgICBlbmNvZGluZzogZm9udC5nZXRVaW50MTYoKSwKICAgICAgICAgIGxhbmd1YWdlOiBmb250LmdldFVpbnQxNigpLAogICAgICAgICAgbmFtZTogZm9udC5nZXRVaW50MTYoKSwKICAgICAgICAgIGxlbmd0aDogZm9udC5nZXRVaW50MTYoKSwKICAgICAgICAgIG9mZnNldDogZm9udC5nZXRVaW50MTYoKQogICAgICAgIH07CgogICAgICAgIGlmIChyLnBsYXRmb3JtID09PSAxICYmIHIuZW5jb2RpbmcgPT09IDAgJiYgci5sYW5ndWFnZSA9PT0gMCB8fCByLnBsYXRmb3JtID09PSAzICYmIHIuZW5jb2RpbmcgPT09IDEgJiYgci5sYW5ndWFnZSA9PT0gMHg0MDkpIHsKICAgICAgICAgIHJlY29yZHMucHVzaChyKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAoaSA9IDAsIGlpID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29uc3QgcmVjb3JkID0gcmVjb3Jkc1tpXTsKCiAgICAgICAgaWYgKHJlY29yZC5sZW5ndGggPD0gMCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBwb3MgPSBzdGFydCArIHN0cmluZ3NTdGFydCArIHJlY29yZC5vZmZzZXQ7CgogICAgICAgIGlmIChwb3MgKyByZWNvcmQubGVuZ3RoID4gZW5kKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGZvbnQucG9zID0gcG9zOwogICAgICAgIGNvbnN0IG5hbWVJbmRleCA9IHJlY29yZC5uYW1lOwoKICAgICAgICBpZiAocmVjb3JkLmVuY29kaW5nKSB7CiAgICAgICAgICBsZXQgc3RyID0gIiI7CgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIGpqID0gcmVjb3JkLmxlbmd0aDsgaiA8IGpqOyBqICs9IDIpIHsKICAgICAgICAgICAgc3RyICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoZm9udC5nZXRVaW50MTYoKSk7CiAgICAgICAgICB9CgogICAgICAgICAgbmFtZXNbMV1bbmFtZUluZGV4XSA9IHN0cjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbmFtZXNbMF1bbmFtZUluZGV4XSA9IGZvbnQuZ2V0U3RyaW5nKHJlY29yZC5sZW5ndGgpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG5hbWVzOwogICAgfQoKICAgIGNvbnN0IFRUT3BzU3RhY2tEZWx0YXMgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgLTIsIC0yLCAtMiwgLTIsIDAsIDAsIC0yLCAtNSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAwLCAwLCAtMSwgMCwgLTEsIC0xLCAtMSwgLTEsIDEsIC0xLCAtOTk5LCAwLCAxLCAwLCAtMSwgLTIsIDAsIC0xLCAtMiwgLTEsIC0xLCAwLCAtMSwgLTEsIDAsIDAsIC05OTksIC05OTksIC0xLCAtMSwgLTEsIC0xLCAtMiwgLTk5OSwgLTIsIC0yLCAtOTk5LCAwLCAtMiwgLTIsIDAsIDAsIC0yLCAwLCAtMiwgMCwgMCwgMCwgLTIsIC0xLCAtMSwgMSwgMSwgMCwgMCwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIDAsIDAsIC0xLCAwLCAtMSwgLTEsIDAsIC05OTksIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIC0yLCAtOTk5LCAtOTk5LCAtOTk5LCAtOTk5LCAtOTk5LCAtMSwgLTEsIC0yLCAtMiwgMCwgMCwgMCwgMCwgLTEsIC0xLCAtOTk5LCAtMiwgLTIsIDAsIDAsIC0xLCAtMiwgLTIsIDAsIDAsIDAsIC0xLCAtMSwgLTEsIC0yXTsKCiAgICBmdW5jdGlvbiBzYW5pdGl6ZVRUUHJvZ3JhbSh0YWJsZSwgdHRDb250ZXh0KSB7CiAgICAgIGxldCBkYXRhID0gdGFibGUuZGF0YTsKICAgICAgbGV0IGkgPSAwLAogICAgICAgICAgaiwKICAgICAgICAgIG4sCiAgICAgICAgICBiLAogICAgICAgICAgZnVuY0lkLAogICAgICAgICAgcGMsCiAgICAgICAgICBsYXN0RW5kZiA9IDAsCiAgICAgICAgICBsYXN0RGVmZiA9IDA7CiAgICAgIGNvbnN0IHN0YWNrID0gW107CiAgICAgIGNvbnN0IGNhbGxzdGFjayA9IFtdOwogICAgICBjb25zdCBmdW5jdGlvbnNDYWxsZWQgPSBbXTsKICAgICAgbGV0IHRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9ucyA9IHR0Q29udGV4dC50b29Db21wbGV4VG9Gb2xsb3dGdW5jdGlvbnM7CiAgICAgIGxldCBpbkZERUYgPSBmYWxzZSwKICAgICAgICAgIGlmTGV2ZWwgPSAwLAogICAgICAgICAgaW5FTFNFID0gMDsKCiAgICAgIGZvciAobGV0IGlpID0gZGF0YS5sZW5ndGg7IGkgPCBpaTspIHsKICAgICAgICBjb25zdCBvcCA9IGRhdGFbaSsrXTsKCiAgICAgICAgaWYgKG9wID09PSAweDQwKSB7CiAgICAgICAgICBuID0gZGF0YVtpKytdOwoKICAgICAgICAgIGlmIChpbkZERUYgfHwgaW5FTFNFKSB7CiAgICAgICAgICAgIGkgKz0gbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBuOyBqKyspIHsKICAgICAgICAgICAgICBzdGFjay5wdXNoKGRhdGFbaSsrXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKG9wID09PSAweDQxKSB7CiAgICAgICAgICBuID0gZGF0YVtpKytdOwoKICAgICAgICAgIGlmIChpbkZERUYgfHwgaW5FTFNFKSB7CiAgICAgICAgICAgIGkgKz0gbiAqIDI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbjsgaisrKSB7CiAgICAgICAgICAgICAgYiA9IGRhdGFbaSsrXTsKICAgICAgICAgICAgICBzdGFjay5wdXNoKGIgPDwgOCB8IGRhdGFbaSsrXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKChvcCAmIDB4ZjgpID09PSAweGIwKSB7CiAgICAgICAgICBuID0gb3AgLSAweGIwICsgMTsKCiAgICAgICAgICBpZiAoaW5GREVGIHx8IGluRUxTRSkgewogICAgICAgICAgICBpICs9IG47CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbjsgaisrKSB7CiAgICAgICAgICAgICAgc3RhY2sucHVzaChkYXRhW2krK10pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICgob3AgJiAweGY4KSA9PT0gMHhiOCkgewogICAgICAgICAgbiA9IG9wIC0gMHhiOCArIDE7CgogICAgICAgICAgaWYgKGluRkRFRiB8fCBpbkVMU0UpIHsKICAgICAgICAgICAgaSArPSBuICogMjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBuOyBqKyspIHsKICAgICAgICAgICAgICBiID0gZGF0YVtpKytdOwogICAgICAgICAgICAgIHN0YWNrLnB1c2goYiA8PCA4IHwgZGF0YVtpKytdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAob3AgPT09IDB4MmIgJiYgIXRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9ucykgewogICAgICAgICAgaWYgKCFpbkZERUYgJiYgIWluRUxTRSkgewogICAgICAgICAgICBmdW5jSWQgPSBzdGFjay5hdCgtMSk7CgogICAgICAgICAgICBpZiAoaXNOYU4oZnVuY0lkKSkgewogICAgICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiVFQ6IENBTEwgZW1wdHkgc3RhY2sgKG9yIGludmFsaWQgZW50cnkpLiIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHR0Q29udGV4dC5mdW5jdGlvbnNVc2VkW2Z1bmNJZF0gPSB0cnVlOwoKICAgICAgICAgICAgICBpZiAoZnVuY0lkIGluIHR0Q29udGV4dC5mdW5jdGlvbnNTdGFja0RlbHRhcykgewogICAgICAgICAgICAgICAgY29uc3QgbmV3U3RhY2tMZW5ndGggPSBzdGFjay5sZW5ndGggKyB0dENvbnRleHQuZnVuY3Rpb25zU3RhY2tEZWx0YXNbZnVuY0lkXTsKCiAgICAgICAgICAgICAgICBpZiAobmV3U3RhY2tMZW5ndGggPCAwKSB7CiAgICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IENBTEwgaW52YWxpZCBmdW5jdGlvbnMgc3RhY2sgZGVsdGEuIik7CiAgICAgICAgICAgICAgICAgIHR0Q29udGV4dC5oaW50c1ZhbGlkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBzdGFjay5sZW5ndGggPSBuZXdTdGFja0xlbmd0aDsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZ1bmNJZCBpbiB0dENvbnRleHQuZnVuY3Rpb25zRGVmaW5lZCAmJiAhZnVuY3Rpb25zQ2FsbGVkLmluY2x1ZGVzKGZ1bmNJZCkpIHsKICAgICAgICAgICAgICAgIGNhbGxzdGFjay5wdXNoKHsKICAgICAgICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgICAgc3RhY2tUb3A6IHN0YWNrLmxlbmd0aCAtIDEKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgZnVuY3Rpb25zQ2FsbGVkLnB1c2goZnVuY0lkKTsKICAgICAgICAgICAgICAgIHBjID0gdHRDb250ZXh0LmZ1bmN0aW9uc0RlZmluZWRbZnVuY0lkXTsKCiAgICAgICAgICAgICAgICBpZiAoIXBjKSB7CiAgICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IENBTEwgbm9uLWV4aXN0ZW50IGZ1bmN0aW9uIik7CiAgICAgICAgICAgICAgICAgIHR0Q29udGV4dC5oaW50c1ZhbGlkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBkYXRhID0gcGMuZGF0YTsKICAgICAgICAgICAgICAgIGkgPSBwYy5pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAob3AgPT09IDB4MmMgJiYgIXRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9ucykgewogICAgICAgICAgaWYgKGluRkRFRiB8fCBpbkVMU0UpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUVDogbmVzdGVkIEZERUZzIG5vdCBhbGxvd2VkIik7CiAgICAgICAgICAgIHRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9ucyA9IHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgaW5GREVGID0gdHJ1ZTsKICAgICAgICAgIGxhc3REZWZmID0gaTsKICAgICAgICAgIGZ1bmNJZCA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgdHRDb250ZXh0LmZ1bmN0aW9uc0RlZmluZWRbZnVuY0lkXSA9IHsKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaQogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgaWYgKG9wID09PSAweDJkKSB7CiAgICAgICAgICBpZiAoaW5GREVGKSB7CiAgICAgICAgICAgIGluRkRFRiA9IGZhbHNlOwogICAgICAgICAgICBsYXN0RW5kZiA9IGk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwYyA9IGNhbGxzdGFjay5wb3AoKTsKCiAgICAgICAgICAgIGlmICghcGMpIHsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlRUOiBFTkRGIGJhZCBzdGFjayIpOwogICAgICAgICAgICAgIHR0Q29udGV4dC5oaW50c1ZhbGlkID0gZmFsc2U7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jSWQgPSBmdW5jdGlvbnNDYWxsZWQucG9wKCk7CiAgICAgICAgICAgIGRhdGEgPSBwYy5kYXRhOwogICAgICAgICAgICBpID0gcGMuaTsKICAgICAgICAgICAgdHRDb250ZXh0LmZ1bmN0aW9uc1N0YWNrRGVsdGFzW2Z1bmNJZF0gPSBzdGFjay5sZW5ndGggLSBwYy5zdGFja1RvcDsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKG9wID09PSAweDg5KSB7CiAgICAgICAgICBpZiAoaW5GREVGIHx8IGluRUxTRSkgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlRUOiBuZXN0ZWQgSURFRnMgbm90IGFsbG93ZWQiKTsKICAgICAgICAgICAgdG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zID0gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpbkZERUYgPSB0cnVlOwogICAgICAgICAgbGFzdERlZmYgPSBpOwogICAgICAgIH0gZWxzZSBpZiAob3AgPT09IDB4NTgpIHsKICAgICAgICAgICsraWZMZXZlbDsKICAgICAgICB9IGVsc2UgaWYgKG9wID09PSAweDFiKSB7CiAgICAgICAgICBpbkVMU0UgPSBpZkxldmVsOwogICAgICAgIH0gZWxzZSBpZiAob3AgPT09IDB4NTkpIHsKICAgICAgICAgIGlmIChpbkVMU0UgPT09IGlmTGV2ZWwpIHsKICAgICAgICAgICAgaW5FTFNFID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICAtLWlmTGV2ZWw7CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHgxYykgewogICAgICAgICAgaWYgKCFpbkZERUYgJiYgIWluRUxTRSkgewogICAgICAgICAgICBjb25zdCBvZmZzZXQgPSBzdGFjay5hdCgtMSk7CgogICAgICAgICAgICBpZiAob2Zmc2V0ID4gMCkgewogICAgICAgICAgICAgIGkgKz0gb2Zmc2V0IC0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFpbkZERUYgJiYgIWluRUxTRSkgewogICAgICAgICAgbGV0IHN0YWNrRGVsdGEgPSAwOwoKICAgICAgICAgIGlmIChvcCA8PSAweDhlKSB7CiAgICAgICAgICAgIHN0YWNrRGVsdGEgPSBUVE9wc1N0YWNrRGVsdGFzW29wXTsKICAgICAgICAgIH0gZWxzZSBpZiAob3AgPj0gMHhjMCAmJiBvcCA8PSAweGRmKSB7CiAgICAgICAgICAgIHN0YWNrRGVsdGEgPSAtMTsKICAgICAgICAgIH0gZWxzZSBpZiAob3AgPj0gMHhlMCkgewogICAgICAgICAgICBzdGFja0RlbHRhID0gLTI7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG9wID49IDB4NzEgJiYgb3AgPD0gMHg3NSkgewogICAgICAgICAgICBuID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgICBpZiAoIWlzTmFOKG4pKSB7CiAgICAgICAgICAgICAgc3RhY2tEZWx0YSA9IC1uICogMjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHdoaWxlIChzdGFja0RlbHRhIDwgMCAmJiBzdGFjay5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgICAgICBzdGFja0RlbHRhKys7CiAgICAgICAgICB9CgogICAgICAgICAgd2hpbGUgKHN0YWNrRGVsdGEgPiAwKSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2goTmFOKTsKICAgICAgICAgICAgc3RhY2tEZWx0YS0tOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdHRDb250ZXh0LnRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9ucyA9IHRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9uczsKICAgICAgY29uc3QgY29udGVudCA9IFtkYXRhXTsKCiAgICAgIGlmIChpID4gZGF0YS5sZW5ndGgpIHsKICAgICAgICBjb250ZW50LnB1c2gobmV3IFVpbnQ4QXJyYXkoaSAtIGRhdGEubGVuZ3RoKSk7CiAgICAgIH0KCiAgICAgIGlmIChsYXN0RGVmZiA+IGxhc3RFbmRmKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUVDogY29tcGxlbWVudGluZyBhIG1pc3NpbmcgZnVuY3Rpb24gdGFpbCIpOwogICAgICAgIGNvbnRlbnQucHVzaChuZXcgVWludDhBcnJheShbMHgyMiwgMHgyZF0pKTsKICAgICAgfQoKICAgICAgZm9sZFRUVGFibGUodGFibGUsIGNvbnRlbnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoZWNrSW52YWxpZEZ1bmN0aW9ucyh0dENvbnRleHQsIG1heEZ1bmN0aW9uRGVmcykgewogICAgICBpZiAodHRDb250ZXh0LnRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9ucykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHR0Q29udGV4dC5mdW5jdGlvbnNEZWZpbmVkLmxlbmd0aCA+IG1heEZ1bmN0aW9uRGVmcykgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IG1vcmUgZnVuY3Rpb25zIGRlZmluZWQgdGhhbiBleHBlY3RlZCIpOwogICAgICAgIHR0Q29udGV4dC5oaW50c1ZhbGlkID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBmb3IgKGxldCBqID0gMCwgamogPSB0dENvbnRleHQuZnVuY3Rpb25zVXNlZC5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgaWYgKGogPiBtYXhGdW5jdGlvbkRlZnMpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IGludmFsaWQgZnVuY3Rpb24gaWQ6ICIgKyBqKTsKICAgICAgICAgIHR0Q29udGV4dC5oaW50c1ZhbGlkID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodHRDb250ZXh0LmZ1bmN0aW9uc1VzZWRbal0gJiYgIXR0Q29udGV4dC5mdW5jdGlvbnNEZWZpbmVkW2pdKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlRUOiB1bmRlZmluZWQgZnVuY3Rpb246ICIgKyBqKTsKICAgICAgICAgIHR0Q29udGV4dC5oaW50c1ZhbGlkID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZm9sZFRUVGFibGUodGFibGUsIGNvbnRlbnQpIHsKICAgICAgaWYgKGNvbnRlbnQubGVuZ3RoID4gMSkgewogICAgICAgIGxldCBuZXdMZW5ndGggPSAwOwogICAgICAgIGxldCBqLCBqajsKCiAgICAgICAgZm9yIChqID0gMCwgamogPSBjb250ZW50Lmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICAgIG5ld0xlbmd0aCArPSBjb250ZW50W2pdLmxlbmd0aDsKICAgICAgICB9CgogICAgICAgIG5ld0xlbmd0aCA9IG5ld0xlbmd0aCArIDMgJiB+MzsKICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDhBcnJheShuZXdMZW5ndGgpOwogICAgICAgIGxldCBwb3MgPSAwOwoKICAgICAgICBmb3IgKGogPSAwLCBqaiA9IGNvbnRlbnQubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgICAgcmVzdWx0LnNldChjb250ZW50W2pdLCBwb3MpOwogICAgICAgICAgcG9zICs9IGNvbnRlbnRbal0ubGVuZ3RoOwogICAgICAgIH0KCiAgICAgICAgdGFibGUuZGF0YSA9IHJlc3VsdDsKICAgICAgICB0YWJsZS5sZW5ndGggPSBuZXdMZW5ndGg7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzYW5pdGl6ZVRUUHJvZ3JhbXMoZnBnbSwgcHJlcCwgY3Z0LCBtYXhGdW5jdGlvbkRlZnMpIHsKICAgICAgY29uc3QgdHRDb250ZXh0ID0gewogICAgICAgIGZ1bmN0aW9uc0RlZmluZWQ6IFtdLAogICAgICAgIGZ1bmN0aW9uc1VzZWQ6IFtdLAogICAgICAgIGZ1bmN0aW9uc1N0YWNrRGVsdGFzOiBbXSwKICAgICAgICB0b29Db21wbGV4VG9Gb2xsb3dGdW5jdGlvbnM6IGZhbHNlLAogICAgICAgIGhpbnRzVmFsaWQ6IHRydWUKICAgICAgfTsKCiAgICAgIGlmIChmcGdtKSB7CiAgICAgICAgc2FuaXRpemVUVFByb2dyYW0oZnBnbSwgdHRDb250ZXh0KTsKICAgICAgfQoKICAgICAgaWYgKHByZXApIHsKICAgICAgICBzYW5pdGl6ZVRUUHJvZ3JhbShwcmVwLCB0dENvbnRleHQpOwogICAgICB9CgogICAgICBpZiAoZnBnbSkgewogICAgICAgIGNoZWNrSW52YWxpZEZ1bmN0aW9ucyh0dENvbnRleHQsIG1heEZ1bmN0aW9uRGVmcyk7CiAgICAgIH0KCiAgICAgIGlmIChjdnQgJiYgY3Z0Lmxlbmd0aCAmIDEpIHsKICAgICAgICBjb25zdCBjdnREYXRhID0gbmV3IFVpbnQ4QXJyYXkoY3Z0Lmxlbmd0aCArIDEpOwogICAgICAgIGN2dERhdGEuc2V0KGN2dC5kYXRhKTsKICAgICAgICBjdnQuZGF0YSA9IGN2dERhdGE7CiAgICAgIH0KCiAgICAgIHJldHVybiB0dENvbnRleHQuaGludHNWYWxpZDsKICAgIH0KCiAgICBmb250ID0gbmV3IF9zdHJlYW0uU3RyZWFtKG5ldyBVaW50OEFycmF5KGZvbnQuZ2V0Qnl0ZXMoKSkpOwogICAgbGV0IGhlYWRlciwgdGFibGVzOwoKICAgIGlmIChpc1RydWVUeXBlQ29sbGVjdGlvbkZpbGUoZm9udCkpIHsKICAgICAgY29uc3QgdHRjRGF0YSA9IHJlYWRUcnVlVHlwZUNvbGxlY3Rpb25EYXRhKGZvbnQsIHRoaXMubmFtZSk7CiAgICAgIGhlYWRlciA9IHR0Y0RhdGEuaGVhZGVyOwogICAgICB0YWJsZXMgPSB0dGNEYXRhLnRhYmxlczsKICAgIH0gZWxzZSB7CiAgICAgIGhlYWRlciA9IHJlYWRPcGVuVHlwZUhlYWRlcihmb250KTsKICAgICAgdGFibGVzID0gcmVhZFRhYmxlcyhmb250LCBoZWFkZXIubnVtVGFibGVzKTsKICAgIH0KCiAgICBsZXQgY2ZmLCBjZmZGaWxlOwogICAgY29uc3QgaXNUcnVlVHlwZSA9ICF0YWJsZXNbIkNGRiAiXTsKCiAgICBpZiAoIWlzVHJ1ZVR5cGUpIHsKICAgICAgY29uc3QgaXNDb21wb3NpdGUgPSBwcm9wZXJ0aWVzLmNvbXBvc2l0ZSAmJiAoKHByb3BlcnRpZXMuY2lkVG9HaWRNYXAgfHwgW10pLmxlbmd0aCA+IDAgfHwgIShwcm9wZXJ0aWVzLmNNYXAgaW5zdGFuY2VvZiBfY21hcC5JZGVudGl0eUNNYXApKTsKCiAgICAgIGlmIChoZWFkZXIudmVyc2lvbiA9PT0gIk9UVE8iICYmICFpc0NvbXBvc2l0ZSB8fCAhdGFibGVzLmhlYWQgfHwgIXRhYmxlcy5oaGVhIHx8ICF0YWJsZXMubWF4cCB8fCAhdGFibGVzLnBvc3QpIHsKICAgICAgICBjZmZGaWxlID0gbmV3IF9zdHJlYW0uU3RyZWFtKHRhYmxlc1siQ0ZGICJdLmRhdGEpOwogICAgICAgIGNmZiA9IG5ldyBfY2ZmX2ZvbnQuQ0ZGRm9udChjZmZGaWxlLCBwcm9wZXJ0aWVzKTsKICAgICAgICBhZGp1c3RXaWR0aHMocHJvcGVydGllcyk7CiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydChuYW1lLCBjZmYsIHByb3BlcnRpZXMpOwogICAgICB9CgogICAgICBkZWxldGUgdGFibGVzLmdseWY7CiAgICAgIGRlbGV0ZSB0YWJsZXMubG9jYTsKICAgICAgZGVsZXRlIHRhYmxlcy5mcGdtOwogICAgICBkZWxldGUgdGFibGVzLnByZXA7CiAgICAgIGRlbGV0ZSB0YWJsZXNbImN2dCAiXTsKICAgICAgdGhpcy5pc09wZW5UeXBlID0gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIGlmICghdGFibGVzLmxvY2EpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoJ1JlcXVpcmVkICJsb2NhIiB0YWJsZSBpcyBub3QgZm91bmQnKTsKICAgICAgfQoKICAgICAgaWYgKCF0YWJsZXMuZ2x5ZikgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgnUmVxdWlyZWQgImdseWYiIHRhYmxlIGlzIG5vdCBmb3VuZCAtLSB0cnlpbmcgdG8gcmVjb3Zlci4nKTsKICAgICAgICB0YWJsZXMuZ2x5ZiA9IHsKICAgICAgICAgIHRhZzogImdseWYiLAogICAgICAgICAgZGF0YTogbmV3IFVpbnQ4QXJyYXkoMCkKICAgICAgICB9OwogICAgICB9CgogICAgICB0aGlzLmlzT3BlblR5cGUgPSBmYWxzZTsKICAgIH0KCiAgICBpZiAoIXRhYmxlcy5tYXhwKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcignUmVxdWlyZWQgIm1heHAiIHRhYmxlIGlzIG5vdCBmb3VuZCcpOwogICAgfQoKICAgIGZvbnQucG9zID0gKGZvbnQuc3RhcnQgfHwgMCkgKyB0YWJsZXMubWF4cC5vZmZzZXQ7CiAgICBjb25zdCB2ZXJzaW9uID0gZm9udC5nZXRJbnQzMigpOwogICAgY29uc3QgbnVtR2x5cGhzID0gZm9udC5nZXRVaW50MTYoKTsKCiAgICBpZiAocHJvcGVydGllcy5zY2FsZUZhY3RvcnMgJiYgcHJvcGVydGllcy5zY2FsZUZhY3RvcnMubGVuZ3RoID09PSBudW1HbHlwaHMgJiYgaXNUcnVlVHlwZSkgewogICAgICBjb25zdCB7CiAgICAgICAgc2NhbGVGYWN0b3JzCiAgICAgIH0gPSBwcm9wZXJ0aWVzOwogICAgICBjb25zdCBpc0dseXBoTG9jYXRpb25zTG9uZyA9IGludDE2KHRhYmxlcy5oZWFkLmRhdGFbNTBdLCB0YWJsZXMuaGVhZC5kYXRhWzUxXSk7CiAgICAgIGNvbnN0IGdseXBocyA9IG5ldyBfZ2x5Zi5HbHlmVGFibGUoewogICAgICAgIGdseWZUYWJsZTogdGFibGVzLmdseWYuZGF0YSwKICAgICAgICBpc0dseXBoTG9jYXRpb25zTG9uZywKICAgICAgICBsb2NhVGFibGU6IHRhYmxlcy5sb2NhLmRhdGEsCiAgICAgICAgbnVtR2x5cGhzCiAgICAgIH0pOwogICAgICBnbHlwaHMuc2NhbGUoc2NhbGVGYWN0b3JzKTsKICAgICAgY29uc3QgewogICAgICAgIGdseWYsCiAgICAgICAgbG9jYSwKICAgICAgICBpc0xvY2F0aW9uTG9uZwogICAgICB9ID0gZ2x5cGhzLndyaXRlKCk7CiAgICAgIHRhYmxlcy5nbHlmLmRhdGEgPSBnbHlmOwogICAgICB0YWJsZXMubG9jYS5kYXRhID0gbG9jYTsKCiAgICAgIGlmIChpc0xvY2F0aW9uTG9uZyAhPT0gISFpc0dseXBoTG9jYXRpb25zTG9uZykgewogICAgICAgIHRhYmxlcy5oZWFkLmRhdGFbNTBdID0gMDsKICAgICAgICB0YWJsZXMuaGVhZC5kYXRhWzUxXSA9IGlzTG9jYXRpb25Mb25nID8gMSA6IDA7CiAgICAgIH0KCiAgICAgIGNvbnN0IG1ldHJpY3MgPSB0YWJsZXMuaG10eC5kYXRhOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1HbHlwaHM7IGkrKykgewogICAgICAgIGNvbnN0IGogPSA0ICogaTsKICAgICAgICBjb25zdCBhZHZhbmNlV2lkdGggPSBNYXRoLnJvdW5kKHNjYWxlRmFjdG9yc1tpXSAqIGludDE2KG1ldHJpY3Nbal0sIG1ldHJpY3NbaiArIDFdKSk7CiAgICAgICAgbWV0cmljc1tqXSA9IGFkdmFuY2VXaWR0aCA+PiA4ICYgMHhmZjsKICAgICAgICBtZXRyaWNzW2ogKyAxXSA9IGFkdmFuY2VXaWR0aCAmIDB4ZmY7CiAgICAgICAgY29uc3QgbHNiID0gTWF0aC5yb3VuZChzY2FsZUZhY3RvcnNbaV0gKiBzaWduZWRJbnQxNihtZXRyaWNzW2ogKyAyXSwgbWV0cmljc1tqICsgM10pKTsKICAgICAgICB3cml0ZVNpZ25lZEludDE2KG1ldHJpY3MsIGogKyAyLCBsc2IpOwogICAgICB9CiAgICB9CgogICAgbGV0IG51bUdseXBoc091dCA9IG51bUdseXBocyArIDE7CiAgICBsZXQgZHVwRmlyc3RFbnRyeSA9IHRydWU7CgogICAgaWYgKG51bUdseXBoc091dCA+IDB4ZmZmZikgewogICAgICBkdXBGaXJzdEVudHJ5ID0gZmFsc2U7CiAgICAgIG51bUdseXBoc091dCA9IG51bUdseXBoczsKICAgICAgKDAsIF91dGlsLndhcm4pKCJOb3QgZW5vdWdoIHNwYWNlIGluIGdseWZzIHRvIGR1cGxpY2F0ZSBmaXJzdCBnbHlwaC4iKTsKICAgIH0KCiAgICBsZXQgbWF4RnVuY3Rpb25EZWZzID0gMDsKICAgIGxldCBtYXhTaXplT2ZJbnN0cnVjdGlvbnMgPSAwOwoKICAgIGlmICh2ZXJzaW9uID49IDB4MDAwMTAwMDAgJiYgdGFibGVzLm1heHAubGVuZ3RoID49IDIyKSB7CiAgICAgIGZvbnQucG9zICs9IDg7CiAgICAgIGNvbnN0IG1heFpvbmVzID0gZm9udC5nZXRVaW50MTYoKTsKCiAgICAgIGlmIChtYXhab25lcyA+IDIpIHsKICAgICAgICB0YWJsZXMubWF4cC5kYXRhWzE0XSA9IDA7CiAgICAgICAgdGFibGVzLm1heHAuZGF0YVsxNV0gPSAyOwogICAgICB9CgogICAgICBmb250LnBvcyArPSA0OwogICAgICBtYXhGdW5jdGlvbkRlZnMgPSBmb250LmdldFVpbnQxNigpOwogICAgICBmb250LnBvcyArPSA0OwogICAgICBtYXhTaXplT2ZJbnN0cnVjdGlvbnMgPSBmb250LmdldFVpbnQxNigpOwogICAgfQoKICAgIHRhYmxlcy5tYXhwLmRhdGFbNF0gPSBudW1HbHlwaHNPdXQgPj4gODsKICAgIHRhYmxlcy5tYXhwLmRhdGFbNV0gPSBudW1HbHlwaHNPdXQgJiAyNTU7CiAgICBjb25zdCBoaW50c1ZhbGlkID0gc2FuaXRpemVUVFByb2dyYW1zKHRhYmxlcy5mcGdtLCB0YWJsZXMucHJlcCwgdGFibGVzWyJjdnQgIl0sIG1heEZ1bmN0aW9uRGVmcyk7CgogICAgaWYgKCFoaW50c1ZhbGlkKSB7CiAgICAgIGRlbGV0ZSB0YWJsZXMuZnBnbTsKICAgICAgZGVsZXRlIHRhYmxlcy5wcmVwOwogICAgICBkZWxldGUgdGFibGVzWyJjdnQgIl07CiAgICB9CgogICAgc2FuaXRpemVNZXRyaWNzKGZvbnQsIHRhYmxlcy5oaGVhLCB0YWJsZXMuaG10eCwgdGFibGVzLmhlYWQsIG51bUdseXBoc091dCwgZHVwRmlyc3RFbnRyeSk7CgogICAgaWYgKCF0YWJsZXMuaGVhZCkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoJ1JlcXVpcmVkICJoZWFkIiB0YWJsZSBpcyBub3QgZm91bmQnKTsKICAgIH0KCiAgICBzYW5pdGl6ZUhlYWQodGFibGVzLmhlYWQsIG51bUdseXBocywgaXNUcnVlVHlwZSA/IHRhYmxlcy5sb2NhLmxlbmd0aCA6IDApOwogICAgbGV0IG1pc3NpbmdHbHlwaHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGlmIChpc1RydWVUeXBlKSB7CiAgICAgIGNvbnN0IGlzR2x5cGhMb2NhdGlvbnNMb25nID0gaW50MTYodGFibGVzLmhlYWQuZGF0YVs1MF0sIHRhYmxlcy5oZWFkLmRhdGFbNTFdKTsKICAgICAgY29uc3QgZ2x5cGhzSW5mbyA9IHNhbml0aXplR2x5cGhMb2NhdGlvbnModGFibGVzLmxvY2EsIHRhYmxlcy5nbHlmLCBudW1HbHlwaHMsIGlzR2x5cGhMb2NhdGlvbnNMb25nLCBoaW50c1ZhbGlkLCBkdXBGaXJzdEVudHJ5LCBtYXhTaXplT2ZJbnN0cnVjdGlvbnMpOwogICAgICBtaXNzaW5nR2x5cGhzID0gZ2x5cGhzSW5mby5taXNzaW5nR2x5cGhzOwoKICAgICAgaWYgKHZlcnNpb24gPj0gMHgwMDAxMDAwMCAmJiB0YWJsZXMubWF4cC5sZW5ndGggPj0gMjIpIHsKICAgICAgICB0YWJsZXMubWF4cC5kYXRhWzI2XSA9IGdseXBoc0luZm8ubWF4U2l6ZU9mSW5zdHJ1Y3Rpb25zID4+IDg7CiAgICAgICAgdGFibGVzLm1heHAuZGF0YVsyN10gPSBnbHlwaHNJbmZvLm1heFNpemVPZkluc3RydWN0aW9ucyAmIDI1NTsKICAgICAgfQogICAgfQoKICAgIGlmICghdGFibGVzLmhoZWEpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCdSZXF1aXJlZCAiaGhlYSIgdGFibGUgaXMgbm90IGZvdW5kJyk7CiAgICB9CgogICAgaWYgKHRhYmxlcy5oaGVhLmRhdGFbMTBdID09PSAwICYmIHRhYmxlcy5oaGVhLmRhdGFbMTFdID09PSAwKSB7CiAgICAgIHRhYmxlcy5oaGVhLmRhdGFbMTBdID0gMHhmZjsKICAgICAgdGFibGVzLmhoZWEuZGF0YVsxMV0gPSAweGZmOwogICAgfQoKICAgIGNvbnN0IG1ldHJpY3NPdmVycmlkZSA9IHsKICAgICAgdW5pdHNQZXJFbTogaW50MTYodGFibGVzLmhlYWQuZGF0YVsxOF0sIHRhYmxlcy5oZWFkLmRhdGFbMTldKSwKICAgICAgeU1heDogaW50MTYodGFibGVzLmhlYWQuZGF0YVs0Ml0sIHRhYmxlcy5oZWFkLmRhdGFbNDNdKSwKICAgICAgeU1pbjogc2lnbmVkSW50MTYodGFibGVzLmhlYWQuZGF0YVszOF0sIHRhYmxlcy5oZWFkLmRhdGFbMzldKSwKICAgICAgYXNjZW50OiBzaWduZWRJbnQxNih0YWJsZXMuaGhlYS5kYXRhWzRdLCB0YWJsZXMuaGhlYS5kYXRhWzVdKSwKICAgICAgZGVzY2VudDogc2lnbmVkSW50MTYodGFibGVzLmhoZWEuZGF0YVs2XSwgdGFibGVzLmhoZWEuZGF0YVs3XSksCiAgICAgIGxpbmVHYXA6IHNpZ25lZEludDE2KHRhYmxlcy5oaGVhLmRhdGFbOF0sIHRhYmxlcy5oaGVhLmRhdGFbOV0pCiAgICB9OwogICAgdGhpcy5hc2NlbnQgPSBtZXRyaWNzT3ZlcnJpZGUuYXNjZW50IC8gbWV0cmljc092ZXJyaWRlLnVuaXRzUGVyRW07CiAgICB0aGlzLmRlc2NlbnQgPSBtZXRyaWNzT3ZlcnJpZGUuZGVzY2VudCAvIG1ldHJpY3NPdmVycmlkZS51bml0c1BlckVtOwogICAgdGhpcy5saW5lR2FwID0gbWV0cmljc092ZXJyaWRlLmxpbmVHYXAgLyBtZXRyaWNzT3ZlcnJpZGUudW5pdHNQZXJFbTsKCiAgICBpZiAodGhpcy5jc3NGb250SW5mbyAmJiB0aGlzLmNzc0ZvbnRJbmZvLmxpbmVIZWlnaHQpIHsKICAgICAgdGhpcy5saW5lSGVpZ2h0ID0gdGhpcy5jc3NGb250SW5mby5tZXRyaWNzLmxpbmVIZWlnaHQ7CiAgICAgIHRoaXMubGluZUdhcCA9IHRoaXMuY3NzRm9udEluZm8ubWV0cmljcy5saW5lR2FwOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5saW5lSGVpZ2h0ID0gdGhpcy5hc2NlbnQgLSB0aGlzLmRlc2NlbnQgKyB0aGlzLmxpbmVHYXA7CiAgICB9CgogICAgaWYgKHRhYmxlcy5wb3N0KSB7CiAgICAgIHJlYWRQb3N0U2NyaXB0VGFibGUodGFibGVzLnBvc3QsIHByb3BlcnRpZXMsIG51bUdseXBocyk7CiAgICB9CgogICAgdGFibGVzLnBvc3QgPSB7CiAgICAgIHRhZzogInBvc3QiLAogICAgICBkYXRhOiBjcmVhdGVQb3N0VGFibGUocHJvcGVydGllcykKICAgIH07CiAgICBjb25zdCBjaGFyQ29kZVRvR2x5cGhJZCA9IFtdOwoKICAgIGZ1bmN0aW9uIGhhc0dseXBoKGdseXBoSWQpIHsKICAgICAgcmV0dXJuICFtaXNzaW5nR2x5cGhzW2dseXBoSWRdOwogICAgfQoKICAgIGlmIChwcm9wZXJ0aWVzLmNvbXBvc2l0ZSkgewogICAgICBjb25zdCBjaWRUb0dpZE1hcCA9IHByb3BlcnRpZXMuY2lkVG9HaWRNYXAgfHwgW107CiAgICAgIGNvbnN0IGlzQ2lkVG9HaWRNYXBFbXB0eSA9IGNpZFRvR2lkTWFwLmxlbmd0aCA9PT0gMDsKICAgICAgcHJvcGVydGllcy5jTWFwLmZvckVhY2goZnVuY3Rpb24gKGNoYXJDb2RlLCBjaWQpIHsKICAgICAgICBpZiAodHlwZW9mIGNpZCA9PT0gInN0cmluZyIpIHsKICAgICAgICAgIGNpZCA9IGNvbnZlcnRDaWRTdHJpbmcoY2hhckNvZGUsIGNpZCwgdHJ1ZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoY2lkID4gMHhmZmZmKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk1heCBzaXplIG9mIENJRCBpcyA2NSw1MzUiKTsKICAgICAgICB9CgogICAgICAgIGxldCBnbHlwaElkID0gLTE7CgogICAgICAgIGlmIChpc0NpZFRvR2lkTWFwRW1wdHkpIHsKICAgICAgICAgIGdseXBoSWQgPSBjaWQ7CiAgICAgICAgfSBlbHNlIGlmIChjaWRUb0dpZE1hcFtjaWRdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGdseXBoSWQgPSBjaWRUb0dpZE1hcFtjaWRdOwogICAgICAgIH0KCiAgICAgICAgaWYgKGdseXBoSWQgPj0gMCAmJiBnbHlwaElkIDwgbnVtR2x5cGhzICYmIGhhc0dseXBoKGdseXBoSWQpKSB7CiAgICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSBnbHlwaElkOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBjbWFwVGFibGUgPSByZWFkQ21hcFRhYmxlKHRhYmxlcy5jbWFwLCBmb250LCB0aGlzLmlzU3ltYm9saWNGb250LCBwcm9wZXJ0aWVzLmhhc0VuY29kaW5nKTsKICAgICAgY29uc3QgY21hcFBsYXRmb3JtSWQgPSBjbWFwVGFibGUucGxhdGZvcm1JZDsKICAgICAgY29uc3QgY21hcEVuY29kaW5nSWQgPSBjbWFwVGFibGUuZW5jb2RpbmdJZDsKICAgICAgY29uc3QgY21hcE1hcHBpbmdzID0gY21hcFRhYmxlLm1hcHBpbmdzOwogICAgICBjb25zdCBjbWFwTWFwcGluZ3NMZW5ndGggPSBjbWFwTWFwcGluZ3MubGVuZ3RoOwogICAgICBsZXQgYmFzZUVuY29kaW5nID0gW10sCiAgICAgICAgICBmb3JjZVBvc3RUYWJsZSA9IGZhbHNlOwoKICAgICAgaWYgKHByb3BlcnRpZXMuaGFzRW5jb2RpbmcgJiYgKHByb3BlcnRpZXMuYmFzZUVuY29kaW5nTmFtZSA9PT0gIk1hY1JvbWFuRW5jb2RpbmciIHx8IHByb3BlcnRpZXMuYmFzZUVuY29kaW5nTmFtZSA9PT0gIldpbkFuc2lFbmNvZGluZyIpKSB7CiAgICAgICAgYmFzZUVuY29kaW5nID0gKDAsIF9lbmNvZGluZ3MuZ2V0RW5jb2RpbmcpKHByb3BlcnRpZXMuYmFzZUVuY29kaW5nTmFtZSk7CiAgICAgIH0KCiAgICAgIGlmIChwcm9wZXJ0aWVzLmhhc0VuY29kaW5nICYmICF0aGlzLmlzU3ltYm9saWNGb250ICYmIChjbWFwUGxhdGZvcm1JZCA9PT0gMyAmJiBjbWFwRW5jb2RpbmdJZCA9PT0gMSB8fCBjbWFwUGxhdGZvcm1JZCA9PT0gMSAmJiBjbWFwRW5jb2RpbmdJZCA9PT0gMCkpIHsKICAgICAgICBjb25zdCBnbHlwaHNVbmljb2RlTWFwID0gKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKTsKCiAgICAgICAgZm9yIChsZXQgY2hhckNvZGUgPSAwOyBjaGFyQ29kZSA8IDI1NjsgY2hhckNvZGUrKykgewogICAgICAgICAgbGV0IGdseXBoTmFtZTsKCiAgICAgICAgICBpZiAodGhpcy5kaWZmZXJlbmNlc1tjaGFyQ29kZV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBnbHlwaE5hbWUgPSB0aGlzLmRpZmZlcmVuY2VzW2NoYXJDb2RlXTsKICAgICAgICAgIH0gZWxzZSBpZiAoYmFzZUVuY29kaW5nLmxlbmd0aCAmJiBiYXNlRW5jb2RpbmdbY2hhckNvZGVdICE9PSAiIikgewogICAgICAgICAgICBnbHlwaE5hbWUgPSBiYXNlRW5jb2RpbmdbY2hhckNvZGVdOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZ2x5cGhOYW1lID0gX2VuY29kaW5ncy5TdGFuZGFyZEVuY29kaW5nW2NoYXJDb2RlXTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWdseXBoTmFtZSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBzdGFuZGFyZEdseXBoTmFtZSA9ICgwLCBfZm9udHNfdXRpbHMucmVjb3ZlckdseXBoTmFtZSkoZ2x5cGhOYW1lLCBnbHlwaHNVbmljb2RlTWFwKTsKICAgICAgICAgIGxldCB1bmljb2RlT3JDaGFyQ29kZTsKCiAgICAgICAgICBpZiAoY21hcFBsYXRmb3JtSWQgPT09IDMgJiYgY21hcEVuY29kaW5nSWQgPT09IDEpIHsKICAgICAgICAgICAgdW5pY29kZU9yQ2hhckNvZGUgPSBnbHlwaHNVbmljb2RlTWFwW3N0YW5kYXJkR2x5cGhOYW1lXTsKICAgICAgICAgIH0gZWxzZSBpZiAoY21hcFBsYXRmb3JtSWQgPT09IDEgJiYgY21hcEVuY29kaW5nSWQgPT09IDApIHsKICAgICAgICAgICAgdW5pY29kZU9yQ2hhckNvZGUgPSBfZW5jb2RpbmdzLk1hY1JvbWFuRW5jb2RpbmcuaW5kZXhPZihzdGFuZGFyZEdseXBoTmFtZSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHVuaWNvZGVPckNoYXJDb2RlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgaWYgKCFwcm9wZXJ0aWVzLmdseXBoTmFtZXMgJiYgcHJvcGVydGllcy5oYXNJbmNsdWRlZFRvVW5pY29kZU1hcCAmJiAhKHRoaXMudG9Vbmljb2RlIGluc3RhbmNlb2YgX3RvX3VuaWNvZGVfbWFwLklkZW50aXR5VG9Vbmljb2RlTWFwKSkgewogICAgICAgICAgICAgIGNvbnN0IHVuaWNvZGUgPSB0aGlzLnRvVW5pY29kZS5nZXQoY2hhckNvZGUpOwoKICAgICAgICAgICAgICBpZiAodW5pY29kZSkgewogICAgICAgICAgICAgICAgdW5pY29kZU9yQ2hhckNvZGUgPSB1bmljb2RlLmNvZGVQb2ludEF0KDApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHVuaWNvZGVPckNoYXJDb2RlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY21hcE1hcHBpbmdzTGVuZ3RoOyArK2kpIHsKICAgICAgICAgICAgaWYgKGNtYXBNYXBwaW5nc1tpXS5jaGFyQ29kZSAhPT0gdW5pY29kZU9yQ2hhckNvZGUpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gY21hcE1hcHBpbmdzW2ldLmdseXBoSWQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChjbWFwUGxhdGZvcm1JZCA9PT0gMCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY21hcE1hcHBpbmdzTGVuZ3RoOyArK2kpIHsKICAgICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NtYXBNYXBwaW5nc1tpXS5jaGFyQ29kZV0gPSBjbWFwTWFwcGluZ3NbaV0uZ2x5cGhJZDsKICAgICAgICB9CgogICAgICAgIGZvcmNlUG9zdFRhYmxlID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNtYXBNYXBwaW5nc0xlbmd0aDsgKytpKSB7CiAgICAgICAgICBsZXQgY2hhckNvZGUgPSBjbWFwTWFwcGluZ3NbaV0uY2hhckNvZGU7CgogICAgICAgICAgaWYgKGNtYXBQbGF0Zm9ybUlkID09PSAzICYmIGNoYXJDb2RlID49IDB4ZjAwMCAmJiBjaGFyQ29kZSA8PSAweGYwZmYpIHsKICAgICAgICAgICAgY2hhckNvZGUgJj0gMHhmZjsKICAgICAgICAgIH0KCiAgICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSBjbWFwTWFwcGluZ3NbaV0uZ2x5cGhJZDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChwcm9wZXJ0aWVzLmdseXBoTmFtZXMgJiYgKGJhc2VFbmNvZGluZy5sZW5ndGggfHwgdGhpcy5kaWZmZXJlbmNlcy5sZW5ndGgpKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSkgewogICAgICAgICAgaWYgKCFmb3JjZVBvc3RUYWJsZSAmJiBjaGFyQ29kZVRvR2x5cGhJZFtpXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IGdseXBoTmFtZSA9IHRoaXMuZGlmZmVyZW5jZXNbaV0gfHwgYmFzZUVuY29kaW5nW2ldOwoKICAgICAgICAgIGlmICghZ2x5cGhOYW1lKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IGdseXBoSWQgPSBwcm9wZXJ0aWVzLmdseXBoTmFtZXMuaW5kZXhPZihnbHlwaE5hbWUpOwoKICAgICAgICAgIGlmIChnbHlwaElkID4gMCAmJiBoYXNHbHlwaChnbHlwaElkKSkgewogICAgICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtpXSA9IGdseXBoSWQ7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKGNoYXJDb2RlVG9HbHlwaElkLmxlbmd0aCA9PT0gMCkgewogICAgICBjaGFyQ29kZVRvR2x5cGhJZFswXSA9IDA7CiAgICB9CgogICAgbGV0IGdseXBoWmVyb0lkID0gbnVtR2x5cGhzT3V0IC0gMTsKCiAgICBpZiAoIWR1cEZpcnN0RW50cnkpIHsKICAgICAgZ2x5cGhaZXJvSWQgPSAwOwogICAgfQoKICAgIGlmICghcHJvcGVydGllcy5jc3NGb250SW5mbykgewogICAgICBjb25zdCBuZXdNYXBwaW5nID0gYWRqdXN0TWFwcGluZyhjaGFyQ29kZVRvR2x5cGhJZCwgaGFzR2x5cGgsIGdseXBoWmVyb0lkLCB0aGlzLnRvVW5pY29kZSk7CiAgICAgIHRoaXMudG9Gb250Q2hhciA9IG5ld01hcHBpbmcudG9Gb250Q2hhcjsKICAgICAgdGFibGVzLmNtYXAgPSB7CiAgICAgICAgdGFnOiAiY21hcCIsCiAgICAgICAgZGF0YTogY3JlYXRlQ21hcFRhYmxlKG5ld01hcHBpbmcuY2hhckNvZGVUb0dseXBoSWQsIG5ld01hcHBpbmcudG9Vbmljb2RlRXh0cmFNYXAsIG51bUdseXBoc091dCkKICAgICAgfTsKCiAgICAgIGlmICghdGFibGVzWyJPUy8yIl0gfHwgIXZhbGlkYXRlT1MyVGFibGUodGFibGVzWyJPUy8yIl0sIGZvbnQpKSB7CiAgICAgICAgdGFibGVzWyJPUy8yIl0gPSB7CiAgICAgICAgICB0YWc6ICJPUy8yIiwKICAgICAgICAgIGRhdGE6IGNyZWF0ZU9TMlRhYmxlKHByb3BlcnRpZXMsIG5ld01hcHBpbmcuY2hhckNvZGVUb0dseXBoSWQsIG1ldHJpY3NPdmVycmlkZSkKICAgICAgICB9OwogICAgICB9CiAgICB9CgogICAgaWYgKCFpc1RydWVUeXBlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY2ZmRmlsZSA9IG5ldyBfc3RyZWFtLlN0cmVhbSh0YWJsZXNbIkNGRiAiXS5kYXRhKTsKICAgICAgICBjb25zdCBwYXJzZXIgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGUGFyc2VyKGNmZkZpbGUsIHByb3BlcnRpZXMsIF9mb250c191dGlscy5TRUFDX0FOQUxZU0lTX0VOQUJMRUQpOwogICAgICAgIGNmZiA9IHBhcnNlci5wYXJzZSgpOwogICAgICAgIGNmZi5kdXBsaWNhdGVGaXJzdEdseXBoKCk7CiAgICAgICAgY29uc3QgY29tcGlsZXIgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGQ29tcGlsZXIoY2ZmKTsKICAgICAgICB0YWJsZXNbIkNGRiAiXS5kYXRhID0gY29tcGlsZXIuY29tcGlsZSgpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJGYWlsZWQgdG8gY29tcGlsZSBmb250ICIgKyBwcm9wZXJ0aWVzLmxvYWRlZE5hbWUpOwogICAgICB9CiAgICB9CgogICAgaWYgKCF0YWJsZXMubmFtZSkgewogICAgICB0YWJsZXMubmFtZSA9IHsKICAgICAgICB0YWc6ICJuYW1lIiwKICAgICAgICBkYXRhOiBjcmVhdGVOYW1lVGFibGUodGhpcy5uYW1lKQogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgbmFtZVByb3RvdHlwZSA9IHJlYWROYW1lVGFibGUodGFibGVzLm5hbWUpOwogICAgICB0YWJsZXMubmFtZS5kYXRhID0gY3JlYXRlTmFtZVRhYmxlKG5hbWUsIG5hbWVQcm90b3R5cGUpOwogICAgICB0aGlzLnBzTmFtZSA9IG5hbWVQcm90b3R5cGVbMF1bNl0gfHwgbnVsbDsKICAgIH0KCiAgICBjb25zdCBidWlsZGVyID0gbmV3IF9vcGVudHlwZV9maWxlX2J1aWxkZXIuT3BlblR5cGVGaWxlQnVpbGRlcihoZWFkZXIudmVyc2lvbik7CgogICAgZm9yIChjb25zdCB0YWJsZVRhZyBpbiB0YWJsZXMpIHsKICAgICAgYnVpbGRlci5hZGRUYWJsZSh0YWJsZVRhZywgdGFibGVzW3RhYmxlVGFnXS5kYXRhKTsKICAgIH0KCiAgICByZXR1cm4gYnVpbGRlci50b0FycmF5KCk7CiAgfQoKICBjb252ZXJ0KGZvbnROYW1lLCBmb250LCBwcm9wZXJ0aWVzKSB7CiAgICBwcm9wZXJ0aWVzLmZpeGVkUGl0Y2ggPSBmYWxzZTsKCiAgICBpZiAocHJvcGVydGllcy5idWlsdEluRW5jb2RpbmcpIHsKICAgICAgYWRqdXN0VG9Vbmljb2RlKHByb3BlcnRpZXMsIHByb3BlcnRpZXMuYnVpbHRJbkVuY29kaW5nKTsKICAgIH0KCiAgICBsZXQgZ2x5cGhaZXJvSWQgPSAxOwoKICAgIGlmIChmb250IGluc3RhbmNlb2YgX2NmZl9mb250LkNGRkZvbnQpIHsKICAgICAgZ2x5cGhaZXJvSWQgPSBmb250Lm51bUdseXBocyAtIDE7CiAgICB9CgogICAgY29uc3QgbWFwcGluZyA9IGZvbnQuZ2V0R2x5cGhNYXBwaW5nKHByb3BlcnRpZXMpOwogICAgbGV0IG5ld01hcHBpbmcgPSBudWxsOwogICAgbGV0IG5ld0NoYXJDb2RlVG9HbHlwaElkID0gbWFwcGluZzsKICAgIGxldCB0b1VuaWNvZGVFeHRyYU1hcCA9IG51bGw7CgogICAgaWYgKCFwcm9wZXJ0aWVzLmNzc0ZvbnRJbmZvKSB7CiAgICAgIG5ld01hcHBpbmcgPSBhZGp1c3RNYXBwaW5nKG1hcHBpbmcsIGZvbnQuaGFzR2x5cGhJZC5iaW5kKGZvbnQpLCBnbHlwaFplcm9JZCwgdGhpcy50b1VuaWNvZGUpOwogICAgICB0aGlzLnRvRm9udENoYXIgPSBuZXdNYXBwaW5nLnRvRm9udENoYXI7CiAgICAgIG5ld0NoYXJDb2RlVG9HbHlwaElkID0gbmV3TWFwcGluZy5jaGFyQ29kZVRvR2x5cGhJZDsKICAgICAgdG9Vbmljb2RlRXh0cmFNYXAgPSBuZXdNYXBwaW5nLnRvVW5pY29kZUV4dHJhTWFwOwogICAgfQoKICAgIGNvbnN0IG51bUdseXBocyA9IGZvbnQubnVtR2x5cGhzOwoKICAgIGZ1bmN0aW9uIGdldENoYXJDb2RlcyhjaGFyQ29kZVRvR2x5cGhJZCwgZ2x5cGhJZCkgewogICAgICBsZXQgY2hhckNvZGVzID0gbnVsbDsKCiAgICAgIGZvciAoY29uc3QgY2hhckNvZGUgaW4gY2hhckNvZGVUb0dseXBoSWQpIHsKICAgICAgICBpZiAoZ2x5cGhJZCA9PT0gY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdKSB7CiAgICAgICAgICBpZiAoIWNoYXJDb2RlcykgewogICAgICAgICAgICBjaGFyQ29kZXMgPSBbXTsKICAgICAgICAgIH0KCiAgICAgICAgICBjaGFyQ29kZXMucHVzaChjaGFyQ29kZSB8IDApOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGNoYXJDb2RlczsKICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVDaGFyQ29kZShjaGFyQ29kZVRvR2x5cGhJZCwgZ2x5cGhJZCkgewogICAgICBmb3IgKGNvbnN0IGNoYXJDb2RlIGluIGNoYXJDb2RlVG9HbHlwaElkKSB7CiAgICAgICAgaWYgKGdseXBoSWQgPT09IGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSkgewogICAgICAgICAgcmV0dXJuIGNoYXJDb2RlIHwgMDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG5ld01hcHBpbmcuY2hhckNvZGVUb0dseXBoSWRbbmV3TWFwcGluZy5uZXh0QXZhaWxhYmxlRm9udENoYXJDb2RlXSA9IGdseXBoSWQ7CiAgICAgIHJldHVybiBuZXdNYXBwaW5nLm5leHRBdmFpbGFibGVGb250Q2hhckNvZGUrKzsKICAgIH0KCiAgICBjb25zdCBzZWFjcyA9IGZvbnQuc2VhY3M7CgogICAgaWYgKG5ld01hcHBpbmcgJiYgX2ZvbnRzX3V0aWxzLlNFQUNfQU5BTFlTSVNfRU5BQkxFRCAmJiBzZWFjcyAmJiBzZWFjcy5sZW5ndGgpIHsKICAgICAgY29uc3QgbWF0cml4ID0gcHJvcGVydGllcy5mb250TWF0cml4IHx8IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYOwogICAgICBjb25zdCBjaGFyc2V0ID0gZm9udC5nZXRDaGFyc2V0KCk7CiAgICAgIGNvbnN0IHNlYWNNYXAgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgICAgZm9yIChsZXQgZ2x5cGhJZCBpbiBzZWFjcykgewogICAgICAgIGdseXBoSWQgfD0gMDsKICAgICAgICBjb25zdCBzZWFjID0gc2VhY3NbZ2x5cGhJZF07CiAgICAgICAgY29uc3QgYmFzZUdseXBoTmFtZSA9IF9lbmNvZGluZ3MuU3RhbmRhcmRFbmNvZGluZ1tzZWFjWzJdXTsKICAgICAgICBjb25zdCBhY2NlbnRHbHlwaE5hbWUgPSBfZW5jb2RpbmdzLlN0YW5kYXJkRW5jb2Rpbmdbc2VhY1szXV07CiAgICAgICAgY29uc3QgYmFzZUdseXBoSWQgPSBjaGFyc2V0LmluZGV4T2YoYmFzZUdseXBoTmFtZSk7CiAgICAgICAgY29uc3QgYWNjZW50R2x5cGhJZCA9IGNoYXJzZXQuaW5kZXhPZihhY2NlbnRHbHlwaE5hbWUpOwoKICAgICAgICBpZiAoYmFzZUdseXBoSWQgPCAwIHx8IGFjY2VudEdseXBoSWQgPCAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGFjY2VudE9mZnNldCA9IHsKICAgICAgICAgIHg6IHNlYWNbMF0gKiBtYXRyaXhbMF0gKyBzZWFjWzFdICogbWF0cml4WzJdICsgbWF0cml4WzRdLAogICAgICAgICAgeTogc2VhY1swXSAqIG1hdHJpeFsxXSArIHNlYWNbMV0gKiBtYXRyaXhbM10gKyBtYXRyaXhbNV0KICAgICAgICB9OwogICAgICAgIGNvbnN0IGNoYXJDb2RlcyA9IGdldENoYXJDb2RlcyhtYXBwaW5nLCBnbHlwaElkKTsKCiAgICAgICAgaWYgKCFjaGFyQ29kZXMpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gY2hhckNvZGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGNoYXJDb2RlID0gY2hhckNvZGVzW2ldOwogICAgICAgICAgY29uc3QgY2hhckNvZGVUb0dseXBoSWQgPSBuZXdNYXBwaW5nLmNoYXJDb2RlVG9HbHlwaElkOwogICAgICAgICAgY29uc3QgYmFzZUZvbnRDaGFyQ29kZSA9IGNyZWF0ZUNoYXJDb2RlKGNoYXJDb2RlVG9HbHlwaElkLCBiYXNlR2x5cGhJZCk7CiAgICAgICAgICBjb25zdCBhY2NlbnRGb250Q2hhckNvZGUgPSBjcmVhdGVDaGFyQ29kZShjaGFyQ29kZVRvR2x5cGhJZCwgYWNjZW50R2x5cGhJZCk7CiAgICAgICAgICBzZWFjTWFwW2NoYXJDb2RlXSA9IHsKICAgICAgICAgICAgYmFzZUZvbnRDaGFyQ29kZSwKICAgICAgICAgICAgYWNjZW50Rm9udENoYXJDb2RlLAogICAgICAgICAgICBhY2NlbnRPZmZzZXQKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9CgogICAgICBwcm9wZXJ0aWVzLnNlYWNNYXAgPSBzZWFjTWFwOwogICAgfQoKICAgIGNvbnN0IHVuaXRzUGVyRW0gPSAxIC8gKHByb3BlcnRpZXMuZm9udE1hdHJpeCB8fCBfdXRpbC5GT05UX0lERU5USVRZX01BVFJJWClbMF07CiAgICBjb25zdCBidWlsZGVyID0gbmV3IF9vcGVudHlwZV9maWxlX2J1aWxkZXIuT3BlblR5cGVGaWxlQnVpbGRlcigiXHg0Rlx4NTRceDU0XHg0RiIpOwogICAgYnVpbGRlci5hZGRUYWJsZSgiQ0ZGICIsIGZvbnQuZGF0YSk7CiAgICBidWlsZGVyLmFkZFRhYmxlKCJPUy8yIiwgY3JlYXRlT1MyVGFibGUocHJvcGVydGllcywgbmV3Q2hhckNvZGVUb0dseXBoSWQpKTsKICAgIGJ1aWxkZXIuYWRkVGFibGUoImNtYXAiLCBjcmVhdGVDbWFwVGFibGUobmV3Q2hhckNvZGVUb0dseXBoSWQsIHRvVW5pY29kZUV4dHJhTWFwLCBudW1HbHlwaHMpKTsKICAgIGJ1aWxkZXIuYWRkVGFibGUoImhlYWQiLCAiXHgwMFx4MDFceDAwXHgwMCIgKyAiXHgwMFx4MDBceDEwXHgwMCIgKyAiXHgwMFx4MDBceDAwXHgwMCIgKyAiXHg1Rlx4MEZceDNDXHhGNSIgKyAiXHgwMFx4MDAiICsgc2FmZVN0cmluZzE2KHVuaXRzUGVyRW0pICsgIlx4MDBceDAwXHgwMFx4MDBceDllXHgwYlx4N2VceDI3IiArICJceDAwXHgwMFx4MDBceDAwXHg5ZVx4MGJceDdlXHgyNyIgKyAiXHgwMFx4MDAiICsgc2FmZVN0cmluZzE2KHByb3BlcnRpZXMuZGVzY2VudCkgKyAiXHgwRlx4RkYiICsgc2FmZVN0cmluZzE2KHByb3BlcnRpZXMuYXNjZW50KSArIHN0cmluZzE2KHByb3BlcnRpZXMuaXRhbGljQW5nbGUgPyAyIDogMCkgKyAiXHgwMFx4MTEiICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIgKyAiXHgwMFx4MDAiKTsKICAgIGJ1aWxkZXIuYWRkVGFibGUoImhoZWEiLCAiXHgwMFx4MDFceDAwXHgwMCIgKyBzYWZlU3RyaW5nMTYocHJvcGVydGllcy5hc2NlbnQpICsgc2FmZVN0cmluZzE2KHByb3BlcnRpZXMuZGVzY2VudCkgKyAiXHgwMFx4MDAiICsgIlx4RkZceEZGIiArICJceDAwXHgwMCIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArIHNhZmVTdHJpbmcxNihwcm9wZXJ0aWVzLmNhcEhlaWdodCkgKyBzYWZlU3RyaW5nMTYoTWF0aC50YW4ocHJvcGVydGllcy5pdGFsaWNBbmdsZSkgKiBwcm9wZXJ0aWVzLnhIZWlnaHQpICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIgKyAiXHgwMFx4MDAiICsgc3RyaW5nMTYobnVtR2x5cGhzKSk7CiAgICBidWlsZGVyLmFkZFRhYmxlKCJobXR4IiwgZnVuY3Rpb24gZm9udEZpZWxkc0htdHgoKSB7CiAgICAgIGNvbnN0IGNoYXJzdHJpbmdzID0gZm9udC5jaGFyc3RyaW5nczsKICAgICAgY29uc3QgY2ZmV2lkdGhzID0gZm9udC5jZmYgPyBmb250LmNmZi53aWR0aHMgOiBudWxsOwogICAgICBsZXQgaG10eCA9ICJceDAwXHgwMFx4MDBceDAwIjsKCiAgICAgIGZvciAobGV0IGkgPSAxLCBpaSA9IG51bUdseXBoczsgaSA8IGlpOyBpKyspIHsKICAgICAgICBsZXQgd2lkdGggPSAwOwoKICAgICAgICBpZiAoY2hhcnN0cmluZ3MpIHsKICAgICAgICAgIGNvbnN0IGNoYXJzdHJpbmcgPSBjaGFyc3RyaW5nc1tpIC0gMV07CiAgICAgICAgICB3aWR0aCA9ICJ3aWR0aCIgaW4gY2hhcnN0cmluZyA/IGNoYXJzdHJpbmcud2lkdGggOiAwOwogICAgICAgIH0gZWxzZSBpZiAoY2ZmV2lkdGhzKSB7CiAgICAgICAgICB3aWR0aCA9IE1hdGguY2VpbChjZmZXaWR0aHNbaV0gfHwgMCk7CiAgICAgICAgfQoKICAgICAgICBobXR4ICs9IHN0cmluZzE2KHdpZHRoKSArIHN0cmluZzE2KDApOwogICAgICB9CgogICAgICByZXR1cm4gaG10eDsKICAgIH0oKSk7CiAgICBidWlsZGVyLmFkZFRhYmxlKCJtYXhwIiwgIlx4MDBceDAwXHg1MFx4MDAiICsgc3RyaW5nMTYobnVtR2x5cGhzKSk7CiAgICBidWlsZGVyLmFkZFRhYmxlKCJuYW1lIiwgY3JlYXRlTmFtZVRhYmxlKGZvbnROYW1lKSk7CiAgICBidWlsZGVyLmFkZFRhYmxlKCJwb3N0IiwgY3JlYXRlUG9zdFRhYmxlKHByb3BlcnRpZXMpKTsKICAgIHJldHVybiBidWlsZGVyLnRvQXJyYXkoKTsKICB9CgogIGdldCBzcGFjZVdpZHRoKCkgewogICAgY29uc3QgcG9zc2libGVTcGFjZVJlcGxhY2VtZW50cyA9IFsic3BhY2UiLCAibWludXMiLCAib25lIiwgImkiLCAiSSJdOwogICAgbGV0IHdpZHRoOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHBvc3NpYmxlU3BhY2VSZXBsYWNlbWVudHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCBnbHlwaE5hbWUgPSBwb3NzaWJsZVNwYWNlUmVwbGFjZW1lbnRzW2ldOwoKICAgICAgaWYgKGdseXBoTmFtZSBpbiB0aGlzLndpZHRocykgewogICAgICAgIHdpZHRoID0gdGhpcy53aWR0aHNbZ2x5cGhOYW1lXTsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY29uc3QgZ2x5cGhzVW5pY29kZU1hcCA9ICgwLCBfZ2x5cGhsaXN0LmdldEdseXBoc1VuaWNvZGUpKCk7CiAgICAgIGNvbnN0IGdseXBoVW5pY29kZSA9IGdseXBoc1VuaWNvZGVNYXBbZ2x5cGhOYW1lXTsKICAgICAgbGV0IGNoYXJjb2RlID0gMDsKCiAgICAgIGlmICh0aGlzLmNvbXBvc2l0ZSAmJiB0aGlzLmNNYXAuY29udGFpbnMoZ2x5cGhVbmljb2RlKSkgewogICAgICAgIGNoYXJjb2RlID0gdGhpcy5jTWFwLmxvb2t1cChnbHlwaFVuaWNvZGUpOwoKICAgICAgICBpZiAodHlwZW9mIGNoYXJjb2RlID09PSAic3RyaW5nIikgewogICAgICAgICAgY2hhcmNvZGUgPSBjb252ZXJ0Q2lkU3RyaW5nKGdseXBoVW5pY29kZSwgY2hhcmNvZGUpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCFjaGFyY29kZSAmJiB0aGlzLnRvVW5pY29kZSkgewogICAgICAgIGNoYXJjb2RlID0gdGhpcy50b1VuaWNvZGUuY2hhckNvZGVPZihnbHlwaFVuaWNvZGUpOwogICAgICB9CgogICAgICBpZiAoY2hhcmNvZGUgPD0gMCkgewogICAgICAgIGNoYXJjb2RlID0gZ2x5cGhVbmljb2RlOwogICAgICB9CgogICAgICB3aWR0aCA9IHRoaXMud2lkdGhzW2NoYXJjb2RlXTsKCiAgICAgIGlmICh3aWR0aCkgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgd2lkdGggPSB3aWR0aCB8fCB0aGlzLmRlZmF1bHRXaWR0aDsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAic3BhY2VXaWR0aCIsIHdpZHRoKTsKICB9CgogIF9jaGFyVG9HbHlwaChjaGFyY29kZSkgewogICAgbGV0IGlzU3BhY2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgbGV0IGZvbnRDaGFyQ29kZSwgd2lkdGgsIG9wZXJhdG9yTGlzdElkOwogICAgbGV0IHdpZHRoQ29kZSA9IGNoYXJjb2RlOwoKICAgIGlmICh0aGlzLmNNYXAgJiYgdGhpcy5jTWFwLmNvbnRhaW5zKGNoYXJjb2RlKSkgewogICAgICB3aWR0aENvZGUgPSB0aGlzLmNNYXAubG9va3VwKGNoYXJjb2RlKTsKCiAgICAgIGlmICh0eXBlb2Ygd2lkdGhDb2RlID09PSAic3RyaW5nIikgewogICAgICAgIHdpZHRoQ29kZSA9IGNvbnZlcnRDaWRTdHJpbmcoY2hhcmNvZGUsIHdpZHRoQ29kZSk7CiAgICAgIH0KICAgIH0KCiAgICB3aWR0aCA9IHRoaXMud2lkdGhzW3dpZHRoQ29kZV07CgogICAgaWYgKHR5cGVvZiB3aWR0aCAhPT0gIm51bWJlciIpIHsKICAgICAgd2lkdGggPSB0aGlzLmRlZmF1bHRXaWR0aDsKICAgIH0KCiAgICBjb25zdCB2bWV0cmljID0gdGhpcy52bWV0cmljcyAmJiB0aGlzLnZtZXRyaWNzW3dpZHRoQ29kZV07CiAgICBsZXQgdW5pY29kZSA9IHRoaXMudG9Vbmljb2RlLmdldChjaGFyY29kZSkgfHwgY2hhcmNvZGU7CgogICAgaWYgKHR5cGVvZiB1bmljb2RlID09PSAibnVtYmVyIikgewogICAgICB1bmljb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZSh1bmljb2RlKTsKICAgIH0KCiAgICBsZXQgaXNJbkZvbnQgPSB0aGlzLnRvRm9udENoYXJbY2hhcmNvZGVdICE9PSB1bmRlZmluZWQ7CiAgICBmb250Q2hhckNvZGUgPSB0aGlzLnRvRm9udENoYXJbY2hhcmNvZGVdIHx8IGNoYXJjb2RlOwoKICAgIGlmICh0aGlzLm1pc3NpbmdGaWxlKSB7CiAgICAgIGNvbnN0IGdseXBoTmFtZSA9IHRoaXMuZGlmZmVyZW5jZXNbY2hhcmNvZGVdIHx8IHRoaXMuZGVmYXVsdEVuY29kaW5nW2NoYXJjb2RlXTsKCiAgICAgIGlmICgoZ2x5cGhOYW1lID09PSAiLm5vdGRlZiIgfHwgZ2x5cGhOYW1lID09PSAiIikgJiYgdGhpcy50eXBlID09PSAiVHlwZTEiKSB7CiAgICAgICAgZm9udENoYXJDb2RlID0gMHgyMDsKICAgICAgfQoKICAgICAgZm9udENoYXJDb2RlID0gKDAsIF91bmljb2RlLm1hcFNwZWNpYWxVbmljb2RlVmFsdWVzKShmb250Q2hhckNvZGUpOwogICAgfQoKICAgIGlmICh0aGlzLmlzVHlwZTNGb250KSB7CiAgICAgIG9wZXJhdG9yTGlzdElkID0gZm9udENoYXJDb2RlOwogICAgfQoKICAgIGxldCBhY2NlbnQgPSBudWxsOwoKICAgIGlmICh0aGlzLnNlYWNNYXAgJiYgdGhpcy5zZWFjTWFwW2NoYXJjb2RlXSkgewogICAgICBpc0luRm9udCA9IHRydWU7CiAgICAgIGNvbnN0IHNlYWMgPSB0aGlzLnNlYWNNYXBbY2hhcmNvZGVdOwogICAgICBmb250Q2hhckNvZGUgPSBzZWFjLmJhc2VGb250Q2hhckNvZGU7CiAgICAgIGFjY2VudCA9IHsKICAgICAgICBmb250Q2hhcjogU3RyaW5nLmZyb21Db2RlUG9pbnQoc2VhYy5hY2NlbnRGb250Q2hhckNvZGUpLAogICAgICAgIG9mZnNldDogc2VhYy5hY2NlbnRPZmZzZXQKICAgICAgfTsKICAgIH0KCiAgICBsZXQgZm9udENoYXIgPSAiIjsKCiAgICBpZiAodHlwZW9mIGZvbnRDaGFyQ29kZSA9PT0gIm51bWJlciIpIHsKICAgICAgaWYgKGZvbnRDaGFyQ29kZSA8PSAweDEwZmZmZikgewogICAgICAgIGZvbnRDaGFyID0gU3RyaW5nLmZyb21Db2RlUG9pbnQoZm9udENoYXJDb2RlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYGNoYXJUb0dseXBoIC0gaW52YWxpZCBmb250Q2hhckNvZGU6ICR7Zm9udENoYXJDb2RlfWApOwogICAgICB9CiAgICB9CgogICAgbGV0IGdseXBoID0gdGhpcy5fZ2x5cGhDYWNoZVtjaGFyY29kZV07CgogICAgaWYgKCFnbHlwaCB8fCAhZ2x5cGgubWF0Y2hlc0ZvckNhY2hlKGNoYXJjb2RlLCBmb250Q2hhciwgdW5pY29kZSwgYWNjZW50LCB3aWR0aCwgdm1ldHJpYywgb3BlcmF0b3JMaXN0SWQsIGlzU3BhY2UsIGlzSW5Gb250KSkgewogICAgICBnbHlwaCA9IG5ldyBHbHlwaChjaGFyY29kZSwgZm9udENoYXIsIHVuaWNvZGUsIGFjY2VudCwgd2lkdGgsIHZtZXRyaWMsIG9wZXJhdG9yTGlzdElkLCBpc1NwYWNlLCBpc0luRm9udCk7CiAgICAgIHRoaXMuX2dseXBoQ2FjaGVbY2hhcmNvZGVdID0gZ2x5cGg7CiAgICB9CgogICAgcmV0dXJuIGdseXBoOwogIH0KCiAgY2hhcnNUb0dseXBocyhjaGFycykgewogICAgbGV0IGdseXBocyA9IHRoaXMuX2NoYXJzQ2FjaGVbY2hhcnNdOwoKICAgIGlmIChnbHlwaHMpIHsKICAgICAgcmV0dXJuIGdseXBoczsKICAgIH0KCiAgICBnbHlwaHMgPSBbXTsKCiAgICBpZiAodGhpcy5jTWFwKSB7CiAgICAgIGNvbnN0IGMgPSBPYmplY3QuY3JlYXRlKG51bGwpLAogICAgICAgICAgICBpaSA9IGNoYXJzLmxlbmd0aDsKICAgICAgbGV0IGkgPSAwOwoKICAgICAgd2hpbGUgKGkgPCBpaSkgewogICAgICAgIHRoaXMuY01hcC5yZWFkQ2hhckNvZGUoY2hhcnMsIGksIGMpOwogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGNoYXJjb2RlLAogICAgICAgICAgbGVuZ3RoCiAgICAgICAgfSA9IGM7CiAgICAgICAgaSArPSBsZW5ndGg7CgogICAgICAgIGNvbnN0IGdseXBoID0gdGhpcy5fY2hhclRvR2x5cGgoY2hhcmNvZGUsIGxlbmd0aCA9PT0gMSAmJiBjaGFycy5jaGFyQ29kZUF0KGkgLSAxKSA9PT0gMHgyMCk7CgogICAgICAgIGdseXBocy5wdXNoKGdseXBoKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gY2hhcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICAgIGNvbnN0IGNoYXJjb2RlID0gY2hhcnMuY2hhckNvZGVBdChpKTsKCiAgICAgICAgY29uc3QgZ2x5cGggPSB0aGlzLl9jaGFyVG9HbHlwaChjaGFyY29kZSwgY2hhcmNvZGUgPT09IDB4MjApOwoKICAgICAgICBnbHlwaHMucHVzaChnbHlwaCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdGhpcy5fY2hhcnNDYWNoZVtjaGFyc10gPSBnbHlwaHM7CiAgfQoKICBnZXRDaGFyUG9zaXRpb25zKGNoYXJzKSB7CiAgICBjb25zdCBwb3NpdGlvbnMgPSBbXTsKCiAgICBpZiAodGhpcy5jTWFwKSB7CiAgICAgIGNvbnN0IGMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICBsZXQgaSA9IDA7CgogICAgICB3aGlsZSAoaSA8IGNoYXJzLmxlbmd0aCkgewogICAgICAgIHRoaXMuY01hcC5yZWFkQ2hhckNvZGUoY2hhcnMsIGksIGMpOwogICAgICAgIGNvbnN0IGxlbmd0aCA9IGMubGVuZ3RoOwogICAgICAgIHBvc2l0aW9ucy5wdXNoKFtpLCBpICsgbGVuZ3RoXSk7CiAgICAgICAgaSArPSBsZW5ndGg7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNoYXJzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICBwb3NpdGlvbnMucHVzaChbaSwgaSArIDFdKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBwb3NpdGlvbnM7CiAgfQoKICBnZXQgZ2x5cGhDYWNoZVZhbHVlcygpIHsKICAgIHJldHVybiBPYmplY3QudmFsdWVzKHRoaXMuX2dseXBoQ2FjaGUpOwogIH0KCiAgZW5jb2RlU3RyaW5nKHN0cikgewogICAgY29uc3QgYnVmZmVycyA9IFtdOwogICAgY29uc3QgY3VycmVudEJ1ZiA9IFtdOwoKICAgIGNvbnN0IGhhc0N1cnJlbnRCdWZFcnJvcnMgPSAoKSA9PiBidWZmZXJzLmxlbmd0aCAlIDIgPT09IDE7CgogICAgY29uc3QgZ2V0Q2hhckNvZGUgPSB0aGlzLnRvVW5pY29kZSBpbnN0YW5jZW9mIF90b191bmljb2RlX21hcC5JZGVudGl0eVRvVW5pY29kZU1hcCA/IHVuaWNvZGUgPT4gdGhpcy50b1VuaWNvZGUuY2hhckNvZGVPZih1bmljb2RlKSA6IHVuaWNvZGUgPT4gdGhpcy50b1VuaWNvZGUuY2hhckNvZGVPZihTdHJpbmcuZnJvbUNvZGVQb2ludCh1bmljb2RlKSk7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gc3RyLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgY29uc3QgdW5pY29kZSA9IHN0ci5jb2RlUG9pbnRBdChpKTsKCiAgICAgIGlmICh1bmljb2RlID4gMHhkN2ZmICYmICh1bmljb2RlIDwgMHhlMDAwIHx8IHVuaWNvZGUgPiAweGZmZmQpKSB7CiAgICAgICAgaSsrOwogICAgICB9CgogICAgICBpZiAodGhpcy50b1VuaWNvZGUpIHsKICAgICAgICBjb25zdCBjaGFyQ29kZSA9IGdldENoYXJDb2RlKHVuaWNvZGUpOwoKICAgICAgICBpZiAoY2hhckNvZGUgIT09IC0xKSB7CiAgICAgICAgICBpZiAoaGFzQ3VycmVudEJ1ZkVycm9ycygpKSB7CiAgICAgICAgICAgIGJ1ZmZlcnMucHVzaChjdXJyZW50QnVmLmpvaW4oIiIpKTsKICAgICAgICAgICAgY3VycmVudEJ1Zi5sZW5ndGggPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IGNoYXJDb2RlTGVuZ3RoID0gdGhpcy5jTWFwID8gdGhpcy5jTWFwLmdldENoYXJDb2RlTGVuZ3RoKGNoYXJDb2RlKSA6IDE7CgogICAgICAgICAgZm9yIChsZXQgaiA9IGNoYXJDb2RlTGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgICAgY3VycmVudEJ1Zi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUgPj4gOCAqIGogJiAweGZmKSk7CiAgICAgICAgICB9CgogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIWhhc0N1cnJlbnRCdWZFcnJvcnMoKSkgewogICAgICAgIGJ1ZmZlcnMucHVzaChjdXJyZW50QnVmLmpvaW4oIiIpKTsKICAgICAgICBjdXJyZW50QnVmLmxlbmd0aCA9IDA7CiAgICAgIH0KCiAgICAgIGN1cnJlbnRCdWYucHVzaChTdHJpbmcuZnJvbUNvZGVQb2ludCh1bmljb2RlKSk7CiAgICB9CgogICAgYnVmZmVycy5wdXNoKGN1cnJlbnRCdWYuam9pbigiIikpOwogICAgcmV0dXJuIGJ1ZmZlcnM7CiAgfQoKfQoKZXhwb3J0cy5Gb250ID0gRm9udDsKCmNsYXNzIEVycm9yRm9udCB7CiAgY29uc3RydWN0b3IoZXJyb3IpIHsKICAgIHRoaXMuZXJyb3IgPSBlcnJvcjsKICAgIHRoaXMubG9hZGVkTmFtZSA9ICJnX2ZvbnRfZXJyb3IiOwogICAgdGhpcy5taXNzaW5nRmlsZSA9IHRydWU7CiAgfQoKICBjaGFyc1RvR2x5cGhzKCkgewogICAgcmV0dXJuIFtdOwogIH0KCiAgZW5jb2RlU3RyaW5nKGNoYXJzKSB7CiAgICByZXR1cm4gW2NoYXJzXTsKICB9CgogIGV4cG9ydERhdGEoKSB7CiAgICBsZXQgZXh0cmFQcm9wZXJ0aWVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgIHJldHVybiB7CiAgICAgIGVycm9yOiB0aGlzLmVycm9yCiAgICB9OwogIH0KCn0KCmV4cG9ydHMuRXJyb3JGb250ID0gRXJyb3JGb250OwoKLyoqKi8gfSksCi8qIDE2MCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuQ0ZGVG9wRGljdCA9IGV4cG9ydHMuQ0ZGU3RyaW5ncyA9IGV4cG9ydHMuQ0ZGU3RhbmRhcmRTdHJpbmdzID0gZXhwb3J0cy5DRkZQcml2YXRlRGljdCA9IGV4cG9ydHMuQ0ZGUGFyc2VyID0gZXhwb3J0cy5DRkZJbmRleCA9IGV4cG9ydHMuQ0ZGSGVhZGVyID0gZXhwb3J0cy5DRkZGRFNlbGVjdCA9IGV4cG9ydHMuQ0ZGQ29tcGlsZXIgPSBleHBvcnRzLkNGRkNoYXJzZXQgPSBleHBvcnRzLkNGRiA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NoYXJzZXRzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjEpOwoKdmFyIF9lbmNvZGluZ3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2Mik7Cgpjb25zdCBNQVhfU1VCUl9ORVNUSU5HID0gMTA7CmNvbnN0IENGRlN0YW5kYXJkU3RyaW5ncyA9IFsiLm5vdGRlZiIsICJzcGFjZSIsICJleGNsYW0iLCAicXVvdGVkYmwiLCAibnVtYmVyc2lnbiIsICJkb2xsYXIiLCAicGVyY2VudCIsICJhbXBlcnNhbmQiLCAicXVvdGVyaWdodCIsICJwYXJlbmxlZnQiLCAicGFyZW5yaWdodCIsICJhc3RlcmlzayIsICJwbHVzIiwgImNvbW1hIiwgImh5cGhlbiIsICJwZXJpb2QiLCAic2xhc2giLCAiemVybyIsICJvbmUiLCAidHdvIiwgInRocmVlIiwgImZvdXIiLCAiZml2ZSIsICJzaXgiLCAic2V2ZW4iLCAiZWlnaHQiLCAibmluZSIsICJjb2xvbiIsICJzZW1pY29sb24iLCAibGVzcyIsICJlcXVhbCIsICJncmVhdGVyIiwgInF1ZXN0aW9uIiwgImF0IiwgIkEiLCAiQiIsICJDIiwgIkQiLCAiRSIsICJGIiwgIkciLCAiSCIsICJJIiwgIkoiLCAiSyIsICJMIiwgIk0iLCAiTiIsICJPIiwgIlAiLCAiUSIsICJSIiwgIlMiLCAiVCIsICJVIiwgIlYiLCAiVyIsICJYIiwgIlkiLCAiWiIsICJicmFja2V0bGVmdCIsICJiYWNrc2xhc2giLCAiYnJhY2tldHJpZ2h0IiwgImFzY2lpY2lyY3VtIiwgInVuZGVyc2NvcmUiLCAicXVvdGVsZWZ0IiwgImEiLCAiYiIsICJjIiwgImQiLCAiZSIsICJmIiwgImciLCAiaCIsICJpIiwgImoiLCAiayIsICJsIiwgIm0iLCAibiIsICJvIiwgInAiLCAicSIsICJyIiwgInMiLCAidCIsICJ1IiwgInYiLCAidyIsICJ4IiwgInkiLCAieiIsICJicmFjZWxlZnQiLCAiYmFyIiwgImJyYWNlcmlnaHQiLCAiYXNjaWl0aWxkZSIsICJleGNsYW1kb3duIiwgImNlbnQiLCAic3RlcmxpbmciLCAiZnJhY3Rpb24iLCAieWVuIiwgImZsb3JpbiIsICJzZWN0aW9uIiwgImN1cnJlbmN5IiwgInF1b3Rlc2luZ2xlIiwgInF1b3RlZGJsbGVmdCIsICJndWlsbGVtb3RsZWZ0IiwgImd1aWxzaW5nbGxlZnQiLCAiZ3VpbHNpbmdscmlnaHQiLCAiZmkiLCAiZmwiLCAiZW5kYXNoIiwgImRhZ2dlciIsICJkYWdnZXJkYmwiLCAicGVyaW9kY2VudGVyZWQiLCAicGFyYWdyYXBoIiwgImJ1bGxldCIsICJxdW90ZXNpbmdsYmFzZSIsICJxdW90ZWRibGJhc2UiLCAicXVvdGVkYmxyaWdodCIsICJndWlsbGVtb3RyaWdodCIsICJlbGxpcHNpcyIsICJwZXJ0aG91c2FuZCIsICJxdWVzdGlvbmRvd24iLCAiZ3JhdmUiLCAiYWN1dGUiLCAiY2lyY3VtZmxleCIsICJ0aWxkZSIsICJtYWNyb24iLCAiYnJldmUiLCAiZG90YWNjZW50IiwgImRpZXJlc2lzIiwgInJpbmciLCAiY2VkaWxsYSIsICJodW5nYXJ1bWxhdXQiLCAib2dvbmVrIiwgImNhcm9uIiwgImVtZGFzaCIsICJBRSIsICJvcmRmZW1pbmluZSIsICJMc2xhc2giLCAiT3NsYXNoIiwgIk9FIiwgIm9yZG1hc2N1bGluZSIsICJhZSIsICJkb3RsZXNzaSIsICJsc2xhc2giLCAib3NsYXNoIiwgIm9lIiwgImdlcm1hbmRibHMiLCAib25lc3VwZXJpb3IiLCAibG9naWNhbG5vdCIsICJtdSIsICJ0cmFkZW1hcmsiLCAiRXRoIiwgIm9uZWhhbGYiLCAicGx1c21pbnVzIiwgIlRob3JuIiwgIm9uZXF1YXJ0ZXIiLCAiZGl2aWRlIiwgImJyb2tlbmJhciIsICJkZWdyZWUiLCAidGhvcm4iLCAidGhyZWVxdWFydGVycyIsICJ0d29zdXBlcmlvciIsICJyZWdpc3RlcmVkIiwgIm1pbnVzIiwgImV0aCIsICJtdWx0aXBseSIsICJ0aHJlZXN1cGVyaW9yIiwgImNvcHlyaWdodCIsICJBYWN1dGUiLCAiQWNpcmN1bWZsZXgiLCAiQWRpZXJlc2lzIiwgIkFncmF2ZSIsICJBcmluZyIsICJBdGlsZGUiLCAiQ2NlZGlsbGEiLCAiRWFjdXRlIiwgIkVjaXJjdW1mbGV4IiwgIkVkaWVyZXNpcyIsICJFZ3JhdmUiLCAiSWFjdXRlIiwgIkljaXJjdW1mbGV4IiwgIklkaWVyZXNpcyIsICJJZ3JhdmUiLCAiTnRpbGRlIiwgIk9hY3V0ZSIsICJPY2lyY3VtZmxleCIsICJPZGllcmVzaXMiLCAiT2dyYXZlIiwgIk90aWxkZSIsICJTY2Fyb24iLCAiVWFjdXRlIiwgIlVjaXJjdW1mbGV4IiwgIlVkaWVyZXNpcyIsICJVZ3JhdmUiLCAiWWFjdXRlIiwgIllkaWVyZXNpcyIsICJaY2Fyb24iLCAiYWFjdXRlIiwgImFjaXJjdW1mbGV4IiwgImFkaWVyZXNpcyIsICJhZ3JhdmUiLCAiYXJpbmciLCAiYXRpbGRlIiwgImNjZWRpbGxhIiwgImVhY3V0ZSIsICJlY2lyY3VtZmxleCIsICJlZGllcmVzaXMiLCAiZWdyYXZlIiwgImlhY3V0ZSIsICJpY2lyY3VtZmxleCIsICJpZGllcmVzaXMiLCAiaWdyYXZlIiwgIm50aWxkZSIsICJvYWN1dGUiLCAib2NpcmN1bWZsZXgiLCAib2RpZXJlc2lzIiwgIm9ncmF2ZSIsICJvdGlsZGUiLCAic2Nhcm9uIiwgInVhY3V0ZSIsICJ1Y2lyY3VtZmxleCIsICJ1ZGllcmVzaXMiLCAidWdyYXZlIiwgInlhY3V0ZSIsICJ5ZGllcmVzaXMiLCAiemNhcm9uIiwgImV4Y2xhbXNtYWxsIiwgIkh1bmdhcnVtbGF1dHNtYWxsIiwgImRvbGxhcm9sZHN0eWxlIiwgImRvbGxhcnN1cGVyaW9yIiwgImFtcGVyc2FuZHNtYWxsIiwgIkFjdXRlc21hbGwiLCAicGFyZW5sZWZ0c3VwZXJpb3IiLCAicGFyZW5yaWdodHN1cGVyaW9yIiwgInR3b2RvdGVubGVhZGVyIiwgIm9uZWRvdGVubGVhZGVyIiwgInplcm9vbGRzdHlsZSIsICJvbmVvbGRzdHlsZSIsICJ0d29vbGRzdHlsZSIsICJ0aHJlZW9sZHN0eWxlIiwgImZvdXJvbGRzdHlsZSIsICJmaXZlb2xkc3R5bGUiLCAic2l4b2xkc3R5bGUiLCAic2V2ZW5vbGRzdHlsZSIsICJlaWdodG9sZHN0eWxlIiwgIm5pbmVvbGRzdHlsZSIsICJjb21tYXN1cGVyaW9yIiwgInRocmVlcXVhcnRlcnNlbWRhc2giLCAicGVyaW9kc3VwZXJpb3IiLCAicXVlc3Rpb25zbWFsbCIsICJhc3VwZXJpb3IiLCAiYnN1cGVyaW9yIiwgImNlbnRzdXBlcmlvciIsICJkc3VwZXJpb3IiLCAiZXN1cGVyaW9yIiwgImlzdXBlcmlvciIsICJsc3VwZXJpb3IiLCAibXN1cGVyaW9yIiwgIm5zdXBlcmlvciIsICJvc3VwZXJpb3IiLCAicnN1cGVyaW9yIiwgInNzdXBlcmlvciIsICJ0c3VwZXJpb3IiLCAiZmYiLCAiZmZpIiwgImZmbCIsICJwYXJlbmxlZnRpbmZlcmlvciIsICJwYXJlbnJpZ2h0aW5mZXJpb3IiLCAiQ2lyY3VtZmxleHNtYWxsIiwgImh5cGhlbnN1cGVyaW9yIiwgIkdyYXZlc21hbGwiLCAiQXNtYWxsIiwgIkJzbWFsbCIsICJDc21hbGwiLCAiRHNtYWxsIiwgIkVzbWFsbCIsICJGc21hbGwiLCAiR3NtYWxsIiwgIkhzbWFsbCIsICJJc21hbGwiLCAiSnNtYWxsIiwgIktzbWFsbCIsICJMc21hbGwiLCAiTXNtYWxsIiwgIk5zbWFsbCIsICJPc21hbGwiLCAiUHNtYWxsIiwgIlFzbWFsbCIsICJSc21hbGwiLCAiU3NtYWxsIiwgIlRzbWFsbCIsICJVc21hbGwiLCAiVnNtYWxsIiwgIldzbWFsbCIsICJYc21hbGwiLCAiWXNtYWxsIiwgIlpzbWFsbCIsICJjb2xvbm1vbmV0YXJ5IiwgIm9uZWZpdHRlZCIsICJydXBpYWgiLCAiVGlsZGVzbWFsbCIsICJleGNsYW1kb3duc21hbGwiLCAiY2VudG9sZHN0eWxlIiwgIkxzbGFzaHNtYWxsIiwgIlNjYXJvbnNtYWxsIiwgIlpjYXJvbnNtYWxsIiwgIkRpZXJlc2lzc21hbGwiLCAiQnJldmVzbWFsbCIsICJDYXJvbnNtYWxsIiwgIkRvdGFjY2VudHNtYWxsIiwgIk1hY3JvbnNtYWxsIiwgImZpZ3VyZWRhc2giLCAiaHlwaGVuaW5mZXJpb3IiLCAiT2dvbmVrc21hbGwiLCAiUmluZ3NtYWxsIiwgIkNlZGlsbGFzbWFsbCIsICJxdWVzdGlvbmRvd25zbWFsbCIsICJvbmVlaWdodGgiLCAidGhyZWVlaWdodGhzIiwgImZpdmVlaWdodGhzIiwgInNldmVuZWlnaHRocyIsICJvbmV0aGlyZCIsICJ0d290aGlyZHMiLCAiemVyb3N1cGVyaW9yIiwgImZvdXJzdXBlcmlvciIsICJmaXZlc3VwZXJpb3IiLCAic2l4c3VwZXJpb3IiLCAic2V2ZW5zdXBlcmlvciIsICJlaWdodHN1cGVyaW9yIiwgIm5pbmVzdXBlcmlvciIsICJ6ZXJvaW5mZXJpb3IiLCAib25laW5mZXJpb3IiLCAidHdvaW5mZXJpb3IiLCAidGhyZWVpbmZlcmlvciIsICJmb3VyaW5mZXJpb3IiLCAiZml2ZWluZmVyaW9yIiwgInNpeGluZmVyaW9yIiwgInNldmVuaW5mZXJpb3IiLCAiZWlnaHRpbmZlcmlvciIsICJuaW5laW5mZXJpb3IiLCAiY2VudGluZmVyaW9yIiwgImRvbGxhcmluZmVyaW9yIiwgInBlcmlvZGluZmVyaW9yIiwgImNvbW1haW5mZXJpb3IiLCAiQWdyYXZlc21hbGwiLCAiQWFjdXRlc21hbGwiLCAiQWNpcmN1bWZsZXhzbWFsbCIsICJBdGlsZGVzbWFsbCIsICJBZGllcmVzaXNzbWFsbCIsICJBcmluZ3NtYWxsIiwgIkFFc21hbGwiLCAiQ2NlZGlsbGFzbWFsbCIsICJFZ3JhdmVzbWFsbCIsICJFYWN1dGVzbWFsbCIsICJFY2lyY3VtZmxleHNtYWxsIiwgIkVkaWVyZXNpc3NtYWxsIiwgIklncmF2ZXNtYWxsIiwgIklhY3V0ZXNtYWxsIiwgIkljaXJjdW1mbGV4c21hbGwiLCAiSWRpZXJlc2lzc21hbGwiLCAiRXRoc21hbGwiLCAiTnRpbGRlc21hbGwiLCAiT2dyYXZlc21hbGwiLCAiT2FjdXRlc21hbGwiLCAiT2NpcmN1bWZsZXhzbWFsbCIsICJPdGlsZGVzbWFsbCIsICJPZGllcmVzaXNzbWFsbCIsICJPRXNtYWxsIiwgIk9zbGFzaHNtYWxsIiwgIlVncmF2ZXNtYWxsIiwgIlVhY3V0ZXNtYWxsIiwgIlVjaXJjdW1mbGV4c21hbGwiLCAiVWRpZXJlc2lzc21hbGwiLCAiWWFjdXRlc21hbGwiLCAiVGhvcm5zbWFsbCIsICJZZGllcmVzaXNzbWFsbCIsICIwMDEuMDAwIiwgIjAwMS4wMDEiLCAiMDAxLjAwMiIsICIwMDEuMDAzIiwgIkJsYWNrIiwgIkJvbGQiLCAiQm9vayIsICJMaWdodCIsICJNZWRpdW0iLCAiUmVndWxhciIsICJSb21hbiIsICJTZW1pYm9sZCJdOwpleHBvcnRzLkNGRlN0YW5kYXJkU3RyaW5ncyA9IENGRlN0YW5kYXJkU3RyaW5nczsKY29uc3QgTlVNX1NUQU5EQVJEX0NGRl9TVFJJTkdTID0gMzkxOwpjb25zdCBDaGFyc3RyaW5nVmFsaWRhdGlvbkRhdGEgPSBbbnVsbCwgewogIGlkOiAiaHN0ZW0iLAogIG1pbjogMiwKICBzdGFja0NsZWFyaW5nOiB0cnVlLAogIHN0ZW06IHRydWUKfSwgbnVsbCwgewogIGlkOiAidnN0ZW0iLAogIG1pbjogMiwKICBzdGFja0NsZWFyaW5nOiB0cnVlLAogIHN0ZW06IHRydWUKfSwgewogIGlkOiAidm1vdmV0byIsCiAgbWluOiAxLAogIHN0YWNrQ2xlYXJpbmc6IHRydWUKfSwgewogIGlkOiAicmxpbmV0byIsCiAgbWluOiAyLAogIHJlc2V0U3RhY2s6IHRydWUKfSwgewogIGlkOiAiaGxpbmV0byIsCiAgbWluOiAxLAogIHJlc2V0U3RhY2s6IHRydWUKfSwgewogIGlkOiAidmxpbmV0byIsCiAgbWluOiAxLAogIHJlc2V0U3RhY2s6IHRydWUKfSwgewogIGlkOiAicnJjdXJ2ZXRvIiwKICBtaW46IDYsCiAgcmVzZXRTdGFjazogdHJ1ZQp9LCBudWxsLCB7CiAgaWQ6ICJjYWxsc3ViciIsCiAgbWluOiAxLAogIHVuZGVmU3RhY2s6IHRydWUKfSwgewogIGlkOiAicmV0dXJuIiwKICBtaW46IDAsCiAgdW5kZWZTdGFjazogdHJ1ZQp9LCBudWxsLCBudWxsLCB7CiAgaWQ6ICJlbmRjaGFyIiwKICBtaW46IDAsCiAgc3RhY2tDbGVhcmluZzogdHJ1ZQp9LCBudWxsLCBudWxsLCBudWxsLCB7CiAgaWQ6ICJoc3RlbWhtIiwKICBtaW46IDIsCiAgc3RhY2tDbGVhcmluZzogdHJ1ZSwKICBzdGVtOiB0cnVlCn0sIHsKICBpZDogImhpbnRtYXNrIiwKICBtaW46IDAsCiAgc3RhY2tDbGVhcmluZzogdHJ1ZQp9LCB7CiAgaWQ6ICJjbnRybWFzayIsCiAgbWluOiAwLAogIHN0YWNrQ2xlYXJpbmc6IHRydWUKfSwgewogIGlkOiAicm1vdmV0byIsCiAgbWluOiAyLAogIHN0YWNrQ2xlYXJpbmc6IHRydWUKfSwgewogIGlkOiAiaG1vdmV0byIsCiAgbWluOiAxLAogIHN0YWNrQ2xlYXJpbmc6IHRydWUKfSwgewogIGlkOiAidnN0ZW1obSIsCiAgbWluOiAyLAogIHN0YWNrQ2xlYXJpbmc6IHRydWUsCiAgc3RlbTogdHJ1ZQp9LCB7CiAgaWQ6ICJyY3VydmVsaW5lIiwKICBtaW46IDgsCiAgcmVzZXRTdGFjazogdHJ1ZQp9LCB7CiAgaWQ6ICJybGluZWN1cnZlIiwKICBtaW46IDgsCiAgcmVzZXRTdGFjazogdHJ1ZQp9LCB7CiAgaWQ6ICJ2dmN1cnZldG8iLAogIG1pbjogNCwKICByZXNldFN0YWNrOiB0cnVlCn0sIHsKICBpZDogImhoY3VydmV0byIsCiAgbWluOiA0LAogIHJlc2V0U3RhY2s6IHRydWUKfSwgbnVsbCwgewogIGlkOiAiY2FsbGdzdWJyIiwKICBtaW46IDEsCiAgdW5kZWZTdGFjazogdHJ1ZQp9LCB7CiAgaWQ6ICJ2aGN1cnZldG8iLAogIG1pbjogNCwKICByZXNldFN0YWNrOiB0cnVlCn0sIHsKICBpZDogImh2Y3VydmV0byIsCiAgbWluOiA0LAogIHJlc2V0U3RhY2s6IHRydWUKfV07CmNvbnN0IENoYXJzdHJpbmdWYWxpZGF0aW9uRGF0YTEyID0gW251bGwsIG51bGwsIG51bGwsIHsKICBpZDogImFuZCIsCiAgbWluOiAyLAogIHN0YWNrRGVsdGE6IC0xCn0sIHsKICBpZDogIm9yIiwKICBtaW46IDIsCiAgc3RhY2tEZWx0YTogLTEKfSwgewogIGlkOiAibm90IiwKICBtaW46IDEsCiAgc3RhY2tEZWx0YTogMAp9LCBudWxsLCBudWxsLCBudWxsLCB7CiAgaWQ6ICJhYnMiLAogIG1pbjogMSwKICBzdGFja0RlbHRhOiAwCn0sIHsKICBpZDogImFkZCIsCiAgbWluOiAyLAogIHN0YWNrRGVsdGE6IC0xLAoKICBzdGFja0ZuKHN0YWNrLCBpbmRleCkgewogICAgc3RhY2tbaW5kZXggLSAyXSA9IHN0YWNrW2luZGV4IC0gMl0gKyBzdGFja1tpbmRleCAtIDFdOwogIH0KCn0sIHsKICBpZDogInN1YiIsCiAgbWluOiAyLAogIHN0YWNrRGVsdGE6IC0xLAoKICBzdGFja0ZuKHN0YWNrLCBpbmRleCkgewogICAgc3RhY2tbaW5kZXggLSAyXSA9IHN0YWNrW2luZGV4IC0gMl0gLSBzdGFja1tpbmRleCAtIDFdOwogIH0KCn0sIHsKICBpZDogImRpdiIsCiAgbWluOiAyLAogIHN0YWNrRGVsdGE6IC0xLAoKICBzdGFja0ZuKHN0YWNrLCBpbmRleCkgewogICAgc3RhY2tbaW5kZXggLSAyXSA9IHN0YWNrW2luZGV4IC0gMl0gLyBzdGFja1tpbmRleCAtIDFdOwogIH0KCn0sIG51bGwsIHsKICBpZDogIm5lZyIsCiAgbWluOiAxLAogIHN0YWNrRGVsdGE6IDAsCgogIHN0YWNrRm4oc3RhY2ssIGluZGV4KSB7CiAgICBzdGFja1tpbmRleCAtIDFdID0gLXN0YWNrW2luZGV4IC0gMV07CiAgfQoKfSwgewogIGlkOiAiZXEiLAogIG1pbjogMiwKICBzdGFja0RlbHRhOiAtMQp9LCBudWxsLCBudWxsLCB7CiAgaWQ6ICJkcm9wIiwKICBtaW46IDEsCiAgc3RhY2tEZWx0YTogLTEKfSwgbnVsbCwgewogIGlkOiAicHV0IiwKICBtaW46IDIsCiAgc3RhY2tEZWx0YTogLTIKfSwgewogIGlkOiAiZ2V0IiwKICBtaW46IDEsCiAgc3RhY2tEZWx0YTogMAp9LCB7CiAgaWQ6ICJpZmVsc2UiLAogIG1pbjogNCwKICBzdGFja0RlbHRhOiAtMwp9LCB7CiAgaWQ6ICJyYW5kb20iLAogIG1pbjogMCwKICBzdGFja0RlbHRhOiAxCn0sIHsKICBpZDogIm11bCIsCiAgbWluOiAyLAogIHN0YWNrRGVsdGE6IC0xLAoKICBzdGFja0ZuKHN0YWNrLCBpbmRleCkgewogICAgc3RhY2tbaW5kZXggLSAyXSA9IHN0YWNrW2luZGV4IC0gMl0gKiBzdGFja1tpbmRleCAtIDFdOwogIH0KCn0sIG51bGwsIHsKICBpZDogInNxcnQiLAogIG1pbjogMSwKICBzdGFja0RlbHRhOiAwCn0sIHsKICBpZDogImR1cCIsCiAgbWluOiAxLAogIHN0YWNrRGVsdGE6IDEKfSwgewogIGlkOiAiZXhjaCIsCiAgbWluOiAyLAogIHN0YWNrRGVsdGE6IDAKfSwgewogIGlkOiAiaW5kZXgiLAogIG1pbjogMiwKICBzdGFja0RlbHRhOiAwCn0sIHsKICBpZDogInJvbGwiLAogIG1pbjogMywKICBzdGFja0RlbHRhOiAtMgp9LCBudWxsLCBudWxsLCBudWxsLCB7CiAgaWQ6ICJoZmxleCIsCiAgbWluOiA3LAogIHJlc2V0U3RhY2s6IHRydWUKfSwgewogIGlkOiAiZmxleCIsCiAgbWluOiAxMywKICByZXNldFN0YWNrOiB0cnVlCn0sIHsKICBpZDogImhmbGV4MSIsCiAgbWluOiA5LAogIHJlc2V0U3RhY2s6IHRydWUKfSwgewogIGlkOiAiZmxleDEiLAogIG1pbjogMTEsCiAgcmVzZXRTdGFjazogdHJ1ZQp9XTsKCmNsYXNzIENGRlBhcnNlciB7CiAgY29uc3RydWN0b3IoZmlsZSwgcHJvcGVydGllcywgc2VhY0FuYWx5c2lzRW5hYmxlZCkgewogICAgdGhpcy5ieXRlcyA9IGZpbGUuZ2V0Qnl0ZXMoKTsKICAgIHRoaXMucHJvcGVydGllcyA9IHByb3BlcnRpZXM7CiAgICB0aGlzLnNlYWNBbmFseXNpc0VuYWJsZWQgPSAhIXNlYWNBbmFseXNpc0VuYWJsZWQ7CiAgfQoKICBwYXJzZSgpIHsKICAgIGNvbnN0IHByb3BlcnRpZXMgPSB0aGlzLnByb3BlcnRpZXM7CiAgICBjb25zdCBjZmYgPSBuZXcgQ0ZGKCk7CiAgICB0aGlzLmNmZiA9IGNmZjsKICAgIGNvbnN0IGhlYWRlciA9IHRoaXMucGFyc2VIZWFkZXIoKTsKICAgIGNvbnN0IG5hbWVJbmRleCA9IHRoaXMucGFyc2VJbmRleChoZWFkZXIuZW5kUG9zKTsKICAgIGNvbnN0IHRvcERpY3RJbmRleCA9IHRoaXMucGFyc2VJbmRleChuYW1lSW5kZXguZW5kUG9zKTsKICAgIGNvbnN0IHN0cmluZ0luZGV4ID0gdGhpcy5wYXJzZUluZGV4KHRvcERpY3RJbmRleC5lbmRQb3MpOwogICAgY29uc3QgZ2xvYmFsU3VickluZGV4ID0gdGhpcy5wYXJzZUluZGV4KHN0cmluZ0luZGV4LmVuZFBvcyk7CiAgICBjb25zdCB0b3BEaWN0UGFyc2VkID0gdGhpcy5wYXJzZURpY3QodG9wRGljdEluZGV4Lm9iai5nZXQoMCkpOwogICAgY29uc3QgdG9wRGljdCA9IHRoaXMuY3JlYXRlRGljdChDRkZUb3BEaWN0LCB0b3BEaWN0UGFyc2VkLCBjZmYuc3RyaW5ncyk7CiAgICBjZmYuaGVhZGVyID0gaGVhZGVyLm9iajsKICAgIGNmZi5uYW1lcyA9IHRoaXMucGFyc2VOYW1lSW5kZXgobmFtZUluZGV4Lm9iaik7CiAgICBjZmYuc3RyaW5ncyA9IHRoaXMucGFyc2VTdHJpbmdJbmRleChzdHJpbmdJbmRleC5vYmopOwogICAgY2ZmLnRvcERpY3QgPSB0b3BEaWN0OwogICAgY2ZmLmdsb2JhbFN1YnJJbmRleCA9IGdsb2JhbFN1YnJJbmRleC5vYmo7CiAgICB0aGlzLnBhcnNlUHJpdmF0ZURpY3QoY2ZmLnRvcERpY3QpOwogICAgY2ZmLmlzQ0lERm9udCA9IHRvcERpY3QuaGFzTmFtZSgiUk9TIik7CiAgICBjb25zdCBjaGFyU3RyaW5nT2Zmc2V0ID0gdG9wRGljdC5nZXRCeU5hbWUoIkNoYXJTdHJpbmdzIik7CiAgICBjb25zdCBjaGFyU3RyaW5nSW5kZXggPSB0aGlzLnBhcnNlSW5kZXgoY2hhclN0cmluZ09mZnNldCkub2JqOwogICAgY29uc3QgZm9udE1hdHJpeCA9IHRvcERpY3QuZ2V0QnlOYW1lKCJGb250TWF0cml4Iik7CgogICAgaWYgKGZvbnRNYXRyaXgpIHsKICAgICAgcHJvcGVydGllcy5mb250TWF0cml4ID0gZm9udE1hdHJpeDsKICAgIH0KCiAgICBjb25zdCBmb250QkJveCA9IHRvcERpY3QuZ2V0QnlOYW1lKCJGb250QkJveCIpOwoKICAgIGlmIChmb250QkJveCkgewogICAgICBwcm9wZXJ0aWVzLmFzY2VudCA9IE1hdGgubWF4KGZvbnRCQm94WzNdLCBmb250QkJveFsxXSk7CiAgICAgIHByb3BlcnRpZXMuZGVzY2VudCA9IE1hdGgubWluKGZvbnRCQm94WzFdLCBmb250QkJveFszXSk7CiAgICAgIHByb3BlcnRpZXMuYXNjZW50U2NhbGVkID0gdHJ1ZTsKICAgIH0KCiAgICBsZXQgY2hhcnNldCwgZW5jb2Rpbmc7CgogICAgaWYgKGNmZi5pc0NJREZvbnQpIHsKICAgICAgY29uc3QgZmRBcnJheUluZGV4ID0gdGhpcy5wYXJzZUluZGV4KHRvcERpY3QuZ2V0QnlOYW1lKCJGREFycmF5IikpLm9iajsKCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGZkQXJyYXlJbmRleC5jb3VudDsgaSA8IGlpOyArK2kpIHsKICAgICAgICBjb25zdCBkaWN0UmF3ID0gZmRBcnJheUluZGV4LmdldChpKTsKICAgICAgICBjb25zdCBmb250RGljdCA9IHRoaXMuY3JlYXRlRGljdChDRkZUb3BEaWN0LCB0aGlzLnBhcnNlRGljdChkaWN0UmF3KSwgY2ZmLnN0cmluZ3MpOwogICAgICAgIHRoaXMucGFyc2VQcml2YXRlRGljdChmb250RGljdCk7CiAgICAgICAgY2ZmLmZkQXJyYXkucHVzaChmb250RGljdCk7CiAgICAgIH0KCiAgICAgIGVuY29kaW5nID0gbnVsbDsKICAgICAgY2hhcnNldCA9IHRoaXMucGFyc2VDaGFyc2V0cyh0b3BEaWN0LmdldEJ5TmFtZSgiY2hhcnNldCIpLCBjaGFyU3RyaW5nSW5kZXguY291bnQsIGNmZi5zdHJpbmdzLCB0cnVlKTsKICAgICAgY2ZmLmZkU2VsZWN0ID0gdGhpcy5wYXJzZUZEU2VsZWN0KHRvcERpY3QuZ2V0QnlOYW1lKCJGRFNlbGVjdCIpLCBjaGFyU3RyaW5nSW5kZXguY291bnQpOwogICAgfSBlbHNlIHsKICAgICAgY2hhcnNldCA9IHRoaXMucGFyc2VDaGFyc2V0cyh0b3BEaWN0LmdldEJ5TmFtZSgiY2hhcnNldCIpLCBjaGFyU3RyaW5nSW5kZXguY291bnQsIGNmZi5zdHJpbmdzLCBmYWxzZSk7CiAgICAgIGVuY29kaW5nID0gdGhpcy5wYXJzZUVuY29kaW5nKHRvcERpY3QuZ2V0QnlOYW1lKCJFbmNvZGluZyIpLCBwcm9wZXJ0aWVzLCBjZmYuc3RyaW5ncywgY2hhcnNldC5jaGFyc2V0KTsKICAgIH0KCiAgICBjZmYuY2hhcnNldCA9IGNoYXJzZXQ7CiAgICBjZmYuZW5jb2RpbmcgPSBlbmNvZGluZzsKICAgIGNvbnN0IGNoYXJTdHJpbmdzQW5kU2VhY3MgPSB0aGlzLnBhcnNlQ2hhclN0cmluZ3MoewogICAgICBjaGFyU3RyaW5nczogY2hhclN0cmluZ0luZGV4LAogICAgICBsb2NhbFN1YnJJbmRleDogdG9wRGljdC5wcml2YXRlRGljdC5zdWJyc0luZGV4LAogICAgICBnbG9iYWxTdWJySW5kZXg6IGdsb2JhbFN1YnJJbmRleC5vYmosCiAgICAgIGZkU2VsZWN0OiBjZmYuZmRTZWxlY3QsCiAgICAgIGZkQXJyYXk6IGNmZi5mZEFycmF5LAogICAgICBwcml2YXRlRGljdDogdG9wRGljdC5wcml2YXRlRGljdAogICAgfSk7CiAgICBjZmYuY2hhclN0cmluZ3MgPSBjaGFyU3RyaW5nc0FuZFNlYWNzLmNoYXJTdHJpbmdzOwogICAgY2ZmLnNlYWNzID0gY2hhclN0cmluZ3NBbmRTZWFjcy5zZWFjczsKICAgIGNmZi53aWR0aHMgPSBjaGFyU3RyaW5nc0FuZFNlYWNzLndpZHRoczsKICAgIHJldHVybiBjZmY7CiAgfQoKICBwYXJzZUhlYWRlcigpIHsKICAgIGxldCBieXRlcyA9IHRoaXMuYnl0ZXM7CiAgICBjb25zdCBieXRlc0xlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKICAgIGxldCBvZmZzZXQgPSAwOwoKICAgIHdoaWxlIChvZmZzZXQgPCBieXRlc0xlbmd0aCAmJiBieXRlc1tvZmZzZXRdICE9PSAxKSB7CiAgICAgICsrb2Zmc2V0OwogICAgfQoKICAgIGlmIChvZmZzZXQgPj0gYnl0ZXNMZW5ndGgpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIENGRiBoZWFkZXIiKTsKICAgIH0KCiAgICBpZiAob2Zmc2V0ICE9PSAwKSB7CiAgICAgICgwLCBfdXRpbC5pbmZvKSgiY2ZmIGRhdGEgaXMgc2hpZnRlZCIpOwogICAgICBieXRlcyA9IGJ5dGVzLnN1YmFycmF5KG9mZnNldCk7CiAgICAgIHRoaXMuYnl0ZXMgPSBieXRlczsKICAgIH0KCiAgICBjb25zdCBtYWpvciA9IGJ5dGVzWzBdOwogICAgY29uc3QgbWlub3IgPSBieXRlc1sxXTsKICAgIGNvbnN0IGhkclNpemUgPSBieXRlc1syXTsKICAgIGNvbnN0IG9mZlNpemUgPSBieXRlc1szXTsKICAgIGNvbnN0IGhlYWRlciA9IG5ldyBDRkZIZWFkZXIobWFqb3IsIG1pbm9yLCBoZHJTaXplLCBvZmZTaXplKTsKICAgIHJldHVybiB7CiAgICAgIG9iajogaGVhZGVyLAogICAgICBlbmRQb3M6IGhkclNpemUKICAgIH07CiAgfQoKICBwYXJzZURpY3QoZGljdCkgewogICAgbGV0IHBvcyA9IDA7CgogICAgZnVuY3Rpb24gcGFyc2VPcGVyYW5kKCkgewogICAgICBsZXQgdmFsdWUgPSBkaWN0W3BvcysrXTsKCiAgICAgIGlmICh2YWx1ZSA9PT0gMzApIHsKICAgICAgICByZXR1cm4gcGFyc2VGbG9hdE9wZXJhbmQoKTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gMjgpIHsKICAgICAgICB2YWx1ZSA9IGRpY3RbcG9zKytdOwogICAgICAgIHZhbHVlID0gKHZhbHVlIDw8IDI0IHwgZGljdFtwb3MrK10gPDwgMTYpID4+IDE2OwogICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gMjkpIHsKICAgICAgICB2YWx1ZSA9IGRpY3RbcG9zKytdOwogICAgICAgIHZhbHVlID0gdmFsdWUgPDwgOCB8IGRpY3RbcG9zKytdOwogICAgICAgIHZhbHVlID0gdmFsdWUgPDwgOCB8IGRpY3RbcG9zKytdOwogICAgICAgIHZhbHVlID0gdmFsdWUgPDwgOCB8IGRpY3RbcG9zKytdOwogICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSAzMiAmJiB2YWx1ZSA8PSAyNDYpIHsKICAgICAgICByZXR1cm4gdmFsdWUgLSAxMzk7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPj0gMjQ3ICYmIHZhbHVlIDw9IDI1MCkgewogICAgICAgIHJldHVybiAodmFsdWUgLSAyNDcpICogMjU2ICsgZGljdFtwb3MrK10gKyAxMDg7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPj0gMjUxICYmIHZhbHVlIDw9IDI1NCkgewogICAgICAgIHJldHVybiAtKCh2YWx1ZSAtIDI1MSkgKiAyNTYpIC0gZGljdFtwb3MrK10gLSAxMDg7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC53YXJuKSgnQ0ZGUGFyc2VyX3BhcnNlRGljdDogIicgKyB2YWx1ZSArICciIGlzIGEgcmVzZXJ2ZWQgY29tbWFuZC4nKTsKICAgICAgcmV0dXJuIE5hTjsKICAgIH0KCiAgICBmdW5jdGlvbiBwYXJzZUZsb2F0T3BlcmFuZCgpIHsKICAgICAgbGV0IHN0ciA9ICIiOwogICAgICBjb25zdCBlb2YgPSAxNTsKICAgICAgY29uc3QgbG9va3VwID0gWyIwIiwgIjEiLCAiMiIsICIzIiwgIjQiLCAiNSIsICI2IiwgIjciLCAiOCIsICI5IiwgIi4iLCAiRSIsICJFLSIsIG51bGwsICItIl07CiAgICAgIGNvbnN0IGxlbmd0aCA9IGRpY3QubGVuZ3RoOwoKICAgICAgd2hpbGUgKHBvcyA8IGxlbmd0aCkgewogICAgICAgIGNvbnN0IGIgPSBkaWN0W3BvcysrXTsKICAgICAgICBjb25zdCBiMSA9IGIgPj4gNDsKICAgICAgICBjb25zdCBiMiA9IGIgJiAxNTsKCiAgICAgICAgaWYgKGIxID09PSBlb2YpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgc3RyICs9IGxvb2t1cFtiMV07CgogICAgICAgIGlmIChiMiA9PT0gZW9mKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHN0ciArPSBsb29rdXBbYjJdOwogICAgICB9CgogICAgICByZXR1cm4gcGFyc2VGbG9hdChzdHIpOwogICAgfQoKICAgIGxldCBvcGVyYW5kcyA9IFtdOwogICAgY29uc3QgZW50cmllcyA9IFtdOwogICAgcG9zID0gMDsKICAgIGNvbnN0IGVuZCA9IGRpY3QubGVuZ3RoOwoKICAgIHdoaWxlIChwb3MgPCBlbmQpIHsKICAgICAgbGV0IGIgPSBkaWN0W3Bvc107CgogICAgICBpZiAoYiA8PSAyMSkgewogICAgICAgIGlmIChiID09PSAxMikgewogICAgICAgICAgYiA9IGIgPDwgOCB8IGRpY3RbKytwb3NdOwogICAgICAgIH0KCiAgICAgICAgZW50cmllcy5wdXNoKFtiLCBvcGVyYW5kc10pOwogICAgICAgIG9wZXJhbmRzID0gW107CiAgICAgICAgKytwb3M7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb3BlcmFuZHMucHVzaChwYXJzZU9wZXJhbmQoKSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZW50cmllczsKICB9CgogIHBhcnNlSW5kZXgocG9zKSB7CiAgICBjb25zdCBjZmZJbmRleCA9IG5ldyBDRkZJbmRleCgpOwogICAgY29uc3QgYnl0ZXMgPSB0aGlzLmJ5dGVzOwogICAgY29uc3QgY291bnQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKICAgIGNvbnN0IG9mZnNldHMgPSBbXTsKICAgIGxldCBlbmQgPSBwb3M7CiAgICBsZXQgaSwgaWk7CgogICAgaWYgKGNvdW50ICE9PSAwKSB7CiAgICAgIGNvbnN0IG9mZnNldFNpemUgPSBieXRlc1twb3MrK107CiAgICAgIGNvbnN0IHN0YXJ0UG9zID0gcG9zICsgKGNvdW50ICsgMSkgKiBvZmZzZXRTaXplIC0gMTsKCiAgICAgIGZvciAoaSA9IDAsIGlpID0gY291bnQgKyAxOyBpIDwgaWk7ICsraSkgewogICAgICAgIGxldCBvZmZzZXQgPSAwOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG9mZnNldFNpemU7ICsraikgewogICAgICAgICAgb2Zmc2V0IDw8PSA4OwogICAgICAgICAgb2Zmc2V0ICs9IGJ5dGVzW3BvcysrXTsKICAgICAgICB9CgogICAgICAgIG9mZnNldHMucHVzaChzdGFydFBvcyArIG9mZnNldCk7CiAgICAgIH0KCiAgICAgIGVuZCA9IG9mZnNldHNbY291bnRdOwogICAgfQoKICAgIGZvciAoaSA9IDAsIGlpID0gb2Zmc2V0cy5sZW5ndGggLSAxOyBpIDwgaWk7ICsraSkgewogICAgICBjb25zdCBvZmZzZXRTdGFydCA9IG9mZnNldHNbaV07CiAgICAgIGNvbnN0IG9mZnNldEVuZCA9IG9mZnNldHNbaSArIDFdOwogICAgICBjZmZJbmRleC5hZGQoYnl0ZXMuc3ViYXJyYXkob2Zmc2V0U3RhcnQsIG9mZnNldEVuZCkpOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIG9iajogY2ZmSW5kZXgsCiAgICAgIGVuZFBvczogZW5kCiAgICB9OwogIH0KCiAgcGFyc2VOYW1lSW5kZXgoaW5kZXgpIHsKICAgIGNvbnN0IG5hbWVzID0gW107CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gaW5kZXguY291bnQ7IGkgPCBpaTsgKytpKSB7CiAgICAgIGNvbnN0IG5hbWUgPSBpbmRleC5nZXQoaSk7CiAgICAgIG5hbWVzLnB1c2goKDAsIF91dGlsLmJ5dGVzVG9TdHJpbmcpKG5hbWUpKTsKICAgIH0KCiAgICByZXR1cm4gbmFtZXM7CiAgfQoKICBwYXJzZVN0cmluZ0luZGV4KGluZGV4KSB7CiAgICBjb25zdCBzdHJpbmdzID0gbmV3IENGRlN0cmluZ3MoKTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBpbmRleC5jb3VudDsgaSA8IGlpOyArK2kpIHsKICAgICAgY29uc3QgZGF0YSA9IGluZGV4LmdldChpKTsKICAgICAgc3RyaW5ncy5hZGQoKDAsIF91dGlsLmJ5dGVzVG9TdHJpbmcpKGRhdGEpKTsKICAgIH0KCiAgICByZXR1cm4gc3RyaW5nczsKICB9CgogIGNyZWF0ZURpY3QoVHlwZSwgZGljdCwgc3RyaW5ncykgewogICAgY29uc3QgY2ZmRGljdCA9IG5ldyBUeXBlKHN0cmluZ3MpOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGRpY3QubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICBjb25zdCBwYWlyID0gZGljdFtpXTsKICAgICAgY29uc3Qga2V5ID0gcGFpclswXTsKICAgICAgY29uc3QgdmFsdWUgPSBwYWlyWzFdOwogICAgICBjZmZEaWN0LnNldEJ5S2V5KGtleSwgdmFsdWUpOwogICAgfQoKICAgIHJldHVybiBjZmZEaWN0OwogIH0KCiAgcGFyc2VDaGFyU3RyaW5nKHN0YXRlLCBkYXRhLCBsb2NhbFN1YnJJbmRleCwgZ2xvYmFsU3VickluZGV4KSB7CiAgICBpZiAoIWRhdGEgfHwgc3RhdGUuY2FsbERlcHRoID4gTUFYX1NVQlJfTkVTVElORykgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgbGV0IHN0YWNrU2l6ZSA9IHN0YXRlLnN0YWNrU2l6ZTsKICAgIGNvbnN0IHN0YWNrID0gc3RhdGUuc3RhY2s7CiAgICBjb25zdCBsZW5ndGggPSBkYXRhLmxlbmd0aDsKCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGxlbmd0aDspIHsKICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW2orK107CiAgICAgIGxldCB2YWxpZGF0aW9uQ29tbWFuZCA9IG51bGw7CgogICAgICBpZiAodmFsdWUgPT09IDEyKSB7CiAgICAgICAgY29uc3QgcSA9IGRhdGFbaisrXTsKCiAgICAgICAgaWYgKHEgPT09IDApIHsKICAgICAgICAgIGRhdGFbaiAtIDJdID0gMTM5OwogICAgICAgICAgZGF0YVtqIC0gMV0gPSAyMjsKICAgICAgICAgIHN0YWNrU2l6ZSA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhbGlkYXRpb25Db21tYW5kID0gQ2hhcnN0cmluZ1ZhbGlkYXRpb25EYXRhMTJbcV07CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAyOCkgewogICAgICAgIHN0YWNrW3N0YWNrU2l6ZV0gPSAoZGF0YVtqXSA8PCAyNCB8IGRhdGFbaiArIDFdIDw8IDE2KSA+PiAxNjsKICAgICAgICBqICs9IDI7CiAgICAgICAgc3RhY2tTaXplKys7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IDE0KSB7CiAgICAgICAgaWYgKHN0YWNrU2l6ZSA+PSA0KSB7CiAgICAgICAgICBzdGFja1NpemUgLT0gNDsKCiAgICAgICAgICBpZiAodGhpcy5zZWFjQW5hbHlzaXNFbmFibGVkKSB7CiAgICAgICAgICAgIHN0YXRlLnNlYWMgPSBzdGFjay5zbGljZShzdGFja1NpemUsIHN0YWNrU2l6ZSArIDQpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YWxpZGF0aW9uQ29tbWFuZCA9IENoYXJzdHJpbmdWYWxpZGF0aW9uRGF0YVt2YWx1ZV07CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPj0gMzIgJiYgdmFsdWUgPD0gMjQ2KSB7CiAgICAgICAgc3RhY2tbc3RhY2tTaXplXSA9IHZhbHVlIC0gMTM5OwogICAgICAgIHN0YWNrU2l6ZSsrOwogICAgICB9IGVsc2UgaWYgKHZhbHVlID49IDI0NyAmJiB2YWx1ZSA8PSAyNTQpIHsKICAgICAgICBzdGFja1tzdGFja1NpemVdID0gdmFsdWUgPCAyNTEgPyAodmFsdWUgLSAyNDcgPDwgOCkgKyBkYXRhW2pdICsgMTA4IDogLSh2YWx1ZSAtIDI1MSA8PCA4KSAtIGRhdGFbal0gLSAxMDg7CiAgICAgICAgaisrOwogICAgICAgIHN0YWNrU2l6ZSsrOwogICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAyNTUpIHsKICAgICAgICBzdGFja1tzdGFja1NpemVdID0gKGRhdGFbal0gPDwgMjQgfCBkYXRhW2ogKyAxXSA8PCAxNiB8IGRhdGFbaiArIDJdIDw8IDggfCBkYXRhW2ogKyAzXSkgLyA2NTUzNjsKICAgICAgICBqICs9IDQ7CiAgICAgICAgc3RhY2tTaXplKys7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IDE5IHx8IHZhbHVlID09PSAyMCkgewogICAgICAgIHN0YXRlLmhpbnRzICs9IHN0YWNrU2l6ZSA+PiAxOwogICAgICAgIGogKz0gc3RhdGUuaGludHMgKyA3ID4+IDM7CiAgICAgICAgc3RhY2tTaXplICU9IDI7CiAgICAgICAgdmFsaWRhdGlvbkNvbW1hbmQgPSBDaGFyc3RyaW5nVmFsaWRhdGlvbkRhdGFbdmFsdWVdOwogICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAxMCB8fCB2YWx1ZSA9PT0gMjkpIHsKICAgICAgICBsZXQgc3VicnNJbmRleDsKCiAgICAgICAgaWYgKHZhbHVlID09PSAxMCkgewogICAgICAgICAgc3VicnNJbmRleCA9IGxvY2FsU3VickluZGV4OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdWJyc0luZGV4ID0gZ2xvYmFsU3VickluZGV4OwogICAgICAgIH0KCiAgICAgICAgaWYgKCFzdWJyc0luZGV4KSB7CiAgICAgICAgICB2YWxpZGF0aW9uQ29tbWFuZCA9IENoYXJzdHJpbmdWYWxpZGF0aW9uRGF0YVt2YWx1ZV07CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIk1pc3Npbmcgc3VicnNJbmRleCBmb3IgIiArIHZhbGlkYXRpb25Db21tYW5kLmlkKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGxldCBiaWFzID0gMzI3Njg7CgogICAgICAgIGlmIChzdWJyc0luZGV4LmNvdW50IDwgMTI0MCkgewogICAgICAgICAgYmlhcyA9IDEwNzsKICAgICAgICB9IGVsc2UgaWYgKHN1YnJzSW5kZXguY291bnQgPCAzMzkwMCkgewogICAgICAgICAgYmlhcyA9IDExMzE7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzdWJyTnVtYmVyID0gc3RhY2tbLS1zdGFja1NpemVdICsgYmlhczsKCiAgICAgICAgaWYgKHN1YnJOdW1iZXIgPCAwIHx8IHN1YnJOdW1iZXIgPj0gc3VicnNJbmRleC5jb3VudCB8fCBpc05hTihzdWJyTnVtYmVyKSkgewogICAgICAgICAgdmFsaWRhdGlvbkNvbW1hbmQgPSBDaGFyc3RyaW5nVmFsaWRhdGlvbkRhdGFbdmFsdWVdOwogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJPdXQgb2YgYm91bmRzIHN1YnJJbmRleCBmb3IgIiArIHZhbGlkYXRpb25Db21tYW5kLmlkKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHN0YXRlLnN0YWNrU2l6ZSA9IHN0YWNrU2l6ZTsKICAgICAgICBzdGF0ZS5jYWxsRGVwdGgrKzsKICAgICAgICBjb25zdCB2YWxpZCA9IHRoaXMucGFyc2VDaGFyU3RyaW5nKHN0YXRlLCBzdWJyc0luZGV4LmdldChzdWJyTnVtYmVyKSwgbG9jYWxTdWJySW5kZXgsIGdsb2JhbFN1YnJJbmRleCk7CgogICAgICAgIGlmICghdmFsaWQpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHN0YXRlLmNhbGxEZXB0aC0tOwogICAgICAgIHN0YWNrU2l6ZSA9IHN0YXRlLnN0YWNrU2l6ZTsKICAgICAgICBjb250aW51ZTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gMTEpIHsKICAgICAgICBzdGF0ZS5zdGFja1NpemUgPSBzdGFja1NpemU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IDAgJiYgaiA9PT0gZGF0YS5sZW5ndGgpIHsKICAgICAgICBkYXRhW2ogLSAxXSA9IDE0OwogICAgICAgIHZhbGlkYXRpb25Db21tYW5kID0gQ2hhcnN0cmluZ1ZhbGlkYXRpb25EYXRhWzE0XTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWxpZGF0aW9uQ29tbWFuZCA9IENoYXJzdHJpbmdWYWxpZGF0aW9uRGF0YVt2YWx1ZV07CiAgICAgIH0KCiAgICAgIGlmICh2YWxpZGF0aW9uQ29tbWFuZCkgewogICAgICAgIGlmICh2YWxpZGF0aW9uQ29tbWFuZC5zdGVtKSB7CiAgICAgICAgICBzdGF0ZS5oaW50cyArPSBzdGFja1NpemUgPj4gMTsKCiAgICAgICAgICBpZiAodmFsdWUgPT09IDMgfHwgdmFsdWUgPT09IDIzKSB7CiAgICAgICAgICAgIHN0YXRlLmhhc1ZTdGVtcyA9IHRydWU7CiAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLmhhc1ZTdGVtcyAmJiAodmFsdWUgPT09IDEgfHwgdmFsdWUgPT09IDE4KSkgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkNGRiBzdGVtIGhpbnRzIGFyZSBpbiB3cm9uZyBvcmRlciIpOwogICAgICAgICAgICBkYXRhW2ogLSAxXSA9IHZhbHVlID09PSAxID8gMyA6IDIzOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCJtaW4iIGluIHZhbGlkYXRpb25Db21tYW5kKSB7CiAgICAgICAgICBpZiAoIXN0YXRlLnVuZGVmU3RhY2sgJiYgc3RhY2tTaXplIDwgdmFsaWRhdGlvbkNvbW1hbmQubWluKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiTm90IGVub3VnaCBwYXJhbWV0ZXJzIGZvciAiICsgdmFsaWRhdGlvbkNvbW1hbmQuaWQgKyAiOyBhY3R1YWw6ICIgKyBzdGFja1NpemUgKyAiLCBleHBlY3RlZDogIiArIHZhbGlkYXRpb25Db21tYW5kLm1pbik7CgogICAgICAgICAgICBpZiAoc3RhY2tTaXplID09PSAwKSB7CiAgICAgICAgICAgICAgZGF0YVtqIC0gMV0gPSAxNDsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHN0YXRlLmZpcnN0U3RhY2tDbGVhcmluZyAmJiB2YWxpZGF0aW9uQ29tbWFuZC5zdGFja0NsZWFyaW5nKSB7CiAgICAgICAgICBzdGF0ZS5maXJzdFN0YWNrQ2xlYXJpbmcgPSBmYWxzZTsKICAgICAgICAgIHN0YWNrU2l6ZSAtPSB2YWxpZGF0aW9uQ29tbWFuZC5taW47CgogICAgICAgICAgaWYgKHN0YWNrU2l6ZSA+PSAyICYmIHZhbGlkYXRpb25Db21tYW5kLnN0ZW0pIHsKICAgICAgICAgICAgc3RhY2tTaXplICU9IDI7CiAgICAgICAgICB9IGVsc2UgaWYgKHN0YWNrU2l6ZSA+IDEpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJGb3VuZCB0b28gbWFueSBwYXJhbWV0ZXJzIGZvciBzdGFjay1jbGVhcmluZyBjb21tYW5kIik7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHN0YWNrU2l6ZSA+IDApIHsKICAgICAgICAgICAgc3RhdGUud2lkdGggPSBzdGFja1tzdGFja1NpemUgLSAxXTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICgic3RhY2tEZWx0YSIgaW4gdmFsaWRhdGlvbkNvbW1hbmQpIHsKICAgICAgICAgIGlmICgic3RhY2tGbiIgaW4gdmFsaWRhdGlvbkNvbW1hbmQpIHsKICAgICAgICAgICAgdmFsaWRhdGlvbkNvbW1hbmQuc3RhY2tGbihzdGFjaywgc3RhY2tTaXplKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdGFja1NpemUgKz0gdmFsaWRhdGlvbkNvbW1hbmQuc3RhY2tEZWx0YTsKICAgICAgICB9IGVsc2UgaWYgKHZhbGlkYXRpb25Db21tYW5kLnN0YWNrQ2xlYXJpbmcpIHsKICAgICAgICAgIHN0YWNrU2l6ZSA9IDA7CiAgICAgICAgfSBlbHNlIGlmICh2YWxpZGF0aW9uQ29tbWFuZC5yZXNldFN0YWNrKSB7CiAgICAgICAgICBzdGFja1NpemUgPSAwOwogICAgICAgICAgc3RhdGUudW5kZWZTdGFjayA9IGZhbHNlOwogICAgICAgIH0gZWxzZSBpZiAodmFsaWRhdGlvbkNvbW1hbmQudW5kZWZTdGFjaykgewogICAgICAgICAgc3RhY2tTaXplID0gMDsKICAgICAgICAgIHN0YXRlLnVuZGVmU3RhY2sgPSB0cnVlOwogICAgICAgICAgc3RhdGUuZmlyc3RTdGFja0NsZWFyaW5nID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc3RhdGUuc3RhY2tTaXplID0gc3RhY2tTaXplOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBwYXJzZUNoYXJTdHJpbmdzKF9yZWYpIHsKICAgIGxldCB7CiAgICAgIGNoYXJTdHJpbmdzLAogICAgICBsb2NhbFN1YnJJbmRleCwKICAgICAgZ2xvYmFsU3VickluZGV4LAogICAgICBmZFNlbGVjdCwKICAgICAgZmRBcnJheSwKICAgICAgcHJpdmF0ZURpY3QKICAgIH0gPSBfcmVmOwogICAgY29uc3Qgc2VhY3MgPSBbXTsKICAgIGNvbnN0IHdpZHRocyA9IFtdOwogICAgY29uc3QgY291bnQgPSBjaGFyU3RyaW5ncy5jb3VudDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgY29uc3QgY2hhcnN0cmluZyA9IGNoYXJTdHJpbmdzLmdldChpKTsKICAgICAgY29uc3Qgc3RhdGUgPSB7CiAgICAgICAgY2FsbERlcHRoOiAwLAogICAgICAgIHN0YWNrU2l6ZTogMCwKICAgICAgICBzdGFjazogW10sCiAgICAgICAgdW5kZWZTdGFjazogdHJ1ZSwKICAgICAgICBoaW50czogMCwKICAgICAgICBmaXJzdFN0YWNrQ2xlYXJpbmc6IHRydWUsCiAgICAgICAgc2VhYzogbnVsbCwKICAgICAgICB3aWR0aDogbnVsbCwKICAgICAgICBoYXNWU3RlbXM6IGZhbHNlCiAgICAgIH07CiAgICAgIGxldCB2YWxpZCA9IHRydWU7CiAgICAgIGxldCBsb2NhbFN1YnJUb1VzZSA9IG51bGw7CiAgICAgIGxldCBwcml2YXRlRGljdFRvVXNlID0gcHJpdmF0ZURpY3Q7CgogICAgICBpZiAoZmRTZWxlY3QgJiYgZmRBcnJheS5sZW5ndGgpIHsKICAgICAgICBjb25zdCBmZEluZGV4ID0gZmRTZWxlY3QuZ2V0RkRJbmRleChpKTsKCiAgICAgICAgaWYgKGZkSW5kZXggPT09IC0xKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkdseXBoIGluZGV4IGlzIG5vdCBpbiBmZCBzZWxlY3QuIik7CiAgICAgICAgICB2YWxpZCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGZkSW5kZXggPj0gZmRBcnJheS5sZW5ndGgpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSW52YWxpZCBmZCBpbmRleCBmb3IgZ2x5cGggaW5kZXguIik7CiAgICAgICAgICB2YWxpZCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBwcml2YXRlRGljdFRvVXNlID0gZmRBcnJheVtmZEluZGV4XS5wcml2YXRlRGljdDsKICAgICAgICAgIGxvY2FsU3ViclRvVXNlID0gcHJpdmF0ZURpY3RUb1VzZS5zdWJyc0luZGV4OwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChsb2NhbFN1YnJJbmRleCkgewogICAgICAgIGxvY2FsU3ViclRvVXNlID0gbG9jYWxTdWJySW5kZXg7CiAgICAgIH0KCiAgICAgIGlmICh2YWxpZCkgewogICAgICAgIHZhbGlkID0gdGhpcy5wYXJzZUNoYXJTdHJpbmcoc3RhdGUsIGNoYXJzdHJpbmcsIGxvY2FsU3ViclRvVXNlLCBnbG9iYWxTdWJySW5kZXgpOwogICAgICB9CgogICAgICBpZiAoc3RhdGUud2lkdGggIT09IG51bGwpIHsKICAgICAgICBjb25zdCBub21pbmFsV2lkdGggPSBwcml2YXRlRGljdFRvVXNlLmdldEJ5TmFtZSgibm9taW5hbFdpZHRoWCIpOwogICAgICAgIHdpZHRoc1tpXSA9IG5vbWluYWxXaWR0aCArIHN0YXRlLndpZHRoOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGRlZmF1bHRXaWR0aCA9IHByaXZhdGVEaWN0VG9Vc2UuZ2V0QnlOYW1lKCJkZWZhdWx0V2lkdGhYIik7CiAgICAgICAgd2lkdGhzW2ldID0gZGVmYXVsdFdpZHRoOwogICAgICB9CgogICAgICBpZiAoc3RhdGUuc2VhYyAhPT0gbnVsbCkgewogICAgICAgIHNlYWNzW2ldID0gc3RhdGUuc2VhYzsKICAgICAgfQoKICAgICAgaWYgKCF2YWxpZCkgewogICAgICAgIGNoYXJTdHJpbmdzLnNldChpLCBuZXcgVWludDhBcnJheShbMTRdKSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gewogICAgICBjaGFyU3RyaW5ncywKICAgICAgc2VhY3MsCiAgICAgIHdpZHRocwogICAgfTsKICB9CgogIGVtcHR5UHJpdmF0ZURpY3Rpb25hcnkocGFyZW50RGljdCkgewogICAgY29uc3QgcHJpdmF0ZURpY3QgPSB0aGlzLmNyZWF0ZURpY3QoQ0ZGUHJpdmF0ZURpY3QsIFtdLCBwYXJlbnREaWN0LnN0cmluZ3MpOwogICAgcGFyZW50RGljdC5zZXRCeUtleSgxOCwgWzAsIDBdKTsKICAgIHBhcmVudERpY3QucHJpdmF0ZURpY3QgPSBwcml2YXRlRGljdDsKICB9CgogIHBhcnNlUHJpdmF0ZURpY3QocGFyZW50RGljdCkgewogICAgaWYgKCFwYXJlbnREaWN0Lmhhc05hbWUoIlByaXZhdGUiKSkgewogICAgICB0aGlzLmVtcHR5UHJpdmF0ZURpY3Rpb25hcnkocGFyZW50RGljdCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBwcml2YXRlT2Zmc2V0ID0gcGFyZW50RGljdC5nZXRCeU5hbWUoIlByaXZhdGUiKTsKCiAgICBpZiAoIUFycmF5LmlzQXJyYXkocHJpdmF0ZU9mZnNldCkgfHwgcHJpdmF0ZU9mZnNldC5sZW5ndGggIT09IDIpIHsKICAgICAgcGFyZW50RGljdC5yZW1vdmVCeU5hbWUoIlByaXZhdGUiKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHNpemUgPSBwcml2YXRlT2Zmc2V0WzBdOwogICAgY29uc3Qgb2Zmc2V0ID0gcHJpdmF0ZU9mZnNldFsxXTsKCiAgICBpZiAoc2l6ZSA9PT0gMCB8fCBvZmZzZXQgPj0gdGhpcy5ieXRlcy5sZW5ndGgpIHsKICAgICAgdGhpcy5lbXB0eVByaXZhdGVEaWN0aW9uYXJ5KHBhcmVudERpY3QpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgcHJpdmF0ZURpY3RFbmQgPSBvZmZzZXQgKyBzaXplOwogICAgY29uc3QgZGljdERhdGEgPSB0aGlzLmJ5dGVzLnN1YmFycmF5KG9mZnNldCwgcHJpdmF0ZURpY3RFbmQpOwogICAgY29uc3QgZGljdCA9IHRoaXMucGFyc2VEaWN0KGRpY3REYXRhKTsKICAgIGNvbnN0IHByaXZhdGVEaWN0ID0gdGhpcy5jcmVhdGVEaWN0KENGRlByaXZhdGVEaWN0LCBkaWN0LCBwYXJlbnREaWN0LnN0cmluZ3MpOwogICAgcGFyZW50RGljdC5wcml2YXRlRGljdCA9IHByaXZhdGVEaWN0OwoKICAgIGlmICghcHJpdmF0ZURpY3QuZ2V0QnlOYW1lKCJTdWJycyIpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBzdWJyc09mZnNldCA9IHByaXZhdGVEaWN0LmdldEJ5TmFtZSgiU3VicnMiKTsKICAgIGNvbnN0IHJlbGF0aXZlT2Zmc2V0ID0gb2Zmc2V0ICsgc3VicnNPZmZzZXQ7CgogICAgaWYgKHN1YnJzT2Zmc2V0ID09PSAwIHx8IHJlbGF0aXZlT2Zmc2V0ID49IHRoaXMuYnl0ZXMubGVuZ3RoKSB7CiAgICAgIHRoaXMuZW1wdHlQcml2YXRlRGljdGlvbmFyeShwYXJlbnREaWN0KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHN1YnJzSW5kZXggPSB0aGlzLnBhcnNlSW5kZXgocmVsYXRpdmVPZmZzZXQpOwogICAgcHJpdmF0ZURpY3Quc3VicnNJbmRleCA9IHN1YnJzSW5kZXgub2JqOwogIH0KCiAgcGFyc2VDaGFyc2V0cyhwb3MsIGxlbmd0aCwgc3RyaW5ncywgY2lkKSB7CiAgICBpZiAocG9zID09PSAwKSB7CiAgICAgIHJldHVybiBuZXcgQ0ZGQ2hhcnNldCh0cnVlLCBDRkZDaGFyc2V0UHJlZGVmaW5lZFR5cGVzLklTT19BRE9CRSwgX2NoYXJzZXRzLklTT0Fkb2JlQ2hhcnNldCk7CiAgICB9IGVsc2UgaWYgKHBvcyA9PT0gMSkgewogICAgICByZXR1cm4gbmV3IENGRkNoYXJzZXQodHJ1ZSwgQ0ZGQ2hhcnNldFByZWRlZmluZWRUeXBlcy5FWFBFUlQsIF9jaGFyc2V0cy5FeHBlcnRDaGFyc2V0KTsKICAgIH0gZWxzZSBpZiAocG9zID09PSAyKSB7CiAgICAgIHJldHVybiBuZXcgQ0ZGQ2hhcnNldCh0cnVlLCBDRkZDaGFyc2V0UHJlZGVmaW5lZFR5cGVzLkVYUEVSVF9TVUJTRVQsIF9jaGFyc2V0cy5FeHBlcnRTdWJzZXRDaGFyc2V0KTsKICAgIH0KCiAgICBjb25zdCBieXRlcyA9IHRoaXMuYnl0ZXM7CiAgICBjb25zdCBzdGFydCA9IHBvczsKICAgIGNvbnN0IGZvcm1hdCA9IGJ5dGVzW3BvcysrXTsKICAgIGNvbnN0IGNoYXJzZXQgPSBbY2lkID8gMCA6ICIubm90ZGVmIl07CiAgICBsZXQgaWQsIGNvdW50LCBpOwogICAgbGVuZ3RoIC09IDE7CgogICAgc3dpdGNoIChmb3JtYXQpIHsKICAgICAgY2FzZSAwOgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgICAgaWQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKICAgICAgICAgIGNoYXJzZXQucHVzaChjaWQgPyBpZCA6IHN0cmluZ3MuZ2V0KGlkKSk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMToKICAgICAgICB3aGlsZSAoY2hhcnNldC5sZW5ndGggPD0gbGVuZ3RoKSB7CiAgICAgICAgICBpZCA9IGJ5dGVzW3BvcysrXSA8PCA4IHwgYnl0ZXNbcG9zKytdOwogICAgICAgICAgY291bnQgPSBieXRlc1twb3MrK107CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8PSBjb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNoYXJzZXQucHVzaChjaWQgPyBpZCsrIDogc3RyaW5ncy5nZXQoaWQrKykpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDI6CiAgICAgICAgd2hpbGUgKGNoYXJzZXQubGVuZ3RoIDw9IGxlbmd0aCkgewogICAgICAgICAgaWQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKICAgICAgICAgIGNvdW50ID0gYnl0ZXNbcG9zKytdIDw8IDggfCBieXRlc1twb3MrK107CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8PSBjb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNoYXJzZXQucHVzaChjaWQgPyBpZCsrIDogc3RyaW5ncy5nZXQoaWQrKykpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biBjaGFyc2V0IGZvcm1hdCIpOwogICAgfQoKICAgIGNvbnN0IGVuZCA9IHBvczsKICAgIGNvbnN0IHJhdyA9IGJ5dGVzLnN1YmFycmF5KHN0YXJ0LCBlbmQpOwogICAgcmV0dXJuIG5ldyBDRkZDaGFyc2V0KGZhbHNlLCBmb3JtYXQsIGNoYXJzZXQsIHJhdyk7CiAgfQoKICBwYXJzZUVuY29kaW5nKHBvcywgcHJvcGVydGllcywgc3RyaW5ncywgY2hhcnNldCkgewogICAgY29uc3QgZW5jb2RpbmcgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgY29uc3QgYnl0ZXMgPSB0aGlzLmJ5dGVzOwogICAgbGV0IHByZWRlZmluZWQgPSBmYWxzZTsKICAgIGxldCBmb3JtYXQsIGksIGlpOwogICAgbGV0IHJhdyA9IG51bGw7CgogICAgZnVuY3Rpb24gcmVhZFN1cHBsZW1lbnQoKSB7CiAgICAgIGNvbnN0IHN1cHBsZW1lbnRzQ291bnQgPSBieXRlc1twb3MrK107CgogICAgICBmb3IgKGkgPSAwOyBpIDwgc3VwcGxlbWVudHNDb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgY29kZSA9IGJ5dGVzW3BvcysrXTsKICAgICAgICBjb25zdCBzaWQgPSAoYnl0ZXNbcG9zKytdIDw8IDgpICsgKGJ5dGVzW3BvcysrXSAmIDB4ZmYpOwogICAgICAgIGVuY29kaW5nW2NvZGVdID0gY2hhcnNldC5pbmRleE9mKHN0cmluZ3MuZ2V0KHNpZCkpOwogICAgICB9CiAgICB9CgogICAgaWYgKHBvcyA9PT0gMCB8fCBwb3MgPT09IDEpIHsKICAgICAgcHJlZGVmaW5lZCA9IHRydWU7CiAgICAgIGZvcm1hdCA9IHBvczsKICAgICAgY29uc3QgYmFzZUVuY29kaW5nID0gcG9zID8gX2VuY29kaW5ncy5FeHBlcnRFbmNvZGluZyA6IF9lbmNvZGluZ3MuU3RhbmRhcmRFbmNvZGluZzsKCiAgICAgIGZvciAoaSA9IDAsIGlpID0gY2hhcnNldC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29uc3QgaW5kZXggPSBiYXNlRW5jb2RpbmcuaW5kZXhPZihjaGFyc2V0W2ldKTsKCiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgICAgZW5jb2RpbmdbaW5kZXhdID0gaTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGRhdGFTdGFydCA9IHBvczsKICAgICAgZm9ybWF0ID0gYnl0ZXNbcG9zKytdOwoKICAgICAgc3dpdGNoIChmb3JtYXQgJiAweDdmKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgY29uc3QgZ2x5cGhzQ291bnQgPSBieXRlc1twb3MrK107CgogICAgICAgICAgZm9yIChpID0gMTsgaSA8PSBnbHlwaHNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGVuY29kaW5nW2J5dGVzW3BvcysrXV0gPSBpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBjb25zdCByYW5nZXNDb3VudCA9IGJ5dGVzW3BvcysrXTsKICAgICAgICAgIGxldCBnaWQgPSAxOwoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCByYW5nZXNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gYnl0ZXNbcG9zKytdOwogICAgICAgICAgICBjb25zdCBsZWZ0ID0gYnl0ZXNbcG9zKytdOwoKICAgICAgICAgICAgZm9yIChsZXQgaiA9IHN0YXJ0OyBqIDw9IHN0YXJ0ICsgbGVmdDsgaisrKSB7CiAgICAgICAgICAgICAgZW5jb2Rpbmdbal0gPSBnaWQrKzsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBVbmtub3duIGVuY29kaW5nIGZvcm1hdDogJHtmb3JtYXR9IGluIENGRmApOwogICAgICB9CgogICAgICBjb25zdCBkYXRhRW5kID0gcG9zOwoKICAgICAgaWYgKGZvcm1hdCAmIDB4ODApIHsKICAgICAgICBieXRlc1tkYXRhU3RhcnRdICY9IDB4N2Y7CiAgICAgICAgcmVhZFN1cHBsZW1lbnQoKTsKICAgICAgfQoKICAgICAgcmF3ID0gYnl0ZXMuc3ViYXJyYXkoZGF0YVN0YXJ0LCBkYXRhRW5kKTsKICAgIH0KCiAgICBmb3JtYXQgJj0gMHg3ZjsKICAgIHJldHVybiBuZXcgQ0ZGRW5jb2RpbmcocHJlZGVmaW5lZCwgZm9ybWF0LCBlbmNvZGluZywgcmF3KTsKICB9CgogIHBhcnNlRkRTZWxlY3QocG9zLCBsZW5ndGgpIHsKICAgIGNvbnN0IGJ5dGVzID0gdGhpcy5ieXRlczsKICAgIGNvbnN0IGZvcm1hdCA9IGJ5dGVzW3BvcysrXTsKICAgIGNvbnN0IGZkU2VsZWN0ID0gW107CiAgICBsZXQgaTsKCiAgICBzd2l0Y2ggKGZvcm1hdCkgewogICAgICBjYXNlIDA6CiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgICAgICBjb25zdCBpZCA9IGJ5dGVzW3BvcysrXTsKICAgICAgICAgIGZkU2VsZWN0LnB1c2goaWQpOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDM6CiAgICAgICAgY29uc3QgcmFuZ2VzQ291bnQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IHJhbmdlc0NvdW50OyArK2kpIHsKICAgICAgICAgIGxldCBmaXJzdCA9IGJ5dGVzW3BvcysrXSA8PCA4IHwgYnl0ZXNbcG9zKytdOwoKICAgICAgICAgIGlmIChpID09PSAwICYmIGZpcnN0ICE9PSAwKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgicGFyc2VGRFNlbGVjdDogVGhlIGZpcnN0IHJhbmdlIG11c3QgaGF2ZSBhIGZpcnN0IEdJRCBvZiAwIiArICIgLS0gdHJ5aW5nIHRvIHJlY292ZXIuIik7CiAgICAgICAgICAgIGZpcnN0ID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBmZEluZGV4ID0gYnl0ZXNbcG9zKytdOwogICAgICAgICAgY29uc3QgbmV4dCA9IGJ5dGVzW3Bvc10gPDwgOCB8IGJ5dGVzW3BvcyArIDFdOwoKICAgICAgICAgIGZvciAobGV0IGogPSBmaXJzdDsgaiA8IG5leHQ7ICsraikgewogICAgICAgICAgICBmZFNlbGVjdC5wdXNoKGZkSW5kZXgpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcG9zICs9IDI7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgcGFyc2VGRFNlbGVjdDogVW5rbm93biBmb3JtYXQgIiR7Zm9ybWF0fSIuYCk7CiAgICB9CgogICAgaWYgKGZkU2VsZWN0Lmxlbmd0aCAhPT0gbGVuZ3RoKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigicGFyc2VGRFNlbGVjdDogSW52YWxpZCBmb250IGRhdGEuIik7CiAgICB9CgogICAgcmV0dXJuIG5ldyBDRkZGRFNlbGVjdChmb3JtYXQsIGZkU2VsZWN0KTsKICB9Cgp9CgpleHBvcnRzLkNGRlBhcnNlciA9IENGRlBhcnNlcjsKCmNsYXNzIENGRiB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLmhlYWRlciA9IG51bGw7CiAgICB0aGlzLm5hbWVzID0gW107CiAgICB0aGlzLnRvcERpY3QgPSBudWxsOwogICAgdGhpcy5zdHJpbmdzID0gbmV3IENGRlN0cmluZ3MoKTsKICAgIHRoaXMuZ2xvYmFsU3VickluZGV4ID0gbnVsbDsKICAgIHRoaXMuZW5jb2RpbmcgPSBudWxsOwogICAgdGhpcy5jaGFyc2V0ID0gbnVsbDsKICAgIHRoaXMuY2hhclN0cmluZ3MgPSBudWxsOwogICAgdGhpcy5mZEFycmF5ID0gW107CiAgICB0aGlzLmZkU2VsZWN0ID0gbnVsbDsKICAgIHRoaXMuaXNDSURGb250ID0gZmFsc2U7CiAgfQoKICBkdXBsaWNhdGVGaXJzdEdseXBoKCkgewogICAgaWYgKHRoaXMuY2hhclN0cmluZ3MuY291bnQgPj0gNjU1MzUpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJOb3QgZW5vdWdoIHNwYWNlIGluIGNoYXJzdHJpbmdzIHRvIGR1cGxpY2F0ZSBmaXJzdCBnbHlwaC4iKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGdseXBoWmVybyA9IHRoaXMuY2hhclN0cmluZ3MuZ2V0KDApOwogICAgdGhpcy5jaGFyU3RyaW5ncy5hZGQoZ2x5cGhaZXJvKTsKCiAgICBpZiAodGhpcy5pc0NJREZvbnQpIHsKICAgICAgdGhpcy5mZFNlbGVjdC5mZFNlbGVjdC5wdXNoKHRoaXMuZmRTZWxlY3QuZmRTZWxlY3RbMF0pOwogICAgfQogIH0KCiAgaGFzR2x5cGhJZChpZCkgewogICAgaWYgKGlkIDwgMCB8fCBpZCA+PSB0aGlzLmNoYXJTdHJpbmdzLmNvdW50KSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBjb25zdCBnbHlwaCA9IHRoaXMuY2hhclN0cmluZ3MuZ2V0KGlkKTsKICAgIHJldHVybiBnbHlwaC5sZW5ndGggPiAwOwogIH0KCn0KCmV4cG9ydHMuQ0ZGID0gQ0ZGOwoKY2xhc3MgQ0ZGSGVhZGVyIHsKICBjb25zdHJ1Y3RvcihtYWpvciwgbWlub3IsIGhkclNpemUsIG9mZlNpemUpIHsKICAgIHRoaXMubWFqb3IgPSBtYWpvcjsKICAgIHRoaXMubWlub3IgPSBtaW5vcjsKICAgIHRoaXMuaGRyU2l6ZSA9IGhkclNpemU7CiAgICB0aGlzLm9mZlNpemUgPSBvZmZTaXplOwogIH0KCn0KCmV4cG9ydHMuQ0ZGSGVhZGVyID0gQ0ZGSGVhZGVyOwoKY2xhc3MgQ0ZGU3RyaW5ncyB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLnN0cmluZ3MgPSBbXTsKICB9CgogIGdldChpbmRleCkgewogICAgaWYgKGluZGV4ID49IDAgJiYgaW5kZXggPD0gTlVNX1NUQU5EQVJEX0NGRl9TVFJJTkdTIC0gMSkgewogICAgICByZXR1cm4gQ0ZGU3RhbmRhcmRTdHJpbmdzW2luZGV4XTsKICAgIH0KCiAgICBpZiAoaW5kZXggLSBOVU1fU1RBTkRBUkRfQ0ZGX1NUUklOR1MgPD0gdGhpcy5zdHJpbmdzLmxlbmd0aCkgewogICAgICByZXR1cm4gdGhpcy5zdHJpbmdzW2luZGV4IC0gTlVNX1NUQU5EQVJEX0NGRl9TVFJJTkdTXTsKICAgIH0KCiAgICByZXR1cm4gQ0ZGU3RhbmRhcmRTdHJpbmdzWzBdOwogIH0KCiAgZ2V0U0lEKHN0cikgewogICAgbGV0IGluZGV4ID0gQ0ZGU3RhbmRhcmRTdHJpbmdzLmluZGV4T2Yoc3RyKTsKCiAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgIHJldHVybiBpbmRleDsKICAgIH0KCiAgICBpbmRleCA9IHRoaXMuc3RyaW5ncy5pbmRleE9mKHN0cik7CgogICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICByZXR1cm4gaW5kZXggKyBOVU1fU1RBTkRBUkRfQ0ZGX1NUUklOR1M7CiAgICB9CgogICAgcmV0dXJuIC0xOwogIH0KCiAgYWRkKHZhbHVlKSB7CiAgICB0aGlzLnN0cmluZ3MucHVzaCh2YWx1ZSk7CiAgfQoKICBnZXQgY291bnQoKSB7CiAgICByZXR1cm4gdGhpcy5zdHJpbmdzLmxlbmd0aDsKICB9Cgp9CgpleHBvcnRzLkNGRlN0cmluZ3MgPSBDRkZTdHJpbmdzOwoKY2xhc3MgQ0ZGSW5kZXggewogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5vYmplY3RzID0gW107CiAgICB0aGlzLmxlbmd0aCA9IDA7CiAgfQoKICBhZGQoZGF0YSkgewogICAgdGhpcy5sZW5ndGggKz0gZGF0YS5sZW5ndGg7CiAgICB0aGlzLm9iamVjdHMucHVzaChkYXRhKTsKICB9CgogIHNldChpbmRleCwgZGF0YSkgewogICAgdGhpcy5sZW5ndGggKz0gZGF0YS5sZW5ndGggLSB0aGlzLm9iamVjdHNbaW5kZXhdLmxlbmd0aDsKICAgIHRoaXMub2JqZWN0c1tpbmRleF0gPSBkYXRhOwogIH0KCiAgZ2V0KGluZGV4KSB7CiAgICByZXR1cm4gdGhpcy5vYmplY3RzW2luZGV4XTsKICB9CgogIGdldCBjb3VudCgpIHsKICAgIHJldHVybiB0aGlzLm9iamVjdHMubGVuZ3RoOwogIH0KCn0KCmV4cG9ydHMuQ0ZGSW5kZXggPSBDRkZJbmRleDsKCmNsYXNzIENGRkRpY3QgewogIGNvbnN0cnVjdG9yKHRhYmxlcywgc3RyaW5ncykgewogICAgdGhpcy5rZXlUb05hbWVNYXAgPSB0YWJsZXMua2V5VG9OYW1lTWFwOwogICAgdGhpcy5uYW1lVG9LZXlNYXAgPSB0YWJsZXMubmFtZVRvS2V5TWFwOwogICAgdGhpcy5kZWZhdWx0cyA9IHRhYmxlcy5kZWZhdWx0czsKICAgIHRoaXMudHlwZXMgPSB0YWJsZXMudHlwZXM7CiAgICB0aGlzLm9wY29kZXMgPSB0YWJsZXMub3Bjb2RlczsKICAgIHRoaXMub3JkZXIgPSB0YWJsZXMub3JkZXI7CiAgICB0aGlzLnN0cmluZ3MgPSBzdHJpbmdzOwogICAgdGhpcy52YWx1ZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIH0KCiAgc2V0QnlLZXkoa2V5LCB2YWx1ZSkgewogICAgaWYgKCEoa2V5IGluIHRoaXMua2V5VG9OYW1lTWFwKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgY29uc3QgdmFsdWVMZW5ndGggPSB2YWx1ZS5sZW5ndGg7CgogICAgaWYgKHZhbHVlTGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWVMZW5ndGg7IGkrKykgewogICAgICBpZiAoaXNOYU4odmFsdWVbaV0pKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCdJbnZhbGlkIENGRkRpY3QgdmFsdWU6ICInICsgdmFsdWUgKyAnIiBmb3Iga2V5ICInICsga2V5ICsgJyIuJyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCB0eXBlID0gdGhpcy50eXBlc1trZXldOwoKICAgIGlmICh0eXBlID09PSAibnVtIiB8fCB0eXBlID09PSAic2lkIiB8fCB0eXBlID09PSAib2Zmc2V0IikgewogICAgICB2YWx1ZSA9IHZhbHVlWzBdOwogICAgfQoKICAgIHRoaXMudmFsdWVzW2tleV0gPSB2YWx1ZTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgc2V0QnlOYW1lKG5hbWUsIHZhbHVlKSB7CiAgICBpZiAoIShuYW1lIGluIHRoaXMubmFtZVRvS2V5TWFwKSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgZGljdGlvbmFyeSBuYW1lICIke25hbWV9ImApOwogICAgfQoKICAgIHRoaXMudmFsdWVzW3RoaXMubmFtZVRvS2V5TWFwW25hbWVdXSA9IHZhbHVlOwogIH0KCiAgaGFzTmFtZShuYW1lKSB7CiAgICByZXR1cm4gdGhpcy5uYW1lVG9LZXlNYXBbbmFtZV0gaW4gdGhpcy52YWx1ZXM7CiAgfQoKICBnZXRCeU5hbWUobmFtZSkgewogICAgaWYgKCEobmFtZSBpbiB0aGlzLm5hbWVUb0tleU1hcCkpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBJbnZhbGlkIGRpY3Rpb25hcnkgbmFtZSAke25hbWV9ImApOwogICAgfQoKICAgIGNvbnN0IGtleSA9IHRoaXMubmFtZVRvS2V5TWFwW25hbWVdOwoKICAgIGlmICghKGtleSBpbiB0aGlzLnZhbHVlcykpIHsKICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdHNba2V5XTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy52YWx1ZXNba2V5XTsKICB9CgogIHJlbW92ZUJ5TmFtZShuYW1lKSB7CiAgICBkZWxldGUgdGhpcy52YWx1ZXNbdGhpcy5uYW1lVG9LZXlNYXBbbmFtZV1dOwogIH0KCiAgc3RhdGljIGNyZWF0ZVRhYmxlcyhsYXlvdXQpIHsKICAgIGNvbnN0IHRhYmxlcyA9IHsKICAgICAga2V5VG9OYW1lTWFwOiB7fSwKICAgICAgbmFtZVRvS2V5TWFwOiB7fSwKICAgICAgZGVmYXVsdHM6IHt9LAogICAgICB0eXBlczoge30sCiAgICAgIG9wY29kZXM6IHt9LAogICAgICBvcmRlcjogW10KICAgIH07CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gbGF5b3V0Lmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgY29uc3QgZW50cnkgPSBsYXlvdXRbaV07CiAgICAgIGNvbnN0IGtleSA9IEFycmF5LmlzQXJyYXkoZW50cnlbMF0pID8gKGVudHJ5WzBdWzBdIDw8IDgpICsgZW50cnlbMF1bMV0gOiBlbnRyeVswXTsKICAgICAgdGFibGVzLmtleVRvTmFtZU1hcFtrZXldID0gZW50cnlbMV07CiAgICAgIHRhYmxlcy5uYW1lVG9LZXlNYXBbZW50cnlbMV1dID0ga2V5OwogICAgICB0YWJsZXMudHlwZXNba2V5XSA9IGVudHJ5WzJdOwogICAgICB0YWJsZXMuZGVmYXVsdHNba2V5XSA9IGVudHJ5WzNdOwogICAgICB0YWJsZXMub3Bjb2Rlc1trZXldID0gQXJyYXkuaXNBcnJheShlbnRyeVswXSkgPyBlbnRyeVswXSA6IFtlbnRyeVswXV07CiAgICAgIHRhYmxlcy5vcmRlci5wdXNoKGtleSk7CiAgICB9CgogICAgcmV0dXJuIHRhYmxlczsKICB9Cgp9Cgpjb25zdCBDRkZUb3BEaWN0TGF5b3V0ID0gW1tbMTIsIDMwXSwgIlJPUyIsIFsic2lkIiwgInNpZCIsICJudW0iXSwgbnVsbF0sIFtbMTIsIDIwXSwgIlN5bnRoZXRpY0Jhc2UiLCAibnVtIiwgbnVsbF0sIFswLCAidmVyc2lvbiIsICJzaWQiLCBudWxsXSwgWzEsICJOb3RpY2UiLCAic2lkIiwgbnVsbF0sIFtbMTIsIDBdLCAiQ29weXJpZ2h0IiwgInNpZCIsIG51bGxdLCBbMiwgIkZ1bGxOYW1lIiwgInNpZCIsIG51bGxdLCBbMywgIkZhbWlseU5hbWUiLCAic2lkIiwgbnVsbF0sIFs0LCAiV2VpZ2h0IiwgInNpZCIsIG51bGxdLCBbWzEyLCAxXSwgImlzRml4ZWRQaXRjaCIsICJudW0iLCAwXSwgW1sxMiwgMl0sICJJdGFsaWNBbmdsZSIsICJudW0iLCAwXSwgW1sxMiwgM10sICJVbmRlcmxpbmVQb3NpdGlvbiIsICJudW0iLCAtMTAwXSwgW1sxMiwgNF0sICJVbmRlcmxpbmVUaGlja25lc3MiLCAibnVtIiwgNTBdLCBbWzEyLCA1XSwgIlBhaW50VHlwZSIsICJudW0iLCAwXSwgW1sxMiwgNl0sICJDaGFyc3RyaW5nVHlwZSIsICJudW0iLCAyXSwgW1sxMiwgN10sICJGb250TWF0cml4IiwgWyJudW0iLCAibnVtIiwgIm51bSIsICJudW0iLCAibnVtIiwgIm51bSJdLCBbMC4wMDEsIDAsIDAsIDAuMDAxLCAwLCAwXV0sIFsxMywgIlVuaXF1ZUlEIiwgIm51bSIsIG51bGxdLCBbNSwgIkZvbnRCQm94IiwgWyJudW0iLCAibnVtIiwgIm51bSIsICJudW0iXSwgWzAsIDAsIDAsIDBdXSwgW1sxMiwgOF0sICJTdHJva2VXaWR0aCIsICJudW0iLCAwXSwgWzE0LCAiWFVJRCIsICJhcnJheSIsIG51bGxdLCBbMTUsICJjaGFyc2V0IiwgIm9mZnNldCIsIDBdLCBbMTYsICJFbmNvZGluZyIsICJvZmZzZXQiLCAwXSwgWzE3LCAiQ2hhclN0cmluZ3MiLCAib2Zmc2V0IiwgMF0sIFsxOCwgIlByaXZhdGUiLCBbIm9mZnNldCIsICJvZmZzZXQiXSwgbnVsbF0sIFtbMTIsIDIxXSwgIlBvc3RTY3JpcHQiLCAic2lkIiwgbnVsbF0sIFtbMTIsIDIyXSwgIkJhc2VGb250TmFtZSIsICJzaWQiLCBudWxsXSwgW1sxMiwgMjNdLCAiQmFzZUZvbnRCbGVuZCIsICJkZWx0YSIsIG51bGxdLCBbWzEyLCAzMV0sICJDSURGb250VmVyc2lvbiIsICJudW0iLCAwXSwgW1sxMiwgMzJdLCAiQ0lERm9udFJldmlzaW9uIiwgIm51bSIsIDBdLCBbWzEyLCAzM10sICJDSURGb250VHlwZSIsICJudW0iLCAwXSwgW1sxMiwgMzRdLCAiQ0lEQ291bnQiLCAibnVtIiwgODcyMF0sIFtbMTIsIDM1XSwgIlVJREJhc2UiLCAibnVtIiwgbnVsbF0sIFtbMTIsIDM3XSwgIkZEU2VsZWN0IiwgIm9mZnNldCIsIG51bGxdLCBbWzEyLCAzNl0sICJGREFycmF5IiwgIm9mZnNldCIsIG51bGxdLCBbWzEyLCAzOF0sICJGb250TmFtZSIsICJzaWQiLCBudWxsXV07CgpjbGFzcyBDRkZUb3BEaWN0IGV4dGVuZHMgQ0ZGRGljdCB7CiAgc3RhdGljIGdldCB0YWJsZXMoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInRhYmxlcyIsIHRoaXMuY3JlYXRlVGFibGVzKENGRlRvcERpY3RMYXlvdXQpKTsKICB9CgogIGNvbnN0cnVjdG9yKHN0cmluZ3MpIHsKICAgIHN1cGVyKENGRlRvcERpY3QudGFibGVzLCBzdHJpbmdzKTsKICAgIHRoaXMucHJpdmF0ZURpY3QgPSBudWxsOwogIH0KCn0KCmV4cG9ydHMuQ0ZGVG9wRGljdCA9IENGRlRvcERpY3Q7CmNvbnN0IENGRlByaXZhdGVEaWN0TGF5b3V0ID0gW1s2LCAiQmx1ZVZhbHVlcyIsICJkZWx0YSIsIG51bGxdLCBbNywgIk90aGVyQmx1ZXMiLCAiZGVsdGEiLCBudWxsXSwgWzgsICJGYW1pbHlCbHVlcyIsICJkZWx0YSIsIG51bGxdLCBbOSwgIkZhbWlseU90aGVyQmx1ZXMiLCAiZGVsdGEiLCBudWxsXSwgW1sxMiwgOV0sICJCbHVlU2NhbGUiLCAibnVtIiwgMC4wMzk2MjVdLCBbWzEyLCAxMF0sICJCbHVlU2hpZnQiLCAibnVtIiwgN10sIFtbMTIsIDExXSwgIkJsdWVGdXp6IiwgIm51bSIsIDFdLCBbMTAsICJTdGRIVyIsICJudW0iLCBudWxsXSwgWzExLCAiU3RkVlciLCAibnVtIiwgbnVsbF0sIFtbMTIsIDEyXSwgIlN0ZW1TbmFwSCIsICJkZWx0YSIsIG51bGxdLCBbWzEyLCAxM10sICJTdGVtU25hcFYiLCAiZGVsdGEiLCBudWxsXSwgW1sxMiwgMTRdLCAiRm9yY2VCb2xkIiwgIm51bSIsIDBdLCBbWzEyLCAxN10sICJMYW5ndWFnZUdyb3VwIiwgIm51bSIsIDBdLCBbWzEyLCAxOF0sICJFeHBhbnNpb25GYWN0b3IiLCAibnVtIiwgMC4wNl0sIFtbMTIsIDE5XSwgImluaXRpYWxSYW5kb21TZWVkIiwgIm51bSIsIDBdLCBbMjAsICJkZWZhdWx0V2lkdGhYIiwgIm51bSIsIDBdLCBbMjEsICJub21pbmFsV2lkdGhYIiwgIm51bSIsIDBdLCBbMTksICJTdWJycyIsICJvZmZzZXQiLCBudWxsXV07CgpjbGFzcyBDRkZQcml2YXRlRGljdCBleHRlbmRzIENGRkRpY3QgewogIHN0YXRpYyBnZXQgdGFibGVzKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ0YWJsZXMiLCB0aGlzLmNyZWF0ZVRhYmxlcyhDRkZQcml2YXRlRGljdExheW91dCkpOwogIH0KCiAgY29uc3RydWN0b3Ioc3RyaW5ncykgewogICAgc3VwZXIoQ0ZGUHJpdmF0ZURpY3QudGFibGVzLCBzdHJpbmdzKTsKICAgIHRoaXMuc3VicnNJbmRleCA9IG51bGw7CiAgfQoKfQoKZXhwb3J0cy5DRkZQcml2YXRlRGljdCA9IENGRlByaXZhdGVEaWN0Owpjb25zdCBDRkZDaGFyc2V0UHJlZGVmaW5lZFR5cGVzID0gewogIElTT19BRE9CRTogMCwKICBFWFBFUlQ6IDEsCiAgRVhQRVJUX1NVQlNFVDogMgp9OwoKY2xhc3MgQ0ZGQ2hhcnNldCB7CiAgY29uc3RydWN0b3IocHJlZGVmaW5lZCwgZm9ybWF0LCBjaGFyc2V0LCByYXcpIHsKICAgIHRoaXMucHJlZGVmaW5lZCA9IHByZWRlZmluZWQ7CiAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKICAgIHRoaXMuY2hhcnNldCA9IGNoYXJzZXQ7CiAgICB0aGlzLnJhdyA9IHJhdzsKICB9Cgp9CgpleHBvcnRzLkNGRkNoYXJzZXQgPSBDRkZDaGFyc2V0OwoKY2xhc3MgQ0ZGRW5jb2RpbmcgewogIGNvbnN0cnVjdG9yKHByZWRlZmluZWQsIGZvcm1hdCwgZW5jb2RpbmcsIHJhdykgewogICAgdGhpcy5wcmVkZWZpbmVkID0gcHJlZGVmaW5lZDsKICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwogICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwogICAgdGhpcy5yYXcgPSByYXc7CiAgfQoKfQoKY2xhc3MgQ0ZGRkRTZWxlY3QgewogIGNvbnN0cnVjdG9yKGZvcm1hdCwgZmRTZWxlY3QpIHsKICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwogICAgdGhpcy5mZFNlbGVjdCA9IGZkU2VsZWN0OwogIH0KCiAgZ2V0RkRJbmRleChnbHlwaEluZGV4KSB7CiAgICBpZiAoZ2x5cGhJbmRleCA8IDAgfHwgZ2x5cGhJbmRleCA+PSB0aGlzLmZkU2VsZWN0Lmxlbmd0aCkgewogICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuZmRTZWxlY3RbZ2x5cGhJbmRleF07CiAgfQoKfQoKZXhwb3J0cy5DRkZGRFNlbGVjdCA9IENGRkZEU2VsZWN0OwoKY2xhc3MgQ0ZGT2Zmc2V0VHJhY2tlciB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLm9mZnNldHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIH0KCiAgaXNUcmFja2luZyhrZXkpIHsKICAgIHJldHVybiBrZXkgaW4gdGhpcy5vZmZzZXRzOwogIH0KCiAgdHJhY2soa2V5LCBsb2NhdGlvbikgewogICAgaWYgKGtleSBpbiB0aGlzLm9mZnNldHMpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBBbHJlYWR5IHRyYWNraW5nIGxvY2F0aW9uIG9mICR7a2V5fWApOwogICAgfQoKICAgIHRoaXMub2Zmc2V0c1trZXldID0gbG9jYXRpb247CiAgfQoKICBvZmZzZXQodmFsdWUpIHsKICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMub2Zmc2V0cykgewogICAgICB0aGlzLm9mZnNldHNba2V5XSArPSB2YWx1ZTsKICAgIH0KICB9CgogIHNldEVudHJ5TG9jYXRpb24oa2V5LCB2YWx1ZXMsIG91dHB1dCkgewogICAgaWYgKCEoa2V5IGluIHRoaXMub2Zmc2V0cykpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBOb3QgdHJhY2tpbmcgbG9jYXRpb24gb2YgJHtrZXl9YCk7CiAgICB9CgogICAgY29uc3QgZGF0YSA9IG91dHB1dC5kYXRhOwogICAgY29uc3QgZGF0YU9mZnNldCA9IHRoaXMub2Zmc2V0c1trZXldOwogICAgY29uc3Qgc2l6ZSA9IDU7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdmFsdWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgY29uc3Qgb2Zmc2V0MCA9IGkgKiBzaXplICsgZGF0YU9mZnNldDsKICAgICAgY29uc3Qgb2Zmc2V0MSA9IG9mZnNldDAgKyAxOwogICAgICBjb25zdCBvZmZzZXQyID0gb2Zmc2V0MCArIDI7CiAgICAgIGNvbnN0IG9mZnNldDMgPSBvZmZzZXQwICsgMzsKICAgICAgY29uc3Qgb2Zmc2V0NCA9IG9mZnNldDAgKyA0OwoKICAgICAgaWYgKGRhdGFbb2Zmc2V0MF0gIT09IDB4MWQgfHwgZGF0YVtvZmZzZXQxXSAhPT0gMCB8fCBkYXRhW29mZnNldDJdICE9PSAwIHx8IGRhdGFbb2Zmc2V0M10gIT09IDAgfHwgZGF0YVtvZmZzZXQ0XSAhPT0gMCkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigid3JpdGluZyB0byBhbiBvZmZzZXQgdGhhdCBpcyBub3QgZW1wdHkiKTsKICAgICAgfQoKICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaV07CiAgICAgIGRhdGFbb2Zmc2V0MF0gPSAweDFkOwogICAgICBkYXRhW29mZnNldDFdID0gdmFsdWUgPj4gMjQgJiAweGZmOwogICAgICBkYXRhW29mZnNldDJdID0gdmFsdWUgPj4gMTYgJiAweGZmOwogICAgICBkYXRhW29mZnNldDNdID0gdmFsdWUgPj4gOCAmIDB4ZmY7CiAgICAgIGRhdGFbb2Zmc2V0NF0gPSB2YWx1ZSAmIDB4ZmY7CiAgICB9CiAgfQoKfQoKY2xhc3MgQ0ZGQ29tcGlsZXIgewogIGNvbnN0cnVjdG9yKGNmZikgewogICAgdGhpcy5jZmYgPSBjZmY7CiAgfQoKICBjb21waWxlKCkgewogICAgY29uc3QgY2ZmID0gdGhpcy5jZmY7CiAgICBjb25zdCBvdXRwdXQgPSB7CiAgICAgIGRhdGE6IFtdLAogICAgICBsZW5ndGg6IDAsCgogICAgICBhZGQoZGF0YSkgewogICAgICAgIHRoaXMuZGF0YSA9IHRoaXMuZGF0YS5jb25jYXQoZGF0YSk7CiAgICAgICAgdGhpcy5sZW5ndGggPSB0aGlzLmRhdGEubGVuZ3RoOwogICAgICB9CgogICAgfTsKICAgIGNvbnN0IGhlYWRlciA9IHRoaXMuY29tcGlsZUhlYWRlcihjZmYuaGVhZGVyKTsKICAgIG91dHB1dC5hZGQoaGVhZGVyKTsKICAgIGNvbnN0IG5hbWVJbmRleCA9IHRoaXMuY29tcGlsZU5hbWVJbmRleChjZmYubmFtZXMpOwogICAgb3V0cHV0LmFkZChuYW1lSW5kZXgpOwoKICAgIGlmIChjZmYuaXNDSURGb250KSB7CiAgICAgIGlmIChjZmYudG9wRGljdC5oYXNOYW1lKCJGb250TWF0cml4IikpIHsKICAgICAgICBjb25zdCBiYXNlID0gY2ZmLnRvcERpY3QuZ2V0QnlOYW1lKCJGb250TWF0cml4Iik7CiAgICAgICAgY2ZmLnRvcERpY3QucmVtb3ZlQnlOYW1lKCJGb250TWF0cml4Iik7CgogICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNmZi5mZEFycmF5Lmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHN1YkRpY3QgPSBjZmYuZmRBcnJheVtpXTsKICAgICAgICAgIGxldCBtYXRyaXggPSBiYXNlLnNsaWNlKDApOwoKICAgICAgICAgIGlmIChzdWJEaWN0Lmhhc05hbWUoIkZvbnRNYXRyaXgiKSkgewogICAgICAgICAgICBtYXRyaXggPSBfdXRpbC5VdGlsLnRyYW5zZm9ybShtYXRyaXgsIHN1YkRpY3QuZ2V0QnlOYW1lKCJGb250TWF0cml4IikpOwogICAgICAgICAgfQoKICAgICAgICAgIHN1YkRpY3Quc2V0QnlOYW1lKCJGb250TWF0cml4IiwgbWF0cml4KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCB4dWlkID0gY2ZmLnRvcERpY3QuZ2V0QnlOYW1lKCJYVUlEIik7CgogICAgaWYgKHh1aWQgJiYgeHVpZC5sZW5ndGggPiAxNikgewogICAgICBjZmYudG9wRGljdC5yZW1vdmVCeU5hbWUoIlhVSUQiKTsKICAgIH0KCiAgICBjZmYudG9wRGljdC5zZXRCeU5hbWUoImNoYXJzZXQiLCAwKTsKICAgIGxldCBjb21waWxlZCA9IHRoaXMuY29tcGlsZVRvcERpY3RzKFtjZmYudG9wRGljdF0sIG91dHB1dC5sZW5ndGgsIGNmZi5pc0NJREZvbnQpOwogICAgb3V0cHV0LmFkZChjb21waWxlZC5vdXRwdXQpOwogICAgY29uc3QgdG9wRGljdFRyYWNrZXIgPSBjb21waWxlZC50cmFja2Vyc1swXTsKICAgIGNvbnN0IHN0cmluZ0luZGV4ID0gdGhpcy5jb21waWxlU3RyaW5nSW5kZXgoY2ZmLnN0cmluZ3Muc3RyaW5ncyk7CiAgICBvdXRwdXQuYWRkKHN0cmluZ0luZGV4KTsKICAgIGNvbnN0IGdsb2JhbFN1YnJJbmRleCA9IHRoaXMuY29tcGlsZUluZGV4KGNmZi5nbG9iYWxTdWJySW5kZXgpOwogICAgb3V0cHV0LmFkZChnbG9iYWxTdWJySW5kZXgpOwoKICAgIGlmIChjZmYuZW5jb2RpbmcgJiYgY2ZmLnRvcERpY3QuaGFzTmFtZSgiRW5jb2RpbmciKSkgewogICAgICBpZiAoY2ZmLmVuY29kaW5nLnByZWRlZmluZWQpIHsKICAgICAgICB0b3BEaWN0VHJhY2tlci5zZXRFbnRyeUxvY2F0aW9uKCJFbmNvZGluZyIsIFtjZmYuZW5jb2RpbmcuZm9ybWF0XSwgb3V0cHV0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBlbmNvZGluZyA9IHRoaXMuY29tcGlsZUVuY29kaW5nKGNmZi5lbmNvZGluZyk7CiAgICAgICAgdG9wRGljdFRyYWNrZXIuc2V0RW50cnlMb2NhdGlvbigiRW5jb2RpbmciLCBbb3V0cHV0Lmxlbmd0aF0sIG91dHB1dCk7CiAgICAgICAgb3V0cHV0LmFkZChlbmNvZGluZyk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBjaGFyc2V0ID0gdGhpcy5jb21waWxlQ2hhcnNldChjZmYuY2hhcnNldCwgY2ZmLmNoYXJTdHJpbmdzLmNvdW50LCBjZmYuc3RyaW5ncywgY2ZmLmlzQ0lERm9udCk7CiAgICB0b3BEaWN0VHJhY2tlci5zZXRFbnRyeUxvY2F0aW9uKCJjaGFyc2V0IiwgW291dHB1dC5sZW5ndGhdLCBvdXRwdXQpOwogICAgb3V0cHV0LmFkZChjaGFyc2V0KTsKICAgIGNvbnN0IGNoYXJTdHJpbmdzID0gdGhpcy5jb21waWxlQ2hhclN0cmluZ3MoY2ZmLmNoYXJTdHJpbmdzKTsKICAgIHRvcERpY3RUcmFja2VyLnNldEVudHJ5TG9jYXRpb24oIkNoYXJTdHJpbmdzIiwgW291dHB1dC5sZW5ndGhdLCBvdXRwdXQpOwogICAgb3V0cHV0LmFkZChjaGFyU3RyaW5ncyk7CgogICAgaWYgKGNmZi5pc0NJREZvbnQpIHsKICAgICAgdG9wRGljdFRyYWNrZXIuc2V0RW50cnlMb2NhdGlvbigiRkRTZWxlY3QiLCBbb3V0cHV0Lmxlbmd0aF0sIG91dHB1dCk7CiAgICAgIGNvbnN0IGZkU2VsZWN0ID0gdGhpcy5jb21waWxlRkRTZWxlY3QoY2ZmLmZkU2VsZWN0KTsKICAgICAgb3V0cHV0LmFkZChmZFNlbGVjdCk7CiAgICAgIGNvbXBpbGVkID0gdGhpcy5jb21waWxlVG9wRGljdHMoY2ZmLmZkQXJyYXksIG91dHB1dC5sZW5ndGgsIHRydWUpOwogICAgICB0b3BEaWN0VHJhY2tlci5zZXRFbnRyeUxvY2F0aW9uKCJGREFycmF5IiwgW291dHB1dC5sZW5ndGhdLCBvdXRwdXQpOwogICAgICBvdXRwdXQuYWRkKGNvbXBpbGVkLm91dHB1dCk7CiAgICAgIGNvbnN0IGZvbnREaWN0VHJhY2tlcnMgPSBjb21waWxlZC50cmFja2VyczsKICAgICAgdGhpcy5jb21waWxlUHJpdmF0ZURpY3RzKGNmZi5mZEFycmF5LCBmb250RGljdFRyYWNrZXJzLCBvdXRwdXQpOwogICAgfQoKICAgIHRoaXMuY29tcGlsZVByaXZhdGVEaWN0cyhbY2ZmLnRvcERpY3RdLCBbdG9wRGljdFRyYWNrZXJdLCBvdXRwdXQpOwogICAgb3V0cHV0LmFkZChbMF0pOwogICAgcmV0dXJuIG91dHB1dC5kYXRhOwogIH0KCiAgZW5jb2RlTnVtYmVyKHZhbHVlKSB7CiAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSkpIHsKICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlSW50ZWdlcih2YWx1ZSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuZW5jb2RlRmxvYXQodmFsdWUpOwogIH0KCiAgc3RhdGljIGdldCBFbmNvZGVGbG9hdFJlZ0V4cCgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiRW5jb2RlRmxvYXRSZWdFeHAiLCAvXC4oXGQqPykoPzo5ezUsMjB9fDB7NSwyMH0pXGR7MCwyfSg/OmUoLispfCQpLyk7CiAgfQoKICBlbmNvZGVGbG9hdChudW0pIHsKICAgIGxldCB2YWx1ZSA9IG51bS50b1N0cmluZygpOwogICAgY29uc3QgbSA9IENGRkNvbXBpbGVyLkVuY29kZUZsb2F0UmVnRXhwLmV4ZWModmFsdWUpOwoKICAgIGlmIChtKSB7CiAgICAgIGNvbnN0IGVwc2lsb24gPSBwYXJzZUZsb2F0KCIxZSIgKyAoKG1bMl0gPyArbVsyXSA6IDApICsgbVsxXS5sZW5ndGgpKTsKICAgICAgdmFsdWUgPSAoTWF0aC5yb3VuZChudW0gKiBlcHNpbG9uKSAvIGVwc2lsb24pLnRvU3RyaW5nKCk7CiAgICB9CgogICAgbGV0IG5pYmJsZXMgPSAiIjsKICAgIGxldCBpLCBpaTsKCiAgICBmb3IgKGkgPSAwLCBpaSA9IHZhbHVlLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgY29uc3QgYSA9IHZhbHVlW2ldOwoKICAgICAgaWYgKGEgPT09ICJlIikgewogICAgICAgIG5pYmJsZXMgKz0gdmFsdWVbKytpXSA9PT0gIi0iID8gImMiIDogImIiOwogICAgICB9IGVsc2UgaWYgKGEgPT09ICIuIikgewogICAgICAgIG5pYmJsZXMgKz0gImEiOwogICAgICB9IGVsc2UgaWYgKGEgPT09ICItIikgewogICAgICAgIG5pYmJsZXMgKz0gImUiOwogICAgICB9IGVsc2UgewogICAgICAgIG5pYmJsZXMgKz0gYTsKICAgICAgfQogICAgfQoKICAgIG5pYmJsZXMgKz0gbmliYmxlcy5sZW5ndGggJiAxID8gImYiIDogImZmIjsKICAgIGNvbnN0IG91dCA9IFszMF07CgogICAgZm9yIChpID0gMCwgaWkgPSBuaWJibGVzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHsKICAgICAgb3V0LnB1c2gocGFyc2VJbnQobmliYmxlcy5zdWJzdHJpbmcoaSwgaSArIDIpLCAxNikpOwogICAgfQoKICAgIHJldHVybiBvdXQ7CiAgfQoKICBlbmNvZGVJbnRlZ2VyKHZhbHVlKSB7CiAgICBsZXQgY29kZTsKCiAgICBpZiAodmFsdWUgPj0gLTEwNyAmJiB2YWx1ZSA8PSAxMDcpIHsKICAgICAgY29kZSA9IFt2YWx1ZSArIDEzOV07CiAgICB9IGVsc2UgaWYgKHZhbHVlID49IDEwOCAmJiB2YWx1ZSA8PSAxMTMxKSB7CiAgICAgIHZhbHVlIC09IDEwODsKICAgICAgY29kZSA9IFsodmFsdWUgPj4gOCkgKyAyNDcsIHZhbHVlICYgMHhmZl07CiAgICB9IGVsc2UgaWYgKHZhbHVlID49IC0xMTMxICYmIHZhbHVlIDw9IC0xMDgpIHsKICAgICAgdmFsdWUgPSAtdmFsdWUgLSAxMDg7CiAgICAgIGNvZGUgPSBbKHZhbHVlID4+IDgpICsgMjUxLCB2YWx1ZSAmIDB4ZmZdOwogICAgfSBlbHNlIGlmICh2YWx1ZSA+PSAtMzI3NjggJiYgdmFsdWUgPD0gMzI3NjcpIHsKICAgICAgY29kZSA9IFsweDFjLCB2YWx1ZSA+PiA4ICYgMHhmZiwgdmFsdWUgJiAweGZmXTsKICAgIH0gZWxzZSB7CiAgICAgIGNvZGUgPSBbMHgxZCwgdmFsdWUgPj4gMjQgJiAweGZmLCB2YWx1ZSA+PiAxNiAmIDB4ZmYsIHZhbHVlID4+IDggJiAweGZmLCB2YWx1ZSAmIDB4ZmZdOwogICAgfQoKICAgIHJldHVybiBjb2RlOwogIH0KCiAgY29tcGlsZUhlYWRlcihoZWFkZXIpIHsKICAgIHJldHVybiBbaGVhZGVyLm1ham9yLCBoZWFkZXIubWlub3IsIDQsIGhlYWRlci5vZmZTaXplXTsKICB9CgogIGNvbXBpbGVOYW1lSW5kZXgobmFtZXMpIHsKICAgIGNvbnN0IG5hbWVJbmRleCA9IG5ldyBDRkZJbmRleCgpOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IG5hbWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgY29uc3QgbmFtZSA9IG5hbWVzW2ldOwogICAgICBjb25zdCBsZW5ndGggPSBNYXRoLm1pbihuYW1lLmxlbmd0aCwgMTI3KTsKICAgICAgbGV0IHNhbml0aXplZE5hbWUgPSBuZXcgQXJyYXkobGVuZ3RoKTsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbGVuZ3RoOyBqKyspIHsKICAgICAgICBsZXQgY2hhciA9IG5hbWVbal07CgogICAgICAgIGlmIChjaGFyIDwgIiEiIHx8IGNoYXIgPiAifiIgfHwgY2hhciA9PT0gIlsiIHx8IGNoYXIgPT09ICJdIiB8fCBjaGFyID09PSAiKCIgfHwgY2hhciA9PT0gIikiIHx8IGNoYXIgPT09ICJ7IiB8fCBjaGFyID09PSAifSIgfHwgY2hhciA9PT0gIjwiIHx8IGNoYXIgPT09ICI+IiB8fCBjaGFyID09PSAiLyIgfHwgY2hhciA9PT0gIiUiKSB7CiAgICAgICAgICBjaGFyID0gIl8iOwogICAgICAgIH0KCiAgICAgICAgc2FuaXRpemVkTmFtZVtqXSA9IGNoYXI7CiAgICAgIH0KCiAgICAgIHNhbml0aXplZE5hbWUgPSBzYW5pdGl6ZWROYW1lLmpvaW4oIiIpOwoKICAgICAgaWYgKHNhbml0aXplZE5hbWUgPT09ICIiKSB7CiAgICAgICAgc2FuaXRpemVkTmFtZSA9ICJCYWRfRm9udF9OYW1lIjsKICAgICAgfQoKICAgICAgbmFtZUluZGV4LmFkZCgoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoc2FuaXRpemVkTmFtZSkpOwogICAgfQoKICAgIHJldHVybiB0aGlzLmNvbXBpbGVJbmRleChuYW1lSW5kZXgpOwogIH0KCiAgY29tcGlsZVRvcERpY3RzKGRpY3RzLCBsZW5ndGgsIHJlbW92ZUNpZEtleXMpIHsKICAgIGNvbnN0IGZvbnREaWN0VHJhY2tlcnMgPSBbXTsKICAgIGxldCBmZEFycmF5SW5kZXggPSBuZXcgQ0ZGSW5kZXgoKTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBkaWN0cy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIGNvbnN0IGZvbnREaWN0ID0gZGljdHNbaV07CgogICAgICBpZiAocmVtb3ZlQ2lkS2V5cykgewogICAgICAgIGZvbnREaWN0LnJlbW92ZUJ5TmFtZSgiQ0lERm9udFZlcnNpb24iKTsKICAgICAgICBmb250RGljdC5yZW1vdmVCeU5hbWUoIkNJREZvbnRSZXZpc2lvbiIpOwogICAgICAgIGZvbnREaWN0LnJlbW92ZUJ5TmFtZSgiQ0lERm9udFR5cGUiKTsKICAgICAgICBmb250RGljdC5yZW1vdmVCeU5hbWUoIkNJRENvdW50Iik7CiAgICAgICAgZm9udERpY3QucmVtb3ZlQnlOYW1lKCJVSURCYXNlIik7CiAgICAgIH0KCiAgICAgIGNvbnN0IGZvbnREaWN0VHJhY2tlciA9IG5ldyBDRkZPZmZzZXRUcmFja2VyKCk7CiAgICAgIGNvbnN0IGZvbnREaWN0RGF0YSA9IHRoaXMuY29tcGlsZURpY3QoZm9udERpY3QsIGZvbnREaWN0VHJhY2tlcik7CiAgICAgIGZvbnREaWN0VHJhY2tlcnMucHVzaChmb250RGljdFRyYWNrZXIpOwogICAgICBmZEFycmF5SW5kZXguYWRkKGZvbnREaWN0RGF0YSk7CiAgICAgIGZvbnREaWN0VHJhY2tlci5vZmZzZXQobGVuZ3RoKTsKICAgIH0KCiAgICBmZEFycmF5SW5kZXggPSB0aGlzLmNvbXBpbGVJbmRleChmZEFycmF5SW5kZXgsIGZvbnREaWN0VHJhY2tlcnMpOwogICAgcmV0dXJuIHsKICAgICAgdHJhY2tlcnM6IGZvbnREaWN0VHJhY2tlcnMsCiAgICAgIG91dHB1dDogZmRBcnJheUluZGV4CiAgICB9OwogIH0KCiAgY29tcGlsZVByaXZhdGVEaWN0cyhkaWN0cywgdHJhY2tlcnMsIG91dHB1dCkgewogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGljdHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICBjb25zdCBmb250RGljdCA9IGRpY3RzW2ldOwogICAgICBjb25zdCBwcml2YXRlRGljdCA9IGZvbnREaWN0LnByaXZhdGVEaWN0OwoKICAgICAgaWYgKCFwcml2YXRlRGljdCB8fCAhZm9udERpY3QuaGFzTmFtZSgiUHJpdmF0ZSIpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJUaGVyZSBtdXN0IGJlIGEgcHJpdmF0ZSBkaWN0aW9uYXJ5LiIpOwogICAgICB9CgogICAgICBjb25zdCBwcml2YXRlRGljdFRyYWNrZXIgPSBuZXcgQ0ZGT2Zmc2V0VHJhY2tlcigpOwogICAgICBjb25zdCBwcml2YXRlRGljdERhdGEgPSB0aGlzLmNvbXBpbGVEaWN0KHByaXZhdGVEaWN0LCBwcml2YXRlRGljdFRyYWNrZXIpOwogICAgICBsZXQgb3V0cHV0TGVuZ3RoID0gb3V0cHV0Lmxlbmd0aDsKICAgICAgcHJpdmF0ZURpY3RUcmFja2VyLm9mZnNldChvdXRwdXRMZW5ndGgpOwoKICAgICAgaWYgKCFwcml2YXRlRGljdERhdGEubGVuZ3RoKSB7CiAgICAgICAgb3V0cHV0TGVuZ3RoID0gMDsKICAgICAgfQoKICAgICAgdHJhY2tlcnNbaV0uc2V0RW50cnlMb2NhdGlvbigiUHJpdmF0ZSIsIFtwcml2YXRlRGljdERhdGEubGVuZ3RoLCBvdXRwdXRMZW5ndGhdLCBvdXRwdXQpOwogICAgICBvdXRwdXQuYWRkKHByaXZhdGVEaWN0RGF0YSk7CgogICAgICBpZiAocHJpdmF0ZURpY3Quc3VicnNJbmRleCAmJiBwcml2YXRlRGljdC5oYXNOYW1lKCJTdWJycyIpKSB7CiAgICAgICAgY29uc3Qgc3VicnMgPSB0aGlzLmNvbXBpbGVJbmRleChwcml2YXRlRGljdC5zdWJyc0luZGV4KTsKICAgICAgICBwcml2YXRlRGljdFRyYWNrZXIuc2V0RW50cnlMb2NhdGlvbigiU3VicnMiLCBbcHJpdmF0ZURpY3REYXRhLmxlbmd0aF0sIG91dHB1dCk7CiAgICAgICAgb3V0cHV0LmFkZChzdWJycyk7CiAgICAgIH0KICAgIH0KICB9CgogIGNvbXBpbGVEaWN0KGRpY3QsIG9mZnNldFRyYWNrZXIpIHsKICAgIGNvbnN0IG91dCA9IFtdOwoKICAgIGZvciAoY29uc3Qga2V5IG9mIGRpY3Qub3JkZXIpIHsKICAgICAgaWYgKCEoa2V5IGluIGRpY3QudmFsdWVzKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBsZXQgdmFsdWVzID0gZGljdC52YWx1ZXNba2V5XTsKICAgICAgbGV0IHR5cGVzID0gZGljdC50eXBlc1trZXldOwoKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHR5cGVzKSkgewogICAgICAgIHR5cGVzID0gW3R5cGVzXTsKICAgICAgfQoKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlcykpIHsKICAgICAgICB2YWx1ZXMgPSBbdmFsdWVzXTsKICAgICAgfQoKICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPT09IDApIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IDAsIGpqID0gdHlwZXMubGVuZ3RoOyBqIDwgamo7ICsraikgewogICAgICAgIGNvbnN0IHR5cGUgPSB0eXBlc1tqXTsKICAgICAgICBjb25zdCB2YWx1ZSA9IHZhbHVlc1tqXTsKCiAgICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICBjYXNlICJudW0iOgogICAgICAgICAgY2FzZSAic2lkIjoKICAgICAgICAgICAgb3V0LnB1c2goLi4udGhpcy5lbmNvZGVOdW1iZXIodmFsdWUpKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAib2Zmc2V0IjoKICAgICAgICAgICAgY29uc3QgbmFtZSA9IGRpY3Qua2V5VG9OYW1lTWFwW2tleV07CgogICAgICAgICAgICBpZiAoIW9mZnNldFRyYWNrZXIuaXNUcmFja2luZyhuYW1lKSkgewogICAgICAgICAgICAgIG9mZnNldFRyYWNrZXIudHJhY2sobmFtZSwgb3V0Lmxlbmd0aCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG91dC5wdXNoKDB4MWQsIDAsIDAsIDAsIDApOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJhcnJheSI6CiAgICAgICAgICBjYXNlICJkZWx0YSI6CiAgICAgICAgICAgIG91dC5wdXNoKC4uLnRoaXMuZW5jb2RlTnVtYmVyKHZhbHVlKSk7CgogICAgICAgICAgICBmb3IgKGxldCBrID0gMSwga2sgPSB2YWx1ZXMubGVuZ3RoOyBrIDwga2s7ICsraykgewogICAgICAgICAgICAgIG91dC5wdXNoKC4uLnRoaXMuZW5jb2RlTnVtYmVyKHZhbHVlc1trXSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVua25vd24gZGF0YSB0eXBlIG9mICR7dHlwZX1gKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG91dC5wdXNoKC4uLmRpY3Qub3Bjb2Rlc1trZXldKTsKICAgIH0KCiAgICByZXR1cm4gb3V0OwogIH0KCiAgY29tcGlsZVN0cmluZ0luZGV4KHN0cmluZ3MpIHsKICAgIGNvbnN0IHN0cmluZ0luZGV4ID0gbmV3IENGRkluZGV4KCk7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gc3RyaW5ncy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIHN0cmluZ0luZGV4LmFkZCgoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoc3RyaW5nc1tpXSkpOwogICAgfQoKICAgIHJldHVybiB0aGlzLmNvbXBpbGVJbmRleChzdHJpbmdJbmRleCk7CiAgfQoKICBjb21waWxlR2xvYmFsU3VickluZGV4KCkgewogICAgY29uc3QgZ2xvYmFsU3VickluZGV4ID0gdGhpcy5jZmYuZ2xvYmFsU3VickluZGV4OwogICAgdGhpcy5vdXQud3JpdGVCeXRlQXJyYXkodGhpcy5jb21waWxlSW5kZXgoZ2xvYmFsU3VickluZGV4KSk7CiAgfQoKICBjb21waWxlQ2hhclN0cmluZ3MoY2hhclN0cmluZ3MpIHsKICAgIGNvbnN0IGNoYXJTdHJpbmdzSW5kZXggPSBuZXcgQ0ZGSW5kZXgoKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoYXJTdHJpbmdzLmNvdW50OyBpKyspIHsKICAgICAgY29uc3QgZ2x5cGggPSBjaGFyU3RyaW5ncy5nZXQoaSk7CgogICAgICBpZiAoZ2x5cGgubGVuZ3RoID09PSAwKSB7CiAgICAgICAgY2hhclN0cmluZ3NJbmRleC5hZGQobmV3IFVpbnQ4QXJyYXkoWzB4OGIsIDB4MGVdKSk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNoYXJTdHJpbmdzSW5kZXguYWRkKGdseXBoKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5jb21waWxlSW5kZXgoY2hhclN0cmluZ3NJbmRleCk7CiAgfQoKICBjb21waWxlQ2hhcnNldChjaGFyc2V0LCBudW1HbHlwaHMsIHN0cmluZ3MsIGlzQ0lERm9udCkgewogICAgbGV0IG91dDsKICAgIGNvbnN0IG51bUdseXBoc0xlc3NOb3REZWYgPSBudW1HbHlwaHMgLSAxOwoKICAgIGlmIChpc0NJREZvbnQpIHsKICAgICAgb3V0ID0gbmV3IFVpbnQ4QXJyYXkoWzIsIDAsIDAsIG51bUdseXBoc0xlc3NOb3REZWYgPj4gOCAmIDB4ZmYsIG51bUdseXBoc0xlc3NOb3REZWYgJiAweGZmXSk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBsZW5ndGggPSAxICsgbnVtR2x5cGhzTGVzc05vdERlZiAqIDI7CiAgICAgIG91dCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7CiAgICAgIG91dFswXSA9IDA7CiAgICAgIGxldCBjaGFyc2V0SW5kZXggPSAwOwogICAgICBjb25zdCBudW1DaGFyc2V0cyA9IGNoYXJzZXQuY2hhcnNldC5sZW5ndGg7CiAgICAgIGxldCB3YXJuZWQgPSBmYWxzZTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgb3V0Lmxlbmd0aDsgaSArPSAyKSB7CiAgICAgICAgbGV0IHNpZCA9IDA7CgogICAgICAgIGlmIChjaGFyc2V0SW5kZXggPCBudW1DaGFyc2V0cykgewogICAgICAgICAgY29uc3QgbmFtZSA9IGNoYXJzZXQuY2hhcnNldFtjaGFyc2V0SW5kZXgrK107CiAgICAgICAgICBzaWQgPSBzdHJpbmdzLmdldFNJRChuYW1lKTsKCiAgICAgICAgICBpZiAoc2lkID09PSAtMSkgewogICAgICAgICAgICBzaWQgPSAwOwoKICAgICAgICAgICAgaWYgKCF3YXJuZWQpIHsKICAgICAgICAgICAgICB3YXJuZWQgPSB0cnVlOwogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgQ291bGRuJ3QgZmluZCAke25hbWV9IGluIENGRiBzdHJpbmdzYCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG91dFtpXSA9IHNpZCA+PiA4ICYgMHhmZjsKICAgICAgICBvdXRbaSArIDFdID0gc2lkICYgMHhmZjsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0aGlzLmNvbXBpbGVUeXBlZEFycmF5KG91dCk7CiAgfQoKICBjb21waWxlRW5jb2RpbmcoZW5jb2RpbmcpIHsKICAgIHJldHVybiB0aGlzLmNvbXBpbGVUeXBlZEFycmF5KGVuY29kaW5nLnJhdyk7CiAgfQoKICBjb21waWxlRkRTZWxlY3QoZmRTZWxlY3QpIHsKICAgIGNvbnN0IGZvcm1hdCA9IGZkU2VsZWN0LmZvcm1hdDsKICAgIGxldCBvdXQsIGk7CgogICAgc3dpdGNoIChmb3JtYXQpIHsKICAgICAgY2FzZSAwOgogICAgICAgIG91dCA9IG5ldyBVaW50OEFycmF5KDEgKyBmZFNlbGVjdC5mZFNlbGVjdC5sZW5ndGgpOwogICAgICAgIG91dFswXSA9IGZvcm1hdDsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IGZkU2VsZWN0LmZkU2VsZWN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBvdXRbaSArIDFdID0gZmRTZWxlY3QuZmRTZWxlY3RbaV07CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzoKICAgICAgICBjb25zdCBzdGFydCA9IDA7CiAgICAgICAgbGV0IGxhc3RGRCA9IGZkU2VsZWN0LmZkU2VsZWN0WzBdOwogICAgICAgIGNvbnN0IHJhbmdlcyA9IFtmb3JtYXQsIDAsIDAsIHN0YXJ0ID4+IDggJiAweGZmLCBzdGFydCAmIDB4ZmYsIGxhc3RGRF07CgogICAgICAgIGZvciAoaSA9IDE7IGkgPCBmZFNlbGVjdC5mZFNlbGVjdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3QgY3VycmVudEZEID0gZmRTZWxlY3QuZmRTZWxlY3RbaV07CgogICAgICAgICAgaWYgKGN1cnJlbnRGRCAhPT0gbGFzdEZEKSB7CiAgICAgICAgICAgIHJhbmdlcy5wdXNoKGkgPj4gOCAmIDB4ZmYsIGkgJiAweGZmLCBjdXJyZW50RkQpOwogICAgICAgICAgICBsYXN0RkQgPSBjdXJyZW50RkQ7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb25zdCBudW1SYW5nZXMgPSAocmFuZ2VzLmxlbmd0aCAtIDMpIC8gMzsKICAgICAgICByYW5nZXNbMV0gPSBudW1SYW5nZXMgPj4gOCAmIDB4ZmY7CiAgICAgICAgcmFuZ2VzWzJdID0gbnVtUmFuZ2VzICYgMHhmZjsKICAgICAgICByYW5nZXMucHVzaChpID4+IDggJiAweGZmLCBpICYgMHhmZik7CiAgICAgICAgb3V0ID0gbmV3IFVpbnQ4QXJyYXkocmFuZ2VzKTsKICAgICAgICBicmVhazsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5jb21waWxlVHlwZWRBcnJheShvdXQpOwogIH0KCiAgY29tcGlsZVR5cGVkQXJyYXkoZGF0YSkgewogICAgY29uc3Qgb3V0ID0gW107CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGF0YS5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIG91dFtpXSA9IGRhdGFbaV07CiAgICB9CgogICAgcmV0dXJuIG91dDsKICB9CgogIGNvbXBpbGVJbmRleChpbmRleCkgewogICAgbGV0IHRyYWNrZXJzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBbXTsKICAgIGNvbnN0IG9iamVjdHMgPSBpbmRleC5vYmplY3RzOwogICAgY29uc3QgY291bnQgPSBvYmplY3RzLmxlbmd0aDsKCiAgICBpZiAoY291bnQgPT09IDApIHsKICAgICAgcmV0dXJuIFswLCAwXTsKICAgIH0KCiAgICBjb25zdCBkYXRhID0gW2NvdW50ID4+IDggJiAweGZmLCBjb3VudCAmIDB4ZmZdOwogICAgbGV0IGxhc3RPZmZzZXQgPSAxLAogICAgICAgIGk7CgogICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyArK2kpIHsKICAgICAgbGFzdE9mZnNldCArPSBvYmplY3RzW2ldLmxlbmd0aDsKICAgIH0KCiAgICBsZXQgb2Zmc2V0U2l6ZTsKCiAgICBpZiAobGFzdE9mZnNldCA8IDB4MTAwKSB7CiAgICAgIG9mZnNldFNpemUgPSAxOwogICAgfSBlbHNlIGlmIChsYXN0T2Zmc2V0IDwgMHgxMDAwMCkgewogICAgICBvZmZzZXRTaXplID0gMjsKICAgIH0gZWxzZSBpZiAobGFzdE9mZnNldCA8IDB4MTAwMDAwMCkgewogICAgICBvZmZzZXRTaXplID0gMzsKICAgIH0gZWxzZSB7CiAgICAgIG9mZnNldFNpemUgPSA0OwogICAgfQoKICAgIGRhdGEucHVzaChvZmZzZXRTaXplKTsKICAgIGxldCByZWxhdGl2ZU9mZnNldCA9IDE7CgogICAgZm9yIChpID0gMDsgaSA8IGNvdW50ICsgMTsgaSsrKSB7CiAgICAgIGlmIChvZmZzZXRTaXplID09PSAxKSB7CiAgICAgICAgZGF0YS5wdXNoKHJlbGF0aXZlT2Zmc2V0ICYgMHhmZik7CiAgICAgIH0gZWxzZSBpZiAob2Zmc2V0U2l6ZSA9PT0gMikgewogICAgICAgIGRhdGEucHVzaChyZWxhdGl2ZU9mZnNldCA+PiA4ICYgMHhmZiwgcmVsYXRpdmVPZmZzZXQgJiAweGZmKTsKICAgICAgfSBlbHNlIGlmIChvZmZzZXRTaXplID09PSAzKSB7CiAgICAgICAgZGF0YS5wdXNoKHJlbGF0aXZlT2Zmc2V0ID4+IDE2ICYgMHhmZiwgcmVsYXRpdmVPZmZzZXQgPj4gOCAmIDB4ZmYsIHJlbGF0aXZlT2Zmc2V0ICYgMHhmZik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YS5wdXNoKHJlbGF0aXZlT2Zmc2V0ID4+PiAyNCAmIDB4ZmYsIHJlbGF0aXZlT2Zmc2V0ID4+IDE2ICYgMHhmZiwgcmVsYXRpdmVPZmZzZXQgPj4gOCAmIDB4ZmYsIHJlbGF0aXZlT2Zmc2V0ICYgMHhmZik7CiAgICAgIH0KCiAgICAgIGlmIChvYmplY3RzW2ldKSB7CiAgICAgICAgcmVsYXRpdmVPZmZzZXQgKz0gb2JqZWN0c1tpXS5sZW5ndGg7CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICBpZiAodHJhY2tlcnNbaV0pIHsKICAgICAgICB0cmFja2Vyc1tpXS5vZmZzZXQoZGF0YS5sZW5ndGgpOwogICAgICB9CgogICAgICBmb3IgKGxldCBqID0gMCwgamogPSBvYmplY3RzW2ldLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICBkYXRhLnB1c2gob2JqZWN0c1tpXVtqXSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZGF0YTsKICB9Cgp9CgpleHBvcnRzLkNGRkNvbXBpbGVyID0gQ0ZGQ29tcGlsZXI7CgovKioqLyB9KSwKLyogMTYxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5JU09BZG9iZUNoYXJzZXQgPSBleHBvcnRzLkV4cGVydFN1YnNldENoYXJzZXQgPSBleHBvcnRzLkV4cGVydENoYXJzZXQgPSB2b2lkIDA7CmNvbnN0IElTT0Fkb2JlQ2hhcnNldCA9IFsiLm5vdGRlZiIsICJzcGFjZSIsICJleGNsYW0iLCAicXVvdGVkYmwiLCAibnVtYmVyc2lnbiIsICJkb2xsYXIiLCAicGVyY2VudCIsICJhbXBlcnNhbmQiLCAicXVvdGVyaWdodCIsICJwYXJlbmxlZnQiLCAicGFyZW5yaWdodCIsICJhc3RlcmlzayIsICJwbHVzIiwgImNvbW1hIiwgImh5cGhlbiIsICJwZXJpb2QiLCAic2xhc2giLCAiemVybyIsICJvbmUiLCAidHdvIiwgInRocmVlIiwgImZvdXIiLCAiZml2ZSIsICJzaXgiLCAic2V2ZW4iLCAiZWlnaHQiLCAibmluZSIsICJjb2xvbiIsICJzZW1pY29sb24iLCAibGVzcyIsICJlcXVhbCIsICJncmVhdGVyIiwgInF1ZXN0aW9uIiwgImF0IiwgIkEiLCAiQiIsICJDIiwgIkQiLCAiRSIsICJGIiwgIkciLCAiSCIsICJJIiwgIkoiLCAiSyIsICJMIiwgIk0iLCAiTiIsICJPIiwgIlAiLCAiUSIsICJSIiwgIlMiLCAiVCIsICJVIiwgIlYiLCAiVyIsICJYIiwgIlkiLCAiWiIsICJicmFja2V0bGVmdCIsICJiYWNrc2xhc2giLCAiYnJhY2tldHJpZ2h0IiwgImFzY2lpY2lyY3VtIiwgInVuZGVyc2NvcmUiLCAicXVvdGVsZWZ0IiwgImEiLCAiYiIsICJjIiwgImQiLCAiZSIsICJmIiwgImciLCAiaCIsICJpIiwgImoiLCAiayIsICJsIiwgIm0iLCAibiIsICJvIiwgInAiLCAicSIsICJyIiwgInMiLCAidCIsICJ1IiwgInYiLCAidyIsICJ4IiwgInkiLCAieiIsICJicmFjZWxlZnQiLCAiYmFyIiwgImJyYWNlcmlnaHQiLCAiYXNjaWl0aWxkZSIsICJleGNsYW1kb3duIiwgImNlbnQiLCAic3RlcmxpbmciLCAiZnJhY3Rpb24iLCAieWVuIiwgImZsb3JpbiIsICJzZWN0aW9uIiwgImN1cnJlbmN5IiwgInF1b3Rlc2luZ2xlIiwgInF1b3RlZGJsbGVmdCIsICJndWlsbGVtb3RsZWZ0IiwgImd1aWxzaW5nbGxlZnQiLCAiZ3VpbHNpbmdscmlnaHQiLCAiZmkiLCAiZmwiLCAiZW5kYXNoIiwgImRhZ2dlciIsICJkYWdnZXJkYmwiLCAicGVyaW9kY2VudGVyZWQiLCAicGFyYWdyYXBoIiwgImJ1bGxldCIsICJxdW90ZXNpbmdsYmFzZSIsICJxdW90ZWRibGJhc2UiLCAicXVvdGVkYmxyaWdodCIsICJndWlsbGVtb3RyaWdodCIsICJlbGxpcHNpcyIsICJwZXJ0aG91c2FuZCIsICJxdWVzdGlvbmRvd24iLCAiZ3JhdmUiLCAiYWN1dGUiLCAiY2lyY3VtZmxleCIsICJ0aWxkZSIsICJtYWNyb24iLCAiYnJldmUiLCAiZG90YWNjZW50IiwgImRpZXJlc2lzIiwgInJpbmciLCAiY2VkaWxsYSIsICJodW5nYXJ1bWxhdXQiLCAib2dvbmVrIiwgImNhcm9uIiwgImVtZGFzaCIsICJBRSIsICJvcmRmZW1pbmluZSIsICJMc2xhc2giLCAiT3NsYXNoIiwgIk9FIiwgIm9yZG1hc2N1bGluZSIsICJhZSIsICJkb3RsZXNzaSIsICJsc2xhc2giLCAib3NsYXNoIiwgIm9lIiwgImdlcm1hbmRibHMiLCAib25lc3VwZXJpb3IiLCAibG9naWNhbG5vdCIsICJtdSIsICJ0cmFkZW1hcmsiLCAiRXRoIiwgIm9uZWhhbGYiLCAicGx1c21pbnVzIiwgIlRob3JuIiwgIm9uZXF1YXJ0ZXIiLCAiZGl2aWRlIiwgImJyb2tlbmJhciIsICJkZWdyZWUiLCAidGhvcm4iLCAidGhyZWVxdWFydGVycyIsICJ0d29zdXBlcmlvciIsICJyZWdpc3RlcmVkIiwgIm1pbnVzIiwgImV0aCIsICJtdWx0aXBseSIsICJ0aHJlZXN1cGVyaW9yIiwgImNvcHlyaWdodCIsICJBYWN1dGUiLCAiQWNpcmN1bWZsZXgiLCAiQWRpZXJlc2lzIiwgIkFncmF2ZSIsICJBcmluZyIsICJBdGlsZGUiLCAiQ2NlZGlsbGEiLCAiRWFjdXRlIiwgIkVjaXJjdW1mbGV4IiwgIkVkaWVyZXNpcyIsICJFZ3JhdmUiLCAiSWFjdXRlIiwgIkljaXJjdW1mbGV4IiwgIklkaWVyZXNpcyIsICJJZ3JhdmUiLCAiTnRpbGRlIiwgIk9hY3V0ZSIsICJPY2lyY3VtZmxleCIsICJPZGllcmVzaXMiLCAiT2dyYXZlIiwgIk90aWxkZSIsICJTY2Fyb24iLCAiVWFjdXRlIiwgIlVjaXJjdW1mbGV4IiwgIlVkaWVyZXNpcyIsICJVZ3JhdmUiLCAiWWFjdXRlIiwgIllkaWVyZXNpcyIsICJaY2Fyb24iLCAiYWFjdXRlIiwgImFjaXJjdW1mbGV4IiwgImFkaWVyZXNpcyIsICJhZ3JhdmUiLCAiYXJpbmciLCAiYXRpbGRlIiwgImNjZWRpbGxhIiwgImVhY3V0ZSIsICJlY2lyY3VtZmxleCIsICJlZGllcmVzaXMiLCAiZWdyYXZlIiwgImlhY3V0ZSIsICJpY2lyY3VtZmxleCIsICJpZGllcmVzaXMiLCAiaWdyYXZlIiwgIm50aWxkZSIsICJvYWN1dGUiLCAib2NpcmN1bWZsZXgiLCAib2RpZXJlc2lzIiwgIm9ncmF2ZSIsICJvdGlsZGUiLCAic2Nhcm9uIiwgInVhY3V0ZSIsICJ1Y2lyY3VtZmxleCIsICJ1ZGllcmVzaXMiLCAidWdyYXZlIiwgInlhY3V0ZSIsICJ5ZGllcmVzaXMiLCAiemNhcm9uIl07CmV4cG9ydHMuSVNPQWRvYmVDaGFyc2V0ID0gSVNPQWRvYmVDaGFyc2V0Owpjb25zdCBFeHBlcnRDaGFyc2V0ID0gWyIubm90ZGVmIiwgInNwYWNlIiwgImV4Y2xhbXNtYWxsIiwgIkh1bmdhcnVtbGF1dHNtYWxsIiwgImRvbGxhcm9sZHN0eWxlIiwgImRvbGxhcnN1cGVyaW9yIiwgImFtcGVyc2FuZHNtYWxsIiwgIkFjdXRlc21hbGwiLCAicGFyZW5sZWZ0c3VwZXJpb3IiLCAicGFyZW5yaWdodHN1cGVyaW9yIiwgInR3b2RvdGVubGVhZGVyIiwgIm9uZWRvdGVubGVhZGVyIiwgImNvbW1hIiwgImh5cGhlbiIsICJwZXJpb2QiLCAiZnJhY3Rpb24iLCAiemVyb29sZHN0eWxlIiwgIm9uZW9sZHN0eWxlIiwgInR3b29sZHN0eWxlIiwgInRocmVlb2xkc3R5bGUiLCAiZm91cm9sZHN0eWxlIiwgImZpdmVvbGRzdHlsZSIsICJzaXhvbGRzdHlsZSIsICJzZXZlbm9sZHN0eWxlIiwgImVpZ2h0b2xkc3R5bGUiLCAibmluZW9sZHN0eWxlIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJjb21tYXN1cGVyaW9yIiwgInRocmVlcXVhcnRlcnNlbWRhc2giLCAicGVyaW9kc3VwZXJpb3IiLCAicXVlc3Rpb25zbWFsbCIsICJhc3VwZXJpb3IiLCAiYnN1cGVyaW9yIiwgImNlbnRzdXBlcmlvciIsICJkc3VwZXJpb3IiLCAiZXN1cGVyaW9yIiwgImlzdXBlcmlvciIsICJsc3VwZXJpb3IiLCAibXN1cGVyaW9yIiwgIm5zdXBlcmlvciIsICJvc3VwZXJpb3IiLCAicnN1cGVyaW9yIiwgInNzdXBlcmlvciIsICJ0c3VwZXJpb3IiLCAiZmYiLCAiZmkiLCAiZmwiLCAiZmZpIiwgImZmbCIsICJwYXJlbmxlZnRpbmZlcmlvciIsICJwYXJlbnJpZ2h0aW5mZXJpb3IiLCAiQ2lyY3VtZmxleHNtYWxsIiwgImh5cGhlbnN1cGVyaW9yIiwgIkdyYXZlc21hbGwiLCAiQXNtYWxsIiwgIkJzbWFsbCIsICJDc21hbGwiLCAiRHNtYWxsIiwgIkVzbWFsbCIsICJGc21hbGwiLCAiR3NtYWxsIiwgIkhzbWFsbCIsICJJc21hbGwiLCAiSnNtYWxsIiwgIktzbWFsbCIsICJMc21hbGwiLCAiTXNtYWxsIiwgIk5zbWFsbCIsICJPc21hbGwiLCAiUHNtYWxsIiwgIlFzbWFsbCIsICJSc21hbGwiLCAiU3NtYWxsIiwgIlRzbWFsbCIsICJVc21hbGwiLCAiVnNtYWxsIiwgIldzbWFsbCIsICJYc21hbGwiLCAiWXNtYWxsIiwgIlpzbWFsbCIsICJjb2xvbm1vbmV0YXJ5IiwgIm9uZWZpdHRlZCIsICJydXBpYWgiLCAiVGlsZGVzbWFsbCIsICJleGNsYW1kb3duc21hbGwiLCAiY2VudG9sZHN0eWxlIiwgIkxzbGFzaHNtYWxsIiwgIlNjYXJvbnNtYWxsIiwgIlpjYXJvbnNtYWxsIiwgIkRpZXJlc2lzc21hbGwiLCAiQnJldmVzbWFsbCIsICJDYXJvbnNtYWxsIiwgIkRvdGFjY2VudHNtYWxsIiwgIk1hY3JvbnNtYWxsIiwgImZpZ3VyZWRhc2giLCAiaHlwaGVuaW5mZXJpb3IiLCAiT2dvbmVrc21hbGwiLCAiUmluZ3NtYWxsIiwgIkNlZGlsbGFzbWFsbCIsICJvbmVxdWFydGVyIiwgIm9uZWhhbGYiLCAidGhyZWVxdWFydGVycyIsICJxdWVzdGlvbmRvd25zbWFsbCIsICJvbmVlaWdodGgiLCAidGhyZWVlaWdodGhzIiwgImZpdmVlaWdodGhzIiwgInNldmVuZWlnaHRocyIsICJvbmV0aGlyZCIsICJ0d290aGlyZHMiLCAiemVyb3N1cGVyaW9yIiwgIm9uZXN1cGVyaW9yIiwgInR3b3N1cGVyaW9yIiwgInRocmVlc3VwZXJpb3IiLCAiZm91cnN1cGVyaW9yIiwgImZpdmVzdXBlcmlvciIsICJzaXhzdXBlcmlvciIsICJzZXZlbnN1cGVyaW9yIiwgImVpZ2h0c3VwZXJpb3IiLCAibmluZXN1cGVyaW9yIiwgInplcm9pbmZlcmlvciIsICJvbmVpbmZlcmlvciIsICJ0d29pbmZlcmlvciIsICJ0aHJlZWluZmVyaW9yIiwgImZvdXJpbmZlcmlvciIsICJmaXZlaW5mZXJpb3IiLCAic2l4aW5mZXJpb3IiLCAic2V2ZW5pbmZlcmlvciIsICJlaWdodGluZmVyaW9yIiwgIm5pbmVpbmZlcmlvciIsICJjZW50aW5mZXJpb3IiLCAiZG9sbGFyaW5mZXJpb3IiLCAicGVyaW9kaW5mZXJpb3IiLCAiY29tbWFpbmZlcmlvciIsICJBZ3JhdmVzbWFsbCIsICJBYWN1dGVzbWFsbCIsICJBY2lyY3VtZmxleHNtYWxsIiwgIkF0aWxkZXNtYWxsIiwgIkFkaWVyZXNpc3NtYWxsIiwgIkFyaW5nc21hbGwiLCAiQUVzbWFsbCIsICJDY2VkaWxsYXNtYWxsIiwgIkVncmF2ZXNtYWxsIiwgIkVhY3V0ZXNtYWxsIiwgIkVjaXJjdW1mbGV4c21hbGwiLCAiRWRpZXJlc2lzc21hbGwiLCAiSWdyYXZlc21hbGwiLCAiSWFjdXRlc21hbGwiLCAiSWNpcmN1bWZsZXhzbWFsbCIsICJJZGllcmVzaXNzbWFsbCIsICJFdGhzbWFsbCIsICJOdGlsZGVzbWFsbCIsICJPZ3JhdmVzbWFsbCIsICJPYWN1dGVzbWFsbCIsICJPY2lyY3VtZmxleHNtYWxsIiwgIk90aWxkZXNtYWxsIiwgIk9kaWVyZXNpc3NtYWxsIiwgIk9Fc21hbGwiLCAiT3NsYXNoc21hbGwiLCAiVWdyYXZlc21hbGwiLCAiVWFjdXRlc21hbGwiLCAiVWNpcmN1bWZsZXhzbWFsbCIsICJVZGllcmVzaXNzbWFsbCIsICJZYWN1dGVzbWFsbCIsICJUaG9ybnNtYWxsIiwgIllkaWVyZXNpc3NtYWxsIl07CmV4cG9ydHMuRXhwZXJ0Q2hhcnNldCA9IEV4cGVydENoYXJzZXQ7CmNvbnN0IEV4cGVydFN1YnNldENoYXJzZXQgPSBbIi5ub3RkZWYiLCAic3BhY2UiLCAiZG9sbGFyb2xkc3R5bGUiLCAiZG9sbGFyc3VwZXJpb3IiLCAicGFyZW5sZWZ0c3VwZXJpb3IiLCAicGFyZW5yaWdodHN1cGVyaW9yIiwgInR3b2RvdGVubGVhZGVyIiwgIm9uZWRvdGVubGVhZGVyIiwgImNvbW1hIiwgImh5cGhlbiIsICJwZXJpb2QiLCAiZnJhY3Rpb24iLCAiemVyb29sZHN0eWxlIiwgIm9uZW9sZHN0eWxlIiwgInR3b29sZHN0eWxlIiwgInRocmVlb2xkc3R5bGUiLCAiZm91cm9sZHN0eWxlIiwgImZpdmVvbGRzdHlsZSIsICJzaXhvbGRzdHlsZSIsICJzZXZlbm9sZHN0eWxlIiwgImVpZ2h0b2xkc3R5bGUiLCAibmluZW9sZHN0eWxlIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJjb21tYXN1cGVyaW9yIiwgInRocmVlcXVhcnRlcnNlbWRhc2giLCAicGVyaW9kc3VwZXJpb3IiLCAiYXN1cGVyaW9yIiwgImJzdXBlcmlvciIsICJjZW50c3VwZXJpb3IiLCAiZHN1cGVyaW9yIiwgImVzdXBlcmlvciIsICJpc3VwZXJpb3IiLCAibHN1cGVyaW9yIiwgIm1zdXBlcmlvciIsICJuc3VwZXJpb3IiLCAib3N1cGVyaW9yIiwgInJzdXBlcmlvciIsICJzc3VwZXJpb3IiLCAidHN1cGVyaW9yIiwgImZmIiwgImZpIiwgImZsIiwgImZmaSIsICJmZmwiLCAicGFyZW5sZWZ0aW5mZXJpb3IiLCAicGFyZW5yaWdodGluZmVyaW9yIiwgImh5cGhlbnN1cGVyaW9yIiwgImNvbG9ubW9uZXRhcnkiLCAib25lZml0dGVkIiwgInJ1cGlhaCIsICJjZW50b2xkc3R5bGUiLCAiZmlndXJlZGFzaCIsICJoeXBoZW5pbmZlcmlvciIsICJvbmVxdWFydGVyIiwgIm9uZWhhbGYiLCAidGhyZWVxdWFydGVycyIsICJvbmVlaWdodGgiLCAidGhyZWVlaWdodGhzIiwgImZpdmVlaWdodGhzIiwgInNldmVuZWlnaHRocyIsICJvbmV0aGlyZCIsICJ0d290aGlyZHMiLCAiemVyb3N1cGVyaW9yIiwgIm9uZXN1cGVyaW9yIiwgInR3b3N1cGVyaW9yIiwgInRocmVlc3VwZXJpb3IiLCAiZm91cnN1cGVyaW9yIiwgImZpdmVzdXBlcmlvciIsICJzaXhzdXBlcmlvciIsICJzZXZlbnN1cGVyaW9yIiwgImVpZ2h0c3VwZXJpb3IiLCAibmluZXN1cGVyaW9yIiwgInplcm9pbmZlcmlvciIsICJvbmVpbmZlcmlvciIsICJ0d29pbmZlcmlvciIsICJ0aHJlZWluZmVyaW9yIiwgImZvdXJpbmZlcmlvciIsICJmaXZlaW5mZXJpb3IiLCAic2l4aW5mZXJpb3IiLCAic2V2ZW5pbmZlcmlvciIsICJlaWdodGluZmVyaW9yIiwgIm5pbmVpbmZlcmlvciIsICJjZW50aW5mZXJpb3IiLCAiZG9sbGFyaW5mZXJpb3IiLCAicGVyaW9kaW5mZXJpb3IiLCAiY29tbWFpbmZlcmlvciJdOwpleHBvcnRzLkV4cGVydFN1YnNldENoYXJzZXQgPSBFeHBlcnRTdWJzZXRDaGFyc2V0OwoKLyoqKi8gfSksCi8qIDE2MiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuWmFwZkRpbmdiYXRzRW5jb2RpbmcgPSBleHBvcnRzLldpbkFuc2lFbmNvZGluZyA9IGV4cG9ydHMuU3ltYm9sU2V0RW5jb2RpbmcgPSBleHBvcnRzLlN0YW5kYXJkRW5jb2RpbmcgPSBleHBvcnRzLk1hY1JvbWFuRW5jb2RpbmcgPSBleHBvcnRzLkV4cGVydEVuY29kaW5nID0gdm9pZCAwOwpleHBvcnRzLmdldEVuY29kaW5nID0gZ2V0RW5jb2Rpbmc7CmNvbnN0IEV4cGVydEVuY29kaW5nID0gWyIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgInNwYWNlIiwgImV4Y2xhbXNtYWxsIiwgIkh1bmdhcnVtbGF1dHNtYWxsIiwgIiIsICJkb2xsYXJvbGRzdHlsZSIsICJkb2xsYXJzdXBlcmlvciIsICJhbXBlcnNhbmRzbWFsbCIsICJBY3V0ZXNtYWxsIiwgInBhcmVubGVmdHN1cGVyaW9yIiwgInBhcmVucmlnaHRzdXBlcmlvciIsICJ0d29kb3RlbmxlYWRlciIsICJvbmVkb3RlbmxlYWRlciIsICJjb21tYSIsICJoeXBoZW4iLCAicGVyaW9kIiwgImZyYWN0aW9uIiwgInplcm9vbGRzdHlsZSIsICJvbmVvbGRzdHlsZSIsICJ0d29vbGRzdHlsZSIsICJ0aHJlZW9sZHN0eWxlIiwgImZvdXJvbGRzdHlsZSIsICJmaXZlb2xkc3R5bGUiLCAic2l4b2xkc3R5bGUiLCAic2V2ZW5vbGRzdHlsZSIsICJlaWdodG9sZHN0eWxlIiwgIm5pbmVvbGRzdHlsZSIsICJjb2xvbiIsICJzZW1pY29sb24iLCAiY29tbWFzdXBlcmlvciIsICJ0aHJlZXF1YXJ0ZXJzZW1kYXNoIiwgInBlcmlvZHN1cGVyaW9yIiwgInF1ZXN0aW9uc21hbGwiLCAiIiwgImFzdXBlcmlvciIsICJic3VwZXJpb3IiLCAiY2VudHN1cGVyaW9yIiwgImRzdXBlcmlvciIsICJlc3VwZXJpb3IiLCAiIiwgIiIsICIiLCAiaXN1cGVyaW9yIiwgIiIsICIiLCAibHN1cGVyaW9yIiwgIm1zdXBlcmlvciIsICJuc3VwZXJpb3IiLCAib3N1cGVyaW9yIiwgIiIsICIiLCAicnN1cGVyaW9yIiwgInNzdXBlcmlvciIsICJ0c3VwZXJpb3IiLCAiIiwgImZmIiwgImZpIiwgImZsIiwgImZmaSIsICJmZmwiLCAicGFyZW5sZWZ0aW5mZXJpb3IiLCAiIiwgInBhcmVucmlnaHRpbmZlcmlvciIsICJDaXJjdW1mbGV4c21hbGwiLCAiaHlwaGVuc3VwZXJpb3IiLCAiR3JhdmVzbWFsbCIsICJBc21hbGwiLCAiQnNtYWxsIiwgIkNzbWFsbCIsICJEc21hbGwiLCAiRXNtYWxsIiwgIkZzbWFsbCIsICJHc21hbGwiLCAiSHNtYWxsIiwgIklzbWFsbCIsICJKc21hbGwiLCAiS3NtYWxsIiwgIkxzbWFsbCIsICJNc21hbGwiLCAiTnNtYWxsIiwgIk9zbWFsbCIsICJQc21hbGwiLCAiUXNtYWxsIiwgIlJzbWFsbCIsICJTc21hbGwiLCAiVHNtYWxsIiwgIlVzbWFsbCIsICJWc21hbGwiLCAiV3NtYWxsIiwgIlhzbWFsbCIsICJZc21hbGwiLCAiWnNtYWxsIiwgImNvbG9ubW9uZXRhcnkiLCAib25lZml0dGVkIiwgInJ1cGlhaCIsICJUaWxkZXNtYWxsIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJleGNsYW1kb3duc21hbGwiLCAiY2VudG9sZHN0eWxlIiwgIkxzbGFzaHNtYWxsIiwgIiIsICIiLCAiU2Nhcm9uc21hbGwiLCAiWmNhcm9uc21hbGwiLCAiRGllcmVzaXNzbWFsbCIsICJCcmV2ZXNtYWxsIiwgIkNhcm9uc21hbGwiLCAiIiwgIkRvdGFjY2VudHNtYWxsIiwgIiIsICIiLCAiTWFjcm9uc21hbGwiLCAiIiwgIiIsICJmaWd1cmVkYXNoIiwgImh5cGhlbmluZmVyaW9yIiwgIiIsICIiLCAiT2dvbmVrc21hbGwiLCAiUmluZ3NtYWxsIiwgIkNlZGlsbGFzbWFsbCIsICIiLCAiIiwgIiIsICJvbmVxdWFydGVyIiwgIm9uZWhhbGYiLCAidGhyZWVxdWFydGVycyIsICJxdWVzdGlvbmRvd25zbWFsbCIsICJvbmVlaWdodGgiLCAidGhyZWVlaWdodGhzIiwgImZpdmVlaWdodGhzIiwgInNldmVuZWlnaHRocyIsICJvbmV0aGlyZCIsICJ0d290aGlyZHMiLCAiIiwgIiIsICJ6ZXJvc3VwZXJpb3IiLCAib25lc3VwZXJpb3IiLCAidHdvc3VwZXJpb3IiLCAidGhyZWVzdXBlcmlvciIsICJmb3Vyc3VwZXJpb3IiLCAiZml2ZXN1cGVyaW9yIiwgInNpeHN1cGVyaW9yIiwgInNldmVuc3VwZXJpb3IiLCAiZWlnaHRzdXBlcmlvciIsICJuaW5lc3VwZXJpb3IiLCAiemVyb2luZmVyaW9yIiwgIm9uZWluZmVyaW9yIiwgInR3b2luZmVyaW9yIiwgInRocmVlaW5mZXJpb3IiLCAiZm91cmluZmVyaW9yIiwgImZpdmVpbmZlcmlvciIsICJzaXhpbmZlcmlvciIsICJzZXZlbmluZmVyaW9yIiwgImVpZ2h0aW5mZXJpb3IiLCAibmluZWluZmVyaW9yIiwgImNlbnRpbmZlcmlvciIsICJkb2xsYXJpbmZlcmlvciIsICJwZXJpb2RpbmZlcmlvciIsICJjb21tYWluZmVyaW9yIiwgIkFncmF2ZXNtYWxsIiwgIkFhY3V0ZXNtYWxsIiwgIkFjaXJjdW1mbGV4c21hbGwiLCAiQXRpbGRlc21hbGwiLCAiQWRpZXJlc2lzc21hbGwiLCAiQXJpbmdzbWFsbCIsICJBRXNtYWxsIiwgIkNjZWRpbGxhc21hbGwiLCAiRWdyYXZlc21hbGwiLCAiRWFjdXRlc21hbGwiLCAiRWNpcmN1bWZsZXhzbWFsbCIsICJFZGllcmVzaXNzbWFsbCIsICJJZ3JhdmVzbWFsbCIsICJJYWN1dGVzbWFsbCIsICJJY2lyY3VtZmxleHNtYWxsIiwgIklkaWVyZXNpc3NtYWxsIiwgIkV0aHNtYWxsIiwgIk50aWxkZXNtYWxsIiwgIk9ncmF2ZXNtYWxsIiwgIk9hY3V0ZXNtYWxsIiwgIk9jaXJjdW1mbGV4c21hbGwiLCAiT3RpbGRlc21hbGwiLCAiT2RpZXJlc2lzc21hbGwiLCAiT0VzbWFsbCIsICJPc2xhc2hzbWFsbCIsICJVZ3JhdmVzbWFsbCIsICJVYWN1dGVzbWFsbCIsICJVY2lyY3VtZmxleHNtYWxsIiwgIlVkaWVyZXNpc3NtYWxsIiwgIllhY3V0ZXNtYWxsIiwgIlRob3Juc21hbGwiLCAiWWRpZXJlc2lzc21hbGwiXTsKZXhwb3J0cy5FeHBlcnRFbmNvZGluZyA9IEV4cGVydEVuY29kaW5nOwpjb25zdCBNYWNFeHBlcnRFbmNvZGluZyA9IFsiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJzcGFjZSIsICJleGNsYW1zbWFsbCIsICJIdW5nYXJ1bWxhdXRzbWFsbCIsICJjZW50b2xkc3R5bGUiLCAiZG9sbGFyb2xkc3R5bGUiLCAiZG9sbGFyc3VwZXJpb3IiLCAiYW1wZXJzYW5kc21hbGwiLCAiQWN1dGVzbWFsbCIsICJwYXJlbmxlZnRzdXBlcmlvciIsICJwYXJlbnJpZ2h0c3VwZXJpb3IiLCAidHdvZG90ZW5sZWFkZXIiLCAib25lZG90ZW5sZWFkZXIiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJmcmFjdGlvbiIsICJ6ZXJvb2xkc3R5bGUiLCAib25lb2xkc3R5bGUiLCAidHdvb2xkc3R5bGUiLCAidGhyZWVvbGRzdHlsZSIsICJmb3Vyb2xkc3R5bGUiLCAiZml2ZW9sZHN0eWxlIiwgInNpeG9sZHN0eWxlIiwgInNldmVub2xkc3R5bGUiLCAiZWlnaHRvbGRzdHlsZSIsICJuaW5lb2xkc3R5bGUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgIiIsICJ0aHJlZXF1YXJ0ZXJzZW1kYXNoIiwgIiIsICJxdWVzdGlvbnNtYWxsIiwgIiIsICIiLCAiIiwgIiIsICJFdGhzbWFsbCIsICIiLCAiIiwgIm9uZXF1YXJ0ZXIiLCAib25laGFsZiIsICJ0aHJlZXF1YXJ0ZXJzIiwgIm9uZWVpZ2h0aCIsICJ0aHJlZWVpZ2h0aHMiLCAiZml2ZWVpZ2h0aHMiLCAic2V2ZW5laWdodGhzIiwgIm9uZXRoaXJkIiwgInR3b3RoaXJkcyIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJmZiIsICJmaSIsICJmbCIsICJmZmkiLCAiZmZsIiwgInBhcmVubGVmdGluZmVyaW9yIiwgIiIsICJwYXJlbnJpZ2h0aW5mZXJpb3IiLCAiQ2lyY3VtZmxleHNtYWxsIiwgImh5cGhlbmluZmVyaW9yIiwgIkdyYXZlc21hbGwiLCAiQXNtYWxsIiwgIkJzbWFsbCIsICJDc21hbGwiLCAiRHNtYWxsIiwgIkVzbWFsbCIsICJGc21hbGwiLCAiR3NtYWxsIiwgIkhzbWFsbCIsICJJc21hbGwiLCAiSnNtYWxsIiwgIktzbWFsbCIsICJMc21hbGwiLCAiTXNtYWxsIiwgIk5zbWFsbCIsICJPc21hbGwiLCAiUHNtYWxsIiwgIlFzbWFsbCIsICJSc21hbGwiLCAiU3NtYWxsIiwgIlRzbWFsbCIsICJVc21hbGwiLCAiVnNtYWxsIiwgIldzbWFsbCIsICJYc21hbGwiLCAiWXNtYWxsIiwgIlpzbWFsbCIsICJjb2xvbm1vbmV0YXJ5IiwgIm9uZWZpdHRlZCIsICJydXBpYWgiLCAiVGlsZGVzbWFsbCIsICIiLCAiIiwgImFzdXBlcmlvciIsICJjZW50c3VwZXJpb3IiLCAiIiwgIiIsICIiLCAiIiwgIkFhY3V0ZXNtYWxsIiwgIkFncmF2ZXNtYWxsIiwgIkFjaXJjdW1mbGV4c21hbGwiLCAiQWRpZXJlc2lzc21hbGwiLCAiQXRpbGRlc21hbGwiLCAiQXJpbmdzbWFsbCIsICJDY2VkaWxsYXNtYWxsIiwgIkVhY3V0ZXNtYWxsIiwgIkVncmF2ZXNtYWxsIiwgIkVjaXJjdW1mbGV4c21hbGwiLCAiRWRpZXJlc2lzc21hbGwiLCAiSWFjdXRlc21hbGwiLCAiSWdyYXZlc21hbGwiLCAiSWNpcmN1bWZsZXhzbWFsbCIsICJJZGllcmVzaXNzbWFsbCIsICJOdGlsZGVzbWFsbCIsICJPYWN1dGVzbWFsbCIsICJPZ3JhdmVzbWFsbCIsICJPY2lyY3VtZmxleHNtYWxsIiwgIk9kaWVyZXNpc3NtYWxsIiwgIk90aWxkZXNtYWxsIiwgIlVhY3V0ZXNtYWxsIiwgIlVncmF2ZXNtYWxsIiwgIlVjaXJjdW1mbGV4c21hbGwiLCAiVWRpZXJlc2lzc21hbGwiLCAiIiwgImVpZ2h0c3VwZXJpb3IiLCAiZm91cmluZmVyaW9yIiwgInRocmVlaW5mZXJpb3IiLCAic2l4aW5mZXJpb3IiLCAiZWlnaHRpbmZlcmlvciIsICJzZXZlbmluZmVyaW9yIiwgIlNjYXJvbnNtYWxsIiwgIiIsICJjZW50aW5mZXJpb3IiLCAidHdvaW5mZXJpb3IiLCAiIiwgIkRpZXJlc2lzc21hbGwiLCAiIiwgIkNhcm9uc21hbGwiLCAib3N1cGVyaW9yIiwgImZpdmVpbmZlcmlvciIsICIiLCAiY29tbWFpbmZlcmlvciIsICJwZXJpb2RpbmZlcmlvciIsICJZYWN1dGVzbWFsbCIsICIiLCAiZG9sbGFyaW5mZXJpb3IiLCAiIiwgIiIsICJUaG9ybnNtYWxsIiwgIiIsICJuaW5laW5mZXJpb3IiLCAiemVyb2luZmVyaW9yIiwgIlpjYXJvbnNtYWxsIiwgIkFFc21hbGwiLCAiT3NsYXNoc21hbGwiLCAicXVlc3Rpb25kb3duc21hbGwiLCAib25laW5mZXJpb3IiLCAiTHNsYXNoc21hbGwiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiQ2VkaWxsYXNtYWxsIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiT0VzbWFsbCIsICJmaWd1cmVkYXNoIiwgImh5cGhlbnN1cGVyaW9yIiwgIiIsICIiLCAiIiwgIiIsICJleGNsYW1kb3duc21hbGwiLCAiIiwgIllkaWVyZXNpc3NtYWxsIiwgIiIsICJvbmVzdXBlcmlvciIsICJ0d29zdXBlcmlvciIsICJ0aHJlZXN1cGVyaW9yIiwgImZvdXJzdXBlcmlvciIsICJmaXZlc3VwZXJpb3IiLCAic2l4c3VwZXJpb3IiLCAic2V2ZW5zdXBlcmlvciIsICJuaW5lc3VwZXJpb3IiLCAiemVyb3N1cGVyaW9yIiwgIiIsICJlc3VwZXJpb3IiLCAicnN1cGVyaW9yIiwgInRzdXBlcmlvciIsICIiLCAiIiwgImlzdXBlcmlvciIsICJzc3VwZXJpb3IiLCAiZHN1cGVyaW9yIiwgIiIsICIiLCAiIiwgIiIsICIiLCAibHN1cGVyaW9yIiwgIk9nb25la3NtYWxsIiwgIkJyZXZlc21hbGwiLCAiTWFjcm9uc21hbGwiLCAiYnN1cGVyaW9yIiwgIm5zdXBlcmlvciIsICJtc3VwZXJpb3IiLCAiY29tbWFzdXBlcmlvciIsICJwZXJpb2RzdXBlcmlvciIsICJEb3RhY2NlbnRzbWFsbCIsICJSaW5nc21hbGwiLCAiIiwgIiIsICIiLCAiIl07CmNvbnN0IE1hY1JvbWFuRW5jb2RpbmcgPSBbIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAic3BhY2UiLCAiZXhjbGFtIiwgInF1b3RlZGJsIiwgIm51bWJlcnNpZ24iLCAiZG9sbGFyIiwgInBlcmNlbnQiLCAiYW1wZXJzYW5kIiwgInF1b3Rlc2luZ2xlIiwgInBhcmVubGVmdCIsICJwYXJlbnJpZ2h0IiwgImFzdGVyaXNrIiwgInBsdXMiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJzbGFzaCIsICJ6ZXJvIiwgIm9uZSIsICJ0d28iLCAidGhyZWUiLCAiZm91ciIsICJmaXZlIiwgInNpeCIsICJzZXZlbiIsICJlaWdodCIsICJuaW5lIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJsZXNzIiwgImVxdWFsIiwgImdyZWF0ZXIiLCAicXVlc3Rpb24iLCAiYXQiLCAiQSIsICJCIiwgIkMiLCAiRCIsICJFIiwgIkYiLCAiRyIsICJIIiwgIkkiLCAiSiIsICJLIiwgIkwiLCAiTSIsICJOIiwgIk8iLCAiUCIsICJRIiwgIlIiLCAiUyIsICJUIiwgIlUiLCAiViIsICJXIiwgIlgiLCAiWSIsICJaIiwgImJyYWNrZXRsZWZ0IiwgImJhY2tzbGFzaCIsICJicmFja2V0cmlnaHQiLCAiYXNjaWljaXJjdW0iLCAidW5kZXJzY29yZSIsICJncmF2ZSIsICJhIiwgImIiLCAiYyIsICJkIiwgImUiLCAiZiIsICJnIiwgImgiLCAiaSIsICJqIiwgImsiLCAibCIsICJtIiwgIm4iLCAibyIsICJwIiwgInEiLCAiciIsICJzIiwgInQiLCAidSIsICJ2IiwgInciLCAieCIsICJ5IiwgInoiLCAiYnJhY2VsZWZ0IiwgImJhciIsICJicmFjZXJpZ2h0IiwgImFzY2lpdGlsZGUiLCAiIiwgIkFkaWVyZXNpcyIsICJBcmluZyIsICJDY2VkaWxsYSIsICJFYWN1dGUiLCAiTnRpbGRlIiwgIk9kaWVyZXNpcyIsICJVZGllcmVzaXMiLCAiYWFjdXRlIiwgImFncmF2ZSIsICJhY2lyY3VtZmxleCIsICJhZGllcmVzaXMiLCAiYXRpbGRlIiwgImFyaW5nIiwgImNjZWRpbGxhIiwgImVhY3V0ZSIsICJlZ3JhdmUiLCAiZWNpcmN1bWZsZXgiLCAiZWRpZXJlc2lzIiwgImlhY3V0ZSIsICJpZ3JhdmUiLCAiaWNpcmN1bWZsZXgiLCAiaWRpZXJlc2lzIiwgIm50aWxkZSIsICJvYWN1dGUiLCAib2dyYXZlIiwgIm9jaXJjdW1mbGV4IiwgIm9kaWVyZXNpcyIsICJvdGlsZGUiLCAidWFjdXRlIiwgInVncmF2ZSIsICJ1Y2lyY3VtZmxleCIsICJ1ZGllcmVzaXMiLCAiZGFnZ2VyIiwgImRlZ3JlZSIsICJjZW50IiwgInN0ZXJsaW5nIiwgInNlY3Rpb24iLCAiYnVsbGV0IiwgInBhcmFncmFwaCIsICJnZXJtYW5kYmxzIiwgInJlZ2lzdGVyZWQiLCAiY29weXJpZ2h0IiwgInRyYWRlbWFyayIsICJhY3V0ZSIsICJkaWVyZXNpcyIsICJub3RlcXVhbCIsICJBRSIsICJPc2xhc2giLCAiaW5maW5pdHkiLCAicGx1c21pbnVzIiwgImxlc3NlcXVhbCIsICJncmVhdGVyZXF1YWwiLCAieWVuIiwgIm11IiwgInBhcnRpYWxkaWZmIiwgInN1bW1hdGlvbiIsICJwcm9kdWN0IiwgInBpIiwgImludGVncmFsIiwgIm9yZGZlbWluaW5lIiwgIm9yZG1hc2N1bGluZSIsICJPbWVnYSIsICJhZSIsICJvc2xhc2giLCAicXVlc3Rpb25kb3duIiwgImV4Y2xhbWRvd24iLCAibG9naWNhbG5vdCIsICJyYWRpY2FsIiwgImZsb3JpbiIsICJhcHByb3hlcXVhbCIsICJEZWx0YSIsICJndWlsbGVtb3RsZWZ0IiwgImd1aWxsZW1vdHJpZ2h0IiwgImVsbGlwc2lzIiwgInNwYWNlIiwgIkFncmF2ZSIsICJBdGlsZGUiLCAiT3RpbGRlIiwgIk9FIiwgIm9lIiwgImVuZGFzaCIsICJlbWRhc2giLCAicXVvdGVkYmxsZWZ0IiwgInF1b3RlZGJscmlnaHQiLCAicXVvdGVsZWZ0IiwgInF1b3RlcmlnaHQiLCAiZGl2aWRlIiwgImxvemVuZ2UiLCAieWRpZXJlc2lzIiwgIllkaWVyZXNpcyIsICJmcmFjdGlvbiIsICJjdXJyZW5jeSIsICJndWlsc2luZ2xsZWZ0IiwgImd1aWxzaW5nbHJpZ2h0IiwgImZpIiwgImZsIiwgImRhZ2dlcmRibCIsICJwZXJpb2RjZW50ZXJlZCIsICJxdW90ZXNpbmdsYmFzZSIsICJxdW90ZWRibGJhc2UiLCAicGVydGhvdXNhbmQiLCAiQWNpcmN1bWZsZXgiLCAiRWNpcmN1bWZsZXgiLCAiQWFjdXRlIiwgIkVkaWVyZXNpcyIsICJFZ3JhdmUiLCAiSWFjdXRlIiwgIkljaXJjdW1mbGV4IiwgIklkaWVyZXNpcyIsICJJZ3JhdmUiLCAiT2FjdXRlIiwgIk9jaXJjdW1mbGV4IiwgImFwcGxlIiwgIk9ncmF2ZSIsICJVYWN1dGUiLCAiVWNpcmN1bWZsZXgiLCAiVWdyYXZlIiwgImRvdGxlc3NpIiwgImNpcmN1bWZsZXgiLCAidGlsZGUiLCAibWFjcm9uIiwgImJyZXZlIiwgImRvdGFjY2VudCIsICJyaW5nIiwgImNlZGlsbGEiLCAiaHVuZ2FydW1sYXV0IiwgIm9nb25layIsICJjYXJvbiJdOwpleHBvcnRzLk1hY1JvbWFuRW5jb2RpbmcgPSBNYWNSb21hbkVuY29kaW5nOwpjb25zdCBTdGFuZGFyZEVuY29kaW5nID0gWyIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgInNwYWNlIiwgImV4Y2xhbSIsICJxdW90ZWRibCIsICJudW1iZXJzaWduIiwgImRvbGxhciIsICJwZXJjZW50IiwgImFtcGVyc2FuZCIsICJxdW90ZXJpZ2h0IiwgInBhcmVubGVmdCIsICJwYXJlbnJpZ2h0IiwgImFzdGVyaXNrIiwgInBsdXMiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJzbGFzaCIsICJ6ZXJvIiwgIm9uZSIsICJ0d28iLCAidGhyZWUiLCAiZm91ciIsICJmaXZlIiwgInNpeCIsICJzZXZlbiIsICJlaWdodCIsICJuaW5lIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJsZXNzIiwgImVxdWFsIiwgImdyZWF0ZXIiLCAicXVlc3Rpb24iLCAiYXQiLCAiQSIsICJCIiwgIkMiLCAiRCIsICJFIiwgIkYiLCAiRyIsICJIIiwgIkkiLCAiSiIsICJLIiwgIkwiLCAiTSIsICJOIiwgIk8iLCAiUCIsICJRIiwgIlIiLCAiUyIsICJUIiwgIlUiLCAiViIsICJXIiwgIlgiLCAiWSIsICJaIiwgImJyYWNrZXRsZWZ0IiwgImJhY2tzbGFzaCIsICJicmFja2V0cmlnaHQiLCAiYXNjaWljaXJjdW0iLCAidW5kZXJzY29yZSIsICJxdW90ZWxlZnQiLCAiYSIsICJiIiwgImMiLCAiZCIsICJlIiwgImYiLCAiZyIsICJoIiwgImkiLCAiaiIsICJrIiwgImwiLCAibSIsICJuIiwgIm8iLCAicCIsICJxIiwgInIiLCAicyIsICJ0IiwgInUiLCAidiIsICJ3IiwgIngiLCAieSIsICJ6IiwgImJyYWNlbGVmdCIsICJiYXIiLCAiYnJhY2VyaWdodCIsICJhc2NpaXRpbGRlIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJleGNsYW1kb3duIiwgImNlbnQiLCAic3RlcmxpbmciLCAiZnJhY3Rpb24iLCAieWVuIiwgImZsb3JpbiIsICJzZWN0aW9uIiwgImN1cnJlbmN5IiwgInF1b3Rlc2luZ2xlIiwgInF1b3RlZGJsbGVmdCIsICJndWlsbGVtb3RsZWZ0IiwgImd1aWxzaW5nbGxlZnQiLCAiZ3VpbHNpbmdscmlnaHQiLCAiZmkiLCAiZmwiLCAiIiwgImVuZGFzaCIsICJkYWdnZXIiLCAiZGFnZ2VyZGJsIiwgInBlcmlvZGNlbnRlcmVkIiwgIiIsICJwYXJhZ3JhcGgiLCAiYnVsbGV0IiwgInF1b3Rlc2luZ2xiYXNlIiwgInF1b3RlZGJsYmFzZSIsICJxdW90ZWRibHJpZ2h0IiwgImd1aWxsZW1vdHJpZ2h0IiwgImVsbGlwc2lzIiwgInBlcnRob3VzYW5kIiwgIiIsICJxdWVzdGlvbmRvd24iLCAiIiwgImdyYXZlIiwgImFjdXRlIiwgImNpcmN1bWZsZXgiLCAidGlsZGUiLCAibWFjcm9uIiwgImJyZXZlIiwgImRvdGFjY2VudCIsICJkaWVyZXNpcyIsICIiLCAicmluZyIsICJjZWRpbGxhIiwgIiIsICJodW5nYXJ1bWxhdXQiLCAib2dvbmVrIiwgImNhcm9uIiwgImVtZGFzaCIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiQUUiLCAiIiwgIm9yZGZlbWluaW5lIiwgIiIsICIiLCAiIiwgIiIsICJMc2xhc2giLCAiT3NsYXNoIiwgIk9FIiwgIm9yZG1hc2N1bGluZSIsICIiLCAiIiwgIiIsICIiLCAiIiwgImFlIiwgIiIsICIiLCAiIiwgImRvdGxlc3NpIiwgIiIsICIiLCAibHNsYXNoIiwgIm9zbGFzaCIsICJvZSIsICJnZXJtYW5kYmxzIiwgIiIsICIiLCAiIiwgIiJdOwpleHBvcnRzLlN0YW5kYXJkRW5jb2RpbmcgPSBTdGFuZGFyZEVuY29kaW5nOwpjb25zdCBXaW5BbnNpRW5jb2RpbmcgPSBbIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAic3BhY2UiLCAiZXhjbGFtIiwgInF1b3RlZGJsIiwgIm51bWJlcnNpZ24iLCAiZG9sbGFyIiwgInBlcmNlbnQiLCAiYW1wZXJzYW5kIiwgInF1b3Rlc2luZ2xlIiwgInBhcmVubGVmdCIsICJwYXJlbnJpZ2h0IiwgImFzdGVyaXNrIiwgInBsdXMiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJzbGFzaCIsICJ6ZXJvIiwgIm9uZSIsICJ0d28iLCAidGhyZWUiLCAiZm91ciIsICJmaXZlIiwgInNpeCIsICJzZXZlbiIsICJlaWdodCIsICJuaW5lIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJsZXNzIiwgImVxdWFsIiwgImdyZWF0ZXIiLCAicXVlc3Rpb24iLCAiYXQiLCAiQSIsICJCIiwgIkMiLCAiRCIsICJFIiwgIkYiLCAiRyIsICJIIiwgIkkiLCAiSiIsICJLIiwgIkwiLCAiTSIsICJOIiwgIk8iLCAiUCIsICJRIiwgIlIiLCAiUyIsICJUIiwgIlUiLCAiViIsICJXIiwgIlgiLCAiWSIsICJaIiwgImJyYWNrZXRsZWZ0IiwgImJhY2tzbGFzaCIsICJicmFja2V0cmlnaHQiLCAiYXNjaWljaXJjdW0iLCAidW5kZXJzY29yZSIsICJncmF2ZSIsICJhIiwgImIiLCAiYyIsICJkIiwgImUiLCAiZiIsICJnIiwgImgiLCAiaSIsICJqIiwgImsiLCAibCIsICJtIiwgIm4iLCAibyIsICJwIiwgInEiLCAiciIsICJzIiwgInQiLCAidSIsICJ2IiwgInciLCAieCIsICJ5IiwgInoiLCAiYnJhY2VsZWZ0IiwgImJhciIsICJicmFjZXJpZ2h0IiwgImFzY2lpdGlsZGUiLCAiYnVsbGV0IiwgIkV1cm8iLCAiYnVsbGV0IiwgInF1b3Rlc2luZ2xiYXNlIiwgImZsb3JpbiIsICJxdW90ZWRibGJhc2UiLCAiZWxsaXBzaXMiLCAiZGFnZ2VyIiwgImRhZ2dlcmRibCIsICJjaXJjdW1mbGV4IiwgInBlcnRob3VzYW5kIiwgIlNjYXJvbiIsICJndWlsc2luZ2xsZWZ0IiwgIk9FIiwgImJ1bGxldCIsICJaY2Fyb24iLCAiYnVsbGV0IiwgImJ1bGxldCIsICJxdW90ZWxlZnQiLCAicXVvdGVyaWdodCIsICJxdW90ZWRibGxlZnQiLCAicXVvdGVkYmxyaWdodCIsICJidWxsZXQiLCAiZW5kYXNoIiwgImVtZGFzaCIsICJ0aWxkZSIsICJ0cmFkZW1hcmsiLCAic2Nhcm9uIiwgImd1aWxzaW5nbHJpZ2h0IiwgIm9lIiwgImJ1bGxldCIsICJ6Y2Fyb24iLCAiWWRpZXJlc2lzIiwgInNwYWNlIiwgImV4Y2xhbWRvd24iLCAiY2VudCIsICJzdGVybGluZyIsICJjdXJyZW5jeSIsICJ5ZW4iLCAiYnJva2VuYmFyIiwgInNlY3Rpb24iLCAiZGllcmVzaXMiLCAiY29weXJpZ2h0IiwgIm9yZGZlbWluaW5lIiwgImd1aWxsZW1vdGxlZnQiLCAibG9naWNhbG5vdCIsICJoeXBoZW4iLCAicmVnaXN0ZXJlZCIsICJtYWNyb24iLCAiZGVncmVlIiwgInBsdXNtaW51cyIsICJ0d29zdXBlcmlvciIsICJ0aHJlZXN1cGVyaW9yIiwgImFjdXRlIiwgIm11IiwgInBhcmFncmFwaCIsICJwZXJpb2RjZW50ZXJlZCIsICJjZWRpbGxhIiwgIm9uZXN1cGVyaW9yIiwgIm9yZG1hc2N1bGluZSIsICJndWlsbGVtb3RyaWdodCIsICJvbmVxdWFydGVyIiwgIm9uZWhhbGYiLCAidGhyZWVxdWFydGVycyIsICJxdWVzdGlvbmRvd24iLCAiQWdyYXZlIiwgIkFhY3V0ZSIsICJBY2lyY3VtZmxleCIsICJBdGlsZGUiLCAiQWRpZXJlc2lzIiwgIkFyaW5nIiwgIkFFIiwgIkNjZWRpbGxhIiwgIkVncmF2ZSIsICJFYWN1dGUiLCAiRWNpcmN1bWZsZXgiLCAiRWRpZXJlc2lzIiwgIklncmF2ZSIsICJJYWN1dGUiLCAiSWNpcmN1bWZsZXgiLCAiSWRpZXJlc2lzIiwgIkV0aCIsICJOdGlsZGUiLCAiT2dyYXZlIiwgIk9hY3V0ZSIsICJPY2lyY3VtZmxleCIsICJPdGlsZGUiLCAiT2RpZXJlc2lzIiwgIm11bHRpcGx5IiwgIk9zbGFzaCIsICJVZ3JhdmUiLCAiVWFjdXRlIiwgIlVjaXJjdW1mbGV4IiwgIlVkaWVyZXNpcyIsICJZYWN1dGUiLCAiVGhvcm4iLCAiZ2VybWFuZGJscyIsICJhZ3JhdmUiLCAiYWFjdXRlIiwgImFjaXJjdW1mbGV4IiwgImF0aWxkZSIsICJhZGllcmVzaXMiLCAiYXJpbmciLCAiYWUiLCAiY2NlZGlsbGEiLCAiZWdyYXZlIiwgImVhY3V0ZSIsICJlY2lyY3VtZmxleCIsICJlZGllcmVzaXMiLCAiaWdyYXZlIiwgImlhY3V0ZSIsICJpY2lyY3VtZmxleCIsICJpZGllcmVzaXMiLCAiZXRoIiwgIm50aWxkZSIsICJvZ3JhdmUiLCAib2FjdXRlIiwgIm9jaXJjdW1mbGV4IiwgIm90aWxkZSIsICJvZGllcmVzaXMiLCAiZGl2aWRlIiwgIm9zbGFzaCIsICJ1Z3JhdmUiLCAidWFjdXRlIiwgInVjaXJjdW1mbGV4IiwgInVkaWVyZXNpcyIsICJ5YWN1dGUiLCAidGhvcm4iLCAieWRpZXJlc2lzIl07CmV4cG9ydHMuV2luQW5zaUVuY29kaW5nID0gV2luQW5zaUVuY29kaW5nOwpjb25zdCBTeW1ib2xTZXRFbmNvZGluZyA9IFsiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJzcGFjZSIsICJleGNsYW0iLCAidW5pdmVyc2FsIiwgIm51bWJlcnNpZ24iLCAiZXhpc3RlbnRpYWwiLCAicGVyY2VudCIsICJhbXBlcnNhbmQiLCAic3VjaHRoYXQiLCAicGFyZW5sZWZ0IiwgInBhcmVucmlnaHQiLCAiYXN0ZXJpc2ttYXRoIiwgInBsdXMiLCAiY29tbWEiLCAibWludXMiLCAicGVyaW9kIiwgInNsYXNoIiwgInplcm8iLCAib25lIiwgInR3byIsICJ0aHJlZSIsICJmb3VyIiwgImZpdmUiLCAic2l4IiwgInNldmVuIiwgImVpZ2h0IiwgIm5pbmUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImxlc3MiLCAiZXF1YWwiLCAiZ3JlYXRlciIsICJxdWVzdGlvbiIsICJjb25ncnVlbnQiLCAiQWxwaGEiLCAiQmV0YSIsICJDaGkiLCAiRGVsdGEiLCAiRXBzaWxvbiIsICJQaGkiLCAiR2FtbWEiLCAiRXRhIiwgIklvdGEiLCAidGhldGExIiwgIkthcHBhIiwgIkxhbWJkYSIsICJNdSIsICJOdSIsICJPbWljcm9uIiwgIlBpIiwgIlRoZXRhIiwgIlJobyIsICJTaWdtYSIsICJUYXUiLCAiVXBzaWxvbiIsICJzaWdtYTEiLCAiT21lZ2EiLCAiWGkiLCAiUHNpIiwgIlpldGEiLCAiYnJhY2tldGxlZnQiLCAidGhlcmVmb3JlIiwgImJyYWNrZXRyaWdodCIsICJwZXJwZW5kaWN1bGFyIiwgInVuZGVyc2NvcmUiLCAicmFkaWNhbGV4IiwgImFscGhhIiwgImJldGEiLCAiY2hpIiwgImRlbHRhIiwgImVwc2lsb24iLCAicGhpIiwgImdhbW1hIiwgImV0YSIsICJpb3RhIiwgInBoaTEiLCAia2FwcGEiLCAibGFtYmRhIiwgIm11IiwgIm51IiwgIm9taWNyb24iLCAicGkiLCAidGhldGEiLCAicmhvIiwgInNpZ21hIiwgInRhdSIsICJ1cHNpbG9uIiwgIm9tZWdhMSIsICJvbWVnYSIsICJ4aSIsICJwc2kiLCAiemV0YSIsICJicmFjZWxlZnQiLCAiYmFyIiwgImJyYWNlcmlnaHQiLCAic2ltaWxhciIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJFdXJvIiwgIlVwc2lsb24xIiwgIm1pbnV0ZSIsICJsZXNzZXF1YWwiLCAiZnJhY3Rpb24iLCAiaW5maW5pdHkiLCAiZmxvcmluIiwgImNsdWIiLCAiZGlhbW9uZCIsICJoZWFydCIsICJzcGFkZSIsICJhcnJvd2JvdGgiLCAiYXJyb3dsZWZ0IiwgImFycm93dXAiLCAiYXJyb3dyaWdodCIsICJhcnJvd2Rvd24iLCAiZGVncmVlIiwgInBsdXNtaW51cyIsICJzZWNvbmQiLCAiZ3JlYXRlcmVxdWFsIiwgIm11bHRpcGx5IiwgInByb3BvcnRpb25hbCIsICJwYXJ0aWFsZGlmZiIsICJidWxsZXQiLCAiZGl2aWRlIiwgIm5vdGVxdWFsIiwgImVxdWl2YWxlbmNlIiwgImFwcHJveGVxdWFsIiwgImVsbGlwc2lzIiwgImFycm93dmVydGV4IiwgImFycm93aG9yaXpleCIsICJjYXJyaWFnZXJldHVybiIsICJhbGVwaCIsICJJZnJha3R1ciIsICJSZnJha3R1ciIsICJ3ZWllcnN0cmFzcyIsICJjaXJjbGVtdWx0aXBseSIsICJjaXJjbGVwbHVzIiwgImVtcHR5c2V0IiwgImludGVyc2VjdGlvbiIsICJ1bmlvbiIsICJwcm9wZXJzdXBlcnNldCIsICJyZWZsZXhzdXBlcnNldCIsICJub3RzdWJzZXQiLCAicHJvcGVyc3Vic2V0IiwgInJlZmxleHN1YnNldCIsICJlbGVtZW50IiwgIm5vdGVsZW1lbnQiLCAiYW5nbGUiLCAiZ3JhZGllbnQiLCAicmVnaXN0ZXJzZXJpZiIsICJjb3B5cmlnaHRzZXJpZiIsICJ0cmFkZW1hcmtzZXJpZiIsICJwcm9kdWN0IiwgInJhZGljYWwiLCAiZG90bWF0aCIsICJsb2dpY2Fsbm90IiwgImxvZ2ljYWxhbmQiLCAibG9naWNhbG9yIiwgImFycm93ZGJsYm90aCIsICJhcnJvd2RibGxlZnQiLCAiYXJyb3dkYmx1cCIsICJhcnJvd2RibHJpZ2h0IiwgImFycm93ZGJsZG93biIsICJsb3plbmdlIiwgImFuZ2xlbGVmdCIsICJyZWdpc3RlcnNhbnMiLCAiY29weXJpZ2h0c2FucyIsICJ0cmFkZW1hcmtzYW5zIiwgInN1bW1hdGlvbiIsICJwYXJlbmxlZnR0cCIsICJwYXJlbmxlZnRleCIsICJwYXJlbmxlZnRidCIsICJicmFja2V0bGVmdHRwIiwgImJyYWNrZXRsZWZ0ZXgiLCAiYnJhY2tldGxlZnRidCIsICJicmFjZWxlZnR0cCIsICJicmFjZWxlZnRtaWQiLCAiYnJhY2VsZWZ0YnQiLCAiYnJhY2VleCIsICIiLCAiYW5nbGVyaWdodCIsICJpbnRlZ3JhbCIsICJpbnRlZ3JhbHRwIiwgImludGVncmFsZXgiLCAiaW50ZWdyYWxidCIsICJwYXJlbnJpZ2h0dHAiLCAicGFyZW5yaWdodGV4IiwgInBhcmVucmlnaHRidCIsICJicmFja2V0cmlnaHR0cCIsICJicmFja2V0cmlnaHRleCIsICJicmFja2V0cmlnaHRidCIsICJicmFjZXJpZ2h0dHAiLCAiYnJhY2VyaWdodG1pZCIsICJicmFjZXJpZ2h0YnQiLCAiIl07CmV4cG9ydHMuU3ltYm9sU2V0RW5jb2RpbmcgPSBTeW1ib2xTZXRFbmNvZGluZzsKY29uc3QgWmFwZkRpbmdiYXRzRW5jb2RpbmcgPSBbIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAic3BhY2UiLCAiYTEiLCAiYTIiLCAiYTIwMiIsICJhMyIsICJhNCIsICJhNSIsICJhMTE5IiwgImExMTgiLCAiYTExNyIsICJhMTEiLCAiYTEyIiwgImExMyIsICJhMTQiLCAiYTE1IiwgImExNiIsICJhMTA1IiwgImExNyIsICJhMTgiLCAiYTE5IiwgImEyMCIsICJhMjEiLCAiYTIyIiwgImEyMyIsICJhMjQiLCAiYTI1IiwgImEyNiIsICJhMjciLCAiYTI4IiwgImE2IiwgImE3IiwgImE4IiwgImE5IiwgImExMCIsICJhMjkiLCAiYTMwIiwgImEzMSIsICJhMzIiLCAiYTMzIiwgImEzNCIsICJhMzUiLCAiYTM2IiwgImEzNyIsICJhMzgiLCAiYTM5IiwgImE0MCIsICJhNDEiLCAiYTQyIiwgImE0MyIsICJhNDQiLCAiYTQ1IiwgImE0NiIsICJhNDciLCAiYTQ4IiwgImE0OSIsICJhNTAiLCAiYTUxIiwgImE1MiIsICJhNTMiLCAiYTU0IiwgImE1NSIsICJhNTYiLCAiYTU3IiwgImE1OCIsICJhNTkiLCAiYTYwIiwgImE2MSIsICJhNjIiLCAiYTYzIiwgImE2NCIsICJhNjUiLCAiYTY2IiwgImE2NyIsICJhNjgiLCAiYTY5IiwgImE3MCIsICJhNzEiLCAiYTcyIiwgImE3MyIsICJhNzQiLCAiYTIwMyIsICJhNzUiLCAiYTIwNCIsICJhNzYiLCAiYTc3IiwgImE3OCIsICJhNzkiLCAiYTgxIiwgImE4MiIsICJhODMiLCAiYTg0IiwgImE5NyIsICJhOTgiLCAiYTk5IiwgImExMDAiLCAiIiwgImE4OSIsICJhOTAiLCAiYTkzIiwgImE5NCIsICJhOTEiLCAiYTkyIiwgImEyMDUiLCAiYTg1IiwgImEyMDYiLCAiYTg2IiwgImE4NyIsICJhODgiLCAiYTk1IiwgImE5NiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiYTEwMSIsICJhMTAyIiwgImExMDMiLCAiYTEwNCIsICJhMTA2IiwgImExMDciLCAiYTEwOCIsICJhMTEyIiwgImExMTEiLCAiYTExMCIsICJhMTA5IiwgImExMjAiLCAiYTEyMSIsICJhMTIyIiwgImExMjMiLCAiYTEyNCIsICJhMTI1IiwgImExMjYiLCAiYTEyNyIsICJhMTI4IiwgImExMjkiLCAiYTEzMCIsICJhMTMxIiwgImExMzIiLCAiYTEzMyIsICJhMTM0IiwgImExMzUiLCAiYTEzNiIsICJhMTM3IiwgImExMzgiLCAiYTEzOSIsICJhMTQwIiwgImExNDEiLCAiYTE0MiIsICJhMTQzIiwgImExNDQiLCAiYTE0NSIsICJhMTQ2IiwgImExNDciLCAiYTE0OCIsICJhMTQ5IiwgImExNTAiLCAiYTE1MSIsICJhMTUyIiwgImExNTMiLCAiYTE1NCIsICJhMTU1IiwgImExNTYiLCAiYTE1NyIsICJhMTU4IiwgImExNTkiLCAiYTE2MCIsICJhMTYxIiwgImExNjMiLCAiYTE2NCIsICJhMTk2IiwgImExNjUiLCAiYTE5MiIsICJhMTY2IiwgImExNjciLCAiYTE2OCIsICJhMTY5IiwgImExNzAiLCAiYTE3MSIsICJhMTcyIiwgImExNzMiLCAiYTE2MiIsICJhMTc0IiwgImExNzUiLCAiYTE3NiIsICJhMTc3IiwgImExNzgiLCAiYTE3OSIsICJhMTkzIiwgImExODAiLCAiYTE5OSIsICJhMTgxIiwgImEyMDAiLCAiYTE4MiIsICIiLCAiYTIwMSIsICJhMTgzIiwgImExODQiLCAiYTE5NyIsICJhMTg1IiwgImExOTQiLCAiYTE5OCIsICJhMTg2IiwgImExOTUiLCAiYTE4NyIsICJhMTg4IiwgImExODkiLCAiYTE5MCIsICJhMTkxIiwgIiJdOwpleHBvcnRzLlphcGZEaW5nYmF0c0VuY29kaW5nID0gWmFwZkRpbmdiYXRzRW5jb2Rpbmc7CgpmdW5jdGlvbiBnZXRFbmNvZGluZyhlbmNvZGluZ05hbWUpIHsKICBzd2l0Y2ggKGVuY29kaW5nTmFtZSkgewogICAgY2FzZSAiV2luQW5zaUVuY29kaW5nIjoKICAgICAgcmV0dXJuIFdpbkFuc2lFbmNvZGluZzsKCiAgICBjYXNlICJTdGFuZGFyZEVuY29kaW5nIjoKICAgICAgcmV0dXJuIFN0YW5kYXJkRW5jb2Rpbmc7CgogICAgY2FzZSAiTWFjUm9tYW5FbmNvZGluZyI6CiAgICAgIHJldHVybiBNYWNSb21hbkVuY29kaW5nOwoKICAgIGNhc2UgIlN5bWJvbFNldEVuY29kaW5nIjoKICAgICAgcmV0dXJuIFN5bWJvbFNldEVuY29kaW5nOwoKICAgIGNhc2UgIlphcGZEaW5nYmF0c0VuY29kaW5nIjoKICAgICAgcmV0dXJuIFphcGZEaW5nYmF0c0VuY29kaW5nOwoKICAgIGNhc2UgIkV4cGVydEVuY29kaW5nIjoKICAgICAgcmV0dXJuIEV4cGVydEVuY29kaW5nOwoKICAgIGNhc2UgIk1hY0V4cGVydEVuY29kaW5nIjoKICAgICAgcmV0dXJuIE1hY0V4cGVydEVuY29kaW5nOwoKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiBudWxsOwogIH0KfQoKLyoqKi8gfSksCi8qIDE2MyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuU0VBQ19BTkFMWVNJU19FTkFCTEVEID0gZXhwb3J0cy5NYWNTdGFuZGFyZEdseXBoT3JkZXJpbmcgPSBleHBvcnRzLkZvbnRGbGFncyA9IHZvaWQgMDsKZXhwb3J0cy5nZXRGb250VHlwZSA9IGdldEZvbnRUeXBlOwpleHBvcnRzLm5vcm1hbGl6ZUZvbnROYW1lID0gbm9ybWFsaXplRm9udE5hbWU7CmV4cG9ydHMucmVjb3ZlckdseXBoTmFtZSA9IHJlY292ZXJHbHlwaE5hbWU7CmV4cG9ydHMudHlwZTFGb250R2x5cGhNYXBwaW5nID0gdHlwZTFGb250R2x5cGhNYXBwaW5nOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfZW5jb2RpbmdzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjIpOwoKdmFyIF9nbHlwaGxpc3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2NCk7Cgp2YXIgX3VuaWNvZGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2NSk7Cgpjb25zdCBTRUFDX0FOQUxZU0lTX0VOQUJMRUQgPSB0cnVlOwpleHBvcnRzLlNFQUNfQU5BTFlTSVNfRU5BQkxFRCA9IFNFQUNfQU5BTFlTSVNfRU5BQkxFRDsKY29uc3QgRm9udEZsYWdzID0gewogIEZpeGVkUGl0Y2g6IDEsCiAgU2VyaWY6IDIsCiAgU3ltYm9saWM6IDQsCiAgU2NyaXB0OiA4LAogIE5vbnN5bWJvbGljOiAzMiwKICBJdGFsaWM6IDY0LAogIEFsbENhcDogNjU1MzYsCiAgU21hbGxDYXA6IDEzMTA3MiwKICBGb3JjZUJvbGQ6IDI2MjE0NAp9OwpleHBvcnRzLkZvbnRGbGFncyA9IEZvbnRGbGFnczsKY29uc3QgTWFjU3RhbmRhcmRHbHlwaE9yZGVyaW5nID0gWyIubm90ZGVmIiwgIi5udWxsIiwgIm5vbm1hcmtpbmdyZXR1cm4iLCAic3BhY2UiLCAiZXhjbGFtIiwgInF1b3RlZGJsIiwgIm51bWJlcnNpZ24iLCAiZG9sbGFyIiwgInBlcmNlbnQiLCAiYW1wZXJzYW5kIiwgInF1b3Rlc2luZ2xlIiwgInBhcmVubGVmdCIsICJwYXJlbnJpZ2h0IiwgImFzdGVyaXNrIiwgInBsdXMiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJzbGFzaCIsICJ6ZXJvIiwgIm9uZSIsICJ0d28iLCAidGhyZWUiLCAiZm91ciIsICJmaXZlIiwgInNpeCIsICJzZXZlbiIsICJlaWdodCIsICJuaW5lIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJsZXNzIiwgImVxdWFsIiwgImdyZWF0ZXIiLCAicXVlc3Rpb24iLCAiYXQiLCAiQSIsICJCIiwgIkMiLCAiRCIsICJFIiwgIkYiLCAiRyIsICJIIiwgIkkiLCAiSiIsICJLIiwgIkwiLCAiTSIsICJOIiwgIk8iLCAiUCIsICJRIiwgIlIiLCAiUyIsICJUIiwgIlUiLCAiViIsICJXIiwgIlgiLCAiWSIsICJaIiwgImJyYWNrZXRsZWZ0IiwgImJhY2tzbGFzaCIsICJicmFja2V0cmlnaHQiLCAiYXNjaWljaXJjdW0iLCAidW5kZXJzY29yZSIsICJncmF2ZSIsICJhIiwgImIiLCAiYyIsICJkIiwgImUiLCAiZiIsICJnIiwgImgiLCAiaSIsICJqIiwgImsiLCAibCIsICJtIiwgIm4iLCAibyIsICJwIiwgInEiLCAiciIsICJzIiwgInQiLCAidSIsICJ2IiwgInciLCAieCIsICJ5IiwgInoiLCAiYnJhY2VsZWZ0IiwgImJhciIsICJicmFjZXJpZ2h0IiwgImFzY2lpdGlsZGUiLCAiQWRpZXJlc2lzIiwgIkFyaW5nIiwgIkNjZWRpbGxhIiwgIkVhY3V0ZSIsICJOdGlsZGUiLCAiT2RpZXJlc2lzIiwgIlVkaWVyZXNpcyIsICJhYWN1dGUiLCAiYWdyYXZlIiwgImFjaXJjdW1mbGV4IiwgImFkaWVyZXNpcyIsICJhdGlsZGUiLCAiYXJpbmciLCAiY2NlZGlsbGEiLCAiZWFjdXRlIiwgImVncmF2ZSIsICJlY2lyY3VtZmxleCIsICJlZGllcmVzaXMiLCAiaWFjdXRlIiwgImlncmF2ZSIsICJpY2lyY3VtZmxleCIsICJpZGllcmVzaXMiLCAibnRpbGRlIiwgIm9hY3V0ZSIsICJvZ3JhdmUiLCAib2NpcmN1bWZsZXgiLCAib2RpZXJlc2lzIiwgIm90aWxkZSIsICJ1YWN1dGUiLCAidWdyYXZlIiwgInVjaXJjdW1mbGV4IiwgInVkaWVyZXNpcyIsICJkYWdnZXIiLCAiZGVncmVlIiwgImNlbnQiLCAic3RlcmxpbmciLCAic2VjdGlvbiIsICJidWxsZXQiLCAicGFyYWdyYXBoIiwgImdlcm1hbmRibHMiLCAicmVnaXN0ZXJlZCIsICJjb3B5cmlnaHQiLCAidHJhZGVtYXJrIiwgImFjdXRlIiwgImRpZXJlc2lzIiwgIm5vdGVxdWFsIiwgIkFFIiwgIk9zbGFzaCIsICJpbmZpbml0eSIsICJwbHVzbWludXMiLCAibGVzc2VxdWFsIiwgImdyZWF0ZXJlcXVhbCIsICJ5ZW4iLCAibXUiLCAicGFydGlhbGRpZmYiLCAic3VtbWF0aW9uIiwgInByb2R1Y3QiLCAicGkiLCAiaW50ZWdyYWwiLCAib3JkZmVtaW5pbmUiLCAib3JkbWFzY3VsaW5lIiwgIk9tZWdhIiwgImFlIiwgIm9zbGFzaCIsICJxdWVzdGlvbmRvd24iLCAiZXhjbGFtZG93biIsICJsb2dpY2Fsbm90IiwgInJhZGljYWwiLCAiZmxvcmluIiwgImFwcHJveGVxdWFsIiwgIkRlbHRhIiwgImd1aWxsZW1vdGxlZnQiLCAiZ3VpbGxlbW90cmlnaHQiLCAiZWxsaXBzaXMiLCAibm9uYnJlYWtpbmdzcGFjZSIsICJBZ3JhdmUiLCAiQXRpbGRlIiwgIk90aWxkZSIsICJPRSIsICJvZSIsICJlbmRhc2giLCAiZW1kYXNoIiwgInF1b3RlZGJsbGVmdCIsICJxdW90ZWRibHJpZ2h0IiwgInF1b3RlbGVmdCIsICJxdW90ZXJpZ2h0IiwgImRpdmlkZSIsICJsb3plbmdlIiwgInlkaWVyZXNpcyIsICJZZGllcmVzaXMiLCAiZnJhY3Rpb24iLCAiY3VycmVuY3kiLCAiZ3VpbHNpbmdsbGVmdCIsICJndWlsc2luZ2xyaWdodCIsICJmaSIsICJmbCIsICJkYWdnZXJkYmwiLCAicGVyaW9kY2VudGVyZWQiLCAicXVvdGVzaW5nbGJhc2UiLCAicXVvdGVkYmxiYXNlIiwgInBlcnRob3VzYW5kIiwgIkFjaXJjdW1mbGV4IiwgIkVjaXJjdW1mbGV4IiwgIkFhY3V0ZSIsICJFZGllcmVzaXMiLCAiRWdyYXZlIiwgIklhY3V0ZSIsICJJY2lyY3VtZmxleCIsICJJZGllcmVzaXMiLCAiSWdyYXZlIiwgIk9hY3V0ZSIsICJPY2lyY3VtZmxleCIsICJhcHBsZSIsICJPZ3JhdmUiLCAiVWFjdXRlIiwgIlVjaXJjdW1mbGV4IiwgIlVncmF2ZSIsICJkb3RsZXNzaSIsICJjaXJjdW1mbGV4IiwgInRpbGRlIiwgIm1hY3JvbiIsICJicmV2ZSIsICJkb3RhY2NlbnQiLCAicmluZyIsICJjZWRpbGxhIiwgImh1bmdhcnVtbGF1dCIsICJvZ29uZWsiLCAiY2Fyb24iLCAiTHNsYXNoIiwgImxzbGFzaCIsICJTY2Fyb24iLCAic2Nhcm9uIiwgIlpjYXJvbiIsICJ6Y2Fyb24iLCAiYnJva2VuYmFyIiwgIkV0aCIsICJldGgiLCAiWWFjdXRlIiwgInlhY3V0ZSIsICJUaG9ybiIsICJ0aG9ybiIsICJtaW51cyIsICJtdWx0aXBseSIsICJvbmVzdXBlcmlvciIsICJ0d29zdXBlcmlvciIsICJ0aHJlZXN1cGVyaW9yIiwgIm9uZWhhbGYiLCAib25lcXVhcnRlciIsICJ0aHJlZXF1YXJ0ZXJzIiwgImZyYW5jIiwgIkdicmV2ZSIsICJnYnJldmUiLCAiSWRvdGFjY2VudCIsICJTY2VkaWxsYSIsICJzY2VkaWxsYSIsICJDYWN1dGUiLCAiY2FjdXRlIiwgIkNjYXJvbiIsICJjY2Fyb24iLCAiZGNyb2F0Il07CmV4cG9ydHMuTWFjU3RhbmRhcmRHbHlwaE9yZGVyaW5nID0gTWFjU3RhbmRhcmRHbHlwaE9yZGVyaW5nOwoKZnVuY3Rpb24gZ2V0Rm9udFR5cGUodHlwZSwgc3VidHlwZSkgewogIGxldCBpc1N0YW5kYXJkRm9udCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CgogIHN3aXRjaCAodHlwZSkgewogICAgY2FzZSAiVHlwZTEiOgogICAgICBpZiAoaXNTdGFuZGFyZEZvbnQpIHsKICAgICAgICByZXR1cm4gX3V0aWwuRm9udFR5cGUuVFlQRTFTVEFOREFSRDsKICAgICAgfQoKICAgICAgcmV0dXJuIHN1YnR5cGUgPT09ICJUeXBlMUMiID8gX3V0aWwuRm9udFR5cGUuVFlQRTFDIDogX3V0aWwuRm9udFR5cGUuVFlQRTE7CgogICAgY2FzZSAiQ0lERm9udFR5cGUwIjoKICAgICAgcmV0dXJuIHN1YnR5cGUgPT09ICJDSURGb250VHlwZTBDIiA/IF91dGlsLkZvbnRUeXBlLkNJREZPTlRUWVBFMEMgOiBfdXRpbC5Gb250VHlwZS5DSURGT05UVFlQRTA7CgogICAgY2FzZSAiT3BlblR5cGUiOgogICAgICByZXR1cm4gX3V0aWwuRm9udFR5cGUuT1BFTlRZUEU7CgogICAgY2FzZSAiVHJ1ZVR5cGUiOgogICAgICByZXR1cm4gX3V0aWwuRm9udFR5cGUuVFJVRVRZUEU7CgogICAgY2FzZSAiQ0lERm9udFR5cGUyIjoKICAgICAgcmV0dXJuIF91dGlsLkZvbnRUeXBlLkNJREZPTlRUWVBFMjsKCiAgICBjYXNlICJNTVR5cGUxIjoKICAgICAgcmV0dXJuIF91dGlsLkZvbnRUeXBlLk1NVFlQRTE7CgogICAgY2FzZSAiVHlwZTAiOgogICAgICByZXR1cm4gX3V0aWwuRm9udFR5cGUuVFlQRTA7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIF91dGlsLkZvbnRUeXBlLlVOS05PV047CiAgfQp9CgpmdW5jdGlvbiByZWNvdmVyR2x5cGhOYW1lKG5hbWUsIGdseXBoc1VuaWNvZGVNYXApIHsKICBpZiAoZ2x5cGhzVW5pY29kZU1hcFtuYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm4gbmFtZTsKICB9CgogIGNvbnN0IHVuaWNvZGUgPSAoMCwgX3VuaWNvZGUuZ2V0VW5pY29kZUZvckdseXBoKShuYW1lLCBnbHlwaHNVbmljb2RlTWFwKTsKCiAgaWYgKHVuaWNvZGUgIT09IC0xKSB7CiAgICBmb3IgKGNvbnN0IGtleSBpbiBnbHlwaHNVbmljb2RlTWFwKSB7CiAgICAgIGlmIChnbHlwaHNVbmljb2RlTWFwW2tleV0gPT09IHVuaWNvZGUpIHsKICAgICAgICByZXR1cm4ga2V5OwogICAgICB9CiAgICB9CiAgfQoKICAoMCwgX3V0aWwuaW5mbykoIlVuYWJsZSB0byByZWNvdmVyIGEgc3RhbmRhcmQgZ2x5cGggbmFtZSBmb3I6ICIgKyBuYW1lKTsKICByZXR1cm4gbmFtZTsKfQoKZnVuY3Rpb24gdHlwZTFGb250R2x5cGhNYXBwaW5nKHByb3BlcnRpZXMsIGJ1aWx0SW5FbmNvZGluZywgZ2x5cGhOYW1lcykgewogIGNvbnN0IGNoYXJDb2RlVG9HbHlwaElkID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICBsZXQgZ2x5cGhJZCwgY2hhckNvZGUsIGJhc2VFbmNvZGluZzsKICBjb25zdCBpc1N5bWJvbGljRm9udCA9ICEhKHByb3BlcnRpZXMuZmxhZ3MgJiBGb250RmxhZ3MuU3ltYm9saWMpOwoKICBpZiAocHJvcGVydGllcy5pc0ludGVybmFsRm9udCkgewogICAgYmFzZUVuY29kaW5nID0gYnVpbHRJbkVuY29kaW5nOwoKICAgIGZvciAoY2hhckNvZGUgPSAwOyBjaGFyQ29kZSA8IGJhc2VFbmNvZGluZy5sZW5ndGg7IGNoYXJDb2RlKyspIHsKICAgICAgZ2x5cGhJZCA9IGdseXBoTmFtZXMuaW5kZXhPZihiYXNlRW5jb2RpbmdbY2hhckNvZGVdKTsKCiAgICAgIGlmIChnbHlwaElkID49IDApIHsKICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSBnbHlwaElkOwogICAgICB9IGVsc2UgewogICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IDA7CiAgICAgIH0KICAgIH0KICB9IGVsc2UgaWYgKHByb3BlcnRpZXMuYmFzZUVuY29kaW5nTmFtZSkgewogICAgYmFzZUVuY29kaW5nID0gKDAsIF9lbmNvZGluZ3MuZ2V0RW5jb2RpbmcpKHByb3BlcnRpZXMuYmFzZUVuY29kaW5nTmFtZSk7CgogICAgZm9yIChjaGFyQ29kZSA9IDA7IGNoYXJDb2RlIDwgYmFzZUVuY29kaW5nLmxlbmd0aDsgY2hhckNvZGUrKykgewogICAgICBnbHlwaElkID0gZ2x5cGhOYW1lcy5pbmRleE9mKGJhc2VFbmNvZGluZ1tjaGFyQ29kZV0pOwoKICAgICAgaWYgKGdseXBoSWQgPj0gMCkgewogICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGdseXBoSWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gMDsKICAgICAgfQogICAgfQogIH0gZWxzZSBpZiAoaXNTeW1ib2xpY0ZvbnQpIHsKICAgIGZvciAoY2hhckNvZGUgaW4gYnVpbHRJbkVuY29kaW5nKSB7CiAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGJ1aWx0SW5FbmNvZGluZ1tjaGFyQ29kZV07CiAgICB9CiAgfSBlbHNlIHsKICAgIGJhc2VFbmNvZGluZyA9IF9lbmNvZGluZ3MuU3RhbmRhcmRFbmNvZGluZzsKCiAgICBmb3IgKGNoYXJDb2RlID0gMDsgY2hhckNvZGUgPCBiYXNlRW5jb2RpbmcubGVuZ3RoOyBjaGFyQ29kZSsrKSB7CiAgICAgIGdseXBoSWQgPSBnbHlwaE5hbWVzLmluZGV4T2YoYmFzZUVuY29kaW5nW2NoYXJDb2RlXSk7CgogICAgICBpZiAoZ2x5cGhJZCA+PSAwKSB7CiAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSAwOwogICAgICB9CiAgICB9CiAgfQoKICBjb25zdCBkaWZmZXJlbmNlcyA9IHByb3BlcnRpZXMuZGlmZmVyZW5jZXM7CiAgbGV0IGdseXBoc1VuaWNvZGVNYXA7CgogIGlmIChkaWZmZXJlbmNlcykgewogICAgZm9yIChjaGFyQ29kZSBpbiBkaWZmZXJlbmNlcykgewogICAgICBjb25zdCBnbHlwaE5hbWUgPSBkaWZmZXJlbmNlc1tjaGFyQ29kZV07CiAgICAgIGdseXBoSWQgPSBnbHlwaE5hbWVzLmluZGV4T2YoZ2x5cGhOYW1lKTsKCiAgICAgIGlmIChnbHlwaElkID09PSAtMSkgewogICAgICAgIGlmICghZ2x5cGhzVW5pY29kZU1hcCkgewogICAgICAgICAgZ2x5cGhzVW5pY29kZU1hcCA9ICgwLCBfZ2x5cGhsaXN0LmdldEdseXBoc1VuaWNvZGUpKCk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzdGFuZGFyZEdseXBoTmFtZSA9IHJlY292ZXJHbHlwaE5hbWUoZ2x5cGhOYW1lLCBnbHlwaHNVbmljb2RlTWFwKTsKCiAgICAgICAgaWYgKHN0YW5kYXJkR2x5cGhOYW1lICE9PSBnbHlwaE5hbWUpIHsKICAgICAgICAgIGdseXBoSWQgPSBnbHlwaE5hbWVzLmluZGV4T2Yoc3RhbmRhcmRHbHlwaE5hbWUpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGdseXBoSWQgPj0gMCkgewogICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGdseXBoSWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gMDsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIGNoYXJDb2RlVG9HbHlwaElkOwp9CgpmdW5jdGlvbiBub3JtYWxpemVGb250TmFtZShuYW1lKSB7CiAgcmV0dXJuIG5hbWUucmVwbGFjZSgvWyxfXS9nLCAiLSIpLnJlcGxhY2UoL1xzL2csICIiKTsKfQoKLyoqKi8gfSksCi8qIDE2NCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7Cl9fd19wZGZqc19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTsKLyogaGFybW9ueSBleHBvcnQgKi8gX193X3BkZmpzX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIHsKLyogaGFybW9ueSBleHBvcnQgKi8gICAiZ2V0RGluZ2JhdHNHbHlwaHNVbmljb2RlIjogKCkgPT4gKC8qIGJpbmRpbmcgKi8gZ2V0RGluZ2JhdHNHbHlwaHNVbmljb2RlKSwKLyogaGFybW9ueSBleHBvcnQgKi8gICAiZ2V0R2x5cGhzVW5pY29kZSI6ICgpID0+ICgvKiBiaW5kaW5nICovIGdldEdseXBoc1VuaWNvZGUpCi8qIGhhcm1vbnkgZXhwb3J0ICovIH0pOwovKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX2NvcmVfdXRpbHNfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMxKTsKCmNvbnN0IGdldEdseXBoc1VuaWNvZGUgPSAoMCxfY29yZV91dGlsc19qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fLmdldEFycmF5TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAoKSB7CiByZXR1cm4gWwogICJBIiwKICAweDAwNDEsCiAgIkFFIiwKICAweDAwYzYsCiAgIkFFYWN1dGUiLAogIDB4MDFmYywKICAiQUVtYWNyb24iLAogIDB4MDFlMiwKICAiQUVzbWFsbCIsCiAgMHhmN2U2LAogICJBYWN1dGUiLAogIDB4MDBjMSwKICAiQWFjdXRlc21hbGwiLAogIDB4ZjdlMSwKICAiQWJyZXZlIiwKICAweDAxMDIsCiAgIkFicmV2ZWFjdXRlIiwKICAweDFlYWUsCiAgIkFicmV2ZWN5cmlsbGljIiwKICAweDA0ZDAsCiAgIkFicmV2ZWRvdGJlbG93IiwKICAweDFlYjYsCiAgIkFicmV2ZWdyYXZlIiwKICAweDFlYjAsCiAgIkFicmV2ZWhvb2thYm92ZSIsCiAgMHgxZWIyLAogICJBYnJldmV0aWxkZSIsCiAgMHgxZWI0LAogICJBY2Fyb24iLAogIDB4MDFjZCwKICAiQWNpcmNsZSIsCiAgMHgyNGI2LAogICJBY2lyY3VtZmxleCIsCiAgMHgwMGMyLAogICJBY2lyY3VtZmxleGFjdXRlIiwKICAweDFlYTQsCiAgIkFjaXJjdW1mbGV4ZG90YmVsb3ciLAogIDB4MWVhYywKICAiQWNpcmN1bWZsZXhncmF2ZSIsCiAgMHgxZWE2LAogICJBY2lyY3VtZmxleGhvb2thYm92ZSIsCiAgMHgxZWE4LAogICJBY2lyY3VtZmxleHNtYWxsIiwKICAweGY3ZTIsCiAgIkFjaXJjdW1mbGV4dGlsZGUiLAogIDB4MWVhYSwKICAiQWN1dGUiLAogIDB4ZjZjOSwKICAiQWN1dGVzbWFsbCIsCiAgMHhmN2I0LAogICJBY3lyaWxsaWMiLAogIDB4MDQxMCwKICAiQWRibGdyYXZlIiwKICAweDAyMDAsCiAgIkFkaWVyZXNpcyIsCiAgMHgwMGM0LAogICJBZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGQyLAogICJBZGllcmVzaXNtYWNyb24iLAogIDB4MDFkZSwKICAiQWRpZXJlc2lzc21hbGwiLAogIDB4ZjdlNCwKICAiQWRvdGJlbG93IiwKICAweDFlYTAsCiAgIkFkb3RtYWNyb24iLAogIDB4MDFlMCwKICAiQWdyYXZlIiwKICAweDAwYzAsCiAgIkFncmF2ZXNtYWxsIiwKICAweGY3ZTAsCiAgIkFob29rYWJvdmUiLAogIDB4MWVhMiwKICAiQWllY3lyaWxsaWMiLAogIDB4MDRkNCwKICAiQWludmVydGVkYnJldmUiLAogIDB4MDIwMiwKICAiQWxwaGEiLAogIDB4MDM5MSwKICAiQWxwaGF0b25vcyIsCiAgMHgwMzg2LAogICJBbWFjcm9uIiwKICAweDAxMDAsCiAgIkFtb25vc3BhY2UiLAogIDB4ZmYyMSwKICAiQW9nb25layIsCiAgMHgwMTA0LAogICJBcmluZyIsCiAgMHgwMGM1LAogICJBcmluZ2FjdXRlIiwKICAweDAxZmEsCiAgIkFyaW5nYmVsb3ciLAogIDB4MWUwMCwKICAiQXJpbmdzbWFsbCIsCiAgMHhmN2U1LAogICJBc21hbGwiLAogIDB4Zjc2MSwKICAiQXRpbGRlIiwKICAweDAwYzMsCiAgIkF0aWxkZXNtYWxsIiwKICAweGY3ZTMsCiAgIkF5YmFybWVuaWFuIiwKICAweDA1MzEsCiAgIkIiLAogIDB4MDA0MiwKICAiQmNpcmNsZSIsCiAgMHgyNGI3LAogICJCZG90YWNjZW50IiwKICAweDFlMDIsCiAgIkJkb3RiZWxvdyIsCiAgMHgxZTA0LAogICJCZWN5cmlsbGljIiwKICAweDA0MTEsCiAgIkJlbmFybWVuaWFuIiwKICAweDA1MzIsCiAgIkJldGEiLAogIDB4MDM5MiwKICAiQmhvb2siLAogIDB4MDE4MSwKICAiQmxpbmViZWxvdyIsCiAgMHgxZTA2LAogICJCbW9ub3NwYWNlIiwKICAweGZmMjIsCiAgIkJyZXZlc21hbGwiLAogIDB4ZjZmNCwKICAiQnNtYWxsIiwKICAweGY3NjIsCiAgIkJ0b3BiYXIiLAogIDB4MDE4MiwKICAiQyIsCiAgMHgwMDQzLAogICJDYWFybWVuaWFuIiwKICAweDA1M2UsCiAgIkNhY3V0ZSIsCiAgMHgwMTA2LAogICJDYXJvbiIsCiAgMHhmNmNhLAogICJDYXJvbnNtYWxsIiwKICAweGY2ZjUsCiAgIkNjYXJvbiIsCiAgMHgwMTBjLAogICJDY2VkaWxsYSIsCiAgMHgwMGM3LAogICJDY2VkaWxsYWFjdXRlIiwKICAweDFlMDgsCiAgIkNjZWRpbGxhc21hbGwiLAogIDB4ZjdlNywKICAiQ2NpcmNsZSIsCiAgMHgyNGI4LAogICJDY2lyY3VtZmxleCIsCiAgMHgwMTA4LAogICJDZG90IiwKICAweDAxMGEsCiAgIkNkb3RhY2NlbnQiLAogIDB4MDEwYSwKICAiQ2VkaWxsYXNtYWxsIiwKICAweGY3YjgsCiAgIkNoYWFybWVuaWFuIiwKICAweDA1NDksCiAgIkNoZWFia2hhc2lhbmN5cmlsbGljIiwKICAweDA0YmMsCiAgIkNoZWN5cmlsbGljIiwKICAweDA0MjcsCiAgIkNoZWRlc2NlbmRlcmFia2hhc2lhbmN5cmlsbGljIiwKICAweDA0YmUsCiAgIkNoZWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0YjYsCiAgIkNoZWRpZXJlc2lzY3lyaWxsaWMiLAogIDB4MDRmNCwKICAiQ2hlaGFybWVuaWFuIiwKICAweDA1NDMsCiAgIkNoZWtoYWthc3NpYW5jeXJpbGxpYyIsCiAgMHgwNGNiLAogICJDaGV2ZXJ0aWNhbHN0cm9rZWN5cmlsbGljIiwKICAweDA0YjgsCiAgIkNoaSIsCiAgMHgwM2E3LAogICJDaG9vayIsCiAgMHgwMTg3LAogICJDaXJjdW1mbGV4c21hbGwiLAogIDB4ZjZmNiwKICAiQ21vbm9zcGFjZSIsCiAgMHhmZjIzLAogICJDb2FybWVuaWFuIiwKICAweDA1NTEsCiAgIkNzbWFsbCIsCiAgMHhmNzYzLAogICJEIiwKICAweDAwNDQsCiAgIkRaIiwKICAweDAxZjEsCiAgIkRaY2Fyb24iLAogIDB4MDFjNCwKICAiRGFhcm1lbmlhbiIsCiAgMHgwNTM0LAogICJEYWZyaWNhbiIsCiAgMHgwMTg5LAogICJEY2Fyb24iLAogIDB4MDEwZSwKICAiRGNlZGlsbGEiLAogIDB4MWUxMCwKICAiRGNpcmNsZSIsCiAgMHgyNGI5LAogICJEY2lyY3VtZmxleGJlbG93IiwKICAweDFlMTIsCiAgIkRjcm9hdCIsCiAgMHgwMTEwLAogICJEZG90YWNjZW50IiwKICAweDFlMGEsCiAgIkRkb3RiZWxvdyIsCiAgMHgxZTBjLAogICJEZWN5cmlsbGljIiwKICAweDA0MTQsCiAgIkRlaWNvcHRpYyIsCiAgMHgwM2VlLAogICJEZWx0YSIsCiAgMHgyMjA2LAogICJEZWx0YWdyZWVrIiwKICAweDAzOTQsCiAgIkRob29rIiwKICAweDAxOGEsCiAgIkRpZXJlc2lzIiwKICAweGY2Y2IsCiAgIkRpZXJlc2lzQWN1dGUiLAogIDB4ZjZjYywKICAiRGllcmVzaXNHcmF2ZSIsCiAgMHhmNmNkLAogICJEaWVyZXNpc3NtYWxsIiwKICAweGY3YTgsCiAgIkRpZ2FtbWFncmVlayIsCiAgMHgwM2RjLAogICJEamVjeXJpbGxpYyIsCiAgMHgwNDAyLAogICJEbGluZWJlbG93IiwKICAweDFlMGUsCiAgIkRtb25vc3BhY2UiLAogIDB4ZmYyNCwKICAiRG90YWNjZW50c21hbGwiLAogIDB4ZjZmNywKICAiRHNsYXNoIiwKICAweDAxMTAsCiAgIkRzbWFsbCIsCiAgMHhmNzY0LAogICJEdG9wYmFyIiwKICAweDAxOGIsCiAgIkR6IiwKICAweDAxZjIsCiAgIkR6Y2Fyb24iLAogIDB4MDFjNSwKICAiRHplYWJraGFzaWFuY3lyaWxsaWMiLAogIDB4MDRlMCwKICAiRHplY3lyaWxsaWMiLAogIDB4MDQwNSwKICAiRHpoZWN5cmlsbGljIiwKICAweDA0MGYsCiAgIkUiLAogIDB4MDA0NSwKICAiRWFjdXRlIiwKICAweDAwYzksCiAgIkVhY3V0ZXNtYWxsIiwKICAweGY3ZTksCiAgIkVicmV2ZSIsCiAgMHgwMTE0LAogICJFY2Fyb24iLAogIDB4MDExYSwKICAiRWNlZGlsbGFicmV2ZSIsCiAgMHgxZTFjLAogICJFY2hhcm1lbmlhbiIsCiAgMHgwNTM1LAogICJFY2lyY2xlIiwKICAweDI0YmEsCiAgIkVjaXJjdW1mbGV4IiwKICAweDAwY2EsCiAgIkVjaXJjdW1mbGV4YWN1dGUiLAogIDB4MWViZSwKICAiRWNpcmN1bWZsZXhiZWxvdyIsCiAgMHgxZTE4LAogICJFY2lyY3VtZmxleGRvdGJlbG93IiwKICAweDFlYzYsCiAgIkVjaXJjdW1mbGV4Z3JhdmUiLAogIDB4MWVjMCwKICAiRWNpcmN1bWZsZXhob29rYWJvdmUiLAogIDB4MWVjMiwKICAiRWNpcmN1bWZsZXhzbWFsbCIsCiAgMHhmN2VhLAogICJFY2lyY3VtZmxleHRpbGRlIiwKICAweDFlYzQsCiAgIkVjeXJpbGxpYyIsCiAgMHgwNDA0LAogICJFZGJsZ3JhdmUiLAogIDB4MDIwNCwKICAiRWRpZXJlc2lzIiwKICAweDAwY2IsCiAgIkVkaWVyZXNpc3NtYWxsIiwKICAweGY3ZWIsCiAgIkVkb3QiLAogIDB4MDExNiwKICAiRWRvdGFjY2VudCIsCiAgMHgwMTE2LAogICJFZG90YmVsb3ciLAogIDB4MWViOCwKICAiRWZjeXJpbGxpYyIsCiAgMHgwNDI0LAogICJFZ3JhdmUiLAogIDB4MDBjOCwKICAiRWdyYXZlc21hbGwiLAogIDB4ZjdlOCwKICAiRWhhcm1lbmlhbiIsCiAgMHgwNTM3LAogICJFaG9va2Fib3ZlIiwKICAweDFlYmEsCiAgIkVpZ2h0cm9tYW4iLAogIDB4MjE2NywKICAiRWludmVydGVkYnJldmUiLAogIDB4MDIwNiwKICAiRWlvdGlmaWVkY3lyaWxsaWMiLAogIDB4MDQ2NCwKICAiRWxjeXJpbGxpYyIsCiAgMHgwNDFiLAogICJFbGV2ZW5yb21hbiIsCiAgMHgyMTZhLAogICJFbWFjcm9uIiwKICAweDAxMTIsCiAgIkVtYWNyb25hY3V0ZSIsCiAgMHgxZTE2LAogICJFbWFjcm9uZ3JhdmUiLAogIDB4MWUxNCwKICAiRW1jeXJpbGxpYyIsCiAgMHgwNDFjLAogICJFbW9ub3NwYWNlIiwKICAweGZmMjUsCiAgIkVuY3lyaWxsaWMiLAogIDB4MDQxZCwKICAiRW5kZXNjZW5kZXJjeXJpbGxpYyIsCiAgMHgwNGEyLAogICJFbmciLAogIDB4MDE0YSwKICAiRW5naGVjeXJpbGxpYyIsCiAgMHgwNGE0LAogICJFbmhvb2tjeXJpbGxpYyIsCiAgMHgwNGM3LAogICJFb2dvbmVrIiwKICAweDAxMTgsCiAgIkVvcGVuIiwKICAweDAxOTAsCiAgIkVwc2lsb24iLAogIDB4MDM5NSwKICAiRXBzaWxvbnRvbm9zIiwKICAweDAzODgsCiAgIkVyY3lyaWxsaWMiLAogIDB4MDQyMCwKICAiRXJldmVyc2VkIiwKICAweDAxOGUsCiAgIkVyZXZlcnNlZGN5cmlsbGljIiwKICAweDA0MmQsCiAgIkVzY3lyaWxsaWMiLAogIDB4MDQyMSwKICAiRXNkZXNjZW5kZXJjeXJpbGxpYyIsCiAgMHgwNGFhLAogICJFc2giLAogIDB4MDFhOSwKICAiRXNtYWxsIiwKICAweGY3NjUsCiAgIkV0YSIsCiAgMHgwMzk3LAogICJFdGFybWVuaWFuIiwKICAweDA1MzgsCiAgIkV0YXRvbm9zIiwKICAweDAzODksCiAgIkV0aCIsCiAgMHgwMGQwLAogICJFdGhzbWFsbCIsCiAgMHhmN2YwLAogICJFdGlsZGUiLAogIDB4MWViYywKICAiRXRpbGRlYmVsb3ciLAogIDB4MWUxYSwKICAiRXVybyIsCiAgMHgyMGFjLAogICJFemgiLAogIDB4MDFiNywKICAiRXpoY2Fyb24iLAogIDB4MDFlZSwKICAiRXpocmV2ZXJzZWQiLAogIDB4MDFiOCwKICAiRiIsCiAgMHgwMDQ2LAogICJGY2lyY2xlIiwKICAweDI0YmIsCiAgIkZkb3RhY2NlbnQiLAogIDB4MWUxZSwKICAiRmVoYXJtZW5pYW4iLAogIDB4MDU1NiwKICAiRmVpY29wdGljIiwKICAweDAzZTQsCiAgIkZob29rIiwKICAweDAxOTEsCiAgIkZpdGFjeXJpbGxpYyIsCiAgMHgwNDcyLAogICJGaXZlcm9tYW4iLAogIDB4MjE2NCwKICAiRm1vbm9zcGFjZSIsCiAgMHhmZjI2LAogICJGb3Vycm9tYW4iLAogIDB4MjE2MywKICAiRnNtYWxsIiwKICAweGY3NjYsCiAgIkciLAogIDB4MDA0NywKICAiR0JzcXVhcmUiLAogIDB4MzM4NywKICAiR2FjdXRlIiwKICAweDAxZjQsCiAgIkdhbW1hIiwKICAweDAzOTMsCiAgIkdhbW1hYWZyaWNhbiIsCiAgMHgwMTk0LAogICJHYW5naWFjb3B0aWMiLAogIDB4MDNlYSwKICAiR2JyZXZlIiwKICAweDAxMWUsCiAgIkdjYXJvbiIsCiAgMHgwMWU2LAogICJHY2VkaWxsYSIsCiAgMHgwMTIyLAogICJHY2lyY2xlIiwKICAweDI0YmMsCiAgIkdjaXJjdW1mbGV4IiwKICAweDAxMWMsCiAgIkdjb21tYWFjY2VudCIsCiAgMHgwMTIyLAogICJHZG90IiwKICAweDAxMjAsCiAgIkdkb3RhY2NlbnQiLAogIDB4MDEyMCwKICAiR2VjeXJpbGxpYyIsCiAgMHgwNDEzLAogICJHaGFkYXJtZW5pYW4iLAogIDB4MDU0MiwKICAiR2hlbWlkZGxlaG9va2N5cmlsbGljIiwKICAweDA0OTQsCiAgIkdoZXN0cm9rZWN5cmlsbGljIiwKICAweDA0OTIsCiAgIkdoZXVwdHVybmN5cmlsbGljIiwKICAweDA0OTAsCiAgIkdob29rIiwKICAweDAxOTMsCiAgIkdpbWFybWVuaWFuIiwKICAweDA1MzMsCiAgIkdqZWN5cmlsbGljIiwKICAweDA0MDMsCiAgIkdtYWNyb24iLAogIDB4MWUyMCwKICAiR21vbm9zcGFjZSIsCiAgMHhmZjI3LAogICJHcmF2ZSIsCiAgMHhmNmNlLAogICJHcmF2ZXNtYWxsIiwKICAweGY3NjAsCiAgIkdzbWFsbCIsCiAgMHhmNzY3LAogICJHc21hbGxob29rIiwKICAweDAyOWIsCiAgIkdzdHJva2UiLAogIDB4MDFlNCwKICAiSCIsCiAgMHgwMDQ4LAogICJIMTg1MzMiLAogIDB4MjVjZiwKICAiSDE4NTQzIiwKICAweDI1YWEsCiAgIkgxODU1MSIsCiAgMHgyNWFiLAogICJIMjIwNzMiLAogIDB4MjVhMSwKICAiSFBzcXVhcmUiLAogIDB4MzNjYiwKICAiSGFhYmtoYXNpYW5jeXJpbGxpYyIsCiAgMHgwNGE4LAogICJIYWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0YjIsCiAgIkhhcmRzaWduY3lyaWxsaWMiLAogIDB4MDQyYSwKICAiSGJhciIsCiAgMHgwMTI2LAogICJIYnJldmViZWxvdyIsCiAgMHgxZTJhLAogICJIY2VkaWxsYSIsCiAgMHgxZTI4LAogICJIY2lyY2xlIiwKICAweDI0YmQsCiAgIkhjaXJjdW1mbGV4IiwKICAweDAxMjQsCiAgIkhkaWVyZXNpcyIsCiAgMHgxZTI2LAogICJIZG90YWNjZW50IiwKICAweDFlMjIsCiAgIkhkb3RiZWxvdyIsCiAgMHgxZTI0LAogICJIbW9ub3NwYWNlIiwKICAweGZmMjgsCiAgIkhvYXJtZW5pYW4iLAogIDB4MDU0MCwKICAiSG9yaWNvcHRpYyIsCiAgMHgwM2U4LAogICJIc21hbGwiLAogIDB4Zjc2OCwKICAiSHVuZ2FydW1sYXV0IiwKICAweGY2Y2YsCiAgIkh1bmdhcnVtbGF1dHNtYWxsIiwKICAweGY2ZjgsCiAgIkh6c3F1YXJlIiwKICAweDMzOTAsCiAgIkkiLAogIDB4MDA0OSwKICAiSUFjeXJpbGxpYyIsCiAgMHgwNDJmLAogICJJSiIsCiAgMHgwMTMyLAogICJJVWN5cmlsbGljIiwKICAweDA0MmUsCiAgIklhY3V0ZSIsCiAgMHgwMGNkLAogICJJYWN1dGVzbWFsbCIsCiAgMHhmN2VkLAogICJJYnJldmUiLAogIDB4MDEyYywKICAiSWNhcm9uIiwKICAweDAxY2YsCiAgIkljaXJjbGUiLAogIDB4MjRiZSwKICAiSWNpcmN1bWZsZXgiLAogIDB4MDBjZSwKICAiSWNpcmN1bWZsZXhzbWFsbCIsCiAgMHhmN2VlLAogICJJY3lyaWxsaWMiLAogIDB4MDQwNiwKICAiSWRibGdyYXZlIiwKICAweDAyMDgsCiAgIklkaWVyZXNpcyIsCiAgMHgwMGNmLAogICJJZGllcmVzaXNhY3V0ZSIsCiAgMHgxZTJlLAogICJJZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGU0LAogICJJZGllcmVzaXNzbWFsbCIsCiAgMHhmN2VmLAogICJJZG90IiwKICAweDAxMzAsCiAgIklkb3RhY2NlbnQiLAogIDB4MDEzMCwKICAiSWRvdGJlbG93IiwKICAweDFlY2EsCiAgIkllYnJldmVjeXJpbGxpYyIsCiAgMHgwNGQ2LAogICJJZWN5cmlsbGljIiwKICAweDA0MTUsCiAgIklmcmFrdHVyIiwKICAweDIxMTEsCiAgIklncmF2ZSIsCiAgMHgwMGNjLAogICJJZ3JhdmVzbWFsbCIsCiAgMHhmN2VjLAogICJJaG9va2Fib3ZlIiwKICAweDFlYzgsCiAgIklpY3lyaWxsaWMiLAogIDB4MDQxOCwKICAiSWludmVydGVkYnJldmUiLAogIDB4MDIwYSwKICAiSWlzaG9ydGN5cmlsbGljIiwKICAweDA0MTksCiAgIkltYWNyb24iLAogIDB4MDEyYSwKICAiSW1hY3JvbmN5cmlsbGljIiwKICAweDA0ZTIsCiAgIkltb25vc3BhY2UiLAogIDB4ZmYyOSwKICAiSW5pYXJtZW5pYW4iLAogIDB4MDUzYiwKICAiSW9jeXJpbGxpYyIsCiAgMHgwNDAxLAogICJJb2dvbmVrIiwKICAweDAxMmUsCiAgIklvdGEiLAogIDB4MDM5OSwKICAiSW90YWFmcmljYW4iLAogIDB4MDE5NiwKICAiSW90YWRpZXJlc2lzIiwKICAweDAzYWEsCiAgIklvdGF0b25vcyIsCiAgMHgwMzhhLAogICJJc21hbGwiLAogIDB4Zjc2OSwKICAiSXN0cm9rZSIsCiAgMHgwMTk3LAogICJJdGlsZGUiLAogIDB4MDEyOCwKICAiSXRpbGRlYmVsb3ciLAogIDB4MWUyYywKICAiSXpoaXRzYWN5cmlsbGljIiwKICAweDA0NzQsCiAgIkl6aGl0c2FkYmxncmF2ZWN5cmlsbGljIiwKICAweDA0NzYsCiAgIkoiLAogIDB4MDA0YSwKICAiSmFhcm1lbmlhbiIsCiAgMHgwNTQxLAogICJKY2lyY2xlIiwKICAweDI0YmYsCiAgIkpjaXJjdW1mbGV4IiwKICAweDAxMzQsCiAgIkplY3lyaWxsaWMiLAogIDB4MDQwOCwKICAiSmhlaGFybWVuaWFuIiwKICAweDA1NGIsCiAgIkptb25vc3BhY2UiLAogIDB4ZmYyYSwKICAiSnNtYWxsIiwKICAweGY3NmEsCiAgIksiLAogIDB4MDA0YiwKICAiS0JzcXVhcmUiLAogIDB4MzM4NSwKICAiS0tzcXVhcmUiLAogIDB4MzNjZCwKICAiS2FiYXNoa2lyY3lyaWxsaWMiLAogIDB4MDRhMCwKICAiS2FjdXRlIiwKICAweDFlMzAsCiAgIkthY3lyaWxsaWMiLAogIDB4MDQxYSwKICAiS2FkZXNjZW5kZXJjeXJpbGxpYyIsCiAgMHgwNDlhLAogICJLYWhvb2tjeXJpbGxpYyIsCiAgMHgwNGMzLAogICJLYXBwYSIsCiAgMHgwMzlhLAogICJLYXN0cm9rZWN5cmlsbGljIiwKICAweDA0OWUsCiAgIkthdmVydGljYWxzdHJva2VjeXJpbGxpYyIsCiAgMHgwNDljLAogICJLY2Fyb24iLAogIDB4MDFlOCwKICAiS2NlZGlsbGEiLAogIDB4MDEzNiwKICAiS2NpcmNsZSIsCiAgMHgyNGMwLAogICJLY29tbWFhY2NlbnQiLAogIDB4MDEzNiwKICAiS2RvdGJlbG93IiwKICAweDFlMzIsCiAgIktlaGFybWVuaWFuIiwKICAweDA1NTQsCiAgIktlbmFybWVuaWFuIiwKICAweDA1M2YsCiAgIktoYWN5cmlsbGljIiwKICAweDA0MjUsCiAgIktoZWljb3B0aWMiLAogIDB4MDNlNiwKICAiS2hvb2siLAogIDB4MDE5OCwKICAiS2plY3lyaWxsaWMiLAogIDB4MDQwYywKICAiS2xpbmViZWxvdyIsCiAgMHgxZTM0LAogICJLbW9ub3NwYWNlIiwKICAweGZmMmIsCiAgIktvcHBhY3lyaWxsaWMiLAogIDB4MDQ4MCwKICAiS29wcGFncmVlayIsCiAgMHgwM2RlLAogICJLc2ljeXJpbGxpYyIsCiAgMHgwNDZlLAogICJLc21hbGwiLAogIDB4Zjc2YiwKICAiTCIsCiAgMHgwMDRjLAogICJMSiIsCiAgMHgwMWM3LAogICJMTCIsCiAgMHhmNmJmLAogICJMYWN1dGUiLAogIDB4MDEzOSwKICAiTGFtYmRhIiwKICAweDAzOWIsCiAgIkxjYXJvbiIsCiAgMHgwMTNkLAogICJMY2VkaWxsYSIsCiAgMHgwMTNiLAogICJMY2lyY2xlIiwKICAweDI0YzEsCiAgIkxjaXJjdW1mbGV4YmVsb3ciLAogIDB4MWUzYywKICAiTGNvbW1hYWNjZW50IiwKICAweDAxM2IsCiAgIkxkb3QiLAogIDB4MDEzZiwKICAiTGRvdGFjY2VudCIsCiAgMHgwMTNmLAogICJMZG90YmVsb3ciLAogIDB4MWUzNiwKICAiTGRvdGJlbG93bWFjcm9uIiwKICAweDFlMzgsCiAgIkxpd25hcm1lbmlhbiIsCiAgMHgwNTNjLAogICJMaiIsCiAgMHgwMWM4LAogICJMamVjeXJpbGxpYyIsCiAgMHgwNDA5LAogICJMbGluZWJlbG93IiwKICAweDFlM2EsCiAgIkxtb25vc3BhY2UiLAogIDB4ZmYyYywKICAiTHNsYXNoIiwKICAweDAxNDEsCiAgIkxzbGFzaHNtYWxsIiwKICAweGY2ZjksCiAgIkxzbWFsbCIsCiAgMHhmNzZjLAogICJNIiwKICAweDAwNGQsCiAgIk1Cc3F1YXJlIiwKICAweDMzODYsCiAgIk1hY3JvbiIsCiAgMHhmNmQwLAogICJNYWNyb25zbWFsbCIsCiAgMHhmN2FmLAogICJNYWN1dGUiLAogIDB4MWUzZSwKICAiTWNpcmNsZSIsCiAgMHgyNGMyLAogICJNZG90YWNjZW50IiwKICAweDFlNDAsCiAgIk1kb3RiZWxvdyIsCiAgMHgxZTQyLAogICJNZW5hcm1lbmlhbiIsCiAgMHgwNTQ0LAogICJNbW9ub3NwYWNlIiwKICAweGZmMmQsCiAgIk1zbWFsbCIsCiAgMHhmNzZkLAogICJNdHVybmVkIiwKICAweDAxOWMsCiAgIk11IiwKICAweDAzOWMsCiAgIk4iLAogIDB4MDA0ZSwKICAiTkoiLAogIDB4MDFjYSwKICAiTmFjdXRlIiwKICAweDAxNDMsCiAgIk5jYXJvbiIsCiAgMHgwMTQ3LAogICJOY2VkaWxsYSIsCiAgMHgwMTQ1LAogICJOY2lyY2xlIiwKICAweDI0YzMsCiAgIk5jaXJjdW1mbGV4YmVsb3ciLAogIDB4MWU0YSwKICAiTmNvbW1hYWNjZW50IiwKICAweDAxNDUsCiAgIk5kb3RhY2NlbnQiLAogIDB4MWU0NCwKICAiTmRvdGJlbG93IiwKICAweDFlNDYsCiAgIk5ob29rbGVmdCIsCiAgMHgwMTlkLAogICJOaW5lcm9tYW4iLAogIDB4MjE2OCwKICAiTmoiLAogIDB4MDFjYiwKICAiTmplY3lyaWxsaWMiLAogIDB4MDQwYSwKICAiTmxpbmViZWxvdyIsCiAgMHgxZTQ4LAogICJObW9ub3NwYWNlIiwKICAweGZmMmUsCiAgIk5vd2FybWVuaWFuIiwKICAweDA1NDYsCiAgIk5zbWFsbCIsCiAgMHhmNzZlLAogICJOdGlsZGUiLAogIDB4MDBkMSwKICAiTnRpbGRlc21hbGwiLAogIDB4ZjdmMSwKICAiTnUiLAogIDB4MDM5ZCwKICAiTyIsCiAgMHgwMDRmLAogICJPRSIsCiAgMHgwMTUyLAogICJPRXNtYWxsIiwKICAweGY2ZmEsCiAgIk9hY3V0ZSIsCiAgMHgwMGQzLAogICJPYWN1dGVzbWFsbCIsCiAgMHhmN2YzLAogICJPYmFycmVkY3lyaWxsaWMiLAogIDB4MDRlOCwKICAiT2JhcnJlZGRpZXJlc2lzY3lyaWxsaWMiLAogIDB4MDRlYSwKICAiT2JyZXZlIiwKICAweDAxNGUsCiAgIk9jYXJvbiIsCiAgMHgwMWQxLAogICJPY2VudGVyZWR0aWxkZSIsCiAgMHgwMTlmLAogICJPY2lyY2xlIiwKICAweDI0YzQsCiAgIk9jaXJjdW1mbGV4IiwKICAweDAwZDQsCiAgIk9jaXJjdW1mbGV4YWN1dGUiLAogIDB4MWVkMCwKICAiT2NpcmN1bWZsZXhkb3RiZWxvdyIsCiAgMHgxZWQ4LAogICJPY2lyY3VtZmxleGdyYXZlIiwKICAweDFlZDIsCiAgIk9jaXJjdW1mbGV4aG9va2Fib3ZlIiwKICAweDFlZDQsCiAgIk9jaXJjdW1mbGV4c21hbGwiLAogIDB4ZjdmNCwKICAiT2NpcmN1bWZsZXh0aWxkZSIsCiAgMHgxZWQ2LAogICJPY3lyaWxsaWMiLAogIDB4MDQxZSwKICAiT2RibGFjdXRlIiwKICAweDAxNTAsCiAgIk9kYmxncmF2ZSIsCiAgMHgwMjBjLAogICJPZGllcmVzaXMiLAogIDB4MDBkNiwKICAiT2RpZXJlc2lzY3lyaWxsaWMiLAogIDB4MDRlNiwKICAiT2RpZXJlc2lzc21hbGwiLAogIDB4ZjdmNiwKICAiT2RvdGJlbG93IiwKICAweDFlY2MsCiAgIk9nb25la3NtYWxsIiwKICAweGY2ZmIsCiAgIk9ncmF2ZSIsCiAgMHgwMGQyLAogICJPZ3JhdmVzbWFsbCIsCiAgMHhmN2YyLAogICJPaGFybWVuaWFuIiwKICAweDA1NTUsCiAgIk9obSIsCiAgMHgyMTI2LAogICJPaG9va2Fib3ZlIiwKICAweDFlY2UsCiAgIk9ob3JuIiwKICAweDAxYTAsCiAgIk9ob3JuYWN1dGUiLAogIDB4MWVkYSwKICAiT2hvcm5kb3RiZWxvdyIsCiAgMHgxZWUyLAogICJPaG9ybmdyYXZlIiwKICAweDFlZGMsCiAgIk9ob3JuaG9va2Fib3ZlIiwKICAweDFlZGUsCiAgIk9ob3JudGlsZGUiLAogIDB4MWVlMCwKICAiT2h1bmdhcnVtbGF1dCIsCiAgMHgwMTUwLAogICJPaSIsCiAgMHgwMWEyLAogICJPaW52ZXJ0ZWRicmV2ZSIsCiAgMHgwMjBlLAogICJPbWFjcm9uIiwKICAweDAxNGMsCiAgIk9tYWNyb25hY3V0ZSIsCiAgMHgxZTUyLAogICJPbWFjcm9uZ3JhdmUiLAogIDB4MWU1MCwKICAiT21lZ2EiLAogIDB4MjEyNiwKICAiT21lZ2FjeXJpbGxpYyIsCiAgMHgwNDYwLAogICJPbWVnYWdyZWVrIiwKICAweDAzYTksCiAgIk9tZWdhcm91bmRjeXJpbGxpYyIsCiAgMHgwNDdhLAogICJPbWVnYXRpdGxvY3lyaWxsaWMiLAogIDB4MDQ3YywKICAiT21lZ2F0b25vcyIsCiAgMHgwMzhmLAogICJPbWljcm9uIiwKICAweDAzOWYsCiAgIk9taWNyb250b25vcyIsCiAgMHgwMzhjLAogICJPbW9ub3NwYWNlIiwKICAweGZmMmYsCiAgIk9uZXJvbWFuIiwKICAweDIxNjAsCiAgIk9vZ29uZWsiLAogIDB4MDFlYSwKICAiT29nb25la21hY3JvbiIsCiAgMHgwMWVjLAogICJPb3BlbiIsCiAgMHgwMTg2LAogICJPc2xhc2giLAogIDB4MDBkOCwKICAiT3NsYXNoYWN1dGUiLAogIDB4MDFmZSwKICAiT3NsYXNoc21hbGwiLAogIDB4ZjdmOCwKICAiT3NtYWxsIiwKICAweGY3NmYsCiAgIk9zdHJva2VhY3V0ZSIsCiAgMHgwMWZlLAogICJPdGN5cmlsbGljIiwKICAweDA0N2UsCiAgIk90aWxkZSIsCiAgMHgwMGQ1LAogICJPdGlsZGVhY3V0ZSIsCiAgMHgxZTRjLAogICJPdGlsZGVkaWVyZXNpcyIsCiAgMHgxZTRlLAogICJPdGlsZGVzbWFsbCIsCiAgMHhmN2Y1LAogICJQIiwKICAweDAwNTAsCiAgIlBhY3V0ZSIsCiAgMHgxZTU0LAogICJQY2lyY2xlIiwKICAweDI0YzUsCiAgIlBkb3RhY2NlbnQiLAogIDB4MWU1NiwKICAiUGVjeXJpbGxpYyIsCiAgMHgwNDFmLAogICJQZWhhcm1lbmlhbiIsCiAgMHgwNTRhLAogICJQZW1pZGRsZWhvb2tjeXJpbGxpYyIsCiAgMHgwNGE2LAogICJQaGkiLAogIDB4MDNhNiwKICAiUGhvb2siLAogIDB4MDFhNCwKICAiUGkiLAogIDB4MDNhMCwKICAiUGl3cmFybWVuaWFuIiwKICAweDA1NTMsCiAgIlBtb25vc3BhY2UiLAogIDB4ZmYzMCwKICAiUHNpIiwKICAweDAzYTgsCiAgIlBzaWN5cmlsbGljIiwKICAweDA0NzAsCiAgIlBzbWFsbCIsCiAgMHhmNzcwLAogICJRIiwKICAweDAwNTEsCiAgIlFjaXJjbGUiLAogIDB4MjRjNiwKICAiUW1vbm9zcGFjZSIsCiAgMHhmZjMxLAogICJRc21hbGwiLAogIDB4Zjc3MSwKICAiUiIsCiAgMHgwMDUyLAogICJSYWFybWVuaWFuIiwKICAweDA1NGMsCiAgIlJhY3V0ZSIsCiAgMHgwMTU0LAogICJSY2Fyb24iLAogIDB4MDE1OCwKICAiUmNlZGlsbGEiLAogIDB4MDE1NiwKICAiUmNpcmNsZSIsCiAgMHgyNGM3LAogICJSY29tbWFhY2NlbnQiLAogIDB4MDE1NiwKICAiUmRibGdyYXZlIiwKICAweDAyMTAsCiAgIlJkb3RhY2NlbnQiLAogIDB4MWU1OCwKICAiUmRvdGJlbG93IiwKICAweDFlNWEsCiAgIlJkb3RiZWxvd21hY3JvbiIsCiAgMHgxZTVjLAogICJSZWhhcm1lbmlhbiIsCiAgMHgwNTUwLAogICJSZnJha3R1ciIsCiAgMHgyMTFjLAogICJSaG8iLAogIDB4MDNhMSwKICAiUmluZ3NtYWxsIiwKICAweGY2ZmMsCiAgIlJpbnZlcnRlZGJyZXZlIiwKICAweDAyMTIsCiAgIlJsaW5lYmVsb3ciLAogIDB4MWU1ZSwKICAiUm1vbm9zcGFjZSIsCiAgMHhmZjMyLAogICJSc21hbGwiLAogIDB4Zjc3MiwKICAiUnNtYWxsaW52ZXJ0ZWQiLAogIDB4MDI4MSwKICAiUnNtYWxsaW52ZXJ0ZWRzdXBlcmlvciIsCiAgMHgwMmI2LAogICJTIiwKICAweDAwNTMsCiAgIlNGMDEwMDAwIiwKICAweDI1MGMsCiAgIlNGMDIwMDAwIiwKICAweDI1MTQsCiAgIlNGMDMwMDAwIiwKICAweDI1MTAsCiAgIlNGMDQwMDAwIiwKICAweDI1MTgsCiAgIlNGMDUwMDAwIiwKICAweDI1M2MsCiAgIlNGMDYwMDAwIiwKICAweDI1MmMsCiAgIlNGMDcwMDAwIiwKICAweDI1MzQsCiAgIlNGMDgwMDAwIiwKICAweDI1MWMsCiAgIlNGMDkwMDAwIiwKICAweDI1MjQsCiAgIlNGMTAwMDAwIiwKICAweDI1MDAsCiAgIlNGMTEwMDAwIiwKICAweDI1MDIsCiAgIlNGMTkwMDAwIiwKICAweDI1NjEsCiAgIlNGMjAwMDAwIiwKICAweDI1NjIsCiAgIlNGMjEwMDAwIiwKICAweDI1NTYsCiAgIlNGMjIwMDAwIiwKICAweDI1NTUsCiAgIlNGMjMwMDAwIiwKICAweDI1NjMsCiAgIlNGMjQwMDAwIiwKICAweDI1NTEsCiAgIlNGMjUwMDAwIiwKICAweDI1NTcsCiAgIlNGMjYwMDAwIiwKICAweDI1NWQsCiAgIlNGMjcwMDAwIiwKICAweDI1NWMsCiAgIlNGMjgwMDAwIiwKICAweDI1NWIsCiAgIlNGMzYwMDAwIiwKICAweDI1NWUsCiAgIlNGMzcwMDAwIiwKICAweDI1NWYsCiAgIlNGMzgwMDAwIiwKICAweDI1NWEsCiAgIlNGMzkwMDAwIiwKICAweDI1NTQsCiAgIlNGNDAwMDAwIiwKICAweDI1NjksCiAgIlNGNDEwMDAwIiwKICAweDI1NjYsCiAgIlNGNDIwMDAwIiwKICAweDI1NjAsCiAgIlNGNDMwMDAwIiwKICAweDI1NTAsCiAgIlNGNDQwMDAwIiwKICAweDI1NmMsCiAgIlNGNDUwMDAwIiwKICAweDI1NjcsCiAgIlNGNDYwMDAwIiwKICAweDI1NjgsCiAgIlNGNDcwMDAwIiwKICAweDI1NjQsCiAgIlNGNDgwMDAwIiwKICAweDI1NjUsCiAgIlNGNDkwMDAwIiwKICAweDI1NTksCiAgIlNGNTAwMDAwIiwKICAweDI1NTgsCiAgIlNGNTEwMDAwIiwKICAweDI1NTIsCiAgIlNGNTIwMDAwIiwKICAweDI1NTMsCiAgIlNGNTMwMDAwIiwKICAweDI1NmIsCiAgIlNGNTQwMDAwIiwKICAweDI1NmEsCiAgIlNhY3V0ZSIsCiAgMHgwMTVhLAogICJTYWN1dGVkb3RhY2NlbnQiLAogIDB4MWU2NCwKICAiU2FtcGlncmVlayIsCiAgMHgwM2UwLAogICJTY2Fyb24iLAogIDB4MDE2MCwKICAiU2Nhcm9uZG90YWNjZW50IiwKICAweDFlNjYsCiAgIlNjYXJvbnNtYWxsIiwKICAweGY2ZmQsCiAgIlNjZWRpbGxhIiwKICAweDAxNWUsCiAgIlNjaHdhIiwKICAweDAxOGYsCiAgIlNjaHdhY3lyaWxsaWMiLAogIDB4MDRkOCwKICAiU2Nod2FkaWVyZXNpc2N5cmlsbGljIiwKICAweDA0ZGEsCiAgIlNjaXJjbGUiLAogIDB4MjRjOCwKICAiU2NpcmN1bWZsZXgiLAogIDB4MDE1YywKICAiU2NvbW1hYWNjZW50IiwKICAweDAyMTgsCiAgIlNkb3RhY2NlbnQiLAogIDB4MWU2MCwKICAiU2RvdGJlbG93IiwKICAweDFlNjIsCiAgIlNkb3RiZWxvd2RvdGFjY2VudCIsCiAgMHgxZTY4LAogICJTZWhhcm1lbmlhbiIsCiAgMHgwNTRkLAogICJTZXZlbnJvbWFuIiwKICAweDIxNjYsCiAgIlNoYWFybWVuaWFuIiwKICAweDA1NDcsCiAgIlNoYWN5cmlsbGljIiwKICAweDA0MjgsCiAgIlNoY2hhY3lyaWxsaWMiLAogIDB4MDQyOSwKICAiU2hlaWNvcHRpYyIsCiAgMHgwM2UyLAogICJTaGhhY3lyaWxsaWMiLAogIDB4MDRiYSwKICAiU2hpbWFjb3B0aWMiLAogIDB4MDNlYywKICAiU2lnbWEiLAogIDB4MDNhMywKICAiU2l4cm9tYW4iLAogIDB4MjE2NSwKICAiU21vbm9zcGFjZSIsCiAgMHhmZjMzLAogICJTb2Z0c2lnbmN5cmlsbGljIiwKICAweDA0MmMsCiAgIlNzbWFsbCIsCiAgMHhmNzczLAogICJTdGlnbWFncmVlayIsCiAgMHgwM2RhLAogICJUIiwKICAweDAwNTQsCiAgIlRhdSIsCiAgMHgwM2E0LAogICJUYmFyIiwKICAweDAxNjYsCiAgIlRjYXJvbiIsCiAgMHgwMTY0LAogICJUY2VkaWxsYSIsCiAgMHgwMTYyLAogICJUY2lyY2xlIiwKICAweDI0YzksCiAgIlRjaXJjdW1mbGV4YmVsb3ciLAogIDB4MWU3MCwKICAiVGNvbW1hYWNjZW50IiwKICAweDAxNjIsCiAgIlRkb3RhY2NlbnQiLAogIDB4MWU2YSwKICAiVGRvdGJlbG93IiwKICAweDFlNmMsCiAgIlRlY3lyaWxsaWMiLAogIDB4MDQyMiwKICAiVGVkZXNjZW5kZXJjeXJpbGxpYyIsCiAgMHgwNGFjLAogICJUZW5yb21hbiIsCiAgMHgyMTY5LAogICJUZXRzZWN5cmlsbGljIiwKICAweDA0YjQsCiAgIlRoZXRhIiwKICAweDAzOTgsCiAgIlRob29rIiwKICAweDAxYWMsCiAgIlRob3JuIiwKICAweDAwZGUsCiAgIlRob3Juc21hbGwiLAogIDB4ZjdmZSwKICAiVGhyZWVyb21hbiIsCiAgMHgyMTYyLAogICJUaWxkZXNtYWxsIiwKICAweGY2ZmUsCiAgIlRpd25hcm1lbmlhbiIsCiAgMHgwNTRmLAogICJUbGluZWJlbG93IiwKICAweDFlNmUsCiAgIlRtb25vc3BhY2UiLAogIDB4ZmYzNCwKICAiVG9hcm1lbmlhbiIsCiAgMHgwNTM5LAogICJUb25lZml2ZSIsCiAgMHgwMWJjLAogICJUb25lc2l4IiwKICAweDAxODQsCiAgIlRvbmV0d28iLAogIDB4MDFhNywKICAiVHJldHJvZmxleGhvb2siLAogIDB4MDFhZSwKICAiVHNlY3lyaWxsaWMiLAogIDB4MDQyNiwKICAiVHNoZWN5cmlsbGljIiwKICAweDA0MGIsCiAgIlRzbWFsbCIsCiAgMHhmNzc0LAogICJUd2VsdmVyb21hbiIsCiAgMHgyMTZiLAogICJUd29yb21hbiIsCiAgMHgyMTYxLAogICJVIiwKICAweDAwNTUsCiAgIlVhY3V0ZSIsCiAgMHgwMGRhLAogICJVYWN1dGVzbWFsbCIsCiAgMHhmN2ZhLAogICJVYnJldmUiLAogIDB4MDE2YywKICAiVWNhcm9uIiwKICAweDAxZDMsCiAgIlVjaXJjbGUiLAogIDB4MjRjYSwKICAiVWNpcmN1bWZsZXgiLAogIDB4MDBkYiwKICAiVWNpcmN1bWZsZXhiZWxvdyIsCiAgMHgxZTc2LAogICJVY2lyY3VtZmxleHNtYWxsIiwKICAweGY3ZmIsCiAgIlVjeXJpbGxpYyIsCiAgMHgwNDIzLAogICJVZGJsYWN1dGUiLAogIDB4MDE3MCwKICAiVWRibGdyYXZlIiwKICAweDAyMTQsCiAgIlVkaWVyZXNpcyIsCiAgMHgwMGRjLAogICJVZGllcmVzaXNhY3V0ZSIsCiAgMHgwMWQ3LAogICJVZGllcmVzaXNiZWxvdyIsCiAgMHgxZTcyLAogICJVZGllcmVzaXNjYXJvbiIsCiAgMHgwMWQ5LAogICJVZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGYwLAogICJVZGllcmVzaXNncmF2ZSIsCiAgMHgwMWRiLAogICJVZGllcmVzaXNtYWNyb24iLAogIDB4MDFkNSwKICAiVWRpZXJlc2lzc21hbGwiLAogIDB4ZjdmYywKICAiVWRvdGJlbG93IiwKICAweDFlZTQsCiAgIlVncmF2ZSIsCiAgMHgwMGQ5LAogICJVZ3JhdmVzbWFsbCIsCiAgMHhmN2Y5LAogICJVaG9va2Fib3ZlIiwKICAweDFlZTYsCiAgIlVob3JuIiwKICAweDAxYWYsCiAgIlVob3JuYWN1dGUiLAogIDB4MWVlOCwKICAiVWhvcm5kb3RiZWxvdyIsCiAgMHgxZWYwLAogICJVaG9ybmdyYXZlIiwKICAweDFlZWEsCiAgIlVob3JuaG9va2Fib3ZlIiwKICAweDFlZWMsCiAgIlVob3JudGlsZGUiLAogIDB4MWVlZSwKICAiVWh1bmdhcnVtbGF1dCIsCiAgMHgwMTcwLAogICJVaHVuZ2FydW1sYXV0Y3lyaWxsaWMiLAogIDB4MDRmMiwKICAiVWludmVydGVkYnJldmUiLAogIDB4MDIxNiwKICAiVWtjeXJpbGxpYyIsCiAgMHgwNDc4LAogICJVbWFjcm9uIiwKICAweDAxNmEsCiAgIlVtYWNyb25jeXJpbGxpYyIsCiAgMHgwNGVlLAogICJVbWFjcm9uZGllcmVzaXMiLAogIDB4MWU3YSwKICAiVW1vbm9zcGFjZSIsCiAgMHhmZjM1LAogICJVb2dvbmVrIiwKICAweDAxNzIsCiAgIlVwc2lsb24iLAogIDB4MDNhNSwKICAiVXBzaWxvbjEiLAogIDB4MDNkMiwKICAiVXBzaWxvbmFjdXRlaG9va3N5bWJvbGdyZWVrIiwKICAweDAzZDMsCiAgIlVwc2lsb25hZnJpY2FuIiwKICAweDAxYjEsCiAgIlVwc2lsb25kaWVyZXNpcyIsCiAgMHgwM2FiLAogICJVcHNpbG9uZGllcmVzaXNob29rc3ltYm9sZ3JlZWsiLAogIDB4MDNkNCwKICAiVXBzaWxvbmhvb2tzeW1ib2wiLAogIDB4MDNkMiwKICAiVXBzaWxvbnRvbm9zIiwKICAweDAzOGUsCiAgIlVyaW5nIiwKICAweDAxNmUsCiAgIlVzaG9ydGN5cmlsbGljIiwKICAweDA0MGUsCiAgIlVzbWFsbCIsCiAgMHhmNzc1LAogICJVc3RyYWlnaHRjeXJpbGxpYyIsCiAgMHgwNGFlLAogICJVc3RyYWlnaHRzdHJva2VjeXJpbGxpYyIsCiAgMHgwNGIwLAogICJVdGlsZGUiLAogIDB4MDE2OCwKICAiVXRpbGRlYWN1dGUiLAogIDB4MWU3OCwKICAiVXRpbGRlYmVsb3ciLAogIDB4MWU3NCwKICAiViIsCiAgMHgwMDU2LAogICJWY2lyY2xlIiwKICAweDI0Y2IsCiAgIlZkb3RiZWxvdyIsCiAgMHgxZTdlLAogICJWZWN5cmlsbGljIiwKICAweDA0MTIsCiAgIlZld2FybWVuaWFuIiwKICAweDA1NGUsCiAgIlZob29rIiwKICAweDAxYjIsCiAgIlZtb25vc3BhY2UiLAogIDB4ZmYzNiwKICAiVm9hcm1lbmlhbiIsCiAgMHgwNTQ4LAogICJWc21hbGwiLAogIDB4Zjc3NiwKICAiVnRpbGRlIiwKICAweDFlN2MsCiAgIlciLAogIDB4MDA1NywKICAiV2FjdXRlIiwKICAweDFlODIsCiAgIldjaXJjbGUiLAogIDB4MjRjYywKICAiV2NpcmN1bWZsZXgiLAogIDB4MDE3NCwKICAiV2RpZXJlc2lzIiwKICAweDFlODQsCiAgIldkb3RhY2NlbnQiLAogIDB4MWU4NiwKICAiV2RvdGJlbG93IiwKICAweDFlODgsCiAgIldncmF2ZSIsCiAgMHgxZTgwLAogICJXbW9ub3NwYWNlIiwKICAweGZmMzcsCiAgIldzbWFsbCIsCiAgMHhmNzc3LAogICJYIiwKICAweDAwNTgsCiAgIlhjaXJjbGUiLAogIDB4MjRjZCwKICAiWGRpZXJlc2lzIiwKICAweDFlOGMsCiAgIlhkb3RhY2NlbnQiLAogIDB4MWU4YSwKICAiWGVoYXJtZW5pYW4iLAogIDB4MDUzZCwKICAiWGkiLAogIDB4MDM5ZSwKICAiWG1vbm9zcGFjZSIsCiAgMHhmZjM4LAogICJYc21hbGwiLAogIDB4Zjc3OCwKICAiWSIsCiAgMHgwMDU5LAogICJZYWN1dGUiLAogIDB4MDBkZCwKICAiWWFjdXRlc21hbGwiLAogIDB4ZjdmZCwKICAiWWF0Y3lyaWxsaWMiLAogIDB4MDQ2MiwKICAiWWNpcmNsZSIsCiAgMHgyNGNlLAogICJZY2lyY3VtZmxleCIsCiAgMHgwMTc2LAogICJZZGllcmVzaXMiLAogIDB4MDE3OCwKICAiWWRpZXJlc2lzc21hbGwiLAogIDB4ZjdmZiwKICAiWWRvdGFjY2VudCIsCiAgMHgxZThlLAogICJZZG90YmVsb3ciLAogIDB4MWVmNCwKICAiWWVyaWN5cmlsbGljIiwKICAweDA0MmIsCiAgIlllcnVkaWVyZXNpc2N5cmlsbGljIiwKICAweDA0ZjgsCiAgIllncmF2ZSIsCiAgMHgxZWYyLAogICJZaG9vayIsCiAgMHgwMWIzLAogICJZaG9va2Fib3ZlIiwKICAweDFlZjYsCiAgIllpYXJtZW5pYW4iLAogIDB4MDU0NSwKICAiWWljeXJpbGxpYyIsCiAgMHgwNDA3LAogICJZaXduYXJtZW5pYW4iLAogIDB4MDU1MiwKICAiWW1vbm9zcGFjZSIsCiAgMHhmZjM5LAogICJZc21hbGwiLAogIDB4Zjc3OSwKICAiWXRpbGRlIiwKICAweDFlZjgsCiAgIll1c2JpZ2N5cmlsbGljIiwKICAweDA0NmEsCiAgIll1c2JpZ2lvdGlmaWVkY3lyaWxsaWMiLAogIDB4MDQ2YywKICAiWXVzbGl0dGxlY3lyaWxsaWMiLAogIDB4MDQ2NiwKICAiWXVzbGl0dGxlaW90aWZpZWRjeXJpbGxpYyIsCiAgMHgwNDY4LAogICJaIiwKICAweDAwNWEsCiAgIlphYXJtZW5pYW4iLAogIDB4MDUzNiwKICAiWmFjdXRlIiwKICAweDAxNzksCiAgIlpjYXJvbiIsCiAgMHgwMTdkLAogICJaY2Fyb25zbWFsbCIsCiAgMHhmNmZmLAogICJaY2lyY2xlIiwKICAweDI0Y2YsCiAgIlpjaXJjdW1mbGV4IiwKICAweDFlOTAsCiAgIlpkb3QiLAogIDB4MDE3YiwKICAiWmRvdGFjY2VudCIsCiAgMHgwMTdiLAogICJaZG90YmVsb3ciLAogIDB4MWU5MiwKICAiWmVjeXJpbGxpYyIsCiAgMHgwNDE3LAogICJaZWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0OTgsCiAgIlplZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGRlLAogICJaZXRhIiwKICAweDAzOTYsCiAgIlpoZWFybWVuaWFuIiwKICAweDA1M2EsCiAgIlpoZWJyZXZlY3lyaWxsaWMiLAogIDB4MDRjMSwKICAiWmhlY3lyaWxsaWMiLAogIDB4MDQxNiwKICAiWmhlZGVzY2VuZGVyY3lyaWxsaWMiLAogIDB4MDQ5NiwKICAiWmhlZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGRjLAogICJabGluZWJlbG93IiwKICAweDFlOTQsCiAgIlptb25vc3BhY2UiLAogIDB4ZmYzYSwKICAiWnNtYWxsIiwKICAweGY3N2EsCiAgIlpzdHJva2UiLAogIDB4MDFiNSwKICAiYSIsCiAgMHgwMDYxLAogICJhYWJlbmdhbGkiLAogIDB4MDk4NiwKICAiYWFjdXRlIiwKICAweDAwZTEsCiAgImFhZGV2YSIsCiAgMHgwOTA2LAogICJhYWd1amFyYXRpIiwKICAweDBhODYsCiAgImFhZ3VybXVraGkiLAogIDB4MGEwNiwKICAiYWFtYXRyYWd1cm11a2hpIiwKICAweDBhM2UsCiAgImFhcnVzcXVhcmUiLAogIDB4MzMwMywKICAiYWF2b3dlbHNpZ25iZW5nYWxpIiwKICAweDA5YmUsCiAgImFhdm93ZWxzaWduZGV2YSIsCiAgMHgwOTNlLAogICJhYXZvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhYmUsCiAgImFiYnJldmlhdGlvbm1hcmthcm1lbmlhbiIsCiAgMHgwNTVmLAogICJhYmJyZXZpYXRpb25zaWduZGV2YSIsCiAgMHgwOTcwLAogICJhYmVuZ2FsaSIsCiAgMHgwOTg1LAogICJhYm9wb21vZm8iLAogIDB4MzExYSwKICAiYWJyZXZlIiwKICAweDAxMDMsCiAgImFicmV2ZWFjdXRlIiwKICAweDFlYWYsCiAgImFicmV2ZWN5cmlsbGljIiwKICAweDA0ZDEsCiAgImFicmV2ZWRvdGJlbG93IiwKICAweDFlYjcsCiAgImFicmV2ZWdyYXZlIiwKICAweDFlYjEsCiAgImFicmV2ZWhvb2thYm92ZSIsCiAgMHgxZWIzLAogICJhYnJldmV0aWxkZSIsCiAgMHgxZWI1LAogICJhY2Fyb24iLAogIDB4MDFjZSwKICAiYWNpcmNsZSIsCiAgMHgyNGQwLAogICJhY2lyY3VtZmxleCIsCiAgMHgwMGUyLAogICJhY2lyY3VtZmxleGFjdXRlIiwKICAweDFlYTUsCiAgImFjaXJjdW1mbGV4ZG90YmVsb3ciLAogIDB4MWVhZCwKICAiYWNpcmN1bWZsZXhncmF2ZSIsCiAgMHgxZWE3LAogICJhY2lyY3VtZmxleGhvb2thYm92ZSIsCiAgMHgxZWE5LAogICJhY2lyY3VtZmxleHRpbGRlIiwKICAweDFlYWIsCiAgImFjdXRlIiwKICAweDAwYjQsCiAgImFjdXRlYmVsb3djbWIiLAogIDB4MDMxNywKICAiYWN1dGVjbWIiLAogIDB4MDMwMSwKICAiYWN1dGVjb21iIiwKICAweDAzMDEsCiAgImFjdXRlZGV2YSIsCiAgMHgwOTU0LAogICJhY3V0ZWxvd21vZCIsCiAgMHgwMmNmLAogICJhY3V0ZXRvbmVjbWIiLAogIDB4MDM0MSwKICAiYWN5cmlsbGljIiwKICAweDA0MzAsCiAgImFkYmxncmF2ZSIsCiAgMHgwMjAxLAogICJhZGRha2d1cm11a2hpIiwKICAweDBhNzEsCiAgImFkZXZhIiwKICAweDA5MDUsCiAgImFkaWVyZXNpcyIsCiAgMHgwMGU0LAogICJhZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGQzLAogICJhZGllcmVzaXNtYWNyb24iLAogIDB4MDFkZiwKICAiYWRvdGJlbG93IiwKICAweDFlYTEsCiAgImFkb3RtYWNyb24iLAogIDB4MDFlMSwKICAiYWUiLAogIDB4MDBlNiwKICAiYWVhY3V0ZSIsCiAgMHgwMWZkLAogICJhZWtvcmVhbiIsCiAgMHgzMTUwLAogICJhZW1hY3JvbiIsCiAgMHgwMWUzLAogICJhZmlpMDAyMDgiLAogIDB4MjAxNSwKICAiYWZpaTA4OTQxIiwKICAweDIwYTQsCiAgImFmaWkxMDAxNyIsCiAgMHgwNDEwLAogICJhZmlpMTAwMTgiLAogIDB4MDQxMSwKICAiYWZpaTEwMDE5IiwKICAweDA0MTIsCiAgImFmaWkxMDAyMCIsCiAgMHgwNDEzLAogICJhZmlpMTAwMjEiLAogIDB4MDQxNCwKICAiYWZpaTEwMDIyIiwKICAweDA0MTUsCiAgImFmaWkxMDAyMyIsCiAgMHgwNDAxLAogICJhZmlpMTAwMjQiLAogIDB4MDQxNiwKICAiYWZpaTEwMDI1IiwKICAweDA0MTcsCiAgImFmaWkxMDAyNiIsCiAgMHgwNDE4LAogICJhZmlpMTAwMjciLAogIDB4MDQxOSwKICAiYWZpaTEwMDI4IiwKICAweDA0MWEsCiAgImFmaWkxMDAyOSIsCiAgMHgwNDFiLAogICJhZmlpMTAwMzAiLAogIDB4MDQxYywKICAiYWZpaTEwMDMxIiwKICAweDA0MWQsCiAgImFmaWkxMDAzMiIsCiAgMHgwNDFlLAogICJhZmlpMTAwMzMiLAogIDB4MDQxZiwKICAiYWZpaTEwMDM0IiwKICAweDA0MjAsCiAgImFmaWkxMDAzNSIsCiAgMHgwNDIxLAogICJhZmlpMTAwMzYiLAogIDB4MDQyMiwKICAiYWZpaTEwMDM3IiwKICAweDA0MjMsCiAgImFmaWkxMDAzOCIsCiAgMHgwNDI0LAogICJhZmlpMTAwMzkiLAogIDB4MDQyNSwKICAiYWZpaTEwMDQwIiwKICAweDA0MjYsCiAgImFmaWkxMDA0MSIsCiAgMHgwNDI3LAogICJhZmlpMTAwNDIiLAogIDB4MDQyOCwKICAiYWZpaTEwMDQzIiwKICAweDA0MjksCiAgImFmaWkxMDA0NCIsCiAgMHgwNDJhLAogICJhZmlpMTAwNDUiLAogIDB4MDQyYiwKICAiYWZpaTEwMDQ2IiwKICAweDA0MmMsCiAgImFmaWkxMDA0NyIsCiAgMHgwNDJkLAogICJhZmlpMTAwNDgiLAogIDB4MDQyZSwKICAiYWZpaTEwMDQ5IiwKICAweDA0MmYsCiAgImFmaWkxMDA1MCIsCiAgMHgwNDkwLAogICJhZmlpMTAwNTEiLAogIDB4MDQwMiwKICAiYWZpaTEwMDUyIiwKICAweDA0MDMsCiAgImFmaWkxMDA1MyIsCiAgMHgwNDA0LAogICJhZmlpMTAwNTQiLAogIDB4MDQwNSwKICAiYWZpaTEwMDU1IiwKICAweDA0MDYsCiAgImFmaWkxMDA1NiIsCiAgMHgwNDA3LAogICJhZmlpMTAwNTciLAogIDB4MDQwOCwKICAiYWZpaTEwMDU4IiwKICAweDA0MDksCiAgImFmaWkxMDA1OSIsCiAgMHgwNDBhLAogICJhZmlpMTAwNjAiLAogIDB4MDQwYiwKICAiYWZpaTEwMDYxIiwKICAweDA0MGMsCiAgImFmaWkxMDA2MiIsCiAgMHgwNDBlLAogICJhZmlpMTAwNjMiLAogIDB4ZjZjNCwKICAiYWZpaTEwMDY0IiwKICAweGY2YzUsCiAgImFmaWkxMDA2NSIsCiAgMHgwNDMwLAogICJhZmlpMTAwNjYiLAogIDB4MDQzMSwKICAiYWZpaTEwMDY3IiwKICAweDA0MzIsCiAgImFmaWkxMDA2OCIsCiAgMHgwNDMzLAogICJhZmlpMTAwNjkiLAogIDB4MDQzNCwKICAiYWZpaTEwMDcwIiwKICAweDA0MzUsCiAgImFmaWkxMDA3MSIsCiAgMHgwNDUxLAogICJhZmlpMTAwNzIiLAogIDB4MDQzNiwKICAiYWZpaTEwMDczIiwKICAweDA0MzcsCiAgImFmaWkxMDA3NCIsCiAgMHgwNDM4LAogICJhZmlpMTAwNzUiLAogIDB4MDQzOSwKICAiYWZpaTEwMDc2IiwKICAweDA0M2EsCiAgImFmaWkxMDA3NyIsCiAgMHgwNDNiLAogICJhZmlpMTAwNzgiLAogIDB4MDQzYywKICAiYWZpaTEwMDc5IiwKICAweDA0M2QsCiAgImFmaWkxMDA4MCIsCiAgMHgwNDNlLAogICJhZmlpMTAwODEiLAogIDB4MDQzZiwKICAiYWZpaTEwMDgyIiwKICAweDA0NDAsCiAgImFmaWkxMDA4MyIsCiAgMHgwNDQxLAogICJhZmlpMTAwODQiLAogIDB4MDQ0MiwKICAiYWZpaTEwMDg1IiwKICAweDA0NDMsCiAgImFmaWkxMDA4NiIsCiAgMHgwNDQ0LAogICJhZmlpMTAwODciLAogIDB4MDQ0NSwKICAiYWZpaTEwMDg4IiwKICAweDA0NDYsCiAgImFmaWkxMDA4OSIsCiAgMHgwNDQ3LAogICJhZmlpMTAwOTAiLAogIDB4MDQ0OCwKICAiYWZpaTEwMDkxIiwKICAweDA0NDksCiAgImFmaWkxMDA5MiIsCiAgMHgwNDRhLAogICJhZmlpMTAwOTMiLAogIDB4MDQ0YiwKICAiYWZpaTEwMDk0IiwKICAweDA0NGMsCiAgImFmaWkxMDA5NSIsCiAgMHgwNDRkLAogICJhZmlpMTAwOTYiLAogIDB4MDQ0ZSwKICAiYWZpaTEwMDk3IiwKICAweDA0NGYsCiAgImFmaWkxMDA5OCIsCiAgMHgwNDkxLAogICJhZmlpMTAwOTkiLAogIDB4MDQ1MiwKICAiYWZpaTEwMTAwIiwKICAweDA0NTMsCiAgImFmaWkxMDEwMSIsCiAgMHgwNDU0LAogICJhZmlpMTAxMDIiLAogIDB4MDQ1NSwKICAiYWZpaTEwMTAzIiwKICAweDA0NTYsCiAgImFmaWkxMDEwNCIsCiAgMHgwNDU3LAogICJhZmlpMTAxMDUiLAogIDB4MDQ1OCwKICAiYWZpaTEwMTA2IiwKICAweDA0NTksCiAgImFmaWkxMDEwNyIsCiAgMHgwNDVhLAogICJhZmlpMTAxMDgiLAogIDB4MDQ1YiwKICAiYWZpaTEwMTA5IiwKICAweDA0NWMsCiAgImFmaWkxMDExMCIsCiAgMHgwNDVlLAogICJhZmlpMTAxNDUiLAogIDB4MDQwZiwKICAiYWZpaTEwMTQ2IiwKICAweDA0NjIsCiAgImFmaWkxMDE0NyIsCiAgMHgwNDcyLAogICJhZmlpMTAxNDgiLAogIDB4MDQ3NCwKICAiYWZpaTEwMTkyIiwKICAweGY2YzYsCiAgImFmaWkxMDE5MyIsCiAgMHgwNDVmLAogICJhZmlpMTAxOTQiLAogIDB4MDQ2MywKICAiYWZpaTEwMTk1IiwKICAweDA0NzMsCiAgImFmaWkxMDE5NiIsCiAgMHgwNDc1LAogICJhZmlpMTA4MzEiLAogIDB4ZjZjNywKICAiYWZpaTEwODMyIiwKICAweGY2YzgsCiAgImFmaWkxMDg0NiIsCiAgMHgwNGQ5LAogICJhZmlpMjk5IiwKICAweDIwMGUsCiAgImFmaWkzMDAiLAogIDB4MjAwZiwKICAiYWZpaTMwMSIsCiAgMHgyMDBkLAogICJhZmlpNTczODEiLAogIDB4MDY2YSwKICAiYWZpaTU3Mzg4IiwKICAweDA2MGMsCiAgImFmaWk1NzM5MiIsCiAgMHgwNjYwLAogICJhZmlpNTczOTMiLAogIDB4MDY2MSwKICAiYWZpaTU3Mzk0IiwKICAweDA2NjIsCiAgImFmaWk1NzM5NSIsCiAgMHgwNjYzLAogICJhZmlpNTczOTYiLAogIDB4MDY2NCwKICAiYWZpaTU3Mzk3IiwKICAweDA2NjUsCiAgImFmaWk1NzM5OCIsCiAgMHgwNjY2LAogICJhZmlpNTczOTkiLAogIDB4MDY2NywKICAiYWZpaTU3NDAwIiwKICAweDA2NjgsCiAgImFmaWk1NzQwMSIsCiAgMHgwNjY5LAogICJhZmlpNTc0MDMiLAogIDB4MDYxYiwKICAiYWZpaTU3NDA3IiwKICAweDA2MWYsCiAgImFmaWk1NzQwOSIsCiAgMHgwNjIxLAogICJhZmlpNTc0MTAiLAogIDB4MDYyMiwKICAiYWZpaTU3NDExIiwKICAweDA2MjMsCiAgImFmaWk1NzQxMiIsCiAgMHgwNjI0LAogICJhZmlpNTc0MTMiLAogIDB4MDYyNSwKICAiYWZpaTU3NDE0IiwKICAweDA2MjYsCiAgImFmaWk1NzQxNSIsCiAgMHgwNjI3LAogICJhZmlpNTc0MTYiLAogIDB4MDYyOCwKICAiYWZpaTU3NDE3IiwKICAweDA2MjksCiAgImFmaWk1NzQxOCIsCiAgMHgwNjJhLAogICJhZmlpNTc0MTkiLAogIDB4MDYyYiwKICAiYWZpaTU3NDIwIiwKICAweDA2MmMsCiAgImFmaWk1NzQyMSIsCiAgMHgwNjJkLAogICJhZmlpNTc0MjIiLAogIDB4MDYyZSwKICAiYWZpaTU3NDIzIiwKICAweDA2MmYsCiAgImFmaWk1NzQyNCIsCiAgMHgwNjMwLAogICJhZmlpNTc0MjUiLAogIDB4MDYzMSwKICAiYWZpaTU3NDI2IiwKICAweDA2MzIsCiAgImFmaWk1NzQyNyIsCiAgMHgwNjMzLAogICJhZmlpNTc0MjgiLAogIDB4MDYzNCwKICAiYWZpaTU3NDI5IiwKICAweDA2MzUsCiAgImFmaWk1NzQzMCIsCiAgMHgwNjM2LAogICJhZmlpNTc0MzEiLAogIDB4MDYzNywKICAiYWZpaTU3NDMyIiwKICAweDA2MzgsCiAgImFmaWk1NzQzMyIsCiAgMHgwNjM5LAogICJhZmlpNTc0MzQiLAogIDB4MDYzYSwKICAiYWZpaTU3NDQwIiwKICAweDA2NDAsCiAgImFmaWk1NzQ0MSIsCiAgMHgwNjQxLAogICJhZmlpNTc0NDIiLAogIDB4MDY0MiwKICAiYWZpaTU3NDQzIiwKICAweDA2NDMsCiAgImFmaWk1NzQ0NCIsCiAgMHgwNjQ0LAogICJhZmlpNTc0NDUiLAogIDB4MDY0NSwKICAiYWZpaTU3NDQ2IiwKICAweDA2NDYsCiAgImFmaWk1NzQ0OCIsCiAgMHgwNjQ4LAogICJhZmlpNTc0NDkiLAogIDB4MDY0OSwKICAiYWZpaTU3NDUwIiwKICAweDA2NGEsCiAgImFmaWk1NzQ1MSIsCiAgMHgwNjRiLAogICJhZmlpNTc0NTIiLAogIDB4MDY0YywKICAiYWZpaTU3NDUzIiwKICAweDA2NGQsCiAgImFmaWk1NzQ1NCIsCiAgMHgwNjRlLAogICJhZmlpNTc0NTUiLAogIDB4MDY0ZiwKICAiYWZpaTU3NDU2IiwKICAweDA2NTAsCiAgImFmaWk1NzQ1NyIsCiAgMHgwNjUxLAogICJhZmlpNTc0NTgiLAogIDB4MDY1MiwKICAiYWZpaTU3NDcwIiwKICAweDA2NDcsCiAgImFmaWk1NzUwNSIsCiAgMHgwNmE0LAogICJhZmlpNTc1MDYiLAogIDB4MDY3ZSwKICAiYWZpaTU3NTA3IiwKICAweDA2ODYsCiAgImFmaWk1NzUwOCIsCiAgMHgwNjk4LAogICJhZmlpNTc1MDkiLAogIDB4MDZhZiwKICAiYWZpaTU3NTExIiwKICAweDA2NzksCiAgImFmaWk1NzUxMiIsCiAgMHgwNjg4LAogICJhZmlpNTc1MTMiLAogIDB4MDY5MSwKICAiYWZpaTU3NTE0IiwKICAweDA2YmEsCiAgImFmaWk1NzUxOSIsCiAgMHgwNmQyLAogICJhZmlpNTc1MzQiLAogIDB4MDZkNSwKICAiYWZpaTU3NjM2IiwKICAweDIwYWEsCiAgImFmaWk1NzY0NSIsCiAgMHgwNWJlLAogICJhZmlpNTc2NTgiLAogIDB4MDVjMywKICAiYWZpaTU3NjY0IiwKICAweDA1ZDAsCiAgImFmaWk1NzY2NSIsCiAgMHgwNWQxLAogICJhZmlpNTc2NjYiLAogIDB4MDVkMiwKICAiYWZpaTU3NjY3IiwKICAweDA1ZDMsCiAgImFmaWk1NzY2OCIsCiAgMHgwNWQ0LAogICJhZmlpNTc2NjkiLAogIDB4MDVkNSwKICAiYWZpaTU3NjcwIiwKICAweDA1ZDYsCiAgImFmaWk1NzY3MSIsCiAgMHgwNWQ3LAogICJhZmlpNTc2NzIiLAogIDB4MDVkOCwKICAiYWZpaTU3NjczIiwKICAweDA1ZDksCiAgImFmaWk1NzY3NCIsCiAgMHgwNWRhLAogICJhZmlpNTc2NzUiLAogIDB4MDVkYiwKICAiYWZpaTU3Njc2IiwKICAweDA1ZGMsCiAgImFmaWk1NzY3NyIsCiAgMHgwNWRkLAogICJhZmlpNTc2NzgiLAogIDB4MDVkZSwKICAiYWZpaTU3Njc5IiwKICAweDA1ZGYsCiAgImFmaWk1NzY4MCIsCiAgMHgwNWUwLAogICJhZmlpNTc2ODEiLAogIDB4MDVlMSwKICAiYWZpaTU3NjgyIiwKICAweDA1ZTIsCiAgImFmaWk1NzY4MyIsCiAgMHgwNWUzLAogICJhZmlpNTc2ODQiLAogIDB4MDVlNCwKICAiYWZpaTU3Njg1IiwKICAweDA1ZTUsCiAgImFmaWk1NzY4NiIsCiAgMHgwNWU2LAogICJhZmlpNTc2ODciLAogIDB4MDVlNywKICAiYWZpaTU3Njg4IiwKICAweDA1ZTgsCiAgImFmaWk1NzY4OSIsCiAgMHgwNWU5LAogICJhZmlpNTc2OTAiLAogIDB4MDVlYSwKICAiYWZpaTU3Njk0IiwKICAweGZiMmEsCiAgImFmaWk1NzY5NSIsCiAgMHhmYjJiLAogICJhZmlpNTc3MDAiLAogIDB4ZmI0YiwKICAiYWZpaTU3NzA1IiwKICAweGZiMWYsCiAgImFmaWk1NzcxNiIsCiAgMHgwNWYwLAogICJhZmlpNTc3MTciLAogIDB4MDVmMSwKICAiYWZpaTU3NzE4IiwKICAweDA1ZjIsCiAgImFmaWk1NzcyMyIsCiAgMHhmYjM1LAogICJhZmlpNTc3OTMiLAogIDB4MDViNCwKICAiYWZpaTU3Nzk0IiwKICAweDA1YjUsCiAgImFmaWk1Nzc5NSIsCiAgMHgwNWI2LAogICJhZmlpNTc3OTYiLAogIDB4MDViYiwKICAiYWZpaTU3Nzk3IiwKICAweDA1YjgsCiAgImFmaWk1Nzc5OCIsCiAgMHgwNWI3LAogICJhZmlpNTc3OTkiLAogIDB4MDViMCwKICAiYWZpaTU3ODAwIiwKICAweDA1YjIsCiAgImFmaWk1NzgwMSIsCiAgMHgwNWIxLAogICJhZmlpNTc4MDIiLAogIDB4MDViMywKICAiYWZpaTU3ODAzIiwKICAweDA1YzIsCiAgImFmaWk1NzgwNCIsCiAgMHgwNWMxLAogICJhZmlpNTc4MDYiLAogIDB4MDViOSwKICAiYWZpaTU3ODA3IiwKICAweDA1YmMsCiAgImFmaWk1NzgzOSIsCiAgMHgwNWJkLAogICJhZmlpNTc4NDEiLAogIDB4MDViZiwKICAiYWZpaTU3ODQyIiwKICAweDA1YzAsCiAgImFmaWk1NzkyOSIsCiAgMHgwMmJjLAogICJhZmlpNjEyNDgiLAogIDB4MjEwNSwKICAiYWZpaTYxMjg5IiwKICAweDIxMTMsCiAgImFmaWk2MTM1MiIsCiAgMHgyMTE2LAogICJhZmlpNjE1NzMiLAogIDB4MjAyYywKICAiYWZpaTYxNTc0IiwKICAweDIwMmQsCiAgImFmaWk2MTU3NSIsCiAgMHgyMDJlLAogICJhZmlpNjE2NjQiLAogIDB4MjAwYywKICAiYWZpaTYzMTY3IiwKICAweDA2NmQsCiAgImFmaWk2NDkzNyIsCiAgMHgwMmJkLAogICJhZ3JhdmUiLAogIDB4MDBlMCwKICAiYWd1amFyYXRpIiwKICAweDBhODUsCiAgImFndXJtdWtoaSIsCiAgMHgwYTA1LAogICJhaGlyYWdhbmEiLAogIDB4MzA0MiwKICAiYWhvb2thYm92ZSIsCiAgMHgxZWEzLAogICJhaWJlbmdhbGkiLAogIDB4MDk5MCwKICAiYWlib3BvbW9mbyIsCiAgMHgzMTFlLAogICJhaWRldmEiLAogIDB4MDkxMCwKICAiYWllY3lyaWxsaWMiLAogIDB4MDRkNSwKICAiYWlndWphcmF0aSIsCiAgMHgwYTkwLAogICJhaWd1cm11a2hpIiwKICAweDBhMTAsCiAgImFpbWF0cmFndXJtdWtoaSIsCiAgMHgwYTQ4LAogICJhaW5hcmFiaWMiLAogIDB4MDYzOSwKICAiYWluZmluYWxhcmFiaWMiLAogIDB4ZmVjYSwKICAiYWluaW5pdGlhbGFyYWJpYyIsCiAgMHhmZWNiLAogICJhaW5tZWRpYWxhcmFiaWMiLAogIDB4ZmVjYywKICAiYWludmVydGVkYnJldmUiLAogIDB4MDIwMywKICAiYWl2b3dlbHNpZ25iZW5nYWxpIiwKICAweDA5YzgsCiAgImFpdm93ZWxzaWduZGV2YSIsCiAgMHgwOTQ4LAogICJhaXZvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhYzgsCiAgImFrYXRha2FuYSIsCiAgMHgzMGEyLAogICJha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3MSwKICAiYWtvcmVhbiIsCiAgMHgzMTRmLAogICJhbGVmIiwKICAweDA1ZDAsCiAgImFsZWZhcmFiaWMiLAogIDB4MDYyNywKICAiYWxlZmRhZ2VzaGhlYnJldyIsCiAgMHhmYjMwLAogICJhbGVmZmluYWxhcmFiaWMiLAogIDB4ZmU4ZSwKICAiYWxlZmhhbXphYWJvdmVhcmFiaWMiLAogIDB4MDYyMywKICAiYWxlZmhhbXphYWJvdmVmaW5hbGFyYWJpYyIsCiAgMHhmZTg0LAogICJhbGVmaGFtemFiZWxvd2FyYWJpYyIsCiAgMHgwNjI1LAogICJhbGVmaGFtemFiZWxvd2ZpbmFsYXJhYmljIiwKICAweGZlODgsCiAgImFsZWZoZWJyZXciLAogIDB4MDVkMCwKICAiYWxlZmxhbWVkaGVicmV3IiwKICAweGZiNGYsCiAgImFsZWZtYWRkYWFib3ZlYXJhYmljIiwKICAweDA2MjIsCiAgImFsZWZtYWRkYWFib3ZlZmluYWxhcmFiaWMiLAogIDB4ZmU4MiwKICAiYWxlZm1ha3N1cmFhcmFiaWMiLAogIDB4MDY0OSwKICAiYWxlZm1ha3N1cmFmaW5hbGFyYWJpYyIsCiAgMHhmZWYwLAogICJhbGVmbWFrc3VyYWluaXRpYWxhcmFiaWMiLAogIDB4ZmVmMywKICAiYWxlZm1ha3N1cmFtZWRpYWxhcmFiaWMiLAogIDB4ZmVmNCwKICAiYWxlZnBhdGFoaGVicmV3IiwKICAweGZiMmUsCiAgImFsZWZxYW1hdHNoZWJyZXciLAogIDB4ZmIyZiwKICAiYWxlcGgiLAogIDB4MjEzNSwKICAiYWxsZXF1YWwiLAogIDB4MjI0YywKICAiYWxwaGEiLAogIDB4MDNiMSwKICAiYWxwaGF0b25vcyIsCiAgMHgwM2FjLAogICJhbWFjcm9uIiwKICAweDAxMDEsCiAgImFtb25vc3BhY2UiLAogIDB4ZmY0MSwKICAiYW1wZXJzYW5kIiwKICAweDAwMjYsCiAgImFtcGVyc2FuZG1vbm9zcGFjZSIsCiAgMHhmZjA2LAogICJhbXBlcnNhbmRzbWFsbCIsCiAgMHhmNzI2LAogICJhbXNxdWFyZSIsCiAgMHgzM2MyLAogICJhbmJvcG9tb2ZvIiwKICAweDMxMjIsCiAgImFuZ2JvcG9tb2ZvIiwKICAweDMxMjQsCiAgImFuZ2JyYWNrZXRsZWZ0IiwKICAweDMwMDgsCiAgImFuZ2JyYWNrZXRyaWdodCIsCiAgMHgzMDA5LAogICJhbmdraGFua2h1dGhhaSIsCiAgMHgwZTVhLAogICJhbmdsZSIsCiAgMHgyMjIwLAogICJhbmdsZWJyYWNrZXRsZWZ0IiwKICAweDMwMDgsCiAgImFuZ2xlYnJhY2tldGxlZnR2ZXJ0aWNhbCIsCiAgMHhmZTNmLAogICJhbmdsZWJyYWNrZXRyaWdodCIsCiAgMHgzMDA5LAogICJhbmdsZWJyYWNrZXRyaWdodHZlcnRpY2FsIiwKICAweGZlNDAsCiAgImFuZ2xlbGVmdCIsCiAgMHgyMzI5LAogICJhbmdsZXJpZ2h0IiwKICAweDIzMmEsCiAgImFuZ3N0cm9tIiwKICAweDIxMmIsCiAgImFub3RlbGVpYSIsCiAgMHgwMzg3LAogICJhbnVkYXR0YWRldmEiLAogIDB4MDk1MiwKICAiYW51c3ZhcmFiZW5nYWxpIiwKICAweDA5ODIsCiAgImFudXN2YXJhZGV2YSIsCiAgMHgwOTAyLAogICJhbnVzdmFyYWd1amFyYXRpIiwKICAweDBhODIsCiAgImFvZ29uZWsiLAogIDB4MDEwNSwKICAiYXBhYXRvc3F1YXJlIiwKICAweDMzMDAsCiAgImFwYXJlbiIsCiAgMHgyNDljLAogICJhcG9zdHJvcGhlYXJtZW5pYW4iLAogIDB4MDU1YSwKICAiYXBvc3Ryb3BoZW1vZCIsCiAgMHgwMmJjLAogICJhcHBsZSIsCiAgMHhmOGZmLAogICJhcHByb2FjaGVzIiwKICAweDIyNTAsCiAgImFwcHJveGVxdWFsIiwKICAweDIyNDgsCiAgImFwcHJveGVxdWFsb3JpbWFnZSIsCiAgMHgyMjUyLAogICJhcHByb3hpbWF0ZWx5ZXF1YWwiLAogIDB4MjI0NSwKICAiYXJhZWFla29yZWFuIiwKICAweDMxOGUsCiAgImFyYWVha29yZWFuIiwKICAweDMxOGQsCiAgImFyYyIsCiAgMHgyMzEyLAogICJhcmlnaHRoYWxmcmluZyIsCiAgMHgxZTlhLAogICJhcmluZyIsCiAgMHgwMGU1LAogICJhcmluZ2FjdXRlIiwKICAweDAxZmIsCiAgImFyaW5nYmVsb3ciLAogIDB4MWUwMSwKICAiYXJyb3dib3RoIiwKICAweDIxOTQsCiAgImFycm93ZGFzaGRvd24iLAogIDB4MjFlMywKICAiYXJyb3dkYXNobGVmdCIsCiAgMHgyMWUwLAogICJhcnJvd2Rhc2hyaWdodCIsCiAgMHgyMWUyLAogICJhcnJvd2Rhc2h1cCIsCiAgMHgyMWUxLAogICJhcnJvd2RibGJvdGgiLAogIDB4MjFkNCwKICAiYXJyb3dkYmxkb3duIiwKICAweDIxZDMsCiAgImFycm93ZGJsbGVmdCIsCiAgMHgyMWQwLAogICJhcnJvd2RibHJpZ2h0IiwKICAweDIxZDIsCiAgImFycm93ZGJsdXAiLAogIDB4MjFkMSwKICAiYXJyb3dkb3duIiwKICAweDIxOTMsCiAgImFycm93ZG93bmxlZnQiLAogIDB4MjE5OSwKICAiYXJyb3dkb3ducmlnaHQiLAogIDB4MjE5OCwKICAiYXJyb3dkb3dud2hpdGUiLAogIDB4MjFlOSwKICAiYXJyb3doZWFkZG93bm1vZCIsCiAgMHgwMmM1LAogICJhcnJvd2hlYWRsZWZ0bW9kIiwKICAweDAyYzIsCiAgImFycm93aGVhZHJpZ2h0bW9kIiwKICAweDAyYzMsCiAgImFycm93aGVhZHVwbW9kIiwKICAweDAyYzQsCiAgImFycm93aG9yaXpleCIsCiAgMHhmOGU3LAogICJhcnJvd2xlZnQiLAogIDB4MjE5MCwKICAiYXJyb3dsZWZ0ZGJsIiwKICAweDIxZDAsCiAgImFycm93bGVmdGRibHN0cm9rZSIsCiAgMHgyMWNkLAogICJhcnJvd2xlZnRvdmVycmlnaHQiLAogIDB4MjFjNiwKICAiYXJyb3dsZWZ0d2hpdGUiLAogIDB4MjFlNiwKICAiYXJyb3dyaWdodCIsCiAgMHgyMTkyLAogICJhcnJvd3JpZ2h0ZGJsc3Ryb2tlIiwKICAweDIxY2YsCiAgImFycm93cmlnaHRoZWF2eSIsCiAgMHgyNzllLAogICJhcnJvd3JpZ2h0b3ZlcmxlZnQiLAogIDB4MjFjNCwKICAiYXJyb3dyaWdodHdoaXRlIiwKICAweDIxZTgsCiAgImFycm93dGFibGVmdCIsCiAgMHgyMWU0LAogICJhcnJvd3RhYnJpZ2h0IiwKICAweDIxZTUsCiAgImFycm93dXAiLAogIDB4MjE5MSwKICAiYXJyb3d1cGRuIiwKICAweDIxOTUsCiAgImFycm93dXBkbmJzZSIsCiAgMHgyMWE4LAogICJhcnJvd3VwZG93bmJhc2UiLAogIDB4MjFhOCwKICAiYXJyb3d1cGxlZnQiLAogIDB4MjE5NiwKICAiYXJyb3d1cGxlZnRvZmRvd24iLAogIDB4MjFjNSwKICAiYXJyb3d1cHJpZ2h0IiwKICAweDIxOTcsCiAgImFycm93dXB3aGl0ZSIsCiAgMHgyMWU3LAogICJhcnJvd3ZlcnRleCIsCiAgMHhmOGU2LAogICJhc2NpaWNpcmN1bSIsCiAgMHgwMDVlLAogICJhc2NpaWNpcmN1bW1vbm9zcGFjZSIsCiAgMHhmZjNlLAogICJhc2NpaXRpbGRlIiwKICAweDAwN2UsCiAgImFzY2lpdGlsZGVtb25vc3BhY2UiLAogIDB4ZmY1ZSwKICAiYXNjcmlwdCIsCiAgMHgwMjUxLAogICJhc2NyaXB0dHVybmVkIiwKICAweDAyNTIsCiAgImFzbWFsbGhpcmFnYW5hIiwKICAweDMwNDEsCiAgImFzbWFsbGthdGFrYW5hIiwKICAweDMwYTEsCiAgImFzbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNjcsCiAgImFzdGVyaXNrIiwKICAweDAwMmEsCiAgImFzdGVyaXNrYWx0b25lYXJhYmljIiwKICAweDA2NmQsCiAgImFzdGVyaXNrYXJhYmljIiwKICAweDA2NmQsCiAgImFzdGVyaXNrbWF0aCIsCiAgMHgyMjE3LAogICJhc3Rlcmlza21vbm9zcGFjZSIsCiAgMHhmZjBhLAogICJhc3Rlcmlza3NtYWxsIiwKICAweGZlNjEsCiAgImFzdGVyaXNtIiwKICAweDIwNDIsCiAgImFzdXBlcmlvciIsCiAgMHhmNmU5LAogICJhc3ltcHRvdGljYWxseWVxdWFsIiwKICAweDIyNDMsCiAgImF0IiwKICAweDAwNDAsCiAgImF0aWxkZSIsCiAgMHgwMGUzLAogICJhdG1vbm9zcGFjZSIsCiAgMHhmZjIwLAogICJhdHNtYWxsIiwKICAweGZlNmIsCiAgImF0dXJuZWQiLAogIDB4MDI1MCwKICAiYXViZW5nYWxpIiwKICAweDA5OTQsCiAgImF1Ym9wb21vZm8iLAogIDB4MzEyMCwKICAiYXVkZXZhIiwKICAweDA5MTQsCiAgImF1Z3VqYXJhdGkiLAogIDB4MGE5NCwKICAiYXVndXJtdWtoaSIsCiAgMHgwYTE0LAogICJhdWxlbmd0aG1hcmtiZW5nYWxpIiwKICAweDA5ZDcsCiAgImF1bWF0cmFndXJtdWtoaSIsCiAgMHgwYTRjLAogICJhdXZvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljYywKICAiYXV2b3dlbHNpZ25kZXZhIiwKICAweDA5NGMsCiAgImF1dm93ZWxzaWduZ3VqYXJhdGkiLAogIDB4MGFjYywKICAiYXZhZ3JhaGFkZXZhIiwKICAweDA5M2QsCiAgImF5YmFybWVuaWFuIiwKICAweDA1NjEsCiAgImF5aW4iLAogIDB4MDVlMiwKICAiYXlpbmFsdG9uZWhlYnJldyIsCiAgMHhmYjIwLAogICJheWluaGVicmV3IiwKICAweDA1ZTIsCiAgImIiLAogIDB4MDA2MiwKICAiYmFiZW5nYWxpIiwKICAweDA5YWMsCiAgImJhY2tzbGFzaCIsCiAgMHgwMDVjLAogICJiYWNrc2xhc2htb25vc3BhY2UiLAogIDB4ZmYzYywKICAiYmFkZXZhIiwKICAweDA5MmMsCiAgImJhZ3VqYXJhdGkiLAogIDB4MGFhYywKICAiYmFndXJtdWtoaSIsCiAgMHgwYTJjLAogICJiYWhpcmFnYW5hIiwKICAweDMwNzAsCiAgImJhaHR0aGFpIiwKICAweDBlM2YsCiAgImJha2F0YWthbmEiLAogIDB4MzBkMCwKICAiYmFyIiwKICAweDAwN2MsCiAgImJhcm1vbm9zcGFjZSIsCiAgMHhmZjVjLAogICJiYm9wb21vZm8iLAogIDB4MzEwNSwKICAiYmNpcmNsZSIsCiAgMHgyNGQxLAogICJiZG90YWNjZW50IiwKICAweDFlMDMsCiAgImJkb3RiZWxvdyIsCiAgMHgxZTA1LAogICJiZWFtZWRzaXh0ZWVudGhub3RlcyIsCiAgMHgyNjZjLAogICJiZWNhdXNlIiwKICAweDIyMzUsCiAgImJlY3lyaWxsaWMiLAogIDB4MDQzMSwKICAiYmVoYXJhYmljIiwKICAweDA2MjgsCiAgImJlaGZpbmFsYXJhYmljIiwKICAweGZlOTAsCiAgImJlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmU5MSwKICAiYmVoaXJhZ2FuYSIsCiAgMHgzMDc5LAogICJiZWhtZWRpYWxhcmFiaWMiLAogIDB4ZmU5MiwKICAiYmVobWVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmM5ZiwKICAiYmVobWVlbWlzb2xhdGVkYXJhYmljIiwKICAweGZjMDgsCiAgImJlaG5vb25maW5hbGFyYWJpYyIsCiAgMHhmYzZkLAogICJiZWthdGFrYW5hIiwKICAweDMwZDksCiAgImJlbmFybWVuaWFuIiwKICAweDA1NjIsCiAgImJldCIsCiAgMHgwNWQxLAogICJiZXRhIiwKICAweDAzYjIsCiAgImJldGFzeW1ib2xncmVlayIsCiAgMHgwM2QwLAogICJiZXRkYWdlc2giLAogIDB4ZmIzMSwKICAiYmV0ZGFnZXNoaGVicmV3IiwKICAweGZiMzEsCiAgImJldGhlYnJldyIsCiAgMHgwNWQxLAogICJiZXRyYWZlaGVicmV3IiwKICAweGZiNGMsCiAgImJoYWJlbmdhbGkiLAogIDB4MDlhZCwKICAiYmhhZGV2YSIsCiAgMHgwOTJkLAogICJiaGFndWphcmF0aSIsCiAgMHgwYWFkLAogICJiaGFndXJtdWtoaSIsCiAgMHgwYTJkLAogICJiaG9vayIsCiAgMHgwMjUzLAogICJiaWhpcmFnYW5hIiwKICAweDMwNzMsCiAgImJpa2F0YWthbmEiLAogIDB4MzBkMywKICAiYmlsYWJpYWxjbGljayIsCiAgMHgwMjk4LAogICJiaW5kaWd1cm11a2hpIiwKICAweDBhMDIsCiAgImJpcnVzcXVhcmUiLAogIDB4MzMzMSwKICAiYmxhY2tjaXJjbGUiLAogIDB4MjVjZiwKICAiYmxhY2tkaWFtb25kIiwKICAweDI1YzYsCiAgImJsYWNrZG93bnBvaW50aW5ndHJpYW5nbGUiLAogIDB4MjViYywKICAiYmxhY2tsZWZ0cG9pbnRpbmdwb2ludGVyIiwKICAweDI1YzQsCiAgImJsYWNrbGVmdHBvaW50aW5ndHJpYW5nbGUiLAogIDB4MjVjMCwKICAiYmxhY2tsZW50aWN1bGFyYnJhY2tldGxlZnQiLAogIDB4MzAxMCwKICAiYmxhY2tsZW50aWN1bGFyYnJhY2tldGxlZnR2ZXJ0aWNhbCIsCiAgMHhmZTNiLAogICJibGFja2xlbnRpY3VsYXJicmFja2V0cmlnaHQiLAogIDB4MzAxMSwKICAiYmxhY2tsZW50aWN1bGFyYnJhY2tldHJpZ2h0dmVydGljYWwiLAogIDB4ZmUzYywKICAiYmxhY2tsb3dlcmxlZnR0cmlhbmdsZSIsCiAgMHgyNWUzLAogICJibGFja2xvd2VycmlnaHR0cmlhbmdsZSIsCiAgMHgyNWUyLAogICJibGFja3JlY3RhbmdsZSIsCiAgMHgyNWFjLAogICJibGFja3JpZ2h0cG9pbnRpbmdwb2ludGVyIiwKICAweDI1YmEsCiAgImJsYWNrcmlnaHRwb2ludGluZ3RyaWFuZ2xlIiwKICAweDI1YjYsCiAgImJsYWNrc21hbGxzcXVhcmUiLAogIDB4MjVhYSwKICAiYmxhY2tzbWlsaW5nZmFjZSIsCiAgMHgyNjNiLAogICJibGFja3NxdWFyZSIsCiAgMHgyNWEwLAogICJibGFja3N0YXIiLAogIDB4MjYwNSwKICAiYmxhY2t1cHBlcmxlZnR0cmlhbmdsZSIsCiAgMHgyNWU0LAogICJibGFja3VwcGVycmlnaHR0cmlhbmdsZSIsCiAgMHgyNWU1LAogICJibGFja3VwcG9pbnRpbmdzbWFsbHRyaWFuZ2xlIiwKICAweDI1YjQsCiAgImJsYWNrdXBwb2ludGluZ3RyaWFuZ2xlIiwKICAweDI1YjIsCiAgImJsYW5rIiwKICAweDI0MjMsCiAgImJsaW5lYmVsb3ciLAogIDB4MWUwNywKICAiYmxvY2siLAogIDB4MjU4OCwKICAiYm1vbm9zcGFjZSIsCiAgMHhmZjQyLAogICJib2JhaW1haXRoYWkiLAogIDB4MGUxYSwKICAiYm9oaXJhZ2FuYSIsCiAgMHgzMDdjLAogICJib2thdGFrYW5hIiwKICAweDMwZGMsCiAgImJwYXJlbiIsCiAgMHgyNDlkLAogICJicXNxdWFyZSIsCiAgMHgzM2MzLAogICJicmFjZWV4IiwKICAweGY4ZjQsCiAgImJyYWNlbGVmdCIsCiAgMHgwMDdiLAogICJicmFjZWxlZnRidCIsCiAgMHhmOGYzLAogICJicmFjZWxlZnRtaWQiLAogIDB4ZjhmMiwKICAiYnJhY2VsZWZ0bW9ub3NwYWNlIiwKICAweGZmNWIsCiAgImJyYWNlbGVmdHNtYWxsIiwKICAweGZlNWIsCiAgImJyYWNlbGVmdHRwIiwKICAweGY4ZjEsCiAgImJyYWNlbGVmdHZlcnRpY2FsIiwKICAweGZlMzcsCiAgImJyYWNlcmlnaHQiLAogIDB4MDA3ZCwKICAiYnJhY2VyaWdodGJ0IiwKICAweGY4ZmUsCiAgImJyYWNlcmlnaHRtaWQiLAogIDB4ZjhmZCwKICAiYnJhY2VyaWdodG1vbm9zcGFjZSIsCiAgMHhmZjVkLAogICJicmFjZXJpZ2h0c21hbGwiLAogIDB4ZmU1YywKICAiYnJhY2VyaWdodHRwIiwKICAweGY4ZmMsCiAgImJyYWNlcmlnaHR2ZXJ0aWNhbCIsCiAgMHhmZTM4LAogICJicmFja2V0bGVmdCIsCiAgMHgwMDViLAogICJicmFja2V0bGVmdGJ0IiwKICAweGY4ZjAsCiAgImJyYWNrZXRsZWZ0ZXgiLAogIDB4ZjhlZiwKICAiYnJhY2tldGxlZnRtb25vc3BhY2UiLAogIDB4ZmYzYiwKICAiYnJhY2tldGxlZnR0cCIsCiAgMHhmOGVlLAogICJicmFja2V0cmlnaHQiLAogIDB4MDA1ZCwKICAiYnJhY2tldHJpZ2h0YnQiLAogIDB4ZjhmYiwKICAiYnJhY2tldHJpZ2h0ZXgiLAogIDB4ZjhmYSwKICAiYnJhY2tldHJpZ2h0bW9ub3NwYWNlIiwKICAweGZmM2QsCiAgImJyYWNrZXRyaWdodHRwIiwKICAweGY4ZjksCiAgImJyZXZlIiwKICAweDAyZDgsCiAgImJyZXZlYmVsb3djbWIiLAogIDB4MDMyZSwKICAiYnJldmVjbWIiLAogIDB4MDMwNiwKICAiYnJldmVpbnZlcnRlZGJlbG93Y21iIiwKICAweDAzMmYsCiAgImJyZXZlaW52ZXJ0ZWRjbWIiLAogIDB4MDMxMSwKICAiYnJldmVpbnZlcnRlZGRvdWJsZWNtYiIsCiAgMHgwMzYxLAogICJicmlkZ2ViZWxvd2NtYiIsCiAgMHgwMzJhLAogICJicmlkZ2VpbnZlcnRlZGJlbG93Y21iIiwKICAweDAzM2EsCiAgImJyb2tlbmJhciIsCiAgMHgwMGE2LAogICJic3Ryb2tlIiwKICAweDAxODAsCiAgImJzdXBlcmlvciIsCiAgMHhmNmVhLAogICJidG9wYmFyIiwKICAweDAxODMsCiAgImJ1aGlyYWdhbmEiLAogIDB4MzA3NiwKICAiYnVrYXRha2FuYSIsCiAgMHgzMGQ2LAogICJidWxsZXQiLAogIDB4MjAyMiwKICAiYnVsbGV0aW52ZXJzZSIsCiAgMHgyNWQ4LAogICJidWxsZXRvcGVyYXRvciIsCiAgMHgyMjE5LAogICJidWxsc2V5ZSIsCiAgMHgyNWNlLAogICJjIiwKICAweDAwNjMsCiAgImNhYXJtZW5pYW4iLAogIDB4MDU2ZSwKICAiY2FiZW5nYWxpIiwKICAweDA5OWEsCiAgImNhY3V0ZSIsCiAgMHgwMTA3LAogICJjYWRldmEiLAogIDB4MDkxYSwKICAiY2FndWphcmF0aSIsCiAgMHgwYTlhLAogICJjYWd1cm11a2hpIiwKICAweDBhMWEsCiAgImNhbHNxdWFyZSIsCiAgMHgzMzg4LAogICJjYW5kcmFiaW5kdWJlbmdhbGkiLAogIDB4MDk4MSwKICAiY2FuZHJhYmluZHVjbWIiLAogIDB4MDMxMCwKICAiY2FuZHJhYmluZHVkZXZhIiwKICAweDA5MDEsCiAgImNhbmRyYWJpbmR1Z3VqYXJhdGkiLAogIDB4MGE4MSwKICAiY2Fwc2xvY2siLAogIDB4MjFlYSwKICAiY2FyZW9mIiwKICAweDIxMDUsCiAgImNhcm9uIiwKICAweDAyYzcsCiAgImNhcm9uYmVsb3djbWIiLAogIDB4MDMyYywKICAiY2Fyb25jbWIiLAogIDB4MDMwYywKICAiY2FycmlhZ2VyZXR1cm4iLAogIDB4MjFiNSwKICAiY2JvcG9tb2ZvIiwKICAweDMxMTgsCiAgImNjYXJvbiIsCiAgMHgwMTBkLAogICJjY2VkaWxsYSIsCiAgMHgwMGU3LAogICJjY2VkaWxsYWFjdXRlIiwKICAweDFlMDksCiAgImNjaXJjbGUiLAogIDB4MjRkMiwKICAiY2NpcmN1bWZsZXgiLAogIDB4MDEwOSwKICAiY2N1cmwiLAogIDB4MDI1NSwKICAiY2RvdCIsCiAgMHgwMTBiLAogICJjZG90YWNjZW50IiwKICAweDAxMGIsCiAgImNkc3F1YXJlIiwKICAweDMzYzUsCiAgImNlZGlsbGEiLAogIDB4MDBiOCwKICAiY2VkaWxsYWNtYiIsCiAgMHgwMzI3LAogICJjZW50IiwKICAweDAwYTIsCiAgImNlbnRpZ3JhZGUiLAogIDB4MjEwMywKICAiY2VudGluZmVyaW9yIiwKICAweGY2ZGYsCiAgImNlbnRtb25vc3BhY2UiLAogIDB4ZmZlMCwKICAiY2VudG9sZHN0eWxlIiwKICAweGY3YTIsCiAgImNlbnRzdXBlcmlvciIsCiAgMHhmNmUwLAogICJjaGFhcm1lbmlhbiIsCiAgMHgwNTc5LAogICJjaGFiZW5nYWxpIiwKICAweDA5OWIsCiAgImNoYWRldmEiLAogIDB4MDkxYiwKICAiY2hhZ3VqYXJhdGkiLAogIDB4MGE5YiwKICAiY2hhZ3VybXVraGkiLAogIDB4MGExYiwKICAiY2hib3BvbW9mbyIsCiAgMHgzMTE0LAogICJjaGVhYmtoYXNpYW5jeXJpbGxpYyIsCiAgMHgwNGJkLAogICJjaGVja21hcmsiLAogIDB4MjcxMywKICAiY2hlY3lyaWxsaWMiLAogIDB4MDQ0NywKICAiY2hlZGVzY2VuZGVyYWJraGFzaWFuY3lyaWxsaWMiLAogIDB4MDRiZiwKICAiY2hlZGVzY2VuZGVyY3lyaWxsaWMiLAogIDB4MDRiNywKICAiY2hlZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGY1LAogICJjaGVoYXJtZW5pYW4iLAogIDB4MDU3MywKICAiY2hla2hha2Fzc2lhbmN5cmlsbGljIiwKICAweDA0Y2MsCiAgImNoZXZlcnRpY2Fsc3Ryb2tlY3lyaWxsaWMiLAogIDB4MDRiOSwKICAiY2hpIiwKICAweDAzYzcsCiAgImNoaWV1Y2hhY2lyY2xla29yZWFuIiwKICAweDMyNzcsCiAgImNoaWV1Y2hhcGFyZW5rb3JlYW4iLAogIDB4MzIxNywKICAiY2hpZXVjaGNpcmNsZWtvcmVhbiIsCiAgMHgzMjY5LAogICJjaGlldWNoa29yZWFuIiwKICAweDMxNGEsCiAgImNoaWV1Y2hwYXJlbmtvcmVhbiIsCiAgMHgzMjA5LAogICJjaG9jaGFuZ3RoYWkiLAogIDB4MGUwYSwKICAiY2hvY2hhbnRoYWkiLAogIDB4MGUwOCwKICAiY2hvY2hpbmd0aGFpIiwKICAweDBlMDksCiAgImNob2Nob2V0aGFpIiwKICAweDBlMGMsCiAgImNob29rIiwKICAweDAxODgsCiAgImNpZXVjYWNpcmNsZWtvcmVhbiIsCiAgMHgzMjc2LAogICJjaWV1Y2FwYXJlbmtvcmVhbiIsCiAgMHgzMjE2LAogICJjaWV1Y2NpcmNsZWtvcmVhbiIsCiAgMHgzMjY4LAogICJjaWV1Y2tvcmVhbiIsCiAgMHgzMTQ4LAogICJjaWV1Y3BhcmVua29yZWFuIiwKICAweDMyMDgsCiAgImNpZXVjdXBhcmVua29yZWFuIiwKICAweDMyMWMsCiAgImNpcmNsZSIsCiAgMHgyNWNiLAogICJjaXJjbGVjb3B5cnQiLAogIDB4MDBhOSwKICAiY2lyY2xlbXVsdGlwbHkiLAogIDB4MjI5NywKICAiY2lyY2xlb3QiLAogIDB4MjI5OSwKICAiY2lyY2xlcGx1cyIsCiAgMHgyMjk1LAogICJjaXJjbGVwb3N0YWxtYXJrIiwKICAweDMwMzYsCiAgImNpcmNsZXdpdGhsZWZ0aGFsZmJsYWNrIiwKICAweDI1ZDAsCiAgImNpcmNsZXdpdGhyaWdodGhhbGZibGFjayIsCiAgMHgyNWQxLAogICJjaXJjdW1mbGV4IiwKICAweDAyYzYsCiAgImNpcmN1bWZsZXhiZWxvd2NtYiIsCiAgMHgwMzJkLAogICJjaXJjdW1mbGV4Y21iIiwKICAweDAzMDIsCiAgImNsZWFyIiwKICAweDIzMjcsCiAgImNsaWNrYWx2ZW9sYXIiLAogIDB4MDFjMiwKICAiY2xpY2tkZW50YWwiLAogIDB4MDFjMCwKICAiY2xpY2tsYXRlcmFsIiwKICAweDAxYzEsCiAgImNsaWNrcmV0cm9mbGV4IiwKICAweDAxYzMsCiAgImNsdWIiLAogIDB4MjY2MywKICAiY2x1YnN1aXRibGFjayIsCiAgMHgyNjYzLAogICJjbHVic3VpdHdoaXRlIiwKICAweDI2NjcsCiAgImNtY3ViZWRzcXVhcmUiLAogIDB4MzNhNCwKICAiY21vbm9zcGFjZSIsCiAgMHhmZjQzLAogICJjbXNxdWFyZWRzcXVhcmUiLAogIDB4MzNhMCwKICAiY29hcm1lbmlhbiIsCiAgMHgwNTgxLAogICJjb2xvbiIsCiAgMHgwMDNhLAogICJjb2xvbm1vbmV0YXJ5IiwKICAweDIwYTEsCiAgImNvbG9ubW9ub3NwYWNlIiwKICAweGZmMWEsCiAgImNvbG9uc2lnbiIsCiAgMHgyMGExLAogICJjb2xvbnNtYWxsIiwKICAweGZlNTUsCiAgImNvbG9udHJpYW5ndWxhcmhhbGZtb2QiLAogIDB4MDJkMSwKICAiY29sb250cmlhbmd1bGFybW9kIiwKICAweDAyZDAsCiAgImNvbW1hIiwKICAweDAwMmMsCiAgImNvbW1hYWJvdmVjbWIiLAogIDB4MDMxMywKICAiY29tbWFhYm92ZXJpZ2h0Y21iIiwKICAweDAzMTUsCiAgImNvbW1hYWNjZW50IiwKICAweGY2YzMsCiAgImNvbW1hYXJhYmljIiwKICAweDA2MGMsCiAgImNvbW1hYXJtZW5pYW4iLAogIDB4MDU1ZCwKICAiY29tbWFpbmZlcmlvciIsCiAgMHhmNmUxLAogICJjb21tYW1vbm9zcGFjZSIsCiAgMHhmZjBjLAogICJjb21tYXJldmVyc2VkYWJvdmVjbWIiLAogIDB4MDMxNCwKICAiY29tbWFyZXZlcnNlZG1vZCIsCiAgMHgwMmJkLAogICJjb21tYXNtYWxsIiwKICAweGZlNTAsCiAgImNvbW1hc3VwZXJpb3IiLAogIDB4ZjZlMiwKICAiY29tbWF0dXJuZWRhYm92ZWNtYiIsCiAgMHgwMzEyLAogICJjb21tYXR1cm5lZG1vZCIsCiAgMHgwMmJiLAogICJjb21wYXNzIiwKICAweDI2M2MsCiAgImNvbmdydWVudCIsCiAgMHgyMjQ1LAogICJjb250b3VyaW50ZWdyYWwiLAogIDB4MjIyZSwKICAiY29udHJvbCIsCiAgMHgyMzAzLAogICJjb250cm9sQUNLIiwKICAweDAwMDYsCiAgImNvbnRyb2xCRUwiLAogIDB4MDAwNywKICAiY29udHJvbEJTIiwKICAweDAwMDgsCiAgImNvbnRyb2xDQU4iLAogIDB4MDAxOCwKICAiY29udHJvbENSIiwKICAweDAwMGQsCiAgImNvbnRyb2xEQzEiLAogIDB4MDAxMSwKICAiY29udHJvbERDMiIsCiAgMHgwMDEyLAogICJjb250cm9sREMzIiwKICAweDAwMTMsCiAgImNvbnRyb2xEQzQiLAogIDB4MDAxNCwKICAiY29udHJvbERFTCIsCiAgMHgwMDdmLAogICJjb250cm9sRExFIiwKICAweDAwMTAsCiAgImNvbnRyb2xFTSIsCiAgMHgwMDE5LAogICJjb250cm9sRU5RIiwKICAweDAwMDUsCiAgImNvbnRyb2xFT1QiLAogIDB4MDAwNCwKICAiY29udHJvbEVTQyIsCiAgMHgwMDFiLAogICJjb250cm9sRVRCIiwKICAweDAwMTcsCiAgImNvbnRyb2xFVFgiLAogIDB4MDAwMywKICAiY29udHJvbEZGIiwKICAweDAwMGMsCiAgImNvbnRyb2xGUyIsCiAgMHgwMDFjLAogICJjb250cm9sR1MiLAogIDB4MDAxZCwKICAiY29udHJvbEhUIiwKICAweDAwMDksCiAgImNvbnRyb2xMRiIsCiAgMHgwMDBhLAogICJjb250cm9sTkFLIiwKICAweDAwMTUsCiAgImNvbnRyb2xOVUxMIiwKICAweDAwMDAsCiAgImNvbnRyb2xSUyIsCiAgMHgwMDFlLAogICJjb250cm9sU0kiLAogIDB4MDAwZiwKICAiY29udHJvbFNPIiwKICAweDAwMGUsCiAgImNvbnRyb2xTT1QiLAogIDB4MDAwMiwKICAiY29udHJvbFNUWCIsCiAgMHgwMDAxLAogICJjb250cm9sU1VCIiwKICAweDAwMWEsCiAgImNvbnRyb2xTWU4iLAogIDB4MDAxNiwKICAiY29udHJvbFVTIiwKICAweDAwMWYsCiAgImNvbnRyb2xWVCIsCiAgMHgwMDBiLAogICJjb3B5cmlnaHQiLAogIDB4MDBhOSwKICAiY29weXJpZ2h0c2FucyIsCiAgMHhmOGU5LAogICJjb3B5cmlnaHRzZXJpZiIsCiAgMHhmNmQ5LAogICJjb3JuZXJicmFja2V0bGVmdCIsCiAgMHgzMDBjLAogICJjb3JuZXJicmFja2V0bGVmdGhhbGZ3aWR0aCIsCiAgMHhmZjYyLAogICJjb3JuZXJicmFja2V0bGVmdHZlcnRpY2FsIiwKICAweGZlNDEsCiAgImNvcm5lcmJyYWNrZXRyaWdodCIsCiAgMHgzMDBkLAogICJjb3JuZXJicmFja2V0cmlnaHRoYWxmd2lkdGgiLAogIDB4ZmY2MywKICAiY29ybmVyYnJhY2tldHJpZ2h0dmVydGljYWwiLAogIDB4ZmU0MiwKICAiY29ycG9yYXRpb25zcXVhcmUiLAogIDB4MzM3ZiwKICAiY29zcXVhcmUiLAogIDB4MzNjNywKICAiY292ZXJrZ3NxdWFyZSIsCiAgMHgzM2M2LAogICJjcGFyZW4iLAogIDB4MjQ5ZSwKICAiY3J1emVpcm8iLAogIDB4MjBhMiwKICAiY3N0cmV0Y2hlZCIsCiAgMHgwMjk3LAogICJjdXJseWFuZCIsCiAgMHgyMmNmLAogICJjdXJseW9yIiwKICAweDIyY2UsCiAgImN1cnJlbmN5IiwKICAweDAwYTQsCiAgImN5ckJyZXZlIiwKICAweGY2ZDEsCiAgImN5ckZsZXgiLAogIDB4ZjZkMiwKICAiY3lyYnJldmUiLAogIDB4ZjZkNCwKICAiY3lyZmxleCIsCiAgMHhmNmQ1LAogICJkIiwKICAweDAwNjQsCiAgImRhYXJtZW5pYW4iLAogIDB4MDU2NCwKICAiZGFiZW5nYWxpIiwKICAweDA5YTYsCiAgImRhZGFyYWJpYyIsCiAgMHgwNjM2LAogICJkYWRldmEiLAogIDB4MDkyNiwKICAiZGFkZmluYWxhcmFiaWMiLAogIDB4ZmViZSwKICAiZGFkaW5pdGlhbGFyYWJpYyIsCiAgMHhmZWJmLAogICJkYWRtZWRpYWxhcmFiaWMiLAogIDB4ZmVjMCwKICAiZGFnZXNoIiwKICAweDA1YmMsCiAgImRhZ2VzaGhlYnJldyIsCiAgMHgwNWJjLAogICJkYWdnZXIiLAogIDB4MjAyMCwKICAiZGFnZ2VyZGJsIiwKICAweDIwMjEsCiAgImRhZ3VqYXJhdGkiLAogIDB4MGFhNiwKICAiZGFndXJtdWtoaSIsCiAgMHgwYTI2LAogICJkYWhpcmFnYW5hIiwKICAweDMwNjAsCiAgImRha2F0YWthbmEiLAogIDB4MzBjMCwKICAiZGFsYXJhYmljIiwKICAweDA2MmYsCiAgImRhbGV0IiwKICAweDA1ZDMsCiAgImRhbGV0ZGFnZXNoIiwKICAweGZiMzMsCiAgImRhbGV0ZGFnZXNoaGVicmV3IiwKICAweGZiMzMsCiAgImRhbGV0aGVicmV3IiwKICAweDA1ZDMsCiAgImRhbGZpbmFsYXJhYmljIiwKICAweGZlYWEsCiAgImRhbW1hYXJhYmljIiwKICAweDA2NGYsCiAgImRhbW1hbG93YXJhYmljIiwKICAweDA2NGYsCiAgImRhbW1hdGFuYWx0b25lYXJhYmljIiwKICAweDA2NGMsCiAgImRhbW1hdGFuYXJhYmljIiwKICAweDA2NGMsCiAgImRhbmRhIiwKICAweDA5NjQsCiAgImRhcmdhaGVicmV3IiwKICAweDA1YTcsCiAgImRhcmdhbGVmdGhlYnJldyIsCiAgMHgwNWE3LAogICJkYXNpYXBuZXVtYXRhY3lyaWxsaWNjbWIiLAogIDB4MDQ4NSwKICAiZGJsR3JhdmUiLAogIDB4ZjZkMywKICAiZGJsYW5nbGVicmFja2V0bGVmdCIsCiAgMHgzMDBhLAogICJkYmxhbmdsZWJyYWNrZXRsZWZ0dmVydGljYWwiLAogIDB4ZmUzZCwKICAiZGJsYW5nbGVicmFja2V0cmlnaHQiLAogIDB4MzAwYiwKICAiZGJsYW5nbGVicmFja2V0cmlnaHR2ZXJ0aWNhbCIsCiAgMHhmZTNlLAogICJkYmxhcmNoaW52ZXJ0ZWRiZWxvd2NtYiIsCiAgMHgwMzJiLAogICJkYmxhcnJvd2xlZnQiLAogIDB4MjFkNCwKICAiZGJsYXJyb3dyaWdodCIsCiAgMHgyMWQyLAogICJkYmxkYW5kYSIsCiAgMHgwOTY1LAogICJkYmxncmF2ZSIsCiAgMHhmNmQ2LAogICJkYmxncmF2ZWNtYiIsCiAgMHgwMzBmLAogICJkYmxpbnRlZ3JhbCIsCiAgMHgyMjJjLAogICJkYmxsb3dsaW5lIiwKICAweDIwMTcsCiAgImRibGxvd2xpbmVjbWIiLAogIDB4MDMzMywKICAiZGJsb3ZlcmxpbmVjbWIiLAogIDB4MDMzZiwKICAiZGJscHJpbWVtb2QiLAogIDB4MDJiYSwKICAiZGJsdmVydGljYWxiYXIiLAogIDB4MjAxNiwKICAiZGJsdmVydGljYWxsaW5lYWJvdmVjbWIiLAogIDB4MDMwZSwKICAiZGJvcG9tb2ZvIiwKICAweDMxMDksCiAgImRic3F1YXJlIiwKICAweDMzYzgsCiAgImRjYXJvbiIsCiAgMHgwMTBmLAogICJkY2VkaWxsYSIsCiAgMHgxZTExLAogICJkY2lyY2xlIiwKICAweDI0ZDMsCiAgImRjaXJjdW1mbGV4YmVsb3ciLAogIDB4MWUxMywKICAiZGNyb2F0IiwKICAweDAxMTEsCiAgImRkYWJlbmdhbGkiLAogIDB4MDlhMSwKICAiZGRhZGV2YSIsCiAgMHgwOTIxLAogICJkZGFndWphcmF0aSIsCiAgMHgwYWExLAogICJkZGFndXJtdWtoaSIsCiAgMHgwYTIxLAogICJkZGFsYXJhYmljIiwKICAweDA2ODgsCiAgImRkYWxmaW5hbGFyYWJpYyIsCiAgMHhmYjg5LAogICJkZGRoYWRldmEiLAogIDB4MDk1YywKICAiZGRoYWJlbmdhbGkiLAogIDB4MDlhMiwKICAiZGRoYWRldmEiLAogIDB4MDkyMiwKICAiZGRoYWd1amFyYXRpIiwKICAweDBhYTIsCiAgImRkaGFndXJtdWtoaSIsCiAgMHgwYTIyLAogICJkZG90YWNjZW50IiwKICAweDFlMGIsCiAgImRkb3RiZWxvdyIsCiAgMHgxZTBkLAogICJkZWNpbWFsc2VwYXJhdG9yYXJhYmljIiwKICAweDA2NmIsCiAgImRlY2ltYWxzZXBhcmF0b3JwZXJzaWFuIiwKICAweDA2NmIsCiAgImRlY3lyaWxsaWMiLAogIDB4MDQzNCwKICAiZGVncmVlIiwKICAweDAwYjAsCiAgImRlaGloZWJyZXciLAogIDB4MDVhZCwKICAiZGVoaXJhZ2FuYSIsCiAgMHgzMDY3LAogICJkZWljb3B0aWMiLAogIDB4MDNlZiwKICAiZGVrYXRha2FuYSIsCiAgMHgzMGM3LAogICJkZWxldGVsZWZ0IiwKICAweDIzMmIsCiAgImRlbGV0ZXJpZ2h0IiwKICAweDIzMjYsCiAgImRlbHRhIiwKICAweDAzYjQsCiAgImRlbHRhdHVybmVkIiwKICAweDAxOGQsCiAgImRlbm9taW5hdG9ybWludXNvbmVudW1lcmF0b3JiZW5nYWxpIiwKICAweDA5ZjgsCiAgImRlemgiLAogIDB4MDJhNCwKICAiZGhhYmVuZ2FsaSIsCiAgMHgwOWE3LAogICJkaGFkZXZhIiwKICAweDA5MjcsCiAgImRoYWd1amFyYXRpIiwKICAweDBhYTcsCiAgImRoYWd1cm11a2hpIiwKICAweDBhMjcsCiAgImRob29rIiwKICAweDAyNTcsCiAgImRpYWx5dGlrYXRvbm9zIiwKICAweDAzODUsCiAgImRpYWx5dGlrYXRvbm9zY21iIiwKICAweDAzNDQsCiAgImRpYW1vbmQiLAogIDB4MjY2NiwKICAiZGlhbW9uZHN1aXR3aGl0ZSIsCiAgMHgyNjYyLAogICJkaWVyZXNpcyIsCiAgMHgwMGE4LAogICJkaWVyZXNpc2FjdXRlIiwKICAweGY2ZDcsCiAgImRpZXJlc2lzYmVsb3djbWIiLAogIDB4MDMyNCwKICAiZGllcmVzaXNjbWIiLAogIDB4MDMwOCwKICAiZGllcmVzaXNncmF2ZSIsCiAgMHhmNmQ4LAogICJkaWVyZXNpc3Rvbm9zIiwKICAweDAzODUsCiAgImRpaGlyYWdhbmEiLAogIDB4MzA2MiwKICAiZGlrYXRha2FuYSIsCiAgMHgzMGMyLAogICJkaXR0b21hcmsiLAogIDB4MzAwMywKICAiZGl2aWRlIiwKICAweDAwZjcsCiAgImRpdmlkZXMiLAogIDB4MjIyMywKICAiZGl2aXNpb25zbGFzaCIsCiAgMHgyMjE1LAogICJkamVjeXJpbGxpYyIsCiAgMHgwNDUyLAogICJka3NoYWRlIiwKICAweDI1OTMsCiAgImRsaW5lYmVsb3ciLAogIDB4MWUwZiwKICAiZGxzcXVhcmUiLAogIDB4MzM5NywKICAiZG1hY3JvbiIsCiAgMHgwMTExLAogICJkbW9ub3NwYWNlIiwKICAweGZmNDQsCiAgImRuYmxvY2siLAogIDB4MjU4NCwKICAiZG9jaGFkYXRoYWkiLAogIDB4MGUwZSwKICAiZG9kZWt0aGFpIiwKICAweDBlMTQsCiAgImRvaGlyYWdhbmEiLAogIDB4MzA2OSwKICAiZG9rYXRha2FuYSIsCiAgMHgzMGM5LAogICJkb2xsYXIiLAogIDB4MDAyNCwKICAiZG9sbGFyaW5mZXJpb3IiLAogIDB4ZjZlMywKICAiZG9sbGFybW9ub3NwYWNlIiwKICAweGZmMDQsCiAgImRvbGxhcm9sZHN0eWxlIiwKICAweGY3MjQsCiAgImRvbGxhcnNtYWxsIiwKICAweGZlNjksCiAgImRvbGxhcnN1cGVyaW9yIiwKICAweGY2ZTQsCiAgImRvbmciLAogIDB4MjBhYiwKICAiZG9ydXNxdWFyZSIsCiAgMHgzMzI2LAogICJkb3RhY2NlbnQiLAogIDB4MDJkOSwKICAiZG90YWNjZW50Y21iIiwKICAweDAzMDcsCiAgImRvdGJlbG93Y21iIiwKICAweDAzMjMsCiAgImRvdGJlbG93Y29tYiIsCiAgMHgwMzIzLAogICJkb3RrYXRha2FuYSIsCiAgMHgzMGZiLAogICJkb3RsZXNzaSIsCiAgMHgwMTMxLAogICJkb3RsZXNzaiIsCiAgMHhmNmJlLAogICJkb3RsZXNzanN0cm9rZWhvb2siLAogIDB4MDI4NCwKICAiZG90bWF0aCIsCiAgMHgyMmM1LAogICJkb3R0ZWRjaXJjbGUiLAogIDB4MjVjYywKICAiZG91YmxleW9kcGF0YWgiLAogIDB4ZmIxZiwKICAiZG91YmxleW9kcGF0YWhoZWJyZXciLAogIDB4ZmIxZiwKICAiZG93bnRhY2tiZWxvd2NtYiIsCiAgMHgwMzFlLAogICJkb3dudGFja21vZCIsCiAgMHgwMmQ1LAogICJkcGFyZW4iLAogIDB4MjQ5ZiwKICAiZHN1cGVyaW9yIiwKICAweGY2ZWIsCiAgImR0YWlsIiwKICAweDAyNTYsCiAgImR0b3BiYXIiLAogIDB4MDE4YywKICAiZHVoaXJhZ2FuYSIsCiAgMHgzMDY1LAogICJkdWthdGFrYW5hIiwKICAweDMwYzUsCiAgImR6IiwKICAweDAxZjMsCiAgImR6YWx0b25lIiwKICAweDAyYTMsCiAgImR6Y2Fyb24iLAogIDB4MDFjNiwKICAiZHpjdXJsIiwKICAweDAyYTUsCiAgImR6ZWFia2hhc2lhbmN5cmlsbGljIiwKICAweDA0ZTEsCiAgImR6ZWN5cmlsbGljIiwKICAweDA0NTUsCiAgImR6aGVjeXJpbGxpYyIsCiAgMHgwNDVmLAogICJlIiwKICAweDAwNjUsCiAgImVhY3V0ZSIsCiAgMHgwMGU5LAogICJlYXJ0aCIsCiAgMHgyNjQxLAogICJlYmVuZ2FsaSIsCiAgMHgwOThmLAogICJlYm9wb21vZm8iLAogIDB4MzExYywKICAiZWJyZXZlIiwKICAweDAxMTUsCiAgImVjYW5kcmFkZXZhIiwKICAweDA5MGQsCiAgImVjYW5kcmFndWphcmF0aSIsCiAgMHgwYThkLAogICJlY2FuZHJhdm93ZWxzaWduZGV2YSIsCiAgMHgwOTQ1LAogICJlY2FuZHJhdm93ZWxzaWduZ3VqYXJhdGkiLAogIDB4MGFjNSwKICAiZWNhcm9uIiwKICAweDAxMWIsCiAgImVjZWRpbGxhYnJldmUiLAogIDB4MWUxZCwKICAiZWNoYXJtZW5pYW4iLAogIDB4MDU2NSwKICAiZWNoeWl3bmFybWVuaWFuIiwKICAweDA1ODcsCiAgImVjaXJjbGUiLAogIDB4MjRkNCwKICAiZWNpcmN1bWZsZXgiLAogIDB4MDBlYSwKICAiZWNpcmN1bWZsZXhhY3V0ZSIsCiAgMHgxZWJmLAogICJlY2lyY3VtZmxleGJlbG93IiwKICAweDFlMTksCiAgImVjaXJjdW1mbGV4ZG90YmVsb3ciLAogIDB4MWVjNywKICAiZWNpcmN1bWZsZXhncmF2ZSIsCiAgMHgxZWMxLAogICJlY2lyY3VtZmxleGhvb2thYm92ZSIsCiAgMHgxZWMzLAogICJlY2lyY3VtZmxleHRpbGRlIiwKICAweDFlYzUsCiAgImVjeXJpbGxpYyIsCiAgMHgwNDU0LAogICJlZGJsZ3JhdmUiLAogIDB4MDIwNSwKICAiZWRldmEiLAogIDB4MDkwZiwKICAiZWRpZXJlc2lzIiwKICAweDAwZWIsCiAgImVkb3QiLAogIDB4MDExNywKICAiZWRvdGFjY2VudCIsCiAgMHgwMTE3LAogICJlZG90YmVsb3ciLAogIDB4MWViOSwKICAiZWVndXJtdWtoaSIsCiAgMHgwYTBmLAogICJlZW1hdHJhZ3VybXVraGkiLAogIDB4MGE0NywKICAiZWZjeXJpbGxpYyIsCiAgMHgwNDQ0LAogICJlZ3JhdmUiLAogIDB4MDBlOCwKICAiZWd1amFyYXRpIiwKICAweDBhOGYsCiAgImVoYXJtZW5pYW4iLAogIDB4MDU2NywKICAiZWhib3BvbW9mbyIsCiAgMHgzMTFkLAogICJlaGlyYWdhbmEiLAogIDB4MzA0OCwKICAiZWhvb2thYm92ZSIsCiAgMHgxZWJiLAogICJlaWJvcG9tb2ZvIiwKICAweDMxMWYsCiAgImVpZ2h0IiwKICAweDAwMzgsCiAgImVpZ2h0YXJhYmljIiwKICAweDA2NjgsCiAgImVpZ2h0YmVuZ2FsaSIsCiAgMHgwOWVlLAogICJlaWdodGNpcmNsZSIsCiAgMHgyNDY3LAogICJlaWdodGNpcmNsZWludmVyc2VzYW5zc2VyaWYiLAogIDB4Mjc5MSwKICAiZWlnaHRkZXZhIiwKICAweDA5NmUsCiAgImVpZ2h0ZWVuY2lyY2xlIiwKICAweDI0NzEsCiAgImVpZ2h0ZWVucGFyZW4iLAogIDB4MjQ4NSwKICAiZWlnaHRlZW5wZXJpb2QiLAogIDB4MjQ5OSwKICAiZWlnaHRndWphcmF0aSIsCiAgMHgwYWVlLAogICJlaWdodGd1cm11a2hpIiwKICAweDBhNmUsCiAgImVpZ2h0aGFja2FyYWJpYyIsCiAgMHgwNjY4LAogICJlaWdodGhhbmd6aG91IiwKICAweDMwMjgsCiAgImVpZ2h0aG5vdGViZWFtZWQiLAogIDB4MjY2YiwKICAiZWlnaHRpZGVvZ3JhcGhpY3BhcmVuIiwKICAweDMyMjcsCiAgImVpZ2h0aW5mZXJpb3IiLAogIDB4MjA4OCwKICAiZWlnaHRtb25vc3BhY2UiLAogIDB4ZmYxOCwKICAiZWlnaHRvbGRzdHlsZSIsCiAgMHhmNzM4LAogICJlaWdodHBhcmVuIiwKICAweDI0N2IsCiAgImVpZ2h0cGVyaW9kIiwKICAweDI0OGYsCiAgImVpZ2h0cGVyc2lhbiIsCiAgMHgwNmY4LAogICJlaWdodHJvbWFuIiwKICAweDIxNzcsCiAgImVpZ2h0c3VwZXJpb3IiLAogIDB4MjA3OCwKICAiZWlnaHR0aGFpIiwKICAweDBlNTgsCiAgImVpbnZlcnRlZGJyZXZlIiwKICAweDAyMDcsCiAgImVpb3RpZmllZGN5cmlsbGljIiwKICAweDA0NjUsCiAgImVrYXRha2FuYSIsCiAgMHgzMGE4LAogICJla2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3NCwKICAiZWtvbmthcmd1cm11a2hpIiwKICAweDBhNzQsCiAgImVrb3JlYW4iLAogIDB4MzE1NCwKICAiZWxjeXJpbGxpYyIsCiAgMHgwNDNiLAogICJlbGVtZW50IiwKICAweDIyMDgsCiAgImVsZXZlbmNpcmNsZSIsCiAgMHgyNDZhLAogICJlbGV2ZW5wYXJlbiIsCiAgMHgyNDdlLAogICJlbGV2ZW5wZXJpb2QiLAogIDB4MjQ5MiwKICAiZWxldmVucm9tYW4iLAogIDB4MjE3YSwKICAiZWxsaXBzaXMiLAogIDB4MjAyNiwKICAiZWxsaXBzaXN2ZXJ0aWNhbCIsCiAgMHgyMmVlLAogICJlbWFjcm9uIiwKICAweDAxMTMsCiAgImVtYWNyb25hY3V0ZSIsCiAgMHgxZTE3LAogICJlbWFjcm9uZ3JhdmUiLAogIDB4MWUxNSwKICAiZW1jeXJpbGxpYyIsCiAgMHgwNDNjLAogICJlbWRhc2giLAogIDB4MjAxNCwKICAiZW1kYXNodmVydGljYWwiLAogIDB4ZmUzMSwKICAiZW1vbm9zcGFjZSIsCiAgMHhmZjQ1LAogICJlbXBoYXNpc21hcmthcm1lbmlhbiIsCiAgMHgwNTViLAogICJlbXB0eXNldCIsCiAgMHgyMjA1LAogICJlbmJvcG9tb2ZvIiwKICAweDMxMjMsCiAgImVuY3lyaWxsaWMiLAogIDB4MDQzZCwKICAiZW5kYXNoIiwKICAweDIwMTMsCiAgImVuZGFzaHZlcnRpY2FsIiwKICAweGZlMzIsCiAgImVuZGVzY2VuZGVyY3lyaWxsaWMiLAogIDB4MDRhMywKICAiZW5nIiwKICAweDAxNGIsCiAgImVuZ2JvcG9tb2ZvIiwKICAweDMxMjUsCiAgImVuZ2hlY3lyaWxsaWMiLAogIDB4MDRhNSwKICAiZW5ob29rY3lyaWxsaWMiLAogIDB4MDRjOCwKICAiZW5zcGFjZSIsCiAgMHgyMDAyLAogICJlb2dvbmVrIiwKICAweDAxMTksCiAgImVva29yZWFuIiwKICAweDMxNTMsCiAgImVvcGVuIiwKICAweDAyNWIsCiAgImVvcGVuY2xvc2VkIiwKICAweDAyOWEsCiAgImVvcGVucmV2ZXJzZWQiLAogIDB4MDI1YywKICAiZW9wZW5yZXZlcnNlZGNsb3NlZCIsCiAgMHgwMjVlLAogICJlb3BlbnJldmVyc2VkaG9vayIsCiAgMHgwMjVkLAogICJlcGFyZW4iLAogIDB4MjRhMCwKICAiZXBzaWxvbiIsCiAgMHgwM2I1LAogICJlcHNpbG9udG9ub3MiLAogIDB4MDNhZCwKICAiZXF1YWwiLAogIDB4MDAzZCwKICAiZXF1YWxtb25vc3BhY2UiLAogIDB4ZmYxZCwKICAiZXF1YWxzbWFsbCIsCiAgMHhmZTY2LAogICJlcXVhbHN1cGVyaW9yIiwKICAweDIwN2MsCiAgImVxdWl2YWxlbmNlIiwKICAweDIyNjEsCiAgImVyYm9wb21vZm8iLAogIDB4MzEyNiwKICAiZXJjeXJpbGxpYyIsCiAgMHgwNDQwLAogICJlcmV2ZXJzZWQiLAogIDB4MDI1OCwKICAiZXJldmVyc2VkY3lyaWxsaWMiLAogIDB4MDQ0ZCwKICAiZXNjeXJpbGxpYyIsCiAgMHgwNDQxLAogICJlc2Rlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0YWIsCiAgImVzaCIsCiAgMHgwMjgzLAogICJlc2hjdXJsIiwKICAweDAyODYsCiAgImVzaG9ydGRldmEiLAogIDB4MDkwZSwKICAiZXNob3J0dm93ZWxzaWduZGV2YSIsCiAgMHgwOTQ2LAogICJlc2hyZXZlcnNlZGxvb3AiLAogIDB4MDFhYSwKICAiZXNoc3F1YXRyZXZlcnNlZCIsCiAgMHgwMjg1LAogICJlc21hbGxoaXJhZ2FuYSIsCiAgMHgzMDQ3LAogICJlc21hbGxrYXRha2FuYSIsCiAgMHgzMGE3LAogICJlc21hbGxrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjZhLAogICJlc3RpbWF0ZWQiLAogIDB4MjEyZSwKICAiZXN1cGVyaW9yIiwKICAweGY2ZWMsCiAgImV0YSIsCiAgMHgwM2I3LAogICJldGFybWVuaWFuIiwKICAweDA1NjgsCiAgImV0YXRvbm9zIiwKICAweDAzYWUsCiAgImV0aCIsCiAgMHgwMGYwLAogICJldGlsZGUiLAogIDB4MWViZCwKICAiZXRpbGRlYmVsb3ciLAogIDB4MWUxYiwKICAiZXRuYWh0YWZvdWtoaGVicmV3IiwKICAweDA1OTEsCiAgImV0bmFodGFmb3VraGxlZnRoZWJyZXciLAogIDB4MDU5MSwKICAiZXRuYWh0YWhlYnJldyIsCiAgMHgwNTkxLAogICJldG5haHRhbGVmdGhlYnJldyIsCiAgMHgwNTkxLAogICJldHVybmVkIiwKICAweDAxZGQsCiAgImV1a29yZWFuIiwKICAweDMxNjEsCiAgImV1cm8iLAogIDB4MjBhYywKICAiZXZvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljNywKICAiZXZvd2Vsc2lnbmRldmEiLAogIDB4MDk0NywKICAiZXZvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhYzcsCiAgImV4Y2xhbSIsCiAgMHgwMDIxLAogICJleGNsYW1hcm1lbmlhbiIsCiAgMHgwNTVjLAogICJleGNsYW1kYmwiLAogIDB4MjAzYywKICAiZXhjbGFtZG93biIsCiAgMHgwMGExLAogICJleGNsYW1kb3duc21hbGwiLAogIDB4ZjdhMSwKICAiZXhjbGFtbW9ub3NwYWNlIiwKICAweGZmMDEsCiAgImV4Y2xhbXNtYWxsIiwKICAweGY3MjEsCiAgImV4aXN0ZW50aWFsIiwKICAweDIyMDMsCiAgImV6aCIsCiAgMHgwMjkyLAogICJlemhjYXJvbiIsCiAgMHgwMWVmLAogICJlemhjdXJsIiwKICAweDAyOTMsCiAgImV6aHJldmVyc2VkIiwKICAweDAxYjksCiAgImV6aHRhaWwiLAogIDB4MDFiYSwKICAiZiIsCiAgMHgwMDY2LAogICJmYWRldmEiLAogIDB4MDk1ZSwKICAiZmFndXJtdWtoaSIsCiAgMHgwYTVlLAogICJmYWhyZW5oZWl0IiwKICAweDIxMDksCiAgImZhdGhhYXJhYmljIiwKICAweDA2NGUsCiAgImZhdGhhbG93YXJhYmljIiwKICAweDA2NGUsCiAgImZhdGhhdGFuYXJhYmljIiwKICAweDA2NGIsCiAgImZib3BvbW9mbyIsCiAgMHgzMTA4LAogICJmY2lyY2xlIiwKICAweDI0ZDUsCiAgImZkb3RhY2NlbnQiLAogIDB4MWUxZiwKICAiZmVoYXJhYmljIiwKICAweDA2NDEsCiAgImZlaGFybWVuaWFuIiwKICAweDA1ODYsCiAgImZlaGZpbmFsYXJhYmljIiwKICAweGZlZDIsCiAgImZlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmVkMywKICAiZmVobWVkaWFsYXJhYmljIiwKICAweGZlZDQsCiAgImZlaWNvcHRpYyIsCiAgMHgwM2U1LAogICJmZW1hbGUiLAogIDB4MjY0MCwKICAiZmYiLAogIDB4ZmIwMCwKICAiZl9mIiwKICAweGZiMDAsCiAgImZmaSIsCiAgMHhmYjAzLAogICJmZmwiLAogIDB4ZmIwNCwKICAiZmkiLAogIDB4ZmIwMSwKICAiZmlmdGVlbmNpcmNsZSIsCiAgMHgyNDZlLAogICJmaWZ0ZWVucGFyZW4iLAogIDB4MjQ4MiwKICAiZmlmdGVlbnBlcmlvZCIsCiAgMHgyNDk2LAogICJmaWd1cmVkYXNoIiwKICAweDIwMTIsCiAgImZpbGxlZGJveCIsCiAgMHgyNWEwLAogICJmaWxsZWRyZWN0IiwKICAweDI1YWMsCiAgImZpbmFsa2FmIiwKICAweDA1ZGEsCiAgImZpbmFsa2FmZGFnZXNoIiwKICAweGZiM2EsCiAgImZpbmFsa2FmZGFnZXNoaGVicmV3IiwKICAweGZiM2EsCiAgImZpbmFsa2FmaGVicmV3IiwKICAweDA1ZGEsCiAgImZpbmFsbWVtIiwKICAweDA1ZGQsCiAgImZpbmFsbWVtaGVicmV3IiwKICAweDA1ZGQsCiAgImZpbmFsbnVuIiwKICAweDA1ZGYsCiAgImZpbmFsbnVuaGVicmV3IiwKICAweDA1ZGYsCiAgImZpbmFscGUiLAogIDB4MDVlMywKICAiZmluYWxwZWhlYnJldyIsCiAgMHgwNWUzLAogICJmaW5hbHRzYWRpIiwKICAweDA1ZTUsCiAgImZpbmFsdHNhZGloZWJyZXciLAogIDB4MDVlNSwKICAiZmlyc3R0b25lY2hpbmVzZSIsCiAgMHgwMmM5LAogICJmaXNoZXllIiwKICAweDI1YzksCiAgImZpdGFjeXJpbGxpYyIsCiAgMHgwNDczLAogICJmaXZlIiwKICAweDAwMzUsCiAgImZpdmVhcmFiaWMiLAogIDB4MDY2NSwKICAiZml2ZWJlbmdhbGkiLAogIDB4MDllYiwKICAiZml2ZWNpcmNsZSIsCiAgMHgyNDY0LAogICJmaXZlY2lyY2xlaW52ZXJzZXNhbnNzZXJpZiIsCiAgMHgyNzhlLAogICJmaXZlZGV2YSIsCiAgMHgwOTZiLAogICJmaXZlZWlnaHRocyIsCiAgMHgyMTVkLAogICJmaXZlZ3VqYXJhdGkiLAogIDB4MGFlYiwKICAiZml2ZWd1cm11a2hpIiwKICAweDBhNmIsCiAgImZpdmVoYWNrYXJhYmljIiwKICAweDA2NjUsCiAgImZpdmVoYW5nemhvdSIsCiAgMHgzMDI1LAogICJmaXZlaWRlb2dyYXBoaWNwYXJlbiIsCiAgMHgzMjI0LAogICJmaXZlaW5mZXJpb3IiLAogIDB4MjA4NSwKICAiZml2ZW1vbm9zcGFjZSIsCiAgMHhmZjE1LAogICJmaXZlb2xkc3R5bGUiLAogIDB4ZjczNSwKICAiZml2ZXBhcmVuIiwKICAweDI0NzgsCiAgImZpdmVwZXJpb2QiLAogIDB4MjQ4YywKICAiZml2ZXBlcnNpYW4iLAogIDB4MDZmNSwKICAiZml2ZXJvbWFuIiwKICAweDIxNzQsCiAgImZpdmVzdXBlcmlvciIsCiAgMHgyMDc1LAogICJmaXZldGhhaSIsCiAgMHgwZTU1LAogICJmbCIsCiAgMHhmYjAyLAogICJmbG9yaW4iLAogIDB4MDE5MiwKICAiZm1vbm9zcGFjZSIsCiAgMHhmZjQ2LAogICJmbXNxdWFyZSIsCiAgMHgzMzk5LAogICJmb2ZhbnRoYWkiLAogIDB4MGUxZiwKICAiZm9mYXRoYWkiLAogIDB4MGUxZCwKICAiZm9uZ21hbnRoYWkiLAogIDB4MGU0ZiwKICAiZm9yYWxsIiwKICAweDIyMDAsCiAgImZvdXIiLAogIDB4MDAzNCwKICAiZm91cmFyYWJpYyIsCiAgMHgwNjY0LAogICJmb3VyYmVuZ2FsaSIsCiAgMHgwOWVhLAogICJmb3VyY2lyY2xlIiwKICAweDI0NjMsCiAgImZvdXJjaXJjbGVpbnZlcnNlc2Fuc3NlcmlmIiwKICAweDI3OGQsCiAgImZvdXJkZXZhIiwKICAweDA5NmEsCiAgImZvdXJndWphcmF0aSIsCiAgMHgwYWVhLAogICJmb3VyZ3VybXVraGkiLAogIDB4MGE2YSwKICAiZm91cmhhY2thcmFiaWMiLAogIDB4MDY2NCwKICAiZm91cmhhbmd6aG91IiwKICAweDMwMjQsCiAgImZvdXJpZGVvZ3JhcGhpY3BhcmVuIiwKICAweDMyMjMsCiAgImZvdXJpbmZlcmlvciIsCiAgMHgyMDg0LAogICJmb3VybW9ub3NwYWNlIiwKICAweGZmMTQsCiAgImZvdXJudW1lcmF0b3JiZW5nYWxpIiwKICAweDA5ZjcsCiAgImZvdXJvbGRzdHlsZSIsCiAgMHhmNzM0LAogICJmb3VycGFyZW4iLAogIDB4MjQ3NywKICAiZm91cnBlcmlvZCIsCiAgMHgyNDhiLAogICJmb3VycGVyc2lhbiIsCiAgMHgwNmY0LAogICJmb3Vycm9tYW4iLAogIDB4MjE3MywKICAiZm91cnN1cGVyaW9yIiwKICAweDIwNzQsCiAgImZvdXJ0ZWVuY2lyY2xlIiwKICAweDI0NmQsCiAgImZvdXJ0ZWVucGFyZW4iLAogIDB4MjQ4MSwKICAiZm91cnRlZW5wZXJpb2QiLAogIDB4MjQ5NSwKICAiZm91cnRoYWkiLAogIDB4MGU1NCwKICAiZm91cnRodG9uZWNoaW5lc2UiLAogIDB4MDJjYiwKICAiZnBhcmVuIiwKICAweDI0YTEsCiAgImZyYWN0aW9uIiwKICAweDIwNDQsCiAgImZyYW5jIiwKICAweDIwYTMsCiAgImciLAogIDB4MDA2NywKICAiZ2FiZW5nYWxpIiwKICAweDA5OTcsCiAgImdhY3V0ZSIsCiAgMHgwMWY1LAogICJnYWRldmEiLAogIDB4MDkxNywKICAiZ2FmYXJhYmljIiwKICAweDA2YWYsCiAgImdhZmZpbmFsYXJhYmljIiwKICAweGZiOTMsCiAgImdhZmluaXRpYWxhcmFiaWMiLAogIDB4ZmI5NCwKICAiZ2FmbWVkaWFsYXJhYmljIiwKICAweGZiOTUsCiAgImdhZ3VqYXJhdGkiLAogIDB4MGE5NywKICAiZ2FndXJtdWtoaSIsCiAgMHgwYTE3LAogICJnYWhpcmFnYW5hIiwKICAweDMwNGMsCiAgImdha2F0YWthbmEiLAogIDB4MzBhYywKICAiZ2FtbWEiLAogIDB4MDNiMywKICAiZ2FtbWFsYXRpbnNtYWxsIiwKICAweDAyNjMsCiAgImdhbW1hc3VwZXJpb3IiLAogIDB4MDJlMCwKICAiZ2FuZ2lhY29wdGljIiwKICAweDAzZWIsCiAgImdib3BvbW9mbyIsCiAgMHgzMTBkLAogICJnYnJldmUiLAogIDB4MDExZiwKICAiZ2Nhcm9uIiwKICAweDAxZTcsCiAgImdjZWRpbGxhIiwKICAweDAxMjMsCiAgImdjaXJjbGUiLAogIDB4MjRkNiwKICAiZ2NpcmN1bWZsZXgiLAogIDB4MDExZCwKICAiZ2NvbW1hYWNjZW50IiwKICAweDAxMjMsCiAgImdkb3QiLAogIDB4MDEyMSwKICAiZ2RvdGFjY2VudCIsCiAgMHgwMTIxLAogICJnZWN5cmlsbGljIiwKICAweDA0MzMsCiAgImdlaGlyYWdhbmEiLAogIDB4MzA1MiwKICAiZ2VrYXRha2FuYSIsCiAgMHgzMGIyLAogICJnZW9tZXRyaWNhbGx5ZXF1YWwiLAogIDB4MjI1MSwKICAiZ2VyZXNoYWNjZW50aGVicmV3IiwKICAweDA1OWMsCiAgImdlcmVzaGhlYnJldyIsCiAgMHgwNWYzLAogICJnZXJlc2htdXFkYW1oZWJyZXciLAogIDB4MDU5ZCwKICAiZ2VybWFuZGJscyIsCiAgMHgwMGRmLAogICJnZXJzaGF5aW1hY2NlbnRoZWJyZXciLAogIDB4MDU5ZSwKICAiZ2Vyc2hheWltaGVicmV3IiwKICAweDA1ZjQsCiAgImdldGFtYXJrIiwKICAweDMwMTMsCiAgImdoYWJlbmdhbGkiLAogIDB4MDk5OCwKICAiZ2hhZGFybWVuaWFuIiwKICAweDA1NzIsCiAgImdoYWRldmEiLAogIDB4MDkxOCwKICAiZ2hhZ3VqYXJhdGkiLAogIDB4MGE5OCwKICAiZ2hhZ3VybXVraGkiLAogIDB4MGExOCwKICAiZ2hhaW5hcmFiaWMiLAogIDB4MDYzYSwKICAiZ2hhaW5maW5hbGFyYWJpYyIsCiAgMHhmZWNlLAogICJnaGFpbmluaXRpYWxhcmFiaWMiLAogIDB4ZmVjZiwKICAiZ2hhaW5tZWRpYWxhcmFiaWMiLAogIDB4ZmVkMCwKICAiZ2hlbWlkZGxlaG9va2N5cmlsbGljIiwKICAweDA0OTUsCiAgImdoZXN0cm9rZWN5cmlsbGljIiwKICAweDA0OTMsCiAgImdoZXVwdHVybmN5cmlsbGljIiwKICAweDA0OTEsCiAgImdoaGFkZXZhIiwKICAweDA5NWEsCiAgImdoaGFndXJtdWtoaSIsCiAgMHgwYTVhLAogICJnaG9vayIsCiAgMHgwMjYwLAogICJnaHpzcXVhcmUiLAogIDB4MzM5MywKICAiZ2loaXJhZ2FuYSIsCiAgMHgzMDRlLAogICJnaWthdGFrYW5hIiwKICAweDMwYWUsCiAgImdpbWFybWVuaWFuIiwKICAweDA1NjMsCiAgImdpbWVsIiwKICAweDA1ZDIsCiAgImdpbWVsZGFnZXNoIiwKICAweGZiMzIsCiAgImdpbWVsZGFnZXNoaGVicmV3IiwKICAweGZiMzIsCiAgImdpbWVsaGVicmV3IiwKICAweDA1ZDIsCiAgImdqZWN5cmlsbGljIiwKICAweDA0NTMsCiAgImdsb3R0YWxpbnZlcnRlZHN0cm9rZSIsCiAgMHgwMWJlLAogICJnbG90dGFsc3RvcCIsCiAgMHgwMjk0LAogICJnbG90dGFsc3RvcGludmVydGVkIiwKICAweDAyOTYsCiAgImdsb3R0YWxzdG9wbW9kIiwKICAweDAyYzAsCiAgImdsb3R0YWxzdG9wcmV2ZXJzZWQiLAogIDB4MDI5NSwKICAiZ2xvdHRhbHN0b3ByZXZlcnNlZG1vZCIsCiAgMHgwMmMxLAogICJnbG90dGFsc3RvcHJldmVyc2Vkc3VwZXJpb3IiLAogIDB4MDJlNCwKICAiZ2xvdHRhbHN0b3BzdHJva2UiLAogIDB4MDJhMSwKICAiZ2xvdHRhbHN0b3BzdHJva2VyZXZlcnNlZCIsCiAgMHgwMmEyLAogICJnbWFjcm9uIiwKICAweDFlMjEsCiAgImdtb25vc3BhY2UiLAogIDB4ZmY0NywKICAiZ29oaXJhZ2FuYSIsCiAgMHgzMDU0LAogICJnb2thdGFrYW5hIiwKICAweDMwYjQsCiAgImdwYXJlbiIsCiAgMHgyNGEyLAogICJncGFzcXVhcmUiLAogIDB4MzNhYywKICAiZ3JhZGllbnQiLAogIDB4MjIwNywKICAiZ3JhdmUiLAogIDB4MDA2MCwKICAiZ3JhdmViZWxvd2NtYiIsCiAgMHgwMzE2LAogICJncmF2ZWNtYiIsCiAgMHgwMzAwLAogICJncmF2ZWNvbWIiLAogIDB4MDMwMCwKICAiZ3JhdmVkZXZhIiwKICAweDA5NTMsCiAgImdyYXZlbG93bW9kIiwKICAweDAyY2UsCiAgImdyYXZlbW9ub3NwYWNlIiwKICAweGZmNDAsCiAgImdyYXZldG9uZWNtYiIsCiAgMHgwMzQwLAogICJncmVhdGVyIiwKICAweDAwM2UsCiAgImdyZWF0ZXJlcXVhbCIsCiAgMHgyMjY1LAogICJncmVhdGVyZXF1YWxvcmxlc3MiLAogIDB4MjJkYiwKICAiZ3JlYXRlcm1vbm9zcGFjZSIsCiAgMHhmZjFlLAogICJncmVhdGVyb3JlcXVpdmFsZW50IiwKICAweDIyNzMsCiAgImdyZWF0ZXJvcmxlc3MiLAogIDB4MjI3NywKICAiZ3JlYXRlcm92ZXJlcXVhbCIsCiAgMHgyMjY3LAogICJncmVhdGVyc21hbGwiLAogIDB4ZmU2NSwKICAiZ3NjcmlwdCIsCiAgMHgwMjYxLAogICJnc3Ryb2tlIiwKICAweDAxZTUsCiAgImd1aGlyYWdhbmEiLAogIDB4MzA1MCwKICAiZ3VpbGxlbW90bGVmdCIsCiAgMHgwMGFiLAogICJndWlsbGVtb3RyaWdodCIsCiAgMHgwMGJiLAogICJndWlsc2luZ2xsZWZ0IiwKICAweDIwMzksCiAgImd1aWxzaW5nbHJpZ2h0IiwKICAweDIwM2EsCiAgImd1a2F0YWthbmEiLAogIDB4MzBiMCwKICAiZ3VyYW11c3F1YXJlIiwKICAweDMzMTgsCiAgImd5c3F1YXJlIiwKICAweDMzYzksCiAgImgiLAogIDB4MDA2OCwKICAiaGFhYmtoYXNpYW5jeXJpbGxpYyIsCiAgMHgwNGE5LAogICJoYWFsdG9uZWFyYWJpYyIsCiAgMHgwNmMxLAogICJoYWJlbmdhbGkiLAogIDB4MDliOSwKICAiaGFkZXNjZW5kZXJjeXJpbGxpYyIsCiAgMHgwNGIzLAogICJoYWRldmEiLAogIDB4MDkzOSwKICAiaGFndWphcmF0aSIsCiAgMHgwYWI5LAogICJoYWd1cm11a2hpIiwKICAweDBhMzksCiAgImhhaGFyYWJpYyIsCiAgMHgwNjJkLAogICJoYWhmaW5hbGFyYWJpYyIsCiAgMHhmZWEyLAogICJoYWhpbml0aWFsYXJhYmljIiwKICAweGZlYTMsCiAgImhhaGlyYWdhbmEiLAogIDB4MzA2ZiwKICAiaGFobWVkaWFsYXJhYmljIiwKICAweGZlYTQsCiAgImhhaXR1c3F1YXJlIiwKICAweDMzMmEsCiAgImhha2F0YWthbmEiLAogIDB4MzBjZiwKICAiaGFrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjhhLAogICJoYWxhbnRndXJtdWtoaSIsCiAgMHgwYTRkLAogICJoYW16YWFyYWJpYyIsCiAgMHgwNjIxLAogICJoYW16YWxvd2FyYWJpYyIsCiAgMHgwNjIxLAogICJoYW5ndWxmaWxsZXIiLAogIDB4MzE2NCwKICAiaGFyZHNpZ25jeXJpbGxpYyIsCiAgMHgwNDRhLAogICJoYXJwb29ubGVmdGJhcmJ1cCIsCiAgMHgyMWJjLAogICJoYXJwb29ucmlnaHRiYXJidXAiLAogIDB4MjFjMCwKICAiaGFzcXVhcmUiLAogIDB4MzNjYSwKICAiaGF0YWZwYXRhaCIsCiAgMHgwNWIyLAogICJoYXRhZnBhdGFoMTYiLAogIDB4MDViMiwKICAiaGF0YWZwYXRhaDIzIiwKICAweDA1YjIsCiAgImhhdGFmcGF0YWgyZiIsCiAgMHgwNWIyLAogICJoYXRhZnBhdGFoaGVicmV3IiwKICAweDA1YjIsCiAgImhhdGFmcGF0YWhuYXJyb3doZWJyZXciLAogIDB4MDViMiwKICAiaGF0YWZwYXRhaHF1YXJ0ZXJoZWJyZXciLAogIDB4MDViMiwKICAiaGF0YWZwYXRhaHdpZGVoZWJyZXciLAogIDB4MDViMiwKICAiaGF0YWZxYW1hdHMiLAogIDB4MDViMywKICAiaGF0YWZxYW1hdHMxYiIsCiAgMHgwNWIzLAogICJoYXRhZnFhbWF0czI4IiwKICAweDA1YjMsCiAgImhhdGFmcWFtYXRzMzQiLAogIDB4MDViMywKICAiaGF0YWZxYW1hdHNoZWJyZXciLAogIDB4MDViMywKICAiaGF0YWZxYW1hdHNuYXJyb3doZWJyZXciLAogIDB4MDViMywKICAiaGF0YWZxYW1hdHNxdWFydGVyaGVicmV3IiwKICAweDA1YjMsCiAgImhhdGFmcWFtYXRzd2lkZWhlYnJldyIsCiAgMHgwNWIzLAogICJoYXRhZnNlZ29sIiwKICAweDA1YjEsCiAgImhhdGFmc2Vnb2wxNyIsCiAgMHgwNWIxLAogICJoYXRhZnNlZ29sMjQiLAogIDB4MDViMSwKICAiaGF0YWZzZWdvbDMwIiwKICAweDA1YjEsCiAgImhhdGFmc2Vnb2xoZWJyZXciLAogIDB4MDViMSwKICAiaGF0YWZzZWdvbG5hcnJvd2hlYnJldyIsCiAgMHgwNWIxLAogICJoYXRhZnNlZ29scXVhcnRlcmhlYnJldyIsCiAgMHgwNWIxLAogICJoYXRhZnNlZ29sd2lkZWhlYnJldyIsCiAgMHgwNWIxLAogICJoYmFyIiwKICAweDAxMjcsCiAgImhib3BvbW9mbyIsCiAgMHgzMTBmLAogICJoYnJldmViZWxvdyIsCiAgMHgxZTJiLAogICJoY2VkaWxsYSIsCiAgMHgxZTI5LAogICJoY2lyY2xlIiwKICAweDI0ZDcsCiAgImhjaXJjdW1mbGV4IiwKICAweDAxMjUsCiAgImhkaWVyZXNpcyIsCiAgMHgxZTI3LAogICJoZG90YWNjZW50IiwKICAweDFlMjMsCiAgImhkb3RiZWxvdyIsCiAgMHgxZTI1LAogICJoZSIsCiAgMHgwNWQ0LAogICJoZWFydCIsCiAgMHgyNjY1LAogICJoZWFydHN1aXRibGFjayIsCiAgMHgyNjY1LAogICJoZWFydHN1aXR3aGl0ZSIsCiAgMHgyNjYxLAogICJoZWRhZ2VzaCIsCiAgMHhmYjM0LAogICJoZWRhZ2VzaGhlYnJldyIsCiAgMHhmYjM0LAogICJoZWhhbHRvbmVhcmFiaWMiLAogIDB4MDZjMSwKICAiaGVoYXJhYmljIiwKICAweDA2NDcsCiAgImhlaGVicmV3IiwKICAweDA1ZDQsCiAgImhlaGZpbmFsYWx0b25lYXJhYmljIiwKICAweGZiYTcsCiAgImhlaGZpbmFsYWx0dHdvYXJhYmljIiwKICAweGZlZWEsCiAgImhlaGZpbmFsYXJhYmljIiwKICAweGZlZWEsCiAgImhlaGhhbXphYWJvdmVmaW5hbGFyYWJpYyIsCiAgMHhmYmE1LAogICJoZWhoYW16YWFib3ZlaXNvbGF0ZWRhcmFiaWMiLAogIDB4ZmJhNCwKICAiaGVoaW5pdGlhbGFsdG9uZWFyYWJpYyIsCiAgMHhmYmE4LAogICJoZWhpbml0aWFsYXJhYmljIiwKICAweGZlZWIsCiAgImhlaGlyYWdhbmEiLAogIDB4MzA3OCwKICAiaGVobWVkaWFsYWx0b25lYXJhYmljIiwKICAweGZiYTksCiAgImhlaG1lZGlhbGFyYWJpYyIsCiAgMHhmZWVjLAogICJoZWlzZWllcmFzcXVhcmUiLAogIDB4MzM3YiwKICAiaGVrYXRha2FuYSIsCiAgMHgzMGQ4LAogICJoZWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOGQsCiAgImhla3V0YWFydXNxdWFyZSIsCiAgMHgzMzM2LAogICJoZW5naG9vayIsCiAgMHgwMjY3LAogICJoZXJ1dHVzcXVhcmUiLAogIDB4MzMzOSwKICAiaGV0IiwKICAweDA1ZDcsCiAgImhldGhlYnJldyIsCiAgMHgwNWQ3LAogICJoaG9vayIsCiAgMHgwMjY2LAogICJoaG9va3N1cGVyaW9yIiwKICAweDAyYjEsCiAgImhpZXVoYWNpcmNsZWtvcmVhbiIsCiAgMHgzMjdiLAogICJoaWV1aGFwYXJlbmtvcmVhbiIsCiAgMHgzMjFiLAogICJoaWV1aGNpcmNsZWtvcmVhbiIsCiAgMHgzMjZkLAogICJoaWV1aGtvcmVhbiIsCiAgMHgzMTRlLAogICJoaWV1aHBhcmVua29yZWFuIiwKICAweDMyMGQsCiAgImhpaGlyYWdhbmEiLAogIDB4MzA3MiwKICAiaGlrYXRha2FuYSIsCiAgMHgzMGQyLAogICJoaWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOGIsCiAgImhpcmlxIiwKICAweDA1YjQsCiAgImhpcmlxMTQiLAogIDB4MDViNCwKICAiaGlyaXEyMSIsCiAgMHgwNWI0LAogICJoaXJpcTJkIiwKICAweDA1YjQsCiAgImhpcmlxaGVicmV3IiwKICAweDA1YjQsCiAgImhpcmlxbmFycm93aGVicmV3IiwKICAweDA1YjQsCiAgImhpcmlxcXVhcnRlcmhlYnJldyIsCiAgMHgwNWI0LAogICJoaXJpcXdpZGVoZWJyZXciLAogIDB4MDViNCwKICAiaGxpbmViZWxvdyIsCiAgMHgxZTk2LAogICJobW9ub3NwYWNlIiwKICAweGZmNDgsCiAgImhvYXJtZW5pYW4iLAogIDB4MDU3MCwKICAiaG9oaXB0aGFpIiwKICAweDBlMmIsCiAgImhvaGlyYWdhbmEiLAogIDB4MzA3YiwKICAiaG9rYXRha2FuYSIsCiAgMHgzMGRiLAogICJob2thdGFrYW5haGFsZndpZHRoIiwKICAweGZmOGUsCiAgImhvbGFtIiwKICAweDA1YjksCiAgImhvbGFtMTkiLAogIDB4MDViOSwKICAiaG9sYW0yNiIsCiAgMHgwNWI5LAogICJob2xhbTMyIiwKICAweDA1YjksCiAgImhvbGFtaGVicmV3IiwKICAweDA1YjksCiAgImhvbGFtbmFycm93aGVicmV3IiwKICAweDA1YjksCiAgImhvbGFtcXVhcnRlcmhlYnJldyIsCiAgMHgwNWI5LAogICJob2xhbXdpZGVoZWJyZXciLAogIDB4MDViOSwKICAiaG9ub2todWt0aGFpIiwKICAweDBlMmUsCiAgImhvb2thYm92ZWNvbWIiLAogIDB4MDMwOSwKICAiaG9va2NtYiIsCiAgMHgwMzA5LAogICJob29rcGFsYXRhbGl6ZWRiZWxvd2NtYiIsCiAgMHgwMzIxLAogICJob29rcmV0cm9mbGV4YmVsb3djbWIiLAogIDB4MDMyMiwKICAiaG9vbnNxdWFyZSIsCiAgMHgzMzQyLAogICJob3JpY29wdGljIiwKICAweDAzZTksCiAgImhvcml6b250YWxiYXIiLAogIDB4MjAxNSwKICAiaG9ybmNtYiIsCiAgMHgwMzFiLAogICJob3RzcHJpbmdzIiwKICAweDI2NjgsCiAgImhvdXNlIiwKICAweDIzMDIsCiAgImhwYXJlbiIsCiAgMHgyNGEzLAogICJoc3VwZXJpb3IiLAogIDB4MDJiMCwKICAiaHR1cm5lZCIsCiAgMHgwMjY1LAogICJodWhpcmFnYW5hIiwKICAweDMwNzUsCiAgImh1aWl0b3NxdWFyZSIsCiAgMHgzMzMzLAogICJodWthdGFrYW5hIiwKICAweDMwZDUsCiAgImh1a2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4YywKICAiaHVuZ2FydW1sYXV0IiwKICAweDAyZGQsCiAgImh1bmdhcnVtbGF1dGNtYiIsCiAgMHgwMzBiLAogICJodiIsCiAgMHgwMTk1LAogICJoeXBoZW4iLAogIDB4MDAyZCwKICAiaHlwaGVuaW5mZXJpb3IiLAogIDB4ZjZlNSwKICAiaHlwaGVubW9ub3NwYWNlIiwKICAweGZmMGQsCiAgImh5cGhlbnNtYWxsIiwKICAweGZlNjMsCiAgImh5cGhlbnN1cGVyaW9yIiwKICAweGY2ZTYsCiAgImh5cGhlbnR3byIsCiAgMHgyMDEwLAogICJpIiwKICAweDAwNjksCiAgImlhY3V0ZSIsCiAgMHgwMGVkLAogICJpYWN5cmlsbGljIiwKICAweDA0NGYsCiAgImliZW5nYWxpIiwKICAweDA5ODcsCiAgImlib3BvbW9mbyIsCiAgMHgzMTI3LAogICJpYnJldmUiLAogIDB4MDEyZCwKICAiaWNhcm9uIiwKICAweDAxZDAsCiAgImljaXJjbGUiLAogIDB4MjRkOCwKICAiaWNpcmN1bWZsZXgiLAogIDB4MDBlZSwKICAiaWN5cmlsbGljIiwKICAweDA0NTYsCiAgImlkYmxncmF2ZSIsCiAgMHgwMjA5LAogICJpZGVvZ3JhcGhlYXJ0aGNpcmNsZSIsCiAgMHgzMjhmLAogICJpZGVvZ3JhcGhmaXJlY2lyY2xlIiwKICAweDMyOGIsCiAgImlkZW9ncmFwaGljYWxsaWFuY2VwYXJlbiIsCiAgMHgzMjNmLAogICJpZGVvZ3JhcGhpY2NhbGxwYXJlbiIsCiAgMHgzMjNhLAogICJpZGVvZ3JhcGhpY2NlbnRyZWNpcmNsZSIsCiAgMHgzMmE1LAogICJpZGVvZ3JhcGhpY2Nsb3NlIiwKICAweDMwMDYsCiAgImlkZW9ncmFwaGljY29tbWEiLAogIDB4MzAwMSwKICAiaWRlb2dyYXBoaWNjb21tYWxlZnQiLAogIDB4ZmY2NCwKICAiaWRlb2dyYXBoaWNjb25ncmF0dWxhdGlvbnBhcmVuIiwKICAweDMyMzcsCiAgImlkZW9ncmFwaGljY29ycmVjdGNpcmNsZSIsCiAgMHgzMmEzLAogICJpZGVvZ3JhcGhpY2VhcnRocGFyZW4iLAogIDB4MzIyZiwKICAiaWRlb2dyYXBoaWNlbnRlcnByaXNlcGFyZW4iLAogIDB4MzIzZCwKICAiaWRlb2dyYXBoaWNleGNlbGxlbnRjaXJjbGUiLAogIDB4MzI5ZCwKICAiaWRlb2dyYXBoaWNmZXN0aXZhbHBhcmVuIiwKICAweDMyNDAsCiAgImlkZW9ncmFwaGljZmluYW5jaWFsY2lyY2xlIiwKICAweDMyOTYsCiAgImlkZW9ncmFwaGljZmluYW5jaWFscGFyZW4iLAogIDB4MzIzNiwKICAiaWRlb2dyYXBoaWNmaXJlcGFyZW4iLAogIDB4MzIyYiwKICAiaWRlb2dyYXBoaWNoYXZlcGFyZW4iLAogIDB4MzIzMiwKICAiaWRlb2dyYXBoaWNoaWdoY2lyY2xlIiwKICAweDMyYTQsCiAgImlkZW9ncmFwaGljaXRlcmF0aW9ubWFyayIsCiAgMHgzMDA1LAogICJpZGVvZ3JhcGhpY2xhYm9yY2lyY2xlIiwKICAweDMyOTgsCiAgImlkZW9ncmFwaGljbGFib3JwYXJlbiIsCiAgMHgzMjM4LAogICJpZGVvZ3JhcGhpY2xlZnRjaXJjbGUiLAogIDB4MzJhNywKICAiaWRlb2dyYXBoaWNsb3djaXJjbGUiLAogIDB4MzJhNiwKICAiaWRlb2dyYXBoaWNtZWRpY2luZWNpcmNsZSIsCiAgMHgzMmE5LAogICJpZGVvZ3JhcGhpY21ldGFscGFyZW4iLAogIDB4MzIyZSwKICAiaWRlb2dyYXBoaWNtb29ucGFyZW4iLAogIDB4MzIyYSwKICAiaWRlb2dyYXBoaWNuYW1lcGFyZW4iLAogIDB4MzIzNCwKICAiaWRlb2dyYXBoaWNwZXJpb2QiLAogIDB4MzAwMiwKICAiaWRlb2dyYXBoaWNwcmludGNpcmNsZSIsCiAgMHgzMjllLAogICJpZGVvZ3JhcGhpY3JlYWNocGFyZW4iLAogIDB4MzI0MywKICAiaWRlb2dyYXBoaWNyZXByZXNlbnRwYXJlbiIsCiAgMHgzMjM5LAogICJpZGVvZ3JhcGhpY3Jlc291cmNlcGFyZW4iLAogIDB4MzIzZSwKICAiaWRlb2dyYXBoaWNyaWdodGNpcmNsZSIsCiAgMHgzMmE4LAogICJpZGVvZ3JhcGhpY3NlY3JldGNpcmNsZSIsCiAgMHgzMjk5LAogICJpZGVvZ3JhcGhpY3NlbGZwYXJlbiIsCiAgMHgzMjQyLAogICJpZGVvZ3JhcGhpY3NvY2lldHlwYXJlbiIsCiAgMHgzMjMzLAogICJpZGVvZ3JhcGhpY3NwYWNlIiwKICAweDMwMDAsCiAgImlkZW9ncmFwaGljc3BlY2lhbHBhcmVuIiwKICAweDMyMzUsCiAgImlkZW9ncmFwaGljc3RvY2twYXJlbiIsCiAgMHgzMjMxLAogICJpZGVvZ3JhcGhpY3N0dWR5cGFyZW4iLAogIDB4MzIzYiwKICAiaWRlb2dyYXBoaWNzdW5wYXJlbiIsCiAgMHgzMjMwLAogICJpZGVvZ3JhcGhpY3N1cGVydmlzZXBhcmVuIiwKICAweDMyM2MsCiAgImlkZW9ncmFwaGljd2F0ZXJwYXJlbiIsCiAgMHgzMjJjLAogICJpZGVvZ3JhcGhpY3dvb2RwYXJlbiIsCiAgMHgzMjJkLAogICJpZGVvZ3JhcGhpY3plcm8iLAogIDB4MzAwNywKICAiaWRlb2dyYXBobWV0YWxjaXJjbGUiLAogIDB4MzI4ZSwKICAiaWRlb2dyYXBobW9vbmNpcmNsZSIsCiAgMHgzMjhhLAogICJpZGVvZ3JhcGhuYW1lY2lyY2xlIiwKICAweDMyOTQsCiAgImlkZW9ncmFwaHN1bmNpcmNsZSIsCiAgMHgzMjkwLAogICJpZGVvZ3JhcGh3YXRlcmNpcmNsZSIsCiAgMHgzMjhjLAogICJpZGVvZ3JhcGh3b29kY2lyY2xlIiwKICAweDMyOGQsCiAgImlkZXZhIiwKICAweDA5MDcsCiAgImlkaWVyZXNpcyIsCiAgMHgwMGVmLAogICJpZGllcmVzaXNhY3V0ZSIsCiAgMHgxZTJmLAogICJpZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGU1LAogICJpZG90YmVsb3ciLAogIDB4MWVjYiwKICAiaWVicmV2ZWN5cmlsbGljIiwKICAweDA0ZDcsCiAgImllY3lyaWxsaWMiLAogIDB4MDQzNSwKICAiaWV1bmdhY2lyY2xla29yZWFuIiwKICAweDMyNzUsCiAgImlldW5nYXBhcmVua29yZWFuIiwKICAweDMyMTUsCiAgImlldW5nY2lyY2xla29yZWFuIiwKICAweDMyNjcsCiAgImlldW5na29yZWFuIiwKICAweDMxNDcsCiAgImlldW5ncGFyZW5rb3JlYW4iLAogIDB4MzIwNywKICAiaWdyYXZlIiwKICAweDAwZWMsCiAgImlndWphcmF0aSIsCiAgMHgwYTg3LAogICJpZ3VybXVraGkiLAogIDB4MGEwNywKICAiaWhpcmFnYW5hIiwKICAweDMwNDQsCiAgImlob29rYWJvdmUiLAogIDB4MWVjOSwKICAiaWliZW5nYWxpIiwKICAweDA5ODgsCiAgImlpY3lyaWxsaWMiLAogIDB4MDQzOCwKICAiaWlkZXZhIiwKICAweDA5MDgsCiAgImlpZ3VqYXJhdGkiLAogIDB4MGE4OCwKICAiaWlndXJtdWtoaSIsCiAgMHgwYTA4LAogICJpaW1hdHJhZ3VybXVraGkiLAogIDB4MGE0MCwKICAiaWludmVydGVkYnJldmUiLAogIDB4MDIwYiwKICAiaWlzaG9ydGN5cmlsbGljIiwKICAweDA0MzksCiAgImlpdm93ZWxzaWduYmVuZ2FsaSIsCiAgMHgwOWMwLAogICJpaXZvd2Vsc2lnbmRldmEiLAogIDB4MDk0MCwKICAiaWl2b3dlbHNpZ25ndWphcmF0aSIsCiAgMHgwYWMwLAogICJpaiIsCiAgMHgwMTMzLAogICJpa2F0YWthbmEiLAogIDB4MzBhNCwKICAiaWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNzIsCiAgImlrb3JlYW4iLAogIDB4MzE2MywKICAiaWxkZSIsCiAgMHgwMmRjLAogICJpbHV5aGVicmV3IiwKICAweDA1YWMsCiAgImltYWNyb24iLAogIDB4MDEyYiwKICAiaW1hY3JvbmN5cmlsbGljIiwKICAweDA0ZTMsCiAgImltYWdlb3JhcHByb3hpbWF0ZWx5ZXF1YWwiLAogIDB4MjI1MywKICAiaW1hdHJhZ3VybXVraGkiLAogIDB4MGEzZiwKICAiaW1vbm9zcGFjZSIsCiAgMHhmZjQ5LAogICJpbmNyZW1lbnQiLAogIDB4MjIwNiwKICAiaW5maW5pdHkiLAogIDB4MjIxZSwKICAiaW5pYXJtZW5pYW4iLAogIDB4MDU2YiwKICAiaW50ZWdyYWwiLAogIDB4MjIyYiwKICAiaW50ZWdyYWxib3R0b20iLAogIDB4MjMyMSwKICAiaW50ZWdyYWxidCIsCiAgMHgyMzIxLAogICJpbnRlZ3JhbGV4IiwKICAweGY4ZjUsCiAgImludGVncmFsdG9wIiwKICAweDIzMjAsCiAgImludGVncmFsdHAiLAogIDB4MjMyMCwKICAiaW50ZXJzZWN0aW9uIiwKICAweDIyMjksCiAgImludGlzcXVhcmUiLAogIDB4MzMwNSwKICAiaW52YnVsbGV0IiwKICAweDI1ZDgsCiAgImludmNpcmNsZSIsCiAgMHgyNWQ5LAogICJpbnZzbWlsZWZhY2UiLAogIDB4MjYzYiwKICAiaW9jeXJpbGxpYyIsCiAgMHgwNDUxLAogICJpb2dvbmVrIiwKICAweDAxMmYsCiAgImlvdGEiLAogIDB4MDNiOSwKICAiaW90YWRpZXJlc2lzIiwKICAweDAzY2EsCiAgImlvdGFkaWVyZXNpc3Rvbm9zIiwKICAweDAzOTAsCiAgImlvdGFsYXRpbiIsCiAgMHgwMjY5LAogICJpb3RhdG9ub3MiLAogIDB4MDNhZiwKICAiaXBhcmVuIiwKICAweDI0YTQsCiAgImlyaWd1cm11a2hpIiwKICAweDBhNzIsCiAgImlzbWFsbGhpcmFnYW5hIiwKICAweDMwNDMsCiAgImlzbWFsbGthdGFrYW5hIiwKICAweDMwYTMsCiAgImlzbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNjgsCiAgImlzc2hhcmJlbmdhbGkiLAogIDB4MDlmYSwKICAiaXN0cm9rZSIsCiAgMHgwMjY4LAogICJpc3VwZXJpb3IiLAogIDB4ZjZlZCwKICAiaXRlcmF0aW9uaGlyYWdhbmEiLAogIDB4MzA5ZCwKICAiaXRlcmF0aW9ua2F0YWthbmEiLAogIDB4MzBmZCwKICAiaXRpbGRlIiwKICAweDAxMjksCiAgIml0aWxkZWJlbG93IiwKICAweDFlMmQsCiAgIml1Ym9wb21vZm8iLAogIDB4MzEyOSwKICAiaXVjeXJpbGxpYyIsCiAgMHgwNDRlLAogICJpdm93ZWxzaWduYmVuZ2FsaSIsCiAgMHgwOWJmLAogICJpdm93ZWxzaWduZGV2YSIsCiAgMHgwOTNmLAogICJpdm93ZWxzaWduZ3VqYXJhdGkiLAogIDB4MGFiZiwKICAiaXpoaXRzYWN5cmlsbGljIiwKICAweDA0NzUsCiAgIml6aGl0c2FkYmxncmF2ZWN5cmlsbGljIiwKICAweDA0NzcsCiAgImoiLAogIDB4MDA2YSwKICAiamFhcm1lbmlhbiIsCiAgMHgwNTcxLAogICJqYWJlbmdhbGkiLAogIDB4MDk5YywKICAiamFkZXZhIiwKICAweDA5MWMsCiAgImphZ3VqYXJhdGkiLAogIDB4MGE5YywKICAiamFndXJtdWtoaSIsCiAgMHgwYTFjLAogICJqYm9wb21vZm8iLAogIDB4MzExMCwKICAiamNhcm9uIiwKICAweDAxZjAsCiAgImpjaXJjbGUiLAogIDB4MjRkOSwKICAiamNpcmN1bWZsZXgiLAogIDB4MDEzNSwKICAiamNyb3NzZWR0YWlsIiwKICAweDAyOWQsCiAgImpkb3RsZXNzc3Ryb2tlIiwKICAweDAyNWYsCiAgImplY3lyaWxsaWMiLAogIDB4MDQ1OCwKICAiamVlbWFyYWJpYyIsCiAgMHgwNjJjLAogICJqZWVtZmluYWxhcmFiaWMiLAogIDB4ZmU5ZSwKICAiamVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmU5ZiwKICAiamVlbW1lZGlhbGFyYWJpYyIsCiAgMHhmZWEwLAogICJqZWhhcmFiaWMiLAogIDB4MDY5OCwKICAiamVoZmluYWxhcmFiaWMiLAogIDB4ZmI4YiwKICAiamhhYmVuZ2FsaSIsCiAgMHgwOTlkLAogICJqaGFkZXZhIiwKICAweDA5MWQsCiAgImpoYWd1amFyYXRpIiwKICAweDBhOWQsCiAgImpoYWd1cm11a2hpIiwKICAweDBhMWQsCiAgImpoZWhhcm1lbmlhbiIsCiAgMHgwNTdiLAogICJqaXMiLAogIDB4MzAwNCwKICAiam1vbm9zcGFjZSIsCiAgMHhmZjRhLAogICJqcGFyZW4iLAogIDB4MjRhNSwKICAianN1cGVyaW9yIiwKICAweDAyYjIsCiAgImsiLAogIDB4MDA2YiwKICAia2FiYXNoa2lyY3lyaWxsaWMiLAogIDB4MDRhMSwKICAia2FiZW5nYWxpIiwKICAweDA5OTUsCiAgImthY3V0ZSIsCiAgMHgxZTMxLAogICJrYWN5cmlsbGljIiwKICAweDA0M2EsCiAgImthZGVzY2VuZGVyY3lyaWxsaWMiLAogIDB4MDQ5YiwKICAia2FkZXZhIiwKICAweDA5MTUsCiAgImthZiIsCiAgMHgwNWRiLAogICJrYWZhcmFiaWMiLAogIDB4MDY0MywKICAia2FmZGFnZXNoIiwKICAweGZiM2IsCiAgImthZmRhZ2VzaGhlYnJldyIsCiAgMHhmYjNiLAogICJrYWZmaW5hbGFyYWJpYyIsCiAgMHhmZWRhLAogICJrYWZoZWJyZXciLAogIDB4MDVkYiwKICAia2FmaW5pdGlhbGFyYWJpYyIsCiAgMHhmZWRiLAogICJrYWZtZWRpYWxhcmFiaWMiLAogIDB4ZmVkYywKICAia2FmcmFmZWhlYnJldyIsCiAgMHhmYjRkLAogICJrYWd1amFyYXRpIiwKICAweDBhOTUsCiAgImthZ3VybXVraGkiLAogIDB4MGExNSwKICAia2FoaXJhZ2FuYSIsCiAgMHgzMDRiLAogICJrYWhvb2tjeXJpbGxpYyIsCiAgMHgwNGM0LAogICJrYWthdGFrYW5hIiwKICAweDMwYWIsCiAgImtha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3NiwKICAia2FwcGEiLAogIDB4MDNiYSwKICAia2FwcGFzeW1ib2xncmVlayIsCiAgMHgwM2YwLAogICJrYXB5ZW91bm1pZXVta29yZWFuIiwKICAweDMxNzEsCiAgImthcHllb3VucGhpZXVwaGtvcmVhbiIsCiAgMHgzMTg0LAogICJrYXB5ZW91bnBpZXVwa29yZWFuIiwKICAweDMxNzgsCiAgImthcHllb3Vuc3NhbmdwaWV1cGtvcmVhbiIsCiAgMHgzMTc5LAogICJrYXJvcmlpc3F1YXJlIiwKICAweDMzMGQsCiAgImthc2hpZGFhdXRvYXJhYmljIiwKICAweDA2NDAsCiAgImthc2hpZGFhdXRvbm9zaWRlYmVhcmluZ2FyYWJpYyIsCiAgMHgwNjQwLAogICJrYXNtYWxsa2F0YWthbmEiLAogIDB4MzBmNSwKICAia2FzcXVhcmUiLAogIDB4MzM4NCwKICAia2FzcmFhcmFiaWMiLAogIDB4MDY1MCwKICAia2FzcmF0YW5hcmFiaWMiLAogIDB4MDY0ZCwKICAia2FzdHJva2VjeXJpbGxpYyIsCiAgMHgwNDlmLAogICJrYXRhaGlyYXByb2xvbmdtYXJraGFsZndpZHRoIiwKICAweGZmNzAsCiAgImthdmVydGljYWxzdHJva2VjeXJpbGxpYyIsCiAgMHgwNDlkLAogICJrYm9wb21vZm8iLAogIDB4MzEwZSwKICAia2NhbHNxdWFyZSIsCiAgMHgzMzg5LAogICJrY2Fyb24iLAogIDB4MDFlOSwKICAia2NlZGlsbGEiLAogIDB4MDEzNywKICAia2NpcmNsZSIsCiAgMHgyNGRhLAogICJrY29tbWFhY2NlbnQiLAogIDB4MDEzNywKICAia2RvdGJlbG93IiwKICAweDFlMzMsCiAgImtlaGFybWVuaWFuIiwKICAweDA1ODQsCiAgImtlaGlyYWdhbmEiLAogIDB4MzA1MSwKICAia2VrYXRha2FuYSIsCiAgMHgzMGIxLAogICJrZWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNzksCiAgImtlbmFybWVuaWFuIiwKICAweDA1NmYsCiAgImtlc21hbGxrYXRha2FuYSIsCiAgMHgzMGY2LAogICJrZ3JlZW5sYW5kaWMiLAogIDB4MDEzOCwKICAia2hhYmVuZ2FsaSIsCiAgMHgwOTk2LAogICJraGFjeXJpbGxpYyIsCiAgMHgwNDQ1LAogICJraGFkZXZhIiwKICAweDA5MTYsCiAgImtoYWd1amFyYXRpIiwKICAweDBhOTYsCiAgImtoYWd1cm11a2hpIiwKICAweDBhMTYsCiAgImtoYWhhcmFiaWMiLAogIDB4MDYyZSwKICAia2hhaGZpbmFsYXJhYmljIiwKICAweGZlYTYsCiAgImtoYWhpbml0aWFsYXJhYmljIiwKICAweGZlYTcsCiAgImtoYWhtZWRpYWxhcmFiaWMiLAogIDB4ZmVhOCwKICAia2hlaWNvcHRpYyIsCiAgMHgwM2U3LAogICJraGhhZGV2YSIsCiAgMHgwOTU5LAogICJraGhhZ3VybXVraGkiLAogIDB4MGE1OSwKICAia2hpZXVraGFjaXJjbGVrb3JlYW4iLAogIDB4MzI3OCwKICAia2hpZXVraGFwYXJlbmtvcmVhbiIsCiAgMHgzMjE4LAogICJraGlldWtoY2lyY2xla29yZWFuIiwKICAweDMyNmEsCiAgImtoaWV1a2hrb3JlYW4iLAogIDB4MzE0YiwKICAia2hpZXVraHBhcmVua29yZWFuIiwKICAweDMyMGEsCiAgImtob2toYWl0aGFpIiwKICAweDBlMDIsCiAgImtob2tob250aGFpIiwKICAweDBlMDUsCiAgImtob2todWF0dGhhaSIsCiAgMHgwZTAzLAogICJraG9raHdhaXRoYWkiLAogIDB4MGUwNCwKICAia2hvbXV0dGhhaSIsCiAgMHgwZTViLAogICJraG9vayIsCiAgMHgwMTk5LAogICJraG9yYWtoYW5ndGhhaSIsCiAgMHgwZTA2LAogICJraHpzcXVhcmUiLAogIDB4MzM5MSwKICAia2loaXJhZ2FuYSIsCiAgMHgzMDRkLAogICJraWthdGFrYW5hIiwKICAweDMwYWQsCiAgImtpa2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3NywKICAia2lyb2d1cmFtdXNxdWFyZSIsCiAgMHgzMzE1LAogICJraXJvbWVldG9ydXNxdWFyZSIsCiAgMHgzMzE2LAogICJraXJvc3F1YXJlIiwKICAweDMzMTQsCiAgImtpeWVva2FjaXJjbGVrb3JlYW4iLAogIDB4MzI2ZSwKICAia2l5ZW9rYXBhcmVua29yZWFuIiwKICAweDMyMGUsCiAgImtpeWVva2NpcmNsZWtvcmVhbiIsCiAgMHgzMjYwLAogICJraXllb2trb3JlYW4iLAogIDB4MzEzMSwKICAia2l5ZW9rcGFyZW5rb3JlYW4iLAogIDB4MzIwMCwKICAia2l5ZW9rc2lvc2tvcmVhbiIsCiAgMHgzMTMzLAogICJramVjeXJpbGxpYyIsCiAgMHgwNDVjLAogICJrbGluZWJlbG93IiwKICAweDFlMzUsCiAgImtsc3F1YXJlIiwKICAweDMzOTgsCiAgImttY3ViZWRzcXVhcmUiLAogIDB4MzNhNiwKICAia21vbm9zcGFjZSIsCiAgMHhmZjRiLAogICJrbXNxdWFyZWRzcXVhcmUiLAogIDB4MzNhMiwKICAia29oaXJhZ2FuYSIsCiAgMHgzMDUzLAogICJrb2htc3F1YXJlIiwKICAweDMzYzAsCiAgImtva2FpdGhhaSIsCiAgMHgwZTAxLAogICJrb2thdGFrYW5hIiwKICAweDMwYjMsCiAgImtva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3YSwKICAia29vcG9zcXVhcmUiLAogIDB4MzMxZSwKICAia29wcGFjeXJpbGxpYyIsCiAgMHgwNDgxLAogICJrb3JlYW5zdGFuZGFyZHN5bWJvbCIsCiAgMHgzMjdmLAogICJrb3JvbmlzY21iIiwKICAweDAzNDMsCiAgImtwYXJlbiIsCiAgMHgyNGE2LAogICJrcGFzcXVhcmUiLAogIDB4MzNhYSwKICAia3NpY3lyaWxsaWMiLAogIDB4MDQ2ZiwKICAia3RzcXVhcmUiLAogIDB4MzNjZiwKICAia3R1cm5lZCIsCiAgMHgwMjllLAogICJrdWhpcmFnYW5hIiwKICAweDMwNGYsCiAgImt1a2F0YWthbmEiLAogIDB4MzBhZiwKICAia3VrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjc4LAogICJrdnNxdWFyZSIsCiAgMHgzM2I4LAogICJrd3NxdWFyZSIsCiAgMHgzM2JlLAogICJsIiwKICAweDAwNmMsCiAgImxhYmVuZ2FsaSIsCiAgMHgwOWIyLAogICJsYWN1dGUiLAogIDB4MDEzYSwKICAibGFkZXZhIiwKICAweDA5MzIsCiAgImxhZ3VqYXJhdGkiLAogIDB4MGFiMiwKICAibGFndXJtdWtoaSIsCiAgMHgwYTMyLAogICJsYWtraGFuZ3lhb3RoYWkiLAogIDB4MGU0NSwKICAibGFtYWxlZmZpbmFsYXJhYmljIiwKICAweGZlZmMsCiAgImxhbWFsZWZoYW16YWFib3ZlZmluYWxhcmFiaWMiLAogIDB4ZmVmOCwKICAibGFtYWxlZmhhbXphYWJvdmVpc29sYXRlZGFyYWJpYyIsCiAgMHhmZWY3LAogICJsYW1hbGVmaGFtemFiZWxvd2ZpbmFsYXJhYmljIiwKICAweGZlZmEsCiAgImxhbWFsZWZoYW16YWJlbG93aXNvbGF0ZWRhcmFiaWMiLAogIDB4ZmVmOSwKICAibGFtYWxlZmlzb2xhdGVkYXJhYmljIiwKICAweGZlZmIsCiAgImxhbWFsZWZtYWRkYWFib3ZlZmluYWxhcmFiaWMiLAogIDB4ZmVmNiwKICAibGFtYWxlZm1hZGRhYWJvdmVpc29sYXRlZGFyYWJpYyIsCiAgMHhmZWY1LAogICJsYW1hcmFiaWMiLAogIDB4MDY0NCwKICAibGFtYmRhIiwKICAweDAzYmIsCiAgImxhbWJkYXN0cm9rZSIsCiAgMHgwMTliLAogICJsYW1lZCIsCiAgMHgwNWRjLAogICJsYW1lZGRhZ2VzaCIsCiAgMHhmYjNjLAogICJsYW1lZGRhZ2VzaGhlYnJldyIsCiAgMHhmYjNjLAogICJsYW1lZGhlYnJldyIsCiAgMHgwNWRjLAogICJsYW1maW5hbGFyYWJpYyIsCiAgMHhmZWRlLAogICJsYW1oYWhpbml0aWFsYXJhYmljIiwKICAweGZjY2EsCiAgImxhbWluaXRpYWxhcmFiaWMiLAogIDB4ZmVkZiwKICAibGFtamVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmNjOSwKICAibGFta2hhaGluaXRpYWxhcmFiaWMiLAogIDB4ZmNjYiwKICAibGFtbGFtaGVoaXNvbGF0ZWRhcmFiaWMiLAogIDB4ZmRmMiwKICAibGFtbWVkaWFsYXJhYmljIiwKICAweGZlZTAsCiAgImxhbW1lZW1oYWhpbml0aWFsYXJhYmljIiwKICAweGZkODgsCiAgImxhbW1lZW1pbml0aWFsYXJhYmljIiwKICAweGZjY2MsCiAgImxhcmdlY2lyY2xlIiwKICAweDI1ZWYsCiAgImxiYXIiLAogIDB4MDE5YSwKICAibGJlbHQiLAogIDB4MDI2YywKICAibGJvcG9tb2ZvIiwKICAweDMxMGMsCiAgImxjYXJvbiIsCiAgMHgwMTNlLAogICJsY2VkaWxsYSIsCiAgMHgwMTNjLAogICJsY2lyY2xlIiwKICAweDI0ZGIsCiAgImxjaXJjdW1mbGV4YmVsb3ciLAogIDB4MWUzZCwKICAibGNvbW1hYWNjZW50IiwKICAweDAxM2MsCiAgImxkb3QiLAogIDB4MDE0MCwKICAibGRvdGFjY2VudCIsCiAgMHgwMTQwLAogICJsZG90YmVsb3ciLAogIDB4MWUzNywKICAibGRvdGJlbG93bWFjcm9uIiwKICAweDFlMzksCiAgImxlZnRhbmdsZWFib3ZlY21iIiwKICAweDAzMWEsCiAgImxlZnR0YWNrYmVsb3djbWIiLAogIDB4MDMxOCwKICAibGVzcyIsCiAgMHgwMDNjLAogICJsZXNzZXF1YWwiLAogIDB4MjI2NCwKICAibGVzc2VxdWFsb3JncmVhdGVyIiwKICAweDIyZGEsCiAgImxlc3Ntb25vc3BhY2UiLAogIDB4ZmYxYywKICAibGVzc29yZXF1aXZhbGVudCIsCiAgMHgyMjcyLAogICJsZXNzb3JncmVhdGVyIiwKICAweDIyNzYsCiAgImxlc3NvdmVyZXF1YWwiLAogIDB4MjI2NiwKICAibGVzc3NtYWxsIiwKICAweGZlNjQsCiAgImxlemgiLAogIDB4MDI2ZSwKICAibGZibG9jayIsCiAgMHgyNThjLAogICJsaG9va3JldHJvZmxleCIsCiAgMHgwMjZkLAogICJsaXJhIiwKICAweDIwYTQsCiAgImxpd25hcm1lbmlhbiIsCiAgMHgwNTZjLAogICJsaiIsCiAgMHgwMWM5LAogICJsamVjeXJpbGxpYyIsCiAgMHgwNDU5LAogICJsbCIsCiAgMHhmNmMwLAogICJsbGFkZXZhIiwKICAweDA5MzMsCiAgImxsYWd1amFyYXRpIiwKICAweDBhYjMsCiAgImxsaW5lYmVsb3ciLAogIDB4MWUzYiwKICAibGxsYWRldmEiLAogIDB4MDkzNCwKICAibGx2b2NhbGljYmVuZ2FsaSIsCiAgMHgwOWUxLAogICJsbHZvY2FsaWNkZXZhIiwKICAweDA5NjEsCiAgImxsdm9jYWxpY3Zvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDllMywKICAibGx2b2NhbGljdm93ZWxzaWduZGV2YSIsCiAgMHgwOTYzLAogICJsbWlkZGxldGlsZGUiLAogIDB4MDI2YiwKICAibG1vbm9zcGFjZSIsCiAgMHhmZjRjLAogICJsbXNxdWFyZSIsCiAgMHgzM2QwLAogICJsb2NodWxhdGhhaSIsCiAgMHgwZTJjLAogICJsb2dpY2FsYW5kIiwKICAweDIyMjcsCiAgImxvZ2ljYWxub3QiLAogIDB4MDBhYywKICAibG9naWNhbG5vdHJldmVyc2VkIiwKICAweDIzMTAsCiAgImxvZ2ljYWxvciIsCiAgMHgyMjI4LAogICJsb2xpbmd0aGFpIiwKICAweDBlMjUsCiAgImxvbmdzIiwKICAweDAxN2YsCiAgImxvd2xpbmVjZW50ZXJsaW5lIiwKICAweGZlNGUsCiAgImxvd2xpbmVjbWIiLAogIDB4MDMzMiwKICAibG93bGluZWRhc2hlZCIsCiAgMHhmZTRkLAogICJsb3plbmdlIiwKICAweDI1Y2EsCiAgImxwYXJlbiIsCiAgMHgyNGE3LAogICJsc2xhc2giLAogIDB4MDE0MiwKICAibHNxdWFyZSIsCiAgMHgyMTEzLAogICJsc3VwZXJpb3IiLAogIDB4ZjZlZSwKICAibHRzaGFkZSIsCiAgMHgyNTkxLAogICJsdXRoYWkiLAogIDB4MGUyNiwKICAibHZvY2FsaWNiZW5nYWxpIiwKICAweDA5OGMsCiAgImx2b2NhbGljZGV2YSIsCiAgMHgwOTBjLAogICJsdm9jYWxpY3Zvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDllMiwKICAibHZvY2FsaWN2b3dlbHNpZ25kZXZhIiwKICAweDA5NjIsCiAgImx4c3F1YXJlIiwKICAweDMzZDMsCiAgIm0iLAogIDB4MDA2ZCwKICAibWFiZW5nYWxpIiwKICAweDA5YWUsCiAgIm1hY3JvbiIsCiAgMHgwMGFmLAogICJtYWNyb25iZWxvd2NtYiIsCiAgMHgwMzMxLAogICJtYWNyb25jbWIiLAogIDB4MDMwNCwKICAibWFjcm9ubG93bW9kIiwKICAweDAyY2QsCiAgIm1hY3Jvbm1vbm9zcGFjZSIsCiAgMHhmZmUzLAogICJtYWN1dGUiLAogIDB4MWUzZiwKICAibWFkZXZhIiwKICAweDA5MmUsCiAgIm1hZ3VqYXJhdGkiLAogIDB4MGFhZSwKICAibWFndXJtdWtoaSIsCiAgMHgwYTJlLAogICJtYWhhcGFraGhlYnJldyIsCiAgMHgwNWE0LAogICJtYWhhcGFraGxlZnRoZWJyZXciLAogIDB4MDVhNCwKICAibWFoaXJhZ2FuYSIsCiAgMHgzMDdlLAogICJtYWljaGF0dGF3YWxvd2xlZnR0aGFpIiwKICAweGY4OTUsCiAgIm1haWNoYXR0YXdhbG93cmlnaHR0aGFpIiwKICAweGY4OTQsCiAgIm1haWNoYXR0YXdhdGhhaSIsCiAgMHgwZTRiLAogICJtYWljaGF0dGF3YXVwcGVybGVmdHRoYWkiLAogIDB4Zjg5MywKICAibWFpZWtsb3dsZWZ0dGhhaSIsCiAgMHhmODhjLAogICJtYWlla2xvd3JpZ2h0dGhhaSIsCiAgMHhmODhiLAogICJtYWlla3RoYWkiLAogIDB4MGU0OCwKICAibWFpZWt1cHBlcmxlZnR0aGFpIiwKICAweGY4OGEsCiAgIm1haWhhbmFrYXRsZWZ0dGhhaSIsCiAgMHhmODg0LAogICJtYWloYW5ha2F0dGhhaSIsCiAgMHgwZTMxLAogICJtYWl0YWlraHVsZWZ0dGhhaSIsCiAgMHhmODg5LAogICJtYWl0YWlraHV0aGFpIiwKICAweDBlNDcsCiAgIm1haXRob2xvd2xlZnR0aGFpIiwKICAweGY4OGYsCiAgIm1haXRob2xvd3JpZ2h0dGhhaSIsCiAgMHhmODhlLAogICJtYWl0aG90aGFpIiwKICAweDBlNDksCiAgIm1haXRob3VwcGVybGVmdHRoYWkiLAogIDB4Zjg4ZCwKICAibWFpdHJpbG93bGVmdHRoYWkiLAogIDB4Zjg5MiwKICAibWFpdHJpbG93cmlnaHR0aGFpIiwKICAweGY4OTEsCiAgIm1haXRyaXRoYWkiLAogIDB4MGU0YSwKICAibWFpdHJpdXBwZXJsZWZ0dGhhaSIsCiAgMHhmODkwLAogICJtYWl5YW1va3RoYWkiLAogIDB4MGU0NiwKICAibWFrYXRha2FuYSIsCiAgMHgzMGRlLAogICJtYWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOGYsCiAgIm1hbGUiLAogIDB4MjY0MiwKICAibWFuc3lvbnNxdWFyZSIsCiAgMHgzMzQ3LAogICJtYXFhZmhlYnJldyIsCiAgMHgwNWJlLAogICJtYXJzIiwKICAweDI2NDIsCiAgIm1hc29yYWNpcmNsZWhlYnJldyIsCiAgMHgwNWFmLAogICJtYXNxdWFyZSIsCiAgMHgzMzgzLAogICJtYm9wb21vZm8iLAogIDB4MzEwNywKICAibWJzcXVhcmUiLAogIDB4MzNkNCwKICAibWNpcmNsZSIsCiAgMHgyNGRjLAogICJtY3ViZWRzcXVhcmUiLAogIDB4MzNhNSwKICAibWRvdGFjY2VudCIsCiAgMHgxZTQxLAogICJtZG90YmVsb3ciLAogIDB4MWU0MywKICAibWVlbWFyYWJpYyIsCiAgMHgwNjQ1LAogICJtZWVtZmluYWxhcmFiaWMiLAogIDB4ZmVlMiwKICAibWVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmVlMywKICAibWVlbW1lZGlhbGFyYWJpYyIsCiAgMHhmZWU0LAogICJtZWVtbWVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmNkMSwKICAibWVlbW1lZW1pc29sYXRlZGFyYWJpYyIsCiAgMHhmYzQ4LAogICJtZWV0b3J1c3F1YXJlIiwKICAweDMzNGQsCiAgIm1laGlyYWdhbmEiLAogIDB4MzA4MSwKICAibWVpemllcmFzcXVhcmUiLAogIDB4MzM3ZSwKICAibWVrYXRha2FuYSIsCiAgMHgzMGUxLAogICJtZWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOTIsCiAgIm1lbSIsCiAgMHgwNWRlLAogICJtZW1kYWdlc2giLAogIDB4ZmIzZSwKICAibWVtZGFnZXNoaGVicmV3IiwKICAweGZiM2UsCiAgIm1lbWhlYnJldyIsCiAgMHgwNWRlLAogICJtZW5hcm1lbmlhbiIsCiAgMHgwNTc0LAogICJtZXJraGFoZWJyZXciLAogIDB4MDVhNSwKICAibWVya2hha2VmdWxhaGVicmV3IiwKICAweDA1YTYsCiAgIm1lcmtoYWtlZnVsYWxlZnRoZWJyZXciLAogIDB4MDVhNiwKICAibWVya2hhbGVmdGhlYnJldyIsCiAgMHgwNWE1LAogICJtaG9vayIsCiAgMHgwMjcxLAogICJtaHpzcXVhcmUiLAogIDB4MzM5MiwKICAibWlkZGxlZG90a2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY2NSwKICAibWlkZG90IiwKICAweDAwYjcsCiAgIm1pZXVtYWNpcmNsZWtvcmVhbiIsCiAgMHgzMjcyLAogICJtaWV1bWFwYXJlbmtvcmVhbiIsCiAgMHgzMjEyLAogICJtaWV1bWNpcmNsZWtvcmVhbiIsCiAgMHgzMjY0LAogICJtaWV1bWtvcmVhbiIsCiAgMHgzMTQxLAogICJtaWV1bXBhbnNpb3Nrb3JlYW4iLAogIDB4MzE3MCwKICAibWlldW1wYXJlbmtvcmVhbiIsCiAgMHgzMjA0LAogICJtaWV1bXBpZXVwa29yZWFuIiwKICAweDMxNmUsCiAgIm1pZXVtc2lvc2tvcmVhbiIsCiAgMHgzMTZmLAogICJtaWhpcmFnYW5hIiwKICAweDMwN2YsCiAgIm1pa2F0YWthbmEiLAogIDB4MzBkZiwKICAibWlrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjkwLAogICJtaW51cyIsCiAgMHgyMjEyLAogICJtaW51c2JlbG93Y21iIiwKICAweDAzMjAsCiAgIm1pbnVzY2lyY2xlIiwKICAweDIyOTYsCiAgIm1pbnVzbW9kIiwKICAweDAyZDcsCiAgIm1pbnVzcGx1cyIsCiAgMHgyMjEzLAogICJtaW51dGUiLAogIDB4MjAzMiwKICAibWlyaWJhYXJ1c3F1YXJlIiwKICAweDMzNGEsCiAgIm1pcmlzcXVhcmUiLAogIDB4MzM0OSwKICAibWxvbmdsZWd0dXJuZWQiLAogIDB4MDI3MCwKICAibWxzcXVhcmUiLAogIDB4MzM5NiwKICAibW1jdWJlZHNxdWFyZSIsCiAgMHgzM2EzLAogICJtbW9ub3NwYWNlIiwKICAweGZmNGQsCiAgIm1tc3F1YXJlZHNxdWFyZSIsCiAgMHgzMzlmLAogICJtb2hpcmFnYW5hIiwKICAweDMwODIsCiAgIm1vaG1zcXVhcmUiLAogIDB4MzNjMSwKICAibW9rYXRha2FuYSIsCiAgMHgzMGUyLAogICJtb2thdGFrYW5haGFsZndpZHRoIiwKICAweGZmOTMsCiAgIm1vbHNxdWFyZSIsCiAgMHgzM2Q2LAogICJtb21hdGhhaSIsCiAgMHgwZTIxLAogICJtb3ZlcnNzcXVhcmUiLAogIDB4MzNhNywKICAibW92ZXJzc3F1YXJlZHNxdWFyZSIsCiAgMHgzM2E4LAogICJtcGFyZW4iLAogIDB4MjRhOCwKICAibXBhc3F1YXJlIiwKICAweDMzYWIsCiAgIm1zc3F1YXJlIiwKICAweDMzYjMsCiAgIm1zdXBlcmlvciIsCiAgMHhmNmVmLAogICJtdHVybmVkIiwKICAweDAyNmYsCiAgIm11IiwKICAweDAwYjUsCiAgIm11MSIsCiAgMHgwMGI1LAogICJtdWFzcXVhcmUiLAogIDB4MzM4MiwKICAibXVjaGdyZWF0ZXIiLAogIDB4MjI2YiwKICAibXVjaGxlc3MiLAogIDB4MjI2YSwKICAibXVmc3F1YXJlIiwKICAweDMzOGMsCiAgIm11Z3JlZWsiLAogIDB4MDNiYywKICAibXVnc3F1YXJlIiwKICAweDMzOGQsCiAgIm11aGlyYWdhbmEiLAogIDB4MzA4MCwKICAibXVrYXRha2FuYSIsCiAgMHgzMGUwLAogICJtdWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOTEsCiAgIm11bHNxdWFyZSIsCiAgMHgzMzk1LAogICJtdWx0aXBseSIsCiAgMHgwMGQ3LAogICJtdW1zcXVhcmUiLAogIDB4MzM5YiwKICAibXVuYWhoZWJyZXciLAogIDB4MDVhMywKICAibXVuYWhsZWZ0aGVicmV3IiwKICAweDA1YTMsCiAgIm11c2ljYWxub3RlIiwKICAweDI2NmEsCiAgIm11c2ljYWxub3RlZGJsIiwKICAweDI2NmIsCiAgIm11c2ljZmxhdHNpZ24iLAogIDB4MjY2ZCwKICAibXVzaWNzaGFycHNpZ24iLAogIDB4MjY2ZiwKICAibXVzc3F1YXJlIiwKICAweDMzYjIsCiAgIm11dnNxdWFyZSIsCiAgMHgzM2I2LAogICJtdXdzcXVhcmUiLAogIDB4MzNiYywKICAibXZtZWdhc3F1YXJlIiwKICAweDMzYjksCiAgIm12c3F1YXJlIiwKICAweDMzYjcsCiAgIm13bWVnYXNxdWFyZSIsCiAgMHgzM2JmLAogICJtd3NxdWFyZSIsCiAgMHgzM2JkLAogICJuIiwKICAweDAwNmUsCiAgIm5hYmVuZ2FsaSIsCiAgMHgwOWE4LAogICJuYWJsYSIsCiAgMHgyMjA3LAogICJuYWN1dGUiLAogIDB4MDE0NCwKICAibmFkZXZhIiwKICAweDA5MjgsCiAgIm5hZ3VqYXJhdGkiLAogIDB4MGFhOCwKICAibmFndXJtdWtoaSIsCiAgMHgwYTI4LAogICJuYWhpcmFnYW5hIiwKICAweDMwNmEsCiAgIm5ha2F0YWthbmEiLAogIDB4MzBjYSwKICAibmFrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjg1LAogICJuYXBvc3Ryb3BoZSIsCiAgMHgwMTQ5LAogICJuYXNxdWFyZSIsCiAgMHgzMzgxLAogICJuYm9wb21vZm8iLAogIDB4MzEwYiwKICAibmJzcGFjZSIsCiAgMHgwMGEwLAogICJuY2Fyb24iLAogIDB4MDE0OCwKICAibmNlZGlsbGEiLAogIDB4MDE0NiwKICAibmNpcmNsZSIsCiAgMHgyNGRkLAogICJuY2lyY3VtZmxleGJlbG93IiwKICAweDFlNGIsCiAgIm5jb21tYWFjY2VudCIsCiAgMHgwMTQ2LAogICJuZG90YWNjZW50IiwKICAweDFlNDUsCiAgIm5kb3RiZWxvdyIsCiAgMHgxZTQ3LAogICJuZWhpcmFnYW5hIiwKICAweDMwNmQsCiAgIm5la2F0YWthbmEiLAogIDB4MzBjZCwKICAibmVrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjg4LAogICJuZXdzaGVxZWxzaWduIiwKICAweDIwYWEsCiAgIm5mc3F1YXJlIiwKICAweDMzOGIsCiAgIm5nYWJlbmdhbGkiLAogIDB4MDk5OSwKICAibmdhZGV2YSIsCiAgMHgwOTE5LAogICJuZ2FndWphcmF0aSIsCiAgMHgwYTk5LAogICJuZ2FndXJtdWtoaSIsCiAgMHgwYTE5LAogICJuZ29uZ3V0aGFpIiwKICAweDBlMDcsCiAgIm5oaXJhZ2FuYSIsCiAgMHgzMDkzLAogICJuaG9va2xlZnQiLAogIDB4MDI3MiwKICAibmhvb2tyZXRyb2ZsZXgiLAogIDB4MDI3MywKICAibmlldW5hY2lyY2xla29yZWFuIiwKICAweDMyNmYsCiAgIm5pZXVuYXBhcmVua29yZWFuIiwKICAweDMyMGYsCiAgIm5pZXVuY2lldWNrb3JlYW4iLAogIDB4MzEzNSwKICAibmlldW5jaXJjbGVrb3JlYW4iLAogIDB4MzI2MSwKICAibmlldW5oaWV1aGtvcmVhbiIsCiAgMHgzMTM2LAogICJuaWV1bmtvcmVhbiIsCiAgMHgzMTM0LAogICJuaWV1bnBhbnNpb3Nrb3JlYW4iLAogIDB4MzE2OCwKICAibmlldW5wYXJlbmtvcmVhbiIsCiAgMHgzMjAxLAogICJuaWV1bnNpb3Nrb3JlYW4iLAogIDB4MzE2NywKICAibmlldW50aWtldXRrb3JlYW4iLAogIDB4MzE2NiwKICAibmloaXJhZ2FuYSIsCiAgMHgzMDZiLAogICJuaWthdGFrYW5hIiwKICAweDMwY2IsCiAgIm5pa2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4NiwKICAibmlraGFoaXRsZWZ0dGhhaSIsCiAgMHhmODk5LAogICJuaWtoYWhpdHRoYWkiLAogIDB4MGU0ZCwKICAibmluZSIsCiAgMHgwMDM5LAogICJuaW5lYXJhYmljIiwKICAweDA2NjksCiAgIm5pbmViZW5nYWxpIiwKICAweDA5ZWYsCiAgIm5pbmVjaXJjbGUiLAogIDB4MjQ2OCwKICAibmluZWNpcmNsZWludmVyc2VzYW5zc2VyaWYiLAogIDB4Mjc5MiwKICAibmluZWRldmEiLAogIDB4MDk2ZiwKICAibmluZWd1amFyYXRpIiwKICAweDBhZWYsCiAgIm5pbmVndXJtdWtoaSIsCiAgMHgwYTZmLAogICJuaW5laGFja2FyYWJpYyIsCiAgMHgwNjY5LAogICJuaW5laGFuZ3pob3UiLAogIDB4MzAyOSwKICAibmluZWlkZW9ncmFwaGljcGFyZW4iLAogIDB4MzIyOCwKICAibmluZWluZmVyaW9yIiwKICAweDIwODksCiAgIm5pbmVtb25vc3BhY2UiLAogIDB4ZmYxOSwKICAibmluZW9sZHN0eWxlIiwKICAweGY3MzksCiAgIm5pbmVwYXJlbiIsCiAgMHgyNDdjLAogICJuaW5lcGVyaW9kIiwKICAweDI0OTAsCiAgIm5pbmVwZXJzaWFuIiwKICAweDA2ZjksCiAgIm5pbmVyb21hbiIsCiAgMHgyMTc4LAogICJuaW5lc3VwZXJpb3IiLAogIDB4MjA3OSwKICAibmluZXRlZW5jaXJjbGUiLAogIDB4MjQ3MiwKICAibmluZXRlZW5wYXJlbiIsCiAgMHgyNDg2LAogICJuaW5ldGVlbnBlcmlvZCIsCiAgMHgyNDlhLAogICJuaW5ldGhhaSIsCiAgMHgwZTU5LAogICJuaiIsCiAgMHgwMWNjLAogICJuamVjeXJpbGxpYyIsCiAgMHgwNDVhLAogICJua2F0YWthbmEiLAogIDB4MzBmMywKICAibmthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOWQsCiAgIm5sZWdyaWdodGxvbmciLAogIDB4MDE5ZSwKICAibmxpbmViZWxvdyIsCiAgMHgxZTQ5LAogICJubW9ub3NwYWNlIiwKICAweGZmNGUsCiAgIm5tc3F1YXJlIiwKICAweDMzOWEsCiAgIm5uYWJlbmdhbGkiLAogIDB4MDlhMywKICAibm5hZGV2YSIsCiAgMHgwOTIzLAogICJubmFndWphcmF0aSIsCiAgMHgwYWEzLAogICJubmFndXJtdWtoaSIsCiAgMHgwYTIzLAogICJubm5hZGV2YSIsCiAgMHgwOTI5LAogICJub2hpcmFnYW5hIiwKICAweDMwNmUsCiAgIm5va2F0YWthbmEiLAogIDB4MzBjZSwKICAibm9rYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjg5LAogICJub25icmVha2luZ3NwYWNlIiwKICAweDAwYTAsCiAgIm5vbmVudGhhaSIsCiAgMHgwZTEzLAogICJub251dGhhaSIsCiAgMHgwZTE5LAogICJub29uYXJhYmljIiwKICAweDA2NDYsCiAgIm5vb25maW5hbGFyYWJpYyIsCiAgMHhmZWU2LAogICJub29uZ2h1bm5hYXJhYmljIiwKICAweDA2YmEsCiAgIm5vb25naHVubmFmaW5hbGFyYWJpYyIsCiAgMHhmYjlmLAogICJub29uaW5pdGlhbGFyYWJpYyIsCiAgMHhmZWU3LAogICJub29uamVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmNkMiwKICAibm9vbmplZW1pc29sYXRlZGFyYWJpYyIsCiAgMHhmYzRiLAogICJub29ubWVkaWFsYXJhYmljIiwKICAweGZlZTgsCiAgIm5vb25tZWVtaW5pdGlhbGFyYWJpYyIsCiAgMHhmY2Q1LAogICJub29ubWVlbWlzb2xhdGVkYXJhYmljIiwKICAweGZjNGUsCiAgIm5vb25ub29uZmluYWxhcmFiaWMiLAogIDB4ZmM4ZCwKICAibm90Y29udGFpbnMiLAogIDB4MjIwYywKICAibm90ZWxlbWVudCIsCiAgMHgyMjA5LAogICJub3RlbGVtZW50b2YiLAogIDB4MjIwOSwKICAibm90ZXF1YWwiLAogIDB4MjI2MCwKICAibm90Z3JlYXRlciIsCiAgMHgyMjZmLAogICJub3RncmVhdGVybm9yZXF1YWwiLAogIDB4MjI3MSwKICAibm90Z3JlYXRlcm5vcmxlc3MiLAogIDB4MjI3OSwKICAibm90aWRlbnRpY2FsIiwKICAweDIyNjIsCiAgIm5vdGxlc3MiLAogIDB4MjI2ZSwKICAibm90bGVzc25vcmVxdWFsIiwKICAweDIyNzAsCiAgIm5vdHBhcmFsbGVsIiwKICAweDIyMjYsCiAgIm5vdHByZWNlZGVzIiwKICAweDIyODAsCiAgIm5vdHN1YnNldCIsCiAgMHgyMjg0LAogICJub3RzdWNjZWVkcyIsCiAgMHgyMjgxLAogICJub3RzdXBlcnNldCIsCiAgMHgyMjg1LAogICJub3dhcm1lbmlhbiIsCiAgMHgwNTc2LAogICJucGFyZW4iLAogIDB4MjRhOSwKICAibnNzcXVhcmUiLAogIDB4MzNiMSwKICAibnN1cGVyaW9yIiwKICAweDIwN2YsCiAgIm50aWxkZSIsCiAgMHgwMGYxLAogICJudSIsCiAgMHgwM2JkLAogICJudWhpcmFnYW5hIiwKICAweDMwNmMsCiAgIm51a2F0YWthbmEiLAogIDB4MzBjYywKICAibnVrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjg3LAogICJudWt0YWJlbmdhbGkiLAogIDB4MDliYywKICAibnVrdGFkZXZhIiwKICAweDA5M2MsCiAgIm51a3RhZ3VqYXJhdGkiLAogIDB4MGFiYywKICAibnVrdGFndXJtdWtoaSIsCiAgMHgwYTNjLAogICJudW1iZXJzaWduIiwKICAweDAwMjMsCiAgIm51bWJlcnNpZ25tb25vc3BhY2UiLAogIDB4ZmYwMywKICAibnVtYmVyc2lnbnNtYWxsIiwKICAweGZlNWYsCiAgIm51bWVyYWxzaWduZ3JlZWsiLAogIDB4MDM3NCwKICAibnVtZXJhbHNpZ25sb3dlcmdyZWVrIiwKICAweDAzNzUsCiAgIm51bWVybyIsCiAgMHgyMTE2LAogICJudW4iLAogIDB4MDVlMCwKICAibnVuZGFnZXNoIiwKICAweGZiNDAsCiAgIm51bmRhZ2VzaGhlYnJldyIsCiAgMHhmYjQwLAogICJudW5oZWJyZXciLAogIDB4MDVlMCwKICAibnZzcXVhcmUiLAogIDB4MzNiNSwKICAibndzcXVhcmUiLAogIDB4MzNiYiwKICAibnlhYmVuZ2FsaSIsCiAgMHgwOTllLAogICJueWFkZXZhIiwKICAweDA5MWUsCiAgIm55YWd1amFyYXRpIiwKICAweDBhOWUsCiAgIm55YWd1cm11a2hpIiwKICAweDBhMWUsCiAgIm8iLAogIDB4MDA2ZiwKICAib2FjdXRlIiwKICAweDAwZjMsCiAgIm9hbmd0aGFpIiwKICAweDBlMmQsCiAgIm9iYXJyZWQiLAogIDB4MDI3NSwKICAib2JhcnJlZGN5cmlsbGljIiwKICAweDA0ZTksCiAgIm9iYXJyZWRkaWVyZXNpc2N5cmlsbGljIiwKICAweDA0ZWIsCiAgIm9iZW5nYWxpIiwKICAweDA5OTMsCiAgIm9ib3BvbW9mbyIsCiAgMHgzMTFiLAogICJvYnJldmUiLAogIDB4MDE0ZiwKICAib2NhbmRyYWRldmEiLAogIDB4MDkxMSwKICAib2NhbmRyYWd1amFyYXRpIiwKICAweDBhOTEsCiAgIm9jYW5kcmF2b3dlbHNpZ25kZXZhIiwKICAweDA5NDksCiAgIm9jYW5kcmF2b3dlbHNpZ25ndWphcmF0aSIsCiAgMHgwYWM5LAogICJvY2Fyb24iLAogIDB4MDFkMiwKICAib2NpcmNsZSIsCiAgMHgyNGRlLAogICJvY2lyY3VtZmxleCIsCiAgMHgwMGY0LAogICJvY2lyY3VtZmxleGFjdXRlIiwKICAweDFlZDEsCiAgIm9jaXJjdW1mbGV4ZG90YmVsb3ciLAogIDB4MWVkOSwKICAib2NpcmN1bWZsZXhncmF2ZSIsCiAgMHgxZWQzLAogICJvY2lyY3VtZmxleGhvb2thYm92ZSIsCiAgMHgxZWQ1LAogICJvY2lyY3VtZmxleHRpbGRlIiwKICAweDFlZDcsCiAgIm9jeXJpbGxpYyIsCiAgMHgwNDNlLAogICJvZGJsYWN1dGUiLAogIDB4MDE1MSwKICAib2RibGdyYXZlIiwKICAweDAyMGQsCiAgIm9kZXZhIiwKICAweDA5MTMsCiAgIm9kaWVyZXNpcyIsCiAgMHgwMGY2LAogICJvZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGU3LAogICJvZG90YmVsb3ciLAogIDB4MWVjZCwKICAib2UiLAogIDB4MDE1MywKICAib2Vrb3JlYW4iLAogIDB4MzE1YSwKICAib2dvbmVrIiwKICAweDAyZGIsCiAgIm9nb25la2NtYiIsCiAgMHgwMzI4LAogICJvZ3JhdmUiLAogIDB4MDBmMiwKICAib2d1amFyYXRpIiwKICAweDBhOTMsCiAgIm9oYXJtZW5pYW4iLAogIDB4MDU4NSwKICAib2hpcmFnYW5hIiwKICAweDMwNGEsCiAgIm9ob29rYWJvdmUiLAogIDB4MWVjZiwKICAib2hvcm4iLAogIDB4MDFhMSwKICAib2hvcm5hY3V0ZSIsCiAgMHgxZWRiLAogICJvaG9ybmRvdGJlbG93IiwKICAweDFlZTMsCiAgIm9ob3JuZ3JhdmUiLAogIDB4MWVkZCwKICAib2hvcm5ob29rYWJvdmUiLAogIDB4MWVkZiwKICAib2hvcm50aWxkZSIsCiAgMHgxZWUxLAogICJvaHVuZ2FydW1sYXV0IiwKICAweDAxNTEsCiAgIm9pIiwKICAweDAxYTMsCiAgIm9pbnZlcnRlZGJyZXZlIiwKICAweDAyMGYsCiAgIm9rYXRha2FuYSIsCiAgMHgzMGFhLAogICJva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3NSwKICAib2tvcmVhbiIsCiAgMHgzMTU3LAogICJvbGVoZWJyZXciLAogIDB4MDVhYiwKICAib21hY3JvbiIsCiAgMHgwMTRkLAogICJvbWFjcm9uYWN1dGUiLAogIDB4MWU1MywKICAib21hY3JvbmdyYXZlIiwKICAweDFlNTEsCiAgIm9tZGV2YSIsCiAgMHgwOTUwLAogICJvbWVnYSIsCiAgMHgwM2M5LAogICJvbWVnYTEiLAogIDB4MDNkNiwKICAib21lZ2FjeXJpbGxpYyIsCiAgMHgwNDYxLAogICJvbWVnYWxhdGluY2xvc2VkIiwKICAweDAyNzcsCiAgIm9tZWdhcm91bmRjeXJpbGxpYyIsCiAgMHgwNDdiLAogICJvbWVnYXRpdGxvY3lyaWxsaWMiLAogIDB4MDQ3ZCwKICAib21lZ2F0b25vcyIsCiAgMHgwM2NlLAogICJvbWd1amFyYXRpIiwKICAweDBhZDAsCiAgIm9taWNyb24iLAogIDB4MDNiZiwKICAib21pY3JvbnRvbm9zIiwKICAweDAzY2MsCiAgIm9tb25vc3BhY2UiLAogIDB4ZmY0ZiwKICAib25lIiwKICAweDAwMzEsCiAgIm9uZWFyYWJpYyIsCiAgMHgwNjYxLAogICJvbmViZW5nYWxpIiwKICAweDA5ZTcsCiAgIm9uZWNpcmNsZSIsCiAgMHgyNDYwLAogICJvbmVjaXJjbGVpbnZlcnNlc2Fuc3NlcmlmIiwKICAweDI3OGEsCiAgIm9uZWRldmEiLAogIDB4MDk2NywKICAib25lZG90ZW5sZWFkZXIiLAogIDB4MjAyNCwKICAib25lZWlnaHRoIiwKICAweDIxNWIsCiAgIm9uZWZpdHRlZCIsCiAgMHhmNmRjLAogICJvbmVndWphcmF0aSIsCiAgMHgwYWU3LAogICJvbmVndXJtdWtoaSIsCiAgMHgwYTY3LAogICJvbmVoYWNrYXJhYmljIiwKICAweDA2NjEsCiAgIm9uZWhhbGYiLAogIDB4MDBiZCwKICAib25laGFuZ3pob3UiLAogIDB4MzAyMSwKICAib25laWRlb2dyYXBoaWNwYXJlbiIsCiAgMHgzMjIwLAogICJvbmVpbmZlcmlvciIsCiAgMHgyMDgxLAogICJvbmVtb25vc3BhY2UiLAogIDB4ZmYxMSwKICAib25lbnVtZXJhdG9yYmVuZ2FsaSIsCiAgMHgwOWY0LAogICJvbmVvbGRzdHlsZSIsCiAgMHhmNzMxLAogICJvbmVwYXJlbiIsCiAgMHgyNDc0LAogICJvbmVwZXJpb2QiLAogIDB4MjQ4OCwKICAib25lcGVyc2lhbiIsCiAgMHgwNmYxLAogICJvbmVxdWFydGVyIiwKICAweDAwYmMsCiAgIm9uZXJvbWFuIiwKICAweDIxNzAsCiAgIm9uZXN1cGVyaW9yIiwKICAweDAwYjksCiAgIm9uZXRoYWkiLAogIDB4MGU1MSwKICAib25ldGhpcmQiLAogIDB4MjE1MywKICAib29nb25layIsCiAgMHgwMWViLAogICJvb2dvbmVrbWFjcm9uIiwKICAweDAxZWQsCiAgIm9vZ3VybXVraGkiLAogIDB4MGExMywKICAib29tYXRyYWd1cm11a2hpIiwKICAweDBhNGIsCiAgIm9vcGVuIiwKICAweDAyNTQsCiAgIm9wYXJlbiIsCiAgMHgyNGFhLAogICJvcGVuYnVsbGV0IiwKICAweDI1ZTYsCiAgIm9wdGlvbiIsCiAgMHgyMzI1LAogICJvcmRmZW1pbmluZSIsCiAgMHgwMGFhLAogICJvcmRtYXNjdWxpbmUiLAogIDB4MDBiYSwKICAib3J0aG9nb25hbCIsCiAgMHgyMjFmLAogICJvc2hvcnRkZXZhIiwKICAweDA5MTIsCiAgIm9zaG9ydHZvd2Vsc2lnbmRldmEiLAogIDB4MDk0YSwKICAib3NsYXNoIiwKICAweDAwZjgsCiAgIm9zbGFzaGFjdXRlIiwKICAweDAxZmYsCiAgIm9zbWFsbGhpcmFnYW5hIiwKICAweDMwNDksCiAgIm9zbWFsbGthdGFrYW5hIiwKICAweDMwYTksCiAgIm9zbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNmIsCiAgIm9zdHJva2VhY3V0ZSIsCiAgMHgwMWZmLAogICJvc3VwZXJpb3IiLAogIDB4ZjZmMCwKICAib3RjeXJpbGxpYyIsCiAgMHgwNDdmLAogICJvdGlsZGUiLAogIDB4MDBmNSwKICAib3RpbGRlYWN1dGUiLAogIDB4MWU0ZCwKICAib3RpbGRlZGllcmVzaXMiLAogIDB4MWU0ZiwKICAib3Vib3BvbW9mbyIsCiAgMHgzMTIxLAogICJvdmVybGluZSIsCiAgMHgyMDNlLAogICJvdmVybGluZWNlbnRlcmxpbmUiLAogIDB4ZmU0YSwKICAib3ZlcmxpbmVjbWIiLAogIDB4MDMwNSwKICAib3ZlcmxpbmVkYXNoZWQiLAogIDB4ZmU0OSwKICAib3ZlcmxpbmVkYmx3YXZ5IiwKICAweGZlNGMsCiAgIm92ZXJsaW5ld2F2eSIsCiAgMHhmZTRiLAogICJvdmVyc2NvcmUiLAogIDB4MDBhZiwKICAib3Zvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljYiwKICAib3Zvd2Vsc2lnbmRldmEiLAogIDB4MDk0YiwKICAib3Zvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhY2IsCiAgInAiLAogIDB4MDA3MCwKICAicGFhbXBzc3F1YXJlIiwKICAweDMzODAsCiAgInBhYXNlbnRvc3F1YXJlIiwKICAweDMzMmIsCiAgInBhYmVuZ2FsaSIsCiAgMHgwOWFhLAogICJwYWN1dGUiLAogIDB4MWU1NSwKICAicGFkZXZhIiwKICAweDA5MmEsCiAgInBhZ2Vkb3duIiwKICAweDIxZGYsCiAgInBhZ2V1cCIsCiAgMHgyMWRlLAogICJwYWd1amFyYXRpIiwKICAweDBhYWEsCiAgInBhZ3VybXVraGkiLAogIDB4MGEyYSwKICAicGFoaXJhZ2FuYSIsCiAgMHgzMDcxLAogICJwYWl5YW5ub2l0aGFpIiwKICAweDBlMmYsCiAgInBha2F0YWthbmEiLAogIDB4MzBkMSwKICAicGFsYXRhbGl6YXRpb25jeXJpbGxpY2NtYiIsCiAgMHgwNDg0LAogICJwYWxvY2hrYWN5cmlsbGljIiwKICAweDA0YzAsCiAgInBhbnNpb3Nrb3JlYW4iLAogIDB4MzE3ZiwKICAicGFyYWdyYXBoIiwKICAweDAwYjYsCiAgInBhcmFsbGVsIiwKICAweDIyMjUsCiAgInBhcmVubGVmdCIsCiAgMHgwMDI4LAogICJwYXJlbmxlZnRhbHRvbmVhcmFiaWMiLAogIDB4ZmQzZSwKICAicGFyZW5sZWZ0YnQiLAogIDB4ZjhlZCwKICAicGFyZW5sZWZ0ZXgiLAogIDB4ZjhlYywKICAicGFyZW5sZWZ0aW5mZXJpb3IiLAogIDB4MjA4ZCwKICAicGFyZW5sZWZ0bW9ub3NwYWNlIiwKICAweGZmMDgsCiAgInBhcmVubGVmdHNtYWxsIiwKICAweGZlNTksCiAgInBhcmVubGVmdHN1cGVyaW9yIiwKICAweDIwN2QsCiAgInBhcmVubGVmdHRwIiwKICAweGY4ZWIsCiAgInBhcmVubGVmdHZlcnRpY2FsIiwKICAweGZlMzUsCiAgInBhcmVucmlnaHQiLAogIDB4MDAyOSwKICAicGFyZW5yaWdodGFsdG9uZWFyYWJpYyIsCiAgMHhmZDNmLAogICJwYXJlbnJpZ2h0YnQiLAogIDB4ZjhmOCwKICAicGFyZW5yaWdodGV4IiwKICAweGY4ZjcsCiAgInBhcmVucmlnaHRpbmZlcmlvciIsCiAgMHgyMDhlLAogICJwYXJlbnJpZ2h0bW9ub3NwYWNlIiwKICAweGZmMDksCiAgInBhcmVucmlnaHRzbWFsbCIsCiAgMHhmZTVhLAogICJwYXJlbnJpZ2h0c3VwZXJpb3IiLAogIDB4MjA3ZSwKICAicGFyZW5yaWdodHRwIiwKICAweGY4ZjYsCiAgInBhcmVucmlnaHR2ZXJ0aWNhbCIsCiAgMHhmZTM2LAogICJwYXJ0aWFsZGlmZiIsCiAgMHgyMjAyLAogICJwYXNlcWhlYnJldyIsCiAgMHgwNWMwLAogICJwYXNodGFoZWJyZXciLAogIDB4MDU5OSwKICAicGFzcXVhcmUiLAogIDB4MzNhOSwKICAicGF0YWgiLAogIDB4MDViNywKICAicGF0YWgxMSIsCiAgMHgwNWI3LAogICJwYXRhaDFkIiwKICAweDA1YjcsCiAgInBhdGFoMmEiLAogIDB4MDViNywKICAicGF0YWhoZWJyZXciLAogIDB4MDViNywKICAicGF0YWhuYXJyb3doZWJyZXciLAogIDB4MDViNywKICAicGF0YWhxdWFydGVyaGVicmV3IiwKICAweDA1YjcsCiAgInBhdGFod2lkZWhlYnJldyIsCiAgMHgwNWI3LAogICJwYXplcmhlYnJldyIsCiAgMHgwNWExLAogICJwYm9wb21vZm8iLAogIDB4MzEwNiwKICAicGNpcmNsZSIsCiAgMHgyNGRmLAogICJwZG90YWNjZW50IiwKICAweDFlNTcsCiAgInBlIiwKICAweDA1ZTQsCiAgInBlY3lyaWxsaWMiLAogIDB4MDQzZiwKICAicGVkYWdlc2giLAogIDB4ZmI0NCwKICAicGVkYWdlc2hoZWJyZXciLAogIDB4ZmI0NCwKICAicGVlemlzcXVhcmUiLAogIDB4MzMzYiwKICAicGVmaW5hbGRhZ2VzaGhlYnJldyIsCiAgMHhmYjQzLAogICJwZWhhcmFiaWMiLAogIDB4MDY3ZSwKICAicGVoYXJtZW5pYW4iLAogIDB4MDU3YSwKICAicGVoZWJyZXciLAogIDB4MDVlNCwKICAicGVoZmluYWxhcmFiaWMiLAogIDB4ZmI1NywKICAicGVoaW5pdGlhbGFyYWJpYyIsCiAgMHhmYjU4LAogICJwZWhpcmFnYW5hIiwKICAweDMwN2EsCiAgInBlaG1lZGlhbGFyYWJpYyIsCiAgMHhmYjU5LAogICJwZWthdGFrYW5hIiwKICAweDMwZGEsCiAgInBlbWlkZGxlaG9va2N5cmlsbGljIiwKICAweDA0YTcsCiAgInBlcmFmZWhlYnJldyIsCiAgMHhmYjRlLAogICJwZXJjZW50IiwKICAweDAwMjUsCiAgInBlcmNlbnRhcmFiaWMiLAogIDB4MDY2YSwKICAicGVyY2VudG1vbm9zcGFjZSIsCiAgMHhmZjA1LAogICJwZXJjZW50c21hbGwiLAogIDB4ZmU2YSwKICAicGVyaW9kIiwKICAweDAwMmUsCiAgInBlcmlvZGFybWVuaWFuIiwKICAweDA1ODksCiAgInBlcmlvZGNlbnRlcmVkIiwKICAweDAwYjcsCiAgInBlcmlvZGhhbGZ3aWR0aCIsCiAgMHhmZjYxLAogICJwZXJpb2RpbmZlcmlvciIsCiAgMHhmNmU3LAogICJwZXJpb2Rtb25vc3BhY2UiLAogIDB4ZmYwZSwKICAicGVyaW9kc21hbGwiLAogIDB4ZmU1MiwKICAicGVyaW9kc3VwZXJpb3IiLAogIDB4ZjZlOCwKICAicGVyaXNwb21lbmlncmVla2NtYiIsCiAgMHgwMzQyLAogICJwZXJwZW5kaWN1bGFyIiwKICAweDIyYTUsCiAgInBlcnRob3VzYW5kIiwKICAweDIwMzAsCiAgInBlc2V0YSIsCiAgMHgyMGE3LAogICJwZnNxdWFyZSIsCiAgMHgzMzhhLAogICJwaGFiZW5nYWxpIiwKICAweDA5YWIsCiAgInBoYWRldmEiLAogIDB4MDkyYiwKICAicGhhZ3VqYXJhdGkiLAogIDB4MGFhYiwKICAicGhhZ3VybXVraGkiLAogIDB4MGEyYiwKICAicGhpIiwKICAweDAzYzYsCiAgInBoaTEiLAogIDB4MDNkNSwKICAicGhpZXVwaGFjaXJjbGVrb3JlYW4iLAogIDB4MzI3YSwKICAicGhpZXVwaGFwYXJlbmtvcmVhbiIsCiAgMHgzMjFhLAogICJwaGlldXBoY2lyY2xla29yZWFuIiwKICAweDMyNmMsCiAgInBoaWV1cGhrb3JlYW4iLAogIDB4MzE0ZCwKICAicGhpZXVwaHBhcmVua29yZWFuIiwKICAweDMyMGMsCiAgInBoaWxhdGluIiwKICAweDAyNzgsCiAgInBoaW50aHV0aGFpIiwKICAweDBlM2EsCiAgInBoaXN5bWJvbGdyZWVrIiwKICAweDAzZDUsCiAgInBob29rIiwKICAweDAxYTUsCiAgInBob3BoYW50aGFpIiwKICAweDBlMWUsCiAgInBob3BodW5ndGhhaSIsCiAgMHgwZTFjLAogICJwaG9zYW1waGFvdGhhaSIsCiAgMHgwZTIwLAogICJwaSIsCiAgMHgwM2MwLAogICJwaWV1cGFjaXJjbGVrb3JlYW4iLAogIDB4MzI3MywKICAicGlldXBhcGFyZW5rb3JlYW4iLAogIDB4MzIxMywKICAicGlldXBjaWV1Y2tvcmVhbiIsCiAgMHgzMTc2LAogICJwaWV1cGNpcmNsZWtvcmVhbiIsCiAgMHgzMjY1LAogICJwaWV1cGtpeWVva2tvcmVhbiIsCiAgMHgzMTcyLAogICJwaWV1cGtvcmVhbiIsCiAgMHgzMTQyLAogICJwaWV1cHBhcmVua29yZWFuIiwKICAweDMyMDUsCiAgInBpZXVwc2lvc2tpeWVva2tvcmVhbiIsCiAgMHgzMTc0LAogICJwaWV1cHNpb3Nrb3JlYW4iLAogIDB4MzE0NCwKICAicGlldXBzaW9zdGlrZXV0a29yZWFuIiwKICAweDMxNzUsCiAgInBpZXVwdGhpZXV0aGtvcmVhbiIsCiAgMHgzMTc3LAogICJwaWV1cHRpa2V1dGtvcmVhbiIsCiAgMHgzMTczLAogICJwaWhpcmFnYW5hIiwKICAweDMwNzQsCiAgInBpa2F0YWthbmEiLAogIDB4MzBkNCwKICAicGlzeW1ib2xncmVlayIsCiAgMHgwM2Q2LAogICJwaXdyYXJtZW5pYW4iLAogIDB4MDU4MywKICAicGx1cyIsCiAgMHgwMDJiLAogICJwbHVzYmVsb3djbWIiLAogIDB4MDMxZiwKICAicGx1c2NpcmNsZSIsCiAgMHgyMjk1LAogICJwbHVzbWludXMiLAogIDB4MDBiMSwKICAicGx1c21vZCIsCiAgMHgwMmQ2LAogICJwbHVzbW9ub3NwYWNlIiwKICAweGZmMGIsCiAgInBsdXNzbWFsbCIsCiAgMHhmZTYyLAogICJwbHVzc3VwZXJpb3IiLAogIDB4MjA3YSwKICAicG1vbm9zcGFjZSIsCiAgMHhmZjUwLAogICJwbXNxdWFyZSIsCiAgMHgzM2Q4LAogICJwb2hpcmFnYW5hIiwKICAweDMwN2QsCiAgInBvaW50aW5naW5kZXhkb3dud2hpdGUiLAogIDB4MjYxZiwKICAicG9pbnRpbmdpbmRleGxlZnR3aGl0ZSIsCiAgMHgyNjFjLAogICJwb2ludGluZ2luZGV4cmlnaHR3aGl0ZSIsCiAgMHgyNjFlLAogICJwb2ludGluZ2luZGV4dXB3aGl0ZSIsCiAgMHgyNjFkLAogICJwb2thdGFrYW5hIiwKICAweDMwZGQsCiAgInBvcGxhdGhhaSIsCiAgMHgwZTFiLAogICJwb3N0YWxtYXJrIiwKICAweDMwMTIsCiAgInBvc3RhbG1hcmtmYWNlIiwKICAweDMwMjAsCiAgInBwYXJlbiIsCiAgMHgyNGFiLAogICJwcmVjZWRlcyIsCiAgMHgyMjdhLAogICJwcmVzY3JpcHRpb24iLAogIDB4MjExZSwKICAicHJpbWVtb2QiLAogIDB4MDJiOSwKICAicHJpbWVyZXZlcnNlZCIsCiAgMHgyMDM1LAogICJwcm9kdWN0IiwKICAweDIyMGYsCiAgInByb2plY3RpdmUiLAogIDB4MjMwNSwKICAicHJvbG9uZ2Vka2FuYSIsCiAgMHgzMGZjLAogICJwcm9wZWxsb3IiLAogIDB4MjMxOCwKICAicHJvcGVyc3Vic2V0IiwKICAweDIyODIsCiAgInByb3BlcnN1cGVyc2V0IiwKICAweDIyODMsCiAgInByb3BvcnRpb24iLAogIDB4MjIzNywKICAicHJvcG9ydGlvbmFsIiwKICAweDIyMWQsCiAgInBzaSIsCiAgMHgwM2M4LAogICJwc2ljeXJpbGxpYyIsCiAgMHgwNDcxLAogICJwc2lsaXBuZXVtYXRhY3lyaWxsaWNjbWIiLAogIDB4MDQ4NiwKICAicHNzcXVhcmUiLAogIDB4MzNiMCwKICAicHVoaXJhZ2FuYSIsCiAgMHgzMDc3LAogICJwdWthdGFrYW5hIiwKICAweDMwZDcsCiAgInB2c3F1YXJlIiwKICAweDMzYjQsCiAgInB3c3F1YXJlIiwKICAweDMzYmEsCiAgInEiLAogIDB4MDA3MSwKICAicWFkZXZhIiwKICAweDA5NTgsCiAgInFhZG1haGVicmV3IiwKICAweDA1YTgsCiAgInFhZmFyYWJpYyIsCiAgMHgwNjQyLAogICJxYWZmaW5hbGFyYWJpYyIsCiAgMHhmZWQ2LAogICJxYWZpbml0aWFsYXJhYmljIiwKICAweGZlZDcsCiAgInFhZm1lZGlhbGFyYWJpYyIsCiAgMHhmZWQ4LAogICJxYW1hdHMiLAogIDB4MDViOCwKICAicWFtYXRzMTAiLAogIDB4MDViOCwKICAicWFtYXRzMWEiLAogIDB4MDViOCwKICAicWFtYXRzMWMiLAogIDB4MDViOCwKICAicWFtYXRzMjciLAogIDB4MDViOCwKICAicWFtYXRzMjkiLAogIDB4MDViOCwKICAicWFtYXRzMzMiLAogIDB4MDViOCwKICAicWFtYXRzZGUiLAogIDB4MDViOCwKICAicWFtYXRzaGVicmV3IiwKICAweDA1YjgsCiAgInFhbWF0c25hcnJvd2hlYnJldyIsCiAgMHgwNWI4LAogICJxYW1hdHNxYXRhbmhlYnJldyIsCiAgMHgwNWI4LAogICJxYW1hdHNxYXRhbm5hcnJvd2hlYnJldyIsCiAgMHgwNWI4LAogICJxYW1hdHNxYXRhbnF1YXJ0ZXJoZWJyZXciLAogIDB4MDViOCwKICAicWFtYXRzcWF0YW53aWRlaGVicmV3IiwKICAweDA1YjgsCiAgInFhbWF0c3F1YXJ0ZXJoZWJyZXciLAogIDB4MDViOCwKICAicWFtYXRzd2lkZWhlYnJldyIsCiAgMHgwNWI4LAogICJxYXJuZXlwYXJhaGVicmV3IiwKICAweDA1OWYsCiAgInFib3BvbW9mbyIsCiAgMHgzMTExLAogICJxY2lyY2xlIiwKICAweDI0ZTAsCiAgInFob29rIiwKICAweDAyYTAsCiAgInFtb25vc3BhY2UiLAogIDB4ZmY1MSwKICAicW9mIiwKICAweDA1ZTcsCiAgInFvZmRhZ2VzaCIsCiAgMHhmYjQ3LAogICJxb2ZkYWdlc2hoZWJyZXciLAogIDB4ZmI0NywKICAicW9maGVicmV3IiwKICAweDA1ZTcsCiAgInFwYXJlbiIsCiAgMHgyNGFjLAogICJxdWFydGVybm90ZSIsCiAgMHgyNjY5LAogICJxdWJ1dHMiLAogIDB4MDViYiwKICAicXVidXRzMTgiLAogIDB4MDViYiwKICAicXVidXRzMjUiLAogIDB4MDViYiwKICAicXVidXRzMzEiLAogIDB4MDViYiwKICAicXVidXRzaGVicmV3IiwKICAweDA1YmIsCiAgInF1YnV0c25hcnJvd2hlYnJldyIsCiAgMHgwNWJiLAogICJxdWJ1dHNxdWFydGVyaGVicmV3IiwKICAweDA1YmIsCiAgInF1YnV0c3dpZGVoZWJyZXciLAogIDB4MDViYiwKICAicXVlc3Rpb24iLAogIDB4MDAzZiwKICAicXVlc3Rpb25hcmFiaWMiLAogIDB4MDYxZiwKICAicXVlc3Rpb25hcm1lbmlhbiIsCiAgMHgwNTVlLAogICJxdWVzdGlvbmRvd24iLAogIDB4MDBiZiwKICAicXVlc3Rpb25kb3duc21hbGwiLAogIDB4ZjdiZiwKICAicXVlc3Rpb25ncmVlayIsCiAgMHgwMzdlLAogICJxdWVzdGlvbm1vbm9zcGFjZSIsCiAgMHhmZjFmLAogICJxdWVzdGlvbnNtYWxsIiwKICAweGY3M2YsCiAgInF1b3RlZGJsIiwKICAweDAwMjIsCiAgInF1b3RlZGJsYmFzZSIsCiAgMHgyMDFlLAogICJxdW90ZWRibGxlZnQiLAogIDB4MjAxYywKICAicXVvdGVkYmxtb25vc3BhY2UiLAogIDB4ZmYwMiwKICAicXVvdGVkYmxwcmltZSIsCiAgMHgzMDFlLAogICJxdW90ZWRibHByaW1lcmV2ZXJzZWQiLAogIDB4MzAxZCwKICAicXVvdGVkYmxyaWdodCIsCiAgMHgyMDFkLAogICJxdW90ZWxlZnQiLAogIDB4MjAxOCwKICAicXVvdGVsZWZ0cmV2ZXJzZWQiLAogIDB4MjAxYiwKICAicXVvdGVyZXZlcnNlZCIsCiAgMHgyMDFiLAogICJxdW90ZXJpZ2h0IiwKICAweDIwMTksCiAgInF1b3RlcmlnaHRuIiwKICAweDAxNDksCiAgInF1b3Rlc2luZ2xiYXNlIiwKICAweDIwMWEsCiAgInF1b3Rlc2luZ2xlIiwKICAweDAwMjcsCiAgInF1b3Rlc2luZ2xlbW9ub3NwYWNlIiwKICAweGZmMDcsCiAgInIiLAogIDB4MDA3MiwKICAicmFhcm1lbmlhbiIsCiAgMHgwNTdjLAogICJyYWJlbmdhbGkiLAogIDB4MDliMCwKICAicmFjdXRlIiwKICAweDAxNTUsCiAgInJhZGV2YSIsCiAgMHgwOTMwLAogICJyYWRpY2FsIiwKICAweDIyMWEsCiAgInJhZGljYWxleCIsCiAgMHhmOGU1LAogICJyYWRvdmVyc3NxdWFyZSIsCiAgMHgzM2FlLAogICJyYWRvdmVyc3NxdWFyZWRzcXVhcmUiLAogIDB4MzNhZiwKICAicmFkc3F1YXJlIiwKICAweDMzYWQsCiAgInJhZmUiLAogIDB4MDViZiwKICAicmFmZWhlYnJldyIsCiAgMHgwNWJmLAogICJyYWd1amFyYXRpIiwKICAweDBhYjAsCiAgInJhZ3VybXVraGkiLAogIDB4MGEzMCwKICAicmFoaXJhZ2FuYSIsCiAgMHgzMDg5LAogICJyYWthdGFrYW5hIiwKICAweDMwZTksCiAgInJha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5NywKICAicmFsb3dlcmRpYWdvbmFsYmVuZ2FsaSIsCiAgMHgwOWYxLAogICJyYW1pZGRsZWRpYWdvbmFsYmVuZ2FsaSIsCiAgMHgwOWYwLAogICJyYW1zaG9ybiIsCiAgMHgwMjY0LAogICJyYXRpbyIsCiAgMHgyMjM2LAogICJyYm9wb21vZm8iLAogIDB4MzExNiwKICAicmNhcm9uIiwKICAweDAxNTksCiAgInJjZWRpbGxhIiwKICAweDAxNTcsCiAgInJjaXJjbGUiLAogIDB4MjRlMSwKICAicmNvbW1hYWNjZW50IiwKICAweDAxNTcsCiAgInJkYmxncmF2ZSIsCiAgMHgwMjExLAogICJyZG90YWNjZW50IiwKICAweDFlNTksCiAgInJkb3RiZWxvdyIsCiAgMHgxZTViLAogICJyZG90YmVsb3dtYWNyb24iLAogIDB4MWU1ZCwKICAicmVmZXJlbmNlbWFyayIsCiAgMHgyMDNiLAogICJyZWZsZXhzdWJzZXQiLAogIDB4MjI4NiwKICAicmVmbGV4c3VwZXJzZXQiLAogIDB4MjI4NywKICAicmVnaXN0ZXJlZCIsCiAgMHgwMGFlLAogICJyZWdpc3RlcnNhbnMiLAogIDB4ZjhlOCwKICAicmVnaXN0ZXJzZXJpZiIsCiAgMHhmNmRhLAogICJyZWhhcmFiaWMiLAogIDB4MDYzMSwKICAicmVoYXJtZW5pYW4iLAogIDB4MDU4MCwKICAicmVoZmluYWxhcmFiaWMiLAogIDB4ZmVhZSwKICAicmVoaXJhZ2FuYSIsCiAgMHgzMDhjLAogICJyZWthdGFrYW5hIiwKICAweDMwZWMsCiAgInJla2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5YSwKICAicmVzaCIsCiAgMHgwNWU4LAogICJyZXNoZGFnZXNoaGVicmV3IiwKICAweGZiNDgsCiAgInJlc2hoZWJyZXciLAogIDB4MDVlOCwKICAicmV2ZXJzZWR0aWxkZSIsCiAgMHgyMjNkLAogICJyZXZpYWhlYnJldyIsCiAgMHgwNTk3LAogICJyZXZpYW11Z3Jhc2hoZWJyZXciLAogIDB4MDU5NywKICAicmV2bG9naWNhbG5vdCIsCiAgMHgyMzEwLAogICJyZmlzaGhvb2siLAogIDB4MDI3ZSwKICAicmZpc2hob29rcmV2ZXJzZWQiLAogIDB4MDI3ZiwKICAicmhhYmVuZ2FsaSIsCiAgMHgwOWRkLAogICJyaGFkZXZhIiwKICAweDA5NWQsCiAgInJobyIsCiAgMHgwM2MxLAogICJyaG9vayIsCiAgMHgwMjdkLAogICJyaG9va3R1cm5lZCIsCiAgMHgwMjdiLAogICJyaG9va3R1cm5lZHN1cGVyaW9yIiwKICAweDAyYjUsCiAgInJob3N5bWJvbGdyZWVrIiwKICAweDAzZjEsCiAgInJob3RpY2hvb2ttb2QiLAogIDB4MDJkZSwKICAicmlldWxhY2lyY2xla29yZWFuIiwKICAweDMyNzEsCiAgInJpZXVsYXBhcmVua29yZWFuIiwKICAweDMyMTEsCiAgInJpZXVsY2lyY2xla29yZWFuIiwKICAweDMyNjMsCiAgInJpZXVsaGlldWhrb3JlYW4iLAogIDB4MzE0MCwKICAicmlldWxraXllb2trb3JlYW4iLAogIDB4MzEzYSwKICAicmlldWxraXllb2tzaW9za29yZWFuIiwKICAweDMxNjksCiAgInJpZXVsa29yZWFuIiwKICAweDMxMzksCiAgInJpZXVsbWlldW1rb3JlYW4iLAogIDB4MzEzYiwKICAicmlldWxwYW5zaW9za29yZWFuIiwKICAweDMxNmMsCiAgInJpZXVscGFyZW5rb3JlYW4iLAogIDB4MzIwMywKICAicmlldWxwaGlldXBoa29yZWFuIiwKICAweDMxM2YsCiAgInJpZXVscGlldXBrb3JlYW4iLAogIDB4MzEzYywKICAicmlldWxwaWV1cHNpb3Nrb3JlYW4iLAogIDB4MzE2YiwKICAicmlldWxzaW9za29yZWFuIiwKICAweDMxM2QsCiAgInJpZXVsdGhpZXV0aGtvcmVhbiIsCiAgMHgzMTNlLAogICJyaWV1bHRpa2V1dGtvcmVhbiIsCiAgMHgzMTZhLAogICJyaWV1bHllb3JpbmhpZXVoa29yZWFuIiwKICAweDMxNmQsCiAgInJpZ2h0YW5nbGUiLAogIDB4MjIxZiwKICAicmlnaHR0YWNrYmVsb3djbWIiLAogIDB4MDMxOSwKICAicmlnaHR0cmlhbmdsZSIsCiAgMHgyMmJmLAogICJyaWhpcmFnYW5hIiwKICAweDMwOGEsCiAgInJpa2F0YWthbmEiLAogIDB4MzBlYSwKICAicmlrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjk4LAogICJyaW5nIiwKICAweDAyZGEsCiAgInJpbmdiZWxvd2NtYiIsCiAgMHgwMzI1LAogICJyaW5nY21iIiwKICAweDAzMGEsCiAgInJpbmdoYWxmbGVmdCIsCiAgMHgwMmJmLAogICJyaW5naGFsZmxlZnRhcm1lbmlhbiIsCiAgMHgwNTU5LAogICJyaW5naGFsZmxlZnRiZWxvd2NtYiIsCiAgMHgwMzFjLAogICJyaW5naGFsZmxlZnRjZW50ZXJlZCIsCiAgMHgwMmQzLAogICJyaW5naGFsZnJpZ2h0IiwKICAweDAyYmUsCiAgInJpbmdoYWxmcmlnaHRiZWxvd2NtYiIsCiAgMHgwMzM5LAogICJyaW5naGFsZnJpZ2h0Y2VudGVyZWQiLAogIDB4MDJkMiwKICAicmludmVydGVkYnJldmUiLAogIDB4MDIxMywKICAicml0dG9ydXNxdWFyZSIsCiAgMHgzMzUxLAogICJybGluZWJlbG93IiwKICAweDFlNWYsCiAgInJsb25nbGVnIiwKICAweDAyN2MsCiAgInJsb25nbGVndHVybmVkIiwKICAweDAyN2EsCiAgInJtb25vc3BhY2UiLAogIDB4ZmY1MiwKICAicm9oaXJhZ2FuYSIsCiAgMHgzMDhkLAogICJyb2thdGFrYW5hIiwKICAweDMwZWQsCiAgInJva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5YiwKICAicm9ydWF0aGFpIiwKICAweDBlMjMsCiAgInJwYXJlbiIsCiAgMHgyNGFkLAogICJycmFiZW5nYWxpIiwKICAweDA5ZGMsCiAgInJyYWRldmEiLAogIDB4MDkzMSwKICAicnJhZ3VybXVraGkiLAogIDB4MGE1YywKICAicnJlaGFyYWJpYyIsCiAgMHgwNjkxLAogICJycmVoZmluYWxhcmFiaWMiLAogIDB4ZmI4ZCwKICAicnJ2b2NhbGljYmVuZ2FsaSIsCiAgMHgwOWUwLAogICJycnZvY2FsaWNkZXZhIiwKICAweDA5NjAsCiAgInJydm9jYWxpY2d1amFyYXRpIiwKICAweDBhZTAsCiAgInJydm9jYWxpY3Zvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljNCwKICAicnJ2b2NhbGljdm93ZWxzaWduZGV2YSIsCiAgMHgwOTQ0LAogICJycnZvY2FsaWN2b3dlbHNpZ25ndWphcmF0aSIsCiAgMHgwYWM0LAogICJyc3VwZXJpb3IiLAogIDB4ZjZmMSwKICAicnRibG9jayIsCiAgMHgyNTkwLAogICJydHVybmVkIiwKICAweDAyNzksCiAgInJ0dXJuZWRzdXBlcmlvciIsCiAgMHgwMmI0LAogICJydWhpcmFnYW5hIiwKICAweDMwOGIsCiAgInJ1a2F0YWthbmEiLAogIDB4MzBlYiwKICAicnVrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjk5LAogICJydXBlZW1hcmtiZW5nYWxpIiwKICAweDA5ZjIsCiAgInJ1cGVlc2lnbmJlbmdhbGkiLAogIDB4MDlmMywKICAicnVwaWFoIiwKICAweGY2ZGQsCiAgInJ1dGhhaSIsCiAgMHgwZTI0LAogICJydm9jYWxpY2JlbmdhbGkiLAogIDB4MDk4YiwKICAicnZvY2FsaWNkZXZhIiwKICAweDA5MGIsCiAgInJ2b2NhbGljZ3VqYXJhdGkiLAogIDB4MGE4YiwKICAicnZvY2FsaWN2b3dlbHNpZ25iZW5nYWxpIiwKICAweDA5YzMsCiAgInJ2b2NhbGljdm93ZWxzaWduZGV2YSIsCiAgMHgwOTQzLAogICJydm9jYWxpY3Zvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhYzMsCiAgInMiLAogIDB4MDA3MywKICAic2FiZW5nYWxpIiwKICAweDA5YjgsCiAgInNhY3V0ZSIsCiAgMHgwMTViLAogICJzYWN1dGVkb3RhY2NlbnQiLAogIDB4MWU2NSwKICAic2FkYXJhYmljIiwKICAweDA2MzUsCiAgInNhZGV2YSIsCiAgMHgwOTM4LAogICJzYWRmaW5hbGFyYWJpYyIsCiAgMHhmZWJhLAogICJzYWRpbml0aWFsYXJhYmljIiwKICAweGZlYmIsCiAgInNhZG1lZGlhbGFyYWJpYyIsCiAgMHhmZWJjLAogICJzYWd1amFyYXRpIiwKICAweDBhYjgsCiAgInNhZ3VybXVraGkiLAogIDB4MGEzOCwKICAic2FoaXJhZ2FuYSIsCiAgMHgzMDU1LAogICJzYWthdGFrYW5hIiwKICAweDMwYjUsCiAgInNha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3YiwKICAic2FsbGFsbGFob3VhbGF5aGV3YXNhbGxhbWFyYWJpYyIsCiAgMHhmZGZhLAogICJzYW1la2giLAogIDB4MDVlMSwKICAic2FtZWtoZGFnZXNoIiwKICAweGZiNDEsCiAgInNhbWVraGRhZ2VzaGhlYnJldyIsCiAgMHhmYjQxLAogICJzYW1la2hoZWJyZXciLAogIDB4MDVlMSwKICAic2FyYWFhdGhhaSIsCiAgMHgwZTMyLAogICJzYXJhYWV0aGFpIiwKICAweDBlNDEsCiAgInNhcmFhaW1haW1hbGFpdGhhaSIsCiAgMHgwZTQ0LAogICJzYXJhYWltYWltdWFudGhhaSIsCiAgMHgwZTQzLAogICJzYXJhYW10aGFpIiwKICAweDBlMzMsCiAgInNhcmFhdGhhaSIsCiAgMHgwZTMwLAogICJzYXJhZXRoYWkiLAogIDB4MGU0MCwKICAic2FyYWlpbGVmdHRoYWkiLAogIDB4Zjg4NiwKICAic2FyYWlpdGhhaSIsCiAgMHgwZTM1LAogICJzYXJhaWxlZnR0aGFpIiwKICAweGY4ODUsCiAgInNhcmFpdGhhaSIsCiAgMHgwZTM0LAogICJzYXJhb3RoYWkiLAogIDB4MGU0MiwKICAic2FyYXVlZWxlZnR0aGFpIiwKICAweGY4ODgsCiAgInNhcmF1ZWV0aGFpIiwKICAweDBlMzcsCiAgInNhcmF1ZWxlZnR0aGFpIiwKICAweGY4ODcsCiAgInNhcmF1ZXRoYWkiLAogIDB4MGUzNiwKICAic2FyYXV0aGFpIiwKICAweDBlMzgsCiAgInNhcmF1dXRoYWkiLAogIDB4MGUzOSwKICAic2JvcG9tb2ZvIiwKICAweDMxMTksCiAgInNjYXJvbiIsCiAgMHgwMTYxLAogICJzY2Fyb25kb3RhY2NlbnQiLAogIDB4MWU2NywKICAic2NlZGlsbGEiLAogIDB4MDE1ZiwKICAic2Nod2EiLAogIDB4MDI1OSwKICAic2Nod2FjeXJpbGxpYyIsCiAgMHgwNGQ5LAogICJzY2h3YWRpZXJlc2lzY3lyaWxsaWMiLAogIDB4MDRkYiwKICAic2Nod2Fob29rIiwKICAweDAyNWEsCiAgInNjaXJjbGUiLAogIDB4MjRlMiwKICAic2NpcmN1bWZsZXgiLAogIDB4MDE1ZCwKICAic2NvbW1hYWNjZW50IiwKICAweDAyMTksCiAgInNkb3RhY2NlbnQiLAogIDB4MWU2MSwKICAic2RvdGJlbG93IiwKICAweDFlNjMsCiAgInNkb3RiZWxvd2RvdGFjY2VudCIsCiAgMHgxZTY5LAogICJzZWFndWxsYmVsb3djbWIiLAogIDB4MDMzYywKICAic2Vjb25kIiwKICAweDIwMzMsCiAgInNlY29uZHRvbmVjaGluZXNlIiwKICAweDAyY2EsCiAgInNlY3Rpb24iLAogIDB4MDBhNywKICAic2VlbmFyYWJpYyIsCiAgMHgwNjMzLAogICJzZWVuZmluYWxhcmFiaWMiLAogIDB4ZmViMiwKICAic2VlbmluaXRpYWxhcmFiaWMiLAogIDB4ZmViMywKICAic2Vlbm1lZGlhbGFyYWJpYyIsCiAgMHhmZWI0LAogICJzZWdvbCIsCiAgMHgwNWI2LAogICJzZWdvbDEzIiwKICAweDA1YjYsCiAgInNlZ29sMWYiLAogIDB4MDViNiwKICAic2Vnb2wyYyIsCiAgMHgwNWI2LAogICJzZWdvbGhlYnJldyIsCiAgMHgwNWI2LAogICJzZWdvbG5hcnJvd2hlYnJldyIsCiAgMHgwNWI2LAogICJzZWdvbHF1YXJ0ZXJoZWJyZXciLAogIDB4MDViNiwKICAic2Vnb2x0YWhlYnJldyIsCiAgMHgwNTkyLAogICJzZWdvbHdpZGVoZWJyZXciLAogIDB4MDViNiwKICAic2VoYXJtZW5pYW4iLAogIDB4MDU3ZCwKICAic2VoaXJhZ2FuYSIsCiAgMHgzMDViLAogICJzZWthdGFrYW5hIiwKICAweDMwYmIsCiAgInNla2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3ZSwKICAic2VtaWNvbG9uIiwKICAweDAwM2IsCiAgInNlbWljb2xvbmFyYWJpYyIsCiAgMHgwNjFiLAogICJzZW1pY29sb25tb25vc3BhY2UiLAogIDB4ZmYxYiwKICAic2VtaWNvbG9uc21hbGwiLAogIDB4ZmU1NCwKICAic2VtaXZvaWNlZG1hcmtrYW5hIiwKICAweDMwOWMsCiAgInNlbWl2b2ljZWRtYXJra2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjlmLAogICJzZW50aXNxdWFyZSIsCiAgMHgzMzIyLAogICJzZW50b3NxdWFyZSIsCiAgMHgzMzIzLAogICJzZXZlbiIsCiAgMHgwMDM3LAogICJzZXZlbmFyYWJpYyIsCiAgMHgwNjY3LAogICJzZXZlbmJlbmdhbGkiLAogIDB4MDllZCwKICAic2V2ZW5jaXJjbGUiLAogIDB4MjQ2NiwKICAic2V2ZW5jaXJjbGVpbnZlcnNlc2Fuc3NlcmlmIiwKICAweDI3OTAsCiAgInNldmVuZGV2YSIsCiAgMHgwOTZkLAogICJzZXZlbmVpZ2h0aHMiLAogIDB4MjE1ZSwKICAic2V2ZW5ndWphcmF0aSIsCiAgMHgwYWVkLAogICJzZXZlbmd1cm11a2hpIiwKICAweDBhNmQsCiAgInNldmVuaGFja2FyYWJpYyIsCiAgMHgwNjY3LAogICJzZXZlbmhhbmd6aG91IiwKICAweDMwMjcsCiAgInNldmVuaWRlb2dyYXBoaWNwYXJlbiIsCiAgMHgzMjI2LAogICJzZXZlbmluZmVyaW9yIiwKICAweDIwODcsCiAgInNldmVubW9ub3NwYWNlIiwKICAweGZmMTcsCiAgInNldmVub2xkc3R5bGUiLAogIDB4ZjczNywKICAic2V2ZW5wYXJlbiIsCiAgMHgyNDdhLAogICJzZXZlbnBlcmlvZCIsCiAgMHgyNDhlLAogICJzZXZlbnBlcnNpYW4iLAogIDB4MDZmNywKICAic2V2ZW5yb21hbiIsCiAgMHgyMTc2LAogICJzZXZlbnN1cGVyaW9yIiwKICAweDIwNzcsCiAgInNldmVudGVlbmNpcmNsZSIsCiAgMHgyNDcwLAogICJzZXZlbnRlZW5wYXJlbiIsCiAgMHgyNDg0LAogICJzZXZlbnRlZW5wZXJpb2QiLAogIDB4MjQ5OCwKICAic2V2ZW50aGFpIiwKICAweDBlNTcsCiAgInNmdGh5cGhlbiIsCiAgMHgwMGFkLAogICJzaGFhcm1lbmlhbiIsCiAgMHgwNTc3LAogICJzaGFiZW5nYWxpIiwKICAweDA5YjYsCiAgInNoYWN5cmlsbGljIiwKICAweDA0NDgsCiAgInNoYWRkYWFyYWJpYyIsCiAgMHgwNjUxLAogICJzaGFkZGFkYW1tYWFyYWJpYyIsCiAgMHhmYzYxLAogICJzaGFkZGFkYW1tYXRhbmFyYWJpYyIsCiAgMHhmYzVlLAogICJzaGFkZGFmYXRoYWFyYWJpYyIsCiAgMHhmYzYwLAogICJzaGFkZGFrYXNyYWFyYWJpYyIsCiAgMHhmYzYyLAogICJzaGFkZGFrYXNyYXRhbmFyYWJpYyIsCiAgMHhmYzVmLAogICJzaGFkZSIsCiAgMHgyNTkyLAogICJzaGFkZWRhcmsiLAogIDB4MjU5MywKICAic2hhZGVsaWdodCIsCiAgMHgyNTkxLAogICJzaGFkZW1lZGl1bSIsCiAgMHgyNTkyLAogICJzaGFkZXZhIiwKICAweDA5MzYsCiAgInNoYWd1amFyYXRpIiwKICAweDBhYjYsCiAgInNoYWd1cm11a2hpIiwKICAweDBhMzYsCiAgInNoYWxzaGVsZXRoZWJyZXciLAogIDB4MDU5MywKICAic2hib3BvbW9mbyIsCiAgMHgzMTE1LAogICJzaGNoYWN5cmlsbGljIiwKICAweDA0NDksCiAgInNoZWVuYXJhYmljIiwKICAweDA2MzQsCiAgInNoZWVuZmluYWxhcmFiaWMiLAogIDB4ZmViNiwKICAic2hlZW5pbml0aWFsYXJhYmljIiwKICAweGZlYjcsCiAgInNoZWVubWVkaWFsYXJhYmljIiwKICAweGZlYjgsCiAgInNoZWljb3B0aWMiLAogIDB4MDNlMywKICAic2hlcWVsIiwKICAweDIwYWEsCiAgInNoZXFlbGhlYnJldyIsCiAgMHgyMGFhLAogICJzaGV2YSIsCiAgMHgwNWIwLAogICJzaGV2YTExNSIsCiAgMHgwNWIwLAogICJzaGV2YTE1IiwKICAweDA1YjAsCiAgInNoZXZhMjIiLAogIDB4MDViMCwKICAic2hldmEyZSIsCiAgMHgwNWIwLAogICJzaGV2YWhlYnJldyIsCiAgMHgwNWIwLAogICJzaGV2YW5hcnJvd2hlYnJldyIsCiAgMHgwNWIwLAogICJzaGV2YXF1YXJ0ZXJoZWJyZXciLAogIDB4MDViMCwKICAic2hldmF3aWRlaGVicmV3IiwKICAweDA1YjAsCiAgInNoaGFjeXJpbGxpYyIsCiAgMHgwNGJiLAogICJzaGltYWNvcHRpYyIsCiAgMHgwM2VkLAogICJzaGluIiwKICAweDA1ZTksCiAgInNoaW5kYWdlc2giLAogIDB4ZmI0OSwKICAic2hpbmRhZ2VzaGhlYnJldyIsCiAgMHhmYjQ5LAogICJzaGluZGFnZXNoc2hpbmRvdCIsCiAgMHhmYjJjLAogICJzaGluZGFnZXNoc2hpbmRvdGhlYnJldyIsCiAgMHhmYjJjLAogICJzaGluZGFnZXNoc2luZG90IiwKICAweGZiMmQsCiAgInNoaW5kYWdlc2hzaW5kb3RoZWJyZXciLAogIDB4ZmIyZCwKICAic2hpbmRvdGhlYnJldyIsCiAgMHgwNWMxLAogICJzaGluaGVicmV3IiwKICAweDA1ZTksCiAgInNoaW5zaGluZG90IiwKICAweGZiMmEsCiAgInNoaW5zaGluZG90aGVicmV3IiwKICAweGZiMmEsCiAgInNoaW5zaW5kb3QiLAogIDB4ZmIyYiwKICAic2hpbnNpbmRvdGhlYnJldyIsCiAgMHhmYjJiLAogICJzaG9vayIsCiAgMHgwMjgyLAogICJzaWdtYSIsCiAgMHgwM2MzLAogICJzaWdtYTEiLAogIDB4MDNjMiwKICAic2lnbWFmaW5hbCIsCiAgMHgwM2MyLAogICJzaWdtYWx1bmF0ZXN5bWJvbGdyZWVrIiwKICAweDAzZjIsCiAgInNpaGlyYWdhbmEiLAogIDB4MzA1NywKICAic2lrYXRha2FuYSIsCiAgMHgzMGI3LAogICJzaWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmN2MsCiAgInNpbHVxaGVicmV3IiwKICAweDA1YmQsCiAgInNpbHVxbGVmdGhlYnJldyIsCiAgMHgwNWJkLAogICJzaW1pbGFyIiwKICAweDIyM2MsCiAgInNpbmRvdGhlYnJldyIsCiAgMHgwNWMyLAogICJzaW9zYWNpcmNsZWtvcmVhbiIsCiAgMHgzMjc0LAogICJzaW9zYXBhcmVua29yZWFuIiwKICAweDMyMTQsCiAgInNpb3NjaWV1Y2tvcmVhbiIsCiAgMHgzMTdlLAogICJzaW9zY2lyY2xla29yZWFuIiwKICAweDMyNjYsCiAgInNpb3NraXllb2trb3JlYW4iLAogIDB4MzE3YSwKICAic2lvc2tvcmVhbiIsCiAgMHgzMTQ1LAogICJzaW9zbmlldW5rb3JlYW4iLAogIDB4MzE3YiwKICAic2lvc3BhcmVua29yZWFuIiwKICAweDMyMDYsCiAgInNpb3NwaWV1cGtvcmVhbiIsCiAgMHgzMTdkLAogICJzaW9zdGlrZXV0a29yZWFuIiwKICAweDMxN2MsCiAgInNpeCIsCiAgMHgwMDM2LAogICJzaXhhcmFiaWMiLAogIDB4MDY2NiwKICAic2l4YmVuZ2FsaSIsCiAgMHgwOWVjLAogICJzaXhjaXJjbGUiLAogIDB4MjQ2NSwKICAic2l4Y2lyY2xlaW52ZXJzZXNhbnNzZXJpZiIsCiAgMHgyNzhmLAogICJzaXhkZXZhIiwKICAweDA5NmMsCiAgInNpeGd1amFyYXRpIiwKICAweDBhZWMsCiAgInNpeGd1cm11a2hpIiwKICAweDBhNmMsCiAgInNpeGhhY2thcmFiaWMiLAogIDB4MDY2NiwKICAic2l4aGFuZ3pob3UiLAogIDB4MzAyNiwKICAic2l4aWRlb2dyYXBoaWNwYXJlbiIsCiAgMHgzMjI1LAogICJzaXhpbmZlcmlvciIsCiAgMHgyMDg2LAogICJzaXhtb25vc3BhY2UiLAogIDB4ZmYxNiwKICAic2l4b2xkc3R5bGUiLAogIDB4ZjczNiwKICAic2l4cGFyZW4iLAogIDB4MjQ3OSwKICAic2l4cGVyaW9kIiwKICAweDI0OGQsCiAgInNpeHBlcnNpYW4iLAogIDB4MDZmNiwKICAic2l4cm9tYW4iLAogIDB4MjE3NSwKICAic2l4c3VwZXJpb3IiLAogIDB4MjA3NiwKICAic2l4dGVlbmNpcmNsZSIsCiAgMHgyNDZmLAogICJzaXh0ZWVuY3VycmVuY3lkZW5vbWluYXRvcmJlbmdhbGkiLAogIDB4MDlmOSwKICAic2l4dGVlbnBhcmVuIiwKICAweDI0ODMsCiAgInNpeHRlZW5wZXJpb2QiLAogIDB4MjQ5NywKICAic2l4dGhhaSIsCiAgMHgwZTU2LAogICJzbGFzaCIsCiAgMHgwMDJmLAogICJzbGFzaG1vbm9zcGFjZSIsCiAgMHhmZjBmLAogICJzbG9uZyIsCiAgMHgwMTdmLAogICJzbG9uZ2RvdGFjY2VudCIsCiAgMHgxZTliLAogICJzbWlsZWZhY2UiLAogIDB4MjYzYSwKICAic21vbm9zcGFjZSIsCiAgMHhmZjUzLAogICJzb2ZwYXN1cWhlYnJldyIsCiAgMHgwNWMzLAogICJzb2Z0aHlwaGVuIiwKICAweDAwYWQsCiAgInNvZnRzaWduY3lyaWxsaWMiLAogIDB4MDQ0YywKICAic29oaXJhZ2FuYSIsCiAgMHgzMDVkLAogICJzb2thdGFrYW5hIiwKICAweDMwYmQsCiAgInNva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3ZiwKICAic29saWR1c2xvbmdvdmVybGF5Y21iIiwKICAweDAzMzgsCiAgInNvbGlkdXNzaG9ydG92ZXJsYXljbWIiLAogIDB4MDMzNywKICAic29ydXNpdGhhaSIsCiAgMHgwZTI5LAogICJzb3NhbGF0aGFpIiwKICAweDBlMjgsCiAgInNvc290aGFpIiwKICAweDBlMGIsCiAgInNvc3VhdGhhaSIsCiAgMHgwZTJhLAogICJzcGFjZSIsCiAgMHgwMDIwLAogICJzcGFjZWhhY2thcmFiaWMiLAogIDB4MDAyMCwKICAic3BhZGUiLAogIDB4MjY2MCwKICAic3BhZGVzdWl0YmxhY2siLAogIDB4MjY2MCwKICAic3BhZGVzdWl0d2hpdGUiLAogIDB4MjY2NCwKICAic3BhcmVuIiwKICAweDI0YWUsCiAgInNxdWFyZWJlbG93Y21iIiwKICAweDAzM2IsCiAgInNxdWFyZWNjIiwKICAweDMzYzQsCiAgInNxdWFyZWNtIiwKICAweDMzOWQsCiAgInNxdWFyZWRpYWdvbmFsY3Jvc3NoYXRjaGZpbGwiLAogIDB4MjVhOSwKICAic3F1YXJlaG9yaXpvbnRhbGZpbGwiLAogIDB4MjVhNCwKICAic3F1YXJla2ciLAogIDB4MzM4ZiwKICAic3F1YXJla20iLAogIDB4MzM5ZSwKICAic3F1YXJla21jYXBpdGFsIiwKICAweDMzY2UsCiAgInNxdWFyZWxuIiwKICAweDMzZDEsCiAgInNxdWFyZWxvZyIsCiAgMHgzM2QyLAogICJzcXVhcmVtZyIsCiAgMHgzMzhlLAogICJzcXVhcmVtaWwiLAogIDB4MzNkNSwKICAic3F1YXJlbW0iLAogIDB4MzM5YywKICAic3F1YXJlbXNxdWFyZWQiLAogIDB4MzNhMSwKICAic3F1YXJlb3J0aG9nb25hbGNyb3NzaGF0Y2hmaWxsIiwKICAweDI1YTYsCiAgInNxdWFyZXVwcGVybGVmdHRvbG93ZXJyaWdodGZpbGwiLAogIDB4MjVhNywKICAic3F1YXJldXBwZXJyaWdodHRvbG93ZXJsZWZ0ZmlsbCIsCiAgMHgyNWE4LAogICJzcXVhcmV2ZXJ0aWNhbGZpbGwiLAogIDB4MjVhNSwKICAic3F1YXJld2hpdGV3aXRoc21hbGxibGFjayIsCiAgMHgyNWEzLAogICJzcnNxdWFyZSIsCiAgMHgzM2RiLAogICJzc2FiZW5nYWxpIiwKICAweDA5YjcsCiAgInNzYWRldmEiLAogIDB4MDkzNywKICAic3NhZ3VqYXJhdGkiLAogIDB4MGFiNywKICAic3NhbmdjaWV1Y2tvcmVhbiIsCiAgMHgzMTQ5LAogICJzc2FuZ2hpZXVoa29yZWFuIiwKICAweDMxODUsCiAgInNzYW5naWV1bmdrb3JlYW4iLAogIDB4MzE4MCwKICAic3NhbmdraXllb2trb3JlYW4iLAogIDB4MzEzMiwKICAic3NhbmduaWV1bmtvcmVhbiIsCiAgMHgzMTY1LAogICJzc2FuZ3BpZXVwa29yZWFuIiwKICAweDMxNDMsCiAgInNzYW5nc2lvc2tvcmVhbiIsCiAgMHgzMTQ2LAogICJzc2FuZ3Rpa2V1dGtvcmVhbiIsCiAgMHgzMTM4LAogICJzc3VwZXJpb3IiLAogIDB4ZjZmMiwKICAic3RlcmxpbmciLAogIDB4MDBhMywKICAic3Rlcmxpbmdtb25vc3BhY2UiLAogIDB4ZmZlMSwKICAic3Ryb2tlbG9uZ292ZXJsYXljbWIiLAogIDB4MDMzNiwKICAic3Ryb2tlc2hvcnRvdmVybGF5Y21iIiwKICAweDAzMzUsCiAgInN1YnNldCIsCiAgMHgyMjgyLAogICJzdWJzZXRub3RlcXVhbCIsCiAgMHgyMjhhLAogICJzdWJzZXRvcmVxdWFsIiwKICAweDIyODYsCiAgInN1Y2NlZWRzIiwKICAweDIyN2IsCiAgInN1Y2h0aGF0IiwKICAweDIyMGIsCiAgInN1aGlyYWdhbmEiLAogIDB4MzA1OSwKICAic3VrYXRha2FuYSIsCiAgMHgzMGI5LAogICJzdWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmN2QsCiAgInN1a3VuYXJhYmljIiwKICAweDA2NTIsCiAgInN1bW1hdGlvbiIsCiAgMHgyMjExLAogICJzdW4iLAogIDB4MjYzYywKICAic3VwZXJzZXQiLAogIDB4MjI4MywKICAic3VwZXJzZXRub3RlcXVhbCIsCiAgMHgyMjhiLAogICJzdXBlcnNldG9yZXF1YWwiLAogIDB4MjI4NywKICAic3ZzcXVhcmUiLAogIDB4MzNkYywKICAic3lvdXdhZXJhc3F1YXJlIiwKICAweDMzN2MsCiAgInQiLAogIDB4MDA3NCwKICAidGFiZW5nYWxpIiwKICAweDA5YTQsCiAgInRhY2tkb3duIiwKICAweDIyYTQsCiAgInRhY2tsZWZ0IiwKICAweDIyYTMsCiAgInRhZGV2YSIsCiAgMHgwOTI0LAogICJ0YWd1amFyYXRpIiwKICAweDBhYTQsCiAgInRhZ3VybXVraGkiLAogIDB4MGEyNCwKICAidGFoYXJhYmljIiwKICAweDA2MzcsCiAgInRhaGZpbmFsYXJhYmljIiwKICAweGZlYzIsCiAgInRhaGluaXRpYWxhcmFiaWMiLAogIDB4ZmVjMywKICAidGFoaXJhZ2FuYSIsCiAgMHgzMDVmLAogICJ0YWhtZWRpYWxhcmFiaWMiLAogIDB4ZmVjNCwKICAidGFpc3lvdWVyYXNxdWFyZSIsCiAgMHgzMzdkLAogICJ0YWthdGFrYW5hIiwKICAweDMwYmYsCiAgInRha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4MCwKICAidGF0d2VlbGFyYWJpYyIsCiAgMHgwNjQwLAogICJ0YXUiLAogIDB4MDNjNCwKICAidGF2IiwKICAweDA1ZWEsCiAgInRhdmRhZ2VzIiwKICAweGZiNGEsCiAgInRhdmRhZ2VzaCIsCiAgMHhmYjRhLAogICJ0YXZkYWdlc2hoZWJyZXciLAogIDB4ZmI0YSwKICAidGF2aGVicmV3IiwKICAweDA1ZWEsCiAgInRiYXIiLAogIDB4MDE2NywKICAidGJvcG9tb2ZvIiwKICAweDMxMGEsCiAgInRjYXJvbiIsCiAgMHgwMTY1LAogICJ0Y2N1cmwiLAogIDB4MDJhOCwKICAidGNlZGlsbGEiLAogIDB4MDE2MywKICAidGNoZWhhcmFiaWMiLAogIDB4MDY4NiwKICAidGNoZWhmaW5hbGFyYWJpYyIsCiAgMHhmYjdiLAogICJ0Y2hlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmI3YywKICAidGNoZWhtZWRpYWxhcmFiaWMiLAogIDB4ZmI3ZCwKICAidGNpcmNsZSIsCiAgMHgyNGUzLAogICJ0Y2lyY3VtZmxleGJlbG93IiwKICAweDFlNzEsCiAgInRjb21tYWFjY2VudCIsCiAgMHgwMTYzLAogICJ0ZGllcmVzaXMiLAogIDB4MWU5NywKICAidGRvdGFjY2VudCIsCiAgMHgxZTZiLAogICJ0ZG90YmVsb3ciLAogIDB4MWU2ZCwKICAidGVjeXJpbGxpYyIsCiAgMHgwNDQyLAogICJ0ZWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0YWQsCiAgInRlaGFyYWJpYyIsCiAgMHgwNjJhLAogICJ0ZWhmaW5hbGFyYWJpYyIsCiAgMHhmZTk2LAogICJ0ZWhoYWhpbml0aWFsYXJhYmljIiwKICAweGZjYTIsCiAgInRlaGhhaGlzb2xhdGVkYXJhYmljIiwKICAweGZjMGMsCiAgInRlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmU5NywKICAidGVoaXJhZ2FuYSIsCiAgMHgzMDY2LAogICJ0ZWhqZWVtaW5pdGlhbGFyYWJpYyIsCiAgMHhmY2ExLAogICJ0ZWhqZWVtaXNvbGF0ZWRhcmFiaWMiLAogIDB4ZmMwYiwKICAidGVobWFyYnV0YWFyYWJpYyIsCiAgMHgwNjI5LAogICJ0ZWhtYXJidXRhZmluYWxhcmFiaWMiLAogIDB4ZmU5NCwKICAidGVobWVkaWFsYXJhYmljIiwKICAweGZlOTgsCiAgInRlaG1lZW1pbml0aWFsYXJhYmljIiwKICAweGZjYTQsCiAgInRlaG1lZW1pc29sYXRlZGFyYWJpYyIsCiAgMHhmYzBlLAogICJ0ZWhub29uZmluYWxhcmFiaWMiLAogIDB4ZmM3MywKICAidGVrYXRha2FuYSIsCiAgMHgzMGM2LAogICJ0ZWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmODMsCiAgInRlbGVwaG9uZSIsCiAgMHgyMTIxLAogICJ0ZWxlcGhvbmVibGFjayIsCiAgMHgyNjBlLAogICJ0ZWxpc2hhZ2Vkb2xhaGVicmV3IiwKICAweDA1YTAsCiAgInRlbGlzaGFxZXRhbmFoZWJyZXciLAogIDB4MDVhOSwKICAidGVuY2lyY2xlIiwKICAweDI0NjksCiAgInRlbmlkZW9ncmFwaGljcGFyZW4iLAogIDB4MzIyOSwKICAidGVucGFyZW4iLAogIDB4MjQ3ZCwKICAidGVucGVyaW9kIiwKICAweDI0OTEsCiAgInRlbnJvbWFuIiwKICAweDIxNzksCiAgInRlc2giLAogIDB4MDJhNywKICAidGV0IiwKICAweDA1ZDgsCiAgInRldGRhZ2VzaCIsCiAgMHhmYjM4LAogICJ0ZXRkYWdlc2hoZWJyZXciLAogIDB4ZmIzOCwKICAidGV0aGVicmV3IiwKICAweDA1ZDgsCiAgInRldHNlY3lyaWxsaWMiLAogIDB4MDRiNSwKICAidGV2aXJoZWJyZXciLAogIDB4MDU5YiwKICAidGV2aXJsZWZ0aGVicmV3IiwKICAweDA1OWIsCiAgInRoYWJlbmdhbGkiLAogIDB4MDlhNSwKICAidGhhZGV2YSIsCiAgMHgwOTI1LAogICJ0aGFndWphcmF0aSIsCiAgMHgwYWE1LAogICJ0aGFndXJtdWtoaSIsCiAgMHgwYTI1LAogICJ0aGFsYXJhYmljIiwKICAweDA2MzAsCiAgInRoYWxmaW5hbGFyYWJpYyIsCiAgMHhmZWFjLAogICJ0aGFudGhha2hhdGxvd2xlZnR0aGFpIiwKICAweGY4OTgsCiAgInRoYW50aGFraGF0bG93cmlnaHR0aGFpIiwKICAweGY4OTcsCiAgInRoYW50aGFraGF0dGhhaSIsCiAgMHgwZTRjLAogICJ0aGFudGhha2hhdHVwcGVybGVmdHRoYWkiLAogIDB4Zjg5NiwKICAidGhlaGFyYWJpYyIsCiAgMHgwNjJiLAogICJ0aGVoZmluYWxhcmFiaWMiLAogIDB4ZmU5YSwKICAidGhlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmU5YiwKICAidGhlaG1lZGlhbGFyYWJpYyIsCiAgMHhmZTljLAogICJ0aGVyZWV4aXN0cyIsCiAgMHgyMjAzLAogICJ0aGVyZWZvcmUiLAogIDB4MjIzNCwKICAidGhldGEiLAogIDB4MDNiOCwKICAidGhldGExIiwKICAweDAzZDEsCiAgInRoZXRhc3ltYm9sZ3JlZWsiLAogIDB4MDNkMSwKICAidGhpZXV0aGFjaXJjbGVrb3JlYW4iLAogIDB4MzI3OSwKICAidGhpZXV0aGFwYXJlbmtvcmVhbiIsCiAgMHgzMjE5LAogICJ0aGlldXRoY2lyY2xla29yZWFuIiwKICAweDMyNmIsCiAgInRoaWV1dGhrb3JlYW4iLAogIDB4MzE0YywKICAidGhpZXV0aHBhcmVua29yZWFuIiwKICAweDMyMGIsCiAgInRoaXJ0ZWVuY2lyY2xlIiwKICAweDI0NmMsCiAgInRoaXJ0ZWVucGFyZW4iLAogIDB4MjQ4MCwKICAidGhpcnRlZW5wZXJpb2QiLAogIDB4MjQ5NCwKICAidGhvbmFuZ21vbnRob3RoYWkiLAogIDB4MGUxMSwKICAidGhvb2siLAogIDB4MDFhZCwKICAidGhvcGh1dGhhb3RoYWkiLAogIDB4MGUxMiwKICAidGhvcm4iLAogIDB4MDBmZSwKICAidGhvdGhhaGFudGhhaSIsCiAgMHgwZTE3LAogICJ0aG90aGFudGhhaSIsCiAgMHgwZTEwLAogICJ0aG90aG9uZ3RoYWkiLAogIDB4MGUxOCwKICAidGhvdGh1bmd0aGFpIiwKICAweDBlMTYsCiAgInRob3VzYW5kY3lyaWxsaWMiLAogIDB4MDQ4MiwKICAidGhvdXNhbmRzc2VwYXJhdG9yYXJhYmljIiwKICAweDA2NmMsCiAgInRob3VzYW5kc3NlcGFyYXRvcnBlcnNpYW4iLAogIDB4MDY2YywKICAidGhyZWUiLAogIDB4MDAzMywKICAidGhyZWVhcmFiaWMiLAogIDB4MDY2MywKICAidGhyZWViZW5nYWxpIiwKICAweDA5ZTksCiAgInRocmVlY2lyY2xlIiwKICAweDI0NjIsCiAgInRocmVlY2lyY2xlaW52ZXJzZXNhbnNzZXJpZiIsCiAgMHgyNzhjLAogICJ0aHJlZWRldmEiLAogIDB4MDk2OSwKICAidGhyZWVlaWdodGhzIiwKICAweDIxNWMsCiAgInRocmVlZ3VqYXJhdGkiLAogIDB4MGFlOSwKICAidGhyZWVndXJtdWtoaSIsCiAgMHgwYTY5LAogICJ0aHJlZWhhY2thcmFiaWMiLAogIDB4MDY2MywKICAidGhyZWVoYW5nemhvdSIsCiAgMHgzMDIzLAogICJ0aHJlZWlkZW9ncmFwaGljcGFyZW4iLAogIDB4MzIyMiwKICAidGhyZWVpbmZlcmlvciIsCiAgMHgyMDgzLAogICJ0aHJlZW1vbm9zcGFjZSIsCiAgMHhmZjEzLAogICJ0aHJlZW51bWVyYXRvcmJlbmdhbGkiLAogIDB4MDlmNiwKICAidGhyZWVvbGRzdHlsZSIsCiAgMHhmNzMzLAogICJ0aHJlZXBhcmVuIiwKICAweDI0NzYsCiAgInRocmVlcGVyaW9kIiwKICAweDI0OGEsCiAgInRocmVlcGVyc2lhbiIsCiAgMHgwNmYzLAogICJ0aHJlZXF1YXJ0ZXJzIiwKICAweDAwYmUsCiAgInRocmVlcXVhcnRlcnNlbWRhc2giLAogIDB4ZjZkZSwKICAidGhyZWVyb21hbiIsCiAgMHgyMTcyLAogICJ0aHJlZXN1cGVyaW9yIiwKICAweDAwYjMsCiAgInRocmVldGhhaSIsCiAgMHgwZTUzLAogICJ0aHpzcXVhcmUiLAogIDB4MzM5NCwKICAidGloaXJhZ2FuYSIsCiAgMHgzMDYxLAogICJ0aWthdGFrYW5hIiwKICAweDMwYzEsCiAgInRpa2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4MSwKICAidGlrZXV0YWNpcmNsZWtvcmVhbiIsCiAgMHgzMjcwLAogICJ0aWtldXRhcGFyZW5rb3JlYW4iLAogIDB4MzIxMCwKICAidGlrZXV0Y2lyY2xla29yZWFuIiwKICAweDMyNjIsCiAgInRpa2V1dGtvcmVhbiIsCiAgMHgzMTM3LAogICJ0aWtldXRwYXJlbmtvcmVhbiIsCiAgMHgzMjAyLAogICJ0aWxkZSIsCiAgMHgwMmRjLAogICJ0aWxkZWJlbG93Y21iIiwKICAweDAzMzAsCiAgInRpbGRlY21iIiwKICAweDAzMDMsCiAgInRpbGRlY29tYiIsCiAgMHgwMzAzLAogICJ0aWxkZWRvdWJsZWNtYiIsCiAgMHgwMzYwLAogICJ0aWxkZW9wZXJhdG9yIiwKICAweDIyM2MsCiAgInRpbGRlb3ZlcmxheWNtYiIsCiAgMHgwMzM0LAogICJ0aWxkZXZlcnRpY2FsY21iIiwKICAweDAzM2UsCiAgInRpbWVzY2lyY2xlIiwKICAweDIyOTcsCiAgInRpcGVoYWhlYnJldyIsCiAgMHgwNTk2LAogICJ0aXBlaGFsZWZ0aGVicmV3IiwKICAweDA1OTYsCiAgInRpcHBpZ3VybXVraGkiLAogIDB4MGE3MCwKICAidGl0bG9jeXJpbGxpY2NtYiIsCiAgMHgwNDgzLAogICJ0aXduYXJtZW5pYW4iLAogIDB4MDU3ZiwKICAidGxpbmViZWxvdyIsCiAgMHgxZTZmLAogICJ0bW9ub3NwYWNlIiwKICAweGZmNTQsCiAgInRvYXJtZW5pYW4iLAogIDB4MDU2OSwKICAidG9oaXJhZ2FuYSIsCiAgMHgzMDY4LAogICJ0b2thdGFrYW5hIiwKICAweDMwYzgsCiAgInRva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4NCwKICAidG9uZWJhcmV4dHJhaGlnaG1vZCIsCiAgMHgwMmU1LAogICJ0b25lYmFyZXh0cmFsb3dtb2QiLAogIDB4MDJlOSwKICAidG9uZWJhcmhpZ2htb2QiLAogIDB4MDJlNiwKICAidG9uZWJhcmxvd21vZCIsCiAgMHgwMmU4LAogICJ0b25lYmFybWlkbW9kIiwKICAweDAyZTcsCiAgInRvbmVmaXZlIiwKICAweDAxYmQsCiAgInRvbmVzaXgiLAogIDB4MDE4NSwKICAidG9uZXR3byIsCiAgMHgwMWE4LAogICJ0b25vcyIsCiAgMHgwMzg0LAogICJ0b25zcXVhcmUiLAogIDB4MzMyNywKICAidG9wYXRha3RoYWkiLAogIDB4MGUwZiwKICAidG9ydG9pc2VzaGVsbGJyYWNrZXRsZWZ0IiwKICAweDMwMTQsCiAgInRvcnRvaXNlc2hlbGxicmFja2V0bGVmdHNtYWxsIiwKICAweGZlNWQsCiAgInRvcnRvaXNlc2hlbGxicmFja2V0bGVmdHZlcnRpY2FsIiwKICAweGZlMzksCiAgInRvcnRvaXNlc2hlbGxicmFja2V0cmlnaHQiLAogIDB4MzAxNSwKICAidG9ydG9pc2VzaGVsbGJyYWNrZXRyaWdodHNtYWxsIiwKICAweGZlNWUsCiAgInRvcnRvaXNlc2hlbGxicmFja2V0cmlnaHR2ZXJ0aWNhbCIsCiAgMHhmZTNhLAogICJ0b3Rhb3RoYWkiLAogIDB4MGUxNSwKICAidHBhbGF0YWxob29rIiwKICAweDAxYWIsCiAgInRwYXJlbiIsCiAgMHgyNGFmLAogICJ0cmFkZW1hcmsiLAogIDB4MjEyMiwKICAidHJhZGVtYXJrc2FucyIsCiAgMHhmOGVhLAogICJ0cmFkZW1hcmtzZXJpZiIsCiAgMHhmNmRiLAogICJ0cmV0cm9mbGV4aG9vayIsCiAgMHgwMjg4LAogICJ0cmlhZ2RuIiwKICAweDI1YmMsCiAgInRyaWFnbGYiLAogIDB4MjVjNCwKICAidHJpYWdydCIsCiAgMHgyNWJhLAogICJ0cmlhZ3VwIiwKICAweDI1YjIsCiAgInRzIiwKICAweDAyYTYsCiAgInRzYWRpIiwKICAweDA1ZTYsCiAgInRzYWRpZGFnZXNoIiwKICAweGZiNDYsCiAgInRzYWRpZGFnZXNoaGVicmV3IiwKICAweGZiNDYsCiAgInRzYWRpaGVicmV3IiwKICAweDA1ZTYsCiAgInRzZWN5cmlsbGljIiwKICAweDA0NDYsCiAgInRzZXJlIiwKICAweDA1YjUsCiAgInRzZXJlMTIiLAogIDB4MDViNSwKICAidHNlcmUxZSIsCiAgMHgwNWI1LAogICJ0c2VyZTJiIiwKICAweDA1YjUsCiAgInRzZXJlaGVicmV3IiwKICAweDA1YjUsCiAgInRzZXJlbmFycm93aGVicmV3IiwKICAweDA1YjUsCiAgInRzZXJlcXVhcnRlcmhlYnJldyIsCiAgMHgwNWI1LAogICJ0c2VyZXdpZGVoZWJyZXciLAogIDB4MDViNSwKICAidHNoZWN5cmlsbGljIiwKICAweDA0NWIsCiAgInRzdXBlcmlvciIsCiAgMHhmNmYzLAogICJ0dGFiZW5nYWxpIiwKICAweDA5OWYsCiAgInR0YWRldmEiLAogIDB4MDkxZiwKICAidHRhZ3VqYXJhdGkiLAogIDB4MGE5ZiwKICAidHRhZ3VybXVraGkiLAogIDB4MGExZiwKICAidHRlaGFyYWJpYyIsCiAgMHgwNjc5LAogICJ0dGVoZmluYWxhcmFiaWMiLAogIDB4ZmI2NywKICAidHRlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmI2OCwKICAidHRlaG1lZGlhbGFyYWJpYyIsCiAgMHhmYjY5LAogICJ0dGhhYmVuZ2FsaSIsCiAgMHgwOWEwLAogICJ0dGhhZGV2YSIsCiAgMHgwOTIwLAogICJ0dGhhZ3VqYXJhdGkiLAogIDB4MGFhMCwKICAidHRoYWd1cm11a2hpIiwKICAweDBhMjAsCiAgInR0dXJuZWQiLAogIDB4MDI4NywKICAidHVoaXJhZ2FuYSIsCiAgMHgzMDY0LAogICJ0dWthdGFrYW5hIiwKICAweDMwYzQsCiAgInR1a2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4MiwKICAidHVzbWFsbGhpcmFnYW5hIiwKICAweDMwNjMsCiAgInR1c21hbGxrYXRha2FuYSIsCiAgMHgzMGMzLAogICJ0dXNtYWxsa2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY2ZiwKICAidHdlbHZlY2lyY2xlIiwKICAweDI0NmIsCiAgInR3ZWx2ZXBhcmVuIiwKICAweDI0N2YsCiAgInR3ZWx2ZXBlcmlvZCIsCiAgMHgyNDkzLAogICJ0d2VsdmVyb21hbiIsCiAgMHgyMTdiLAogICJ0d2VudHljaXJjbGUiLAogIDB4MjQ3MywKICAidHdlbnR5aGFuZ3pob3UiLAogIDB4NTM0NCwKICAidHdlbnR5cGFyZW4iLAogIDB4MjQ4NywKICAidHdlbnR5cGVyaW9kIiwKICAweDI0OWIsCiAgInR3byIsCiAgMHgwMDMyLAogICJ0d29hcmFiaWMiLAogIDB4MDY2MiwKICAidHdvYmVuZ2FsaSIsCiAgMHgwOWU4LAogICJ0d29jaXJjbGUiLAogIDB4MjQ2MSwKICAidHdvY2lyY2xlaW52ZXJzZXNhbnNzZXJpZiIsCiAgMHgyNzhiLAogICJ0d29kZXZhIiwKICAweDA5NjgsCiAgInR3b2RvdGVubGVhZGVyIiwKICAweDIwMjUsCiAgInR3b2RvdGxlYWRlciIsCiAgMHgyMDI1LAogICJ0d29kb3RsZWFkZXJ2ZXJ0aWNhbCIsCiAgMHhmZTMwLAogICJ0d29ndWphcmF0aSIsCiAgMHgwYWU4LAogICJ0d29ndXJtdWtoaSIsCiAgMHgwYTY4LAogICJ0d29oYWNrYXJhYmljIiwKICAweDA2NjIsCiAgInR3b2hhbmd6aG91IiwKICAweDMwMjIsCiAgInR3b2lkZW9ncmFwaGljcGFyZW4iLAogIDB4MzIyMSwKICAidHdvaW5mZXJpb3IiLAogIDB4MjA4MiwKICAidHdvbW9ub3NwYWNlIiwKICAweGZmMTIsCiAgInR3b251bWVyYXRvcmJlbmdhbGkiLAogIDB4MDlmNSwKICAidHdvb2xkc3R5bGUiLAogIDB4ZjczMiwKICAidHdvcGFyZW4iLAogIDB4MjQ3NSwKICAidHdvcGVyaW9kIiwKICAweDI0ODksCiAgInR3b3BlcnNpYW4iLAogIDB4MDZmMiwKICAidHdvcm9tYW4iLAogIDB4MjE3MSwKICAidHdvc3Ryb2tlIiwKICAweDAxYmIsCiAgInR3b3N1cGVyaW9yIiwKICAweDAwYjIsCiAgInR3b3RoYWkiLAogIDB4MGU1MiwKICAidHdvdGhpcmRzIiwKICAweDIxNTQsCiAgInUiLAogIDB4MDA3NSwKICAidWFjdXRlIiwKICAweDAwZmEsCiAgInViYXIiLAogIDB4MDI4OSwKICAidWJlbmdhbGkiLAogIDB4MDk4OSwKICAidWJvcG9tb2ZvIiwKICAweDMxMjgsCiAgInVicmV2ZSIsCiAgMHgwMTZkLAogICJ1Y2Fyb24iLAogIDB4MDFkNCwKICAidWNpcmNsZSIsCiAgMHgyNGU0LAogICJ1Y2lyY3VtZmxleCIsCiAgMHgwMGZiLAogICJ1Y2lyY3VtZmxleGJlbG93IiwKICAweDFlNzcsCiAgInVjeXJpbGxpYyIsCiAgMHgwNDQzLAogICJ1ZGF0dGFkZXZhIiwKICAweDA5NTEsCiAgInVkYmxhY3V0ZSIsCiAgMHgwMTcxLAogICJ1ZGJsZ3JhdmUiLAogIDB4MDIxNSwKICAidWRldmEiLAogIDB4MDkwOSwKICAidWRpZXJlc2lzIiwKICAweDAwZmMsCiAgInVkaWVyZXNpc2FjdXRlIiwKICAweDAxZDgsCiAgInVkaWVyZXNpc2JlbG93IiwKICAweDFlNzMsCiAgInVkaWVyZXNpc2Nhcm9uIiwKICAweDAxZGEsCiAgInVkaWVyZXNpc2N5cmlsbGljIiwKICAweDA0ZjEsCiAgInVkaWVyZXNpc2dyYXZlIiwKICAweDAxZGMsCiAgInVkaWVyZXNpc21hY3JvbiIsCiAgMHgwMWQ2LAogICJ1ZG90YmVsb3ciLAogIDB4MWVlNSwKICAidWdyYXZlIiwKICAweDAwZjksCiAgInVndWphcmF0aSIsCiAgMHgwYTg5LAogICJ1Z3VybXVraGkiLAogIDB4MGEwOSwKICAidWhpcmFnYW5hIiwKICAweDMwNDYsCiAgInVob29rYWJvdmUiLAogIDB4MWVlNywKICAidWhvcm4iLAogIDB4MDFiMCwKICAidWhvcm5hY3V0ZSIsCiAgMHgxZWU5LAogICJ1aG9ybmRvdGJlbG93IiwKICAweDFlZjEsCiAgInVob3JuZ3JhdmUiLAogIDB4MWVlYiwKICAidWhvcm5ob29rYWJvdmUiLAogIDB4MWVlZCwKICAidWhvcm50aWxkZSIsCiAgMHgxZWVmLAogICJ1aHVuZ2FydW1sYXV0IiwKICAweDAxNzEsCiAgInVodW5nYXJ1bWxhdXRjeXJpbGxpYyIsCiAgMHgwNGYzLAogICJ1aW52ZXJ0ZWRicmV2ZSIsCiAgMHgwMjE3LAogICJ1a2F0YWthbmEiLAogIDB4MzBhNiwKICAidWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNzMsCiAgInVrY3lyaWxsaWMiLAogIDB4MDQ3OSwKICAidWtvcmVhbiIsCiAgMHgzMTVjLAogICJ1bWFjcm9uIiwKICAweDAxNmIsCiAgInVtYWNyb25jeXJpbGxpYyIsCiAgMHgwNGVmLAogICJ1bWFjcm9uZGllcmVzaXMiLAogIDB4MWU3YiwKICAidW1hdHJhZ3VybXVraGkiLAogIDB4MGE0MSwKICAidW1vbm9zcGFjZSIsCiAgMHhmZjU1LAogICJ1bmRlcnNjb3JlIiwKICAweDAwNWYsCiAgInVuZGVyc2NvcmVkYmwiLAogIDB4MjAxNywKICAidW5kZXJzY29yZW1vbm9zcGFjZSIsCiAgMHhmZjNmLAogICJ1bmRlcnNjb3JldmVydGljYWwiLAogIDB4ZmUzMywKICAidW5kZXJzY29yZXdhdnkiLAogIDB4ZmU0ZiwKICAidW5pb24iLAogIDB4MjIyYSwKICAidW5pdmVyc2FsIiwKICAweDIyMDAsCiAgInVvZ29uZWsiLAogIDB4MDE3MywKICAidXBhcmVuIiwKICAweDI0YjAsCiAgInVwYmxvY2siLAogIDB4MjU4MCwKICAidXBwZXJkb3RoZWJyZXciLAogIDB4MDVjNCwKICAidXBzaWxvbiIsCiAgMHgwM2M1LAogICJ1cHNpbG9uZGllcmVzaXMiLAogIDB4MDNjYiwKICAidXBzaWxvbmRpZXJlc2lzdG9ub3MiLAogIDB4MDNiMCwKICAidXBzaWxvbmxhdGluIiwKICAweDAyOGEsCiAgInVwc2lsb250b25vcyIsCiAgMHgwM2NkLAogICJ1cHRhY2tiZWxvd2NtYiIsCiAgMHgwMzFkLAogICJ1cHRhY2ttb2QiLAogIDB4MDJkNCwKICAidXJhZ3VybXVraGkiLAogIDB4MGE3MywKICAidXJpbmciLAogIDB4MDE2ZiwKICAidXNob3J0Y3lyaWxsaWMiLAogIDB4MDQ1ZSwKICAidXNtYWxsaGlyYWdhbmEiLAogIDB4MzA0NSwKICAidXNtYWxsa2F0YWthbmEiLAogIDB4MzBhNSwKICAidXNtYWxsa2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY2OSwKICAidXN0cmFpZ2h0Y3lyaWxsaWMiLAogIDB4MDRhZiwKICAidXN0cmFpZ2h0c3Ryb2tlY3lyaWxsaWMiLAogIDB4MDRiMSwKICAidXRpbGRlIiwKICAweDAxNjksCiAgInV0aWxkZWFjdXRlIiwKICAweDFlNzksCiAgInV0aWxkZWJlbG93IiwKICAweDFlNzUsCiAgInV1YmVuZ2FsaSIsCiAgMHgwOThhLAogICJ1dWRldmEiLAogIDB4MDkwYSwKICAidXVndWphcmF0aSIsCiAgMHgwYThhLAogICJ1dWd1cm11a2hpIiwKICAweDBhMGEsCiAgInV1bWF0cmFndXJtdWtoaSIsCiAgMHgwYTQyLAogICJ1dXZvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljMiwKICAidXV2b3dlbHNpZ25kZXZhIiwKICAweDA5NDIsCiAgInV1dm93ZWxzaWduZ3VqYXJhdGkiLAogIDB4MGFjMiwKICAidXZvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljMSwKICAidXZvd2Vsc2lnbmRldmEiLAogIDB4MDk0MSwKICAidXZvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhYzEsCiAgInYiLAogIDB4MDA3NiwKICAidmFkZXZhIiwKICAweDA5MzUsCiAgInZhZ3VqYXJhdGkiLAogIDB4MGFiNSwKICAidmFndXJtdWtoaSIsCiAgMHgwYTM1LAogICJ2YWthdGFrYW5hIiwKICAweDMwZjcsCiAgInZhdiIsCiAgMHgwNWQ1LAogICJ2YXZkYWdlc2giLAogIDB4ZmIzNSwKICAidmF2ZGFnZXNoNjUiLAogIDB4ZmIzNSwKICAidmF2ZGFnZXNoaGVicmV3IiwKICAweGZiMzUsCiAgInZhdmhlYnJldyIsCiAgMHgwNWQ1LAogICJ2YXZob2xhbSIsCiAgMHhmYjRiLAogICJ2YXZob2xhbWhlYnJldyIsCiAgMHhmYjRiLAogICJ2YXZ2YXZoZWJyZXciLAogIDB4MDVmMCwKICAidmF2eW9kaGVicmV3IiwKICAweDA1ZjEsCiAgInZjaXJjbGUiLAogIDB4MjRlNSwKICAidmRvdGJlbG93IiwKICAweDFlN2YsCiAgInZlY3lyaWxsaWMiLAogIDB4MDQzMiwKICAidmVoYXJhYmljIiwKICAweDA2YTQsCiAgInZlaGZpbmFsYXJhYmljIiwKICAweGZiNmIsCiAgInZlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmI2YywKICAidmVobWVkaWFsYXJhYmljIiwKICAweGZiNmQsCiAgInZla2F0YWthbmEiLAogIDB4MzBmOSwKICAidmVudXMiLAogIDB4MjY0MCwKICAidmVydGljYWxiYXIiLAogIDB4MDA3YywKICAidmVydGljYWxsaW5lYWJvdmVjbWIiLAogIDB4MDMwZCwKICAidmVydGljYWxsaW5lYmVsb3djbWIiLAogIDB4MDMyOSwKICAidmVydGljYWxsaW5lbG93bW9kIiwKICAweDAyY2MsCiAgInZlcnRpY2FsbGluZW1vZCIsCiAgMHgwMmM4LAogICJ2ZXdhcm1lbmlhbiIsCiAgMHgwNTdlLAogICJ2aG9vayIsCiAgMHgwMjhiLAogICJ2aWthdGFrYW5hIiwKICAweDMwZjgsCiAgInZpcmFtYWJlbmdhbGkiLAogIDB4MDljZCwKICAidmlyYW1hZGV2YSIsCiAgMHgwOTRkLAogICJ2aXJhbWFndWphcmF0aSIsCiAgMHgwYWNkLAogICJ2aXNhcmdhYmVuZ2FsaSIsCiAgMHgwOTgzLAogICJ2aXNhcmdhZGV2YSIsCiAgMHgwOTAzLAogICJ2aXNhcmdhZ3VqYXJhdGkiLAogIDB4MGE4MywKICAidm1vbm9zcGFjZSIsCiAgMHhmZjU2LAogICJ2b2FybWVuaWFuIiwKICAweDA1NzgsCiAgInZvaWNlZGl0ZXJhdGlvbmhpcmFnYW5hIiwKICAweDMwOWUsCiAgInZvaWNlZGl0ZXJhdGlvbmthdGFrYW5hIiwKICAweDMwZmUsCiAgInZvaWNlZG1hcmtrYW5hIiwKICAweDMwOWIsCiAgInZvaWNlZG1hcmtrYW5haGFsZndpZHRoIiwKICAweGZmOWUsCiAgInZva2F0YWthbmEiLAogIDB4MzBmYSwKICAidnBhcmVuIiwKICAweDI0YjEsCiAgInZ0aWxkZSIsCiAgMHgxZTdkLAogICJ2dHVybmVkIiwKICAweDAyOGMsCiAgInZ1aGlyYWdhbmEiLAogIDB4MzA5NCwKICAidnVrYXRha2FuYSIsCiAgMHgzMGY0LAogICJ3IiwKICAweDAwNzcsCiAgIndhY3V0ZSIsCiAgMHgxZTgzLAogICJ3YWVrb3JlYW4iLAogIDB4MzE1OSwKICAid2FoaXJhZ2FuYSIsCiAgMHgzMDhmLAogICJ3YWthdGFrYW5hIiwKICAweDMwZWYsCiAgIndha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5YywKICAid2Frb3JlYW4iLAogIDB4MzE1OCwKICAid2FzbWFsbGhpcmFnYW5hIiwKICAweDMwOGUsCiAgIndhc21hbGxrYXRha2FuYSIsCiAgMHgzMGVlLAogICJ3YXR0b3NxdWFyZSIsCiAgMHgzMzU3LAogICJ3YXZlZGFzaCIsCiAgMHgzMDFjLAogICJ3YXZ5dW5kZXJzY29yZXZlcnRpY2FsIiwKICAweGZlMzQsCiAgIndhd2FyYWJpYyIsCiAgMHgwNjQ4LAogICJ3YXdmaW5hbGFyYWJpYyIsCiAgMHhmZWVlLAogICJ3YXdoYW16YWFib3ZlYXJhYmljIiwKICAweDA2MjQsCiAgIndhd2hhbXphYWJvdmVmaW5hbGFyYWJpYyIsCiAgMHhmZTg2LAogICJ3YnNxdWFyZSIsCiAgMHgzM2RkLAogICJ3Y2lyY2xlIiwKICAweDI0ZTYsCiAgIndjaXJjdW1mbGV4IiwKICAweDAxNzUsCiAgIndkaWVyZXNpcyIsCiAgMHgxZTg1LAogICJ3ZG90YWNjZW50IiwKICAweDFlODcsCiAgIndkb3RiZWxvdyIsCiAgMHgxZTg5LAogICJ3ZWhpcmFnYW5hIiwKICAweDMwOTEsCiAgIndlaWVyc3RyYXNzIiwKICAweDIxMTgsCiAgIndla2F0YWthbmEiLAogIDB4MzBmMSwKICAid2Vrb3JlYW4iLAogIDB4MzE1ZSwKICAid2Vva29yZWFuIiwKICAweDMxNWQsCiAgIndncmF2ZSIsCiAgMHgxZTgxLAogICJ3aGl0ZWJ1bGxldCIsCiAgMHgyNWU2LAogICJ3aGl0ZWNpcmNsZSIsCiAgMHgyNWNiLAogICJ3aGl0ZWNpcmNsZWludmVyc2UiLAogIDB4MjVkOSwKICAid2hpdGVjb3JuZXJicmFja2V0bGVmdCIsCiAgMHgzMDBlLAogICJ3aGl0ZWNvcm5lcmJyYWNrZXRsZWZ0dmVydGljYWwiLAogIDB4ZmU0MywKICAid2hpdGVjb3JuZXJicmFja2V0cmlnaHQiLAogIDB4MzAwZiwKICAid2hpdGVjb3JuZXJicmFja2V0cmlnaHR2ZXJ0aWNhbCIsCiAgMHhmZTQ0LAogICJ3aGl0ZWRpYW1vbmQiLAogIDB4MjVjNywKICAid2hpdGVkaWFtb25kY29udGFpbmluZ2JsYWNrc21hbGxkaWFtb25kIiwKICAweDI1YzgsCiAgIndoaXRlZG93bnBvaW50aW5nc21hbGx0cmlhbmdsZSIsCiAgMHgyNWJmLAogICJ3aGl0ZWRvd25wb2ludGluZ3RyaWFuZ2xlIiwKICAweDI1YmQsCiAgIndoaXRlbGVmdHBvaW50aW5nc21hbGx0cmlhbmdsZSIsCiAgMHgyNWMzLAogICJ3aGl0ZWxlZnRwb2ludGluZ3RyaWFuZ2xlIiwKICAweDI1YzEsCiAgIndoaXRlbGVudGljdWxhcmJyYWNrZXRsZWZ0IiwKICAweDMwMTYsCiAgIndoaXRlbGVudGljdWxhcmJyYWNrZXRyaWdodCIsCiAgMHgzMDE3LAogICJ3aGl0ZXJpZ2h0cG9pbnRpbmdzbWFsbHRyaWFuZ2xlIiwKICAweDI1YjksCiAgIndoaXRlcmlnaHRwb2ludGluZ3RyaWFuZ2xlIiwKICAweDI1YjcsCiAgIndoaXRlc21hbGxzcXVhcmUiLAogIDB4MjVhYiwKICAid2hpdGVzbWlsaW5nZmFjZSIsCiAgMHgyNjNhLAogICJ3aGl0ZXNxdWFyZSIsCiAgMHgyNWExLAogICJ3aGl0ZXN0YXIiLAogIDB4MjYwNiwKICAid2hpdGV0ZWxlcGhvbmUiLAogIDB4MjYwZiwKICAid2hpdGV0b3J0b2lzZXNoZWxsYnJhY2tldGxlZnQiLAogIDB4MzAxOCwKICAid2hpdGV0b3J0b2lzZXNoZWxsYnJhY2tldHJpZ2h0IiwKICAweDMwMTksCiAgIndoaXRldXBwb2ludGluZ3NtYWxsdHJpYW5nbGUiLAogIDB4MjViNSwKICAid2hpdGV1cHBvaW50aW5ndHJpYW5nbGUiLAogIDB4MjViMywKICAid2loaXJhZ2FuYSIsCiAgMHgzMDkwLAogICJ3aWthdGFrYW5hIiwKICAweDMwZjAsCiAgIndpa29yZWFuIiwKICAweDMxNWYsCiAgIndtb25vc3BhY2UiLAogIDB4ZmY1NywKICAid29oaXJhZ2FuYSIsCiAgMHgzMDkyLAogICJ3b2thdGFrYW5hIiwKICAweDMwZjIsCiAgIndva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY2NiwKICAid29uIiwKICAweDIwYTksCiAgIndvbm1vbm9zcGFjZSIsCiAgMHhmZmU2LAogICJ3b3dhZW50aGFpIiwKICAweDBlMjcsCiAgIndwYXJlbiIsCiAgMHgyNGIyLAogICJ3cmluZyIsCiAgMHgxZTk4LAogICJ3c3VwZXJpb3IiLAogIDB4MDJiNywKICAid3R1cm5lZCIsCiAgMHgwMjhkLAogICJ3eW5uIiwKICAweDAxYmYsCiAgIngiLAogIDB4MDA3OCwKICAieGFib3ZlY21iIiwKICAweDAzM2QsCiAgInhib3BvbW9mbyIsCiAgMHgzMTEyLAogICJ4Y2lyY2xlIiwKICAweDI0ZTcsCiAgInhkaWVyZXNpcyIsCiAgMHgxZThkLAogICJ4ZG90YWNjZW50IiwKICAweDFlOGIsCiAgInhlaGFybWVuaWFuIiwKICAweDA1NmQsCiAgInhpIiwKICAweDAzYmUsCiAgInhtb25vc3BhY2UiLAogIDB4ZmY1OCwKICAieHBhcmVuIiwKICAweDI0YjMsCiAgInhzdXBlcmlvciIsCiAgMHgwMmUzLAogICJ5IiwKICAweDAwNzksCiAgInlhYWRvc3F1YXJlIiwKICAweDMzNGUsCiAgInlhYmVuZ2FsaSIsCiAgMHgwOWFmLAogICJ5YWN1dGUiLAogIDB4MDBmZCwKICAieWFkZXZhIiwKICAweDA5MmYsCiAgInlhZWtvcmVhbiIsCiAgMHgzMTUyLAogICJ5YWd1amFyYXRpIiwKICAweDBhYWYsCiAgInlhZ3VybXVraGkiLAogIDB4MGEyZiwKICAieWFoaXJhZ2FuYSIsCiAgMHgzMDg0LAogICJ5YWthdGFrYW5hIiwKICAweDMwZTQsCiAgInlha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5NCwKICAieWFrb3JlYW4iLAogIDB4MzE1MSwKICAieWFtYWtrYW50aGFpIiwKICAweDBlNGUsCiAgInlhc21hbGxoaXJhZ2FuYSIsCiAgMHgzMDgzLAogICJ5YXNtYWxsa2F0YWthbmEiLAogIDB4MzBlMywKICAieWFzbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNmMsCiAgInlhdGN5cmlsbGljIiwKICAweDA0NjMsCiAgInljaXJjbGUiLAogIDB4MjRlOCwKICAieWNpcmN1bWZsZXgiLAogIDB4MDE3NywKICAieWRpZXJlc2lzIiwKICAweDAwZmYsCiAgInlkb3RhY2NlbnQiLAogIDB4MWU4ZiwKICAieWRvdGJlbG93IiwKICAweDFlZjUsCiAgInllaGFyYWJpYyIsCiAgMHgwNjRhLAogICJ5ZWhiYXJyZWVhcmFiaWMiLAogIDB4MDZkMiwKICAieWVoYmFycmVlZmluYWxhcmFiaWMiLAogIDB4ZmJhZiwKICAieWVoZmluYWxhcmFiaWMiLAogIDB4ZmVmMiwKICAieWVoaGFtemFhYm92ZWFyYWJpYyIsCiAgMHgwNjI2LAogICJ5ZWhoYW16YWFib3ZlZmluYWxhcmFiaWMiLAogIDB4ZmU4YSwKICAieWVoaGFtemFhYm92ZWluaXRpYWxhcmFiaWMiLAogIDB4ZmU4YiwKICAieWVoaGFtemFhYm92ZW1lZGlhbGFyYWJpYyIsCiAgMHhmZThjLAogICJ5ZWhpbml0aWFsYXJhYmljIiwKICAweGZlZjMsCiAgInllaG1lZGlhbGFyYWJpYyIsCiAgMHhmZWY0LAogICJ5ZWhtZWVtaW5pdGlhbGFyYWJpYyIsCiAgMHhmY2RkLAogICJ5ZWhtZWVtaXNvbGF0ZWRhcmFiaWMiLAogIDB4ZmM1OCwKICAieWVobm9vbmZpbmFsYXJhYmljIiwKICAweGZjOTQsCiAgInllaHRocmVlZG90c2JlbG93YXJhYmljIiwKICAweDA2ZDEsCiAgInlla29yZWFuIiwKICAweDMxNTYsCiAgInllbiIsCiAgMHgwMGE1LAogICJ5ZW5tb25vc3BhY2UiLAogIDB4ZmZlNSwKICAieWVva29yZWFuIiwKICAweDMxNTUsCiAgInllb3JpbmhpZXVoa29yZWFuIiwKICAweDMxODYsCiAgInllcmFoYmVueW9tb2hlYnJldyIsCiAgMHgwNWFhLAogICJ5ZXJhaGJlbnlvbW9sZWZ0aGVicmV3IiwKICAweDA1YWEsCiAgInllcmljeXJpbGxpYyIsCiAgMHgwNDRiLAogICJ5ZXJ1ZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGY5LAogICJ5ZXNpZXVuZ2tvcmVhbiIsCiAgMHgzMTgxLAogICJ5ZXNpZXVuZ3BhbnNpb3Nrb3JlYW4iLAogIDB4MzE4MywKICAieWVzaWV1bmdzaW9za29yZWFuIiwKICAweDMxODIsCiAgInlldGl2aGVicmV3IiwKICAweDA1OWEsCiAgInlncmF2ZSIsCiAgMHgxZWYzLAogICJ5aG9vayIsCiAgMHgwMWI0LAogICJ5aG9va2Fib3ZlIiwKICAweDFlZjcsCiAgInlpYXJtZW5pYW4iLAogIDB4MDU3NSwKICAieWljeXJpbGxpYyIsCiAgMHgwNDU3LAogICJ5aWtvcmVhbiIsCiAgMHgzMTYyLAogICJ5aW55YW5nIiwKICAweDI2MmYsCiAgInlpd25hcm1lbmlhbiIsCiAgMHgwNTgyLAogICJ5bW9ub3NwYWNlIiwKICAweGZmNTksCiAgInlvZCIsCiAgMHgwNWQ5LAogICJ5b2RkYWdlc2giLAogIDB4ZmIzOSwKICAieW9kZGFnZXNoaGVicmV3IiwKICAweGZiMzksCiAgInlvZGhlYnJldyIsCiAgMHgwNWQ5LAogICJ5b2R5b2RoZWJyZXciLAogIDB4MDVmMiwKICAieW9keW9kcGF0YWhoZWJyZXciLAogIDB4ZmIxZiwKICAieW9oaXJhZ2FuYSIsCiAgMHgzMDg4LAogICJ5b2lrb3JlYW4iLAogIDB4MzE4OSwKICAieW9rYXRha2FuYSIsCiAgMHgzMGU4LAogICJ5b2thdGFrYW5haGFsZndpZHRoIiwKICAweGZmOTYsCiAgInlva29yZWFuIiwKICAweDMxNWIsCiAgInlvc21hbGxoaXJhZ2FuYSIsCiAgMHgzMDg3LAogICJ5b3NtYWxsa2F0YWthbmEiLAogIDB4MzBlNywKICAieW9zbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNmUsCiAgInlvdGdyZWVrIiwKICAweDAzZjMsCiAgInlveWFla29yZWFuIiwKICAweDMxODgsCiAgInlveWFrb3JlYW4iLAogIDB4MzE4NywKICAieW95YWt0aGFpIiwKICAweDBlMjIsCiAgInlveWluZ3RoYWkiLAogIDB4MGUwZCwKICAieXBhcmVuIiwKICAweDI0YjQsCiAgInlwb2dlZ3JhbW1lbmkiLAogIDB4MDM3YSwKICAieXBvZ2VncmFtbWVuaWdyZWVrY21iIiwKICAweDAzNDUsCiAgInlyIiwKICAweDAxYTYsCiAgInlyaW5nIiwKICAweDFlOTksCiAgInlzdXBlcmlvciIsCiAgMHgwMmI4LAogICJ5dGlsZGUiLAogIDB4MWVmOSwKICAieXR1cm5lZCIsCiAgMHgwMjhlLAogICJ5dWhpcmFnYW5hIiwKICAweDMwODYsCiAgInl1aWtvcmVhbiIsCiAgMHgzMThjLAogICJ5dWthdGFrYW5hIiwKICAweDMwZTYsCiAgInl1a2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5NSwKICAieXVrb3JlYW4iLAogIDB4MzE2MCwKICAieXVzYmlnY3lyaWxsaWMiLAogIDB4MDQ2YiwKICAieXVzYmlnaW90aWZpZWRjeXJpbGxpYyIsCiAgMHgwNDZkLAogICJ5dXNsaXR0bGVjeXJpbGxpYyIsCiAgMHgwNDY3LAogICJ5dXNsaXR0bGVpb3RpZmllZGN5cmlsbGljIiwKICAweDA0NjksCiAgInl1c21hbGxoaXJhZ2FuYSIsCiAgMHgzMDg1LAogICJ5dXNtYWxsa2F0YWthbmEiLAogIDB4MzBlNSwKICAieXVzbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNmQsCiAgInl1eWVrb3JlYW4iLAogIDB4MzE4YiwKICAieXV5ZW9rb3JlYW4iLAogIDB4MzE4YSwKICAieXlhYmVuZ2FsaSIsCiAgMHgwOWRmLAogICJ5eWFkZXZhIiwKICAweDA5NWYsCiAgInoiLAogIDB4MDA3YSwKICAiemFhcm1lbmlhbiIsCiAgMHgwNTY2LAogICJ6YWN1dGUiLAogIDB4MDE3YSwKICAiemFkZXZhIiwKICAweDA5NWIsCiAgInphZ3VybXVraGkiLAogIDB4MGE1YiwKICAiemFoYXJhYmljIiwKICAweDA2MzgsCiAgInphaGZpbmFsYXJhYmljIiwKICAweGZlYzYsCiAgInphaGluaXRpYWxhcmFiaWMiLAogIDB4ZmVjNywKICAiemFoaXJhZ2FuYSIsCiAgMHgzMDU2LAogICJ6YWhtZWRpYWxhcmFiaWMiLAogIDB4ZmVjOCwKICAiemFpbmFyYWJpYyIsCiAgMHgwNjMyLAogICJ6YWluZmluYWxhcmFiaWMiLAogIDB4ZmViMCwKICAiemFrYXRha2FuYSIsCiAgMHgzMGI2LAogICJ6YXFlZmdhZG9saGVicmV3IiwKICAweDA1OTUsCiAgInphcWVmcWF0YW5oZWJyZXciLAogIDB4MDU5NCwKICAiemFycWFoZWJyZXciLAogIDB4MDU5OCwKICAiemF5aW4iLAogIDB4MDVkNiwKICAiemF5aW5kYWdlc2giLAogIDB4ZmIzNiwKICAiemF5aW5kYWdlc2hoZWJyZXciLAogIDB4ZmIzNiwKICAiemF5aW5oZWJyZXciLAogIDB4MDVkNiwKICAiemJvcG9tb2ZvIiwKICAweDMxMTcsCiAgInpjYXJvbiIsCiAgMHgwMTdlLAogICJ6Y2lyY2xlIiwKICAweDI0ZTksCiAgInpjaXJjdW1mbGV4IiwKICAweDFlOTEsCiAgInpjdXJsIiwKICAweDAyOTEsCiAgInpkb3QiLAogIDB4MDE3YywKICAiemRvdGFjY2VudCIsCiAgMHgwMTdjLAogICJ6ZG90YmVsb3ciLAogIDB4MWU5MywKICAiemVjeXJpbGxpYyIsCiAgMHgwNDM3LAogICJ6ZWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0OTksCiAgInplZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGRmLAogICJ6ZWhpcmFnYW5hIiwKICAweDMwNWMsCiAgInpla2F0YWthbmEiLAogIDB4MzBiYywKICAiemVybyIsCiAgMHgwMDMwLAogICJ6ZXJvYXJhYmljIiwKICAweDA2NjAsCiAgInplcm9iZW5nYWxpIiwKICAweDA5ZTYsCiAgInplcm9kZXZhIiwKICAweDA5NjYsCiAgInplcm9ndWphcmF0aSIsCiAgMHgwYWU2LAogICJ6ZXJvZ3VybXVraGkiLAogIDB4MGE2NiwKICAiemVyb2hhY2thcmFiaWMiLAogIDB4MDY2MCwKICAiemVyb2luZmVyaW9yIiwKICAweDIwODAsCiAgInplcm9tb25vc3BhY2UiLAogIDB4ZmYxMCwKICAiemVyb29sZHN0eWxlIiwKICAweGY3MzAsCiAgInplcm9wZXJzaWFuIiwKICAweDA2ZjAsCiAgInplcm9zdXBlcmlvciIsCiAgMHgyMDcwLAogICJ6ZXJvdGhhaSIsCiAgMHgwZTUwLAogICJ6ZXJvd2lkdGhqb2luZXIiLAogIDB4ZmVmZiwKICAiemVyb3dpZHRobm9uam9pbmVyIiwKICAweDIwMGMsCiAgInplcm93aWR0aHNwYWNlIiwKICAweDIwMGIsCiAgInpldGEiLAogIDB4MDNiNiwKICAiemhib3BvbW9mbyIsCiAgMHgzMTEzLAogICJ6aGVhcm1lbmlhbiIsCiAgMHgwNTZhLAogICJ6aGVicmV2ZWN5cmlsbGljIiwKICAweDA0YzIsCiAgInpoZWN5cmlsbGljIiwKICAweDA0MzYsCiAgInpoZWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0OTcsCiAgInpoZWRpZXJlc2lzY3lyaWxsaWMiLAogIDB4MDRkZCwKICAiemloaXJhZ2FuYSIsCiAgMHgzMDU4LAogICJ6aWthdGFrYW5hIiwKICAweDMwYjgsCiAgInppbm9yaGVicmV3IiwKICAweDA1YWUsCiAgInpsaW5lYmVsb3ciLAogIDB4MWU5NSwKICAiem1vbm9zcGFjZSIsCiAgMHhmZjVhLAogICJ6b2hpcmFnYW5hIiwKICAweDMwNWUsCiAgInpva2F0YWthbmEiLAogIDB4MzBiZSwKICAienBhcmVuIiwKICAweDI0YjUsCiAgInpyZXRyb2ZsZXhob29rIiwKICAweDAyOTAsCiAgInpzdHJva2UiLAogIDB4MDFiNiwKICAienVoaXJhZ2FuYSIsCiAgMHgzMDVhLAogICJ6dWthdGFrYW5hIiwKICAweDMwYmEsCiAgIi5ub3RkZWYiLAogIDB4MDAwMCwKICAiYW5nYnJhY2tldGxlZnRiaWciLAogIDB4MjMyOSwKICAiYW5nYnJhY2tldGxlZnRCaWciLAogIDB4MjMyOSwKICAiYW5nYnJhY2tldGxlZnRiaWdnIiwKICAweDIzMjksCiAgImFuZ2JyYWNrZXRsZWZ0QmlnZyIsCiAgMHgyMzI5LAogICJhbmdicmFja2V0cmlnaHRCaWciLAogIDB4MjMyYSwKICAiYW5nYnJhY2tldHJpZ2h0YmlnIiwKICAweDIzMmEsCiAgImFuZ2JyYWNrZXRyaWdodEJpZ2ciLAogIDB4MjMyYSwKICAiYW5nYnJhY2tldHJpZ2h0YmlnZyIsCiAgMHgyMzJhLAogICJhcnJvd2hvb2tsZWZ0IiwKICAweDIxYWEsCiAgImFycm93aG9va3JpZ2h0IiwKICAweDIxYTksCiAgImFycm93bGVmdHRvcGhhbGYiLAogIDB4MjFiYywKICAiYXJyb3dsZWZ0Ym90aGFsZiIsCiAgMHgyMWJkLAogICJhcnJvd25vcnRoZWFzdCIsCiAgMHgyMTk3LAogICJhcnJvd25vcnRod2VzdCIsCiAgMHgyMTk2LAogICJhcnJvd3JpZ2h0dG9waGFsZiIsCiAgMHgyMWMwLAogICJhcnJvd3JpZ2h0Ym90aGFsZiIsCiAgMHgyMWMxLAogICJhcnJvd3NvdXRoZWFzdCIsCiAgMHgyMTk4LAogICJhcnJvd3NvdXRod2VzdCIsCiAgMHgyMTk5LAogICJiYWNrc2xhc2hiaWciLAogIDB4MjIxNiwKICAiYmFja3NsYXNoQmlnIiwKICAweDIyMTYsCiAgImJhY2tzbGFzaEJpZ2ciLAogIDB4MjIxNiwKICAiYmFja3NsYXNoYmlnZyIsCiAgMHgyMjE2LAogICJiYXJkYmwiLAogIDB4MjAxNiwKICAiYnJhY2VodGlwZG93bmxlZnQiLAogIDB4ZmUzNywKICAiYnJhY2VodGlwZG93bnJpZ2h0IiwKICAweGZlMzcsCiAgImJyYWNlaHRpcHVwbGVmdCIsCiAgMHhmZTM4LAogICJicmFjZWh0aXB1cHJpZ2h0IiwKICAweGZlMzgsCiAgImJyYWNlbGVmdEJpZyIsCiAgMHgwMDdiLAogICJicmFjZWxlZnRiaWciLAogIDB4MDA3YiwKICAiYnJhY2VsZWZ0YmlnZyIsCiAgMHgwMDdiLAogICJicmFjZWxlZnRCaWdnIiwKICAweDAwN2IsCiAgImJyYWNlcmlnaHRCaWciLAogIDB4MDA3ZCwKICAiYnJhY2VyaWdodGJpZyIsCiAgMHgwMDdkLAogICJicmFjZXJpZ2h0YmlnZyIsCiAgMHgwMDdkLAogICJicmFjZXJpZ2h0QmlnZyIsCiAgMHgwMDdkLAogICJicmFja2V0bGVmdGJpZyIsCiAgMHgwMDViLAogICJicmFja2V0bGVmdEJpZyIsCiAgMHgwMDViLAogICJicmFja2V0bGVmdGJpZ2ciLAogIDB4MDA1YiwKICAiYnJhY2tldGxlZnRCaWdnIiwKICAweDAwNWIsCiAgImJyYWNrZXRyaWdodEJpZyIsCiAgMHgwMDVkLAogICJicmFja2V0cmlnaHRiaWciLAogIDB4MDA1ZCwKICAiYnJhY2tldHJpZ2h0YmlnZyIsCiAgMHgwMDVkLAogICJicmFja2V0cmlnaHRCaWdnIiwKICAweDAwNWQsCiAgImNlaWxpbmdsZWZ0YmlnIiwKICAweDIzMDgsCiAgImNlaWxpbmdsZWZ0QmlnIiwKICAweDIzMDgsCiAgImNlaWxpbmdsZWZ0QmlnZyIsCiAgMHgyMzA4LAogICJjZWlsaW5nbGVmdGJpZ2ciLAogIDB4MjMwOCwKICAiY2VpbGluZ3JpZ2h0YmlnIiwKICAweDIzMDksCiAgImNlaWxpbmdyaWdodEJpZyIsCiAgMHgyMzA5LAogICJjZWlsaW5ncmlnaHRiaWdnIiwKICAweDIzMDksCiAgImNlaWxpbmdyaWdodEJpZ2ciLAogIDB4MjMwOSwKICAiY2lyY2xlZG90ZGlzcGxheSIsCiAgMHgyMjk5LAogICJjaXJjbGVkb3R0ZXh0IiwKICAweDIyOTksCiAgImNpcmNsZW11bHRpcGx5ZGlzcGxheSIsCiAgMHgyMjk3LAogICJjaXJjbGVtdWx0aXBseXRleHQiLAogIDB4MjI5NywKICAiY2lyY2xlcGx1c2Rpc3BsYXkiLAogIDB4MjI5NSwKICAiY2lyY2xlcGx1c3RleHQiLAogIDB4MjI5NSwKICAiY29udGludGVncmFsZGlzcGxheSIsCiAgMHgyMjJlLAogICJjb250aW50ZWdyYWx0ZXh0IiwKICAweDIyMmUsCiAgImNvcHJvZHVjdGRpc3BsYXkiLAogIDB4MjIxMCwKICAiY29wcm9kdWN0dGV4dCIsCiAgMHgyMjEwLAogICJmbG9vcmxlZnRCaWciLAogIDB4MjMwYSwKICAiZmxvb3JsZWZ0YmlnIiwKICAweDIzMGEsCiAgImZsb29ybGVmdGJpZ2ciLAogIDB4MjMwYSwKICAiZmxvb3JsZWZ0QmlnZyIsCiAgMHgyMzBhLAogICJmbG9vcnJpZ2h0YmlnIiwKICAweDIzMGIsCiAgImZsb29ycmlnaHRCaWciLAogIDB4MjMwYiwKICAiZmxvb3JyaWdodEJpZ2ciLAogIDB4MjMwYiwKICAiZmxvb3JyaWdodGJpZ2ciLAogIDB4MjMwYiwKICAiaGF0d2lkZSIsCiAgMHgwMzAyLAogICJoYXR3aWRlciIsCiAgMHgwMzAyLAogICJoYXR3aWRlc3QiLAogIDB4MDMwMiwKICAiaW50ZXJjYWwiLAogIDB4MWQ0MCwKICAiaW50ZWdyYWxkaXNwbGF5IiwKICAweDIyMmIsCiAgImludGVncmFsdGV4dCIsCiAgMHgyMjJiLAogICJpbnRlcnNlY3Rpb25kaXNwbGF5IiwKICAweDIyYzIsCiAgImludGVyc2VjdGlvbnRleHQiLAogIDB4MjJjMiwKICAibG9naWNhbGFuZGRpc3BsYXkiLAogIDB4MjIyNywKICAibG9naWNhbGFuZHRleHQiLAogIDB4MjIyNywKICAibG9naWNhbG9yZGlzcGxheSIsCiAgMHgyMjI4LAogICJsb2dpY2Fsb3J0ZXh0IiwKICAweDIyMjgsCiAgInBhcmVubGVmdEJpZyIsCiAgMHgwMDI4LAogICJwYXJlbmxlZnRiaWciLAogIDB4MDAyOCwKICAicGFyZW5sZWZ0QmlnZyIsCiAgMHgwMDI4LAogICJwYXJlbmxlZnRiaWdnIiwKICAweDAwMjgsCiAgInBhcmVucmlnaHRCaWciLAogIDB4MDAyOSwKICAicGFyZW5yaWdodGJpZyIsCiAgMHgwMDI5LAogICJwYXJlbnJpZ2h0QmlnZyIsCiAgMHgwMDI5LAogICJwYXJlbnJpZ2h0YmlnZyIsCiAgMHgwMDI5LAogICJwcmltZSIsCiAgMHgyMDMyLAogICJwcm9kdWN0ZGlzcGxheSIsCiAgMHgyMjBmLAogICJwcm9kdWN0dGV4dCIsCiAgMHgyMjBmLAogICJyYWRpY2FsYmlnIiwKICAweDIyMWEsCiAgInJhZGljYWxCaWciLAogIDB4MjIxYSwKICAicmFkaWNhbEJpZ2ciLAogIDB4MjIxYSwKICAicmFkaWNhbGJpZ2ciLAogIDB4MjIxYSwKICAicmFkaWNhbGJ0IiwKICAweDIyMWEsCiAgInJhZGljYWx0cCIsCiAgMHgyMjFhLAogICJyYWRpY2FsdmVydGV4IiwKICAweDIyMWEsCiAgInNsYXNoYmlnIiwKICAweDAwMmYsCiAgInNsYXNoQmlnIiwKICAweDAwMmYsCiAgInNsYXNoQmlnZyIsCiAgMHgwMDJmLAogICJzbGFzaGJpZ2ciLAogIDB4MDAyZiwKICAic3VtbWF0aW9uZGlzcGxheSIsCiAgMHgyMjExLAogICJzdW1tYXRpb250ZXh0IiwKICAweDIyMTEsCiAgInRpbGRld2lkZSIsCiAgMHgwMmRjLAogICJ0aWxkZXdpZGVyIiwKICAweDAyZGMsCiAgInRpbGRld2lkZXN0IiwKICAweDAyZGMsCiAgInVuaW9uZGlzcGxheSIsCiAgMHgyMmMzLAogICJ1bmlvbm11bHRpZGlzcGxheSIsCiAgMHgyMjhlLAogICJ1bmlvbm11bHRpdGV4dCIsCiAgMHgyMjhlLAogICJ1bmlvbnNxZGlzcGxheSIsCiAgMHgyMjk0LAogICJ1bmlvbnNxdGV4dCIsCiAgMHgyMjk0LAogICJ1bmlvbnRleHQiLAogIDB4MjJjMywKICAidmV4dGVuZGRvdWJsZSIsCiAgMHgyMjI1LAogICJ2ZXh0ZW5kc2luZ2xlIiwKICAweDIyMjMKIF07Cn0pOwpjb25zdCBnZXREaW5nYmF0c0dseXBoc1VuaWNvZGUgPSAoMCxfY29yZV91dGlsc19qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fLmdldEFycmF5TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAoKSB7CiByZXR1cm4gWwogICJzcGFjZSIsCiAgMHgwMDIwLAogICJhMSIsCiAgMHgyNzAxLAogICJhMiIsCiAgMHgyNzAyLAogICJhMjAyIiwKICAweDI3MDMsCiAgImEzIiwKICAweDI3MDQsCiAgImE0IiwKICAweDI2MGUsCiAgImE1IiwKICAweDI3MDYsCiAgImExMTkiLAogIDB4MjcwNywKICAiYTExOCIsCiAgMHgyNzA4LAogICJhMTE3IiwKICAweDI3MDksCiAgImExMSIsCiAgMHgyNjFiLAogICJhMTIiLAogIDB4MjYxZSwKICAiYTEzIiwKICAweDI3MGMsCiAgImExNCIsCiAgMHgyNzBkLAogICJhMTUiLAogIDB4MjcwZSwKICAiYTE2IiwKICAweDI3MGYsCiAgImExMDUiLAogIDB4MjcxMCwKICAiYTE3IiwKICAweDI3MTEsCiAgImExOCIsCiAgMHgyNzEyLAogICJhMTkiLAogIDB4MjcxMywKICAiYTIwIiwKICAweDI3MTQsCiAgImEyMSIsCiAgMHgyNzE1LAogICJhMjIiLAogIDB4MjcxNiwKICAiYTIzIiwKICAweDI3MTcsCiAgImEyNCIsCiAgMHgyNzE4LAogICJhMjUiLAogIDB4MjcxOSwKICAiYTI2IiwKICAweDI3MWEsCiAgImEyNyIsCiAgMHgyNzFiLAogICJhMjgiLAogIDB4MjcxYywKICAiYTYiLAogIDB4MjcxZCwKICAiYTciLAogIDB4MjcxZSwKICAiYTgiLAogIDB4MjcxZiwKICAiYTkiLAogIDB4MjcyMCwKICAiYTEwIiwKICAweDI3MjEsCiAgImEyOSIsCiAgMHgyNzIyLAogICJhMzAiLAogIDB4MjcyMywKICAiYTMxIiwKICAweDI3MjQsCiAgImEzMiIsCiAgMHgyNzI1LAogICJhMzMiLAogIDB4MjcyNiwKICAiYTM0IiwKICAweDI3MjcsCiAgImEzNSIsCiAgMHgyNjA1LAogICJhMzYiLAogIDB4MjcyOSwKICAiYTM3IiwKICAweDI3MmEsCiAgImEzOCIsCiAgMHgyNzJiLAogICJhMzkiLAogIDB4MjcyYywKICAiYTQwIiwKICAweDI3MmQsCiAgImE0MSIsCiAgMHgyNzJlLAogICJhNDIiLAogIDB4MjcyZiwKICAiYTQzIiwKICAweDI3MzAsCiAgImE0NCIsCiAgMHgyNzMxLAogICJhNDUiLAogIDB4MjczMiwKICAiYTQ2IiwKICAweDI3MzMsCiAgImE0NyIsCiAgMHgyNzM0LAogICJhNDgiLAogIDB4MjczNSwKICAiYTQ5IiwKICAweDI3MzYsCiAgImE1MCIsCiAgMHgyNzM3LAogICJhNTEiLAogIDB4MjczOCwKICAiYTUyIiwKICAweDI3MzksCiAgImE1MyIsCiAgMHgyNzNhLAogICJhNTQiLAogIDB4MjczYiwKICAiYTU1IiwKICAweDI3M2MsCiAgImE1NiIsCiAgMHgyNzNkLAogICJhNTciLAogIDB4MjczZSwKICAiYTU4IiwKICAweDI3M2YsCiAgImE1OSIsCiAgMHgyNzQwLAogICJhNjAiLAogIDB4Mjc0MSwKICAiYTYxIiwKICAweDI3NDIsCiAgImE2MiIsCiAgMHgyNzQzLAogICJhNjMiLAogIDB4Mjc0NCwKICAiYTY0IiwKICAweDI3NDUsCiAgImE2NSIsCiAgMHgyNzQ2LAogICJhNjYiLAogIDB4Mjc0NywKICAiYTY3IiwKICAweDI3NDgsCiAgImE2OCIsCiAgMHgyNzQ5LAogICJhNjkiLAogIDB4Mjc0YSwKICAiYTcwIiwKICAweDI3NGIsCiAgImE3MSIsCiAgMHgyNWNmLAogICJhNzIiLAogIDB4Mjc0ZCwKICAiYTczIiwKICAweDI1YTAsCiAgImE3NCIsCiAgMHgyNzRmLAogICJhMjAzIiwKICAweDI3NTAsCiAgImE3NSIsCiAgMHgyNzUxLAogICJhMjA0IiwKICAweDI3NTIsCiAgImE3NiIsCiAgMHgyNWIyLAogICJhNzciLAogIDB4MjViYywKICAiYTc4IiwKICAweDI1YzYsCiAgImE3OSIsCiAgMHgyNzU2LAogICJhODEiLAogIDB4MjVkNywKICAiYTgyIiwKICAweDI3NTgsCiAgImE4MyIsCiAgMHgyNzU5LAogICJhODQiLAogIDB4Mjc1YSwKICAiYTk3IiwKICAweDI3NWIsCiAgImE5OCIsCiAgMHgyNzVjLAogICJhOTkiLAogIDB4Mjc1ZCwKICAiYTEwMCIsCiAgMHgyNzVlLAogICJhMTAxIiwKICAweDI3NjEsCiAgImExMDIiLAogIDB4Mjc2MiwKICAiYTEwMyIsCiAgMHgyNzYzLAogICJhMTA0IiwKICAweDI3NjQsCiAgImExMDYiLAogIDB4Mjc2NSwKICAiYTEwNyIsCiAgMHgyNzY2LAogICJhMTA4IiwKICAweDI3NjcsCiAgImExMTIiLAogIDB4MjY2MywKICAiYTExMSIsCiAgMHgyNjY2LAogICJhMTEwIiwKICAweDI2NjUsCiAgImExMDkiLAogIDB4MjY2MCwKICAiYTEyMCIsCiAgMHgyNDYwLAogICJhMTIxIiwKICAweDI0NjEsCiAgImExMjIiLAogIDB4MjQ2MiwKICAiYTEyMyIsCiAgMHgyNDYzLAogICJhMTI0IiwKICAweDI0NjQsCiAgImExMjUiLAogIDB4MjQ2NSwKICAiYTEyNiIsCiAgMHgyNDY2LAogICJhMTI3IiwKICAweDI0NjcsCiAgImExMjgiLAogIDB4MjQ2OCwKICAiYTEyOSIsCiAgMHgyNDY5LAogICJhMTMwIiwKICAweDI3NzYsCiAgImExMzEiLAogIDB4Mjc3NywKICAiYTEzMiIsCiAgMHgyNzc4LAogICJhMTMzIiwKICAweDI3NzksCiAgImExMzQiLAogIDB4Mjc3YSwKICAiYTEzNSIsCiAgMHgyNzdiLAogICJhMTM2IiwKICAweDI3N2MsCiAgImExMzciLAogIDB4Mjc3ZCwKICAiYTEzOCIsCiAgMHgyNzdlLAogICJhMTM5IiwKICAweDI3N2YsCiAgImExNDAiLAogIDB4Mjc4MCwKICAiYTE0MSIsCiAgMHgyNzgxLAogICJhMTQyIiwKICAweDI3ODIsCiAgImExNDMiLAogIDB4Mjc4MywKICAiYTE0NCIsCiAgMHgyNzg0LAogICJhMTQ1IiwKICAweDI3ODUsCiAgImExNDYiLAogIDB4Mjc4NiwKICAiYTE0NyIsCiAgMHgyNzg3LAogICJhMTQ4IiwKICAweDI3ODgsCiAgImExNDkiLAogIDB4Mjc4OSwKICAiYTE1MCIsCiAgMHgyNzhhLAogICJhMTUxIiwKICAweDI3OGIsCiAgImExNTIiLAogIDB4Mjc4YywKICAiYTE1MyIsCiAgMHgyNzhkLAogICJhMTU0IiwKICAweDI3OGUsCiAgImExNTUiLAogIDB4Mjc4ZiwKICAiYTE1NiIsCiAgMHgyNzkwLAogICJhMTU3IiwKICAweDI3OTEsCiAgImExNTgiLAogIDB4Mjc5MiwKICAiYTE1OSIsCiAgMHgyNzkzLAogICJhMTYwIiwKICAweDI3OTQsCiAgImExNjEiLAogIDB4MjE5MiwKICAiYTE2MyIsCiAgMHgyMTk0LAogICJhMTY0IiwKICAweDIxOTUsCiAgImExOTYiLAogIDB4Mjc5OCwKICAiYTE2NSIsCiAgMHgyNzk5LAogICJhMTkyIiwKICAweDI3OWEsCiAgImExNjYiLAogIDB4Mjc5YiwKICAiYTE2NyIsCiAgMHgyNzljLAogICJhMTY4IiwKICAweDI3OWQsCiAgImExNjkiLAogIDB4Mjc5ZSwKICAiYTE3MCIsCiAgMHgyNzlmLAogICJhMTcxIiwKICAweDI3YTAsCiAgImExNzIiLAogIDB4MjdhMSwKICAiYTE3MyIsCiAgMHgyN2EyLAogICJhMTYyIiwKICAweDI3YTMsCiAgImExNzQiLAogIDB4MjdhNCwKICAiYTE3NSIsCiAgMHgyN2E1LAogICJhMTc2IiwKICAweDI3YTYsCiAgImExNzciLAogIDB4MjdhNywKICAiYTE3OCIsCiAgMHgyN2E4LAogICJhMTc5IiwKICAweDI3YTksCiAgImExOTMiLAogIDB4MjdhYSwKICAiYTE4MCIsCiAgMHgyN2FiLAogICJhMTk5IiwKICAweDI3YWMsCiAgImExODEiLAogIDB4MjdhZCwKICAiYTIwMCIsCiAgMHgyN2FlLAogICJhMTgyIiwKICAweDI3YWYsCiAgImEyMDEiLAogIDB4MjdiMSwKICAiYTE4MyIsCiAgMHgyN2IyLAogICJhMTg0IiwKICAweDI3YjMsCiAgImExOTciLAogIDB4MjdiNCwKICAiYTE4NSIsCiAgMHgyN2I1LAogICJhMTk0IiwKICAweDI3YjYsCiAgImExOTgiLAogIDB4MjdiNywKICAiYTE4NiIsCiAgMHgyN2I4LAogICJhMTk1IiwKICAweDI3YjksCiAgImExODciLAogIDB4MjdiYSwKICAiYTE4OCIsCiAgMHgyN2JiLAogICJhMTg5IiwKICAweDI3YmMsCiAgImExOTAiLAogIDB4MjdiZCwKICAiYTE5MSIsCiAgMHgyN2JlLAogICJhODkiLAogIDB4Mjc2OCwKICAiYTkwIiwKICAweDI3NjksCiAgImE5MyIsCiAgMHgyNzZhLAogICJhOTQiLAogIDB4Mjc2YiwKICAiYTkxIiwKICAweDI3NmMsCiAgImE5MiIsCiAgMHgyNzZkLAogICJhMjA1IiwKICAweDI3NmUsCiAgImE4NSIsCiAgMHgyNzZmLAogICJhMjA2IiwKICAweDI3NzAsCiAgImE4NiIsCiAgMHgyNzcxLAogICJhODciLAogIDB4Mjc3MiwKICAiYTg4IiwKICAweDI3NzMsCiAgImE5NSIsCiAgMHgyNzc0LAogICJhOTYiLAogIDB4Mjc3NSwKICAiLm5vdGRlZiIsCiAgMHgwMDAwCiBdOwp9KTsKCgovKioqLyB9KSwKLyogMTY1ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKX193X3BkZmpzX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pOwovKiBoYXJtb255IGV4cG9ydCAqLyBfX3dfcGRmanNfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgewovKiBoYXJtb255IGV4cG9ydCAqLyAgICJjbGVhclVuaWNvZGVDYWNoZXMiOiAoKSA9PiAoLyogYmluZGluZyAqLyBjbGVhclVuaWNvZGVDYWNoZXMpLAovKiBoYXJtb255IGV4cG9ydCAqLyAgICJnZXRDaGFyVW5pY29kZUNhdGVnb3J5IjogKCkgPT4gKC8qIGJpbmRpbmcgKi8gZ2V0Q2hhclVuaWNvZGVDYXRlZ29yeSksCi8qIGhhcm1vbnkgZXhwb3J0ICovICAgImdldE5vcm1hbGl6ZWRVbmljb2RlcyI6ICgpID0+ICgvKiBiaW5kaW5nICovIGdldE5vcm1hbGl6ZWRVbmljb2RlcyksCi8qIGhhcm1vbnkgZXhwb3J0ICovICAgImdldFVuaWNvZGVGb3JHbHlwaCI6ICgpID0+ICgvKiBiaW5kaW5nICovIGdldFVuaWNvZGVGb3JHbHlwaCksCi8qIGhhcm1vbnkgZXhwb3J0ICovICAgImdldFVuaWNvZGVSYW5nZUZvciI6ICgpID0+ICgvKiBiaW5kaW5nICovIGdldFVuaWNvZGVSYW5nZUZvciksCi8qIGhhcm1vbnkgZXhwb3J0ICovICAgIm1hcFNwZWNpYWxVbmljb2RlVmFsdWVzIjogKCkgPT4gKC8qIGJpbmRpbmcgKi8gbWFwU3BlY2lhbFVuaWNvZGVWYWx1ZXMpLAovKiBoYXJtb255IGV4cG9ydCAqLyAgICJyZXZlcnNlSWZSdGwiOiAoKSA9PiAoLyogYmluZGluZyAqLyByZXZlcnNlSWZSdGwpCi8qIGhhcm1vbnkgZXhwb3J0ICovIH0pOwovKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX2NvcmVfdXRpbHNfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMxKTsKCmNvbnN0IGdldFNwZWNpYWxQVUFTeW1ib2xzID0gKDAsX2NvcmVfdXRpbHNfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiB0WzYzNzIxXSA9IDB4MDBhOTsKIHRbNjMxOTNdID0gMHgwMGE5OwogdFs2MzcyMF0gPSAweDAwYWU7CiB0WzYzMTk0XSA9IDB4MDBhZTsKIHRbNjM3MjJdID0gMHgyMTIyOwogdFs2MzE5NV0gPSAweDIxMjI7CiB0WzYzNzI5XSA9IDB4MjNhNzsKIHRbNjM3MzBdID0gMHgyM2E4OwogdFs2MzczMV0gPSAweDIzYTk7CiB0WzYzNzQwXSA9IDB4MjNhYjsKIHRbNjM3NDFdID0gMHgyM2FjOwogdFs2Mzc0Ml0gPSAweDIzYWQ7CiB0WzYzNzI2XSA9IDB4MjNhMTsKIHRbNjM3MjddID0gMHgyM2EyOwogdFs2MzcyOF0gPSAweDIzYTM7CiB0WzYzNzM3XSA9IDB4MjNhNDsKIHRbNjM3MzhdID0gMHgyM2E1OwogdFs2MzczOV0gPSAweDIzYTY7CiB0WzYzNzIzXSA9IDB4MjM5YjsKIHRbNjM3MjRdID0gMHgyMzljOwogdFs2MzcyNV0gPSAweDIzOWQ7CiB0WzYzNzM0XSA9IDB4MjM5ZTsKIHRbNjM3MzVdID0gMHgyMzlmOwogdFs2MzczNl0gPSAweDIzYTA7Cn0pOwpmdW5jdGlvbiBtYXBTcGVjaWFsVW5pY29kZVZhbHVlcyhjb2RlKSB7CiBpZiAoY29kZSA+PSAweGZmZjAgJiYgY29kZSA8PSAweGZmZmYpIHsKICByZXR1cm4gMDsKIH0gZWxzZSBpZiAoY29kZSA+PSAweGY2MDAgJiYgY29kZSA8PSAweGY4ZmYpIHsKICByZXR1cm4gZ2V0U3BlY2lhbFBVQVN5bWJvbHMoKVtjb2RlXSB8fCBjb2RlOwogfSBlbHNlIGlmIChjb2RlID09PSAweDAwYWQpIHsKICByZXR1cm4gMHgwMDJkOwogfQogcmV0dXJuIGNvZGU7Cn0KZnVuY3Rpb24gZ2V0VW5pY29kZUZvckdseXBoKG5hbWUsIGdseXBoc1VuaWNvZGVNYXApIHsKIGxldCB1bmljb2RlID0gZ2x5cGhzVW5pY29kZU1hcFtuYW1lXTsKIGlmICh1bmljb2RlICE9PSB1bmRlZmluZWQpIHsKICByZXR1cm4gdW5pY29kZTsKIH0KIGlmICghbmFtZSkgewogIHJldHVybiAtMTsKIH0KIGlmIChuYW1lWzBdID09PSAidSIpIHsKICBjb25zdCBuYW1lTGVuID0gbmFtZS5sZW5ndGg7CiAgbGV0IGhleFN0cjsKICBpZiAobmFtZUxlbiA9PT0gNyAmJiBuYW1lWzFdID09PSAibiIgJiYgbmFtZVsyXSA9PT0gImkiKSB7CiAgIGhleFN0ciA9IG5hbWUuc3Vic3RyaW5nKDMpOwogIH0gZWxzZSBpZiAobmFtZUxlbiA+PSA1ICYmIG5hbWVMZW4gPD0gNykgewogICBoZXhTdHIgPSBuYW1lLnN1YnN0cmluZygxKTsKICB9IGVsc2UgewogICByZXR1cm4gLTE7CiAgfQogIGlmIChoZXhTdHIgPT09IGhleFN0ci50b1VwcGVyQ2FzZSgpKSB7CiAgIHVuaWNvZGUgPSBwYXJzZUludChoZXhTdHIsIDE2KTsKICAgaWYgKHVuaWNvZGUgPj0gMCkgewogICAgcmV0dXJuIHVuaWNvZGU7CiAgIH0KICB9CiB9CiByZXR1cm4gLTE7Cn0KY29uc3QgVW5pY29kZVJhbmdlcyA9IFsKIHsKICBiZWdpbjogMHgwMDAwLAogIGVuZDogMHgwMDdmCiB9LAogewogIGJlZ2luOiAweDAwODAsCiAgZW5kOiAweDAwZmYKIH0sCiB7CiAgYmVnaW46IDB4MDEwMCwKICBlbmQ6IDB4MDE3ZgogfSwKIHsKICBiZWdpbjogMHgwMTgwLAogIGVuZDogMHgwMjRmCiB9LAogewogIGJlZ2luOiAweDAyNTAsCiAgZW5kOiAweDAyYWYKIH0sCiB7CiAgYmVnaW46IDB4MDJiMCwKICBlbmQ6IDB4MDJmZgogfSwKIHsKICBiZWdpbjogMHgwMzAwLAogIGVuZDogMHgwMzZmCiB9LAogewogIGJlZ2luOiAweDAzNzAsCiAgZW5kOiAweDAzZmYKIH0sCiB7CiAgYmVnaW46IDB4MmM4MCwKICBlbmQ6IDB4MmNmZgogfSwKIHsKICBiZWdpbjogMHgwNDAwLAogIGVuZDogMHgwNGZmCiB9LAogewogIGJlZ2luOiAweDA1MzAsCiAgZW5kOiAweDA1OGYKIH0sCiB7CiAgYmVnaW46IDB4MDU5MCwKICBlbmQ6IDB4MDVmZgogfSwKIHsKICBiZWdpbjogMHhhNTAwLAogIGVuZDogMHhhNjNmCiB9LAogewogIGJlZ2luOiAweDA2MDAsCiAgZW5kOiAweDA2ZmYKIH0sCiB7CiAgYmVnaW46IDB4MDdjMCwKICBlbmQ6IDB4MDdmZgogfSwKIHsKICBiZWdpbjogMHgwOTAwLAogIGVuZDogMHgwOTdmCiB9LAogewogIGJlZ2luOiAweDA5ODAsCiAgZW5kOiAweDA5ZmYKIH0sCiB7CiAgYmVnaW46IDB4MGEwMCwKICBlbmQ6IDB4MGE3ZgogfSwKIHsKICBiZWdpbjogMHgwYTgwLAogIGVuZDogMHgwYWZmCiB9LAogewogIGJlZ2luOiAweDBiMDAsCiAgZW5kOiAweDBiN2YKIH0sCiB7CiAgYmVnaW46IDB4MGI4MCwKICBlbmQ6IDB4MGJmZgogfSwKIHsKICBiZWdpbjogMHgwYzAwLAogIGVuZDogMHgwYzdmCiB9LAogewogIGJlZ2luOiAweDBjODAsCiAgZW5kOiAweDBjZmYKIH0sCiB7CiAgYmVnaW46IDB4MGQwMCwKICBlbmQ6IDB4MGQ3ZgogfSwKIHsKICBiZWdpbjogMHgwZTAwLAogIGVuZDogMHgwZTdmCiB9LAogewogIGJlZ2luOiAweDBlODAsCiAgZW5kOiAweDBlZmYKIH0sCiB7CiAgYmVnaW46IDB4MTBhMCwKICBlbmQ6IDB4MTBmZgogfSwKIHsKICBiZWdpbjogMHgxYjAwLAogIGVuZDogMHgxYjdmCiB9LAogewogIGJlZ2luOiAweDExMDAsCiAgZW5kOiAweDExZmYKIH0sCiB7CiAgYmVnaW46IDB4MWUwMCwKICBlbmQ6IDB4MWVmZgogfSwKIHsKICBiZWdpbjogMHgxZjAwLAogIGVuZDogMHgxZmZmCiB9LAogewogIGJlZ2luOiAweDIwMDAsCiAgZW5kOiAweDIwNmYKIH0sCiB7CiAgYmVnaW46IDB4MjA3MCwKICBlbmQ6IDB4MjA5ZgogfSwKIHsKICBiZWdpbjogMHgyMGEwLAogIGVuZDogMHgyMGNmCiB9LAogewogIGJlZ2luOiAweDIwZDAsCiAgZW5kOiAweDIwZmYKIH0sCiB7CiAgYmVnaW46IDB4MjEwMCwKICBlbmQ6IDB4MjE0ZgogfSwKIHsKICBiZWdpbjogMHgyMTUwLAogIGVuZDogMHgyMThmCiB9LAogewogIGJlZ2luOiAweDIxOTAsCiAgZW5kOiAweDIxZmYKIH0sCiB7CiAgYmVnaW46IDB4MjIwMCwKICBlbmQ6IDB4MjJmZgogfSwKIHsKICBiZWdpbjogMHgyMzAwLAogIGVuZDogMHgyM2ZmCiB9LAogewogIGJlZ2luOiAweDI0MDAsCiAgZW5kOiAweDI0M2YKIH0sCiB7CiAgYmVnaW46IDB4MjQ0MCwKICBlbmQ6IDB4MjQ1ZgogfSwKIHsKICBiZWdpbjogMHgyNDYwLAogIGVuZDogMHgyNGZmCiB9LAogewogIGJlZ2luOiAweDI1MDAsCiAgZW5kOiAweDI1N2YKIH0sCiB7CiAgYmVnaW46IDB4MjU4MCwKICBlbmQ6IDB4MjU5ZgogfSwKIHsKICBiZWdpbjogMHgyNWEwLAogIGVuZDogMHgyNWZmCiB9LAogewogIGJlZ2luOiAweDI2MDAsCiAgZW5kOiAweDI2ZmYKIH0sCiB7CiAgYmVnaW46IDB4MjcwMCwKICBlbmQ6IDB4MjdiZgogfSwKIHsKICBiZWdpbjogMHgzMDAwLAogIGVuZDogMHgzMDNmCiB9LAogewogIGJlZ2luOiAweDMwNDAsCiAgZW5kOiAweDMwOWYKIH0sCiB7CiAgYmVnaW46IDB4MzBhMCwKICBlbmQ6IDB4MzBmZgogfSwKIHsKICBiZWdpbjogMHgzMTAwLAogIGVuZDogMHgzMTJmCiB9LAogewogIGJlZ2luOiAweDMxMzAsCiAgZW5kOiAweDMxOGYKIH0sCiB7CiAgYmVnaW46IDB4YTg0MCwKICBlbmQ6IDB4YTg3ZgogfSwKIHsKICBiZWdpbjogMHgzMjAwLAogIGVuZDogMHgzMmZmCiB9LAogewogIGJlZ2luOiAweDMzMDAsCiAgZW5kOiAweDMzZmYKIH0sCiB7CiAgYmVnaW46IDB4YWMwMCwKICBlbmQ6IDB4ZDdhZgogfSwKIHsKICBiZWdpbjogMHhkODAwLAogIGVuZDogMHhkZmZmCiB9LAogewogIGJlZ2luOiAweDEwOTAwLAogIGVuZDogMHgxMDkxZgogfSwKIHsKICBiZWdpbjogMHg0ZTAwLAogIGVuZDogMHg5ZmZmCiB9LAogewogIGJlZ2luOiAweGUwMDAsCiAgZW5kOiAweGY4ZmYKIH0sCiB7CiAgYmVnaW46IDB4MzFjMCwKICBlbmQ6IDB4MzFlZgogfSwKIHsKICBiZWdpbjogMHhmYjAwLAogIGVuZDogMHhmYjRmCiB9LAogewogIGJlZ2luOiAweGZiNTAsCiAgZW5kOiAweGZkZmYKIH0sCiB7CiAgYmVnaW46IDB4ZmUyMCwKICBlbmQ6IDB4ZmUyZgogfSwKIHsKICBiZWdpbjogMHhmZTEwLAogIGVuZDogMHhmZTFmCiB9LAogewogIGJlZ2luOiAweGZlNTAsCiAgZW5kOiAweGZlNmYKIH0sCiB7CiAgYmVnaW46IDB4ZmU3MCwKICBlbmQ6IDB4ZmVmZgogfSwKIHsKICBiZWdpbjogMHhmZjAwLAogIGVuZDogMHhmZmVmCiB9LAogewogIGJlZ2luOiAweGZmZjAsCiAgZW5kOiAweGZmZmYKIH0sCiB7CiAgYmVnaW46IDB4MGYwMCwKICBlbmQ6IDB4MGZmZgogfSwKIHsKICBiZWdpbjogMHgwNzAwLAogIGVuZDogMHgwNzRmCiB9LAogewogIGJlZ2luOiAweDA3ODAsCiAgZW5kOiAweDA3YmYKIH0sCiB7CiAgYmVnaW46IDB4MGQ4MCwKICBlbmQ6IDB4MGRmZgogfSwKIHsKICBiZWdpbjogMHgxMDAwLAogIGVuZDogMHgxMDlmCiB9LAogewogIGJlZ2luOiAweDEyMDAsCiAgZW5kOiAweDEzN2YKIH0sCiB7CiAgYmVnaW46IDB4MTNhMCwKICBlbmQ6IDB4MTNmZgogfSwKIHsKICBiZWdpbjogMHgxNDAwLAogIGVuZDogMHgxNjdmCiB9LAogewogIGJlZ2luOiAweDE2ODAsCiAgZW5kOiAweDE2OWYKIH0sCiB7CiAgYmVnaW46IDB4MTZhMCwKICBlbmQ6IDB4MTZmZgogfSwKIHsKICBiZWdpbjogMHgxNzgwLAogIGVuZDogMHgxN2ZmCiB9LAogewogIGJlZ2luOiAweDE4MDAsCiAgZW5kOiAweDE4YWYKIH0sCiB7CiAgYmVnaW46IDB4MjgwMCwKICBlbmQ6IDB4MjhmZgogfSwKIHsKICBiZWdpbjogMHhhMDAwLAogIGVuZDogMHhhNDhmCiB9LAogewogIGJlZ2luOiAweDE3MDAsCiAgZW5kOiAweDE3MWYKIH0sCiB7CiAgYmVnaW46IDB4MTAzMDAsCiAgZW5kOiAweDEwMzJmCiB9LAogewogIGJlZ2luOiAweDEwMzMwLAogIGVuZDogMHgxMDM0ZgogfSwKIHsKICBiZWdpbjogMHgxMDQwMCwKICBlbmQ6IDB4MTA0NGYKIH0sCiB7CiAgYmVnaW46IDB4MWQwMDAsCiAgZW5kOiAweDFkMGZmCiB9LAogewogIGJlZ2luOiAweDFkNDAwLAogIGVuZDogMHgxZDdmZgogfSwKIHsKICBiZWdpbjogMHhmZjAwMCwKICBlbmQ6IDB4ZmZmZmQKIH0sCiB7CiAgYmVnaW46IDB4ZmUwMCwKICBlbmQ6IDB4ZmUwZgogfSwKIHsKICBiZWdpbjogMHhlMDAwMCwKICBlbmQ6IDB4ZTAwN2YKIH0sCiB7CiAgYmVnaW46IDB4MTkwMCwKICBlbmQ6IDB4MTk0ZgogfSwKIHsKICBiZWdpbjogMHgxOTUwLAogIGVuZDogMHgxOTdmCiB9LAogewogIGJlZ2luOiAweDE5ODAsCiAgZW5kOiAweDE5ZGYKIH0sCiB7CiAgYmVnaW46IDB4MWEwMCwKICBlbmQ6IDB4MWExZgogfSwKIHsKICBiZWdpbjogMHgyYzAwLAogIGVuZDogMHgyYzVmCiB9LAogewogIGJlZ2luOiAweDJkMzAsCiAgZW5kOiAweDJkN2YKIH0sCiB7CiAgYmVnaW46IDB4NGRjMCwKICBlbmQ6IDB4NGRmZgogfSwKIHsKICBiZWdpbjogMHhhODAwLAogIGVuZDogMHhhODJmCiB9LAogewogIGJlZ2luOiAweDEwMDAwLAogIGVuZDogMHgxMDA3ZgogfSwKIHsKICBiZWdpbjogMHgxMDE0MCwKICBlbmQ6IDB4MTAxOGYKIH0sCiB7CiAgYmVnaW46IDB4MTAzODAsCiAgZW5kOiAweDEwMzlmCiB9LAogewogIGJlZ2luOiAweDEwM2EwLAogIGVuZDogMHgxMDNkZgogfSwKIHsKICBiZWdpbjogMHgxMDQ1MCwKICBlbmQ6IDB4MTA0N2YKIH0sCiB7CiAgYmVnaW46IDB4MTA0ODAsCiAgZW5kOiAweDEwNGFmCiB9LAogewogIGJlZ2luOiAweDEwODAwLAogIGVuZDogMHgxMDgzZgogfSwKIHsKICBiZWdpbjogMHgxMGEwMCwKICBlbmQ6IDB4MTBhNWYKIH0sCiB7CiAgYmVnaW46IDB4MWQzMDAsCiAgZW5kOiAweDFkMzVmCiB9LAogewogIGJlZ2luOiAweDEyMDAwLAogIGVuZDogMHgxMjNmZgogfSwKIHsKICBiZWdpbjogMHgxZDM2MCwKICBlbmQ6IDB4MWQzN2YKIH0sCiB7CiAgYmVnaW46IDB4MWI4MCwKICBlbmQ6IDB4MWJiZgogfSwKIHsKICBiZWdpbjogMHgxYzAwLAogIGVuZDogMHgxYzRmCiB9LAogewogIGJlZ2luOiAweDFjNTAsCiAgZW5kOiAweDFjN2YKIH0sCiB7CiAgYmVnaW46IDB4YTg4MCwKICBlbmQ6IDB4YThkZgogfSwKIHsKICBiZWdpbjogMHhhOTAwLAogIGVuZDogMHhhOTJmCiB9LAogewogIGJlZ2luOiAweGE5MzAsCiAgZW5kOiAweGE5NWYKIH0sCiB7CiAgYmVnaW46IDB4YWEwMCwKICBlbmQ6IDB4YWE1ZgogfSwKIHsKICBiZWdpbjogMHgxMDE5MCwKICBlbmQ6IDB4MTAxY2YKIH0sCiB7CiAgYmVnaW46IDB4MTAxZDAsCiAgZW5kOiAweDEwMWZmCiB9LAogewogIGJlZ2luOiAweDEwMmEwLAogIGVuZDogMHgxMDJkZgogfSwKIHsKICBiZWdpbjogMHgxZjAzMCwKICBlbmQ6IDB4MWYwOWYKIH0KXTsKZnVuY3Rpb24gZ2V0VW5pY29kZVJhbmdlRm9yKHZhbHVlKSB7CiBmb3IgKGxldCBpID0gMCwgaWkgPSBVbmljb2RlUmFuZ2VzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICBjb25zdCByYW5nZSA9IFVuaWNvZGVSYW5nZXNbaV07CiAgaWYgKHZhbHVlID49IHJhbmdlLmJlZ2luICYmIHZhbHVlIDwgcmFuZ2UuZW5kKSB7CiAgIHJldHVybiBpOwogIH0KIH0KIHJldHVybiAtMTsKfQpmdW5jdGlvbiBpc1JUTFJhbmdlRm9yKHZhbHVlKSB7CiBsZXQgcmFuZ2UgPSBVbmljb2RlUmFuZ2VzWzEzXTsKIGlmICh2YWx1ZSA+PSByYW5nZS5iZWdpbiAmJiB2YWx1ZSA8IHJhbmdlLmVuZCkgewogIHJldHVybiB0cnVlOwogfQogcmFuZ2UgPSBVbmljb2RlUmFuZ2VzWzExXTsKIGlmICh2YWx1ZSA+PSByYW5nZS5iZWdpbiAmJiB2YWx1ZSA8IHJhbmdlLmVuZCkgewogIHJldHVybiB0cnVlOwogfQogcmV0dXJuIGZhbHNlOwp9CmNvbnN0IGdldE5vcm1hbGl6ZWRVbmljb2RlcyA9ICgwLF9jb3JlX3V0aWxzX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18uZ2V0QXJyYXlMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICgpIHsKIHJldHVybiBbCiAgIlx1MDBBOCIsCiAgIlx1MDAyMFx1MDMwOCIsCiAgIlx1MDBBRiIsCiAgIlx1MDAyMFx1MDMwNCIsCiAgIlx1MDBCNCIsCiAgIlx1MDAyMFx1MDMwMSIsCiAgIlx1MDBCNSIsCiAgIlx1MDNCQyIsCiAgIlx1MDBCOCIsCiAgIlx1MDAyMFx1MDMyNyIsCiAgIlx1MDEzMiIsCiAgIlx1MDA0OVx1MDA0QSIsCiAgIlx1MDEzMyIsCiAgIlx1MDA2OVx1MDA2QSIsCiAgIlx1MDEzRiIsCiAgIlx1MDA0Q1x1MDBCNyIsCiAgIlx1MDE0MCIsCiAgIlx1MDA2Q1x1MDBCNyIsCiAgIlx1MDE0OSIsCiAgIlx1MDJCQ1x1MDA2RSIsCiAgIlx1MDE3RiIsCiAgIlx1MDA3MyIsCiAgIlx1MDFDNCIsCiAgIlx1MDA0NFx1MDE3RCIsCiAgIlx1MDFDNSIsCiAgIlx1MDA0NFx1MDE3RSIsCiAgIlx1MDFDNiIsCiAgIlx1MDA2NFx1MDE3RSIsCiAgIlx1MDFDNyIsCiAgIlx1MDA0Q1x1MDA0QSIsCiAgIlx1MDFDOCIsCiAgIlx1MDA0Q1x1MDA2QSIsCiAgIlx1MDFDOSIsCiAgIlx1MDA2Q1x1MDA2QSIsCiAgIlx1MDFDQSIsCiAgIlx1MDA0RVx1MDA0QSIsCiAgIlx1MDFDQiIsCiAgIlx1MDA0RVx1MDA2QSIsCiAgIlx1MDFDQyIsCiAgIlx1MDA2RVx1MDA2QSIsCiAgIlx1MDFGMSIsCiAgIlx1MDA0NFx1MDA1QSIsCiAgIlx1MDFGMiIsCiAgIlx1MDA0NFx1MDA3QSIsCiAgIlx1MDFGMyIsCiAgIlx1MDA2NFx1MDA3QSIsCiAgIlx1MDJEOCIsCiAgIlx1MDAyMFx1MDMwNiIsCiAgIlx1MDJEOSIsCiAgIlx1MDAyMFx1MDMwNyIsCiAgIlx1MDJEQSIsCiAgIlx1MDAyMFx1MDMwQSIsCiAgIlx1MDJEQiIsCiAgIlx1MDAyMFx1MDMyOCIsCiAgIlx1MDJEQyIsCiAgIlx1MDAyMFx1MDMwMyIsCiAgIlx1MDJERCIsCiAgIlx1MDAyMFx1MDMwQiIsCiAgIlx1MDM3QSIsCiAgIlx1MDAyMFx1MDM0NSIsCiAgIlx1MDM4NCIsCiAgIlx1MDAyMFx1MDMwMSIsCiAgIlx1MDNEMCIsCiAgIlx1MDNCMiIsCiAgIlx1MDNEMSIsCiAgIlx1MDNCOCIsCiAgIlx1MDNEMiIsCiAgIlx1MDNBNSIsCiAgIlx1MDNENSIsCiAgIlx1MDNDNiIsCiAgIlx1MDNENiIsCiAgIlx1MDNDMCIsCiAgIlx1MDNGMCIsCiAgIlx1MDNCQSIsCiAgIlx1MDNGMSIsCiAgIlx1MDNDMSIsCiAgIlx1MDNGMiIsCiAgIlx1MDNDMiIsCiAgIlx1MDNGNCIsCiAgIlx1MDM5OCIsCiAgIlx1MDNGNSIsCiAgIlx1MDNCNSIsCiAgIlx1MDNGOSIsCiAgIlx1MDNBMyIsCiAgIlx1MDU4NyIsCiAgIlx1MDU2NVx1MDU4MiIsCiAgIlx1MDY3NSIsCiAgIlx1MDYyN1x1MDY3NCIsCiAgIlx1MDY3NiIsCiAgIlx1MDY0OFx1MDY3NCIsCiAgIlx1MDY3NyIsCiAgIlx1MDZDN1x1MDY3NCIsCiAgIlx1MDY3OCIsCiAgIlx1MDY0QVx1MDY3NCIsCiAgIlx1MEUzMyIsCiAgIlx1MEU0RFx1MEUzMiIsCiAgIlx1MEVCMyIsCiAgIlx1MEVDRFx1MEVCMiIsCiAgIlx1MEVEQyIsCiAgIlx1MEVBQlx1MEU5OSIsCiAgIlx1MEVERCIsCiAgIlx1MEVBQlx1MEVBMSIsCiAgIlx1MEY3NyIsCiAgIlx1MEZCMlx1MEY4MSIsCiAgIlx1MEY3OSIsCiAgIlx1MEZCM1x1MEY4MSIsCiAgIlx1MUU5QSIsCiAgIlx1MDA2MVx1MDJCRSIsCiAgIlx1MUZCRCIsCiAgIlx1MDAyMFx1MDMxMyIsCiAgIlx1MUZCRiIsCiAgIlx1MDAyMFx1MDMxMyIsCiAgIlx1MUZDMCIsCiAgIlx1MDAyMFx1MDM0MiIsCiAgIlx1MUZGRSIsCiAgIlx1MDAyMFx1MDMxNCIsCiAgIlx1MjAwMiIsCiAgIlx1MDAyMCIsCiAgIlx1MjAwMyIsCiAgIlx1MDAyMCIsCiAgIlx1MjAwNCIsCiAgIlx1MDAyMCIsCiAgIlx1MjAwNSIsCiAgIlx1MDAyMCIsCiAgIlx1MjAwNiIsCiAgIlx1MDAyMCIsCiAgIlx1MjAwOCIsCiAgIlx1MDAyMCIsCiAgIlx1MjAwOSIsCiAgIlx1MDAyMCIsCiAgIlx1MjAwQSIsCiAgIlx1MDAyMCIsCiAgIlx1MjAxNyIsCiAgIlx1MDAyMFx1MDMzMyIsCiAgIlx1MjAyNCIsCiAgIlx1MDAyRSIsCiAgIlx1MjAyNSIsCiAgIlx1MDAyRVx1MDAyRSIsCiAgIlx1MjAyNiIsCiAgIlx1MDAyRVx1MDAyRVx1MDAyRSIsCiAgIlx1MjAzMyIsCiAgIlx1MjAzMlx1MjAzMiIsCiAgIlx1MjAzNCIsCiAgIlx1MjAzMlx1MjAzMlx1MjAzMiIsCiAgIlx1MjAzNiIsCiAgIlx1MjAzNVx1MjAzNSIsCiAgIlx1MjAzNyIsCiAgIlx1MjAzNVx1MjAzNVx1MjAzNSIsCiAgIlx1MjAzQyIsCiAgIlx1MDAyMVx1MDAyMSIsCiAgIlx1MjAzRSIsCiAgIlx1MDAyMFx1MDMwNSIsCiAgIlx1MjA0NyIsCiAgIlx1MDAzRlx1MDAzRiIsCiAgIlx1MjA0OCIsCiAgIlx1MDAzRlx1MDAyMSIsCiAgIlx1MjA0OSIsCiAgIlx1MDAyMVx1MDAzRiIsCiAgIlx1MjA1NyIsCiAgIlx1MjAzMlx1MjAzMlx1MjAzMlx1MjAzMiIsCiAgIlx1MjA1RiIsCiAgIlx1MDAyMCIsCiAgIlx1MjBBOCIsCiAgIlx1MDA1Mlx1MDA3MyIsCiAgIlx1MjEwMCIsCiAgIlx1MDA2MVx1MDAyRlx1MDA2MyIsCiAgIlx1MjEwMSIsCiAgIlx1MDA2MVx1MDAyRlx1MDA3MyIsCiAgIlx1MjEwMyIsCiAgIlx1MDBCMFx1MDA0MyIsCiAgIlx1MjEwNSIsCiAgIlx1MDA2M1x1MDAyRlx1MDA2RiIsCiAgIlx1MjEwNiIsCiAgIlx1MDA2M1x1MDAyRlx1MDA3NSIsCiAgIlx1MjEwNyIsCiAgIlx1MDE5MCIsCiAgIlx1MjEwOSIsCiAgIlx1MDBCMFx1MDA0NiIsCiAgIlx1MjExNiIsCiAgIlx1MDA0RVx1MDA2RiIsCiAgIlx1MjEyMSIsCiAgIlx1MDA1NFx1MDA0NVx1MDA0QyIsCiAgIlx1MjEzNSIsCiAgIlx1MDVEMCIsCiAgIlx1MjEzNiIsCiAgIlx1MDVEMSIsCiAgIlx1MjEzNyIsCiAgIlx1MDVEMiIsCiAgIlx1MjEzOCIsCiAgIlx1MDVEMyIsCiAgIlx1MjEzQiIsCiAgIlx1MDA0Nlx1MDA0MVx1MDA1OCIsCiAgIlx1MjE2MCIsCiAgIlx1MDA0OSIsCiAgIlx1MjE2MSIsCiAgIlx1MDA0OVx1MDA0OSIsCiAgIlx1MjE2MiIsCiAgIlx1MDA0OVx1MDA0OVx1MDA0OSIsCiAgIlx1MjE2MyIsCiAgIlx1MDA0OVx1MDA1NiIsCiAgIlx1MjE2NCIsCiAgIlx1MDA1NiIsCiAgIlx1MjE2NSIsCiAgIlx1MDA1Nlx1MDA0OSIsCiAgIlx1MjE2NiIsCiAgIlx1MDA1Nlx1MDA0OVx1MDA0OSIsCiAgIlx1MjE2NyIsCiAgIlx1MDA1Nlx1MDA0OVx1MDA0OVx1MDA0OSIsCiAgIlx1MjE2OCIsCiAgIlx1MDA0OVx1MDA1OCIsCiAgIlx1MjE2OSIsCiAgIlx1MDA1OCIsCiAgIlx1MjE2QSIsCiAgIlx1MDA1OFx1MDA0OSIsCiAgIlx1MjE2QiIsCiAgIlx1MDA1OFx1MDA0OVx1MDA0OSIsCiAgIlx1MjE2QyIsCiAgIlx1MDA0QyIsCiAgIlx1MjE2RCIsCiAgIlx1MDA0MyIsCiAgIlx1MjE2RSIsCiAgIlx1MDA0NCIsCiAgIlx1MjE2RiIsCiAgIlx1MDA0RCIsCiAgIlx1MjE3MCIsCiAgIlx1MDA2OSIsCiAgIlx1MjE3MSIsCiAgIlx1MDA2OVx1MDA2OSIsCiAgIlx1MjE3MiIsCiAgIlx1MDA2OVx1MDA2OVx1MDA2OSIsCiAgIlx1MjE3MyIsCiAgIlx1MDA2OVx1MDA3NiIsCiAgIlx1MjE3NCIsCiAgIlx1MDA3NiIsCiAgIlx1MjE3NSIsCiAgIlx1MDA3Nlx1MDA2OSIsCiAgIlx1MjE3NiIsCiAgIlx1MDA3Nlx1MDA2OVx1MDA2OSIsCiAgIlx1MjE3NyIsCiAgIlx1MDA3Nlx1MDA2OVx1MDA2OVx1MDA2OSIsCiAgIlx1MjE3OCIsCiAgIlx1MDA2OVx1MDA3OCIsCiAgIlx1MjE3OSIsCiAgIlx1MDA3OCIsCiAgIlx1MjE3QSIsCiAgIlx1MDA3OFx1MDA2OSIsCiAgIlx1MjE3QiIsCiAgIlx1MDA3OFx1MDA2OVx1MDA2OSIsCiAgIlx1MjE3QyIsCiAgIlx1MDA2QyIsCiAgIlx1MjE3RCIsCiAgIlx1MDA2MyIsCiAgIlx1MjE3RSIsCiAgIlx1MDA2NCIsCiAgIlx1MjE3RiIsCiAgIlx1MDA2RCIsCiAgIlx1MjIyQyIsCiAgIlx1MjIyQlx1MjIyQiIsCiAgIlx1MjIyRCIsCiAgIlx1MjIyQlx1MjIyQlx1MjIyQiIsCiAgIlx1MjIyRiIsCiAgIlx1MjIyRVx1MjIyRSIsCiAgIlx1MjIzMCIsCiAgIlx1MjIyRVx1MjIyRVx1MjIyRSIsCiAgIlx1MjQ3NCIsCiAgIlx1MDAyOFx1MDAzMVx1MDAyOSIsCiAgIlx1MjQ3NSIsCiAgIlx1MDAyOFx1MDAzMlx1MDAyOSIsCiAgIlx1MjQ3NiIsCiAgIlx1MDAyOFx1MDAzM1x1MDAyOSIsCiAgIlx1MjQ3NyIsCiAgIlx1MDAyOFx1MDAzNFx1MDAyOSIsCiAgIlx1MjQ3OCIsCiAgIlx1MDAyOFx1MDAzNVx1MDAyOSIsCiAgIlx1MjQ3OSIsCiAgIlx1MDAyOFx1MDAzNlx1MDAyOSIsCiAgIlx1MjQ3QSIsCiAgIlx1MDAyOFx1MDAzN1x1MDAyOSIsCiAgIlx1MjQ3QiIsCiAgIlx1MDAyOFx1MDAzOFx1MDAyOSIsCiAgIlx1MjQ3QyIsCiAgIlx1MDAyOFx1MDAzOVx1MDAyOSIsCiAgIlx1MjQ3RCIsCiAgIlx1MDAyOFx1MDAzMVx1MDAzMFx1MDAyOSIsCiAgIlx1MjQ3RSIsCiAgIlx1MDAyOFx1MDAzMVx1MDAzMVx1MDAyOSIsCiAgIlx1MjQ3RiIsCiAgIlx1MDAyOFx1MDAzMVx1MDAzMlx1MDAyOSIsCiAgIlx1MjQ4MCIsCiAgIlx1MDAyOFx1MDAzMVx1MDAzM1x1MDAyOSIsCiAgIlx1MjQ4MSIsCiAgIlx1MDAyOFx1MDAzMVx1MDAzNFx1MDAyOSIsCiAgIlx1MjQ4MiIsCiAgIlx1MDAyOFx1MDAzMVx1MDAzNVx1MDAyOSIsCiAgIlx1MjQ4MyIsCiAgIlx1MDAyOFx1MDAzMVx1MDAzNlx1MDAyOSIsCiAgIlx1MjQ4NCIsCiAgIlx1MDAyOFx1MDAzMVx1MDAzN1x1MDAyOSIsCiAgIlx1MjQ4NSIsCiAgIlx1MDAyOFx1MDAzMVx1MDAzOFx1MDAyOSIsCiAgIlx1MjQ4NiIsCiAgIlx1MDAyOFx1MDAzMVx1MDAzOVx1MDAyOSIsCiAgIlx1MjQ4NyIsCiAgIlx1MDAyOFx1MDAzMlx1MDAzMFx1MDAyOSIsCiAgIlx1MjQ4OCIsCiAgIlx1MDAzMVx1MDAyRSIsCiAgIlx1MjQ4OSIsCiAgIlx1MDAzMlx1MDAyRSIsCiAgIlx1MjQ4QSIsCiAgIlx1MDAzM1x1MDAyRSIsCiAgIlx1MjQ4QiIsCiAgIlx1MDAzNFx1MDAyRSIsCiAgIlx1MjQ4QyIsCiAgIlx1MDAzNVx1MDAyRSIsCiAgIlx1MjQ4RCIsCiAgIlx1MDAzNlx1MDAyRSIsCiAgIlx1MjQ4RSIsCiAgIlx1MDAzN1x1MDAyRSIsCiAgIlx1MjQ4RiIsCiAgIlx1MDAzOFx1MDAyRSIsCiAgIlx1MjQ5MCIsCiAgIlx1MDAzOVx1MDAyRSIsCiAgIlx1MjQ5MSIsCiAgIlx1MDAzMVx1MDAzMFx1MDAyRSIsCiAgIlx1MjQ5MiIsCiAgIlx1MDAzMVx1MDAzMVx1MDAyRSIsCiAgIlx1MjQ5MyIsCiAgIlx1MDAzMVx1MDAzMlx1MDAyRSIsCiAgIlx1MjQ5NCIsCiAgIlx1MDAzMVx1MDAzM1x1MDAyRSIsCiAgIlx1MjQ5NSIsCiAgIlx1MDAzMVx1MDAzNFx1MDAyRSIsCiAgIlx1MjQ5NiIsCiAgIlx1MDAzMVx1MDAzNVx1MDAyRSIsCiAgIlx1MjQ5NyIsCiAgIlx1MDAzMVx1MDAzNlx1MDAyRSIsCiAgIlx1MjQ5OCIsCiAgIlx1MDAzMVx1MDAzN1x1MDAyRSIsCiAgIlx1MjQ5OSIsCiAgIlx1MDAzMVx1MDAzOFx1MDAyRSIsCiAgIlx1MjQ5QSIsCiAgIlx1MDAzMVx1MDAzOVx1MDAyRSIsCiAgIlx1MjQ5QiIsCiAgIlx1MDAzMlx1MDAzMFx1MDAyRSIsCiAgIlx1MjQ5QyIsCiAgIlx1MDAyOFx1MDA2MVx1MDAyOSIsCiAgIlx1MjQ5RCIsCiAgIlx1MDAyOFx1MDA2Mlx1MDAyOSIsCiAgIlx1MjQ5RSIsCiAgIlx1MDAyOFx1MDA2M1x1MDAyOSIsCiAgIlx1MjQ5RiIsCiAgIlx1MDAyOFx1MDA2NFx1MDAyOSIsCiAgIlx1MjRBMCIsCiAgIlx1MDAyOFx1MDA2NVx1MDAyOSIsCiAgIlx1MjRBMSIsCiAgIlx1MDAyOFx1MDA2Nlx1MDAyOSIsCiAgIlx1MjRBMiIsCiAgIlx1MDAyOFx1MDA2N1x1MDAyOSIsCiAgIlx1MjRBMyIsCiAgIlx1MDAyOFx1MDA2OFx1MDAyOSIsCiAgIlx1MjRBNCIsCiAgIlx1MDAyOFx1MDA2OVx1MDAyOSIsCiAgIlx1MjRBNSIsCiAgIlx1MDAyOFx1MDA2QVx1MDAyOSIsCiAgIlx1MjRBNiIsCiAgIlx1MDAyOFx1MDA2Qlx1MDAyOSIsCiAgIlx1MjRBNyIsCiAgIlx1MDAyOFx1MDA2Q1x1MDAyOSIsCiAgIlx1MjRBOCIsCiAgIlx1MDAyOFx1MDA2RFx1MDAyOSIsCiAgIlx1MjRBOSIsCiAgIlx1MDAyOFx1MDA2RVx1MDAyOSIsCiAgIlx1MjRBQSIsCiAgIlx1MDAyOFx1MDA2Rlx1MDAyOSIsCiAgIlx1MjRBQiIsCiAgIlx1MDAyOFx1MDA3MFx1MDAyOSIsCiAgIlx1MjRBQyIsCiAgIlx1MDAyOFx1MDA3MVx1MDAyOSIsCiAgIlx1MjRBRCIsCiAgIlx1MDAyOFx1MDA3Mlx1MDAyOSIsCiAgIlx1MjRBRSIsCiAgIlx1MDAyOFx1MDA3M1x1MDAyOSIsCiAgIlx1MjRBRiIsCiAgIlx1MDAyOFx1MDA3NFx1MDAyOSIsCiAgIlx1MjRCMCIsCiAgIlx1MDAyOFx1MDA3NVx1MDAyOSIsCiAgIlx1MjRCMSIsCiAgIlx1MDAyOFx1MDA3Nlx1MDAyOSIsCiAgIlx1MjRCMiIsCiAgIlx1MDAyOFx1MDA3N1x1MDAyOSIsCiAgIlx1MjRCMyIsCiAgIlx1MDAyOFx1MDA3OFx1MDAyOSIsCiAgIlx1MjRCNCIsCiAgIlx1MDAyOFx1MDA3OVx1MDAyOSIsCiAgIlx1MjRCNSIsCiAgIlx1MDAyOFx1MDA3QVx1MDAyOSIsCiAgIlx1MkEwQyIsCiAgIlx1MjIyQlx1MjIyQlx1MjIyQlx1MjIyQiIsCiAgIlx1MkE3NCIsCiAgIlx1MDAzQVx1MDAzQVx1MDAzRCIsCiAgIlx1MkE3NSIsCiAgIlx1MDAzRFx1MDAzRCIsCiAgIlx1MkE3NiIsCiAgIlx1MDAzRFx1MDAzRFx1MDAzRCIsCiAgIlx1MkU5RiIsCiAgIlx1NkJDRCIsCiAgIlx1MkVGMyIsCiAgIlx1OUY5RiIsCiAgIlx1MkYwMCIsCiAgIlx1NEUwMCIsCiAgIlx1MkYwMSIsCiAgIlx1NEUyOCIsCiAgIlx1MkYwMiIsCiAgIlx1NEUzNiIsCiAgIlx1MkYwMyIsCiAgIlx1NEUzRiIsCiAgIlx1MkYwNCIsCiAgIlx1NEU1OSIsCiAgIlx1MkYwNSIsCiAgIlx1NEU4NSIsCiAgIlx1MkYwNiIsCiAgIlx1NEU4QyIsCiAgIlx1MkYwNyIsCiAgIlx1NEVBMCIsCiAgIlx1MkYwOCIsCiAgIlx1NEVCQSIsCiAgIlx1MkYwOSIsCiAgIlx1NTEzRiIsCiAgIlx1MkYwQSIsCiAgIlx1NTE2NSIsCiAgIlx1MkYwQiIsCiAgIlx1NTE2QiIsCiAgIlx1MkYwQyIsCiAgIlx1NTE4MiIsCiAgIlx1MkYwRCIsCiAgIlx1NTE5NiIsCiAgIlx1MkYwRSIsCiAgIlx1NTFBQiIsCiAgIlx1MkYwRiIsCiAgIlx1NTFFMCIsCiAgIlx1MkYxMCIsCiAgIlx1NTFGNSIsCiAgIlx1MkYxMSIsCiAgIlx1NTIwMCIsCiAgIlx1MkYxMiIsCiAgIlx1NTI5QiIsCiAgIlx1MkYxMyIsCiAgIlx1NTJGOSIsCiAgIlx1MkYxNCIsCiAgIlx1NTMxNSIsCiAgIlx1MkYxNSIsCiAgIlx1NTMxQSIsCiAgIlx1MkYxNiIsCiAgIlx1NTMzOCIsCiAgIlx1MkYxNyIsCiAgIlx1NTM0MSIsCiAgIlx1MkYxOCIsCiAgIlx1NTM1QyIsCiAgIlx1MkYxOSIsCiAgIlx1NTM2OSIsCiAgIlx1MkYxQSIsCiAgIlx1NTM4MiIsCiAgIlx1MkYxQiIsCiAgIlx1NTNCNiIsCiAgIlx1MkYxQyIsCiAgIlx1NTNDOCIsCiAgIlx1MkYxRCIsCiAgIlx1NTNFMyIsCiAgIlx1MkYxRSIsCiAgIlx1NTZENyIsCiAgIlx1MkYxRiIsCiAgIlx1NTcxRiIsCiAgIlx1MkYyMCIsCiAgIlx1NThFQiIsCiAgIlx1MkYyMSIsCiAgIlx1NTkwMiIsCiAgIlx1MkYyMiIsCiAgIlx1NTkwQSIsCiAgIlx1MkYyMyIsCiAgIlx1NTkxNSIsCiAgIlx1MkYyNCIsCiAgIlx1NTkyNyIsCiAgIlx1MkYyNSIsCiAgIlx1NTk3MyIsCiAgIlx1MkYyNiIsCiAgIlx1NUI1MCIsCiAgIlx1MkYyNyIsCiAgIlx1NUI4MCIsCiAgIlx1MkYyOCIsCiAgIlx1NUJGOCIsCiAgIlx1MkYyOSIsCiAgIlx1NUMwRiIsCiAgIlx1MkYyQSIsCiAgIlx1NUMyMiIsCiAgIlx1MkYyQiIsCiAgIlx1NUMzOCIsCiAgIlx1MkYyQyIsCiAgIlx1NUM2RSIsCiAgIlx1MkYyRCIsCiAgIlx1NUM3MSIsCiAgIlx1MkYyRSIsCiAgIlx1NUREQiIsCiAgIlx1MkYyRiIsCiAgIlx1NURFNSIsCiAgIlx1MkYzMCIsCiAgIlx1NURGMSIsCiAgIlx1MkYzMSIsCiAgIlx1NURGRSIsCiAgIlx1MkYzMiIsCiAgIlx1NUU3MiIsCiAgIlx1MkYzMyIsCiAgIlx1NUU3QSIsCiAgIlx1MkYzNCIsCiAgIlx1NUU3RiIsCiAgIlx1MkYzNSIsCiAgIlx1NUVGNCIsCiAgIlx1MkYzNiIsCiAgIlx1NUVGRSIsCiAgIlx1MkYzNyIsCiAgIlx1NUYwQiIsCiAgIlx1MkYzOCIsCiAgIlx1NUYxMyIsCiAgIlx1MkYzOSIsCiAgIlx1NUY1MCIsCiAgIlx1MkYzQSIsCiAgIlx1NUY2MSIsCiAgIlx1MkYzQiIsCiAgIlx1NUY3MyIsCiAgIlx1MkYzQyIsCiAgIlx1NUZDMyIsCiAgIlx1MkYzRCIsCiAgIlx1NjIwOCIsCiAgIlx1MkYzRSIsCiAgIlx1NjIzNiIsCiAgIlx1MkYzRiIsCiAgIlx1NjI0QiIsCiAgIlx1MkY0MCIsCiAgIlx1NjUyRiIsCiAgIlx1MkY0MSIsCiAgIlx1NjUzNCIsCiAgIlx1MkY0MiIsCiAgIlx1NjU4NyIsCiAgIlx1MkY0MyIsCiAgIlx1NjU5NyIsCiAgIlx1MkY0NCIsCiAgIlx1NjVBNCIsCiAgIlx1MkY0NSIsCiAgIlx1NjVCOSIsCiAgIlx1MkY0NiIsCiAgIlx1NjVFMCIsCiAgIlx1MkY0NyIsCiAgIlx1NjVFNSIsCiAgIlx1MkY0OCIsCiAgIlx1NjZGMCIsCiAgIlx1MkY0OSIsCiAgIlx1NjcwOCIsCiAgIlx1MkY0QSIsCiAgIlx1NjcyOCIsCiAgIlx1MkY0QiIsCiAgIlx1NkIyMCIsCiAgIlx1MkY0QyIsCiAgIlx1NkI2MiIsCiAgIlx1MkY0RCIsCiAgIlx1NkI3OSIsCiAgIlx1MkY0RSIsCiAgIlx1NkJCMyIsCiAgIlx1MkY0RiIsCiAgIlx1NkJDQiIsCiAgIlx1MkY1MCIsCiAgIlx1NkJENCIsCiAgIlx1MkY1MSIsCiAgIlx1NkJEQiIsCiAgIlx1MkY1MiIsCiAgIlx1NkMwRiIsCiAgIlx1MkY1MyIsCiAgIlx1NkMxNCIsCiAgIlx1MkY1NCIsCiAgIlx1NkMzNCIsCiAgIlx1MkY1NSIsCiAgIlx1NzA2QiIsCiAgIlx1MkY1NiIsCiAgIlx1NzIyQSIsCiAgIlx1MkY1NyIsCiAgIlx1NzIzNiIsCiAgIlx1MkY1OCIsCiAgIlx1NzIzQiIsCiAgIlx1MkY1OSIsCiAgIlx1NzIzRiIsCiAgIlx1MkY1QSIsCiAgIlx1NzI0NyIsCiAgIlx1MkY1QiIsCiAgIlx1NzI1OSIsCiAgIlx1MkY1QyIsCiAgIlx1NzI1QiIsCiAgIlx1MkY1RCIsCiAgIlx1NzJBQyIsCiAgIlx1MkY1RSIsCiAgIlx1NzM4NCIsCiAgIlx1MkY1RiIsCiAgIlx1NzM4OSIsCiAgIlx1MkY2MCIsCiAgIlx1NzREQyIsCiAgIlx1MkY2MSIsCiAgIlx1NzRFNiIsCiAgIlx1MkY2MiIsCiAgIlx1NzUxOCIsCiAgIlx1MkY2MyIsCiAgIlx1NzUxRiIsCiAgIlx1MkY2NCIsCiAgIlx1NzUyOCIsCiAgIlx1MkY2NSIsCiAgIlx1NzUzMCIsCiAgIlx1MkY2NiIsCiAgIlx1NzU4QiIsCiAgIlx1MkY2NyIsCiAgIlx1NzU5MiIsCiAgIlx1MkY2OCIsCiAgIlx1NzY3NiIsCiAgIlx1MkY2OSIsCiAgIlx1NzY3RCIsCiAgIlx1MkY2QSIsCiAgIlx1NzZBRSIsCiAgIlx1MkY2QiIsCiAgIlx1NzZCRiIsCiAgIlx1MkY2QyIsCiAgIlx1NzZFRSIsCiAgIlx1MkY2RCIsCiAgIlx1NzdEQiIsCiAgIlx1MkY2RSIsCiAgIlx1NzdFMiIsCiAgIlx1MkY2RiIsCiAgIlx1NzdGMyIsCiAgIlx1MkY3MCIsCiAgIlx1NzkzQSIsCiAgIlx1MkY3MSIsCiAgIlx1NzlCOCIsCiAgIlx1MkY3MiIsCiAgIlx1NzlCRSIsCiAgIlx1MkY3MyIsCiAgIlx1N0E3NCIsCiAgIlx1MkY3NCIsCiAgIlx1N0FDQiIsCiAgIlx1MkY3NSIsCiAgIlx1N0FGOSIsCiAgIlx1MkY3NiIsCiAgIlx1N0M3MyIsCiAgIlx1MkY3NyIsCiAgIlx1N0NGOCIsCiAgIlx1MkY3OCIsCiAgIlx1N0YzNiIsCiAgIlx1MkY3OSIsCiAgIlx1N0Y1MSIsCiAgIlx1MkY3QSIsCiAgIlx1N0Y4QSIsCiAgIlx1MkY3QiIsCiAgIlx1N0ZCRCIsCiAgIlx1MkY3QyIsCiAgIlx1ODAwMSIsCiAgIlx1MkY3RCIsCiAgIlx1ODAwQyIsCiAgIlx1MkY3RSIsCiAgIlx1ODAxMiIsCiAgIlx1MkY3RiIsCiAgIlx1ODAzMyIsCiAgIlx1MkY4MCIsCiAgIlx1ODA3RiIsCiAgIlx1MkY4MSIsCiAgIlx1ODA4OSIsCiAgIlx1MkY4MiIsCiAgIlx1ODFFMyIsCiAgIlx1MkY4MyIsCiAgIlx1ODFFQSIsCiAgIlx1MkY4NCIsCiAgIlx1ODFGMyIsCiAgIlx1MkY4NSIsCiAgIlx1ODFGQyIsCiAgIlx1MkY4NiIsCiAgIlx1ODIwQyIsCiAgIlx1MkY4NyIsCiAgIlx1ODIxQiIsCiAgIlx1MkY4OCIsCiAgIlx1ODIxRiIsCiAgIlx1MkY4OSIsCiAgIlx1ODI2RSIsCiAgIlx1MkY4QSIsCiAgIlx1ODI3MiIsCiAgIlx1MkY4QiIsCiAgIlx1ODI3OCIsCiAgIlx1MkY4QyIsCiAgIlx1ODY0RCIsCiAgIlx1MkY4RCIsCiAgIlx1ODY2QiIsCiAgIlx1MkY4RSIsCiAgIlx1ODg0MCIsCiAgIlx1MkY4RiIsCiAgIlx1ODg0QyIsCiAgIlx1MkY5MCIsCiAgIlx1ODg2MyIsCiAgIlx1MkY5MSIsCiAgIlx1ODk3RSIsCiAgIlx1MkY5MiIsCiAgIlx1ODk4QiIsCiAgIlx1MkY5MyIsCiAgIlx1ODlEMiIsCiAgIlx1MkY5NCIsCiAgIlx1OEEwMCIsCiAgIlx1MkY5NSIsCiAgIlx1OEMzNyIsCiAgIlx1MkY5NiIsCiAgIlx1OEM0NiIsCiAgIlx1MkY5NyIsCiAgIlx1OEM1NSIsCiAgIlx1MkY5OCIsCiAgIlx1OEM3OCIsCiAgIlx1MkY5OSIsCiAgIlx1OEM5RCIsCiAgIlx1MkY5QSIsCiAgIlx1OEQ2NCIsCiAgIlx1MkY5QiIsCiAgIlx1OEQ3MCIsCiAgIlx1MkY5QyIsCiAgIlx1OERCMyIsCiAgIlx1MkY5RCIsCiAgIlx1OEVBQiIsCiAgIlx1MkY5RSIsCiAgIlx1OEVDQSIsCiAgIlx1MkY5RiIsCiAgIlx1OEY5QiIsCiAgIlx1MkZBMCIsCiAgIlx1OEZCMCIsCiAgIlx1MkZBMSIsCiAgIlx1OEZCNSIsCiAgIlx1MkZBMiIsCiAgIlx1OTA5MSIsCiAgIlx1MkZBMyIsCiAgIlx1OTE0OSIsCiAgIlx1MkZBNCIsCiAgIlx1OTFDNiIsCiAgIlx1MkZBNSIsCiAgIlx1OTFDQyIsCiAgIlx1MkZBNiIsCiAgIlx1OTFEMSIsCiAgIlx1MkZBNyIsCiAgIlx1OTU3NyIsCiAgIlx1MkZBOCIsCiAgIlx1OTU4MCIsCiAgIlx1MkZBOSIsCiAgIlx1OTYxQyIsCiAgIlx1MkZBQSIsCiAgIlx1OTZCNiIsCiAgIlx1MkZBQiIsCiAgIlx1OTZCOSIsCiAgIlx1MkZBQyIsCiAgIlx1OTZFOCIsCiAgIlx1MkZBRCIsCiAgIlx1OTc1MSIsCiAgIlx1MkZBRSIsCiAgIlx1OTc1RSIsCiAgIlx1MkZBRiIsCiAgIlx1OTc2MiIsCiAgIlx1MkZCMCIsCiAgIlx1OTc2OSIsCiAgIlx1MkZCMSIsCiAgIlx1OTdDQiIsCiAgIlx1MkZCMiIsCiAgIlx1OTdFRCIsCiAgIlx1MkZCMyIsCiAgIlx1OTdGMyIsCiAgIlx1MkZCNCIsCiAgIlx1OTgwMSIsCiAgIlx1MkZCNSIsCiAgIlx1OThBOCIsCiAgIlx1MkZCNiIsCiAgIlx1OThEQiIsCiAgIlx1MkZCNyIsCiAgIlx1OThERiIsCiAgIlx1MkZCOCIsCiAgIlx1OTk5NiIsCiAgIlx1MkZCOSIsCiAgIlx1OTk5OSIsCiAgIlx1MkZCQSIsCiAgIlx1OTlBQyIsCiAgIlx1MkZCQiIsCiAgIlx1OUFBOCIsCiAgIlx1MkZCQyIsCiAgIlx1OUFEOCIsCiAgIlx1MkZCRCIsCiAgIlx1OUFERiIsCiAgIlx1MkZCRSIsCiAgIlx1OUIyNSIsCiAgIlx1MkZCRiIsCiAgIlx1OUIyRiIsCiAgIlx1MkZDMCIsCiAgIlx1OUIzMiIsCiAgIlx1MkZDMSIsCiAgIlx1OUIzQyIsCiAgIlx1MkZDMiIsCiAgIlx1OUI1QSIsCiAgIlx1MkZDMyIsCiAgIlx1OUNFNSIsCiAgIlx1MkZDNCIsCiAgIlx1OUU3NSIsCiAgIlx1MkZDNSIsCiAgIlx1OUU3RiIsCiAgIlx1MkZDNiIsCiAgIlx1OUVBNSIsCiAgIlx1MkZDNyIsCiAgIlx1OUVCQiIsCiAgIlx1MkZDOCIsCiAgIlx1OUVDMyIsCiAgIlx1MkZDOSIsCiAgIlx1OUVDRCIsCiAgIlx1MkZDQSIsCiAgIlx1OUVEMSIsCiAgIlx1MkZDQiIsCiAgIlx1OUVGOSIsCiAgIlx1MkZDQyIsCiAgIlx1OUVGRCIsCiAgIlx1MkZDRCIsCiAgIlx1OUYwRSIsCiAgIlx1MkZDRSIsCiAgIlx1OUYxMyIsCiAgIlx1MkZDRiIsCiAgIlx1OUYyMCIsCiAgIlx1MkZEMCIsCiAgIlx1OUYzQiIsCiAgIlx1MkZEMSIsCiAgIlx1OUY0QSIsCiAgIlx1MkZEMiIsCiAgIlx1OUY1MiIsCiAgIlx1MkZEMyIsCiAgIlx1OUY4RCIsCiAgIlx1MkZENCIsCiAgIlx1OUY5QyIsCiAgIlx1MkZENSIsCiAgIlx1OUZBMCIsCiAgIlx1MzAzNiIsCiAgIlx1MzAxMiIsCiAgIlx1MzAzOCIsCiAgIlx1NTM0MSIsCiAgIlx1MzAzOSIsCiAgIlx1NTM0NCIsCiAgIlx1MzAzQSIsCiAgIlx1NTM0NSIsCiAgIlx1MzA5QiIsCiAgIlx1MDAyMFx1MzA5OSIsCiAgIlx1MzA5QyIsCiAgIlx1MDAyMFx1MzA5QSIsCiAgIlx1MzEzMSIsCiAgIlx1MTEwMCIsCiAgIlx1MzEzMiIsCiAgIlx1MTEwMSIsCiAgIlx1MzEzMyIsCiAgIlx1MTFBQSIsCiAgIlx1MzEzNCIsCiAgIlx1MTEwMiIsCiAgIlx1MzEzNSIsCiAgIlx1MTFBQyIsCiAgIlx1MzEzNiIsCiAgIlx1MTFBRCIsCiAgIlx1MzEzNyIsCiAgIlx1MTEwMyIsCiAgIlx1MzEzOCIsCiAgIlx1MTEwNCIsCiAgIlx1MzEzOSIsCiAgIlx1MTEwNSIsCiAgIlx1MzEzQSIsCiAgIlx1MTFCMCIsCiAgIlx1MzEzQiIsCiAgIlx1MTFCMSIsCiAgIlx1MzEzQyIsCiAgIlx1MTFCMiIsCiAgIlx1MzEzRCIsCiAgIlx1MTFCMyIsCiAgIlx1MzEzRSIsCiAgIlx1MTFCNCIsCiAgIlx1MzEzRiIsCiAgIlx1MTFCNSIsCiAgIlx1MzE0MCIsCiAgIlx1MTExQSIsCiAgIlx1MzE0MSIsCiAgIlx1MTEwNiIsCiAgIlx1MzE0MiIsCiAgIlx1MTEwNyIsCiAgIlx1MzE0MyIsCiAgIlx1MTEwOCIsCiAgIlx1MzE0NCIsCiAgIlx1MTEyMSIsCiAgIlx1MzE0NSIsCiAgIlx1MTEwOSIsCiAgIlx1MzE0NiIsCiAgIlx1MTEwQSIsCiAgIlx1MzE0NyIsCiAgIlx1MTEwQiIsCiAgIlx1MzE0OCIsCiAgIlx1MTEwQyIsCiAgIlx1MzE0OSIsCiAgIlx1MTEwRCIsCiAgIlx1MzE0QSIsCiAgIlx1MTEwRSIsCiAgIlx1MzE0QiIsCiAgIlx1MTEwRiIsCiAgIlx1MzE0QyIsCiAgIlx1MTExMCIsCiAgIlx1MzE0RCIsCiAgIlx1MTExMSIsCiAgIlx1MzE0RSIsCiAgIlx1MTExMiIsCiAgIlx1MzE0RiIsCiAgIlx1MTE2MSIsCiAgIlx1MzE1MCIsCiAgIlx1MTE2MiIsCiAgIlx1MzE1MSIsCiAgIlx1MTE2MyIsCiAgIlx1MzE1MiIsCiAgIlx1MTE2NCIsCiAgIlx1MzE1MyIsCiAgIlx1MTE2NSIsCiAgIlx1MzE1NCIsCiAgIlx1MTE2NiIsCiAgIlx1MzE1NSIsCiAgIlx1MTE2NyIsCiAgIlx1MzE1NiIsCiAgIlx1MTE2OCIsCiAgIlx1MzE1NyIsCiAgIlx1MTE2OSIsCiAgIlx1MzE1OCIsCiAgIlx1MTE2QSIsCiAgIlx1MzE1OSIsCiAgIlx1MTE2QiIsCiAgIlx1MzE1QSIsCiAgIlx1MTE2QyIsCiAgIlx1MzE1QiIsCiAgIlx1MTE2RCIsCiAgIlx1MzE1QyIsCiAgIlx1MTE2RSIsCiAgIlx1MzE1RCIsCiAgIlx1MTE2RiIsCiAgIlx1MzE1RSIsCiAgIlx1MTE3MCIsCiAgIlx1MzE1RiIsCiAgIlx1MTE3MSIsCiAgIlx1MzE2MCIsCiAgIlx1MTE3MiIsCiAgIlx1MzE2MSIsCiAgIlx1MTE3MyIsCiAgIlx1MzE2MiIsCiAgIlx1MTE3NCIsCiAgIlx1MzE2MyIsCiAgIlx1MTE3NSIsCiAgIlx1MzE2NCIsCiAgIlx1MTE2MCIsCiAgIlx1MzE2NSIsCiAgIlx1MTExNCIsCiAgIlx1MzE2NiIsCiAgIlx1MTExNSIsCiAgIlx1MzE2NyIsCiAgIlx1MTFDNyIsCiAgIlx1MzE2OCIsCiAgIlx1MTFDOCIsCiAgIlx1MzE2OSIsCiAgIlx1MTFDQyIsCiAgIlx1MzE2QSIsCiAgIlx1MTFDRSIsCiAgIlx1MzE2QiIsCiAgIlx1MTFEMyIsCiAgIlx1MzE2QyIsCiAgIlx1MTFENyIsCiAgIlx1MzE2RCIsCiAgIlx1MTFEOSIsCiAgIlx1MzE2RSIsCiAgIlx1MTExQyIsCiAgIlx1MzE2RiIsCiAgIlx1MTFERCIsCiAgIlx1MzE3MCIsCiAgIlx1MTFERiIsCiAgIlx1MzE3MSIsCiAgIlx1MTExRCIsCiAgIlx1MzE3MiIsCiAgIlx1MTExRSIsCiAgIlx1MzE3MyIsCiAgIlx1MTEyMCIsCiAgIlx1MzE3NCIsCiAgIlx1MTEyMiIsCiAgIlx1MzE3NSIsCiAgIlx1MTEyMyIsCiAgIlx1MzE3NiIsCiAgIlx1MTEyNyIsCiAgIlx1MzE3NyIsCiAgIlx1MTEyOSIsCiAgIlx1MzE3OCIsCiAgIlx1MTEyQiIsCiAgIlx1MzE3OSIsCiAgIlx1MTEyQyIsCiAgIlx1MzE3QSIsCiAgIlx1MTEyRCIsCiAgIlx1MzE3QiIsCiAgIlx1MTEyRSIsCiAgIlx1MzE3QyIsCiAgIlx1MTEyRiIsCiAgIlx1MzE3RCIsCiAgIlx1MTEzMiIsCiAgIlx1MzE3RSIsCiAgIlx1MTEzNiIsCiAgIlx1MzE3RiIsCiAgIlx1MTE0MCIsCiAgIlx1MzE4MCIsCiAgIlx1MTE0NyIsCiAgIlx1MzE4MSIsCiAgIlx1MTE0QyIsCiAgIlx1MzE4MiIsCiAgIlx1MTFGMSIsCiAgIlx1MzE4MyIsCiAgIlx1MTFGMiIsCiAgIlx1MzE4NCIsCiAgIlx1MTE1NyIsCiAgIlx1MzE4NSIsCiAgIlx1MTE1OCIsCiAgIlx1MzE4NiIsCiAgIlx1MTE1OSIsCiAgIlx1MzE4NyIsCiAgIlx1MTE4NCIsCiAgIlx1MzE4OCIsCiAgIlx1MTE4NSIsCiAgIlx1MzE4OSIsCiAgIlx1MTE4OCIsCiAgIlx1MzE4QSIsCiAgIlx1MTE5MSIsCiAgIlx1MzE4QiIsCiAgIlx1MTE5MiIsCiAgIlx1MzE4QyIsCiAgIlx1MTE5NCIsCiAgIlx1MzE4RCIsCiAgIlx1MTE5RSIsCiAgIlx1MzE4RSIsCiAgIlx1MTFBMSIsCiAgIlx1MzIwMCIsCiAgIlx1MDAyOFx1MTEwMFx1MDAyOSIsCiAgIlx1MzIwMSIsCiAgIlx1MDAyOFx1MTEwMlx1MDAyOSIsCiAgIlx1MzIwMiIsCiAgIlx1MDAyOFx1MTEwM1x1MDAyOSIsCiAgIlx1MzIwMyIsCiAgIlx1MDAyOFx1MTEwNVx1MDAyOSIsCiAgIlx1MzIwNCIsCiAgIlx1MDAyOFx1MTEwNlx1MDAyOSIsCiAgIlx1MzIwNSIsCiAgIlx1MDAyOFx1MTEwN1x1MDAyOSIsCiAgIlx1MzIwNiIsCiAgIlx1MDAyOFx1MTEwOVx1MDAyOSIsCiAgIlx1MzIwNyIsCiAgIlx1MDAyOFx1MTEwQlx1MDAyOSIsCiAgIlx1MzIwOCIsCiAgIlx1MDAyOFx1MTEwQ1x1MDAyOSIsCiAgIlx1MzIwOSIsCiAgIlx1MDAyOFx1MTEwRVx1MDAyOSIsCiAgIlx1MzIwQSIsCiAgIlx1MDAyOFx1MTEwRlx1MDAyOSIsCiAgIlx1MzIwQiIsCiAgIlx1MDAyOFx1MTExMFx1MDAyOSIsCiAgIlx1MzIwQyIsCiAgIlx1MDAyOFx1MTExMVx1MDAyOSIsCiAgIlx1MzIwRCIsCiAgIlx1MDAyOFx1MTExMlx1MDAyOSIsCiAgIlx1MzIwRSIsCiAgIlx1MDAyOFx1MTEwMFx1MTE2MVx1MDAyOSIsCiAgIlx1MzIwRiIsCiAgIlx1MDAyOFx1MTEwMlx1MTE2MVx1MDAyOSIsCiAgIlx1MzIxMCIsCiAgIlx1MDAyOFx1MTEwM1x1MTE2MVx1MDAyOSIsCiAgIlx1MzIxMSIsCiAgIlx1MDAyOFx1MTEwNVx1MTE2MVx1MDAyOSIsCiAgIlx1MzIxMiIsCiAgIlx1MDAyOFx1MTEwNlx1MTE2MVx1MDAyOSIsCiAgIlx1MzIxMyIsCiAgIlx1MDAyOFx1MTEwN1x1MTE2MVx1MDAyOSIsCiAgIlx1MzIxNCIsCiAgIlx1MDAyOFx1MTEwOVx1MTE2MVx1MDAyOSIsCiAgIlx1MzIxNSIsCiAgIlx1MDAyOFx1MTEwQlx1MTE2MVx1MDAyOSIsCiAgIlx1MzIxNiIsCiAgIlx1MDAyOFx1MTEwQ1x1MTE2MVx1MDAyOSIsCiAgIlx1MzIxNyIsCiAgIlx1MDAyOFx1MTEwRVx1MTE2MVx1MDAyOSIsCiAgIlx1MzIxOCIsCiAgIlx1MDAyOFx1MTEwRlx1MTE2MVx1MDAyOSIsCiAgIlx1MzIxOSIsCiAgIlx1MDAyOFx1MTExMFx1MTE2MVx1MDAyOSIsCiAgIlx1MzIxQSIsCiAgIlx1MDAyOFx1MTExMVx1MTE2MVx1MDAyOSIsCiAgIlx1MzIxQiIsCiAgIlx1MDAyOFx1MTExMlx1MTE2MVx1MDAyOSIsCiAgIlx1MzIxQyIsCiAgIlx1MDAyOFx1MTEwQ1x1MTE2RVx1MDAyOSIsCiAgIlx1MzIxRCIsCiAgIlx1MDAyOFx1MTEwQlx1MTE2OVx1MTEwQ1x1MTE2NVx1MTFBQlx1MDAyOSIsCiAgIlx1MzIxRSIsCiAgIlx1MDAyOFx1MTEwQlx1MTE2OVx1MTExMlx1MTE2RVx1MDAyOSIsCiAgIlx1MzIyMCIsCiAgIlx1MDAyOFx1NEUwMFx1MDAyOSIsCiAgIlx1MzIyMSIsCiAgIlx1MDAyOFx1NEU4Q1x1MDAyOSIsCiAgIlx1MzIyMiIsCiAgIlx1MDAyOFx1NEUwOVx1MDAyOSIsCiAgIlx1MzIyMyIsCiAgIlx1MDAyOFx1NTZEQlx1MDAyOSIsCiAgIlx1MzIyNCIsCiAgIlx1MDAyOFx1NEU5NFx1MDAyOSIsCiAgIlx1MzIyNSIsCiAgIlx1MDAyOFx1NTE2RFx1MDAyOSIsCiAgIlx1MzIyNiIsCiAgIlx1MDAyOFx1NEUwM1x1MDAyOSIsCiAgIlx1MzIyNyIsCiAgIlx1MDAyOFx1NTE2Qlx1MDAyOSIsCiAgIlx1MzIyOCIsCiAgIlx1MDAyOFx1NEU1RFx1MDAyOSIsCiAgIlx1MzIyOSIsCiAgIlx1MDAyOFx1NTM0MVx1MDAyOSIsCiAgIlx1MzIyQSIsCiAgIlx1MDAyOFx1NjcwOFx1MDAyOSIsCiAgIlx1MzIyQiIsCiAgIlx1MDAyOFx1NzA2Qlx1MDAyOSIsCiAgIlx1MzIyQyIsCiAgIlx1MDAyOFx1NkMzNFx1MDAyOSIsCiAgIlx1MzIyRCIsCiAgIlx1MDAyOFx1NjcyOFx1MDAyOSIsCiAgIlx1MzIyRSIsCiAgIlx1MDAyOFx1OTFEMVx1MDAyOSIsCiAgIlx1MzIyRiIsCiAgIlx1MDAyOFx1NTcxRlx1MDAyOSIsCiAgIlx1MzIzMCIsCiAgIlx1MDAyOFx1NjVFNVx1MDAyOSIsCiAgIlx1MzIzMSIsCiAgIlx1MDAyOFx1NjgyQVx1MDAyOSIsCiAgIlx1MzIzMiIsCiAgIlx1MDAyOFx1NjcwOVx1MDAyOSIsCiAgIlx1MzIzMyIsCiAgIlx1MDAyOFx1NzkzRVx1MDAyOSIsCiAgIlx1MzIzNCIsCiAgIlx1MDAyOFx1NTQwRFx1MDAyOSIsCiAgIlx1MzIzNSIsCiAgIlx1MDAyOFx1NzI3OVx1MDAyOSIsCiAgIlx1MzIzNiIsCiAgIlx1MDAyOFx1OENBMVx1MDAyOSIsCiAgIlx1MzIzNyIsCiAgIlx1MDAyOFx1Nzk1RFx1MDAyOSIsCiAgIlx1MzIzOCIsCiAgIlx1MDAyOFx1NTJCNFx1MDAyOSIsCiAgIlx1MzIzOSIsCiAgIlx1MDAyOFx1NEVFM1x1MDAyOSIsCiAgIlx1MzIzQSIsCiAgIlx1MDAyOFx1NTQ3Q1x1MDAyOSIsCiAgIlx1MzIzQiIsCiAgIlx1MDAyOFx1NUI2Nlx1MDAyOSIsCiAgIlx1MzIzQyIsCiAgIlx1MDAyOFx1NzZFM1x1MDAyOSIsCiAgIlx1MzIzRCIsCiAgIlx1MDAyOFx1NEYwMVx1MDAyOSIsCiAgIlx1MzIzRSIsCiAgIlx1MDAyOFx1OENDN1x1MDAyOSIsCiAgIlx1MzIzRiIsCiAgIlx1MDAyOFx1NTM1NFx1MDAyOSIsCiAgIlx1MzI0MCIsCiAgIlx1MDAyOFx1Nzk2RFx1MDAyOSIsCiAgIlx1MzI0MSIsCiAgIlx1MDAyOFx1NEYxMVx1MDAyOSIsCiAgIlx1MzI0MiIsCiAgIlx1MDAyOFx1ODFFQVx1MDAyOSIsCiAgIlx1MzI0MyIsCiAgIlx1MDAyOFx1ODFGM1x1MDAyOSIsCiAgIlx1MzJDMCIsCiAgIlx1MDAzMVx1NjcwOCIsCiAgIlx1MzJDMSIsCiAgIlx1MDAzMlx1NjcwOCIsCiAgIlx1MzJDMiIsCiAgIlx1MDAzM1x1NjcwOCIsCiAgIlx1MzJDMyIsCiAgIlx1MDAzNFx1NjcwOCIsCiAgIlx1MzJDNCIsCiAgIlx1MDAzNVx1NjcwOCIsCiAgIlx1MzJDNSIsCiAgIlx1MDAzNlx1NjcwOCIsCiAgIlx1MzJDNiIsCiAgIlx1MDAzN1x1NjcwOCIsCiAgIlx1MzJDNyIsCiAgIlx1MDAzOFx1NjcwOCIsCiAgIlx1MzJDOCIsCiAgIlx1MDAzOVx1NjcwOCIsCiAgIlx1MzJDOSIsCiAgIlx1MDAzMVx1MDAzMFx1NjcwOCIsCiAgIlx1MzJDQSIsCiAgIlx1MDAzMVx1MDAzMVx1NjcwOCIsCiAgIlx1MzJDQiIsCiAgIlx1MDAzMVx1MDAzMlx1NjcwOCIsCiAgIlx1MzM1OCIsCiAgIlx1MDAzMFx1NzBCOSIsCiAgIlx1MzM1OSIsCiAgIlx1MDAzMVx1NzBCOSIsCiAgIlx1MzM1QSIsCiAgIlx1MDAzMlx1NzBCOSIsCiAgIlx1MzM1QiIsCiAgIlx1MDAzM1x1NzBCOSIsCiAgIlx1MzM1QyIsCiAgIlx1MDAzNFx1NzBCOSIsCiAgIlx1MzM1RCIsCiAgIlx1MDAzNVx1NzBCOSIsCiAgIlx1MzM1RSIsCiAgIlx1MDAzNlx1NzBCOSIsCiAgIlx1MzM1RiIsCiAgIlx1MDAzN1x1NzBCOSIsCiAgIlx1MzM2MCIsCiAgIlx1MDAzOFx1NzBCOSIsCiAgIlx1MzM2MSIsCiAgIlx1MDAzOVx1NzBCOSIsCiAgIlx1MzM2MiIsCiAgIlx1MDAzMVx1MDAzMFx1NzBCOSIsCiAgIlx1MzM2MyIsCiAgIlx1MDAzMVx1MDAzMVx1NzBCOSIsCiAgIlx1MzM2NCIsCiAgIlx1MDAzMVx1MDAzMlx1NzBCOSIsCiAgIlx1MzM2NSIsCiAgIlx1MDAzMVx1MDAzM1x1NzBCOSIsCiAgIlx1MzM2NiIsCiAgIlx1MDAzMVx1MDAzNFx1NzBCOSIsCiAgIlx1MzM2NyIsCiAgIlx1MDAzMVx1MDAzNVx1NzBCOSIsCiAgIlx1MzM2OCIsCiAgIlx1MDAzMVx1MDAzNlx1NzBCOSIsCiAgIlx1MzM2OSIsCiAgIlx1MDAzMVx1MDAzN1x1NzBCOSIsCiAgIlx1MzM2QSIsCiAgIlx1MDAzMVx1MDAzOFx1NzBCOSIsCiAgIlx1MzM2QiIsCiAgIlx1MDAzMVx1MDAzOVx1NzBCOSIsCiAgIlx1MzM2QyIsCiAgIlx1MDAzMlx1MDAzMFx1NzBCOSIsCiAgIlx1MzM2RCIsCiAgIlx1MDAzMlx1MDAzMVx1NzBCOSIsCiAgIlx1MzM2RSIsCiAgIlx1MDAzMlx1MDAzMlx1NzBCOSIsCiAgIlx1MzM2RiIsCiAgIlx1MDAzMlx1MDAzM1x1NzBCOSIsCiAgIlx1MzM3MCIsCiAgIlx1MDAzMlx1MDAzNFx1NzBCOSIsCiAgIlx1MzNFMCIsCiAgIlx1MDAzMVx1NjVFNSIsCiAgIlx1MzNFMSIsCiAgIlx1MDAzMlx1NjVFNSIsCiAgIlx1MzNFMiIsCiAgIlx1MDAzM1x1NjVFNSIsCiAgIlx1MzNFMyIsCiAgIlx1MDAzNFx1NjVFNSIsCiAgIlx1MzNFNCIsCiAgIlx1MDAzNVx1NjVFNSIsCiAgIlx1MzNFNSIsCiAgIlx1MDAzNlx1NjVFNSIsCiAgIlx1MzNFNiIsCiAgIlx1MDAzN1x1NjVFNSIsCiAgIlx1MzNFNyIsCiAgIlx1MDAzOFx1NjVFNSIsCiAgIlx1MzNFOCIsCiAgIlx1MDAzOVx1NjVFNSIsCiAgIlx1MzNFOSIsCiAgIlx1MDAzMVx1MDAzMFx1NjVFNSIsCiAgIlx1MzNFQSIsCiAgIlx1MDAzMVx1MDAzMVx1NjVFNSIsCiAgIlx1MzNFQiIsCiAgIlx1MDAzMVx1MDAzMlx1NjVFNSIsCiAgIlx1MzNFQyIsCiAgIlx1MDAzMVx1MDAzM1x1NjVFNSIsCiAgIlx1MzNFRCIsCiAgIlx1MDAzMVx1MDAzNFx1NjVFNSIsCiAgIlx1MzNFRSIsCiAgIlx1MDAzMVx1MDAzNVx1NjVFNSIsCiAgIlx1MzNFRiIsCiAgIlx1MDAzMVx1MDAzNlx1NjVFNSIsCiAgIlx1MzNGMCIsCiAgIlx1MDAzMVx1MDAzN1x1NjVFNSIsCiAgIlx1MzNGMSIsCiAgIlx1MDAzMVx1MDAzOFx1NjVFNSIsCiAgIlx1MzNGMiIsCiAgIlx1MDAzMVx1MDAzOVx1NjVFNSIsCiAgIlx1MzNGMyIsCiAgIlx1MDAzMlx1MDAzMFx1NjVFNSIsCiAgIlx1MzNGNCIsCiAgIlx1MDAzMlx1MDAzMVx1NjVFNSIsCiAgIlx1MzNGNSIsCiAgIlx1MDAzMlx1MDAzMlx1NjVFNSIsCiAgIlx1MzNGNiIsCiAgIlx1MDAzMlx1MDAzM1x1NjVFNSIsCiAgIlx1MzNGNyIsCiAgIlx1MDAzMlx1MDAzNFx1NjVFNSIsCiAgIlx1MzNGOCIsCiAgIlx1MDAzMlx1MDAzNVx1NjVFNSIsCiAgIlx1MzNGOSIsCiAgIlx1MDAzMlx1MDAzNlx1NjVFNSIsCiAgIlx1MzNGQSIsCiAgIlx1MDAzMlx1MDAzN1x1NjVFNSIsCiAgIlx1MzNGQiIsCiAgIlx1MDAzMlx1MDAzOFx1NjVFNSIsCiAgIlx1MzNGQyIsCiAgIlx1MDAzMlx1MDAzOVx1NjVFNSIsCiAgIlx1MzNGRCIsCiAgIlx1MDAzM1x1MDAzMFx1NjVFNSIsCiAgIlx1MzNGRSIsCiAgIlx1MDAzM1x1MDAzMVx1NjVFNSIsCiAgIlx1RkIwMCIsCiAgIlx1MDA2Nlx1MDA2NiIsCiAgIlx1RkIwMSIsCiAgIlx1MDA2Nlx1MDA2OSIsCiAgIlx1RkIwMiIsCiAgIlx1MDA2Nlx1MDA2QyIsCiAgIlx1RkIwMyIsCiAgIlx1MDA2Nlx1MDA2Nlx1MDA2OSIsCiAgIlx1RkIwNCIsCiAgIlx1MDA2Nlx1MDA2Nlx1MDA2QyIsCiAgIlx1RkIwNSIsCiAgIlx1MDE3Rlx1MDA3NCIsCiAgIlx1RkIwNiIsCiAgIlx1MDA3M1x1MDA3NCIsCiAgIlx1RkIxMyIsCiAgIlx1MDU3NFx1MDU3NiIsCiAgIlx1RkIxNCIsCiAgIlx1MDU3NFx1MDU2NSIsCiAgIlx1RkIxNSIsCiAgIlx1MDU3NFx1MDU2QiIsCiAgIlx1RkIxNiIsCiAgIlx1MDU3RVx1MDU3NiIsCiAgIlx1RkIxNyIsCiAgIlx1MDU3NFx1MDU2RCIsCiAgIlx1RkI0RiIsCiAgIlx1MDVEMFx1MDVEQyIsCiAgIlx1RkI1MCIsCiAgIlx1MDY3MSIsCiAgIlx1RkI1MSIsCiAgIlx1MDY3MSIsCiAgIlx1RkI1MiIsCiAgIlx1MDY3QiIsCiAgIlx1RkI1MyIsCiAgIlx1MDY3QiIsCiAgIlx1RkI1NCIsCiAgIlx1MDY3QiIsCiAgIlx1RkI1NSIsCiAgIlx1MDY3QiIsCiAgIlx1RkI1NiIsCiAgIlx1MDY3RSIsCiAgIlx1RkI1NyIsCiAgIlx1MDY3RSIsCiAgIlx1RkI1OCIsCiAgIlx1MDY3RSIsCiAgIlx1RkI1OSIsCiAgIlx1MDY3RSIsCiAgIlx1RkI1QSIsCiAgIlx1MDY4MCIsCiAgIlx1RkI1QiIsCiAgIlx1MDY4MCIsCiAgIlx1RkI1QyIsCiAgIlx1MDY4MCIsCiAgIlx1RkI1RCIsCiAgIlx1MDY4MCIsCiAgIlx1RkI1RSIsCiAgIlx1MDY3QSIsCiAgIlx1RkI1RiIsCiAgIlx1MDY3QSIsCiAgIlx1RkI2MCIsCiAgIlx1MDY3QSIsCiAgIlx1RkI2MSIsCiAgIlx1MDY3QSIsCiAgIlx1RkI2MiIsCiAgIlx1MDY3RiIsCiAgIlx1RkI2MyIsCiAgIlx1MDY3RiIsCiAgIlx1RkI2NCIsCiAgIlx1MDY3RiIsCiAgIlx1RkI2NSIsCiAgIlx1MDY3RiIsCiAgIlx1RkI2NiIsCiAgIlx1MDY3OSIsCiAgIlx1RkI2NyIsCiAgIlx1MDY3OSIsCiAgIlx1RkI2OCIsCiAgIlx1MDY3OSIsCiAgIlx1RkI2OSIsCiAgIlx1MDY3OSIsCiAgIlx1RkI2QSIsCiAgIlx1MDZBNCIsCiAgIlx1RkI2QiIsCiAgIlx1MDZBNCIsCiAgIlx1RkI2QyIsCiAgIlx1MDZBNCIsCiAgIlx1RkI2RCIsCiAgIlx1MDZBNCIsCiAgIlx1RkI2RSIsCiAgIlx1MDZBNiIsCiAgIlx1RkI2RiIsCiAgIlx1MDZBNiIsCiAgIlx1RkI3MCIsCiAgIlx1MDZBNiIsCiAgIlx1RkI3MSIsCiAgIlx1MDZBNiIsCiAgIlx1RkI3MiIsCiAgIlx1MDY4NCIsCiAgIlx1RkI3MyIsCiAgIlx1MDY4NCIsCiAgIlx1RkI3NCIsCiAgIlx1MDY4NCIsCiAgIlx1RkI3NSIsCiAgIlx1MDY4NCIsCiAgIlx1RkI3NiIsCiAgIlx1MDY4MyIsCiAgIlx1RkI3NyIsCiAgIlx1MDY4MyIsCiAgIlx1RkI3OCIsCiAgIlx1MDY4MyIsCiAgIlx1RkI3OSIsCiAgIlx1MDY4MyIsCiAgIlx1RkI3QSIsCiAgIlx1MDY4NiIsCiAgIlx1RkI3QiIsCiAgIlx1MDY4NiIsCiAgIlx1RkI3QyIsCiAgIlx1MDY4NiIsCiAgIlx1RkI3RCIsCiAgIlx1MDY4NiIsCiAgIlx1RkI3RSIsCiAgIlx1MDY4NyIsCiAgIlx1RkI3RiIsCiAgIlx1MDY4NyIsCiAgIlx1RkI4MCIsCiAgIlx1MDY4NyIsCiAgIlx1RkI4MSIsCiAgIlx1MDY4NyIsCiAgIlx1RkI4MiIsCiAgIlx1MDY4RCIsCiAgIlx1RkI4MyIsCiAgIlx1MDY4RCIsCiAgIlx1RkI4NCIsCiAgIlx1MDY4QyIsCiAgIlx1RkI4NSIsCiAgIlx1MDY4QyIsCiAgIlx1RkI4NiIsCiAgIlx1MDY4RSIsCiAgIlx1RkI4NyIsCiAgIlx1MDY4RSIsCiAgIlx1RkI4OCIsCiAgIlx1MDY4OCIsCiAgIlx1RkI4OSIsCiAgIlx1MDY4OCIsCiAgIlx1RkI4QSIsCiAgIlx1MDY5OCIsCiAgIlx1RkI4QiIsCiAgIlx1MDY5OCIsCiAgIlx1RkI4QyIsCiAgIlx1MDY5MSIsCiAgIlx1RkI4RCIsCiAgIlx1MDY5MSIsCiAgIlx1RkI4RSIsCiAgIlx1MDZBOSIsCiAgIlx1RkI4RiIsCiAgIlx1MDZBOSIsCiAgIlx1RkI5MCIsCiAgIlx1MDZBOSIsCiAgIlx1RkI5MSIsCiAgIlx1MDZBOSIsCiAgIlx1RkI5MiIsCiAgIlx1MDZBRiIsCiAgIlx1RkI5MyIsCiAgIlx1MDZBRiIsCiAgIlx1RkI5NCIsCiAgIlx1MDZBRiIsCiAgIlx1RkI5NSIsCiAgIlx1MDZBRiIsCiAgIlx1RkI5NiIsCiAgIlx1MDZCMyIsCiAgIlx1RkI5NyIsCiAgIlx1MDZCMyIsCiAgIlx1RkI5OCIsCiAgIlx1MDZCMyIsCiAgIlx1RkI5OSIsCiAgIlx1MDZCMyIsCiAgIlx1RkI5QSIsCiAgIlx1MDZCMSIsCiAgIlx1RkI5QiIsCiAgIlx1MDZCMSIsCiAgIlx1RkI5QyIsCiAgIlx1MDZCMSIsCiAgIlx1RkI5RCIsCiAgIlx1MDZCMSIsCiAgIlx1RkI5RSIsCiAgIlx1MDZCQSIsCiAgIlx1RkI5RiIsCiAgIlx1MDZCQSIsCiAgIlx1RkJBMCIsCiAgIlx1MDZCQiIsCiAgIlx1RkJBMSIsCiAgIlx1MDZCQiIsCiAgIlx1RkJBMiIsCiAgIlx1MDZCQiIsCiAgIlx1RkJBMyIsCiAgIlx1MDZCQiIsCiAgIlx1RkJBNCIsCiAgIlx1MDZDMCIsCiAgIlx1RkJBNSIsCiAgIlx1MDZDMCIsCiAgIlx1RkJBNiIsCiAgIlx1MDZDMSIsCiAgIlx1RkJBNyIsCiAgIlx1MDZDMSIsCiAgIlx1RkJBOCIsCiAgIlx1MDZDMSIsCiAgIlx1RkJBOSIsCiAgIlx1MDZDMSIsCiAgIlx1RkJBQSIsCiAgIlx1MDZCRSIsCiAgIlx1RkJBQiIsCiAgIlx1MDZCRSIsCiAgIlx1RkJBQyIsCiAgIlx1MDZCRSIsCiAgIlx1RkJBRCIsCiAgIlx1MDZCRSIsCiAgIlx1RkJBRSIsCiAgIlx1MDZEMiIsCiAgIlx1RkJBRiIsCiAgIlx1MDZEMiIsCiAgIlx1RkJCMCIsCiAgIlx1MDZEMyIsCiAgIlx1RkJCMSIsCiAgIlx1MDZEMyIsCiAgIlx1RkJEMyIsCiAgIlx1MDZBRCIsCiAgIlx1RkJENCIsCiAgIlx1MDZBRCIsCiAgIlx1RkJENSIsCiAgIlx1MDZBRCIsCiAgIlx1RkJENiIsCiAgIlx1MDZBRCIsCiAgIlx1RkJENyIsCiAgIlx1MDZDNyIsCiAgIlx1RkJEOCIsCiAgIlx1MDZDNyIsCiAgIlx1RkJEOSIsCiAgIlx1MDZDNiIsCiAgIlx1RkJEQSIsCiAgIlx1MDZDNiIsCiAgIlx1RkJEQiIsCiAgIlx1MDZDOCIsCiAgIlx1RkJEQyIsCiAgIlx1MDZDOCIsCiAgIlx1RkJERCIsCiAgIlx1MDY3NyIsCiAgIlx1RkJERSIsCiAgIlx1MDZDQiIsCiAgIlx1RkJERiIsCiAgIlx1MDZDQiIsCiAgIlx1RkJFMCIsCiAgIlx1MDZDNSIsCiAgIlx1RkJFMSIsCiAgIlx1MDZDNSIsCiAgIlx1RkJFMiIsCiAgIlx1MDZDOSIsCiAgIlx1RkJFMyIsCiAgIlx1MDZDOSIsCiAgIlx1RkJFNCIsCiAgIlx1MDZEMCIsCiAgIlx1RkJFNSIsCiAgIlx1MDZEMCIsCiAgIlx1RkJFNiIsCiAgIlx1MDZEMCIsCiAgIlx1RkJFNyIsCiAgIlx1MDZEMCIsCiAgIlx1RkJFOCIsCiAgIlx1MDY0OSIsCiAgIlx1RkJFOSIsCiAgIlx1MDY0OSIsCiAgIlx1RkJFQSIsCiAgIlx1MDYyNlx1MDYyNyIsCiAgIlx1RkJFQiIsCiAgIlx1MDYyNlx1MDYyNyIsCiAgIlx1RkJFQyIsCiAgIlx1MDYyNlx1MDZENSIsCiAgIlx1RkJFRCIsCiAgIlx1MDYyNlx1MDZENSIsCiAgIlx1RkJFRSIsCiAgIlx1MDYyNlx1MDY0OCIsCiAgIlx1RkJFRiIsCiAgIlx1MDYyNlx1MDY0OCIsCiAgIlx1RkJGMCIsCiAgIlx1MDYyNlx1MDZDNyIsCiAgIlx1RkJGMSIsCiAgIlx1MDYyNlx1MDZDNyIsCiAgIlx1RkJGMiIsCiAgIlx1MDYyNlx1MDZDNiIsCiAgIlx1RkJGMyIsCiAgIlx1MDYyNlx1MDZDNiIsCiAgIlx1RkJGNCIsCiAgIlx1MDYyNlx1MDZDOCIsCiAgIlx1RkJGNSIsCiAgIlx1MDYyNlx1MDZDOCIsCiAgIlx1RkJGNiIsCiAgIlx1MDYyNlx1MDZEMCIsCiAgIlx1RkJGNyIsCiAgIlx1MDYyNlx1MDZEMCIsCiAgIlx1RkJGOCIsCiAgIlx1MDYyNlx1MDZEMCIsCiAgIlx1RkJGOSIsCiAgIlx1MDYyNlx1MDY0OSIsCiAgIlx1RkJGQSIsCiAgIlx1MDYyNlx1MDY0OSIsCiAgIlx1RkJGQiIsCiAgIlx1MDYyNlx1MDY0OSIsCiAgIlx1RkJGQyIsCiAgIlx1MDZDQyIsCiAgIlx1RkJGRCIsCiAgIlx1MDZDQyIsCiAgIlx1RkJGRSIsCiAgIlx1MDZDQyIsCiAgIlx1RkJGRiIsCiAgIlx1MDZDQyIsCiAgIlx1RkMwMCIsCiAgIlx1MDYyNlx1MDYyQyIsCiAgIlx1RkMwMSIsCiAgIlx1MDYyNlx1MDYyRCIsCiAgIlx1RkMwMiIsCiAgIlx1MDYyNlx1MDY0NSIsCiAgIlx1RkMwMyIsCiAgIlx1MDYyNlx1MDY0OSIsCiAgIlx1RkMwNCIsCiAgIlx1MDYyNlx1MDY0QSIsCiAgIlx1RkMwNSIsCiAgIlx1MDYyOFx1MDYyQyIsCiAgIlx1RkMwNiIsCiAgIlx1MDYyOFx1MDYyRCIsCiAgIlx1RkMwNyIsCiAgIlx1MDYyOFx1MDYyRSIsCiAgIlx1RkMwOCIsCiAgIlx1MDYyOFx1MDY0NSIsCiAgIlx1RkMwOSIsCiAgIlx1MDYyOFx1MDY0OSIsCiAgIlx1RkMwQSIsCiAgIlx1MDYyOFx1MDY0QSIsCiAgIlx1RkMwQiIsCiAgIlx1MDYyQVx1MDYyQyIsCiAgIlx1RkMwQyIsCiAgIlx1MDYyQVx1MDYyRCIsCiAgIlx1RkMwRCIsCiAgIlx1MDYyQVx1MDYyRSIsCiAgIlx1RkMwRSIsCiAgIlx1MDYyQVx1MDY0NSIsCiAgIlx1RkMwRiIsCiAgIlx1MDYyQVx1MDY0OSIsCiAgIlx1RkMxMCIsCiAgIlx1MDYyQVx1MDY0QSIsCiAgIlx1RkMxMSIsCiAgIlx1MDYyQlx1MDYyQyIsCiAgIlx1RkMxMiIsCiAgIlx1MDYyQlx1MDY0NSIsCiAgIlx1RkMxMyIsCiAgIlx1MDYyQlx1MDY0OSIsCiAgIlx1RkMxNCIsCiAgIlx1MDYyQlx1MDY0QSIsCiAgIlx1RkMxNSIsCiAgIlx1MDYyQ1x1MDYyRCIsCiAgIlx1RkMxNiIsCiAgIlx1MDYyQ1x1MDY0NSIsCiAgIlx1RkMxNyIsCiAgIlx1MDYyRFx1MDYyQyIsCiAgIlx1RkMxOCIsCiAgIlx1MDYyRFx1MDY0NSIsCiAgIlx1RkMxOSIsCiAgIlx1MDYyRVx1MDYyQyIsCiAgIlx1RkMxQSIsCiAgIlx1MDYyRVx1MDYyRCIsCiAgIlx1RkMxQiIsCiAgIlx1MDYyRVx1MDY0NSIsCiAgIlx1RkMxQyIsCiAgIlx1MDYzM1x1MDYyQyIsCiAgIlx1RkMxRCIsCiAgIlx1MDYzM1x1MDYyRCIsCiAgIlx1RkMxRSIsCiAgIlx1MDYzM1x1MDYyRSIsCiAgIlx1RkMxRiIsCiAgIlx1MDYzM1x1MDY0NSIsCiAgIlx1RkMyMCIsCiAgIlx1MDYzNVx1MDYyRCIsCiAgIlx1RkMyMSIsCiAgIlx1MDYzNVx1MDY0NSIsCiAgIlx1RkMyMiIsCiAgIlx1MDYzNlx1MDYyQyIsCiAgIlx1RkMyMyIsCiAgIlx1MDYzNlx1MDYyRCIsCiAgIlx1RkMyNCIsCiAgIlx1MDYzNlx1MDYyRSIsCiAgIlx1RkMyNSIsCiAgIlx1MDYzNlx1MDY0NSIsCiAgIlx1RkMyNiIsCiAgIlx1MDYzN1x1MDYyRCIsCiAgIlx1RkMyNyIsCiAgIlx1MDYzN1x1MDY0NSIsCiAgIlx1RkMyOCIsCiAgIlx1MDYzOFx1MDY0NSIsCiAgIlx1RkMyOSIsCiAgIlx1MDYzOVx1MDYyQyIsCiAgIlx1RkMyQSIsCiAgIlx1MDYzOVx1MDY0NSIsCiAgIlx1RkMyQiIsCiAgIlx1MDYzQVx1MDYyQyIsCiAgIlx1RkMyQyIsCiAgIlx1MDYzQVx1MDY0NSIsCiAgIlx1RkMyRCIsCiAgIlx1MDY0MVx1MDYyQyIsCiAgIlx1RkMyRSIsCiAgIlx1MDY0MVx1MDYyRCIsCiAgIlx1RkMyRiIsCiAgIlx1MDY0MVx1MDYyRSIsCiAgIlx1RkMzMCIsCiAgIlx1MDY0MVx1MDY0NSIsCiAgIlx1RkMzMSIsCiAgIlx1MDY0MVx1MDY0OSIsCiAgIlx1RkMzMiIsCiAgIlx1MDY0MVx1MDY0QSIsCiAgIlx1RkMzMyIsCiAgIlx1MDY0Mlx1MDYyRCIsCiAgIlx1RkMzNCIsCiAgIlx1MDY0Mlx1MDY0NSIsCiAgIlx1RkMzNSIsCiAgIlx1MDY0Mlx1MDY0OSIsCiAgIlx1RkMzNiIsCiAgIlx1MDY0Mlx1MDY0QSIsCiAgIlx1RkMzNyIsCiAgIlx1MDY0M1x1MDYyNyIsCiAgIlx1RkMzOCIsCiAgIlx1MDY0M1x1MDYyQyIsCiAgIlx1RkMzOSIsCiAgIlx1MDY0M1x1MDYyRCIsCiAgIlx1RkMzQSIsCiAgIlx1MDY0M1x1MDYyRSIsCiAgIlx1RkMzQiIsCiAgIlx1MDY0M1x1MDY0NCIsCiAgIlx1RkMzQyIsCiAgIlx1MDY0M1x1MDY0NSIsCiAgIlx1RkMzRCIsCiAgIlx1MDY0M1x1MDY0OSIsCiAgIlx1RkMzRSIsCiAgIlx1MDY0M1x1MDY0QSIsCiAgIlx1RkMzRiIsCiAgIlx1MDY0NFx1MDYyQyIsCiAgIlx1RkM0MCIsCiAgIlx1MDY0NFx1MDYyRCIsCiAgIlx1RkM0MSIsCiAgIlx1MDY0NFx1MDYyRSIsCiAgIlx1RkM0MiIsCiAgIlx1MDY0NFx1MDY0NSIsCiAgIlx1RkM0MyIsCiAgIlx1MDY0NFx1MDY0OSIsCiAgIlx1RkM0NCIsCiAgIlx1MDY0NFx1MDY0QSIsCiAgIlx1RkM0NSIsCiAgIlx1MDY0NVx1MDYyQyIsCiAgIlx1RkM0NiIsCiAgIlx1MDY0NVx1MDYyRCIsCiAgIlx1RkM0NyIsCiAgIlx1MDY0NVx1MDYyRSIsCiAgIlx1RkM0OCIsCiAgIlx1MDY0NVx1MDY0NSIsCiAgIlx1RkM0OSIsCiAgIlx1MDY0NVx1MDY0OSIsCiAgIlx1RkM0QSIsCiAgIlx1MDY0NVx1MDY0QSIsCiAgIlx1RkM0QiIsCiAgIlx1MDY0Nlx1MDYyQyIsCiAgIlx1RkM0QyIsCiAgIlx1MDY0Nlx1MDYyRCIsCiAgIlx1RkM0RCIsCiAgIlx1MDY0Nlx1MDYyRSIsCiAgIlx1RkM0RSIsCiAgIlx1MDY0Nlx1MDY0NSIsCiAgIlx1RkM0RiIsCiAgIlx1MDY0Nlx1MDY0OSIsCiAgIlx1RkM1MCIsCiAgIlx1MDY0Nlx1MDY0QSIsCiAgIlx1RkM1MSIsCiAgIlx1MDY0N1x1MDYyQyIsCiAgIlx1RkM1MiIsCiAgIlx1MDY0N1x1MDY0NSIsCiAgIlx1RkM1MyIsCiAgIlx1MDY0N1x1MDY0OSIsCiAgIlx1RkM1NCIsCiAgIlx1MDY0N1x1MDY0QSIsCiAgIlx1RkM1NSIsCiAgIlx1MDY0QVx1MDYyQyIsCiAgIlx1RkM1NiIsCiAgIlx1MDY0QVx1MDYyRCIsCiAgIlx1RkM1NyIsCiAgIlx1MDY0QVx1MDYyRSIsCiAgIlx1RkM1OCIsCiAgIlx1MDY0QVx1MDY0NSIsCiAgIlx1RkM1OSIsCiAgIlx1MDY0QVx1MDY0OSIsCiAgIlx1RkM1QSIsCiAgIlx1MDY0QVx1MDY0QSIsCiAgIlx1RkM1QiIsCiAgIlx1MDYzMFx1MDY3MCIsCiAgIlx1RkM1QyIsCiAgIlx1MDYzMVx1MDY3MCIsCiAgIlx1RkM1RCIsCiAgIlx1MDY0OVx1MDY3MCIsCiAgIlx1RkM1RSIsCiAgIlx1MDAyMFx1MDY0Q1x1MDY1MSIsCiAgIlx1RkM1RiIsCiAgIlx1MDAyMFx1MDY0RFx1MDY1MSIsCiAgIlx1RkM2MCIsCiAgIlx1MDAyMFx1MDY0RVx1MDY1MSIsCiAgIlx1RkM2MSIsCiAgIlx1MDAyMFx1MDY0Rlx1MDY1MSIsCiAgIlx1RkM2MiIsCiAgIlx1MDAyMFx1MDY1MFx1MDY1MSIsCiAgIlx1RkM2MyIsCiAgIlx1MDAyMFx1MDY1MVx1MDY3MCIsCiAgIlx1RkM2NCIsCiAgIlx1MDYyNlx1MDYzMSIsCiAgIlx1RkM2NSIsCiAgIlx1MDYyNlx1MDYzMiIsCiAgIlx1RkM2NiIsCiAgIlx1MDYyNlx1MDY0NSIsCiAgIlx1RkM2NyIsCiAgIlx1MDYyNlx1MDY0NiIsCiAgIlx1RkM2OCIsCiAgIlx1MDYyNlx1MDY0OSIsCiAgIlx1RkM2OSIsCiAgIlx1MDYyNlx1MDY0QSIsCiAgIlx1RkM2QSIsCiAgIlx1MDYyOFx1MDYzMSIsCiAgIlx1RkM2QiIsCiAgIlx1MDYyOFx1MDYzMiIsCiAgIlx1RkM2QyIsCiAgIlx1MDYyOFx1MDY0NSIsCiAgIlx1RkM2RCIsCiAgIlx1MDYyOFx1MDY0NiIsCiAgIlx1RkM2RSIsCiAgIlx1MDYyOFx1MDY0OSIsCiAgIlx1RkM2RiIsCiAgIlx1MDYyOFx1MDY0QSIsCiAgIlx1RkM3MCIsCiAgIlx1MDYyQVx1MDYzMSIsCiAgIlx1RkM3MSIsCiAgIlx1MDYyQVx1MDYzMiIsCiAgIlx1RkM3MiIsCiAgIlx1MDYyQVx1MDY0NSIsCiAgIlx1RkM3MyIsCiAgIlx1MDYyQVx1MDY0NiIsCiAgIlx1RkM3NCIsCiAgIlx1MDYyQVx1MDY0OSIsCiAgIlx1RkM3NSIsCiAgIlx1MDYyQVx1MDY0QSIsCiAgIlx1RkM3NiIsCiAgIlx1MDYyQlx1MDYzMSIsCiAgIlx1RkM3NyIsCiAgIlx1MDYyQlx1MDYzMiIsCiAgIlx1RkM3OCIsCiAgIlx1MDYyQlx1MDY0NSIsCiAgIlx1RkM3OSIsCiAgIlx1MDYyQlx1MDY0NiIsCiAgIlx1RkM3QSIsCiAgIlx1MDYyQlx1MDY0OSIsCiAgIlx1RkM3QiIsCiAgIlx1MDYyQlx1MDY0QSIsCiAgIlx1RkM3QyIsCiAgIlx1MDY0MVx1MDY0OSIsCiAgIlx1RkM3RCIsCiAgIlx1MDY0MVx1MDY0QSIsCiAgIlx1RkM3RSIsCiAgIlx1MDY0Mlx1MDY0OSIsCiAgIlx1RkM3RiIsCiAgIlx1MDY0Mlx1MDY0QSIsCiAgIlx1RkM4MCIsCiAgIlx1MDY0M1x1MDYyNyIsCiAgIlx1RkM4MSIsCiAgIlx1MDY0M1x1MDY0NCIsCiAgIlx1RkM4MiIsCiAgIlx1MDY0M1x1MDY0NSIsCiAgIlx1RkM4MyIsCiAgIlx1MDY0M1x1MDY0OSIsCiAgIlx1RkM4NCIsCiAgIlx1MDY0M1x1MDY0QSIsCiAgIlx1RkM4NSIsCiAgIlx1MDY0NFx1MDY0NSIsCiAgIlx1RkM4NiIsCiAgIlx1MDY0NFx1MDY0OSIsCiAgIlx1RkM4NyIsCiAgIlx1MDY0NFx1MDY0QSIsCiAgIlx1RkM4OCIsCiAgIlx1MDY0NVx1MDYyNyIsCiAgIlx1RkM4OSIsCiAgIlx1MDY0NVx1MDY0NSIsCiAgIlx1RkM4QSIsCiAgIlx1MDY0Nlx1MDYzMSIsCiAgIlx1RkM4QiIsCiAgIlx1MDY0Nlx1MDYzMiIsCiAgIlx1RkM4QyIsCiAgIlx1MDY0Nlx1MDY0NSIsCiAgIlx1RkM4RCIsCiAgIlx1MDY0Nlx1MDY0NiIsCiAgIlx1RkM4RSIsCiAgIlx1MDY0Nlx1MDY0OSIsCiAgIlx1RkM4RiIsCiAgIlx1MDY0Nlx1MDY0QSIsCiAgIlx1RkM5MCIsCiAgIlx1MDY0OVx1MDY3MCIsCiAgIlx1RkM5MSIsCiAgIlx1MDY0QVx1MDYzMSIsCiAgIlx1RkM5MiIsCiAgIlx1MDY0QVx1MDYzMiIsCiAgIlx1RkM5MyIsCiAgIlx1MDY0QVx1MDY0NSIsCiAgIlx1RkM5NCIsCiAgIlx1MDY0QVx1MDY0NiIsCiAgIlx1RkM5NSIsCiAgIlx1MDY0QVx1MDY0OSIsCiAgIlx1RkM5NiIsCiAgIlx1MDY0QVx1MDY0QSIsCiAgIlx1RkM5NyIsCiAgIlx1MDYyNlx1MDYyQyIsCiAgIlx1RkM5OCIsCiAgIlx1MDYyNlx1MDYyRCIsCiAgIlx1RkM5OSIsCiAgIlx1MDYyNlx1MDYyRSIsCiAgIlx1RkM5QSIsCiAgIlx1MDYyNlx1MDY0NSIsCiAgIlx1RkM5QiIsCiAgIlx1MDYyNlx1MDY0NyIsCiAgIlx1RkM5QyIsCiAgIlx1MDYyOFx1MDYyQyIsCiAgIlx1RkM5RCIsCiAgIlx1MDYyOFx1MDYyRCIsCiAgIlx1RkM5RSIsCiAgIlx1MDYyOFx1MDYyRSIsCiAgIlx1RkM5RiIsCiAgIlx1MDYyOFx1MDY0NSIsCiAgIlx1RkNBMCIsCiAgIlx1MDYyOFx1MDY0NyIsCiAgIlx1RkNBMSIsCiAgIlx1MDYyQVx1MDYyQyIsCiAgIlx1RkNBMiIsCiAgIlx1MDYyQVx1MDYyRCIsCiAgIlx1RkNBMyIsCiAgIlx1MDYyQVx1MDYyRSIsCiAgIlx1RkNBNCIsCiAgIlx1MDYyQVx1MDY0NSIsCiAgIlx1RkNBNSIsCiAgIlx1MDYyQVx1MDY0NyIsCiAgIlx1RkNBNiIsCiAgIlx1MDYyQlx1MDY0NSIsCiAgIlx1RkNBNyIsCiAgIlx1MDYyQ1x1MDYyRCIsCiAgIlx1RkNBOCIsCiAgIlx1MDYyQ1x1MDY0NSIsCiAgIlx1RkNBOSIsCiAgIlx1MDYyRFx1MDYyQyIsCiAgIlx1RkNBQSIsCiAgIlx1MDYyRFx1MDY0NSIsCiAgIlx1RkNBQiIsCiAgIlx1MDYyRVx1MDYyQyIsCiAgIlx1RkNBQyIsCiAgIlx1MDYyRVx1MDY0NSIsCiAgIlx1RkNBRCIsCiAgIlx1MDYzM1x1MDYyQyIsCiAgIlx1RkNBRSIsCiAgIlx1MDYzM1x1MDYyRCIsCiAgIlx1RkNBRiIsCiAgIlx1MDYzM1x1MDYyRSIsCiAgIlx1RkNCMCIsCiAgIlx1MDYzM1x1MDY0NSIsCiAgIlx1RkNCMSIsCiAgIlx1MDYzNVx1MDYyRCIsCiAgIlx1RkNCMiIsCiAgIlx1MDYzNVx1MDYyRSIsCiAgIlx1RkNCMyIsCiAgIlx1MDYzNVx1MDY0NSIsCiAgIlx1RkNCNCIsCiAgIlx1MDYzNlx1MDYyQyIsCiAgIlx1RkNCNSIsCiAgIlx1MDYzNlx1MDYyRCIsCiAgIlx1RkNCNiIsCiAgIlx1MDYzNlx1MDYyRSIsCiAgIlx1RkNCNyIsCiAgIlx1MDYzNlx1MDY0NSIsCiAgIlx1RkNCOCIsCiAgIlx1MDYzN1x1MDYyRCIsCiAgIlx1RkNCOSIsCiAgIlx1MDYzOFx1MDY0NSIsCiAgIlx1RkNCQSIsCiAgIlx1MDYzOVx1MDYyQyIsCiAgIlx1RkNCQiIsCiAgIlx1MDYzOVx1MDY0NSIsCiAgIlx1RkNCQyIsCiAgIlx1MDYzQVx1MDYyQyIsCiAgIlx1RkNCRCIsCiAgIlx1MDYzQVx1MDY0NSIsCiAgIlx1RkNCRSIsCiAgIlx1MDY0MVx1MDYyQyIsCiAgIlx1RkNCRiIsCiAgIlx1MDY0MVx1MDYyRCIsCiAgIlx1RkNDMCIsCiAgIlx1MDY0MVx1MDYyRSIsCiAgIlx1RkNDMSIsCiAgIlx1MDY0MVx1MDY0NSIsCiAgIlx1RkNDMiIsCiAgIlx1MDY0Mlx1MDYyRCIsCiAgIlx1RkNDMyIsCiAgIlx1MDY0Mlx1MDY0NSIsCiAgIlx1RkNDNCIsCiAgIlx1MDY0M1x1MDYyQyIsCiAgIlx1RkNDNSIsCiAgIlx1MDY0M1x1MDYyRCIsCiAgIlx1RkNDNiIsCiAgIlx1MDY0M1x1MDYyRSIsCiAgIlx1RkNDNyIsCiAgIlx1MDY0M1x1MDY0NCIsCiAgIlx1RkNDOCIsCiAgIlx1MDY0M1x1MDY0NSIsCiAgIlx1RkNDOSIsCiAgIlx1MDY0NFx1MDYyQyIsCiAgIlx1RkNDQSIsCiAgIlx1MDY0NFx1MDYyRCIsCiAgIlx1RkNDQiIsCiAgIlx1MDY0NFx1MDYyRSIsCiAgIlx1RkNDQyIsCiAgIlx1MDY0NFx1MDY0NSIsCiAgIlx1RkNDRCIsCiAgIlx1MDY0NFx1MDY0NyIsCiAgIlx1RkNDRSIsCiAgIlx1MDY0NVx1MDYyQyIsCiAgIlx1RkNDRiIsCiAgIlx1MDY0NVx1MDYyRCIsCiAgIlx1RkNEMCIsCiAgIlx1MDY0NVx1MDYyRSIsCiAgIlx1RkNEMSIsCiAgIlx1MDY0NVx1MDY0NSIsCiAgIlx1RkNEMiIsCiAgIlx1MDY0Nlx1MDYyQyIsCiAgIlx1RkNEMyIsCiAgIlx1MDY0Nlx1MDYyRCIsCiAgIlx1RkNENCIsCiAgIlx1MDY0Nlx1MDYyRSIsCiAgIlx1RkNENSIsCiAgIlx1MDY0Nlx1MDY0NSIsCiAgIlx1RkNENiIsCiAgIlx1MDY0Nlx1MDY0NyIsCiAgIlx1RkNENyIsCiAgIlx1MDY0N1x1MDYyQyIsCiAgIlx1RkNEOCIsCiAgIlx1MDY0N1x1MDY0NSIsCiAgIlx1RkNEOSIsCiAgIlx1MDY0N1x1MDY3MCIsCiAgIlx1RkNEQSIsCiAgIlx1MDY0QVx1MDYyQyIsCiAgIlx1RkNEQiIsCiAgIlx1MDY0QVx1MDYyRCIsCiAgIlx1RkNEQyIsCiAgIlx1MDY0QVx1MDYyRSIsCiAgIlx1RkNERCIsCiAgIlx1MDY0QVx1MDY0NSIsCiAgIlx1RkNERSIsCiAgIlx1MDY0QVx1MDY0NyIsCiAgIlx1RkNERiIsCiAgIlx1MDYyNlx1MDY0NSIsCiAgIlx1RkNFMCIsCiAgIlx1MDYyNlx1MDY0NyIsCiAgIlx1RkNFMSIsCiAgIlx1MDYyOFx1MDY0NSIsCiAgIlx1RkNFMiIsCiAgIlx1MDYyOFx1MDY0NyIsCiAgIlx1RkNFMyIsCiAgIlx1MDYyQVx1MDY0NSIsCiAgIlx1RkNFNCIsCiAgIlx1MDYyQVx1MDY0NyIsCiAgIlx1RkNFNSIsCiAgIlx1MDYyQlx1MDY0NSIsCiAgIlx1RkNFNiIsCiAgIlx1MDYyQlx1MDY0NyIsCiAgIlx1RkNFNyIsCiAgIlx1MDYzM1x1MDY0NSIsCiAgIlx1RkNFOCIsCiAgIlx1MDYzM1x1MDY0NyIsCiAgIlx1RkNFOSIsCiAgIlx1MDYzNFx1MDY0NSIsCiAgIlx1RkNFQSIsCiAgIlx1MDYzNFx1MDY0NyIsCiAgIlx1RkNFQiIsCiAgIlx1MDY0M1x1MDY0NCIsCiAgIlx1RkNFQyIsCiAgIlx1MDY0M1x1MDY0NSIsCiAgIlx1RkNFRCIsCiAgIlx1MDY0NFx1MDY0NSIsCiAgIlx1RkNFRSIsCiAgIlx1MDY0Nlx1MDY0NSIsCiAgIlx1RkNFRiIsCiAgIlx1MDY0Nlx1MDY0NyIsCiAgIlx1RkNGMCIsCiAgIlx1MDY0QVx1MDY0NSIsCiAgIlx1RkNGMSIsCiAgIlx1MDY0QVx1MDY0NyIsCiAgIlx1RkNGMiIsCiAgIlx1MDY0MFx1MDY0RVx1MDY1MSIsCiAgIlx1RkNGMyIsCiAgIlx1MDY0MFx1MDY0Rlx1MDY1MSIsCiAgIlx1RkNGNCIsCiAgIlx1MDY0MFx1MDY1MFx1MDY1MSIsCiAgIlx1RkNGNSIsCiAgIlx1MDYzN1x1MDY0OSIsCiAgIlx1RkNGNiIsCiAgIlx1MDYzN1x1MDY0QSIsCiAgIlx1RkNGNyIsCiAgIlx1MDYzOVx1MDY0OSIsCiAgIlx1RkNGOCIsCiAgIlx1MDYzOVx1MDY0QSIsCiAgIlx1RkNGOSIsCiAgIlx1MDYzQVx1MDY0OSIsCiAgIlx1RkNGQSIsCiAgIlx1MDYzQVx1MDY0QSIsCiAgIlx1RkNGQiIsCiAgIlx1MDYzM1x1MDY0OSIsCiAgIlx1RkNGQyIsCiAgIlx1MDYzM1x1MDY0QSIsCiAgIlx1RkNGRCIsCiAgIlx1MDYzNFx1MDY0OSIsCiAgIlx1RkNGRSIsCiAgIlx1MDYzNFx1MDY0QSIsCiAgIlx1RkNGRiIsCiAgIlx1MDYyRFx1MDY0OSIsCiAgIlx1RkQwMCIsCiAgIlx1MDYyRFx1MDY0QSIsCiAgIlx1RkQwMSIsCiAgIlx1MDYyQ1x1MDY0OSIsCiAgIlx1RkQwMiIsCiAgIlx1MDYyQ1x1MDY0QSIsCiAgIlx1RkQwMyIsCiAgIlx1MDYyRVx1MDY0OSIsCiAgIlx1RkQwNCIsCiAgIlx1MDYyRVx1MDY0QSIsCiAgIlx1RkQwNSIsCiAgIlx1MDYzNVx1MDY0OSIsCiAgIlx1RkQwNiIsCiAgIlx1MDYzNVx1MDY0QSIsCiAgIlx1RkQwNyIsCiAgIlx1MDYzNlx1MDY0OSIsCiAgIlx1RkQwOCIsCiAgIlx1MDYzNlx1MDY0QSIsCiAgIlx1RkQwOSIsCiAgIlx1MDYzNFx1MDYyQyIsCiAgIlx1RkQwQSIsCiAgIlx1MDYzNFx1MDYyRCIsCiAgIlx1RkQwQiIsCiAgIlx1MDYzNFx1MDYyRSIsCiAgIlx1RkQwQyIsCiAgIlx1MDYzNFx1MDY0NSIsCiAgIlx1RkQwRCIsCiAgIlx1MDYzNFx1MDYzMSIsCiAgIlx1RkQwRSIsCiAgIlx1MDYzM1x1MDYzMSIsCiAgIlx1RkQwRiIsCiAgIlx1MDYzNVx1MDYzMSIsCiAgIlx1RkQxMCIsCiAgIlx1MDYzNlx1MDYzMSIsCiAgIlx1RkQxMSIsCiAgIlx1MDYzN1x1MDY0OSIsCiAgIlx1RkQxMiIsCiAgIlx1MDYzN1x1MDY0QSIsCiAgIlx1RkQxMyIsCiAgIlx1MDYzOVx1MDY0OSIsCiAgIlx1RkQxNCIsCiAgIlx1MDYzOVx1MDY0QSIsCiAgIlx1RkQxNSIsCiAgIlx1MDYzQVx1MDY0OSIsCiAgIlx1RkQxNiIsCiAgIlx1MDYzQVx1MDY0QSIsCiAgIlx1RkQxNyIsCiAgIlx1MDYzM1x1MDY0OSIsCiAgIlx1RkQxOCIsCiAgIlx1MDYzM1x1MDY0QSIsCiAgIlx1RkQxOSIsCiAgIlx1MDYzNFx1MDY0OSIsCiAgIlx1RkQxQSIsCiAgIlx1MDYzNFx1MDY0QSIsCiAgIlx1RkQxQiIsCiAgIlx1MDYyRFx1MDY0OSIsCiAgIlx1RkQxQyIsCiAgIlx1MDYyRFx1MDY0QSIsCiAgIlx1RkQxRCIsCiAgIlx1MDYyQ1x1MDY0OSIsCiAgIlx1RkQxRSIsCiAgIlx1MDYyQ1x1MDY0QSIsCiAgIlx1RkQxRiIsCiAgIlx1MDYyRVx1MDY0OSIsCiAgIlx1RkQyMCIsCiAgIlx1MDYyRVx1MDY0QSIsCiAgIlx1RkQyMSIsCiAgIlx1MDYzNVx1MDY0OSIsCiAgIlx1RkQyMiIsCiAgIlx1MDYzNVx1MDY0QSIsCiAgIlx1RkQyMyIsCiAgIlx1MDYzNlx1MDY0OSIsCiAgIlx1RkQyNCIsCiAgIlx1MDYzNlx1MDY0QSIsCiAgIlx1RkQyNSIsCiAgIlx1MDYzNFx1MDYyQyIsCiAgIlx1RkQyNiIsCiAgIlx1MDYzNFx1MDYyRCIsCiAgIlx1RkQyNyIsCiAgIlx1MDYzNFx1MDYyRSIsCiAgIlx1RkQyOCIsCiAgIlx1MDYzNFx1MDY0NSIsCiAgIlx1RkQyOSIsCiAgIlx1MDYzNFx1MDYzMSIsCiAgIlx1RkQyQSIsCiAgIlx1MDYzM1x1MDYzMSIsCiAgIlx1RkQyQiIsCiAgIlx1MDYzNVx1MDYzMSIsCiAgIlx1RkQyQyIsCiAgIlx1MDYzNlx1MDYzMSIsCiAgIlx1RkQyRCIsCiAgIlx1MDYzNFx1MDYyQyIsCiAgIlx1RkQyRSIsCiAgIlx1MDYzNFx1MDYyRCIsCiAgIlx1RkQyRiIsCiAgIlx1MDYzNFx1MDYyRSIsCiAgIlx1RkQzMCIsCiAgIlx1MDYzNFx1MDY0NSIsCiAgIlx1RkQzMSIsCiAgIlx1MDYzM1x1MDY0NyIsCiAgIlx1RkQzMiIsCiAgIlx1MDYzNFx1MDY0NyIsCiAgIlx1RkQzMyIsCiAgIlx1MDYzN1x1MDY0NSIsCiAgIlx1RkQzNCIsCiAgIlx1MDYzM1x1MDYyQyIsCiAgIlx1RkQzNSIsCiAgIlx1MDYzM1x1MDYyRCIsCiAgIlx1RkQzNiIsCiAgIlx1MDYzM1x1MDYyRSIsCiAgIlx1RkQzNyIsCiAgIlx1MDYzNFx1MDYyQyIsCiAgIlx1RkQzOCIsCiAgIlx1MDYzNFx1MDYyRCIsCiAgIlx1RkQzOSIsCiAgIlx1MDYzNFx1MDYyRSIsCiAgIlx1RkQzQSIsCiAgIlx1MDYzN1x1MDY0NSIsCiAgIlx1RkQzQiIsCiAgIlx1MDYzOFx1MDY0NSIsCiAgIlx1RkQzQyIsCiAgIlx1MDYyN1x1MDY0QiIsCiAgIlx1RkQzRCIsCiAgIlx1MDYyN1x1MDY0QiIsCiAgIlx1RkQ1MCIsCiAgIlx1MDYyQVx1MDYyQ1x1MDY0NSIsCiAgIlx1RkQ1MSIsCiAgIlx1MDYyQVx1MDYyRFx1MDYyQyIsCiAgIlx1RkQ1MiIsCiAgIlx1MDYyQVx1MDYyRFx1MDYyQyIsCiAgIlx1RkQ1MyIsCiAgIlx1MDYyQVx1MDYyRFx1MDY0NSIsCiAgIlx1RkQ1NCIsCiAgIlx1MDYyQVx1MDYyRVx1MDY0NSIsCiAgIlx1RkQ1NSIsCiAgIlx1MDYyQVx1MDY0NVx1MDYyQyIsCiAgIlx1RkQ1NiIsCiAgIlx1MDYyQVx1MDY0NVx1MDYyRCIsCiAgIlx1RkQ1NyIsCiAgIlx1MDYyQVx1MDY0NVx1MDYyRSIsCiAgIlx1RkQ1OCIsCiAgIlx1MDYyQ1x1MDY0NVx1MDYyRCIsCiAgIlx1RkQ1OSIsCiAgIlx1MDYyQ1x1MDY0NVx1MDYyRCIsCiAgIlx1RkQ1QSIsCiAgIlx1MDYyRFx1MDY0NVx1MDY0QSIsCiAgIlx1RkQ1QiIsCiAgIlx1MDYyRFx1MDY0NVx1MDY0OSIsCiAgIlx1RkQ1QyIsCiAgIlx1MDYzM1x1MDYyRFx1MDYyQyIsCiAgIlx1RkQ1RCIsCiAgIlx1MDYzM1x1MDYyQ1x1MDYyRCIsCiAgIlx1RkQ1RSIsCiAgIlx1MDYzM1x1MDYyQ1x1MDY0OSIsCiAgIlx1RkQ1RiIsCiAgIlx1MDYzM1x1MDY0NVx1MDYyRCIsCiAgIlx1RkQ2MCIsCiAgIlx1MDYzM1x1MDY0NVx1MDYyRCIsCiAgIlx1RkQ2MSIsCiAgIlx1MDYzM1x1MDY0NVx1MDYyQyIsCiAgIlx1RkQ2MiIsCiAgIlx1MDYzM1x1MDY0NVx1MDY0NSIsCiAgIlx1RkQ2MyIsCiAgIlx1MDYzM1x1MDY0NVx1MDY0NSIsCiAgIlx1RkQ2NCIsCiAgIlx1MDYzNVx1MDYyRFx1MDYyRCIsCiAgIlx1RkQ2NSIsCiAgIlx1MDYzNVx1MDYyRFx1MDYyRCIsCiAgIlx1RkQ2NiIsCiAgIlx1MDYzNVx1MDY0NVx1MDY0NSIsCiAgIlx1RkQ2NyIsCiAgIlx1MDYzNFx1MDYyRFx1MDY0NSIsCiAgIlx1RkQ2OCIsCiAgIlx1MDYzNFx1MDYyRFx1MDY0NSIsCiAgIlx1RkQ2OSIsCiAgIlx1MDYzNFx1MDYyQ1x1MDY0QSIsCiAgIlx1RkQ2QSIsCiAgIlx1MDYzNFx1MDY0NVx1MDYyRSIsCiAgIlx1RkQ2QiIsCiAgIlx1MDYzNFx1MDY0NVx1MDYyRSIsCiAgIlx1RkQ2QyIsCiAgIlx1MDYzNFx1MDY0NVx1MDY0NSIsCiAgIlx1RkQ2RCIsCiAgIlx1MDYzNFx1MDY0NVx1MDY0NSIsCiAgIlx1RkQ2RSIsCiAgIlx1MDYzNlx1MDYyRFx1MDY0OSIsCiAgIlx1RkQ2RiIsCiAgIlx1MDYzNlx1MDYyRVx1MDY0NSIsCiAgIlx1RkQ3MCIsCiAgIlx1MDYzNlx1MDYyRVx1MDY0NSIsCiAgIlx1RkQ3MSIsCiAgIlx1MDYzN1x1MDY0NVx1MDYyRCIsCiAgIlx1RkQ3MiIsCiAgIlx1MDYzN1x1MDY0NVx1MDYyRCIsCiAgIlx1RkQ3MyIsCiAgIlx1MDYzN1x1MDY0NVx1MDY0NSIsCiAgIlx1RkQ3NCIsCiAgIlx1MDYzN1x1MDY0NVx1MDY0QSIsCiAgIlx1RkQ3NSIsCiAgIlx1MDYzOVx1MDYyQ1x1MDY0NSIsCiAgIlx1RkQ3NiIsCiAgIlx1MDYzOVx1MDY0NVx1MDY0NSIsCiAgIlx1RkQ3NyIsCiAgIlx1MDYzOVx1MDY0NVx1MDY0NSIsCiAgIlx1RkQ3OCIsCiAgIlx1MDYzOVx1MDY0NVx1MDY0OSIsCiAgIlx1RkQ3OSIsCiAgIlx1MDYzQVx1MDY0NVx1MDY0NSIsCiAgIlx1RkQ3QSIsCiAgIlx1MDYzQVx1MDY0NVx1MDY0QSIsCiAgIlx1RkQ3QiIsCiAgIlx1MDYzQVx1MDY0NVx1MDY0OSIsCiAgIlx1RkQ3QyIsCiAgIlx1MDY0MVx1MDYyRVx1MDY0NSIsCiAgIlx1RkQ3RCIsCiAgIlx1MDY0MVx1MDYyRVx1MDY0NSIsCiAgIlx1RkQ3RSIsCiAgIlx1MDY0Mlx1MDY0NVx1MDYyRCIsCiAgIlx1RkQ3RiIsCiAgIlx1MDY0Mlx1MDY0NVx1MDY0NSIsCiAgIlx1RkQ4MCIsCiAgIlx1MDY0NFx1MDYyRFx1MDY0NSIsCiAgIlx1RkQ4MSIsCiAgIlx1MDY0NFx1MDYyRFx1MDY0QSIsCiAgIlx1RkQ4MiIsCiAgIlx1MDY0NFx1MDYyRFx1MDY0OSIsCiAgIlx1RkQ4MyIsCiAgIlx1MDY0NFx1MDYyQ1x1MDYyQyIsCiAgIlx1RkQ4NCIsCiAgIlx1MDY0NFx1MDYyQ1x1MDYyQyIsCiAgIlx1RkQ4NSIsCiAgIlx1MDY0NFx1MDYyRVx1MDY0NSIsCiAgIlx1RkQ4NiIsCiAgIlx1MDY0NFx1MDYyRVx1MDY0NSIsCiAgIlx1RkQ4NyIsCiAgIlx1MDY0NFx1MDY0NVx1MDYyRCIsCiAgIlx1RkQ4OCIsCiAgIlx1MDY0NFx1MDY0NVx1MDYyRCIsCiAgIlx1RkQ4OSIsCiAgIlx1MDY0NVx1MDYyRFx1MDYyQyIsCiAgIlx1RkQ4QSIsCiAgIlx1MDY0NVx1MDYyRFx1MDY0NSIsCiAgIlx1RkQ4QiIsCiAgIlx1MDY0NVx1MDYyRFx1MDY0QSIsCiAgIlx1RkQ4QyIsCiAgIlx1MDY0NVx1MDYyQ1x1MDYyRCIsCiAgIlx1RkQ4RCIsCiAgIlx1MDY0NVx1MDYyQ1x1MDY0NSIsCiAgIlx1RkQ4RSIsCiAgIlx1MDY0NVx1MDYyRVx1MDYyQyIsCiAgIlx1RkQ4RiIsCiAgIlx1MDY0NVx1MDYyRVx1MDY0NSIsCiAgIlx1RkQ5MiIsCiAgIlx1MDY0NVx1MDYyQ1x1MDYyRSIsCiAgIlx1RkQ5MyIsCiAgIlx1MDY0N1x1MDY0NVx1MDYyQyIsCiAgIlx1RkQ5NCIsCiAgIlx1MDY0N1x1MDY0NVx1MDY0NSIsCiAgIlx1RkQ5NSIsCiAgIlx1MDY0Nlx1MDYyRFx1MDY0NSIsCiAgIlx1RkQ5NiIsCiAgIlx1MDY0Nlx1MDYyRFx1MDY0OSIsCiAgIlx1RkQ5NyIsCiAgIlx1MDY0Nlx1MDYyQ1x1MDY0NSIsCiAgIlx1RkQ5OCIsCiAgIlx1MDY0Nlx1MDYyQ1x1MDY0NSIsCiAgIlx1RkQ5OSIsCiAgIlx1MDY0Nlx1MDYyQ1x1MDY0OSIsCiAgIlx1RkQ5QSIsCiAgIlx1MDY0Nlx1MDY0NVx1MDY0QSIsCiAgIlx1RkQ5QiIsCiAgIlx1MDY0Nlx1MDY0NVx1MDY0OSIsCiAgIlx1RkQ5QyIsCiAgIlx1MDY0QVx1MDY0NVx1MDY0NSIsCiAgIlx1RkQ5RCIsCiAgIlx1MDY0QVx1MDY0NVx1MDY0NSIsCiAgIlx1RkQ5RSIsCiAgIlx1MDYyOFx1MDYyRVx1MDY0QSIsCiAgIlx1RkQ5RiIsCiAgIlx1MDYyQVx1MDYyQ1x1MDY0QSIsCiAgIlx1RkRBMCIsCiAgIlx1MDYyQVx1MDYyQ1x1MDY0OSIsCiAgIlx1RkRBMSIsCiAgIlx1MDYyQVx1MDYyRVx1MDY0QSIsCiAgIlx1RkRBMiIsCiAgIlx1MDYyQVx1MDYyRVx1MDY0OSIsCiAgIlx1RkRBMyIsCiAgIlx1MDYyQVx1MDY0NVx1MDY0QSIsCiAgIlx1RkRBNCIsCiAgIlx1MDYyQVx1MDY0NVx1MDY0OSIsCiAgIlx1RkRBNSIsCiAgIlx1MDYyQ1x1MDY0NVx1MDY0QSIsCiAgIlx1RkRBNiIsCiAgIlx1MDYyQ1x1MDYyRFx1MDY0OSIsCiAgIlx1RkRBNyIsCiAgIlx1MDYyQ1x1MDY0NVx1MDY0OSIsCiAgIlx1RkRBOCIsCiAgIlx1MDYzM1x1MDYyRVx1MDY0OSIsCiAgIlx1RkRBOSIsCiAgIlx1MDYzNVx1MDYyRFx1MDY0QSIsCiAgIlx1RkRBQSIsCiAgIlx1MDYzNFx1MDYyRFx1MDY0QSIsCiAgIlx1RkRBQiIsCiAgIlx1MDYzNlx1MDYyRFx1MDY0QSIsCiAgIlx1RkRBQyIsCiAgIlx1MDY0NFx1MDYyQ1x1MDY0QSIsCiAgIlx1RkRBRCIsCiAgIlx1MDY0NFx1MDY0NVx1MDY0QSIsCiAgIlx1RkRBRSIsCiAgIlx1MDY0QVx1MDYyRFx1MDY0QSIsCiAgIlx1RkRBRiIsCiAgIlx1MDY0QVx1MDYyQ1x1MDY0QSIsCiAgIlx1RkRCMCIsCiAgIlx1MDY0QVx1MDY0NVx1MDY0QSIsCiAgIlx1RkRCMSIsCiAgIlx1MDY0NVx1MDY0NVx1MDY0QSIsCiAgIlx1RkRCMiIsCiAgIlx1MDY0Mlx1MDY0NVx1MDY0QSIsCiAgIlx1RkRCMyIsCiAgIlx1MDY0Nlx1MDYyRFx1MDY0QSIsCiAgIlx1RkRCNCIsCiAgIlx1MDY0Mlx1MDY0NVx1MDYyRCIsCiAgIlx1RkRCNSIsCiAgIlx1MDY0NFx1MDYyRFx1MDY0NSIsCiAgIlx1RkRCNiIsCiAgIlx1MDYzOVx1MDY0NVx1MDY0QSIsCiAgIlx1RkRCNyIsCiAgIlx1MDY0M1x1MDY0NVx1MDY0QSIsCiAgIlx1RkRCOCIsCiAgIlx1MDY0Nlx1MDYyQ1x1MDYyRCIsCiAgIlx1RkRCOSIsCiAgIlx1MDY0NVx1MDYyRVx1MDY0QSIsCiAgIlx1RkRCQSIsCiAgIlx1MDY0NFx1MDYyQ1x1MDY0NSIsCiAgIlx1RkRCQiIsCiAgIlx1MDY0M1x1MDY0NVx1MDY0NSIsCiAgIlx1RkRCQyIsCiAgIlx1MDY0NFx1MDYyQ1x1MDY0NSIsCiAgIlx1RkRCRCIsCiAgIlx1MDY0Nlx1MDYyQ1x1MDYyRCIsCiAgIlx1RkRCRSIsCiAgIlx1MDYyQ1x1MDYyRFx1MDY0QSIsCiAgIlx1RkRCRiIsCiAgIlx1MDYyRFx1MDYyQ1x1MDY0QSIsCiAgIlx1RkRDMCIsCiAgIlx1MDY0NVx1MDYyQ1x1MDY0QSIsCiAgIlx1RkRDMSIsCiAgIlx1MDY0MVx1MDY0NVx1MDY0QSIsCiAgIlx1RkRDMiIsCiAgIlx1MDYyOFx1MDYyRFx1MDY0QSIsCiAgIlx1RkRDMyIsCiAgIlx1MDY0M1x1MDY0NVx1MDY0NSIsCiAgIlx1RkRDNCIsCiAgIlx1MDYzOVx1MDYyQ1x1MDY0NSIsCiAgIlx1RkRDNSIsCiAgIlx1MDYzNVx1MDY0NVx1MDY0NSIsCiAgIlx1RkRDNiIsCiAgIlx1MDYzM1x1MDYyRVx1MDY0QSIsCiAgIlx1RkRDNyIsCiAgIlx1MDY0Nlx1MDYyQ1x1MDY0QSIsCiAgIlx1RkU0OSIsCiAgIlx1MjAzRSIsCiAgIlx1RkU0QSIsCiAgIlx1MjAzRSIsCiAgIlx1RkU0QiIsCiAgIlx1MjAzRSIsCiAgIlx1RkU0QyIsCiAgIlx1MjAzRSIsCiAgIlx1RkU0RCIsCiAgIlx1MDA1RiIsCiAgIlx1RkU0RSIsCiAgIlx1MDA1RiIsCiAgIlx1RkU0RiIsCiAgIlx1MDA1RiIsCiAgIlx1RkU4MCIsCiAgIlx1MDYyMSIsCiAgIlx1RkU4MSIsCiAgIlx1MDYyMiIsCiAgIlx1RkU4MiIsCiAgIlx1MDYyMiIsCiAgIlx1RkU4MyIsCiAgIlx1MDYyMyIsCiAgIlx1RkU4NCIsCiAgIlx1MDYyMyIsCiAgIlx1RkU4NSIsCiAgIlx1MDYyNCIsCiAgIlx1RkU4NiIsCiAgIlx1MDYyNCIsCiAgIlx1RkU4NyIsCiAgIlx1MDYyNSIsCiAgIlx1RkU4OCIsCiAgIlx1MDYyNSIsCiAgIlx1RkU4OSIsCiAgIlx1MDYyNiIsCiAgIlx1RkU4QSIsCiAgIlx1MDYyNiIsCiAgIlx1RkU4QiIsCiAgIlx1MDYyNiIsCiAgIlx1RkU4QyIsCiAgIlx1MDYyNiIsCiAgIlx1RkU4RCIsCiAgIlx1MDYyNyIsCiAgIlx1RkU4RSIsCiAgIlx1MDYyNyIsCiAgIlx1RkU4RiIsCiAgIlx1MDYyOCIsCiAgIlx1RkU5MCIsCiAgIlx1MDYyOCIsCiAgIlx1RkU5MSIsCiAgIlx1MDYyOCIsCiAgIlx1RkU5MiIsCiAgIlx1MDYyOCIsCiAgIlx1RkU5MyIsCiAgIlx1MDYyOSIsCiAgIlx1RkU5NCIsCiAgIlx1MDYyOSIsCiAgIlx1RkU5NSIsCiAgIlx1MDYyQSIsCiAgIlx1RkU5NiIsCiAgIlx1MDYyQSIsCiAgIlx1RkU5NyIsCiAgIlx1MDYyQSIsCiAgIlx1RkU5OCIsCiAgIlx1MDYyQSIsCiAgIlx1RkU5OSIsCiAgIlx1MDYyQiIsCiAgIlx1RkU5QSIsCiAgIlx1MDYyQiIsCiAgIlx1RkU5QiIsCiAgIlx1MDYyQiIsCiAgIlx1RkU5QyIsCiAgIlx1MDYyQiIsCiAgIlx1RkU5RCIsCiAgIlx1MDYyQyIsCiAgIlx1RkU5RSIsCiAgIlx1MDYyQyIsCiAgIlx1RkU5RiIsCiAgIlx1MDYyQyIsCiAgIlx1RkVBMCIsCiAgIlx1MDYyQyIsCiAgIlx1RkVBMSIsCiAgIlx1MDYyRCIsCiAgIlx1RkVBMiIsCiAgIlx1MDYyRCIsCiAgIlx1RkVBMyIsCiAgIlx1MDYyRCIsCiAgIlx1RkVBNCIsCiAgIlx1MDYyRCIsCiAgIlx1RkVBNSIsCiAgIlx1MDYyRSIsCiAgIlx1RkVBNiIsCiAgIlx1MDYyRSIsCiAgIlx1RkVBNyIsCiAgIlx1MDYyRSIsCiAgIlx1RkVBOCIsCiAgIlx1MDYyRSIsCiAgIlx1RkVBOSIsCiAgIlx1MDYyRiIsCiAgIlx1RkVBQSIsCiAgIlx1MDYyRiIsCiAgIlx1RkVBQiIsCiAgIlx1MDYzMCIsCiAgIlx1RkVBQyIsCiAgIlx1MDYzMCIsCiAgIlx1RkVBRCIsCiAgIlx1MDYzMSIsCiAgIlx1RkVBRSIsCiAgIlx1MDYzMSIsCiAgIlx1RkVBRiIsCiAgIlx1MDYzMiIsCiAgIlx1RkVCMCIsCiAgIlx1MDYzMiIsCiAgIlx1RkVCMSIsCiAgIlx1MDYzMyIsCiAgIlx1RkVCMiIsCiAgIlx1MDYzMyIsCiAgIlx1RkVCMyIsCiAgIlx1MDYzMyIsCiAgIlx1RkVCNCIsCiAgIlx1MDYzMyIsCiAgIlx1RkVCNSIsCiAgIlx1MDYzNCIsCiAgIlx1RkVCNiIsCiAgIlx1MDYzNCIsCiAgIlx1RkVCNyIsCiAgIlx1MDYzNCIsCiAgIlx1RkVCOCIsCiAgIlx1MDYzNCIsCiAgIlx1RkVCOSIsCiAgIlx1MDYzNSIsCiAgIlx1RkVCQSIsCiAgIlx1MDYzNSIsCiAgIlx1RkVCQiIsCiAgIlx1MDYzNSIsCiAgIlx1RkVCQyIsCiAgIlx1MDYzNSIsCiAgIlx1RkVCRCIsCiAgIlx1MDYzNiIsCiAgIlx1RkVCRSIsCiAgIlx1MDYzNiIsCiAgIlx1RkVCRiIsCiAgIlx1MDYzNiIsCiAgIlx1RkVDMCIsCiAgIlx1MDYzNiIsCiAgIlx1RkVDMSIsCiAgIlx1MDYzNyIsCiAgIlx1RkVDMiIsCiAgIlx1MDYzNyIsCiAgIlx1RkVDMyIsCiAgIlx1MDYzNyIsCiAgIlx1RkVDNCIsCiAgIlx1MDYzNyIsCiAgIlx1RkVDNSIsCiAgIlx1MDYzOCIsCiAgIlx1RkVDNiIsCiAgIlx1MDYzOCIsCiAgIlx1RkVDNyIsCiAgIlx1MDYzOCIsCiAgIlx1RkVDOCIsCiAgIlx1MDYzOCIsCiAgIlx1RkVDOSIsCiAgIlx1MDYzOSIsCiAgIlx1RkVDQSIsCiAgIlx1MDYzOSIsCiAgIlx1RkVDQiIsCiAgIlx1MDYzOSIsCiAgIlx1RkVDQyIsCiAgIlx1MDYzOSIsCiAgIlx1RkVDRCIsCiAgIlx1MDYzQSIsCiAgIlx1RkVDRSIsCiAgIlx1MDYzQSIsCiAgIlx1RkVDRiIsCiAgIlx1MDYzQSIsCiAgIlx1RkVEMCIsCiAgIlx1MDYzQSIsCiAgIlx1RkVEMSIsCiAgIlx1MDY0MSIsCiAgIlx1RkVEMiIsCiAgIlx1MDY0MSIsCiAgIlx1RkVEMyIsCiAgIlx1MDY0MSIsCiAgIlx1RkVENCIsCiAgIlx1MDY0MSIsCiAgIlx1RkVENSIsCiAgIlx1MDY0MiIsCiAgIlx1RkVENiIsCiAgIlx1MDY0MiIsCiAgIlx1RkVENyIsCiAgIlx1MDY0MiIsCiAgIlx1RkVEOCIsCiAgIlx1MDY0MiIsCiAgIlx1RkVEOSIsCiAgIlx1MDY0MyIsCiAgIlx1RkVEQSIsCiAgIlx1MDY0MyIsCiAgIlx1RkVEQiIsCiAgIlx1MDY0MyIsCiAgIlx1RkVEQyIsCiAgIlx1MDY0MyIsCiAgIlx1RkVERCIsCiAgIlx1MDY0NCIsCiAgIlx1RkVERSIsCiAgIlx1MDY0NCIsCiAgIlx1RkVERiIsCiAgIlx1MDY0NCIsCiAgIlx1RkVFMCIsCiAgIlx1MDY0NCIsCiAgIlx1RkVFMSIsCiAgIlx1MDY0NSIsCiAgIlx1RkVFMiIsCiAgIlx1MDY0NSIsCiAgIlx1RkVFMyIsCiAgIlx1MDY0NSIsCiAgIlx1RkVFNCIsCiAgIlx1MDY0NSIsCiAgIlx1RkVFNSIsCiAgIlx1MDY0NiIsCiAgIlx1RkVFNiIsCiAgIlx1MDY0NiIsCiAgIlx1RkVFNyIsCiAgIlx1MDY0NiIsCiAgIlx1RkVFOCIsCiAgIlx1MDY0NiIsCiAgIlx1RkVFOSIsCiAgIlx1MDY0NyIsCiAgIlx1RkVFQSIsCiAgIlx1MDY0NyIsCiAgIlx1RkVFQiIsCiAgIlx1MDY0NyIsCiAgIlx1RkVFQyIsCiAgIlx1MDY0NyIsCiAgIlx1RkVFRCIsCiAgIlx1MDY0OCIsCiAgIlx1RkVFRSIsCiAgIlx1MDY0OCIsCiAgIlx1RkVFRiIsCiAgIlx1MDY0OSIsCiAgIlx1RkVGMCIsCiAgIlx1MDY0OSIsCiAgIlx1RkVGMSIsCiAgIlx1MDY0QSIsCiAgIlx1RkVGMiIsCiAgIlx1MDY0QSIsCiAgIlx1RkVGMyIsCiAgIlx1MDY0QSIsCiAgIlx1RkVGNCIsCiAgIlx1MDY0QSIsCiAgIlx1RkVGNSIsCiAgIlx1MDY0NFx1MDYyMiIsCiAgIlx1RkVGNiIsCiAgIlx1MDY0NFx1MDYyMiIsCiAgIlx1RkVGNyIsCiAgIlx1MDY0NFx1MDYyMyIsCiAgIlx1RkVGOCIsCiAgIlx1MDY0NFx1MDYyMyIsCiAgIlx1RkVGOSIsCiAgIlx1MDY0NFx1MDYyNSIsCiAgIlx1RkVGQSIsCiAgIlx1MDY0NFx1MDYyNSIsCiAgIlx1RkVGQiIsCiAgIlx1MDY0NFx1MDYyNyIsCiAgIlx1RkVGQyIsCiAgIlx1MDY0NFx1MDYyNyIKIF07Cn0pOwpmdW5jdGlvbiByZXZlcnNlSWZSdGwoY2hhcnMpIHsKIGNvbnN0IGNoYXJzTGVuZ3RoID0gY2hhcnMubGVuZ3RoOwogaWYgKGNoYXJzTGVuZ3RoIDw9IDEgfHwgIWlzUlRMUmFuZ2VGb3IoY2hhcnMuY2hhckNvZGVBdCgwKSkpIHsKICByZXR1cm4gY2hhcnM7CiB9CiBjb25zdCBidWYgPSBbXTsKIGZvciAobGV0IGlpID0gY2hhcnNMZW5ndGggLSAxOyBpaSA+PSAwOyBpaS0tKSB7CiAgYnVmLnB1c2goY2hhcnNbaWldKTsKIH0KIHJldHVybiBidWYuam9pbigiIik7Cn0KY29uc3QgU3BlY2lhbENoYXJSZWdFeHAgPSBuZXcgUmVnRXhwKCJeKFxccyl8KFxccHtNbn0pfChcXHB7Q2Z9KSQiLCAidSIpOwpjb25zdCBDYXRlZ29yeUNhY2hlID0gbmV3IE1hcCgpOwpmdW5jdGlvbiBnZXRDaGFyVW5pY29kZUNhdGVnb3J5KGNoYXIpIHsKIGNvbnN0IGNhY2hlZENhdGVnb3J5ID0gQ2F0ZWdvcnlDYWNoZS5nZXQoY2hhcik7CiBpZiAoY2FjaGVkQ2F0ZWdvcnkpIHsKICByZXR1cm4gY2FjaGVkQ2F0ZWdvcnk7CiB9CiBjb25zdCBncm91cHMgPSBjaGFyLm1hdGNoKFNwZWNpYWxDaGFyUmVnRXhwKTsKIGNvbnN0IGNhdGVnb3J5ID0gewogIGlzV2hpdGVzcGFjZTogISEoZ3JvdXBzICYmIGdyb3Vwc1sxXSksCiAgaXNaZXJvV2lkdGhEaWFjcml0aWM6ICEhKGdyb3VwcyAmJiBncm91cHNbMl0pLAogIGlzSW52aXNpYmxlRm9ybWF0TWFyazogISEoZ3JvdXBzICYmIGdyb3Vwc1szXSkKIH07CiBDYXRlZ29yeUNhY2hlLnNldChjaGFyLCBjYXRlZ29yeSk7CiByZXR1cm4gY2F0ZWdvcnk7Cn0KZnVuY3Rpb24gY2xlYXJVbmljb2RlQ2FjaGVzKCkgewogQ2F0ZWdvcnlDYWNoZS5jbGVhcigpOwp9CgoKLyoqKi8gfSksCi8qIDE2NiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuZ2V0U2VyaWZGb250cyA9IGV4cG9ydHMuZ2V0Tm9uU3RkRm9udE1hcCA9IGV4cG9ydHMuZ2V0R2x5cGhNYXBGb3JTdGFuZGFyZEZvbnRzID0gZXhwb3J0cy5nZXRGb250TmFtZVRvRmlsZU1hcCA9IHZvaWQgMDsKZXhwb3J0cy5nZXRTdGFuZGFyZEZvbnROYW1lID0gZ2V0U3RhbmRhcmRGb250TmFtZTsKZXhwb3J0cy5nZXRTeW1ib2xzRm9udHMgPSBleHBvcnRzLmdldFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQ2FsaWJyaSA9IGV4cG9ydHMuZ2V0U3VwcGxlbWVudGFsR2x5cGhNYXBGb3JBcmlhbEJsYWNrID0gZXhwb3J0cy5nZXRTdGRGb250TWFwID0gdm9pZCAwOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKdmFyIF9mb250c191dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTYzKTsKCmNvbnN0IGdldFN0ZEZvbnRNYXAgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogIHRbIlRpbWVzLVJvbWFuIl0gPSAiVGltZXMtUm9tYW4iOwogIHQuSGVsdmV0aWNhID0gIkhlbHZldGljYSI7CiAgdC5Db3VyaWVyID0gIkNvdXJpZXIiOwogIHQuU3ltYm9sID0gIlN5bWJvbCI7CiAgdFsiVGltZXMtQm9sZCJdID0gIlRpbWVzLUJvbGQiOwogIHRbIkhlbHZldGljYS1Cb2xkIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIkNvdXJpZXItQm9sZCJdID0gIkNvdXJpZXItQm9sZCI7CiAgdC5aYXBmRGluZ2JhdHMgPSAiWmFwZkRpbmdiYXRzIjsKICB0WyJUaW1lcy1JdGFsaWMiXSA9ICJUaW1lcy1JdGFsaWMiOwogIHRbIkhlbHZldGljYS1PYmxpcXVlIl0gPSAiSGVsdmV0aWNhLU9ibGlxdWUiOwogIHRbIkNvdXJpZXItT2JsaXF1ZSJdID0gIkNvdXJpZXItT2JsaXF1ZSI7CiAgdFsiVGltZXMtQm9sZEl0YWxpYyJdID0gIlRpbWVzLUJvbGRJdGFsaWMiOwogIHRbIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSJdID0gIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSI7CiAgdFsiQ291cmllci1Cb2xkT2JsaXF1ZSJdID0gIkNvdXJpZXItQm9sZE9ibGlxdWUiOwogIHQuQXJpYWxOYXJyb3cgPSAiSGVsdmV0aWNhIjsKICB0WyJBcmlhbE5hcnJvdy1Cb2xkIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIkFyaWFsTmFycm93LUJvbGRJdGFsaWMiXSA9ICJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiOwogIHRbIkFyaWFsTmFycm93LUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0LkFyaWFsQmxhY2sgPSAiSGVsdmV0aWNhIjsKICB0WyJBcmlhbEJsYWNrLUJvbGQiXSA9ICJIZWx2ZXRpY2EtQm9sZCI7CiAgdFsiQXJpYWxCbGFjay1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJBcmlhbEJsYWNrLUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0WyJBcmlhbC1CbGFjayJdID0gIkhlbHZldGljYSI7CiAgdFsiQXJpYWwtQmxhY2stQm9sZCJdID0gIkhlbHZldGljYS1Cb2xkIjsKICB0WyJBcmlhbC1CbGFjay1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJBcmlhbC1CbGFjay1JdGFsaWMiXSA9ICJIZWx2ZXRpY2EtT2JsaXF1ZSI7CiAgdC5BcmlhbCA9ICJIZWx2ZXRpY2EiOwogIHRbIkFyaWFsLUJvbGQiXSA9ICJIZWx2ZXRpY2EtQm9sZCI7CiAgdFsiQXJpYWwtQm9sZEl0YWxpYyJdID0gIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSI7CiAgdFsiQXJpYWwtSXRhbGljIl0gPSAiSGVsdmV0aWNhLU9ibGlxdWUiOwogIHQuQXJpYWxNVCA9ICJIZWx2ZXRpY2EiOwogIHRbIkFyaWFsLUJvbGRJdGFsaWNNVCJdID0gIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSI7CiAgdFsiQXJpYWwtQm9sZE1UIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIkFyaWFsLUl0YWxpY01UIl0gPSAiSGVsdmV0aWNhLU9ibGlxdWUiOwogIHQuQXJpYWxVbmljb2RlTVMgPSAiSGVsdmV0aWNhIjsKICB0WyJBcmlhbFVuaWNvZGVNUy1Cb2xkIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIkFyaWFsVW5pY29kZU1TLUJvbGRJdGFsaWMiXSA9ICJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiOwogIHRbIkFyaWFsVW5pY29kZU1TLUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0WyJDb3VyaWVyLUJvbGRJdGFsaWMiXSA9ICJDb3VyaWVyLUJvbGRPYmxpcXVlIjsKICB0WyJDb3VyaWVyLUl0YWxpYyJdID0gIkNvdXJpZXItT2JsaXF1ZSI7CiAgdC5Db3VyaWVyTmV3ID0gIkNvdXJpZXIiOwogIHRbIkNvdXJpZXJOZXctQm9sZCJdID0gIkNvdXJpZXItQm9sZCI7CiAgdFsiQ291cmllck5ldy1Cb2xkSXRhbGljIl0gPSAiQ291cmllci1Cb2xkT2JsaXF1ZSI7CiAgdFsiQ291cmllck5ldy1JdGFsaWMiXSA9ICJDb3VyaWVyLU9ibGlxdWUiOwogIHRbIkNvdXJpZXJOZXdQUy1Cb2xkSXRhbGljTVQiXSA9ICJDb3VyaWVyLUJvbGRPYmxpcXVlIjsKICB0WyJDb3VyaWVyTmV3UFMtQm9sZE1UIl0gPSAiQ291cmllci1Cb2xkIjsKICB0WyJDb3VyaWVyTmV3UFMtSXRhbGljTVQiXSA9ICJDb3VyaWVyLU9ibGlxdWUiOwogIHQuQ291cmllck5ld1BTTVQgPSAiQ291cmllciI7CiAgdFsiSGVsdmV0aWNhLUJvbGRJdGFsaWMiXSA9ICJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiOwogIHRbIkhlbHZldGljYS1JdGFsaWMiXSA9ICJIZWx2ZXRpY2EtT2JsaXF1ZSI7CiAgdFsiU3ltYm9sLUJvbGQiXSA9ICJTeW1ib2wiOwogIHRbIlN5bWJvbC1Cb2xkSXRhbGljIl0gPSAiU3ltYm9sIjsKICB0WyJTeW1ib2wtSXRhbGljIl0gPSAiU3ltYm9sIjsKICB0LlRpbWVzTmV3Um9tYW4gPSAiVGltZXMtUm9tYW4iOwogIHRbIlRpbWVzTmV3Um9tYW4tQm9sZCJdID0gIlRpbWVzLUJvbGQiOwogIHRbIlRpbWVzTmV3Um9tYW4tQm9sZEl0YWxpYyJdID0gIlRpbWVzLUJvbGRJdGFsaWMiOwogIHRbIlRpbWVzTmV3Um9tYW4tSXRhbGljIl0gPSAiVGltZXMtSXRhbGljIjsKICB0LlRpbWVzTmV3Um9tYW5QUyA9ICJUaW1lcy1Sb21hbiI7CiAgdFsiVGltZXNOZXdSb21hblBTLUJvbGQiXSA9ICJUaW1lcy1Cb2xkIjsKICB0WyJUaW1lc05ld1JvbWFuUFMtQm9sZEl0YWxpYyJdID0gIlRpbWVzLUJvbGRJdGFsaWMiOwogIHRbIlRpbWVzTmV3Um9tYW5QUy1Cb2xkSXRhbGljTVQiXSA9ICJUaW1lcy1Cb2xkSXRhbGljIjsKICB0WyJUaW1lc05ld1JvbWFuUFMtQm9sZE1UIl0gPSAiVGltZXMtQm9sZCI7CiAgdFsiVGltZXNOZXdSb21hblBTLUl0YWxpYyJdID0gIlRpbWVzLUl0YWxpYyI7CiAgdFsiVGltZXNOZXdSb21hblBTLUl0YWxpY01UIl0gPSAiVGltZXMtSXRhbGljIjsKICB0LlRpbWVzTmV3Um9tYW5QU01UID0gIlRpbWVzLVJvbWFuIjsKICB0WyJUaW1lc05ld1JvbWFuUFNNVC1Cb2xkIl0gPSAiVGltZXMtQm9sZCI7CiAgdFsiVGltZXNOZXdSb21hblBTTVQtQm9sZEl0YWxpYyJdID0gIlRpbWVzLUJvbGRJdGFsaWMiOwogIHRbIlRpbWVzTmV3Um9tYW5QU01ULUl0YWxpYyJdID0gIlRpbWVzLUl0YWxpYyI7Cn0pOwpleHBvcnRzLmdldFN0ZEZvbnRNYXAgPSBnZXRTdGRGb250TWFwOwpjb25zdCBnZXRGb250TmFtZVRvRmlsZU1hcCA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgdC5Db3VyaWVyID0gIkZveGl0Rml4ZWQucGZiIjsKICB0WyJDb3VyaWVyLUJvbGQiXSA9ICJGb3hpdEZpeGVkQm9sZC5wZmIiOwogIHRbIkNvdXJpZXItQm9sZE9ibGlxdWUiXSA9ICJGb3hpdEZpeGVkQm9sZEl0YWxpYy5wZmIiOwogIHRbIkNvdXJpZXItT2JsaXF1ZSJdID0gIkZveGl0Rml4ZWRJdGFsaWMucGZiIjsKICB0LkhlbHZldGljYSA9ICJGb3hpdFNhbnMucGZiIjsKICB0WyJIZWx2ZXRpY2EtQm9sZCJdID0gIkZveGl0U2Fuc0JvbGQucGZiIjsKICB0WyJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiXSA9ICJGb3hpdFNhbnNCb2xkSXRhbGljLnBmYiI7CiAgdFsiSGVsdmV0aWNhLU9ibGlxdWUiXSA9ICJGb3hpdFNhbnNJdGFsaWMucGZiIjsKICB0WyJUaW1lcy1Sb21hbiJdID0gIkZveGl0U2VyaWYucGZiIjsKICB0WyJUaW1lcy1Cb2xkIl0gPSAiRm94aXRTZXJpZkJvbGQucGZiIjsKICB0WyJUaW1lcy1Cb2xkSXRhbGljIl0gPSAiRm94aXRTZXJpZkJvbGRJdGFsaWMucGZiIjsKICB0WyJUaW1lcy1JdGFsaWMiXSA9ICJGb3hpdFNlcmlmSXRhbGljLnBmYiI7CiAgdC5TeW1ib2wgPSAiRm94aXRTeW1ib2wucGZiIjsKICB0LlphcGZEaW5nYmF0cyA9ICJGb3hpdERpbmdiYXRzLnBmYiI7CiAgdFsiTGliZXJhdGlvblNhbnMtUmVndWxhciJdID0gIkxpYmVyYXRpb25TYW5zLVJlZ3VsYXIudHRmIjsKICB0WyJMaWJlcmF0aW9uU2Fucy1Cb2xkIl0gPSAiTGliZXJhdGlvblNhbnMtQm9sZC50dGYiOwogIHRbIkxpYmVyYXRpb25TYW5zLUl0YWxpYyJdID0gIkxpYmVyYXRpb25TYW5zLUl0YWxpYy50dGYiOwogIHRbIkxpYmVyYXRpb25TYW5zLUJvbGRJdGFsaWMiXSA9ICJMaWJlcmF0aW9uU2Fucy1Cb2xkSXRhbGljLnR0ZiI7Cn0pOwpleHBvcnRzLmdldEZvbnROYW1lVG9GaWxlTWFwID0gZ2V0Rm9udE5hbWVUb0ZpbGVNYXA7CmNvbnN0IGdldE5vblN0ZEZvbnRNYXAgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogIHQuQ2FsaWJyaSA9ICJIZWx2ZXRpY2EiOwogIHRbIkNhbGlicmktQm9sZCJdID0gIkhlbHZldGljYS1Cb2xkIjsKICB0WyJDYWxpYnJpLUJvbGRJdGFsaWMiXSA9ICJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiOwogIHRbIkNhbGlicmktSXRhbGljIl0gPSAiSGVsdmV0aWNhLU9ibGlxdWUiOwogIHQuQ2VudHVyeUdvdGhpYyA9ICJIZWx2ZXRpY2EiOwogIHRbIkNlbnR1cnlHb3RoaWMtQm9sZCJdID0gIkhlbHZldGljYS1Cb2xkIjsKICB0WyJDZW50dXJ5R290aGljLUJvbGRJdGFsaWMiXSA9ICJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiOwogIHRbIkNlbnR1cnlHb3RoaWMtSXRhbGljIl0gPSAiSGVsdmV0aWNhLU9ibGlxdWUiOwogIHQuQ29taWNTYW5zTVMgPSAiQ29taWMgU2FucyBNUyI7CiAgdFsiQ29taWNTYW5zTVMtQm9sZCJdID0gIkNvbWljIFNhbnMgTVMtQm9sZCI7CiAgdFsiQ29taWNTYW5zTVMtQm9sZEl0YWxpYyJdID0gIkNvbWljIFNhbnMgTVMtQm9sZEl0YWxpYyI7CiAgdFsiQ29taWNTYW5zTVMtSXRhbGljIl0gPSAiQ29taWMgU2FucyBNUy1JdGFsaWMiOwogIHRbIkl0Y1N5bWJvbC1Cb2xkIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIkl0Y1N5bWJvbC1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJJdGNTeW1ib2wtQm9vayJdID0gIkhlbHZldGljYSI7CiAgdFsiSXRjU3ltYm9sLUJvb2tJdGFsaWMiXSA9ICJIZWx2ZXRpY2EtT2JsaXF1ZSI7CiAgdFsiSXRjU3ltYm9sLU1lZGl1bSJdID0gIkhlbHZldGljYSI7CiAgdFsiSXRjU3ltYm9sLU1lZGl1bUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0Lkx1Y2lkYUNvbnNvbGUgPSAiQ291cmllciI7CiAgdFsiTHVjaWRhQ29uc29sZS1Cb2xkIl0gPSAiQ291cmllci1Cb2xkIjsKICB0WyJMdWNpZGFDb25zb2xlLUJvbGRJdGFsaWMiXSA9ICJDb3VyaWVyLUJvbGRPYmxpcXVlIjsKICB0WyJMdWNpZGFDb25zb2xlLUl0YWxpYyJdID0gIkNvdXJpZXItT2JsaXF1ZSI7CiAgdFsiTHVjaWRhU2Fucy1EZW1pIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIk1TLUdvdGhpYyJdID0gIk1TIEdvdGhpYyI7CiAgdFsiTVMtR290aGljLUJvbGQiXSA9ICJNUyBHb3RoaWMtQm9sZCI7CiAgdFsiTVMtR290aGljLUJvbGRJdGFsaWMiXSA9ICJNUyBHb3RoaWMtQm9sZEl0YWxpYyI7CiAgdFsiTVMtR290aGljLUl0YWxpYyJdID0gIk1TIEdvdGhpYy1JdGFsaWMiOwogIHRbIk1TLU1pbmNobyJdID0gIk1TIE1pbmNobyI7CiAgdFsiTVMtTWluY2hvLUJvbGQiXSA9ICJNUyBNaW5jaG8tQm9sZCI7CiAgdFsiTVMtTWluY2hvLUJvbGRJdGFsaWMiXSA9ICJNUyBNaW5jaG8tQm9sZEl0YWxpYyI7CiAgdFsiTVMtTWluY2hvLUl0YWxpYyJdID0gIk1TIE1pbmNoby1JdGFsaWMiOwogIHRbIk1TLVBHb3RoaWMiXSA9ICJNUyBQR290aGljIjsKICB0WyJNUy1QR290aGljLUJvbGQiXSA9ICJNUyBQR290aGljLUJvbGQiOwogIHRbIk1TLVBHb3RoaWMtQm9sZEl0YWxpYyJdID0gIk1TIFBHb3RoaWMtQm9sZEl0YWxpYyI7CiAgdFsiTVMtUEdvdGhpYy1JdGFsaWMiXSA9ICJNUyBQR290aGljLUl0YWxpYyI7CiAgdFsiTVMtUE1pbmNobyJdID0gIk1TIFBNaW5jaG8iOwogIHRbIk1TLVBNaW5jaG8tQm9sZCJdID0gIk1TIFBNaW5jaG8tQm9sZCI7CiAgdFsiTVMtUE1pbmNoby1Cb2xkSXRhbGljIl0gPSAiTVMgUE1pbmNoby1Cb2xkSXRhbGljIjsKICB0WyJNUy1QTWluY2hvLUl0YWxpYyJdID0gIk1TIFBNaW5jaG8tSXRhbGljIjsKICB0Lk51cHRpYWxTY3JpcHQgPSAiVGltZXMtSXRhbGljIjsKICB0LlNlZ29lVUlTeW1ib2wgPSAiSGVsdmV0aWNhIjsKICB0LldpbmdkaW5ncyA9ICJaYXBmRGluZ2JhdHMiOwogIHRbIldpbmdkaW5ncy1SZWd1bGFyIl0gPSAiWmFwZkRpbmdiYXRzIjsKfSk7CmV4cG9ydHMuZ2V0Tm9uU3RkRm9udE1hcCA9IGdldE5vblN0ZEZvbnRNYXA7CmNvbnN0IGdldFNlcmlmRm9udHMgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogIHRbIkFkb2JlIEplbnNvbiJdID0gdHJ1ZTsKICB0WyJBZG9iZSBUZXh0Il0gPSB0cnVlOwogIHQuQWxiZXJ0dXMgPSB0cnVlOwogIHQuQWxkdXMgPSB0cnVlOwogIHQuQWxleGFuZHJpYSA9IHRydWU7CiAgdC5BbGdlcmlhbiA9IHRydWU7CiAgdFsiQW1lcmljYW4gVHlwZXdyaXRlciJdID0gdHJ1ZTsKICB0LkFudGlxdWEgPSB0cnVlOwogIHQuQXBleCA9IHRydWU7CiAgdC5Bcm5vID0gdHJ1ZTsKICB0LkFzdGVyID0gdHJ1ZTsKICB0LkF1cm9yYSA9IHRydWU7CiAgdC5CYXNrZXJ2aWxsZSA9IHRydWU7CiAgdC5CZWxsID0gdHJ1ZTsKICB0LkJlbWJvID0gdHJ1ZTsKICB0WyJCZW1ibyBTY2hvb2xib29rIl0gPSB0cnVlOwogIHQuQmVuZ3VpYXQgPSB0cnVlOwogIHRbIkJlcmtlbGV5IE9sZCBTdHlsZSJdID0gdHJ1ZTsKICB0WyJCZXJuaGFyZCBNb2Rlcm4iXSA9IHRydWU7CiAgdFsiQmVydGhvbGQgQ2l0eSJdID0gdHJ1ZTsKICB0LkJvZG9uaSA9IHRydWU7CiAgdFsiQmF1ZXIgQm9kb25pIl0gPSB0cnVlOwogIHRbIkJvb2sgQW50aXF1YSJdID0gdHJ1ZTsKICB0LkJvb2ttYW4gPSB0cnVlOwogIHRbIkJvcmRlYXV4IFJvbWFuIl0gPSB0cnVlOwogIHRbIkNhbGlmb3JuaWFuIEZCIl0gPSB0cnVlOwogIHQuQ2FsaXN0byA9IHRydWU7CiAgdC5DYWx2ZXJ0ID0gdHJ1ZTsKICB0LkNhcGl0YWxzID0gdHJ1ZTsKICB0LkNhbWJyaWEgPSB0cnVlOwogIHQuQ2FydGllciA9IHRydWU7CiAgdC5DYXNsb24gPSB0cnVlOwogIHQuQ2F0dWxsID0gdHJ1ZTsKICB0LkNlbnRhdXIgPSB0cnVlOwogIHRbIkNlbnR1cnkgT2xkIFN0eWxlIl0gPSB0cnVlOwogIHRbIkNlbnR1cnkgU2Nob29sYm9vayJdID0gdHJ1ZTsKICB0LkNoYXBhcnJhbCA9IHRydWU7CiAgdFsiQ2hhcmlzIFNJTCJdID0gdHJ1ZTsKICB0LkNoZWx0ZW5oYW0gPSB0cnVlOwogIHRbIkNob2xsYSBTbGFiIl0gPSB0cnVlOwogIHQuQ2xhcmVuZG9uID0gdHJ1ZTsKICB0LkNsZWFyZmFjZSA9IHRydWU7CiAgdC5Db2NoaW4gPSB0cnVlOwogIHQuQ29sb25uYSA9IHRydWU7CiAgdFsiQ29tcHV0ZXIgTW9kZXJuIl0gPSB0cnVlOwogIHRbIkNvbmNyZXRlIFJvbWFuIl0gPSB0cnVlOwogIHQuQ29uc3RhbnRpYSA9IHRydWU7CiAgdFsiQ29vcGVyIEJsYWNrIl0gPSB0cnVlOwogIHQuQ29yb25hID0gdHJ1ZTsKICB0LkVjb3R5cGUgPSB0cnVlOwogIHQuRWd5cHRpZW5uZSA9IHRydWU7CiAgdC5FbGVwaGFudCA9IHRydWU7CiAgdC5FeGNlbHNpb3IgPSB0cnVlOwogIHQuRmFpcmZpZWxkID0gdHJ1ZTsKICB0WyJGRiBTY2FsYSJdID0gdHJ1ZTsKICB0LkZvbGthcmQgPSB0cnVlOwogIHQuRm9vdGxpZ2h0ID0gdHJ1ZTsKICB0LkZyZWVTZXJpZiA9IHRydWU7CiAgdFsiRnJpeiBRdWFkcmF0YSJdID0gdHJ1ZTsKICB0LkdhcmFtb25kID0gdHJ1ZTsKICB0LkdlbnRpdW0gPSB0cnVlOwogIHQuR2VvcmdpYSA9IHRydWU7CiAgdC5HbG91Y2VzdGVyID0gdHJ1ZTsKICB0WyJHb3VkeSBPbGQgU3R5bGUiXSA9IHRydWU7CiAgdFsiR291ZHkgU2Nob29sYm9vayJdID0gdHJ1ZTsKICB0WyJHb3VkeSBQcm8gRm9udCJdID0gdHJ1ZTsKICB0LkdyYW5qb24gPSB0cnVlOwogIHRbIkd1YXJkaWFuIEVneXB0aWFuIl0gPSB0cnVlOwogIHQuSGVhdGhlciA9IHRydWU7CiAgdC5IZXJjdWxlcyA9IHRydWU7CiAgdFsiSGlnaCBUb3dlciBUZXh0Il0gPSB0cnVlOwogIHQuSGlyb3NoaWdlID0gdHJ1ZTsKICB0WyJIb2VmbGVyIFRleHQiXSA9IHRydWU7CiAgdFsiSHVtYW5hIFNlcmlmIl0gPSB0cnVlOwogIHQuSW1wcmludCA9IHRydWU7CiAgdFsiSW9uaWMgTm8uIDUiXSA9IHRydWU7CiAgdC5KYW5zb24gPSB0cnVlOwogIHQuSm9hbm5hID0gdHJ1ZTsKICB0LktvcmlubmEgPSB0cnVlOwogIHQuTGV4aWNvbiA9IHRydWU7CiAgdC5MaWJlcmF0aW9uU2VyaWYgPSB0cnVlOwogIHRbIkxpYmVyYXRpb24gU2VyaWYiXSA9IHRydWU7CiAgdFsiTGludXggTGliZXJ0aW5lIl0gPSB0cnVlOwogIHQuTGl0ZXJhdHVybmF5YSA9IHRydWU7CiAgdC5MdWNpZGEgPSB0cnVlOwogIHRbIkx1Y2lkYSBCcmlnaHQiXSA9IHRydWU7CiAgdC5NZWxpb3IgPSB0cnVlOwogIHQuTWVtcGhpcyA9IHRydWU7CiAgdC5NaWxsZXIgPSB0cnVlOwogIHQuTWluaW9uID0gdHJ1ZTsKICB0Lk1vZGVybiA9IHRydWU7CiAgdFsiTW9uYSBMaXNhIl0gPSB0cnVlOwogIHRbIk1ycyBFYXZlcyJdID0gdHJ1ZTsKICB0WyJNUyBTZXJpZiJdID0gdHJ1ZTsKICB0WyJNdXNlbyBTbGFiIl0gPSB0cnVlOwogIHRbIk5ldyBZb3JrIl0gPSB0cnVlOwogIHRbIk5pbWJ1cyBSb21hbiJdID0gdHJ1ZTsKICB0WyJOUFMgUmF3bGluc29uIFJvYWR3YXkiXSA9IHRydWU7CiAgdC5OdXB0aWFsU2NyaXB0ID0gdHJ1ZTsKICB0LlBhbGF0aW5vID0gdHJ1ZTsKICB0LlBlcnBldHVhID0gdHJ1ZTsKICB0LlBsYW50aW4gPSB0cnVlOwogIHRbIlBsYW50aW4gU2Nob29sYm9vayJdID0gdHJ1ZTsKICB0LlBsYXliaWxsID0gdHJ1ZTsKICB0WyJQb29yIFJpY2hhcmQiXSA9IHRydWU7CiAgdFsiUmF3bGluc29uIFJvYWR3YXkiXSA9IHRydWU7CiAgdC5SZW5hdWx0ID0gdHJ1ZTsKICB0LlJlcXVpZW0gPSB0cnVlOwogIHQuUm9ja3dlbGwgPSB0cnVlOwogIHQuUm9tYW4gPSB0cnVlOwogIHRbIlJvdGlzIFNlcmlmIl0gPSB0cnVlOwogIHQuU2Fib24gPSB0cnVlOwogIHQuU2NhbGEgPSB0cnVlOwogIHQuU2VhZ3VsbCA9IHRydWU7CiAgdC5TaXN0aW5hID0gdHJ1ZTsKICB0LlNvdXZlbmlyID0gdHJ1ZTsKICB0LlNUSVggPSB0cnVlOwogIHRbIlN0b25lIEluZm9ybWFsIl0gPSB0cnVlOwogIHRbIlN0b25lIFNlcmlmIl0gPSB0cnVlOwogIHQuU3lsZmFlbiA9IHRydWU7CiAgdC5UaW1lcyA9IHRydWU7CiAgdC5UcmFqYW4gPSB0cnVlOwogIHRbIlRyaW5pdMOpIl0gPSB0cnVlOwogIHRbIlRydW1wIE1lZGlhZXZhbCJdID0gdHJ1ZTsKICB0LlV0b3BpYSA9IHRydWU7CiAgdFsiVmFsZSBUeXBlIl0gPSB0cnVlOwogIHRbIkJpdHN0cmVhbSBWZXJhIl0gPSB0cnVlOwogIHRbIlZlcmEgU2VyaWYiXSA9IHRydWU7CiAgdC5WZXJzYWlsbGVzID0gdHJ1ZTsKICB0LldhbnRlZCA9IHRydWU7CiAgdC5XZWlzcyA9IHRydWU7CiAgdFsiV2lkZSBMYXRpbiJdID0gdHJ1ZTsKICB0LldpbmRzb3IgPSB0cnVlOwogIHQuWElUUyA9IHRydWU7Cn0pOwpleHBvcnRzLmdldFNlcmlmRm9udHMgPSBnZXRTZXJpZkZvbnRzOwpjb25zdCBnZXRTeW1ib2xzRm9udHMgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogIHQuRGluZ2JhdHMgPSB0cnVlOwogIHQuU3ltYm9sID0gdHJ1ZTsKICB0LlphcGZEaW5nYmF0cyA9IHRydWU7Cn0pOwpleHBvcnRzLmdldFN5bWJvbHNGb250cyA9IGdldFN5bWJvbHNGb250czsKY29uc3QgZ2V0R2x5cGhNYXBGb3JTdGFuZGFyZEZvbnRzID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0WzJdID0gMTA7CiAgdFszXSA9IDMyOwogIHRbNF0gPSAzMzsKICB0WzVdID0gMzQ7CiAgdFs2XSA9IDM1OwogIHRbN10gPSAzNjsKICB0WzhdID0gMzc7CiAgdFs5XSA9IDM4OwogIHRbMTBdID0gMzk7CiAgdFsxMV0gPSA0MDsKICB0WzEyXSA9IDQxOwogIHRbMTNdID0gNDI7CiAgdFsxNF0gPSA0MzsKICB0WzE1XSA9IDQ0OwogIHRbMTZdID0gNDU7CiAgdFsxN10gPSA0NjsKICB0WzE4XSA9IDQ3OwogIHRbMTldID0gNDg7CiAgdFsyMF0gPSA0OTsKICB0WzIxXSA9IDUwOwogIHRbMjJdID0gNTE7CiAgdFsyM10gPSA1MjsKICB0WzI0XSA9IDUzOwogIHRbMjVdID0gNTQ7CiAgdFsyNl0gPSA1NTsKICB0WzI3XSA9IDU2OwogIHRbMjhdID0gNTc7CiAgdFsyOV0gPSA1ODsKICB0WzMwXSA9IDg5NDsKICB0WzMxXSA9IDYwOwogIHRbMzJdID0gNjE7CiAgdFszM10gPSA2MjsKICB0WzM0XSA9IDYzOwogIHRbMzVdID0gNjQ7CiAgdFszNl0gPSA2NTsKICB0WzM3XSA9IDY2OwogIHRbMzhdID0gNjc7CiAgdFszOV0gPSA2ODsKICB0WzQwXSA9IDY5OwogIHRbNDFdID0gNzA7CiAgdFs0Ml0gPSA3MTsKICB0WzQzXSA9IDcyOwogIHRbNDRdID0gNzM7CiAgdFs0NV0gPSA3NDsKICB0WzQ2XSA9IDc1OwogIHRbNDddID0gNzY7CiAgdFs0OF0gPSA3NzsKICB0WzQ5XSA9IDc4OwogIHRbNTBdID0gNzk7CiAgdFs1MV0gPSA4MDsKICB0WzUyXSA9IDgxOwogIHRbNTNdID0gODI7CiAgdFs1NF0gPSA4MzsKICB0WzU1XSA9IDg0OwogIHRbNTZdID0gODU7CiAgdFs1N10gPSA4NjsKICB0WzU4XSA9IDg3OwogIHRbNTldID0gODg7CiAgdFs2MF0gPSA4OTsKICB0WzYxXSA9IDkwOwogIHRbNjJdID0gOTE7CiAgdFs2M10gPSA5MjsKICB0WzY0XSA9IDkzOwogIHRbNjVdID0gOTQ7CiAgdFs2Nl0gPSA5NTsKICB0WzY3XSA9IDk2OwogIHRbNjhdID0gOTc7CiAgdFs2OV0gPSA5ODsKICB0WzcwXSA9IDk5OwogIHRbNzFdID0gMTAwOwogIHRbNzJdID0gMTAxOwogIHRbNzNdID0gMTAyOwogIHRbNzRdID0gMTAzOwogIHRbNzVdID0gMTA0OwogIHRbNzZdID0gMTA1OwogIHRbNzddID0gMTA2OwogIHRbNzhdID0gMTA3OwogIHRbNzldID0gMTA4OwogIHRbODBdID0gMTA5OwogIHRbODFdID0gMTEwOwogIHRbODJdID0gMTExOwogIHRbODNdID0gMTEyOwogIHRbODRdID0gMTEzOwogIHRbODVdID0gMTE0OwogIHRbODZdID0gMTE1OwogIHRbODddID0gMTE2OwogIHRbODhdID0gMTE3OwogIHRbODldID0gMTE4OwogIHRbOTBdID0gMTE5OwogIHRbOTFdID0gMTIwOwogIHRbOTJdID0gMTIxOwogIHRbOTNdID0gMTIyOwogIHRbOTRdID0gMTIzOwogIHRbOTVdID0gMTI0OwogIHRbOTZdID0gMTI1OwogIHRbOTddID0gMTI2OwogIHRbOThdID0gMTk2OwogIHRbOTldID0gMTk3OwogIHRbMTAwXSA9IDE5OTsKICB0WzEwMV0gPSAyMDE7CiAgdFsxMDJdID0gMjA5OwogIHRbMTAzXSA9IDIxNDsKICB0WzEwNF0gPSAyMjA7CiAgdFsxMDVdID0gMjI1OwogIHRbMTA2XSA9IDIyNDsKICB0WzEwN10gPSAyMjY7CiAgdFsxMDhdID0gMjI4OwogIHRbMTA5XSA9IDIyNzsKICB0WzExMF0gPSAyMjk7CiAgdFsxMTFdID0gMjMxOwogIHRbMTEyXSA9IDIzMzsKICB0WzExM10gPSAyMzI7CiAgdFsxMTRdID0gMjM0OwogIHRbMTE1XSA9IDIzNTsKICB0WzExNl0gPSAyMzc7CiAgdFsxMTddID0gMjM2OwogIHRbMTE4XSA9IDIzODsKICB0WzExOV0gPSAyMzk7CiAgdFsxMjBdID0gMjQxOwogIHRbMTIxXSA9IDI0MzsKICB0WzEyMl0gPSAyNDI7CiAgdFsxMjNdID0gMjQ0OwogIHRbMTI0XSA9IDI0NjsKICB0WzEyNV0gPSAyNDU7CiAgdFsxMjZdID0gMjUwOwogIHRbMTI3XSA9IDI0OTsKICB0WzEyOF0gPSAyNTE7CiAgdFsxMjldID0gMjUyOwogIHRbMTMwXSA9IDgyMjQ7CiAgdFsxMzFdID0gMTc2OwogIHRbMTMyXSA9IDE2MjsKICB0WzEzM10gPSAxNjM7CiAgdFsxMzRdID0gMTY3OwogIHRbMTM1XSA9IDgyMjY7CiAgdFsxMzZdID0gMTgyOwogIHRbMTM3XSA9IDIyMzsKICB0WzEzOF0gPSAxNzQ7CiAgdFsxMzldID0gMTY5OwogIHRbMTQwXSA9IDg0ODI7CiAgdFsxNDFdID0gMTgwOwogIHRbMTQyXSA9IDE2ODsKICB0WzE0M10gPSA4ODAwOwogIHRbMTQ0XSA9IDE5ODsKICB0WzE0NV0gPSAyMTY7CiAgdFsxNDZdID0gODczNDsKICB0WzE0N10gPSAxNzc7CiAgdFsxNDhdID0gODgwNDsKICB0WzE0OV0gPSA4ODA1OwogIHRbMTUwXSA9IDE2NTsKICB0WzE1MV0gPSAxODE7CiAgdFsxNTJdID0gODcwNjsKICB0WzE1M10gPSA4NzIxOwogIHRbMTU0XSA9IDg3MTk7CiAgdFsxNTZdID0gODc0NzsKICB0WzE1N10gPSAxNzA7CiAgdFsxNThdID0gMTg2OwogIHRbMTU5XSA9IDg0ODY7CiAgdFsxNjBdID0gMjMwOwogIHRbMTYxXSA9IDI0ODsKICB0WzE2Ml0gPSAxOTE7CiAgdFsxNjNdID0gMTYxOwogIHRbMTY0XSA9IDE3MjsKICB0WzE2NV0gPSA4NzMwOwogIHRbMTY2XSA9IDQwMjsKICB0WzE2N10gPSA4Nzc2OwogIHRbMTY4XSA9IDg3MTA7CiAgdFsxNjldID0gMTcxOwogIHRbMTcwXSA9IDE4NzsKICB0WzE3MV0gPSA4MjMwOwogIHRbMjAwXSA9IDE5MzsKICB0WzIwM10gPSAyMDU7CiAgdFsyMTBdID0gMjE4OwogIHRbMjIzXSA9IDcxMTsKICB0WzIyNF0gPSAzMjE7CiAgdFsyMjVdID0gMzIyOwogIHRbMjI2XSA9IDM1MjsKICB0WzIyN10gPSAzNTM7CiAgdFsyMjhdID0gMzgxOwogIHRbMjI5XSA9IDM4MjsKICB0WzIzM10gPSAyMjE7CiAgdFsyMzRdID0gMjUzOwogIHRbMjUyXSA9IDI2MzsKICB0WzI1M10gPSAyNjg7CiAgdFsyNTRdID0gMjY5OwogIHRbMjU4XSA9IDI1ODsKICB0WzI2MF0gPSAyNjA7CiAgdFsyNjFdID0gMjYxOwogIHRbMjY1XSA9IDI4MDsKICB0WzI2Nl0gPSAyODE7CiAgdFsyNjddID0gMjgyOwogIHRbMjY4XSA9IDI4MzsKICB0WzI2OV0gPSAzMTM7CiAgdFsyNzVdID0gMzIzOwogIHRbMjc2XSA9IDMyNDsKICB0WzI3OF0gPSAzMjg7CiAgdFsyODNdID0gMzQ0OwogIHRbMjg0XSA9IDM0NTsKICB0WzI4NV0gPSAzNDY7CiAgdFsyODZdID0gMzQ3OwogIHRbMjkyXSA9IDM2NzsKICB0WzI5NV0gPSAzNzc7CiAgdFsyOTZdID0gMzc4OwogIHRbMjk4XSA9IDM4MDsKICB0WzMwNV0gPSA5NjM7CiAgdFszMDZdID0gOTY0OwogIHRbMzA3XSA9IDk2NjsKICB0WzMwOF0gPSA4MjE1OwogIHRbMzA5XSA9IDgyNTI7CiAgdFszMTBdID0gODMxOTsKICB0WzMxMV0gPSA4MzU5OwogIHRbMzEyXSA9IDg1OTI7CiAgdFszMTNdID0gODU5MzsKICB0WzMzN10gPSA5NTUyOwogIHRbNDkzXSA9IDEwMzk7CiAgdFs0OTRdID0gMTA0MDsKICB0WzY3Ml0gPSAxNDg4OwogIHRbNjczXSA9IDE0ODk7CiAgdFs2NzRdID0gMTQ5MDsKICB0WzY3NV0gPSAxNDkxOwogIHRbNjc2XSA9IDE0OTI7CiAgdFs2NzddID0gMTQ5MzsKICB0WzY3OF0gPSAxNDk0OwogIHRbNjc5XSA9IDE0OTU7CiAgdFs2ODBdID0gMTQ5NjsKICB0WzY4MV0gPSAxNDk3OwogIHRbNjgyXSA9IDE0OTg7CiAgdFs2ODNdID0gMTQ5OTsKICB0WzY4NF0gPSAxNTAwOwogIHRbNjg1XSA9IDE1MDE7CiAgdFs2ODZdID0gMTUwMjsKICB0WzY4N10gPSAxNTAzOwogIHRbNjg4XSA9IDE1MDQ7CiAgdFs2ODldID0gMTUwNTsKICB0WzY5MF0gPSAxNTA2OwogIHRbNjkxXSA9IDE1MDc7CiAgdFs2OTJdID0gMTUwODsKICB0WzY5M10gPSAxNTA5OwogIHRbNjk0XSA9IDE1MTA7CiAgdFs2OTVdID0gMTUxMTsKICB0WzY5Nl0gPSAxNTEyOwogIHRbNjk3XSA9IDE1MTM7CiAgdFs2OThdID0gMTUxNDsKICB0WzcwNV0gPSAxNTI0OwogIHRbNzA2XSA9IDgzNjI7CiAgdFs3MTBdID0gNjQyODg7CiAgdFs3MTFdID0gNjQyOTg7CiAgdFs3NTldID0gMTYxNzsKICB0Wzc2MV0gPSAxNzc2OwogIHRbNzYzXSA9IDE3Nzg7CiAgdFs3NzVdID0gMTY1MjsKICB0Wzc3N10gPSAxNzY0OwogIHRbNzc4XSA9IDE3ODA7CiAgdFs3NzldID0gMTc4MTsKICB0Wzc4MF0gPSAxNzgyOwogIHRbNzgyXSA9IDc3MTsKICB0Wzc4M10gPSA2NDcyNjsKICB0Wzc4Nl0gPSA4MzYzOwogIHRbNzg4XSA9IDg1MzI7CiAgdFs3OTBdID0gNzY4OwogIHRbNzkxXSA9IDc2OTsKICB0Wzc5Ml0gPSA3Njg7CiAgdFs3OTVdID0gODAzOwogIHRbNzk3XSA9IDY0MzM2OwogIHRbNzk4XSA9IDY0MzM3OwogIHRbNzk5XSA9IDY0MzQyOwogIHRbODAwXSA9IDY0MzQzOwogIHRbODAxXSA9IDY0MzQ0OwogIHRbODAyXSA9IDY0MzQ1OwogIHRbODAzXSA9IDY0MzYyOwogIHRbODA0XSA9IDY0MzYzOwogIHRbODA1XSA9IDY0MzY0OwogIHRbMjQyNF0gPSA3ODIxOwogIHRbMjQyNV0gPSA3ODIyOwogIHRbMjQyNl0gPSA3ODIzOwogIHRbMjQyN10gPSA3ODI0OwogIHRbMjQyOF0gPSA3ODI1OwogIHRbMjQyOV0gPSA3ODI2OwogIHRbMjQzMF0gPSA3ODI3OwogIHRbMjQzM10gPSA3NjgyOwogIHRbMjY3OF0gPSA4MDQ1OwogIHRbMjY3OV0gPSA4MDQ2OwogIHRbMjgzMF0gPSAxNTUyOwogIHRbMjgzOF0gPSA2ODY7CiAgdFsyODQwXSA9IDc1MTsKICB0WzI4NDJdID0gNzUzOwogIHRbMjg0M10gPSA3NTQ7CiAgdFsyODQ0XSA9IDc1NTsKICB0WzI4NDZdID0gNzU3OwogIHRbMjg1Nl0gPSA3Njc7CiAgdFsyODU3XSA9IDg0ODsKICB0WzI4NThdID0gODQ5OwogIHRbMjg2Ml0gPSA4NTM7CiAgdFsyODYzXSA9IDg1NDsKICB0WzI4NjRdID0gODU1OwogIHRbMjg2NV0gPSA4NjE7CiAgdFsyODY2XSA9IDg2MjsKICB0WzI5MDZdID0gNzQ2MDsKICB0WzI5MDhdID0gNzQ2MjsKICB0WzI5MDldID0gNzQ2MzsKICB0WzI5MTBdID0gNzQ2NDsKICB0WzI5MTJdID0gNzQ2NjsKICB0WzI5MTNdID0gNzQ2NzsKICB0WzI5MTRdID0gNzQ2ODsKICB0WzI5MTZdID0gNzQ3MDsKICB0WzI5MTddID0gNzQ3MTsKICB0WzI5MThdID0gNzQ3MjsKICB0WzI5MjBdID0gNzQ3NDsKICB0WzI5MjFdID0gNzQ3NTsKICB0WzI5MjJdID0gNzQ3NjsKICB0WzI5MjRdID0gNzQ3ODsKICB0WzI5MjVdID0gNzQ3OTsKICB0WzI5MjZdID0gNzQ4MDsKICB0WzI5MjhdID0gNzQ4MjsKICB0WzI5MjldID0gNzQ4MzsKICB0WzI5MzBdID0gNzQ4NDsKICB0WzI5MzJdID0gNzQ4NjsKICB0WzI5MzNdID0gNzQ4NzsKICB0WzI5MzRdID0gNzQ4ODsKICB0WzI5MzZdID0gNzQ5MDsKICB0WzI5MzddID0gNzQ5MTsKICB0WzI5MzhdID0gNzQ5MjsKICB0WzI5NDBdID0gNzQ5NDsKICB0WzI5NDFdID0gNzQ5NTsKICB0WzI5NDJdID0gNzQ5NjsKICB0WzI5NDRdID0gNzQ5ODsKICB0WzI5NDZdID0gNzUwMDsKICB0WzI5NDhdID0gNzUwMjsKICB0WzI5NTBdID0gNzUwNDsKICB0WzI5NTFdID0gNzUwNTsKICB0WzI5NTJdID0gNzUwNjsKICB0WzI5NTRdID0gNzUwODsKICB0WzI5NTVdID0gNzUwOTsKICB0WzI5NTZdID0gNzUxMDsKICB0WzI5NThdID0gNzUxMjsKICB0WzI5NTldID0gNzUxMzsKICB0WzI5NjBdID0gNzUxNDsKICB0WzI5NjJdID0gNzUxNjsKICB0WzI5NjNdID0gNzUxNzsKICB0WzI5NjRdID0gNzUxODsKICB0WzI5NjZdID0gNzUyMDsKICB0WzI5NjddID0gNzUyMTsKICB0WzI5NjhdID0gNzUyMjsKICB0WzI5NzBdID0gNzUyNDsKICB0WzI5NzFdID0gNzUyNTsKICB0WzI5NzJdID0gNzUyNjsKICB0WzI5NzRdID0gNzUyODsKICB0WzI5NzVdID0gNzUyOTsKICB0WzI5NzZdID0gNzUzMDsKICB0WzI5NzhdID0gMTUzNzsKICB0WzI5NzldID0gMTUzODsKICB0WzI5ODBdID0gMTUzOTsKICB0WzI5ODJdID0gMTU0OTsKICB0WzI5ODNdID0gMTU1MTsKICB0WzI5ODRdID0gMTU1MjsKICB0WzI5ODZdID0gMTU1NDsKICB0WzI5ODddID0gMTU1NTsKICB0WzI5ODhdID0gMTU1NjsKICB0WzI5OTBdID0gMTYyMzsKICB0WzI5OTFdID0gMTYyNDsKICB0WzI5OTVdID0gMTc3NTsKICB0WzI5OTldID0gMTc5MTsKICB0WzMwMDJdID0gNjQyOTA7CiAgdFszMDAzXSA9IDY0MjkxOwogIHRbMzAwNF0gPSA2NDI5MjsKICB0WzMwMDZdID0gNjQyOTQ7CiAgdFszMDA3XSA9IDY0Mjk1OwogIHRbMzAwOF0gPSA2NDI5NjsKICB0WzMwMTFdID0gMTkwMDsKICB0WzMwMTRdID0gODIyMzsKICB0WzMwMTVdID0gODI0NDsKICB0WzMwMTddID0gNzUzMjsKICB0WzMwMThdID0gNzUzMzsKICB0WzMwMTldID0gNzUzNDsKICB0WzMwNzVdID0gNzU5MDsKICB0WzMwNzZdID0gNzU5MTsKICB0WzMwNzldID0gNzU5NDsKICB0WzMwODBdID0gNzU5NTsKICB0WzMwODNdID0gNzU5ODsKICB0WzMwODRdID0gNzU5OTsKICB0WzMwODddID0gNzYwMjsKICB0WzMwODhdID0gNzYwMzsKICB0WzMwOTFdID0gNzYwNjsKICB0WzMwOTJdID0gNzYwNzsKICB0WzMwOTVdID0gNzYxMDsKICB0WzMwOTZdID0gNzYxMTsKICB0WzMwOTldID0gNzYxNDsKICB0WzMxMDBdID0gNzYxNTsKICB0WzMxMDNdID0gNzYxODsKICB0WzMxMDRdID0gNzYxOTsKICB0WzMxMDddID0gODMzNzsKICB0WzMxMDhdID0gODMzODsKICB0WzMxMTZdID0gMTg4NDsKICB0WzMxMTldID0gMTg4NTsKICB0WzMxMjBdID0gMTg4NTsKICB0WzMxMjNdID0gMTg4NjsKICB0WzMxMjRdID0gMTg4NjsKICB0WzMxMjddID0gMTg4NzsKICB0WzMxMjhdID0gMTg4NzsKICB0WzMxMzFdID0gMTg4ODsKICB0WzMxMzJdID0gMTg4ODsKICB0WzMxMzVdID0gMTg4OTsKICB0WzMxMzZdID0gMTg4OTsKICB0WzMxMzldID0gMTg5MDsKICB0WzMxNDBdID0gMTg5MDsKICB0WzMxNDNdID0gMTg5MTsKICB0WzMxNDRdID0gMTg5MTsKICB0WzMxNDddID0gMTg5MjsKICB0WzMxNDhdID0gMTg5MjsKICB0WzMxNTNdID0gNTgwOwogIHRbMzE1NF0gPSA1ODE7CiAgdFszMTU3XSA9IDU4NDsKICB0WzMxNThdID0gNTg1OwogIHRbMzE2MV0gPSA1ODg7CiAgdFszMTYyXSA9IDU4OTsKICB0WzMxNjVdID0gODkxOwogIHRbMzE2Nl0gPSA4OTI7CiAgdFszMTY5XSA9IDEyNzQ7CiAgdFszMTcwXSA9IDEyNzU7CiAgdFszMTczXSA9IDEyNzg7CiAgdFszMTc0XSA9IDEyNzk7CiAgdFszMTgxXSA9IDc2MjI7CiAgdFszMTgyXSA9IDc2MjM7CiAgdFszMjgyXSA9IDExNzk5OwogIHRbMzMxNl0gPSA1Nzg7CiAgdFszMzc5XSA9IDQyNzg1OwogIHRbMzM5M10gPSAxMTU5OwogIHRbMzQxNl0gPSA4Mzc3Owp9KTsKZXhwb3J0cy5nZXRHbHlwaE1hcEZvclN0YW5kYXJkRm9udHMgPSBnZXRHbHlwaE1hcEZvclN0YW5kYXJkRm9udHM7CmNvbnN0IGdldFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQXJpYWxCbGFjayA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgdFsyMjddID0gMzIyOwogIHRbMjY0XSA9IDI2MTsKICB0WzI5MV0gPSAzNDY7Cn0pOwpleHBvcnRzLmdldFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQXJpYWxCbGFjayA9IGdldFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQXJpYWxCbGFjazsKY29uc3QgZ2V0U3VwcGxlbWVudGFsR2x5cGhNYXBGb3JDYWxpYnJpID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0WzFdID0gMzI7CiAgdFs0XSA9IDY1OwogIHRbNl0gPSAxOTM7CiAgdFsxN10gPSA2NjsKICB0WzE4XSA9IDY3OwogIHRbMjFdID0gMjY4OwogIHRbMjRdID0gNjg7CiAgdFsyOF0gPSA2OTsKICB0WzMwXSA9IDIwMTsKICB0WzMyXSA9IDI4MjsKICB0WzM4XSA9IDcwOwogIHRbMzldID0gNzE7CiAgdFs0NF0gPSA3MjsKICB0WzQ3XSA9IDczOwogIHRbNDldID0gMjA1OwogIHRbNThdID0gNzQ7CiAgdFs2MF0gPSA3NTsKICB0WzYyXSA9IDc2OwogIHRbNjhdID0gNzc7CiAgdFs2OV0gPSA3ODsKICB0Wzc1XSA9IDc5OwogIHRbODddID0gODA7CiAgdFs4OV0gPSA4MTsKICB0WzkwXSA9IDgyOwogIHRbOTJdID0gMzQ0OwogIHRbOTRdID0gODM7CiAgdFs5N10gPSAzNTI7CiAgdFsxMDBdID0gODQ7CiAgdFsxMDRdID0gODU7CiAgdFsxMTVdID0gODY7CiAgdFsxMTZdID0gODc7CiAgdFsxMjFdID0gODg7CiAgdFsxMjJdID0gODk7CiAgdFsxMjRdID0gMjIxOwogIHRbMTI3XSA9IDkwOwogIHRbMTI5XSA9IDM4MTsKICB0WzI1OF0gPSA5NzsKICB0WzI2MF0gPSAyMjU7CiAgdFsyNjhdID0gMjYxOwogIHRbMjcxXSA9IDk4OwogIHRbMjcyXSA9IDk5OwogIHRbMjczXSA9IDI2MzsKICB0WzI3NV0gPSAyNjk7CiAgdFsyODJdID0gMTAwOwogIHRbMjg2XSA9IDEwMTsKICB0WzI4OF0gPSAyMzM7CiAgdFsyOTBdID0gMjgzOwogIHRbMjk1XSA9IDI4MTsKICB0WzI5Nl0gPSAxMDI7CiAgdFszMzZdID0gMTAzOwogIHRbMzQ2XSA9IDEwNDsKICB0WzM0OV0gPSAxMDU7CiAgdFszNTFdID0gMjM3OwogIHRbMzYxXSA9IDEwNjsKICB0WzM2NF0gPSAxMDc7CiAgdFszNjddID0gMTA4OwogIHRbMzcxXSA9IDMyMjsKICB0WzM3M10gPSAxMDk7CiAgdFszNzRdID0gMTEwOwogIHRbMzgxXSA9IDExMTsKICB0WzM4M10gPSAyNDM7CiAgdFszOTNdID0gMTEyOwogIHRbMzk1XSA9IDExMzsKICB0WzM5Nl0gPSAxMTQ7CiAgdFszOThdID0gMzQ1OwogIHRbNDAwXSA9IDExNTsKICB0WzQwMV0gPSAzNDc7CiAgdFs0MDNdID0gMzUzOwogIHRbNDEwXSA9IDExNjsKICB0WzQzN10gPSAxMTc7CiAgdFs0NDhdID0gMTE4OwogIHRbNDQ5XSA9IDExOTsKICB0WzQ1NF0gPSAxMjA7CiAgdFs0NTVdID0gMTIxOwogIHRbNDU3XSA9IDI1MzsKICB0WzQ2MF0gPSAxMjI7CiAgdFs0NjJdID0gMzgyOwogIHRbNDYzXSA9IDM4MDsKICB0Wzg1M10gPSA0NDsKICB0Wzg1NV0gPSA1ODsKICB0Wzg1Nl0gPSA0NjsKICB0Wzg3Nl0gPSA0NzsKICB0Wzg3OF0gPSA0NTsKICB0Wzg4Ml0gPSA0NTsKICB0Wzg5NF0gPSA0MDsKICB0Wzg5NV0gPSA0MTsKICB0Wzg5Nl0gPSA5MTsKICB0Wzg5N10gPSA5MzsKICB0WzkyM10gPSA2NDsKICB0WzEwMDRdID0gNDg7CiAgdFsxMDA1XSA9IDQ5OwogIHRbMTAwNl0gPSA1MDsKICB0WzEwMDddID0gNTE7CiAgdFsxMDA4XSA9IDUyOwogIHRbMTAwOV0gPSA1MzsKICB0WzEwMTBdID0gNTQ7CiAgdFsxMDExXSA9IDU1OwogIHRbMTAxMl0gPSA1NjsKICB0WzEwMTNdID0gNTc7CiAgdFsxMDgxXSA9IDM3OwogIHRbMTA4NV0gPSA0MzsKICB0WzEwODZdID0gNDU7Cn0pOwpleHBvcnRzLmdldFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQ2FsaWJyaSA9IGdldFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQ2FsaWJyaTsKCmZ1bmN0aW9uIGdldFN0YW5kYXJkRm9udE5hbWUobmFtZSkgewogIGNvbnN0IGZvbnROYW1lID0gKDAsIF9mb250c191dGlscy5ub3JtYWxpemVGb250TmFtZSkobmFtZSk7CiAgY29uc3Qgc3RkRm9udE1hcCA9IGdldFN0ZEZvbnRNYXAoKTsKICByZXR1cm4gc3RkRm9udE1hcFtmb250TmFtZV07Cn0KCi8qKiovIH0pLAovKiAxNjcgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlRvVW5pY29kZU1hcCA9IGV4cG9ydHMuSWRlbnRpdHlUb1VuaWNvZGVNYXAgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY2xhc3MgVG9Vbmljb2RlTWFwIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIGxldCBjbWFwID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBbXTsKICAgIHRoaXMuX21hcCA9IGNtYXA7CiAgfQoKICBnZXQgbGVuZ3RoKCkgewogICAgcmV0dXJuIHRoaXMuX21hcC5sZW5ndGg7CiAgfQoKICBmb3JFYWNoKGNhbGxiYWNrKSB7CiAgICBmb3IgKGNvbnN0IGNoYXJDb2RlIGluIHRoaXMuX21hcCkgewogICAgICBjYWxsYmFjayhjaGFyQ29kZSwgdGhpcy5fbWFwW2NoYXJDb2RlXS5jaGFyQ29kZUF0KDApKTsKICAgIH0KICB9CgogIGhhcyhpKSB7CiAgICByZXR1cm4gdGhpcy5fbWFwW2ldICE9PSB1bmRlZmluZWQ7CiAgfQoKICBnZXQoaSkgewogICAgcmV0dXJuIHRoaXMuX21hcFtpXTsKICB9CgogIGNoYXJDb2RlT2YodmFsdWUpIHsKICAgIGNvbnN0IG1hcCA9IHRoaXMuX21hcDsKCiAgICBpZiAobWFwLmxlbmd0aCA8PSAweDEwMDAwKSB7CiAgICAgIHJldHVybiBtYXAuaW5kZXhPZih2YWx1ZSk7CiAgICB9CgogICAgZm9yIChjb25zdCBjaGFyQ29kZSBpbiBtYXApIHsKICAgICAgaWYgKG1hcFtjaGFyQ29kZV0gPT09IHZhbHVlKSB7CiAgICAgICAgcmV0dXJuIGNoYXJDb2RlIHwgMDsKICAgICAgfQogICAgfQoKICAgIHJldHVybiAtMTsKICB9CgogIGFtZW5kKG1hcCkgewogICAgZm9yIChjb25zdCBjaGFyQ29kZSBpbiBtYXApIHsKICAgICAgdGhpcy5fbWFwW2NoYXJDb2RlXSA9IG1hcFtjaGFyQ29kZV07CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5Ub1VuaWNvZGVNYXAgPSBUb1VuaWNvZGVNYXA7CgpjbGFzcyBJZGVudGl0eVRvVW5pY29kZU1hcCB7CiAgY29uc3RydWN0b3IoZmlyc3RDaGFyLCBsYXN0Q2hhcikgewogICAgdGhpcy5maXJzdENoYXIgPSBmaXJzdENoYXI7CiAgICB0aGlzLmxhc3RDaGFyID0gbGFzdENoYXI7CiAgfQoKICBnZXQgbGVuZ3RoKCkgewogICAgcmV0dXJuIHRoaXMubGFzdENoYXIgKyAxIC0gdGhpcy5maXJzdENoYXI7CiAgfQoKICBmb3JFYWNoKGNhbGxiYWNrKSB7CiAgICBmb3IgKGxldCBpID0gdGhpcy5maXJzdENoYXIsIGlpID0gdGhpcy5sYXN0Q2hhcjsgaSA8PSBpaTsgaSsrKSB7CiAgICAgIGNhbGxiYWNrKGksIGkpOwogICAgfQogIH0KCiAgaGFzKGkpIHsKICAgIHJldHVybiB0aGlzLmZpcnN0Q2hhciA8PSBpICYmIGkgPD0gdGhpcy5sYXN0Q2hhcjsKICB9CgogIGdldChpKSB7CiAgICBpZiAodGhpcy5maXJzdENoYXIgPD0gaSAmJiBpIDw9IHRoaXMubGFzdENoYXIpIHsKICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoaSk7CiAgICB9CgogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIGNoYXJDb2RlT2YodikgewogICAgcmV0dXJuIE51bWJlci5pc0ludGVnZXIodikgJiYgdiA+PSB0aGlzLmZpcnN0Q2hhciAmJiB2IDw9IHRoaXMubGFzdENoYXIgPyB2IDogLTE7CiAgfQoKICBhbWVuZChtYXApIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIlNob3VsZCBub3QgY2FsbCBhbWVuZCgpIik7CiAgfQoKfQoKZXhwb3J0cy5JZGVudGl0eVRvVW5pY29kZU1hcCA9IElkZW50aXR5VG9Vbmljb2RlTWFwOwoKLyoqKi8gfSksCi8qIDE2OCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuQ0ZGRm9udCA9IHZvaWQgMDsKCnZhciBfY2ZmX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTYwKTsKCnZhciBfZm9udHNfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2Myk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY2xhc3MgQ0ZGRm9udCB7CiAgY29uc3RydWN0b3IoZmlsZSwgcHJvcGVydGllcykgewogICAgdGhpcy5wcm9wZXJ0aWVzID0gcHJvcGVydGllczsKICAgIGNvbnN0IHBhcnNlciA9IG5ldyBfY2ZmX3BhcnNlci5DRkZQYXJzZXIoZmlsZSwgcHJvcGVydGllcywgX2ZvbnRzX3V0aWxzLlNFQUNfQU5BTFlTSVNfRU5BQkxFRCk7CiAgICB0aGlzLmNmZiA9IHBhcnNlci5wYXJzZSgpOwogICAgdGhpcy5jZmYuZHVwbGljYXRlRmlyc3RHbHlwaCgpOwogICAgY29uc3QgY29tcGlsZXIgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGQ29tcGlsZXIodGhpcy5jZmYpOwogICAgdGhpcy5zZWFjcyA9IHRoaXMuY2ZmLnNlYWNzOwoKICAgIHRyeSB7CiAgICAgIHRoaXMuZGF0YSA9IGNvbXBpbGVyLmNvbXBpbGUoKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJGYWlsZWQgdG8gY29tcGlsZSBmb250ICIgKyBwcm9wZXJ0aWVzLmxvYWRlZE5hbWUpOwogICAgICB0aGlzLmRhdGEgPSBmaWxlOwogICAgfQoKICAgIHRoaXMuX2NyZWF0ZUJ1aWx0SW5FbmNvZGluZygpOwogIH0KCiAgZ2V0IG51bUdseXBocygpIHsKICAgIHJldHVybiB0aGlzLmNmZi5jaGFyU3RyaW5ncy5jb3VudDsKICB9CgogIGdldENoYXJzZXQoKSB7CiAgICByZXR1cm4gdGhpcy5jZmYuY2hhcnNldC5jaGFyc2V0OwogIH0KCiAgZ2V0R2x5cGhNYXBwaW5nKCkgewogICAgY29uc3QgY2ZmID0gdGhpcy5jZmY7CiAgICBjb25zdCBwcm9wZXJ0aWVzID0gdGhpcy5wcm9wZXJ0aWVzOwogICAgY29uc3QgY2hhcnNldHMgPSBjZmYuY2hhcnNldC5jaGFyc2V0OwogICAgbGV0IGNoYXJDb2RlVG9HbHlwaElkOwogICAgbGV0IGdseXBoSWQ7CgogICAgaWYgKHByb3BlcnRpZXMuY29tcG9zaXRlKSB7CiAgICAgIGNoYXJDb2RlVG9HbHlwaElkID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgbGV0IGNoYXJDb2RlOwoKICAgICAgaWYgKGNmZi5pc0NJREZvbnQpIHsKICAgICAgICBmb3IgKGdseXBoSWQgPSAwOyBnbHlwaElkIDwgY2hhcnNldHMubGVuZ3RoOyBnbHlwaElkKyspIHsKICAgICAgICAgIGNvbnN0IGNpZCA9IGNoYXJzZXRzW2dseXBoSWRdOwogICAgICAgICAgY2hhckNvZGUgPSBwcm9wZXJ0aWVzLmNNYXAuY2hhckNvZGVPZihjaWQpOwogICAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChnbHlwaElkID0gMDsgZ2x5cGhJZCA8IGNmZi5jaGFyU3RyaW5ncy5jb3VudDsgZ2x5cGhJZCsrKSB7CiAgICAgICAgICBjaGFyQ29kZSA9IHByb3BlcnRpZXMuY01hcC5jaGFyQ29kZU9mKGdseXBoSWQpOwogICAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBjaGFyQ29kZVRvR2x5cGhJZDsKICAgIH0KCiAgICBsZXQgZW5jb2RpbmcgPSBjZmYuZW5jb2RpbmcgPyBjZmYuZW5jb2RpbmcuZW5jb2RpbmcgOiBudWxsOwoKICAgIGlmIChwcm9wZXJ0aWVzLmlzSW50ZXJuYWxGb250KSB7CiAgICAgIGVuY29kaW5nID0gcHJvcGVydGllcy5kZWZhdWx0RW5jb2Rpbmc7CiAgICB9CgogICAgY2hhckNvZGVUb0dseXBoSWQgPSAoMCwgX2ZvbnRzX3V0aWxzLnR5cGUxRm9udEdseXBoTWFwcGluZykocHJvcGVydGllcywgZW5jb2RpbmcsIGNoYXJzZXRzKTsKICAgIHJldHVybiBjaGFyQ29kZVRvR2x5cGhJZDsKICB9CgogIGhhc0dseXBoSWQoaWQpIHsKICAgIHJldHVybiB0aGlzLmNmZi5oYXNHbHlwaElkKGlkKTsKICB9CgogIF9jcmVhdGVCdWlsdEluRW5jb2RpbmcoKSB7CiAgICBjb25zdCB7CiAgICAgIGNoYXJzZXQsCiAgICAgIGVuY29kaW5nCiAgICB9ID0gdGhpcy5jZmY7CgogICAgaWYgKCFjaGFyc2V0IHx8ICFlbmNvZGluZykgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgY2hhcnNldHMgPSBjaGFyc2V0LmNoYXJzZXQsCiAgICAgICAgICBlbmNvZGluZ3MgPSBlbmNvZGluZy5lbmNvZGluZzsKICAgIGNvbnN0IG1hcCA9IFtdOwoKICAgIGZvciAoY29uc3QgY2hhckNvZGUgaW4gZW5jb2RpbmdzKSB7CiAgICAgIGNvbnN0IGdseXBoSWQgPSBlbmNvZGluZ3NbY2hhckNvZGVdOwoKICAgICAgaWYgKGdseXBoSWQgPj0gMCkgewogICAgICAgIGNvbnN0IGdseXBoTmFtZSA9IGNoYXJzZXRzW2dseXBoSWRdOwoKICAgICAgICBpZiAoZ2x5cGhOYW1lKSB7CiAgICAgICAgICBtYXBbY2hhckNvZGVdID0gZ2x5cGhOYW1lOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChtYXAubGVuZ3RoID4gMCkgewogICAgICB0aGlzLnByb3BlcnRpZXMuYnVpbHRJbkVuY29kaW5nID0gbWFwOwogICAgfQogIH0KCn0KCmV4cG9ydHMuQ0ZGRm9udCA9IENGRkZvbnQ7CgovKioqLyB9KSwKLyogMTY5ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Gb250UmVuZGVyZXJGYWN0b3J5ID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfY2ZmX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTYwKTsKCnZhciBfZ2x5cGhsaXN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjQpOwoKdmFyIF9lbmNvZGluZ3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2Mik7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTM1KTsKCmZ1bmN0aW9uIGdldFVpbnQzMihkYXRhLCBvZmZzZXQpIHsKICByZXR1cm4gKGRhdGFbb2Zmc2V0XSA8PCAyNCB8IGRhdGFbb2Zmc2V0ICsgMV0gPDwgMTYgfCBkYXRhW29mZnNldCArIDJdIDw8IDggfCBkYXRhW29mZnNldCArIDNdKSA+Pj4gMDsKfQoKZnVuY3Rpb24gZ2V0VWludDE2KGRhdGEsIG9mZnNldCkgewogIHJldHVybiBkYXRhW29mZnNldF0gPDwgOCB8IGRhdGFbb2Zmc2V0ICsgMV07Cn0KCmZ1bmN0aW9uIGdldEludDE2KGRhdGEsIG9mZnNldCkgewogIHJldHVybiAoZGF0YVtvZmZzZXRdIDw8IDI0IHwgZGF0YVtvZmZzZXQgKyAxXSA8PCAxNikgPj4gMTY7Cn0KCmZ1bmN0aW9uIGdldEludDgoZGF0YSwgb2Zmc2V0KSB7CiAgcmV0dXJuIGRhdGFbb2Zmc2V0XSA8PCAyNCA+PiAyNDsKfQoKZnVuY3Rpb24gZ2V0RmxvYXQyMTQoZGF0YSwgb2Zmc2V0KSB7CiAgcmV0dXJuIGdldEludDE2KGRhdGEsIG9mZnNldCkgLyAxNjM4NDsKfQoKZnVuY3Rpb24gZ2V0U3Vicm91dGluZUJpYXMoc3VicnMpIHsKICBjb25zdCBudW1TdWJycyA9IHN1YnJzLmxlbmd0aDsKICBsZXQgYmlhcyA9IDMyNzY4OwoKICBpZiAobnVtU3VicnMgPCAxMjQwKSB7CiAgICBiaWFzID0gMTA3OwogIH0gZWxzZSBpZiAobnVtU3VicnMgPCAzMzkwMCkgewogICAgYmlhcyA9IDExMzE7CiAgfQoKICByZXR1cm4gYmlhczsKfQoKZnVuY3Rpb24gcGFyc2VDbWFwKGRhdGEsIHN0YXJ0LCBlbmQpIHsKICBjb25zdCBvZmZzZXQgPSBnZXRVaW50MTYoZGF0YSwgc3RhcnQgKyAyKSA9PT0gMSA/IGdldFVpbnQzMihkYXRhLCBzdGFydCArIDgpIDogZ2V0VWludDMyKGRhdGEsIHN0YXJ0ICsgMTYpOwogIGNvbnN0IGZvcm1hdCA9IGdldFVpbnQxNihkYXRhLCBzdGFydCArIG9mZnNldCk7CiAgbGV0IHJhbmdlcywgcCwgaTsKCiAgaWYgKGZvcm1hdCA9PT0gNCkgewogICAgZ2V0VWludDE2KGRhdGEsIHN0YXJ0ICsgb2Zmc2V0ICsgMik7CiAgICBjb25zdCBzZWdDb3VudCA9IGdldFVpbnQxNihkYXRhLCBzdGFydCArIG9mZnNldCArIDYpID4+IDE7CiAgICBwID0gc3RhcnQgKyBvZmZzZXQgKyAxNDsKICAgIHJhbmdlcyA9IFtdOwoKICAgIGZvciAoaSA9IDA7IGkgPCBzZWdDb3VudDsgaSsrLCBwICs9IDIpIHsKICAgICAgcmFuZ2VzW2ldID0gewogICAgICAgIGVuZDogZ2V0VWludDE2KGRhdGEsIHApCiAgICAgIH07CiAgICB9CgogICAgcCArPSAyOwoKICAgIGZvciAoaSA9IDA7IGkgPCBzZWdDb3VudDsgaSsrLCBwICs9IDIpIHsKICAgICAgcmFuZ2VzW2ldLnN0YXJ0ID0gZ2V0VWludDE2KGRhdGEsIHApOwogICAgfQoKICAgIGZvciAoaSA9IDA7IGkgPCBzZWdDb3VudDsgaSsrLCBwICs9IDIpIHsKICAgICAgcmFuZ2VzW2ldLmlkRGVsdGEgPSBnZXRVaW50MTYoZGF0YSwgcCk7CiAgICB9CgogICAgZm9yIChpID0gMDsgaSA8IHNlZ0NvdW50OyBpKyssIHAgKz0gMikgewogICAgICBsZXQgaWRPZmZzZXQgPSBnZXRVaW50MTYoZGF0YSwgcCk7CgogICAgICBpZiAoaWRPZmZzZXQgPT09IDApIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgcmFuZ2VzW2ldLmlkcyA9IFtdOwoKICAgICAgZm9yIChsZXQgaiA9IDAsIGpqID0gcmFuZ2VzW2ldLmVuZCAtIHJhbmdlc1tpXS5zdGFydCArIDE7IGogPCBqajsgaisrKSB7CiAgICAgICAgcmFuZ2VzW2ldLmlkc1tqXSA9IGdldFVpbnQxNihkYXRhLCBwICsgaWRPZmZzZXQpOwogICAgICAgIGlkT2Zmc2V0ICs9IDI7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcmFuZ2VzOwogIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAxMikgewogICAgY29uc3QgZ3JvdXBzID0gZ2V0VWludDMyKGRhdGEsIHN0YXJ0ICsgb2Zmc2V0ICsgMTIpOwogICAgcCA9IHN0YXJ0ICsgb2Zmc2V0ICsgMTY7CiAgICByYW5nZXMgPSBbXTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgZ3JvdXBzOyBpKyspIHsKICAgICAgc3RhcnQgPSBnZXRVaW50MzIoZGF0YSwgcCk7CiAgICAgIHJhbmdlcy5wdXNoKHsKICAgICAgICBzdGFydCwKICAgICAgICBlbmQ6IGdldFVpbnQzMihkYXRhLCBwICsgNCksCiAgICAgICAgaWREZWx0YTogZ2V0VWludDMyKGRhdGEsIHAgKyA4KSAtIHN0YXJ0CiAgICAgIH0pOwogICAgICBwICs9IDEyOwogICAgfQoKICAgIHJldHVybiByYW5nZXM7CiAgfQoKICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYHVuc3VwcG9ydGVkIGNtYXA6ICR7Zm9ybWF0fWApOwp9CgpmdW5jdGlvbiBwYXJzZUNmZihkYXRhLCBzdGFydCwgZW5kLCBzZWFjQW5hbHlzaXNFbmFibGVkKSB7CiAgY29uc3QgcHJvcGVydGllcyA9IHt9OwogIGNvbnN0IHBhcnNlciA9IG5ldyBfY2ZmX3BhcnNlci5DRkZQYXJzZXIobmV3IF9zdHJlYW0uU3RyZWFtKGRhdGEsIHN0YXJ0LCBlbmQgLSBzdGFydCksIHByb3BlcnRpZXMsIHNlYWNBbmFseXNpc0VuYWJsZWQpOwogIGNvbnN0IGNmZiA9IHBhcnNlci5wYXJzZSgpOwogIHJldHVybiB7CiAgICBnbHlwaHM6IGNmZi5jaGFyU3RyaW5ncy5vYmplY3RzLAogICAgc3VicnM6IGNmZi50b3BEaWN0LnByaXZhdGVEaWN0ICYmIGNmZi50b3BEaWN0LnByaXZhdGVEaWN0LnN1YnJzSW5kZXggJiYgY2ZmLnRvcERpY3QucHJpdmF0ZURpY3Quc3VicnNJbmRleC5vYmplY3RzLAogICAgZ3N1YnJzOiBjZmYuZ2xvYmFsU3VickluZGV4ICYmIGNmZi5nbG9iYWxTdWJySW5kZXgub2JqZWN0cywKICAgIGlzQ0ZGQ0lERm9udDogY2ZmLmlzQ0lERm9udCwKICAgIGZkU2VsZWN0OiBjZmYuZmRTZWxlY3QsCiAgICBmZEFycmF5OiBjZmYuZmRBcnJheQogIH07Cn0KCmZ1bmN0aW9uIHBhcnNlR2x5ZlRhYmxlKGdseWYsIGxvY2EsIGlzR2x5cGhMb2NhdGlvbnNMb25nKSB7CiAgbGV0IGl0ZW1TaXplLCBpdGVtRGVjb2RlOwoKICBpZiAoaXNHbHlwaExvY2F0aW9uc0xvbmcpIHsKICAgIGl0ZW1TaXplID0gNDsKICAgIGl0ZW1EZWNvZGUgPSBnZXRVaW50MzI7CiAgfSBlbHNlIHsKICAgIGl0ZW1TaXplID0gMjsKCiAgICBpdGVtRGVjb2RlID0gKGRhdGEsIG9mZnNldCkgPT4gMiAqIGdldFVpbnQxNihkYXRhLCBvZmZzZXQpOwogIH0KCiAgY29uc3QgZ2x5cGhzID0gW107CiAgbGV0IHN0YXJ0T2Zmc2V0ID0gaXRlbURlY29kZShsb2NhLCAwKTsKCiAgZm9yIChsZXQgaiA9IGl0ZW1TaXplOyBqIDwgbG9jYS5sZW5ndGg7IGogKz0gaXRlbVNpemUpIHsKICAgIGNvbnN0IGVuZE9mZnNldCA9IGl0ZW1EZWNvZGUobG9jYSwgaik7CiAgICBnbHlwaHMucHVzaChnbHlmLnN1YmFycmF5KHN0YXJ0T2Zmc2V0LCBlbmRPZmZzZXQpKTsKICAgIHN0YXJ0T2Zmc2V0ID0gZW5kT2Zmc2V0OwogIH0KCiAgcmV0dXJuIGdseXBoczsKfQoKZnVuY3Rpb24gbG9va3VwQ21hcChyYW5nZXMsIHVuaWNvZGUpIHsKICBjb25zdCBjb2RlID0gdW5pY29kZS5jb2RlUG9pbnRBdCgwKTsKICBsZXQgZ2lkID0gMCwKICAgICAgbCA9IDAsCiAgICAgIHIgPSByYW5nZXMubGVuZ3RoIC0gMTsKCiAgd2hpbGUgKGwgPCByKSB7CiAgICBjb25zdCBjID0gbCArIHIgKyAxID4+IDE7CgogICAgaWYgKGNvZGUgPCByYW5nZXNbY10uc3RhcnQpIHsKICAgICAgciA9IGMgLSAxOwogICAgfSBlbHNlIHsKICAgICAgbCA9IGM7CiAgICB9CiAgfQoKICBpZiAocmFuZ2VzW2xdLnN0YXJ0IDw9IGNvZGUgJiYgY29kZSA8PSByYW5nZXNbbF0uZW5kKSB7CiAgICBnaWQgPSByYW5nZXNbbF0uaWREZWx0YSArIChyYW5nZXNbbF0uaWRzID8gcmFuZ2VzW2xdLmlkc1tjb2RlIC0gcmFuZ2VzW2xdLnN0YXJ0XSA6IGNvZGUpICYgMHhmZmZmOwogIH0KCiAgcmV0dXJuIHsKICAgIGNoYXJDb2RlOiBjb2RlLAogICAgZ2x5cGhJZDogZ2lkCiAgfTsKfQoKZnVuY3Rpb24gY29tcGlsZUdseWYoY29kZSwgY21kcywgZm9udCkgewogIGZ1bmN0aW9uIG1vdmVUbyh4LCB5KSB7CiAgICBjbWRzLnB1c2goewogICAgICBjbWQ6ICJtb3ZlVG8iLAogICAgICBhcmdzOiBbeCwgeV0KICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gbGluZVRvKHgsIHkpIHsKICAgIGNtZHMucHVzaCh7CiAgICAgIGNtZDogImxpbmVUbyIsCiAgICAgIGFyZ3M6IFt4LCB5XQogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBxdWFkcmF0aWNDdXJ2ZVRvKHhhLCB5YSwgeCwgeSkgewogICAgY21kcy5wdXNoKHsKICAgICAgY21kOiAicXVhZHJhdGljQ3VydmVUbyIsCiAgICAgIGFyZ3M6IFt4YSwgeWEsIHgsIHldCiAgICB9KTsKICB9CgogIGxldCBpID0gMDsKICBjb25zdCBudW1iZXJPZkNvbnRvdXJzID0gZ2V0SW50MTYoY29kZSwgaSk7CiAgbGV0IGZsYWdzOwogIGxldCB4ID0gMCwKICAgICAgeSA9IDA7CiAgaSArPSAxMDsKCiAgaWYgKG51bWJlck9mQ29udG91cnMgPCAwKSB7CiAgICBkbyB7CiAgICAgIGZsYWdzID0gZ2V0VWludDE2KGNvZGUsIGkpOwogICAgICBjb25zdCBnbHlwaEluZGV4ID0gZ2V0VWludDE2KGNvZGUsIGkgKyAyKTsKICAgICAgaSArPSA0OwogICAgICBsZXQgYXJnMSwgYXJnMjsKCiAgICAgIGlmIChmbGFncyAmIDB4MDEpIHsKICAgICAgICBpZiAoZmxhZ3MgJiAweDAyKSB7CiAgICAgICAgICBhcmcxID0gZ2V0SW50MTYoY29kZSwgaSk7CiAgICAgICAgICBhcmcyID0gZ2V0SW50MTYoY29kZSwgaSArIDIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhcmcxID0gZ2V0VWludDE2KGNvZGUsIGkpOwogICAgICAgICAgYXJnMiA9IGdldFVpbnQxNihjb2RlLCBpICsgMik7CiAgICAgICAgfQoKICAgICAgICBpICs9IDQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGZsYWdzICYgMHgwMikgewogICAgICAgICAgYXJnMSA9IGdldEludDgoY29kZSwgaSsrKTsKICAgICAgICAgIGFyZzIgPSBnZXRJbnQ4KGNvZGUsIGkrKyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFyZzEgPSBjb2RlW2krK107CiAgICAgICAgICBhcmcyID0gY29kZVtpKytdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGZsYWdzICYgMHgwMikgewogICAgICAgIHggPSBhcmcxOwogICAgICAgIHkgPSBhcmcyOwogICAgICB9IGVsc2UgewogICAgICAgIHggPSAwOwogICAgICAgIHkgPSAwOwogICAgICB9CgogICAgICBsZXQgc2NhbGVYID0gMSwKICAgICAgICAgIHNjYWxlWSA9IDEsCiAgICAgICAgICBzY2FsZTAxID0gMCwKICAgICAgICAgIHNjYWxlMTAgPSAwOwoKICAgICAgaWYgKGZsYWdzICYgMHgwOCkgewogICAgICAgIHNjYWxlWCA9IHNjYWxlWSA9IGdldEZsb2F0MjE0KGNvZGUsIGkpOwogICAgICAgIGkgKz0gMjsKICAgICAgfSBlbHNlIGlmIChmbGFncyAmIDB4NDApIHsKICAgICAgICBzY2FsZVggPSBnZXRGbG9hdDIxNChjb2RlLCBpKTsKICAgICAgICBzY2FsZVkgPSBnZXRGbG9hdDIxNChjb2RlLCBpICsgMik7CiAgICAgICAgaSArPSA0OwogICAgICB9IGVsc2UgaWYgKGZsYWdzICYgMHg4MCkgewogICAgICAgIHNjYWxlWCA9IGdldEZsb2F0MjE0KGNvZGUsIGkpOwogICAgICAgIHNjYWxlMDEgPSBnZXRGbG9hdDIxNChjb2RlLCBpICsgMik7CiAgICAgICAgc2NhbGUxMCA9IGdldEZsb2F0MjE0KGNvZGUsIGkgKyA0KTsKICAgICAgICBzY2FsZVkgPSBnZXRGbG9hdDIxNChjb2RlLCBpICsgNik7CiAgICAgICAgaSArPSA4OwogICAgICB9CgogICAgICBjb25zdCBzdWJnbHlwaCA9IGZvbnQuZ2x5cGhzW2dseXBoSW5kZXhdOwoKICAgICAgaWYgKHN1YmdseXBoKSB7CiAgICAgICAgY21kcy5wdXNoKHsKICAgICAgICAgIGNtZDogInNhdmUiCiAgICAgICAgfSwgewogICAgICAgICAgY21kOiAidHJhbnNmb3JtIiwKICAgICAgICAgIGFyZ3M6IFtzY2FsZVgsIHNjYWxlMDEsIHNjYWxlMTAsIHNjYWxlWSwgeCwgeV0KICAgICAgICB9KTsKCiAgICAgICAgaWYgKCEoZmxhZ3MgJiAweDAyKSkge30KCiAgICAgICAgY29tcGlsZUdseWYoc3ViZ2x5cGgsIGNtZHMsIGZvbnQpOwogICAgICAgIGNtZHMucHVzaCh7CiAgICAgICAgICBjbWQ6ICJyZXN0b3JlIgogICAgICAgIH0pOwogICAgICB9CiAgICB9IHdoaWxlIChmbGFncyAmIDB4MjApOwogIH0gZWxzZSB7CiAgICBjb25zdCBlbmRQdHNPZkNvbnRvdXJzID0gW107CiAgICBsZXQgaiwgamo7CgogICAgZm9yIChqID0gMDsgaiA8IG51bWJlck9mQ29udG91cnM7IGorKykgewogICAgICBlbmRQdHNPZkNvbnRvdXJzLnB1c2goZ2V0VWludDE2KGNvZGUsIGkpKTsKICAgICAgaSArPSAyOwogICAgfQoKICAgIGNvbnN0IGluc3RydWN0aW9uTGVuZ3RoID0gZ2V0VWludDE2KGNvZGUsIGkpOwogICAgaSArPSAyICsgaW5zdHJ1Y3Rpb25MZW5ndGg7CiAgICBjb25zdCBudW1iZXJPZlBvaW50cyA9IGVuZFB0c09mQ29udG91cnMuYXQoLTEpICsgMTsKICAgIGNvbnN0IHBvaW50cyA9IFtdOwoKICAgIHdoaWxlIChwb2ludHMubGVuZ3RoIDwgbnVtYmVyT2ZQb2ludHMpIHsKICAgICAgZmxhZ3MgPSBjb2RlW2krK107CiAgICAgIGxldCByZXBlYXQgPSAxOwoKICAgICAgaWYgKGZsYWdzICYgMHgwOCkgewogICAgICAgIHJlcGVhdCArPSBjb2RlW2krK107CiAgICAgIH0KCiAgICAgIHdoaWxlIChyZXBlYXQtLSA+IDApIHsKICAgICAgICBwb2ludHMucHVzaCh7CiAgICAgICAgICBmbGFncwogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgZm9yIChqID0gMDsgaiA8IG51bWJlck9mUG9pbnRzOyBqKyspIHsKICAgICAgc3dpdGNoIChwb2ludHNbal0uZmxhZ3MgJiAweDEyKSB7CiAgICAgICAgY2FzZSAweDAwOgogICAgICAgICAgeCArPSBnZXRJbnQxNihjb2RlLCBpKTsKICAgICAgICAgIGkgKz0gMjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4MDI6CiAgICAgICAgICB4IC09IGNvZGVbaSsrXTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4MTI6CiAgICAgICAgICB4ICs9IGNvZGVbaSsrXTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBwb2ludHNbal0ueCA9IHg7CiAgICB9CgogICAgZm9yIChqID0gMDsgaiA8IG51bWJlck9mUG9pbnRzOyBqKyspIHsKICAgICAgc3dpdGNoIChwb2ludHNbal0uZmxhZ3MgJiAweDI0KSB7CiAgICAgICAgY2FzZSAweDAwOgogICAgICAgICAgeSArPSBnZXRJbnQxNihjb2RlLCBpKTsKICAgICAgICAgIGkgKz0gMjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4MDQ6CiAgICAgICAgICB5IC09IGNvZGVbaSsrXTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4MjQ6CiAgICAgICAgICB5ICs9IGNvZGVbaSsrXTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBwb2ludHNbal0ueSA9IHk7CiAgICB9CgogICAgbGV0IHN0YXJ0UG9pbnQgPSAwOwoKICAgIGZvciAoaSA9IDA7IGkgPCBudW1iZXJPZkNvbnRvdXJzOyBpKyspIHsKICAgICAgY29uc3QgZW5kUG9pbnQgPSBlbmRQdHNPZkNvbnRvdXJzW2ldOwogICAgICBjb25zdCBjb250b3VyID0gcG9pbnRzLnNsaWNlKHN0YXJ0UG9pbnQsIGVuZFBvaW50ICsgMSk7CgogICAgICBpZiAoY29udG91clswXS5mbGFncyAmIDEpIHsKICAgICAgICBjb250b3VyLnB1c2goY29udG91clswXSk7CiAgICAgIH0gZWxzZSBpZiAoY29udG91ci5hdCgtMSkuZmxhZ3MgJiAxKSB7CiAgICAgICAgY29udG91ci51bnNoaWZ0KGNvbnRvdXIuYXQoLTEpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBwID0gewogICAgICAgICAgZmxhZ3M6IDEsCiAgICAgICAgICB4OiAoY29udG91clswXS54ICsgY29udG91ci5hdCgtMSkueCkgLyAyLAogICAgICAgICAgeTogKGNvbnRvdXJbMF0ueSArIGNvbnRvdXIuYXQoLTEpLnkpIC8gMgogICAgICAgIH07CiAgICAgICAgY29udG91ci51bnNoaWZ0KHApOwogICAgICAgIGNvbnRvdXIucHVzaChwKTsKICAgICAgfQoKICAgICAgbW92ZVRvKGNvbnRvdXJbMF0ueCwgY29udG91clswXS55KTsKCiAgICAgIGZvciAoaiA9IDEsIGpqID0gY29udG91ci5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgaWYgKGNvbnRvdXJbal0uZmxhZ3MgJiAxKSB7CiAgICAgICAgICBsaW5lVG8oY29udG91cltqXS54LCBjb250b3VyW2pdLnkpOwogICAgICAgIH0gZWxzZSBpZiAoY29udG91cltqICsgMV0uZmxhZ3MgJiAxKSB7CiAgICAgICAgICBxdWFkcmF0aWNDdXJ2ZVRvKGNvbnRvdXJbal0ueCwgY29udG91cltqXS55LCBjb250b3VyW2ogKyAxXS54LCBjb250b3VyW2ogKyAxXS55KTsKICAgICAgICAgIGorKzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcXVhZHJhdGljQ3VydmVUbyhjb250b3VyW2pdLngsIGNvbnRvdXJbal0ueSwgKGNvbnRvdXJbal0ueCArIGNvbnRvdXJbaiArIDFdLngpIC8gMiwgKGNvbnRvdXJbal0ueSArIGNvbnRvdXJbaiArIDFdLnkpIC8gMik7CiAgICAgICAgfQogICAgICB9CgogICAgICBzdGFydFBvaW50ID0gZW5kUG9pbnQgKyAxOwogICAgfQogIH0KfQoKZnVuY3Rpb24gY29tcGlsZUNoYXJTdHJpbmcoY2hhclN0cmluZ0NvZGUsIGNtZHMsIGZvbnQsIGdseXBoSWQpIHsKICBmdW5jdGlvbiBtb3ZlVG8oeCwgeSkgewogICAgY21kcy5wdXNoKHsKICAgICAgY21kOiAibW92ZVRvIiwKICAgICAgYXJnczogW3gsIHldCiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGxpbmVUbyh4LCB5KSB7CiAgICBjbWRzLnB1c2goewogICAgICBjbWQ6ICJsaW5lVG8iLAogICAgICBhcmdzOiBbeCwgeV0KICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gYmV6aWVyQ3VydmVUbyh4MSwgeTEsIHgyLCB5MiwgeCwgeSkgewogICAgY21kcy5wdXNoKHsKICAgICAgY21kOiAiYmV6aWVyQ3VydmVUbyIsCiAgICAgIGFyZ3M6IFt4MSwgeTEsIHgyLCB5MiwgeCwgeV0KICAgIH0pOwogIH0KCiAgY29uc3Qgc3RhY2sgPSBbXTsKICBsZXQgeCA9IDAsCiAgICAgIHkgPSAwOwogIGxldCBzdGVtcyA9IDA7CgogIGZ1bmN0aW9uIHBhcnNlKGNvZGUpIHsKICAgIGxldCBpID0gMDsKCiAgICB3aGlsZSAoaSA8IGNvZGUubGVuZ3RoKSB7CiAgICAgIGxldCBzdGFja0NsZWFuID0gZmFsc2U7CiAgICAgIGxldCB2ID0gY29kZVtpKytdOwogICAgICBsZXQgeGEsIHhiLCB5YSwgeWIsIHkxLCB5MiwgeTMsIG4sIHN1YnJDb2RlOwoKICAgICAgc3dpdGNoICh2KSB7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgc3RlbXMgKz0gc3RhY2subGVuZ3RoID4+IDE7CiAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBzdGVtcyArPSBzdGFjay5sZW5ndGggPj4gMTsKICAgICAgICAgIHN0YWNrQ2xlYW4gPSB0cnVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgNDoKICAgICAgICAgIHkgKz0gc3RhY2sucG9wKCk7CiAgICAgICAgICBtb3ZlVG8oeCwgeSk7CiAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDU6CiAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICB4ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHkgKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgbGluZVRvKHgsIHkpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDY6CiAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICB4ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIGxpbmVUbyh4LCB5KTsKCiAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgeSArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICBsaW5lVG8oeCwgeSk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgNzoKICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHkgKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgbGluZVRvKHgsIHkpOwoKICAgICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB4ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIGxpbmVUbyh4LCB5KTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSA4OgogICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5ID0geWIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxMDoKICAgICAgICAgIG4gPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN1YnJDb2RlID0gbnVsbDsKCiAgICAgICAgICBpZiAoZm9udC5pc0NGRkNJREZvbnQpIHsKICAgICAgICAgICAgY29uc3QgZmRJbmRleCA9IGZvbnQuZmRTZWxlY3QuZ2V0RkRJbmRleChnbHlwaElkKTsKCiAgICAgICAgICAgIGlmIChmZEluZGV4ID49IDAgJiYgZmRJbmRleCA8IGZvbnQuZmRBcnJheS5sZW5ndGgpIHsKICAgICAgICAgICAgICBjb25zdCBmb250RGljdCA9IGZvbnQuZmRBcnJheVtmZEluZGV4XTsKICAgICAgICAgICAgICBsZXQgc3VicnM7CgogICAgICAgICAgICAgIGlmIChmb250RGljdC5wcml2YXRlRGljdCAmJiBmb250RGljdC5wcml2YXRlRGljdC5zdWJyc0luZGV4KSB7CiAgICAgICAgICAgICAgICBzdWJycyA9IGZvbnREaWN0LnByaXZhdGVEaWN0LnN1YnJzSW5kZXgub2JqZWN0czsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChzdWJycykgewogICAgICAgICAgICAgICAgbiArPSBnZXRTdWJyb3V0aW5lQmlhcyhzdWJycyk7CiAgICAgICAgICAgICAgICBzdWJyQ29kZSA9IHN1YnJzW25dOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkludmFsaWQgZmQgaW5kZXggZm9yIGdseXBoIGluZGV4LiIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdWJyQ29kZSA9IGZvbnQuc3VicnNbbiArIGZvbnQuc3VicnNCaWFzXTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoc3VickNvZGUpIHsKICAgICAgICAgICAgcGFyc2Uoc3VickNvZGUpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDExOgogICAgICAgICAgcmV0dXJuOwoKICAgICAgICBjYXNlIDEyOgogICAgICAgICAgdiA9IGNvZGVbaSsrXTsKCiAgICAgICAgICBzd2l0Y2ggKHYpIHsKICAgICAgICAgICAgY2FzZSAzNDoKICAgICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHkxID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5LCB4YiwgeTEsIHgsIHkxKTsKICAgICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeTEsIHhiLCB5LCB4LCB5KTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMzU6CiAgICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeSA9IHliICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHlhID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5ID0geWIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwogICAgICAgICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAzNjoKICAgICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHkxID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeTIgPSB5MSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5MSwgeGIsIHkyLCB4LCB5Mik7CiAgICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5MyA9IHkyICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHkyLCB4YiwgeTMsIHgsIHkpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAzNzoKICAgICAgICAgICAgICBjb25zdCB4MCA9IHgsCiAgICAgICAgICAgICAgICAgICAgeTAgPSB5OwogICAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHkgPSB5YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHggPSB4YjsKICAgICAgICAgICAgICB5ID0geWI7CgogICAgICAgICAgICAgIGlmIChNYXRoLmFicyh4IC0geDApID4gTWF0aC5hYnMoeSAtIHkwKSkgewogICAgICAgICAgICAgICAgeCArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB5ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGB1bmtub3duIG9wZXJhdG9yOiAxMiAke3Z9YCk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoID49IDQpIHsKICAgICAgICAgICAgY29uc3QgYWNoYXIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgY29uc3QgYmNoYXIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgeSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICB4ID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGNtZHMucHVzaCh7CiAgICAgICAgICAgICAgY21kOiAic2F2ZSIKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgIGNtZDogInRyYW5zbGF0ZSIsCiAgICAgICAgICAgICAgYXJnczogW3gsIHldCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBsZXQgY21hcCA9IGxvb2t1cENtYXAoZm9udC5jbWFwLCBTdHJpbmcuZnJvbUNoYXJDb2RlKGZvbnQuZ2x5cGhOYW1lTWFwW19lbmNvZGluZ3MuU3RhbmRhcmRFbmNvZGluZ1thY2hhcl1dKSk7CiAgICAgICAgICAgIGNvbXBpbGVDaGFyU3RyaW5nKGZvbnQuZ2x5cGhzW2NtYXAuZ2x5cGhJZF0sIGNtZHMsIGZvbnQsIGNtYXAuZ2x5cGhJZCk7CiAgICAgICAgICAgIGNtZHMucHVzaCh7CiAgICAgICAgICAgICAgY21kOiAicmVzdG9yZSIKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNtYXAgPSBsb29rdXBDbWFwKGZvbnQuY21hcCwgU3RyaW5nLmZyb21DaGFyQ29kZShmb250LmdseXBoTmFtZU1hcFtfZW5jb2RpbmdzLlN0YW5kYXJkRW5jb2RpbmdbYmNoYXJdXSkpOwogICAgICAgICAgICBjb21waWxlQ2hhclN0cmluZyhmb250LmdseXBoc1tjbWFwLmdseXBoSWRdLCBjbWRzLCBmb250LCBjbWFwLmdseXBoSWQpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybjsKCiAgICAgICAgY2FzZSAxODoKICAgICAgICAgIHN0ZW1zICs9IHN0YWNrLmxlbmd0aCA+PiAxOwogICAgICAgICAgc3RhY2tDbGVhbiA9IHRydWU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxOToKICAgICAgICAgIHN0ZW1zICs9IHN0YWNrLmxlbmd0aCA+PiAxOwogICAgICAgICAgaSArPSBzdGVtcyArIDcgPj4gMzsKICAgICAgICAgIHN0YWNrQ2xlYW4gPSB0cnVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjA6CiAgICAgICAgICBzdGVtcyArPSBzdGFjay5sZW5ndGggPj4gMTsKICAgICAgICAgIGkgKz0gc3RlbXMgKyA3ID4+IDM7CiAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDIxOgogICAgICAgICAgeSArPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHggKz0gc3RhY2sucG9wKCk7CiAgICAgICAgICBtb3ZlVG8oeCwgeSk7CiAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDIyOgogICAgICAgICAgeCArPSBzdGFjay5wb3AoKTsKICAgICAgICAgIG1vdmVUbyh4LCB5KTsKICAgICAgICAgIHN0YWNrQ2xlYW4gPSB0cnVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjM6CiAgICAgICAgICBzdGVtcyArPSBzdGFjay5sZW5ndGggPj4gMTsKICAgICAgICAgIHN0YWNrQ2xlYW4gPSB0cnVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMikgewogICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHkgPSB5YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwogICAgICAgICAgfQoKICAgICAgICAgIHggKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgIHkgKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgIGxpbmVUbyh4LCB5KTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI1OgogICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDYpIHsKICAgICAgICAgICAgeCArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIGxpbmVUbyh4LCB5KTsKICAgICAgICAgIH0KCiAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgeSA9IHliICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjY6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoICUgMikgewogICAgICAgICAgICB4ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICB9CgogICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgeGEgPSB4OwogICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHggPSB4YjsKICAgICAgICAgICAgeSA9IHliICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjc6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoICUgMikgewogICAgICAgICAgICB5ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICB9CgogICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWEgPSB5OwogICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHkgPSB5YjsKICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjg6CiAgICAgICAgICBzdGFjay5wdXNoKChjb2RlW2ldIDw8IDI0IHwgY29kZVtpICsgMV0gPDwgMTYpID4+IDE2KTsKICAgICAgICAgIGkgKz0gMjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI5OgogICAgICAgICAgbiA9IHN0YWNrLnBvcCgpICsgZm9udC5nc3VicnNCaWFzOwogICAgICAgICAgc3VickNvZGUgPSBmb250LmdzdWJyc1tuXTsKCiAgICAgICAgICBpZiAoc3VickNvZGUpIHsKICAgICAgICAgICAgcGFyc2Uoc3VickNvZGUpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDMwOgogICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgeGEgPSB4OwogICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHkgPSB5YiArIChzdGFjay5sZW5ndGggPT09IDEgPyBzdGFjay5zaGlmdCgpIDogMCk7CiAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwoKICAgICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5YSA9IHk7CiAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeSA9IHliICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeCA9IHhiICsgKHN0YWNrLmxlbmd0aCA9PT0gMSA/IHN0YWNrLnNoaWZ0KCkgOiAwKTsKICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMzE6CiAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5YSA9IHk7CiAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeSA9IHliICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeCA9IHhiICsgKHN0YWNrLmxlbmd0aCA9PT0gMSA/IHN0YWNrLnNoaWZ0KCkgOiAwKTsKICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CgogICAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHhhID0geDsKICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5ID0geWIgKyAoc3RhY2subGVuZ3RoID09PSAxID8gc3RhY2suc2hpZnQoKSA6IDApOwogICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGlmICh2IDwgMzIpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGB1bmtub3duIG9wZXJhdG9yOiAke3Z9YCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHYgPCAyNDcpIHsKICAgICAgICAgICAgc3RhY2sucHVzaCh2IC0gMTM5KTsKICAgICAgICAgIH0gZWxzZSBpZiAodiA8IDI1MSkgewogICAgICAgICAgICBzdGFjay5wdXNoKCh2IC0gMjQ3KSAqIDI1NiArIGNvZGVbaSsrXSArIDEwOCk7CiAgICAgICAgICB9IGVsc2UgaWYgKHYgPCAyNTUpIHsKICAgICAgICAgICAgc3RhY2sucHVzaCgtKHYgLSAyNTEpICogMjU2IC0gY29kZVtpKytdIC0gMTA4KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2goKGNvZGVbaV0gPDwgMjQgfCBjb2RlW2kgKyAxXSA8PCAxNiB8IGNvZGVbaSArIDJdIDw8IDggfCBjb2RlW2kgKyAzXSkgLyA2NTUzNik7CiAgICAgICAgICAgIGkgKz0gNDsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKHN0YWNrQ2xlYW4pIHsKICAgICAgICBzdGFjay5sZW5ndGggPSAwOwogICAgICB9CiAgICB9CiAgfQoKICBwYXJzZShjaGFyU3RyaW5nQ29kZSk7Cn0KCmNvbnN0IE5PT1AgPSBbXTsKCmNsYXNzIENvbXBpbGVkRm9udCB7CiAgY29uc3RydWN0b3IoZm9udE1hdHJpeCkgewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IENvbXBpbGVkRm9udCkgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgaW5pdGlhbGl6ZSBDb21waWxlZEZvbnQuIik7CiAgICB9CgogICAgdGhpcy5mb250TWF0cml4ID0gZm9udE1hdHJpeDsKICAgIHRoaXMuY29tcGlsZWRHbHlwaHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy5jb21waWxlZENoYXJDb2RlVG9HbHlwaElkID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICB9CgogIGdldFBhdGhKcyh1bmljb2RlKSB7CiAgICBjb25zdCB7CiAgICAgIGNoYXJDb2RlLAogICAgICBnbHlwaElkCiAgICB9ID0gbG9va3VwQ21hcCh0aGlzLmNtYXAsIHVuaWNvZGUpOwogICAgbGV0IGZuID0gdGhpcy5jb21waWxlZEdseXBoc1tnbHlwaElkXTsKCiAgICBpZiAoIWZuKSB7CiAgICAgIHRyeSB7CiAgICAgICAgZm4gPSB0aGlzLmNvbXBpbGVHbHlwaCh0aGlzLmdseXBoc1tnbHlwaElkXSwgZ2x5cGhJZCk7CiAgICAgICAgdGhpcy5jb21waWxlZEdseXBoc1tnbHlwaElkXSA9IGZuOwogICAgICB9IGNhdGNoIChleCkgewogICAgICAgIHRoaXMuY29tcGlsZWRHbHlwaHNbZ2x5cGhJZF0gPSBOT09QOwoKICAgICAgICBpZiAodGhpcy5jb21waWxlZENoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0aGlzLmNvbXBpbGVkQ2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgICB9CgogICAgICAgIHRocm93IGV4OwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMuY29tcGlsZWRDaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPT09IHVuZGVmaW5lZCkgewogICAgICB0aGlzLmNvbXBpbGVkQ2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgIH0KCiAgICByZXR1cm4gZm47CiAgfQoKICBjb21waWxlR2x5cGgoY29kZSwgZ2x5cGhJZCkgewogICAgaWYgKCFjb2RlIHx8IGNvZGUubGVuZ3RoID09PSAwIHx8IGNvZGVbMF0gPT09IDE0KSB7CiAgICAgIHJldHVybiBOT09QOwogICAgfQoKICAgIGxldCBmb250TWF0cml4ID0gdGhpcy5mb250TWF0cml4OwoKICAgIGlmICh0aGlzLmlzQ0ZGQ0lERm9udCkgewogICAgICBjb25zdCBmZEluZGV4ID0gdGhpcy5mZFNlbGVjdC5nZXRGREluZGV4KGdseXBoSWQpOwoKICAgICAgaWYgKGZkSW5kZXggPj0gMCAmJiBmZEluZGV4IDwgdGhpcy5mZEFycmF5Lmxlbmd0aCkgewogICAgICAgIGNvbnN0IGZvbnREaWN0ID0gdGhpcy5mZEFycmF5W2ZkSW5kZXhdOwogICAgICAgIGZvbnRNYXRyaXggPSBmb250RGljdC5nZXRCeU5hbWUoIkZvbnRNYXRyaXgiKSB8fCBfdXRpbC5GT05UX0lERU5USVRZX01BVFJJWDsKICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIkludmFsaWQgZmQgaW5kZXggZm9yIGdseXBoIGluZGV4LiIpOwogICAgICB9CiAgICB9CgogICAgY29uc3QgY21kcyA9IFt7CiAgICAgIGNtZDogInNhdmUiCiAgICB9LCB7CiAgICAgIGNtZDogInRyYW5zZm9ybSIsCiAgICAgIGFyZ3M6IGZvbnRNYXRyaXguc2xpY2UoKQogICAgfSwgewogICAgICBjbWQ6ICJzY2FsZSIsCiAgICAgIGFyZ3M6IFsic2l6ZSIsICItc2l6ZSJdCiAgICB9XTsKICAgIHRoaXMuY29tcGlsZUdseXBoSW1wbChjb2RlLCBjbWRzLCBnbHlwaElkKTsKICAgIGNtZHMucHVzaCh7CiAgICAgIGNtZDogInJlc3RvcmUiCiAgICB9KTsKICAgIHJldHVybiBjbWRzOwogIH0KCiAgY29tcGlsZUdseXBoSW1wbCgpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNoaWxkcmVuIGNsYXNzZXMgc2hvdWxkIGltcGxlbWVudCB0aGlzLiIpOwogIH0KCiAgaGFzQnVpbHRQYXRoKHVuaWNvZGUpIHsKICAgIGNvbnN0IHsKICAgICAgY2hhckNvZGUsCiAgICAgIGdseXBoSWQKICAgIH0gPSBsb29rdXBDbWFwKHRoaXMuY21hcCwgdW5pY29kZSk7CiAgICByZXR1cm4gdGhpcy5jb21waWxlZEdseXBoc1tnbHlwaElkXSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuY29tcGlsZWRDaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gIT09IHVuZGVmaW5lZDsKICB9Cgp9CgpjbGFzcyBUcnVlVHlwZUNvbXBpbGVkIGV4dGVuZHMgQ29tcGlsZWRGb250IHsKICBjb25zdHJ1Y3RvcihnbHlwaHMsIGNtYXAsIGZvbnRNYXRyaXgpIHsKICAgIHN1cGVyKGZvbnRNYXRyaXggfHwgWzAuMDAwNDg4LCAwLCAwLCAwLjAwMDQ4OCwgMCwgMF0pOwogICAgdGhpcy5nbHlwaHMgPSBnbHlwaHM7CiAgICB0aGlzLmNtYXAgPSBjbWFwOwogIH0KCiAgY29tcGlsZUdseXBoSW1wbChjb2RlLCBjbWRzKSB7CiAgICBjb21waWxlR2x5Zihjb2RlLCBjbWRzLCB0aGlzKTsKICB9Cgp9CgpjbGFzcyBUeXBlMkNvbXBpbGVkIGV4dGVuZHMgQ29tcGlsZWRGb250IHsKICBjb25zdHJ1Y3RvcihjZmZJbmZvLCBjbWFwLCBmb250TWF0cml4LCBnbHlwaE5hbWVNYXApIHsKICAgIHN1cGVyKGZvbnRNYXRyaXggfHwgWzAuMDAxLCAwLCAwLCAwLjAwMSwgMCwgMF0pOwogICAgdGhpcy5nbHlwaHMgPSBjZmZJbmZvLmdseXBoczsKICAgIHRoaXMuZ3N1YnJzID0gY2ZmSW5mby5nc3VicnMgfHwgW107CiAgICB0aGlzLnN1YnJzID0gY2ZmSW5mby5zdWJycyB8fCBbXTsKICAgIHRoaXMuY21hcCA9IGNtYXA7CiAgICB0aGlzLmdseXBoTmFtZU1hcCA9IGdseXBoTmFtZU1hcCB8fCAoMCwgX2dseXBobGlzdC5nZXRHbHlwaHNVbmljb2RlKSgpOwogICAgdGhpcy5nc3VicnNCaWFzID0gZ2V0U3Vicm91dGluZUJpYXModGhpcy5nc3VicnMpOwogICAgdGhpcy5zdWJyc0JpYXMgPSBnZXRTdWJyb3V0aW5lQmlhcyh0aGlzLnN1YnJzKTsKICAgIHRoaXMuaXNDRkZDSURGb250ID0gY2ZmSW5mby5pc0NGRkNJREZvbnQ7CiAgICB0aGlzLmZkU2VsZWN0ID0gY2ZmSW5mby5mZFNlbGVjdDsKICAgIHRoaXMuZmRBcnJheSA9IGNmZkluZm8uZmRBcnJheTsKICB9CgogIGNvbXBpbGVHbHlwaEltcGwoY29kZSwgY21kcywgZ2x5cGhJZCkgewogICAgY29tcGlsZUNoYXJTdHJpbmcoY29kZSwgY21kcywgdGhpcywgZ2x5cGhJZCk7CiAgfQoKfQoKY2xhc3MgRm9udFJlbmRlcmVyRmFjdG9yeSB7CiAgc3RhdGljIGNyZWF0ZShmb250LCBzZWFjQW5hbHlzaXNFbmFibGVkKSB7CiAgICBjb25zdCBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoZm9udC5kYXRhKTsKICAgIGxldCBjbWFwLCBnbHlmLCBsb2NhLCBjZmYsIGluZGV4VG9Mb2NGb3JtYXQsIHVuaXRzUGVyRW07CiAgICBjb25zdCBudW1UYWJsZXMgPSBnZXRVaW50MTYoZGF0YSwgNCk7CgogICAgZm9yIChsZXQgaSA9IDAsIHAgPSAxMjsgaSA8IG51bVRhYmxlczsgaSsrLCBwICs9IDE2KSB7CiAgICAgIGNvbnN0IHRhZyA9ICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShkYXRhLnN1YmFycmF5KHAsIHAgKyA0KSk7CiAgICAgIGNvbnN0IG9mZnNldCA9IGdldFVpbnQzMihkYXRhLCBwICsgOCk7CiAgICAgIGNvbnN0IGxlbmd0aCA9IGdldFVpbnQzMihkYXRhLCBwICsgMTIpOwoKICAgICAgc3dpdGNoICh0YWcpIHsKICAgICAgICBjYXNlICJjbWFwIjoKICAgICAgICAgIGNtYXAgPSBwYXJzZUNtYXAoZGF0YSwgb2Zmc2V0LCBvZmZzZXQgKyBsZW5ndGgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImdseWYiOgogICAgICAgICAgZ2x5ZiA9IGRhdGEuc3ViYXJyYXkob2Zmc2V0LCBvZmZzZXQgKyBsZW5ndGgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImxvY2EiOgogICAgICAgICAgbG9jYSA9IGRhdGEuc3ViYXJyYXkob2Zmc2V0LCBvZmZzZXQgKyBsZW5ndGgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImhlYWQiOgogICAgICAgICAgdW5pdHNQZXJFbSA9IGdldFVpbnQxNihkYXRhLCBvZmZzZXQgKyAxOCk7CiAgICAgICAgICBpbmRleFRvTG9jRm9ybWF0ID0gZ2V0VWludDE2KGRhdGEsIG9mZnNldCArIDUwKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJDRkYgIjoKICAgICAgICAgIGNmZiA9IHBhcnNlQ2ZmKGRhdGEsIG9mZnNldCwgb2Zmc2V0ICsgbGVuZ3RoLCBzZWFjQW5hbHlzaXNFbmFibGVkKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKGdseWYpIHsKICAgICAgY29uc3QgZm9udE1hdHJpeCA9ICF1bml0c1BlckVtID8gZm9udC5mb250TWF0cml4IDogWzEgLyB1bml0c1BlckVtLCAwLCAwLCAxIC8gdW5pdHNQZXJFbSwgMCwgMF07CiAgICAgIHJldHVybiBuZXcgVHJ1ZVR5cGVDb21waWxlZChwYXJzZUdseWZUYWJsZShnbHlmLCBsb2NhLCBpbmRleFRvTG9jRm9ybWF0KSwgY21hcCwgZm9udE1hdHJpeCk7CiAgICB9CgogICAgcmV0dXJuIG5ldyBUeXBlMkNvbXBpbGVkKGNmZiwgY21hcCwgZm9udC5mb250TWF0cml4LCBmb250LmdseXBoTmFtZU1hcCk7CiAgfQoKfQoKZXhwb3J0cy5Gb250UmVuZGVyZXJGYWN0b3J5ID0gRm9udFJlbmRlcmVyRmFjdG9yeTsKCi8qKiovIH0pLAovKiAxNzAgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmdldE1ldHJpY3MgPSBleHBvcnRzLmdldEZvbnRCYXNpY01ldHJpY3MgPSB2b2lkIDA7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgpjb25zdCBnZXRNZXRyaWNzID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0LkNvdXJpZXIgPSA2MDA7CiAgdFsiQ291cmllci1Cb2xkIl0gPSA2MDA7CiAgdFsiQ291cmllci1Cb2xkT2JsaXF1ZSJdID0gNjAwOwogIHRbIkNvdXJpZXItT2JsaXF1ZSJdID0gNjAwOwogIHQuSGVsdmV0aWNhID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgIHQuc3BhY2UgPSAyNzg7CiAgICB0LmV4Y2xhbSA9IDI3ODsKICAgIHQucXVvdGVkYmwgPSAzNTU7CiAgICB0Lm51bWJlcnNpZ24gPSA1NTY7CiAgICB0LmRvbGxhciA9IDU1NjsKICAgIHQucGVyY2VudCA9IDg4OTsKICAgIHQuYW1wZXJzYW5kID0gNjY3OwogICAgdC5xdW90ZXJpZ2h0ID0gMjIyOwogICAgdC5wYXJlbmxlZnQgPSAzMzM7CiAgICB0LnBhcmVucmlnaHQgPSAzMzM7CiAgICB0LmFzdGVyaXNrID0gMzg5OwogICAgdC5wbHVzID0gNTg0OwogICAgdC5jb21tYSA9IDI3ODsKICAgIHQuaHlwaGVuID0gMzMzOwogICAgdC5wZXJpb2QgPSAyNzg7CiAgICB0LnNsYXNoID0gMjc4OwogICAgdC56ZXJvID0gNTU2OwogICAgdC5vbmUgPSA1NTY7CiAgICB0LnR3byA9IDU1NjsKICAgIHQudGhyZWUgPSA1NTY7CiAgICB0LmZvdXIgPSA1NTY7CiAgICB0LmZpdmUgPSA1NTY7CiAgICB0LnNpeCA9IDU1NjsKICAgIHQuc2V2ZW4gPSA1NTY7CiAgICB0LmVpZ2h0ID0gNTU2OwogICAgdC5uaW5lID0gNTU2OwogICAgdC5jb2xvbiA9IDI3ODsKICAgIHQuc2VtaWNvbG9uID0gMjc4OwogICAgdC5sZXNzID0gNTg0OwogICAgdC5lcXVhbCA9IDU4NDsKICAgIHQuZ3JlYXRlciA9IDU4NDsKICAgIHQucXVlc3Rpb24gPSA1NTY7CiAgICB0LmF0ID0gMTAxNTsKICAgIHQuQSA9IDY2NzsKICAgIHQuQiA9IDY2NzsKICAgIHQuQyA9IDcyMjsKICAgIHQuRCA9IDcyMjsKICAgIHQuRSA9IDY2NzsKICAgIHQuRiA9IDYxMTsKICAgIHQuRyA9IDc3ODsKICAgIHQuSCA9IDcyMjsKICAgIHQuSSA9IDI3ODsKICAgIHQuSiA9IDUwMDsKICAgIHQuSyA9IDY2NzsKICAgIHQuTCA9IDU1NjsKICAgIHQuTSA9IDgzMzsKICAgIHQuTiA9IDcyMjsKICAgIHQuTyA9IDc3ODsKICAgIHQuUCA9IDY2NzsKICAgIHQuUSA9IDc3ODsKICAgIHQuUiA9IDcyMjsKICAgIHQuUyA9IDY2NzsKICAgIHQuVCA9IDYxMTsKICAgIHQuVSA9IDcyMjsKICAgIHQuViA9IDY2NzsKICAgIHQuVyA9IDk0NDsKICAgIHQuWCA9IDY2NzsKICAgIHQuWSA9IDY2NzsKICAgIHQuWiA9IDYxMTsKICAgIHQuYnJhY2tldGxlZnQgPSAyNzg7CiAgICB0LmJhY2tzbGFzaCA9IDI3ODsKICAgIHQuYnJhY2tldHJpZ2h0ID0gMjc4OwogICAgdC5hc2NpaWNpcmN1bSA9IDQ2OTsKICAgIHQudW5kZXJzY29yZSA9IDU1NjsKICAgIHQucXVvdGVsZWZ0ID0gMjIyOwogICAgdC5hID0gNTU2OwogICAgdC5iID0gNTU2OwogICAgdC5jID0gNTAwOwogICAgdC5kID0gNTU2OwogICAgdC5lID0gNTU2OwogICAgdC5mID0gMjc4OwogICAgdC5nID0gNTU2OwogICAgdC5oID0gNTU2OwogICAgdC5pID0gMjIyOwogICAgdC5qID0gMjIyOwogICAgdC5rID0gNTAwOwogICAgdC5sID0gMjIyOwogICAgdC5tID0gODMzOwogICAgdC5uID0gNTU2OwogICAgdC5vID0gNTU2OwogICAgdC5wID0gNTU2OwogICAgdC5xID0gNTU2OwogICAgdC5yID0gMzMzOwogICAgdC5zID0gNTAwOwogICAgdC50ID0gMjc4OwogICAgdC51ID0gNTU2OwogICAgdC52ID0gNTAwOwogICAgdC53ID0gNzIyOwogICAgdC54ID0gNTAwOwogICAgdC55ID0gNTAwOwogICAgdC56ID0gNTAwOwogICAgdC5icmFjZWxlZnQgPSAzMzQ7CiAgICB0LmJhciA9IDI2MDsKICAgIHQuYnJhY2VyaWdodCA9IDMzNDsKICAgIHQuYXNjaWl0aWxkZSA9IDU4NDsKICAgIHQuZXhjbGFtZG93biA9IDMzMzsKICAgIHQuY2VudCA9IDU1NjsKICAgIHQuc3RlcmxpbmcgPSA1NTY7CiAgICB0LmZyYWN0aW9uID0gMTY3OwogICAgdC55ZW4gPSA1NTY7CiAgICB0LmZsb3JpbiA9IDU1NjsKICAgIHQuc2VjdGlvbiA9IDU1NjsKICAgIHQuY3VycmVuY3kgPSA1NTY7CiAgICB0LnF1b3Rlc2luZ2xlID0gMTkxOwogICAgdC5xdW90ZWRibGxlZnQgPSAzMzM7CiAgICB0Lmd1aWxsZW1vdGxlZnQgPSA1NTY7CiAgICB0Lmd1aWxzaW5nbGxlZnQgPSAzMzM7CiAgICB0Lmd1aWxzaW5nbHJpZ2h0ID0gMzMzOwogICAgdC5maSA9IDUwMDsKICAgIHQuZmwgPSA1MDA7CiAgICB0LmVuZGFzaCA9IDU1NjsKICAgIHQuZGFnZ2VyID0gNTU2OwogICAgdC5kYWdnZXJkYmwgPSA1NTY7CiAgICB0LnBlcmlvZGNlbnRlcmVkID0gMjc4OwogICAgdC5wYXJhZ3JhcGggPSA1Mzc7CiAgICB0LmJ1bGxldCA9IDM1MDsKICAgIHQucXVvdGVzaW5nbGJhc2UgPSAyMjI7CiAgICB0LnF1b3RlZGJsYmFzZSA9IDMzMzsKICAgIHQucXVvdGVkYmxyaWdodCA9IDMzMzsKICAgIHQuZ3VpbGxlbW90cmlnaHQgPSA1NTY7CiAgICB0LmVsbGlwc2lzID0gMTAwMDsKICAgIHQucGVydGhvdXNhbmQgPSAxMDAwOwogICAgdC5xdWVzdGlvbmRvd24gPSA2MTE7CiAgICB0LmdyYXZlID0gMzMzOwogICAgdC5hY3V0ZSA9IDMzMzsKICAgIHQuY2lyY3VtZmxleCA9IDMzMzsKICAgIHQudGlsZGUgPSAzMzM7CiAgICB0Lm1hY3JvbiA9IDMzMzsKICAgIHQuYnJldmUgPSAzMzM7CiAgICB0LmRvdGFjY2VudCA9IDMzMzsKICAgIHQuZGllcmVzaXMgPSAzMzM7CiAgICB0LnJpbmcgPSAzMzM7CiAgICB0LmNlZGlsbGEgPSAzMzM7CiAgICB0Lmh1bmdhcnVtbGF1dCA9IDMzMzsKICAgIHQub2dvbmVrID0gMzMzOwogICAgdC5jYXJvbiA9IDMzMzsKICAgIHQuZW1kYXNoID0gMTAwMDsKICAgIHQuQUUgPSAxMDAwOwogICAgdC5vcmRmZW1pbmluZSA9IDM3MDsKICAgIHQuTHNsYXNoID0gNTU2OwogICAgdC5Pc2xhc2ggPSA3Nzg7CiAgICB0Lk9FID0gMTAwMDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzY1OwogICAgdC5hZSA9IDg4OTsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDIyMjsKICAgIHQub3NsYXNoID0gNjExOwogICAgdC5vZSA9IDk0NDsKICAgIHQuZ2VybWFuZGJscyA9IDYxMTsKICAgIHQuSWRpZXJlc2lzID0gMjc4OwogICAgdC5lYWN1dGUgPSA1NTY7CiAgICB0LmFicmV2ZSA9IDU1NjsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDU1NjsKICAgIHQuZWNhcm9uID0gNTU2OwogICAgdC5ZZGllcmVzaXMgPSA2Njc7CiAgICB0LmRpdmlkZSA9IDU4NDsKICAgIHQuWWFjdXRlID0gNjY3OwogICAgdC5BY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWFjdXRlID0gNTU2OwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNTAwOwogICAgdC5zY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0LmVjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTU2OwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA1NTY7CiAgICB0LkVkaWVyZXNpcyA9IDY2NzsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzM3OwogICAgdC5FbWFjcm9uID0gNjY3OwogICAgdC5jY2Fyb24gPSA1MDA7CiAgICB0LmFyaW5nID0gNTU2OwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDIyMjsKICAgIHQuYWdyYXZlID0gNTU2OwogICAgdC5UY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkNhY3V0ZSA9IDcyMjsKICAgIHQuYXRpbGRlID0gNTU2OwogICAgdC5FZG90YWNjZW50ID0gNjY3OwogICAgdC5zY2Fyb24gPSA1MDA7CiAgICB0LnNjZWRpbGxhID0gNTAwOwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0NzE7CiAgICB0LlJjYXJvbiA9IDcyMjsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzc4OwogICAgdC51Y2lyY3VtZmxleCA9IDU1NjsKICAgIHQuYWNpcmN1bWZsZXggPSA1NTY7CiAgICB0LkFtYWNyb24gPSA2Njc7CiAgICB0LnJjYXJvbiA9IDMzMzsKICAgIHQuY2NlZGlsbGEgPSA1MDA7CiAgICB0Llpkb3RhY2NlbnQgPSA2MTE7CiAgICB0LlRob3JuID0gNjY3OwogICAgdC5PbWFjcm9uID0gNzc4OwogICAgdC5SYWN1dGUgPSA3MjI7CiAgICB0LlNhY3V0ZSA9IDY2NzsKICAgIHQuZGNhcm9uID0gNjQzOwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDU1NjsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMzMzsKICAgIHQuT2dyYXZlID0gNzc4OwogICAgdC5BZ3JhdmUgPSA2Njc7CiAgICB0LkFicmV2ZSA9IDY2NzsKICAgIHQubXVsdGlwbHkgPSA1ODQ7CiAgICB0LnVhY3V0ZSA9IDU1NjsKICAgIHQuVGNhcm9uID0gNjExOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ3NjsKICAgIHQueWRpZXJlc2lzID0gNTAwOwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWRpZXJlc2lzID0gNTU2OwogICAgdC5lZGllcmVzaXMgPSA1NTY7CiAgICB0LmNhY3V0ZSA9IDUwMDsKICAgIHQubmFjdXRlID0gNTU2OwogICAgdC51bWFjcm9uID0gNTU2OwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDI3ODsKICAgIHQucGx1c21pbnVzID0gNTg0OwogICAgdC5icm9rZW5iYXIgPSAyNjA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3Mzc7CiAgICB0LkdicmV2ZSA9IDc3ODsKICAgIHQuSWRvdGFjY2VudCA9IDI3ODsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2Njc7CiAgICB0LnJhY3V0ZSA9IDMzMzsKICAgIHQub21hY3JvbiA9IDU1NjsKICAgIHQuWmFjdXRlID0gNjExOwogICAgdC5aY2Fyb24gPSA2MTE7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDcyMjsKICAgIHQubGNvbW1hYWNjZW50ID0gMjIyOwogICAgdC50Y2Fyb24gPSAzMTc7CiAgICB0LmVvZ29uZWsgPSA1NTY7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDY2NzsKICAgIHQuQWRpZXJlc2lzID0gNjY3OwogICAgdC5lZ3JhdmUgPSA1NTY7CiAgICB0LnphY3V0ZSA9IDUwMDsKICAgIHQuaW9nb25layA9IDIyMjsKICAgIHQuT2FjdXRlID0gNzc4OwogICAgdC5vYWN1dGUgPSA1NTY7CiAgICB0LmFtYWNyb24gPSA1NTY7CiAgICB0LnNhY3V0ZSA9IDUwMDsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDc3ODsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA1NTY7CiAgICB0LnR3b3N1cGVyaW9yID0gMzMzOwogICAgdC5PZGllcmVzaXMgPSA3Nzg7CiAgICB0Lm11ID0gNTU2OwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA1NTY7CiAgICB0LkVvZ29uZWsgPSA2Njc7CiAgICB0LmRjcm9hdCA9IDU1NjsKICAgIHQudGhyZWVxdWFydGVycyA9IDgzNDsKICAgIHQuU2NlZGlsbGEgPSA2Njc7CiAgICB0LmxjYXJvbiA9IDI5OTsKICAgIHQuS2NvbW1hYWNjZW50ID0gNjY3OwogICAgdC5MYWN1dGUgPSA1NTY7CiAgICB0LnRyYWRlbWFyayA9IDEwMDA7CiAgICB0LmVkb3RhY2NlbnQgPSA1NTY7CiAgICB0LklncmF2ZSA9IDI3ODsKICAgIHQuSW1hY3JvbiA9IDI3ODsKICAgIHQuTGNhcm9uID0gNTU2OwogICAgdC5vbmVoYWxmID0gODM0OwogICAgdC5sZXNzZXF1YWwgPSA1NDk7CiAgICB0Lm9jaXJjdW1mbGV4ID0gNTU2OwogICAgdC5udGlsZGUgPSA1NTY7CiAgICB0LlVodW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LkVhY3V0ZSA9IDY2NzsKICAgIHQuZW1hY3JvbiA9IDU1NjsKICAgIHQuZ2JyZXZlID0gNTU2OwogICAgdC5vbmVxdWFydGVyID0gODM0OwogICAgdC5TY2Fyb24gPSA2Njc7CiAgICB0LlNjb21tYWFjY2VudCA9IDY2NzsKICAgIHQuT2h1bmdhcnVtbGF1dCA9IDc3ODsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5vZ3JhdmUgPSA1NTY7CiAgICB0LkNjYXJvbiA9IDcyMjsKICAgIHQudWdyYXZlID0gNTU2OwogICAgdC5yYWRpY2FsID0gNDUzOwogICAgdC5EY2Fyb24gPSA3MjI7CiAgICB0LnJjb21tYWFjY2VudCA9IDMzMzsKICAgIHQuTnRpbGRlID0gNzIyOwogICAgdC5vdGlsZGUgPSA1NTY7CiAgICB0LlJjb21tYWFjY2VudCA9IDcyMjsKICAgIHQuTGNvbW1hYWNjZW50ID0gNTU2OwogICAgdC5BdGlsZGUgPSA2Njc7CiAgICB0LkFvZ29uZWsgPSA2Njc7CiAgICB0LkFyaW5nID0gNjY3OwogICAgdC5PdGlsZGUgPSA3Nzg7CiAgICB0Lnpkb3RhY2NlbnQgPSA1MDA7CiAgICB0LkVjYXJvbiA9IDY2NzsKICAgIHQuSW9nb25layA9IDI3ODsKICAgIHQua2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5taW51cyA9IDU4NDsKICAgIHQuSWNpcmN1bWZsZXggPSAyNzg7CiAgICB0Lm5jYXJvbiA9IDU1NjsKICAgIHQudGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC5sb2dpY2Fsbm90ID0gNTg0OwogICAgdC5vZGllcmVzaXMgPSA1NTY7CiAgICB0LnVkaWVyZXNpcyA9IDU1NjsKICAgIHQubm90ZXF1YWwgPSA1NDk7CiAgICB0Lmdjb21tYWFjY2VudCA9IDU1NjsKICAgIHQuZXRoID0gNTU2OwogICAgdC56Y2Fyb24gPSA1MDA7CiAgICB0Lm5jb21tYWFjY2VudCA9IDU1NjsKICAgIHQub25lc3VwZXJpb3IgPSAzMzM7CiAgICB0LmltYWNyb24gPSAyNzg7CiAgICB0LkV1cm8gPSA1NTY7CiAgfSk7CiAgdFsiSGVsdmV0aWNhLUJvbGQiXSA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICB0LnNwYWNlID0gMjc4OwogICAgdC5leGNsYW0gPSAzMzM7CiAgICB0LnF1b3RlZGJsID0gNDc0OwogICAgdC5udW1iZXJzaWduID0gNTU2OwogICAgdC5kb2xsYXIgPSA1NTY7CiAgICB0LnBlcmNlbnQgPSA4ODk7CiAgICB0LmFtcGVyc2FuZCA9IDcyMjsKICAgIHQucXVvdGVyaWdodCA9IDI3ODsKICAgIHQucGFyZW5sZWZ0ID0gMzMzOwogICAgdC5wYXJlbnJpZ2h0ID0gMzMzOwogICAgdC5hc3RlcmlzayA9IDM4OTsKICAgIHQucGx1cyA9IDU4NDsKICAgIHQuY29tbWEgPSAyNzg7CiAgICB0Lmh5cGhlbiA9IDMzMzsKICAgIHQucGVyaW9kID0gMjc4OwogICAgdC5zbGFzaCA9IDI3ODsKICAgIHQuemVybyA9IDU1NjsKICAgIHQub25lID0gNTU2OwogICAgdC50d28gPSA1NTY7CiAgICB0LnRocmVlID0gNTU2OwogICAgdC5mb3VyID0gNTU2OwogICAgdC5maXZlID0gNTU2OwogICAgdC5zaXggPSA1NTY7CiAgICB0LnNldmVuID0gNTU2OwogICAgdC5laWdodCA9IDU1NjsKICAgIHQubmluZSA9IDU1NjsKICAgIHQuY29sb24gPSAzMzM7CiAgICB0LnNlbWljb2xvbiA9IDMzMzsKICAgIHQubGVzcyA9IDU4NDsKICAgIHQuZXF1YWwgPSA1ODQ7CiAgICB0LmdyZWF0ZXIgPSA1ODQ7CiAgICB0LnF1ZXN0aW9uID0gNjExOwogICAgdC5hdCA9IDk3NTsKICAgIHQuQSA9IDcyMjsKICAgIHQuQiA9IDcyMjsKICAgIHQuQyA9IDcyMjsKICAgIHQuRCA9IDcyMjsKICAgIHQuRSA9IDY2NzsKICAgIHQuRiA9IDYxMTsKICAgIHQuRyA9IDc3ODsKICAgIHQuSCA9IDcyMjsKICAgIHQuSSA9IDI3ODsKICAgIHQuSiA9IDU1NjsKICAgIHQuSyA9IDcyMjsKICAgIHQuTCA9IDYxMTsKICAgIHQuTSA9IDgzMzsKICAgIHQuTiA9IDcyMjsKICAgIHQuTyA9IDc3ODsKICAgIHQuUCA9IDY2NzsKICAgIHQuUSA9IDc3ODsKICAgIHQuUiA9IDcyMjsKICAgIHQuUyA9IDY2NzsKICAgIHQuVCA9IDYxMTsKICAgIHQuVSA9IDcyMjsKICAgIHQuViA9IDY2NzsKICAgIHQuVyA9IDk0NDsKICAgIHQuWCA9IDY2NzsKICAgIHQuWSA9IDY2NzsKICAgIHQuWiA9IDYxMTsKICAgIHQuYnJhY2tldGxlZnQgPSAzMzM7CiAgICB0LmJhY2tzbGFzaCA9IDI3ODsKICAgIHQuYnJhY2tldHJpZ2h0ID0gMzMzOwogICAgdC5hc2NpaWNpcmN1bSA9IDU4NDsKICAgIHQudW5kZXJzY29yZSA9IDU1NjsKICAgIHQucXVvdGVsZWZ0ID0gMjc4OwogICAgdC5hID0gNTU2OwogICAgdC5iID0gNjExOwogICAgdC5jID0gNTU2OwogICAgdC5kID0gNjExOwogICAgdC5lID0gNTU2OwogICAgdC5mID0gMzMzOwogICAgdC5nID0gNjExOwogICAgdC5oID0gNjExOwogICAgdC5pID0gMjc4OwogICAgdC5qID0gMjc4OwogICAgdC5rID0gNTU2OwogICAgdC5sID0gMjc4OwogICAgdC5tID0gODg5OwogICAgdC5uID0gNjExOwogICAgdC5vID0gNjExOwogICAgdC5wID0gNjExOwogICAgdC5xID0gNjExOwogICAgdC5yID0gMzg5OwogICAgdC5zID0gNTU2OwogICAgdC50ID0gMzMzOwogICAgdC51ID0gNjExOwogICAgdC52ID0gNTU2OwogICAgdC53ID0gNzc4OwogICAgdC54ID0gNTU2OwogICAgdC55ID0gNTU2OwogICAgdC56ID0gNTAwOwogICAgdC5icmFjZWxlZnQgPSAzODk7CiAgICB0LmJhciA9IDI4MDsKICAgIHQuYnJhY2VyaWdodCA9IDM4OTsKICAgIHQuYXNjaWl0aWxkZSA9IDU4NDsKICAgIHQuZXhjbGFtZG93biA9IDMzMzsKICAgIHQuY2VudCA9IDU1NjsKICAgIHQuc3RlcmxpbmcgPSA1NTY7CiAgICB0LmZyYWN0aW9uID0gMTY3OwogICAgdC55ZW4gPSA1NTY7CiAgICB0LmZsb3JpbiA9IDU1NjsKICAgIHQuc2VjdGlvbiA9IDU1NjsKICAgIHQuY3VycmVuY3kgPSA1NTY7CiAgICB0LnF1b3Rlc2luZ2xlID0gMjM4OwogICAgdC5xdW90ZWRibGxlZnQgPSA1MDA7CiAgICB0Lmd1aWxsZW1vdGxlZnQgPSA1NTY7CiAgICB0Lmd1aWxzaW5nbGxlZnQgPSAzMzM7CiAgICB0Lmd1aWxzaW5nbHJpZ2h0ID0gMzMzOwogICAgdC5maSA9IDYxMTsKICAgIHQuZmwgPSA2MTE7CiAgICB0LmVuZGFzaCA9IDU1NjsKICAgIHQuZGFnZ2VyID0gNTU2OwogICAgdC5kYWdnZXJkYmwgPSA1NTY7CiAgICB0LnBlcmlvZGNlbnRlcmVkID0gMjc4OwogICAgdC5wYXJhZ3JhcGggPSA1NTY7CiAgICB0LmJ1bGxldCA9IDM1MDsKICAgIHQucXVvdGVzaW5nbGJhc2UgPSAyNzg7CiAgICB0LnF1b3RlZGJsYmFzZSA9IDUwMDsKICAgIHQucXVvdGVkYmxyaWdodCA9IDUwMDsKICAgIHQuZ3VpbGxlbW90cmlnaHQgPSA1NTY7CiAgICB0LmVsbGlwc2lzID0gMTAwMDsKICAgIHQucGVydGhvdXNhbmQgPSAxMDAwOwogICAgdC5xdWVzdGlvbmRvd24gPSA2MTE7CiAgICB0LmdyYXZlID0gMzMzOwogICAgdC5hY3V0ZSA9IDMzMzsKICAgIHQuY2lyY3VtZmxleCA9IDMzMzsKICAgIHQudGlsZGUgPSAzMzM7CiAgICB0Lm1hY3JvbiA9IDMzMzsKICAgIHQuYnJldmUgPSAzMzM7CiAgICB0LmRvdGFjY2VudCA9IDMzMzsKICAgIHQuZGllcmVzaXMgPSAzMzM7CiAgICB0LnJpbmcgPSAzMzM7CiAgICB0LmNlZGlsbGEgPSAzMzM7CiAgICB0Lmh1bmdhcnVtbGF1dCA9IDMzMzsKICAgIHQub2dvbmVrID0gMzMzOwogICAgdC5jYXJvbiA9IDMzMzsKICAgIHQuZW1kYXNoID0gMTAwMDsKICAgIHQuQUUgPSAxMDAwOwogICAgdC5vcmRmZW1pbmluZSA9IDM3MDsKICAgIHQuTHNsYXNoID0gNjExOwogICAgdC5Pc2xhc2ggPSA3Nzg7CiAgICB0Lk9FID0gMTAwMDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzY1OwogICAgdC5hZSA9IDg4OTsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNjExOwogICAgdC5vZSA9IDk0NDsKICAgIHQuZ2VybWFuZGJscyA9IDYxMTsKICAgIHQuSWRpZXJlc2lzID0gMjc4OwogICAgdC5lYWN1dGUgPSA1NTY7CiAgICB0LmFicmV2ZSA9IDU1NjsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDYxMTsKICAgIHQuZWNhcm9uID0gNTU2OwogICAgdC5ZZGllcmVzaXMgPSA2Njc7CiAgICB0LmRpdmlkZSA9IDU4NDsKICAgIHQuWWFjdXRlID0gNjY3OwogICAgdC5BY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuYWFjdXRlID0gNTU2OwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNTU2OwogICAgdC5zY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LmVjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTU2OwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA2MTE7CiAgICB0LkVkaWVyZXNpcyA9IDY2NzsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzM3OwogICAgdC5FbWFjcm9uID0gNjY3OwogICAgdC5jY2Fyb24gPSA1NTY7CiAgICB0LmFyaW5nID0gNTU2OwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNTU2OwogICAgdC5UY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkNhY3V0ZSA9IDcyMjsKICAgIHQuYXRpbGRlID0gNTU2OwogICAgdC5FZG90YWNjZW50ID0gNjY3OwogICAgdC5zY2Fyb24gPSA1NTY7CiAgICB0LnNjZWRpbGxhID0gNTU2OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0OTQ7CiAgICB0LlJjYXJvbiA9IDcyMjsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzc4OwogICAgdC51Y2lyY3VtZmxleCA9IDYxMTsKICAgIHQuYWNpcmN1bWZsZXggPSA1NTY7CiAgICB0LkFtYWNyb24gPSA3MjI7CiAgICB0LnJjYXJvbiA9IDM4OTsKICAgIHQuY2NlZGlsbGEgPSA1NTY7CiAgICB0Llpkb3RhY2NlbnQgPSA2MTE7CiAgICB0LlRob3JuID0gNjY3OwogICAgdC5PbWFjcm9uID0gNzc4OwogICAgdC5SYWN1dGUgPSA3MjI7CiAgICB0LlNhY3V0ZSA9IDY2NzsKICAgIHQuZGNhcm9uID0gNzQzOwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDYxMTsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMzMzsKICAgIHQuT2dyYXZlID0gNzc4OwogICAgdC5BZ3JhdmUgPSA3MjI7CiAgICB0LkFicmV2ZSA9IDcyMjsKICAgIHQubXVsdGlwbHkgPSA1ODQ7CiAgICB0LnVhY3V0ZSA9IDYxMTsKICAgIHQuVGNhcm9uID0gNjExOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ5NDsKICAgIHQueWRpZXJlc2lzID0gNTU2OwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWRpZXJlc2lzID0gNTU2OwogICAgdC5lZGllcmVzaXMgPSA1NTY7CiAgICB0LmNhY3V0ZSA9IDU1NjsKICAgIHQubmFjdXRlID0gNjExOwogICAgdC51bWFjcm9uID0gNjExOwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDI3ODsKICAgIHQucGx1c21pbnVzID0gNTg0OwogICAgdC5icm9rZW5iYXIgPSAyODA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3Mzc7CiAgICB0LkdicmV2ZSA9IDc3ODsKICAgIHQuSWRvdGFjY2VudCA9IDI3ODsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2Njc7CiAgICB0LnJhY3V0ZSA9IDM4OTsKICAgIHQub21hY3JvbiA9IDYxMTsKICAgIHQuWmFjdXRlID0gNjExOwogICAgdC5aY2Fyb24gPSA2MTE7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDcyMjsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSAzODk7CiAgICB0LmVvZ29uZWsgPSA1NTY7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDcyMjsKICAgIHQuQWRpZXJlc2lzID0gNzIyOwogICAgdC5lZ3JhdmUgPSA1NTY7CiAgICB0LnphY3V0ZSA9IDUwMDsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzc4OwogICAgdC5vYWN1dGUgPSA2MTE7CiAgICB0LmFtYWNyb24gPSA1NTY7CiAgICB0LnNhY3V0ZSA9IDU1NjsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDc3ODsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA2MTE7CiAgICB0LnR3b3N1cGVyaW9yID0gMzMzOwogICAgdC5PZGllcmVzaXMgPSA3Nzg7CiAgICB0Lm11ID0gNjExOwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA2MTE7CiAgICB0LkVvZ29uZWsgPSA2Njc7CiAgICB0LmRjcm9hdCA9IDYxMTsKICAgIHQudGhyZWVxdWFydGVycyA9IDgzNDsKICAgIHQuU2NlZGlsbGEgPSA2Njc7CiAgICB0LmxjYXJvbiA9IDQwMDsKICAgIHQuS2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC5MYWN1dGUgPSA2MTE7CiAgICB0LnRyYWRlbWFyayA9IDEwMDA7CiAgICB0LmVkb3RhY2NlbnQgPSA1NTY7CiAgICB0LklncmF2ZSA9IDI3ODsKICAgIHQuSW1hY3JvbiA9IDI3ODsKICAgIHQuTGNhcm9uID0gNjExOwogICAgdC5vbmVoYWxmID0gODM0OwogICAgdC5sZXNzZXF1YWwgPSA1NDk7CiAgICB0Lm9jaXJjdW1mbGV4ID0gNjExOwogICAgdC5udGlsZGUgPSA2MTE7CiAgICB0LlVodW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LkVhY3V0ZSA9IDY2NzsKICAgIHQuZW1hY3JvbiA9IDU1NjsKICAgIHQuZ2JyZXZlID0gNjExOwogICAgdC5vbmVxdWFydGVyID0gODM0OwogICAgdC5TY2Fyb24gPSA2Njc7CiAgICB0LlNjb21tYWFjY2VudCA9IDY2NzsKICAgIHQuT2h1bmdhcnVtbGF1dCA9IDc3ODsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5vZ3JhdmUgPSA2MTE7CiAgICB0LkNjYXJvbiA9IDcyMjsKICAgIHQudWdyYXZlID0gNjExOwogICAgdC5yYWRpY2FsID0gNTQ5OwogICAgdC5EY2Fyb24gPSA3MjI7CiAgICB0LnJjb21tYWFjY2VudCA9IDM4OTsKICAgIHQuTnRpbGRlID0gNzIyOwogICAgdC5vdGlsZGUgPSA2MTE7CiAgICB0LlJjb21tYWFjY2VudCA9IDcyMjsKICAgIHQuTGNvbW1hYWNjZW50ID0gNjExOwogICAgdC5BdGlsZGUgPSA3MjI7CiAgICB0LkFvZ29uZWsgPSA3MjI7CiAgICB0LkFyaW5nID0gNzIyOwogICAgdC5PdGlsZGUgPSA3Nzg7CiAgICB0Lnpkb3RhY2NlbnQgPSA1MDA7CiAgICB0LkVjYXJvbiA9IDY2NzsKICAgIHQuSW9nb25layA9IDI3ODsKICAgIHQua2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5taW51cyA9IDU4NDsKICAgIHQuSWNpcmN1bWZsZXggPSAyNzg7CiAgICB0Lm5jYXJvbiA9IDYxMTsKICAgIHQudGNvbW1hYWNjZW50ID0gMzMzOwogICAgdC5sb2dpY2Fsbm90ID0gNTg0OwogICAgdC5vZGllcmVzaXMgPSA2MTE7CiAgICB0LnVkaWVyZXNpcyA9IDYxMTsKICAgIHQubm90ZXF1YWwgPSA1NDk7CiAgICB0Lmdjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuZXRoID0gNjExOwogICAgdC56Y2Fyb24gPSA1MDA7CiAgICB0Lm5jb21tYWFjY2VudCA9IDYxMTsKICAgIHQub25lc3VwZXJpb3IgPSAzMzM7CiAgICB0LmltYWNyb24gPSAyNzg7CiAgICB0LkV1cm8gPSA1NTY7CiAgfSk7CiAgdFsiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIl0gPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI3ODsKICAgIHQuZXhjbGFtID0gMzMzOwogICAgdC5xdW90ZWRibCA9IDQ3NDsKICAgIHQubnVtYmVyc2lnbiA9IDU1NjsKICAgIHQuZG9sbGFyID0gNTU2OwogICAgdC5wZXJjZW50ID0gODg5OwogICAgdC5hbXBlcnNhbmQgPSA3MjI7CiAgICB0LnF1b3RlcmlnaHQgPSAyNzg7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2sgPSAzODk7CiAgICB0LnBsdXMgPSA1ODQ7CiAgICB0LmNvbW1hID0gMjc4OwogICAgdC5oeXBoZW4gPSAzMzM7CiAgICB0LnBlcmlvZCA9IDI3ODsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1NTY7CiAgICB0Lm9uZSA9IDU1NjsKICAgIHQudHdvID0gNTU2OwogICAgdC50aHJlZSA9IDU1NjsKICAgIHQuZm91ciA9IDU1NjsKICAgIHQuZml2ZSA9IDU1NjsKICAgIHQuc2l4ID0gNTU2OwogICAgdC5zZXZlbiA9IDU1NjsKICAgIHQuZWlnaHQgPSA1NTY7CiAgICB0Lm5pbmUgPSA1NTY7CiAgICB0LmNvbG9uID0gMzMzOwogICAgdC5zZW1pY29sb24gPSAzMzM7CiAgICB0Lmxlc3MgPSA1ODQ7CiAgICB0LmVxdWFsID0gNTg0OwogICAgdC5ncmVhdGVyID0gNTg0OwogICAgdC5xdWVzdGlvbiA9IDYxMTsKICAgIHQuYXQgPSA5NzU7CiAgICB0LkEgPSA3MjI7CiAgICB0LkIgPSA3MjI7CiAgICB0LkMgPSA3MjI7CiAgICB0LkQgPSA3MjI7CiAgICB0LkUgPSA2Njc7CiAgICB0LkYgPSA2MTE7CiAgICB0LkcgPSA3Nzg7CiAgICB0LkggPSA3MjI7CiAgICB0LkkgPSAyNzg7CiAgICB0LkogPSA1NTY7CiAgICB0LksgPSA3MjI7CiAgICB0LkwgPSA2MTE7CiAgICB0Lk0gPSA4MzM7CiAgICB0Lk4gPSA3MjI7CiAgICB0Lk8gPSA3Nzg7CiAgICB0LlAgPSA2Njc7CiAgICB0LlEgPSA3Nzg7CiAgICB0LlIgPSA3MjI7CiAgICB0LlMgPSA2Njc7CiAgICB0LlQgPSA2MTE7CiAgICB0LlUgPSA3MjI7CiAgICB0LlYgPSA2Njc7CiAgICB0LlcgPSA5NDQ7CiAgICB0LlggPSA2Njc7CiAgICB0LlkgPSA2Njc7CiAgICB0LlogPSA2MTE7CiAgICB0LmJyYWNrZXRsZWZ0ID0gMzMzOwogICAgdC5iYWNrc2xhc2ggPSAyNzg7CiAgICB0LmJyYWNrZXRyaWdodCA9IDMzMzsKICAgIHQuYXNjaWljaXJjdW0gPSA1ODQ7CiAgICB0LnVuZGVyc2NvcmUgPSA1NTY7CiAgICB0LnF1b3RlbGVmdCA9IDI3ODsKICAgIHQuYSA9IDU1NjsKICAgIHQuYiA9IDYxMTsKICAgIHQuYyA9IDU1NjsKICAgIHQuZCA9IDYxMTsKICAgIHQuZSA9IDU1NjsKICAgIHQuZiA9IDMzMzsKICAgIHQuZyA9IDYxMTsKICAgIHQuaCA9IDYxMTsKICAgIHQuaSA9IDI3ODsKICAgIHQuaiA9IDI3ODsKICAgIHQuayA9IDU1NjsKICAgIHQubCA9IDI3ODsKICAgIHQubSA9IDg4OTsKICAgIHQubiA9IDYxMTsKICAgIHQubyA9IDYxMTsKICAgIHQucCA9IDYxMTsKICAgIHQucSA9IDYxMTsKICAgIHQuciA9IDM4OTsKICAgIHQucyA9IDU1NjsKICAgIHQudCA9IDMzMzsKICAgIHQudSA9IDYxMTsKICAgIHQudiA9IDU1NjsKICAgIHQudyA9IDc3ODsKICAgIHQueCA9IDU1NjsKICAgIHQueSA9IDU1NjsKICAgIHQueiA9IDUwMDsKICAgIHQuYnJhY2VsZWZ0ID0gMzg5OwogICAgdC5iYXIgPSAyODA7CiAgICB0LmJyYWNlcmlnaHQgPSAzODk7CiAgICB0LmFzY2lpdGlsZGUgPSA1ODQ7CiAgICB0LmV4Y2xhbWRvd24gPSAzMzM7CiAgICB0LmNlbnQgPSA1NTY7CiAgICB0LnN0ZXJsaW5nID0gNTU2OwogICAgdC5mcmFjdGlvbiA9IDE2NzsKICAgIHQueWVuID0gNTU2OwogICAgdC5mbG9yaW4gPSA1NTY7CiAgICB0LnNlY3Rpb24gPSA1NTY7CiAgICB0LmN1cnJlbmN5ID0gNTU2OwogICAgdC5xdW90ZXNpbmdsZSA9IDIzODsKICAgIHQucXVvdGVkYmxsZWZ0ID0gNTAwOwogICAgdC5ndWlsbGVtb3RsZWZ0ID0gNTU2OwogICAgdC5ndWlsc2luZ2xsZWZ0ID0gMzMzOwogICAgdC5ndWlsc2luZ2xyaWdodCA9IDMzMzsKICAgIHQuZmkgPSA2MTE7CiAgICB0LmZsID0gNjExOwogICAgdC5lbmRhc2ggPSA1NTY7CiAgICB0LmRhZ2dlciA9IDU1NjsKICAgIHQuZGFnZ2VyZGJsID0gNTU2OwogICAgdC5wZXJpb2RjZW50ZXJlZCA9IDI3ODsKICAgIHQucGFyYWdyYXBoID0gNTU2OwogICAgdC5idWxsZXQgPSAzNTA7CiAgICB0LnF1b3Rlc2luZ2xiYXNlID0gMjc4OwogICAgdC5xdW90ZWRibGJhc2UgPSA1MDA7CiAgICB0LnF1b3RlZGJscmlnaHQgPSA1MDA7CiAgICB0Lmd1aWxsZW1vdHJpZ2h0ID0gNTU2OwogICAgdC5lbGxpcHNpcyA9IDEwMDA7CiAgICB0LnBlcnRob3VzYW5kID0gMTAwMDsKICAgIHQucXVlc3Rpb25kb3duID0gNjExOwogICAgdC5ncmF2ZSA9IDMzMzsKICAgIHQuYWN1dGUgPSAzMzM7CiAgICB0LmNpcmN1bWZsZXggPSAzMzM7CiAgICB0LnRpbGRlID0gMzMzOwogICAgdC5tYWNyb24gPSAzMzM7CiAgICB0LmJyZXZlID0gMzMzOwogICAgdC5kb3RhY2NlbnQgPSAzMzM7CiAgICB0LmRpZXJlc2lzID0gMzMzOwogICAgdC5yaW5nID0gMzMzOwogICAgdC5jZWRpbGxhID0gMzMzOwogICAgdC5odW5nYXJ1bWxhdXQgPSAzMzM7CiAgICB0Lm9nb25layA9IDMzMzsKICAgIHQuY2Fyb24gPSAzMzM7CiAgICB0LmVtZGFzaCA9IDEwMDA7CiAgICB0LkFFID0gMTAwMDsKICAgIHQub3JkZmVtaW5pbmUgPSAzNzA7CiAgICB0LkxzbGFzaCA9IDYxMTsKICAgIHQuT3NsYXNoID0gNzc4OwogICAgdC5PRSA9IDEwMDA7CiAgICB0Lm9yZG1hc2N1bGluZSA9IDM2NTsKICAgIHQuYWUgPSA4ODk7CiAgICB0LmRvdGxlc3NpID0gMjc4OwogICAgdC5sc2xhc2ggPSAyNzg7CiAgICB0Lm9zbGFzaCA9IDYxMTsKICAgIHQub2UgPSA5NDQ7CiAgICB0Lmdlcm1hbmRibHMgPSA2MTE7CiAgICB0LklkaWVyZXNpcyA9IDI3ODsKICAgIHQuZWFjdXRlID0gNTU2OwogICAgdC5hYnJldmUgPSA1NTY7CiAgICB0LnVodW5nYXJ1bWxhdXQgPSA2MTE7CiAgICB0LmVjYXJvbiA9IDU1NjsKICAgIHQuWWRpZXJlc2lzID0gNjY3OwogICAgdC5kaXZpZGUgPSA1ODQ7CiAgICB0LllhY3V0ZSA9IDY2NzsKICAgIHQuQWNpcmN1bWZsZXggPSA3MjI7CiAgICB0LmFhY3V0ZSA9IDU1NjsKICAgIHQuVWNpcmN1bWZsZXggPSA3MjI7CiAgICB0LnlhY3V0ZSA9IDU1NjsKICAgIHQuc2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5lY2lyY3VtZmxleCA9IDU1NjsKICAgIHQuVXJpbmcgPSA3MjI7CiAgICB0LlVkaWVyZXNpcyA9IDcyMjsKICAgIHQuYW9nb25layA9IDU1NjsKICAgIHQuVWFjdXRlID0gNzIyOwogICAgdC51b2dvbmVrID0gNjExOwogICAgdC5FZGllcmVzaXMgPSA2Njc7CiAgICB0LkRjcm9hdCA9IDcyMjsKICAgIHQuY29tbWFhY2NlbnQgPSAyNTA7CiAgICB0LmNvcHlyaWdodCA9IDczNzsKICAgIHQuRW1hY3JvbiA9IDY2NzsKICAgIHQuY2Nhcm9uID0gNTU2OwogICAgdC5hcmluZyA9IDU1NjsKICAgIHQuTmNvbW1hYWNjZW50ID0gNzIyOwogICAgdC5sYWN1dGUgPSAyNzg7CiAgICB0LmFncmF2ZSA9IDU1NjsKICAgIHQuVGNvbW1hYWNjZW50ID0gNjExOwogICAgdC5DYWN1dGUgPSA3MjI7CiAgICB0LmF0aWxkZSA9IDU1NjsKICAgIHQuRWRvdGFjY2VudCA9IDY2NzsKICAgIHQuc2Nhcm9uID0gNTU2OwogICAgdC5zY2VkaWxsYSA9IDU1NjsKICAgIHQuaWFjdXRlID0gMjc4OwogICAgdC5sb3plbmdlID0gNDk0OwogICAgdC5SY2Fyb24gPSA3MjI7CiAgICB0Lkdjb21tYWFjY2VudCA9IDc3ODsKICAgIHQudWNpcmN1bWZsZXggPSA2MTE7CiAgICB0LmFjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5BbWFjcm9uID0gNzIyOwogICAgdC5yY2Fyb24gPSAzODk7CiAgICB0LmNjZWRpbGxhID0gNTU2OwogICAgdC5aZG90YWNjZW50ID0gNjExOwogICAgdC5UaG9ybiA9IDY2NzsKICAgIHQuT21hY3JvbiA9IDc3ODsKICAgIHQuUmFjdXRlID0gNzIyOwogICAgdC5TYWN1dGUgPSA2Njc7CiAgICB0LmRjYXJvbiA9IDc0MzsKICAgIHQuVW1hY3JvbiA9IDcyMjsKICAgIHQudXJpbmcgPSA2MTE7CiAgICB0LnRocmVlc3VwZXJpb3IgPSAzMzM7CiAgICB0Lk9ncmF2ZSA9IDc3ODsKICAgIHQuQWdyYXZlID0gNzIyOwogICAgdC5BYnJldmUgPSA3MjI7CiAgICB0Lm11bHRpcGx5ID0gNTg0OwogICAgdC51YWN1dGUgPSA2MTE7CiAgICB0LlRjYXJvbiA9IDYxMTsKICAgIHQucGFydGlhbGRpZmYgPSA0OTQ7CiAgICB0LnlkaWVyZXNpcyA9IDU1NjsKICAgIHQuTmFjdXRlID0gNzIyOwogICAgdC5pY2lyY3VtZmxleCA9IDI3ODsKICAgIHQuRWNpcmN1bWZsZXggPSA2Njc7CiAgICB0LmFkaWVyZXNpcyA9IDU1NjsKICAgIHQuZWRpZXJlc2lzID0gNTU2OwogICAgdC5jYWN1dGUgPSA1NTY7CiAgICB0Lm5hY3V0ZSA9IDYxMTsKICAgIHQudW1hY3JvbiA9IDYxMTsKICAgIHQuTmNhcm9uID0gNzIyOwogICAgdC5JYWN1dGUgPSAyNzg7CiAgICB0LnBsdXNtaW51cyA9IDU4NDsKICAgIHQuYnJva2VuYmFyID0gMjgwOwogICAgdC5yZWdpc3RlcmVkID0gNzM3OwogICAgdC5HYnJldmUgPSA3Nzg7CiAgICB0Lklkb3RhY2NlbnQgPSAyNzg7CiAgICB0LnN1bW1hdGlvbiA9IDYwMDsKICAgIHQuRWdyYXZlID0gNjY3OwogICAgdC5yYWN1dGUgPSAzODk7CiAgICB0Lm9tYWNyb24gPSA2MTE7CiAgICB0LlphY3V0ZSA9IDYxMTsKICAgIHQuWmNhcm9uID0gNjExOwogICAgdC5ncmVhdGVyZXF1YWwgPSA1NDk7CiAgICB0LkV0aCA9IDcyMjsKICAgIHQuQ2NlZGlsbGEgPSA3MjI7CiAgICB0Lmxjb21tYWFjY2VudCA9IDI3ODsKICAgIHQudGNhcm9uID0gMzg5OwogICAgdC5lb2dvbmVrID0gNTU2OwogICAgdC5Vb2dvbmVrID0gNzIyOwogICAgdC5BYWN1dGUgPSA3MjI7CiAgICB0LkFkaWVyZXNpcyA9IDcyMjsKICAgIHQuZWdyYXZlID0gNTU2OwogICAgdC56YWN1dGUgPSA1MDA7CiAgICB0LmlvZ29uZWsgPSAyNzg7CiAgICB0Lk9hY3V0ZSA9IDc3ODsKICAgIHQub2FjdXRlID0gNjExOwogICAgdC5hbWFjcm9uID0gNTU2OwogICAgdC5zYWN1dGUgPSA1NTY7CiAgICB0LmlkaWVyZXNpcyA9IDI3ODsKICAgIHQuT2NpcmN1bWZsZXggPSA3Nzg7CiAgICB0LlVncmF2ZSA9IDcyMjsKICAgIHQuRGVsdGEgPSA2MTI7CiAgICB0LnRob3JuID0gNjExOwogICAgdC50d29zdXBlcmlvciA9IDMzMzsKICAgIHQuT2RpZXJlc2lzID0gNzc4OwogICAgdC5tdSA9IDYxMTsKICAgIHQuaWdyYXZlID0gMjc4OwogICAgdC5vaHVuZ2FydW1sYXV0ID0gNjExOwogICAgdC5Fb2dvbmVrID0gNjY3OwogICAgdC5kY3JvYXQgPSA2MTE7CiAgICB0LnRocmVlcXVhcnRlcnMgPSA4MzQ7CiAgICB0LlNjZWRpbGxhID0gNjY3OwogICAgdC5sY2Fyb24gPSA0MDA7CiAgICB0Lktjb21tYWFjY2VudCA9IDcyMjsKICAgIHQuTGFjdXRlID0gNjExOwogICAgdC50cmFkZW1hcmsgPSAxMDAwOwogICAgdC5lZG90YWNjZW50ID0gNTU2OwogICAgdC5JZ3JhdmUgPSAyNzg7CiAgICB0LkltYWNyb24gPSAyNzg7CiAgICB0LkxjYXJvbiA9IDYxMTsKICAgIHQub25laGFsZiA9IDgzNDsKICAgIHQubGVzc2VxdWFsID0gNTQ5OwogICAgdC5vY2lyY3VtZmxleCA9IDYxMTsKICAgIHQubnRpbGRlID0gNjExOwogICAgdC5VaHVuZ2FydW1sYXV0ID0gNzIyOwogICAgdC5FYWN1dGUgPSA2Njc7CiAgICB0LmVtYWNyb24gPSA1NTY7CiAgICB0LmdicmV2ZSA9IDYxMTsKICAgIHQub25lcXVhcnRlciA9IDgzNDsKICAgIHQuU2Nhcm9uID0gNjY3OwogICAgdC5TY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0Lk9odW5nYXJ1bWxhdXQgPSA3Nzg7CiAgICB0LmRlZ3JlZSA9IDQwMDsKICAgIHQub2dyYXZlID0gNjExOwogICAgdC5DY2Fyb24gPSA3MjI7CiAgICB0LnVncmF2ZSA9IDYxMTsKICAgIHQucmFkaWNhbCA9IDU0OTsKICAgIHQuRGNhcm9uID0gNzIyOwogICAgdC5yY29tbWFhY2NlbnQgPSAzODk7CiAgICB0Lk50aWxkZSA9IDcyMjsKICAgIHQub3RpbGRlID0gNjExOwogICAgdC5SY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0Lkxjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuQXRpbGRlID0gNzIyOwogICAgdC5Bb2dvbmVrID0gNzIyOwogICAgdC5BcmluZyA9IDcyMjsKICAgIHQuT3RpbGRlID0gNzc4OwogICAgdC56ZG90YWNjZW50ID0gNTAwOwogICAgdC5FY2Fyb24gPSA2Njc7CiAgICB0LklvZ29uZWsgPSAyNzg7CiAgICB0Lmtjb21tYWFjY2VudCA9IDU1NjsKICAgIHQubWludXMgPSA1ODQ7CiAgICB0LkljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5uY2Fyb24gPSA2MTE7CiAgICB0LnRjb21tYWFjY2VudCA9IDMzMzsKICAgIHQubG9naWNhbG5vdCA9IDU4NDsKICAgIHQub2RpZXJlc2lzID0gNjExOwogICAgdC51ZGllcmVzaXMgPSA2MTE7CiAgICB0Lm5vdGVxdWFsID0gNTQ5OwogICAgdC5nY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LmV0aCA9IDYxMTsKICAgIHQuemNhcm9uID0gNTAwOwogICAgdC5uY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0Lm9uZXN1cGVyaW9yID0gMzMzOwogICAgdC5pbWFjcm9uID0gMjc4OwogICAgdC5FdXJvID0gNTU2OwogIH0pOwogIHRbIkhlbHZldGljYS1PYmxpcXVlIl0gPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI3ODsKICAgIHQuZXhjbGFtID0gMjc4OwogICAgdC5xdW90ZWRibCA9IDM1NTsKICAgIHQubnVtYmVyc2lnbiA9IDU1NjsKICAgIHQuZG9sbGFyID0gNTU2OwogICAgdC5wZXJjZW50ID0gODg5OwogICAgdC5hbXBlcnNhbmQgPSA2Njc7CiAgICB0LnF1b3RlcmlnaHQgPSAyMjI7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2sgPSAzODk7CiAgICB0LnBsdXMgPSA1ODQ7CiAgICB0LmNvbW1hID0gMjc4OwogICAgdC5oeXBoZW4gPSAzMzM7CiAgICB0LnBlcmlvZCA9IDI3ODsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1NTY7CiAgICB0Lm9uZSA9IDU1NjsKICAgIHQudHdvID0gNTU2OwogICAgdC50aHJlZSA9IDU1NjsKICAgIHQuZm91ciA9IDU1NjsKICAgIHQuZml2ZSA9IDU1NjsKICAgIHQuc2l4ID0gNTU2OwogICAgdC5zZXZlbiA9IDU1NjsKICAgIHQuZWlnaHQgPSA1NTY7CiAgICB0Lm5pbmUgPSA1NTY7CiAgICB0LmNvbG9uID0gMjc4OwogICAgdC5zZW1pY29sb24gPSAyNzg7CiAgICB0Lmxlc3MgPSA1ODQ7CiAgICB0LmVxdWFsID0gNTg0OwogICAgdC5ncmVhdGVyID0gNTg0OwogICAgdC5xdWVzdGlvbiA9IDU1NjsKICAgIHQuYXQgPSAxMDE1OwogICAgdC5BID0gNjY3OwogICAgdC5CID0gNjY3OwogICAgdC5DID0gNzIyOwogICAgdC5EID0gNzIyOwogICAgdC5FID0gNjY3OwogICAgdC5GID0gNjExOwogICAgdC5HID0gNzc4OwogICAgdC5IID0gNzIyOwogICAgdC5JID0gMjc4OwogICAgdC5KID0gNTAwOwogICAgdC5LID0gNjY3OwogICAgdC5MID0gNTU2OwogICAgdC5NID0gODMzOwogICAgdC5OID0gNzIyOwogICAgdC5PID0gNzc4OwogICAgdC5QID0gNjY3OwogICAgdC5RID0gNzc4OwogICAgdC5SID0gNzIyOwogICAgdC5TID0gNjY3OwogICAgdC5UID0gNjExOwogICAgdC5VID0gNzIyOwogICAgdC5WID0gNjY3OwogICAgdC5XID0gOTQ0OwogICAgdC5YID0gNjY3OwogICAgdC5ZID0gNjY3OwogICAgdC5aID0gNjExOwogICAgdC5icmFja2V0bGVmdCA9IDI3ODsKICAgIHQuYmFja3NsYXNoID0gMjc4OwogICAgdC5icmFja2V0cmlnaHQgPSAyNzg7CiAgICB0LmFzY2lpY2lyY3VtID0gNDY5OwogICAgdC51bmRlcnNjb3JlID0gNTU2OwogICAgdC5xdW90ZWxlZnQgPSAyMjI7CiAgICB0LmEgPSA1NTY7CiAgICB0LmIgPSA1NTY7CiAgICB0LmMgPSA1MDA7CiAgICB0LmQgPSA1NTY7CiAgICB0LmUgPSA1NTY7CiAgICB0LmYgPSAyNzg7CiAgICB0LmcgPSA1NTY7CiAgICB0LmggPSA1NTY7CiAgICB0LmkgPSAyMjI7CiAgICB0LmogPSAyMjI7CiAgICB0LmsgPSA1MDA7CiAgICB0LmwgPSAyMjI7CiAgICB0Lm0gPSA4MzM7CiAgICB0Lm4gPSA1NTY7CiAgICB0Lm8gPSA1NTY7CiAgICB0LnAgPSA1NTY7CiAgICB0LnEgPSA1NTY7CiAgICB0LnIgPSAzMzM7CiAgICB0LnMgPSA1MDA7CiAgICB0LnQgPSAyNzg7CiAgICB0LnUgPSA1NTY7CiAgICB0LnYgPSA1MDA7CiAgICB0LncgPSA3MjI7CiAgICB0LnggPSA1MDA7CiAgICB0LnkgPSA1MDA7CiAgICB0LnogPSA1MDA7CiAgICB0LmJyYWNlbGVmdCA9IDMzNDsKICAgIHQuYmFyID0gMjYwOwogICAgdC5icmFjZXJpZ2h0ID0gMzM0OwogICAgdC5hc2NpaXRpbGRlID0gNTg0OwogICAgdC5leGNsYW1kb3duID0gMzMzOwogICAgdC5jZW50ID0gNTU2OwogICAgdC5zdGVybGluZyA9IDU1NjsKICAgIHQuZnJhY3Rpb24gPSAxNjc7CiAgICB0LnllbiA9IDU1NjsKICAgIHQuZmxvcmluID0gNTU2OwogICAgdC5zZWN0aW9uID0gNTU2OwogICAgdC5jdXJyZW5jeSA9IDU1NjsKICAgIHQucXVvdGVzaW5nbGUgPSAxOTE7CiAgICB0LnF1b3RlZGJsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbGxlbW90bGVmdCA9IDU1NjsKICAgIHQuZ3VpbHNpbmdsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbHNpbmdscmlnaHQgPSAzMzM7CiAgICB0LmZpID0gNTAwOwogICAgdC5mbCA9IDUwMDsKICAgIHQuZW5kYXNoID0gNTU2OwogICAgdC5kYWdnZXIgPSA1NTY7CiAgICB0LmRhZ2dlcmRibCA9IDU1NjsKICAgIHQucGVyaW9kY2VudGVyZWQgPSAyNzg7CiAgICB0LnBhcmFncmFwaCA9IDUzNzsKICAgIHQuYnVsbGV0ID0gMzUwOwogICAgdC5xdW90ZXNpbmdsYmFzZSA9IDIyMjsKICAgIHQucXVvdGVkYmxiYXNlID0gMzMzOwogICAgdC5xdW90ZWRibHJpZ2h0ID0gMzMzOwogICAgdC5ndWlsbGVtb3RyaWdodCA9IDU1NjsKICAgIHQuZWxsaXBzaXMgPSAxMDAwOwogICAgdC5wZXJ0aG91c2FuZCA9IDEwMDA7CiAgICB0LnF1ZXN0aW9uZG93biA9IDYxMTsKICAgIHQuZ3JhdmUgPSAzMzM7CiAgICB0LmFjdXRlID0gMzMzOwogICAgdC5jaXJjdW1mbGV4ID0gMzMzOwogICAgdC50aWxkZSA9IDMzMzsKICAgIHQubWFjcm9uID0gMzMzOwogICAgdC5icmV2ZSA9IDMzMzsKICAgIHQuZG90YWNjZW50ID0gMzMzOwogICAgdC5kaWVyZXNpcyA9IDMzMzsKICAgIHQucmluZyA9IDMzMzsKICAgIHQuY2VkaWxsYSA9IDMzMzsKICAgIHQuaHVuZ2FydW1sYXV0ID0gMzMzOwogICAgdC5vZ29uZWsgPSAzMzM7CiAgICB0LmNhcm9uID0gMzMzOwogICAgdC5lbWRhc2ggPSAxMDAwOwogICAgdC5BRSA9IDEwMDA7CiAgICB0Lm9yZGZlbWluaW5lID0gMzcwOwogICAgdC5Mc2xhc2ggPSA1NTY7CiAgICB0Lk9zbGFzaCA9IDc3ODsKICAgIHQuT0UgPSAxMDAwOwogICAgdC5vcmRtYXNjdWxpbmUgPSAzNjU7CiAgICB0LmFlID0gODg5OwogICAgdC5kb3RsZXNzaSA9IDI3ODsKICAgIHQubHNsYXNoID0gMjIyOwogICAgdC5vc2xhc2ggPSA2MTE7CiAgICB0Lm9lID0gOTQ0OwogICAgdC5nZXJtYW5kYmxzID0gNjExOwogICAgdC5JZGllcmVzaXMgPSAyNzg7CiAgICB0LmVhY3V0ZSA9IDU1NjsKICAgIHQuYWJyZXZlID0gNTU2OwogICAgdC51aHVuZ2FydW1sYXV0ID0gNTU2OwogICAgdC5lY2Fyb24gPSA1NTY7CiAgICB0LllkaWVyZXNpcyA9IDY2NzsKICAgIHQuZGl2aWRlID0gNTg0OwogICAgdC5ZYWN1dGUgPSA2Njc7CiAgICB0LkFjaXJjdW1mbGV4ID0gNjY3OwogICAgdC5hYWN1dGUgPSA1NTY7CiAgICB0LlVjaXJjdW1mbGV4ID0gNzIyOwogICAgdC55YWN1dGUgPSA1MDA7CiAgICB0LnNjb21tYWFjY2VudCA9IDUwMDsKICAgIHQuZWNpcmN1bWZsZXggPSA1NTY7CiAgICB0LlVyaW5nID0gNzIyOwogICAgdC5VZGllcmVzaXMgPSA3MjI7CiAgICB0LmFvZ29uZWsgPSA1NTY7CiAgICB0LlVhY3V0ZSA9IDcyMjsKICAgIHQudW9nb25layA9IDU1NjsKICAgIHQuRWRpZXJlc2lzID0gNjY3OwogICAgdC5EY3JvYXQgPSA3MjI7CiAgICB0LmNvbW1hYWNjZW50ID0gMjUwOwogICAgdC5jb3B5cmlnaHQgPSA3Mzc7CiAgICB0LkVtYWNyb24gPSA2Njc7CiAgICB0LmNjYXJvbiA9IDUwMDsKICAgIHQuYXJpbmcgPSA1NTY7CiAgICB0Lk5jb21tYWFjY2VudCA9IDcyMjsKICAgIHQubGFjdXRlID0gMjIyOwogICAgdC5hZ3JhdmUgPSA1NTY7CiAgICB0LlRjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuQ2FjdXRlID0gNzIyOwogICAgdC5hdGlsZGUgPSA1NTY7CiAgICB0LkVkb3RhY2NlbnQgPSA2Njc7CiAgICB0LnNjYXJvbiA9IDUwMDsKICAgIHQuc2NlZGlsbGEgPSA1MDA7CiAgICB0LmlhY3V0ZSA9IDI3ODsKICAgIHQubG96ZW5nZSA9IDQ3MTsKICAgIHQuUmNhcm9uID0gNzIyOwogICAgdC5HY29tbWFhY2NlbnQgPSA3Nzg7CiAgICB0LnVjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5hY2lyY3VtZmxleCA9IDU1NjsKICAgIHQuQW1hY3JvbiA9IDY2NzsKICAgIHQucmNhcm9uID0gMzMzOwogICAgdC5jY2VkaWxsYSA9IDUwMDsKICAgIHQuWmRvdGFjY2VudCA9IDYxMTsKICAgIHQuVGhvcm4gPSA2Njc7CiAgICB0Lk9tYWNyb24gPSA3Nzg7CiAgICB0LlJhY3V0ZSA9IDcyMjsKICAgIHQuU2FjdXRlID0gNjY3OwogICAgdC5kY2Fyb24gPSA2NDM7CiAgICB0LlVtYWNyb24gPSA3MjI7CiAgICB0LnVyaW5nID0gNTU2OwogICAgdC50aHJlZXN1cGVyaW9yID0gMzMzOwogICAgdC5PZ3JhdmUgPSA3Nzg7CiAgICB0LkFncmF2ZSA9IDY2NzsKICAgIHQuQWJyZXZlID0gNjY3OwogICAgdC5tdWx0aXBseSA9IDU4NDsKICAgIHQudWFjdXRlID0gNTU2OwogICAgdC5UY2Fyb24gPSA2MTE7CiAgICB0LnBhcnRpYWxkaWZmID0gNDc2OwogICAgdC55ZGllcmVzaXMgPSA1MDA7CiAgICB0Lk5hY3V0ZSA9IDcyMjsKICAgIHQuaWNpcmN1bWZsZXggPSAyNzg7CiAgICB0LkVjaXJjdW1mbGV4ID0gNjY3OwogICAgdC5hZGllcmVzaXMgPSA1NTY7CiAgICB0LmVkaWVyZXNpcyA9IDU1NjsKICAgIHQuY2FjdXRlID0gNTAwOwogICAgdC5uYWN1dGUgPSA1NTY7CiAgICB0LnVtYWNyb24gPSA1NTY7CiAgICB0Lk5jYXJvbiA9IDcyMjsKICAgIHQuSWFjdXRlID0gMjc4OwogICAgdC5wbHVzbWludXMgPSA1ODQ7CiAgICB0LmJyb2tlbmJhciA9IDI2MDsKICAgIHQucmVnaXN0ZXJlZCA9IDczNzsKICAgIHQuR2JyZXZlID0gNzc4OwogICAgdC5JZG90YWNjZW50ID0gMjc4OwogICAgdC5zdW1tYXRpb24gPSA2MDA7CiAgICB0LkVncmF2ZSA9IDY2NzsKICAgIHQucmFjdXRlID0gMzMzOwogICAgdC5vbWFjcm9uID0gNTU2OwogICAgdC5aYWN1dGUgPSA2MTE7CiAgICB0LlpjYXJvbiA9IDYxMTsKICAgIHQuZ3JlYXRlcmVxdWFsID0gNTQ5OwogICAgdC5FdGggPSA3MjI7CiAgICB0LkNjZWRpbGxhID0gNzIyOwogICAgdC5sY29tbWFhY2NlbnQgPSAyMjI7CiAgICB0LnRjYXJvbiA9IDMxNzsKICAgIHQuZW9nb25layA9IDU1NjsKICAgIHQuVW9nb25layA9IDcyMjsKICAgIHQuQWFjdXRlID0gNjY3OwogICAgdC5BZGllcmVzaXMgPSA2Njc7CiAgICB0LmVncmF2ZSA9IDU1NjsKICAgIHQuemFjdXRlID0gNTAwOwogICAgdC5pb2dvbmVrID0gMjIyOwogICAgdC5PYWN1dGUgPSA3Nzg7CiAgICB0Lm9hY3V0ZSA9IDU1NjsKICAgIHQuYW1hY3JvbiA9IDU1NjsKICAgIHQuc2FjdXRlID0gNTAwOwogICAgdC5pZGllcmVzaXMgPSAyNzg7CiAgICB0Lk9jaXJjdW1mbGV4ID0gNzc4OwogICAgdC5VZ3JhdmUgPSA3MjI7CiAgICB0LkRlbHRhID0gNjEyOwogICAgdC50aG9ybiA9IDU1NjsKICAgIHQudHdvc3VwZXJpb3IgPSAzMzM7CiAgICB0Lk9kaWVyZXNpcyA9IDc3ODsKICAgIHQubXUgPSA1NTY7CiAgICB0LmlncmF2ZSA9IDI3ODsKICAgIHQub2h1bmdhcnVtbGF1dCA9IDU1NjsKICAgIHQuRW9nb25layA9IDY2NzsKICAgIHQuZGNyb2F0ID0gNTU2OwogICAgdC50aHJlZXF1YXJ0ZXJzID0gODM0OwogICAgdC5TY2VkaWxsYSA9IDY2NzsKICAgIHQubGNhcm9uID0gMjk5OwogICAgdC5LY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0LkxhY3V0ZSA9IDU1NjsKICAgIHQudHJhZGVtYXJrID0gMTAwMDsKICAgIHQuZWRvdGFjY2VudCA9IDU1NjsKICAgIHQuSWdyYXZlID0gMjc4OwogICAgdC5JbWFjcm9uID0gMjc4OwogICAgdC5MY2Fyb24gPSA1NTY7CiAgICB0Lm9uZWhhbGYgPSA4MzQ7CiAgICB0Lmxlc3NlcXVhbCA9IDU0OTsKICAgIHQub2NpcmN1bWZsZXggPSA1NTY7CiAgICB0Lm50aWxkZSA9IDU1NjsKICAgIHQuVWh1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuRWFjdXRlID0gNjY3OwogICAgdC5lbWFjcm9uID0gNTU2OwogICAgdC5nYnJldmUgPSA1NTY7CiAgICB0Lm9uZXF1YXJ0ZXIgPSA4MzQ7CiAgICB0LlNjYXJvbiA9IDY2NzsKICAgIHQuU2NvbW1hYWNjZW50ID0gNjY3OwogICAgdC5PaHVuZ2FydW1sYXV0ID0gNzc4OwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0Lm9ncmF2ZSA9IDU1NjsKICAgIHQuQ2Nhcm9uID0gNzIyOwogICAgdC51Z3JhdmUgPSA1NTY7CiAgICB0LnJhZGljYWwgPSA0NTM7CiAgICB0LkRjYXJvbiA9IDcyMjsKICAgIHQucmNvbW1hYWNjZW50ID0gMzMzOwogICAgdC5OdGlsZGUgPSA3MjI7CiAgICB0Lm90aWxkZSA9IDU1NjsKICAgIHQuUmNvbW1hYWNjZW50ID0gNzIyOwogICAgdC5MY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LkF0aWxkZSA9IDY2NzsKICAgIHQuQW9nb25layA9IDY2NzsKICAgIHQuQXJpbmcgPSA2Njc7CiAgICB0Lk90aWxkZSA9IDc3ODsKICAgIHQuemRvdGFjY2VudCA9IDUwMDsKICAgIHQuRWNhcm9uID0gNjY3OwogICAgdC5Jb2dvbmVrID0gMjc4OwogICAgdC5rY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0Lm1pbnVzID0gNTg0OwogICAgdC5JY2lyY3VtZmxleCA9IDI3ODsKICAgIHQubmNhcm9uID0gNTU2OwogICAgdC50Y29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LmxvZ2ljYWxub3QgPSA1ODQ7CiAgICB0Lm9kaWVyZXNpcyA9IDU1NjsKICAgIHQudWRpZXJlc2lzID0gNTU2OwogICAgdC5ub3RlcXVhbCA9IDU0OTsKICAgIHQuZ2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5ldGggPSA1NTY7CiAgICB0LnpjYXJvbiA9IDUwMDsKICAgIHQubmNvbW1hYWNjZW50ID0gNTU2OwogICAgdC5vbmVzdXBlcmlvciA9IDMzMzsKICAgIHQuaW1hY3JvbiA9IDI3ODsKICAgIHQuRXVybyA9IDU1NjsKICB9KTsKICB0LlN5bWJvbCA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICB0LnNwYWNlID0gMjUwOwogICAgdC5leGNsYW0gPSAzMzM7CiAgICB0LnVuaXZlcnNhbCA9IDcxMzsKICAgIHQubnVtYmVyc2lnbiA9IDUwMDsKICAgIHQuZXhpc3RlbnRpYWwgPSA1NDk7CiAgICB0LnBlcmNlbnQgPSA4MzM7CiAgICB0LmFtcGVyc2FuZCA9IDc3ODsKICAgIHQuc3VjaHRoYXQgPSA0Mzk7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2ttYXRoID0gNTAwOwogICAgdC5wbHVzID0gNTQ5OwogICAgdC5jb21tYSA9IDI1MDsKICAgIHQubWludXMgPSA1NDk7CiAgICB0LnBlcmlvZCA9IDI1MDsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1MDA7CiAgICB0Lm9uZSA9IDUwMDsKICAgIHQudHdvID0gNTAwOwogICAgdC50aHJlZSA9IDUwMDsKICAgIHQuZm91ciA9IDUwMDsKICAgIHQuZml2ZSA9IDUwMDsKICAgIHQuc2l4ID0gNTAwOwogICAgdC5zZXZlbiA9IDUwMDsKICAgIHQuZWlnaHQgPSA1MDA7CiAgICB0Lm5pbmUgPSA1MDA7CiAgICB0LmNvbG9uID0gMjc4OwogICAgdC5zZW1pY29sb24gPSAyNzg7CiAgICB0Lmxlc3MgPSA1NDk7CiAgICB0LmVxdWFsID0gNTQ5OwogICAgdC5ncmVhdGVyID0gNTQ5OwogICAgdC5xdWVzdGlvbiA9IDQ0NDsKICAgIHQuY29uZ3J1ZW50ID0gNTQ5OwogICAgdC5BbHBoYSA9IDcyMjsKICAgIHQuQmV0YSA9IDY2NzsKICAgIHQuQ2hpID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQuRXBzaWxvbiA9IDYxMTsKICAgIHQuUGhpID0gNzYzOwogICAgdC5HYW1tYSA9IDYwMzsKICAgIHQuRXRhID0gNzIyOwogICAgdC5Jb3RhID0gMzMzOwogICAgdC50aGV0YTEgPSA2MzE7CiAgICB0LkthcHBhID0gNzIyOwogICAgdC5MYW1iZGEgPSA2ODY7CiAgICB0Lk11ID0gODg5OwogICAgdC5OdSA9IDcyMjsKICAgIHQuT21pY3JvbiA9IDcyMjsKICAgIHQuUGkgPSA3Njg7CiAgICB0LlRoZXRhID0gNzQxOwogICAgdC5SaG8gPSA1NTY7CiAgICB0LlNpZ21hID0gNTkyOwogICAgdC5UYXUgPSA2MTE7CiAgICB0LlVwc2lsb24gPSA2OTA7CiAgICB0LnNpZ21hMSA9IDQzOTsKICAgIHQuT21lZ2EgPSA3Njg7CiAgICB0LlhpID0gNjQ1OwogICAgdC5Qc2kgPSA3OTU7CiAgICB0LlpldGEgPSA2MTE7CiAgICB0LmJyYWNrZXRsZWZ0ID0gMzMzOwogICAgdC50aGVyZWZvcmUgPSA4NjM7CiAgICB0LmJyYWNrZXRyaWdodCA9IDMzMzsKICAgIHQucGVycGVuZGljdWxhciA9IDY1ODsKICAgIHQudW5kZXJzY29yZSA9IDUwMDsKICAgIHQucmFkaWNhbGV4ID0gNTAwOwogICAgdC5hbHBoYSA9IDYzMTsKICAgIHQuYmV0YSA9IDU0OTsKICAgIHQuY2hpID0gNTQ5OwogICAgdC5kZWx0YSA9IDQ5NDsKICAgIHQuZXBzaWxvbiA9IDQzOTsKICAgIHQucGhpID0gNTIxOwogICAgdC5nYW1tYSA9IDQxMTsKICAgIHQuZXRhID0gNjAzOwogICAgdC5pb3RhID0gMzI5OwogICAgdC5waGkxID0gNjAzOwogICAgdC5rYXBwYSA9IDU0OTsKICAgIHQubGFtYmRhID0gNTQ5OwogICAgdC5tdSA9IDU3NjsKICAgIHQubnUgPSA1MjE7CiAgICB0Lm9taWNyb24gPSA1NDk7CiAgICB0LnBpID0gNTQ5OwogICAgdC50aGV0YSA9IDUyMTsKICAgIHQucmhvID0gNTQ5OwogICAgdC5zaWdtYSA9IDYwMzsKICAgIHQudGF1ID0gNDM5OwogICAgdC51cHNpbG9uID0gNTc2OwogICAgdC5vbWVnYTEgPSA3MTM7CiAgICB0Lm9tZWdhID0gNjg2OwogICAgdC54aSA9IDQ5MzsKICAgIHQucHNpID0gNjg2OwogICAgdC56ZXRhID0gNDk0OwogICAgdC5icmFjZWxlZnQgPSA0ODA7CiAgICB0LmJhciA9IDIwMDsKICAgIHQuYnJhY2VyaWdodCA9IDQ4MDsKICAgIHQuc2ltaWxhciA9IDU0OTsKICAgIHQuRXVybyA9IDc1MDsKICAgIHQuVXBzaWxvbjEgPSA2MjA7CiAgICB0Lm1pbnV0ZSA9IDI0NzsKICAgIHQubGVzc2VxdWFsID0gNTQ5OwogICAgdC5mcmFjdGlvbiA9IDE2NzsKICAgIHQuaW5maW5pdHkgPSA3MTM7CiAgICB0LmZsb3JpbiA9IDUwMDsKICAgIHQuY2x1YiA9IDc1MzsKICAgIHQuZGlhbW9uZCA9IDc1MzsKICAgIHQuaGVhcnQgPSA3NTM7CiAgICB0LnNwYWRlID0gNzUzOwogICAgdC5hcnJvd2JvdGggPSAxMDQyOwogICAgdC5hcnJvd2xlZnQgPSA5ODc7CiAgICB0LmFycm93dXAgPSA2MDM7CiAgICB0LmFycm93cmlnaHQgPSA5ODc7CiAgICB0LmFycm93ZG93biA9IDYwMzsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5wbHVzbWludXMgPSA1NDk7CiAgICB0LnNlY29uZCA9IDQxMTsKICAgIHQuZ3JlYXRlcmVxdWFsID0gNTQ5OwogICAgdC5tdWx0aXBseSA9IDU0OTsKICAgIHQucHJvcG9ydGlvbmFsID0gNzEzOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ5NDsKICAgIHQuYnVsbGV0ID0gNDYwOwogICAgdC5kaXZpZGUgPSA1NDk7CiAgICB0Lm5vdGVxdWFsID0gNTQ5OwogICAgdC5lcXVpdmFsZW5jZSA9IDU0OTsKICAgIHQuYXBwcm94ZXF1YWwgPSA1NDk7CiAgICB0LmVsbGlwc2lzID0gMTAwMDsKICAgIHQuYXJyb3d2ZXJ0ZXggPSA2MDM7CiAgICB0LmFycm93aG9yaXpleCA9IDEwMDA7CiAgICB0LmNhcnJpYWdlcmV0dXJuID0gNjU4OwogICAgdC5hbGVwaCA9IDgyMzsKICAgIHQuSWZyYWt0dXIgPSA2ODY7CiAgICB0LlJmcmFrdHVyID0gNzk1OwogICAgdC53ZWllcnN0cmFzcyA9IDk4NzsKICAgIHQuY2lyY2xlbXVsdGlwbHkgPSA3Njg7CiAgICB0LmNpcmNsZXBsdXMgPSA3Njg7CiAgICB0LmVtcHR5c2V0ID0gODIzOwogICAgdC5pbnRlcnNlY3Rpb24gPSA3Njg7CiAgICB0LnVuaW9uID0gNzY4OwogICAgdC5wcm9wZXJzdXBlcnNldCA9IDcxMzsKICAgIHQucmVmbGV4c3VwZXJzZXQgPSA3MTM7CiAgICB0Lm5vdHN1YnNldCA9IDcxMzsKICAgIHQucHJvcGVyc3Vic2V0ID0gNzEzOwogICAgdC5yZWZsZXhzdWJzZXQgPSA3MTM7CiAgICB0LmVsZW1lbnQgPSA3MTM7CiAgICB0Lm5vdGVsZW1lbnQgPSA3MTM7CiAgICB0LmFuZ2xlID0gNzY4OwogICAgdC5ncmFkaWVudCA9IDcxMzsKICAgIHQucmVnaXN0ZXJzZXJpZiA9IDc5MDsKICAgIHQuY29weXJpZ2h0c2VyaWYgPSA3OTA7CiAgICB0LnRyYWRlbWFya3NlcmlmID0gODkwOwogICAgdC5wcm9kdWN0ID0gODIzOwogICAgdC5yYWRpY2FsID0gNTQ5OwogICAgdC5kb3RtYXRoID0gMjUwOwogICAgdC5sb2dpY2Fsbm90ID0gNzEzOwogICAgdC5sb2dpY2FsYW5kID0gNjAzOwogICAgdC5sb2dpY2Fsb3IgPSA2MDM7CiAgICB0LmFycm93ZGJsYm90aCA9IDEwNDI7CiAgICB0LmFycm93ZGJsbGVmdCA9IDk4NzsKICAgIHQuYXJyb3dkYmx1cCA9IDYwMzsKICAgIHQuYXJyb3dkYmxyaWdodCA9IDk4NzsKICAgIHQuYXJyb3dkYmxkb3duID0gNjAzOwogICAgdC5sb3plbmdlID0gNDk0OwogICAgdC5hbmdsZWxlZnQgPSAzMjk7CiAgICB0LnJlZ2lzdGVyc2FucyA9IDc5MDsKICAgIHQuY29weXJpZ2h0c2FucyA9IDc5MDsKICAgIHQudHJhZGVtYXJrc2FucyA9IDc4NjsKICAgIHQuc3VtbWF0aW9uID0gNzEzOwogICAgdC5wYXJlbmxlZnR0cCA9IDM4NDsKICAgIHQucGFyZW5sZWZ0ZXggPSAzODQ7CiAgICB0LnBhcmVubGVmdGJ0ID0gMzg0OwogICAgdC5icmFja2V0bGVmdHRwID0gMzg0OwogICAgdC5icmFja2V0bGVmdGV4ID0gMzg0OwogICAgdC5icmFja2V0bGVmdGJ0ID0gMzg0OwogICAgdC5icmFjZWxlZnR0cCA9IDQ5NDsKICAgIHQuYnJhY2VsZWZ0bWlkID0gNDk0OwogICAgdC5icmFjZWxlZnRidCA9IDQ5NDsKICAgIHQuYnJhY2VleCA9IDQ5NDsKICAgIHQuYW5nbGVyaWdodCA9IDMyOTsKICAgIHQuaW50ZWdyYWwgPSAyNzQ7CiAgICB0LmludGVncmFsdHAgPSA2ODY7CiAgICB0LmludGVncmFsZXggPSA2ODY7CiAgICB0LmludGVncmFsYnQgPSA2ODY7CiAgICB0LnBhcmVucmlnaHR0cCA9IDM4NDsKICAgIHQucGFyZW5yaWdodGV4ID0gMzg0OwogICAgdC5wYXJlbnJpZ2h0YnQgPSAzODQ7CiAgICB0LmJyYWNrZXRyaWdodHRwID0gMzg0OwogICAgdC5icmFja2V0cmlnaHRleCA9IDM4NDsKICAgIHQuYnJhY2tldHJpZ2h0YnQgPSAzODQ7CiAgICB0LmJyYWNlcmlnaHR0cCA9IDQ5NDsKICAgIHQuYnJhY2VyaWdodG1pZCA9IDQ5NDsKICAgIHQuYnJhY2VyaWdodGJ0ID0gNDk0OwogICAgdC5hcHBsZSA9IDc5MDsKICB9KTsKICB0WyJUaW1lcy1Sb21hbiJdID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgIHQuc3BhY2UgPSAyNTA7CiAgICB0LmV4Y2xhbSA9IDMzMzsKICAgIHQucXVvdGVkYmwgPSA0MDg7CiAgICB0Lm51bWJlcnNpZ24gPSA1MDA7CiAgICB0LmRvbGxhciA9IDUwMDsKICAgIHQucGVyY2VudCA9IDgzMzsKICAgIHQuYW1wZXJzYW5kID0gNzc4OwogICAgdC5xdW90ZXJpZ2h0ID0gMzMzOwogICAgdC5wYXJlbmxlZnQgPSAzMzM7CiAgICB0LnBhcmVucmlnaHQgPSAzMzM7CiAgICB0LmFzdGVyaXNrID0gNTAwOwogICAgdC5wbHVzID0gNTY0OwogICAgdC5jb21tYSA9IDI1MDsKICAgIHQuaHlwaGVuID0gMzMzOwogICAgdC5wZXJpb2QgPSAyNTA7CiAgICB0LnNsYXNoID0gMjc4OwogICAgdC56ZXJvID0gNTAwOwogICAgdC5vbmUgPSA1MDA7CiAgICB0LnR3byA9IDUwMDsKICAgIHQudGhyZWUgPSA1MDA7CiAgICB0LmZvdXIgPSA1MDA7CiAgICB0LmZpdmUgPSA1MDA7CiAgICB0LnNpeCA9IDUwMDsKICAgIHQuc2V2ZW4gPSA1MDA7CiAgICB0LmVpZ2h0ID0gNTAwOwogICAgdC5uaW5lID0gNTAwOwogICAgdC5jb2xvbiA9IDI3ODsKICAgIHQuc2VtaWNvbG9uID0gMjc4OwogICAgdC5sZXNzID0gNTY0OwogICAgdC5lcXVhbCA9IDU2NDsKICAgIHQuZ3JlYXRlciA9IDU2NDsKICAgIHQucXVlc3Rpb24gPSA0NDQ7CiAgICB0LmF0ID0gOTIxOwogICAgdC5BID0gNzIyOwogICAgdC5CID0gNjY3OwogICAgdC5DID0gNjY3OwogICAgdC5EID0gNzIyOwogICAgdC5FID0gNjExOwogICAgdC5GID0gNTU2OwogICAgdC5HID0gNzIyOwogICAgdC5IID0gNzIyOwogICAgdC5JID0gMzMzOwogICAgdC5KID0gMzg5OwogICAgdC5LID0gNzIyOwogICAgdC5MID0gNjExOwogICAgdC5NID0gODg5OwogICAgdC5OID0gNzIyOwogICAgdC5PID0gNzIyOwogICAgdC5QID0gNTU2OwogICAgdC5RID0gNzIyOwogICAgdC5SID0gNjY3OwogICAgdC5TID0gNTU2OwogICAgdC5UID0gNjExOwogICAgdC5VID0gNzIyOwogICAgdC5WID0gNzIyOwogICAgdC5XID0gOTQ0OwogICAgdC5YID0gNzIyOwogICAgdC5ZID0gNzIyOwogICAgdC5aID0gNjExOwogICAgdC5icmFja2V0bGVmdCA9IDMzMzsKICAgIHQuYmFja3NsYXNoID0gMjc4OwogICAgdC5icmFja2V0cmlnaHQgPSAzMzM7CiAgICB0LmFzY2lpY2lyY3VtID0gNDY5OwogICAgdC51bmRlcnNjb3JlID0gNTAwOwogICAgdC5xdW90ZWxlZnQgPSAzMzM7CiAgICB0LmEgPSA0NDQ7CiAgICB0LmIgPSA1MDA7CiAgICB0LmMgPSA0NDQ7CiAgICB0LmQgPSA1MDA7CiAgICB0LmUgPSA0NDQ7CiAgICB0LmYgPSAzMzM7CiAgICB0LmcgPSA1MDA7CiAgICB0LmggPSA1MDA7CiAgICB0LmkgPSAyNzg7CiAgICB0LmogPSAyNzg7CiAgICB0LmsgPSA1MDA7CiAgICB0LmwgPSAyNzg7CiAgICB0Lm0gPSA3Nzg7CiAgICB0Lm4gPSA1MDA7CiAgICB0Lm8gPSA1MDA7CiAgICB0LnAgPSA1MDA7CiAgICB0LnEgPSA1MDA7CiAgICB0LnIgPSAzMzM7CiAgICB0LnMgPSAzODk7CiAgICB0LnQgPSAyNzg7CiAgICB0LnUgPSA1MDA7CiAgICB0LnYgPSA1MDA7CiAgICB0LncgPSA3MjI7CiAgICB0LnggPSA1MDA7CiAgICB0LnkgPSA1MDA7CiAgICB0LnogPSA0NDQ7CiAgICB0LmJyYWNlbGVmdCA9IDQ4MDsKICAgIHQuYmFyID0gMjAwOwogICAgdC5icmFjZXJpZ2h0ID0gNDgwOwogICAgdC5hc2NpaXRpbGRlID0gNTQxOwogICAgdC5leGNsYW1kb3duID0gMzMzOwogICAgdC5jZW50ID0gNTAwOwogICAgdC5zdGVybGluZyA9IDUwMDsKICAgIHQuZnJhY3Rpb24gPSAxNjc7CiAgICB0LnllbiA9IDUwMDsKICAgIHQuZmxvcmluID0gNTAwOwogICAgdC5zZWN0aW9uID0gNTAwOwogICAgdC5jdXJyZW5jeSA9IDUwMDsKICAgIHQucXVvdGVzaW5nbGUgPSAxODA7CiAgICB0LnF1b3RlZGJsbGVmdCA9IDQ0NDsKICAgIHQuZ3VpbGxlbW90bGVmdCA9IDUwMDsKICAgIHQuZ3VpbHNpbmdsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbHNpbmdscmlnaHQgPSAzMzM7CiAgICB0LmZpID0gNTU2OwogICAgdC5mbCA9IDU1NjsKICAgIHQuZW5kYXNoID0gNTAwOwogICAgdC5kYWdnZXIgPSA1MDA7CiAgICB0LmRhZ2dlcmRibCA9IDUwMDsKICAgIHQucGVyaW9kY2VudGVyZWQgPSAyNTA7CiAgICB0LnBhcmFncmFwaCA9IDQ1MzsKICAgIHQuYnVsbGV0ID0gMzUwOwogICAgdC5xdW90ZXNpbmdsYmFzZSA9IDMzMzsKICAgIHQucXVvdGVkYmxiYXNlID0gNDQ0OwogICAgdC5xdW90ZWRibHJpZ2h0ID0gNDQ0OwogICAgdC5ndWlsbGVtb3RyaWdodCA9IDUwMDsKICAgIHQuZWxsaXBzaXMgPSAxMDAwOwogICAgdC5wZXJ0aG91c2FuZCA9IDEwMDA7CiAgICB0LnF1ZXN0aW9uZG93biA9IDQ0NDsKICAgIHQuZ3JhdmUgPSAzMzM7CiAgICB0LmFjdXRlID0gMzMzOwogICAgdC5jaXJjdW1mbGV4ID0gMzMzOwogICAgdC50aWxkZSA9IDMzMzsKICAgIHQubWFjcm9uID0gMzMzOwogICAgdC5icmV2ZSA9IDMzMzsKICAgIHQuZG90YWNjZW50ID0gMzMzOwogICAgdC5kaWVyZXNpcyA9IDMzMzsKICAgIHQucmluZyA9IDMzMzsKICAgIHQuY2VkaWxsYSA9IDMzMzsKICAgIHQuaHVuZ2FydW1sYXV0ID0gMzMzOwogICAgdC5vZ29uZWsgPSAzMzM7CiAgICB0LmNhcm9uID0gMzMzOwogICAgdC5lbWRhc2ggPSAxMDAwOwogICAgdC5BRSA9IDg4OTsKICAgIHQub3JkZmVtaW5pbmUgPSAyNzY7CiAgICB0LkxzbGFzaCA9IDYxMTsKICAgIHQuT3NsYXNoID0gNzIyOwogICAgdC5PRSA9IDg4OTsKICAgIHQub3JkbWFzY3VsaW5lID0gMzEwOwogICAgdC5hZSA9IDY2NzsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNTAwOwogICAgdC5vZSA9IDcyMjsKICAgIHQuZ2VybWFuZGJscyA9IDUwMDsKICAgIHQuSWRpZXJlc2lzID0gMzMzOwogICAgdC5lYWN1dGUgPSA0NDQ7CiAgICB0LmFicmV2ZSA9IDQ0NDsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDUwMDsKICAgIHQuZWNhcm9uID0gNDQ0OwogICAgdC5ZZGllcmVzaXMgPSA3MjI7CiAgICB0LmRpdmlkZSA9IDU2NDsKICAgIHQuWWFjdXRlID0gNzIyOwogICAgdC5BY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuYWFjdXRlID0gNDQ0OwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNTAwOwogICAgdC5zY29tbWFhY2NlbnQgPSAzODk7CiAgICB0LmVjaXJjdW1mbGV4ID0gNDQ0OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNDQ0OwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA1MDA7CiAgICB0LkVkaWVyZXNpcyA9IDYxMTsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzYwOwogICAgdC5FbWFjcm9uID0gNjExOwogICAgdC5jY2Fyb24gPSA0NDQ7CiAgICB0LmFyaW5nID0gNDQ0OwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNDQ0OwogICAgdC5UY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkNhY3V0ZSA9IDY2NzsKICAgIHQuYXRpbGRlID0gNDQ0OwogICAgdC5FZG90YWNjZW50ID0gNjExOwogICAgdC5zY2Fyb24gPSAzODk7CiAgICB0LnNjZWRpbGxhID0gMzg5OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0NzE7CiAgICB0LlJjYXJvbiA9IDY2NzsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC51Y2lyY3VtZmxleCA9IDUwMDsKICAgIHQuYWNpcmN1bWZsZXggPSA0NDQ7CiAgICB0LkFtYWNyb24gPSA3MjI7CiAgICB0LnJjYXJvbiA9IDMzMzsKICAgIHQuY2NlZGlsbGEgPSA0NDQ7CiAgICB0Llpkb3RhY2NlbnQgPSA2MTE7CiAgICB0LlRob3JuID0gNTU2OwogICAgdC5PbWFjcm9uID0gNzIyOwogICAgdC5SYWN1dGUgPSA2Njc7CiAgICB0LlNhY3V0ZSA9IDU1NjsKICAgIHQuZGNhcm9uID0gNTg4OwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDUwMDsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMwMDsKICAgIHQuT2dyYXZlID0gNzIyOwogICAgdC5BZ3JhdmUgPSA3MjI7CiAgICB0LkFicmV2ZSA9IDcyMjsKICAgIHQubXVsdGlwbHkgPSA1NjQ7CiAgICB0LnVhY3V0ZSA9IDUwMDsKICAgIHQuVGNhcm9uID0gNjExOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ3NjsKICAgIHQueWRpZXJlc2lzID0gNTAwOwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDYxMTsKICAgIHQuYWRpZXJlc2lzID0gNDQ0OwogICAgdC5lZGllcmVzaXMgPSA0NDQ7CiAgICB0LmNhY3V0ZSA9IDQ0NDsKICAgIHQubmFjdXRlID0gNTAwOwogICAgdC51bWFjcm9uID0gNTAwOwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDMzMzsKICAgIHQucGx1c21pbnVzID0gNTY0OwogICAgdC5icm9rZW5iYXIgPSAyMDA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3NjA7CiAgICB0LkdicmV2ZSA9IDcyMjsKICAgIHQuSWRvdGFjY2VudCA9IDMzMzsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2MTE7CiAgICB0LnJhY3V0ZSA9IDMzMzsKICAgIHQub21hY3JvbiA9IDUwMDsKICAgIHQuWmFjdXRlID0gNjExOwogICAgdC5aY2Fyb24gPSA2MTE7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDY2NzsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSAzMjY7CiAgICB0LmVvZ29uZWsgPSA0NDQ7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDcyMjsKICAgIHQuQWRpZXJlc2lzID0gNzIyOwogICAgdC5lZ3JhdmUgPSA0NDQ7CiAgICB0LnphY3V0ZSA9IDQ0NDsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzIyOwogICAgdC5vYWN1dGUgPSA1MDA7CiAgICB0LmFtYWNyb24gPSA0NDQ7CiAgICB0LnNhY3V0ZSA9IDM4OTsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA1MDA7CiAgICB0LnR3b3N1cGVyaW9yID0gMzAwOwogICAgdC5PZGllcmVzaXMgPSA3MjI7CiAgICB0Lm11ID0gNTAwOwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA1MDA7CiAgICB0LkVvZ29uZWsgPSA2MTE7CiAgICB0LmRjcm9hdCA9IDUwMDsKICAgIHQudGhyZWVxdWFydGVycyA9IDc1MDsKICAgIHQuU2NlZGlsbGEgPSA1NTY7CiAgICB0LmxjYXJvbiA9IDM0NDsKICAgIHQuS2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC5MYWN1dGUgPSA2MTE7CiAgICB0LnRyYWRlbWFyayA9IDk4MDsKICAgIHQuZWRvdGFjY2VudCA9IDQ0NDsKICAgIHQuSWdyYXZlID0gMzMzOwogICAgdC5JbWFjcm9uID0gMzMzOwogICAgdC5MY2Fyb24gPSA2MTE7CiAgICB0Lm9uZWhhbGYgPSA3NTA7CiAgICB0Lmxlc3NlcXVhbCA9IDU0OTsKICAgIHQub2NpcmN1bWZsZXggPSA1MDA7CiAgICB0Lm50aWxkZSA9IDUwMDsKICAgIHQuVWh1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuRWFjdXRlID0gNjExOwogICAgdC5lbWFjcm9uID0gNDQ0OwogICAgdC5nYnJldmUgPSA1MDA7CiAgICB0Lm9uZXF1YXJ0ZXIgPSA3NTA7CiAgICB0LlNjYXJvbiA9IDU1NjsKICAgIHQuU2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5PaHVuZ2FydW1sYXV0ID0gNzIyOwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0Lm9ncmF2ZSA9IDUwMDsKICAgIHQuQ2Nhcm9uID0gNjY3OwogICAgdC51Z3JhdmUgPSA1MDA7CiAgICB0LnJhZGljYWwgPSA0NTM7CiAgICB0LkRjYXJvbiA9IDcyMjsKICAgIHQucmNvbW1hYWNjZW50ID0gMzMzOwogICAgdC5OdGlsZGUgPSA3MjI7CiAgICB0Lm90aWxkZSA9IDUwMDsKICAgIHQuUmNvbW1hYWNjZW50ID0gNjY3OwogICAgdC5MY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkF0aWxkZSA9IDcyMjsKICAgIHQuQW9nb25layA9IDcyMjsKICAgIHQuQXJpbmcgPSA3MjI7CiAgICB0Lk90aWxkZSA9IDcyMjsKICAgIHQuemRvdGFjY2VudCA9IDQ0NDsKICAgIHQuRWNhcm9uID0gNjExOwogICAgdC5Jb2dvbmVrID0gMzMzOwogICAgdC5rY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0Lm1pbnVzID0gNTY0OwogICAgdC5JY2lyY3VtZmxleCA9IDMzMzsKICAgIHQubmNhcm9uID0gNTAwOwogICAgdC50Y29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LmxvZ2ljYWxub3QgPSA1NjQ7CiAgICB0Lm9kaWVyZXNpcyA9IDUwMDsKICAgIHQudWRpZXJlc2lzID0gNTAwOwogICAgdC5ub3RlcXVhbCA9IDU0OTsKICAgIHQuZ2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5ldGggPSA1MDA7CiAgICB0LnpjYXJvbiA9IDQ0NDsKICAgIHQubmNvbW1hYWNjZW50ID0gNTAwOwogICAgdC5vbmVzdXBlcmlvciA9IDMwMDsKICAgIHQuaW1hY3JvbiA9IDI3ODsKICAgIHQuRXVybyA9IDUwMDsKICB9KTsKICB0WyJUaW1lcy1Cb2xkIl0gPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI1MDsKICAgIHQuZXhjbGFtID0gMzMzOwogICAgdC5xdW90ZWRibCA9IDU1NTsKICAgIHQubnVtYmVyc2lnbiA9IDUwMDsKICAgIHQuZG9sbGFyID0gNTAwOwogICAgdC5wZXJjZW50ID0gMTAwMDsKICAgIHQuYW1wZXJzYW5kID0gODMzOwogICAgdC5xdW90ZXJpZ2h0ID0gMzMzOwogICAgdC5wYXJlbmxlZnQgPSAzMzM7CiAgICB0LnBhcmVucmlnaHQgPSAzMzM7CiAgICB0LmFzdGVyaXNrID0gNTAwOwogICAgdC5wbHVzID0gNTcwOwogICAgdC5jb21tYSA9IDI1MDsKICAgIHQuaHlwaGVuID0gMzMzOwogICAgdC5wZXJpb2QgPSAyNTA7CiAgICB0LnNsYXNoID0gMjc4OwogICAgdC56ZXJvID0gNTAwOwogICAgdC5vbmUgPSA1MDA7CiAgICB0LnR3byA9IDUwMDsKICAgIHQudGhyZWUgPSA1MDA7CiAgICB0LmZvdXIgPSA1MDA7CiAgICB0LmZpdmUgPSA1MDA7CiAgICB0LnNpeCA9IDUwMDsKICAgIHQuc2V2ZW4gPSA1MDA7CiAgICB0LmVpZ2h0ID0gNTAwOwogICAgdC5uaW5lID0gNTAwOwogICAgdC5jb2xvbiA9IDMzMzsKICAgIHQuc2VtaWNvbG9uID0gMzMzOwogICAgdC5sZXNzID0gNTcwOwogICAgdC5lcXVhbCA9IDU3MDsKICAgIHQuZ3JlYXRlciA9IDU3MDsKICAgIHQucXVlc3Rpb24gPSA1MDA7CiAgICB0LmF0ID0gOTMwOwogICAgdC5BID0gNzIyOwogICAgdC5CID0gNjY3OwogICAgdC5DID0gNzIyOwogICAgdC5EID0gNzIyOwogICAgdC5FID0gNjY3OwogICAgdC5GID0gNjExOwogICAgdC5HID0gNzc4OwogICAgdC5IID0gNzc4OwogICAgdC5JID0gMzg5OwogICAgdC5KID0gNTAwOwogICAgdC5LID0gNzc4OwogICAgdC5MID0gNjY3OwogICAgdC5NID0gOTQ0OwogICAgdC5OID0gNzIyOwogICAgdC5PID0gNzc4OwogICAgdC5QID0gNjExOwogICAgdC5RID0gNzc4OwogICAgdC5SID0gNzIyOwogICAgdC5TID0gNTU2OwogICAgdC5UID0gNjY3OwogICAgdC5VID0gNzIyOwogICAgdC5WID0gNzIyOwogICAgdC5XID0gMTAwMDsKICAgIHQuWCA9IDcyMjsKICAgIHQuWSA9IDcyMjsKICAgIHQuWiA9IDY2NzsKICAgIHQuYnJhY2tldGxlZnQgPSAzMzM7CiAgICB0LmJhY2tzbGFzaCA9IDI3ODsKICAgIHQuYnJhY2tldHJpZ2h0ID0gMzMzOwogICAgdC5hc2NpaWNpcmN1bSA9IDU4MTsKICAgIHQudW5kZXJzY29yZSA9IDUwMDsKICAgIHQucXVvdGVsZWZ0ID0gMzMzOwogICAgdC5hID0gNTAwOwogICAgdC5iID0gNTU2OwogICAgdC5jID0gNDQ0OwogICAgdC5kID0gNTU2OwogICAgdC5lID0gNDQ0OwogICAgdC5mID0gMzMzOwogICAgdC5nID0gNTAwOwogICAgdC5oID0gNTU2OwogICAgdC5pID0gMjc4OwogICAgdC5qID0gMzMzOwogICAgdC5rID0gNTU2OwogICAgdC5sID0gMjc4OwogICAgdC5tID0gODMzOwogICAgdC5uID0gNTU2OwogICAgdC5vID0gNTAwOwogICAgdC5wID0gNTU2OwogICAgdC5xID0gNTU2OwogICAgdC5yID0gNDQ0OwogICAgdC5zID0gMzg5OwogICAgdC50ID0gMzMzOwogICAgdC51ID0gNTU2OwogICAgdC52ID0gNTAwOwogICAgdC53ID0gNzIyOwogICAgdC54ID0gNTAwOwogICAgdC55ID0gNTAwOwogICAgdC56ID0gNDQ0OwogICAgdC5icmFjZWxlZnQgPSAzOTQ7CiAgICB0LmJhciA9IDIyMDsKICAgIHQuYnJhY2VyaWdodCA9IDM5NDsKICAgIHQuYXNjaWl0aWxkZSA9IDUyMDsKICAgIHQuZXhjbGFtZG93biA9IDMzMzsKICAgIHQuY2VudCA9IDUwMDsKICAgIHQuc3RlcmxpbmcgPSA1MDA7CiAgICB0LmZyYWN0aW9uID0gMTY3OwogICAgdC55ZW4gPSA1MDA7CiAgICB0LmZsb3JpbiA9IDUwMDsKICAgIHQuc2VjdGlvbiA9IDUwMDsKICAgIHQuY3VycmVuY3kgPSA1MDA7CiAgICB0LnF1b3Rlc2luZ2xlID0gMjc4OwogICAgdC5xdW90ZWRibGxlZnQgPSA1MDA7CiAgICB0Lmd1aWxsZW1vdGxlZnQgPSA1MDA7CiAgICB0Lmd1aWxzaW5nbGxlZnQgPSAzMzM7CiAgICB0Lmd1aWxzaW5nbHJpZ2h0ID0gMzMzOwogICAgdC5maSA9IDU1NjsKICAgIHQuZmwgPSA1NTY7CiAgICB0LmVuZGFzaCA9IDUwMDsKICAgIHQuZGFnZ2VyID0gNTAwOwogICAgdC5kYWdnZXJkYmwgPSA1MDA7CiAgICB0LnBlcmlvZGNlbnRlcmVkID0gMjUwOwogICAgdC5wYXJhZ3JhcGggPSA1NDA7CiAgICB0LmJ1bGxldCA9IDM1MDsKICAgIHQucXVvdGVzaW5nbGJhc2UgPSAzMzM7CiAgICB0LnF1b3RlZGJsYmFzZSA9IDUwMDsKICAgIHQucXVvdGVkYmxyaWdodCA9IDUwMDsKICAgIHQuZ3VpbGxlbW90cmlnaHQgPSA1MDA7CiAgICB0LmVsbGlwc2lzID0gMTAwMDsKICAgIHQucGVydGhvdXNhbmQgPSAxMDAwOwogICAgdC5xdWVzdGlvbmRvd24gPSA1MDA7CiAgICB0LmdyYXZlID0gMzMzOwogICAgdC5hY3V0ZSA9IDMzMzsKICAgIHQuY2lyY3VtZmxleCA9IDMzMzsKICAgIHQudGlsZGUgPSAzMzM7CiAgICB0Lm1hY3JvbiA9IDMzMzsKICAgIHQuYnJldmUgPSAzMzM7CiAgICB0LmRvdGFjY2VudCA9IDMzMzsKICAgIHQuZGllcmVzaXMgPSAzMzM7CiAgICB0LnJpbmcgPSAzMzM7CiAgICB0LmNlZGlsbGEgPSAzMzM7CiAgICB0Lmh1bmdhcnVtbGF1dCA9IDMzMzsKICAgIHQub2dvbmVrID0gMzMzOwogICAgdC5jYXJvbiA9IDMzMzsKICAgIHQuZW1kYXNoID0gMTAwMDsKICAgIHQuQUUgPSAxMDAwOwogICAgdC5vcmRmZW1pbmluZSA9IDMwMDsKICAgIHQuTHNsYXNoID0gNjY3OwogICAgdC5Pc2xhc2ggPSA3Nzg7CiAgICB0Lk9FID0gMTAwMDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzMwOwogICAgdC5hZSA9IDcyMjsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNTAwOwogICAgdC5vZSA9IDcyMjsKICAgIHQuZ2VybWFuZGJscyA9IDU1NjsKICAgIHQuSWRpZXJlc2lzID0gMzg5OwogICAgdC5lYWN1dGUgPSA0NDQ7CiAgICB0LmFicmV2ZSA9IDUwMDsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDU1NjsKICAgIHQuZWNhcm9uID0gNDQ0OwogICAgdC5ZZGllcmVzaXMgPSA3MjI7CiAgICB0LmRpdmlkZSA9IDU3MDsKICAgIHQuWWFjdXRlID0gNzIyOwogICAgdC5BY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuYWFjdXRlID0gNTAwOwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNTAwOwogICAgdC5zY29tbWFhY2NlbnQgPSAzODk7CiAgICB0LmVjaXJjdW1mbGV4ID0gNDQ0OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTAwOwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA1NTY7CiAgICB0LkVkaWVyZXNpcyA9IDY2NzsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzQ3OwogICAgdC5FbWFjcm9uID0gNjY3OwogICAgdC5jY2Fyb24gPSA0NDQ7CiAgICB0LmFyaW5nID0gNTAwOwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNTAwOwogICAgdC5UY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0LkNhY3V0ZSA9IDcyMjsKICAgIHQuYXRpbGRlID0gNTAwOwogICAgdC5FZG90YWNjZW50ID0gNjY3OwogICAgdC5zY2Fyb24gPSAzODk7CiAgICB0LnNjZWRpbGxhID0gMzg5OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0OTQ7CiAgICB0LlJjYXJvbiA9IDcyMjsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzc4OwogICAgdC51Y2lyY3VtZmxleCA9IDU1NjsKICAgIHQuYWNpcmN1bWZsZXggPSA1MDA7CiAgICB0LkFtYWNyb24gPSA3MjI7CiAgICB0LnJjYXJvbiA9IDQ0NDsKICAgIHQuY2NlZGlsbGEgPSA0NDQ7CiAgICB0Llpkb3RhY2NlbnQgPSA2Njc7CiAgICB0LlRob3JuID0gNjExOwogICAgdC5PbWFjcm9uID0gNzc4OwogICAgdC5SYWN1dGUgPSA3MjI7CiAgICB0LlNhY3V0ZSA9IDU1NjsKICAgIHQuZGNhcm9uID0gNjcyOwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDU1NjsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMwMDsKICAgIHQuT2dyYXZlID0gNzc4OwogICAgdC5BZ3JhdmUgPSA3MjI7CiAgICB0LkFicmV2ZSA9IDcyMjsKICAgIHQubXVsdGlwbHkgPSA1NzA7CiAgICB0LnVhY3V0ZSA9IDU1NjsKICAgIHQuVGNhcm9uID0gNjY3OwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ5NDsKICAgIHQueWRpZXJlc2lzID0gNTAwOwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWRpZXJlc2lzID0gNTAwOwogICAgdC5lZGllcmVzaXMgPSA0NDQ7CiAgICB0LmNhY3V0ZSA9IDQ0NDsKICAgIHQubmFjdXRlID0gNTU2OwogICAgdC51bWFjcm9uID0gNTU2OwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDM4OTsKICAgIHQucGx1c21pbnVzID0gNTcwOwogICAgdC5icm9rZW5iYXIgPSAyMjA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3NDc7CiAgICB0LkdicmV2ZSA9IDc3ODsKICAgIHQuSWRvdGFjY2VudCA9IDM4OTsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2Njc7CiAgICB0LnJhY3V0ZSA9IDQ0NDsKICAgIHQub21hY3JvbiA9IDUwMDsKICAgIHQuWmFjdXRlID0gNjY3OwogICAgdC5aY2Fyb24gPSA2Njc7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDcyMjsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSA0MTY7CiAgICB0LmVvZ29uZWsgPSA0NDQ7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDcyMjsKICAgIHQuQWRpZXJlc2lzID0gNzIyOwogICAgdC5lZ3JhdmUgPSA0NDQ7CiAgICB0LnphY3V0ZSA9IDQ0NDsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzc4OwogICAgdC5vYWN1dGUgPSA1MDA7CiAgICB0LmFtYWNyb24gPSA1MDA7CiAgICB0LnNhY3V0ZSA9IDM4OTsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDc3ODsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA1NTY7CiAgICB0LnR3b3N1cGVyaW9yID0gMzAwOwogICAgdC5PZGllcmVzaXMgPSA3Nzg7CiAgICB0Lm11ID0gNTU2OwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA1MDA7CiAgICB0LkVvZ29uZWsgPSA2Njc7CiAgICB0LmRjcm9hdCA9IDU1NjsKICAgIHQudGhyZWVxdWFydGVycyA9IDc1MDsKICAgIHQuU2NlZGlsbGEgPSA1NTY7CiAgICB0LmxjYXJvbiA9IDM5NDsKICAgIHQuS2NvbW1hYWNjZW50ID0gNzc4OwogICAgdC5MYWN1dGUgPSA2Njc7CiAgICB0LnRyYWRlbWFyayA9IDEwMDA7CiAgICB0LmVkb3RhY2NlbnQgPSA0NDQ7CiAgICB0LklncmF2ZSA9IDM4OTsKICAgIHQuSW1hY3JvbiA9IDM4OTsKICAgIHQuTGNhcm9uID0gNjY3OwogICAgdC5vbmVoYWxmID0gNzUwOwogICAgdC5sZXNzZXF1YWwgPSA1NDk7CiAgICB0Lm9jaXJjdW1mbGV4ID0gNTAwOwogICAgdC5udGlsZGUgPSA1NTY7CiAgICB0LlVodW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LkVhY3V0ZSA9IDY2NzsKICAgIHQuZW1hY3JvbiA9IDQ0NDsKICAgIHQuZ2JyZXZlID0gNTAwOwogICAgdC5vbmVxdWFydGVyID0gNzUwOwogICAgdC5TY2Fyb24gPSA1NTY7CiAgICB0LlNjb21tYWFjY2VudCA9IDU1NjsKICAgIHQuT2h1bmdhcnVtbGF1dCA9IDc3ODsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5vZ3JhdmUgPSA1MDA7CiAgICB0LkNjYXJvbiA9IDcyMjsKICAgIHQudWdyYXZlID0gNTU2OwogICAgdC5yYWRpY2FsID0gNTQ5OwogICAgdC5EY2Fyb24gPSA3MjI7CiAgICB0LnJjb21tYWFjY2VudCA9IDQ0NDsKICAgIHQuTnRpbGRlID0gNzIyOwogICAgdC5vdGlsZGUgPSA1MDA7CiAgICB0LlJjb21tYWFjY2VudCA9IDcyMjsKICAgIHQuTGNvbW1hYWNjZW50ID0gNjY3OwogICAgdC5BdGlsZGUgPSA3MjI7CiAgICB0LkFvZ29uZWsgPSA3MjI7CiAgICB0LkFyaW5nID0gNzIyOwogICAgdC5PdGlsZGUgPSA3Nzg7CiAgICB0Lnpkb3RhY2NlbnQgPSA0NDQ7CiAgICB0LkVjYXJvbiA9IDY2NzsKICAgIHQuSW9nb25layA9IDM4OTsKICAgIHQua2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5taW51cyA9IDU3MDsKICAgIHQuSWNpcmN1bWZsZXggPSAzODk7CiAgICB0Lm5jYXJvbiA9IDU1NjsKICAgIHQudGNvbW1hYWNjZW50ID0gMzMzOwogICAgdC5sb2dpY2Fsbm90ID0gNTcwOwogICAgdC5vZGllcmVzaXMgPSA1MDA7CiAgICB0LnVkaWVyZXNpcyA9IDU1NjsKICAgIHQubm90ZXF1YWwgPSA1NDk7CiAgICB0Lmdjb21tYWFjY2VudCA9IDUwMDsKICAgIHQuZXRoID0gNTAwOwogICAgdC56Y2Fyb24gPSA0NDQ7CiAgICB0Lm5jb21tYWFjY2VudCA9IDU1NjsKICAgIHQub25lc3VwZXJpb3IgPSAzMDA7CiAgICB0LmltYWNyb24gPSAyNzg7CiAgICB0LkV1cm8gPSA1MDA7CiAgfSk7CiAgdFsiVGltZXMtQm9sZEl0YWxpYyJdID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgIHQuc3BhY2UgPSAyNTA7CiAgICB0LmV4Y2xhbSA9IDM4OTsKICAgIHQucXVvdGVkYmwgPSA1NTU7CiAgICB0Lm51bWJlcnNpZ24gPSA1MDA7CiAgICB0LmRvbGxhciA9IDUwMDsKICAgIHQucGVyY2VudCA9IDgzMzsKICAgIHQuYW1wZXJzYW5kID0gNzc4OwogICAgdC5xdW90ZXJpZ2h0ID0gMzMzOwogICAgdC5wYXJlbmxlZnQgPSAzMzM7CiAgICB0LnBhcmVucmlnaHQgPSAzMzM7CiAgICB0LmFzdGVyaXNrID0gNTAwOwogICAgdC5wbHVzID0gNTcwOwogICAgdC5jb21tYSA9IDI1MDsKICAgIHQuaHlwaGVuID0gMzMzOwogICAgdC5wZXJpb2QgPSAyNTA7CiAgICB0LnNsYXNoID0gMjc4OwogICAgdC56ZXJvID0gNTAwOwogICAgdC5vbmUgPSA1MDA7CiAgICB0LnR3byA9IDUwMDsKICAgIHQudGhyZWUgPSA1MDA7CiAgICB0LmZvdXIgPSA1MDA7CiAgICB0LmZpdmUgPSA1MDA7CiAgICB0LnNpeCA9IDUwMDsKICAgIHQuc2V2ZW4gPSA1MDA7CiAgICB0LmVpZ2h0ID0gNTAwOwogICAgdC5uaW5lID0gNTAwOwogICAgdC5jb2xvbiA9IDMzMzsKICAgIHQuc2VtaWNvbG9uID0gMzMzOwogICAgdC5sZXNzID0gNTcwOwogICAgdC5lcXVhbCA9IDU3MDsKICAgIHQuZ3JlYXRlciA9IDU3MDsKICAgIHQucXVlc3Rpb24gPSA1MDA7CiAgICB0LmF0ID0gODMyOwogICAgdC5BID0gNjY3OwogICAgdC5CID0gNjY3OwogICAgdC5DID0gNjY3OwogICAgdC5EID0gNzIyOwogICAgdC5FID0gNjY3OwogICAgdC5GID0gNjY3OwogICAgdC5HID0gNzIyOwogICAgdC5IID0gNzc4OwogICAgdC5JID0gMzg5OwogICAgdC5KID0gNTAwOwogICAgdC5LID0gNjY3OwogICAgdC5MID0gNjExOwogICAgdC5NID0gODg5OwogICAgdC5OID0gNzIyOwogICAgdC5PID0gNzIyOwogICAgdC5QID0gNjExOwogICAgdC5RID0gNzIyOwogICAgdC5SID0gNjY3OwogICAgdC5TID0gNTU2OwogICAgdC5UID0gNjExOwogICAgdC5VID0gNzIyOwogICAgdC5WID0gNjY3OwogICAgdC5XID0gODg5OwogICAgdC5YID0gNjY3OwogICAgdC5ZID0gNjExOwogICAgdC5aID0gNjExOwogICAgdC5icmFja2V0bGVmdCA9IDMzMzsKICAgIHQuYmFja3NsYXNoID0gMjc4OwogICAgdC5icmFja2V0cmlnaHQgPSAzMzM7CiAgICB0LmFzY2lpY2lyY3VtID0gNTcwOwogICAgdC51bmRlcnNjb3JlID0gNTAwOwogICAgdC5xdW90ZWxlZnQgPSAzMzM7CiAgICB0LmEgPSA1MDA7CiAgICB0LmIgPSA1MDA7CiAgICB0LmMgPSA0NDQ7CiAgICB0LmQgPSA1MDA7CiAgICB0LmUgPSA0NDQ7CiAgICB0LmYgPSAzMzM7CiAgICB0LmcgPSA1MDA7CiAgICB0LmggPSA1NTY7CiAgICB0LmkgPSAyNzg7CiAgICB0LmogPSAyNzg7CiAgICB0LmsgPSA1MDA7CiAgICB0LmwgPSAyNzg7CiAgICB0Lm0gPSA3Nzg7CiAgICB0Lm4gPSA1NTY7CiAgICB0Lm8gPSA1MDA7CiAgICB0LnAgPSA1MDA7CiAgICB0LnEgPSA1MDA7CiAgICB0LnIgPSAzODk7CiAgICB0LnMgPSAzODk7CiAgICB0LnQgPSAyNzg7CiAgICB0LnUgPSA1NTY7CiAgICB0LnYgPSA0NDQ7CiAgICB0LncgPSA2Njc7CiAgICB0LnggPSA1MDA7CiAgICB0LnkgPSA0NDQ7CiAgICB0LnogPSAzODk7CiAgICB0LmJyYWNlbGVmdCA9IDM0ODsKICAgIHQuYmFyID0gMjIwOwogICAgdC5icmFjZXJpZ2h0ID0gMzQ4OwogICAgdC5hc2NpaXRpbGRlID0gNTcwOwogICAgdC5leGNsYW1kb3duID0gMzg5OwogICAgdC5jZW50ID0gNTAwOwogICAgdC5zdGVybGluZyA9IDUwMDsKICAgIHQuZnJhY3Rpb24gPSAxNjc7CiAgICB0LnllbiA9IDUwMDsKICAgIHQuZmxvcmluID0gNTAwOwogICAgdC5zZWN0aW9uID0gNTAwOwogICAgdC5jdXJyZW5jeSA9IDUwMDsKICAgIHQucXVvdGVzaW5nbGUgPSAyNzg7CiAgICB0LnF1b3RlZGJsbGVmdCA9IDUwMDsKICAgIHQuZ3VpbGxlbW90bGVmdCA9IDUwMDsKICAgIHQuZ3VpbHNpbmdsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbHNpbmdscmlnaHQgPSAzMzM7CiAgICB0LmZpID0gNTU2OwogICAgdC5mbCA9IDU1NjsKICAgIHQuZW5kYXNoID0gNTAwOwogICAgdC5kYWdnZXIgPSA1MDA7CiAgICB0LmRhZ2dlcmRibCA9IDUwMDsKICAgIHQucGVyaW9kY2VudGVyZWQgPSAyNTA7CiAgICB0LnBhcmFncmFwaCA9IDUwMDsKICAgIHQuYnVsbGV0ID0gMzUwOwogICAgdC5xdW90ZXNpbmdsYmFzZSA9IDMzMzsKICAgIHQucXVvdGVkYmxiYXNlID0gNTAwOwogICAgdC5xdW90ZWRibHJpZ2h0ID0gNTAwOwogICAgdC5ndWlsbGVtb3RyaWdodCA9IDUwMDsKICAgIHQuZWxsaXBzaXMgPSAxMDAwOwogICAgdC5wZXJ0aG91c2FuZCA9IDEwMDA7CiAgICB0LnF1ZXN0aW9uZG93biA9IDUwMDsKICAgIHQuZ3JhdmUgPSAzMzM7CiAgICB0LmFjdXRlID0gMzMzOwogICAgdC5jaXJjdW1mbGV4ID0gMzMzOwogICAgdC50aWxkZSA9IDMzMzsKICAgIHQubWFjcm9uID0gMzMzOwogICAgdC5icmV2ZSA9IDMzMzsKICAgIHQuZG90YWNjZW50ID0gMzMzOwogICAgdC5kaWVyZXNpcyA9IDMzMzsKICAgIHQucmluZyA9IDMzMzsKICAgIHQuY2VkaWxsYSA9IDMzMzsKICAgIHQuaHVuZ2FydW1sYXV0ID0gMzMzOwogICAgdC5vZ29uZWsgPSAzMzM7CiAgICB0LmNhcm9uID0gMzMzOwogICAgdC5lbWRhc2ggPSAxMDAwOwogICAgdC5BRSA9IDk0NDsKICAgIHQub3JkZmVtaW5pbmUgPSAyNjY7CiAgICB0LkxzbGFzaCA9IDYxMTsKICAgIHQuT3NsYXNoID0gNzIyOwogICAgdC5PRSA9IDk0NDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzAwOwogICAgdC5hZSA9IDcyMjsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNTAwOwogICAgdC5vZSA9IDcyMjsKICAgIHQuZ2VybWFuZGJscyA9IDUwMDsKICAgIHQuSWRpZXJlc2lzID0gMzg5OwogICAgdC5lYWN1dGUgPSA0NDQ7CiAgICB0LmFicmV2ZSA9IDUwMDsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDU1NjsKICAgIHQuZWNhcm9uID0gNDQ0OwogICAgdC5ZZGllcmVzaXMgPSA2MTE7CiAgICB0LmRpdmlkZSA9IDU3MDsKICAgIHQuWWFjdXRlID0gNjExOwogICAgdC5BY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWFjdXRlID0gNTAwOwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNDQ0OwogICAgdC5zY29tbWFhY2NlbnQgPSAzODk7CiAgICB0LmVjaXJjdW1mbGV4ID0gNDQ0OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTAwOwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA1NTY7CiAgICB0LkVkaWVyZXNpcyA9IDY2NzsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzQ3OwogICAgdC5FbWFjcm9uID0gNjY3OwogICAgdC5jY2Fyb24gPSA0NDQ7CiAgICB0LmFyaW5nID0gNTAwOwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNTAwOwogICAgdC5UY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkNhY3V0ZSA9IDY2NzsKICAgIHQuYXRpbGRlID0gNTAwOwogICAgdC5FZG90YWNjZW50ID0gNjY3OwogICAgdC5zY2Fyb24gPSAzODk7CiAgICB0LnNjZWRpbGxhID0gMzg5OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0OTQ7CiAgICB0LlJjYXJvbiA9IDY2NzsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC51Y2lyY3VtZmxleCA9IDU1NjsKICAgIHQuYWNpcmN1bWZsZXggPSA1MDA7CiAgICB0LkFtYWNyb24gPSA2Njc7CiAgICB0LnJjYXJvbiA9IDM4OTsKICAgIHQuY2NlZGlsbGEgPSA0NDQ7CiAgICB0Llpkb3RhY2NlbnQgPSA2MTE7CiAgICB0LlRob3JuID0gNjExOwogICAgdC5PbWFjcm9uID0gNzIyOwogICAgdC5SYWN1dGUgPSA2Njc7CiAgICB0LlNhY3V0ZSA9IDU1NjsKICAgIHQuZGNhcm9uID0gNjA4OwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDU1NjsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMwMDsKICAgIHQuT2dyYXZlID0gNzIyOwogICAgdC5BZ3JhdmUgPSA2Njc7CiAgICB0LkFicmV2ZSA9IDY2NzsKICAgIHQubXVsdGlwbHkgPSA1NzA7CiAgICB0LnVhY3V0ZSA9IDU1NjsKICAgIHQuVGNhcm9uID0gNjExOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ5NDsKICAgIHQueWRpZXJlc2lzID0gNDQ0OwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWRpZXJlc2lzID0gNTAwOwogICAgdC5lZGllcmVzaXMgPSA0NDQ7CiAgICB0LmNhY3V0ZSA9IDQ0NDsKICAgIHQubmFjdXRlID0gNTU2OwogICAgdC51bWFjcm9uID0gNTU2OwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDM4OTsKICAgIHQucGx1c21pbnVzID0gNTcwOwogICAgdC5icm9rZW5iYXIgPSAyMjA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3NDc7CiAgICB0LkdicmV2ZSA9IDcyMjsKICAgIHQuSWRvdGFjY2VudCA9IDM4OTsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2Njc7CiAgICB0LnJhY3V0ZSA9IDM4OTsKICAgIHQub21hY3JvbiA9IDUwMDsKICAgIHQuWmFjdXRlID0gNjExOwogICAgdC5aY2Fyb24gPSA2MTE7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDY2NzsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSAzNjY7CiAgICB0LmVvZ29uZWsgPSA0NDQ7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDY2NzsKICAgIHQuQWRpZXJlc2lzID0gNjY3OwogICAgdC5lZ3JhdmUgPSA0NDQ7CiAgICB0LnphY3V0ZSA9IDM4OTsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzIyOwogICAgdC5vYWN1dGUgPSA1MDA7CiAgICB0LmFtYWNyb24gPSA1MDA7CiAgICB0LnNhY3V0ZSA9IDM4OTsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA1MDA7CiAgICB0LnR3b3N1cGVyaW9yID0gMzAwOwogICAgdC5PZGllcmVzaXMgPSA3MjI7CiAgICB0Lm11ID0gNTc2OwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA1MDA7CiAgICB0LkVvZ29uZWsgPSA2Njc7CiAgICB0LmRjcm9hdCA9IDUwMDsKICAgIHQudGhyZWVxdWFydGVycyA9IDc1MDsKICAgIHQuU2NlZGlsbGEgPSA1NTY7CiAgICB0LmxjYXJvbiA9IDM4MjsKICAgIHQuS2NvbW1hYWNjZW50ID0gNjY3OwogICAgdC5MYWN1dGUgPSA2MTE7CiAgICB0LnRyYWRlbWFyayA9IDEwMDA7CiAgICB0LmVkb3RhY2NlbnQgPSA0NDQ7CiAgICB0LklncmF2ZSA9IDM4OTsKICAgIHQuSW1hY3JvbiA9IDM4OTsKICAgIHQuTGNhcm9uID0gNjExOwogICAgdC5vbmVoYWxmID0gNzUwOwogICAgdC5sZXNzZXF1YWwgPSA1NDk7CiAgICB0Lm9jaXJjdW1mbGV4ID0gNTAwOwogICAgdC5udGlsZGUgPSA1NTY7CiAgICB0LlVodW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LkVhY3V0ZSA9IDY2NzsKICAgIHQuZW1hY3JvbiA9IDQ0NDsKICAgIHQuZ2JyZXZlID0gNTAwOwogICAgdC5vbmVxdWFydGVyID0gNzUwOwogICAgdC5TY2Fyb24gPSA1NTY7CiAgICB0LlNjb21tYWFjY2VudCA9IDU1NjsKICAgIHQuT2h1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5vZ3JhdmUgPSA1MDA7CiAgICB0LkNjYXJvbiA9IDY2NzsKICAgIHQudWdyYXZlID0gNTU2OwogICAgdC5yYWRpY2FsID0gNTQ5OwogICAgdC5EY2Fyb24gPSA3MjI7CiAgICB0LnJjb21tYWFjY2VudCA9IDM4OTsKICAgIHQuTnRpbGRlID0gNzIyOwogICAgdC5vdGlsZGUgPSA1MDA7CiAgICB0LlJjb21tYWFjY2VudCA9IDY2NzsKICAgIHQuTGNvbW1hYWNjZW50ID0gNjExOwogICAgdC5BdGlsZGUgPSA2Njc7CiAgICB0LkFvZ29uZWsgPSA2Njc7CiAgICB0LkFyaW5nID0gNjY3OwogICAgdC5PdGlsZGUgPSA3MjI7CiAgICB0Lnpkb3RhY2NlbnQgPSAzODk7CiAgICB0LkVjYXJvbiA9IDY2NzsKICAgIHQuSW9nb25layA9IDM4OTsKICAgIHQua2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5taW51cyA9IDYwNjsKICAgIHQuSWNpcmN1bWZsZXggPSAzODk7CiAgICB0Lm5jYXJvbiA9IDU1NjsKICAgIHQudGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC5sb2dpY2Fsbm90ID0gNjA2OwogICAgdC5vZGllcmVzaXMgPSA1MDA7CiAgICB0LnVkaWVyZXNpcyA9IDU1NjsKICAgIHQubm90ZXF1YWwgPSA1NDk7CiAgICB0Lmdjb21tYWFjY2VudCA9IDUwMDsKICAgIHQuZXRoID0gNTAwOwogICAgdC56Y2Fyb24gPSAzODk7CiAgICB0Lm5jb21tYWFjY2VudCA9IDU1NjsKICAgIHQub25lc3VwZXJpb3IgPSAzMDA7CiAgICB0LmltYWNyb24gPSAyNzg7CiAgICB0LkV1cm8gPSA1MDA7CiAgfSk7CiAgdFsiVGltZXMtSXRhbGljIl0gPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI1MDsKICAgIHQuZXhjbGFtID0gMzMzOwogICAgdC5xdW90ZWRibCA9IDQyMDsKICAgIHQubnVtYmVyc2lnbiA9IDUwMDsKICAgIHQuZG9sbGFyID0gNTAwOwogICAgdC5wZXJjZW50ID0gODMzOwogICAgdC5hbXBlcnNhbmQgPSA3Nzg7CiAgICB0LnF1b3RlcmlnaHQgPSAzMzM7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2sgPSA1MDA7CiAgICB0LnBsdXMgPSA2NzU7CiAgICB0LmNvbW1hID0gMjUwOwogICAgdC5oeXBoZW4gPSAzMzM7CiAgICB0LnBlcmlvZCA9IDI1MDsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1MDA7CiAgICB0Lm9uZSA9IDUwMDsKICAgIHQudHdvID0gNTAwOwogICAgdC50aHJlZSA9IDUwMDsKICAgIHQuZm91ciA9IDUwMDsKICAgIHQuZml2ZSA9IDUwMDsKICAgIHQuc2l4ID0gNTAwOwogICAgdC5zZXZlbiA9IDUwMDsKICAgIHQuZWlnaHQgPSA1MDA7CiAgICB0Lm5pbmUgPSA1MDA7CiAgICB0LmNvbG9uID0gMzMzOwogICAgdC5zZW1pY29sb24gPSAzMzM7CiAgICB0Lmxlc3MgPSA2NzU7CiAgICB0LmVxdWFsID0gNjc1OwogICAgdC5ncmVhdGVyID0gNjc1OwogICAgdC5xdWVzdGlvbiA9IDUwMDsKICAgIHQuYXQgPSA5MjA7CiAgICB0LkEgPSA2MTE7CiAgICB0LkIgPSA2MTE7CiAgICB0LkMgPSA2Njc7CiAgICB0LkQgPSA3MjI7CiAgICB0LkUgPSA2MTE7CiAgICB0LkYgPSA2MTE7CiAgICB0LkcgPSA3MjI7CiAgICB0LkggPSA3MjI7CiAgICB0LkkgPSAzMzM7CiAgICB0LkogPSA0NDQ7CiAgICB0LksgPSA2Njc7CiAgICB0LkwgPSA1NTY7CiAgICB0Lk0gPSA4MzM7CiAgICB0Lk4gPSA2Njc7CiAgICB0Lk8gPSA3MjI7CiAgICB0LlAgPSA2MTE7CiAgICB0LlEgPSA3MjI7CiAgICB0LlIgPSA2MTE7CiAgICB0LlMgPSA1MDA7CiAgICB0LlQgPSA1NTY7CiAgICB0LlUgPSA3MjI7CiAgICB0LlYgPSA2MTE7CiAgICB0LlcgPSA4MzM7CiAgICB0LlggPSA2MTE7CiAgICB0LlkgPSA1NTY7CiAgICB0LlogPSA1NTY7CiAgICB0LmJyYWNrZXRsZWZ0ID0gMzg5OwogICAgdC5iYWNrc2xhc2ggPSAyNzg7CiAgICB0LmJyYWNrZXRyaWdodCA9IDM4OTsKICAgIHQuYXNjaWljaXJjdW0gPSA0MjI7CiAgICB0LnVuZGVyc2NvcmUgPSA1MDA7CiAgICB0LnF1b3RlbGVmdCA9IDMzMzsKICAgIHQuYSA9IDUwMDsKICAgIHQuYiA9IDUwMDsKICAgIHQuYyA9IDQ0NDsKICAgIHQuZCA9IDUwMDsKICAgIHQuZSA9IDQ0NDsKICAgIHQuZiA9IDI3ODsKICAgIHQuZyA9IDUwMDsKICAgIHQuaCA9IDUwMDsKICAgIHQuaSA9IDI3ODsKICAgIHQuaiA9IDI3ODsKICAgIHQuayA9IDQ0NDsKICAgIHQubCA9IDI3ODsKICAgIHQubSA9IDcyMjsKICAgIHQubiA9IDUwMDsKICAgIHQubyA9IDUwMDsKICAgIHQucCA9IDUwMDsKICAgIHQucSA9IDUwMDsKICAgIHQuciA9IDM4OTsKICAgIHQucyA9IDM4OTsKICAgIHQudCA9IDI3ODsKICAgIHQudSA9IDUwMDsKICAgIHQudiA9IDQ0NDsKICAgIHQudyA9IDY2NzsKICAgIHQueCA9IDQ0NDsKICAgIHQueSA9IDQ0NDsKICAgIHQueiA9IDM4OTsKICAgIHQuYnJhY2VsZWZ0ID0gNDAwOwogICAgdC5iYXIgPSAyNzU7CiAgICB0LmJyYWNlcmlnaHQgPSA0MDA7CiAgICB0LmFzY2lpdGlsZGUgPSA1NDE7CiAgICB0LmV4Y2xhbWRvd24gPSAzODk7CiAgICB0LmNlbnQgPSA1MDA7CiAgICB0LnN0ZXJsaW5nID0gNTAwOwogICAgdC5mcmFjdGlvbiA9IDE2NzsKICAgIHQueWVuID0gNTAwOwogICAgdC5mbG9yaW4gPSA1MDA7CiAgICB0LnNlY3Rpb24gPSA1MDA7CiAgICB0LmN1cnJlbmN5ID0gNTAwOwogICAgdC5xdW90ZXNpbmdsZSA9IDIxNDsKICAgIHQucXVvdGVkYmxsZWZ0ID0gNTU2OwogICAgdC5ndWlsbGVtb3RsZWZ0ID0gNTAwOwogICAgdC5ndWlsc2luZ2xsZWZ0ID0gMzMzOwogICAgdC5ndWlsc2luZ2xyaWdodCA9IDMzMzsKICAgIHQuZmkgPSA1MDA7CiAgICB0LmZsID0gNTAwOwogICAgdC5lbmRhc2ggPSA1MDA7CiAgICB0LmRhZ2dlciA9IDUwMDsKICAgIHQuZGFnZ2VyZGJsID0gNTAwOwogICAgdC5wZXJpb2RjZW50ZXJlZCA9IDI1MDsKICAgIHQucGFyYWdyYXBoID0gNTIzOwogICAgdC5idWxsZXQgPSAzNTA7CiAgICB0LnF1b3Rlc2luZ2xiYXNlID0gMzMzOwogICAgdC5xdW90ZWRibGJhc2UgPSA1NTY7CiAgICB0LnF1b3RlZGJscmlnaHQgPSA1NTY7CiAgICB0Lmd1aWxsZW1vdHJpZ2h0ID0gNTAwOwogICAgdC5lbGxpcHNpcyA9IDg4OTsKICAgIHQucGVydGhvdXNhbmQgPSAxMDAwOwogICAgdC5xdWVzdGlvbmRvd24gPSA1MDA7CiAgICB0LmdyYXZlID0gMzMzOwogICAgdC5hY3V0ZSA9IDMzMzsKICAgIHQuY2lyY3VtZmxleCA9IDMzMzsKICAgIHQudGlsZGUgPSAzMzM7CiAgICB0Lm1hY3JvbiA9IDMzMzsKICAgIHQuYnJldmUgPSAzMzM7CiAgICB0LmRvdGFjY2VudCA9IDMzMzsKICAgIHQuZGllcmVzaXMgPSAzMzM7CiAgICB0LnJpbmcgPSAzMzM7CiAgICB0LmNlZGlsbGEgPSAzMzM7CiAgICB0Lmh1bmdhcnVtbGF1dCA9IDMzMzsKICAgIHQub2dvbmVrID0gMzMzOwogICAgdC5jYXJvbiA9IDMzMzsKICAgIHQuZW1kYXNoID0gODg5OwogICAgdC5BRSA9IDg4OTsKICAgIHQub3JkZmVtaW5pbmUgPSAyNzY7CiAgICB0LkxzbGFzaCA9IDU1NjsKICAgIHQuT3NsYXNoID0gNzIyOwogICAgdC5PRSA9IDk0NDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzEwOwogICAgdC5hZSA9IDY2NzsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNTAwOwogICAgdC5vZSA9IDY2NzsKICAgIHQuZ2VybWFuZGJscyA9IDUwMDsKICAgIHQuSWRpZXJlc2lzID0gMzMzOwogICAgdC5lYWN1dGUgPSA0NDQ7CiAgICB0LmFicmV2ZSA9IDUwMDsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDUwMDsKICAgIHQuZWNhcm9uID0gNDQ0OwogICAgdC5ZZGllcmVzaXMgPSA1NTY7CiAgICB0LmRpdmlkZSA9IDY3NTsKICAgIHQuWWFjdXRlID0gNTU2OwogICAgdC5BY2lyY3VtZmxleCA9IDYxMTsKICAgIHQuYWFjdXRlID0gNTAwOwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNDQ0OwogICAgdC5zY29tbWFhY2NlbnQgPSAzODk7CiAgICB0LmVjaXJjdW1mbGV4ID0gNDQ0OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTAwOwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA1MDA7CiAgICB0LkVkaWVyZXNpcyA9IDYxMTsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzYwOwogICAgdC5FbWFjcm9uID0gNjExOwogICAgdC5jY2Fyb24gPSA0NDQ7CiAgICB0LmFyaW5nID0gNTAwOwogICAgdC5OY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNTAwOwogICAgdC5UY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LkNhY3V0ZSA9IDY2NzsKICAgIHQuYXRpbGRlID0gNTAwOwogICAgdC5FZG90YWNjZW50ID0gNjExOwogICAgdC5zY2Fyb24gPSAzODk7CiAgICB0LnNjZWRpbGxhID0gMzg5OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0NzE7CiAgICB0LlJjYXJvbiA9IDYxMTsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC51Y2lyY3VtZmxleCA9IDUwMDsKICAgIHQuYWNpcmN1bWZsZXggPSA1MDA7CiAgICB0LkFtYWNyb24gPSA2MTE7CiAgICB0LnJjYXJvbiA9IDM4OTsKICAgIHQuY2NlZGlsbGEgPSA0NDQ7CiAgICB0Llpkb3RhY2NlbnQgPSA1NTY7CiAgICB0LlRob3JuID0gNjExOwogICAgdC5PbWFjcm9uID0gNzIyOwogICAgdC5SYWN1dGUgPSA2MTE7CiAgICB0LlNhY3V0ZSA9IDUwMDsKICAgIHQuZGNhcm9uID0gNTQ0OwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDUwMDsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMwMDsKICAgIHQuT2dyYXZlID0gNzIyOwogICAgdC5BZ3JhdmUgPSA2MTE7CiAgICB0LkFicmV2ZSA9IDYxMTsKICAgIHQubXVsdGlwbHkgPSA2NzU7CiAgICB0LnVhY3V0ZSA9IDUwMDsKICAgIHQuVGNhcm9uID0gNTU2OwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ3NjsKICAgIHQueWRpZXJlc2lzID0gNDQ0OwogICAgdC5OYWN1dGUgPSA2Njc7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDYxMTsKICAgIHQuYWRpZXJlc2lzID0gNTAwOwogICAgdC5lZGllcmVzaXMgPSA0NDQ7CiAgICB0LmNhY3V0ZSA9IDQ0NDsKICAgIHQubmFjdXRlID0gNTAwOwogICAgdC51bWFjcm9uID0gNTAwOwogICAgdC5OY2Fyb24gPSA2Njc7CiAgICB0LklhY3V0ZSA9IDMzMzsKICAgIHQucGx1c21pbnVzID0gNjc1OwogICAgdC5icm9rZW5iYXIgPSAyNzU7CiAgICB0LnJlZ2lzdGVyZWQgPSA3NjA7CiAgICB0LkdicmV2ZSA9IDcyMjsKICAgIHQuSWRvdGFjY2VudCA9IDMzMzsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2MTE7CiAgICB0LnJhY3V0ZSA9IDM4OTsKICAgIHQub21hY3JvbiA9IDUwMDsKICAgIHQuWmFjdXRlID0gNTU2OwogICAgdC5aY2Fyb24gPSA1NTY7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDY2NzsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSAzMDA7CiAgICB0LmVvZ29uZWsgPSA0NDQ7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDYxMTsKICAgIHQuQWRpZXJlc2lzID0gNjExOwogICAgdC5lZ3JhdmUgPSA0NDQ7CiAgICB0LnphY3V0ZSA9IDM4OTsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzIyOwogICAgdC5vYWN1dGUgPSA1MDA7CiAgICB0LmFtYWNyb24gPSA1MDA7CiAgICB0LnNhY3V0ZSA9IDM4OTsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA1MDA7CiAgICB0LnR3b3N1cGVyaW9yID0gMzAwOwogICAgdC5PZGllcmVzaXMgPSA3MjI7CiAgICB0Lm11ID0gNTAwOwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA1MDA7CiAgICB0LkVvZ29uZWsgPSA2MTE7CiAgICB0LmRjcm9hdCA9IDUwMDsKICAgIHQudGhyZWVxdWFydGVycyA9IDc1MDsKICAgIHQuU2NlZGlsbGEgPSA1MDA7CiAgICB0LmxjYXJvbiA9IDMwMDsKICAgIHQuS2NvbW1hYWNjZW50ID0gNjY3OwogICAgdC5MYWN1dGUgPSA1NTY7CiAgICB0LnRyYWRlbWFyayA9IDk4MDsKICAgIHQuZWRvdGFjY2VudCA9IDQ0NDsKICAgIHQuSWdyYXZlID0gMzMzOwogICAgdC5JbWFjcm9uID0gMzMzOwogICAgdC5MY2Fyb24gPSA2MTE7CiAgICB0Lm9uZWhhbGYgPSA3NTA7CiAgICB0Lmxlc3NlcXVhbCA9IDU0OTsKICAgIHQub2NpcmN1bWZsZXggPSA1MDA7CiAgICB0Lm50aWxkZSA9IDUwMDsKICAgIHQuVWh1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuRWFjdXRlID0gNjExOwogICAgdC5lbWFjcm9uID0gNDQ0OwogICAgdC5nYnJldmUgPSA1MDA7CiAgICB0Lm9uZXF1YXJ0ZXIgPSA3NTA7CiAgICB0LlNjYXJvbiA9IDUwMDsKICAgIHQuU2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5PaHVuZ2FydW1sYXV0ID0gNzIyOwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0Lm9ncmF2ZSA9IDUwMDsKICAgIHQuQ2Nhcm9uID0gNjY3OwogICAgdC51Z3JhdmUgPSA1MDA7CiAgICB0LnJhZGljYWwgPSA0NTM7CiAgICB0LkRjYXJvbiA9IDcyMjsKICAgIHQucmNvbW1hYWNjZW50ID0gMzg5OwogICAgdC5OdGlsZGUgPSA2Njc7CiAgICB0Lm90aWxkZSA9IDUwMDsKICAgIHQuUmNvbW1hYWNjZW50ID0gNjExOwogICAgdC5MY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LkF0aWxkZSA9IDYxMTsKICAgIHQuQW9nb25layA9IDYxMTsKICAgIHQuQXJpbmcgPSA2MTE7CiAgICB0Lk90aWxkZSA9IDcyMjsKICAgIHQuemRvdGFjY2VudCA9IDM4OTsKICAgIHQuRWNhcm9uID0gNjExOwogICAgdC5Jb2dvbmVrID0gMzMzOwogICAgdC5rY29tbWFhY2NlbnQgPSA0NDQ7CiAgICB0Lm1pbnVzID0gNjc1OwogICAgdC5JY2lyY3VtZmxleCA9IDMzMzsKICAgIHQubmNhcm9uID0gNTAwOwogICAgdC50Y29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LmxvZ2ljYWxub3QgPSA2NzU7CiAgICB0Lm9kaWVyZXNpcyA9IDUwMDsKICAgIHQudWRpZXJlc2lzID0gNTAwOwogICAgdC5ub3RlcXVhbCA9IDU0OTsKICAgIHQuZ2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5ldGggPSA1MDA7CiAgICB0LnpjYXJvbiA9IDM4OTsKICAgIHQubmNvbW1hYWNjZW50ID0gNTAwOwogICAgdC5vbmVzdXBlcmlvciA9IDMwMDsKICAgIHQuaW1hY3JvbiA9IDI3ODsKICAgIHQuRXVybyA9IDUwMDsKICB9KTsKICB0LlphcGZEaW5nYmF0cyA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICB0LnNwYWNlID0gMjc4OwogICAgdC5hMSA9IDk3NDsKICAgIHQuYTIgPSA5NjE7CiAgICB0LmEyMDIgPSA5NzQ7CiAgICB0LmEzID0gOTgwOwogICAgdC5hNCA9IDcxOTsKICAgIHQuYTUgPSA3ODk7CiAgICB0LmExMTkgPSA3OTA7CiAgICB0LmExMTggPSA3OTE7CiAgICB0LmExMTcgPSA2OTA7CiAgICB0LmExMSA9IDk2MDsKICAgIHQuYTEyID0gOTM5OwogICAgdC5hMTMgPSA1NDk7CiAgICB0LmExNCA9IDg1NTsKICAgIHQuYTE1ID0gOTExOwogICAgdC5hMTYgPSA5MzM7CiAgICB0LmExMDUgPSA5MTE7CiAgICB0LmExNyA9IDk0NTsKICAgIHQuYTE4ID0gOTc0OwogICAgdC5hMTkgPSA3NTU7CiAgICB0LmEyMCA9IDg0NjsKICAgIHQuYTIxID0gNzYyOwogICAgdC5hMjIgPSA3NjE7CiAgICB0LmEyMyA9IDU3MTsKICAgIHQuYTI0ID0gNjc3OwogICAgdC5hMjUgPSA3NjM7CiAgICB0LmEyNiA9IDc2MDsKICAgIHQuYTI3ID0gNzU5OwogICAgdC5hMjggPSA3NTQ7CiAgICB0LmE2ID0gNDk0OwogICAgdC5hNyA9IDU1MjsKICAgIHQuYTggPSA1Mzc7CiAgICB0LmE5ID0gNTc3OwogICAgdC5hMTAgPSA2OTI7CiAgICB0LmEyOSA9IDc4NjsKICAgIHQuYTMwID0gNzg4OwogICAgdC5hMzEgPSA3ODg7CiAgICB0LmEzMiA9IDc5MDsKICAgIHQuYTMzID0gNzkzOwogICAgdC5hMzQgPSA3OTQ7CiAgICB0LmEzNSA9IDgxNjsKICAgIHQuYTM2ID0gODIzOwogICAgdC5hMzcgPSA3ODk7CiAgICB0LmEzOCA9IDg0MTsKICAgIHQuYTM5ID0gODIzOwogICAgdC5hNDAgPSA4MzM7CiAgICB0LmE0MSA9IDgxNjsKICAgIHQuYTQyID0gODMxOwogICAgdC5hNDMgPSA5MjM7CiAgICB0LmE0NCA9IDc0NDsKICAgIHQuYTQ1ID0gNzIzOwogICAgdC5hNDYgPSA3NDk7CiAgICB0LmE0NyA9IDc5MDsKICAgIHQuYTQ4ID0gNzkyOwogICAgdC5hNDkgPSA2OTU7CiAgICB0LmE1MCA9IDc3NjsKICAgIHQuYTUxID0gNzY4OwogICAgdC5hNTIgPSA3OTI7CiAgICB0LmE1MyA9IDc1OTsKICAgIHQuYTU0ID0gNzA3OwogICAgdC5hNTUgPSA3MDg7CiAgICB0LmE1NiA9IDY4MjsKICAgIHQuYTU3ID0gNzAxOwogICAgdC5hNTggPSA4MjY7CiAgICB0LmE1OSA9IDgxNTsKICAgIHQuYTYwID0gNzg5OwogICAgdC5hNjEgPSA3ODk7CiAgICB0LmE2MiA9IDcwNzsKICAgIHQuYTYzID0gNjg3OwogICAgdC5hNjQgPSA2OTY7CiAgICB0LmE2NSA9IDY4OTsKICAgIHQuYTY2ID0gNzg2OwogICAgdC5hNjcgPSA3ODc7CiAgICB0LmE2OCA9IDcxMzsKICAgIHQuYTY5ID0gNzkxOwogICAgdC5hNzAgPSA3ODU7CiAgICB0LmE3MSA9IDc5MTsKICAgIHQuYTcyID0gODczOwogICAgdC5hNzMgPSA3NjE7CiAgICB0LmE3NCA9IDc2MjsKICAgIHQuYTIwMyA9IDc2MjsKICAgIHQuYTc1ID0gNzU5OwogICAgdC5hMjA0ID0gNzU5OwogICAgdC5hNzYgPSA4OTI7CiAgICB0LmE3NyA9IDg5MjsKICAgIHQuYTc4ID0gNzg4OwogICAgdC5hNzkgPSA3ODQ7CiAgICB0LmE4MSA9IDQzODsKICAgIHQuYTgyID0gMTM4OwogICAgdC5hODMgPSAyNzc7CiAgICB0LmE4NCA9IDQxNTsKICAgIHQuYTk3ID0gMzkyOwogICAgdC5hOTggPSAzOTI7CiAgICB0LmE5OSA9IDY2ODsKICAgIHQuYTEwMCA9IDY2ODsKICAgIHQuYTg5ID0gMzkwOwogICAgdC5hOTAgPSAzOTA7CiAgICB0LmE5MyA9IDMxNzsKICAgIHQuYTk0ID0gMzE3OwogICAgdC5hOTEgPSAyNzY7CiAgICB0LmE5MiA9IDI3NjsKICAgIHQuYTIwNSA9IDUwOTsKICAgIHQuYTg1ID0gNTA5OwogICAgdC5hMjA2ID0gNDEwOwogICAgdC5hODYgPSA0MTA7CiAgICB0LmE4NyA9IDIzNDsKICAgIHQuYTg4ID0gMjM0OwogICAgdC5hOTUgPSAzMzQ7CiAgICB0LmE5NiA9IDMzNDsKICAgIHQuYTEwMSA9IDczMjsKICAgIHQuYTEwMiA9IDU0NDsKICAgIHQuYTEwMyA9IDU0NDsKICAgIHQuYTEwNCA9IDkxMDsKICAgIHQuYTEwNiA9IDY2NzsKICAgIHQuYTEwNyA9IDc2MDsKICAgIHQuYTEwOCA9IDc2MDsKICAgIHQuYTExMiA9IDc3NjsKICAgIHQuYTExMSA9IDU5NTsKICAgIHQuYTExMCA9IDY5NDsKICAgIHQuYTEwOSA9IDYyNjsKICAgIHQuYTEyMCA9IDc4ODsKICAgIHQuYTEyMSA9IDc4ODsKICAgIHQuYTEyMiA9IDc4ODsKICAgIHQuYTEyMyA9IDc4ODsKICAgIHQuYTEyNCA9IDc4ODsKICAgIHQuYTEyNSA9IDc4ODsKICAgIHQuYTEyNiA9IDc4ODsKICAgIHQuYTEyNyA9IDc4ODsKICAgIHQuYTEyOCA9IDc4ODsKICAgIHQuYTEyOSA9IDc4ODsKICAgIHQuYTEzMCA9IDc4ODsKICAgIHQuYTEzMSA9IDc4ODsKICAgIHQuYTEzMiA9IDc4ODsKICAgIHQuYTEzMyA9IDc4ODsKICAgIHQuYTEzNCA9IDc4ODsKICAgIHQuYTEzNSA9IDc4ODsKICAgIHQuYTEzNiA9IDc4ODsKICAgIHQuYTEzNyA9IDc4ODsKICAgIHQuYTEzOCA9IDc4ODsKICAgIHQuYTEzOSA9IDc4ODsKICAgIHQuYTE0MCA9IDc4ODsKICAgIHQuYTE0MSA9IDc4ODsKICAgIHQuYTE0MiA9IDc4ODsKICAgIHQuYTE0MyA9IDc4ODsKICAgIHQuYTE0NCA9IDc4ODsKICAgIHQuYTE0NSA9IDc4ODsKICAgIHQuYTE0NiA9IDc4ODsKICAgIHQuYTE0NyA9IDc4ODsKICAgIHQuYTE0OCA9IDc4ODsKICAgIHQuYTE0OSA9IDc4ODsKICAgIHQuYTE1MCA9IDc4ODsKICAgIHQuYTE1MSA9IDc4ODsKICAgIHQuYTE1MiA9IDc4ODsKICAgIHQuYTE1MyA9IDc4ODsKICAgIHQuYTE1NCA9IDc4ODsKICAgIHQuYTE1NSA9IDc4ODsKICAgIHQuYTE1NiA9IDc4ODsKICAgIHQuYTE1NyA9IDc4ODsKICAgIHQuYTE1OCA9IDc4ODsKICAgIHQuYTE1OSA9IDc4ODsKICAgIHQuYTE2MCA9IDg5NDsKICAgIHQuYTE2MSA9IDgzODsKICAgIHQuYTE2MyA9IDEwMTY7CiAgICB0LmExNjQgPSA0NTg7CiAgICB0LmExOTYgPSA3NDg7CiAgICB0LmExNjUgPSA5MjQ7CiAgICB0LmExOTIgPSA3NDg7CiAgICB0LmExNjYgPSA5MTg7CiAgICB0LmExNjcgPSA5Mjc7CiAgICB0LmExNjggPSA5Mjg7CiAgICB0LmExNjkgPSA5Mjg7CiAgICB0LmExNzAgPSA4MzQ7CiAgICB0LmExNzEgPSA4NzM7CiAgICB0LmExNzIgPSA4Mjg7CiAgICB0LmExNzMgPSA5MjQ7CiAgICB0LmExNjIgPSA5MjQ7CiAgICB0LmExNzQgPSA5MTc7CiAgICB0LmExNzUgPSA5MzA7CiAgICB0LmExNzYgPSA5MzE7CiAgICB0LmExNzcgPSA0NjM7CiAgICB0LmExNzggPSA4ODM7CiAgICB0LmExNzkgPSA4MzY7CiAgICB0LmExOTMgPSA4MzY7CiAgICB0LmExODAgPSA4Njc7CiAgICB0LmExOTkgPSA4Njc7CiAgICB0LmExODEgPSA2OTY7CiAgICB0LmEyMDAgPSA2OTY7CiAgICB0LmExODIgPSA4NzQ7CiAgICB0LmEyMDEgPSA4NzQ7CiAgICB0LmExODMgPSA3NjA7CiAgICB0LmExODQgPSA5NDY7CiAgICB0LmExOTcgPSA3NzE7CiAgICB0LmExODUgPSA4NjU7CiAgICB0LmExOTQgPSA3NzE7CiAgICB0LmExOTggPSA4ODg7CiAgICB0LmExODYgPSA5Njc7CiAgICB0LmExOTUgPSA4ODg7CiAgICB0LmExODcgPSA4MzE7CiAgICB0LmExODggPSA4NzM7CiAgICB0LmExODkgPSA5Mjc7CiAgICB0LmExOTAgPSA5NzA7CiAgICB0LmExOTEgPSA5MTg7CiAgfSk7Cn0pOwpleHBvcnRzLmdldE1ldHJpY3MgPSBnZXRNZXRyaWNzOwpjb25zdCBnZXRGb250QmFzaWNNZXRyaWNzID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0LkNvdXJpZXIgPSB7CiAgICBhc2NlbnQ6IDYyOSwKICAgIGRlc2NlbnQ6IC0xNTcsCiAgICBjYXBIZWlnaHQ6IDU2MiwKICAgIHhIZWlnaHQ6IC00MjYKICB9OwogIHRbIkNvdXJpZXItQm9sZCJdID0gewogICAgYXNjZW50OiA2MjksCiAgICBkZXNjZW50OiAtMTU3LAogICAgY2FwSGVpZ2h0OiA1NjIsCiAgICB4SGVpZ2h0OiA0MzkKICB9OwogIHRbIkNvdXJpZXItT2JsaXF1ZSJdID0gewogICAgYXNjZW50OiA2MjksCiAgICBkZXNjZW50OiAtMTU3LAogICAgY2FwSGVpZ2h0OiA1NjIsCiAgICB4SGVpZ2h0OiA0MjYKICB9OwogIHRbIkNvdXJpZXItQm9sZE9ibGlxdWUiXSA9IHsKICAgIGFzY2VudDogNjI5LAogICAgZGVzY2VudDogLTE1NywKICAgIGNhcEhlaWdodDogNTYyLAogICAgeEhlaWdodDogNDI2CiAgfTsKICB0LkhlbHZldGljYSA9IHsKICAgIGFzY2VudDogNzE4LAogICAgZGVzY2VudDogLTIwNywKICAgIGNhcEhlaWdodDogNzE4LAogICAgeEhlaWdodDogNTIzCiAgfTsKICB0WyJIZWx2ZXRpY2EtQm9sZCJdID0gewogICAgYXNjZW50OiA3MTgsCiAgICBkZXNjZW50OiAtMjA3LAogICAgY2FwSGVpZ2h0OiA3MTgsCiAgICB4SGVpZ2h0OiA1MzIKICB9OwogIHRbIkhlbHZldGljYS1PYmxpcXVlIl0gPSB7CiAgICBhc2NlbnQ6IDcxOCwKICAgIGRlc2NlbnQ6IC0yMDcsCiAgICBjYXBIZWlnaHQ6IDcxOCwKICAgIHhIZWlnaHQ6IDUyMwogIH07CiAgdFsiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIl0gPSB7CiAgICBhc2NlbnQ6IDcxOCwKICAgIGRlc2NlbnQ6IC0yMDcsCiAgICBjYXBIZWlnaHQ6IDcxOCwKICAgIHhIZWlnaHQ6IDUzMgogIH07CiAgdFsiVGltZXMtUm9tYW4iXSA9IHsKICAgIGFzY2VudDogNjgzLAogICAgZGVzY2VudDogLTIxNywKICAgIGNhcEhlaWdodDogNjYyLAogICAgeEhlaWdodDogNDUwCiAgfTsKICB0WyJUaW1lcy1Cb2xkIl0gPSB7CiAgICBhc2NlbnQ6IDY4MywKICAgIGRlc2NlbnQ6IC0yMTcsCiAgICBjYXBIZWlnaHQ6IDY3NiwKICAgIHhIZWlnaHQ6IDQ2MQogIH07CiAgdFsiVGltZXMtSXRhbGljIl0gPSB7CiAgICBhc2NlbnQ6IDY4MywKICAgIGRlc2NlbnQ6IC0yMTcsCiAgICBjYXBIZWlnaHQ6IDY1MywKICAgIHhIZWlnaHQ6IDQ0MQogIH07CiAgdFsiVGltZXMtQm9sZEl0YWxpYyJdID0gewogICAgYXNjZW50OiA2ODMsCiAgICBkZXNjZW50OiAtMjE3LAogICAgY2FwSGVpZ2h0OiA2NjksCiAgICB4SGVpZ2h0OiA0NjIKICB9OwogIHQuU3ltYm9sID0gewogICAgYXNjZW50OiBNYXRoLk5hTiwKICAgIGRlc2NlbnQ6IE1hdGguTmFOLAogICAgY2FwSGVpZ2h0OiBNYXRoLk5hTiwKICAgIHhIZWlnaHQ6IE1hdGguTmFOCiAgfTsKICB0LlphcGZEaW5nYmF0cyA9IHsKICAgIGFzY2VudDogTWF0aC5OYU4sCiAgICBkZXNjZW50OiBNYXRoLk5hTiwKICAgIGNhcEhlaWdodDogTWF0aC5OYU4sCiAgICB4SGVpZ2h0OiBNYXRoLk5hTgogIH07Cn0pOwpleHBvcnRzLmdldEZvbnRCYXNpY01ldHJpY3MgPSBnZXRGb250QmFzaWNNZXRyaWNzOwoKLyoqKi8gfSksCi8qIDE3MSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuR2x5ZlRhYmxlID0gdm9pZCAwOwpjb25zdCBPTl9DVVJWRV9QT0lOVCA9IDEgPDwgMDsKY29uc3QgWF9TSE9SVF9WRUNUT1IgPSAxIDw8IDE7CmNvbnN0IFlfU0hPUlRfVkVDVE9SID0gMSA8PCAyOwpjb25zdCBSRVBFQVRfRkxBRyA9IDEgPDwgMzsKY29uc3QgWF9JU19TQU1FX09SX1BPU0lUSVZFX1hfU0hPUlRfVkVDVE9SID0gMSA8PCA0Owpjb25zdCBZX0lTX1NBTUVfT1JfUE9TSVRJVkVfWV9TSE9SVF9WRUNUT1IgPSAxIDw8IDU7CmNvbnN0IE9WRVJMQVBfU0lNUExFID0gMSA8PCA2Owpjb25zdCBBUkdfMV9BTkRfMl9BUkVfV09SRFMgPSAxIDw8IDA7CmNvbnN0IEFSR1NfQVJFX1hZX1ZBTFVFUyA9IDEgPDwgMTsKY29uc3QgV0VfSEFWRV9BX1NDQUxFID0gMSA8PCAzOwpjb25zdCBNT1JFX0NPTVBPTkVOVFMgPSAxIDw8IDU7CmNvbnN0IFdFX0hBVkVfQU5fWF9BTkRfWV9TQ0FMRSA9IDEgPDwgNjsKY29uc3QgV0VfSEFWRV9BX1RXT19CWV9UV08gPSAxIDw8IDc7CmNvbnN0IFdFX0hBVkVfSU5TVFJVQ1RJT05TID0gMSA8PCA4OwoKY2xhc3MgR2x5ZlRhYmxlIHsKICBjb25zdHJ1Y3RvcihfcmVmKSB7CiAgICBsZXQgewogICAgICBnbHlmVGFibGUsCiAgICAgIGlzR2x5cGhMb2NhdGlvbnNMb25nLAogICAgICBsb2NhVGFibGUsCiAgICAgIG51bUdseXBocwogICAgfSA9IF9yZWY7CiAgICB0aGlzLmdseXBocyA9IFtdOwogICAgY29uc3QgbG9jYSA9IG5ldyBEYXRhVmlldyhsb2NhVGFibGUuYnVmZmVyLCBsb2NhVGFibGUuYnl0ZU9mZnNldCwgbG9jYVRhYmxlLmJ5dGVMZW5ndGgpOwogICAgY29uc3QgZ2x5ZiA9IG5ldyBEYXRhVmlldyhnbHlmVGFibGUuYnVmZmVyLCBnbHlmVGFibGUuYnl0ZU9mZnNldCwgZ2x5ZlRhYmxlLmJ5dGVMZW5ndGgpOwogICAgY29uc3Qgb2Zmc2V0U2l6ZSA9IGlzR2x5cGhMb2NhdGlvbnNMb25nID8gNCA6IDI7CiAgICBsZXQgcHJldiA9IGlzR2x5cGhMb2NhdGlvbnNMb25nID8gbG9jYS5nZXRVaW50MzIoMCkgOiAyICogbG9jYS5nZXRVaW50MTYoMCk7CiAgICBsZXQgcG9zID0gMDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUdseXBoczsgaSsrKSB7CiAgICAgIHBvcyArPSBvZmZzZXRTaXplOwogICAgICBjb25zdCBuZXh0ID0gaXNHbHlwaExvY2F0aW9uc0xvbmcgPyBsb2NhLmdldFVpbnQzMihwb3MpIDogMiAqIGxvY2EuZ2V0VWludDE2KHBvcyk7CgogICAgICBpZiAobmV4dCA9PT0gcHJldikgewogICAgICAgIHRoaXMuZ2x5cGhzLnB1c2gobmV3IEdseXBoKHt9KSk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGdseXBoID0gR2x5cGgucGFyc2UocHJldiwgZ2x5Zik7CiAgICAgIHRoaXMuZ2x5cGhzLnB1c2goZ2x5cGgpOwogICAgICBwcmV2ID0gbmV4dDsKICAgIH0KICB9CgogIGdldFNpemUoKSB7CiAgICByZXR1cm4gdGhpcy5nbHlwaHMucmVkdWNlKChhLCBnKSA9PiB7CiAgICAgIGNvbnN0IHNpemUgPSBnLmdldFNpemUoKTsKICAgICAgcmV0dXJuIGEgKyAoc2l6ZSArIDMgJiB+Myk7CiAgICB9LCAwKTsKICB9CgogIHdyaXRlKCkgewogICAgY29uc3QgdG90YWxTaXplID0gdGhpcy5nZXRTaXplKCk7CiAgICBjb25zdCBnbHlmVGFibGUgPSBuZXcgRGF0YVZpZXcobmV3IEFycmF5QnVmZmVyKHRvdGFsU2l6ZSkpOwogICAgY29uc3QgaXNMb2NhdGlvbkxvbmcgPSB0b3RhbFNpemUgPiAweDFmZmZlOwogICAgY29uc3Qgb2Zmc2V0U2l6ZSA9IGlzTG9jYXRpb25Mb25nID8gNCA6IDI7CiAgICBjb25zdCBsb2NhVGFibGUgPSBuZXcgRGF0YVZpZXcobmV3IEFycmF5QnVmZmVyKCh0aGlzLmdseXBocy5sZW5ndGggKyAxKSAqIG9mZnNldFNpemUpKTsKCiAgICBpZiAoaXNMb2NhdGlvbkxvbmcpIHsKICAgICAgbG9jYVRhYmxlLnNldFVpbnQzMigwLCAwKTsKICAgIH0gZWxzZSB7CiAgICAgIGxvY2FUYWJsZS5zZXRVaW50MTYoMCwgMCk7CiAgICB9CgogICAgbGV0IHBvcyA9IDA7CiAgICBsZXQgbG9jYUluZGV4ID0gMDsKCiAgICBmb3IgKGNvbnN0IGdseXBoIG9mIHRoaXMuZ2x5cGhzKSB7CiAgICAgIHBvcyArPSBnbHlwaC53cml0ZShwb3MsIGdseWZUYWJsZSk7CiAgICAgIHBvcyA9IHBvcyArIDMgJiB+MzsKICAgICAgbG9jYUluZGV4ICs9IG9mZnNldFNpemU7CgogICAgICBpZiAoaXNMb2NhdGlvbkxvbmcpIHsKICAgICAgICBsb2NhVGFibGUuc2V0VWludDMyKGxvY2FJbmRleCwgcG9zKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsb2NhVGFibGUuc2V0VWludDE2KGxvY2FJbmRleCwgcG9zID4+IDEpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgaXNMb2NhdGlvbkxvbmcsCiAgICAgIGxvY2E6IG5ldyBVaW50OEFycmF5KGxvY2FUYWJsZS5idWZmZXIpLAogICAgICBnbHlmOiBuZXcgVWludDhBcnJheShnbHlmVGFibGUuYnVmZmVyKQogICAgfTsKICB9CgogIHNjYWxlKGZhY3RvcnMpIHsKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHRoaXMuZ2x5cGhzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgdGhpcy5nbHlwaHNbaV0uc2NhbGUoZmFjdG9yc1tpXSk7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5HbHlmVGFibGUgPSBHbHlmVGFibGU7CgpjbGFzcyBHbHlwaCB7CiAgY29uc3RydWN0b3IoX3JlZjIpIHsKICAgIGxldCB7CiAgICAgIGhlYWRlciA9IG51bGwsCiAgICAgIHNpbXBsZSA9IG51bGwsCiAgICAgIGNvbXBvc2l0ZXMgPSBudWxsCiAgICB9ID0gX3JlZjI7CiAgICB0aGlzLmhlYWRlciA9IGhlYWRlcjsKICAgIHRoaXMuc2ltcGxlID0gc2ltcGxlOwogICAgdGhpcy5jb21wb3NpdGVzID0gY29tcG9zaXRlczsKICB9CgogIHN0YXRpYyBwYXJzZShwb3MsIGdseWYpIHsKICAgIGNvbnN0IFtyZWFkLCBoZWFkZXJdID0gR2x5cGhIZWFkZXIucGFyc2UocG9zLCBnbHlmKTsKICAgIHBvcyArPSByZWFkOwoKICAgIGlmIChoZWFkZXIubnVtYmVyT2ZDb250b3VycyA8IDApIHsKICAgICAgY29uc3QgY29tcG9zaXRlcyA9IFtdOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBjb25zdCBbbiwgY29tcG9zaXRlXSA9IENvbXBvc2l0ZUdseXBoLnBhcnNlKHBvcywgZ2x5Zik7CiAgICAgICAgcG9zICs9IG47CiAgICAgICAgY29tcG9zaXRlcy5wdXNoKGNvbXBvc2l0ZSk7CgogICAgICAgIGlmICghKGNvbXBvc2l0ZS5mbGFncyAmIE1PUkVfQ09NUE9ORU5UUykpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBHbHlwaCh7CiAgICAgICAgaGVhZGVyLAogICAgICAgIGNvbXBvc2l0ZXMKICAgICAgfSk7CiAgICB9CgogICAgY29uc3Qgc2ltcGxlID0gU2ltcGxlR2x5cGgucGFyc2UocG9zLCBnbHlmLCBoZWFkZXIubnVtYmVyT2ZDb250b3Vycyk7CiAgICByZXR1cm4gbmV3IEdseXBoKHsKICAgICAgaGVhZGVyLAogICAgICBzaW1wbGUKICAgIH0pOwogIH0KCiAgZ2V0U2l6ZSgpIHsKICAgIGlmICghdGhpcy5oZWFkZXIpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgY29uc3Qgc2l6ZSA9IHRoaXMuc2ltcGxlID8gdGhpcy5zaW1wbGUuZ2V0U2l6ZSgpIDogdGhpcy5jb21wb3NpdGVzLnJlZHVjZSgoYSwgYykgPT4gYSArIGMuZ2V0U2l6ZSgpLCAwKTsKICAgIHJldHVybiB0aGlzLmhlYWRlci5nZXRTaXplKCkgKyBzaXplOwogIH0KCiAgd3JpdGUocG9zLCBidWYpIHsKICAgIGlmICghdGhpcy5oZWFkZXIpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgY29uc3Qgc3BvcyA9IHBvczsKICAgIHBvcyArPSB0aGlzLmhlYWRlci53cml0ZShwb3MsIGJ1Zik7CgogICAgaWYgKHRoaXMuc2ltcGxlKSB7CiAgICAgIHBvcyArPSB0aGlzLnNpbXBsZS53cml0ZShwb3MsIGJ1Zik7CiAgICB9IGVsc2UgewogICAgICBmb3IgKGNvbnN0IGNvbXBvc2l0ZSBvZiB0aGlzLmNvbXBvc2l0ZXMpIHsKICAgICAgICBwb3MgKz0gY29tcG9zaXRlLndyaXRlKHBvcywgYnVmKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBwb3MgLSBzcG9zOwogIH0KCiAgc2NhbGUoZmFjdG9yKSB7CiAgICBpZiAoIXRoaXMuaGVhZGVyKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCB4TWlkZGxlID0gKHRoaXMuaGVhZGVyLnhNaW4gKyB0aGlzLmhlYWRlci54TWF4KSAvIDI7CiAgICB0aGlzLmhlYWRlci5zY2FsZSh4TWlkZGxlLCBmYWN0b3IpOwoKICAgIGlmICh0aGlzLnNpbXBsZSkgewogICAgICB0aGlzLnNpbXBsZS5zY2FsZSh4TWlkZGxlLCBmYWN0b3IpOwogICAgfSBlbHNlIHsKICAgICAgZm9yIChjb25zdCBjb21wb3NpdGUgb2YgdGhpcy5jb21wb3NpdGVzKSB7CiAgICAgICAgY29tcG9zaXRlLnNjYWxlKHhNaWRkbGUsIGZhY3Rvcik7CiAgICAgIH0KICAgIH0KICB9Cgp9CgpjbGFzcyBHbHlwaEhlYWRlciB7CiAgY29uc3RydWN0b3IoX3JlZjMpIHsKICAgIGxldCB7CiAgICAgIG51bWJlck9mQ29udG91cnMsCiAgICAgIHhNaW4sCiAgICAgIHlNaW4sCiAgICAgIHhNYXgsCiAgICAgIHlNYXgKICAgIH0gPSBfcmVmMzsKICAgIHRoaXMubnVtYmVyT2ZDb250b3VycyA9IG51bWJlck9mQ29udG91cnM7CiAgICB0aGlzLnhNaW4gPSB4TWluOwogICAgdGhpcy55TWluID0geU1pbjsKICAgIHRoaXMueE1heCA9IHhNYXg7CiAgICB0aGlzLnlNYXggPSB5TWF4OwogIH0KCiAgc3RhdGljIHBhcnNlKHBvcywgZ2x5ZikgewogICAgcmV0dXJuIFsxMCwgbmV3IEdseXBoSGVhZGVyKHsKICAgICAgbnVtYmVyT2ZDb250b3VyczogZ2x5Zi5nZXRJbnQxNihwb3MpLAogICAgICB4TWluOiBnbHlmLmdldEludDE2KHBvcyArIDIpLAogICAgICB5TWluOiBnbHlmLmdldEludDE2KHBvcyArIDQpLAogICAgICB4TWF4OiBnbHlmLmdldEludDE2KHBvcyArIDYpLAogICAgICB5TWF4OiBnbHlmLmdldEludDE2KHBvcyArIDgpCiAgICB9KV07CiAgfQoKICBnZXRTaXplKCkgewogICAgcmV0dXJuIDEwOwogIH0KCiAgd3JpdGUocG9zLCBidWYpIHsKICAgIGJ1Zi5zZXRJbnQxNihwb3MsIHRoaXMubnVtYmVyT2ZDb250b3Vycyk7CiAgICBidWYuc2V0SW50MTYocG9zICsgMiwgdGhpcy54TWluKTsKICAgIGJ1Zi5zZXRJbnQxNihwb3MgKyA0LCB0aGlzLnlNaW4pOwogICAgYnVmLnNldEludDE2KHBvcyArIDYsIHRoaXMueE1heCk7CiAgICBidWYuc2V0SW50MTYocG9zICsgOCwgdGhpcy55TWF4KTsKICAgIHJldHVybiAxMDsKICB9CgogIHNjYWxlKHgsIGZhY3RvcikgewogICAgdGhpcy54TWluID0gTWF0aC5yb3VuZCh4ICsgKHRoaXMueE1pbiAtIHgpICogZmFjdG9yKTsKICAgIHRoaXMueE1heCA9IE1hdGgucm91bmQoeCArICh0aGlzLnhNYXggLSB4KSAqIGZhY3Rvcik7CiAgfQoKfQoKY2xhc3MgQ29udG91ciB7CiAgY29uc3RydWN0b3IoX3JlZjQpIHsKICAgIGxldCB7CiAgICAgIGZsYWdzLAogICAgICB4Q29vcmRpbmF0ZXMsCiAgICAgIHlDb29yZGluYXRlcwogICAgfSA9IF9yZWY0OwogICAgdGhpcy54Q29vcmRpbmF0ZXMgPSB4Q29vcmRpbmF0ZXM7CiAgICB0aGlzLnlDb29yZGluYXRlcyA9IHlDb29yZGluYXRlczsKICAgIHRoaXMuZmxhZ3MgPSBmbGFnczsKICB9Cgp9CgpjbGFzcyBTaW1wbGVHbHlwaCB7CiAgY29uc3RydWN0b3IoX3JlZjUpIHsKICAgIGxldCB7CiAgICAgIGNvbnRvdXJzLAogICAgICBpbnN0cnVjdGlvbnMKICAgIH0gPSBfcmVmNTsKICAgIHRoaXMuY29udG91cnMgPSBjb250b3VyczsKICAgIHRoaXMuaW5zdHJ1Y3Rpb25zID0gaW5zdHJ1Y3Rpb25zOwogIH0KCiAgc3RhdGljIHBhcnNlKHBvcywgZ2x5ZiwgbnVtYmVyT2ZDb250b3VycykgewogICAgY29uc3QgZW5kUHRzT2ZDb250b3VycyA9IFtdOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtYmVyT2ZDb250b3VyczsgaSsrKSB7CiAgICAgIGNvbnN0IGVuZFB0ID0gZ2x5Zi5nZXRVaW50MTYocG9zKTsKICAgICAgcG9zICs9IDI7CiAgICAgIGVuZFB0c09mQ29udG91cnMucHVzaChlbmRQdCk7CiAgICB9CgogICAgY29uc3QgbnVtYmVyT2ZQdCA9IGVuZFB0c09mQ29udG91cnNbbnVtYmVyT2ZDb250b3VycyAtIDFdICsgMTsKICAgIGNvbnN0IGluc3RydWN0aW9uTGVuZ3RoID0gZ2x5Zi5nZXRVaW50MTYocG9zKTsKICAgIHBvcyArPSAyOwogICAgY29uc3QgaW5zdHJ1Y3Rpb25zID0gbmV3IFVpbnQ4QXJyYXkoZ2x5Zikuc2xpY2UocG9zLCBwb3MgKyBpbnN0cnVjdGlvbkxlbmd0aCk7CiAgICBwb3MgKz0gaW5zdHJ1Y3Rpb25MZW5ndGg7CiAgICBjb25zdCBmbGFncyA9IFtdOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtYmVyT2ZQdDsgcG9zKyssIGkrKykgewogICAgICBsZXQgZmxhZyA9IGdseWYuZ2V0VWludDgocG9zKTsKICAgICAgZmxhZ3MucHVzaChmbGFnKTsKCiAgICAgIGlmIChmbGFnICYgUkVQRUFUX0ZMQUcpIHsKICAgICAgICBjb25zdCBjb3VudCA9IGdseWYuZ2V0VWludDgoKytwb3MpOwogICAgICAgIGZsYWcgXj0gUkVQRUFUX0ZMQUc7CgogICAgICAgIGZvciAobGV0IG0gPSAwOyBtIDwgY291bnQ7IG0rKykgewogICAgICAgICAgZmxhZ3MucHVzaChmbGFnKTsKICAgICAgICB9CgogICAgICAgIGkgKz0gY291bnQ7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBhbGxYQ29vcmRpbmF0ZXMgPSBbXTsKICAgIGxldCB4Q29vcmRpbmF0ZXMgPSBbXTsKICAgIGxldCB5Q29vcmRpbmF0ZXMgPSBbXTsKICAgIGxldCBwb2ludEZsYWdzID0gW107CiAgICBjb25zdCBjb250b3VycyA9IFtdOwogICAgbGV0IGVuZFB0c09mQ29udG91cnNJbmRleCA9IDA7CiAgICBsZXQgbGFzdENvb3JkaW5hdGUgPSAwOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtYmVyT2ZQdDsgaSsrKSB7CiAgICAgIGNvbnN0IGZsYWcgPSBmbGFnc1tpXTsKCiAgICAgIGlmIChmbGFnICYgWF9TSE9SVF9WRUNUT1IpIHsKICAgICAgICBjb25zdCB4ID0gZ2x5Zi5nZXRVaW50OChwb3MrKyk7CiAgICAgICAgbGFzdENvb3JkaW5hdGUgKz0gZmxhZyAmIFhfSVNfU0FNRV9PUl9QT1NJVElWRV9YX1NIT1JUX1ZFQ1RPUiA/IHggOiAteDsKICAgICAgICB4Q29vcmRpbmF0ZXMucHVzaChsYXN0Q29vcmRpbmF0ZSk7CiAgICAgIH0gZWxzZSBpZiAoZmxhZyAmIFhfSVNfU0FNRV9PUl9QT1NJVElWRV9YX1NIT1JUX1ZFQ1RPUikgewogICAgICAgIHhDb29yZGluYXRlcy5wdXNoKGxhc3RDb29yZGluYXRlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsYXN0Q29vcmRpbmF0ZSArPSBnbHlmLmdldEludDE2KHBvcyk7CiAgICAgICAgcG9zICs9IDI7CiAgICAgICAgeENvb3JkaW5hdGVzLnB1c2gobGFzdENvb3JkaW5hdGUpOwogICAgICB9CgogICAgICBpZiAoZW5kUHRzT2ZDb250b3Vyc1tlbmRQdHNPZkNvbnRvdXJzSW5kZXhdID09PSBpKSB7CiAgICAgICAgZW5kUHRzT2ZDb250b3Vyc0luZGV4Kys7CiAgICAgICAgYWxsWENvb3JkaW5hdGVzLnB1c2goeENvb3JkaW5hdGVzKTsKICAgICAgICB4Q29vcmRpbmF0ZXMgPSBbXTsKICAgICAgfQogICAgfQoKICAgIGxhc3RDb29yZGluYXRlID0gMDsKICAgIGVuZFB0c09mQ29udG91cnNJbmRleCA9IDA7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1iZXJPZlB0OyBpKyspIHsKICAgICAgY29uc3QgZmxhZyA9IGZsYWdzW2ldOwoKICAgICAgaWYgKGZsYWcgJiBZX1NIT1JUX1ZFQ1RPUikgewogICAgICAgIGNvbnN0IHkgPSBnbHlmLmdldFVpbnQ4KHBvcysrKTsKICAgICAgICBsYXN0Q29vcmRpbmF0ZSArPSBmbGFnICYgWV9JU19TQU1FX09SX1BPU0lUSVZFX1lfU0hPUlRfVkVDVE9SID8geSA6IC15OwogICAgICAgIHlDb29yZGluYXRlcy5wdXNoKGxhc3RDb29yZGluYXRlKTsKICAgICAgfSBlbHNlIGlmIChmbGFnICYgWV9JU19TQU1FX09SX1BPU0lUSVZFX1lfU0hPUlRfVkVDVE9SKSB7CiAgICAgICAgeUNvb3JkaW5hdGVzLnB1c2gobGFzdENvb3JkaW5hdGUpOwogICAgICB9IGVsc2UgewogICAgICAgIGxhc3RDb29yZGluYXRlICs9IGdseWYuZ2V0SW50MTYocG9zKTsKICAgICAgICBwb3MgKz0gMjsKICAgICAgICB5Q29vcmRpbmF0ZXMucHVzaChsYXN0Q29vcmRpbmF0ZSk7CiAgICAgIH0KCiAgICAgIHBvaW50RmxhZ3MucHVzaChmbGFnICYgT05fQ1VSVkVfUE9JTlQgfCBmbGFnICYgT1ZFUkxBUF9TSU1QTEUpOwoKICAgICAgaWYgKGVuZFB0c09mQ29udG91cnNbZW5kUHRzT2ZDb250b3Vyc0luZGV4XSA9PT0gaSkgewogICAgICAgIHhDb29yZGluYXRlcyA9IGFsbFhDb29yZGluYXRlc1tlbmRQdHNPZkNvbnRvdXJzSW5kZXhdOwogICAgICAgIGVuZFB0c09mQ29udG91cnNJbmRleCsrOwogICAgICAgIGNvbnRvdXJzLnB1c2gobmV3IENvbnRvdXIoewogICAgICAgICAgZmxhZ3M6IHBvaW50RmxhZ3MsCiAgICAgICAgICB4Q29vcmRpbmF0ZXMsCiAgICAgICAgICB5Q29vcmRpbmF0ZXMKICAgICAgICB9KSk7CiAgICAgICAgeUNvb3JkaW5hdGVzID0gW107CiAgICAgICAgcG9pbnRGbGFncyA9IFtdOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG5ldyBTaW1wbGVHbHlwaCh7CiAgICAgIGNvbnRvdXJzLAogICAgICBpbnN0cnVjdGlvbnMKICAgIH0pOwogIH0KCiAgZ2V0U2l6ZSgpIHsKICAgIGxldCBzaXplID0gdGhpcy5jb250b3Vycy5sZW5ndGggKiAyICsgMiArIHRoaXMuaW5zdHJ1Y3Rpb25zLmxlbmd0aDsKICAgIGxldCBsYXN0WCA9IDA7CiAgICBsZXQgbGFzdFkgPSAwOwoKICAgIGZvciAoY29uc3QgY29udG91ciBvZiB0aGlzLmNvbnRvdXJzKSB7CiAgICAgIHNpemUgKz0gY29udG91ci5mbGFncy5sZW5ndGg7CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb250b3VyLnhDb29yZGluYXRlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29uc3QgeCA9IGNvbnRvdXIueENvb3JkaW5hdGVzW2ldOwogICAgICAgIGNvbnN0IHkgPSBjb250b3VyLnlDb29yZGluYXRlc1tpXTsKICAgICAgICBsZXQgYWJzID0gTWF0aC5hYnMoeCAtIGxhc3RYKTsKCiAgICAgICAgaWYgKGFicyA+IDI1NSkgewogICAgICAgICAgc2l6ZSArPSAyOwogICAgICAgIH0gZWxzZSBpZiAoYWJzID4gMCkgewogICAgICAgICAgc2l6ZSArPSAxOwogICAgICAgIH0KCiAgICAgICAgbGFzdFggPSB4OwogICAgICAgIGFicyA9IE1hdGguYWJzKHkgLSBsYXN0WSk7CgogICAgICAgIGlmIChhYnMgPiAyNTUpIHsKICAgICAgICAgIHNpemUgKz0gMjsKICAgICAgICB9IGVsc2UgaWYgKGFicyA+IDApIHsKICAgICAgICAgIHNpemUgKz0gMTsKICAgICAgICB9CgogICAgICAgIGxhc3RZID0geTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBzaXplOwogIH0KCiAgd3JpdGUocG9zLCBidWYpIHsKICAgIGNvbnN0IHNwb3MgPSBwb3M7CiAgICBjb25zdCB4Q29vcmRpbmF0ZXMgPSBbXTsKICAgIGNvbnN0IHlDb29yZGluYXRlcyA9IFtdOwogICAgY29uc3QgZmxhZ3MgPSBbXTsKICAgIGxldCBsYXN0WCA9IDA7CiAgICBsZXQgbGFzdFkgPSAwOwoKICAgIGZvciAoY29uc3QgY29udG91ciBvZiB0aGlzLmNvbnRvdXJzKSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNvbnRvdXIueENvb3JkaW5hdGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBsZXQgZmxhZyA9IGNvbnRvdXIuZmxhZ3NbaV07CiAgICAgICAgY29uc3QgeCA9IGNvbnRvdXIueENvb3JkaW5hdGVzW2ldOwogICAgICAgIGxldCBkZWx0YSA9IHggLSBsYXN0WDsKCiAgICAgICAgaWYgKGRlbHRhID09PSAwKSB7CiAgICAgICAgICBmbGFnIHw9IFhfSVNfU0FNRV9PUl9QT1NJVElWRV9YX1NIT1JUX1ZFQ1RPUjsKICAgICAgICAgIHhDb29yZGluYXRlcy5wdXNoKDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCBhYnMgPSBNYXRoLmFicyhkZWx0YSk7CgogICAgICAgICAgaWYgKGFicyA8PSAyNTUpIHsKICAgICAgICAgICAgZmxhZyB8PSBkZWx0YSA+PSAwID8gWF9TSE9SVF9WRUNUT1IgfCBYX0lTX1NBTUVfT1JfUE9TSVRJVkVfWF9TSE9SVF9WRUNUT1IgOiBYX1NIT1JUX1ZFQ1RPUjsKICAgICAgICAgICAgeENvb3JkaW5hdGVzLnB1c2goYWJzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHhDb29yZGluYXRlcy5wdXNoKGRlbHRhKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGxhc3RYID0geDsKICAgICAgICBjb25zdCB5ID0gY29udG91ci55Q29vcmRpbmF0ZXNbaV07CiAgICAgICAgZGVsdGEgPSB5IC0gbGFzdFk7CgogICAgICAgIGlmIChkZWx0YSA9PT0gMCkgewogICAgICAgICAgZmxhZyB8PSBZX0lTX1NBTUVfT1JfUE9TSVRJVkVfWV9TSE9SVF9WRUNUT1I7CiAgICAgICAgICB5Q29vcmRpbmF0ZXMucHVzaCgwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgYWJzID0gTWF0aC5hYnMoZGVsdGEpOwoKICAgICAgICAgIGlmIChhYnMgPD0gMjU1KSB7CiAgICAgICAgICAgIGZsYWcgfD0gZGVsdGEgPj0gMCA/IFlfU0hPUlRfVkVDVE9SIHwgWV9JU19TQU1FX09SX1BPU0lUSVZFX1lfU0hPUlRfVkVDVE9SIDogWV9TSE9SVF9WRUNUT1I7CiAgICAgICAgICAgIHlDb29yZGluYXRlcy5wdXNoKGFicyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB5Q29vcmRpbmF0ZXMucHVzaChkZWx0YSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBsYXN0WSA9IHk7CiAgICAgICAgZmxhZ3MucHVzaChmbGFnKTsKICAgICAgfQoKICAgICAgYnVmLnNldFVpbnQxNihwb3MsIHhDb29yZGluYXRlcy5sZW5ndGggLSAxKTsKICAgICAgcG9zICs9IDI7CiAgICB9CgogICAgYnVmLnNldFVpbnQxNihwb3MsIHRoaXMuaW5zdHJ1Y3Rpb25zLmxlbmd0aCk7CiAgICBwb3MgKz0gMjsKCiAgICBpZiAodGhpcy5pbnN0cnVjdGlvbnMubGVuZ3RoKSB7CiAgICAgIG5ldyBVaW50OEFycmF5KGJ1Zi5idWZmZXIsIDAsIGJ1Zi5idWZmZXIuYnl0ZUxlbmd0aCkuc2V0KHRoaXMuaW5zdHJ1Y3Rpb25zLCBwb3MpOwogICAgICBwb3MgKz0gdGhpcy5pbnN0cnVjdGlvbnMubGVuZ3RoOwogICAgfQoKICAgIGZvciAoY29uc3QgZmxhZyBvZiBmbGFncykgewogICAgICBidWYuc2V0VWludDgocG9zKyssIGZsYWcpOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHhDb29yZGluYXRlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IHggPSB4Q29vcmRpbmF0ZXNbaV07CiAgICAgIGNvbnN0IGZsYWcgPSBmbGFnc1tpXTsKCiAgICAgIGlmIChmbGFnICYgWF9TSE9SVF9WRUNUT1IpIHsKICAgICAgICBidWYuc2V0VWludDgocG9zKyssIHgpOwogICAgICB9IGVsc2UgaWYgKCEoZmxhZyAmIFhfSVNfU0FNRV9PUl9QT1NJVElWRV9YX1NIT1JUX1ZFQ1RPUikpIHsKICAgICAgICBidWYuc2V0SW50MTYocG9zLCB4KTsKICAgICAgICBwb3MgKz0gMjsKICAgICAgfQogICAgfQoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHlDb29yZGluYXRlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IHkgPSB5Q29vcmRpbmF0ZXNbaV07CiAgICAgIGNvbnN0IGZsYWcgPSBmbGFnc1tpXTsKCiAgICAgIGlmIChmbGFnICYgWV9TSE9SVF9WRUNUT1IpIHsKICAgICAgICBidWYuc2V0VWludDgocG9zKyssIHkpOwogICAgICB9IGVsc2UgaWYgKCEoZmxhZyAmIFlfSVNfU0FNRV9PUl9QT1NJVElWRV9ZX1NIT1JUX1ZFQ1RPUikpIHsKICAgICAgICBidWYuc2V0SW50MTYocG9zLCB5KTsKICAgICAgICBwb3MgKz0gMjsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBwb3MgLSBzcG9zOwogIH0KCiAgc2NhbGUoeCwgZmFjdG9yKSB7CiAgICBmb3IgKGNvbnN0IGNvbnRvdXIgb2YgdGhpcy5jb250b3VycykgewogICAgICBpZiAoY29udG91ci54Q29vcmRpbmF0ZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNvbnRvdXIueENvb3JkaW5hdGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBjb250b3VyLnhDb29yZGluYXRlc1tpXSA9IE1hdGgucm91bmQoeCArIChjb250b3VyLnhDb29yZGluYXRlc1tpXSAtIHgpICogZmFjdG9yKTsKICAgICAgfQogICAgfQogIH0KCn0KCmNsYXNzIENvbXBvc2l0ZUdseXBoIHsKICBjb25zdHJ1Y3RvcihfcmVmNikgewogICAgbGV0IHsKICAgICAgZmxhZ3MsCiAgICAgIGdseXBoSW5kZXgsCiAgICAgIGFyZ3VtZW50MSwKICAgICAgYXJndW1lbnQyLAogICAgICB0cmFuc2YsCiAgICAgIGluc3RydWN0aW9ucwogICAgfSA9IF9yZWY2OwogICAgdGhpcy5mbGFncyA9IGZsYWdzOwogICAgdGhpcy5nbHlwaEluZGV4ID0gZ2x5cGhJbmRleDsKICAgIHRoaXMuYXJndW1lbnQxID0gYXJndW1lbnQxOwogICAgdGhpcy5hcmd1bWVudDIgPSBhcmd1bWVudDI7CiAgICB0aGlzLnRyYW5zZiA9IHRyYW5zZjsKICAgIHRoaXMuaW5zdHJ1Y3Rpb25zID0gaW5zdHJ1Y3Rpb25zOwogIH0KCiAgc3RhdGljIHBhcnNlKHBvcywgZ2x5ZikgewogICAgY29uc3Qgc3BvcyA9IHBvczsKICAgIGNvbnN0IHRyYW5zZiA9IFtdOwogICAgbGV0IGZsYWdzID0gZ2x5Zi5nZXRVaW50MTYocG9zKTsKICAgIGNvbnN0IGdseXBoSW5kZXggPSBnbHlmLmdldFVpbnQxNihwb3MgKyAyKTsKICAgIHBvcyArPSA0OwogICAgbGV0IGFyZ3VtZW50MSwgYXJndW1lbnQyOwoKICAgIGlmIChmbGFncyAmIEFSR18xX0FORF8yX0FSRV9XT1JEUykgewogICAgICBpZiAoZmxhZ3MgJiBBUkdTX0FSRV9YWV9WQUxVRVMpIHsKICAgICAgICBhcmd1bWVudDEgPSBnbHlmLmdldEludDE2KHBvcyk7CiAgICAgICAgYXJndW1lbnQyID0gZ2x5Zi5nZXRJbnQxNihwb3MgKyAyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBhcmd1bWVudDEgPSBnbHlmLmdldFVpbnQxNihwb3MpOwogICAgICAgIGFyZ3VtZW50MiA9IGdseWYuZ2V0VWludDE2KHBvcyArIDIpOwogICAgICB9CgogICAgICBwb3MgKz0gNDsKICAgICAgZmxhZ3MgXj0gQVJHXzFfQU5EXzJfQVJFX1dPUkRTOwogICAgfSBlbHNlIHsKICAgICAgaWYgKGZsYWdzICYgQVJHU19BUkVfWFlfVkFMVUVTKSB7CiAgICAgICAgYXJndW1lbnQxID0gZ2x5Zi5nZXRJbnQ4KHBvcyk7CiAgICAgICAgYXJndW1lbnQyID0gZ2x5Zi5nZXRJbnQ4KHBvcyArIDEpOwogICAgICB9IGVsc2UgewogICAgICAgIGFyZ3VtZW50MSA9IGdseWYuZ2V0VWludDgocG9zKTsKICAgICAgICBhcmd1bWVudDIgPSBnbHlmLmdldFVpbnQ4KHBvcyArIDEpOwogICAgICB9CgogICAgICBwb3MgKz0gMjsKICAgIH0KCiAgICBpZiAoZmxhZ3MgJiBXRV9IQVZFX0FfU0NBTEUpIHsKICAgICAgdHJhbnNmLnB1c2goZ2x5Zi5nZXRVaW50MTYocG9zKSk7CiAgICAgIHBvcyArPSAyOwogICAgfSBlbHNlIGlmIChmbGFncyAmIFdFX0hBVkVfQU5fWF9BTkRfWV9TQ0FMRSkgewogICAgICB0cmFuc2YucHVzaChnbHlmLmdldFVpbnQxNihwb3MpLCBnbHlmLmdldFVpbnQxNihwb3MgKyAyKSk7CiAgICAgIHBvcyArPSA0OwogICAgfSBlbHNlIGlmIChmbGFncyAmIFdFX0hBVkVfQV9UV09fQllfVFdPKSB7CiAgICAgIHRyYW5zZi5wdXNoKGdseWYuZ2V0VWludDE2KHBvcyksIGdseWYuZ2V0VWludDE2KHBvcyArIDIpLCBnbHlmLmdldFVpbnQxNihwb3MgKyA0KSwgZ2x5Zi5nZXRVaW50MTYocG9zICsgNikpOwogICAgICBwb3MgKz0gODsKICAgIH0KCiAgICBsZXQgaW5zdHJ1Y3Rpb25zID0gbnVsbDsKCiAgICBpZiAoZmxhZ3MgJiBXRV9IQVZFX0lOU1RSVUNUSU9OUykgewogICAgICBjb25zdCBpbnN0cnVjdGlvbkxlbmd0aCA9IGdseWYuZ2V0VWludDE2KHBvcyk7CiAgICAgIHBvcyArPSAyOwogICAgICBpbnN0cnVjdGlvbnMgPSBuZXcgVWludDhBcnJheShnbHlmKS5zbGljZShwb3MsIHBvcyArIGluc3RydWN0aW9uTGVuZ3RoKTsKICAgICAgcG9zICs9IGluc3RydWN0aW9uTGVuZ3RoOwogICAgfQoKICAgIHJldHVybiBbcG9zIC0gc3BvcywgbmV3IENvbXBvc2l0ZUdseXBoKHsKICAgICAgZmxhZ3MsCiAgICAgIGdseXBoSW5kZXgsCiAgICAgIGFyZ3VtZW50MSwKICAgICAgYXJndW1lbnQyLAogICAgICB0cmFuc2YsCiAgICAgIGluc3RydWN0aW9ucwogICAgfSldOwogIH0KCiAgZ2V0U2l6ZSgpIHsKICAgIGxldCBzaXplID0gMiArIDIgKyB0aGlzLnRyYW5zZi5sZW5ndGggKiAyOwoKICAgIGlmICh0aGlzLmZsYWdzICYgV0VfSEFWRV9JTlNUUlVDVElPTlMpIHsKICAgICAgc2l6ZSArPSAyICsgdGhpcy5pbnN0cnVjdGlvbnMubGVuZ3RoOwogICAgfQoKICAgIHNpemUgKz0gMjsKCiAgICBpZiAodGhpcy5mbGFncyAmIDIpIHsKICAgICAgaWYgKCEodGhpcy5hcmd1bWVudDEgPj0gLTEyOCAmJiB0aGlzLmFyZ3VtZW50MSA8PSAxMjcgJiYgdGhpcy5hcmd1bWVudDIgPj0gLTEyOCAmJiB0aGlzLmFyZ3VtZW50MiA8PSAxMjcpKSB7CiAgICAgICAgc2l6ZSArPSAyOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoISh0aGlzLmFyZ3VtZW50MSA+PSAwICYmIHRoaXMuYXJndW1lbnQxIDw9IDI1NSAmJiB0aGlzLmFyZ3VtZW50MiA+PSAwICYmIHRoaXMuYXJndW1lbnQyIDw9IDI1NSkpIHsKICAgICAgICBzaXplICs9IDI7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc2l6ZTsKICB9CgogIHdyaXRlKHBvcywgYnVmKSB7CiAgICBjb25zdCBzcG9zID0gcG9zOwoKICAgIGlmICh0aGlzLmZsYWdzICYgQVJHU19BUkVfWFlfVkFMVUVTKSB7CiAgICAgIGlmICghKHRoaXMuYXJndW1lbnQxID49IC0xMjggJiYgdGhpcy5hcmd1bWVudDEgPD0gMTI3ICYmIHRoaXMuYXJndW1lbnQyID49IC0xMjggJiYgdGhpcy5hcmd1bWVudDIgPD0gMTI3KSkgewogICAgICAgIHRoaXMuZmxhZ3MgfD0gQVJHXzFfQU5EXzJfQVJFX1dPUkRTOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoISh0aGlzLmFyZ3VtZW50MSA+PSAwICYmIHRoaXMuYXJndW1lbnQxIDw9IDI1NSAmJiB0aGlzLmFyZ3VtZW50MiA+PSAwICYmIHRoaXMuYXJndW1lbnQyIDw9IDI1NSkpIHsKICAgICAgICB0aGlzLmZsYWdzIHw9IEFSR18xX0FORF8yX0FSRV9XT1JEUzsKICAgICAgfQogICAgfQoKICAgIGJ1Zi5zZXRVaW50MTYocG9zLCB0aGlzLmZsYWdzKTsKICAgIGJ1Zi5zZXRVaW50MTYocG9zICsgMiwgdGhpcy5nbHlwaEluZGV4KTsKICAgIHBvcyArPSA0OwoKICAgIGlmICh0aGlzLmZsYWdzICYgQVJHXzFfQU5EXzJfQVJFX1dPUkRTKSB7CiAgICAgIGlmICh0aGlzLmZsYWdzICYgQVJHU19BUkVfWFlfVkFMVUVTKSB7CiAgICAgICAgYnVmLnNldEludDE2KHBvcywgdGhpcy5hcmd1bWVudDEpOwogICAgICAgIGJ1Zi5zZXRJbnQxNihwb3MgKyAyLCB0aGlzLmFyZ3VtZW50Mik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYnVmLnNldFVpbnQxNihwb3MsIHRoaXMuYXJndW1lbnQxKTsKICAgICAgICBidWYuc2V0VWludDE2KHBvcyArIDIsIHRoaXMuYXJndW1lbnQyKTsKICAgICAgfQoKICAgICAgcG9zICs9IDQ7CiAgICB9IGVsc2UgewogICAgICBidWYuc2V0VWludDgocG9zLCB0aGlzLmFyZ3VtZW50MSk7CiAgICAgIGJ1Zi5zZXRVaW50OChwb3MgKyAxLCB0aGlzLmFyZ3VtZW50Mik7CiAgICAgIHBvcyArPSAyOwogICAgfQoKICAgIGlmICh0aGlzLmZsYWdzICYgV0VfSEFWRV9JTlNUUlVDVElPTlMpIHsKICAgICAgYnVmLnNldFVpbnQxNihwb3MsIHRoaXMuaW5zdHJ1Y3Rpb25zLmxlbmd0aCk7CiAgICAgIHBvcyArPSAyOwoKICAgICAgaWYgKHRoaXMuaW5zdHJ1Y3Rpb25zLmxlbmd0aCkgewogICAgICAgIG5ldyBVaW50OEFycmF5KGJ1Zi5idWZmZXIsIDAsIGJ1Zi5idWZmZXIuYnl0ZUxlbmd0aCkuc2V0KHRoaXMuaW5zdHJ1Y3Rpb25zLCBwb3MpOwogICAgICAgIHBvcyArPSB0aGlzLmluc3RydWN0aW9ucy5sZW5ndGg7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcG9zIC0gc3BvczsKICB9CgogIHNjYWxlKHgsIGZhY3Rvcikge30KCn0KCi8qKiovIH0pLAovKiAxNzIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk9wZW5UeXBlRmlsZUJ1aWxkZXIgPSB2b2lkIDA7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKZnVuY3Rpb24gd3JpdGVJbnQxNihkZXN0LCBvZmZzZXQsIG51bSkgewogIGRlc3Rbb2Zmc2V0XSA9IG51bSA+PiA4ICYgMHhmZjsKICBkZXN0W29mZnNldCArIDFdID0gbnVtICYgMHhmZjsKfQoKZnVuY3Rpb24gd3JpdGVJbnQzMihkZXN0LCBvZmZzZXQsIG51bSkgewogIGRlc3Rbb2Zmc2V0XSA9IG51bSA+PiAyNCAmIDB4ZmY7CiAgZGVzdFtvZmZzZXQgKyAxXSA9IG51bSA+PiAxNiAmIDB4ZmY7CiAgZGVzdFtvZmZzZXQgKyAyXSA9IG51bSA+PiA4ICYgMHhmZjsKICBkZXN0W29mZnNldCArIDNdID0gbnVtICYgMHhmZjsKfQoKZnVuY3Rpb24gd3JpdGVEYXRhKGRlc3QsIG9mZnNldCwgZGF0YSkgewogIGlmIChkYXRhIGluc3RhbmNlb2YgVWludDhBcnJheSkgewogICAgZGVzdC5zZXQoZGF0YSwgb2Zmc2V0KTsKICB9IGVsc2UgaWYgKHR5cGVvZiBkYXRhID09PSAic3RyaW5nIikgewogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGF0YS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGRlc3Rbb2Zmc2V0KytdID0gZGF0YS5jaGFyQ29kZUF0KGkpICYgMHhmZjsKICAgIH0KICB9IGVsc2UgewogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGF0YS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGRlc3Rbb2Zmc2V0KytdID0gZGF0YVtpXSAmIDB4ZmY7CiAgICB9CiAgfQp9Cgpjb25zdCBPVEZfSEVBREVSX1NJWkUgPSAxMjsKY29uc3QgT1RGX1RBQkxFX0VOVFJZX1NJWkUgPSAxNjsKCmNsYXNzIE9wZW5UeXBlRmlsZUJ1aWxkZXIgewogIGNvbnN0cnVjdG9yKHNmbnQpIHsKICAgIHRoaXMuc2ZudCA9IHNmbnQ7CiAgICB0aGlzLnRhYmxlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgfQoKICBzdGF0aWMgZ2V0U2VhcmNoUGFyYW1zKGVudHJpZXNDb3VudCwgZW50cnlTaXplKSB7CiAgICBsZXQgbWF4UG93ZXIyID0gMSwKICAgICAgICBsb2cyID0gMDsKCiAgICB3aGlsZSAoKG1heFBvd2VyMiBeIGVudHJpZXNDb3VudCkgPiBtYXhQb3dlcjIpIHsKICAgICAgbWF4UG93ZXIyIDw8PSAxOwogICAgICBsb2cyKys7CiAgICB9CgogICAgY29uc3Qgc2VhcmNoUmFuZ2UgPSBtYXhQb3dlcjIgKiBlbnRyeVNpemU7CiAgICByZXR1cm4gewogICAgICByYW5nZTogc2VhcmNoUmFuZ2UsCiAgICAgIGVudHJ5OiBsb2cyLAogICAgICByYW5nZVNoaWZ0OiBlbnRyeVNpemUgKiBlbnRyaWVzQ291bnQgLSBzZWFyY2hSYW5nZQogICAgfTsKICB9CgogIHRvQXJyYXkoKSB7CiAgICBsZXQgc2ZudCA9IHRoaXMuc2ZudDsKICAgIGNvbnN0IHRhYmxlcyA9IHRoaXMudGFibGVzOwogICAgY29uc3QgdGFibGVzTmFtZXMgPSBPYmplY3Qua2V5cyh0YWJsZXMpOwogICAgdGFibGVzTmFtZXMuc29ydCgpOwogICAgY29uc3QgbnVtVGFibGVzID0gdGFibGVzTmFtZXMubGVuZ3RoOwogICAgbGV0IGksIGosIGpqLCB0YWJsZSwgdGFibGVOYW1lOwogICAgbGV0IG9mZnNldCA9IE9URl9IRUFERVJfU0laRSArIG51bVRhYmxlcyAqIE9URl9UQUJMRV9FTlRSWV9TSVpFOwogICAgY29uc3QgdGFibGVPZmZzZXRzID0gW29mZnNldF07CgogICAgZm9yIChpID0gMDsgaSA8IG51bVRhYmxlczsgaSsrKSB7CiAgICAgIHRhYmxlID0gdGFibGVzW3RhYmxlc05hbWVzW2ldXTsKICAgICAgY29uc3QgcGFkZGVkTGVuZ3RoID0gKHRhYmxlLmxlbmd0aCArIDMgJiB+MykgPj4+IDA7CiAgICAgIG9mZnNldCArPSBwYWRkZWRMZW5ndGg7CiAgICAgIHRhYmxlT2Zmc2V0cy5wdXNoKG9mZnNldCk7CiAgICB9CgogICAgY29uc3QgZmlsZSA9IG5ldyBVaW50OEFycmF5KG9mZnNldCk7CgogICAgZm9yIChpID0gMDsgaSA8IG51bVRhYmxlczsgaSsrKSB7CiAgICAgIHRhYmxlID0gdGFibGVzW3RhYmxlc05hbWVzW2ldXTsKICAgICAgd3JpdGVEYXRhKGZpbGUsIHRhYmxlT2Zmc2V0c1tpXSwgdGFibGUpOwogICAgfQoKICAgIGlmIChzZm50ID09PSAidHJ1ZSIpIHsKICAgICAgc2ZudCA9ICgwLCBfdXRpbC5zdHJpbmczMikoMHgwMDAxMDAwMCk7CiAgICB9CgogICAgZmlsZVswXSA9IHNmbnQuY2hhckNvZGVBdCgwKSAmIDB4ZmY7CiAgICBmaWxlWzFdID0gc2ZudC5jaGFyQ29kZUF0KDEpICYgMHhmZjsKICAgIGZpbGVbMl0gPSBzZm50LmNoYXJDb2RlQXQoMikgJiAweGZmOwogICAgZmlsZVszXSA9IHNmbnQuY2hhckNvZGVBdCgzKSAmIDB4ZmY7CiAgICB3cml0ZUludDE2KGZpbGUsIDQsIG51bVRhYmxlcyk7CiAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSBPcGVuVHlwZUZpbGVCdWlsZGVyLmdldFNlYXJjaFBhcmFtcyhudW1UYWJsZXMsIDE2KTsKICAgIHdyaXRlSW50MTYoZmlsZSwgNiwgc2VhcmNoUGFyYW1zLnJhbmdlKTsKICAgIHdyaXRlSW50MTYoZmlsZSwgOCwgc2VhcmNoUGFyYW1zLmVudHJ5KTsKICAgIHdyaXRlSW50MTYoZmlsZSwgMTAsIHNlYXJjaFBhcmFtcy5yYW5nZVNoaWZ0KTsKICAgIG9mZnNldCA9IE9URl9IRUFERVJfU0laRTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgbnVtVGFibGVzOyBpKyspIHsKICAgICAgdGFibGVOYW1lID0gdGFibGVzTmFtZXNbaV07CiAgICAgIGZpbGVbb2Zmc2V0XSA9IHRhYmxlTmFtZS5jaGFyQ29kZUF0KDApICYgMHhmZjsKICAgICAgZmlsZVtvZmZzZXQgKyAxXSA9IHRhYmxlTmFtZS5jaGFyQ29kZUF0KDEpICYgMHhmZjsKICAgICAgZmlsZVtvZmZzZXQgKyAyXSA9IHRhYmxlTmFtZS5jaGFyQ29kZUF0KDIpICYgMHhmZjsKICAgICAgZmlsZVtvZmZzZXQgKyAzXSA9IHRhYmxlTmFtZS5jaGFyQ29kZUF0KDMpICYgMHhmZjsKICAgICAgbGV0IGNoZWNrc3VtID0gMDsKCiAgICAgIGZvciAoaiA9IHRhYmxlT2Zmc2V0c1tpXSwgamogPSB0YWJsZU9mZnNldHNbaSArIDFdOyBqIDwgamo7IGogKz0gNCkgewogICAgICAgIGNvbnN0IHF1YWQgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZmlsZSwgaik7CiAgICAgICAgY2hlY2tzdW0gPSBjaGVja3N1bSArIHF1YWQgPj4+IDA7CiAgICAgIH0KCiAgICAgIHdyaXRlSW50MzIoZmlsZSwgb2Zmc2V0ICsgNCwgY2hlY2tzdW0pOwogICAgICB3cml0ZUludDMyKGZpbGUsIG9mZnNldCArIDgsIHRhYmxlT2Zmc2V0c1tpXSk7CiAgICAgIHdyaXRlSW50MzIoZmlsZSwgb2Zmc2V0ICsgMTIsIHRhYmxlc1t0YWJsZU5hbWVdLmxlbmd0aCk7CiAgICAgIG9mZnNldCArPSBPVEZfVEFCTEVfRU5UUllfU0laRTsKICAgIH0KCiAgICByZXR1cm4gZmlsZTsKICB9CgogIGFkZFRhYmxlKHRhZywgZGF0YSkgewogICAgaWYgKHRhZyBpbiB0aGlzLnRhYmxlcykgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIlRhYmxlICIgKyB0YWcgKyAiIGFscmVhZHkgZXhpc3RzIik7CiAgICB9CgogICAgdGhpcy50YWJsZXNbdGFnXSA9IGRhdGE7CiAgfQoKfQoKZXhwb3J0cy5PcGVuVHlwZUZpbGVCdWlsZGVyID0gT3BlblR5cGVGaWxlQnVpbGRlcjsKCi8qKiovIH0pLAovKiAxNzMgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlR5cGUxRm9udCA9IHZvaWQgMDsKCnZhciBfY2ZmX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTYwKTsKCnZhciBfZm9udHNfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2Myk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTM1KTsKCnZhciBfdHlwZTFfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzQpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmZ1bmN0aW9uIGZpbmRCbG9jayhzdHJlYW1CeXRlcywgc2lnbmF0dXJlLCBzdGFydEluZGV4KSB7CiAgY29uc3Qgc3RyZWFtQnl0ZXNMZW5ndGggPSBzdHJlYW1CeXRlcy5sZW5ndGg7CiAgY29uc3Qgc2lnbmF0dXJlTGVuZ3RoID0gc2lnbmF0dXJlLmxlbmd0aDsKICBjb25zdCBzY2FuTGVuZ3RoID0gc3RyZWFtQnl0ZXNMZW5ndGggLSBzaWduYXR1cmVMZW5ndGg7CiAgbGV0IGkgPSBzdGFydEluZGV4LAogICAgICBmb3VuZCA9IGZhbHNlOwoKICB3aGlsZSAoaSA8IHNjYW5MZW5ndGgpIHsKICAgIGxldCBqID0gMDsKCiAgICB3aGlsZSAoaiA8IHNpZ25hdHVyZUxlbmd0aCAmJiBzdHJlYW1CeXRlc1tpICsgal0gPT09IHNpZ25hdHVyZVtqXSkgewogICAgICBqKys7CiAgICB9CgogICAgaWYgKGogPj0gc2lnbmF0dXJlTGVuZ3RoKSB7CiAgICAgIGkgKz0gajsKCiAgICAgIHdoaWxlIChpIDwgc3RyZWFtQnl0ZXNMZW5ndGggJiYgKDAsIF9jb3JlX3V0aWxzLmlzV2hpdGVTcGFjZSkoc3RyZWFtQnl0ZXNbaV0pKSB7CiAgICAgICAgaSsrOwogICAgICB9CgogICAgICBmb3VuZCA9IHRydWU7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGkrKzsKICB9CgogIHJldHVybiB7CiAgICBmb3VuZCwKICAgIGxlbmd0aDogaQogIH07Cn0KCmZ1bmN0aW9uIGdldEhlYWRlckJsb2NrKHN0cmVhbSwgc3VnZ2VzdGVkTGVuZ3RoKSB7CiAgY29uc3QgRUVYRUNfU0lHTkFUVVJFID0gWzB4NjUsIDB4NjUsIDB4NzgsIDB4NjUsIDB4NjNdOwogIGNvbnN0IHN0cmVhbVN0YXJ0UG9zID0gc3RyZWFtLnBvczsKICBsZXQgaGVhZGVyQnl0ZXMsIGhlYWRlckJ5dGVzTGVuZ3RoLCBibG9jazsKCiAgdHJ5IHsKICAgIGhlYWRlckJ5dGVzID0gc3RyZWFtLmdldEJ5dGVzKHN1Z2dlc3RlZExlbmd0aCk7CiAgICBoZWFkZXJCeXRlc0xlbmd0aCA9IGhlYWRlckJ5dGVzLmxlbmd0aDsKICB9IGNhdGNoIChleCkge30KCiAgaWYgKGhlYWRlckJ5dGVzTGVuZ3RoID09PSBzdWdnZXN0ZWRMZW5ndGgpIHsKICAgIGJsb2NrID0gZmluZEJsb2NrKGhlYWRlckJ5dGVzLCBFRVhFQ19TSUdOQVRVUkUsIHN1Z2dlc3RlZExlbmd0aCAtIDIgKiBFRVhFQ19TSUdOQVRVUkUubGVuZ3RoKTsKCiAgICBpZiAoYmxvY2suZm91bmQgJiYgYmxvY2subGVuZ3RoID09PSBzdWdnZXN0ZWRMZW5ndGgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBzdHJlYW06IG5ldyBfc3RyZWFtLlN0cmVhbShoZWFkZXJCeXRlcyksCiAgICAgICAgbGVuZ3RoOiBzdWdnZXN0ZWRMZW5ndGgKICAgICAgfTsKICAgIH0KICB9CgogICgwLCBfdXRpbC53YXJuKSgnSW52YWxpZCAiTGVuZ3RoMSIgcHJvcGVydHkgaW4gVHlwZTEgZm9udCAtLSB0cnlpbmcgdG8gcmVjb3Zlci4nKTsKICBzdHJlYW0ucG9zID0gc3RyZWFtU3RhcnRQb3M7CiAgY29uc3QgU0NBTl9CTE9DS19MRU5HVEggPSAyMDQ4OwogIGxldCBhY3R1YWxMZW5ndGg7CgogIHdoaWxlICh0cnVlKSB7CiAgICBjb25zdCBzY2FuQnl0ZXMgPSBzdHJlYW0ucGVla0J5dGVzKFNDQU5fQkxPQ0tfTEVOR1RIKTsKICAgIGJsb2NrID0gZmluZEJsb2NrKHNjYW5CeXRlcywgRUVYRUNfU0lHTkFUVVJFLCAwKTsKCiAgICBpZiAoYmxvY2subGVuZ3RoID09PSAwKSB7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIHN0cmVhbS5wb3MgKz0gYmxvY2subGVuZ3RoOwoKICAgIGlmIChibG9jay5mb3VuZCkgewogICAgICBhY3R1YWxMZW5ndGggPSBzdHJlYW0ucG9zIC0gc3RyZWFtU3RhcnRQb3M7CiAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgc3RyZWFtLnBvcyA9IHN0cmVhbVN0YXJ0UG9zOwoKICBpZiAoYWN0dWFsTGVuZ3RoKSB7CiAgICByZXR1cm4gewogICAgICBzdHJlYW06IG5ldyBfc3RyZWFtLlN0cmVhbShzdHJlYW0uZ2V0Qnl0ZXMoYWN0dWFsTGVuZ3RoKSksCiAgICAgIGxlbmd0aDogYWN0dWFsTGVuZ3RoCiAgICB9OwogIH0KCiAgKDAsIF91dGlsLndhcm4pKCdVbmFibGUgdG8gcmVjb3ZlciAiTGVuZ3RoMSIgcHJvcGVydHkgaW4gVHlwZTEgZm9udCAtLSB1c2luZyBhcyBpcy4nKTsKICByZXR1cm4gewogICAgc3RyZWFtOiBuZXcgX3N0cmVhbS5TdHJlYW0oc3RyZWFtLmdldEJ5dGVzKHN1Z2dlc3RlZExlbmd0aCkpLAogICAgbGVuZ3RoOiBzdWdnZXN0ZWRMZW5ndGgKICB9Owp9CgpmdW5jdGlvbiBnZXRFZXhlY0Jsb2NrKHN0cmVhbSwgc3VnZ2VzdGVkTGVuZ3RoKSB7CiAgY29uc3QgZWV4ZWNCeXRlcyA9IHN0cmVhbS5nZXRCeXRlcygpOwogIHJldHVybiB7CiAgICBzdHJlYW06IG5ldyBfc3RyZWFtLlN0cmVhbShlZXhlY0J5dGVzKSwKICAgIGxlbmd0aDogZWV4ZWNCeXRlcy5sZW5ndGgKICB9Owp9CgpjbGFzcyBUeXBlMUZvbnQgewogIGNvbnN0cnVjdG9yKG5hbWUsIGZpbGUsIHByb3BlcnRpZXMpIHsKICAgIGNvbnN0IFBGQl9IRUFERVJfU0laRSA9IDY7CiAgICBsZXQgaGVhZGVyQmxvY2tMZW5ndGggPSBwcm9wZXJ0aWVzLmxlbmd0aDE7CiAgICBsZXQgZWV4ZWNCbG9ja0xlbmd0aCA9IHByb3BlcnRpZXMubGVuZ3RoMjsKICAgIGxldCBwZmJIZWFkZXIgPSBmaWxlLnBlZWtCeXRlcyhQRkJfSEVBREVSX1NJWkUpOwogICAgY29uc3QgcGZiSGVhZGVyUHJlc2VudCA9IHBmYkhlYWRlclswXSA9PT0gMHg4MCAmJiBwZmJIZWFkZXJbMV0gPT09IDB4MDE7CgogICAgaWYgKHBmYkhlYWRlclByZXNlbnQpIHsKICAgICAgZmlsZS5za2lwKFBGQl9IRUFERVJfU0laRSk7CiAgICAgIGhlYWRlckJsb2NrTGVuZ3RoID0gcGZiSGVhZGVyWzVdIDw8IDI0IHwgcGZiSGVhZGVyWzRdIDw8IDE2IHwgcGZiSGVhZGVyWzNdIDw8IDggfCBwZmJIZWFkZXJbMl07CiAgICB9CgogICAgY29uc3QgaGVhZGVyQmxvY2sgPSBnZXRIZWFkZXJCbG9jayhmaWxlLCBoZWFkZXJCbG9ja0xlbmd0aCk7CiAgICBjb25zdCBoZWFkZXJCbG9ja1BhcnNlciA9IG5ldyBfdHlwZTFfcGFyc2VyLlR5cGUxUGFyc2VyKGhlYWRlckJsb2NrLnN0cmVhbSwgZmFsc2UsIF9mb250c191dGlscy5TRUFDX0FOQUxZU0lTX0VOQUJMRUQpOwogICAgaGVhZGVyQmxvY2tQYXJzZXIuZXh0cmFjdEZvbnRIZWFkZXIocHJvcGVydGllcyk7CgogICAgaWYgKHBmYkhlYWRlclByZXNlbnQpIHsKICAgICAgcGZiSGVhZGVyID0gZmlsZS5nZXRCeXRlcyhQRkJfSEVBREVSX1NJWkUpOwogICAgICBlZXhlY0Jsb2NrTGVuZ3RoID0gcGZiSGVhZGVyWzVdIDw8IDI0IHwgcGZiSGVhZGVyWzRdIDw8IDE2IHwgcGZiSGVhZGVyWzNdIDw8IDggfCBwZmJIZWFkZXJbMl07CiAgICB9CgogICAgY29uc3QgZWV4ZWNCbG9jayA9IGdldEVleGVjQmxvY2soZmlsZSwgZWV4ZWNCbG9ja0xlbmd0aCk7CiAgICBjb25zdCBlZXhlY0Jsb2NrUGFyc2VyID0gbmV3IF90eXBlMV9wYXJzZXIuVHlwZTFQYXJzZXIoZWV4ZWNCbG9jay5zdHJlYW0sIHRydWUsIF9mb250c191dGlscy5TRUFDX0FOQUxZU0lTX0VOQUJMRUQpOwogICAgY29uc3QgZGF0YSA9IGVleGVjQmxvY2tQYXJzZXIuZXh0cmFjdEZvbnRQcm9ncmFtKHByb3BlcnRpZXMpOwoKICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGEucHJvcGVydGllcykgewogICAgICBwcm9wZXJ0aWVzW2tleV0gPSBkYXRhLnByb3BlcnRpZXNba2V5XTsKICAgIH0KCiAgICBjb25zdCBjaGFyc3RyaW5ncyA9IGRhdGEuY2hhcnN0cmluZ3M7CiAgICBjb25zdCB0eXBlMkNoYXJzdHJpbmdzID0gdGhpcy5nZXRUeXBlMkNoYXJzdHJpbmdzKGNoYXJzdHJpbmdzKTsKICAgIGNvbnN0IHN1YnJzID0gdGhpcy5nZXRUeXBlMlN1YnJzKGRhdGEuc3VicnMpOwogICAgdGhpcy5jaGFyc3RyaW5ncyA9IGNoYXJzdHJpbmdzOwogICAgdGhpcy5kYXRhID0gdGhpcy53cmFwKG5hbWUsIHR5cGUyQ2hhcnN0cmluZ3MsIHRoaXMuY2hhcnN0cmluZ3MsIHN1YnJzLCBwcm9wZXJ0aWVzKTsKICAgIHRoaXMuc2VhY3MgPSB0aGlzLmdldFNlYWNzKGRhdGEuY2hhcnN0cmluZ3MpOwogIH0KCiAgZ2V0IG51bUdseXBocygpIHsKICAgIHJldHVybiB0aGlzLmNoYXJzdHJpbmdzLmxlbmd0aCArIDE7CiAgfQoKICBnZXRDaGFyc2V0KCkgewogICAgY29uc3QgY2hhcnNldCA9IFsiLm5vdGRlZiJdOwoKICAgIGZvciAoY29uc3QgewogICAgICBnbHlwaE5hbWUKICAgIH0gb2YgdGhpcy5jaGFyc3RyaW5ncykgewogICAgICBjaGFyc2V0LnB1c2goZ2x5cGhOYW1lKTsKICAgIH0KCiAgICByZXR1cm4gY2hhcnNldDsKICB9CgogIGdldEdseXBoTWFwcGluZyhwcm9wZXJ0aWVzKSB7CiAgICBjb25zdCBjaGFyc3RyaW5ncyA9IHRoaXMuY2hhcnN0cmluZ3M7CgogICAgaWYgKHByb3BlcnRpZXMuY29tcG9zaXRlKSB7CiAgICAgIGNvbnN0IGNoYXJDb2RlVG9HbHlwaElkID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICAgIGZvciAobGV0IGdseXBoSWQgPSAwLCBjaGFyc3RyaW5nc0xlbiA9IGNoYXJzdHJpbmdzLmxlbmd0aDsgZ2x5cGhJZCA8IGNoYXJzdHJpbmdzTGVuOyBnbHlwaElkKyspIHsKICAgICAgICBjb25zdCBjaGFyQ29kZSA9IHByb3BlcnRpZXMuY01hcC5jaGFyQ29kZU9mKGdseXBoSWQpOwogICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGdseXBoSWQgKyAxOwogICAgICB9CgogICAgICByZXR1cm4gY2hhckNvZGVUb0dseXBoSWQ7CiAgICB9CgogICAgY29uc3QgZ2x5cGhOYW1lcyA9IFsiLm5vdGRlZiJdOwogICAgbGV0IGJ1aWx0SW5FbmNvZGluZywgZ2x5cGhJZDsKCiAgICBmb3IgKGdseXBoSWQgPSAwOyBnbHlwaElkIDwgY2hhcnN0cmluZ3MubGVuZ3RoOyBnbHlwaElkKyspIHsKICAgICAgZ2x5cGhOYW1lcy5wdXNoKGNoYXJzdHJpbmdzW2dseXBoSWRdLmdseXBoTmFtZSk7CiAgICB9CgogICAgY29uc3QgZW5jb2RpbmcgPSBwcm9wZXJ0aWVzLmJ1aWx0SW5FbmNvZGluZzsKCiAgICBpZiAoZW5jb2RpbmcpIHsKICAgICAgYnVpbHRJbkVuY29kaW5nID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICAgIGZvciAoY29uc3QgY2hhckNvZGUgaW4gZW5jb2RpbmcpIHsKICAgICAgICBnbHlwaElkID0gZ2x5cGhOYW1lcy5pbmRleE9mKGVuY29kaW5nW2NoYXJDb2RlXSk7CgogICAgICAgIGlmIChnbHlwaElkID49IDApIHsKICAgICAgICAgIGJ1aWx0SW5FbmNvZGluZ1tjaGFyQ29kZV0gPSBnbHlwaElkOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiAoMCwgX2ZvbnRzX3V0aWxzLnR5cGUxRm9udEdseXBoTWFwcGluZykocHJvcGVydGllcywgYnVpbHRJbkVuY29kaW5nLCBnbHlwaE5hbWVzKTsKICB9CgogIGhhc0dseXBoSWQoaWQpIHsKICAgIGlmIChpZCA8IDAgfHwgaWQgPj0gdGhpcy5udW1HbHlwaHMpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmIChpZCA9PT0gMCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBjb25zdCBnbHlwaCA9IHRoaXMuY2hhcnN0cmluZ3NbaWQgLSAxXTsKICAgIHJldHVybiBnbHlwaC5jaGFyc3RyaW5nLmxlbmd0aCA+IDA7CiAgfQoKICBnZXRTZWFjcyhjaGFyc3RyaW5ncykgewogICAgY29uc3Qgc2VhY01hcCA9IFtdOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNoYXJzdHJpbmdzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgY29uc3QgY2hhcnN0cmluZyA9IGNoYXJzdHJpbmdzW2ldOwoKICAgICAgaWYgKGNoYXJzdHJpbmcuc2VhYykgewogICAgICAgIHNlYWNNYXBbaSArIDFdID0gY2hhcnN0cmluZy5zZWFjOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHNlYWNNYXA7CiAgfQoKICBnZXRUeXBlMkNoYXJzdHJpbmdzKHR5cGUxQ2hhcnN0cmluZ3MpIHsKICAgIGNvbnN0IHR5cGUyQ2hhcnN0cmluZ3MgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB0eXBlMUNoYXJzdHJpbmdzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgdHlwZTJDaGFyc3RyaW5ncy5wdXNoKHR5cGUxQ2hhcnN0cmluZ3NbaV0uY2hhcnN0cmluZyk7CiAgICB9CgogICAgcmV0dXJuIHR5cGUyQ2hhcnN0cmluZ3M7CiAgfQoKICBnZXRUeXBlMlN1YnJzKHR5cGUxU3VicnMpIHsKICAgIGxldCBiaWFzID0gMDsKICAgIGNvbnN0IGNvdW50ID0gdHlwZTFTdWJycy5sZW5ndGg7CgogICAgaWYgKGNvdW50IDwgMTEzMykgewogICAgICBiaWFzID0gMTA3OwogICAgfSBlbHNlIGlmIChjb3VudCA8IDMzNzY5KSB7CiAgICAgIGJpYXMgPSAxMTMxOwogICAgfSBlbHNlIHsKICAgICAgYmlhcyA9IDMyNzY4OwogICAgfQoKICAgIGNvbnN0IHR5cGUyU3VicnMgPSBbXTsKICAgIGxldCBpOwoKICAgIGZvciAoaSA9IDA7IGkgPCBiaWFzOyBpKyspIHsKICAgICAgdHlwZTJTdWJycy5wdXNoKFsweDBiXSk7CiAgICB9CgogICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgdHlwZTJTdWJycy5wdXNoKHR5cGUxU3VicnNbaV0pOwogICAgfQoKICAgIHJldHVybiB0eXBlMlN1YnJzOwogIH0KCiAgd3JhcChuYW1lLCBnbHlwaHMsIGNoYXJzdHJpbmdzLCBzdWJycywgcHJvcGVydGllcykgewogICAgY29uc3QgY2ZmID0gbmV3IF9jZmZfcGFyc2VyLkNGRigpOwogICAgY2ZmLmhlYWRlciA9IG5ldyBfY2ZmX3BhcnNlci5DRkZIZWFkZXIoMSwgMCwgNCwgNCk7CiAgICBjZmYubmFtZXMgPSBbbmFtZV07CiAgICBjb25zdCB0b3BEaWN0ID0gbmV3IF9jZmZfcGFyc2VyLkNGRlRvcERpY3QoKTsKICAgIHRvcERpY3Quc2V0QnlOYW1lKCJ2ZXJzaW9uIiwgMzkxKTsKICAgIHRvcERpY3Quc2V0QnlOYW1lKCJOb3RpY2UiLCAzOTIpOwogICAgdG9wRGljdC5zZXRCeU5hbWUoIkZ1bGxOYW1lIiwgMzkzKTsKICAgIHRvcERpY3Quc2V0QnlOYW1lKCJGYW1pbHlOYW1lIiwgMzk0KTsKICAgIHRvcERpY3Quc2V0QnlOYW1lKCJXZWlnaHQiLCAzOTUpOwogICAgdG9wRGljdC5zZXRCeU5hbWUoIkVuY29kaW5nIiwgbnVsbCk7CiAgICB0b3BEaWN0LnNldEJ5TmFtZSgiRm9udE1hdHJpeCIsIHByb3BlcnRpZXMuZm9udE1hdHJpeCk7CiAgICB0b3BEaWN0LnNldEJ5TmFtZSgiRm9udEJCb3giLCBwcm9wZXJ0aWVzLmJib3gpOwogICAgdG9wRGljdC5zZXRCeU5hbWUoImNoYXJzZXQiLCBudWxsKTsKICAgIHRvcERpY3Quc2V0QnlOYW1lKCJDaGFyU3RyaW5ncyIsIG51bGwpOwogICAgdG9wRGljdC5zZXRCeU5hbWUoIlByaXZhdGUiLCBudWxsKTsKICAgIGNmZi50b3BEaWN0ID0gdG9wRGljdDsKICAgIGNvbnN0IHN0cmluZ3MgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGU3RyaW5ncygpOwogICAgc3RyaW5ncy5hZGQoIlZlcnNpb24gMC4xMSIpOwogICAgc3RyaW5ncy5hZGQoIlNlZSBvcmlnaW5hbCBub3RpY2UiKTsKICAgIHN0cmluZ3MuYWRkKG5hbWUpOwogICAgc3RyaW5ncy5hZGQobmFtZSk7CiAgICBzdHJpbmdzLmFkZCgiTWVkaXVtIik7CiAgICBjZmYuc3RyaW5ncyA9IHN0cmluZ3M7CiAgICBjZmYuZ2xvYmFsU3VickluZGV4ID0gbmV3IF9jZmZfcGFyc2VyLkNGRkluZGV4KCk7CiAgICBjb25zdCBjb3VudCA9IGdseXBocy5sZW5ndGg7CiAgICBjb25zdCBjaGFyc2V0QXJyYXkgPSBbIi5ub3RkZWYiXTsKICAgIGxldCBpLCBpaTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICBjb25zdCBnbHlwaE5hbWUgPSBjaGFyc3RyaW5nc1tpXS5nbHlwaE5hbWU7CgogICAgICBjb25zdCBpbmRleCA9IF9jZmZfcGFyc2VyLkNGRlN0YW5kYXJkU3RyaW5ncy5pbmRleE9mKGdseXBoTmFtZSk7CgogICAgICBpZiAoaW5kZXggPT09IC0xKSB7CiAgICAgICAgc3RyaW5ncy5hZGQoZ2x5cGhOYW1lKTsKICAgICAgfQoKICAgICAgY2hhcnNldEFycmF5LnB1c2goZ2x5cGhOYW1lKTsKICAgIH0KCiAgICBjZmYuY2hhcnNldCA9IG5ldyBfY2ZmX3BhcnNlci5DRkZDaGFyc2V0KGZhbHNlLCAwLCBjaGFyc2V0QXJyYXkpOwogICAgY29uc3QgY2hhclN0cmluZ3NJbmRleCA9IG5ldyBfY2ZmX3BhcnNlci5DRkZJbmRleCgpOwogICAgY2hhclN0cmluZ3NJbmRleC5hZGQoWzB4OGIsIDB4MGVdKTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICBjaGFyU3RyaW5nc0luZGV4LmFkZChnbHlwaHNbaV0pOwogICAgfQoKICAgIGNmZi5jaGFyU3RyaW5ncyA9IGNoYXJTdHJpbmdzSW5kZXg7CiAgICBjb25zdCBwcml2YXRlRGljdCA9IG5ldyBfY2ZmX3BhcnNlci5DRkZQcml2YXRlRGljdCgpOwogICAgcHJpdmF0ZURpY3Quc2V0QnlOYW1lKCJTdWJycyIsIG51bGwpOwogICAgY29uc3QgZmllbGRzID0gWyJCbHVlVmFsdWVzIiwgIk90aGVyQmx1ZXMiLCAiRmFtaWx5Qmx1ZXMiLCAiRmFtaWx5T3RoZXJCbHVlcyIsICJTdGVtU25hcEgiLCAiU3RlbVNuYXBWIiwgIkJsdWVTaGlmdCIsICJCbHVlRnV6eiIsICJCbHVlU2NhbGUiLCAiTGFuZ3VhZ2VHcm91cCIsICJFeHBhbnNpb25GYWN0b3IiLCAiRm9yY2VCb2xkIiwgIlN0ZEhXIiwgIlN0ZFZXIl07CgogICAgZm9yIChpID0gMCwgaWkgPSBmaWVsZHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCBmaWVsZCA9IGZpZWxkc1tpXTsKCiAgICAgIGlmICghKGZpZWxkIGluIHByb3BlcnRpZXMucHJpdmF0ZURhdGEpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZhbHVlID0gcHJvcGVydGllcy5wcml2YXRlRGF0YVtmaWVsZF07CgogICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgICBmb3IgKGxldCBqID0gdmFsdWUubGVuZ3RoIC0gMTsgaiA+IDA7IGotLSkgewogICAgICAgICAgdmFsdWVbal0gLT0gdmFsdWVbaiAtIDFdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcHJpdmF0ZURpY3Quc2V0QnlOYW1lKGZpZWxkLCB2YWx1ZSk7CiAgICB9CgogICAgY2ZmLnRvcERpY3QucHJpdmF0ZURpY3QgPSBwcml2YXRlRGljdDsKICAgIGNvbnN0IHN1YnJJbmRleCA9IG5ldyBfY2ZmX3BhcnNlci5DRkZJbmRleCgpOwoKICAgIGZvciAoaSA9IDAsIGlpID0gc3VicnMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBzdWJySW5kZXguYWRkKHN1YnJzW2ldKTsKICAgIH0KCiAgICBwcml2YXRlRGljdC5zdWJyc0luZGV4ID0gc3VickluZGV4OwogICAgY29uc3QgY29tcGlsZXIgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGQ29tcGlsZXIoY2ZmKTsKICAgIHJldHVybiBjb21waWxlci5jb21waWxlKCk7CiAgfQoKfQoKZXhwb3J0cy5UeXBlMUZvbnQgPSBUeXBlMUZvbnQ7CgovKioqLyB9KSwKLyogMTc0ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5UeXBlMVBhcnNlciA9IHZvaWQgMDsKCnZhciBfZW5jb2RpbmdzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjIpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzNSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY29uc3QgSElOVElOR19FTkFCTEVEID0gZmFsc2U7CmNvbnN0IENPTU1BTkRfTUFQID0gewogIGhzdGVtOiBbMV0sCiAgdnN0ZW06IFszXSwKICB2bW92ZXRvOiBbNF0sCiAgcmxpbmV0bzogWzVdLAogIGhsaW5ldG86IFs2XSwKICB2bGluZXRvOiBbN10sCiAgcnJjdXJ2ZXRvOiBbOF0sCiAgY2FsbHN1YnI6IFsxMF0sCiAgZmxleDogWzEyLCAzNV0sCiAgZHJvcDogWzEyLCAxOF0sCiAgZW5kY2hhcjogWzE0XSwKICBybW92ZXRvOiBbMjFdLAogIGhtb3ZldG86IFsyMl0sCiAgdmhjdXJ2ZXRvOiBbMzBdLAogIGh2Y3VydmV0bzogWzMxXQp9OwoKY2xhc3MgVHlwZTFDaGFyU3RyaW5nIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMud2lkdGggPSAwOwogICAgdGhpcy5sc2IgPSAwOwogICAgdGhpcy5mbGV4aW5nID0gZmFsc2U7CiAgICB0aGlzLm91dHB1dCA9IFtdOwogICAgdGhpcy5zdGFjayA9IFtdOwogIH0KCiAgY29udmVydChlbmNvZGVkLCBzdWJycywgc2VhY0FuYWx5c2lzRW5hYmxlZCkgewogICAgY29uc3QgY291bnQgPSBlbmNvZGVkLmxlbmd0aDsKICAgIGxldCBlcnJvciA9IGZhbHNlOwogICAgbGV0IHd4LCBzYngsIHN1YnJOdW1iZXI7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgIGxldCB2YWx1ZSA9IGVuY29kZWRbaV07CgogICAgICBpZiAodmFsdWUgPCAzMikgewogICAgICAgIGlmICh2YWx1ZSA9PT0gMTIpIHsKICAgICAgICAgIHZhbHVlID0gKHZhbHVlIDw8IDgpICsgZW5jb2RlZFsrK2ldOwogICAgICAgIH0KCiAgICAgICAgc3dpdGNoICh2YWx1ZSkgewogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBpZiAoIUhJTlRJTkdfRU5BQkxFRCkgewogICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLmhzdGVtKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBpZiAoIUhJTlRJTkdfRU5BQkxFRCkgewogICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLnZzdGVtKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBpZiAodGhpcy5mbGV4aW5nKSB7CiAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoIDwgMSkgewogICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb25zdCBkeSA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgICAgdGhpcy5zdGFjay5wdXNoKDAsIGR5KTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDEsIENPTU1BTkRfTUFQLnZtb3ZldG8pOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCgyLCBDT01NQU5EX01BUC5ybGluZXRvKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMSwgQ09NTUFORF9NQVAuaGxpbmV0byk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDEsIENPTU1BTkRfTUFQLnZsaW5ldG8pOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCg2LCBDT01NQU5EX01BUC5ycmN1cnZldG8pOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoIDwgMSkgewogICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3Vick51bWJlciA9IHRoaXMuc3RhY2sucG9wKCk7CgogICAgICAgICAgICBpZiAoIXN1YnJzW3N1YnJOdW1iZXJdKSB7CiAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBlcnJvciA9IHRoaXMuY29udmVydChzdWJyc1tzdWJyTnVtYmVyXSwgc3VicnMsIHNlYWNBbmFseXNpc0VuYWJsZWQpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICByZXR1cm4gZXJyb3I7CgogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd3ggPSB0aGlzLnN0YWNrLnBvcCgpOwogICAgICAgICAgICBzYnggPSB0aGlzLnN0YWNrLnBvcCgpOwogICAgICAgICAgICB0aGlzLmxzYiA9IHNieDsKICAgICAgICAgICAgdGhpcy53aWR0aCA9IHd4OwogICAgICAgICAgICB0aGlzLnN0YWNrLnB1c2god3gsIHNieCk7CiAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCgyLCBDT01NQU5EX01BUC5obW92ZXRvKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgdGhpcy5vdXRwdXQucHVzaChDT01NQU5EX01BUC5lbmRjaGFyWzBdKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgaWYgKHRoaXMuZmxleGluZykgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMiwgQ09NTUFORF9NQVAucm1vdmV0byk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgIGlmICh0aGlzLmZsZXhpbmcpIHsKICAgICAgICAgICAgICB0aGlzLnN0YWNrLnB1c2goMCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCgxLCBDT01NQU5EX01BUC5obW92ZXRvKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDQsIENPTU1BTkRfTUFQLnZoY3VydmV0byk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMzE6CiAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCg0LCBDT01NQU5EX01BUC5odmN1cnZldG8pOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICgxMiA8PCA4KSArIDA6CiAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyAxOgogICAgICAgICAgICBpZiAoIUhJTlRJTkdfRU5BQkxFRCkgewogICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLnZzdGVtKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyAyOgogICAgICAgICAgICBpZiAoIUhJTlRJTkdfRU5BQkxFRCkgewogICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLmhzdGVtKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyA2OgogICAgICAgICAgICBpZiAoc2VhY0FuYWx5c2lzRW5hYmxlZCkgewogICAgICAgICAgICAgIGNvbnN0IGFzYiA9IHRoaXMuc3RhY2suYXQoLTUpOwogICAgICAgICAgICAgIHRoaXMuc2VhYyA9IHRoaXMuc3RhY2suc3BsaWNlKC00LCA0KTsKICAgICAgICAgICAgICB0aGlzLnNlYWNbMF0gKz0gdGhpcy5sc2IgLSBhc2I7CiAgICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDAsIENPTU1BTkRfTUFQLmVuZGNoYXIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCg0LCBDT01NQU5EX01BUC5lbmRjaGFyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyA3OgogICAgICAgICAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggPCA0KSB7CiAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLnN0YWNrLnBvcCgpOwogICAgICAgICAgICB3eCA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGNvbnN0IHNieSA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHNieCA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHRoaXMubHNiID0gc2J4OwogICAgICAgICAgICB0aGlzLndpZHRoID0gd3g7CiAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaCh3eCwgc2J4LCBzYnkpOwogICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMywgQ09NTUFORF9NQVAucm1vdmV0byk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgKDEyIDw8IDgpICsgMTI6CiAgICAgICAgICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCA8IDIpIHsKICAgICAgICAgICAgICBlcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IG51bTIgPSB0aGlzLnN0YWNrLnBvcCgpOwogICAgICAgICAgICBjb25zdCBudW0xID0gdGhpcy5zdGFjay5wb3AoKTsKICAgICAgICAgICAgdGhpcy5zdGFjay5wdXNoKG51bTEgLyBudW0yKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyAxNjoKICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3Vick51bWJlciA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGNvbnN0IG51bUFyZ3MgPSB0aGlzLnN0YWNrLnBvcCgpOwoKICAgICAgICAgICAgaWYgKHN1YnJOdW1iZXIgPT09IDAgJiYgbnVtQXJncyA9PT0gMykgewogICAgICAgICAgICAgIGNvbnN0IGZsZXhBcmdzID0gdGhpcy5zdGFjay5zcGxpY2UodGhpcy5zdGFjay5sZW5ndGggLSAxNywgMTcpOwogICAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaChmbGV4QXJnc1syXSArIGZsZXhBcmdzWzBdLCBmbGV4QXJnc1szXSArIGZsZXhBcmdzWzFdLCBmbGV4QXJnc1s0XSwgZmxleEFyZ3NbNV0sIGZsZXhBcmdzWzZdLCBmbGV4QXJnc1s3XSwgZmxleEFyZ3NbOF0sIGZsZXhBcmdzWzldLCBmbGV4QXJnc1sxMF0sIGZsZXhBcmdzWzExXSwgZmxleEFyZ3NbMTJdLCBmbGV4QXJnc1sxM10sIGZsZXhBcmdzWzE0XSk7CiAgICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDEzLCBDT01NQU5EX01BUC5mbGV4LCB0cnVlKTsKICAgICAgICAgICAgICB0aGlzLmZsZXhpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLnN0YWNrLnB1c2goZmxleEFyZ3NbMTVdLCBmbGV4QXJnc1sxNl0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKHN1YnJOdW1iZXIgPT09IDEgJiYgbnVtQXJncyA9PT0gMCkgewogICAgICAgICAgICAgIHRoaXMuZmxleGluZyA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgKDEyIDw8IDgpICsgMTc6CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgKDEyIDw8IDgpICsgMzM6CiAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCdVbmtub3duIHR5cGUgMSBjaGFyc3RyaW5nIGNvbW1hbmQgb2YgIicgKyB2YWx1ZSArICciJyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGNvbnRpbnVlOwogICAgICB9IGVsc2UgaWYgKHZhbHVlIDw9IDI0NikgewogICAgICAgIHZhbHVlIC09IDEzOTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA8PSAyNTApIHsKICAgICAgICB2YWx1ZSA9ICh2YWx1ZSAtIDI0NykgKiAyNTYgKyBlbmNvZGVkWysraV0gKyAxMDg7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPD0gMjU0KSB7CiAgICAgICAgdmFsdWUgPSAtKCh2YWx1ZSAtIDI1MSkgKiAyNTYpIC0gZW5jb2RlZFsrK2ldIC0gMTA4OwogICAgICB9IGVsc2UgewogICAgICAgIHZhbHVlID0gKGVuY29kZWRbKytpXSAmIDB4ZmYpIDw8IDI0IHwgKGVuY29kZWRbKytpXSAmIDB4ZmYpIDw8IDE2IHwgKGVuY29kZWRbKytpXSAmIDB4ZmYpIDw8IDggfCAoZW5jb2RlZFsrK2ldICYgMHhmZikgPDwgMDsKICAgICAgfQoKICAgICAgdGhpcy5zdGFjay5wdXNoKHZhbHVlKTsKICAgIH0KCiAgICByZXR1cm4gZXJyb3I7CiAgfQoKICBleGVjdXRlQ29tbWFuZChob3dNYW55QXJncywgY29tbWFuZCwga2VlcFN0YWNrKSB7CiAgICBjb25zdCBzdGFja0xlbmd0aCA9IHRoaXMuc3RhY2subGVuZ3RoOwoKICAgIGlmIChob3dNYW55QXJncyA+IHN0YWNrTGVuZ3RoKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGNvbnN0IHN0YXJ0ID0gc3RhY2tMZW5ndGggLSBob3dNYW55QXJnczsKCiAgICBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPCBzdGFja0xlbmd0aDsgaSsrKSB7CiAgICAgIGxldCB2YWx1ZSA9IHRoaXMuc3RhY2tbaV07CgogICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSkpIHsKICAgICAgICB0aGlzLm91dHB1dC5wdXNoKDI4LCB2YWx1ZSA+PiA4ICYgMHhmZiwgdmFsdWUgJiAweGZmKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWx1ZSA9IDY1NTM2ICogdmFsdWUgfCAwOwogICAgICAgIHRoaXMub3V0cHV0LnB1c2goMjU1LCB2YWx1ZSA+PiAyNCAmIDB4ZmYsIHZhbHVlID4+IDE2ICYgMHhmZiwgdmFsdWUgPj4gOCAmIDB4ZmYsIHZhbHVlICYgMHhmZik7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLm91dHB1dC5wdXNoKC4uLmNvbW1hbmQpOwoKICAgIGlmIChrZWVwU3RhY2spIHsKICAgICAgdGhpcy5zdGFjay5zcGxpY2Uoc3RhcnQsIGhvd01hbnlBcmdzKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuc3RhY2subGVuZ3RoID0gMDsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKfQoKY29uc3QgRUVYRUNfRU5DUllQVF9LRVkgPSA1NTY2NTsKY29uc3QgQ0hBUl9TVFJTX0VOQ1JZUFRfS0VZID0gNDMzMDsKCmZ1bmN0aW9uIGlzSGV4RGlnaXQoY29kZSkgewogIHJldHVybiBjb2RlID49IDQ4ICYmIGNvZGUgPD0gNTcgfHwgY29kZSA+PSA2NSAmJiBjb2RlIDw9IDcwIHx8IGNvZGUgPj0gOTcgJiYgY29kZSA8PSAxMDI7Cn0KCmZ1bmN0aW9uIGRlY3J5cHQoZGF0YSwga2V5LCBkaXNjYXJkTnVtYmVyKSB7CiAgaWYgKGRpc2NhcmROdW1iZXIgPj0gZGF0YS5sZW5ndGgpIHsKICAgIHJldHVybiBuZXcgVWludDhBcnJheSgwKTsKICB9CgogIGNvbnN0IGMxID0gNTI4NDUsCiAgICAgICAgYzIgPSAyMjcxOTsKICBsZXQgciA9IGtleSB8IDAsCiAgICAgIGksCiAgICAgIGo7CgogIGZvciAoaSA9IDA7IGkgPCBkaXNjYXJkTnVtYmVyOyBpKyspIHsKICAgIHIgPSAoZGF0YVtpXSArIHIpICogYzEgKyBjMiAmICgxIDw8IDE2KSAtIDE7CiAgfQoKICBjb25zdCBjb3VudCA9IGRhdGEubGVuZ3RoIC0gZGlzY2FyZE51bWJlcjsKICBjb25zdCBkZWNyeXB0ZWQgPSBuZXcgVWludDhBcnJheShjb3VudCk7CgogIGZvciAoaSA9IGRpc2NhcmROdW1iZXIsIGogPSAwOyBqIDwgY291bnQ7IGkrKywgaisrKSB7CiAgICBjb25zdCB2YWx1ZSA9IGRhdGFbaV07CiAgICBkZWNyeXB0ZWRbal0gPSB2YWx1ZSBeIHIgPj4gODsKICAgIHIgPSAodmFsdWUgKyByKSAqIGMxICsgYzIgJiAoMSA8PCAxNikgLSAxOwogIH0KCiAgcmV0dXJuIGRlY3J5cHRlZDsKfQoKZnVuY3Rpb24gZGVjcnlwdEFzY2lpKGRhdGEsIGtleSwgZGlzY2FyZE51bWJlcikgewogIGNvbnN0IGMxID0gNTI4NDUsCiAgICAgICAgYzIgPSAyMjcxOTsKICBsZXQgciA9IGtleSB8IDA7CiAgY29uc3QgY291bnQgPSBkYXRhLmxlbmd0aCwKICAgICAgICBtYXliZUxlbmd0aCA9IGNvdW50ID4+PiAxOwogIGNvbnN0IGRlY3J5cHRlZCA9IG5ldyBVaW50OEFycmF5KG1heWJlTGVuZ3RoKTsKICBsZXQgaSwgajsKCiAgZm9yIChpID0gMCwgaiA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICBjb25zdCBkaWdpdDEgPSBkYXRhW2ldOwoKICAgIGlmICghaXNIZXhEaWdpdChkaWdpdDEpKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGkrKzsKICAgIGxldCBkaWdpdDI7CgogICAgd2hpbGUgKGkgPCBjb3VudCAmJiAhaXNIZXhEaWdpdChkaWdpdDIgPSBkYXRhW2ldKSkgewogICAgICBpKys7CiAgICB9CgogICAgaWYgKGkgPCBjb3VudCkgewogICAgICBjb25zdCB2YWx1ZSA9IHBhcnNlSW50KFN0cmluZy5mcm9tQ2hhckNvZGUoZGlnaXQxLCBkaWdpdDIpLCAxNik7CiAgICAgIGRlY3J5cHRlZFtqKytdID0gdmFsdWUgXiByID4+IDg7CiAgICAgIHIgPSAodmFsdWUgKyByKSAqIGMxICsgYzIgJiAoMSA8PCAxNikgLSAxOwogICAgfQogIH0KCiAgcmV0dXJuIGRlY3J5cHRlZC5zbGljZShkaXNjYXJkTnVtYmVyLCBqKTsKfQoKZnVuY3Rpb24gaXNTcGVjaWFsKGMpIHsKICByZXR1cm4gYyA9PT0gMHgyZiB8fCBjID09PSAweDViIHx8IGMgPT09IDB4NWQgfHwgYyA9PT0gMHg3YiB8fCBjID09PSAweDdkIHx8IGMgPT09IDB4MjggfHwgYyA9PT0gMHgyOTsKfQoKY2xhc3MgVHlwZTFQYXJzZXIgewogIGNvbnN0cnVjdG9yKHN0cmVhbSwgZW5jcnlwdGVkLCBzZWFjQW5hbHlzaXNFbmFibGVkKSB7CiAgICBpZiAoZW5jcnlwdGVkKSB7CiAgICAgIGNvbnN0IGRhdGEgPSBzdHJlYW0uZ2V0Qnl0ZXMoKTsKICAgICAgY29uc3QgaXNCaW5hcnkgPSAhKChpc0hleERpZ2l0KGRhdGFbMF0pIHx8ICgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGRhdGFbMF0pKSAmJiBpc0hleERpZ2l0KGRhdGFbMV0pICYmIGlzSGV4RGlnaXQoZGF0YVsyXSkgJiYgaXNIZXhEaWdpdChkYXRhWzNdKSAmJiBpc0hleERpZ2l0KGRhdGFbNF0pICYmIGlzSGV4RGlnaXQoZGF0YVs1XSkgJiYgaXNIZXhEaWdpdChkYXRhWzZdKSAmJiBpc0hleERpZ2l0KGRhdGFbN10pKTsKICAgICAgc3RyZWFtID0gbmV3IF9zdHJlYW0uU3RyZWFtKGlzQmluYXJ5ID8gZGVjcnlwdChkYXRhLCBFRVhFQ19FTkNSWVBUX0tFWSwgNCkgOiBkZWNyeXB0QXNjaWkoZGF0YSwgRUVYRUNfRU5DUllQVF9LRVksIDQpKTsKICAgIH0KCiAgICB0aGlzLnNlYWNBbmFseXNpc0VuYWJsZWQgPSAhIXNlYWNBbmFseXNpc0VuYWJsZWQ7CiAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTsKICAgIHRoaXMubmV4dENoYXIoKTsKICB9CgogIHJlYWROdW1iZXJBcnJheSgpIHsKICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgIGNvbnN0IGFycmF5ID0gW107CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgY29uc3QgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CgogICAgICBpZiAodG9rZW4gPT09IG51bGwgfHwgdG9rZW4gPT09ICJdIiB8fCB0b2tlbiA9PT0gIn0iKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGFycmF5LnB1c2gocGFyc2VGbG9hdCh0b2tlbiB8fCAwKSk7CiAgICB9CgogICAgcmV0dXJuIGFycmF5OwogIH0KCiAgcmVhZE51bWJlcigpIHsKICAgIGNvbnN0IHRva2VuID0gdGhpcy5nZXRUb2tlbigpOwogICAgcmV0dXJuIHBhcnNlRmxvYXQodG9rZW4gfHwgMCk7CiAgfQoKICByZWFkSW50KCkgewogICAgY29uc3QgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CiAgICByZXR1cm4gcGFyc2VJbnQodG9rZW4gfHwgMCwgMTApIHwgMDsKICB9CgogIHJlYWRCb29sZWFuKCkgewogICAgY29uc3QgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CiAgICByZXR1cm4gdG9rZW4gPT09ICJ0cnVlIiA/IDEgOiAwOwogIH0KCiAgbmV4dENoYXIoKSB7CiAgICByZXR1cm4gdGhpcy5jdXJyZW50Q2hhciA9IHRoaXMuc3RyZWFtLmdldEJ5dGUoKTsKICB9CgogIHByZXZDaGFyKCkgewogICAgdGhpcy5zdHJlYW0uc2tpcCgtMik7CiAgICByZXR1cm4gdGhpcy5jdXJyZW50Q2hhciA9IHRoaXMuc3RyZWFtLmdldEJ5dGUoKTsKICB9CgogIGdldFRva2VuKCkgewogICAgbGV0IGNvbW1lbnQgPSBmYWxzZTsKICAgIGxldCBjaCA9IHRoaXMuY3VycmVudENoYXI7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgaWYgKGNoID09PSAtMSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBpZiAoY29tbWVudCkgewogICAgICAgIGlmIChjaCA9PT0gMHgwYSB8fCBjaCA9PT0gMHgwZCkgewogICAgICAgICAgY29tbWVudCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgyNSkgewogICAgICAgIGNvbW1lbnQgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKCEoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICB9CgogICAgaWYgKGlzU3BlY2lhbChjaCkpIHsKICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaCk7CiAgICB9CgogICAgbGV0IHRva2VuID0gIiI7CgogICAgZG8gewogICAgICB0b2tlbiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICB9IHdoaWxlIChjaCA+PSAwICYmICEoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkgJiYgIWlzU3BlY2lhbChjaCkpOwoKICAgIHJldHVybiB0b2tlbjsKICB9CgogIHJlYWRDaGFyU3RyaW5ncyhieXRlcywgbGVuSVYpIHsKICAgIGlmIChsZW5JViA9PT0gLTEpIHsKICAgICAgcmV0dXJuIGJ5dGVzOwogICAgfQoKICAgIHJldHVybiBkZWNyeXB0KGJ5dGVzLCBDSEFSX1NUUlNfRU5DUllQVF9LRVksIGxlbklWKTsKICB9CgogIGV4dHJhY3RGb250UHJvZ3JhbShwcm9wZXJ0aWVzKSB7CiAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnN0cmVhbTsKICAgIGNvbnN0IHN1YnJzID0gW10sCiAgICAgICAgICBjaGFyc3RyaW5ncyA9IFtdOwogICAgY29uc3QgcHJpdmF0ZURhdGEgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgcHJpdmF0ZURhdGEubGVuSVYgPSA0OwogICAgY29uc3QgcHJvZ3JhbSA9IHsKICAgICAgc3VicnM6IFtdLAogICAgICBjaGFyc3RyaW5nczogW10sCiAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICBwcml2YXRlRGF0YQogICAgICB9CiAgICB9OwogICAgbGV0IHRva2VuLCBsZW5ndGgsIGRhdGEsIGxlbklWOwoKICAgIHdoaWxlICgodG9rZW4gPSB0aGlzLmdldFRva2VuKCkpICE9PSBudWxsKSB7CiAgICAgIGlmICh0b2tlbiAhPT0gIi8iKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHRva2VuID0gdGhpcy5nZXRUb2tlbigpOwoKICAgICAgc3dpdGNoICh0b2tlbikgewogICAgICAgIGNhc2UgIkNoYXJTdHJpbmdzIjoKICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gbnVsbCB8fCB0b2tlbiA9PT0gImVuZCIpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRva2VuICE9PSAiLyIpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZ2x5cGggPSB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgIGxlbmd0aCA9IHRoaXMucmVhZEludCgpOwogICAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgIGRhdGEgPSBsZW5ndGggPiAwID8gc3RyZWFtLmdldEJ5dGVzKGxlbmd0aCkgOiBuZXcgVWludDhBcnJheSgwKTsKICAgICAgICAgICAgbGVuSVYgPSBwcm9ncmFtLnByb3BlcnRpZXMucHJpdmF0ZURhdGEubGVuSVY7CiAgICAgICAgICAgIGNvbnN0IGVuY29kZWQgPSB0aGlzLnJlYWRDaGFyU3RyaW5ncyhkYXRhLCBsZW5JVik7CiAgICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CgogICAgICAgICAgICBpZiAodG9rZW4gPT09ICJub2FjY2VzcyIpIHsKICAgICAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodG9rZW4gPT09ICIvIikgewogICAgICAgICAgICAgIHRoaXMucHJldkNoYXIoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2hhcnN0cmluZ3MucHVzaCh7CiAgICAgICAgICAgICAgZ2x5cGgsCiAgICAgICAgICAgICAgZW5jb2RlZAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiU3VicnMiOgogICAgICAgICAgdGhpcy5yZWFkSW50KCk7CiAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CgogICAgICAgICAgd2hpbGUgKHRoaXMuZ2V0VG9rZW4oKSA9PT0gImR1cCIpIHsKICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnJlYWRJbnQoKTsKICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5yZWFkSW50KCk7CiAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgZGF0YSA9IGxlbmd0aCA+IDAgPyBzdHJlYW0uZ2V0Qnl0ZXMobGVuZ3RoKSA6IG5ldyBVaW50OEFycmF5KDApOwogICAgICAgICAgICBsZW5JViA9IHByb2dyYW0ucHJvcGVydGllcy5wcml2YXRlRGF0YS5sZW5JVjsKICAgICAgICAgICAgY29uc3QgZW5jb2RlZCA9IHRoaXMucmVhZENoYXJTdHJpbmdzKGRhdGEsIGxlbklWKTsKICAgICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gIm5vYWNjZXNzIikgewogICAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3VicnNbaW5kZXhdID0gZW5jb2RlZDsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiQmx1ZVZhbHVlcyI6CiAgICAgICAgY2FzZSAiT3RoZXJCbHVlcyI6CiAgICAgICAgY2FzZSAiRmFtaWx5Qmx1ZXMiOgogICAgICAgIGNhc2UgIkZhbWlseU90aGVyQmx1ZXMiOgogICAgICAgICAgY29uc3QgYmx1ZUFycmF5ID0gdGhpcy5yZWFkTnVtYmVyQXJyYXkoKTsKCiAgICAgICAgICBpZiAoYmx1ZUFycmF5Lmxlbmd0aCA+IDAgJiYgYmx1ZUFycmF5Lmxlbmd0aCAlIDIgPT09IDAgJiYgSElOVElOR19FTkFCTEVEKSB7CiAgICAgICAgICAgIHByb2dyYW0ucHJvcGVydGllcy5wcml2YXRlRGF0YVt0b2tlbl0gPSBibHVlQXJyYXk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlN0ZW1TbmFwSCI6CiAgICAgICAgY2FzZSAiU3RlbVNuYXBWIjoKICAgICAgICAgIHByb2dyYW0ucHJvcGVydGllcy5wcml2YXRlRGF0YVt0b2tlbl0gPSB0aGlzLnJlYWROdW1iZXJBcnJheSgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlN0ZEhXIjoKICAgICAgICBjYXNlICJTdGRWVyI6CiAgICAgICAgICBwcm9ncmFtLnByb3BlcnRpZXMucHJpdmF0ZURhdGFbdG9rZW5dID0gdGhpcy5yZWFkTnVtYmVyQXJyYXkoKVswXTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJCbHVlU2hpZnQiOgogICAgICAgIGNhc2UgImxlbklWIjoKICAgICAgICBjYXNlICJCbHVlRnV6eiI6CiAgICAgICAgY2FzZSAiQmx1ZVNjYWxlIjoKICAgICAgICBjYXNlICJMYW5ndWFnZUdyb3VwIjoKICAgICAgICBjYXNlICJFeHBhbnNpb25GYWN0b3IiOgogICAgICAgICAgcHJvZ3JhbS5wcm9wZXJ0aWVzLnByaXZhdGVEYXRhW3Rva2VuXSA9IHRoaXMucmVhZE51bWJlcigpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIkZvcmNlQm9sZCI6CiAgICAgICAgICBwcm9ncmFtLnByb3BlcnRpZXMucHJpdmF0ZURhdGFbdG9rZW5dID0gdGhpcy5yZWFkQm9vbGVhbigpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGNvbnN0IHsKICAgICAgZW5jb2RlZCwKICAgICAgZ2x5cGgKICAgIH0gb2YgY2hhcnN0cmluZ3MpIHsKICAgICAgY29uc3QgY2hhclN0cmluZyA9IG5ldyBUeXBlMUNoYXJTdHJpbmcoKTsKICAgICAgY29uc3QgZXJyb3IgPSBjaGFyU3RyaW5nLmNvbnZlcnQoZW5jb2RlZCwgc3VicnMsIHRoaXMuc2VhY0FuYWx5c2lzRW5hYmxlZCk7CiAgICAgIGxldCBvdXRwdXQgPSBjaGFyU3RyaW5nLm91dHB1dDsKCiAgICAgIGlmIChlcnJvcikgewogICAgICAgIG91dHB1dCA9IFsxNF07CiAgICAgIH0KCiAgICAgIGNvbnN0IGNoYXJTdHJpbmdPYmplY3QgPSB7CiAgICAgICAgZ2x5cGhOYW1lOiBnbHlwaCwKICAgICAgICBjaGFyc3RyaW5nOiBvdXRwdXQsCiAgICAgICAgd2lkdGg6IGNoYXJTdHJpbmcud2lkdGgsCiAgICAgICAgbHNiOiBjaGFyU3RyaW5nLmxzYiwKICAgICAgICBzZWFjOiBjaGFyU3RyaW5nLnNlYWMKICAgICAgfTsKCiAgICAgIGlmIChnbHlwaCA9PT0gIi5ub3RkZWYiKSB7CiAgICAgICAgcHJvZ3JhbS5jaGFyc3RyaW5ncy51bnNoaWZ0KGNoYXJTdHJpbmdPYmplY3QpOwogICAgICB9IGVsc2UgewogICAgICAgIHByb2dyYW0uY2hhcnN0cmluZ3MucHVzaChjaGFyU3RyaW5nT2JqZWN0KTsKICAgICAgfQoKICAgICAgaWYgKHByb3BlcnRpZXMuYnVpbHRJbkVuY29kaW5nKSB7CiAgICAgICAgY29uc3QgaW5kZXggPSBwcm9wZXJ0aWVzLmJ1aWx0SW5FbmNvZGluZy5pbmRleE9mKGdseXBoKTsKCiAgICAgICAgaWYgKGluZGV4ID4gLTEgJiYgcHJvcGVydGllcy53aWR0aHNbaW5kZXhdID09PSB1bmRlZmluZWQgJiYgaW5kZXggPj0gcHJvcGVydGllcy5maXJzdENoYXIgJiYgaW5kZXggPD0gcHJvcGVydGllcy5sYXN0Q2hhcikgewogICAgICAgICAgcHJvcGVydGllcy53aWR0aHNbaW5kZXhdID0gY2hhclN0cmluZy53aWR0aDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcHJvZ3JhbTsKICB9CgogIGV4dHJhY3RGb250SGVhZGVyKHByb3BlcnRpZXMpIHsKICAgIGxldCB0b2tlbjsKCiAgICB3aGlsZSAoKHRva2VuID0gdGhpcy5nZXRUb2tlbigpKSAhPT0gbnVsbCkgewogICAgICBpZiAodG9rZW4gIT09ICIvIikgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgIHN3aXRjaCAodG9rZW4pIHsKICAgICAgICBjYXNlICJGb250TWF0cml4IjoKICAgICAgICAgIGNvbnN0IG1hdHJpeCA9IHRoaXMucmVhZE51bWJlckFycmF5KCk7CiAgICAgICAgICBwcm9wZXJ0aWVzLmZvbnRNYXRyaXggPSBtYXRyaXg7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiRW5jb2RpbmciOgogICAgICAgICAgY29uc3QgZW5jb2RpbmdBcmcgPSB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICBsZXQgZW5jb2Rpbmc7CgogICAgICAgICAgaWYgKCEvXlxkKyQvLnRlc3QoZW5jb2RpbmdBcmcpKSB7CiAgICAgICAgICAgIGVuY29kaW5nID0gKDAsIF9lbmNvZGluZ3MuZ2V0RW5jb2RpbmcpKGVuY29kaW5nQXJnKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVuY29kaW5nID0gW107CiAgICAgICAgICAgIGNvbnN0IHNpemUgPSBwYXJzZUludChlbmNvZGluZ0FyZywgMTApIHwgMDsKICAgICAgICAgICAgdGhpcy5nZXRUb2tlbigpOwoKICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaXplOyBqKyspIHsKICAgICAgICAgICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgICAgd2hpbGUgKHRva2VuICE9PSAiZHVwIiAmJiB0b2tlbiAhPT0gImRlZiIpIHsKICAgICAgICAgICAgICAgIHRva2VuID0gdGhpcy5nZXRUb2tlbigpOwoKICAgICAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAodG9rZW4gPT09ICJkZWYiKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5yZWFkSW50KCk7CiAgICAgICAgICAgICAgdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICAgIGNvbnN0IGdseXBoID0gdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICAgIGVuY29kaW5nW2luZGV4XSA9IGdseXBoOwogICAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHByb3BlcnRpZXMuYnVpbHRJbkVuY29kaW5nID0gZW5jb2Rpbmc7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiRm9udEJCb3giOgogICAgICAgICAgY29uc3QgZm9udEJCb3ggPSB0aGlzLnJlYWROdW1iZXJBcnJheSgpOwogICAgICAgICAgcHJvcGVydGllcy5hc2NlbnQgPSBNYXRoLm1heChmb250QkJveFszXSwgZm9udEJCb3hbMV0pOwogICAgICAgICAgcHJvcGVydGllcy5kZXNjZW50ID0gTWF0aC5taW4oZm9udEJCb3hbMV0sIGZvbnRCQm94WzNdKTsKICAgICAgICAgIHByb3BlcnRpZXMuYXNjZW50U2NhbGVkID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5UeXBlMVBhcnNlciA9IFR5cGUxUGFyc2VyOwoKLyoqKi8gfSksCi8qIDE3NSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuUGF0dGVybiA9IHZvaWQgMDsKZXhwb3J0cy5nZXRUaWxpbmdQYXR0ZXJuSVIgPSBnZXRUaWxpbmdQYXR0ZXJuSVI7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9iYXNlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMyKTsKCnZhciBfY29sb3JzcGFjZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTM5KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMxKTsKCmNvbnN0IFNoYWRpbmdUeXBlID0gewogIEZVTkNUSU9OX0JBU0VEOiAxLAogIEFYSUFMOiAyLAogIFJBRElBTDogMywKICBGUkVFX0ZPUk1fTUVTSDogNCwKICBMQVRUSUNFX0ZPUk1fTUVTSDogNSwKICBDT09OU19QQVRDSF9NRVNIOiA2LAogIFRFTlNPUl9QQVRDSF9NRVNIOiA3Cn07CgpjbGFzcyBQYXR0ZXJuIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBpbml0aWFsaXplIFBhdHRlcm4uIik7CiAgfQoKICBzdGF0aWMgcGFyc2VTaGFkaW5nKHNoYWRpbmcsIHhyZWYsIHJlcywgaGFuZGxlciwgcGRmRnVuY3Rpb25GYWN0b3J5LCBsb2NhbENvbG9yU3BhY2VDYWNoZSkgewogICAgY29uc3QgZGljdCA9IHNoYWRpbmcgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSA/IHNoYWRpbmcuZGljdCA6IHNoYWRpbmc7CiAgICBjb25zdCB0eXBlID0gZGljdC5nZXQoIlNoYWRpbmdUeXBlIik7CgogICAgdHJ5IHsKICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgY2FzZSBTaGFkaW5nVHlwZS5BWElBTDoKICAgICAgICBjYXNlIFNoYWRpbmdUeXBlLlJBRElBTDoKICAgICAgICAgIHJldHVybiBuZXcgUmFkaWFsQXhpYWxTaGFkaW5nKGRpY3QsIHhyZWYsIHJlcywgcGRmRnVuY3Rpb25GYWN0b3J5LCBsb2NhbENvbG9yU3BhY2VDYWNoZSk7CgogICAgICAgIGNhc2UgU2hhZGluZ1R5cGUuRlJFRV9GT1JNX01FU0g6CiAgICAgICAgY2FzZSBTaGFkaW5nVHlwZS5MQVRUSUNFX0ZPUk1fTUVTSDoKICAgICAgICBjYXNlIFNoYWRpbmdUeXBlLkNPT05TX1BBVENIX01FU0g6CiAgICAgICAgY2FzZSBTaGFkaW5nVHlwZS5URU5TT1JfUEFUQ0hfTUVTSDoKICAgICAgICAgIHJldHVybiBuZXcgTWVzaFNoYWRpbmcoc2hhZGluZywgeHJlZiwgcmVzLCBwZGZGdW5jdGlvbkZhY3RvcnksIGxvY2FsQ29sb3JTcGFjZUNhY2hlKTsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5zdXBwb3J0ZWQgU2hhZGluZ1R5cGU6ICIgKyB0eXBlKTsKICAgICAgfQogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5zaGFkaW5nUGF0dGVybgogICAgICB9KTsKICAgICAgKDAsIF91dGlsLndhcm4pKGV4KTsKICAgICAgcmV0dXJuIG5ldyBEdW1teVNoYWRpbmcoKTsKICAgIH0KICB9Cgp9CgpleHBvcnRzLlBhdHRlcm4gPSBQYXR0ZXJuOwoKY2xhc3MgQmFzZVNoYWRpbmcgewogIHN0YXRpYyBnZXQgU01BTExfTlVNQkVSKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJTTUFMTF9OVU1CRVIiLCAxZS02KTsKICB9CgogIGNvbnN0cnVjdG9yKCkgewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IEJhc2VTaGFkaW5nKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBpbml0aWFsaXplIEJhc2VTaGFkaW5nLiIpOwogICAgfQogIH0KCiAgZ2V0SVIoKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYGdldElSYCBjYWxsZWQuIik7CiAgfQoKfQoKY2xhc3MgUmFkaWFsQXhpYWxTaGFkaW5nIGV4dGVuZHMgQmFzZVNoYWRpbmcgewogIGNvbnN0cnVjdG9yKGRpY3QsIHhyZWYsIHJlc291cmNlcywgcGRmRnVuY3Rpb25GYWN0b3J5LCBsb2NhbENvbG9yU3BhY2VDYWNoZSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMuY29vcmRzQXJyID0gZGljdC5nZXRBcnJheSgiQ29vcmRzIik7CiAgICB0aGlzLnNoYWRpbmdUeXBlID0gZGljdC5nZXQoIlNoYWRpbmdUeXBlIik7CgogICAgY29uc3QgY3MgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnBhcnNlKHsKICAgICAgY3M6IGRpY3QuZ2V0UmF3KCJDUyIpIHx8IGRpY3QuZ2V0UmF3KCJDb2xvclNwYWNlIiksCiAgICAgIHhyZWYsCiAgICAgIHJlc291cmNlcywKICAgICAgcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgfSk7CgogICAgY29uc3QgYmJveCA9IGRpY3QuZ2V0QXJyYXkoIkJCb3giKTsKCiAgICBpZiAoQXJyYXkuaXNBcnJheShiYm94KSAmJiBiYm94Lmxlbmd0aCA9PT0gNCkgewogICAgICB0aGlzLmJib3ggPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3QoYmJveCk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmJib3ggPSBudWxsOwogICAgfQoKICAgIGxldCB0MCA9IDAuMCwKICAgICAgICB0MSA9IDEuMDsKCiAgICBpZiAoZGljdC5oYXMoIkRvbWFpbiIpKSB7CiAgICAgIGNvbnN0IGRvbWFpbkFyciA9IGRpY3QuZ2V0QXJyYXkoIkRvbWFpbiIpOwogICAgICB0MCA9IGRvbWFpbkFyclswXTsKICAgICAgdDEgPSBkb21haW5BcnJbMV07CiAgICB9CgogICAgbGV0IGV4dGVuZFN0YXJ0ID0gZmFsc2UsCiAgICAgICAgZXh0ZW5kRW5kID0gZmFsc2U7CgogICAgaWYgKGRpY3QuaGFzKCJFeHRlbmQiKSkgewogICAgICBjb25zdCBleHRlbmRBcnIgPSBkaWN0LmdldEFycmF5KCJFeHRlbmQiKTsKICAgICAgZXh0ZW5kU3RhcnQgPSBleHRlbmRBcnJbMF07CiAgICAgIGV4dGVuZEVuZCA9IGV4dGVuZEFyclsxXTsKICAgIH0KCiAgICBpZiAodGhpcy5zaGFkaW5nVHlwZSA9PT0gU2hhZGluZ1R5cGUuUkFESUFMICYmICghZXh0ZW5kU3RhcnQgfHwgIWV4dGVuZEVuZCkpIHsKICAgICAgY29uc3QgW3gxLCB5MSwgcjEsIHgyLCB5MiwgcjJdID0gdGhpcy5jb29yZHNBcnI7CiAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5oeXBvdCh4MSAtIHgyLCB5MSAtIHkyKTsKCiAgICAgIGlmIChyMSA8PSByMiArIGRpc3RhbmNlICYmIHIyIDw9IHIxICsgZGlzdGFuY2UpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIlVuc3VwcG9ydGVkIHJhZGlhbCBncmFkaWVudC4iKTsKICAgICAgfQogICAgfQoKICAgIHRoaXMuZXh0ZW5kU3RhcnQgPSBleHRlbmRTdGFydDsKICAgIHRoaXMuZXh0ZW5kRW5kID0gZXh0ZW5kRW5kOwogICAgY29uc3QgZm5PYmogPSBkaWN0LmdldFJhdygiRnVuY3Rpb24iKTsKICAgIGNvbnN0IGZuID0gcGRmRnVuY3Rpb25GYWN0b3J5LmNyZWF0ZUZyb21BcnJheShmbk9iaik7CiAgICBjb25zdCBOVU1CRVJfT0ZfU0FNUExFUyA9IDEwOwogICAgY29uc3Qgc3RlcCA9ICh0MSAtIHQwKSAvIE5VTUJFUl9PRl9TQU1QTEVTOwogICAgY29uc3QgY29sb3JTdG9wcyA9IHRoaXMuY29sb3JTdG9wcyA9IFtdOwoKICAgIGlmICh0MCA+PSB0MSB8fCBzdGVwIDw9IDApIHsKICAgICAgKDAsIF91dGlsLmluZm8pKCJCYWQgc2hhZGluZyBkb21haW4uIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBjb2xvciA9IG5ldyBGbG9hdDMyQXJyYXkoY3MubnVtQ29tcHMpLAogICAgICAgICAgcmF0aW8gPSBuZXcgRmxvYXQzMkFycmF5KDEpOwogICAgbGV0IHJnYkNvbG9yOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IE5VTUJFUl9PRl9TQU1QTEVTOyBpKyspIHsKICAgICAgcmF0aW9bMF0gPSB0MCArIGkgKiBzdGVwOwogICAgICBmbihyYXRpbywgMCwgY29sb3IsIDApOwogICAgICByZ2JDb2xvciA9IGNzLmdldFJnYihjb2xvciwgMCk7CgogICAgICBjb25zdCBjc3NDb2xvciA9IF91dGlsLlV0aWwubWFrZUhleENvbG9yKHJnYkNvbG9yWzBdLCByZ2JDb2xvclsxXSwgcmdiQ29sb3JbMl0pOwoKICAgICAgY29sb3JTdG9wcy5wdXNoKFtpIC8gTlVNQkVSX09GX1NBTVBMRVMsIGNzc0NvbG9yXSk7CiAgICB9CgogICAgbGV0IGJhY2tncm91bmQgPSAidHJhbnNwYXJlbnQiOwoKICAgIGlmIChkaWN0LmhhcygiQmFja2dyb3VuZCIpKSB7CiAgICAgIHJnYkNvbG9yID0gY3MuZ2V0UmdiKGRpY3QuZ2V0KCJCYWNrZ3JvdW5kIiksIDApOwogICAgICBiYWNrZ3JvdW5kID0gX3V0aWwuVXRpbC5tYWtlSGV4Q29sb3IocmdiQ29sb3JbMF0sIHJnYkNvbG9yWzFdLCByZ2JDb2xvclsyXSk7CiAgICB9CgogICAgaWYgKCFleHRlbmRTdGFydCkgewogICAgICBjb2xvclN0b3BzLnVuc2hpZnQoWzAsIGJhY2tncm91bmRdKTsKICAgICAgY29sb3JTdG9wc1sxXVswXSArPSBCYXNlU2hhZGluZy5TTUFMTF9OVU1CRVI7CiAgICB9CgogICAgaWYgKCFleHRlbmRFbmQpIHsKICAgICAgY29sb3JTdG9wcy5hdCgtMSlbMF0gLT0gQmFzZVNoYWRpbmcuU01BTExfTlVNQkVSOwogICAgICBjb2xvclN0b3BzLnB1c2goWzEsIGJhY2tncm91bmRdKTsKICAgIH0KCiAgICB0aGlzLmNvbG9yU3RvcHMgPSBjb2xvclN0b3BzOwogIH0KCiAgZ2V0SVIoKSB7CiAgICBjb25zdCBjb29yZHNBcnIgPSB0aGlzLmNvb3Jkc0FycjsKICAgIGNvbnN0IHNoYWRpbmdUeXBlID0gdGhpcy5zaGFkaW5nVHlwZTsKICAgIGxldCB0eXBlLCBwMCwgcDEsIHIwLCByMTsKCiAgICBpZiAoc2hhZGluZ1R5cGUgPT09IFNoYWRpbmdUeXBlLkFYSUFMKSB7CiAgICAgIHAwID0gW2Nvb3Jkc0FyclswXSwgY29vcmRzQXJyWzFdXTsKICAgICAgcDEgPSBbY29vcmRzQXJyWzJdLCBjb29yZHNBcnJbM11dOwogICAgICByMCA9IG51bGw7CiAgICAgIHIxID0gbnVsbDsKICAgICAgdHlwZSA9ICJheGlhbCI7CiAgICB9IGVsc2UgaWYgKHNoYWRpbmdUeXBlID09PSBTaGFkaW5nVHlwZS5SQURJQUwpIHsKICAgICAgcDAgPSBbY29vcmRzQXJyWzBdLCBjb29yZHNBcnJbMV1dOwogICAgICBwMSA9IFtjb29yZHNBcnJbM10sIGNvb3Jkc0Fycls0XV07CiAgICAgIHIwID0gY29vcmRzQXJyWzJdOwogICAgICByMSA9IGNvb3Jkc0Fycls1XTsKICAgICAgdHlwZSA9ICJyYWRpYWwiOwogICAgfSBlbHNlIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKShgZ2V0UGF0dGVybiB0eXBlIHVua25vd246ICR7c2hhZGluZ1R5cGV9YCk7CiAgICB9CgogICAgcmV0dXJuIFsiUmFkaWFsQXhpYWwiLCB0eXBlLCB0aGlzLmJib3gsIHRoaXMuY29sb3JTdG9wcywgcDAsIHAxLCByMCwgcjFdOwogIH0KCn0KCmNsYXNzIE1lc2hTdHJlYW1SZWFkZXIgewogIGNvbnN0cnVjdG9yKHN0cmVhbSwgY29udGV4dCkgewogICAgdGhpcy5zdHJlYW0gPSBzdHJlYW07CiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0OwogICAgdGhpcy5idWZmZXIgPSAwOwogICAgdGhpcy5idWZmZXJMZW5ndGggPSAwOwogICAgY29uc3QgbnVtQ29tcHMgPSBjb250ZXh0Lm51bUNvbXBzOwogICAgdGhpcy50bXBDb21wc0J1ZiA9IG5ldyBGbG9hdDMyQXJyYXkobnVtQ29tcHMpOwogICAgY29uc3QgY3NOdW1Db21wcyA9IGNvbnRleHQuY29sb3JTcGFjZS5udW1Db21wczsKICAgIHRoaXMudG1wQ3NDb21wc0J1ZiA9IGNvbnRleHQuY29sb3JGbiA/IG5ldyBGbG9hdDMyQXJyYXkoY3NOdW1Db21wcykgOiB0aGlzLnRtcENvbXBzQnVmOwogIH0KCiAgZ2V0IGhhc0RhdGEoKSB7CiAgICBpZiAodGhpcy5zdHJlYW0uZW5kKSB7CiAgICAgIHJldHVybiB0aGlzLnN0cmVhbS5wb3MgPCB0aGlzLnN0cmVhbS5lbmQ7CiAgICB9CgogICAgaWYgKHRoaXMuYnVmZmVyTGVuZ3RoID4gMCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBjb25zdCBuZXh0Qnl0ZSA9IHRoaXMuc3RyZWFtLmdldEJ5dGUoKTsKCiAgICBpZiAobmV4dEJ5dGUgPCAwKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICB0aGlzLmJ1ZmZlciA9IG5leHRCeXRlOwogICAgdGhpcy5idWZmZXJMZW5ndGggPSA4OwogICAgcmV0dXJuIHRydWU7CiAgfQoKICByZWFkQml0cyhuKSB7CiAgICBsZXQgYnVmZmVyID0gdGhpcy5idWZmZXI7CiAgICBsZXQgYnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXJMZW5ndGg7CgogICAgaWYgKG4gPT09IDMyKSB7CiAgICAgIGlmIChidWZmZXJMZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gKHRoaXMuc3RyZWFtLmdldEJ5dGUoKSA8PCAyNCB8IHRoaXMuc3RyZWFtLmdldEJ5dGUoKSA8PCAxNiB8IHRoaXMuc3RyZWFtLmdldEJ5dGUoKSA8PCA4IHwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpKSA+Pj4gMDsKICAgICAgfQoKICAgICAgYnVmZmVyID0gYnVmZmVyIDw8IDI0IHwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpIDw8IDE2IHwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpIDw8IDggfCB0aGlzLnN0cmVhbS5nZXRCeXRlKCk7CiAgICAgIGNvbnN0IG5leHRCeXRlID0gdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpOwogICAgICB0aGlzLmJ1ZmZlciA9IG5leHRCeXRlICYgKDEgPDwgYnVmZmVyTGVuZ3RoKSAtIDE7CiAgICAgIHJldHVybiAoYnVmZmVyIDw8IDggLSBidWZmZXJMZW5ndGggfCAobmV4dEJ5dGUgJiAweGZmKSA+PiBidWZmZXJMZW5ndGgpID4+PiAwOwogICAgfQoKICAgIGlmIChuID09PSA4ICYmIGJ1ZmZlckxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpOwogICAgfQoKICAgIHdoaWxlIChidWZmZXJMZW5ndGggPCBuKSB7CiAgICAgIGJ1ZmZlciA9IGJ1ZmZlciA8PCA4IHwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpOwogICAgICBidWZmZXJMZW5ndGggKz0gODsKICAgIH0KCiAgICBidWZmZXJMZW5ndGggLT0gbjsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gYnVmZmVyTGVuZ3RoOwogICAgdGhpcy5idWZmZXIgPSBidWZmZXIgJiAoMSA8PCBidWZmZXJMZW5ndGgpIC0gMTsKICAgIHJldHVybiBidWZmZXIgPj4gYnVmZmVyTGVuZ3RoOwogIH0KCiAgYWxpZ24oKSB7CiAgICB0aGlzLmJ1ZmZlciA9IDA7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IDA7CiAgfQoKICByZWFkRmxhZygpIHsKICAgIHJldHVybiB0aGlzLnJlYWRCaXRzKHRoaXMuY29udGV4dC5iaXRzUGVyRmxhZyk7CiAgfQoKICByZWFkQ29vcmRpbmF0ZSgpIHsKICAgIGNvbnN0IGJpdHNQZXJDb29yZGluYXRlID0gdGhpcy5jb250ZXh0LmJpdHNQZXJDb29yZGluYXRlOwogICAgY29uc3QgeGkgPSB0aGlzLnJlYWRCaXRzKGJpdHNQZXJDb29yZGluYXRlKTsKICAgIGNvbnN0IHlpID0gdGhpcy5yZWFkQml0cyhiaXRzUGVyQ29vcmRpbmF0ZSk7CiAgICBjb25zdCBkZWNvZGUgPSB0aGlzLmNvbnRleHQuZGVjb2RlOwogICAgY29uc3Qgc2NhbGUgPSBiaXRzUGVyQ29vcmRpbmF0ZSA8IDMyID8gMSAvICgoMSA8PCBiaXRzUGVyQ29vcmRpbmF0ZSkgLSAxKSA6IDIuMzI4MzA2NDM2NTM4Njk2M2UtMTA7CiAgICByZXR1cm4gW3hpICogc2NhbGUgKiAoZGVjb2RlWzFdIC0gZGVjb2RlWzBdKSArIGRlY29kZVswXSwgeWkgKiBzY2FsZSAqIChkZWNvZGVbM10gLSBkZWNvZGVbMl0pICsgZGVjb2RlWzJdXTsKICB9CgogIHJlYWRDb21wb25lbnRzKCkgewogICAgY29uc3QgbnVtQ29tcHMgPSB0aGlzLmNvbnRleHQubnVtQ29tcHM7CiAgICBjb25zdCBiaXRzUGVyQ29tcG9uZW50ID0gdGhpcy5jb250ZXh0LmJpdHNQZXJDb21wb25lbnQ7CiAgICBjb25zdCBzY2FsZSA9IGJpdHNQZXJDb21wb25lbnQgPCAzMiA/IDEgLyAoKDEgPDwgYml0c1BlckNvbXBvbmVudCkgLSAxKSA6IDIuMzI4MzA2NDM2NTM4Njk2M2UtMTA7CiAgICBjb25zdCBkZWNvZGUgPSB0aGlzLmNvbnRleHQuZGVjb2RlOwogICAgY29uc3QgY29tcG9uZW50cyA9IHRoaXMudG1wQ29tcHNCdWY7CgogICAgZm9yIChsZXQgaSA9IDAsIGogPSA0OyBpIDwgbnVtQ29tcHM7IGkrKywgaiArPSAyKSB7CiAgICAgIGNvbnN0IGNpID0gdGhpcy5yZWFkQml0cyhiaXRzUGVyQ29tcG9uZW50KTsKICAgICAgY29tcG9uZW50c1tpXSA9IGNpICogc2NhbGUgKiAoZGVjb2RlW2ogKyAxXSAtIGRlY29kZVtqXSkgKyBkZWNvZGVbal07CiAgICB9CgogICAgY29uc3QgY29sb3IgPSB0aGlzLnRtcENzQ29tcHNCdWY7CgogICAgaWYgKHRoaXMuY29udGV4dC5jb2xvckZuKSB7CiAgICAgIHRoaXMuY29udGV4dC5jb2xvckZuKGNvbXBvbmVudHMsIDAsIGNvbG9yLCAwKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5jb250ZXh0LmNvbG9yU3BhY2UuZ2V0UmdiKGNvbG9yLCAwKTsKICB9Cgp9Cgpjb25zdCBnZXRCID0gZnVuY3Rpb24gZ2V0QkNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gYnVpbGRCKGNvdW50KSB7CiAgICBjb25zdCBsdXQgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBjb3VudDsgaSsrKSB7CiAgICAgIGNvbnN0IHQgPSBpIC8gY291bnQsCiAgICAgICAgICAgIHRfID0gMSAtIHQ7CiAgICAgIGx1dC5wdXNoKG5ldyBGbG9hdDMyQXJyYXkoW3RfICogdF8gKiB0XywgMyAqIHQgKiB0XyAqIHRfLCAzICogdCAqIHQgKiB0XywgdCAqIHQgKiB0XSkpOwogICAgfQoKICAgIHJldHVybiBsdXQ7CiAgfQoKICBjb25zdCBjYWNoZSA9IFtdOwogIHJldHVybiBmdW5jdGlvbiAoY291bnQpIHsKICAgIGlmICghY2FjaGVbY291bnRdKSB7CiAgICAgIGNhY2hlW2NvdW50XSA9IGJ1aWxkQihjb3VudCk7CiAgICB9CgogICAgcmV0dXJuIGNhY2hlW2NvdW50XTsKICB9Owp9KCk7CgpjbGFzcyBNZXNoU2hhZGluZyBleHRlbmRzIEJhc2VTaGFkaW5nIHsKICBzdGF0aWMgZ2V0IE1JTl9TUExJVF9QQVRDSF9DSFVOS1NfQU1PVU5UKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJNSU5fU1BMSVRfUEFUQ0hfQ0hVTktTX0FNT1VOVCIsIDMpOwogIH0KCiAgc3RhdGljIGdldCBNQVhfU1BMSVRfUEFUQ0hfQ0hVTktTX0FNT1VOVCgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiTUFYX1NQTElUX1BBVENIX0NIVU5LU19BTU9VTlQiLCAyMCk7CiAgfQoKICBzdGF0aWMgZ2V0IFRSSUFOR0xFX0RFTlNJVFkoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIlRSSUFOR0xFX0RFTlNJVFkiLCAyMCk7CiAgfQoKICBjb25zdHJ1Y3RvcihzdHJlYW0sIHhyZWYsIHJlc291cmNlcywgcGRmRnVuY3Rpb25GYWN0b3J5LCBsb2NhbENvbG9yU3BhY2VDYWNoZSkgewogICAgc3VwZXIoKTsKCiAgICBpZiAoIShzdHJlYW0gaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJNZXNoIGRhdGEgaXMgbm90IGEgc3RyZWFtIik7CiAgICB9CgogICAgY29uc3QgZGljdCA9IHN0cmVhbS5kaWN0OwogICAgdGhpcy5zaGFkaW5nVHlwZSA9IGRpY3QuZ2V0KCJTaGFkaW5nVHlwZSIpOwogICAgY29uc3QgYmJveCA9IGRpY3QuZ2V0QXJyYXkoIkJCb3giKTsKCiAgICBpZiAoQXJyYXkuaXNBcnJheShiYm94KSAmJiBiYm94Lmxlbmd0aCA9PT0gNCkgewogICAgICB0aGlzLmJib3ggPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3QoYmJveCk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmJib3ggPSBudWxsOwogICAgfQoKICAgIGNvbnN0IGNzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5wYXJzZSh7CiAgICAgIGNzOiBkaWN0LmdldFJhdygiQ1MiKSB8fCBkaWN0LmdldFJhdygiQ29sb3JTcGFjZSIpLAogICAgICB4cmVmLAogICAgICByZXNvdXJjZXMsCiAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeSwKICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgIH0pOwoKICAgIHRoaXMuYmFja2dyb3VuZCA9IGRpY3QuaGFzKCJCYWNrZ3JvdW5kIikgPyBjcy5nZXRSZ2IoZGljdC5nZXQoIkJhY2tncm91bmQiKSwgMCkgOiBudWxsOwogICAgY29uc3QgZm5PYmogPSBkaWN0LmdldFJhdygiRnVuY3Rpb24iKTsKICAgIGNvbnN0IGZuID0gZm5PYmogPyBwZGZGdW5jdGlvbkZhY3RvcnkuY3JlYXRlRnJvbUFycmF5KGZuT2JqKSA6IG51bGw7CiAgICB0aGlzLmNvb3JkcyA9IFtdOwogICAgdGhpcy5jb2xvcnMgPSBbXTsKICAgIHRoaXMuZmlndXJlcyA9IFtdOwogICAgY29uc3QgZGVjb2RlQ29udGV4dCA9IHsKICAgICAgYml0c1BlckNvb3JkaW5hdGU6IGRpY3QuZ2V0KCJCaXRzUGVyQ29vcmRpbmF0ZSIpLAogICAgICBiaXRzUGVyQ29tcG9uZW50OiBkaWN0LmdldCgiQml0c1BlckNvbXBvbmVudCIpLAogICAgICBiaXRzUGVyRmxhZzogZGljdC5nZXQoIkJpdHNQZXJGbGFnIiksCiAgICAgIGRlY29kZTogZGljdC5nZXRBcnJheSgiRGVjb2RlIiksCiAgICAgIGNvbG9yRm46IGZuLAogICAgICBjb2xvclNwYWNlOiBjcywKICAgICAgbnVtQ29tcHM6IGZuID8gMSA6IGNzLm51bUNvbXBzCiAgICB9OwogICAgY29uc3QgcmVhZGVyID0gbmV3IE1lc2hTdHJlYW1SZWFkZXIoc3RyZWFtLCBkZWNvZGVDb250ZXh0KTsKICAgIGxldCBwYXRjaE1lc2ggPSBmYWxzZTsKCiAgICBzd2l0Y2ggKHRoaXMuc2hhZGluZ1R5cGUpIHsKICAgICAgY2FzZSBTaGFkaW5nVHlwZS5GUkVFX0ZPUk1fTUVTSDoKICAgICAgICB0aGlzLl9kZWNvZGVUeXBlNFNoYWRpbmcocmVhZGVyKTsKCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFNoYWRpbmdUeXBlLkxBVFRJQ0VfRk9STV9NRVNIOgogICAgICAgIGNvbnN0IHZlcnRpY2VzUGVyUm93ID0gZGljdC5nZXQoIlZlcnRpY2VzUGVyUm93IikgfCAwOwoKICAgICAgICBpZiAodmVydGljZXNQZXJSb3cgPCAyKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgVmVydGljZXNQZXJSb3ciKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuX2RlY29kZVR5cGU1U2hhZGluZyhyZWFkZXIsIHZlcnRpY2VzUGVyUm93KTsKCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFNoYWRpbmdUeXBlLkNPT05TX1BBVENIX01FU0g6CiAgICAgICAgdGhpcy5fZGVjb2RlVHlwZTZTaGFkaW5nKHJlYWRlcik7CgogICAgICAgIHBhdGNoTWVzaCA9IHRydWU7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFNoYWRpbmdUeXBlLlRFTlNPUl9QQVRDSF9NRVNIOgogICAgICAgIHRoaXMuX2RlY29kZVR5cGU3U2hhZGluZyhyZWFkZXIpOwoKICAgICAgICBwYXRjaE1lc2ggPSB0cnVlOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJVbnN1cHBvcnRlZCBtZXNoIHR5cGUuIik7CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgaWYgKHBhdGNoTWVzaCkgewogICAgICB0aGlzLl91cGRhdGVCb3VuZHMoKTsKCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHRoaXMuZmlndXJlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgdGhpcy5fYnVpbGRGaWd1cmVGcm9tUGF0Y2goaSk7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLl91cGRhdGVCb3VuZHMoKTsKCiAgICB0aGlzLl9wYWNrRGF0YSgpOwogIH0KCiAgX2RlY29kZVR5cGU0U2hhZGluZyhyZWFkZXIpIHsKICAgIGNvbnN0IGNvb3JkcyA9IHRoaXMuY29vcmRzOwogICAgY29uc3QgY29sb3JzID0gdGhpcy5jb2xvcnM7CiAgICBjb25zdCBvcGVyYXRvcnMgPSBbXTsKICAgIGNvbnN0IHBzID0gW107CiAgICBsZXQgdmVydGljZXNMZWZ0ID0gMDsKCiAgICB3aGlsZSAocmVhZGVyLmhhc0RhdGEpIHsKICAgICAgY29uc3QgZiA9IHJlYWRlci5yZWFkRmxhZygpOwogICAgICBjb25zdCBjb29yZCA9IHJlYWRlci5yZWFkQ29vcmRpbmF0ZSgpOwogICAgICBjb25zdCBjb2xvciA9IHJlYWRlci5yZWFkQ29tcG9uZW50cygpOwoKICAgICAgaWYgKHZlcnRpY2VzTGVmdCA9PT0gMCkgewogICAgICAgIGlmICghKDAgPD0gZiAmJiBmIDw9IDIpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gdHlwZTQgZmxhZyIpOwogICAgICAgIH0KCiAgICAgICAgc3dpdGNoIChmKSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHZlcnRpY2VzTGVmdCA9IDM7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgcHMucHVzaChwcy5hdCgtMiksIHBzLmF0KC0xKSk7CiAgICAgICAgICAgIHZlcnRpY2VzTGVmdCA9IDE7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcHMucHVzaChwcy5hdCgtMyksIHBzLmF0KC0xKSk7CiAgICAgICAgICAgIHZlcnRpY2VzTGVmdCA9IDE7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgb3BlcmF0b3JzLnB1c2goZik7CiAgICAgIH0KCiAgICAgIHBzLnB1c2goY29vcmRzLmxlbmd0aCk7CiAgICAgIGNvb3Jkcy5wdXNoKGNvb3JkKTsKICAgICAgY29sb3JzLnB1c2goY29sb3IpOwogICAgICB2ZXJ0aWNlc0xlZnQtLTsKICAgICAgcmVhZGVyLmFsaWduKCk7CiAgICB9CgogICAgdGhpcy5maWd1cmVzLnB1c2goewogICAgICB0eXBlOiAidHJpYW5nbGVzIiwKICAgICAgY29vcmRzOiBuZXcgSW50MzJBcnJheShwcyksCiAgICAgIGNvbG9yczogbmV3IEludDMyQXJyYXkocHMpCiAgICB9KTsKICB9CgogIF9kZWNvZGVUeXBlNVNoYWRpbmcocmVhZGVyLCB2ZXJ0aWNlc1BlclJvdykgewogICAgY29uc3QgY29vcmRzID0gdGhpcy5jb29yZHM7CiAgICBjb25zdCBjb2xvcnMgPSB0aGlzLmNvbG9yczsKICAgIGNvbnN0IHBzID0gW107CgogICAgd2hpbGUgKHJlYWRlci5oYXNEYXRhKSB7CiAgICAgIGNvbnN0IGNvb3JkID0gcmVhZGVyLnJlYWRDb29yZGluYXRlKCk7CiAgICAgIGNvbnN0IGNvbG9yID0gcmVhZGVyLnJlYWRDb21wb25lbnRzKCk7CiAgICAgIHBzLnB1c2goY29vcmRzLmxlbmd0aCk7CiAgICAgIGNvb3Jkcy5wdXNoKGNvb3JkKTsKICAgICAgY29sb3JzLnB1c2goY29sb3IpOwogICAgfQoKICAgIHRoaXMuZmlndXJlcy5wdXNoKHsKICAgICAgdHlwZTogImxhdHRpY2UiLAogICAgICBjb29yZHM6IG5ldyBJbnQzMkFycmF5KHBzKSwKICAgICAgY29sb3JzOiBuZXcgSW50MzJBcnJheShwcyksCiAgICAgIHZlcnRpY2VzUGVyUm93CiAgICB9KTsKICB9CgogIF9kZWNvZGVUeXBlNlNoYWRpbmcocmVhZGVyKSB7CiAgICBjb25zdCBjb29yZHMgPSB0aGlzLmNvb3JkczsKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuY29sb3JzOwogICAgY29uc3QgcHMgPSBuZXcgSW50MzJBcnJheSgxNik7CiAgICBjb25zdCBjcyA9IG5ldyBJbnQzMkFycmF5KDQpOwoKICAgIHdoaWxlIChyZWFkZXIuaGFzRGF0YSkgewogICAgICBjb25zdCBmID0gcmVhZGVyLnJlYWRGbGFnKCk7CgogICAgICBpZiAoISgwIDw9IGYgJiYgZiA8PSAzKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biB0eXBlNiBmbGFnIik7CiAgICAgIH0KCiAgICAgIGNvbnN0IHBpID0gY29vcmRzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGYgIT09IDAgPyA4IDogMTI7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29vcmRzLnB1c2gocmVhZGVyLnJlYWRDb29yZGluYXRlKCkpOwogICAgICB9CgogICAgICBjb25zdCBjaSA9IGNvbG9ycy5sZW5ndGg7CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBmICE9PSAwID8gMiA6IDQ7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29sb3JzLnB1c2gocmVhZGVyLnJlYWRDb21wb25lbnRzKCkpOwogICAgICB9CgogICAgICBsZXQgdG1wMSwgdG1wMiwgdG1wMywgdG1wNDsKCiAgICAgIHN3aXRjaCAoZikgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHBzWzEyXSA9IHBpICsgMzsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgNDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgNTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgNjsKICAgICAgICAgIHBzWzhdID0gcGkgKyAyOwogICAgICAgICAgcHNbMTFdID0gcGkgKyA3OwogICAgICAgICAgcHNbNF0gPSBwaSArIDE7CiAgICAgICAgICBwc1s3XSA9IHBpICsgODsKICAgICAgICAgIHBzWzBdID0gcGk7CiAgICAgICAgICBwc1sxXSA9IHBpICsgMTE7CiAgICAgICAgICBwc1syXSA9IHBpICsgMTA7CiAgICAgICAgICBwc1szXSA9IHBpICsgOTsKICAgICAgICAgIGNzWzJdID0gY2kgKyAxOwogICAgICAgICAgY3NbM10gPSBjaSArIDI7CiAgICAgICAgICBjc1swXSA9IGNpOwogICAgICAgICAgY3NbMV0gPSBjaSArIDM7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxOgogICAgICAgICAgdG1wMSA9IHBzWzEyXTsKICAgICAgICAgIHRtcDIgPSBwc1sxM107CiAgICAgICAgICB0bXAzID0gcHNbMTRdOwogICAgICAgICAgdG1wNCA9IHBzWzE1XTsKICAgICAgICAgIHBzWzEyXSA9IHRtcDQ7CiAgICAgICAgICBwc1sxM10gPSBwaSArIDA7CiAgICAgICAgICBwc1sxNF0gPSBwaSArIDE7CiAgICAgICAgICBwc1sxNV0gPSBwaSArIDI7CiAgICAgICAgICBwc1s4XSA9IHRtcDM7CiAgICAgICAgICBwc1sxMV0gPSBwaSArIDM7CiAgICAgICAgICBwc1s0XSA9IHRtcDI7CiAgICAgICAgICBwc1s3XSA9IHBpICsgNDsKICAgICAgICAgIHBzWzBdID0gdG1wMTsKICAgICAgICAgIHBzWzFdID0gcGkgKyA3OwogICAgICAgICAgcHNbMl0gPSBwaSArIDY7CiAgICAgICAgICBwc1szXSA9IHBpICsgNTsKICAgICAgICAgIHRtcDEgPSBjc1syXTsKICAgICAgICAgIHRtcDIgPSBjc1szXTsKICAgICAgICAgIGNzWzJdID0gdG1wMjsKICAgICAgICAgIGNzWzNdID0gY2k7CiAgICAgICAgICBjc1swXSA9IHRtcDE7CiAgICAgICAgICBjc1sxXSA9IGNpICsgMTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgICB0bXAxID0gcHNbMTVdOwogICAgICAgICAgdG1wMiA9IHBzWzExXTsKICAgICAgICAgIHBzWzEyXSA9IHBzWzNdOwogICAgICAgICAgcHNbMTNdID0gcGkgKyAwOwogICAgICAgICAgcHNbMTRdID0gcGkgKyAxOwogICAgICAgICAgcHNbMTVdID0gcGkgKyAyOwogICAgICAgICAgcHNbOF0gPSBwc1s3XTsKICAgICAgICAgIHBzWzExXSA9IHBpICsgMzsKICAgICAgICAgIHBzWzRdID0gdG1wMjsKICAgICAgICAgIHBzWzddID0gcGkgKyA0OwogICAgICAgICAgcHNbMF0gPSB0bXAxOwogICAgICAgICAgcHNbMV0gPSBwaSArIDc7CiAgICAgICAgICBwc1syXSA9IHBpICsgNjsKICAgICAgICAgIHBzWzNdID0gcGkgKyA1OwogICAgICAgICAgdG1wMSA9IGNzWzNdOwogICAgICAgICAgY3NbMl0gPSBjc1sxXTsKICAgICAgICAgIGNzWzNdID0gY2k7CiAgICAgICAgICBjc1swXSA9IHRtcDE7CiAgICAgICAgICBjc1sxXSA9IGNpICsgMTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBwc1sxMl0gPSBwc1swXTsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgMDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzhdID0gcHNbMV07CiAgICAgICAgICBwc1sxMV0gPSBwaSArIDM7CiAgICAgICAgICBwc1s0XSA9IHBzWzJdOwogICAgICAgICAgcHNbN10gPSBwaSArIDQ7CiAgICAgICAgICBwc1swXSA9IHBzWzNdOwogICAgICAgICAgcHNbMV0gPSBwaSArIDc7CiAgICAgICAgICBwc1syXSA9IHBpICsgNjsKICAgICAgICAgIHBzWzNdID0gcGkgKyA1OwogICAgICAgICAgY3NbMl0gPSBjc1swXTsKICAgICAgICAgIGNzWzNdID0gY2k7CiAgICAgICAgICBjc1swXSA9IGNzWzFdOwogICAgICAgICAgY3NbMV0gPSBjaSArIDE7CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgcHNbNV0gPSBjb29yZHMubGVuZ3RoOwogICAgICBjb29yZHMucHVzaChbKC00ICogY29vcmRzW3BzWzBdXVswXSAtIGNvb3Jkc1twc1sxNV1dWzBdICsgNiAqIChjb29yZHNbcHNbNF1dWzBdICsgY29vcmRzW3BzWzFdXVswXSkgLSAyICogKGNvb3Jkc1twc1sxMl1dWzBdICsgY29vcmRzW3BzWzNdXVswXSkgKyAzICogKGNvb3Jkc1twc1sxM11dWzBdICsgY29vcmRzW3BzWzddXVswXSkpIC8gOSwgKC00ICogY29vcmRzW3BzWzBdXVsxXSAtIGNvb3Jkc1twc1sxNV1dWzFdICsgNiAqIChjb29yZHNbcHNbNF1dWzFdICsgY29vcmRzW3BzWzFdXVsxXSkgLSAyICogKGNvb3Jkc1twc1sxMl1dWzFdICsgY29vcmRzW3BzWzNdXVsxXSkgKyAzICogKGNvb3Jkc1twc1sxM11dWzFdICsgY29vcmRzW3BzWzddXVsxXSkpIC8gOV0pOwogICAgICBwc1s2XSA9IGNvb3Jkcy5sZW5ndGg7CiAgICAgIGNvb3Jkcy5wdXNoKFsoLTQgKiBjb29yZHNbcHNbM11dWzBdIC0gY29vcmRzW3BzWzEyXV1bMF0gKyA2ICogKGNvb3Jkc1twc1syXV1bMF0gKyBjb29yZHNbcHNbN11dWzBdKSAtIDIgKiAoY29vcmRzW3BzWzBdXVswXSArIGNvb3Jkc1twc1sxNV1dWzBdKSArIDMgKiAoY29vcmRzW3BzWzRdXVswXSArIGNvb3Jkc1twc1sxNF1dWzBdKSkgLyA5LCAoLTQgKiBjb29yZHNbcHNbM11dWzFdIC0gY29vcmRzW3BzWzEyXV1bMV0gKyA2ICogKGNvb3Jkc1twc1syXV1bMV0gKyBjb29yZHNbcHNbN11dWzFdKSAtIDIgKiAoY29vcmRzW3BzWzBdXVsxXSArIGNvb3Jkc1twc1sxNV1dWzFdKSArIDMgKiAoY29vcmRzW3BzWzRdXVsxXSArIGNvb3Jkc1twc1sxNF1dWzFdKSkgLyA5XSk7CiAgICAgIHBzWzldID0gY29vcmRzLmxlbmd0aDsKICAgICAgY29vcmRzLnB1c2goWygtNCAqIGNvb3Jkc1twc1sxMl1dWzBdIC0gY29vcmRzW3BzWzNdXVswXSArIDYgKiAoY29vcmRzW3BzWzhdXVswXSArIGNvb3Jkc1twc1sxM11dWzBdKSAtIDIgKiAoY29vcmRzW3BzWzBdXVswXSArIGNvb3Jkc1twc1sxNV1dWzBdKSArIDMgKiAoY29vcmRzW3BzWzExXV1bMF0gKyBjb29yZHNbcHNbMV1dWzBdKSkgLyA5LCAoLTQgKiBjb29yZHNbcHNbMTJdXVsxXSAtIGNvb3Jkc1twc1szXV1bMV0gKyA2ICogKGNvb3Jkc1twc1s4XV1bMV0gKyBjb29yZHNbcHNbMTNdXVsxXSkgLSAyICogKGNvb3Jkc1twc1swXV1bMV0gKyBjb29yZHNbcHNbMTVdXVsxXSkgKyAzICogKGNvb3Jkc1twc1sxMV1dWzFdICsgY29vcmRzW3BzWzFdXVsxXSkpIC8gOV0pOwogICAgICBwc1sxMF0gPSBjb29yZHMubGVuZ3RoOwogICAgICBjb29yZHMucHVzaChbKC00ICogY29vcmRzW3BzWzE1XV1bMF0gLSBjb29yZHNbcHNbMF1dWzBdICsgNiAqIChjb29yZHNbcHNbMTFdXVswXSArIGNvb3Jkc1twc1sxNF1dWzBdKSAtIDIgKiAoY29vcmRzW3BzWzEyXV1bMF0gKyBjb29yZHNbcHNbM11dWzBdKSArIDMgKiAoY29vcmRzW3BzWzJdXVswXSArIGNvb3Jkc1twc1s4XV1bMF0pKSAvIDksICgtNCAqIGNvb3Jkc1twc1sxNV1dWzFdIC0gY29vcmRzW3BzWzBdXVsxXSArIDYgKiAoY29vcmRzW3BzWzExXV1bMV0gKyBjb29yZHNbcHNbMTRdXVsxXSkgLSAyICogKGNvb3Jkc1twc1sxMl1dWzFdICsgY29vcmRzW3BzWzNdXVsxXSkgKyAzICogKGNvb3Jkc1twc1syXV1bMV0gKyBjb29yZHNbcHNbOF1dWzFdKSkgLyA5XSk7CiAgICAgIHRoaXMuZmlndXJlcy5wdXNoKHsKICAgICAgICB0eXBlOiAicGF0Y2giLAogICAgICAgIGNvb3JkczogbmV3IEludDMyQXJyYXkocHMpLAogICAgICAgIGNvbG9yczogbmV3IEludDMyQXJyYXkoY3MpCiAgICAgIH0pOwogICAgfQogIH0KCiAgX2RlY29kZVR5cGU3U2hhZGluZyhyZWFkZXIpIHsKICAgIGNvbnN0IGNvb3JkcyA9IHRoaXMuY29vcmRzOwogICAgY29uc3QgY29sb3JzID0gdGhpcy5jb2xvcnM7CiAgICBjb25zdCBwcyA9IG5ldyBJbnQzMkFycmF5KDE2KTsKICAgIGNvbnN0IGNzID0gbmV3IEludDMyQXJyYXkoNCk7CgogICAgd2hpbGUgKHJlYWRlci5oYXNEYXRhKSB7CiAgICAgIGNvbnN0IGYgPSByZWFkZXIucmVhZEZsYWcoKTsKCiAgICAgIGlmICghKDAgPD0gZiAmJiBmIDw9IDMpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbmtub3duIHR5cGU3IGZsYWciKTsKICAgICAgfQoKICAgICAgY29uc3QgcGkgPSBjb29yZHMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZiAhPT0gMCA/IDEyIDogMTY7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29vcmRzLnB1c2gocmVhZGVyLnJlYWRDb29yZGluYXRlKCkpOwogICAgICB9CgogICAgICBjb25zdCBjaSA9IGNvbG9ycy5sZW5ndGg7CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBmICE9PSAwID8gMiA6IDQ7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29sb3JzLnB1c2gocmVhZGVyLnJlYWRDb21wb25lbnRzKCkpOwogICAgICB9CgogICAgICBsZXQgdG1wMSwgdG1wMiwgdG1wMywgdG1wNDsKCiAgICAgIHN3aXRjaCAoZikgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHBzWzEyXSA9IHBpICsgMzsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgNDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgNTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgNjsKICAgICAgICAgIHBzWzhdID0gcGkgKyAyOwogICAgICAgICAgcHNbOV0gPSBwaSArIDEzOwogICAgICAgICAgcHNbMTBdID0gcGkgKyAxNDsKICAgICAgICAgIHBzWzExXSA9IHBpICsgNzsKICAgICAgICAgIHBzWzRdID0gcGkgKyAxOwogICAgICAgICAgcHNbNV0gPSBwaSArIDEyOwogICAgICAgICAgcHNbNl0gPSBwaSArIDE1OwogICAgICAgICAgcHNbN10gPSBwaSArIDg7CiAgICAgICAgICBwc1swXSA9IHBpOwogICAgICAgICAgcHNbMV0gPSBwaSArIDExOwogICAgICAgICAgcHNbMl0gPSBwaSArIDEwOwogICAgICAgICAgcHNbM10gPSBwaSArIDk7CiAgICAgICAgICBjc1syXSA9IGNpICsgMTsKICAgICAgICAgIGNzWzNdID0gY2kgKyAyOwogICAgICAgICAgY3NbMF0gPSBjaTsKICAgICAgICAgIGNzWzFdID0gY2kgKyAzOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMToKICAgICAgICAgIHRtcDEgPSBwc1sxMl07CiAgICAgICAgICB0bXAyID0gcHNbMTNdOwogICAgICAgICAgdG1wMyA9IHBzWzE0XTsKICAgICAgICAgIHRtcDQgPSBwc1sxNV07CiAgICAgICAgICBwc1sxMl0gPSB0bXA0OwogICAgICAgICAgcHNbMTNdID0gcGkgKyAwOwogICAgICAgICAgcHNbMTRdID0gcGkgKyAxOwogICAgICAgICAgcHNbMTVdID0gcGkgKyAyOwogICAgICAgICAgcHNbOF0gPSB0bXAzOwogICAgICAgICAgcHNbOV0gPSBwaSArIDk7CiAgICAgICAgICBwc1sxMF0gPSBwaSArIDEwOwogICAgICAgICAgcHNbMTFdID0gcGkgKyAzOwogICAgICAgICAgcHNbNF0gPSB0bXAyOwogICAgICAgICAgcHNbNV0gPSBwaSArIDg7CiAgICAgICAgICBwc1s2XSA9IHBpICsgMTE7CiAgICAgICAgICBwc1s3XSA9IHBpICsgNDsKICAgICAgICAgIHBzWzBdID0gdG1wMTsKICAgICAgICAgIHBzWzFdID0gcGkgKyA3OwogICAgICAgICAgcHNbMl0gPSBwaSArIDY7CiAgICAgICAgICBwc1szXSA9IHBpICsgNTsKICAgICAgICAgIHRtcDEgPSBjc1syXTsKICAgICAgICAgIHRtcDIgPSBjc1szXTsKICAgICAgICAgIGNzWzJdID0gdG1wMjsKICAgICAgICAgIGNzWzNdID0gY2k7CiAgICAgICAgICBjc1swXSA9IHRtcDE7CiAgICAgICAgICBjc1sxXSA9IGNpICsgMTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgICB0bXAxID0gcHNbMTVdOwogICAgICAgICAgdG1wMiA9IHBzWzExXTsKICAgICAgICAgIHBzWzEyXSA9IHBzWzNdOwogICAgICAgICAgcHNbMTNdID0gcGkgKyAwOwogICAgICAgICAgcHNbMTRdID0gcGkgKyAxOwogICAgICAgICAgcHNbMTVdID0gcGkgKyAyOwogICAgICAgICAgcHNbOF0gPSBwc1s3XTsKICAgICAgICAgIHBzWzldID0gcGkgKyA5OwogICAgICAgICAgcHNbMTBdID0gcGkgKyAxMDsKICAgICAgICAgIHBzWzExXSA9IHBpICsgMzsKICAgICAgICAgIHBzWzRdID0gdG1wMjsKICAgICAgICAgIHBzWzVdID0gcGkgKyA4OwogICAgICAgICAgcHNbNl0gPSBwaSArIDExOwogICAgICAgICAgcHNbN10gPSBwaSArIDQ7CiAgICAgICAgICBwc1swXSA9IHRtcDE7CiAgICAgICAgICBwc1sxXSA9IHBpICsgNzsKICAgICAgICAgIHBzWzJdID0gcGkgKyA2OwogICAgICAgICAgcHNbM10gPSBwaSArIDU7CiAgICAgICAgICB0bXAxID0gY3NbM107CiAgICAgICAgICBjc1syXSA9IGNzWzFdOwogICAgICAgICAgY3NbM10gPSBjaTsKICAgICAgICAgIGNzWzBdID0gdG1wMTsKICAgICAgICAgIGNzWzFdID0gY2kgKyAxOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMzoKICAgICAgICAgIHBzWzEyXSA9IHBzWzBdOwogICAgICAgICAgcHNbMTNdID0gcGkgKyAwOwogICAgICAgICAgcHNbMTRdID0gcGkgKyAxOwogICAgICAgICAgcHNbMTVdID0gcGkgKyAyOwogICAgICAgICAgcHNbOF0gPSBwc1sxXTsKICAgICAgICAgIHBzWzldID0gcGkgKyA5OwogICAgICAgICAgcHNbMTBdID0gcGkgKyAxMDsKICAgICAgICAgIHBzWzExXSA9IHBpICsgMzsKICAgICAgICAgIHBzWzRdID0gcHNbMl07CiAgICAgICAgICBwc1s1XSA9IHBpICsgODsKICAgICAgICAgIHBzWzZdID0gcGkgKyAxMTsKICAgICAgICAgIHBzWzddID0gcGkgKyA0OwogICAgICAgICAgcHNbMF0gPSBwc1szXTsKICAgICAgICAgIHBzWzFdID0gcGkgKyA3OwogICAgICAgICAgcHNbMl0gPSBwaSArIDY7CiAgICAgICAgICBwc1szXSA9IHBpICsgNTsKICAgICAgICAgIGNzWzJdID0gY3NbMF07CiAgICAgICAgICBjc1szXSA9IGNpOwogICAgICAgICAgY3NbMF0gPSBjc1sxXTsKICAgICAgICAgIGNzWzFdID0gY2kgKyAxOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHRoaXMuZmlndXJlcy5wdXNoKHsKICAgICAgICB0eXBlOiAicGF0Y2giLAogICAgICAgIGNvb3JkczogbmV3IEludDMyQXJyYXkocHMpLAogICAgICAgIGNvbG9yczogbmV3IEludDMyQXJyYXkoY3MpCiAgICAgIH0pOwogICAgfQogIH0KCiAgX2J1aWxkRmlndXJlRnJvbVBhdGNoKGluZGV4KSB7CiAgICBjb25zdCBmaWd1cmUgPSB0aGlzLmZpZ3VyZXNbaW5kZXhdOwogICAgKDAsIF91dGlsLmFzc2VydCkoZmlndXJlLnR5cGUgPT09ICJwYXRjaCIsICJVbmV4cGVjdGVkIHBhdGNoIG1lc2ggZmlndXJlIik7CiAgICBjb25zdCBjb29yZHMgPSB0aGlzLmNvb3JkcywKICAgICAgICAgIGNvbG9ycyA9IHRoaXMuY29sb3JzOwogICAgY29uc3QgcGkgPSBmaWd1cmUuY29vcmRzOwogICAgY29uc3QgY2kgPSBmaWd1cmUuY29sb3JzOwogICAgY29uc3QgZmlndXJlTWluWCA9IE1hdGgubWluKGNvb3Jkc1twaVswXV1bMF0sIGNvb3Jkc1twaVszXV1bMF0sIGNvb3Jkc1twaVsxMl1dWzBdLCBjb29yZHNbcGlbMTVdXVswXSk7CiAgICBjb25zdCBmaWd1cmVNaW5ZID0gTWF0aC5taW4oY29vcmRzW3BpWzBdXVsxXSwgY29vcmRzW3BpWzNdXVsxXSwgY29vcmRzW3BpWzEyXV1bMV0sIGNvb3Jkc1twaVsxNV1dWzFdKTsKICAgIGNvbnN0IGZpZ3VyZU1heFggPSBNYXRoLm1heChjb29yZHNbcGlbMF1dWzBdLCBjb29yZHNbcGlbM11dWzBdLCBjb29yZHNbcGlbMTJdXVswXSwgY29vcmRzW3BpWzE1XV1bMF0pOwogICAgY29uc3QgZmlndXJlTWF4WSA9IE1hdGgubWF4KGNvb3Jkc1twaVswXV1bMV0sIGNvb3Jkc1twaVszXV1bMV0sIGNvb3Jkc1twaVsxMl1dWzFdLCBjb29yZHNbcGlbMTVdXVsxXSk7CiAgICBsZXQgc3BsaXRYQnkgPSBNYXRoLmNlaWwoKGZpZ3VyZU1heFggLSBmaWd1cmVNaW5YKSAqIE1lc2hTaGFkaW5nLlRSSUFOR0xFX0RFTlNJVFkgLyAodGhpcy5ib3VuZHNbMl0gLSB0aGlzLmJvdW5kc1swXSkpOwogICAgc3BsaXRYQnkgPSBNYXRoLm1heChNZXNoU2hhZGluZy5NSU5fU1BMSVRfUEFUQ0hfQ0hVTktTX0FNT1VOVCwgTWF0aC5taW4oTWVzaFNoYWRpbmcuTUFYX1NQTElUX1BBVENIX0NIVU5LU19BTU9VTlQsIHNwbGl0WEJ5KSk7CiAgICBsZXQgc3BsaXRZQnkgPSBNYXRoLmNlaWwoKGZpZ3VyZU1heFkgLSBmaWd1cmVNaW5ZKSAqIE1lc2hTaGFkaW5nLlRSSUFOR0xFX0RFTlNJVFkgLyAodGhpcy5ib3VuZHNbM10gLSB0aGlzLmJvdW5kc1sxXSkpOwogICAgc3BsaXRZQnkgPSBNYXRoLm1heChNZXNoU2hhZGluZy5NSU5fU1BMSVRfUEFUQ0hfQ0hVTktTX0FNT1VOVCwgTWF0aC5taW4oTWVzaFNoYWRpbmcuTUFYX1NQTElUX1BBVENIX0NIVU5LU19BTU9VTlQsIHNwbGl0WUJ5KSk7CiAgICBjb25zdCB2ZXJ0aWNlc1BlclJvdyA9IHNwbGl0WEJ5ICsgMTsKICAgIGNvbnN0IGZpZ3VyZUNvb3JkcyA9IG5ldyBJbnQzMkFycmF5KChzcGxpdFlCeSArIDEpICogdmVydGljZXNQZXJSb3cpOwogICAgY29uc3QgZmlndXJlQ29sb3JzID0gbmV3IEludDMyQXJyYXkoKHNwbGl0WUJ5ICsgMSkgKiB2ZXJ0aWNlc1BlclJvdyk7CiAgICBsZXQgayA9IDA7CiAgICBjb25zdCBjbCA9IG5ldyBVaW50OEFycmF5KDMpLAogICAgICAgICAgY3IgPSBuZXcgVWludDhBcnJheSgzKTsKICAgIGNvbnN0IGMwID0gY29sb3JzW2NpWzBdXSwKICAgICAgICAgIGMxID0gY29sb3JzW2NpWzFdXSwKICAgICAgICAgIGMyID0gY29sb3JzW2NpWzJdXSwKICAgICAgICAgIGMzID0gY29sb3JzW2NpWzNdXTsKICAgIGNvbnN0IGJSb3cgPSBnZXRCKHNwbGl0WUJ5KSwKICAgICAgICAgIGJDb2wgPSBnZXRCKHNwbGl0WEJ5KTsKCiAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPD0gc3BsaXRZQnk7IHJvdysrKSB7CiAgICAgIGNsWzBdID0gKGMwWzBdICogKHNwbGl0WUJ5IC0gcm93KSArIGMyWzBdICogcm93KSAvIHNwbGl0WUJ5IHwgMDsKICAgICAgY2xbMV0gPSAoYzBbMV0gKiAoc3BsaXRZQnkgLSByb3cpICsgYzJbMV0gKiByb3cpIC8gc3BsaXRZQnkgfCAwOwogICAgICBjbFsyXSA9IChjMFsyXSAqIChzcGxpdFlCeSAtIHJvdykgKyBjMlsyXSAqIHJvdykgLyBzcGxpdFlCeSB8IDA7CiAgICAgIGNyWzBdID0gKGMxWzBdICogKHNwbGl0WUJ5IC0gcm93KSArIGMzWzBdICogcm93KSAvIHNwbGl0WUJ5IHwgMDsKICAgICAgY3JbMV0gPSAoYzFbMV0gKiAoc3BsaXRZQnkgLSByb3cpICsgYzNbMV0gKiByb3cpIC8gc3BsaXRZQnkgfCAwOwogICAgICBjclsyXSA9IChjMVsyXSAqIChzcGxpdFlCeSAtIHJvdykgKyBjM1syXSAqIHJvdykgLyBzcGxpdFlCeSB8IDA7CgogICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPD0gc3BsaXRYQnk7IGNvbCsrLCBrKyspIHsKICAgICAgICBpZiAoKHJvdyA9PT0gMCB8fCByb3cgPT09IHNwbGl0WUJ5KSAmJiAoY29sID09PSAwIHx8IGNvbCA9PT0gc3BsaXRYQnkpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGxldCB4ID0gMCwKICAgICAgICAgICAgeSA9IDA7CiAgICAgICAgbGV0IHEgPSAwOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSAzOyBpKyspIHsKICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDw9IDM7IGorKywgcSsrKSB7CiAgICAgICAgICAgIGNvbnN0IG0gPSBiUm93W3Jvd11baV0gKiBiQ29sW2NvbF1bal07CiAgICAgICAgICAgIHggKz0gY29vcmRzW3BpW3FdXVswXSAqIG07CiAgICAgICAgICAgIHkgKz0gY29vcmRzW3BpW3FdXVsxXSAqIG07CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmaWd1cmVDb29yZHNba10gPSBjb29yZHMubGVuZ3RoOwogICAgICAgIGNvb3Jkcy5wdXNoKFt4LCB5XSk7CiAgICAgICAgZmlndXJlQ29sb3JzW2tdID0gY29sb3JzLmxlbmd0aDsKICAgICAgICBjb25zdCBuZXdDb2xvciA9IG5ldyBVaW50OEFycmF5KDMpOwogICAgICAgIG5ld0NvbG9yWzBdID0gKGNsWzBdICogKHNwbGl0WEJ5IC0gY29sKSArIGNyWzBdICogY29sKSAvIHNwbGl0WEJ5IHwgMDsKICAgICAgICBuZXdDb2xvclsxXSA9IChjbFsxXSAqIChzcGxpdFhCeSAtIGNvbCkgKyBjclsxXSAqIGNvbCkgLyBzcGxpdFhCeSB8IDA7CiAgICAgICAgbmV3Q29sb3JbMl0gPSAoY2xbMl0gKiAoc3BsaXRYQnkgLSBjb2wpICsgY3JbMl0gKiBjb2wpIC8gc3BsaXRYQnkgfCAwOwogICAgICAgIGNvbG9ycy5wdXNoKG5ld0NvbG9yKTsKICAgICAgfQogICAgfQoKICAgIGZpZ3VyZUNvb3Jkc1swXSA9IHBpWzBdOwogICAgZmlndXJlQ29sb3JzWzBdID0gY2lbMF07CiAgICBmaWd1cmVDb29yZHNbc3BsaXRYQnldID0gcGlbM107CiAgICBmaWd1cmVDb2xvcnNbc3BsaXRYQnldID0gY2lbMV07CiAgICBmaWd1cmVDb29yZHNbdmVydGljZXNQZXJSb3cgKiBzcGxpdFlCeV0gPSBwaVsxMl07CiAgICBmaWd1cmVDb2xvcnNbdmVydGljZXNQZXJSb3cgKiBzcGxpdFlCeV0gPSBjaVsyXTsKICAgIGZpZ3VyZUNvb3Jkc1t2ZXJ0aWNlc1BlclJvdyAqIHNwbGl0WUJ5ICsgc3BsaXRYQnldID0gcGlbMTVdOwogICAgZmlndXJlQ29sb3JzW3ZlcnRpY2VzUGVyUm93ICogc3BsaXRZQnkgKyBzcGxpdFhCeV0gPSBjaVszXTsKICAgIHRoaXMuZmlndXJlc1tpbmRleF0gPSB7CiAgICAgIHR5cGU6ICJsYXR0aWNlIiwKICAgICAgY29vcmRzOiBmaWd1cmVDb29yZHMsCiAgICAgIGNvbG9yczogZmlndXJlQ29sb3JzLAogICAgICB2ZXJ0aWNlc1BlclJvdwogICAgfTsKICB9CgogIF91cGRhdGVCb3VuZHMoKSB7CiAgICBsZXQgbWluWCA9IHRoaXMuY29vcmRzWzBdWzBdLAogICAgICAgIG1pblkgPSB0aGlzLmNvb3Jkc1swXVsxXSwKICAgICAgICBtYXhYID0gbWluWCwKICAgICAgICBtYXhZID0gbWluWTsKCiAgICBmb3IgKGxldCBpID0gMSwgaWkgPSB0aGlzLmNvb3Jkcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLmNvb3Jkc1tpXVswXSwKICAgICAgICAgICAgeSA9IHRoaXMuY29vcmRzW2ldWzFdOwogICAgICBtaW5YID0gbWluWCA+IHggPyB4IDogbWluWDsKICAgICAgbWluWSA9IG1pblkgPiB5ID8geSA6IG1pblk7CiAgICAgIG1heFggPSBtYXhYIDwgeCA/IHggOiBtYXhYOwogICAgICBtYXhZID0gbWF4WSA8IHkgPyB5IDogbWF4WTsKICAgIH0KCiAgICB0aGlzLmJvdW5kcyA9IFttaW5YLCBtaW5ZLCBtYXhYLCBtYXhZXTsKICB9CgogIF9wYWNrRGF0YSgpIHsKICAgIGxldCBpLCBpaSwgaiwgamo7CiAgICBjb25zdCBjb29yZHMgPSB0aGlzLmNvb3JkczsKICAgIGNvbnN0IGNvb3Jkc1BhY2tlZCA9IG5ldyBGbG9hdDMyQXJyYXkoY29vcmRzLmxlbmd0aCAqIDIpOwoKICAgIGZvciAoaSA9IDAsIGogPSAwLCBpaSA9IGNvb3Jkcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IHh5ID0gY29vcmRzW2ldOwogICAgICBjb29yZHNQYWNrZWRbaisrXSA9IHh5WzBdOwogICAgICBjb29yZHNQYWNrZWRbaisrXSA9IHh5WzFdOwogICAgfQoKICAgIHRoaXMuY29vcmRzID0gY29vcmRzUGFja2VkOwogICAgY29uc3QgY29sb3JzID0gdGhpcy5jb2xvcnM7CiAgICBjb25zdCBjb2xvcnNQYWNrZWQgPSBuZXcgVWludDhBcnJheShjb2xvcnMubGVuZ3RoICogMyk7CgogICAgZm9yIChpID0gMCwgaiA9IDAsIGlpID0gY29sb3JzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgY29uc3QgYyA9IGNvbG9yc1tpXTsKICAgICAgY29sb3JzUGFja2VkW2orK10gPSBjWzBdOwogICAgICBjb2xvcnNQYWNrZWRbaisrXSA9IGNbMV07CiAgICAgIGNvbG9yc1BhY2tlZFtqKytdID0gY1syXTsKICAgIH0KCiAgICB0aGlzLmNvbG9ycyA9IGNvbG9yc1BhY2tlZDsKICAgIGNvbnN0IGZpZ3VyZXMgPSB0aGlzLmZpZ3VyZXM7CgogICAgZm9yIChpID0gMCwgaWkgPSBmaWd1cmVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgY29uc3QgZmlndXJlID0gZmlndXJlc1tpXSwKICAgICAgICAgICAgcHMgPSBmaWd1cmUuY29vcmRzLAogICAgICAgICAgICBjcyA9IGZpZ3VyZS5jb2xvcnM7CgogICAgICBmb3IgKGogPSAwLCBqaiA9IHBzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICBwc1tqXSAqPSAyOwogICAgICAgIGNzW2pdICo9IDM7CiAgICAgIH0KICAgIH0KICB9CgogIGdldElSKCkgewogICAgcmV0dXJuIFsiTWVzaCIsIHRoaXMuc2hhZGluZ1R5cGUsIHRoaXMuY29vcmRzLCB0aGlzLmNvbG9ycywgdGhpcy5maWd1cmVzLCB0aGlzLmJvdW5kcywgdGhpcy5iYm94LCB0aGlzLmJhY2tncm91bmRdOwogIH0KCn0KCmNsYXNzIER1bW15U2hhZGluZyBleHRlbmRzIEJhc2VTaGFkaW5nIHsKICBnZXRJUigpIHsKICAgIHJldHVybiBbIkR1bW15Il07CiAgfQoKfQoKZnVuY3Rpb24gZ2V0VGlsaW5nUGF0dGVybklSKG9wZXJhdG9yTGlzdCwgZGljdCwgY29sb3IpIHsKICBjb25zdCBtYXRyaXggPSBkaWN0LmdldEFycmF5KCJNYXRyaXgiKTsKCiAgY29uc3QgYmJveCA9IF91dGlsLlV0aWwubm9ybWFsaXplUmVjdChkaWN0LmdldEFycmF5KCJCQm94IikpOwoKICBjb25zdCB4c3RlcCA9IGRpY3QuZ2V0KCJYU3RlcCIpOwogIGNvbnN0IHlzdGVwID0gZGljdC5nZXQoIllTdGVwIik7CiAgY29uc3QgcGFpbnRUeXBlID0gZGljdC5nZXQoIlBhaW50VHlwZSIpOwogIGNvbnN0IHRpbGluZ1R5cGUgPSBkaWN0LmdldCgiVGlsaW5nVHlwZSIpOwoKICBpZiAoYmJveFsyXSAtIGJib3hbMF0gPT09IDAgfHwgYmJveFszXSAtIGJib3hbMV0gPT09IDApIHsKICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW52YWxpZCBnZXRUaWxpbmdQYXR0ZXJuSVIgL0JCb3ggYXJyYXk6IFske2Jib3h9XS5gKTsKICB9CgogIHJldHVybiBbIlRpbGluZ1BhdHRlcm4iLCBjb2xvciwgb3BlcmF0b3JMaXN0LCBtYXRyaXgsIGJib3gsIHhzdGVwLCB5c3RlcCwgcGFpbnRUeXBlLCB0aWxpbmdUeXBlXTsKfQoKLyoqKi8gfSksCi8qIDE3NiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuZ2V0WGZhRm9udERpY3QgPSBnZXRYZmFGb250RGljdDsKZXhwb3J0cy5nZXRYZmFGb250TmFtZSA9IGdldFhmYUZvbnROYW1lOwoKdmFyIF9jYWxpYnJpX2ZhY3RvcnMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3Nyk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMCk7Cgp2YXIgX2hlbHZldGljYV9mYWN0b3JzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzgpOwoKdmFyIF9saWJlcmF0aW9uc2Fuc193aWR0aHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3OSk7Cgp2YXIgX215cmlhZHByb19mYWN0b3JzID0gX193X3BkZmpzX3JlcXVpcmVfXygxODApOwoKdmFyIF9zZWdvZXVpX2ZhY3RvcnMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE4MSk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX2ZvbnRzX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjMpOwoKY29uc3QgZ2V0WEZBRm9udE1hcCA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgdFsiTXlyaWFkUHJvLVJlZ3VsYXIiXSA9IHRbIlBkZkpTLUZhbGxiYWNrLVJlZ3VsYXIiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1SZWd1bGFyIiwKICAgIGZhY3RvcnM6IF9teXJpYWRwcm9fZmFjdG9ycy5NeXJpYWRQcm9SZWd1bGFyRmFjdG9ycywKICAgIGJhc2VXaWR0aHM6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNSZWd1bGFyV2lkdGhzLAogICAgYmFzZU1hcHBpbmc6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNSZWd1bGFyTWFwcGluZywKICAgIG1ldHJpY3M6IF9teXJpYWRwcm9fZmFjdG9ycy5NeXJpYWRQcm9SZWd1bGFyTWV0cmljcwogIH07CiAgdFsiTXlyaWFkUHJvLUJvbGQiXSA9IHRbIlBkZkpTLUZhbGxiYWNrLUJvbGQiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1Cb2xkIiwKICAgIGZhY3RvcnM6IF9teXJpYWRwcm9fZmFjdG9ycy5NeXJpYWRQcm9Cb2xkRmFjdG9ycywKICAgIGJhc2VXaWR0aHM6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNCb2xkV2lkdGhzLAogICAgYmFzZU1hcHBpbmc6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNCb2xkTWFwcGluZywKICAgIG1ldHJpY3M6IF9teXJpYWRwcm9fZmFjdG9ycy5NeXJpYWRQcm9Cb2xkTWV0cmljcwogIH07CiAgdFsiTXlyaWFkUHJvLUl0Il0gPSB0WyJNeXJpYWRQcm8tSXRhbGljIl0gPSB0WyJQZGZKUy1GYWxsYmFjay1JdGFsaWMiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1JdGFsaWMiLAogICAgZmFjdG9yczogX215cmlhZHByb19mYWN0b3JzLk15cmlhZFByb0l0YWxpY0ZhY3RvcnMsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zSXRhbGljV2lkdGhzLAogICAgYmFzZU1hcHBpbmc6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNJdGFsaWNNYXBwaW5nLAogICAgbWV0cmljczogX215cmlhZHByb19mYWN0b3JzLk15cmlhZFByb0l0YWxpY01ldHJpY3MKICB9OwogIHRbIk15cmlhZFByby1Cb2xkSXQiXSA9IHRbIk15cmlhZFByby1Cb2xkSXRhbGljIl0gPSB0WyJQZGZKUy1GYWxsYmFjay1Cb2xkSXRhbGljIl0gPSB7CiAgICBuYW1lOiAiTGliZXJhdGlvblNhbnMtQm9sZEl0YWxpYyIsCiAgICBmYWN0b3JzOiBfbXlyaWFkcHJvX2ZhY3RvcnMuTXlyaWFkUHJvQm9sZEl0YWxpY0ZhY3RvcnMsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZEl0YWxpY1dpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZEl0YWxpY01hcHBpbmcsCiAgICBtZXRyaWNzOiBfbXlyaWFkcHJvX2ZhY3RvcnMuTXlyaWFkUHJvQm9sZEl0YWxpY01ldHJpY3MKICB9OwogIHQuQXJpYWxNVCA9IHQuQXJpYWwgPSB0WyJBcmlhbC1SZWd1bGFyIl0gPSB7CiAgICBuYW1lOiAiTGliZXJhdGlvblNhbnMtUmVndWxhciIsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zUmVndWxhcldpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zUmVndWxhck1hcHBpbmcKICB9OwogIHRbIkFyaWFsLUJvbGRNVCJdID0gdFsiQXJpYWwtQm9sZCJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGQiLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRNYXBwaW5nCiAgfTsKICB0WyJBcmlhbC1JdGFsaWNNVCJdID0gdFsiQXJpYWwtSXRhbGljIl0gPSB7CiAgICBuYW1lOiAiTGliZXJhdGlvblNhbnMtSXRhbGljIiwKICAgIGJhc2VXaWR0aHM6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNJdGFsaWNXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0l0YWxpY01hcHBpbmcKICB9OwogIHRbIkFyaWFsLUJvbGRJdGFsaWNNVCJdID0gdFsiQXJpYWwtQm9sZEl0YWxpYyJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGRJdGFsaWMiLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNNYXBwaW5nCiAgfTsKICB0WyJDYWxpYnJpLVJlZ3VsYXIiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1SZWd1bGFyIiwKICAgIGZhY3RvcnM6IF9jYWxpYnJpX2ZhY3RvcnMuQ2FsaWJyaVJlZ3VsYXJGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJNYXBwaW5nLAogICAgbWV0cmljczogX2NhbGlicmlfZmFjdG9ycy5DYWxpYnJpUmVndWxhck1ldHJpY3MKICB9OwogIHRbIkNhbGlicmktQm9sZCJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGQiLAogICAgZmFjdG9yczogX2NhbGlicmlfZmFjdG9ycy5DYWxpYnJpQm9sZEZhY3RvcnMsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZFdpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZE1hcHBpbmcsCiAgICBtZXRyaWNzOiBfY2FsaWJyaV9mYWN0b3JzLkNhbGlicmlCb2xkTWV0cmljcwogIH07CiAgdFsiQ2FsaWJyaS1JdGFsaWMiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1JdGFsaWMiLAogICAgZmFjdG9yczogX2NhbGlicmlfZmFjdG9ycy5DYWxpYnJpSXRhbGljRmFjdG9ycywKICAgIGJhc2VXaWR0aHM6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNJdGFsaWNXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0l0YWxpY01hcHBpbmcsCiAgICBtZXRyaWNzOiBfY2FsaWJyaV9mYWN0b3JzLkNhbGlicmlJdGFsaWNNZXRyaWNzCiAgfTsKICB0WyJDYWxpYnJpLUJvbGRJdGFsaWMiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1Cb2xkSXRhbGljIiwKICAgIGZhY3RvcnM6IF9jYWxpYnJpX2ZhY3RvcnMuQ2FsaWJyaUJvbGRJdGFsaWNGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNNYXBwaW5nLAogICAgbWV0cmljczogX2NhbGlicmlfZmFjdG9ycy5DYWxpYnJpQm9sZEl0YWxpY01ldHJpY3MKICB9OwogIHRbIlNlZ29ldWktUmVndWxhciJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLVJlZ3VsYXIiLAogICAgZmFjdG9yczogX3NlZ29ldWlfZmFjdG9ycy5TZWdvZXVpUmVndWxhckZhY3RvcnMsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zUmVndWxhcldpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zUmVndWxhck1hcHBpbmcsCiAgICBtZXRyaWNzOiBfc2Vnb2V1aV9mYWN0b3JzLlNlZ29ldWlSZWd1bGFyTWV0cmljcwogIH07CiAgdFsiU2Vnb2V1aS1Cb2xkIl0gPSB7CiAgICBuYW1lOiAiTGliZXJhdGlvblNhbnMtQm9sZCIsCiAgICBmYWN0b3JzOiBfc2Vnb2V1aV9mYWN0b3JzLlNlZ29ldWlCb2xkRmFjdG9ycywKICAgIGJhc2VXaWR0aHM6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNCb2xkV2lkdGhzLAogICAgYmFzZU1hcHBpbmc6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNCb2xkTWFwcGluZywKICAgIG1ldHJpY3M6IF9zZWdvZXVpX2ZhY3RvcnMuU2Vnb2V1aUJvbGRNZXRyaWNzCiAgfTsKICB0WyJTZWdvZXVpLUl0YWxpYyJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUl0YWxpYyIsCiAgICBmYWN0b3JzOiBfc2Vnb2V1aV9mYWN0b3JzLlNlZ29ldWlJdGFsaWNGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0l0YWxpY1dpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zSXRhbGljTWFwcGluZywKICAgIG1ldHJpY3M6IF9zZWdvZXVpX2ZhY3RvcnMuU2Vnb2V1aUl0YWxpY01ldHJpY3MKICB9OwogIHRbIlNlZ29ldWktQm9sZEl0YWxpYyJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGRJdGFsaWMiLAogICAgZmFjdG9yczogX3NlZ29ldWlfZmFjdG9ycy5TZWdvZXVpQm9sZEl0YWxpY0ZhY3RvcnMsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZEl0YWxpY1dpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZEl0YWxpY01hcHBpbmcsCiAgICBtZXRyaWNzOiBfc2Vnb2V1aV9mYWN0b3JzLlNlZ29ldWlCb2xkSXRhbGljTWV0cmljcwogIH07CiAgdFsiSGVsdmV0aWNhLVJlZ3VsYXIiXSA9IHQuSGVsdmV0aWNhID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLVJlZ3VsYXIiLAogICAgZmFjdG9yczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYVJlZ3VsYXJGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJNYXBwaW5nLAogICAgbWV0cmljczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYVJlZ3VsYXJNZXRyaWNzCiAgfTsKICB0WyJIZWx2ZXRpY2EtQm9sZCJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGQiLAogICAgZmFjdG9yczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYUJvbGRGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRNYXBwaW5nLAogICAgbWV0cmljczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYUJvbGRNZXRyaWNzCiAgfTsKICB0WyJIZWx2ZXRpY2EtSXRhbGljIl0gPSB7CiAgICBuYW1lOiAiTGliZXJhdGlvblNhbnMtSXRhbGljIiwKICAgIGZhY3RvcnM6IF9oZWx2ZXRpY2FfZmFjdG9ycy5IZWx2ZXRpY2FJdGFsaWNGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0l0YWxpY1dpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zSXRhbGljTWFwcGluZywKICAgIG1ldHJpY3M6IF9oZWx2ZXRpY2FfZmFjdG9ycy5IZWx2ZXRpY2FJdGFsaWNNZXRyaWNzCiAgfTsKICB0WyJIZWx2ZXRpY2EtQm9sZEl0YWxpYyJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGRJdGFsaWMiLAogICAgZmFjdG9yczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYUJvbGRJdGFsaWNGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNNYXBwaW5nLAogICAgbWV0cmljczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYUJvbGRJdGFsaWNNZXRyaWNzCiAgfTsKfSk7CgpmdW5jdGlvbiBnZXRYZmFGb250TmFtZShuYW1lKSB7CiAgY29uc3QgZm9udE5hbWUgPSAoMCwgX2ZvbnRzX3V0aWxzLm5vcm1hbGl6ZUZvbnROYW1lKShuYW1lKTsKICBjb25zdCBmb250TWFwID0gZ2V0WEZBRm9udE1hcCgpOwogIHJldHVybiBmb250TWFwW2ZvbnROYW1lXTsKfQoKZnVuY3Rpb24gZ2V0WGZhRm9udFdpZHRocyhuYW1lKSB7CiAgY29uc3QgaW5mbyA9IGdldFhmYUZvbnROYW1lKG5hbWUpOwoKICBpZiAoIWluZm8pIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgY29uc3QgewogICAgYmFzZVdpZHRocywKICAgIGJhc2VNYXBwaW5nLAogICAgZmFjdG9ycwogIH0gPSBpbmZvOwogIGxldCByZXNjYWxlZEJhc2VXaWR0aHM7CgogIGlmICghZmFjdG9ycykgewogICAgcmVzY2FsZWRCYXNlV2lkdGhzID0gYmFzZVdpZHRoczsKICB9IGVsc2UgewogICAgcmVzY2FsZWRCYXNlV2lkdGhzID0gYmFzZVdpZHRocy5tYXAoKHcsIGkpID0+IHcgKiBmYWN0b3JzW2ldKTsKICB9CgogIGxldCBjdXJyZW50Q29kZSA9IC0yOwogIGxldCBjdXJyZW50QXJyYXk7CiAgY29uc3QgbmV3V2lkdGhzID0gW107CgogIGZvciAoY29uc3QgW3VuaWNvZGUsIGdseXBoSW5kZXhdIG9mIGJhc2VNYXBwaW5nLm1hcCgoY2hhclVuaWNvZGUsIGluZGV4KSA9PiBbY2hhclVuaWNvZGUsIGluZGV4XSkuc29ydCgoX3JlZiwgX3JlZjIpID0+IHsKICAgIGxldCBbdW5pY29kZTFdID0gX3JlZjsKICAgIGxldCBbdW5pY29kZTJdID0gX3JlZjI7CiAgICByZXR1cm4gdW5pY29kZTEgLSB1bmljb2RlMjsKICB9KSkgewogICAgaWYgKHVuaWNvZGUgPT09IC0xKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGlmICh1bmljb2RlID09PSBjdXJyZW50Q29kZSArIDEpIHsKICAgICAgY3VycmVudEFycmF5LnB1c2gocmVzY2FsZWRCYXNlV2lkdGhzW2dseXBoSW5kZXhdKTsKICAgICAgY3VycmVudENvZGUgKz0gMTsKICAgIH0gZWxzZSB7CiAgICAgIGN1cnJlbnRDb2RlID0gdW5pY29kZTsKICAgICAgY3VycmVudEFycmF5ID0gW3Jlc2NhbGVkQmFzZVdpZHRoc1tnbHlwaEluZGV4XV07CiAgICAgIG5ld1dpZHRocy5wdXNoKHVuaWNvZGUsIGN1cnJlbnRBcnJheSk7CiAgICB9CiAgfQoKICByZXR1cm4gbmV3V2lkdGhzOwp9CgpmdW5jdGlvbiBnZXRYZmFGb250RGljdChuYW1lKSB7CiAgY29uc3Qgd2lkdGhzID0gZ2V0WGZhRm9udFdpZHRocyhuYW1lKTsKICBjb25zdCBkaWN0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QobnVsbCk7CiAgZGljdC5zZXQoIkJhc2VGb250IiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQobmFtZSkpOwogIGRpY3Quc2V0KCJUeXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZvbnQiKSk7CiAgZGljdC5zZXQoIlN1YnR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiQ0lERm9udFR5cGUyIikpOwogIGRpY3Quc2V0KCJFbmNvZGluZyIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJJZGVudGl0eS1IIikpOwogIGRpY3Quc2V0KCJDSURUb0dJRE1hcCIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJJZGVudGl0eSIpKTsKICBkaWN0LnNldCgiVyIsIHdpZHRocyk7CiAgZGljdC5zZXQoIkZpcnN0Q2hhciIsIHdpZHRoc1swXSk7CiAgZGljdC5zZXQoIkxhc3RDaGFyIiwgd2lkdGhzLmF0KC0yKSArIHdpZHRocy5hdCgtMSkubGVuZ3RoIC0gMSk7CiAgY29uc3QgZGVzY3JpcHRvciA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KG51bGwpOwogIGRpY3Quc2V0KCJGb250RGVzY3JpcHRvciIsIGRlc2NyaXB0b3IpOwogIGNvbnN0IHN5c3RlbUluZm8gPSBuZXcgX3ByaW1pdGl2ZXMuRGljdChudWxsKTsKICBzeXN0ZW1JbmZvLnNldCgiT3JkZXJpbmciLCAiSWRlbnRpdHkiKTsKICBzeXN0ZW1JbmZvLnNldCgiUmVnaXN0cnkiLCAiQWRvYmUiKTsKICBzeXN0ZW1JbmZvLnNldCgiU3VwcGxlbWVudCIsIDApOwogIGRpY3Quc2V0KCJDSURTeXN0ZW1JbmZvIiwgc3lzdGVtSW5mbyk7CiAgcmV0dXJuIGRpY3Q7Cn0KCi8qKiovIH0pLAovKiAxNzcgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkNhbGlicmlSZWd1bGFyTWV0cmljcyA9IGV4cG9ydHMuQ2FsaWJyaVJlZ3VsYXJGYWN0b3JzID0gZXhwb3J0cy5DYWxpYnJpSXRhbGljTWV0cmljcyA9IGV4cG9ydHMuQ2FsaWJyaUl0YWxpY0ZhY3RvcnMgPSBleHBvcnRzLkNhbGlicmlCb2xkTWV0cmljcyA9IGV4cG9ydHMuQ2FsaWJyaUJvbGRJdGFsaWNNZXRyaWNzID0gZXhwb3J0cy5DYWxpYnJpQm9sZEl0YWxpY0ZhY3RvcnMgPSBleHBvcnRzLkNhbGlicmlCb2xkRmFjdG9ycyA9IHZvaWQgMDsKY29uc3QgQ2FsaWJyaUJvbGRGYWN0b3JzID0gWzEuMzg3NywgMSwgMSwgMSwgMC45NzgwMSwgMC45MjQ4MiwgMC44OTU1MiwgMC45MTEzMywgMC44MTk4OCwgMC45NzU2NiwgMC45ODE1MiwgMC45MzU0OCwgMC45MzU0OCwgMS4yNzk4LCAwLjg1Mjg0LCAwLjkyNzk0LCAxLCAwLjk2MTM0LCAxLjU0NjU3LCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjgyODQ1LCAwLjgyODQ1LCAwLjg1Mjg0LCAwLjg1Mjg0LCAwLjg1Mjg0LCAwLjc1ODU5LCAwLjkyMTM4LCAwLjgzOTA4LCAwLjc3NjIsIDAuNzMyOTMsIDAuODcyODksIDAuNzMxMzMsIDAuNzUxNCwgMC44MTkyMSwgMC44NzM1NiwgMC45NTk1OCwgMC41OTUyNiwgMC43NTcyNywgMC42OTIyNSwgMS4wNDkyNCwgMC45MTIxLCAwLjg2OTQzLCAwLjc5Nzk1LCAwLjg4MTk4LCAwLjc3OTU4LCAwLjcwODY0LCAwLjgxMDU1LCAwLjkwMzk5LCAwLjg4NjUzLCAwLjk2MDE3LCAwLjgyNTc3LCAwLjc3ODkyLCAwLjc4MjU3LCAwLjk3NTA3LCAxLjU0NjU3LCAwLjk3NTA3LCAwLjg1Mjg0LCAwLjg5NTUyLCAwLjkwMTc2LCAwLjg4NzYyLCAwLjg3ODUsIDAuNzUyNDEsIDAuODc4NSwgMC45MDUxOCwgMC45NTAxNSwgMC43NzYxOCwgMC44Nzg1LCAwLjg4NDAxLCAwLjkxOTE2LCAwLjg2MzA0LCAwLjg4NDAxLCAwLjkxNDg4LCAwLjg3ODUsIDAuODgwMSwgMC44Nzg1LCAwLjg3ODUsIDAuOTEzNDMsIDAuNzE3MywgMS4wNDEwNiwgMC44Nzg1LCAwLjg1MDc1LCAwLjk1Nzk0LCAwLjgyNjE2LCAwLjg1MTYyLCAwLjc5NDkyLCAwLjg4MzMxLCAxLjY5ODA4LCAwLjg4MzMxLCAwLjg1Mjg0LCAwLjk3ODAxLCAwLjg5NTUyLCAwLjkxMTMzLCAwLjg5NTUyLCAwLjkxMTMzLCAxLjc4MDEsIDAuODk1NTIsIDEuMjQ0ODcsIDEuMTMyNTQsIDEuMTI0MDEsIDAuOTY4MzksIDAuODUyODQsIDAuNjg3ODcsIDAuNzA2NDUsIDAuODU1OTIsIDAuOTA3NDcsIDEuMDE0NjYsIDEuMDA4OCwgMC45MDMyMywgMSwgMS4wNzQ2MywgMSwgMC45MTA1NiwgMC43NTgwNiwgMS4xOTExOCwgMC45NjgzOSwgMC43ODg2NCwgMC44Mjg0NSwgMC44NDEzMywgMC43NTg1OSwgMC44MzkwOCwgMC44MzkwOCwgMC44MzkwOCwgMC44MzkwOCwgMC44MzkwOCwgMC44MzkwOCwgMC43NzUzOSwgMC43MzI5MywgMC43MzEzMywgMC43MzEzMywgMC43MzEzMywgMC43MzEzMywgMC45NTk1OCwgMC45NTk1OCwgMC45NTk1OCwgMC45NTk1OCwgMC44ODUwNiwgMC45MTIxLCAwLjg2OTQzLCAwLjg2OTQzLCAwLjg2OTQzLCAwLjg2OTQzLCAwLjg2OTQzLCAwLjg1Mjg0LCAwLjg3NTA4LCAwLjkwMzk5LCAwLjkwMzk5LCAwLjkwMzk5LCAwLjkwMzk5LCAwLjc3ODkyLCAwLjc5Nzk1LCAwLjkwODA3LCAwLjg4NzYyLCAwLjg4NzYyLCAwLjg4NzYyLCAwLjg4NzYyLCAwLjg4NzYyLCAwLjg4NzYyLCAwLjg3MTUsIDAuNzUyNDEsIDAuOTA1MTgsIDAuOTA1MTgsIDAuOTA1MTgsIDAuOTA1MTgsIDAuODg0MDEsIDAuODg0MDEsIDAuODg0MDEsIDAuODg0MDEsIDAuODc4NSwgMC44Nzg1LCAwLjg4MDEsIDAuODgwMSwgMC44ODAxLCAwLjg4MDEsIDAuODgwMSwgMC45MDc0NywgMC44OTA0OSwgMC44Nzg1LCAwLjg3ODUsIDAuODc4NSwgMC44Nzg1LCAwLjg1MTYyLCAwLjg3ODUsIDAuODUxNjIsIDAuODM5MDgsIDAuODg3NjIsIDAuODM5MDgsIDAuODg3NjIsIDAuODM5MDgsIDAuODg3NjIsIDAuNzMyOTMsIDAuNzUyNDEsIDAuNzMyOTMsIDAuNzUyNDEsIDAuNzMyOTMsIDAuNzUyNDEsIDAuNzMyOTMsIDAuNzUyNDEsIDAuODcyODksIDAuODMwMTYsIDAuODg1MDYsIDAuOTMxMjUsIDAuNzMxMzMsIDAuOTA1MTgsIDAuNzMxMzMsIDAuOTA1MTgsIDAuNzMxMzMsIDAuOTA1MTgsIDAuNzMxMzMsIDAuOTA1MTgsIDAuNzMxMzMsIDAuOTA1MTgsIDAuODE5MjEsIDAuNzc2MTgsIDAuODE5MjEsIDAuNzc2MTgsIDAuODE5MjEsIDAuNzc2MTgsIDEsIDEsIDAuODczNTYsIDAuODc4NSwgMC45MTA3NSwgMC44OTYwOCwgMC45NTk1OCwgMC44ODQwMSwgMC45NTk1OCwgMC44ODQwMSwgMC45NTk1OCwgMC44ODQwMSwgMC45NTk1OCwgMC44ODQwMSwgMC45NTk1OCwgMC44ODQwMSwgMC43NjIyOSwgMC45MDE2NywgMC41OTUyNiwgMC45MTkxNiwgMSwgMSwgMC44NjMwNCwgMC42OTIyNSwgMC44ODQwMSwgMSwgMSwgMC43MDQyNCwgMC43OTQ2OCwgMC45MTkyNiwgMC44ODE3NSwgMC43MDgyMywgMC45NDkwMywgMC45MTIxLCAwLjg3ODUsIDEsIDEsIDAuOTEyMSwgMC44Nzg1LCAwLjg3ODAyLCAwLjg4NjU2LCAwLjg3ODUsIDAuODY5NDMsIDAuODgwMSwgMC44Njk0MywgMC44ODAxLCAwLjg2OTQzLCAwLjg4MDEsIDAuODc0MDIsIDAuODkyOTEsIDAuNzc5NTgsIDAuOTEzNDMsIDEsIDEsIDAuNzc5NTgsIDAuOTEzNDMsIDAuNzA4NjQsIDAuNzE3MywgMC43MDg2NCwgMC43MTczLCAwLjcwODY0LCAwLjcxNzMsIDAuNzA4NjQsIDAuNzE3MywgMSwgMSwgMC44MTA1NSwgMC43NTg0MSwgMC44MTA1NSwgMS4wNjQ1MiwgMC45MDM5OSwgMC44Nzg1LCAwLjkwMzk5LCAwLjg3ODUsIDAuOTAzOTksIDAuODc4NSwgMC45MDM5OSwgMC44Nzg1LCAwLjkwMzk5LCAwLjg3ODUsIDAuOTAzOTksIDAuODc4NSwgMC45NjAxNywgMC45NTc5NCwgMC43Nzg5MiwgMC44NTE2MiwgMC43Nzg5MiwgMC43ODI1NywgMC43OTQ5MiwgMC43ODI1NywgMC43OTQ5MiwgMC43ODI1NywgMC43OTQ5MiwgMC45Mjk3LCAwLjU2ODkyLCAwLjgzOTA4LCAwLjg4NzYyLCAwLjc3NTM5LCAwLjg3MTUsIDAuODc1MDgsIDAuODkwNDksIDEsIDEsIDAuODEwNTUsIDEuMDQxMDYsIDEuMjA1MjgsIDEuMjA1MjgsIDEsIDEuMTU1NDMsIDAuNzA2NzQsIDAuOTgzODcsIDAuOTQ3MjEsIDEuMzM0MzEsIDEuNDU4OTQsIDAuOTUxNjEsIDEuMDYzMDMsIDAuODM5MDgsIDAuODAzNTIsIDAuNTcxODQsIDAuNjk2NSwgMC41NjI4OSwgMC44MjAwMSwgMC41NjAyOSwgMC44MTIzNSwgMS4wMjk4OCwgMC44MzkwOCwgMC43NzYyLCAwLjY4MTU2LCAwLjgwMzY3LCAwLjczMTMzLCAwLjc4MjU3LCAwLjg3MzU2LCAwLjg2OTQzLCAwLjk1OTU4LCAwLjc1NzI3LCAwLjg5MDE5LCAxLjA0OTI0LCAwLjkxMjEsIDAuNzY0OCwgMC44Njk0MywgMC44NzM1NiwgMC43OTc5NSwgMC43ODI3NSwgMC44MTA1NSwgMC43Nzg5MiwgMC45NzYyLCAwLjgyNTc3LCAwLjk5ODE5LCAwLjg0ODk2LCAwLjk1OTU4LCAwLjc3ODkyLCAwLjk2MTA4LCAxLjAxNDA3LCAwLjg5MDQ5LCAxLjAyOTg4LCAwLjk0MjExLCAwLjk2MTA4LCAwLjg5MzYsIDAuODQwMjEsIDAuODc4NDIsIDAuOTYzOTksIDAuNzkxMDksIDAuODkwNDksIDEuMDA4MTMsIDEuMDI5ODgsIDAuODYwNzcsIDAuODc0NDUsIDAuOTIwOTksIDAuODQ3MjMsIDAuODY1MTMsIDAuODgwMSwgMC43NTYzOCwgMC44NTcxNCwgMC43ODIxNiwgMC43OTU4NiwgMC44Nzk2NSwgMC45NDIxMSwgMC45Nzc0NywgMC43ODI4NywgMC45NzkyNiwgMC44NDk3MSwgMS4wMjk4OCwgMC45NDIxMSwgMC44ODAxLCAwLjk0MjExLCAwLjg0OTcxLCAwLjczMTMzLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjkwMjY0LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjkwNTE4LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjkwNTQ4LCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk2MDE3LCAwLjk1Nzk0LCAwLjk2MDE3LCAwLjk1Nzk0LCAwLjk2MDE3LCAwLjk1Nzk0LCAwLjc3ODkyLCAwLjg1MTYyLCAxLCAxLCAwLjg5NTUyLCAwLjkwNTI3LCAxLCAwLjkwMzYzLCAwLjkyNzk0LCAwLjkyNzk0LCAwLjkyNzk0LCAwLjkyNzk0LCAwLjg3MDEyLCAwLjg3MDEyLCAwLjg3MDEyLCAwLjg5NTUyLCAwLjg5NTUyLCAxLjQyMjU5LCAwLjcxMTQzLCAxLjA2MTUyLCAxLCAxLCAxLjAzMzcyLCAxLjAzMzcyLCAwLjk3MTcxLCAxLjQ5NTYsIDIuMjgwNywgMC45MzgzNSwgMC44MzQwNiwgMC45MTEzMywgMC44NDEwNywgMC45MTEzMywgMSwgMSwgMSwgMC43MjAyMSwgMSwgMS4yMzEwOCwgMC44MzQ4OSwgMC44ODUyNSwgMC44ODUyNSwgMC44MTQ5OSwgMC45MDUyNywgMS44MTA1NSwgMC45MDUyNywgMS44MTA1NSwgMS4zMTAwNiwgMS41MzcxMSwgMC45NDQzNCwgMS4wODY5NiwgMSwgMC45NTAxOCwgMC43NzE5MiwgMC44NTI4NCwgMC45MDc0NywgMS4xNzUzNCwgMC42OTgyNSwgMC45NzE2LCAxLjM3MDc3LCAwLjkwNzQ3LCAwLjkwNzQ3LCAwLjg1MzU2LCAwLjkwNzQ3LCAwLjkwNzQ3LCAxLjQ0OTQ3LCAwLjg1Mjg0LCAwLjg5NDEsIDAuODk0MSwgMC43MDU3MiwgMC44LCAwLjcwNTcyLCAwLjcwNTcyLCAwLjcwNTcyLCAwLjcwNTcyLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk5ODYyLCAwLjk5ODYyLCAxLCAxLCAxLCAxLCAxLCAxLjA4MDA0LCAwLjkxMDI3LCAxLCAxLCAxLCAwLjk5ODYyLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjkwNzI3LCAwLjkwNzI3LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxXTsKZXhwb3J0cy5DYWxpYnJpQm9sZEZhY3RvcnMgPSBDYWxpYnJpQm9sZEZhY3RvcnM7CmNvbnN0IENhbGlicmlCb2xkTWV0cmljcyA9IHsKICBsaW5lSGVpZ2h0OiAxLjIyMDcsCiAgbGluZUdhcDogMC4yMjA3Cn07CmV4cG9ydHMuQ2FsaWJyaUJvbGRNZXRyaWNzID0gQ2FsaWJyaUJvbGRNZXRyaWNzOwpjb25zdCBDYWxpYnJpQm9sZEl0YWxpY0ZhY3RvcnMgPSBbMS4zODc3LCAxLCAxLCAxLCAwLjk3ODAxLCAwLjkyNDgyLCAwLjg5NTUyLCAwLjkxMTMzLCAwLjgxOTg4LCAwLjk3NTY2LCAwLjk4MTUyLCAwLjkzNTQ4LCAwLjkzNTQ4LCAxLjI3OTgsIDAuODUyODQsIDAuOTI3OTQsIDEsIDAuOTYxMzQsIDEuNTYyMzksIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuODI4NDUsIDAuODI4NDUsIDAuODUyODQsIDAuODUyODQsIDAuODUyODQsIDAuNzU4NTksIDAuOTIxMzgsIDAuODM5MDgsIDAuNzc2MiwgMC43MTgwNSwgMC44NzI4OSwgMC43MzEzMywgMC43NTE0LCAwLjgxOTIxLCAwLjg3MzU2LCAwLjk1OTU4LCAwLjU5NTI2LCAwLjc1NzI3LCAwLjY5MjI1LCAxLjA0OTI0LCAwLjkwODcyLCAwLjg1OTM4LCAwLjc5Nzk1LCAwLjg3MDY4LCAwLjc3OTU4LCAwLjY5NzY2LCAwLjgxMDU1LCAwLjkwMzk5LCAwLjg4NjUzLCAwLjk2MDY4LCAwLjgyNTc3LCAwLjc3ODkyLCAwLjc4MjU3LCAwLjk3NTA3LCAxLjUyOSwgMC45NzUwNywgMC44NTI4NCwgMC44OTU1MiwgMC45MDE3NiwgMC45NDkwOCwgMC44NjQxMSwgMC43NDAxMiwgMC44NjQxMSwgMC44ODMyMywgMC45NTAxNSwgMC44NjQxMSwgMC44NjMzMSwgMC44ODQwMSwgMC45MTkxNiwgMC44NjMwNCwgMC44ODQwMSwgMC45MDM5LCAwLjg2MzMxLCAwLjg2MzMxLCAwLjg2NDExLCAwLjg2NDExLCAwLjkwNDY0LCAwLjcwODUyLCAxLjA0MTA2LCAwLjg2MzMxLCAwLjg0MzcyLCAwLjk1Nzk0LCAwLjgyNjE2LCAwLjg0NTQ4LCAwLjc5NDkyLCAwLjg4MzMxLCAxLjY5ODA4LCAwLjg4MzMxLCAwLjg1Mjg0LCAwLjk3ODAxLCAwLjg5NTUyLCAwLjkxMTMzLCAwLjg5NTUyLCAwLjkxMTMzLCAxLjc4MDEsIDAuODk1NTIsIDEuMjQ0ODcsIDEuMTMyNTQsIDEuMTkxMjksIDAuOTY4MzksIDAuODUyODQsIDAuNjg3ODcsIDAuNzA2NDUsIDAuODU1OTIsIDAuOTA3NDcsIDEuMDE0NjYsIDEuMDA4OCwgMC45MDMyMywgMSwgMS4wNzQ2MywgMSwgMC45MTA1NiwgMC43NTgwNiwgMS4xOTExOCwgMC45NjgzOSwgMC43ODg2NCwgMC44Mjg0NSwgMC44NDEzMywgMC43NTg1OSwgMC44MzkwOCwgMC44MzkwOCwgMC44MzkwOCwgMC44MzkwOCwgMC44MzkwOCwgMC44MzkwOCwgMC43NzUzOSwgMC43MTgwNSwgMC43MzEzMywgMC43MzEzMywgMC43MzEzMywgMC43MzEzMywgMC45NTk1OCwgMC45NTk1OCwgMC45NTk1OCwgMC45NTk1OCwgMC44ODUwNiwgMC45MDg3MiwgMC44NTkzOCwgMC44NTkzOCwgMC44NTkzOCwgMC44NTkzOCwgMC44NTkzOCwgMC44NTI4NCwgMC44NzA2OCwgMC45MDM5OSwgMC45MDM5OSwgMC45MDM5OSwgMC45MDM5OSwgMC43Nzg5MiwgMC43OTc5NSwgMC45MDgwNywgMC45NDkwOCwgMC45NDkwOCwgMC45NDkwOCwgMC45NDkwOCwgMC45NDkwOCwgMC45NDkwOCwgMC44NTg4NywgMC43NDAxMiwgMC44ODMyMywgMC44ODMyMywgMC44ODMyMywgMC44ODMyMywgMC44ODQwMSwgMC44ODQwMSwgMC44ODQwMSwgMC44ODQwMSwgMC44Nzg1LCAwLjg2MzMxLCAwLjg2MzMxLCAwLjg2MzMxLCAwLjg2MzMxLCAwLjg2MzMxLCAwLjg2MzMxLCAwLjkwNzQ3LCAwLjg5MDQ5LCAwLjg2MzMxLCAwLjg2MzMxLCAwLjg2MzMxLCAwLjg2MzMxLCAwLjg0NTQ4LCAwLjg2NDExLCAwLjg0NTQ4LCAwLjgzOTA4LCAwLjk0OTA4LCAwLjgzOTA4LCAwLjk0OTA4LCAwLjgzOTA4LCAwLjk0OTA4LCAwLjcxODA1LCAwLjc0MDEyLCAwLjcxODA1LCAwLjc0MDEyLCAwLjcxODA1LCAwLjc0MDEyLCAwLjcxODA1LCAwLjc0MDEyLCAwLjg3Mjg5LCAwLjc5NTM4LCAwLjg4NTA2LCAwLjkyNzI2LCAwLjczMTMzLCAwLjg4MzIzLCAwLjczMTMzLCAwLjg4MzIzLCAwLjczMTMzLCAwLjg4MzIzLCAwLjczMTMzLCAwLjg4MzIzLCAwLjczMTMzLCAwLjg4MzIzLCAwLjgxOTIxLCAwLjg2NDExLCAwLjgxOTIxLCAwLjg2NDExLCAwLjgxOTIxLCAwLjg2NDExLCAxLCAxLCAwLjg3MzU2LCAwLjg2MzMxLCAwLjkxMDc1LCAwLjg3NzcsIDAuOTU5NTgsIDAuODg0MDEsIDAuOTU5NTgsIDAuODg0MDEsIDAuOTU5NTgsIDAuODg0MDEsIDAuOTU5NTgsIDAuODg0MDEsIDAuOTU5NTgsIDAuODg0MDEsIDAuNzY0NjcsIDAuOTAxNjcsIDAuNTk1MjYsIDAuOTE5MTYsIDEsIDEsIDAuODYzMDQsIDAuNjkyMjUsIDAuODg0MDEsIDEsIDEsIDAuNzA0MjQsIDAuNzczMTIsIDAuOTE5MjYsIDAuODgxNzUsIDAuNzA4MjMsIDAuOTQ5MDMsIDAuOTA4NzIsIDAuODYzMzEsIDEsIDEsIDAuOTA4NzIsIDAuODYzMzEsIDAuODY5MDYsIDAuODgxMTYsIDAuODYzMzEsIDAuODU5MzgsIDAuODYzMzEsIDAuODU5MzgsIDAuODYzMzEsIDAuODU5MzgsIDAuODYzMzEsIDAuODc0MDIsIDAuODY1NDksIDAuNzc5NTgsIDAuOTA0NjQsIDEsIDEsIDAuNzc5NTgsIDAuOTA0NjQsIDAuNjk3NjYsIDAuNzA4NTIsIDAuNjk3NjYsIDAuNzA4NTIsIDAuNjk3NjYsIDAuNzA4NTIsIDAuNjk3NjYsIDAuNzA4NTIsIDEsIDEsIDAuODEwNTUsIDAuNzU4NDEsIDAuODEwNTUsIDEuMDY0NTIsIDAuOTAzOTksIDAuODYzMzEsIDAuOTAzOTksIDAuODYzMzEsIDAuOTAzOTksIDAuODYzMzEsIDAuOTAzOTksIDAuODYzMzEsIDAuOTAzOTksIDAuODYzMzEsIDAuOTAzOTksIDAuODYzMzEsIDAuOTYwNjgsIDAuOTU3OTQsIDAuNzc4OTIsIDAuODQ1NDgsIDAuNzc4OTIsIDAuNzgyNTcsIDAuNzk0OTIsIDAuNzgyNTcsIDAuNzk0OTIsIDAuNzgyNTcsIDAuNzk0OTIsIDAuOTI5NywgMC41Njg5MiwgMC44MzkwOCwgMC45NDkwOCwgMC43NzUzOSwgMC44NTg4NywgMC44NzA2OCwgMC44OTA0OSwgMSwgMSwgMC44MTA1NSwgMS4wNDEwNiwgMS4yMDUyOCwgMS4yMDUyOCwgMSwgMS4xNTU0MywgMC43MDA4OCwgMC45ODM4NywgMC45NDcyMSwgMS4zMzQzMSwgMS40NTg5NCwgMC45NTE2MSwgMS40ODM4NywgMC44MzkwOCwgMC44MDM1MiwgMC41NzExOCwgMC42OTY1LCAwLjU2MzQ3LCAwLjc5MTc5LCAwLjU1ODUzLCAwLjgwMzQ2LCAxLjAyOTg4LCAwLjgzOTA4LCAwLjc3NjIsIDAuNjcxNzQsIDAuODYwMzYsIDAuNzMxMzMsIDAuNzgyNTcsIDAuODczNTYsIDAuODY0NDEsIDAuOTU5NTgsIDAuNzU3MjcsIDAuODkwMTksIDEuMDQ5MjQsIDAuOTA4NzIsIDAuNzQ4ODksIDAuODU5MzgsIDAuODc4OTEsIDAuNzk3OTUsIDAuNzk1NywgMC44MTA1NSwgMC43Nzg5MiwgMC45NzQ0NywgMC44MjU3NywgMC45NzQ2NiwgMC44NzE3OSwgMC45NTk1OCwgMC43Nzg5MiwgMC45NDI1MiwgMC45NTYxMiwgMC44NzUzLCAxLjAyOTg4LCAwLjkyNzMzLCAwLjk0MjUyLCAwLjg3NDExLCAwLjg0MDIxLCAwLjg3MjgsIDAuOTU2MTIsIDAuNzQwODEsIDAuODc1MywgMS4wMjE4OSwgMS4wMjk4OCwgMC44NDgxNCwgMC44NzQ0NSwgMC45MTgyMiwgMC44NDcyMywgMC44NTY2OCwgMC44NjMzMSwgMC44MTM0NCwgMC44NzU4MSwgMC43NjQyMiwgMC44MjA0NiwgMC45NjA1NywgMC45MjczMywgMC45OTM3NSwgMC43ODAyMiwgMC45NTQ1MiwgMC44NjAxNSwgMS4wMjk4OCwgMC45MjczMywgMC44NjMzMSwgMC45MjczMywgMC44NjAxNSwgMC43MzEzMywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45MDYzMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC44ODMyMywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC44NTE3NCwgMSwgMSwgMSwgMSwgMSwgMSwgMC45NjA2OCwgMC45NTc5NCwgMC45NjA2OCwgMC45NTc5NCwgMC45NjA2OCwgMC45NTc5NCwgMC43Nzg5MiwgMC44NDU0OCwgMSwgMSwgMC44OTU1MiwgMC45MDUyNywgMSwgMC45MDM2MywgMC45Mjc5NCwgMC45Mjc5NCwgMC45Mjc5NCwgMC44OTgwNywgMC44NzAxMiwgMC44NzAxMiwgMC44NzAxMiwgMC44OTU1MiwgMC44OTU1MiwgMS40MjI1OSwgMC43MTA5NCwgMS4wNjE1MiwgMSwgMSwgMS4wMzM3MiwgMS4wMzM3MiwgMC45NzE3MSwgMS40OTU2LCAyLjI4MDcsIDAuOTI5NzIsIDAuODM0MDYsIDAuOTExMzMsIDAuODMzMjYsIDAuOTExMzMsIDEsIDEsIDEsIDAuNzIwMjEsIDEsIDEuMjMxMDgsIDAuODM0ODksIDAuODg1MjUsIDAuODg1MjUsIDAuODE0OTksIDAuOTA2MTYsIDEuODEwNTUsIDAuOTA1MjcsIDEuODEwNTUsIDEuMzEwNywgMS41MzcxMSwgMC45NDQzNCwgMS4wODY5NiwgMSwgMC45NTAxOCwgMC43NzE5MiwgMC44NTI4NCwgMC45MDc0NywgMS4xNzUzNCwgMC42OTgyNSwgMC45NzE2LCAxLjM3MDc3LCAwLjkwNzQ3LCAwLjkwNzQ3LCAwLjg1MzU2LCAwLjkwNzQ3LCAwLjkwNzQ3LCAxLjQ0OTQ3LCAwLjg1Mjg0LCAwLjg5NDEsIDAuODk0MSwgMC43MDU3MiwgMC44LCAwLjcwNTcyLCAwLjcwNTcyLCAwLjcwNTcyLCAwLjcwNTcyLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk5ODYyLCAwLjk5ODYyLCAxLCAxLCAxLCAxLCAxLCAxLjA4MDA0LCAwLjkxMDI3LCAxLCAxLCAxLCAwLjk5ODYyLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjkwNzI3LCAwLjkwNzI3LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxXTsKZXhwb3J0cy5DYWxpYnJpQm9sZEl0YWxpY0ZhY3RvcnMgPSBDYWxpYnJpQm9sZEl0YWxpY0ZhY3RvcnM7CmNvbnN0IENhbGlicmlCb2xkSXRhbGljTWV0cmljcyA9IHsKICBsaW5lSGVpZ2h0OiAxLjIyMDcsCiAgbGluZUdhcDogMC4yMjA3Cn07CmV4cG9ydHMuQ2FsaWJyaUJvbGRJdGFsaWNNZXRyaWNzID0gQ2FsaWJyaUJvbGRJdGFsaWNNZXRyaWNzOwpjb25zdCBDYWxpYnJpSXRhbGljRmFjdG9ycyA9IFsxLjM4NzcsIDEsIDEsIDEsIDEuMTcyMjMsIDEuMTI5MywgMC44OTU1MiwgMC45MTEzMywgMC44MDM5NSwgMS4wMjI2OSwgMS4xNTYwMSwgMC45MTA1NiwgMC45MTA1NiwgMS4yNzk4LCAwLjg1Mjg0LCAwLjg5ODA3LCAxLCAwLjkwODYxLCAxLjM5NTQzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjk2MzA5LCAwLjk2MzA5LCAwLjg1Mjg0LCAwLjg1Mjg0LCAwLjg1Mjg0LCAwLjgzMzE5LCAwLjg4MDcxLCAwLjg2NzUsIDAuODE1NTIsIDAuNzIzNDYsIDAuODUxOTMsIDAuNzMyMDYsIDAuNzUyMiwgMC44MTEwNSwgMC44NjI3NSwgMC45MDY4NSwgMC42Mzc3LCAwLjc3ODkyLCAwLjc1NTkzLCAxLjAyNjM4LCAwLjg5MjQ5LCAwLjg0MTE4LCAwLjc3NDUyLCAwLjg1Mzc0LCAwLjc1MTg2LCAwLjY3Nzg5LCAwLjc5Nzc2LCAwLjg4ODQ0LCAwLjg1MDY2LCAwLjk0MzA5LCAwLjc3ODE4LCAwLjczMDYsIDAuNzY2NTksIDEuMTAzNjksIDEuMzgzMTMsIDEuMTAzNjksIDEuMDYxMzksIDAuODk1NTIsIDAuODczOSwgMC45MjQ1LCAwLjkyNDUsIDAuODMyMDMsIDAuOTI0NSwgMC44NTg2NSwgMS4wOTg0MiwgMC45MjQ1LCAwLjkyNDUsIDEuMDMyOTcsIDEuMDc2OTIsIDAuOTA5MTgsIDEuMDMyOTcsIDAuOTQ5NTksIDAuOTI0NSwgMC45MjI3NCwgMC45MjQ1LCAwLjkyNDUsIDEuMDI5MzMsIDAuNzc4MzIsIDEuMjA1NjIsIDAuOTI0NSwgMC44OTE2LCAwLjk4OTg2LCAwLjg2NjIxLCAwLjg5NDUzLCAwLjc5MDA0LCAwLjk0MTUyLCAxLjc3MjU2LCAwLjk0MTUyLCAwLjg1Mjg0LCAwLjk3ODAxLCAwLjg5NTUyLCAwLjkxMTMzLCAwLjg5NTUyLCAwLjkxMTMzLCAxLjkxNzI5LCAwLjg5NTUyLCAxLjE3ODg5LCAxLjEzMjU0LCAxLjE2MzU5LCAwLjkyMDk4LCAwLjg1Mjg0LCAwLjY4Nzg3LCAwLjcxMzUzLCAwLjg0NzM3LCAwLjkwNzQ3LCAxLjAwODgsIDEuMDA0NCwgMC44NzY4MywgMSwgMS4wOTA5MSwgMSwgMC45MjIyOSwgMC43MzksIDEuMTU2NDIsIDAuOTIwOTgsIDAuNzYyODgsIDAuODA1MDQsIDAuODA5NzIsIDAuNzU4NTksIDAuODY3NSwgMC44Njc1LCAwLjg2NzUsIDAuODY3NSwgMC44Njc1LCAwLjg2NzUsIDAuNzYzMTgsIDAuNzIzNDYsIDAuNzMyMDYsIDAuNzMyMDYsIDAuNzMyMDYsIDAuNzMyMDYsIDAuOTA2ODUsIDAuOTA2ODUsIDAuOTA2ODUsIDAuOTA2ODUsIDAuODY0NzcsIDAuODkyNDksIDAuODQxMTgsIDAuODQxMTgsIDAuODQxMTgsIDAuODQxMTgsIDAuODQxMTgsIDAuODUyODQsIDAuODQ1NTcsIDAuODg4NDQsIDAuODg4NDQsIDAuODg4NDQsIDAuODg4NDQsIDAuNzMwNiwgMC43NzQ1MiwgMC44NjMzMSwgMC45MjQ1LCAwLjkyNDUsIDAuOTI0NSwgMC45MjQ1LCAwLjkyNDUsIDAuOTI0NSwgMC44NDg0MywgMC44MzIwMywgMC44NTg2NSwgMC44NTg2NSwgMC44NTg2NSwgMC44NTg2NSwgMC44MjYwMSwgMC44MjYwMSwgMC44MjYwMSwgMC44MjYwMSwgMC45NDQ2OSwgMC45MjQ1LCAwLjkyMjc0LCAwLjkyMjc0LCAwLjkyMjc0LCAwLjkyMjc0LCAwLjkyMjc0LCAwLjkwNzQ3LCAwLjg2NjUxLCAwLjkyNDUsIDAuOTI0NSwgMC45MjQ1LCAwLjkyNDUsIDAuODk0NTMsIDAuOTI0NSwgMC44OTQ1MywgMC44Njc1LCAwLjkyNDUsIDAuODY3NSwgMC45MjQ1LCAwLjg2NzUsIDAuOTI0NSwgMC43MjM0NiwgMC44MzIwMywgMC43MjM0NiwgMC44MzIwMywgMC43MjM0NiwgMC44MzIwMywgMC43MjM0NiwgMC44MzIwMywgMC44NTE5MywgMC44ODc1LCAwLjg2NDc3LCAwLjk5MDM0LCAwLjczMjA2LCAwLjg1ODY1LCAwLjczMjA2LCAwLjg1ODY1LCAwLjczMjA2LCAwLjg1ODY1LCAwLjczMjA2LCAwLjg1ODY1LCAwLjczMjA2LCAwLjg1ODY1LCAwLjgxMTA1LCAwLjkyNDUsIDAuODExMDUsIDAuOTI0NSwgMC44MTEwNSwgMC45MjQ1LCAxLCAxLCAwLjg2Mjc1LCAwLjkyNDUsIDAuOTA4NzIsIDAuOTM1OTEsIDAuOTA2ODUsIDAuODI2MDEsIDAuOTA2ODUsIDAuODI2MDEsIDAuOTA2ODUsIDAuODI2MDEsIDAuOTA2ODUsIDEuMDMyOTcsIDAuOTA2ODUsIDAuODI2MDEsIDAuNzc4OTYsIDEuMDU2MTEsIDAuNjM3NywgMS4wNzY5MiwgMSwgMSwgMC45MDkxOCwgMC43NTU5MywgMS4wMzI5NywgMSwgMSwgMC43NjAzMiwgMC45Mzc1LCAwLjk4MTU2LCAwLjkzNDA3LCAwLjc3MjYxLCAxLjExNDI5LCAwLjg5MjQ5LCAwLjkyNDUsIDEsIDEsIDAuODkyNDksIDAuOTI0NSwgMC45MjUzNCwgMC44NjY5OCwgMC45MjQ1LCAwLjg0MTE4LCAwLjkyMjc0LCAwLjg0MTE4LCAwLjkyMjc0LCAwLjg0MTE4LCAwLjkyMjc0LCAwLjg2NjcsIDAuODYyOTEsIDAuNzUxODYsIDEuMDI5MzMsIDEsIDEsIDAuNzUxODYsIDEuMDI5MzMsIDAuNjc3ODksIDAuNzc4MzIsIDAuNjc3ODksIDAuNzc4MzIsIDAuNjc3ODksIDAuNzc4MzIsIDAuNjc3ODksIDAuNzc4MzIsIDEsIDEsIDAuNzk3NzYsIDAuOTc2NTUsIDAuNzk3NzYsIDEuMjMwMjMsIDAuODg4NDQsIDAuOTI0NSwgMC44ODg0NCwgMC45MjQ1LCAwLjg4ODQ0LCAwLjkyNDUsIDAuODg4NDQsIDAuOTI0NSwgMC44ODg0NCwgMC45MjQ1LCAwLjg4ODQ0LCAwLjkyNDUsIDAuOTQzMDksIDAuOTg5ODYsIDAuNzMwNiwgMC44OTQ1MywgMC43MzA2LCAwLjc2NjU5LCAwLjc5MDA0LCAwLjc2NjU5LCAwLjc5MDA0LCAwLjc2NjU5LCAwLjc5MDA0LCAxLjA5MjMxLCAwLjU0ODczLCAwLjg2NzUsIDAuOTI0NSwgMC43NjMxOCwgMC44NDg0MywgMC44NDU1NywgMC44NjY1MSwgMSwgMSwgMC43OTc3NiwgMS4yMDU2MiwgMS4xODYyMiwgMS4xODYyMiwgMSwgMS4xNDM3LCAwLjY3MDA5LCAwLjk2MzM0LCAwLjkzNjk1LCAxLjM1MTkxLCAxLjQwOTA5LCAwLjk1MTYxLCAxLjQ4Mzg3LCAwLjg2NzUsIDAuOTA4NjEsIDAuNjE5MiwgMC43MzYzLCAwLjY0ODI0LCAwLjgyNDExLCAwLjU2MzIxLCAwLjg1Njk2LCAxLjIzNTE2LCAwLjg2NzUsIDAuODE1NTIsIDAuNzI4NiwgMC44NDEzNCwgMC43MzIwNiwgMC43NjY1OSwgMC44NjI3NSwgMC44NDM2OSwgMC45MDY4NSwgMC43Nzg5MiwgMC44NTg3MSwgMS4wMjYzOCwgMC44OTI0OSwgMC43NTgyOCwgMC44NDExOCwgMC44NTk4NCwgMC43NzQ1MiwgMC43NjQ2NiwgMC43OTc3NiwgMC43MzA2LCAwLjkwNzgyLCAwLjc3ODE4LCAwLjkwMywgMC44NzI5MSwgMC45MDY4NSwgMC43MzA2LCAwLjk5MDU4LCAxLjAzNjY3LCAwLjk0NjM1LCAxLjIzNTE2LCAwLjk4NDksIDAuOTkwNTgsIDAuOTIzOTMsIDAuODkxNiwgMC45NDIsIDEuMDM2NjcsIDAuNzUwMjYsIDAuOTQ2MzUsIDEuMDI5NywgMS4yMzUxNiwgMC45MDkxOCwgMC45NDA0OCwgMC45ODIxNywgMC44OTc0NiwgMC44NDE1MywgMC45MjI3NCwgMC44MjUwNywgMC44ODgzMiwgMC44NDQzOCwgMC44ODE3OCwgMS4wMzUyNSwgMC45ODQ5LCAxLjAwMjI1LCAwLjc4MDg2LCAwLjk3MjQ4LCAwLjg5NDA0LCAxLjIzNTE2LCAwLjk4NDksIDAuOTIyNzQsIDAuOTg0OSwgMC44OTQwNCwgMC43MzIwNiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC44OTY5MywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC44NTg2NSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45MDkzMywgMSwgMSwgMSwgMSwgMSwgMSwgMC45NDMwOSwgMC45ODk4NiwgMC45NDMwOSwgMC45ODk4NiwgMC45NDMwOSwgMC45ODk4NiwgMC43MzA2LCAwLjg5NDUzLCAxLCAxLCAwLjg5NTUyLCAwLjkwNTI3LCAxLCAwLjkwMTg2LCAxLjEyMzA4LCAxLjEyMzA4LCAxLjEyMzA4LCAxLjEyMzA4LCAxLjI1NjYsIDEuMjU2NiwgMS4yNTY2LCAwLjg5NTUyLCAwLjg5NTUyLCAxLjQyMjU5LCAwLjY4OTk0LCAxLjAzODA5LCAxLCAxLCAxLjAxNzYsIDEuMDE3NiwgMS4xMTUyMywgMS40OTU2LCAyLjAxNDYyLCAwLjk3ODU4LCAwLjgyNjE2LCAwLjkxMTMzLCAwLjgzNDM3LCAwLjkxMTMzLCAxLCAxLCAxLCAwLjcwNTA4LCAxLCAxLjIzMTA4LCAwLjc5ODAxLCAwLjg0NDI2LCAwLjg0NDI2LCAwLjc3NCwgMC45MDU3MiwgMS44MTA1NSwgMC45MDc0OSwgMS44MTA1NSwgMS4yODgwOSwgMS41NTQ2OSwgMC45NDQzNCwgMS4wNzgwNiwgMSwgMC45NzA5NCwgMC43NTg5LCAwLjg1Mjg0LCAwLjkwNzQ3LCAxLjE5NjU4LCAwLjY5ODI1LCAwLjk3NjIyLCAxLjMzNTEyLCAwLjkwNzQ3LCAwLjkwNzQ3LCAwLjg1Mjg0LCAwLjkwNzQ3LCAwLjkwNzQ3LCAxLjQ0OTQ3LCAwLjg1Mjg0LCAwLjg5NDEsIDAuODk0MSwgMC43MDU3MiwgMC44LCAwLjcwNTcyLCAwLjcwNTcyLCAwLjcwNTcyLCAwLjcwNTcyLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk5ODYyLCAwLjk5ODYyLCAxLCAxLCAxLCAxLCAxLCAxLjAzMzYsIDAuOTEwMjcsIDEsIDEsIDEsIDAuOTk4NjIsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMDU4NTksIDEuMDU4NTksIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLkNhbGlicmlJdGFsaWNGYWN0b3JzID0gQ2FsaWJyaUl0YWxpY0ZhY3RvcnM7CmNvbnN0IENhbGlicmlJdGFsaWNNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMjIwNywKICBsaW5lR2FwOiAwLjIyMDcKfTsKZXhwb3J0cy5DYWxpYnJpSXRhbGljTWV0cmljcyA9IENhbGlicmlJdGFsaWNNZXRyaWNzOwpjb25zdCBDYWxpYnJpUmVndWxhckZhY3RvcnMgPSBbMS4zODc3LCAxLCAxLCAxLCAxLjE3MjIzLCAxLjEyOTMsIDAuODk1NTIsIDAuOTExMzMsIDAuODAzOTUsIDEuMDIyNjksIDEuMTU2MDEsIDAuOTEwNTYsIDAuOTEwNTYsIDEuMjc5OCwgMC44NTI4NCwgMC44OTgwNywgMSwgMC45MDg2MSwgMS4zOTAxNiwgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45NjMwOSwgMC45NjMwOSwgMC44NTI4NCwgMC44NTI4NCwgMC44NTI4NCwgMC44MzMxOSwgMC44ODA3MSwgMC44Njc1LCAwLjgxNTUyLCAwLjczODM0LCAwLjg1MTkzLCAwLjczMjA2LCAwLjc1MjIsIDAuODExMDUsIDAuODYyNzUsIDAuOTA2ODUsIDAuNjM3NywgMC43Nzg5MiwgMC43NTU5MywgMS4wMjYzOCwgMC44OTM4NSwgMC44NTEyMiwgMC43NzQ1MiwgMC44NjUwMywgMC43NTE4NiwgMC42ODg4NywgMC43OTc3NiwgMC44ODg0NCwgMC44NTA2NiwgMC45NDI1OCwgMC43NzgxOCwgMC43MzA2LCAwLjc2NjU5LCAxLjEwMzY5LCAxLjM5MDE2LCAxLjEwMzY5LCAxLjA2MTM5LCAwLjg5NTUyLCAwLjg3MzksIDAuODYxMjgsIDAuOTQ0NjksIDAuODQ1NywgMC45NDQ2OSwgMC44OTQ2NCwgMS4wOTg0MiwgMC44NDYzNiwgMC45NDQ2OSwgMS4wMzI5NywgMS4wNzY5MiwgMC45MDkxOCwgMS4wMzI5NywgMC45NTg5NywgMC45NDQ2OSwgMC45NDgyLCAwLjk0NDY5LCAwLjk0NDY5LCAxLjA0NjkyLCAwLjc4MjIzLCAxLjIwNTYyLCAwLjk0NDY5LCAwLjkwMzMyLCAwLjk4OTg2LCAwLjg2NjIxLCAwLjkwNTI3LCAwLjc5MDA0LCAwLjk0MTUyLCAxLjc3MjU2LCAwLjk0MTUyLCAwLjg1Mjg0LCAwLjk3ODAxLCAwLjg5NTUyLCAwLjkxMTMzLCAwLjg5NTUyLCAwLjkxMTMzLCAxLjkxNzI5LCAwLjg5NTUyLCAxLjE3ODg5LCAxLjEzMjU0LCAxLjA4NzA3LCAwLjkyMDk4LCAwLjg1Mjg0LCAwLjY4Nzg3LCAwLjcxMzUzLCAwLjg0NzM3LCAwLjkwNzQ3LCAxLjAwODgsIDEuMDA0NCwgMC44NzY4MywgMSwgMS4wOTA5MSwgMSwgMC45MjIyOSwgMC43MzksIDEuMTU2NDIsIDAuOTIwOTgsIDAuNzYyODgsIDAuODA1MDQsIDAuODA5NzIsIDAuNzU4NTksIDAuODY3NSwgMC44Njc1LCAwLjg2NzUsIDAuODY3NSwgMC44Njc1LCAwLjg2NzUsIDAuNzYzMTgsIDAuNzM4MzQsIDAuNzMyMDYsIDAuNzMyMDYsIDAuNzMyMDYsIDAuNzMyMDYsIDAuOTA2ODUsIDAuOTA2ODUsIDAuOTA2ODUsIDAuOTA2ODUsIDAuODY0NzcsIDAuODkzODUsIDAuODUxMjIsIDAuODUxMjIsIDAuODUxMjIsIDAuODUxMjIsIDAuODUxMjIsIDAuODUyODQsIDAuODUzMTEsIDAuODg4NDQsIDAuODg4NDQsIDAuODg4NDQsIDAuODg4NDQsIDAuNzMwNiwgMC43NzQ1MiwgMC44NjMzMSwgMC44NjEyOCwgMC44NjEyOCwgMC44NjEyOCwgMC44NjEyOCwgMC44NjEyOCwgMC44NjEyOCwgMC44NjkzLCAwLjg0NTcsIDAuODk0NjQsIDAuODk0NjQsIDAuODk0NjQsIDAuODk0NjQsIDAuODI2MDEsIDAuODI2MDEsIDAuODI2MDEsIDAuODI2MDEsIDAuOTQ0NjksIDAuOTQ0NjksIDAuOTQ4MiwgMC45NDgyLCAwLjk0ODIsIDAuOTQ4MiwgMC45NDgyLCAwLjkwNzQ3LCAwLjg2NjUxLCAwLjk0NDY5LCAwLjk0NDY5LCAwLjk0NDY5LCAwLjk0NDY5LCAwLjkwNTI3LCAwLjk0NDY5LCAwLjkwNTI3LCAwLjg2NzUsIDAuODYxMjgsIDAuODY3NSwgMC44NjEyOCwgMC44Njc1LCAwLjg2MTI4LCAwLjczODM0LCAwLjg0NTcsIDAuNzM4MzQsIDAuODQ1NywgMC43MzgzNCwgMC44NDU3LCAwLjczODM0LCAwLjg0NTcsIDAuODUxOTMsIDAuOTI0NTQsIDAuODY0NzcsIDAuOTkyMSwgMC43MzIwNiwgMC44OTQ2NCwgMC43MzIwNiwgMC44OTQ2NCwgMC43MzIwNiwgMC44OTQ2NCwgMC43MzIwNiwgMC44OTQ2NCwgMC43MzIwNiwgMC44OTQ2NCwgMC44MTEwNSwgMC44NDYzNiwgMC44MTEwNSwgMC44NDYzNiwgMC44MTEwNSwgMC44NDYzNiwgMSwgMSwgMC44NjI3NSwgMC45NDQ2OSwgMC45MDg3MiwgMC45NTc4NiwgMC45MDY4NSwgMC44MjYwMSwgMC45MDY4NSwgMC44MjYwMSwgMC45MDY4NSwgMC44MjYwMSwgMC45MDY4NSwgMS4wMzI5NywgMC45MDY4NSwgMC44MjYwMSwgMC43Nzc0MSwgMS4wNTYxMSwgMC42Mzc3LCAxLjA3NjkyLCAxLCAxLCAwLjkwOTE4LCAwLjc1NTkzLCAxLjAzMjk3LCAxLCAxLCAwLjc2MDMyLCAwLjkwNDUyLCAwLjk4MTU2LCAxLjExODQyLCAwLjc3MjYxLCAxLjExNDI5LCAwLjg5Mzg1LCAwLjk0NDY5LCAxLCAxLCAwLjg5Mzg1LCAwLjk0NDY5LCAwLjk1ODc3LCAwLjg2OTAxLCAwLjk0NDY5LCAwLjg1MTIyLCAwLjk0ODIsIDAuODUxMjIsIDAuOTQ4MiwgMC44NTEyMiwgMC45NDgyLCAwLjg2NjcsIDAuOTAwMTYsIDAuNzUxODYsIDEuMDQ2OTIsIDEsIDEsIDAuNzUxODYsIDEuMDQ2OTIsIDAuNjg4ODcsIDAuNzgyMjMsIDAuNjg4ODcsIDAuNzgyMjMsIDAuNjg4ODcsIDAuNzgyMjMsIDAuNjg4ODcsIDAuNzgyMjMsIDEsIDEsIDAuNzk3NzYsIDAuOTIxODgsIDAuNzk3NzYsIDEuMjMwMjMsIDAuODg4NDQsIDAuOTQ0NjksIDAuODg4NDQsIDAuOTQ0NjksIDAuODg4NDQsIDAuOTQ0NjksIDAuODg4NDQsIDAuOTQ0NjksIDAuODg4NDQsIDAuOTQ0NjksIDAuODg4NDQsIDAuOTQ0NjksIDAuOTQyNTgsIDAuOTg5ODYsIDAuNzMwNiwgMC45MDUyNywgMC43MzA2LCAwLjc2NjU5LCAwLjc5MDA0LCAwLjc2NjU5LCAwLjc5MDA0LCAwLjc2NjU5LCAwLjc5MDA0LCAxLjA5MjMxLCAwLjU0ODczLCAwLjg2NzUsIDAuODYxMjgsIDAuNzYzMTgsIDAuODY5MywgMC44NTMxMSwgMC44NjY1MSwgMSwgMSwgMC43OTc3NiwgMS4yMDU2MiwgMS4xODYyMiwgMS4xODYyMiwgMSwgMS4xNDM3LCAwLjY3NzQyLCAwLjk2MzM0LCAwLjkzNjk1LCAxLjM1MTkxLCAxLjQwOTA5LCAwLjk1MTYxLCAxLjQ4Mzg3LCAwLjg2Njg2LCAwLjkwODYxLCAwLjYyMjY3LCAwLjc0MzU5LCAwLjY1NjQ5LCAwLjg1NDk4LCAwLjU2OTYzLCAwLjg4MjU0LCAxLjIzNTE2LCAwLjg2NzUsIDAuODE1NTIsIDAuNzU0NDMsIDAuODQ1MDMsIDAuNzMyMDYsIDAuNzY2NTksIDAuODYyNzUsIDAuODUxMjIsIDAuOTA2ODUsIDAuNzc4OTIsIDAuODU3NDYsIDEuMDI2MzgsIDAuODkzODUsIDAuNzU2NTcsIDAuODUxMjIsIDAuODYyNzUsIDAuNzc0NTIsIDAuNzQxNzEsIDAuNzk3NzYsIDAuNzMwNiwgMC45NTE2NSwgMC43NzgxOCwgMC44OTc3MiwgMC44ODgzMSwgMC45MDY4NSwgMC43MzA2LCAwLjk4MTQyLCAxLjAyMTkxLCAwLjk2NTc2LCAxLjIzNTE2LCAwLjk5MDE4LCAwLjk4MTQyLCAwLjkyMzYsIDAuODkyNTgsIDAuOTQwMzUsIDEuMDIxOTEsIDAuNzg4NDgsIDAuOTY1NzYsIDAuOTU2MSwgMS4yMzUxNiwgMC45MDkxOCwgMC45MjU3OCwgMC45NTQyNCwgMC44OTc0NiwgMC44Mzk2OSwgMC45NDgyLCAwLjgwMTEzLCAwLjg5NDQyLCAwLjg1MjA4LCAwLjg2MTU1LCAwLjk4MDIyLCAwLjk5MDE4LCAxLjAwNDUyLCAwLjgxMjA5LCAwLjk5MjQ3LCAwLjg5MTgxLCAxLjIzNTE2LCAwLjk5MDE4LCAwLjk0ODIsIDAuOTkwMTgsIDAuODkxODEsIDAuNzMyMDYsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuODg4NDQsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuODk0NjQsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTY3NjYsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTQyNTgsIDAuOTg5ODYsIDAuOTQyNTgsIDAuOTg5ODYsIDAuOTQyNTgsIDAuOTg5ODYsIDAuNzMwNiwgMC45MDUyNywgMSwgMSwgMC44OTU1MiwgMC45MDUyNywgMSwgMC45MDE4NiwgMS4xMjMwOCwgMS4xMjMwOCwgMS4xMjMwOCwgMS4xMjMwOCwgMS4yNTY2LCAxLjI1NjYsIDEuMjU2NiwgMC44OTU1MiwgMC44OTU1MiwgMS40MjI1OSwgMC42OTA0MywgMS4wMzgwOSwgMSwgMSwgMS4wMTc2LCAxLjAxNzYsIDEuMTE1MjMsIDEuNDk1NiwgMi4wMTQ2MiwgMC45OTMzMSwgMC44MjYxNiwgMC45MTEzMywgMC44NDI4NiwgMC45MTEzMywgMSwgMSwgMSwgMC43MDUwOCwgMSwgMS4yMzEwOCwgMC43OTgwMSwgMC44NDQyNiwgMC44NDQyNiwgMC43NzQsIDAuOTA1MjcsIDEuODEwNTUsIDAuOTA1MjcsIDEuODEwNTUsIDEuMjg4MDksIDEuNTU0NjksIDAuOTQ0MzQsIDEuMDc4MDYsIDEsIDAuOTcwOTQsIDAuNzU4OSwgMC44NTI4NCwgMC45MDc0NywgMS4xOTY1OCwgMC42OTgyNSwgMC45NzYyMiwgMS4zMzUxMiwgMC45MDc0NywgMC45MDc0NywgMC44NTM1NiwgMC45MDc0NywgMC45MDc0NywgMS40NDk0NywgMC44NTI4NCwgMC44OTQxLCAwLjg5NDEsIDAuNzA1NzIsIDAuOCwgMC43MDU3MiwgMC43MDU3MiwgMC43MDU3MiwgMC43MDU3MiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45OTg2MiwgMC45OTg2MiwgMSwgMSwgMSwgMSwgMSwgMS4wMzM2LCAwLjkxMDI3LCAxLCAxLCAxLCAwLjk5ODYyLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjA1ODU5LCAxLjA1ODU5LCAxLCAxLCAxLCAxLjA3MTg1LCAwLjk5NDEzLCAwLjk2MzM0LCAxLjA4MDY1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxXTsKZXhwb3J0cy5DYWxpYnJpUmVndWxhckZhY3RvcnMgPSBDYWxpYnJpUmVndWxhckZhY3RvcnM7CmNvbnN0IENhbGlicmlSZWd1bGFyTWV0cmljcyA9IHsKICBsaW5lSGVpZ2h0OiAxLjIyMDcsCiAgbGluZUdhcDogMC4yMjA3Cn07CmV4cG9ydHMuQ2FsaWJyaVJlZ3VsYXJNZXRyaWNzID0gQ2FsaWJyaVJlZ3VsYXJNZXRyaWNzOwoKLyoqKi8gfSksCi8qIDE3OCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuSGVsdmV0aWNhUmVndWxhck1ldHJpY3MgPSBleHBvcnRzLkhlbHZldGljYVJlZ3VsYXJGYWN0b3JzID0gZXhwb3J0cy5IZWx2ZXRpY2FJdGFsaWNNZXRyaWNzID0gZXhwb3J0cy5IZWx2ZXRpY2FJdGFsaWNGYWN0b3JzID0gZXhwb3J0cy5IZWx2ZXRpY2FCb2xkTWV0cmljcyA9IGV4cG9ydHMuSGVsdmV0aWNhQm9sZEl0YWxpY01ldHJpY3MgPSBleHBvcnRzLkhlbHZldGljYUJvbGRJdGFsaWNGYWN0b3JzID0gZXhwb3J0cy5IZWx2ZXRpY2FCb2xkRmFjdG9ycyA9IHZvaWQgMDsKY29uc3QgSGVsdmV0aWNhQm9sZEZhY3RvcnMgPSBbMC43NjExNiwgMSwgMSwgMS4wMDA2LCAwLjk5OTk4LCAwLjk5OTc0LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTgyLCAwLjk5OTc3LCAxLjAwMDg3LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTU5LCAxLjAwMDAzLCAxLjAwMDYsIDAuOTk5OTgsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTk4LCAxLCAxLjAwMDAzLCAxLjAwMDAzLCAxLjAwMDAzLCAxLjAwMDI2LCAwLjk5OTksIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMjYsIDEuMDAwMjIsIDAuOTk5NzcsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3NywgMS4wMDAyNiwgMC45OTk5OSwgMC45OTk3NywgMS4wMDAyMiwgMS4wMDAwMSwgMS4wMDAyMiwgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAxNiwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAyNiwgMC45OTk5OCwgMS4wMDA2LCAwLjk5OTk4LCAxLjAwMDAzLCAwLjk5OTczLCAwLjk5OTk4LCAwLjk5OTczLCAxLjAwMDI2LCAwLjk5OTczLCAxLjAwMDI2LCAwLjk5OTczLCAwLjk5OTk4LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDYsIDEuMDAwNiwgMC45OTk3MywgMS4wMDA2LCAwLjk5OTgyLCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAwLjk5OTU5LCAwLjk5OTczLCAwLjk5OTk4LCAxLjAwMDI2LCAwLjk5OTczLCAxLjAwMDIyLCAwLjk5OTczLCAwLjk5OTczLCAxLCAwLjk5OTU5LCAxLjAwMDc3LCAwLjk5OTU5LCAxLjAwMDAzLCAwLjk5OTk4LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDc3LCAwLjk5OTczLCAwLjk5OTk4LCAxLjAwMDI1LCAwLjk5OTY4LCAwLjk5OTczLCAxLjAwMDAzLCAxLjAwMDI1LCAwLjYwMjk5LCAxLjAwMDI0LCAxLjA2NDA5LCAxLCAxLCAwLjk5OTk4LCAxLCAwLjk5OTczLCAxLjAwMDYsIDAuOTk5OTgsIDEsIDAuOTk5MzYsIDAuOTk5NzMsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMjYsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDEsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMC45OTk3NywgMC45OTk3NywgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAwMywgMS4wMDAyMiwgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAyNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk4MiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjA2NDA5LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAwLjk5OTczLCAxLjAwMDI2LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAxLjAzMzc0LCAwLjk5OTc3LCAxLjAwMDI2LCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAwLjk5OTc3LCAxLjAwMDI2LCAwLjk5OTc3LCAxLjAwMDI2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNDIsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwNiwgMC45OTk3NywgMC45OTk3MywgMC45OTk3MywgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDI2LCAxLjAwMDYsIDEuMDAwMjYsIDEuMDM4MjgsIDEuMDAwMjYsIDAuOTk5OTksIDEuMDAwMjYsIDEuMDAwNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTkzLCAwLjk5OTgsIDEuMDAwMjYsIDEuMDAwMjIsIDEuMDAwMjYsIDEuMDAwMjIsIDEuMDAwMjYsIDEuMDAwMjIsIDEuMDAwMjYsIDEsIDEuMDAwMTYsIDAuOTk5NzcsIDAuOTk5NTksIDAuOTk5NzcsIDAuOTk5NTksIDAuOTk5NzcsIDAuOTk5NTksIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMjYsIDAuOTk5OTgsIDEuMDAwMjYsIDAuODEyMSwgMS4wMDAyNiwgMC45OTk5OCwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMS4wMDAxNiwgMS4wMDAyMiwgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMS4wMDAyNiwgMSwgMS4wMDAyNiwgMSwgMS4wMDAyNiwgMSwgMS4wMDA2LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAxLCAwLjk5OTgyLCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDI2LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAxLjAwMDM0LCAwLjk5OTc3LCAxLCAwLjk5OTk3LCAxLjAwMDI2LCAxLjAwMDc4LCAxLjAwMDM2LCAwLjk5OTczLCAxLjAwMDEzLCAxLjAwMDYsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5ODgsIDAuODUxNDgsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwNiwgMC45OTk3NywgMS4wMDAwMSwgMC45OTk5OSwgMC45OTk3NywgMS4wMDA2OSwgMS4wMDAyMiwgMC45OTk3NywgMS4wMDAwMSwgMC45OTk4NCwgMS4wMDAyNiwgMS4wMDAwMSwgMS4wMDAyNCwgMS4wMDAwMSwgMC45OTk5LCAxLCAxLjAwMDYsIDEuMDAwMDEsIDEuMDAwNDEsIDAuOTk5NjIsIDEuMDAwMjYsIDEuMDAwNiwgMC45OTk5NSwgMS4wMDA0MSwgMC45OTk0MiwgMC45OTk3MywgMC45OTkyNywgMS4wMDA4MiwgMC45OTkwMiwgMS4wMDAyNiwgMS4wMDA4NywgMS4wMDA2LCAxLjAwMDY5LCAwLjk5OTczLCAwLjk5ODY3LCAwLjk5OTczLCAwLjk5OTMsIDEuMDAwMjYsIDEuMDAwNDksIDEuMDAwNTYsIDEsIDAuOTk5ODgsIDAuOTk5MzUsIDAuOTk5OTUsIDAuOTk5NTQsIDEuMDAwNTUsIDAuOTk5NDUsIDEuMDAwMzIsIDEuMDAwNiwgMC45OTk5NSwgMS4wMDAyNiwgMC45OTk5NSwgMS4wMDAzMiwgMS4wMDAwMSwgMS4wMDAwOCwgMC45OTk3MSwgMS4wMDAxOSwgMC45OTk0LCAxLjAwMDAxLCAxLjAwMDYsIDEuMDAwNDQsIDAuOTk5NzMsIDEuMDAwMjMsIDEuMDAwNDcsIDEsIDAuOTk5NDIsIDAuOTk1NjEsIDAuOTk5ODksIDEuMDAwMzUsIDAuOTk5NzcsIDEuMDAwMzUsIDAuOTk5NzcsIDEuMDAwMTksIDAuOTk5NDQsIDEuMDAwMDEsIDEuMDAwMjEsIDAuOTk5MjYsIDEuMDAwMzUsIDEuMDAwMzUsIDAuOTk5NDIsIDEuMDAwNDgsIDAuOTk5OTksIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwMzUsIDEuMDAwMDEsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5ODksIDEuMDAwNTcsIDEuMDAwMDEsIDAuOTk5MzYsIDEuMDAwNTIsIDEuMDAwMTIsIDAuOTk5OTYsIDEuMDAwNDMsIDEsIDEuMDAwMzUsIDAuOTk5NCwgMC45OTk3NiwgMS4wMDAzNSwgMC45OTk3MywgMS4wMDA1MiwgMS4wMDA0MSwgMS4wMDExOSwgMS4wMDAzNywgMC45OTk3MywgMS4wMDAwMiwgMC45OTk4NiwgMS4wMDA0MSwgMS4wMDA0MSwgMC45OTkwMiwgMC45OTk2LCAxLjAwMDM0LCAwLjk5OTk5LCAxLjAwMDI2LCAwLjk5OTk5LCAxLjAwMDI2LCAwLjk5OTczLCAxLjAwMDUyLCAwLjk5OTczLCAxLCAwLjk5OTczLCAxLjAwMDQxLCAxLjAwMDc1LCAwLjk5OTQsIDEuMDAwMywgMC45OTk5OSwgMSwgMS4wMDA0MSwgMC45OTk1NSwgMSwgMC45OTkxNSwgMC45OTk3MywgMC45OTk3MywgMS4wMDAyNiwgMS4wMDExOSwgMC45OTk1NSwgMC45OTk3MywgMS4wMDA2LCAwLjk5OTExLCAxLjAwMDYsIDEuMDAwMjYsIDAuOTk5NzIsIDEuMDAwMjYsIDAuOTk5MDIsIDEuMDAwNDEsIDAuOTk5NzMsIDAuOTk5OTksIDEsIDEsIDEuMDAwMzgsIDEuMDAwNSwgMS4wMDAxNiwgMS4wMDAyMiwgMS4wMDAxNiwgMS4wMDAyMiwgMS4wMDAxNiwgMS4wMDAyMiwgMS4wMDAwMSwgMC45OTk3MywgMSwgMSwgMC45OTk3MywgMSwgMSwgMC45OTk1NSwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLCAxLCAxLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTcyLCAxLCAxLCAxLjAwMTA2LCAwLjk5OTk5LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk5LCAwLjk5OTk4LCAxLjY2NDc1LCAxLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDIzLCAwLjk5OTczLCAwLjk5OTcxLCAxLjAwMDQ3LCAxLjAwMDIzLCAxLCAwLjk5OTkxLCAwLjk5OTg0LCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDAyLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk5OTcyLCAxLCAxLjIwOTg1LCAxLjM5NzEzLCAxLjAwMDAzLCAxLjAwMDMxLCAxLjAwMDE1LCAxLCAwLjk5NTYxLCAxLjAwMDI3LCAxLjAwMDMxLCAxLjAwMDMxLCAwLjk5OTE1LCAxLjAwMDMxLCAxLjAwMDMxLCAwLjk5OTk5LCAxLjAwMDAzLCAwLjk5OTk5LCAwLjk5OTk5LCAxLjQxMTQ0LCAxLjYsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDA1NzksIDEuNDA1NzksIDEuMzY2MjUsIDAuOTk5OTksIDEsIDAuOTk4NjEsIDAuOTk4NjEsIDEsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDAuOTk5NzIsIDAuOTk5OTksIDAuOTk5OTksIDAuOTk5OTksIDAuOTk5OTksIDEuNDA0ODMsIDEsIDAuOTk5NzcsIDEuMDAwNTQsIDEsIDEsIDAuOTk5NTMsIDAuOTk5NjIsIDEuMDAwNDIsIDAuOTk5NSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07CmV4cG9ydHMuSGVsdmV0aWNhQm9sZEZhY3RvcnMgPSBIZWx2ZXRpY2FCb2xkRmFjdG9yczsKY29uc3QgSGVsdmV0aWNhQm9sZE1ldHJpY3MgPSB7CiAgbGluZUhlaWdodDogMS4yLAogIGxpbmVHYXA6IDAuMgp9OwpleHBvcnRzLkhlbHZldGljYUJvbGRNZXRyaWNzID0gSGVsdmV0aWNhQm9sZE1ldHJpY3M7CmNvbnN0IEhlbHZldGljYUJvbGRJdGFsaWNGYWN0b3JzID0gWzAuNzYxMTYsIDEsIDEsIDEuMDAwNiwgMC45OTk5OCwgMC45OTk3NCwgMC45OTk3MywgMC45OTk3MywgMC45OTk4MiwgMC45OTk3NywgMS4wMDA4NywgMC45OTk5OCwgMC45OTk5OCwgMC45OTk1OSwgMS4wMDAwMywgMS4wMDA2LCAwLjk5OTk4LCAxLjAwMDYsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk5OCwgMSwgMS4wMDAwMywgMS4wMDAwMywgMS4wMDAwMywgMS4wMDAyNiwgMC45OTk5LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDI2LCAxLjAwMDIyLCAwLjk5OTc3LCAxLjAwMDYsIDAuOTk5NzMsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5OTksIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwMDEsIDEuMDAwMjIsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMTYsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5OTgsIDEuMDAwNiwgMC45OTk5OCwgMS4wMDAwMywgMC45OTk3MywgMC45OTk5OCwgMC45OTk3MywgMS4wMDAyNiwgMC45OTk3MywgMS4wMDAyNiwgMC45OTk3MywgMC45OTk5OCwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NzMsIDEuMDAwNiwgMC45OTk4MiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMC45OTk1OSwgMC45OTk3MywgMC45OTk5OCwgMS4wMDAyNiwgMC45OTk3MywgMS4wMDAyMiwgMC45OTk3MywgMC45OTk3MywgMSwgMC45OTk1OSwgMS4wMDA3NywgMC45OTk1OSwgMS4wMDAwMywgMC45OTk5OCwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wMDA3NywgMC45OTk3MywgMC45OTk5OCwgMS4wMDAyNSwgMC45OTk2OCwgMC45OTk3MywgMS4wMDAwMywgMS4wMDAyNSwgMC42MDI5OSwgMS4wMDAyNCwgMS4wNjQwOSwgMSwgMSwgMC45OTk5OCwgMSwgMC45OTk3MywgMS4wMDA2LCAwLjk5OTk4LCAxLCAwLjk5OTM2LCAwLjk5OTczLCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDI2LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAxLCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NzcsIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMDMsIDEuMDAwMjIsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5ODIsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wNjQwOSwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMC45OTk3MywgMS4wMDAyNiwgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMS4wMDQ0LCAwLjk5OTc3LCAxLjAwMDI2LCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAwLjk5OTc3LCAxLjAwMDI2LCAwLjk5OTc3LCAxLjAwMDI2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NzEsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwNiwgMC45OTk3NywgMC45OTk3MywgMC45OTk3MywgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDI2LCAxLjAwMDYsIDEuMDAwMjYsIDEuMDEwMTEsIDEuMDAwMjYsIDAuOTk5OTksIDEuMDAwMjYsIDEuMDAwNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTkzLCAwLjk5OTgsIDEuMDAwMjYsIDEuMDAwMjIsIDEuMDAwMjYsIDEuMDAwMjIsIDEuMDAwMjYsIDEuMDAwMjIsIDEuMDAwMjYsIDEsIDEuMDAwMTYsIDAuOTk5NzcsIDAuOTk5NTksIDAuOTk5NzcsIDAuOTk5NTksIDAuOTk5NzcsIDAuOTk5NTksIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMjYsIDAuOTk5OTgsIDEuMDAwMjYsIDAuODEyMSwgMS4wMDAyNiwgMC45OTk5OCwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMS4wMDAxNiwgMS4wMDAyMiwgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMS4wMDAyNiwgMSwgMS4wMDAyNiwgMSwgMS4wMDAyNiwgMSwgMS4wMDA2LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAxLCAwLjk5OTgyLCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDI2LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTc3LCAxLCAxLCAxLjAwMDI2LCAwLjk5OTY5LCAwLjk5OTcyLCAwLjk5OTgxLCAwLjk5OTgsIDEuMDAwNiwgMC45OTk3NywgMC45OTk3NywgMS4wMDAyMiwgMC45MTE1NSwgMS4wMDAwMSwgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyMiwgMS4wMDA2LCAwLjk5OTc3LCAxLjAwMDAxLCAwLjk5OTk5LCAwLjk5OTc3LCAwLjk5OTY2LCAxLjAwMDIyLCAxLjAwMDMyLCAxLjAwMDAxLCAwLjk5OTQ0LCAxLjAwMDI2LCAxLjAwMDAxLCAwLjk5OTY4LCAxLjAwMDAxLCAxLjAwMDQ3LCAxLCAxLjAwMDYsIDEuMDAwMDEsIDAuOTk5ODEsIDEuMDAxMDEsIDEuMDAwMjYsIDEuMDAwNiwgMC45OTk0OCwgMC45OTk4MSwgMS4wMDA2NCwgMC45OTk3MywgMC45OTk0MiwgMS4wMDEwMSwgMS4wMDA2MSwgMS4wMDAyNiwgMS4wMDA2OSwgMS4wMDA2LCAxLjAwMDE0LCAwLjk5OTczLCAxLjAxMzIyLCAwLjk5OTczLCAxLjAwMDY1LCAxLjAwMDI2LCAxLjAwMDEyLCAwLjk5OTIzLCAxLCAxLjAwMDY0LCAxLjAwMDc2LCAwLjk5OTQ4LCAxLjAwMDU1LCAxLjAwMDYzLCAxLjAwMDA3LCAwLjk5OTQzLCAxLjAwMDYsIDAuOTk5NDgsIDEuMDAwMjYsIDAuOTk5NDgsIDAuOTk5NDMsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMjksIDEuMDAwMzgsIDEuMDAwMzUsIDEuMDAwMDEsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTczLCAwLjk5OTc4LCAxLjAwMDAxLCAxLjAwMDU3LCAwLjk5OTg5LCAwLjk5OTY3LCAwLjk5OTY0LCAwLjk5OTY3LCAwLjk5OTc3LCAwLjk5OTk5LCAwLjk5OTc3LCAxLjAwMDM4LCAwLjk5OTc3LCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDY2LCAwLjk5OTY3LCAwLjk5OTY3LCAxLjAwMDQxLCAwLjk5OTk4LCAwLjk5OTk5LCAwLjk5OTc3LCAxLjAwMDIyLCAwLjk5OTY3LCAxLjAwMDAxLCAwLjk5OTc3LCAxLjAwMDI2LCAwLjk5OTY0LCAxLjAwMDMxLCAxLjAwMDAxLCAwLjk5OTk5LCAwLjk5OTk5LCAxLCAxLjAwMDIzLCAxLCAxLCAwLjk5OTk5LCAxLjAwMDM1LCAxLjAwMDAxLCAwLjk5OTk5LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTk5LCAxLjAwMDU4LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTU1LCAwLjk5OTUsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMzIsIDAuOTk5ODksIDEuMDAwMzQsIDAuOTk5OTksIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDAuOTk5NzMsIDAuNDU5OTgsIDAuOTk5NzMsIDEuMDAwMjYsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5OTksIDAuOTk5ODIsIDAuOTk5OTQsIDAuOTk5OTYsIDEsIDEuMDAwNDIsIDEuMDAwNDQsIDEuMDAwMjksIDEuMDAwMjMsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwMjYsIDAuOTk5NDksIDEuMDAwMDIsIDAuOTk5NzMsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NzUsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMzIsIDAuOTg2ODUsIDAuOTk5NzMsIDEuMDAwMjYsIDEsIDEsIDAuOTk5NjYsIDEuMDAwNDQsIDEuMDAwMTYsIDEuMDAwMjIsIDEuMDAwMTYsIDEuMDAwMjIsIDEuMDAwMTYsIDEuMDAwMjIsIDEuMDAwMDEsIDAuOTk5NzMsIDEsIDEsIDAuOTk5NzMsIDEsIDEsIDAuOTk5NTUsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMSwgMSwgMSwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MiwgMSwgMSwgMS4wMDEwNiwgMC45OTk5OSwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OSwgMC45OTk5OCwgMS42NjQ3NSwgMSwgMC45OTk3MywgMC45OTk3MywgMSwgMC45OTk3MywgMC45OTk3MSwgMC45OTk3OCwgMSwgMSwgMC45OTk5MSwgMC45OTk4NCwgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDA5OCwgMSwgMSwgMSwgMS4wMDA0OSwgMSwgMSwgMC45OTk3MiwgMSwgMS4yMDk4NSwgMS4zOTcxMywgMS4wMDAwMywgMS4wMDAzMSwgMS4wMDAxNSwgMSwgMC45OTU2MSwgMS4wMDAyNywgMS4wMDAzMSwgMS4wMDAzMSwgMC45OTkxNSwgMS4wMDAzMSwgMS4wMDAzMSwgMC45OTk5OSwgMS4wMDAwMywgMC45OTk5OSwgMC45OTk5OSwgMS40MTE0NCwgMS42LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQwNTc5LCAxLjQwNTc5LCAxLjM2NjI1LCAwLjk5OTk5LCAxLCAwLjk5ODYxLCAwLjk5ODYxLCAxLCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAwLjk5OTcyLCAwLjk5OTk5LCAwLjk5OTk5LCAwLjk5OTk5LCAwLjk5OTk5LCAxLjQwNDgzLCAxLCAwLjk5OTc3LCAxLjAwMDU0LCAxLCAxLCAwLjk5OTUzLCAwLjk5OTYyLCAxLjAwMDQyLCAwLjk5OTUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLkhlbHZldGljYUJvbGRJdGFsaWNGYWN0b3JzID0gSGVsdmV0aWNhQm9sZEl0YWxpY0ZhY3RvcnM7CmNvbnN0IEhlbHZldGljYUJvbGRJdGFsaWNNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMzUsCiAgbGluZUdhcDogMC4yCn07CmV4cG9ydHMuSGVsdmV0aWNhQm9sZEl0YWxpY01ldHJpY3MgPSBIZWx2ZXRpY2FCb2xkSXRhbGljTWV0cmljczsKY29uc3QgSGVsdmV0aWNhSXRhbGljRmFjdG9ycyA9IFswLjc2MTE2LCAxLCAxLCAxLjAwMDYsIDEuMDAwNiwgMS4wMDAwNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk4MiwgMS4wMDAwMSwgMS4wMDA0MywgMC45OTk5OCwgMC45OTk5OCwgMC45OTk1OSwgMS4wMDAwMywgMS4wMDA2LCAwLjk5OTk4LCAxLjAwMDYsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wMDA2LCAxLCAxLjAwMDAzLCAxLjAwMDAzLCAxLjAwMDAzLCAwLjk5OTczLCAwLjk5OTg3LCAxLjAwMDAxLCAxLjAwMDAxLCAwLjk5OTc3LCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDI2LCAxLjAwMDIyLCAwLjk5OTc3LCAxLjAwMDYsIDEsIDEuMDAwMDEsIDAuOTk5NzMsIDAuOTk5OTksIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwMDEsIDEuMDAwMjIsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMTYsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMjYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NDksIDAuOTk5NzMsIDAuOTk5OTgsIDAuOTk5NzMsIDAuOTk5NzMsIDEsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3MywgMC45OTkyNCwgMC45OTkyNCwgMSwgMC45OTkyNCwgMC45OTk5OSwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk5OCwgMSwgMS4wMDA2LCAwLjk5OTczLCAxLCAwLjk5OTc3LCAxLCAxLCAxLCAxLjAwMDA1LCAxLjAwMDksIDEuMDAwMDUsIDEuMDAwMDMsIDAuOTk5OTgsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwOSwgMC45OTk3MywgMC45OTk5OCwgMS4wMDAyNSwgMC45OTk2OCwgMC45OTk3MywgMS4wMDAwMywgMS4wMDAyNSwgMC42MDI5OSwgMS4wMDAyNCwgMS4wNjQwOSwgMSwgMSwgMC45OTk5OCwgMSwgMC45OTk4LCAxLjAwMDYsIDAuOTk5OTgsIDEsIDAuOTk5MzYsIDAuOTk5NzMsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMjYsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMC45OTk3NywgMC45OTk3NywgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAwMywgMS4wMDAyMiwgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAyNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk4MiwgMSwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAxLjA2NDA5LCAxLjAwMDI2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAxLCAwLjk5OTczLCAxLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAwLjk5OTc3LCAxLCAwLjk5OTc3LCAxLCAwLjk5OTc3LCAxLCAwLjk5OTc3LCAxLCAwLjk5OTc3LCAxLjAyODgsIDAuOTk5NzcsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMC45OTkyNCwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NDYsIDEuMDAwMzQsIDEsIDAuOTk5MjQsIDEuMDAwMDEsIDEsIDEsIDAuOTk5NzMsIDAuOTk5MjQsIDAuOTk5NzMsIDAuOTk5MjQsIDAuOTk5NzMsIDEuMDYzMTEsIDAuOTk5NzMsIDEuMDAwMjQsIDAuOTk5NzMsIDAuOTk5MjQsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDEuMDAwNDEsIDAuOTk5OCwgMC45OTk3MywgMS4wMDAyMiwgMC45OTk3MywgMS4wMDAyMiwgMC45OTk3MywgMS4wMDAyMiwgMC45OTk3MywgMSwgMS4wMDAxNiwgMC45OTk3NywgMC45OTk5OCwgMC45OTk3NywgMC45OTk5OCwgMC45OTk3NywgMC45OTk5OCwgMS4wMDAwMSwgMSwgMS4wMDAwMSwgMSwgMS4wMDAwMSwgMSwgMS4wMDAwMSwgMSwgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDI2LCAwLjg5NTQ3LCAxLjAwMDI2LCAxLjAwMDYsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDEuMDAwMTYsIDAuOTk5NzcsIDEuMDAwMDEsIDEsIDEuMDAwMDEsIDEuMDAwMjYsIDEsIDEuMDAwMjYsIDEsIDEuMDAwMjYsIDEsIDAuOTk5MjQsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEsIDAuOTk5ODIsIDEuMDAwMjIsIDEuMDAwMjYsIDEuMDAwMDEsIDEsIDEuMDAwMjYsIDEuMDAwNiwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMS4wMDAwMSwgMSwgMS4wMDA1NCwgMC45OTk3NywgMS4wMDA4NCwgMS4wMDAwNywgMC45OTk3MywgMS4wMDAxMywgMC45OTkyNCwgMS4wMDAwMSwgMS4wMDAwMSwgMC45OTk0NSwgMC45MTIyMSwgMS4wMDAwMSwgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyMiwgMS4wMDA2LCAxLjAwMDAxLCAxLjAwMDAxLCAwLjk5OTk5LCAwLjk5OTc3LCAwLjk5OTMzLCAxLjAwMDIyLCAxLjAwMDU0LCAxLjAwMDAxLCAxLjAwMDY1LCAxLjAwMDI2LCAxLjAwMDAxLCAxLjAwMDEsIDEuMDAwMDEsIDEuMDAwNTIsIDEsIDEuMDAwNiwgMS4wMDAwMSwgMC45OTk0NSwgMC45OTg5NywgMC45OTk2OCwgMC45OTkyNCwgMS4wMDAzNiwgMC45OTk0NSwgMC45OTk0OSwgMSwgMS4wMDA2LCAwLjk5ODk3LCAwLjk5OTE4LCAwLjk5OTY4LCAwLjk5OTExLCAwLjk5OTI0LCAxLCAwLjk5OTYyLCAxLjAxNDg3LCAxLCAxLjAwMDUsIDAuOTk5NzMsIDEuMDAwMTIsIDEuMDAwNDMsIDEsIDAuOTk5OTUsIDAuOTk5OTQsIDEuMDAwMzYsIDAuOTk5NDcsIDEuMDAwMTksIDEuMDAwNjMsIDEuMDAwMjUsIDAuOTk5MjQsIDEuMDAwMzYsIDAuOTk5NzMsIDEuMDAwMzYsIDEuMDAwMjUsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMjcsIDEuMDAwMSwgMS4wMDA2OCwgMS4wMDAwMSwgMS4wMDA2LCAxLjAwMDYsIDEsIDEuMDAwMDgsIDAuOTk5NTcsIDAuOTk5NzIsIDAuOTk5NCwgMC45OTk1NCwgMC45OTk3NSwgMS4wMDA1MSwgMS4wMDAwMSwgMS4wMDAxOSwgMS4wMDAwMSwgMS4wMDAxLCAwLjk5OTg2LCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDM4LCAwLjk5OTU0LCAwLjk5OTU0LCAwLjk5OTQsIDEuMDAwNjYsIDAuOTk5OTksIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwNTQsIDEuMDAwMDEsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzUsIDEuMDAwMSwgMS4wMDAwMSwgMC45OTk5MywgMC45OTk1LCAwLjk5OTU1LCAxLjAwMDE2LCAwLjk5OTc4LCAwLjk5OTc0LCAxLjAwMDE5LCAxLjAwMDIyLCAwLjk5OTU1LCAxLjAwMDUzLCAwLjk5OTczLCAxLjAwMDg5LCAxLjAwMDA1LCAwLjk5OTY3LCAxLjAwMDQ4LCAwLjk5OTczLCAxLjAwMDAyLCAxLjAwMDM0LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTY0LCAxLjAwMDA2LCAxLjAwMDY2LCAwLjk5OTQ3LCAwLjk5OTczLCAwLjk4ODk0LCAwLjk5OTczLCAxLCAwLjQ0ODk4LCAxLCAwLjk5OTQ2LCAxLCAxLjAwMDM5LCAxLjAwMDgyLCAwLjk5OTkxLCAwLjk5OTkxLCAwLjk5OTg1LCAxLjAwMDIyLCAxLjAwMDIzLCAxLjAwMDYxLCAxLjAwMDA2LCAwLjk5OTY2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDE5LCAxLjAwMDgsIDEsIDAuOTk5MjQsIDAuOTk5MjQsIDAuOTk5MjQsIDAuOTk5ODMsIDEuMDAwNDQsIDAuOTk5NzMsIDAuOTk5NjQsIDAuOTgzMzIsIDEsIDAuOTk5NzMsIDEsIDEsIDAuOTk5NjIsIDAuOTk4OTUsIDEuMDAwMTYsIDAuOTk5NzcsIDEuMDAwMTYsIDAuOTk5NzcsIDEuMDAwMTYsIDAuOTk5NzcsIDEuMDAwMDEsIDEsIDEsIDEsIDAuOTk5NzMsIDEsIDEsIDAuOTk5NTUsIDAuOTk5MjQsIDAuOTk5MjQsIDAuOTk5MjQsIDAuOTk5MjQsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzIsIDEsIDEsIDEuMDAyNjcsIDAuOTk5OTksIDAuOTk5OTgsIDAuOTk5OTgsIDEsIDAuOTk5OTgsIDEuNjY0NzUsIDEsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwMjMsIDAuOTk5NzMsIDEuMDA0MjMsIDAuOTk5MjUsIDAuOTk5OTksIDEsIDAuOTk5OTEsIDAuOTk5ODQsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwNDksIDEsIDEuMDAyNDUsIDEsIDEsIDEsIDEsIDAuOTYzMjksIDEsIDEuMjA5ODUsIDEuMzk3MTMsIDEuMDAwMDMsIDAuODI1NCwgMS4wMDAxNSwgMSwgMS4wMDAzNSwgMS4wMDAyNywgMS4wMDAzMSwgMS4wMDAzMSwgMS4wMDAwMywgMS4wMDAzMSwgMS4wMDAzMSwgMC45OTk5OSwgMS4wMDAwMywgMC45OTk5OSwgMC45OTk5OSwgMS40MTE0NCwgMS42LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQwNTc5LCAxLjQwNTc5LCAxLjM2NjI1LCAwLjk5OTk5LCAxLCAwLjk5ODYxLCAwLjk5ODYxLCAxLCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAwLjk1MzE3LCAwLjk5OTk5LCAwLjk5OTk5LCAwLjk5OTk5LCAwLjk5OTk5LCAxLjQwNDgzLCAxLCAwLjk5OTc3LCAxLjAwMDU0LCAxLCAxLCAwLjk5OTUzLCAwLjk5OTYyLCAxLjAwMDQyLCAwLjk5OTUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLkhlbHZldGljYUl0YWxpY0ZhY3RvcnMgPSBIZWx2ZXRpY2FJdGFsaWNGYWN0b3JzOwpjb25zdCBIZWx2ZXRpY2FJdGFsaWNNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMzUsCiAgbGluZUdhcDogMC4yCn07CmV4cG9ydHMuSGVsdmV0aWNhSXRhbGljTWV0cmljcyA9IEhlbHZldGljYUl0YWxpY01ldHJpY3M7CmNvbnN0IEhlbHZldGljYVJlZ3VsYXJGYWN0b3JzID0gWzAuNzYxMTYsIDEsIDEsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDA2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTgyLCAxLjAwMDAxLCAxLjAwMDQzLCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTU5LCAxLjAwMDAzLCAxLjAwMDYsIDAuOTk5OTgsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDYsIDEsIDEuMDAwMDMsIDEuMDAwMDMsIDEuMDAwMDMsIDAuOTk5NzMsIDAuOTk5ODcsIDEuMDAwMDEsIDEuMDAwMDEsIDAuOTk5NzcsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMjYsIDEuMDAwMjIsIDAuOTk5NzcsIDEuMDAwNiwgMSwgMS4wMDAwMSwgMC45OTk3MywgMC45OTk5OSwgMC45OTk3NywgMS4wMDAyMiwgMS4wMDAwMSwgMS4wMDAyMiwgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAxNiwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMC45OTk0OSwgMC45OTk3MywgMC45OTk5OCwgMC45OTk3MywgMC45OTk3MywgMSwgMC45OTk3MywgMC45OTk3MywgMS4wMDA2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTI0LCAwLjk5OTI0LCAxLCAwLjk5OTI0LCAwLjk5OTk5LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTk4LCAxLCAxLjAwMDYsIDAuOTk5NzMsIDEsIDAuOTk5NzcsIDEsIDEsIDEsIDEuMDAwMDUsIDEuMDAwOSwgMS4wMDAwNSwgMS4wMDAwMywgMC45OTk5OCwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wMDA5LCAwLjk5OTczLCAwLjk5OTk4LCAxLjAwMDI1LCAwLjk5OTY4LCAwLjk5OTczLCAxLjAwMDAzLCAxLjAwMDI1LCAwLjYwMjk5LCAxLjAwMDI0LCAxLjA2NDA5LCAxLCAxLCAwLjk5OTk4LCAxLCAwLjk5OTgsIDEuMDAwNiwgMC45OTk5OCwgMSwgMC45OTkzNiwgMC45OTk3MywgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDAyNiwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAwMSwgMSwgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTc3LCAwLjk5OTc3LCAxLjAwMDIyLCAxLjAwMDIyLCAxLjAwMDIyLCAxLjAwMDIyLCAxLjAwMDIyLCAxLjAwMDAzLCAxLjAwMDIyLCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDI2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTgyLCAxLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDY0MDksIDEuMDAwMjYsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDEsIDAuOTk5NzMsIDEsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDAuOTk5NzcsIDEsIDAuOTk5NzcsIDEsIDAuOTk5NzcsIDEsIDAuOTk5NzcsIDEsIDAuOTk5NzcsIDEuMDQ1OTYsIDAuOTk5NzcsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMC45OTkyNCwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwMTksIDEuMDAwMzQsIDEsIDAuOTk5MjQsIDEuMDAwMDEsIDEsIDEsIDAuOTk5NzMsIDAuOTk5MjQsIDAuOTk5NzMsIDAuOTk5MjQsIDAuOTk5NzMsIDEuMDI1NzIsIDAuOTk5NzMsIDEuMDAwMDUsIDAuOTk5NzMsIDAuOTk5MjQsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5OTksIDAuOTk5OCwgMC45OTk3MywgMS4wMDAyMiwgMC45OTk3MywgMS4wMDAyMiwgMC45OTk3MywgMS4wMDAyMiwgMC45OTk3MywgMSwgMS4wMDAxNiwgMC45OTk3NywgMC45OTk5OCwgMC45OTk3NywgMC45OTk5OCwgMC45OTk3NywgMC45OTk5OCwgMS4wMDAwMSwgMSwgMS4wMDAwMSwgMSwgMS4wMDAwMSwgMSwgMS4wMDAwMSwgMSwgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDI2LCAwLjg0NTMzLCAxLjAwMDI2LCAxLjAwMDYsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDEuMDAwMTYsIDAuOTk5NzcsIDEuMDAwMDEsIDEsIDEuMDAwMDEsIDEuMDAwMjYsIDEsIDEuMDAwMjYsIDEsIDEuMDAwMjYsIDEsIDAuOTk5MjQsIDAuOTk5NzMsIDEuMDAwMDEsIDAuOTk5NzMsIDEsIDAuOTk5ODIsIDEuMDAwMjIsIDEuMDAwMjYsIDEuMDAwMDEsIDEsIDEuMDAwMjYsIDEuMDAwNiwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTkyOCwgMSwgMC45OTk3NywgMS4wMDAxMywgMS4wMDA1NSwgMC45OTk0NywgMC45OTk0NSwgMC45OTk0MSwgMC45OTkyNCwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDA0LCAwLjkxNjIxLCAxLjAwMDAxLCAxLjAwMDI2LCAwLjk5OTc3LCAxLjAwMDIyLCAxLjAwMDYsIDEuMDAwMDEsIDEuMDAwMDUsIDAuOTk5OTksIDAuOTk5NzcsIDEuMDAwMTUsIDEuMDAwMjIsIDAuOTk5NzcsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMjYsIDEuMDAwMDEsIDEuMDAwMTksIDEuMDAwMDEsIDAuOTk5NDYsIDEsIDEuMDAwNiwgMS4wMDAwMSwgMC45OTk3OCwgMS4wMDA0NSwgMC45OTk3MywgMC45OTkyNCwgMS4wMDAyMywgMC45OTk3OCwgMC45OTk2NiwgMSwgMS4wMDA2NSwgMS4wMDA0NSwgMS4wMDAxOSwgMC45OTk3MywgMC45OTk3MywgMC45OTkyNCwgMSwgMSwgMC45NjQ5OSwgMSwgMS4wMDA1NSwgMC45OTk3MywgMS4wMDAwOCwgMS4wMDAyNywgMSwgMC45OTk3LCAwLjk5OTk1LCAxLjAwMDIzLCAwLjk5OTMzLCAxLjAwMDE5LCAxLjAwMDE1LCAxLjAwMDMxLCAwLjk5OTI0LCAxLjAwMDIzLCAwLjk5OTczLCAxLjAwMDIzLCAxLjAwMDMxLCAxLjAwMDAxLCAwLjk5OTI4LCAxLjAwMDI5LCAxLjAwMDkyLCAxLjAwMDM1LCAxLjAwMDAxLCAxLjAwMDYsIDEuMDAwNiwgMSwgMC45OTk4OCwgMC45OTk3NSwgMSwgMS4wMDA4MiwgMC45OTU2MSwgMC45OTk2LCAxLjAwMDM1LCAxLjAwMDAxLCAwLjk5OTYyLCAxLjAwMDAxLCAxLjAwMDkyLCAwLjk5OTY0LCAxLjAwMDAxLCAwLjk5OTYzLCAwLjk5OTk5LCAxLjAwMDM1LCAxLjAwMDM1LCAxLjAwMDgyLCAwLjk5OTYyLCAwLjk5OTk5LCAwLjk5OTc3LCAxLjAwMDIyLCAxLjAwMDM1LCAxLjAwMDAxLCAwLjk5OTc3LCAxLjAwMDI2LCAwLjk5OTYsIDAuOTk5NjcsIDEuMDAwMDEsIDEuMDAwMzQsIDEuMDAwNzQsIDEuMDAwNTQsIDEuMDAwNTMsIDEuMDAwNjMsIDAuOTk5NzEsIDAuOTk5NjIsIDEuMDAwMzUsIDAuOTk5NzUsIDAuOTk5NzcsIDAuOTk5NzMsIDEuMDAwNDMsIDAuOTk5NTMsIDEuMDAwNywgMC45OTkxNSwgMC45OTk3MywgMS4wMDAwOCwgMC45OTg5MiwgMS4wMDA3MywgMS4wMDA3MywgMS4wMDExNCwgMC45OTkxNSwgMS4wMDA3MywgMC45OTk1NSwgMC45OTk3MywgMS4wMDA5MiwgMC45OTk3MywgMSwgMC45OTk5OCwgMSwgMS4wMDAzLCAxLCAxLjAwMDQzLCAxLjAwMDAxLCAwLjk5OTY5LCAxLjAwMDMsIDEsIDEuMDAwMzUsIDEuMDAwMDEsIDAuOTk5NSwgMSwgMS4wMDA5MiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wMDA3LCAwLjk5OTUsIDEsIDAuOTk5MjQsIDEuMDAwNiwgMC45OTkyNCwgMC45OTk3MiwgMS4wMDA2MiwgMC45OTk3MywgMS4wMDExNCwgMS4wMDA3MywgMSwgMC45OTk1NSwgMSwgMSwgMS4wMDA0NywgMC45OTk2OCwgMS4wMDAxNiwgMC45OTk3NywgMS4wMDAxNiwgMC45OTk3NywgMS4wMDAxNiwgMC45OTk3NywgMS4wMDAwMSwgMSwgMSwgMSwgMC45OTk3MywgMSwgMSwgMC45OTk1NSwgMC45OTkyNCwgMC45OTkyNCwgMC45OTkyNCwgMC45OTkyNCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MiwgMSwgMSwgMS4wMDI2NywgMC45OTk5OSwgMC45OTk5OCwgMC45OTk5OCwgMSwgMC45OTk5OCwgMS42NjQ3NSwgMSwgMC45OTk3MywgMC45OTk3MywgMS4wMDAyMywgMC45OTk3MywgMC45OTk3MSwgMC45OTkyNSwgMS4wMDAyMywgMSwgMC45OTk5MSwgMC45OTk4NCwgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDAwMiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45NjMyOSwgMSwgMS4yMDk4NSwgMS4zOTcxMywgMS4wMDAwMywgMC44MjU0LCAxLjAwMDE1LCAxLCAxLjAwMDM1LCAxLjAwMDI3LCAxLjAwMDMxLCAxLjAwMDMxLCAwLjk5OTE1LCAxLjAwMDMxLCAxLjAwMDMxLCAwLjk5OTk5LCAxLjAwMDAzLCAwLjk5OTk5LCAwLjk5OTk5LCAxLjQxMTQ0LCAxLjYsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDExNDQsIDEuNDA1NzksIDEuNDA1NzksIDEuMzY2MjUsIDAuOTk5OTksIDEsIDAuOTk4NjEsIDAuOTk4NjEsIDEsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDAuOTUzMTcsIDAuOTk5OTksIDAuOTk5OTksIDAuOTk5OTksIDAuOTk5OTksIDEuNDA0ODMsIDEsIDAuOTk5NzcsIDEuMDAwNTQsIDEsIDEsIDAuOTk5NTMsIDAuOTk5NjIsIDEuMDAwNDIsIDAuOTk5NSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07CmV4cG9ydHMuSGVsdmV0aWNhUmVndWxhckZhY3RvcnMgPSBIZWx2ZXRpY2FSZWd1bGFyRmFjdG9yczsKY29uc3QgSGVsdmV0aWNhUmVndWxhck1ldHJpY3MgPSB7CiAgbGluZUhlaWdodDogMS4yLAogIGxpbmVHYXA6IDAuMgp9OwpleHBvcnRzLkhlbHZldGljYVJlZ3VsYXJNZXRyaWNzID0gSGVsdmV0aWNhUmVndWxhck1ldHJpY3M7CgovKioqLyB9KSwKLyogMTc5ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJXaWR0aHMgPSBleHBvcnRzLkxpYmVyYXRpb25TYW5zUmVndWxhck1hcHBpbmcgPSBleHBvcnRzLkxpYmVyYXRpb25TYW5zSXRhbGljV2lkdGhzID0gZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc0l0YWxpY01hcHBpbmcgPSBleHBvcnRzLkxpYmVyYXRpb25TYW5zQm9sZFdpZHRocyA9IGV4cG9ydHMuTGliZXJhdGlvblNhbnNCb2xkTWFwcGluZyA9IGV4cG9ydHMuTGliZXJhdGlvblNhbnNCb2xkSXRhbGljV2lkdGhzID0gZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNNYXBwaW5nID0gdm9pZCAwOwpjb25zdCBMaWJlcmF0aW9uU2Fuc0JvbGRXaWR0aHMgPSBbMzY1LCAwLCAzMzMsIDI3OCwgMzMzLCA0NzQsIDU1NiwgNTU2LCA4ODksIDcyMiwgMjM4LCAzMzMsIDMzMywgMzg5LCA1ODQsIDI3OCwgMzMzLCAyNzgsIDI3OCwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCAzMzMsIDMzMywgNTg0LCA1ODQsIDU4NCwgNjExLCA5NzUsIDcyMiwgNzIyLCA3MjIsIDcyMiwgNjY3LCA2MTEsIDc3OCwgNzIyLCAyNzgsIDU1NiwgNzIyLCA2MTEsIDgzMywgNzIyLCA3NzgsIDY2NywgNzc4LCA3MjIsIDY2NywgNjExLCA3MjIsIDY2NywgOTQ0LCA2NjcsIDY2NywgNjExLCAzMzMsIDI3OCwgMzMzLCA1ODQsIDU1NiwgMzMzLCA1NTYsIDYxMSwgNTU2LCA2MTEsIDU1NiwgMzMzLCA2MTEsIDYxMSwgMjc4LCAyNzgsIDU1NiwgMjc4LCA4ODksIDYxMSwgNjExLCA2MTEsIDYxMSwgMzg5LCA1NTYsIDMzMywgNjExLCA1NTYsIDc3OCwgNTU2LCA1NTYsIDUwMCwgMzg5LCAyODAsIDM4OSwgNTg0LCAzMzMsIDU1NiwgNTU2LCA1NTYsIDU1NiwgMjgwLCA1NTYsIDMzMywgNzM3LCAzNzAsIDU1NiwgNTg0LCA3MzcsIDU1MiwgNDAwLCA1NDksIDMzMywgMzMzLCAzMzMsIDU3NiwgNTU2LCAyNzgsIDMzMywgMzMzLCAzNjUsIDU1NiwgODM0LCA4MzQsIDgzNCwgNjExLCA3MjIsIDcyMiwgNzIyLCA3MjIsIDcyMiwgNzIyLCAxMDAwLCA3MjIsIDY2NywgNjY3LCA2NjcsIDY2NywgMjc4LCAyNzgsIDI3OCwgMjc4LCA3MjIsIDcyMiwgNzc4LCA3NzgsIDc3OCwgNzc4LCA3NzgsIDU4NCwgNzc4LCA3MjIsIDcyMiwgNzIyLCA3MjIsIDY2NywgNjY3LCA2MTEsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDg4OSwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDI3OCwgMjc4LCAyNzgsIDI3OCwgNjExLCA2MTEsIDYxMSwgNjExLCA2MTEsIDYxMSwgNjExLCA1NDksIDYxMSwgNjExLCA2MTEsIDYxMSwgNjExLCA1NTYsIDYxMSwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA3MTksIDcyMiwgNjExLCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDc3OCwgNjExLCA3NzgsIDYxMSwgNzc4LCA2MTEsIDc3OCwgNjExLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgNzg1LCA1NTYsIDU1NiwgMjc4LCA3MjIsIDU1NiwgNTU2LCA2MTEsIDI3OCwgNjExLCAyNzgsIDYxMSwgMzg1LCA2MTEsIDQ3OSwgNjExLCAyNzgsIDcyMiwgNjExLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDcwOCwgNzIzLCA2MTEsIDc3OCwgNjExLCA3NzgsIDYxMSwgNzc4LCA2MTEsIDEwMDAsIDk0NCwgNzIyLCAzODksIDcyMiwgMzg5LCA3MjIsIDM4OSwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDYxMSwgMzMzLCA2MTEsIDQ3OSwgNjExLCAzMzMsIDcyMiwgNjExLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDcyMiwgNjExLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDk0NCwgNzc4LCA2NjcsIDU1NiwgNjY3LCA2MTEsIDUwMCwgNjExLCA1MDAsIDYxMSwgNTAwLCAyNzgsIDU1NiwgNzIyLCA1NTYsIDEwMDAsIDg4OSwgNzc4LCA2MTEsIDY2NywgNTU2LCA2MTEsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCA0NjUsIDcyMiwgMzMzLCA4NTMsIDkwNiwgNDc0LCA4MjUsIDkyNywgODM4LCAyNzgsIDcyMiwgNzIyLCA2MDEsIDcxOSwgNjY3LCA2MTEsIDcyMiwgNzc4LCAyNzgsIDcyMiwgNjY3LCA4MzMsIDcyMiwgNjQ0LCA3NzgsIDcyMiwgNjY3LCA2MDAsIDYxMSwgNjY3LCA4MjEsIDY2NywgODA5LCA4MDIsIDI3OCwgNjY3LCA2MTUsIDQ1MSwgNjExLCAyNzgsIDU4MiwgNjE1LCA2MTAsIDU1NiwgNjA2LCA0NzUsIDQ2MCwgNjExLCA1NDEsIDI3OCwgNTU4LCA1NTYsIDYxMiwgNTU2LCA0NDUsIDYxMSwgNzY2LCA2MTksIDUyMCwgNjg0LCA0NDYsIDU4MiwgNzE1LCA1NzYsIDc1MywgODQ1LCAyNzgsIDU4MiwgNjExLCA1ODIsIDg0NSwgNjY3LCA2NjksIDg4NSwgNTY3LCA3MTEsIDY2NywgMjc4LCAyNzYsIDU1NiwgMTA5NCwgMTA2MiwgODc1LCA2MTAsIDcyMiwgNjIyLCA3MTksIDcyMiwgNzE5LCA3MjIsIDU2NywgNzEyLCA2NjcsIDkwNCwgNjI2LCA3MTksIDcxOSwgNjEwLCA3MDIsIDgzMywgNzIyLCA3NzgsIDcxOSwgNjY3LCA3MjIsIDYxMSwgNjIyLCA4NTQsIDY2NywgNzMwLCA3MDMsIDEwMDUsIDEwMTksIDg3MCwgOTc5LCA3MTksIDcxMSwgMTAzMSwgNzE5LCA1NTYsIDYxOCwgNjE1LCA0MTcsIDYzNSwgNTU2LCA3MDksIDQ5NywgNjE1LCA2MTUsIDUwMCwgNjM1LCA3NDAsIDYwNCwgNjExLCA2MDQsIDYxMSwgNTU2LCA0OTAsIDU1NiwgODc1LCA1NTYsIDYxNSwgNTgxLCA4MzMsIDg0NCwgNzI5LCA4NTQsIDYxNSwgNTUyLCA4NTQsIDU4MywgNTU2LCA1NTYsIDYxMSwgNDE3LCA1NTIsIDU1NiwgMjc4LCAyODEsIDI3OCwgOTY5LCA5MDYsIDYxMSwgNTAwLCA2MTUsIDU1NiwgNjA0LCA3NzgsIDYxMSwgNDg3LCA0NDcsIDk0NCwgNzc4LCA5NDQsIDc3OCwgOTQ0LCA3NzgsIDY2NywgNTU2LCAzMzMsIDMzMywgNTU2LCAxMDAwLCAxMDAwLCA1NTIsIDI3OCwgMjc4LCAyNzgsIDI3OCwgNTAwLCA1MDAsIDUwMCwgNTU2LCA1NTYsIDM1MCwgMTAwMCwgMTAwMCwgMjQwLCA0NzksIDMzMywgMzMzLCA2MDQsIDMzMywgMTY3LCAzOTYsIDU1NiwgNTU2LCAxMDk0LCA1NTYsIDg4NSwgNDg5LCAxMTE1LCAxMDAwLCA3NjgsIDYwMCwgODM0LCA4MzQsIDgzNCwgODM0LCAxMDAwLCA1MDAsIDEwMDAsIDUwMCwgMTAwMCwgNTAwLCA1MDAsIDQ5NCwgNjEyLCA4MjMsIDcxMywgNTg0LCA1NDksIDcxMywgOTc5LCA3MjIsIDI3NCwgNTQ5LCA1NDksIDU4MywgNTQ5LCA1NDksIDYwNCwgNTg0LCA2MDQsIDYwNCwgNzA4LCA2MjUsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcyOSwgNjA0LCA2MDQsIDM1NCwgMzU0LCAxMDAwLCA5OTAsIDk5MCwgOTkwLCA5OTAsIDQ5NCwgNjA0LCA2MDQsIDYwNCwgNjA0LCAzNTQsIDEwMjEsIDEwNTIsIDkxNywgNzUwLCA3NTAsIDUzMSwgNjU2LCA1OTQsIDUxMCwgNTAwLCA3NTAsIDc1MCwgNjExLCA2MTEsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAyMjIsIDIyMiwgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzNdOwpleHBvcnRzLkxpYmVyYXRpb25TYW5zQm9sZFdpZHRocyA9IExpYmVyYXRpb25TYW5zQm9sZFdpZHRoczsKY29uc3QgTGliZXJhdGlvblNhbnNCb2xkTWFwcGluZyA9IFstMSwgLTEsIC0xLCAzMiwgMzMsIDM0LCAzNSwgMzYsIDM3LCAzOCwgMzksIDQwLCA0MSwgNDIsIDQzLCA0NCwgNDUsIDQ2LCA0NywgNDgsIDQ5LCA1MCwgNTEsIDUyLCA1MywgNTQsIDU1LCA1NiwgNTcsIDU4LCA1OSwgNjAsIDYxLCA2MiwgNjMsIDY0LCA2NSwgNjYsIDY3LCA2OCwgNjksIDcwLCA3MSwgNzIsIDczLCA3NCwgNzUsIDc2LCA3NywgNzgsIDc5LCA4MCwgODEsIDgyLCA4MywgODQsIDg1LCA4NiwgODcsIDg4LCA4OSwgOTAsIDkxLCA5MiwgOTMsIDk0LCA5NSwgOTYsIDk3LCA5OCwgOTksIDEwMCwgMTAxLCAxMDIsIDEwMywgMTA0LCAxMDUsIDEwNiwgMTA3LCAxMDgsIDEwOSwgMTEwLCAxMTEsIDExMiwgMTEzLCAxMTQsIDExNSwgMTE2LCAxMTcsIDExOCwgMTE5LCAxMjAsIDEyMSwgMTIyLCAxMjMsIDEyNCwgMTI1LCAxMjYsIDE2MSwgMTYyLCAxNjMsIDE2NCwgMTY1LCAxNjYsIDE2NywgMTY4LCAxNjksIDE3MCwgMTcxLCAxNzIsIDE3NCwgMTc1LCAxNzYsIDE3NywgMTc4LCAxNzksIDE4MCwgMTgxLCAxODIsIDE4MywgMTg0LCAxODUsIDE4NiwgMTg3LCAxODgsIDE4OSwgMTkwLCAxOTEsIDE5MiwgMTkzLCAxOTQsIDE5NSwgMTk2LCAxOTcsIDE5OCwgMTk5LCAyMDAsIDIwMSwgMjAyLCAyMDMsIDIwNCwgMjA1LCAyMDYsIDIwNywgMjA4LCAyMDksIDIxMCwgMjExLCAyMTIsIDIxMywgMjE0LCAyMTUsIDIxNiwgMjE3LCAyMTgsIDIxOSwgMjIwLCAyMjEsIDIyMiwgMjIzLCAyMjQsIDIyNSwgMjI2LCAyMjcsIDIyOCwgMjI5LCAyMzAsIDIzMSwgMjMyLCAyMzMsIDIzNCwgMjM1LCAyMzYsIDIzNywgMjM4LCAyMzksIDI0MCwgMjQxLCAyNDIsIDI0MywgMjQ0LCAyNDUsIDI0NiwgMjQ3LCAyNDgsIDI0OSwgMjUwLCAyNTEsIDI1MiwgMjUzLCAyNTQsIDI1NSwgMjU2LCAyNTcsIDI1OCwgMjU5LCAyNjAsIDI2MSwgMjYyLCAyNjMsIDI2NCwgMjY1LCAyNjYsIDI2NywgMjY4LCAyNjksIDI3MCwgMjcxLCAyNzIsIDI3MywgMjc0LCAyNzUsIDI3NiwgMjc3LCAyNzgsIDI3OSwgMjgwLCAyODEsIDI4MiwgMjgzLCAyODQsIDI4NSwgMjg2LCAyODcsIDI4OCwgMjg5LCAyOTAsIDI5MSwgMjkyLCAyOTMsIDI5NCwgMjk1LCAyOTYsIDI5NywgMjk4LCAyOTksIDMwMCwgMzAxLCAzMDIsIDMwMywgMzA0LCAzMDUsIDMwNiwgMzA3LCAzMDgsIDMwOSwgMzEwLCAzMTEsIDMxMiwgMzEzLCAzMTQsIDMxNSwgMzE2LCAzMTcsIDMxOCwgMzE5LCAzMjAsIDMyMSwgMzIyLCAzMjMsIDMyNCwgMzI1LCAzMjYsIDMyNywgMzI4LCAzMjksIDMzMCwgMzMxLCAzMzIsIDMzMywgMzM0LCAzMzUsIDMzNiwgMzM3LCAzMzgsIDMzOSwgMzQwLCAzNDEsIDM0MiwgMzQzLCAzNDQsIDM0NSwgMzQ2LCAzNDcsIDM0OCwgMzQ5LCAzNTAsIDM1MSwgMzUyLCAzNTMsIDM1NCwgMzU1LCAzNTYsIDM1NywgMzU4LCAzNTksIDM2MCwgMzYxLCAzNjIsIDM2MywgMzY0LCAzNjUsIDM2NiwgMzY3LCAzNjgsIDM2OSwgMzcwLCAzNzEsIDM3MiwgMzczLCAzNzQsIDM3NSwgMzc2LCAzNzcsIDM3OCwgMzc5LCAzODAsIDM4MSwgMzgyLCAzODMsIDQwMiwgNTA2LCA1MDcsIDUwOCwgNTA5LCA1MTAsIDUxMSwgNTM2LCA1MzcsIDUzOCwgNTM5LCA3MTAsIDcxMSwgNzEzLCA3MjgsIDcyOSwgNzMwLCA3MzEsIDczMiwgNzMzLCA5MDAsIDkwMSwgOTAyLCA5MDMsIDkwNCwgOTA1LCA5MDYsIDkwOCwgOTEwLCA5MTEsIDkxMiwgOTEzLCA5MTQsIDkxNSwgOTE2LCA5MTcsIDkxOCwgOTE5LCA5MjAsIDkyMSwgOTIyLCA5MjMsIDkyNCwgOTI1LCA5MjYsIDkyNywgOTI4LCA5MjksIDkzMSwgOTMyLCA5MzMsIDkzNCwgOTM1LCA5MzYsIDkzNywgOTM4LCA5MzksIDk0MCwgOTQxLCA5NDIsIDk0MywgOTQ0LCA5NDUsIDk0NiwgOTQ3LCA5NDgsIDk0OSwgOTUwLCA5NTEsIDk1MiwgOTUzLCA5NTQsIDk1NSwgOTU2LCA5NTcsIDk1OCwgOTU5LCA5NjAsIDk2MSwgOTYyLCA5NjMsIDk2NCwgOTY1LCA5NjYsIDk2NywgOTY4LCA5NjksIDk3MCwgOTcxLCA5NzIsIDk3MywgOTc0LCAxMDI0LCAxMDI1LCAxMDI2LCAxMDI3LCAxMDI4LCAxMDI5LCAxMDMwLCAxMDMxLCAxMDMyLCAxMDMzLCAxMDM0LCAxMDM1LCAxMDM2LCAxMDM3LCAxMDM4LCAxMDM5LCAxMDQwLCAxMDQxLCAxMDQyLCAxMDQzLCAxMDQ0LCAxMDQ1LCAxMDQ2LCAxMDQ3LCAxMDQ4LCAxMDQ5LCAxMDUwLCAxMDUxLCAxMDUyLCAxMDUzLCAxMDU0LCAxMDU1LCAxMDU2LCAxMDU3LCAxMDU4LCAxMDU5LCAxMDYwLCAxMDYxLCAxMDYyLCAxMDYzLCAxMDY0LCAxMDY1LCAxMDY2LCAxMDY3LCAxMDY4LCAxMDY5LCAxMDcwLCAxMDcxLCAxMDcyLCAxMDczLCAxMDc0LCAxMDc1LCAxMDc2LCAxMDc3LCAxMDc4LCAxMDc5LCAxMDgwLCAxMDgxLCAxMDgyLCAxMDgzLCAxMDg0LCAxMDg1LCAxMDg2LCAxMDg3LCAxMDg4LCAxMDg5LCAxMDkwLCAxMDkxLCAxMDkyLCAxMDkzLCAxMDk0LCAxMDk1LCAxMDk2LCAxMDk3LCAxMDk4LCAxMDk5LCAxMTAwLCAxMTAxLCAxMTAyLCAxMTAzLCAxMTA0LCAxMTA1LCAxMTA2LCAxMTA3LCAxMTA4LCAxMTA5LCAxMTEwLCAxMTExLCAxMTEyLCAxMTEzLCAxMTE0LCAxMTE1LCAxMTE2LCAxMTE3LCAxMTE4LCAxMTE5LCAxMTM4LCAxMTM5LCAxMTY4LCAxMTY5LCA3ODA4LCA3ODA5LCA3ODEwLCA3ODExLCA3ODEyLCA3ODEzLCA3OTIyLCA3OTIzLCA4MjA4LCA4MjA5LCA4MjExLCA4MjEyLCA4MjEzLCA4MjE1LCA4MjE2LCA4MjE3LCA4MjE4LCA4MjE5LCA4MjIwLCA4MjIxLCA4MjIyLCA4MjI0LCA4MjI1LCA4MjI2LCA4MjMwLCA4MjQwLCA4MjQyLCA4MjQzLCA4MjQ5LCA4MjUwLCA4MjUyLCA4MjU0LCA4MjYwLCA4MzE5LCA4MzU1LCA4MzU2LCA4MzU5LCA4MzY0LCA4NDUzLCA4NDY3LCA4NDcwLCA4NDgyLCA4NDg2LCA4NDk0LCA4NTM5LCA4NTQwLCA4NTQxLCA4NTQyLCA4NTkyLCA4NTkzLCA4NTk0LCA4NTk1LCA4NTk2LCA4NTk3LCA4NjE2LCA4NzA2LCA4NzEwLCA4NzE5LCA4NzIxLCA4NzIyLCA4NzMwLCA4NzM0LCA4NzM1LCA4NzQ1LCA4NzQ3LCA4Nzc2LCA4ODAwLCA4ODAxLCA4ODA0LCA4ODA1LCA4OTYyLCA4OTc2LCA4OTkyLCA4OTkzLCA5NDcyLCA5NDc0LCA5NDg0LCA5NDg4LCA5NDkyLCA5NDk2LCA5NTAwLCA5NTA4LCA5NTE2LCA5NTI0LCA5NTMyLCA5NTUyLCA5NTUzLCA5NTU0LCA5NTU1LCA5NTU2LCA5NTU3LCA5NTU4LCA5NTU5LCA5NTYwLCA5NTYxLCA5NTYyLCA5NTYzLCA5NTY0LCA5NTY1LCA5NTY2LCA5NTY3LCA5NTY4LCA5NTY5LCA5NTcwLCA5NTcxLCA5NTcyLCA5NTczLCA5NTc0LCA5NTc1LCA5NTc2LCA5NTc3LCA5NTc4LCA5NTc5LCA5NTgwLCA5NjAwLCA5NjA0LCA5NjA4LCA5NjEyLCA5NjE2LCA5NjE3LCA5NjE4LCA5NjE5LCA5NjMyLCA5NjMzLCA5NjQyLCA5NjQzLCA5NjQ0LCA5NjUwLCA5NjU4LCA5NjYwLCA5NjY4LCA5Njc0LCA5Njc1LCA5Njc5LCA5Njg4LCA5Njg5LCA5NzAyLCA5Nzg2LCA5Nzg3LCA5Nzg4LCA5NzkyLCA5Nzk0LCA5ODI0LCA5ODI3LCA5ODI5LCA5ODMwLCA5ODM0LCA5ODM1LCA5ODM2LCA2MTQ0MSwgNjE0NDIsIDYxNDQ1LCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTFdOwpleHBvcnRzLkxpYmVyYXRpb25TYW5zQm9sZE1hcHBpbmcgPSBMaWJlcmF0aW9uU2Fuc0JvbGRNYXBwaW5nOwpjb25zdCBMaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNXaWR0aHMgPSBbMzY1LCAwLCAzMzMsIDI3OCwgMzMzLCA0NzQsIDU1NiwgNTU2LCA4ODksIDcyMiwgMjM4LCAzMzMsIDMzMywgMzg5LCA1ODQsIDI3OCwgMzMzLCAyNzgsIDI3OCwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCAzMzMsIDMzMywgNTg0LCA1ODQsIDU4NCwgNjExLCA5NzUsIDcyMiwgNzIyLCA3MjIsIDcyMiwgNjY3LCA2MTEsIDc3OCwgNzIyLCAyNzgsIDU1NiwgNzIyLCA2MTEsIDgzMywgNzIyLCA3NzgsIDY2NywgNzc4LCA3MjIsIDY2NywgNjExLCA3MjIsIDY2NywgOTQ0LCA2NjcsIDY2NywgNjExLCAzMzMsIDI3OCwgMzMzLCA1ODQsIDU1NiwgMzMzLCA1NTYsIDYxMSwgNTU2LCA2MTEsIDU1NiwgMzMzLCA2MTEsIDYxMSwgMjc4LCAyNzgsIDU1NiwgMjc4LCA4ODksIDYxMSwgNjExLCA2MTEsIDYxMSwgMzg5LCA1NTYsIDMzMywgNjExLCA1NTYsIDc3OCwgNTU2LCA1NTYsIDUwMCwgMzg5LCAyODAsIDM4OSwgNTg0LCAzMzMsIDU1NiwgNTU2LCA1NTYsIDU1NiwgMjgwLCA1NTYsIDMzMywgNzM3LCAzNzAsIDU1NiwgNTg0LCA3MzcsIDU1MiwgNDAwLCA1NDksIDMzMywgMzMzLCAzMzMsIDU3NiwgNTU2LCAyNzgsIDMzMywgMzMzLCAzNjUsIDU1NiwgODM0LCA4MzQsIDgzNCwgNjExLCA3MjIsIDcyMiwgNzIyLCA3MjIsIDcyMiwgNzIyLCAxMDAwLCA3MjIsIDY2NywgNjY3LCA2NjcsIDY2NywgMjc4LCAyNzgsIDI3OCwgMjc4LCA3MjIsIDcyMiwgNzc4LCA3NzgsIDc3OCwgNzc4LCA3NzgsIDU4NCwgNzc4LCA3MjIsIDcyMiwgNzIyLCA3MjIsIDY2NywgNjY3LCA2MTEsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDg4OSwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDI3OCwgMjc4LCAyNzgsIDI3OCwgNjExLCA2MTEsIDYxMSwgNjExLCA2MTEsIDYxMSwgNjExLCA1NDksIDYxMSwgNjExLCA2MTEsIDYxMSwgNjExLCA1NTYsIDYxMSwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA3NDAsIDcyMiwgNjExLCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDc3OCwgNjExLCA3NzgsIDYxMSwgNzc4LCA2MTEsIDc3OCwgNjExLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgNzgyLCA1NTYsIDU1NiwgMjc4LCA3MjIsIDU1NiwgNTU2LCA2MTEsIDI3OCwgNjExLCAyNzgsIDYxMSwgMzk2LCA2MTEsIDQ3OSwgNjExLCAyNzgsIDcyMiwgNjExLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDcwOCwgNzIzLCA2MTEsIDc3OCwgNjExLCA3NzgsIDYxMSwgNzc4LCA2MTEsIDEwMDAsIDk0NCwgNzIyLCAzODksIDcyMiwgMzg5LCA3MjIsIDM4OSwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDYxMSwgMzMzLCA2MTEsIDQ3OSwgNjExLCAzMzMsIDcyMiwgNjExLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDcyMiwgNjExLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDk0NCwgNzc4LCA2NjcsIDU1NiwgNjY3LCA2MTEsIDUwMCwgNjExLCA1MDAsIDYxMSwgNTAwLCAyNzgsIDU1NiwgNzIyLCA1NTYsIDEwMDAsIDg4OSwgNzc4LCA2MTEsIDY2NywgNTU2LCA2MTEsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDcyMiwgMzMzLCA4NTQsIDkwNiwgNDczLCA4NDQsIDkzMCwgODQ3LCAyNzgsIDcyMiwgNzIyLCA2MTAsIDY3MSwgNjY3LCA2MTEsIDcyMiwgNzc4LCAyNzgsIDcyMiwgNjY3LCA4MzMsIDcyMiwgNjU3LCA3NzgsIDcxOCwgNjY3LCA1OTAsIDYxMSwgNjY3LCA4MjIsIDY2NywgODI5LCA3ODEsIDI3OCwgNjY3LCA2MjAsIDQ3OSwgNjExLCAyNzgsIDU5MSwgNjIwLCA2MjEsIDU1NiwgNjEwLCA0NzksIDQ5MiwgNjExLCA1NTgsIDI3OCwgNTY2LCA1NTYsIDYwMywgNTU2LCA0NTAsIDYxMSwgNzEyLCA2MDUsIDUzMiwgNjY0LCA0MDksIDU5MSwgNzA0LCA1NzgsIDc3MywgODM0LCAyNzgsIDU5MSwgNjExLCA1OTEsIDgzNCwgNjY3LCA2NjcsIDg4NiwgNjE0LCA3MTksIDY2NywgMjc4LCAyNzgsIDU1NiwgMTA5NCwgMTA0MiwgODU0LCA2MjIsIDcxOSwgNjc3LCA3MTksIDcyMiwgNzA4LCA3MjIsIDYxNCwgNzIyLCA2NjcsIDkyNywgNjQzLCA3MTksIDcxOSwgNjE1LCA2ODcsIDgzMywgNzIyLCA3NzgsIDcxOSwgNjY3LCA3MjIsIDYxMSwgNjc3LCA3ODEsIDY2NywgNzI5LCA3MDgsIDk3OSwgOTg5LCA4NTQsIDEwMDAsIDcwOCwgNzE5LCAxMDQyLCA3MjksIDU1NiwgNjE5LCA2MDQsIDUzNCwgNjE4LCA1NTYsIDczNiwgNTEwLCA2MTEsIDYxMSwgNTA3LCA2MjIsIDc0MCwgNjA0LCA2MTEsIDYxMSwgNjExLCA1NTYsIDg4OSwgNTU2LCA4ODUsIDU1NiwgNjQ2LCA1ODMsIDg4OSwgOTM1LCA3MDcsIDg1NCwgNTk0LCA1NTIsIDg2NSwgNTg5LCA1NTYsIDU1NiwgNjExLCA0NjksIDU2MywgNTU2LCAyNzgsIDI3OCwgMjc4LCA5NjksIDkwNiwgNjExLCA1MDcsIDYxOSwgNTU2LCA2MTEsIDc3OCwgNjExLCA1NzUsIDQ2NywgOTQ0LCA3NzgsIDk0NCwgNzc4LCA5NDQsIDc3OCwgNjY3LCA1NTYsIDMzMywgMzMzLCA1NTYsIDEwMDAsIDEwMDAsIDU1MiwgMjc4LCAyNzgsIDI3OCwgMjc4LCA1MDAsIDUwMCwgNTAwLCA1NTYsIDU1NiwgMzUwLCAxMDAwLCAxMDAwLCAyNDAsIDQ3OSwgMzMzLCAzMzMsIDYwNCwgMzMzLCAxNjcsIDM5NiwgNTU2LCA1NTYsIDExMDQsIDU1NiwgODg1LCA1MTYsIDExNDYsIDEwMDAsIDc2OCwgNjAwLCA4MzQsIDgzNCwgODM0LCA4MzQsIDk5OSwgNTAwLCAxMDAwLCA1MDAsIDEwMDAsIDUwMCwgNTAwLCA0OTQsIDYxMiwgODIzLCA3MTMsIDU4NCwgNTQ5LCA3MTMsIDk3OSwgNzIyLCAyNzQsIDU0OSwgNTQ5LCA1ODMsIDU0OSwgNTQ5LCA2MDQsIDU4NCwgNjA0LCA2MDQsIDcwOCwgNjI1LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MjksIDYwNCwgNjA0LCAzNTQsIDM1NCwgMTAwMCwgOTkwLCA5OTAsIDk5MCwgOTkwLCA0OTQsIDYwNCwgNjA0LCA2MDQsIDYwNCwgMzU0LCAxMDIxLCAxMDUyLCA5MTcsIDc1MCwgNzUwLCA1MzEsIDY1NiwgNTk0LCA1MTAsIDUwMCwgNzUwLCA3NTAsIDYxMSwgNjExLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMjIyLCAyMjIsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzXTsKZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNXaWR0aHMgPSBMaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNXaWR0aHM7CmNvbnN0IExpYmVyYXRpb25TYW5zQm9sZEl0YWxpY01hcHBpbmcgPSBbLTEsIC0xLCAtMSwgMzIsIDMzLCAzNCwgMzUsIDM2LCAzNywgMzgsIDM5LCA0MCwgNDEsIDQyLCA0MywgNDQsIDQ1LCA0NiwgNDcsIDQ4LCA0OSwgNTAsIDUxLCA1MiwgNTMsIDU0LCA1NSwgNTYsIDU3LCA1OCwgNTksIDYwLCA2MSwgNjIsIDYzLCA2NCwgNjUsIDY2LCA2NywgNjgsIDY5LCA3MCwgNzEsIDcyLCA3MywgNzQsIDc1LCA3NiwgNzcsIDc4LCA3OSwgODAsIDgxLCA4MiwgODMsIDg0LCA4NSwgODYsIDg3LCA4OCwgODksIDkwLCA5MSwgOTIsIDkzLCA5NCwgOTUsIDk2LCA5NywgOTgsIDk5LCAxMDAsIDEwMSwgMTAyLCAxMDMsIDEwNCwgMTA1LCAxMDYsIDEwNywgMTA4LCAxMDksIDExMCwgMTExLCAxMTIsIDExMywgMTE0LCAxMTUsIDExNiwgMTE3LCAxMTgsIDExOSwgMTIwLCAxMjEsIDEyMiwgMTIzLCAxMjQsIDEyNSwgMTI2LCAxNjEsIDE2MiwgMTYzLCAxNjQsIDE2NSwgMTY2LCAxNjcsIDE2OCwgMTY5LCAxNzAsIDE3MSwgMTcyLCAxNzQsIDE3NSwgMTc2LCAxNzcsIDE3OCwgMTc5LCAxODAsIDE4MSwgMTgyLCAxODMsIDE4NCwgMTg1LCAxODYsIDE4NywgMTg4LCAxODksIDE5MCwgMTkxLCAxOTIsIDE5MywgMTk0LCAxOTUsIDE5NiwgMTk3LCAxOTgsIDE5OSwgMjAwLCAyMDEsIDIwMiwgMjAzLCAyMDQsIDIwNSwgMjA2LCAyMDcsIDIwOCwgMjA5LCAyMTAsIDIxMSwgMjEyLCAyMTMsIDIxNCwgMjE1LCAyMTYsIDIxNywgMjE4LCAyMTksIDIyMCwgMjIxLCAyMjIsIDIyMywgMjI0LCAyMjUsIDIyNiwgMjI3LCAyMjgsIDIyOSwgMjMwLCAyMzEsIDIzMiwgMjMzLCAyMzQsIDIzNSwgMjM2LCAyMzcsIDIzOCwgMjM5LCAyNDAsIDI0MSwgMjQyLCAyNDMsIDI0NCwgMjQ1LCAyNDYsIDI0NywgMjQ4LCAyNDksIDI1MCwgMjUxLCAyNTIsIDI1MywgMjU0LCAyNTUsIDI1NiwgMjU3LCAyNTgsIDI1OSwgMjYwLCAyNjEsIDI2MiwgMjYzLCAyNjQsIDI2NSwgMjY2LCAyNjcsIDI2OCwgMjY5LCAyNzAsIDI3MSwgMjcyLCAyNzMsIDI3NCwgMjc1LCAyNzYsIDI3NywgMjc4LCAyNzksIDI4MCwgMjgxLCAyODIsIDI4MywgMjg0LCAyODUsIDI4NiwgMjg3LCAyODgsIDI4OSwgMjkwLCAyOTEsIDI5MiwgMjkzLCAyOTQsIDI5NSwgMjk2LCAyOTcsIDI5OCwgMjk5LCAzMDAsIDMwMSwgMzAyLCAzMDMsIDMwNCwgMzA1LCAzMDYsIDMwNywgMzA4LCAzMDksIDMxMCwgMzExLCAzMTIsIDMxMywgMzE0LCAzMTUsIDMxNiwgMzE3LCAzMTgsIDMxOSwgMzIwLCAzMjEsIDMyMiwgMzIzLCAzMjQsIDMyNSwgMzI2LCAzMjcsIDMyOCwgMzI5LCAzMzAsIDMzMSwgMzMyLCAzMzMsIDMzNCwgMzM1LCAzMzYsIDMzNywgMzM4LCAzMzksIDM0MCwgMzQxLCAzNDIsIDM0MywgMzQ0LCAzNDUsIDM0NiwgMzQ3LCAzNDgsIDM0OSwgMzUwLCAzNTEsIDM1MiwgMzUzLCAzNTQsIDM1NSwgMzU2LCAzNTcsIDM1OCwgMzU5LCAzNjAsIDM2MSwgMzYyLCAzNjMsIDM2NCwgMzY1LCAzNjYsIDM2NywgMzY4LCAzNjksIDM3MCwgMzcxLCAzNzIsIDM3MywgMzc0LCAzNzUsIDM3NiwgMzc3LCAzNzgsIDM3OSwgMzgwLCAzODEsIDM4MiwgMzgzLCA0MDIsIDUwNiwgNTA3LCA1MDgsIDUwOSwgNTEwLCA1MTEsIDUzNiwgNTM3LCA1MzgsIDUzOSwgNzEwLCA3MTEsIDcxMywgNzI4LCA3MjksIDczMCwgNzMxLCA3MzIsIDczMywgOTAwLCA5MDEsIDkwMiwgOTAzLCA5MDQsIDkwNSwgOTA2LCA5MDgsIDkxMCwgOTExLCA5MTIsIDkxMywgOTE0LCA5MTUsIDkxNiwgOTE3LCA5MTgsIDkxOSwgOTIwLCA5MjEsIDkyMiwgOTIzLCA5MjQsIDkyNSwgOTI2LCA5MjcsIDkyOCwgOTI5LCA5MzEsIDkzMiwgOTMzLCA5MzQsIDkzNSwgOTM2LCA5MzcsIDkzOCwgOTM5LCA5NDAsIDk0MSwgOTQyLCA5NDMsIDk0NCwgOTQ1LCA5NDYsIDk0NywgOTQ4LCA5NDksIDk1MCwgOTUxLCA5NTIsIDk1MywgOTU0LCA5NTUsIDk1NiwgOTU3LCA5NTgsIDk1OSwgOTYwLCA5NjEsIDk2MiwgOTYzLCA5NjQsIDk2NSwgOTY2LCA5NjcsIDk2OCwgOTY5LCA5NzAsIDk3MSwgOTcyLCA5NzMsIDk3NCwgMTAyNCwgMTAyNSwgMTAyNiwgMTAyNywgMTAyOCwgMTAyOSwgMTAzMCwgMTAzMSwgMTAzMiwgMTAzMywgMTAzNCwgMTAzNSwgMTAzNiwgMTAzNywgMTAzOCwgMTAzOSwgMTA0MCwgMTA0MSwgMTA0MiwgMTA0MywgMTA0NCwgMTA0NSwgMTA0NiwgMTA0NywgMTA0OCwgMTA0OSwgMTA1MCwgMTA1MSwgMTA1MiwgMTA1MywgMTA1NCwgMTA1NSwgMTA1NiwgMTA1NywgMTA1OCwgMTA1OSwgMTA2MCwgMTA2MSwgMTA2MiwgMTA2MywgMTA2NCwgMTA2NSwgMTA2NiwgMTA2NywgMTA2OCwgMTA2OSwgMTA3MCwgMTA3MSwgMTA3MiwgMTA3MywgMTA3NCwgMTA3NSwgMTA3NiwgMTA3NywgMTA3OCwgMTA3OSwgMTA4MCwgMTA4MSwgMTA4MiwgMTA4MywgMTA4NCwgMTA4NSwgMTA4NiwgMTA4NywgMTA4OCwgMTA4OSwgMTA5MCwgMTA5MSwgMTA5MiwgMTA5MywgMTA5NCwgMTA5NSwgMTA5NiwgMTA5NywgMTA5OCwgMTA5OSwgMTEwMCwgMTEwMSwgMTEwMiwgMTEwMywgMTEwNCwgMTEwNSwgMTEwNiwgMTEwNywgMTEwOCwgMTEwOSwgMTExMCwgMTExMSwgMTExMiwgMTExMywgMTExNCwgMTExNSwgMTExNiwgMTExNywgMTExOCwgMTExOSwgMTEzOCwgMTEzOSwgMTE2OCwgMTE2OSwgNzgwOCwgNzgwOSwgNzgxMCwgNzgxMSwgNzgxMiwgNzgxMywgNzkyMiwgNzkyMywgODIwOCwgODIwOSwgODIxMSwgODIxMiwgODIxMywgODIxNSwgODIxNiwgODIxNywgODIxOCwgODIxOSwgODIyMCwgODIyMSwgODIyMiwgODIyNCwgODIyNSwgODIyNiwgODIzMCwgODI0MCwgODI0MiwgODI0MywgODI0OSwgODI1MCwgODI1MiwgODI1NCwgODI2MCwgODMxOSwgODM1NSwgODM1NiwgODM1OSwgODM2NCwgODQ1MywgODQ2NywgODQ3MCwgODQ4MiwgODQ4NiwgODQ5NCwgODUzOSwgODU0MCwgODU0MSwgODU0MiwgODU5MiwgODU5MywgODU5NCwgODU5NSwgODU5NiwgODU5NywgODYxNiwgODcwNiwgODcxMCwgODcxOSwgODcyMSwgODcyMiwgODczMCwgODczNCwgODczNSwgODc0NSwgODc0NywgODc3NiwgODgwMCwgODgwMSwgODgwNCwgODgwNSwgODk2MiwgODk3NiwgODk5MiwgODk5MywgOTQ3MiwgOTQ3NCwgOTQ4NCwgOTQ4OCwgOTQ5MiwgOTQ5NiwgOTUwMCwgOTUwOCwgOTUxNiwgOTUyNCwgOTUzMiwgOTU1MiwgOTU1MywgOTU1NCwgOTU1NSwgOTU1NiwgOTU1NywgOTU1OCwgOTU1OSwgOTU2MCwgOTU2MSwgOTU2MiwgOTU2MywgOTU2NCwgOTU2NSwgOTU2NiwgOTU2NywgOTU2OCwgOTU2OSwgOTU3MCwgOTU3MSwgOTU3MiwgOTU3MywgOTU3NCwgOTU3NSwgOTU3NiwgOTU3NywgOTU3OCwgOTU3OSwgOTU4MCwgOTYwMCwgOTYwNCwgOTYwOCwgOTYxMiwgOTYxNiwgOTYxNywgOTYxOCwgOTYxOSwgOTYzMiwgOTYzMywgOTY0MiwgOTY0MywgOTY0NCwgOTY1MCwgOTY1OCwgOTY2MCwgOTY2OCwgOTY3NCwgOTY3NSwgOTY3OSwgOTY4OCwgOTY4OSwgOTcwMiwgOTc4NiwgOTc4NywgOTc4OCwgOTc5MiwgOTc5NCwgOTgyNCwgOTgyNywgOTgyOSwgOTgzMCwgOTgzNCwgOTgzNSwgOTgzNiwgNjE0NDEsIDYxNDQyLCA2MTQ0NSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xXTsKZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNNYXBwaW5nID0gTGliZXJhdGlvblNhbnNCb2xkSXRhbGljTWFwcGluZzsKY29uc3QgTGliZXJhdGlvblNhbnNJdGFsaWNXaWR0aHMgPSBbMzY1LCAwLCAzMzMsIDI3OCwgMjc4LCAzNTUsIDU1NiwgNTU2LCA4ODksIDY2NywgMTkxLCAzMzMsIDMzMywgMzg5LCA1ODQsIDI3OCwgMzMzLCAyNzgsIDI3OCwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCAyNzgsIDI3OCwgNTg0LCA1ODQsIDU4NCwgNTU2LCAxMDE1LCA2NjcsIDY2NywgNzIyLCA3MjIsIDY2NywgNjExLCA3NzgsIDcyMiwgMjc4LCA1MDAsIDY2NywgNTU2LCA4MzMsIDcyMiwgNzc4LCA2NjcsIDc3OCwgNzIyLCA2NjcsIDYxMSwgNzIyLCA2NjcsIDk0NCwgNjY3LCA2NjcsIDYxMSwgMjc4LCAyNzgsIDI3OCwgNDY5LCA1NTYsIDMzMywgNTU2LCA1NTYsIDUwMCwgNTU2LCA1NTYsIDI3OCwgNTU2LCA1NTYsIDIyMiwgMjIyLCA1MDAsIDIyMiwgODMzLCA1NTYsIDU1NiwgNTU2LCA1NTYsIDMzMywgNTAwLCAyNzgsIDU1NiwgNTAwLCA3MjIsIDUwMCwgNTAwLCA1MDAsIDMzNCwgMjYwLCAzMzQsIDU4NCwgMzMzLCA1NTYsIDU1NiwgNTU2LCA1NTYsIDI2MCwgNTU2LCAzMzMsIDczNywgMzcwLCA1NTYsIDU4NCwgNzM3LCA1NTIsIDQwMCwgNTQ5LCAzMzMsIDMzMywgMzMzLCA1NzYsIDUzNywgMjc4LCAzMzMsIDMzMywgMzY1LCA1NTYsIDgzNCwgODM0LCA4MzQsIDYxMSwgNjY3LCA2NjcsIDY2NywgNjY3LCA2NjcsIDY2NywgMTAwMCwgNzIyLCA2NjcsIDY2NywgNjY3LCA2NjcsIDI3OCwgMjc4LCAyNzgsIDI3OCwgNzIyLCA3MjIsIDc3OCwgNzc4LCA3NzgsIDc3OCwgNzc4LCA1ODQsIDc3OCwgNzIyLCA3MjIsIDcyMiwgNzIyLCA2NjcsIDY2NywgNjExLCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA4ODksIDUwMCwgNTU2LCA1NTYsIDU1NiwgNTU2LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTQ5LCA2MTEsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTAwLCA1NTYsIDUwMCwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNzIyLCA1MDAsIDcyMiwgNTAwLCA3MjIsIDUwMCwgNzIyLCA1MDAsIDcyMiwgNjI1LCA3MjIsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA3NzgsIDU1NiwgNzc4LCA1NTYsIDc3OCwgNTU2LCA3NzgsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDIyMiwgMjc4LCAyNzgsIDczMywgNDQ0LCA1MDAsIDIyMiwgNjY3LCA1MDAsIDUwMCwgNTU2LCAyMjIsIDU1NiwgMjIyLCA1NTYsIDI4MSwgNTU2LCA0MDAsIDU1NiwgMjIyLCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA2MTUsIDcyMywgNTU2LCA3NzgsIDU1NiwgNzc4LCA1NTYsIDc3OCwgNTU2LCAxMDAwLCA5NDQsIDcyMiwgMzMzLCA3MjIsIDMzMywgNzIyLCAzMzMsIDY2NywgNTAwLCA2NjcsIDUwMCwgNjY3LCA1MDAsIDY2NywgNTAwLCA2MTEsIDI3OCwgNjExLCAzNTQsIDYxMSwgMjc4LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA5NDQsIDcyMiwgNjY3LCA1MDAsIDY2NywgNjExLCA1MDAsIDYxMSwgNTAwLCA2MTEsIDUwMCwgMjIyLCA1NTYsIDY2NywgNTU2LCAxMDAwLCA4ODksIDc3OCwgNjExLCA2NjcsIDUwMCwgNjExLCAyNzgsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCA2NjcsIDI3OCwgNzg5LCA4NDYsIDM4OSwgNzk0LCA4NjUsIDc3NSwgMjIyLCA2NjcsIDY2NywgNTcwLCA2NzEsIDY2NywgNjExLCA3MjIsIDc3OCwgMjc4LCA2NjcsIDY2NywgODMzLCA3MjIsIDY0OCwgNzc4LCA3MjUsIDY2NywgNjAwLCA2MTEsIDY2NywgODM3LCA2NjcsIDgzMSwgNzYxLCAyNzgsIDY2NywgNTcwLCA0MzksIDU1NSwgMjIyLCA1NTAsIDU3MCwgNTcxLCA1MDAsIDU1NiwgNDM5LCA0NjMsIDU1NSwgNTQyLCAyMjIsIDUwMCwgNDkyLCA1NDgsIDUwMCwgNDQ3LCA1NTYsIDY3MCwgNTczLCA0ODYsIDYwMywgMzc0LCA1NTAsIDY1MiwgNTQ2LCA3MjgsIDc3OSwgMjIyLCA1NTAsIDU1NiwgNTUwLCA3NzksIDY2NywgNjY3LCA4NDMsIDU0NCwgNzA4LCA2NjcsIDI3OCwgMjc4LCA1MDAsIDEwNjYsIDk4MiwgODQ0LCA1ODksIDcxNSwgNjM5LCA3MjQsIDY2NywgNjUxLCA2NjcsIDU0NCwgNzA0LCA2NjcsIDkxNywgNjE0LCA3MTUsIDcxNSwgNTg5LCA2ODYsIDgzMywgNzIyLCA3NzgsIDcyNSwgNjY3LCA3MjIsIDYxMSwgNjM5LCA3OTUsIDY2NywgNzI3LCA2NzMsIDkyMCwgOTIzLCA4MDUsIDg4NiwgNjUxLCA2OTQsIDEwMjIsIDY4MiwgNTU2LCA1NjIsIDUyMiwgNDkzLCA1NTMsIDU1NiwgNjg4LCA0NjUsIDU1NiwgNTU2LCA0NzIsIDU2NCwgNjg2LCA1NTAsIDU1NiwgNTU2LCA1NTYsIDUwMCwgODMzLCA1MDAsIDgzNSwgNTAwLCA1NzIsIDUxOCwgODMwLCA4NTEsIDYyMSwgNzM2LCA1MjYsIDQ5MiwgNzUyLCA1MzQsIDU1NiwgNTU2LCA1NTYsIDM3OCwgNDk2LCA1MDAsIDIyMiwgMjIyLCAyMjIsIDkxMCwgODI4LCA1NTYsIDQ3MiwgNTY1LCA1MDAsIDU1NiwgNzc4LCA1NTYsIDQ5MiwgMzM5LCA5NDQsIDcyMiwgOTQ0LCA3MjIsIDk0NCwgNzIyLCA2NjcsIDUwMCwgMzMzLCAzMzMsIDU1NiwgMTAwMCwgMTAwMCwgNTUyLCAyMjIsIDIyMiwgMjIyLCAyMjIsIDMzMywgMzMzLCAzMzMsIDU1NiwgNTU2LCAzNTAsIDEwMDAsIDEwMDAsIDE4OCwgMzU0LCAzMzMsIDMzMywgNTAwLCAzMzMsIDE2NywgMzY1LCA1NTYsIDU1NiwgMTA5NCwgNTU2LCA4ODUsIDMyMywgMTA4MywgMTAwMCwgNzY4LCA2MDAsIDgzNCwgODM0LCA4MzQsIDgzNCwgMTAwMCwgNTAwLCA5OTgsIDUwMCwgMTAwMCwgNTAwLCA1MDAsIDQ5NCwgNjEyLCA4MjMsIDcxMywgNTg0LCA1NDksIDcxMywgOTc5LCA3MTksIDI3NCwgNTQ5LCA1NDksIDU4NCwgNTQ5LCA1NDksIDYwNCwgNTg0LCA2MDQsIDYwNCwgNzA4LCA2MjUsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcyOSwgNjA0LCA2MDQsIDM1NCwgMzU0LCAxMDAwLCA5OTAsIDk5MCwgOTkwLCA5OTAsIDQ5NCwgNjA0LCA2MDQsIDYwNCwgNjA0LCAzNTQsIDEwMjEsIDEwNTIsIDkxNywgNzUwLCA3NTAsIDUzMSwgNjU2LCA1OTQsIDUxMCwgNTAwLCA3NTAsIDc1MCwgNTAwLCA1MDAsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAyMjIsIDIyMiwgMjk0LCAyOTQsIDMyNCwgMzI0LCAzMTYsIDMyOCwgMzk4LCAyODVdOwpleHBvcnRzLkxpYmVyYXRpb25TYW5zSXRhbGljV2lkdGhzID0gTGliZXJhdGlvblNhbnNJdGFsaWNXaWR0aHM7CmNvbnN0IExpYmVyYXRpb25TYW5zSXRhbGljTWFwcGluZyA9IFstMSwgLTEsIC0xLCAzMiwgMzMsIDM0LCAzNSwgMzYsIDM3LCAzOCwgMzksIDQwLCA0MSwgNDIsIDQzLCA0NCwgNDUsIDQ2LCA0NywgNDgsIDQ5LCA1MCwgNTEsIDUyLCA1MywgNTQsIDU1LCA1NiwgNTcsIDU4LCA1OSwgNjAsIDYxLCA2MiwgNjMsIDY0LCA2NSwgNjYsIDY3LCA2OCwgNjksIDcwLCA3MSwgNzIsIDczLCA3NCwgNzUsIDc2LCA3NywgNzgsIDc5LCA4MCwgODEsIDgyLCA4MywgODQsIDg1LCA4NiwgODcsIDg4LCA4OSwgOTAsIDkxLCA5MiwgOTMsIDk0LCA5NSwgOTYsIDk3LCA5OCwgOTksIDEwMCwgMTAxLCAxMDIsIDEwMywgMTA0LCAxMDUsIDEwNiwgMTA3LCAxMDgsIDEwOSwgMTEwLCAxMTEsIDExMiwgMTEzLCAxMTQsIDExNSwgMTE2LCAxMTcsIDExOCwgMTE5LCAxMjAsIDEyMSwgMTIyLCAxMjMsIDEyNCwgMTI1LCAxMjYsIDE2MSwgMTYyLCAxNjMsIDE2NCwgMTY1LCAxNjYsIDE2NywgMTY4LCAxNjksIDE3MCwgMTcxLCAxNzIsIDE3NCwgMTc1LCAxNzYsIDE3NywgMTc4LCAxNzksIDE4MCwgMTgxLCAxODIsIDE4MywgMTg0LCAxODUsIDE4NiwgMTg3LCAxODgsIDE4OSwgMTkwLCAxOTEsIDE5MiwgMTkzLCAxOTQsIDE5NSwgMTk2LCAxOTcsIDE5OCwgMTk5LCAyMDAsIDIwMSwgMjAyLCAyMDMsIDIwNCwgMjA1LCAyMDYsIDIwNywgMjA4LCAyMDksIDIxMCwgMjExLCAyMTIsIDIxMywgMjE0LCAyMTUsIDIxNiwgMjE3LCAyMTgsIDIxOSwgMjIwLCAyMjEsIDIyMiwgMjIzLCAyMjQsIDIyNSwgMjI2LCAyMjcsIDIyOCwgMjI5LCAyMzAsIDIzMSwgMjMyLCAyMzMsIDIzNCwgMjM1LCAyMzYsIDIzNywgMjM4LCAyMzksIDI0MCwgMjQxLCAyNDIsIDI0MywgMjQ0LCAyNDUsIDI0NiwgMjQ3LCAyNDgsIDI0OSwgMjUwLCAyNTEsIDI1MiwgMjUzLCAyNTQsIDI1NSwgMjU2LCAyNTcsIDI1OCwgMjU5LCAyNjAsIDI2MSwgMjYyLCAyNjMsIDI2NCwgMjY1LCAyNjYsIDI2NywgMjY4LCAyNjksIDI3MCwgMjcxLCAyNzIsIDI3MywgMjc0LCAyNzUsIDI3NiwgMjc3LCAyNzgsIDI3OSwgMjgwLCAyODEsIDI4MiwgMjgzLCAyODQsIDI4NSwgMjg2LCAyODcsIDI4OCwgMjg5LCAyOTAsIDI5MSwgMjkyLCAyOTMsIDI5NCwgMjk1LCAyOTYsIDI5NywgMjk4LCAyOTksIDMwMCwgMzAxLCAzMDIsIDMwMywgMzA0LCAzMDUsIDMwNiwgMzA3LCAzMDgsIDMwOSwgMzEwLCAzMTEsIDMxMiwgMzEzLCAzMTQsIDMxNSwgMzE2LCAzMTcsIDMxOCwgMzE5LCAzMjAsIDMyMSwgMzIyLCAzMjMsIDMyNCwgMzI1LCAzMjYsIDMyNywgMzI4LCAzMjksIDMzMCwgMzMxLCAzMzIsIDMzMywgMzM0LCAzMzUsIDMzNiwgMzM3LCAzMzgsIDMzOSwgMzQwLCAzNDEsIDM0MiwgMzQzLCAzNDQsIDM0NSwgMzQ2LCAzNDcsIDM0OCwgMzQ5LCAzNTAsIDM1MSwgMzUyLCAzNTMsIDM1NCwgMzU1LCAzNTYsIDM1NywgMzU4LCAzNTksIDM2MCwgMzYxLCAzNjIsIDM2MywgMzY0LCAzNjUsIDM2NiwgMzY3LCAzNjgsIDM2OSwgMzcwLCAzNzEsIDM3MiwgMzczLCAzNzQsIDM3NSwgMzc2LCAzNzcsIDM3OCwgMzc5LCAzODAsIDM4MSwgMzgyLCAzODMsIDQwMiwgNTA2LCA1MDcsIDUwOCwgNTA5LCA1MTAsIDUxMSwgNTM2LCA1MzcsIDUzOCwgNTM5LCA3MTAsIDcxMSwgNzEzLCA3MjgsIDcyOSwgNzMwLCA3MzEsIDczMiwgNzMzLCA5MDAsIDkwMSwgOTAyLCA5MDMsIDkwNCwgOTA1LCA5MDYsIDkwOCwgOTEwLCA5MTEsIDkxMiwgOTEzLCA5MTQsIDkxNSwgOTE2LCA5MTcsIDkxOCwgOTE5LCA5MjAsIDkyMSwgOTIyLCA5MjMsIDkyNCwgOTI1LCA5MjYsIDkyNywgOTI4LCA5MjksIDkzMSwgOTMyLCA5MzMsIDkzNCwgOTM1LCA5MzYsIDkzNywgOTM4LCA5MzksIDk0MCwgOTQxLCA5NDIsIDk0MywgOTQ0LCA5NDUsIDk0NiwgOTQ3LCA5NDgsIDk0OSwgOTUwLCA5NTEsIDk1MiwgOTUzLCA5NTQsIDk1NSwgOTU2LCA5NTcsIDk1OCwgOTU5LCA5NjAsIDk2MSwgOTYyLCA5NjMsIDk2NCwgOTY1LCA5NjYsIDk2NywgOTY4LCA5NjksIDk3MCwgOTcxLCA5NzIsIDk3MywgOTc0LCAxMDI0LCAxMDI1LCAxMDI2LCAxMDI3LCAxMDI4LCAxMDI5LCAxMDMwLCAxMDMxLCAxMDMyLCAxMDMzLCAxMDM0LCAxMDM1LCAxMDM2LCAxMDM3LCAxMDM4LCAxMDM5LCAxMDQwLCAxMDQxLCAxMDQyLCAxMDQzLCAxMDQ0LCAxMDQ1LCAxMDQ2LCAxMDQ3LCAxMDQ4LCAxMDQ5LCAxMDUwLCAxMDUxLCAxMDUyLCAxMDUzLCAxMDU0LCAxMDU1LCAxMDU2LCAxMDU3LCAxMDU4LCAxMDU5LCAxMDYwLCAxMDYxLCAxMDYyLCAxMDYzLCAxMDY0LCAxMDY1LCAxMDY2LCAxMDY3LCAxMDY4LCAxMDY5LCAxMDcwLCAxMDcxLCAxMDcyLCAxMDczLCAxMDc0LCAxMDc1LCAxMDc2LCAxMDc3LCAxMDc4LCAxMDc5LCAxMDgwLCAxMDgxLCAxMDgyLCAxMDgzLCAxMDg0LCAxMDg1LCAxMDg2LCAxMDg3LCAxMDg4LCAxMDg5LCAxMDkwLCAxMDkxLCAxMDkyLCAxMDkzLCAxMDk0LCAxMDk1LCAxMDk2LCAxMDk3LCAxMDk4LCAxMDk5LCAxMTAwLCAxMTAxLCAxMTAyLCAxMTAzLCAxMTA0LCAxMTA1LCAxMTA2LCAxMTA3LCAxMTA4LCAxMTA5LCAxMTEwLCAxMTExLCAxMTEyLCAxMTEzLCAxMTE0LCAxMTE1LCAxMTE2LCAxMTE3LCAxMTE4LCAxMTE5LCAxMTM4LCAxMTM5LCAxMTY4LCAxMTY5LCA3ODA4LCA3ODA5LCA3ODEwLCA3ODExLCA3ODEyLCA3ODEzLCA3OTIyLCA3OTIzLCA4MjA4LCA4MjA5LCA4MjExLCA4MjEyLCA4MjEzLCA4MjE1LCA4MjE2LCA4MjE3LCA4MjE4LCA4MjE5LCA4MjIwLCA4MjIxLCA4MjIyLCA4MjI0LCA4MjI1LCA4MjI2LCA4MjMwLCA4MjQwLCA4MjQyLCA4MjQzLCA4MjQ5LCA4MjUwLCA4MjUyLCA4MjU0LCA4MjYwLCA4MzE5LCA4MzU1LCA4MzU2LCA4MzU5LCA4MzY0LCA4NDUzLCA4NDY3LCA4NDcwLCA4NDgyLCA4NDg2LCA4NDk0LCA4NTM5LCA4NTQwLCA4NTQxLCA4NTQyLCA4NTkyLCA4NTkzLCA4NTk0LCA4NTk1LCA4NTk2LCA4NTk3LCA4NjE2LCA4NzA2LCA4NzEwLCA4NzE5LCA4NzIxLCA4NzIyLCA4NzMwLCA4NzM0LCA4NzM1LCA4NzQ1LCA4NzQ3LCA4Nzc2LCA4ODAwLCA4ODAxLCA4ODA0LCA4ODA1LCA4OTYyLCA4OTc2LCA4OTkyLCA4OTkzLCA5NDcyLCA5NDc0LCA5NDg0LCA5NDg4LCA5NDkyLCA5NDk2LCA5NTAwLCA5NTA4LCA5NTE2LCA5NTI0LCA5NTMyLCA5NTUyLCA5NTUzLCA5NTU0LCA5NTU1LCA5NTU2LCA5NTU3LCA5NTU4LCA5NTU5LCA5NTYwLCA5NTYxLCA5NTYyLCA5NTYzLCA5NTY0LCA5NTY1LCA5NTY2LCA5NTY3LCA5NTY4LCA5NTY5LCA5NTcwLCA5NTcxLCA5NTcyLCA5NTczLCA5NTc0LCA5NTc1LCA5NTc2LCA5NTc3LCA5NTc4LCA5NTc5LCA5NTgwLCA5NjAwLCA5NjA0LCA5NjA4LCA5NjEyLCA5NjE2LCA5NjE3LCA5NjE4LCA5NjE5LCA5NjMyLCA5NjMzLCA5NjQyLCA5NjQzLCA5NjQ0LCA5NjUwLCA5NjU4LCA5NjYwLCA5NjY4LCA5Njc0LCA5Njc1LCA5Njc5LCA5Njg4LCA5Njg5LCA5NzAyLCA5Nzg2LCA5Nzg3LCA5Nzg4LCA5NzkyLCA5Nzk0LCA5ODI0LCA5ODI3LCA5ODI5LCA5ODMwLCA5ODM0LCA5ODM1LCA5ODM2LCA2MTQ0MSwgNjE0NDIsIDYxNDQ1LCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTFdOwpleHBvcnRzLkxpYmVyYXRpb25TYW5zSXRhbGljTWFwcGluZyA9IExpYmVyYXRpb25TYW5zSXRhbGljTWFwcGluZzsKY29uc3QgTGliZXJhdGlvblNhbnNSZWd1bGFyV2lkdGhzID0gWzM2NSwgMCwgMzMzLCAyNzgsIDI3OCwgMzU1LCA1NTYsIDU1NiwgODg5LCA2NjcsIDE5MSwgMzMzLCAzMzMsIDM4OSwgNTg0LCAyNzgsIDMzMywgMjc4LCAyNzgsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgMjc4LCAyNzgsIDU4NCwgNTg0LCA1ODQsIDU1NiwgMTAxNSwgNjY3LCA2NjcsIDcyMiwgNzIyLCA2NjcsIDYxMSwgNzc4LCA3MjIsIDI3OCwgNTAwLCA2NjcsIDU1NiwgODMzLCA3MjIsIDc3OCwgNjY3LCA3NzgsIDcyMiwgNjY3LCA2MTEsIDcyMiwgNjY3LCA5NDQsIDY2NywgNjY3LCA2MTEsIDI3OCwgMjc4LCAyNzgsIDQ2OSwgNTU2LCAzMzMsIDU1NiwgNTU2LCA1MDAsIDU1NiwgNTU2LCAyNzgsIDU1NiwgNTU2LCAyMjIsIDIyMiwgNTAwLCAyMjIsIDgzMywgNTU2LCA1NTYsIDU1NiwgNTU2LCAzMzMsIDUwMCwgMjc4LCA1NTYsIDUwMCwgNzIyLCA1MDAsIDUwMCwgNTAwLCAzMzQsIDI2MCwgMzM0LCA1ODQsIDMzMywgNTU2LCA1NTYsIDU1NiwgNTU2LCAyNjAsIDU1NiwgMzMzLCA3MzcsIDM3MCwgNTU2LCA1ODQsIDczNywgNTUyLCA0MDAsIDU0OSwgMzMzLCAzMzMsIDMzMywgNTc2LCA1MzcsIDI3OCwgMzMzLCAzMzMsIDM2NSwgNTU2LCA4MzQsIDgzNCwgODM0LCA2MTEsIDY2NywgNjY3LCA2NjcsIDY2NywgNjY3LCA2NjcsIDEwMDAsIDcyMiwgNjY3LCA2NjcsIDY2NywgNjY3LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDcyMiwgNzIyLCA3NzgsIDc3OCwgNzc4LCA3NzgsIDc3OCwgNTg0LCA3NzgsIDcyMiwgNzIyLCA3MjIsIDcyMiwgNjY3LCA2NjcsIDYxMSwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgODg5LCA1MDAsIDU1NiwgNTU2LCA1NTYsIDU1NiwgMjc4LCAyNzgsIDI3OCwgMjc4LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU0OSwgNjExLCA1NTYsIDU1NiwgNTU2LCA1NTYsIDUwMCwgNTU2LCA1MDAsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDcyMiwgNTAwLCA3MjIsIDUwMCwgNzIyLCA1MDAsIDcyMiwgNTAwLCA3MjIsIDYxNSwgNzIyLCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNzc4LCA1NTYsIDc3OCwgNTU2LCA3NzgsIDU1NiwgNzc4LCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyMjIsIDI3OCwgMjc4LCA3MzUsIDQ0NCwgNTAwLCAyMjIsIDY2NywgNTAwLCA1MDAsIDU1NiwgMjIyLCA1NTYsIDIyMiwgNTU2LCAyOTIsIDU1NiwgMzM0LCA1NTYsIDIyMiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNjA0LCA3MjMsIDU1NiwgNzc4LCA1NTYsIDc3OCwgNTU2LCA3NzgsIDU1NiwgMTAwMCwgOTQ0LCA3MjIsIDMzMywgNzIyLCAzMzMsIDcyMiwgMzMzLCA2NjcsIDUwMCwgNjY3LCA1MDAsIDY2NywgNTAwLCA2NjcsIDUwMCwgNjExLCAyNzgsIDYxMSwgMzc1LCA2MTEsIDI3OCwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgOTQ0LCA3MjIsIDY2NywgNTAwLCA2NjcsIDYxMSwgNTAwLCA2MTEsIDUwMCwgNjExLCA1MDAsIDIyMiwgNTU2LCA2NjcsIDU1NiwgMTAwMCwgODg5LCA3NzgsIDYxMSwgNjY3LCA1MDAsIDYxMSwgMjc4LCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgNjY3LCAyNzgsIDc4NCwgODM4LCAzODQsIDc3NCwgODU1LCA3NTIsIDIyMiwgNjY3LCA2NjcsIDU1MSwgNjY4LCA2NjcsIDYxMSwgNzIyLCA3NzgsIDI3OCwgNjY3LCA2NjgsIDgzMywgNzIyLCA2NTAsIDc3OCwgNzIyLCA2NjcsIDYxOCwgNjExLCA2NjcsIDc5OCwgNjY3LCA4MzUsIDc0OCwgMjc4LCA2NjcsIDU3OCwgNDQ2LCA1NTYsIDIyMiwgNTQ3LCA1NzgsIDU3NSwgNTAwLCA1NTcsIDQ0NiwgNDQxLCA1NTYsIDU1NiwgMjIyLCA1MDAsIDUwMCwgNTc2LCA1MDAsIDQ0OCwgNTU2LCA2OTAsIDU2OSwgNDgyLCA2MTcsIDM5NSwgNTQ3LCA2NDgsIDUyNSwgNzEzLCA3ODEsIDIyMiwgNTQ3LCA1NTYsIDU0NywgNzgxLCA2NjcsIDY2NywgODY1LCA1NDIsIDcxOSwgNjY3LCAyNzgsIDI3OCwgNTAwLCAxMDU3LCAxMDEwLCA4NTQsIDU4MywgNzIyLCA2MzUsIDcxOSwgNjY3LCA2NTYsIDY2NywgNTQyLCA2NzcsIDY2NywgOTIzLCA2MDQsIDcxOSwgNzE5LCA1ODMsIDY1NiwgODMzLCA3MjIsIDc3OCwgNzE5LCA2NjcsIDcyMiwgNjExLCA2MzUsIDc2MCwgNjY3LCA3NDAsIDY2NywgOTE3LCA5MzgsIDc5MiwgODg1LCA2NTYsIDcxOSwgMTAxMCwgNzIyLCA1NTYsIDU3MywgNTMxLCAzNjUsIDU4MywgNTU2LCA2NjksIDQ1OCwgNTU5LCA1NTksIDQzOCwgNTgzLCA2ODgsIDU1MiwgNTU2LCA1NDIsIDU1NiwgNTAwLCA0NTgsIDUwMCwgODIzLCA1MDAsIDU3MywgNTIxLCA4MDIsIDgyMywgNjI1LCA3MTksIDUyMSwgNTEwLCA3NTAsIDU0MiwgNTU2LCA1NTYsIDU1NiwgMzY1LCA1MTAsIDUwMCwgMjIyLCAyNzgsIDIyMiwgOTA2LCA4MTIsIDU1NiwgNDM4LCA1NTksIDUwMCwgNTUyLCA3NzgsIDU1NiwgNDg5LCA0MTEsIDk0NCwgNzIyLCA5NDQsIDcyMiwgOTQ0LCA3MjIsIDY2NywgNTAwLCAzMzMsIDMzMywgNTU2LCAxMDAwLCAxMDAwLCA1NTIsIDIyMiwgMjIyLCAyMjIsIDIyMiwgMzMzLCAzMzMsIDMzMywgNTU2LCA1NTYsIDM1MCwgMTAwMCwgMTAwMCwgMTg4LCAzNTQsIDMzMywgMzMzLCA1MDAsIDMzMywgMTY3LCAzNjUsIDU1NiwgNTU2LCAxMDk0LCA1NTYsIDg4NSwgMzIzLCAxMDczLCAxMDAwLCA3NjgsIDYwMCwgODM0LCA4MzQsIDgzNCwgODM0LCAxMDAwLCA1MDAsIDEwMDAsIDUwMCwgMTAwMCwgNTAwLCA1MDAsIDQ5NCwgNjEyLCA4MjMsIDcxMywgNTg0LCA1NDksIDcxMywgOTc5LCA3MTksIDI3NCwgNTQ5LCA1NDksIDU4MywgNTQ5LCA1NDksIDYwNCwgNTg0LCA2MDQsIDYwNCwgNzA4LCA2MjUsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcyOSwgNjA0LCA2MDQsIDM1NCwgMzU0LCAxMDAwLCA5OTAsIDk5MCwgOTkwLCA5OTAsIDQ5NCwgNjA0LCA2MDQsIDYwNCwgNjA0LCAzNTQsIDEwMjEsIDEwNTIsIDkxNywgNzUwLCA3NTAsIDUzMSwgNjU2LCA1OTQsIDUxMCwgNTAwLCA3NTAsIDc1MCwgNTAwLCA1MDAsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAyMjIsIDIyMiwgMjk0LCAyOTQsIDMyNCwgMzI0LCAzMTYsIDMyOCwgMzk4LCAyODVdOwpleHBvcnRzLkxpYmVyYXRpb25TYW5zUmVndWxhcldpZHRocyA9IExpYmVyYXRpb25TYW5zUmVndWxhcldpZHRoczsKY29uc3QgTGliZXJhdGlvblNhbnNSZWd1bGFyTWFwcGluZyA9IFstMSwgLTEsIC0xLCAzMiwgMzMsIDM0LCAzNSwgMzYsIDM3LCAzOCwgMzksIDQwLCA0MSwgNDIsIDQzLCA0NCwgNDUsIDQ2LCA0NywgNDgsIDQ5LCA1MCwgNTEsIDUyLCA1MywgNTQsIDU1LCA1NiwgNTcsIDU4LCA1OSwgNjAsIDYxLCA2MiwgNjMsIDY0LCA2NSwgNjYsIDY3LCA2OCwgNjksIDcwLCA3MSwgNzIsIDczLCA3NCwgNzUsIDc2LCA3NywgNzgsIDc5LCA4MCwgODEsIDgyLCA4MywgODQsIDg1LCA4NiwgODcsIDg4LCA4OSwgOTAsIDkxLCA5MiwgOTMsIDk0LCA5NSwgOTYsIDk3LCA5OCwgOTksIDEwMCwgMTAxLCAxMDIsIDEwMywgMTA0LCAxMDUsIDEwNiwgMTA3LCAxMDgsIDEwOSwgMTEwLCAxMTEsIDExMiwgMTEzLCAxMTQsIDExNSwgMTE2LCAxMTcsIDExOCwgMTE5LCAxMjAsIDEyMSwgMTIyLCAxMjMsIDEyNCwgMTI1LCAxMjYsIDE2MSwgMTYyLCAxNjMsIDE2NCwgMTY1LCAxNjYsIDE2NywgMTY4LCAxNjksIDE3MCwgMTcxLCAxNzIsIDE3NCwgMTc1LCAxNzYsIDE3NywgMTc4LCAxNzksIDE4MCwgMTgxLCAxODIsIDE4MywgMTg0LCAxODUsIDE4NiwgMTg3LCAxODgsIDE4OSwgMTkwLCAxOTEsIDE5MiwgMTkzLCAxOTQsIDE5NSwgMTk2LCAxOTcsIDE5OCwgMTk5LCAyMDAsIDIwMSwgMjAyLCAyMDMsIDIwNCwgMjA1LCAyMDYsIDIwNywgMjA4LCAyMDksIDIxMCwgMjExLCAyMTIsIDIxMywgMjE0LCAyMTUsIDIxNiwgMjE3LCAyMTgsIDIxOSwgMjIwLCAyMjEsIDIyMiwgMjIzLCAyMjQsIDIyNSwgMjI2LCAyMjcsIDIyOCwgMjI5LCAyMzAsIDIzMSwgMjMyLCAyMzMsIDIzNCwgMjM1LCAyMzYsIDIzNywgMjM4LCAyMzksIDI0MCwgMjQxLCAyNDIsIDI0MywgMjQ0LCAyNDUsIDI0NiwgMjQ3LCAyNDgsIDI0OSwgMjUwLCAyNTEsIDI1MiwgMjUzLCAyNTQsIDI1NSwgMjU2LCAyNTcsIDI1OCwgMjU5LCAyNjAsIDI2MSwgMjYyLCAyNjMsIDI2NCwgMjY1LCAyNjYsIDI2NywgMjY4LCAyNjksIDI3MCwgMjcxLCAyNzIsIDI3MywgMjc0LCAyNzUsIDI3NiwgMjc3LCAyNzgsIDI3OSwgMjgwLCAyODEsIDI4MiwgMjgzLCAyODQsIDI4NSwgMjg2LCAyODcsIDI4OCwgMjg5LCAyOTAsIDI5MSwgMjkyLCAyOTMsIDI5NCwgMjk1LCAyOTYsIDI5NywgMjk4LCAyOTksIDMwMCwgMzAxLCAzMDIsIDMwMywgMzA0LCAzMDUsIDMwNiwgMzA3LCAzMDgsIDMwOSwgMzEwLCAzMTEsIDMxMiwgMzEzLCAzMTQsIDMxNSwgMzE2LCAzMTcsIDMxOCwgMzE5LCAzMjAsIDMyMSwgMzIyLCAzMjMsIDMyNCwgMzI1LCAzMjYsIDMyNywgMzI4LCAzMjksIDMzMCwgMzMxLCAzMzIsIDMzMywgMzM0LCAzMzUsIDMzNiwgMzM3LCAzMzgsIDMzOSwgMzQwLCAzNDEsIDM0MiwgMzQzLCAzNDQsIDM0NSwgMzQ2LCAzNDcsIDM0OCwgMzQ5LCAzNTAsIDM1MSwgMzUyLCAzNTMsIDM1NCwgMzU1LCAzNTYsIDM1NywgMzU4LCAzNTksIDM2MCwgMzYxLCAzNjIsIDM2MywgMzY0LCAzNjUsIDM2NiwgMzY3LCAzNjgsIDM2OSwgMzcwLCAzNzEsIDM3MiwgMzczLCAzNzQsIDM3NSwgMzc2LCAzNzcsIDM3OCwgMzc5LCAzODAsIDM4MSwgMzgyLCAzODMsIDQwMiwgNTA2LCA1MDcsIDUwOCwgNTA5LCA1MTAsIDUxMSwgNTM2LCA1MzcsIDUzOCwgNTM5LCA3MTAsIDcxMSwgNzEzLCA3MjgsIDcyOSwgNzMwLCA3MzEsIDczMiwgNzMzLCA5MDAsIDkwMSwgOTAyLCA5MDMsIDkwNCwgOTA1LCA5MDYsIDkwOCwgOTEwLCA5MTEsIDkxMiwgOTEzLCA5MTQsIDkxNSwgOTE2LCA5MTcsIDkxOCwgOTE5LCA5MjAsIDkyMSwgOTIyLCA5MjMsIDkyNCwgOTI1LCA5MjYsIDkyNywgOTI4LCA5MjksIDkzMSwgOTMyLCA5MzMsIDkzNCwgOTM1LCA5MzYsIDkzNywgOTM4LCA5MzksIDk0MCwgOTQxLCA5NDIsIDk0MywgOTQ0LCA5NDUsIDk0NiwgOTQ3LCA5NDgsIDk0OSwgOTUwLCA5NTEsIDk1MiwgOTUzLCA5NTQsIDk1NSwgOTU2LCA5NTcsIDk1OCwgOTU5LCA5NjAsIDk2MSwgOTYyLCA5NjMsIDk2NCwgOTY1LCA5NjYsIDk2NywgOTY4LCA5NjksIDk3MCwgOTcxLCA5NzIsIDk3MywgOTc0LCAxMDI0LCAxMDI1LCAxMDI2LCAxMDI3LCAxMDI4LCAxMDI5LCAxMDMwLCAxMDMxLCAxMDMyLCAxMDMzLCAxMDM0LCAxMDM1LCAxMDM2LCAxMDM3LCAxMDM4LCAxMDM5LCAxMDQwLCAxMDQxLCAxMDQyLCAxMDQzLCAxMDQ0LCAxMDQ1LCAxMDQ2LCAxMDQ3LCAxMDQ4LCAxMDQ5LCAxMDUwLCAxMDUxLCAxMDUyLCAxMDUzLCAxMDU0LCAxMDU1LCAxMDU2LCAxMDU3LCAxMDU4LCAxMDU5LCAxMDYwLCAxMDYxLCAxMDYyLCAxMDYzLCAxMDY0LCAxMDY1LCAxMDY2LCAxMDY3LCAxMDY4LCAxMDY5LCAxMDcwLCAxMDcxLCAxMDcyLCAxMDczLCAxMDc0LCAxMDc1LCAxMDc2LCAxMDc3LCAxMDc4LCAxMDc5LCAxMDgwLCAxMDgxLCAxMDgyLCAxMDgzLCAxMDg0LCAxMDg1LCAxMDg2LCAxMDg3LCAxMDg4LCAxMDg5LCAxMDkwLCAxMDkxLCAxMDkyLCAxMDkzLCAxMDk0LCAxMDk1LCAxMDk2LCAxMDk3LCAxMDk4LCAxMDk5LCAxMTAwLCAxMTAxLCAxMTAyLCAxMTAzLCAxMTA0LCAxMTA1LCAxMTA2LCAxMTA3LCAxMTA4LCAxMTA5LCAxMTEwLCAxMTExLCAxMTEyLCAxMTEzLCAxMTE0LCAxMTE1LCAxMTE2LCAxMTE3LCAxMTE4LCAxMTE5LCAxMTM4LCAxMTM5LCAxMTY4LCAxMTY5LCA3ODA4LCA3ODA5LCA3ODEwLCA3ODExLCA3ODEyLCA3ODEzLCA3OTIyLCA3OTIzLCA4MjA4LCA4MjA5LCA4MjExLCA4MjEyLCA4MjEzLCA4MjE1LCA4MjE2LCA4MjE3LCA4MjE4LCA4MjE5LCA4MjIwLCA4MjIxLCA4MjIyLCA4MjI0LCA4MjI1LCA4MjI2LCA4MjMwLCA4MjQwLCA4MjQyLCA4MjQzLCA4MjQ5LCA4MjUwLCA4MjUyLCA4MjU0LCA4MjYwLCA4MzE5LCA4MzU1LCA4MzU2LCA4MzU5LCA4MzY0LCA4NDUzLCA4NDY3LCA4NDcwLCA4NDgyLCA4NDg2LCA4NDk0LCA4NTM5LCA4NTQwLCA4NTQxLCA4NTQyLCA4NTkyLCA4NTkzLCA4NTk0LCA4NTk1LCA4NTk2LCA4NTk3LCA4NjE2LCA4NzA2LCA4NzEwLCA4NzE5LCA4NzIxLCA4NzIyLCA4NzMwLCA4NzM0LCA4NzM1LCA4NzQ1LCA4NzQ3LCA4Nzc2LCA4ODAwLCA4ODAxLCA4ODA0LCA4ODA1LCA4OTYyLCA4OTc2LCA4OTkyLCA4OTkzLCA5NDcyLCA5NDc0LCA5NDg0LCA5NDg4LCA5NDkyLCA5NDk2LCA5NTAwLCA5NTA4LCA5NTE2LCA5NTI0LCA5NTMyLCA5NTUyLCA5NTUzLCA5NTU0LCA5NTU1LCA5NTU2LCA5NTU3LCA5NTU4LCA5NTU5LCA5NTYwLCA5NTYxLCA5NTYyLCA5NTYzLCA5NTY0LCA5NTY1LCA5NTY2LCA5NTY3LCA5NTY4LCA5NTY5LCA5NTcwLCA5NTcxLCA5NTcyLCA5NTczLCA5NTc0LCA5NTc1LCA5NTc2LCA5NTc3LCA5NTc4LCA5NTc5LCA5NTgwLCA5NjAwLCA5NjA0LCA5NjA4LCA5NjEyLCA5NjE2LCA5NjE3LCA5NjE4LCA5NjE5LCA5NjMyLCA5NjMzLCA5NjQyLCA5NjQzLCA5NjQ0LCA5NjUwLCA5NjU4LCA5NjYwLCA5NjY4LCA5Njc0LCA5Njc1LCA5Njc5LCA5Njg4LCA5Njg5LCA5NzAyLCA5Nzg2LCA5Nzg3LCA5Nzg4LCA5NzkyLCA5Nzk0LCA5ODI0LCA5ODI3LCA5ODI5LCA5ODMwLCA5ODM0LCA5ODM1LCA5ODM2LCA2MTQ0MSwgNjE0NDIsIDYxNDQ1LCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTFdOwpleHBvcnRzLkxpYmVyYXRpb25TYW5zUmVndWxhck1hcHBpbmcgPSBMaWJlcmF0aW9uU2Fuc1JlZ3VsYXJNYXBwaW5nOwoKLyoqKi8gfSksCi8qIDE4MCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTXlyaWFkUHJvUmVndWxhck1ldHJpY3MgPSBleHBvcnRzLk15cmlhZFByb1JlZ3VsYXJGYWN0b3JzID0gZXhwb3J0cy5NeXJpYWRQcm9JdGFsaWNNZXRyaWNzID0gZXhwb3J0cy5NeXJpYWRQcm9JdGFsaWNGYWN0b3JzID0gZXhwb3J0cy5NeXJpYWRQcm9Cb2xkTWV0cmljcyA9IGV4cG9ydHMuTXlyaWFkUHJvQm9sZEl0YWxpY01ldHJpY3MgPSBleHBvcnRzLk15cmlhZFByb0JvbGRJdGFsaWNGYWN0b3JzID0gZXhwb3J0cy5NeXJpYWRQcm9Cb2xkRmFjdG9ycyA9IHZvaWQgMDsKY29uc3QgTXlyaWFkUHJvQm9sZEZhY3RvcnMgPSBbMS4zNjg5OCwgMSwgMSwgMC43MjcwNiwgMC44MDQ3OSwgMC44MzczNCwgMC45ODg5NCwgMC45OTc5MywgMC45ODk3LCAwLjkzODg0LCAwLjg2MjA5LCAwLjk0MjkyLCAwLjk0MjkyLCAxLjE2NjYxLCAxLjAyMDU4LCAwLjkzNTgyLCAwLjk2Njk0LCAwLjkzNTgyLCAxLjE5MTM3LCAwLjk5NzkzLCAwLjk5NzkzLCAwLjk5NzkzLCAwLjk5NzkzLCAwLjk5NzkzLCAwLjk5NzkzLCAwLjk5NzkzLCAwLjk5NzkzLCAwLjk5NzkzLCAwLjk5NzkzLCAwLjc4MDc2LCAwLjc4MDc2LCAxLjAyMDU4LCAxLjAyMDU4LCAxLjAyMDU4LCAwLjcyODUxLCAwLjc4OTY2LCAwLjkwODM4LCAwLjgzNjM3LCAwLjgyMzkxLCAwLjk2Mzc2LCAwLjgwMDYxLCAwLjg2Mjc1LCAwLjg3NjgsIDAuOTU0MDcsIDEuMDI1OCwgMC43MzkwMSwgMC44NTAyMiwgMC44MzY1NSwgMS4wMTU2LCAwLjk1NTQ2LCAwLjkyMTc5LCAwLjg3MTA3LCAwLjkyMTc5LCAwLjgyMTE0LCAwLjgwOTYsIDAuODk3MTMsIDAuOTQ0MzgsIDAuOTUzNTMsIDAuOTQwODMsIDAuOTE5MDUsIDAuOTA0MDYsIDAuOTQ0NiwgMC45NDI5MiwgMS4xODc3NywgMC45NDI5MiwgMS4wMjA1OCwgMC44OTkwMywgMC45MDA4OCwgMC45NDkzOCwgMC45Nzg5OCwgMC44MTA5MywgMC45NzU3MSwgMC45NDkzOCwgMS4wMjQsIDAuOTU3NywgMC45NTkzMywgMC45ODYyMSwgMS4wNDc0LCAwLjk3NDU1LCAwLjk4OTgxLCAwLjk2NzIsIDAuOTU5MzMsIDAuOTQ0NiwgMC45Nzg5OCwgMC45NzQwNywgMC45NzY0NiwgMC43ODAzNiwgMS4xMDIwOCwgMC45NTQ0MiwgMC45NTI5OCwgMC45NzU3OSwgMC45MzMyLCAwLjk0MDM5LCAwLjkzOCwgMC44MDY4NywgMS4wMTE0OSwgMC44MDY4NywgMS4wMjA1OCwgMC44MDQ3OSwgMC45OTc5MywgMC45OTc5MywgMC45OTc5MywgMC45OTc5MywgMS4wMTE0OSwgMS4wMDg3MiwgMC45MDA4OCwgMC45MTg4MiwgMS4wMjEzLCAwLjgzNjEsIDEuMDIwNTgsIDAuNjIyOTUsIDAuNTQzMjQsIDAuODkwMjIsIDEuMDg1OTUsIDEsIDEsIDAuOTAwODgsIDEsIDAuOTc0NTUsIDAuOTM1ODIsIDAuOTAwODgsIDEsIDEuMDU2ODYsIDAuODM2MSwgMC45OTY0MiwgMC45OTY0MiwgMC45OTY0MiwgMC43Mjg1MSwgMC45MDgzOCwgMC45MDgzOCwgMC45MDgzOCwgMC45MDgzOCwgMC45MDgzOCwgMC45MDgzOCwgMC44NjgsIDAuODIzOTEsIDAuODAwNjEsIDAuODAwNjEsIDAuODAwNjEsIDAuODAwNjEsIDEuMDI1OCwgMS4wMjU4LCAxLjAyNTgsIDEuMDI1OCwgMC45NzQ4NCwgMC45NTU0NiwgMC45MjE3OSwgMC45MjE3OSwgMC45MjE3OSwgMC45MjE3OSwgMC45MjE3OSwgMS4wMjA1OCwgMC45MjE3OSwgMC45NDQzOCwgMC45NDQzOCwgMC45NDQzOCwgMC45NDQzOCwgMC45MDQwNiwgMC44Njk1OCwgMC45ODIyNSwgMC45NDkzOCwgMC45NDkzOCwgMC45NDkzOCwgMC45NDkzOCwgMC45NDkzOCwgMC45NDkzOCwgMC45MDMxLCAwLjgxMDkzLCAwLjk0OTM4LCAwLjk0OTM4LCAwLjk0OTM4LCAwLjk0OTM4LCAwLjk4NjIxLCAwLjk4NjIxLCAwLjk4NjIxLCAwLjk4NjIxLCAwLjkzOTY5LCAwLjk1OTMzLCAwLjk0NDYsIDAuOTQ0NiwgMC45NDQ2LCAwLjk0NDYsIDAuOTQ0NiwgMS4wODU5NSwgMC45NDQ2LCAwLjk1NDQyLCAwLjk1NDQyLCAwLjk1NDQyLCAwLjk1NDQyLCAwLjk0MDM5LCAwLjk3ODk4LCAwLjk0MDM5LCAwLjkwODM4LCAwLjk0OTM4LCAwLjkwODM4LCAwLjk0OTM4LCAwLjkwODM4LCAwLjk0OTM4LCAwLjgyMzkxLCAwLjgxMDkzLCAwLjgyMzkxLCAwLjgxMDkzLCAwLjgyMzkxLCAwLjgxMDkzLCAwLjgyMzkxLCAwLjgxMDkzLCAwLjk2Mzc2LCAwLjg0MzEzLCAwLjk3NDg0LCAwLjk3NTcxLCAwLjgwMDYxLCAwLjk0OTM4LCAwLjgwMDYxLCAwLjk0OTM4LCAwLjgwMDYxLCAwLjk0OTM4LCAwLjgwMDYxLCAwLjk0OTM4LCAwLjgwMDYxLCAwLjk0OTM4LCAwLjg3NjgsIDAuOTU3NywgMC44NzY4LCAwLjk1NzcsIDAuODc2OCwgMC45NTc3LCAxLCAxLCAwLjk1NDA3LCAwLjk1OTMzLCAwLjk3MDY5LCAwLjk1OTMzLCAxLjAyNTgsIDAuOTg2MjEsIDEuMDI1OCwgMC45ODYyMSwgMS4wMjU4LCAwLjk4NjIxLCAxLjAyNTgsIDAuOTg2MjEsIDEuMDI1OCwgMC45ODYyMSwgMC44ODcsIDEuMDE1OTEsIDAuNzM5MDEsIDEuMDQ3NCwgMSwgMSwgMC45NzQ1NSwgMC44MzY1NSwgMC45ODk4MSwgMSwgMSwgMC44MzY1NSwgMC43Mzk3NywgMC44MzY1NSwgMC43MzkwMywgMC44NDYzOCwgMS4wMzMsIDAuOTU1NDYsIDAuOTU5MzMsIDEsIDEsIDAuOTU1NDYsIDAuOTU5MzMsIDAuODI3MSwgMC45NTQxNywgMC45NTkzMywgMC45MjE3OSwgMC45NDQ2LCAwLjkyMTc5LCAwLjk0NDYsIDAuOTIxNzksIDAuOTQ0NiwgMC45MzYsIDAuOTE5NjQsIDAuODIxMTQsIDAuOTc2NDYsIDEsIDEsIDAuODIxMTQsIDAuOTc2NDYsIDAuODA5NiwgMC43ODAzNiwgMC44MDk2LCAwLjc4MDM2LCAxLCAxLCAwLjgwOTYsIDAuNzgwMzYsIDEsIDEsIDAuODk3MTMsIDAuNzc0NTIsIDAuODk3MTMsIDEuMTAyMDgsIDAuOTQ0MzgsIDAuOTU0NDIsIDAuOTQ0MzgsIDAuOTU0NDIsIDAuOTQ0MzgsIDAuOTU0NDIsIDAuOTQ0MzgsIDAuOTU0NDIsIDAuOTQ0MzgsIDAuOTU0NDIsIDAuOTQ0MzgsIDAuOTU0NDIsIDAuOTQwODMsIDAuOTc1NzksIDAuOTA0MDYsIDAuOTQwMzksIDAuOTA0MDYsIDAuOTQ0NiwgMC45MzgsIDAuOTQ0NiwgMC45MzgsIDAuOTQ0NiwgMC45MzgsIDEsIDAuOTk3OTMsIDAuOTA4MzgsIDAuOTQ5MzgsIDAuODY4LCAwLjkwMzEsIDAuOTIxNzksIDAuOTQ0NiwgMSwgMSwgMC44OTcxMywgMS4xMDIwOCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDk4OSwgMC45MzU4LCAwLjkxOTQ1LCAwLjgzMTgxLCAwLjc1MjYxLCAwLjg3OTkyLCAwLjgyOTc2LCAwLjk2MDM0LCAwLjgzNjg5LCAwLjk3MjY4LCAxLjAwNzgsIDAuOTA4MzgsIDAuODM2MzcsIDAuODAxOSwgMC45MDE1NywgMC44MDA2MSwgMC45NDQ2LCAwLjk1NDA3LCAwLjkyNDM2LCAxLjAyNTgsIDAuODUwMjIsIDAuOTcxNTMsIDEuMDE1NiwgMC45NTU0NiwgMC44OTE5MiwgMC45MjE3OSwgMC45MjM2MSwgMC44NzEwNywgMC45NjMxOCwgMC44OTcxMywgMC45MzcwNCwgMC45NTYzOCwgMC45MTkwNSwgMC45MTcwOSwgMC45Mjc5NiwgMS4wMjU4LCAwLjkzNzA0LCAwLjk0ODM2LCAxLjAzNzMsIDAuOTU5MzMsIDEuMDA3OCwgMC45NTg3MSwgMC45NDgzNiwgMC45NjE3NCwgMC45MjYwMSwgMC45NDk4LCAwLjk4NjA3LCAwLjk1Nzc2LCAwLjk1OTMzLCAxLjA1NDUzLCAxLjAwNzgsIDAuOTgyNzUsIDAuOTMxNCwgMC45NTYxNywgMC45MTcwMSwgMS4wNTk5MywgMC45NDQ2LCAwLjc4MzY3LCAwLjk1NTMsIDEsIDAuODY4MzIsIDEuMDEyOCwgMC45NTg3MSwgMC45OTM5NCwgMC44NzU0OCwgMC45NjM2MSwgMC44Njc3NCwgMS4wMDc4LCAwLjk1ODcxLCAwLjk0NDYsIDAuOTU4NzEsIDAuODY3NzQsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTQwODMsIDAuOTc1NzksIDAuOTQwODMsIDAuOTc1NzksIDAuOTQwODMsIDAuOTc1NzksIDAuOTA0MDYsIDAuOTQwMzksIDAuOTY2OTQsIDEsIDAuODk5MDMsIDEsIDEsIDEsIDAuOTM1ODIsIDAuOTM1ODIsIDAuOTM1ODIsIDEsIDAuOTA4LCAwLjkwOCwgMC45MTgsIDAuOTQyMTksIDAuOTQyMTksIDAuOTY1NDQsIDEsIDEuMjg1LCAxLCAxLCAwLjgxMDc5LCAwLjgxMDc5LCAxLCAxLCAwLjc0ODU0LCAxLCAxLCAxLCAxLCAwLjk5NzkzLCAxLCAxLCAxLCAwLjY1LCAxLCAxLjM2MTQ1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjE3MTczLCAxLCAwLjgwNTM1LCAwLjc2MTY5LCAxLjAyMDU4LCAxLjA3MzIsIDEuMDU0ODYsIDEsIDEsIDEuMzA2OTIsIDEuMDg1OTUsIDEuMDg1OTUsIDEsIDEuMDg1OTUsIDEuMDg1OTUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMTYxNjEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLk15cmlhZFByb0JvbGRGYWN0b3JzID0gTXlyaWFkUHJvQm9sZEZhY3RvcnM7CmNvbnN0IE15cmlhZFByb0JvbGRNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMiwKICBsaW5lR2FwOiAwLjIKfTsKZXhwb3J0cy5NeXJpYWRQcm9Cb2xkTWV0cmljcyA9IE15cmlhZFByb0JvbGRNZXRyaWNzOwpjb25zdCBNeXJpYWRQcm9Cb2xkSXRhbGljRmFjdG9ycyA9IFsxLjM2ODk4LCAxLCAxLCAwLjY2MjI3LCAwLjgwNzc5LCAwLjgxNjI1LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3NzMzLCAwLjkyMjIyLCAwLjgzMjY2LCAwLjk0MjkyLCAwLjk0MjkyLCAxLjE2MTQ4LCAxLjAyMDU4LCAwLjkzNTgyLCAwLjk2Njk0LCAwLjkzNTgyLCAxLjE3MzM3LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjc4MDc2LCAwLjc4MDc2LCAxLjAyMDU4LCAxLjAyMDU4LCAxLjAyMDU4LCAwLjcxNTQxLCAwLjc2ODEzLCAwLjg1NTc2LCAwLjgwNTkxLCAwLjgwNzI5LCAwLjk0Mjk5LCAwLjc3NTEyLCAwLjgzNjU1LCAwLjg2NTIzLCAwLjkyMjIyLCAwLjk4NjIxLCAwLjcxNzQzLCAwLjgxNjk4LCAwLjc5NzI2LCAwLjk4NTU4LCAwLjkyMjIyLCAwLjkwNjM3LCAwLjgzODA5LCAwLjkwNjM3LCAwLjgwNzI5LCAwLjc2NDYzLCAwLjg2Mjc1LCAwLjkwNjk5LCAwLjkxNjA1LCAwLjkxNTQsIDAuODUzMDgsIDAuODU0NTgsIDAuOTA1MzEsIDAuOTQyOTIsIDEuMjEyOTYsIDAuOTQyOTIsIDEuMDIwNTgsIDAuODk5MDMsIDEuMTg2MTYsIDAuOTk2MTMsIDAuOTE2NzcsIDAuNzgyMTYsIDAuOTE2NzcsIDAuOTAwODMsIDAuOTg3OTYsIDAuOTEzNSwgMC45MjE2OCwgMC45NTM4MSwgMC45ODk4MSwgMC45NTI5OCwgMC45NTM4MSwgMC45MzQ1OSwgMC45MjE2OCwgMC45MTUxMywgMC45MjAwNCwgMC45MTY3NywgMC45NTA3NywgMC43NDgsIDEuMDQ1MDIsIDAuOTE2NzcsIDAuOTIwNjEsIDAuOTQyMzYsIDAuODk1NDQsIDAuODkzNjQsIDAuOSwgMC44MDY4NywgMC44NTc4LCAwLjgwNjg3LCAxLjAyMDU4LCAwLjgwNzc5LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjk3Mjc2LCAwLjg1NzgsIDAuOTk5NzMsIDEuMTg2MTYsIDAuOTEzMzksIDEuMDgwNzQsIDAuODI4OTEsIDEuMDIwNTgsIDAuNTU1MDksIDAuNzE1MjYsIDAuODkwMjIsIDEuMDg1OTUsIDEsIDEsIDEuMTg2MTYsIDEsIDAuOTY3MzYsIDAuOTM1ODIsIDEuMTg2MTYsIDEsIDEuMDQ4NjQsIDAuODI3MTEsIDAuOTkwNDMsIDAuOTkwNDMsIDAuOTkwNDMsIDAuNzE1NDEsIDAuODU1NzYsIDAuODU1NzYsIDAuODU1NzYsIDAuODU1NzYsIDAuODU1NzYsIDAuODU1NzYsIDAuODQ1LCAwLjgwNzI5LCAwLjc3NTEyLCAwLjc3NTEyLCAwLjc3NTEyLCAwLjc3NTEyLCAwLjk4NjIxLCAwLjk4NjIxLCAwLjk4NjIxLCAwLjk4NjIxLCAwLjk1OTYxLCAwLjkyMjIyLCAwLjkwNjM3LCAwLjkwNjM3LCAwLjkwNjM3LCAwLjkwNjM3LCAwLjkwNjM3LCAxLjAyMDU4LCAwLjkwMjUxLCAwLjkwNjk5LCAwLjkwNjk5LCAwLjkwNjk5LCAwLjkwNjk5LCAwLjg1NDU4LCAwLjgzNjU5LCAwLjk0OTUxLCAwLjk5NjEzLCAwLjk5NjEzLCAwLjk5NjEzLCAwLjk5NjEzLCAwLjk5NjEzLCAwLjk5NjEzLCAwLjg1ODExLCAwLjc4MjE2LCAwLjkwMDgzLCAwLjkwMDgzLCAwLjkwMDgzLCAwLjkwMDgzLCAwLjk1MzgxLCAwLjk1MzgxLCAwLjk1MzgxLCAwLjk1MzgxLCAwLjkxMzUsIDAuOTIxNjgsIDAuOTE1MTMsIDAuOTE1MTMsIDAuOTE1MTMsIDAuOTE1MTMsIDAuOTE1MTMsIDEuMDg1OTUsIDAuOTE2NzcsIDAuOTE2NzcsIDAuOTE2NzcsIDAuOTE2NzcsIDAuOTE2NzcsIDAuODkzNjQsIDAuOTIzMzIsIDAuODkzNjQsIDAuODU1NzYsIDAuOTk2MTMsIDAuODU1NzYsIDAuOTk2MTMsIDAuODU1NzYsIDAuOTk2MTMsIDAuODA3MjksIDAuNzgyMTYsIDAuODA3MjksIDAuNzgyMTYsIDAuODA3MjksIDAuNzgyMTYsIDAuODA3MjksIDAuNzgyMTYsIDAuOTQyOTksIDAuNzY3ODMsIDAuOTU5NjEsIDAuOTE2NzcsIDAuNzc1MTIsIDAuOTAwODMsIDAuNzc1MTIsIDAuOTAwODMsIDAuNzc1MTIsIDAuOTAwODMsIDAuNzc1MTIsIDAuOTAwODMsIDAuNzc1MTIsIDAuOTAwODMsIDAuODY1MjMsIDAuOTEzNSwgMC44NjUyMywgMC45MTM1LCAwLjg2NTIzLCAwLjkxMzUsIDEsIDEsIDAuOTIyMjIsIDAuOTIxNjgsIDAuOTIyMjIsIDAuOTIxNjgsIDAuOTg2MjEsIDAuOTUzODEsIDAuOTg2MjEsIDAuOTUzODEsIDAuOTg2MjEsIDAuOTUzODEsIDAuOTg2MjEsIDAuOTUzODEsIDAuOTg2MjEsIDAuOTUzODEsIDAuODYwMzYsIDAuOTcwOTYsIDAuNzE3NDMsIDAuOTg5ODEsIDEsIDEsIDAuOTUyOTgsIDAuNzk3MjYsIDAuOTUzODEsIDEsIDEsIDAuNzk3MjYsIDAuNjg5NCwgMC43OTcyNiwgMC43NDMyMSwgMC44MTY5MSwgMS4wMDA2LCAwLjkyMjIyLCAwLjkyMTY4LCAxLCAxLCAwLjkyMjIyLCAwLjkyMTY4LCAwLjc5NDY0LCAwLjkyMDk4LCAwLjkyMTY4LCAwLjkwNjM3LCAwLjkxNTEzLCAwLjkwNjM3LCAwLjkxNTEzLCAwLjkwNjM3LCAwLjkxNTEzLCAwLjkwOSwgMC44NzUxNCwgMC44MDcyOSwgMC45NTA3NywgMSwgMSwgMC44MDcyOSwgMC45NTA3NywgMC43NjQ2MywgMC43NDgsIDAuNzY0NjMsIDAuNzQ4LCAxLCAxLCAwLjc2NDYzLCAwLjc0OCwgMSwgMSwgMC44NjI3NSwgMC43MjY1MSwgMC44NjI3NSwgMS4wNDUwMiwgMC45MDY5OSwgMC45MTY3NywgMC45MDY5OSwgMC45MTY3NywgMC45MDY5OSwgMC45MTY3NywgMC45MDY5OSwgMC45MTY3NywgMC45MDY5OSwgMC45MTY3NywgMC45MDY5OSwgMC45MTY3NywgMC45MTU0LCAwLjk0MjM2LCAwLjg1NDU4LCAwLjg5MzY0LCAwLjg1NDU4LCAwLjkwNTMxLCAwLjksIDAuOTA1MzEsIDAuOSwgMC45MDUzMSwgMC45LCAxLCAwLjk3Mjc2LCAwLjg1NTc2LCAwLjk5NjEzLCAwLjg0NSwgMC44NTgxMSwgMC45MDI1MSwgMC45MTY3NywgMSwgMSwgMC44NjI3NSwgMS4wNDUwMiwgMS4xODYxNiwgMS4xODYxNiwgMS4xODYxNiwgMS4xODYxNiwgMS4xODYxNiwgMS4xODYxNiwgMS4xODYxNiwgMS4xODYxNiwgMS4xODYxNiwgMS4wMDg5OSwgMS4zMDYyOCwgMC44NTU3NiwgMC44MDE3OCwgMC42Njg2MiwgMC43OTI3LCAwLjY5MzIzLCAwLjg4MTI3LCAwLjcyNDU5LCAwLjg5NzExLCAwLjk1MzgxLCAwLjg1NTc2LCAwLjgwNTkxLCAwLjc4MDUsIDAuOTQ3MjksIDAuNzc1MTIsIDAuOTA1MzEsIDAuOTIyMjIsIDAuOTA2MzcsIDAuOTg2MjEsIDAuODE2OTgsIDAuOTI2NTUsIDAuOTg1NTgsIDAuOTIyMjIsIDAuODUzNTksIDAuOTA2MzcsIDAuOTA5NzYsIDAuODM4MDksIDAuOTQ1MjMsIDAuODYyNzUsIDAuODM1MDksIDAuOTMxNTcsIDAuODUzMDgsIDAuODMzOTIsIDAuOTIzNDYsIDAuOTg2MjEsIDAuODM1MDksIDAuOTI4ODYsIDAuOTEzMjQsIDAuOTIxNjgsIDAuOTUzODEsIDAuOTA2NDYsIDAuOTI4ODYsIDAuOTA1NTcsIDAuODY4NDcsIDAuOTAyNzYsIDAuOTEzMjQsIDAuODY4NDIsIDAuOTIxNjgsIDAuOTk1MzEsIDAuOTUzODEsIDAuOTIyNCwgMC44NTQwOCwgMC45MjY5OSwgMC44Njg0NywgMS4wMDUxLCAwLjkxNTEzLCAwLjgwNDg3LCAwLjkzNDgxLCAxLCAwLjg4MTU5LCAxLjA1MjE0LCAwLjkwNjQ2LCAwLjk3MzU1LCAwLjgxNTM5LCAwLjg5Mzk4LCAwLjg1OTIzLCAwLjk1MzgxLCAwLjkwNjQ2LCAwLjkxNTEzLCAwLjkwNjQ2LCAwLjg1OTIzLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjkxNTQsIDAuOTQyMzYsIDAuOTE1NCwgMC45NDIzNiwgMC45MTU0LCAwLjk0MjM2LCAwLjg1NDU4LCAwLjg5MzY0LCAwLjk2Njk0LCAxLCAwLjg5OTAzLCAxLCAxLCAxLCAwLjkxNzgyLCAwLjkxNzgyLCAwLjkxNzgyLCAxLCAwLjg5NiwgMC44OTYsIDAuODk2LCAwLjkzMzIsIDAuOTMzMiwgMC45NTk3MywgMSwgMS4yNiwgMSwgMSwgMC44MDQ3OSwgMC44MDE3OCwgMSwgMSwgMC44NTYzMywgMSwgMSwgMSwgMSwgMC45NzI3NiwgMSwgMSwgMSwgMC42OTgsIDEsIDEuMzYxNDUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMTQ1NDIsIDEsIDAuNzkxOTksIDAuNzg2OTQsIDEuMDIwNTgsIDEuMDM0OTMsIDEuMDU0ODYsIDEsIDEsIDEuMjMwMjYsIDEuMDg1OTUsIDEuMDg1OTUsIDEsIDEuMDg1OTUsIDEuMDg1OTUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMjAwMDYsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLk15cmlhZFByb0JvbGRJdGFsaWNGYWN0b3JzID0gTXlyaWFkUHJvQm9sZEl0YWxpY0ZhY3RvcnM7CmNvbnN0IE15cmlhZFByb0JvbGRJdGFsaWNNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMiwKICBsaW5lR2FwOiAwLjIKfTsKZXhwb3J0cy5NeXJpYWRQcm9Cb2xkSXRhbGljTWV0cmljcyA9IE15cmlhZFByb0JvbGRJdGFsaWNNZXRyaWNzOwpjb25zdCBNeXJpYWRQcm9JdGFsaWNGYWN0b3JzID0gWzEuMzY4OTgsIDEsIDEsIDAuNjU1MDcsIDAuODQ5NDMsIDAuODU2MzksIDAuODg0NjUsIDAuODg0NjUsIDAuODY5MzYsIDAuODgzMDcsIDAuODY5NDgsIDAuODUyODMsIDAuODUyODMsIDEuMDYzODMsIDEuMDIwNTgsIDAuNzU5NDUsIDAuOTIxOSwgMC43NTk0NSwgMS4xNzMzNywgMC44ODQ2NSwgMC44ODQ2NSwgMC44ODQ2NSwgMC44ODQ2NSwgMC44ODQ2NSwgMC44ODQ2NSwgMC44ODQ2NSwgMC44ODQ2NSwgMC44ODQ2NSwgMC44ODQ2NSwgMC43NTk0NSwgMC43NTk0NSwgMS4wMjA1OCwgMS4wMjA1OCwgMS4wMjA1OCwgMC42OTA0NiwgMC43MDkyNiwgMC44NTE1OCwgMC43NzgxMiwgMC43Njg1MiwgMC44OTU5MSwgMC43MDQ2NiwgMC43NjEyNSwgMC44MDA5NCwgMC44NjgyMiwgMC44Mzg2NCwgMC43MjgsIDAuNzcyMTIsIDAuNzk0NzUsIDAuOTM2MzcsIDAuODc1MTQsIDAuODU4OCwgMC43NjAxMywgMC44NTg4LCAwLjcyNDIxLCAwLjY5ODY2LCAwLjc3NTk4LCAwLjg1OTkxLCAwLjgwODExLCAwLjg3ODMyLCAwLjc4MTEyLCAwLjc3NTEyLCAwLjg1NjIsIDEuMDIyMiwgMS4xODQxNywgMS4wMjIyLCAxLjI3MDE0LCAwLjg5OTAzLCAxLjE1MDEyLCAwLjkzODU5LCAwLjk0Mzk5LCAwLjg0NiwgMC45NDM5OSwgMC44MTQ1MywgMS4wMTg2LCAwLjk0MjE5LCAwLjk2MDE3LCAxLjAzMDc1LCAxLjAyMTc1LCAwLjkxMiwgMS4wMzA3NSwgMC45Njk5OCwgMC45NjAxNywgMC45Mzg1OSwgMC45NDM5OSwgMC45NDM5OSwgMC45NTQ5MywgMC43NDYsIDEuMTI2NTgsIDAuOTQ1NzgsIDAuOTEsIDAuOTc5LCAwLjg4MiwgMC44ODIsIDAuODMsIDAuODUwMzQsIDAuODM1MzcsIDAuODUwMzQsIDEuMDIwNTgsIDAuNzA4NjksIDAuODg0NjUsIDAuODg0NjUsIDAuODg0NjUsIDAuODg0NjUsIDAuODM1MzcsIDAuOTAwODMsIDEuMTUwMTIsIDAuOTE2MSwgMC45NDU2NSwgMC43MzU0MSwgMS4wMjA1OCwgMC41MzYwOSwgMC42OTM1MywgMC43OTUxOSwgMS4wODU5NSwgMSwgMSwgMS4xNTAxMiwgMSwgMC45MTk3NCwgMC43NTk0NSwgMS4xNTAxMiwgMSwgMC45NDQ2LCAwLjczMzYxLCAwLjkwMDUsIDAuOTAwNSwgMC45MDA1LCAwLjYyODY0LCAwLjg1MTU4LCAwLjg1MTU4LCAwLjg1MTU4LCAwLjg1MTU4LCAwLjg1MTU4LCAwLjg1MTU4LCAwLjc3MywgMC43Njg1MiwgMC43MDQ2NiwgMC43MDQ2NiwgMC43MDQ2NiwgMC43MDQ2NiwgMC44Mzg2NCwgMC44Mzg2NCwgMC44Mzg2NCwgMC44Mzg2NCwgMC45MDU2MSwgMC44NzUxNCwgMC44NTg4LCAwLjg1ODgsIDAuODU4OCwgMC44NTg4LCAwLjg1ODgsIDEuMDIwNTgsIDAuODU3NTEsIDAuODU5OTEsIDAuODU5OTEsIDAuODU5OTEsIDAuODU5OTEsIDAuNzc1MTIsIDAuNzYwMTMsIDAuODgwNzUsIDAuOTM4NTksIDAuOTM4NTksIDAuOTM4NTksIDAuOTM4NTksIDAuOTM4NTksIDAuOTM4NTksIDAuODA3NSwgMC44NDYsIDAuODE0NTMsIDAuODE0NTMsIDAuODE0NTMsIDAuODE0NTMsIDAuODI0MjQsIDAuODI0MjQsIDAuODI0MjQsIDAuODI0MjQsIDAuOTI3OCwgMC45NjAxNywgMC45Mzg1OSwgMC45Mzg1OSwgMC45Mzg1OSwgMC45Mzg1OSwgMC45Mzg1OSwgMS4wODU5NSwgMC44NTYyLCAwLjk0NTc4LCAwLjk0NTc4LCAwLjk0NTc4LCAwLjk0NTc4LCAwLjg4MiwgMC45NDU3OCwgMC44ODIsIDAuODUxNTgsIDAuOTM4NTksIDAuODUxNTgsIDAuOTM4NTksIDAuODUxNTgsIDAuOTM4NTksIDAuNzY4NTIsIDAuODQ2LCAwLjc2ODUyLCAwLjg0NiwgMC43Njg1MiwgMC44NDYsIDAuNzY4NTIsIDAuODQ2LCAwLjg5NTkxLCAwLjg1NDQsIDAuOTA1NjEsIDAuOTQzOTksIDAuNzA0NjYsIDAuODE0NTMsIDAuNzA0NjYsIDAuODE0NTMsIDAuNzA0NjYsIDAuODE0NTMsIDAuNzA0NjYsIDAuODE0NTMsIDAuNzA0NjYsIDAuODE0NTMsIDAuODAwOTQsIDAuOTQyMTksIDAuODAwOTQsIDAuOTQyMTksIDAuODAwOTQsIDAuOTQyMTksIDEsIDEsIDAuODY4MjIsIDAuOTYwMTcsIDAuODY4MjIsIDAuOTYwMTcsIDAuODM4NjQsIDAuODI0MjQsIDAuODM4NjQsIDAuODI0MjQsIDAuODM4NjQsIDAuODI0MjQsIDAuODM4NjQsIDEuMDMwNzUsIDAuODM4NjQsIDAuODI0MjQsIDAuODE0MDIsIDEuMDI3MzgsIDAuNzI4LCAxLjAyMTc1LCAxLCAxLCAwLjkxMiwgMC43OTQ3NSwgMS4wMzA3NSwgMSwgMSwgMC43OTQ3NSwgMC44MzkxMSwgMC43OTQ3NSwgMC42NjI2NiwgMC44MDU1MywgMS4wNjY3NiwgMC44NzUxNCwgMC45NjAxNywgMSwgMSwgMC44NzUxNCwgMC45NjAxNywgMC44Njg2NSwgMC44NzM5NiwgMC45NjAxNywgMC44NTg4LCAwLjkzODU5LCAwLjg1ODgsIDAuOTM4NTksIDAuODU4OCwgMC45Mzg1OSwgMC44NjcsIDAuODQ3NTksIDAuNzI0MjEsIDAuOTU0OTMsIDEsIDEsIDAuNzI0MjEsIDAuOTU0OTMsIDAuNjk4NjYsIDAuNzQ2LCAwLjY5ODY2LCAwLjc0NiwgMSwgMSwgMC42OTg2NiwgMC43NDYsIDEsIDEsIDAuNzc1OTgsIDAuODg0MTcsIDAuNzc1OTgsIDEuMTI2NTgsIDAuODU5OTEsIDAuOTQ1NzgsIDAuODU5OTEsIDAuOTQ1NzgsIDAuODU5OTEsIDAuOTQ1NzgsIDAuODU5OTEsIDAuOTQ1NzgsIDAuODU5OTEsIDAuOTQ1NzgsIDAuODU5OTEsIDAuOTQ1NzgsIDAuODc4MzIsIDAuOTc5LCAwLjc3NTEyLCAwLjg4MiwgMC43NzUxMiwgMC44NTYyLCAwLjgzLCAwLjg1NjIsIDAuODMsIDAuODU2MiwgMC44MywgMSwgMC44ODQ2NSwgMC44NTE1OCwgMC45Mzg1OSwgMC43NzMsIDAuODA3NSwgMC44NTc1MSwgMC44NTYyLCAxLCAxLCAwLjc3NTk4LCAxLjEyNjU4LCAxLjE1MDEyLCAxLjE1MDEyLCAxLjE1MDEyLCAxLjE1MDEyLCAxLjE1MDEyLCAxLjE1MzEzLCAxLjE1MDEyLCAxLjE1MDEyLCAxLjE1MDEyLCAxLjA4MTA2LCAxLjAzOTAxLCAwLjg1MTU4LCAwLjc3MDI1LCAwLjYyMjY0LCAwLjc2NDYsIDAuNjUzNTEsIDAuODYwMjYsIDAuNjk0NjEsIDAuODk5NDcsIDEuMDMwNzUsIDAuODUxNTgsIDAuNzc4MTIsIDAuNzY0NDksIDAuODg4MzYsIDAuNzA0NjYsIDAuODU2MiwgMC44NjgyMiwgMC44NTg4LCAwLjgzODY0LCAwLjc3MjEyLCAwLjg1MzA4LCAwLjkzNjM3LCAwLjg3NTE0LCAwLjgyMzUyLCAwLjg1ODgsIDAuODU3MDEsIDAuNzYwMTMsIDAuODkwNTgsIDAuNzc1OTgsIDAuODE1NiwgMC44MjU2NSwgMC43ODExMiwgMC43Nzg5OSwgMC44OTM4NiwgMC44Mzg2NCwgMC44MTU2LCAwLjk0ODYsIDAuOTIzODgsIDAuOTYxODYsIDEuMDMwNzUsIDAuOTExMjMsIDAuOTQ4NiwgMC45MzI5OCwgMC44NzgsIDAuOTM5NDIsIDAuOTIzODgsIDAuODQ1OTYsIDAuOTYxODYsIDAuOTUxMTksIDEuMDMwNzUsIDAuOTIyLCAwLjg4Nzg3LCAwLjk1ODI5LCAwLjg4LCAwLjkzNTU5LCAwLjkzODU5LCAwLjc4ODE1LCAwLjkzNzU4LCAxLCAwLjg5MjE3LCAxLjAzNzM3LCAwLjkxMTIzLCAwLjkzOTY5LCAwLjc3NDg3LCAwLjg1NzY5LCAwLjg2Nzk5LCAxLjAzMDc1LCAwLjkxMTIzLCAwLjkzODU5LCAwLjkxMTIzLCAwLjg2Nzk5LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjg3ODMyLCAwLjk3OSwgMC44NzgzMiwgMC45NzksIDAuODc4MzIsIDAuOTc5LCAwLjc3NTEyLCAwLjg4MiwgMC45MjE5LCAxLCAwLjg5OTAzLCAxLCAxLCAxLCAwLjg3MzIxLCAwLjg3MzIxLCAwLjg3MzIxLCAxLCAxLjAyNywgMS4wMjcsIDEuMDI3LCAwLjg2ODQ3LCAwLjg2ODQ3LCAwLjc5MTIxLCAxLCAxLjEyNCwgMSwgMSwgMC43MzU3MiwgMC43MzU3MiwgMSwgMSwgMC44NTAzNCwgMSwgMSwgMSwgMSwgMC44ODQ2NSwgMSwgMSwgMSwgMC42NjksIDEsIDEuMzYxNDUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMDQ4MjgsIDEsIDAuNzQ5NDgsIDAuNzUxODcsIDEuMDIwNTgsIDAuOTgzOTEsIDEuMDIxMTksIDEsIDEsIDEuMDYyMzMsIDEuMDg1OTUsIDEuMDg1OTUsIDEsIDEuMDg1OTUsIDEuMDg1OTUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMDUyMzMsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLk15cmlhZFByb0l0YWxpY0ZhY3RvcnMgPSBNeXJpYWRQcm9JdGFsaWNGYWN0b3JzOwpjb25zdCBNeXJpYWRQcm9JdGFsaWNNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMiwKICBsaW5lR2FwOiAwLjIKfTsKZXhwb3J0cy5NeXJpYWRQcm9JdGFsaWNNZXRyaWNzID0gTXlyaWFkUHJvSXRhbGljTWV0cmljczsKY29uc3QgTXlyaWFkUHJvUmVndWxhckZhY3RvcnMgPSBbMS4zNjg5OCwgMSwgMSwgMC43NjMwNSwgMC44Mjc4NCwgMC45NDkzNSwgMC44OTM2NCwgMC45MjI0MSwgMC44OTA3MywgMC45MDcwNiwgMC45ODQ3MiwgMC44NTI4MywgMC44NTI4MywgMS4wNjY0LCAxLjAyMDU4LCAwLjc0NTA1LCAwLjkyMTksIDAuNzQ1MDUsIDEuMjM0NTYsIDAuOTIyNDEsIDAuOTIyNDEsIDAuOTIyNDEsIDAuOTIyNDEsIDAuOTIyNDEsIDAuOTIyNDEsIDAuOTIyNDEsIDAuOTIyNDEsIDAuOTIyNDEsIDAuOTIyNDEsIDAuNzQ1MDUsIDAuNzQ1MDUsIDEuMDIwNTgsIDEuMDIwNTgsIDEuMDIwNTgsIDAuNzMwMDIsIDAuNzI2MDEsIDAuOTE3NTUsIDAuODEyNiwgMC44MDMxNCwgMC45MjIyMiwgMC43Mzc2NCwgMC43OTcyNiwgMC44MzA1MSwgMC45MDI4NCwgMC44NjAyMywgMC43NCwgMC44MTI2LCAwLjg0ODY5LCAwLjk2NTE4LCAwLjkxMTE1LCAwLjg4NTgsIDAuNzk3NjEsIDAuODg1OCwgMC43NDQ5OCwgMC43MzkxNCwgMC44MTM2MywgMC44OTU5MSwgMC44MzY1OSwgMC44OTYzMywgMC44NTYwOCwgMC44MTExLCAwLjkwNTMxLCAxLjAyMjIsIDEuMjI3MzYsIDEuMDIyMiwgMS4yNzAxNCwgMC44OTkwMywgMC45MDA4OCwgMC44NjY2NywgMS4wMjMxLCAwLjg5NiwgMS4wMTQxMSwgMC45MDA4MywgMS4wNTA5OSwgMS4wMDUxMiwgMC45OTc5MywgMS4wNTMyNiwgMS4wOTM3NywgMC45MzgsIDEuMDYyMjYsIDEuMDAxMTksIDAuOTk3OTMsIDAuOTg3MTQsIDEuMDIzMSwgMS4wMTIzMSwgMC45ODE5NiwgMC43OTIsIDEuMTkxMzcsIDAuOTkwNzQsIDAuOTYyLCAxLjAxOTE1LCAwLjkyNiwgMC45NDIsIDAuODU2LCAwLjg1MDM0LCAwLjkyMDA2LCAwLjg1MDM0LCAxLjAyMDU4LCAwLjY5MDY3LCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMDA2LCAwLjkzMzIsIDAuOTAwODgsIDAuOTE4ODIsIDAuOTM0ODQsIDAuNzUzMzksIDEuMDIwNTgsIDAuNTY4NjYsIDAuNTQzMjQsIDAuNzk1MTksIDEuMDg1OTUsIDEsIDEsIDAuOTAwODgsIDEsIDAuOTUzMjUsIDAuNzQ1MDUsIDAuOTAwODgsIDEsIDAuOTcxOTgsIDAuNzUzMzksIDAuOTEwMDksIDAuOTEwMDksIDAuOTEwMDksIDAuNjY0NjYsIDAuOTE3NTUsIDAuOTE3NTUsIDAuOTE3NTUsIDAuOTE3NTUsIDAuOTE3NTUsIDAuOTE3NTUsIDAuNzg4LCAwLjgwMzE0LCAwLjczNzY0LCAwLjczNzY0LCAwLjczNzY0LCAwLjczNzY0LCAwLjg2MDIzLCAwLjg2MDIzLCAwLjg2MDIzLCAwLjg2MDIzLCAwLjkyOTE1LCAwLjkxMTE1LCAwLjg4NTgsIDAuODg1OCwgMC44ODU4LCAwLjg4NTgsIDAuODg1OCwgMS4wMjA1OCwgMC44ODU4LCAwLjg5NTkxLCAwLjg5NTkxLCAwLjg5NTkxLCAwLjg5NTkxLCAwLjgxMTEsIDAuNzk2MTEsIDAuODk3MTMsIDAuODY2NjcsIDAuODY2NjcsIDAuODY2NjcsIDAuODY2NjcsIDAuODY2NjcsIDAuODY2NjcsIDAuODY5MzYsIDAuODk2LCAwLjkwMDgzLCAwLjkwMDgzLCAwLjkwMDgzLCAwLjkwMDgzLCAwLjg0MjI0LCAwLjg0MjI0LCAwLjg0MjI0LCAwLjg0MjI0LCAwLjk3Mjc2LCAwLjk5NzkzLCAwLjk4NzE0LCAwLjk4NzE0LCAwLjk4NzE0LCAwLjk4NzE0LCAwLjk4NzE0LCAxLjA4NTk1LCAwLjg5ODc2LCAwLjk5MDc0LCAwLjk5MDc0LCAwLjk5MDc0LCAwLjk5MDc0LCAwLjk0MiwgMS4wMjMxLCAwLjk0MiwgMC45MTc1NSwgMC44NjY2NywgMC45MTc1NSwgMC44NjY2NywgMC45MTc1NSwgMC44NjY2NywgMC44MDMxNCwgMC44OTYsIDAuODAzMTQsIDAuODk2LCAwLjgwMzE0LCAwLjg5NiwgMC44MDMxNCwgMC44OTYsIDAuOTIyMjIsIDAuOTMzNzIsIDAuOTI5MTUsIDEuMDE0MTEsIDAuNzM3NjQsIDAuOTAwODMsIDAuNzM3NjQsIDAuOTAwODMsIDAuNzM3NjQsIDAuOTAwODMsIDAuNzM3NjQsIDAuOTAwODMsIDAuNzM3NjQsIDAuOTAwODMsIDAuODMwNTEsIDEuMDA1MTIsIDAuODMwNTEsIDEuMDA1MTIsIDAuODMwNTEsIDEuMDA1MTIsIDEsIDEsIDAuOTAyODQsIDAuOTk3OTMsIDAuOTA5NzYsIDAuOTk3OTMsIDAuODYwMjMsIDAuODQyMjQsIDAuODYwMjMsIDAuODQyMjQsIDAuODYwMjMsIDAuODQyMjQsIDAuODYwMjMsIDEuMDUzMjYsIDAuODYwMjMsIDAuODQyMjQsIDAuODI4NzMsIDEuMDc0NjksIDAuNzQsIDEuMDkzNzcsIDEsIDEsIDAuOTM4LCAwLjg0ODY5LCAxLjA2MjI2LCAxLCAxLCAwLjg0ODY5LCAwLjgzNzA0LCAwLjg0ODY5LCAwLjgxNDQxLCAwLjg1NTg4LCAxLjA4OTI3LCAwLjkxMTE1LCAwLjk5NzkzLCAxLCAxLCAwLjkxMTE1LCAwLjk5NzkzLCAwLjkxODg3LCAwLjkwOTkxLCAwLjk5NzkzLCAwLjg4NTgsIDAuOTg3MTQsIDAuODg1OCwgMC45ODcxNCwgMC44ODU4LCAwLjk4NzE0LCAwLjg5NCwgMC45MTQzNCwgMC43NDQ5OCwgMC45ODE5NiwgMSwgMSwgMC43NDQ5OCwgMC45ODE5NiwgMC43MzkxNCwgMC43OTIsIDAuNzM5MTQsIDAuNzkyLCAxLCAxLCAwLjczOTE0LCAwLjc5MiwgMSwgMSwgMC44MTM2MywgMC45MDQsIDAuODEzNjMsIDEuMTkxMzcsIDAuODk1OTEsIDAuOTkwNzQsIDAuODk1OTEsIDAuOTkwNzQsIDAuODk1OTEsIDAuOTkwNzQsIDAuODk1OTEsIDAuOTkwNzQsIDAuODk1OTEsIDAuOTkwNzQsIDAuODk1OTEsIDAuOTkwNzQsIDAuODk2MzMsIDEuMDE5MTUsIDAuODExMSwgMC45NDIsIDAuODExMSwgMC45MDUzMSwgMC44NTYsIDAuOTA1MzEsIDAuODU2LCAwLjkwNTMxLCAwLjg1NiwgMSwgMC45MjI0MSwgMC45MTc1NSwgMC44NjY2NywgMC43ODgsIDAuODY5MzYsIDAuODg1OCwgMC44OTg3NiwgMSwgMSwgMC44MTM2MywgMS4xOTEzNywgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDA4OCwgMC45MDM4OCwgMS4wMzkwMSwgMC45MjEzOCwgMC43ODEwNSwgMC43MTU0LCAwLjg2MTY5LCAwLjgwNTEzLCAwLjk0MDA3LCAwLjgyNTI4LCAwLjk4NjEyLCAxLjA2MjI2LCAwLjkxNzU1LCAwLjgxMjYsIDAuODE4ODQsIDAuOTI4MTksIDAuNzM3NjQsIDAuOTA1MzEsIDAuOTAyODQsIDAuODg1OCwgMC44NjAyMywgMC44MTI2LCAwLjkxMTcyLCAwLjk2NTE4LCAwLjkxMTE1LCAwLjgzMDg5LCAwLjg4NTgsIDAuODc3OTEsIDAuNzk3NjEsIDAuODkyOTcsIDAuODEzNjMsIDAuODgxNTcsIDAuODk5OTIsIDAuODU2MDgsIDAuODE5OTIsIDAuOTQzMDcsIDAuODYwMjMsIDAuODgxNTcsIDAuOTUzMDgsIDAuOTg2OTksIDAuOTk3OTMsIDEuMDYyMjYsIDAuOTU4MTcsIDAuOTUzMDgsIDAuOTczNTgsIDAuOTI4LCAwLjk4MDg4LCAwLjk4Njk5LCAwLjkyNzYxLCAwLjk5NzkzLCAwLjk2MDE3LCAxLjA2MjI2LCAwLjk4NiwgMC45NDQsIDAuOTU5NzgsIDAuOTM4LCAwLjk2NzA1LCAwLjk4NzE0LCAwLjgwNDQyLCAwLjk4OTcyLCAxLCAwLjg5NzYyLCAxLjA0NTUyLCAwLjk1ODE3LCAwLjk5MDA3LCAwLjg3MDY0LCAwLjkxODc5LCAwLjg4ODg4LCAxLjA2MjI2LCAwLjk1ODE3LCAwLjk4NzE0LCAwLjk1ODE3LCAwLjg4ODg4LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjg5NjMzLCAxLjAxOTE1LCAwLjg5NjMzLCAxLjAxOTE1LCAwLjg5NjMzLCAxLjAxOTE1LCAwLjgxMTEsIDAuOTQyLCAwLjkyMTksIDEsIDAuODk5MDMsIDEsIDEsIDEsIDAuOTMxNzMsIDAuOTMxNzMsIDAuOTMxNzMsIDEsIDEuMDYzMDQsIDEuMDYzMDQsIDEuMDY5MDQsIDAuODk5MDMsIDAuODk5MDMsIDAuODA1NDksIDEsIDEuMTU2LCAxLCAxLCAwLjc2NTc1LCAwLjc2NTc1LCAxLCAxLCAwLjcyNDU4LCAxLCAxLCAxLCAxLCAwLjkyMjQxLCAxLCAxLCAxLCAwLjYxOSwgMSwgMS4zNjE0NSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMS4wNzI1NywgMSwgMC43NDcwNSwgMC43MTExOSwgMS4wMjA1OCwgMS4wMjQsIDEuMDIxMTksIDEsIDEsIDEuMTUzNiwgMS4wODU5NSwgMS4wODU5NSwgMSwgMS4wODU5NSwgMS4wODU5NSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMS4wNTYzOCwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07CmV4cG9ydHMuTXlyaWFkUHJvUmVndWxhckZhY3RvcnMgPSBNeXJpYWRQcm9SZWd1bGFyRmFjdG9yczsKY29uc3QgTXlyaWFkUHJvUmVndWxhck1ldHJpY3MgPSB7CiAgbGluZUhlaWdodDogMS4yLAogIGxpbmVHYXA6IDAuMgp9OwpleHBvcnRzLk15cmlhZFByb1JlZ3VsYXJNZXRyaWNzID0gTXlyaWFkUHJvUmVndWxhck1ldHJpY3M7CgovKioqLyB9KSwKLyogMTgxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5TZWdvZXVpUmVndWxhck1ldHJpY3MgPSBleHBvcnRzLlNlZ29ldWlSZWd1bGFyRmFjdG9ycyA9IGV4cG9ydHMuU2Vnb2V1aUl0YWxpY01ldHJpY3MgPSBleHBvcnRzLlNlZ29ldWlJdGFsaWNGYWN0b3JzID0gZXhwb3J0cy5TZWdvZXVpQm9sZE1ldHJpY3MgPSBleHBvcnRzLlNlZ29ldWlCb2xkSXRhbGljTWV0cmljcyA9IGV4cG9ydHMuU2Vnb2V1aUJvbGRJdGFsaWNGYWN0b3JzID0gZXhwb3J0cy5TZWdvZXVpQm9sZEZhY3RvcnMgPSB2b2lkIDA7CmNvbnN0IFNlZ29ldWlCb2xkRmFjdG9ycyA9IFsxLjc2NzM4LCAxLCAxLCAwLjk5Mjk3LCAwLjk4MjQsIDEuMDQwMTYsIDEuMDY0OTcsIDEuMDM0MjQsIDAuOTc1MjksIDEuMTc2NDcsIDEuMjMyMDMsIDEuMTA4NSwgMS4xMDg1LCAxLjE2OTM5LCAxLjIxMDcsIDAuOTc1NCwgMS4yMTQwOCwgMC45NzU0LCAxLjU5NTc4LCAxLjAzNDI0LCAxLjAzNDI0LCAxLjAzNDI0LCAxLjAzNDI0LCAxLjAzNDI0LCAxLjAzNDI0LCAxLjAzNDI0LCAxLjAzNDI0LCAxLjAzNDI0LCAxLjAzNDI0LCAwLjgxMzc4LCAwLjgxMzc4LCAxLjIxMDcsIDEuMjEwNywgMS4yMTA3LCAwLjcxNzAzLCAwLjk3ODQ3LCAwLjk3MzYzLCAwLjg4Nzc2LCAwLjg2NDEsIDEuMDIwOTYsIDAuNzk3OTUsIDAuODUxMzIsIDAuOTE0LCAxLjA2MDg1LCAxLjE0MDYsIDAuODAwNywgMC44OTg1OCwgMC44MzY5MywgMS4xNDg4OSwgMS4wOTM5OCwgMC45NzQ4OSwgMC45MjA5NCwgMC45NzQ4OSwgMC45MDM5OSwgMC44NDA0MSwgMC45NTkyMywgMS4wMDEzNSwgMSwgMS4wNjQ2NywgMC45ODI0MywgMC45MDk5NiwgMC45OTM2MSwgMS4xMDg1LCAxLjU2OTQyLCAxLjEwODUsIDEuMjEwNywgMC43NDYyNywgMC45NDI4MiwgMC45Njc1MiwgMS4wMTUxOSwgMC44NjMwNCwgMS4wMTM1OSwgMC45NzI3OCwgMS4xNTEwMywgMS4wMTM1OSwgMC45ODU2MSwgMS4wMjI4NSwgMS4wMjI4NSwgMS4wMDUyNywgMS4wMjI4NSwgMS4wMzAyLCAwLjk5MDQxLCAxLjAwMDgsIDEuMDE1MTksIDEuMDEzNTksIDEuMDIyNTgsIDAuNzkxMDQsIDEuMTY4NjIsIDAuOTkwNDEsIDAuOTc0NTQsIDEuMDI1MTEsIDAuOTkyOTgsIDAuOTY3NTIsIDAuOTU4MDEsIDAuOTQ4NTYsIDEuMTY1NzksIDAuOTQ4NTYsIDEuMjEwNywgMC45ODI0LCAxLjAzNDI0LCAxLjAzNDI0LCAxLCAxLjAzNDI0LCAxLjE2NTc5LCAwLjg3MjcsIDEuMzg3MSwgMS4xODYyMiwgMS4xMDgxOCwgMS4wNDQ3OCwgMS4yMTA3LCAxLjE4NjIyLCAwLjc1MTU1LCAwLjk0OTk0LCAxLjI4ODI2LCAxLjIxNDA4LCAxLjIxNDA4LCAwLjkxMDU2LCAxLCAwLjkxNTcyLCAwLjk3NTQsIDAuNjQ2NjMsIDEuMTgzMjgsIDEuMjQ4NjYsIDEuMDQ0NzgsIDEuMTQxNjksIDEuMTU3NDksIDEuMTczODksIDAuNzE3MDMsIDAuOTczNjMsIDAuOTczNjMsIDAuOTczNjMsIDAuOTczNjMsIDAuOTczNjMsIDAuOTczNjMsIDAuOTM1MDYsIDAuODY0MSwgMC43OTc5NSwgMC43OTc5NSwgMC43OTc5NSwgMC43OTc5NSwgMS4xNDA2LCAxLjE0MDYsIDEuMTQwNiwgMS4xNDA2LCAxLjAyMDk2LCAxLjA5Mzk4LCAwLjk3NDI2LCAwLjk3NDI2LCAwLjk3NDI2LCAwLjk3NDI2LCAwLjk3NDI2LCAxLjIxMDcsIDAuOTc0ODksIDEuMDAxMzUsIDEuMDAxMzUsIDEuMDAxMzUsIDEuMDAxMzUsIDAuOTA5OTYsIDAuOTIwOTQsIDEuMDI3OTgsIDAuOTY3NTIsIDAuOTY3NTIsIDAuOTY3NTIsIDAuOTY3NTIsIDAuOTY3NTIsIDAuOTY3NTIsIDAuOTMxMzYsIDAuODYzMDQsIDAuOTcyNzgsIDAuOTcyNzgsIDAuOTcyNzgsIDAuOTcyNzgsIDEuMDIyODUsIDEuMDIyODUsIDEuMDIyODUsIDEuMDIyODUsIDAuOTcxMjIsIDAuOTkwNDEsIDEsIDEsIDEsIDEsIDEsIDEuMjg4MjYsIDEuMDAwOCwgMC45OTA0MSwgMC45OTA0MSwgMC45OTA0MSwgMC45OTA0MSwgMC45Njc1MiwgMS4wMTUxOSwgMC45Njc1MiwgMC45NzM2MywgMC45Njc1MiwgMC45NzM2MywgMC45Njc1MiwgMC45NzM2MywgMC45Njc1MiwgMC44NjQxLCAwLjg2MzA0LCAwLjg2NDEsIDAuODYzMDQsIDAuODY0MSwgMC44NjMwNCwgMC44NjQxLCAwLjg2MzA0LCAxLjAyMDk2LCAxLjAzMDU3LCAxLjAyMDk2LCAxLjAzNTE3LCAwLjc5Nzk1LCAwLjk3Mjc4LCAwLjc5Nzk1LCAwLjk3Mjc4LCAwLjc5Nzk1LCAwLjk3Mjc4LCAwLjc5Nzk1LCAwLjk3Mjc4LCAwLjc5Nzk1LCAwLjk3Mjc4LCAwLjkxNCwgMS4wMTM1OSwgMC45MTQsIDEuMDEzNTksIDAuOTE0LCAxLjAxMzU5LCAxLCAxLCAxLjA2MDg1LCAwLjk4NTYxLCAxLjA2MDg1LCAxLjAwODc5LCAxLjE0MDYsIDEuMDIyODUsIDEuMTQwNiwgMS4wMjI4NSwgMS4xNDA2LCAxLjAyMjg1LCAxLjE0MDYsIDEuMDIyODUsIDEuMTQwNiwgMS4wMjI4NSwgMC45NzEzOCwgMS4wODY5MiwgMC44MDA3LCAxLjAyMjg1LCAxLCAxLCAxLjAwNTI3LCAwLjgzNjkzLCAxLjAyMjg1LCAxLCAxLCAwLjgzNjkzLCAwLjk0NTUsIDAuODM2OTMsIDAuOTA0MTgsIDAuODM2OTMsIDEuMTMwMDUsIDEuMDkzOTgsIDAuOTkwNDEsIDEsIDEsIDEuMDkzOTgsIDAuOTkwNDEsIDAuOTY2OTIsIDEuMDkyNTEsIDAuOTkwNDEsIDAuOTc0ODksIDEuMDAwOCwgMC45NzQ4OSwgMS4wMDA4LCAwLjk3NDg5LCAxLjAwMDgsIDAuOTM5OTQsIDAuOTc5MzEsIDAuOTAzOTksIDEuMDIyNTgsIDEsIDEsIDAuOTAzOTksIDEuMDIyNTgsIDAuODQwNDEsIDAuNzkxMDQsIDAuODQwNDEsIDAuNzkxMDQsIDAuODQwNDEsIDAuNzkxMDQsIDAuODQwNDEsIDAuNzkxMDQsIDEsIDEsIDAuOTU5MjMsIDEuMDcwMzQsIDAuOTU5MjMsIDEuMTY4NjIsIDEuMDAxMzUsIDAuOTkwNDEsIDEuMDAxMzUsIDAuOTkwNDEsIDEuMDAxMzUsIDAuOTkwNDEsIDEuMDAxMzUsIDAuOTkwNDEsIDEuMDAxMzUsIDAuOTkwNDEsIDEuMDAxMzUsIDAuOTkwNDEsIDEuMDY0NjcsIDEuMDI1MTEsIDAuOTA5OTYsIDAuOTY3NTIsIDAuOTA5OTYsIDAuOTkzNjEsIDAuOTU4MDEsIDAuOTkzNjEsIDAuOTU4MDEsIDAuOTkzNjEsIDAuOTU4MDEsIDEuMDc3MzMsIDEuMDM0MjQsIDAuOTczNjMsIDAuOTY3NTIsIDAuOTM1MDYsIDAuOTMxMzYsIDAuOTc0ODksIDEuMDAwOCwgMSwgMSwgMC45NTkyMywgMS4xNjg2MiwgMS4xNTEwMywgMS4xNTEwMywgMS4wMTE3MywgMS4wMzk1OSwgMC43NTk1MywgMC44MTM3OCwgMC43OTkxMiwgMS4xNTEwMywgMS4yMTk5NCwgMC45NTE2MSwgMC44NzgxNSwgMS4wMTE0OSwgMC44MTUyNSwgMC43Njc2LCAwLjk4MTY3LCAxLjAxMTM0LCAxLjAyNTQ2LCAwLjg0MDk3LCAxLjAzMDg5LCAxLjE4MTAyLCAwLjk3MzYzLCAwLjg4Nzc2LCAwLjg1MTM0LCAwLjk3ODI2LCAwLjc5Nzk1LCAwLjk5MzYxLCAxLjA2MDg1LCAwLjk3NDg5LCAxLjE0MDYsIDAuODk4NTgsIDEuMDM4OCwgMS4xNDg4OSwgMS4wOTM5OCwgMC44NjAzOSwgMC45NzQ4OSwgMS4wNTk1LCAwLjkyMDk0LCAwLjk0NzkzLCAwLjk1OTIzLCAwLjkwOTk2LCAwLjk5MzQ2LCAwLjk4MjQzLCAxLjAyMTEyLCAwLjk1NDkzLCAxLjE0MDYsIDAuOTA5OTYsIDEuMDM1NzQsIDEuMDI1OTcsIDEuMDAwOCwgMS4xODEwMiwgMS4wNjYyOCwgMS4wMzU3NCwgMS4wMTkyLCAxLjAxOTMyLCAxLjAwODg2LCAwLjk3NTMxLCAxLjAxMDYsIDEuMDAwOCwgMS4xMzE4OSwgMS4xODEwMiwgMS4wMjI3NywgMC45ODY4MywgMS4wMDE2LCAwLjk5NTYxLCAxLjA3MjM3LCAxLjAwMDgsIDAuOTA0MzQsIDAuOTk5MjEsIDAuOTM4MDMsIDAuODk2NSwgMS4yMzA4NSwgMS4wNjYyOCwgMS4wNDk4MywgMC45NjI2OCwgMS4wNDk5LCAwLjk4NDM5LCAxLjE4MTAyLCAxLjA2NjI4LCAxLjAwMDgsIDEuMDY2MjgsIDAuOTg0MzksIDAuNzk3OTUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMDk0NjYsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTcyNzgsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMDIwNjUsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMDY0NjcsIDEuMDI1MTEsIDEuMDY0NjcsIDEuMDI1MTEsIDEuMDY0NjcsIDEuMDI1MTEsIDAuOTA5OTYsIDAuOTY3NTIsIDEsIDEuMjE0MDgsIDAuODk5MDMsIDEsIDEsIDAuNzUxNTUsIDEuMDQzOTQsIDEuMDQzOTQsIDEuMDQzOTQsIDEuMDQzOTQsIDAuOTg2MzMsIDAuOTg2MzMsIDAuOTg2MzMsIDAuNzMwNDcsIDAuNzMwNDcsIDEuMjA2NDIsIDAuOTEyMTEsIDEuMjU2MzUsIDEuMjIyLCAxLjAyOTU2LCAxLjAzMzcyLCAxLjAzMzcyLCAwLjk2MDM5LCAxLjI0NjMzLCAxLCAxLjEyNDU0LCAwLjkzNTAzLCAxLjAzNDI0LCAxLjE5Njg3LCAxLjAzNDI0LCAxLCAxLCAxLCAwLjc3MSwgMSwgMSwgMS4xNTc0OSwgMS4xNTc0OSwgMS4xNTc0OSwgMS4xMDk0OCwgMC44NjI3OSwgMC45NDQzNCwgMC44NjI3OSwgMC45NDQzNCwgMC44NjE4MiwgMSwgMSwgMS4xNjg5NywgMSwgMC45NjA4NSwgMC45MDEzNywgMS4yMTA3LCAxLjE4NDE2LCAxLjEzOTczLCAwLjY5ODI1LCAwLjk3MTYsIDIuMTAzMzksIDEuMjkwMDQsIDEuMjkwMDQsIDEuMjExNzIsIDEuMjkwMDQsIDEuMjkwMDQsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuNDI2MDMsIDEsIDAuOTk4NjIsIDAuOTk4NjIsIDEsIDAuODcwMjUsIDAuODcwMjUsIDAuODcwMjUsIDAuODcwMjUsIDEuMTg4NzQsIDEuNDI2MDMsIDEsIDEuNDI2MDMsIDEuNDI2MDMsIDAuOTk4NjIsIDEsIDEsIDEsIDEsIDEsIDEuMjg4NiwgMS4wNDMxNSwgMS4xNTI5NiwgMS4zNDE2MywgMSwgMSwgMSwgMS4wOTE5MywgMS4wOTE5MywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07CmV4cG9ydHMuU2Vnb2V1aUJvbGRGYWN0b3JzID0gU2Vnb2V1aUJvbGRGYWN0b3JzOwpjb25zdCBTZWdvZXVpQm9sZE1ldHJpY3MgPSB7CiAgbGluZUhlaWdodDogMS4zMzAwOCwKICBsaW5lR2FwOiAwCn07CmV4cG9ydHMuU2Vnb2V1aUJvbGRNZXRyaWNzID0gU2Vnb2V1aUJvbGRNZXRyaWNzOwpjb25zdCBTZWdvZXVpQm9sZEl0YWxpY0ZhY3RvcnMgPSBbMS43NjczOCwgMSwgMSwgMC45ODk0NiwgMS4wMzk1OSwgMS4wNDAxNiwgMS4wMjgwOSwgMS4wMzYsIDAuOTc2MzksIDEuMTA5NTMsIDEuMjMyMDMsIDEuMTExNDQsIDEuMTExNDQsIDEuMTY5MzksIDEuMjEyMzcsIDAuOTc1NCwgMS4yMTI2MSwgMC45NzU0LCAxLjU5NzU0LCAxLjAzNiwgMS4wMzYsIDEuMDM2LCAxLjAzNiwgMS4wMzYsIDEuMDM2LCAxLjAzNiwgMS4wMzYsIDEuMDM2LCAxLjAzNiwgMC44MTM3OCwgMC44MTM3OCwgMS4yMTIzNywgMS4yMTIzNywgMS4yMTIzNywgMC43MzU0MSwgMC45Nzg0NywgMC45NzM2MywgMC44OTcyMywgMC44Nzg5NywgMS4wNDI2LCAwLjc5NDI5LCAwLjg1MjkyLCAwLjkxMTQ5LCAxLjA1ODE1LCAxLjE0MDYsIDAuNzk2MzEsIDAuOTAxMjgsIDAuODM4NTMsIDEuMDQzOTYsIDEuMTA2MTUsIDAuOTc1NTIsIDAuOTQ0MzYsIDAuOTc1NTIsIDAuODg2NDEsIDAuODA1MjcsIDAuOTYwODMsIDEuMDAxMzUsIDEsIDEuMDY3NzcsIDAuOTgxNywgMC45MTE0MiwgMC45OTM2MSwgMS4xMTE0NCwgMS41NzI5MywgMS4xMTE0NCwgMS4yMTIzNywgMC43NDYyNywgMS4zMTgxOCwgMS4wNjU4NSwgMC45NzA0MiwgMC44MzA1NSwgMC45NzA0MiwgMC45MzUwMywgMS4xMjYxLCAwLjk3MDQyLCAwLjk3OTIyLCAxLjE0MjM2LCAwLjk0NTUyLCAxLjAxMDU0LCAxLjE0MjM2LCAxLjAyNDcxLCAwLjk3OTIyLCAwLjk0MTY1LCAwLjk3MDQyLCAwLjk3MDQyLCAxLjAyNzYsIDAuNzg5MjksIDEuMTI2MSwgMC45NzkyMiwgMC45NTg3NCwgMS4wMjE5NywgMC45ODUwNywgMC45Njc1MiwgMC45NzE2OCwgMC45NTEwNywgMS4xNjU3OSwgMC45NTEwNywgMS4yMTIzNywgMS4wMzk1OSwgMS4wMzYsIDEuMDM2LCAxLCAxLjAzNiwgMS4xNjU3OSwgMC44NzM1NywgMS4zMTgxOCwgMS4xODc1NCwgMS4yNjc4MSwgMS4wNTM1NiwgMS4yMTIzNywgMS4xODYyMiwgMC43OTQ4NywgMC45NDk5NCwgMS4yOTAwNCwgMS4yNDA0NywgMS4yNDA0NywgMS4zMTgxOCwgMSwgMC45MTQ4NCwgMC45NzU0LCAxLjMxODE4LCAxLjEzNDksIDEuMjQ4NjYsIDEuMDUzNTYsIDEuMTM5MzQsIDEuMTU1NzQsIDEuMTczODksIDAuNzM1NDEsIDAuOTczNjMsIDAuOTczNjMsIDAuOTczNjMsIDAuOTczNjMsIDAuOTczNjMsIDAuOTczNjMsIDAuOTQzODUsIDAuODc4OTcsIDAuNzk0MjksIDAuNzk0MjksIDAuNzk0MjksIDAuNzk0MjksIDEuMTQwNiwgMS4xNDA2LCAxLjE0MDYsIDEuMTQwNiwgMS4wNDI2LCAxLjEwNjE1LCAwLjk3NTUyLCAwLjk3NTUyLCAwLjk3NTUyLCAwLjk3NTUyLCAwLjk3NTUyLCAxLjIxMjM3LCAwLjk3NTUyLCAxLjAwMTM1LCAxLjAwMTM1LCAxLjAwMTM1LCAxLjAwMTM1LCAwLjkxMTQyLCAwLjk0NDM2LCAwLjk4NzIxLCAxLjA2NTg1LCAxLjA2NTg1LCAxLjA2NTg1LCAxLjA2NTg1LCAxLjA2NTg1LCAxLjA2NTg1LCAwLjk2NzA1LCAwLjgzMDU1LCAwLjkzNTAzLCAwLjkzNTAzLCAwLjkzNTAzLCAwLjkzNTAzLCAxLjE0MjM2LCAxLjE0MjM2LCAxLjE0MjM2LCAxLjE0MjM2LCAwLjkzMTI1LCAwLjk3OTIyLCAwLjk0MTY1LCAwLjk0MTY1LCAwLjk0MTY1LCAwLjk0MTY1LCAwLjk0MTY1LCAxLjI5MDA0LCAwLjk0MTY1LCAwLjk3OTIyLCAwLjk3OTIyLCAwLjk3OTIyLCAwLjk3OTIyLCAwLjk2NzUyLCAwLjk3MDQyLCAwLjk2NzUyLCAwLjk3MzYzLCAxLjA2NTg1LCAwLjk3MzYzLCAxLjA2NTg1LCAwLjk3MzYzLCAxLjA2NTg1LCAwLjg3ODk3LCAwLjgzMDU1LCAwLjg3ODk3LCAwLjgzMDU1LCAwLjg3ODk3LCAwLjgzMDU1LCAwLjg3ODk3LCAwLjgzMDU1LCAxLjA0MjYsIDEuMDAzMywgMS4wNDI2LCAwLjk3MDQyLCAwLjc5NDI5LCAwLjkzNTAzLCAwLjc5NDI5LCAwLjkzNTAzLCAwLjc5NDI5LCAwLjkzNTAzLCAwLjc5NDI5LCAwLjkzNTAzLCAwLjc5NDI5LCAwLjkzNTAzLCAwLjkxMTQ5LCAwLjk3MDQyLCAwLjkxMTQ5LCAwLjk3MDQyLCAwLjkxMTQ5LCAwLjk3MDQyLCAxLCAxLCAxLjA1ODE1LCAwLjk3OTIyLCAxLjA1ODE1LCAwLjk3OTIyLCAxLjE0MDYsIDEuMTQyMzYsIDEuMTQwNiwgMS4xNDIzNiwgMS4xNDA2LCAxLjE0MjM2LCAxLjE0MDYsIDEuMTQyMzYsIDEuMTQwNiwgMS4xNDIzNiwgMC45NzQ0MSwgMS4wNDMwMiwgMC43OTYzMSwgMS4wMTU4MiwgMSwgMSwgMS4wMTA1NCwgMC44Mzg1MywgMS4xNDIzNiwgMSwgMSwgMC44Mzg1MywgMS4wOTEyNSwgMC44Mzg1MywgMC45MDQxOCwgMC44Mzg1MywgMS4xOTUwOCwgMS4xMDYxNSwgMC45NzkyMiwgMSwgMSwgMS4xMDYxNSwgMC45NzkyMiwgMS4wMTAzNCwgMS4xMDQ2NiwgMC45NzkyMiwgMC45NzU1MiwgMC45NDE2NSwgMC45NzU1MiwgMC45NDE2NSwgMC45NzU1MiwgMC45NDE2NSwgMC45MTYwMiwgMC45MTk4MSwgMC44ODY0MSwgMS4wMjc2LCAxLCAxLCAwLjg4NjQxLCAxLjAyNzYsIDAuODA1MjcsIDAuNzg5MjksIDAuODA1MjcsIDAuNzg5MjksIDAuODA1MjcsIDAuNzg5MjksIDAuODA1MjcsIDAuNzg5MjksIDEsIDEsIDAuOTYwODMsIDEuMDU0MDMsIDAuOTU5MjMsIDEuMTY4NjIsIDEuMDAxMzUsIDAuOTc5MjIsIDEuMDAxMzUsIDAuOTc5MjIsIDEuMDAxMzUsIDAuOTc5MjIsIDEuMDAxMzUsIDAuOTc5MjIsIDEuMDAxMzUsIDAuOTc5MjIsIDEuMDAxMzUsIDAuOTc5MjIsIDEuMDY3NzcsIDEuMDIxOTcsIDAuOTExNDIsIDAuOTY3NTIsIDAuOTExNDIsIDAuOTkzNjEsIDAuOTcxNjgsIDAuOTkzNjEsIDAuOTcxNjgsIDAuOTkzNjEsIDAuOTcxNjgsIDEuMjMxOTksIDEuMDM2LCAwLjk3MzYzLCAxLjA2NTg1LCAwLjk0Mzg1LCAwLjk2NzA1LCAwLjk3NTUyLCAwLjk0MTY1LCAxLCAxLCAwLjk2MDgzLCAxLjEyNjEsIDEuMzE4MTgsIDEuMzE4MTgsIDEuMzE4MTgsIDEuMzE4MTgsIDEuMzE4MTgsIDEuMzE4MTgsIDEuMzE4MTgsIDEuMzE4MTgsIDEuMzE4MTgsIDAuOTUxNjEsIDEuMjcxMjYsIDEuMDA4MTEsIDAuODMyODQsIDAuNzc3MDIsIDAuOTkxMzcsIDAuOTUyNTMsIDEuMDM0NywgMC44NjE0MiwgMS4wNzIwNSwgMS4xNDIzNiwgMC45NzM2MywgMC44OTcyMywgMC44Njg2OSwgMS4wOTgxOCwgMC43OTQyOSwgMC45OTM2MSwgMS4wNTgxNSwgMC45NzU1MiwgMS4xNDA2LCAwLjkwMTI4LCAxLjA2NjYyLCAxLjA0Mzk2LCAxLjEwNjE1LCAwLjg0OTE4LCAwLjk3NTUyLCAxLjA0Njk0LCAwLjk0NDM2LCAwLjk4MDE1LCAwLjk2MDgzLCAwLjkxMTQyLCAxLjAwMzU2LCAwLjk4MTcsIDEuMDE5NDUsIDAuOTg5OTksIDEuMTQwNiwgMC45MTE0MiwgMS4wNDk2MSwgMC45ODk4LCAxLjAwNjM5LCAxLjE0MjM2LCAxLjA3NTE0LCAxLjA0OTYxLCAwLjk5NjA3LCAxLjAyODk3LCAxLjAwOCwgMC45ODk4LCAwLjk1MTM0LCAxLjAwNjM5LCAxLjExMTIxLCAxLjE0MjM2LCAxLjAwNTE4LCAwLjk3OTgxLCAxLjAyMTg2LCAxLCAxLjA4NTc4LCAwLjk0MTY1LCAwLjk5MzE0LCAwLjk4Mzg3LCAwLjkzMDI4LCAwLjkzMzc3LCAxLjM1MTI1LCAxLjA3NTE0LCAxLjEwNjg3LCAwLjkzNDkxLCAxLjA0MjMyLCAxLjAwMzUxLCAxLjE0MjM2LCAxLjA3NTE0LCAwLjk0MTY1LCAxLjA3NTE0LCAxLjAwMzUxLCAwLjc5NDI5LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjA5MDk3LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjkzNTAzLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk2NjA5LCAxLCAxLCAxLCAxLCAxLCAxLCAxLjA2Nzc3LCAxLjAyMTk3LCAxLjA2Nzc3LCAxLjAyMTk3LCAxLjA2Nzc3LCAxLjAyMTk3LCAwLjkxMTQyLCAwLjk2NzUyLCAxLCAxLjIxMjYxLCAwLjg5OTAzLCAxLCAxLCAwLjc1MTU1LCAxLjA0NzQ1LCAxLjA0NzQ1LCAxLjA0NzQ1LCAxLjA0Mzk0LCAwLjk4NjMzLCAwLjk4NjMzLCAwLjk4NjMzLCAwLjcyOTU5LCAwLjcyOTU5LCAxLjIwNTAyLCAwLjkxNDA2LCAxLjI2NTE0LCAxLjIyMiwgMS4wMjk1NiwgMS4wMzM3MiwgMS4wMzM3MiwgMC45NjAzOSwgMS4yNDYzMywgMSwgMS4wOTEyNSwgMC45MzMyNywgMS4wMzMzNiwgMS4xNjU0MSwgMS4wMzYsIDEsIDEsIDEsIDAuNzcxLCAxLCAxLCAxLjE1NTc0LCAxLjE1NTc0LCAxLjE1NTc0LCAxLjE1NTc0LCAwLjg2MzY0LCAwLjk0NDM0LCAwLjg2Mjc5LCAwLjk0NDM0LCAwLjg2MjI0LCAxLCAxLCAxLjE2Nzk4LCAxLCAwLjk2MDg1LCAwLjkwMDY4LCAxLjIxMjM3LCAxLjE4NDE2LCAxLjEzOTA0LCAwLjY5ODI1LCAwLjk3MTYsIDIuMTAzMzksIDEuMjkwMDQsIDEuMjkwMDQsIDEuMjEzMzksIDEuMjkwMDQsIDEuMjkwMDQsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuNDI2MDMsIDEsIDAuOTk4NjIsIDAuOTk4NjIsIDEsIDAuODcwMjUsIDAuODcwMjUsIDAuODcwMjUsIDAuODcwMjUsIDEuMTg3NzUsIDEuNDI2MDMsIDEsIDEuNDI2MDMsIDEuNDI2MDMsIDAuOTk4NjIsIDEsIDEsIDEsIDEsIDEsIDEuMjg4NiwgMS4wNDMxNSwgMS4xNTI5NiwgMS4zNDE2MywgMSwgMSwgMSwgMS4xMzI2OSwgMS4xMzI2OSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07CmV4cG9ydHMuU2Vnb2V1aUJvbGRJdGFsaWNGYWN0b3JzID0gU2Vnb2V1aUJvbGRJdGFsaWNGYWN0b3JzOwpjb25zdCBTZWdvZXVpQm9sZEl0YWxpY01ldHJpY3MgPSB7CiAgbGluZUhlaWdodDogMS4zMzAwOCwKICBsaW5lR2FwOiAwCn07CmV4cG9ydHMuU2Vnb2V1aUJvbGRJdGFsaWNNZXRyaWNzID0gU2Vnb2V1aUJvbGRJdGFsaWNNZXRyaWNzOwpjb25zdCBTZWdvZXVpSXRhbGljRmFjdG9ycyA9IFsxLjc2NzM4LCAxLCAxLCAwLjk4OTQ2LCAxLjE0NzYzLCAxLjA1MzY1LCAxLjA2MjM0LCAwLjk2OTI3LCAwLjkyNTg2LCAxLjE1MzczLCAxLjE4NDE0LCAwLjkxMzQ5LCAwLjkxMzQ5LCAxLjA3NDAzLCAxLjE3MzA4LCAwLjc4MzgzLCAxLjIwMDg4LCAwLjc4MzgzLCAxLjQyNTMxLCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjc4MzgzLCAwLjc4MzgzLCAxLjE3MzA4LCAxLjE3MzA4LCAxLjE3MzA4LCAwLjc3MzQ5LCAwLjk0NTY1LCAwLjk0NzI5LCAwLjg1OTQ0LCAwLjg4NTA2LCAwLjk4NTgsIDAuNzQ4MTcsIDAuODAwMTYsIDAuODg0NDksIDAuOTgwMzksIDAuOTU3ODIsIDAuNjkyMzgsIDAuODk4OTgsIDAuODMyMzEsIDAuOTgxODMsIDEuMDM5ODksIDAuOTY5MjQsIDAuODYyMzcsIDAuOTY5MjQsIDAuODA1OTUsIDAuNzQ1MjQsIDAuODYwOTEsIDAuOTU0MDIsIDAuOTQxNDMsIDAuOTg0NDgsIDAuODg1OCwgMC44MzA4OSwgMC45MzI4NSwgMS4wOTQ5LCAxLjM5MDE2LCAxLjA5NDksIDEuNDU5OTQsIDAuNzQ2MjcsIDEuMDQ4MzksIDAuOTc0NTQsIDAuOTc0NTQsIDAuODcyMDcsIDAuOTc0NTQsIDAuODc1MzMsIDEuMDYxNTEsIDAuOTc0NTQsIDEuMDAxNzYsIDEuMTY0ODQsIDEuMDgxMzIsIDAuOTgwNDcsIDEuMTY0ODQsIDEuMDI5ODksIDEuMDEwNTQsIDAuOTYyMjUsIDAuOTc0NTQsIDAuOTc0NTQsIDEuMDY1OTgsIDAuNzkwMDQsIDEuMTYzNDQsIDEuMDAzNTEsIDAuOTQ2MjksIDAuOTk3MywgMC45MTAxNiwgMC45Njc3NywgMC45MDQzLCAwLjkxMDgyLCAwLjkyNDgxLCAwLjkxMDgyLCAxLjE3MzA4LCAwLjk1NzQ4LCAwLjk2OTI3LCAwLjk2OTI3LCAxLCAwLjk2OTI3LCAwLjkyNDgxLCAwLjgwNTk3LCAxLjA0ODM5LCAxLjIzMzkzLCAxLjE3ODEsIDAuOTI0NSwgMS4xNzMwOCwgMS4yMDgwOCwgMC42MzIxOCwgMC45NDI2MSwgMS4yNDgyMiwgMS4wOTk3MSwgMS4wOTk3MSwgMS4wNDgzOSwgMSwgMC44NTI3MywgMC43ODAzMiwgMS4wNDgzOSwgMS4wOTk3MSwgMS4yMjMyNiwgMC45MjQ1LCAxLjA5ODM2LCAxLjEzNTI1LCAxLjE1MjIyLCAwLjcwNDI0LCAwLjk0NzI5LCAwLjk0NzI5LCAwLjk0NzI5LCAwLjk0NzI5LCAwLjk0NzI5LCAwLjk0NzI5LCAwLjg1NDk4LCAwLjg4NTA2LCAwLjc0ODE3LCAwLjc0ODE3LCAwLjc0ODE3LCAwLjc0ODE3LCAwLjk1NzgyLCAwLjk1NzgyLCAwLjk1NzgyLCAwLjk1NzgyLCAwLjk4NTgsIDEuMDM5ODksIDAuOTY5MjQsIDAuOTY5MjQsIDAuOTY5MjQsIDAuOTY5MjQsIDAuOTY5MjQsIDEuMTczMDgsIDAuOTY5MjQsIDAuOTU0MDIsIDAuOTU0MDIsIDAuOTU0MDIsIDAuOTU0MDIsIDAuODMwODksIDAuODYyMzcsIDAuODg0MDksIDAuOTc0NTQsIDAuOTc0NTQsIDAuOTc0NTQsIDAuOTc0NTQsIDAuOTc0NTQsIDAuOTc0NTQsIDAuOTI5MTYsIDAuODcyMDcsIDAuODc1MzMsIDAuODc1MzMsIDAuODc1MzMsIDAuODc1MzMsIDAuOTMxNDYsIDAuOTMxNDYsIDAuOTMxNDYsIDAuOTMxNDYsIDAuOTM4NTQsIDEuMDEwNTQsIDAuOTYyMjUsIDAuOTYyMjUsIDAuOTYyMjUsIDAuOTYyMjUsIDAuOTYyMjUsIDEuMjQ4MjIsIDAuODc2MSwgMS4wMDM1MSwgMS4wMDM1MSwgMS4wMDM1MSwgMS4wMDM1MSwgMC45Njc3NywgMC45NzQ1NCwgMC45Njc3NywgMC45NDcyOSwgMC45NzQ1NCwgMC45NDcyOSwgMC45NzQ1NCwgMC45NDcyOSwgMC45NzQ1NCwgMC44ODUwNiwgMC44NzIwNywgMC44ODUwNiwgMC44NzIwNywgMC44ODUwNiwgMC44NzIwNywgMC44ODUwNiwgMC44NzIwNywgMC45ODU4LCAwLjk1MzkxLCAwLjk4NTgsIDAuOTc0NTQsIDAuNzQ4MTcsIDAuODc1MzMsIDAuNzQ4MTcsIDAuODc1MzMsIDAuNzQ4MTcsIDAuODc1MzMsIDAuNzQ4MTcsIDAuODc1MzMsIDAuNzQ4MTcsIDAuODc1MzMsIDAuODg0NDksIDAuOTc0NTQsIDAuODg0NDksIDAuOTc0NTQsIDAuODg0NDksIDAuOTc0NTQsIDEsIDEsIDAuOTgwMzksIDEuMDAxNzYsIDAuOTgwMzksIDEuMDAxNzYsIDAuOTU3ODIsIDAuOTMxNDYsIDAuOTU3ODIsIDAuOTMxNDYsIDAuOTU3ODIsIDAuOTMxNDYsIDAuOTU3ODIsIDEuMTY0ODQsIDAuOTU3ODIsIDAuOTMxNDYsIDAuODQ0MjEsIDEuMTI3NjEsIDAuNjkyMzgsIDEuMDgxMzIsIDEsIDEsIDAuOTgwNDcsIDAuODMyMzEsIDEuMTY0ODQsIDEsIDEsIDAuODQ3MjMsIDEuMDQ4NjEsIDAuODQ3MjMsIDAuNzg3NTUsIDAuODMyMzEsIDEuMjM3MzYsIDEuMDM5ODksIDEuMDEwNTQsIDEsIDEsIDEuMDM5ODksIDEuMDEwNTQsIDAuOTg1NywgMS4wMzg0OSwgMS4wMTA1NCwgMC45NjkyNCwgMC45NjIyNSwgMC45NjkyNCwgMC45NjIyNSwgMC45NjkyNCwgMC45NjIyNSwgMC45MjM4MywgMC45MDE3MSwgMC44MDU5NSwgMS4wNjU5OCwgMSwgMSwgMC44MDU5NSwgMS4wNjU5OCwgMC43NDUyNCwgMC43OTAwNCwgMC43NDUyNCwgMC43OTAwNCwgMC43NDUyNCwgMC43OTAwNCwgMC43NDUyNCwgMC43OTAwNCwgMSwgMSwgMC44NjA5MSwgMS4wMjc1OSwgMC44NTc3MSwgMS4xNjM0NCwgMC45NTQwMiwgMS4wMDM1MSwgMC45NTQwMiwgMS4wMDM1MSwgMC45NTQwMiwgMS4wMDM1MSwgMC45NTQwMiwgMS4wMDM1MSwgMC45NTQwMiwgMS4wMDM1MSwgMC45NTQwMiwgMS4wMDM1MSwgMC45ODQ0OCwgMC45OTczLCAwLjgzMDg5LCAwLjk2Nzc3LCAwLjgzMDg5LCAwLjkzMjg1LCAwLjkwNDMsIDAuOTMyODUsIDAuOTA0MywgMC45MzI4NSwgMC45MDQzLCAxLjMxODY4LCAwLjk2OTI3LCAwLjk0NzI5LCAwLjk3NDU0LCAwLjg1NDk4LCAwLjkyOTE2LCAwLjk2OTI0LCAwLjg3NjEsIDEsIDEsIDAuODYwOTEsIDEuMTYzNDQsIDEuMDQ4MzksIDEuMDQ4MzksIDEuMDQ4MzksIDEuMDQ4MzksIDEuMDQ4MzksIDEuMDQ4MzksIDEuMDQ4MzksIDEuMDQ4MzksIDEuMDQ4MzksIDAuODE5NjUsIDAuODE5NjUsIDAuOTQ3MjksIDAuNzgwMzIsIDAuNzEwMjIsIDAuOTA4ODMsIDAuODQxNzEsIDAuOTk4NzcsIDAuNzc1OTYsIDEuMDU3MzQsIDEuMiwgMC45NDcyOSwgMC44NTk0NCwgMC44Mjc5MSwgMC45NjA3LCAwLjc0ODE3LCAwLjkzMjg1LCAwLjk4MDM5LCAwLjk2OTI0LCAwLjk1NzgyLCAwLjg5ODk4LCAwLjk4MzE2LCAwLjk4MTgzLCAxLjAzOTg5LCAwLjc4NjE0LCAwLjk2OTI0LCAwLjk3NjQyLCAwLjg2MjM3LCAwLjg2MDc1LCAwLjg2MDkxLCAwLjgzMDg5LCAwLjkwMDgyLCAwLjg4NTgsIDAuOTcyOTYsIDEuMDEyODQsIDAuOTU3ODIsIDAuODMwODksIDEuMDk3NiwgMS4wNCwgMS4wMzM0MiwgMS4yLCAxLjA2NzUsIDEuMDk3NiwgMC45ODIwNSwgMS4wMzgwOSwgMS4wNTA5NywgMS4wNCwgMC45NTM2NCwgMS4wMzM0MiwgMS4wNTQwMSwgMS4yLCAxLjAyMTQ4LCAxLjAxMTksIDEuMDQ3MjQsIDEuMDEyNywgMS4wMjczMiwgMC45NjIyNSwgMC44OTY1LCAwLjk3NzgzLCAwLjkzNTc0LCAwLjk0ODE4LCAxLjMwNjc5LCAxLjA2NzUsIDEuMTE4MjYsIDAuOTk4MjEsIDEuMDU1NywgMS4wMzI2LCAxLjIsIDEuMDY3NSwgMC45NjIyNSwgMS4wNjc1LCAxLjAzMjYsIDAuNzQ4MTcsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMDM3NTQsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuODc1MzMsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTg3MDUsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTg0NDgsIDAuOTk3MywgMC45ODQ0OCwgMC45OTczLCAwLjk4NDQ4LCAwLjk5NzMsIDAuODMwODksIDAuOTY3NzcsIDEsIDEuMjAwODgsIDAuODk5MDMsIDEsIDEsIDAuNzUxNTUsIDAuOTQ5NDUsIDAuOTQ5NDUsIDAuOTQ5NDUsIDAuOTQ5NDUsIDEuMTIzMTcsIDEuMTIzMTcsIDEuMTIzMTcsIDAuNjc2MDMsIDAuNjc2MDMsIDEuMTU2MjEsIDAuNzM1ODQsIDEuMjExOTEsIDEuMjIxMzUsIDEuMDY0ODMsIDAuOTQ4NjgsIDAuOTQ4NjgsIDAuOTU5OTYsIDEuMjQ2MzMsIDEsIDEuMDc0OTcsIDAuODc3MDksIDAuOTY5MjcsIDEuMDE0NzMsIDAuOTY5MjcsIDEsIDEsIDEsIDAuNzcyOTUsIDEsIDEsIDEuMDk4MzYsIDEuMDk4MzYsIDEuMDk4MzYsIDEuMDE1MjIsIDAuODYzMjEsIDAuOTQ0MzQsIDAuODY0OSwgMC45NDQzNCwgMC44NjE4MiwgMSwgMSwgMS4wODMsIDEsIDAuOTE1NzgsIDAuODY0MzgsIDEuMTczMDgsIDEuMTg0MTYsIDEuMTQ1ODksIDAuNjk4MjUsIDAuOTc2MjIsIDEuOTY3OTEsIDEuMjQ4MjIsIDEuMjQ4MjIsIDEuMTczMDgsIDEuMjQ4MjIsIDEuMjQ4MjIsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuNDI2MDMsIDEsIDAuOTk4NjIsIDAuOTk4NjIsIDEsIDAuODcwMjUsIDAuODcwMjUsIDAuODcwMjUsIDAuODcwMjUsIDEuMTc5ODQsIDEuNDI2MDMsIDEsIDEuNDI2MDMsIDEuNDI2MDMsIDAuOTk4NjIsIDEsIDEsIDEsIDEsIDEsIDEuMjg4NiwgMS4wNDMxNSwgMS4xNTI5NiwgMS4zNDE2MywgMSwgMSwgMSwgMS4xMDc0MiwgMS4xMDc0MiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07CmV4cG9ydHMuU2Vnb2V1aUl0YWxpY0ZhY3RvcnMgPSBTZWdvZXVpSXRhbGljRmFjdG9yczsKY29uc3QgU2Vnb2V1aUl0YWxpY01ldHJpY3MgPSB7CiAgbGluZUhlaWdodDogMS4zMzAwOCwKICBsaW5lR2FwOiAwCn07CmV4cG9ydHMuU2Vnb2V1aUl0YWxpY01ldHJpY3MgPSBTZWdvZXVpSXRhbGljTWV0cmljczsKY29uc3QgU2Vnb2V1aVJlZ3VsYXJGYWN0b3JzID0gWzEuNzY3MzgsIDEsIDEsIDAuOTg1OTQsIDEuMDIyODUsIDEuMTA0NTQsIDEuMDYyMzQsIDAuOTY5MjcsIDAuOTIwMzcsIDEuMTk5ODUsIDEuMjA0NiwgMC45MDYxNiwgMC45MDYxNiwgMS4wNzE1MiwgMS4xNzE0LCAwLjc4MDMyLCAxLjIwMDg4LCAwLjc4MDMyLCAxLjQwMjQ2LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjk2OTI3LCAwLjc4MDMyLCAwLjc4MDMyLCAxLjE3MTQsIDEuMTcxNCwgMS4xNzE0LCAwLjgwNTk3LCAwLjk0MDg0LCAwLjk2NzA2LCAwLjg1OTQ0LCAwLjg1NzM0LCAwLjk3MDkzLCAwLjc1ODQyLCAwLjc5OTM2LCAwLjg4MTk4LCAwLjk4MzEsIDAuOTU3ODIsIDAuNzEzODcsIDAuODY5NjksIDAuODQ2MzYsIDEuMDc3OTYsIDEuMDM1ODQsIDAuOTY5MjQsIDAuODM5NjgsIDAuOTY5MjQsIDAuODI4MjYsIDAuNzk2NDksIDAuODU3NzEsIDAuOTUxMzIsIDAuOTMxMTksIDAuOTg5NjUsIDAuODg0MzMsIDAuODI4NywgMC45MzM2NSwgMS4wODYxMiwgMS4zNjM4LCAxLjA4NjEyLCAxLjQ1Nzg2LCAwLjc0NjI3LCAwLjgwNDk5LCAwLjkxNDg0LCAxLjA1NzA3LCAwLjkyMzgzLCAxLjA1ODgyLCAwLjk0MDMsIDEuMTI2NTQsIDEuMDU4ODIsIDEuMDE3NTYsIDEuMDkwMTEsIDEuMDkwMTEsIDAuOTk0MTQsIDEuMDkwMTEsIDEuMDM0LCAxLjAxNzU2LCAxLjA1MzU2LCAxLjA1NzA3LCAxLjA1ODgyLCAxLjA0Mzk5LCAwLjg0ODYzLCAxLjIxOTY4LCAxLjAxNzU2LCAwLjk1ODAxLCAxLjAwMDY4LCAwLjkxNzk3LCAwLjk2Nzc3LCAwLjkwNDMsIDAuOTAzNTEsIDAuOTIxMDUsIDAuOTAzNTEsIDEuMTcxNCwgMC44NTMzNywgMC45NjkyNywgMC45NjkyNywgMC45OTkxMiwgMC45NjkyNywgMC45MjEwNSwgMC44MDU5NywgMS4yNDM0LCAxLjIwODA4LCAxLjA1OTM3LCAwLjkwOTU3LCAxLjE3MTQsIDEuMjA4MDgsIDAuNzUxNTUsIDAuOTQyNjEsIDEuMjQ2NDQsIDEuMDk5NzEsIDEuMDk5NzEsIDAuODQ3NTEsIDEsIDAuODUyNzMsIDAuNzgwMzIsIDAuNjE1ODQsIDEuMDU0MjUsIDEuMTc5MTQsIDAuOTA5NTcsIDEuMDg2NjUsIDEuMTE1OTMsIDEuMTQxNjksIDAuNzMzODEsIDAuOTY3MDYsIDAuOTY3MDYsIDAuOTY3MDYsIDAuOTY3MDYsIDAuOTY3MDYsIDAuOTY3MDYsIDAuODYwMzUsIDAuODU3MzQsIDAuNzU4NDIsIDAuNzU4NDIsIDAuNzU4NDIsIDAuNzU4NDIsIDAuOTU3ODIsIDAuOTU3ODIsIDAuOTU3ODIsIDAuOTU3ODIsIDAuOTcwOTMsIDEuMDM1ODQsIDAuOTY5MjQsIDAuOTY5MjQsIDAuOTY5MjQsIDAuOTY5MjQsIDAuOTY5MjQsIDEuMTcxNCwgMC45NjkyNCwgMC45NTEzMiwgMC45NTEzMiwgMC45NTEzMiwgMC45NTEzMiwgMC44Mjg3LCAwLjgzOTY4LCAwLjg5MDQ5LCAwLjkxNDg0LCAwLjkxNDg0LCAwLjkxNDg0LCAwLjkxNDg0LCAwLjkxNDg0LCAwLjkxNDg0LCAwLjkzNTc1LCAwLjkyMzgzLCAwLjk0MDMsIDAuOTQwMywgMC45NDAzLCAwLjk0MDMsIDAuODcxNywgMC44NzE3LCAwLjg3MTcsIDAuODcxNywgMS4wMDUyNywgMS4wMTc1NiwgMS4wNTM1NiwgMS4wNTM1NiwgMS4wNTM1NiwgMS4wNTM1NiwgMS4wNTM1NiwgMS4yNDY0NCwgMC45NTkyMywgMS4wMTc1NiwgMS4wMTc1NiwgMS4wMTc1NiwgMS4wMTc1NiwgMC45Njc3NywgMS4wNTcwNywgMC45Njc3NywgMC45NjcwNiwgMC45MTQ4NCwgMC45NjcwNiwgMC45MTQ4NCwgMC45NjcwNiwgMC45MTQ4NCwgMC44NTczNCwgMC45MjM4MywgMC44NTczNCwgMC45MjM4MywgMC44NTczNCwgMC45MjM4MywgMC44NTczNCwgMC45MjM4MywgMC45NzA5MywgMS4wOTY5LCAwLjk3MDkzLCAxLjA1ODgyLCAwLjc1ODQyLCAwLjk0MDMsIDAuNzU4NDIsIDAuOTQwMywgMC43NTg0MiwgMC45NDAzLCAwLjc1ODQyLCAwLjk0MDMsIDAuNzU4NDIsIDAuOTQwMywgMC44ODE5OCwgMS4wNTg4MiwgMC44ODE5OCwgMS4wNTg4MiwgMC44ODE5OCwgMS4wNTg4MiwgMSwgMSwgMC45ODMxLCAxLjAxNzU2LCAwLjk4MzEsIDEuMDE3NTYsIDAuOTU3ODIsIDAuODcxNywgMC45NTc4MiwgMC44NzE3LCAwLjk1NzgyLCAwLjg3MTcsIDAuOTU3ODIsIDEuMDkwMTEsIDAuOTU3ODIsIDAuODcxNywgMC44NDc4NCwgMS4xMTU1MSwgMC43MTM4NywgMS4wOTAxMSwgMSwgMSwgMC45OTQxNCwgMC44NDYzNiwgMS4wOTAxMSwgMSwgMSwgMC44NDYzNiwgMS4wNTM2LCAwLjg0NjM2LCAwLjk0Mjk4LCAwLjg0NjM2LCAxLjIzMjk3LCAxLjAzNTg0LCAxLjAxNzU2LCAxLCAxLCAxLjAzNTg0LCAxLjAxNzU2LCAxLjAwMzIzLCAxLjAzNDQ0LCAxLjAxNzU2LCAwLjk2OTI0LCAxLjA1MzU2LCAwLjk2OTI0LCAxLjA1MzU2LCAwLjk2OTI0LCAxLjA1MzU2LCAwLjkzMDY2LCAwLjk4MjkzLCAwLjgyODI2LCAxLjA0Mzk5LCAxLCAxLCAwLjgyODI2LCAxLjA0Mzk5LCAwLjc5NjQ5LCAwLjg0ODYzLCAwLjc5NjQ5LCAwLjg0ODYzLCAwLjc5NjQ5LCAwLjg0ODYzLCAwLjc5NjQ5LCAwLjg0ODYzLCAxLCAxLCAwLjg1NzcxLCAxLjE3MzE4LCAwLjg1NzcxLCAxLjIxOTY4LCAwLjk1MTMyLCAxLjAxNzU2LCAwLjk1MTMyLCAxLjAxNzU2LCAwLjk1MTMyLCAxLjAxNzU2LCAwLjk1MTMyLCAxLjAxNzU2LCAwLjk1MTMyLCAxLjAxNzU2LCAwLjk1MTMyLCAxLjAxNzU2LCAwLjk4OTY1LCAxLjAwMDY4LCAwLjgyODcsIDAuOTY3NzcsIDAuODI4NywgMC45MzM2NSwgMC45MDQzLCAwLjkzMzY1LCAwLjkwNDMsIDAuOTMzNjUsIDAuOTA0MywgMS4wODU3MSwgMC45NjkyNywgMC45NjcwNiwgMC45MTQ4NCwgMC44NjAzNSwgMC45MzU3NSwgMC45NjkyNCwgMC45NTkyMywgMSwgMSwgMC44NTc3MSwgMS4yMTk2OCwgMS4xMTQzNywgMS4xMTQzNywgMC45MzEwOSwgMC45MTIwMiwgMC42MDQxMSwgMC44NDE2NCwgMC41NTU3MiwgMS4wMTE3MywgMC45NzM2MSwgMC44MTgxOCwgMC44MTgxOCwgMC45NjYzNSwgMC43ODAzMiwgMC43MjcyNywgMC45MjM2NiwgMC45ODYwMSwgMS4wMzQwNSwgMC43Nzk2OCwgMS4wOTc5OSwgMS4yLCAwLjk2NzA2LCAwLjg1OTQ0LCAwLjg1NjM4LCAwLjk2NDkxLCAwLjc1ODQyLCAwLjkzMzY1LCAwLjk4MzEsIDAuOTY5MjQsIDAuOTU3ODIsIDAuODY5NjksIDAuOTQxNTIsIDEuMDc3OTYsIDEuMDM1ODQsIDAuNzg0MzcsIDAuOTY5MjQsIDAuOTg3MTUsIDAuODM5NjgsIDAuODM0OTEsIDAuODU3NzEsIDAuODI4NywgMC45NDQ5MiwgMC44ODQzMywgMC45Mjg3LCAxLjAwOTgsIDAuOTU3ODIsIDAuODI4NywgMS4wNjI1LCAwLjk4MjQ4LCAxLjAzNDI0LCAxLjIsIDEuMDEwNzEsIDEuMDYyNSwgMC45NTI0NiwgMS4wMzgwOSwgMS4wNDkxMiwgMC45ODI0OCwgMS4wMDIyMSwgMS4wMzQyNCwgMS4wNTQ0MywgMS4yLCAxLjA0Nzg1LCAwLjk5NjA5LCAxLjAwMTY5LCAxLjA1MTc2LCAwLjk5MzQ2LCAxLjA1MzU2LCAwLjkwODcsIDEuMDMwMDQsIDAuOTU1NDIsIDAuOTMxMTcsIDEuMjMzNjIsIDEuMDEwNzEsIDEuMDc4MzEsIDEuMDI1MTIsIDEuMDUyMDUsIDEuMDM1MDIsIDEuMiwgMS4wMTA3MSwgMS4wNTM1NiwgMS4wMTA3MSwgMS4wMzUwMiwgMC43NTg0MiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMS4wMzcxOSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45NDAzLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjA0MDIxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk4OTY1LCAxLjAwMDY4LCAwLjk4OTY1LCAxLjAwMDY4LCAwLjk4OTY1LCAxLjAwMDY4LCAwLjgyODcsIDAuOTY3NzcsIDEsIDEuMjAwODgsIDAuODk5MDMsIDEsIDEsIDAuNzUxNTUsIDEuMDMwNzcsIDEuMDMwNzcsIDEuMDMwNzcsIDEuMDMwNzcsIDEuMTMxOTYsIDEuMTMxOTYsIDEuMTMxOTYsIDAuNjc0MjgsIDAuNjc0MjgsIDEuMTYwMzksIDAuNzMyOTEsIDEuMjA5OTYsIDEuMjIxMzUsIDEuMDY0ODMsIDAuOTQ4NjgsIDAuOTQ4NjgsIDAuOTU5OTYsIDEuMjQ2MzMsIDEsIDEuMDc0OTcsIDAuODc3OTYsIDAuOTY5MjcsIDEuMDE1MTgsIDAuOTY5MjcsIDEsIDEsIDEsIDAuNzcyOTUsIDEsIDEsIDEuMTA1MzksIDEuMTA1MzksIDEuMTEzNTgsIDEuMDY5NjcsIDAuODYyNzksIDAuOTQ0MzQsIDAuODYyNzksIDAuOTQ0MzQsIDAuODYxODIsIDEsIDEsIDEuMDgzLCAxLCAwLjkxNTc4LCAwLjg2NTA3LCAxLjE3MTQsIDEuMTg0MTYsIDEuMTQ1ODksIDAuNjk4MjUsIDAuOTc2MjIsIDEuOTY5NywgMS4yNDgyMiwgMS4yNDgyMiwgMS4xNzIzOCwgMS4yNDgyMiwgMS4yNDgyMiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMS40MjYwMywgMSwgMC45OTg2MiwgMC45OTg2MiwgMSwgMC44NzAyNSwgMC44NzAyNSwgMC44NzAyNSwgMC44NzAyNSwgMS4xODA4MywgMS40MjYwMywgMSwgMS40MjYwMywgMS40MjYwMywgMC45OTg2MiwgMSwgMSwgMSwgMSwgMSwgMS4yODg2LCAxLjA0MzE1LCAxLjE1Mjk2LCAxLjM0MTYzLCAxLCAxLCAxLCAxLjEwOTM4LCAxLjEwOTM4LCAxLCAxLCAxLCAxLjA1NDI1LCAxLjA5OTcxLCAxLjA5OTcxLCAxLjA5OTcxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxXTsKZXhwb3J0cy5TZWdvZXVpUmVndWxhckZhY3RvcnMgPSBTZWdvZXVpUmVndWxhckZhY3RvcnM7CmNvbnN0IFNlZ29ldWlSZWd1bGFyTWV0cmljcyA9IHsKICBsaW5lSGVpZ2h0OiAxLjMzMDA4LAogIGxpbmVHYXA6IDAKfTsKZXhwb3J0cy5TZWdvZXVpUmVndWxhck1ldHJpY3MgPSBTZWdvZXVpUmVndWxhck1ldHJpY3M7CgovKioqLyB9KSwKLyogMTgyICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Qb3N0U2NyaXB0RXZhbHVhdG9yID0gZXhwb3J0cy5Qb3N0U2NyaXB0Q29tcGlsZXIgPSBleHBvcnRzLlBERkZ1bmN0aW9uRmFjdG9yeSA9IHZvaWQgMDsKZXhwb3J0cy5pc1BERkZ1bmN0aW9uID0gaXNQREZGdW5jdGlvbjsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMwKTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX3BzX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTgzKTsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMik7Cgp2YXIgX2ltYWdlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxODQpOwoKY2xhc3MgUERGRnVuY3Rpb25GYWN0b3J5IHsKICBjb25zdHJ1Y3RvcihfcmVmKSB7CiAgICBsZXQgewogICAgICB4cmVmLAogICAgICBpc0V2YWxTdXBwb3J0ZWQgPSB0cnVlCiAgICB9ID0gX3JlZjsKICAgIHRoaXMueHJlZiA9IHhyZWY7CiAgICB0aGlzLmlzRXZhbFN1cHBvcnRlZCA9IGlzRXZhbFN1cHBvcnRlZCAhPT0gZmFsc2U7CiAgfQoKICBjcmVhdGUoZm4pIHsKICAgIGNvbnN0IGNhY2hlZEZ1bmN0aW9uID0gdGhpcy5nZXRDYWNoZWQoZm4pOwoKICAgIGlmIChjYWNoZWRGdW5jdGlvbikgewogICAgICByZXR1cm4gY2FjaGVkRnVuY3Rpb247CiAgICB9CgogICAgY29uc3QgcGFyc2VkRnVuY3Rpb24gPSBQREZGdW5jdGlvbi5wYXJzZSh7CiAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgaXNFdmFsU3VwcG9ydGVkOiB0aGlzLmlzRXZhbFN1cHBvcnRlZCwKICAgICAgZm46IGZuIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmID8gdGhpcy54cmVmLmZldGNoKGZuKSA6IGZuCiAgICB9KTsKCiAgICB0aGlzLl9jYWNoZShmbiwgcGFyc2VkRnVuY3Rpb24pOwoKICAgIHJldHVybiBwYXJzZWRGdW5jdGlvbjsKICB9CgogIGNyZWF0ZUZyb21BcnJheShmbk9iaikgewogICAgY29uc3QgY2FjaGVkRnVuY3Rpb24gPSB0aGlzLmdldENhY2hlZChmbk9iaik7CgogICAgaWYgKGNhY2hlZEZ1bmN0aW9uKSB7CiAgICAgIHJldHVybiBjYWNoZWRGdW5jdGlvbjsKICAgIH0KCiAgICBjb25zdCBwYXJzZWRGdW5jdGlvbiA9IFBERkZ1bmN0aW9uLnBhcnNlQXJyYXkoewogICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgIGlzRXZhbFN1cHBvcnRlZDogdGhpcy5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgIGZuT2JqOiBmbk9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZiA/IHRoaXMueHJlZi5mZXRjaChmbk9iaikgOiBmbk9iagogICAgfSk7CgogICAgdGhpcy5fY2FjaGUoZm5PYmosIHBhcnNlZEZ1bmN0aW9uKTsKCiAgICByZXR1cm4gcGFyc2VkRnVuY3Rpb247CiAgfQoKICBnZXRDYWNoZWQoY2FjaGVLZXkpIHsKICAgIGxldCBmblJlZjsKCiAgICBpZiAoY2FjaGVLZXkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgZm5SZWYgPSBjYWNoZUtleTsKICAgIH0gZWxzZSBpZiAoY2FjaGVLZXkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIGZuUmVmID0gY2FjaGVLZXkub2JqSWQ7CiAgICB9IGVsc2UgaWYgKGNhY2hlS2V5IGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgZm5SZWYgPSBjYWNoZUtleS5kaWN0ICYmIGNhY2hlS2V5LmRpY3Qub2JqSWQ7CiAgICB9CgogICAgaWYgKGZuUmVmKSB7CiAgICAgIGNvbnN0IGxvY2FsRnVuY3Rpb24gPSB0aGlzLl9sb2NhbEZ1bmN0aW9uQ2FjaGUuZ2V0QnlSZWYoZm5SZWYpOwoKICAgICAgaWYgKGxvY2FsRnVuY3Rpb24pIHsKICAgICAgICByZXR1cm4gbG9jYWxGdW5jdGlvbjsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgX2NhY2hlKGNhY2hlS2V5LCBwYXJzZWRGdW5jdGlvbikgewogICAgaWYgKCFwYXJzZWRGdW5jdGlvbikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BERkZ1bmN0aW9uRmFjdG9yeS5fY2FjaGUgLSBleHBlY3RlZCAicGFyc2VkRnVuY3Rpb24iIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGxldCBmblJlZjsKCiAgICBpZiAoY2FjaGVLZXkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgZm5SZWYgPSBjYWNoZUtleTsKICAgIH0gZWxzZSBpZiAoY2FjaGVLZXkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIGZuUmVmID0gY2FjaGVLZXkub2JqSWQ7CiAgICB9IGVsc2UgaWYgKGNhY2hlS2V5IGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgZm5SZWYgPSBjYWNoZUtleS5kaWN0ICYmIGNhY2hlS2V5LmRpY3Qub2JqSWQ7CiAgICB9CgogICAgaWYgKGZuUmVmKSB7CiAgICAgIHRoaXMuX2xvY2FsRnVuY3Rpb25DYWNoZS5zZXQobnVsbCwgZm5SZWYsIHBhcnNlZEZ1bmN0aW9uKTsKICAgIH0KICB9CgogIGdldCBfbG9jYWxGdW5jdGlvbkNhY2hlKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJfbG9jYWxGdW5jdGlvbkNhY2hlIiwgbmV3IF9pbWFnZV91dGlscy5Mb2NhbEZ1bmN0aW9uQ2FjaGUoKSk7CiAgfQoKfQoKZXhwb3J0cy5QREZGdW5jdGlvbkZhY3RvcnkgPSBQREZGdW5jdGlvbkZhY3Rvcnk7CgpmdW5jdGlvbiB0b051bWJlckFycmF5KGFycikgewogIGlmICghQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IGxlbmd0aCA9IGFyci5sZW5ndGg7CgogIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgIGlmICh0eXBlb2YgYXJyW2ldICE9PSAibnVtYmVyIikgewogICAgICBjb25zdCByZXN1bHQgPSBuZXcgQXJyYXkobGVuZ3RoKTsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbGVuZ3RoOyBqKyspIHsKICAgICAgICByZXN1bHRbal0gPSArYXJyW2pdOwogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0KCiAgcmV0dXJuIGFycjsKfQoKY2xhc3MgUERGRnVuY3Rpb24gewogIHN0YXRpYyBnZXRTYW1wbGVBcnJheShzaXplLCBvdXRwdXRTaXplLCBicHMsIHN0cmVhbSkgewogICAgbGV0IGksIGlpOwogICAgbGV0IGxlbmd0aCA9IDE7CgogICAgZm9yIChpID0gMCwgaWkgPSBzaXplLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgbGVuZ3RoICo9IHNpemVbaV07CiAgICB9CgogICAgbGVuZ3RoICo9IG91dHB1dFNpemU7CiAgICBjb25zdCBhcnJheSA9IG5ldyBBcnJheShsZW5ndGgpOwogICAgbGV0IGNvZGVTaXplID0gMDsKICAgIGxldCBjb2RlQnVmID0gMDsKICAgIGNvbnN0IHNhbXBsZU11bCA9IDEuMCAvICgyLjAgKiogYnBzIC0gMSk7CiAgICBjb25zdCBzdHJCeXRlcyA9IHN0cmVhbS5nZXRCeXRlcygobGVuZ3RoICogYnBzICsgNykgLyA4KTsKICAgIGxldCBzdHJJZHggPSAwOwoKICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICB3aGlsZSAoY29kZVNpemUgPCBicHMpIHsKICAgICAgICBjb2RlQnVmIDw8PSA4OwogICAgICAgIGNvZGVCdWYgfD0gc3RyQnl0ZXNbc3RySWR4KytdOwogICAgICAgIGNvZGVTaXplICs9IDg7CiAgICAgIH0KCiAgICAgIGNvZGVTaXplIC09IGJwczsKICAgICAgYXJyYXlbaV0gPSAoY29kZUJ1ZiA+PiBjb2RlU2l6ZSkgKiBzYW1wbGVNdWw7CiAgICAgIGNvZGVCdWYgJj0gKDEgPDwgY29kZVNpemUpIC0gMTsKICAgIH0KCiAgICByZXR1cm4gYXJyYXk7CiAgfQoKICBzdGF0aWMgcGFyc2UoX3JlZjIpIHsKICAgIGxldCB7CiAgICAgIHhyZWYsCiAgICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgICAgZm4KICAgIH0gPSBfcmVmMjsKICAgIGNvbnN0IGRpY3QgPSBmbi5kaWN0IHx8IGZuOwogICAgY29uc3QgdHlwZU51bSA9IGRpY3QuZ2V0KCJGdW5jdGlvblR5cGUiKTsKCiAgICBzd2l0Y2ggKHR5cGVOdW0pIHsKICAgICAgY2FzZSAwOgogICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdFNhbXBsZWQoewogICAgICAgICAgeHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgIGZuLAogICAgICAgICAgZGljdAogICAgICAgIH0pOwoKICAgICAgY2FzZSAxOgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyOgogICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdEludGVycG9sYXRlZCh7CiAgICAgICAgICB4cmVmLAogICAgICAgICAgaXNFdmFsU3VwcG9ydGVkLAogICAgICAgICAgZGljdAogICAgICAgIH0pOwoKICAgICAgY2FzZSAzOgogICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdFN0aWNoZWQoewogICAgICAgICAgeHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgIGRpY3QKICAgICAgICB9KTsKCiAgICAgIGNhc2UgNDoKICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RQb3N0U2NyaXB0KHsKICAgICAgICAgIHhyZWYsCiAgICAgICAgICBpc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgICBmbiwKICAgICAgICAgIGRpY3QKICAgICAgICB9KTsKICAgIH0KCiAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gdHlwZSBvZiBmdW5jdGlvbiIpOwogIH0KCiAgc3RhdGljIHBhcnNlQXJyYXkoX3JlZjMpIHsKICAgIGxldCB7CiAgICAgIHhyZWYsCiAgICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgICAgZm5PYmoKICAgIH0gPSBfcmVmMzsKCiAgICBpZiAoIUFycmF5LmlzQXJyYXkoZm5PYmopKSB7CiAgICAgIHJldHVybiB0aGlzLnBhcnNlKHsKICAgICAgICB4cmVmLAogICAgICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgICAgICBmbjogZm5PYmoKICAgICAgfSk7CiAgICB9CgogICAgY29uc3QgZm5BcnJheSA9IFtdOwoKICAgIGZvciAobGV0IGogPSAwLCBqaiA9IGZuT2JqLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgZm5BcnJheS5wdXNoKHRoaXMucGFyc2UoewogICAgICAgIHhyZWYsCiAgICAgICAgaXNFdmFsU3VwcG9ydGVkLAogICAgICAgIGZuOiB4cmVmLmZldGNoSWZSZWYoZm5PYmpbal0pCiAgICAgIH0pKTsKICAgIH0KCiAgICByZXR1cm4gZnVuY3Rpb24gKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGZuQXJyYXkubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGZuQXJyYXlbaV0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQgKyBpKTsKICAgICAgfQogICAgfTsKICB9CgogIHN0YXRpYyBjb25zdHJ1Y3RTYW1wbGVkKF9yZWY0KSB7CiAgICBsZXQgewogICAgICB4cmVmLAogICAgICBpc0V2YWxTdXBwb3J0ZWQsCiAgICAgIGZuLAogICAgICBkaWN0CiAgICB9ID0gX3JlZjQ7CgogICAgZnVuY3Rpb24gdG9NdWx0aUFycmF5KGFycikgewogICAgICBjb25zdCBpbnB1dExlbmd0aCA9IGFyci5sZW5ndGg7CiAgICAgIGNvbnN0IG91dCA9IFtdOwogICAgICBsZXQgaW5kZXggPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dExlbmd0aDsgaSArPSAyKSB7CiAgICAgICAgb3V0W2luZGV4KytdID0gW2FycltpXSwgYXJyW2kgKyAxXV07CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXQ7CiAgICB9CgogICAgZnVuY3Rpb24gaW50ZXJwb2xhdGUoeCwgeG1pbiwgeG1heCwgeW1pbiwgeW1heCkgewogICAgICByZXR1cm4geW1pbiArICh4IC0geG1pbikgKiAoKHltYXggLSB5bWluKSAvICh4bWF4IC0geG1pbikpOwogICAgfQoKICAgIGxldCBkb21haW4gPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIkRvbWFpbiIpKTsKICAgIGxldCByYW5nZSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiUmFuZ2UiKSk7CgogICAgaWYgKCFkb21haW4gfHwgIXJhbmdlKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTm8gZG9tYWluIG9yIHJhbmdlIik7CiAgICB9CgogICAgY29uc3QgaW5wdXRTaXplID0gZG9tYWluLmxlbmd0aCAvIDI7CiAgICBjb25zdCBvdXRwdXRTaXplID0gcmFuZ2UubGVuZ3RoIC8gMjsKICAgIGRvbWFpbiA9IHRvTXVsdGlBcnJheShkb21haW4pOwogICAgcmFuZ2UgPSB0b011bHRpQXJyYXkocmFuZ2UpOwogICAgY29uc3Qgc2l6ZSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiU2l6ZSIpKTsKICAgIGNvbnN0IGJwcyA9IGRpY3QuZ2V0KCJCaXRzUGVyU2FtcGxlIik7CiAgICBjb25zdCBvcmRlciA9IGRpY3QuZ2V0KCJPcmRlciIpIHx8IDE7CgogICAgaWYgKG9yZGVyICE9PSAxKSB7CiAgICAgICgwLCBfdXRpbC5pbmZvKSgiTm8gc3VwcG9ydCBmb3IgY3ViaWMgc3BsaW5lIGludGVycG9sYXRpb246ICIgKyBvcmRlcik7CiAgICB9CgogICAgbGV0IGVuY29kZSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiRW5jb2RlIikpOwoKICAgIGlmICghZW5jb2RlKSB7CiAgICAgIGVuY29kZSA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dFNpemU7ICsraSkgewogICAgICAgIGVuY29kZS5wdXNoKFswLCBzaXplW2ldIC0gMV0pOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBlbmNvZGUgPSB0b011bHRpQXJyYXkoZW5jb2RlKTsKICAgIH0KCiAgICBsZXQgZGVjb2RlID0gdG9OdW1iZXJBcnJheShkaWN0LmdldEFycmF5KCJEZWNvZGUiKSk7CgogICAgaWYgKCFkZWNvZGUpIHsKICAgICAgZGVjb2RlID0gcmFuZ2U7CiAgICB9IGVsc2UgewogICAgICBkZWNvZGUgPSB0b011bHRpQXJyYXkoZGVjb2RlKTsKICAgIH0KCiAgICBjb25zdCBzYW1wbGVzID0gdGhpcy5nZXRTYW1wbGVBcnJheShzaXplLCBvdXRwdXRTaXplLCBicHMsIGZuKTsKICAgIHJldHVybiBmdW5jdGlvbiBjb25zdHJ1Y3RTYW1wbGVkRm4oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgY29uc3QgY3ViZVZlcnRpY2VzID0gMSA8PCBpbnB1dFNpemU7CiAgICAgIGNvbnN0IGN1YmVOID0gbmV3IEZsb2F0NjRBcnJheShjdWJlVmVydGljZXMpOwogICAgICBjb25zdCBjdWJlVmVydGV4ID0gbmV3IFVpbnQzMkFycmF5KGN1YmVWZXJ0aWNlcyk7CiAgICAgIGxldCBpLCBqOwoKICAgICAgZm9yIChqID0gMDsgaiA8IGN1YmVWZXJ0aWNlczsgaisrKSB7CiAgICAgICAgY3ViZU5bal0gPSAxOwogICAgICB9CgogICAgICBsZXQgayA9IG91dHB1dFNpemUsCiAgICAgICAgICBwb3MgPSAxOwoKICAgICAgZm9yIChpID0gMDsgaSA8IGlucHV0U2l6ZTsgKytpKSB7CiAgICAgICAgY29uc3QgZG9tYWluXzJpID0gZG9tYWluW2ldWzBdOwogICAgICAgIGNvbnN0IGRvbWFpbl8yaV8xID0gZG9tYWluW2ldWzFdOwogICAgICAgIGNvbnN0IHhpID0gTWF0aC5taW4oTWF0aC5tYXgoc3JjW3NyY09mZnNldCArIGldLCBkb21haW5fMmkpLCBkb21haW5fMmlfMSk7CiAgICAgICAgbGV0IGUgPSBpbnRlcnBvbGF0ZSh4aSwgZG9tYWluXzJpLCBkb21haW5fMmlfMSwgZW5jb2RlW2ldWzBdLCBlbmNvZGVbaV1bMV0pOwogICAgICAgIGNvbnN0IHNpemVfaSA9IHNpemVbaV07CiAgICAgICAgZSA9IE1hdGgubWluKE1hdGgubWF4KGUsIDApLCBzaXplX2kgLSAxKTsKICAgICAgICBjb25zdCBlMCA9IGUgPCBzaXplX2kgLSAxID8gTWF0aC5mbG9vcihlKSA6IGUgLSAxOwogICAgICAgIGNvbnN0IG4wID0gZTAgKyAxIC0gZTsKICAgICAgICBjb25zdCBuMSA9IGUgLSBlMDsKICAgICAgICBjb25zdCBvZmZzZXQwID0gZTAgKiBrOwogICAgICAgIGNvbnN0IG9mZnNldDEgPSBvZmZzZXQwICsgazsKCiAgICAgICAgZm9yIChqID0gMDsgaiA8IGN1YmVWZXJ0aWNlczsgaisrKSB7CiAgICAgICAgICBpZiAoaiAmIHBvcykgewogICAgICAgICAgICBjdWJlTltqXSAqPSBuMTsKICAgICAgICAgICAgY3ViZVZlcnRleFtqXSArPSBvZmZzZXQxOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3ViZU5bal0gKj0gbjA7CiAgICAgICAgICAgIGN1YmVWZXJ0ZXhbal0gKz0gb2Zmc2V0MDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGsgKj0gc2l6ZV9pOwogICAgICAgIHBvcyA8PD0gMTsKICAgICAgfQoKICAgICAgZm9yIChqID0gMDsgaiA8IG91dHB1dFNpemU7ICsraikgewogICAgICAgIGxldCByaiA9IDA7CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBjdWJlVmVydGljZXM7IGkrKykgewogICAgICAgICAgcmogKz0gc2FtcGxlc1tjdWJlVmVydGV4W2ldICsgal0gKiBjdWJlTltpXTsKICAgICAgICB9CgogICAgICAgIHJqID0gaW50ZXJwb2xhdGUocmosIDAsIDEsIGRlY29kZVtqXVswXSwgZGVjb2RlW2pdWzFdKTsKICAgICAgICBkZXN0W2Rlc3RPZmZzZXQgKyBqXSA9IE1hdGgubWluKE1hdGgubWF4KHJqLCByYW5nZVtqXVswXSksIHJhbmdlW2pdWzFdKTsKICAgICAgfQogICAgfTsKICB9CgogIHN0YXRpYyBjb25zdHJ1Y3RJbnRlcnBvbGF0ZWQoX3JlZjUpIHsKICAgIGxldCB7CiAgICAgIHhyZWYsCiAgICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgICAgZGljdAogICAgfSA9IF9yZWY1OwogICAgY29uc3QgYzAgPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIkMwIikpIHx8IFswXTsKICAgIGNvbnN0IGMxID0gdG9OdW1iZXJBcnJheShkaWN0LmdldEFycmF5KCJDMSIpKSB8fCBbMV07CiAgICBjb25zdCBuID0gZGljdC5nZXQoIk4iKTsKICAgIGNvbnN0IGRpZmYgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjMC5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIGRpZmYucHVzaChjMVtpXSAtIGMwW2ldKTsKICAgIH0KCiAgICBjb25zdCBsZW5ndGggPSBkaWZmLmxlbmd0aDsKICAgIHJldHVybiBmdW5jdGlvbiBjb25zdHJ1Y3RJbnRlcnBvbGF0ZWRGbihzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgICBjb25zdCB4ID0gbiA9PT0gMSA/IHNyY1tzcmNPZmZzZXRdIDogc3JjW3NyY09mZnNldF0gKiogbjsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbGVuZ3RoOyArK2opIHsKICAgICAgICBkZXN0W2Rlc3RPZmZzZXQgKyBqXSA9IGMwW2pdICsgeCAqIGRpZmZbal07CiAgICAgIH0KICAgIH07CiAgfQoKICBzdGF0aWMgY29uc3RydWN0U3RpY2hlZChfcmVmNikgewogICAgbGV0IHsKICAgICAgeHJlZiwKICAgICAgaXNFdmFsU3VwcG9ydGVkLAogICAgICBkaWN0CiAgICB9ID0gX3JlZjY7CiAgICBjb25zdCBkb21haW4gPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIkRvbWFpbiIpKTsKCiAgICBpZiAoIWRvbWFpbikgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk5vIGRvbWFpbiIpOwogICAgfQoKICAgIGNvbnN0IGlucHV0U2l6ZSA9IGRvbWFpbi5sZW5ndGggLyAyOwoKICAgIGlmIChpbnB1dFNpemUgIT09IDEpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYWQgZG9tYWluIGZvciBzdGljaGVkIGZ1bmN0aW9uIik7CiAgICB9CgogICAgY29uc3QgZm5SZWZzID0gZGljdC5nZXQoIkZ1bmN0aW9ucyIpOwogICAgY29uc3QgZm5zID0gW107CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZm5SZWZzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgZm5zLnB1c2godGhpcy5wYXJzZSh7CiAgICAgICAgeHJlZiwKICAgICAgICBpc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgZm46IHhyZWYuZmV0Y2hJZlJlZihmblJlZnNbaV0pCiAgICAgIH0pKTsKICAgIH0KCiAgICBjb25zdCBib3VuZHMgPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIkJvdW5kcyIpKTsKICAgIGNvbnN0IGVuY29kZSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiRW5jb2RlIikpOwogICAgY29uc3QgdG1wQnVmID0gbmV3IEZsb2F0MzJBcnJheSgxKTsKICAgIHJldHVybiBmdW5jdGlvbiBjb25zdHJ1Y3RTdGljaGVkRm4oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgY29uc3QgY2xpcCA9IGZ1bmN0aW9uIGNvbnN0cnVjdFN0aWNoZWRGcm9tSVJDbGlwKHYsIG1pbiwgbWF4KSB7CiAgICAgICAgaWYgKHYgPiBtYXgpIHsKICAgICAgICAgIHYgPSBtYXg7CiAgICAgICAgfSBlbHNlIGlmICh2IDwgbWluKSB7CiAgICAgICAgICB2ID0gbWluOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHY7CiAgICAgIH07CgogICAgICBjb25zdCB2ID0gY2xpcChzcmNbc3JjT2Zmc2V0XSwgZG9tYWluWzBdLCBkb21haW5bMV0pOwogICAgICBjb25zdCBsZW5ndGggPSBib3VuZHMubGVuZ3RoOwogICAgICBsZXQgaTsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgIGlmICh2IDwgYm91bmRzW2ldKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGxldCBkbWluID0gZG9tYWluWzBdOwoKICAgICAgaWYgKGkgPiAwKSB7CiAgICAgICAgZG1pbiA9IGJvdW5kc1tpIC0gMV07CiAgICAgIH0KCiAgICAgIGxldCBkbWF4ID0gZG9tYWluWzFdOwoKICAgICAgaWYgKGkgPCBib3VuZHMubGVuZ3RoKSB7CiAgICAgICAgZG1heCA9IGJvdW5kc1tpXTsKICAgICAgfQoKICAgICAgY29uc3Qgcm1pbiA9IGVuY29kZVsyICogaV07CiAgICAgIGNvbnN0IHJtYXggPSBlbmNvZGVbMiAqIGkgKyAxXTsKICAgICAgdG1wQnVmWzBdID0gZG1pbiA9PT0gZG1heCA/IHJtaW4gOiBybWluICsgKHYgLSBkbWluKSAqIChybWF4IC0gcm1pbikgLyAoZG1heCAtIGRtaW4pOwogICAgICBmbnNbaV0odG1wQnVmLCAwLCBkZXN0LCBkZXN0T2Zmc2V0KTsKICAgIH07CiAgfQoKICBzdGF0aWMgY29uc3RydWN0UG9zdFNjcmlwdChfcmVmNykgewogICAgbGV0IHsKICAgICAgeHJlZiwKICAgICAgaXNFdmFsU3VwcG9ydGVkLAogICAgICBmbiwKICAgICAgZGljdAogICAgfSA9IF9yZWY3OwogICAgY29uc3QgZG9tYWluID0gdG9OdW1iZXJBcnJheShkaWN0LmdldEFycmF5KCJEb21haW4iKSk7CiAgICBjb25zdCByYW5nZSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiUmFuZ2UiKSk7CgogICAgaWYgKCFkb21haW4pIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJObyBkb21haW4uIik7CiAgICB9CgogICAgaWYgKCFyYW5nZSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk5vIHJhbmdlLiIpOwogICAgfQoKICAgIGNvbnN0IGxleGVyID0gbmV3IF9wc19wYXJzZXIuUG9zdFNjcmlwdExleGVyKGZuKTsKICAgIGNvbnN0IHBhcnNlciA9IG5ldyBfcHNfcGFyc2VyLlBvc3RTY3JpcHRQYXJzZXIobGV4ZXIpOwogICAgY29uc3QgY29kZSA9IHBhcnNlci5wYXJzZSgpOwoKICAgIGlmIChpc0V2YWxTdXBwb3J0ZWQgJiYgX3V0aWwuRmVhdHVyZVRlc3QuaXNFdmFsU3VwcG9ydGVkKSB7CiAgICAgIGNvbnN0IGNvbXBpbGVkID0gbmV3IFBvc3RTY3JpcHRDb21waWxlcigpLmNvbXBpbGUoY29kZSwgZG9tYWluLCByYW5nZSk7CgogICAgICBpZiAoY29tcGlsZWQpIHsKICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKCJzcmMiLCAic3JjT2Zmc2V0IiwgImRlc3QiLCAiZGVzdE9mZnNldCIsIGNvbXBpbGVkKTsKICAgICAgfQogICAgfQoKICAgICgwLCBfdXRpbC5pbmZvKSgiVW5hYmxlIHRvIGNvbXBpbGUgUFMgZnVuY3Rpb24iKTsKICAgIGNvbnN0IG51bU91dHB1dHMgPSByYW5nZS5sZW5ndGggPj4gMTsKICAgIGNvbnN0IG51bUlucHV0cyA9IGRvbWFpbi5sZW5ndGggPj4gMTsKICAgIGNvbnN0IGV2YWx1YXRvciA9IG5ldyBQb3N0U2NyaXB0RXZhbHVhdG9yKGNvZGUpOwogICAgY29uc3QgY2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgY29uc3QgTUFYX0NBQ0hFX1NJWkUgPSAyMDQ4ICogNDsKICAgIGxldCBjYWNoZV9hdmFpbGFibGUgPSBNQVhfQ0FDSEVfU0laRTsKICAgIGNvbnN0IHRtcEJ1ZiA9IG5ldyBGbG9hdDMyQXJyYXkobnVtSW5wdXRzKTsKICAgIHJldHVybiBmdW5jdGlvbiBjb25zdHJ1Y3RQb3N0U2NyaXB0Rm4oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgbGV0IGksIHZhbHVlOwogICAgICBsZXQga2V5ID0gIiI7CiAgICAgIGNvbnN0IGlucHV0ID0gdG1wQnVmOwoKICAgICAgZm9yIChpID0gMDsgaSA8IG51bUlucHV0czsgaSsrKSB7CiAgICAgICAgdmFsdWUgPSBzcmNbc3JjT2Zmc2V0ICsgaV07CiAgICAgICAgaW5wdXRbaV0gPSB2YWx1ZTsKICAgICAgICBrZXkgKz0gdmFsdWUgKyAiXyI7CiAgICAgIH0KCiAgICAgIGNvbnN0IGNhY2hlZFZhbHVlID0gY2FjaGVba2V5XTsKCiAgICAgIGlmIChjYWNoZWRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgZGVzdC5zZXQoY2FjaGVkVmFsdWUsIGRlc3RPZmZzZXQpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgb3V0cHV0ID0gbmV3IEZsb2F0MzJBcnJheShudW1PdXRwdXRzKTsKICAgICAgY29uc3Qgc3RhY2sgPSBldmFsdWF0b3IuZXhlY3V0ZShpbnB1dCk7CiAgICAgIGNvbnN0IHN0YWNrSW5kZXggPSBzdGFjay5sZW5ndGggLSBudW1PdXRwdXRzOwoKICAgICAgZm9yIChpID0gMDsgaSA8IG51bU91dHB1dHM7IGkrKykgewogICAgICAgIHZhbHVlID0gc3RhY2tbc3RhY2tJbmRleCArIGldOwogICAgICAgIGxldCBib3VuZCA9IHJhbmdlW2kgKiAyXTsKCiAgICAgICAgaWYgKHZhbHVlIDwgYm91bmQpIHsKICAgICAgICAgIHZhbHVlID0gYm91bmQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJvdW5kID0gcmFuZ2VbaSAqIDIgKyAxXTsKCiAgICAgICAgICBpZiAodmFsdWUgPiBib3VuZCkgewogICAgICAgICAgICB2YWx1ZSA9IGJvdW5kOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgb3V0cHV0W2ldID0gdmFsdWU7CiAgICAgIH0KCiAgICAgIGlmIChjYWNoZV9hdmFpbGFibGUgPiAwKSB7CiAgICAgICAgY2FjaGVfYXZhaWxhYmxlLS07CiAgICAgICAgY2FjaGVba2V5XSA9IG91dHB1dDsKICAgICAgfQoKICAgICAgZGVzdC5zZXQob3V0cHV0LCBkZXN0T2Zmc2V0KTsKICAgIH07CiAgfQoKfQoKZnVuY3Rpb24gaXNQREZGdW5jdGlvbih2KSB7CiAgbGV0IGZuRGljdDsKCiAgaWYgKHR5cGVvZiB2ICE9PSAib2JqZWN0IikgewogICAgcmV0dXJuIGZhbHNlOwogIH0gZWxzZSBpZiAodiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgIGZuRGljdCA9IHY7CiAgfSBlbHNlIGlmICh2IGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgIGZuRGljdCA9IHYuZGljdDsKICB9IGVsc2UgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgcmV0dXJuIGZuRGljdC5oYXMoIkZ1bmN0aW9uVHlwZSIpOwp9CgpjbGFzcyBQb3N0U2NyaXB0U3RhY2sgewogIHN0YXRpYyBnZXQgTUFYX1NUQUNLX1NJWkUoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIk1BWF9TVEFDS19TSVpFIiwgMTAwKTsKICB9CgogIGNvbnN0cnVjdG9yKGluaXRpYWxTdGFjaykgewogICAgdGhpcy5zdGFjayA9ICFpbml0aWFsU3RhY2sgPyBbXSA6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGluaXRpYWxTdGFjaywgMCk7CiAgfQoKICBwdXNoKHZhbHVlKSB7CiAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggPj0gUG9zdFNjcmlwdFN0YWNrLk1BWF9TVEFDS19TSVpFKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiUG9zdFNjcmlwdCBmdW5jdGlvbiBzdGFjayBvdmVyZmxvdy4iKTsKICAgIH0KCiAgICB0aGlzLnN0YWNrLnB1c2godmFsdWUpOwogIH0KCiAgcG9wKCkgewogICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoIDw9IDApIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJQb3N0U2NyaXB0IGZ1bmN0aW9uIHN0YWNrIHVuZGVyZmxvdy4iKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5zdGFjay5wb3AoKTsKICB9CgogIGNvcHkobikgewogICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoICsgbiA+PSBQb3N0U2NyaXB0U3RhY2suTUFYX1NUQUNLX1NJWkUpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJQb3N0U2NyaXB0IGZ1bmN0aW9uIHN0YWNrIG92ZXJmbG93LiIpOwogICAgfQoKICAgIGNvbnN0IHN0YWNrID0gdGhpcy5zdGFjazsKCiAgICBmb3IgKGxldCBpID0gc3RhY2subGVuZ3RoIC0gbiwgaiA9IG4gLSAxOyBqID49IDA7IGotLSwgaSsrKSB7CiAgICAgIHN0YWNrLnB1c2goc3RhY2tbaV0pOwogICAgfQogIH0KCiAgaW5kZXgobikgewogICAgdGhpcy5wdXNoKHRoaXMuc3RhY2tbdGhpcy5zdGFjay5sZW5ndGggLSBuIC0gMV0pOwogIH0KCiAgcm9sbChuLCBwKSB7CiAgICBjb25zdCBzdGFjayA9IHRoaXMuc3RhY2s7CiAgICBjb25zdCBsID0gc3RhY2subGVuZ3RoIC0gbjsKICAgIGNvbnN0IHIgPSBzdGFjay5sZW5ndGggLSAxOwogICAgY29uc3QgYyA9IGwgKyAocCAtIE1hdGguZmxvb3IocCAvIG4pICogbik7CgogICAgZm9yIChsZXQgaSA9IGwsIGogPSByOyBpIDwgajsgaSsrLCBqLS0pIHsKICAgICAgY29uc3QgdCA9IHN0YWNrW2ldOwogICAgICBzdGFja1tpXSA9IHN0YWNrW2pdOwogICAgICBzdGFja1tqXSA9IHQ7CiAgICB9CgogICAgZm9yIChsZXQgaSA9IGwsIGogPSBjIC0gMTsgaSA8IGo7IGkrKywgai0tKSB7CiAgICAgIGNvbnN0IHQgPSBzdGFja1tpXTsKICAgICAgc3RhY2tbaV0gPSBzdGFja1tqXTsKICAgICAgc3RhY2tbal0gPSB0OwogICAgfQoKICAgIGZvciAobGV0IGkgPSBjLCBqID0gcjsgaSA8IGo7IGkrKywgai0tKSB7CiAgICAgIGNvbnN0IHQgPSBzdGFja1tpXTsKICAgICAgc3RhY2tbaV0gPSBzdGFja1tqXTsKICAgICAgc3RhY2tbal0gPSB0OwogICAgfQogIH0KCn0KCmNsYXNzIFBvc3RTY3JpcHRFdmFsdWF0b3IgewogIGNvbnN0cnVjdG9yKG9wZXJhdG9ycykgewogICAgdGhpcy5vcGVyYXRvcnMgPSBvcGVyYXRvcnM7CiAgfQoKICBleGVjdXRlKGluaXRpYWxTdGFjaykgewogICAgY29uc3Qgc3RhY2sgPSBuZXcgUG9zdFNjcmlwdFN0YWNrKGluaXRpYWxTdGFjayk7CiAgICBsZXQgY291bnRlciA9IDA7CiAgICBjb25zdCBvcGVyYXRvcnMgPSB0aGlzLm9wZXJhdG9yczsKICAgIGNvbnN0IGxlbmd0aCA9IG9wZXJhdG9ycy5sZW5ndGg7CiAgICBsZXQgb3BlcmF0b3IsIGEsIGI7CgogICAgd2hpbGUgKGNvdW50ZXIgPCBsZW5ndGgpIHsKICAgICAgb3BlcmF0b3IgPSBvcGVyYXRvcnNbY291bnRlcisrXTsKCiAgICAgIGlmICh0eXBlb2Ygb3BlcmF0b3IgPT09ICJudW1iZXIiKSB7CiAgICAgICAgc3RhY2sucHVzaChvcGVyYXRvcik7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHN3aXRjaCAob3BlcmF0b3IpIHsKICAgICAgICBjYXNlICJqeiI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgaWYgKCFhKSB7CiAgICAgICAgICAgIGNvdW50ZXIgPSBiOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJqIjoKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGNvdW50ZXIgPSBhOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImFicyI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKE1hdGguYWJzKGEpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJhZGQiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChhICsgYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiYW5kIjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKCiAgICAgICAgICBpZiAodHlwZW9mIGEgPT09ICJib29sZWFuIiAmJiB0eXBlb2YgYiA9PT0gImJvb2xlYW4iKSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYSAmJiBiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYSAmIGIpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJhdGFuIjoKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goTWF0aC5hdGFuKGEpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJiaXRzaGlmdCI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgaWYgKGEgPiAwKSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYSA8PCBiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYSA+PiBiKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiY2VpbGluZyI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKE1hdGguY2VpbChhKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiY29weSI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5jb3B5KGEpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImNvcyI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKE1hdGguY29zKGEpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJjdmkiOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpIHwgMDsKICAgICAgICAgIHN0YWNrLnB1c2goYSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiY3ZyIjoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJkaXYiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChhIC8gYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZHVwIjoKICAgICAgICAgIHN0YWNrLmNvcHkoMSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZXEiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChhID09PSBiKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJleGNoIjoKICAgICAgICAgIHN0YWNrLnJvbGwoMiwgMSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZXhwIjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYSAqKiBiKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJmYWxzZSI6CiAgICAgICAgICBzdGFjay5wdXNoKGZhbHNlKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJmbG9vciI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKE1hdGguZmxvb3IoYSkpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImdlIjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYSA+PSBiKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJndCI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGEgPiBiKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJpZGl2IjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYSAvIGIgfCAwKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJpbmRleCI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5pbmRleChhKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJsZSI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGEgPD0gYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibG4iOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChNYXRoLmxvZyhhKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibG9nIjoKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goTWF0aC5sb2coYSkgLyBNYXRoLkxOMTApOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImx0IjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYSA8IGIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIm1vZCI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGEgJSBiKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJtdWwiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChhICogYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibmUiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChhICE9PSBiKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJuZWciOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaCgtYSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibm90IjoKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKCiAgICAgICAgICBpZiAodHlwZW9mIGEgPT09ICJib29sZWFuIikgewogICAgICAgICAgICBzdGFjay5wdXNoKCFhKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2gofmEpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJvciI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgaWYgKHR5cGVvZiBhID09PSAiYm9vbGVhbiIgJiYgdHlwZW9mIGIgPT09ICJib29sZWFuIikgewogICAgICAgICAgICBzdGFjay5wdXNoKGEgfHwgYik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdGFjay5wdXNoKGEgfCBiKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAicG9wIjoKICAgICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInJvbGwiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucm9sbChhLCBiKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJyb3VuZCI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKE1hdGgucm91bmQoYSkpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInNpbiI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKE1hdGguc2luKGEpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJzcXJ0IjoKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goTWF0aC5zcXJ0KGEpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJzdWIiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChhIC0gYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAidHJ1ZSI6CiAgICAgICAgICBzdGFjay5wdXNoKHRydWUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInRydW5jYXRlIjoKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBhIDwgMCA/IE1hdGguY2VpbChhKSA6IE1hdGguZmxvb3IoYSk7CiAgICAgICAgICBzdGFjay5wdXNoKGEpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInhvciI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgaWYgKHR5cGVvZiBhID09PSAiYm9vbGVhbiIgJiYgdHlwZW9mIGIgPT09ICJib29sZWFuIikgewogICAgICAgICAgICBzdGFjay5wdXNoKGEgIT09IGIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhY2sucHVzaChhIF4gYik7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVua25vd24gb3BlcmF0b3IgJHtvcGVyYXRvcn1gKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBzdGFjay5zdGFjazsKICB9Cgp9CgpleHBvcnRzLlBvc3RTY3JpcHRFdmFsdWF0b3IgPSBQb3N0U2NyaXB0RXZhbHVhdG9yOwoKY2xhc3MgQXN0Tm9kZSB7CiAgY29uc3RydWN0b3IodHlwZSkgewogICAgdGhpcy50eXBlID0gdHlwZTsKICB9CgogIHZpc2l0KHZpc2l0b3IpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoImFic3RyYWN0IG1ldGhvZCIpOwogIH0KCn0KCmNsYXNzIEFzdEFyZ3VtZW50IGV4dGVuZHMgQXN0Tm9kZSB7CiAgY29uc3RydWN0b3IoaW5kZXgsIG1pbiwgbWF4KSB7CiAgICBzdXBlcigiYXJncyIpOwogICAgdGhpcy5pbmRleCA9IGluZGV4OwogICAgdGhpcy5taW4gPSBtaW47CiAgICB0aGlzLm1heCA9IG1heDsKICB9CgogIHZpc2l0KHZpc2l0b3IpIHsKICAgIHZpc2l0b3IudmlzaXRBcmd1bWVudCh0aGlzKTsKICB9Cgp9CgpjbGFzcyBBc3RMaXRlcmFsIGV4dGVuZHMgQXN0Tm9kZSB7CiAgY29uc3RydWN0b3IobnVtYmVyKSB7CiAgICBzdXBlcigibGl0ZXJhbCIpOwogICAgdGhpcy5udW1iZXIgPSBudW1iZXI7CiAgICB0aGlzLm1pbiA9IG51bWJlcjsKICAgIHRoaXMubWF4ID0gbnVtYmVyOwogIH0KCiAgdmlzaXQodmlzaXRvcikgewogICAgdmlzaXRvci52aXNpdExpdGVyYWwodGhpcyk7CiAgfQoKfQoKY2xhc3MgQXN0QmluYXJ5T3BlcmF0aW9uIGV4dGVuZHMgQXN0Tm9kZSB7CiAgY29uc3RydWN0b3Iob3AsIGFyZzEsIGFyZzIsIG1pbiwgbWF4KSB7CiAgICBzdXBlcigiYmluYXJ5Iik7CiAgICB0aGlzLm9wID0gb3A7CiAgICB0aGlzLmFyZzEgPSBhcmcxOwogICAgdGhpcy5hcmcyID0gYXJnMjsKICAgIHRoaXMubWluID0gbWluOwogICAgdGhpcy5tYXggPSBtYXg7CiAgfQoKICB2aXNpdCh2aXNpdG9yKSB7CiAgICB2aXNpdG9yLnZpc2l0QmluYXJ5T3BlcmF0aW9uKHRoaXMpOwogIH0KCn0KCmNsYXNzIEFzdE1pbiBleHRlbmRzIEFzdE5vZGUgewogIGNvbnN0cnVjdG9yKGFyZywgbWF4KSB7CiAgICBzdXBlcigibWF4Iik7CiAgICB0aGlzLmFyZyA9IGFyZzsKICAgIHRoaXMubWluID0gYXJnLm1pbjsKICAgIHRoaXMubWF4ID0gbWF4OwogIH0KCiAgdmlzaXQodmlzaXRvcikgewogICAgdmlzaXRvci52aXNpdE1pbih0aGlzKTsKICB9Cgp9CgpjbGFzcyBBc3RWYXJpYWJsZSBleHRlbmRzIEFzdE5vZGUgewogIGNvbnN0cnVjdG9yKGluZGV4LCBtaW4sIG1heCkgewogICAgc3VwZXIoInZhciIpOwogICAgdGhpcy5pbmRleCA9IGluZGV4OwogICAgdGhpcy5taW4gPSBtaW47CiAgICB0aGlzLm1heCA9IG1heDsKICB9CgogIHZpc2l0KHZpc2l0b3IpIHsKICAgIHZpc2l0b3IudmlzaXRWYXJpYWJsZSh0aGlzKTsKICB9Cgp9CgpjbGFzcyBBc3RWYXJpYWJsZURlZmluaXRpb24gZXh0ZW5kcyBBc3ROb2RlIHsKICBjb25zdHJ1Y3Rvcih2YXJpYWJsZSwgYXJnKSB7CiAgICBzdXBlcigiZGVmaW5pdGlvbiIpOwogICAgdGhpcy52YXJpYWJsZSA9IHZhcmlhYmxlOwogICAgdGhpcy5hcmcgPSBhcmc7CiAgfQoKICB2aXNpdCh2aXNpdG9yKSB7CiAgICB2aXNpdG9yLnZpc2l0VmFyaWFibGVEZWZpbml0aW9uKHRoaXMpOwogIH0KCn0KCmNsYXNzIEV4cHJlc3Npb25CdWlsZGVyVmlzaXRvciB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLnBhcnRzID0gW107CiAgfQoKICB2aXNpdEFyZ3VtZW50KGFyZykgewogICAgdGhpcy5wYXJ0cy5wdXNoKCJNYXRoLm1heCgiLCBhcmcubWluLCAiLCBNYXRoLm1pbigiLCBhcmcubWF4LCAiLCBzcmNbc3JjT2Zmc2V0ICsgIiwgYXJnLmluZGV4LCAiXSkpIik7CiAgfQoKICB2aXNpdFZhcmlhYmxlKHZhcmlhYmxlKSB7CiAgICB0aGlzLnBhcnRzLnB1c2goInYiLCB2YXJpYWJsZS5pbmRleCk7CiAgfQoKICB2aXNpdExpdGVyYWwobGl0ZXJhbCkgewogICAgdGhpcy5wYXJ0cy5wdXNoKGxpdGVyYWwubnVtYmVyKTsKICB9CgogIHZpc2l0QmluYXJ5T3BlcmF0aW9uKG9wZXJhdGlvbikgewogICAgdGhpcy5wYXJ0cy5wdXNoKCIoIik7CiAgICBvcGVyYXRpb24uYXJnMS52aXNpdCh0aGlzKTsKICAgIHRoaXMucGFydHMucHVzaCgiICIsIG9wZXJhdGlvbi5vcCwgIiAiKTsKICAgIG9wZXJhdGlvbi5hcmcyLnZpc2l0KHRoaXMpOwogICAgdGhpcy5wYXJ0cy5wdXNoKCIpIik7CiAgfQoKICB2aXNpdFZhcmlhYmxlRGVmaW5pdGlvbihkZWZpbml0aW9uKSB7CiAgICB0aGlzLnBhcnRzLnB1c2goInZhciAiKTsKICAgIGRlZmluaXRpb24udmFyaWFibGUudmlzaXQodGhpcyk7CiAgICB0aGlzLnBhcnRzLnB1c2goIiA9ICIpOwogICAgZGVmaW5pdGlvbi5hcmcudmlzaXQodGhpcyk7CiAgICB0aGlzLnBhcnRzLnB1c2goIjsiKTsKICB9CgogIHZpc2l0TWluKG1heCkgewogICAgdGhpcy5wYXJ0cy5wdXNoKCJNYXRoLm1pbigiKTsKICAgIG1heC5hcmcudmlzaXQodGhpcyk7CiAgICB0aGlzLnBhcnRzLnB1c2goIiwgIiwgbWF4Lm1heCwgIikiKTsKICB9CgogIHRvU3RyaW5nKCkgewogICAgcmV0dXJuIHRoaXMucGFydHMuam9pbigiIik7CiAgfQoKfQoKZnVuY3Rpb24gYnVpbGRBZGRPcGVyYXRpb24obnVtMSwgbnVtMikgewogIGlmIChudW0yLnR5cGUgPT09ICJsaXRlcmFsIiAmJiBudW0yLm51bWJlciA9PT0gMCkgewogICAgcmV0dXJuIG51bTE7CiAgfQoKICBpZiAobnVtMS50eXBlID09PSAibGl0ZXJhbCIgJiYgbnVtMS5udW1iZXIgPT09IDApIHsKICAgIHJldHVybiBudW0yOwogIH0KCiAgaWYgKG51bTIudHlwZSA9PT0gImxpdGVyYWwiICYmIG51bTEudHlwZSA9PT0gImxpdGVyYWwiKSB7CiAgICByZXR1cm4gbmV3IEFzdExpdGVyYWwobnVtMS5udW1iZXIgKyBudW0yLm51bWJlcik7CiAgfQoKICByZXR1cm4gbmV3IEFzdEJpbmFyeU9wZXJhdGlvbigiKyIsIG51bTEsIG51bTIsIG51bTEubWluICsgbnVtMi5taW4sIG51bTEubWF4ICsgbnVtMi5tYXgpOwp9CgpmdW5jdGlvbiBidWlsZE11bE9wZXJhdGlvbihudW0xLCBudW0yKSB7CiAgaWYgKG51bTIudHlwZSA9PT0gImxpdGVyYWwiKSB7CiAgICBpZiAobnVtMi5udW1iZXIgPT09IDApIHsKICAgICAgcmV0dXJuIG5ldyBBc3RMaXRlcmFsKDApOwogICAgfSBlbHNlIGlmIChudW0yLm51bWJlciA9PT0gMSkgewogICAgICByZXR1cm4gbnVtMTsKICAgIH0gZWxzZSBpZiAobnVtMS50eXBlID09PSAibGl0ZXJhbCIpIHsKICAgICAgcmV0dXJuIG5ldyBBc3RMaXRlcmFsKG51bTEubnVtYmVyICogbnVtMi5udW1iZXIpOwogICAgfQogIH0KCiAgaWYgKG51bTEudHlwZSA9PT0gImxpdGVyYWwiKSB7CiAgICBpZiAobnVtMS5udW1iZXIgPT09IDApIHsKICAgICAgcmV0dXJuIG5ldyBBc3RMaXRlcmFsKDApOwogICAgfSBlbHNlIGlmIChudW0xLm51bWJlciA9PT0gMSkgewogICAgICByZXR1cm4gbnVtMjsKICAgIH0KICB9CgogIGNvbnN0IG1pbiA9IE1hdGgubWluKG51bTEubWluICogbnVtMi5taW4sIG51bTEubWluICogbnVtMi5tYXgsIG51bTEubWF4ICogbnVtMi5taW4sIG51bTEubWF4ICogbnVtMi5tYXgpOwogIGNvbnN0IG1heCA9IE1hdGgubWF4KG51bTEubWluICogbnVtMi5taW4sIG51bTEubWluICogbnVtMi5tYXgsIG51bTEubWF4ICogbnVtMi5taW4sIG51bTEubWF4ICogbnVtMi5tYXgpOwogIHJldHVybiBuZXcgQXN0QmluYXJ5T3BlcmF0aW9uKCIqIiwgbnVtMSwgbnVtMiwgbWluLCBtYXgpOwp9CgpmdW5jdGlvbiBidWlsZFN1Yk9wZXJhdGlvbihudW0xLCBudW0yKSB7CiAgaWYgKG51bTIudHlwZSA9PT0gImxpdGVyYWwiKSB7CiAgICBpZiAobnVtMi5udW1iZXIgPT09IDApIHsKICAgICAgcmV0dXJuIG51bTE7CiAgICB9IGVsc2UgaWYgKG51bTEudHlwZSA9PT0gImxpdGVyYWwiKSB7CiAgICAgIHJldHVybiBuZXcgQXN0TGl0ZXJhbChudW0xLm51bWJlciAtIG51bTIubnVtYmVyKTsKICAgIH0KICB9CgogIGlmIChudW0yLnR5cGUgPT09ICJiaW5hcnkiICYmIG51bTIub3AgPT09ICItIiAmJiBudW0xLnR5cGUgPT09ICJsaXRlcmFsIiAmJiBudW0xLm51bWJlciA9PT0gMSAmJiBudW0yLmFyZzEudHlwZSA9PT0gImxpdGVyYWwiICYmIG51bTIuYXJnMS5udW1iZXIgPT09IDEpIHsKICAgIHJldHVybiBudW0yLmFyZzI7CiAgfQoKICByZXR1cm4gbmV3IEFzdEJpbmFyeU9wZXJhdGlvbigiLSIsIG51bTEsIG51bTIsIG51bTEubWluIC0gbnVtMi5tYXgsIG51bTEubWF4IC0gbnVtMi5taW4pOwp9CgpmdW5jdGlvbiBidWlsZE1pbk9wZXJhdGlvbihudW0xLCBtYXgpIHsKICBpZiAobnVtMS5taW4gPj0gbWF4KSB7CiAgICByZXR1cm4gbmV3IEFzdExpdGVyYWwobWF4KTsKICB9IGVsc2UgaWYgKG51bTEubWF4IDw9IG1heCkgewogICAgcmV0dXJuIG51bTE7CiAgfQoKICByZXR1cm4gbmV3IEFzdE1pbihudW0xLCBtYXgpOwp9CgpjbGFzcyBQb3N0U2NyaXB0Q29tcGlsZXIgewogIGNvbXBpbGUoY29kZSwgZG9tYWluLCByYW5nZSkgewogICAgY29uc3Qgc3RhY2sgPSBbXTsKICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IFtdOwogICAgY29uc3QgaW5wdXRTaXplID0gZG9tYWluLmxlbmd0aCA+PiAxLAogICAgICAgICAgb3V0cHV0U2l6ZSA9IHJhbmdlLmxlbmd0aCA+PiAxOwogICAgbGV0IGxhc3RSZWdpc3RlciA9IDA7CiAgICBsZXQgbiwgajsKICAgIGxldCBudW0xLCBudW0yLCBhc3QxLCBhc3QyLCB0bXBWYXIsIGl0ZW07CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dFNpemU7IGkrKykgewogICAgICBzdGFjay5wdXNoKG5ldyBBc3RBcmd1bWVudChpLCBkb21haW5baSAqIDJdLCBkb21haW5baSAqIDIgKyAxXSkpOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNvZGUubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBpdGVtID0gY29kZVtpXTsKCiAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gIm51bWJlciIpIHsKICAgICAgICBzdGFjay5wdXNoKG5ldyBBc3RMaXRlcmFsKGl0ZW0pKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgc3dpdGNoIChpdGVtKSB7CiAgICAgICAgY2FzZSAiYWRkIjoKICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIG51bTIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIG51bTEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYnVpbGRBZGRPcGVyYXRpb24obnVtMSwgbnVtMikpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImN2ciI6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMSkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibXVsIjoKICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIG51bTIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIG51bTEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYnVpbGRNdWxPcGVyYXRpb24obnVtMSwgbnVtMikpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInN1YiI6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBudW0yID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBudW0xID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGJ1aWxkU3ViT3BlcmF0aW9uKG51bTEsIG51bTIpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJleGNoIjoKICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGFzdDEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGFzdDIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYXN0MSwgYXN0Mik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAicG9wIjoKICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImluZGV4IjoKICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIG51bTEgPSBzdGFjay5wb3AoKTsKCiAgICAgICAgICBpZiAobnVtMS50eXBlICE9PSAibGl0ZXJhbCIpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgbiA9IG51bTEubnVtYmVyOwoKICAgICAgICAgIGlmIChuIDwgMCB8fCAhTnVtYmVyLmlzSW50ZWdlcihuKSB8fCBzdGFjay5sZW5ndGggPCBuKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGFzdDEgPSBzdGFja1tzdGFjay5sZW5ndGggLSBuIC0gMV07CgogICAgICAgICAgaWYgKGFzdDEudHlwZSA9PT0gImxpdGVyYWwiIHx8IGFzdDEudHlwZSA9PT0gInZhciIpIHsKICAgICAgICAgICAgc3RhY2sucHVzaChhc3QxKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdG1wVmFyID0gbmV3IEFzdFZhcmlhYmxlKGxhc3RSZWdpc3RlcisrLCBhc3QxLm1pbiwgYXN0MS5tYXgpOwogICAgICAgICAgc3RhY2tbc3RhY2subGVuZ3RoIC0gbiAtIDFdID0gdG1wVmFyOwogICAgICAgICAgc3RhY2sucHVzaCh0bXBWYXIpOwogICAgICAgICAgaW5zdHJ1Y3Rpb25zLnB1c2gobmV3IEFzdFZhcmlhYmxlRGVmaW5pdGlvbih0bXBWYXIsIGFzdDEpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJkdXAiOgogICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA8IDEpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHR5cGVvZiBjb2RlW2kgKyAxXSA9PT0gIm51bWJlciIgJiYgY29kZVtpICsgMl0gPT09ICJndCIgJiYgY29kZVtpICsgM10gPT09IGkgKyA3ICYmIGNvZGVbaSArIDRdID09PSAianoiICYmIGNvZGVbaSArIDVdID09PSAicG9wIiAmJiBjb2RlW2kgKyA2XSA9PT0gY29kZVtpICsgMV0pIHsKICAgICAgICAgICAgbnVtMSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBzdGFjay5wdXNoKGJ1aWxkTWluT3BlcmF0aW9uKG51bTEsIGNvZGVbaSArIDFdKSk7CiAgICAgICAgICAgIGkgKz0gNjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgYXN0MSA9IHN0YWNrLmF0KC0xKTsKCiAgICAgICAgICBpZiAoYXN0MS50eXBlID09PSAibGl0ZXJhbCIgfHwgYXN0MS50eXBlID09PSAidmFyIikgewogICAgICAgICAgICBzdGFjay5wdXNoKGFzdDEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICB0bXBWYXIgPSBuZXcgQXN0VmFyaWFibGUobGFzdFJlZ2lzdGVyKyssIGFzdDEubWluLCBhc3QxLm1heCk7CiAgICAgICAgICBzdGFja1tzdGFjay5sZW5ndGggLSAxXSA9IHRtcFZhcjsKICAgICAgICAgIHN0YWNrLnB1c2godG1wVmFyKTsKICAgICAgICAgIGluc3RydWN0aW9ucy5wdXNoKG5ldyBBc3RWYXJpYWJsZURlZmluaXRpb24odG1wVmFyLCBhc3QxKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAicm9sbCI6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBudW0yID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBudW0xID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgaWYgKG51bTIudHlwZSAhPT0gImxpdGVyYWwiIHx8IG51bTEudHlwZSAhPT0gImxpdGVyYWwiKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGogPSBudW0yLm51bWJlcjsKICAgICAgICAgIG4gPSBudW0xLm51bWJlcjsKCiAgICAgICAgICBpZiAobiA8PSAwIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKG4pIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKGopIHx8IHN0YWNrLmxlbmd0aCA8IG4pIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgaiA9IChqICUgbiArIG4pICUgbjsKCiAgICAgICAgICBpZiAoaiA9PT0gMCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShzdGFjaywgc3RhY2suc3BsaWNlKHN0YWNrLmxlbmd0aCAtIG4sIG4gLSBqKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9CgogICAgaWYgKHN0YWNrLmxlbmd0aCAhPT0gb3V0cHV0U2l6ZSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCByZXN1bHQgPSBbXTsKCiAgICBmb3IgKGNvbnN0IGluc3RydWN0aW9uIG9mIGluc3RydWN0aW9ucykgewogICAgICBjb25zdCBzdGF0ZW1lbnRCdWlsZGVyID0gbmV3IEV4cHJlc3Npb25CdWlsZGVyVmlzaXRvcigpOwogICAgICBpbnN0cnVjdGlvbi52aXNpdChzdGF0ZW1lbnRCdWlsZGVyKTsKICAgICAgcmVzdWx0LnB1c2goc3RhdGVtZW50QnVpbGRlci50b1N0cmluZygpKTsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBzdGFjay5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IGV4cHIgPSBzdGFja1tpXSwKICAgICAgICAgICAgc3RhdGVtZW50QnVpbGRlciA9IG5ldyBFeHByZXNzaW9uQnVpbGRlclZpc2l0b3IoKTsKICAgICAgZXhwci52aXNpdChzdGF0ZW1lbnRCdWlsZGVyKTsKICAgICAgY29uc3QgbWluID0gcmFuZ2VbaSAqIDJdLAogICAgICAgICAgICBtYXggPSByYW5nZVtpICogMiArIDFdOwogICAgICBjb25zdCBvdXQgPSBbc3RhdGVtZW50QnVpbGRlci50b1N0cmluZygpXTsKCiAgICAgIGlmIChtaW4gPiBleHByLm1pbikgewogICAgICAgIG91dC51bnNoaWZ0KCJNYXRoLm1heCgiLCBtaW4sICIsICIpOwogICAgICAgIG91dC5wdXNoKCIpIik7CiAgICAgIH0KCiAgICAgIGlmIChtYXggPCBleHByLm1heCkgewogICAgICAgIG91dC51bnNoaWZ0KCJNYXRoLm1pbigiLCBtYXgsICIsICIpOwogICAgICAgIG91dC5wdXNoKCIpIik7CiAgICAgIH0KCiAgICAgIG91dC51bnNoaWZ0KCJkZXN0W2Rlc3RPZmZzZXQgKyAiLCBpLCAiXSA9ICIpOwogICAgICBvdXQucHVzaCgiOyIpOwogICAgICByZXN1bHQucHVzaChvdXQuam9pbigiIikpOwogICAgfQoKICAgIHJldHVybiByZXN1bHQuam9pbigiXG4iKTsKICB9Cgp9CgpleHBvcnRzLlBvc3RTY3JpcHRDb21waWxlciA9IFBvc3RTY3JpcHRDb21waWxlcjsKCi8qKiovIH0pLAovKiAxODMgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlBvc3RTY3JpcHRQYXJzZXIgPSBleHBvcnRzLlBvc3RTY3JpcHRMZXhlciA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMCk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7CgpjbGFzcyBQb3N0U2NyaXB0UGFyc2VyIHsKICBjb25zdHJ1Y3RvcihsZXhlcikgewogICAgdGhpcy5sZXhlciA9IGxleGVyOwogICAgdGhpcy5vcGVyYXRvcnMgPSBbXTsKICAgIHRoaXMudG9rZW4gPSBudWxsOwogICAgdGhpcy5wcmV2ID0gbnVsbDsKICB9CgogIG5leHRUb2tlbigpIHsKICAgIHRoaXMucHJldiA9IHRoaXMudG9rZW47CiAgICB0aGlzLnRva2VuID0gdGhpcy5sZXhlci5nZXRUb2tlbigpOwogIH0KCiAgYWNjZXB0KHR5cGUpIHsKICAgIGlmICh0aGlzLnRva2VuLnR5cGUgPT09IHR5cGUpIHsKICAgICAgdGhpcy5uZXh0VG9rZW4oKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZXhwZWN0KHR5cGUpIHsKICAgIGlmICh0aGlzLmFjY2VwdCh0eXBlKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVuZXhwZWN0ZWQgc3ltYm9sOiBmb3VuZCAke3RoaXMudG9rZW4udHlwZX0gZXhwZWN0ZWQgJHt0eXBlfS5gKTsKICB9CgogIHBhcnNlKCkgewogICAgdGhpcy5uZXh0VG9rZW4oKTsKICAgIHRoaXMuZXhwZWN0KFBvc3RTY3JpcHRUb2tlblR5cGVzLkxCUkFDRSk7CiAgICB0aGlzLnBhcnNlQmxvY2soKTsKICAgIHRoaXMuZXhwZWN0KFBvc3RTY3JpcHRUb2tlblR5cGVzLlJCUkFDRSk7CiAgICByZXR1cm4gdGhpcy5vcGVyYXRvcnM7CiAgfQoKICBwYXJzZUJsb2NrKCkgewogICAgd2hpbGUgKHRydWUpIHsKICAgICAgaWYgKHRoaXMuYWNjZXB0KFBvc3RTY3JpcHRUb2tlblR5cGVzLk5VTUJFUikpIHsKICAgICAgICB0aGlzLm9wZXJhdG9ycy5wdXNoKHRoaXMucHJldi52YWx1ZSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5hY2NlcHQoUG9zdFNjcmlwdFRva2VuVHlwZXMuT1BFUkFUT1IpKSB7CiAgICAgICAgdGhpcy5vcGVyYXRvcnMucHVzaCh0aGlzLnByZXYudmFsdWUpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuYWNjZXB0KFBvc3RTY3JpcHRUb2tlblR5cGVzLkxCUkFDRSkpIHsKICAgICAgICB0aGlzLnBhcnNlQ29uZGl0aW9uKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgfQoKICBwYXJzZUNvbmRpdGlvbigpIHsKICAgIGNvbnN0IGNvbmRpdGlvbkxvY2F0aW9uID0gdGhpcy5vcGVyYXRvcnMubGVuZ3RoOwogICAgdGhpcy5vcGVyYXRvcnMucHVzaChudWxsLCBudWxsKTsKICAgIHRoaXMucGFyc2VCbG9jaygpOwogICAgdGhpcy5leHBlY3QoUG9zdFNjcmlwdFRva2VuVHlwZXMuUkJSQUNFKTsKCiAgICBpZiAodGhpcy5hY2NlcHQoUG9zdFNjcmlwdFRva2VuVHlwZXMuSUYpKSB7CiAgICAgIHRoaXMub3BlcmF0b3JzW2NvbmRpdGlvbkxvY2F0aW9uXSA9IHRoaXMub3BlcmF0b3JzLmxlbmd0aDsKICAgICAgdGhpcy5vcGVyYXRvcnNbY29uZGl0aW9uTG9jYXRpb24gKyAxXSA9ICJqeiI7CiAgICB9IGVsc2UgaWYgKHRoaXMuYWNjZXB0KFBvc3RTY3JpcHRUb2tlblR5cGVzLkxCUkFDRSkpIHsKICAgICAgY29uc3QganVtcExvY2F0aW9uID0gdGhpcy5vcGVyYXRvcnMubGVuZ3RoOwogICAgICB0aGlzLm9wZXJhdG9ycy5wdXNoKG51bGwsIG51bGwpOwogICAgICBjb25zdCBlbmRPZlRydWUgPSB0aGlzLm9wZXJhdG9ycy5sZW5ndGg7CiAgICAgIHRoaXMucGFyc2VCbG9jaygpOwogICAgICB0aGlzLmV4cGVjdChQb3N0U2NyaXB0VG9rZW5UeXBlcy5SQlJBQ0UpOwogICAgICB0aGlzLmV4cGVjdChQb3N0U2NyaXB0VG9rZW5UeXBlcy5JRkVMU0UpOwogICAgICB0aGlzLm9wZXJhdG9yc1tqdW1wTG9jYXRpb25dID0gdGhpcy5vcGVyYXRvcnMubGVuZ3RoOwogICAgICB0aGlzLm9wZXJhdG9yc1tqdW1wTG9jYXRpb24gKyAxXSA9ICJqIjsKICAgICAgdGhpcy5vcGVyYXRvcnNbY29uZGl0aW9uTG9jYXRpb25dID0gZW5kT2ZUcnVlOwogICAgICB0aGlzLm9wZXJhdG9yc1tjb25kaXRpb25Mb2NhdGlvbiArIDFdID0gImp6IjsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUFMgRnVuY3Rpb246IGVycm9yIHBhcnNpbmcgY29uZGl0aW9uYWwuIik7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5Qb3N0U2NyaXB0UGFyc2VyID0gUG9zdFNjcmlwdFBhcnNlcjsKY29uc3QgUG9zdFNjcmlwdFRva2VuVHlwZXMgPSB7CiAgTEJSQUNFOiAwLAogIFJCUkFDRTogMSwKICBOVU1CRVI6IDIsCiAgT1BFUkFUT1I6IDMsCiAgSUY6IDQsCiAgSUZFTFNFOiA1Cn07CgpjbGFzcyBQb3N0U2NyaXB0VG9rZW4gewogIHN0YXRpYyBnZXQgb3BDYWNoZSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAib3BDYWNoZSIsIE9iamVjdC5jcmVhdGUobnVsbCkpOwogIH0KCiAgY29uc3RydWN0b3IodHlwZSwgdmFsdWUpIHsKICAgIHRoaXMudHlwZSA9IHR5cGU7CiAgICB0aGlzLnZhbHVlID0gdmFsdWU7CiAgfQoKICBzdGF0aWMgZ2V0T3BlcmF0b3Iob3ApIHsKICAgIGNvbnN0IG9wVmFsdWUgPSBQb3N0U2NyaXB0VG9rZW4ub3BDYWNoZVtvcF07CgogICAgaWYgKG9wVmFsdWUpIHsKICAgICAgcmV0dXJuIG9wVmFsdWU7CiAgICB9CgogICAgcmV0dXJuIFBvc3RTY3JpcHRUb2tlbi5vcENhY2hlW29wXSA9IG5ldyBQb3N0U2NyaXB0VG9rZW4oUG9zdFNjcmlwdFRva2VuVHlwZXMuT1BFUkFUT1IsIG9wKTsKICB9CgogIHN0YXRpYyBnZXQgTEJSQUNFKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJMQlJBQ0UiLCBuZXcgUG9zdFNjcmlwdFRva2VuKFBvc3RTY3JpcHRUb2tlblR5cGVzLkxCUkFDRSwgInsiKSk7CiAgfQoKICBzdGF0aWMgZ2V0IFJCUkFDRSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiUkJSQUNFIiwgbmV3IFBvc3RTY3JpcHRUb2tlbihQb3N0U2NyaXB0VG9rZW5UeXBlcy5SQlJBQ0UsICJ9IikpOwogIH0KCiAgc3RhdGljIGdldCBJRigpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiSUYiLCBuZXcgUG9zdFNjcmlwdFRva2VuKFBvc3RTY3JpcHRUb2tlblR5cGVzLklGLCAiSUYiKSk7CiAgfQoKICBzdGF0aWMgZ2V0IElGRUxTRSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiSUZFTFNFIiwgbmV3IFBvc3RTY3JpcHRUb2tlbihQb3N0U2NyaXB0VG9rZW5UeXBlcy5JRkVMU0UsICJJRkVMU0UiKSk7CiAgfQoKfQoKY2xhc3MgUG9zdFNjcmlwdExleGVyIHsKICBjb25zdHJ1Y3RvcihzdHJlYW0pIHsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5uZXh0Q2hhcigpOwogICAgdGhpcy5zdHJCdWYgPSBbXTsKICB9CgogIG5leHRDaGFyKCkgewogICAgcmV0dXJuIHRoaXMuY3VycmVudENoYXIgPSB0aGlzLnN0cmVhbS5nZXRCeXRlKCk7CiAgfQoKICBnZXRUb2tlbigpIHsKICAgIGxldCBjb21tZW50ID0gZmFsc2U7CiAgICBsZXQgY2ggPSB0aGlzLmN1cnJlbnRDaGFyOwoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGlmIChjaCA8IDApIHsKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuRU9GOwogICAgICB9CgogICAgICBpZiAoY29tbWVudCkgewogICAgICAgIGlmIChjaCA9PT0gMHgwYSB8fCBjaCA9PT0gMHgwZCkgewogICAgICAgICAgY29tbWVudCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgyNSkgewogICAgICAgIGNvbW1lbnQgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKCEoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICB9CgogICAgc3dpdGNoIChjaCB8IDApIHsKICAgICAgY2FzZSAweDMwOgogICAgICBjYXNlIDB4MzE6CiAgICAgIGNhc2UgMHgzMjoKICAgICAgY2FzZSAweDMzOgogICAgICBjYXNlIDB4MzQ6CiAgICAgIGNhc2UgMHgzNToKICAgICAgY2FzZSAweDM2OgogICAgICBjYXNlIDB4Mzc6CiAgICAgIGNhc2UgMHgzODoKICAgICAgY2FzZSAweDM5OgogICAgICBjYXNlIDB4MmI6CiAgICAgIGNhc2UgMHgyZDoKICAgICAgY2FzZSAweDJlOgogICAgICAgIHJldHVybiBuZXcgUG9zdFNjcmlwdFRva2VuKFBvc3RTY3JpcHRUb2tlblR5cGVzLk5VTUJFUiwgdGhpcy5nZXROdW1iZXIoKSk7CgogICAgICBjYXNlIDB4N2I6CiAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgIHJldHVybiBQb3N0U2NyaXB0VG9rZW4uTEJSQUNFOwoKICAgICAgY2FzZSAweDdkOgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICByZXR1cm4gUG9zdFNjcmlwdFRva2VuLlJCUkFDRTsKICAgIH0KCiAgICBjb25zdCBzdHJCdWYgPSB0aGlzLnN0ckJ1ZjsKICAgIHN0ckJ1Zi5sZW5ndGggPSAwOwogICAgc3RyQnVmWzBdID0gU3RyaW5nLmZyb21DaGFyQ29kZShjaCk7CgogICAgd2hpbGUgKChjaCA9IHRoaXMubmV4dENoYXIoKSkgPj0gMCAmJiAoY2ggPj0gMHg0MSAmJiBjaCA8PSAweDVhIHx8IGNoID49IDB4NjEgJiYgY2ggPD0gMHg3YSkpIHsKICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgfQoKICAgIGNvbnN0IHN0ciA9IHN0ckJ1Zi5qb2luKCIiKTsKCiAgICBzd2l0Y2ggKHN0ci50b0xvd2VyQ2FzZSgpKSB7CiAgICAgIGNhc2UgImlmIjoKICAgICAgICByZXR1cm4gUG9zdFNjcmlwdFRva2VuLklGOwoKICAgICAgY2FzZSAiaWZlbHNlIjoKICAgICAgICByZXR1cm4gUG9zdFNjcmlwdFRva2VuLklGRUxTRTsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIFBvc3RTY3JpcHRUb2tlbi5nZXRPcGVyYXRvcihzdHIpOwogICAgfQogIH0KCiAgZ2V0TnVtYmVyKCkgewogICAgbGV0IGNoID0gdGhpcy5jdXJyZW50Q2hhcjsKICAgIGNvbnN0IHN0ckJ1ZiA9IHRoaXMuc3RyQnVmOwogICAgc3RyQnVmLmxlbmd0aCA9IDA7CiAgICBzdHJCdWZbMF0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKCiAgICB3aGlsZSAoKGNoID0gdGhpcy5uZXh0Q2hhcigpKSA+PSAwKSB7CiAgICAgIGlmIChjaCA+PSAweDMwICYmIGNoIDw9IDB4MzkgfHwgY2ggPT09IDB4MmQgfHwgY2ggPT09IDB4MmUpIHsKICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCB2YWx1ZSA9IHBhcnNlRmxvYXQoc3RyQnVmLmpvaW4oIiIpKTsKCiAgICBpZiAoaXNOYU4odmFsdWUpKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW52YWxpZCBmbG9hdGluZyBwb2ludCBudW1iZXI6ICR7dmFsdWV9YCk7CiAgICB9CgogICAgcmV0dXJuIHZhbHVlOwogIH0KCn0KCmV4cG9ydHMuUG9zdFNjcmlwdExleGVyID0gUG9zdFNjcmlwdExleGVyOwoKLyoqKi8gfSksCi8qIDE4NCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTG9jYWxUaWxpbmdQYXR0ZXJuQ2FjaGUgPSBleHBvcnRzLkxvY2FsSW1hZ2VDYWNoZSA9IGV4cG9ydHMuTG9jYWxHU3RhdGVDYWNoZSA9IGV4cG9ydHMuTG9jYWxGdW5jdGlvbkNhY2hlID0gZXhwb3J0cy5Mb2NhbENvbG9yU3BhY2VDYWNoZSA9IGV4cG9ydHMuR2xvYmFsSW1hZ2VDYWNoZSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMCk7CgpjbGFzcyBCYXNlTG9jYWxDYWNoZSB7CiAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IEJhc2VMb2NhbENhY2hlKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBpbml0aWFsaXplIEJhc2VMb2NhbENhY2hlLiIpOwogICAgfQoKICAgIHRoaXMuX29ubHlSZWZzID0gKG9wdGlvbnMgJiYgb3B0aW9ucy5vbmx5UmVmcykgPT09IHRydWU7CgogICAgaWYgKCF0aGlzLl9vbmx5UmVmcykgewogICAgICB0aGlzLl9uYW1lUmVmTWFwID0gbmV3IE1hcCgpOwogICAgICB0aGlzLl9pbWFnZU1hcCA9IG5ldyBNYXAoKTsKICAgIH0KCiAgICB0aGlzLl9pbWFnZUNhY2hlID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldENhY2hlKCk7CiAgfQoKICBnZXRCeU5hbWUobmFtZSkgewogICAgaWYgKHRoaXMuX29ubHlSZWZzKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIlNob3VsZCBub3QgY2FsbCBgZ2V0QnlOYW1lYCBtZXRob2QuIik7CiAgICB9CgogICAgY29uc3QgcmVmID0gdGhpcy5fbmFtZVJlZk1hcC5nZXQobmFtZSk7CgogICAgaWYgKHJlZikgewogICAgICByZXR1cm4gdGhpcy5nZXRCeVJlZihyZWYpOwogICAgfQoKICAgIHJldHVybiB0aGlzLl9pbWFnZU1hcC5nZXQobmFtZSkgfHwgbnVsbDsKICB9CgogIGdldEJ5UmVmKHJlZikgewogICAgcmV0dXJuIHRoaXMuX2ltYWdlQ2FjaGUuZ2V0KHJlZikgfHwgbnVsbDsKICB9CgogIHNldChuYW1lLCByZWYsIGRhdGEpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgc2V0YCBjYWxsZWQuIik7CiAgfQoKfQoKY2xhc3MgTG9jYWxJbWFnZUNhY2hlIGV4dGVuZHMgQmFzZUxvY2FsQ2FjaGUgewogIHNldChuYW1lKSB7CiAgICBsZXQgcmVmID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsOwogICAgbGV0IGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKCiAgICBpZiAodHlwZW9mIG5hbWUgIT09ICJzdHJpbmciKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignTG9jYWxJbWFnZUNhY2hlLnNldCAtIGV4cGVjdGVkICJuYW1lIiBhcmd1bWVudC4nKTsKICAgIH0KCiAgICBpZiAocmVmKSB7CiAgICAgIGlmICh0aGlzLl9pbWFnZUNhY2hlLmhhcyhyZWYpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLl9uYW1lUmVmTWFwLnNldChuYW1lLCByZWYpOwoKICAgICAgdGhpcy5faW1hZ2VDYWNoZS5wdXQocmVmLCBkYXRhKTsKCiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy5faW1hZ2VNYXAuaGFzKG5hbWUpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9pbWFnZU1hcC5zZXQobmFtZSwgZGF0YSk7CiAgfQoKfQoKZXhwb3J0cy5Mb2NhbEltYWdlQ2FjaGUgPSBMb2NhbEltYWdlQ2FjaGU7CgpjbGFzcyBMb2NhbENvbG9yU3BhY2VDYWNoZSBleHRlbmRzIEJhc2VMb2NhbENhY2hlIHsKICBzZXQoKSB7CiAgICBsZXQgbmFtZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbnVsbDsKICAgIGxldCByZWYgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IG51bGw7CiAgICBsZXQgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkOwoKICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gInN0cmluZyIgJiYgIXJlZikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvY2FsQ29sb3JTcGFjZUNhY2hlLnNldCAtIGV4cGVjdGVkICJuYW1lIiBhbmQvb3IgInJlZiIgYXJndW1lbnQuJyk7CiAgICB9CgogICAgaWYgKHJlZikgewogICAgICBpZiAodGhpcy5faW1hZ2VDYWNoZS5oYXMocmVmKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKG5hbWUgIT09IG51bGwpIHsKICAgICAgICB0aGlzLl9uYW1lUmVmTWFwLnNldChuYW1lLCByZWYpOwogICAgICB9CgogICAgICB0aGlzLl9pbWFnZUNhY2hlLnB1dChyZWYsIGRhdGEpOwoKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLl9pbWFnZU1hcC5oYXMobmFtZSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuX2ltYWdlTWFwLnNldChuYW1lLCBkYXRhKTsKICB9Cgp9CgpleHBvcnRzLkxvY2FsQ29sb3JTcGFjZUNhY2hlID0gTG9jYWxDb2xvclNwYWNlQ2FjaGU7CgpjbGFzcyBMb2NhbEZ1bmN0aW9uQ2FjaGUgZXh0ZW5kcyBCYXNlTG9jYWxDYWNoZSB7CiAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgc3VwZXIoewogICAgICBvbmx5UmVmczogdHJ1ZQogICAgfSk7CiAgfQoKICBzZXQoKSB7CiAgICBsZXQgbmFtZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbnVsbDsKICAgIGxldCByZWYgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDsKICAgIGxldCBkYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CgogICAgaWYgKCFyZWYpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb2NhbEZ1bmN0aW9uQ2FjaGUuc2V0IC0gZXhwZWN0ZWQgInJlZiIgYXJndW1lbnQuJyk7CiAgICB9CgogICAgaWYgKHRoaXMuX2ltYWdlQ2FjaGUuaGFzKHJlZikpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuX2ltYWdlQ2FjaGUucHV0KHJlZiwgZGF0YSk7CiAgfQoKfQoKZXhwb3J0cy5Mb2NhbEZ1bmN0aW9uQ2FjaGUgPSBMb2NhbEZ1bmN0aW9uQ2FjaGU7CgpjbGFzcyBMb2NhbEdTdGF0ZUNhY2hlIGV4dGVuZHMgQmFzZUxvY2FsQ2FjaGUgewogIHNldChuYW1lKSB7CiAgICBsZXQgcmVmID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsOwogICAgbGV0IGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKCiAgICBpZiAodHlwZW9mIG5hbWUgIT09ICJzdHJpbmciKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignTG9jYWxHU3RhdGVDYWNoZS5zZXQgLSBleHBlY3RlZCAibmFtZSIgYXJndW1lbnQuJyk7CiAgICB9CgogICAgaWYgKHJlZikgewogICAgICBpZiAodGhpcy5faW1hZ2VDYWNoZS5oYXMocmVmKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5fbmFtZVJlZk1hcC5zZXQobmFtZSwgcmVmKTsKCiAgICAgIHRoaXMuX2ltYWdlQ2FjaGUucHV0KHJlZiwgZGF0YSk7CgogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHRoaXMuX2ltYWdlTWFwLmhhcyhuYW1lKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5faW1hZ2VNYXAuc2V0KG5hbWUsIGRhdGEpOwogIH0KCn0KCmV4cG9ydHMuTG9jYWxHU3RhdGVDYWNoZSA9IExvY2FsR1N0YXRlQ2FjaGU7CgpjbGFzcyBMb2NhbFRpbGluZ1BhdHRlcm5DYWNoZSBleHRlbmRzIEJhc2VMb2NhbENhY2hlIHsKICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICBzdXBlcih7CiAgICAgIG9ubHlSZWZzOiB0cnVlCiAgICB9KTsKICB9CgogIHNldCgpIHsKICAgIGxldCBuYW1lID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsOwogICAgbGV0IHJlZiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwogICAgbGV0IGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKCiAgICBpZiAoIXJlZikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvY2FsVGlsaW5nUGF0dGVybkNhY2hlLnNldCAtIGV4cGVjdGVkICJyZWYiIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGlmICh0aGlzLl9pbWFnZUNhY2hlLmhhcyhyZWYpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9pbWFnZUNhY2hlLnB1dChyZWYsIGRhdGEpOwogIH0KCn0KCmV4cG9ydHMuTG9jYWxUaWxpbmdQYXR0ZXJuQ2FjaGUgPSBMb2NhbFRpbGluZ1BhdHRlcm5DYWNoZTsKCmNsYXNzIEdsb2JhbEltYWdlQ2FjaGUgewogIHN0YXRpYyBnZXQgTlVNX1BBR0VTX1RIUkVTSE9MRCgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiTlVNX1BBR0VTX1RIUkVTSE9MRCIsIDIpOwogIH0KCiAgc3RhdGljIGdldCBNSU5fSU1BR0VTX1RPX0NBQ0hFKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJNSU5fSU1BR0VTX1RPX0NBQ0hFIiwgMTApOwogIH0KCiAgc3RhdGljIGdldCBNQVhfQllURV9TSVpFKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJNQVhfQllURV9TSVpFIiwgNDBlNik7CiAgfQoKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMuX3JlZkNhY2hlID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldENhY2hlKCk7CiAgICB0aGlzLl9pbWFnZUNhY2hlID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldENhY2hlKCk7CiAgfQoKICBnZXQgX2J5dGVTaXplKCkgewogICAgbGV0IGJ5dGVTaXplID0gMDsKCiAgICBmb3IgKGNvbnN0IGltYWdlRGF0YSBvZiB0aGlzLl9pbWFnZUNhY2hlKSB7CiAgICAgIGJ5dGVTaXplICs9IGltYWdlRGF0YS5ieXRlU2l6ZTsKICAgIH0KCiAgICByZXR1cm4gYnl0ZVNpemU7CiAgfQoKICBnZXQgX2NhY2hlTGltaXRSZWFjaGVkKCkgewogICAgaWYgKHRoaXMuX2ltYWdlQ2FjaGUuc2l6ZSA8IEdsb2JhbEltYWdlQ2FjaGUuTUlOX0lNQUdFU19UT19DQUNIRSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKHRoaXMuX2J5dGVTaXplIDwgR2xvYmFsSW1hZ2VDYWNoZS5NQVhfQllURV9TSVpFKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIHNob3VsZENhY2hlKHJlZiwgcGFnZUluZGV4KSB7CiAgICBjb25zdCBwYWdlSW5kZXhTZXQgPSB0aGlzLl9yZWZDYWNoZS5nZXQocmVmKTsKCiAgICBjb25zdCBudW1QYWdlcyA9IHBhZ2VJbmRleFNldCA/IHBhZ2VJbmRleFNldC5zaXplICsgKHBhZ2VJbmRleFNldC5oYXMocGFnZUluZGV4KSA/IDAgOiAxKSA6IDE7CgogICAgaWYgKG51bVBhZ2VzIDwgR2xvYmFsSW1hZ2VDYWNoZS5OVU1fUEFHRVNfVEhSRVNIT0xEKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAoIXRoaXMuX2ltYWdlQ2FjaGUuaGFzKHJlZikgJiYgdGhpcy5fY2FjaGVMaW1pdFJlYWNoZWQpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgYWRkUGFnZUluZGV4KHJlZiwgcGFnZUluZGV4KSB7CiAgICBsZXQgcGFnZUluZGV4U2V0ID0gdGhpcy5fcmVmQ2FjaGUuZ2V0KHJlZik7CgogICAgaWYgKCFwYWdlSW5kZXhTZXQpIHsKICAgICAgcGFnZUluZGV4U2V0ID0gbmV3IFNldCgpOwoKICAgICAgdGhpcy5fcmVmQ2FjaGUucHV0KHJlZiwgcGFnZUluZGV4U2V0KTsKICAgIH0KCiAgICBwYWdlSW5kZXhTZXQuYWRkKHBhZ2VJbmRleCk7CiAgfQoKICBhZGRCeXRlU2l6ZShyZWYsIGJ5dGVTaXplKSB7CiAgICBjb25zdCBpbWFnZURhdGEgPSB0aGlzLl9pbWFnZUNhY2hlLmdldChyZWYpOwoKICAgIGlmICghaW1hZ2VEYXRhKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoaW1hZ2VEYXRhLmJ5dGVTaXplKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpbWFnZURhdGEuYnl0ZVNpemUgPSBieXRlU2l6ZTsKICB9CgogIGdldERhdGEocmVmLCBwYWdlSW5kZXgpIHsKICAgIGNvbnN0IHBhZ2VJbmRleFNldCA9IHRoaXMuX3JlZkNhY2hlLmdldChyZWYpOwoKICAgIGlmICghcGFnZUluZGV4U2V0KSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmIChwYWdlSW5kZXhTZXQuc2l6ZSA8IEdsb2JhbEltYWdlQ2FjaGUuTlVNX1BBR0VTX1RIUkVTSE9MRCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBpbWFnZURhdGEgPSB0aGlzLl9pbWFnZUNhY2hlLmdldChyZWYpOwoKICAgIGlmICghaW1hZ2VEYXRhKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHBhZ2VJbmRleFNldC5hZGQocGFnZUluZGV4KTsKICAgIHJldHVybiBpbWFnZURhdGE7CiAgfQoKICBzZXREYXRhKHJlZiwgZGF0YSkgewogICAgaWYgKCF0aGlzLl9yZWZDYWNoZS5oYXMocmVmKSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dsb2JhbEltYWdlQ2FjaGUuc2V0RGF0YSAtIGV4cGVjdGVkICJhZGRQYWdlSW5kZXgiIHRvIGhhdmUgYmVlbiBjYWxsZWQuJyk7CiAgICB9CgogICAgaWYgKHRoaXMuX2ltYWdlQ2FjaGUuaGFzKHJlZikpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLl9jYWNoZUxpbWl0UmVhY2hlZCkgewogICAgICAoMCwgX3V0aWwud2FybikoIkdsb2JhbEltYWdlQ2FjaGUuc2V0RGF0YSAtIGNhY2hlIGxpbWl0IHJlYWNoZWQuIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9pbWFnZUNhY2hlLnB1dChyZWYsIGRhdGEpOwogIH0KCiAgY2xlYXIoKSB7CiAgICBsZXQgb25seURhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwoKICAgIGlmICghb25seURhdGEpIHsKICAgICAgdGhpcy5fcmVmQ2FjaGUuY2xlYXIoKTsKICAgIH0KCiAgICB0aGlzLl9pbWFnZUNhY2hlLmNsZWFyKCk7CiAgfQoKfQoKZXhwb3J0cy5HbG9iYWxJbWFnZUNhY2hlID0gR2xvYmFsSW1hZ2VDYWNoZTsKCi8qKiovIH0pLAovKiAxODUgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmJpZGkgPSBiaWRpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNvbnN0IGJhc2VUeXBlcyA9IFsiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiUyIsICJCIiwgIlMiLCAiV1MiLCAiQiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCIiwgIkIiLCAiQiIsICJTIiwgIldTIiwgIk9OIiwgIk9OIiwgIkVUIiwgIkVUIiwgIkVUIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIkVTIiwgIkNTIiwgIkVTIiwgIkNTIiwgIkNTIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkNTIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiT04iLCAiT04iLCAiT04iLCAiT04iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJDUyIsICJPTiIsICJFVCIsICJFVCIsICJFVCIsICJFVCIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJMIiwgIk9OIiwgIk9OIiwgIkJOIiwgIk9OIiwgIk9OIiwgIkVUIiwgIkVUIiwgIkVOIiwgIkVOIiwgIk9OIiwgIkwiLCAiT04iLCAiT04iLCAiT04iLCAiRU4iLCAiTCIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiT04iLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJPTiIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiXTsKY29uc3QgYXJhYmljVHlwZXMgPSBbIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIk9OIiwgIk9OIiwgIkFMIiwgIkVUIiwgIkVUIiwgIkFMIiwgIkNTIiwgIkFMIiwgIk9OIiwgIk9OIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiQUwiLCAiQUwiLCAiIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkVUIiwgIkFOIiwgIkFOIiwgIkFMIiwgIkFMIiwgIkFMIiwgIk5TTSIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiQU4iLCAiT04iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiQUwiLCAiQUwiLCAiTlNNIiwgIk5TTSIsICJPTiIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiQUwiLCAiQUwiLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiXTsKCmZ1bmN0aW9uIGlzT2RkKGkpIHsKICByZXR1cm4gKGkgJiAxKSAhPT0gMDsKfQoKZnVuY3Rpb24gaXNFdmVuKGkpIHsKICByZXR1cm4gKGkgJiAxKSA9PT0gMDsKfQoKZnVuY3Rpb24gZmluZFVuZXF1YWwoYXJyLCBzdGFydCwgdmFsdWUpIHsKICBsZXQgaiwgamo7CgogIGZvciAoaiA9IHN0YXJ0LCBqaiA9IGFyci5sZW5ndGg7IGogPCBqajsgKytqKSB7CiAgICBpZiAoYXJyW2pdICE9PSB2YWx1ZSkgewogICAgICByZXR1cm4gajsKICAgIH0KICB9CgogIHJldHVybiBqOwp9CgpmdW5jdGlvbiBzZXRWYWx1ZXMoYXJyLCBzdGFydCwgZW5kLCB2YWx1ZSkgewogIGZvciAobGV0IGogPSBzdGFydDsgaiA8IGVuZDsgKytqKSB7CiAgICBhcnJbal0gPSB2YWx1ZTsKICB9Cn0KCmZ1bmN0aW9uIHJldmVyc2VWYWx1ZXMoYXJyLCBzdGFydCwgZW5kKSB7CiAgZm9yIChsZXQgaSA9IHN0YXJ0LCBqID0gZW5kIC0gMTsgaSA8IGo7ICsraSwgLS1qKSB7CiAgICBjb25zdCB0ZW1wID0gYXJyW2ldOwogICAgYXJyW2ldID0gYXJyW2pdOwogICAgYXJyW2pdID0gdGVtcDsKICB9Cn0KCmZ1bmN0aW9uIGNyZWF0ZUJpZGlUZXh0KHN0ciwgaXNMVFIpIHsKICBsZXQgdmVydGljYWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlOwogIGxldCBkaXIgPSAibHRyIjsKCiAgaWYgKHZlcnRpY2FsKSB7CiAgICBkaXIgPSAidHRiIjsKICB9IGVsc2UgaWYgKCFpc0xUUikgewogICAgZGlyID0gInJ0bCI7CiAgfQoKICByZXR1cm4gewogICAgc3RyLAogICAgZGlyCiAgfTsKfQoKY29uc3QgY2hhcnMgPSBbXTsKY29uc3QgdHlwZXMgPSBbXTsKCmZ1bmN0aW9uIGJpZGkoc3RyKSB7CiAgbGV0IHN0YXJ0TGV2ZWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IC0xOwogIGxldCB2ZXJ0aWNhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgbGV0IGlzTFRSID0gdHJ1ZTsKICBjb25zdCBzdHJMZW5ndGggPSBzdHIubGVuZ3RoOwoKICBpZiAoc3RyTGVuZ3RoID09PSAwIHx8IHZlcnRpY2FsKSB7CiAgICByZXR1cm4gY3JlYXRlQmlkaVRleHQoc3RyLCBpc0xUUiwgdmVydGljYWwpOwogIH0KCiAgY2hhcnMubGVuZ3RoID0gc3RyTGVuZ3RoOwogIHR5cGVzLmxlbmd0aCA9IHN0ckxlbmd0aDsKICBsZXQgbnVtQmlkaSA9IDA7CiAgbGV0IGksIGlpOwoKICBmb3IgKGkgPSAwOyBpIDwgc3RyTGVuZ3RoOyArK2kpIHsKICAgIGNoYXJzW2ldID0gc3RyLmNoYXJBdChpKTsKICAgIGNvbnN0IGNoYXJDb2RlID0gc3RyLmNoYXJDb2RlQXQoaSk7CiAgICBsZXQgY2hhclR5cGUgPSAiTCI7CgogICAgaWYgKGNoYXJDb2RlIDw9IDB4MDBmZikgewogICAgICBjaGFyVHlwZSA9IGJhc2VUeXBlc1tjaGFyQ29kZV07CiAgICB9IGVsc2UgaWYgKDB4MDU5MCA8PSBjaGFyQ29kZSAmJiBjaGFyQ29kZSA8PSAweDA1ZjQpIHsKICAgICAgY2hhclR5cGUgPSAiUiI7CiAgICB9IGVsc2UgaWYgKDB4MDYwMCA8PSBjaGFyQ29kZSAmJiBjaGFyQ29kZSA8PSAweDA2ZmYpIHsKICAgICAgY2hhclR5cGUgPSBhcmFiaWNUeXBlc1tjaGFyQ29kZSAmIDB4ZmZdOwoKICAgICAgaWYgKCFjaGFyVHlwZSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiQmlkaTogaW52YWxpZCBVbmljb2RlIGNoYXJhY3RlciAiICsgY2hhckNvZGUudG9TdHJpbmcoMTYpKTsKICAgICAgfQogICAgfSBlbHNlIGlmICgweDA3MDAgPD0gY2hhckNvZGUgJiYgY2hhckNvZGUgPD0gMHgwOGFjKSB7CiAgICAgIGNoYXJUeXBlID0gIkFMIjsKICAgIH0KCiAgICBpZiAoY2hhclR5cGUgPT09ICJSIiB8fCBjaGFyVHlwZSA9PT0gIkFMIiB8fCBjaGFyVHlwZSA9PT0gIkFOIikgewogICAgICBudW1CaWRpKys7CiAgICB9CgogICAgdHlwZXNbaV0gPSBjaGFyVHlwZTsKICB9CgogIGlmIChudW1CaWRpID09PSAwKSB7CiAgICBpc0xUUiA9IHRydWU7CiAgICByZXR1cm4gY3JlYXRlQmlkaVRleHQoc3RyLCBpc0xUUik7CiAgfQoKICBpZiAoc3RhcnRMZXZlbCA9PT0gLTEpIHsKICAgIGlmIChudW1CaWRpIC8gc3RyTGVuZ3RoIDwgMC4zICYmIHN0ckxlbmd0aCA+IDQpIHsKICAgICAgaXNMVFIgPSB0cnVlOwogICAgICBzdGFydExldmVsID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGlzTFRSID0gZmFsc2U7CiAgICAgIHN0YXJ0TGV2ZWwgPSAxOwogICAgfQogIH0KCiAgY29uc3QgbGV2ZWxzID0gW107CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgbGV2ZWxzW2ldID0gc3RhcnRMZXZlbDsKICB9CgogIGNvbnN0IGUgPSBpc09kZChzdGFydExldmVsKSA/ICJSIiA6ICJMIjsKICBjb25zdCBzb3IgPSBlOwogIGNvbnN0IGVvciA9IHNvcjsKICBsZXQgbGFzdFR5cGUgPSBzb3I7CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgaWYgKHR5cGVzW2ldID09PSAiTlNNIikgewogICAgICB0eXBlc1tpXSA9IGxhc3RUeXBlOwogICAgfSBlbHNlIHsKICAgICAgbGFzdFR5cGUgPSB0eXBlc1tpXTsKICAgIH0KICB9CgogIGxhc3RUeXBlID0gc29yOwogIGxldCB0OwoKICBmb3IgKGkgPSAwOyBpIDwgc3RyTGVuZ3RoOyArK2kpIHsKICAgIHQgPSB0eXBlc1tpXTsKCiAgICBpZiAodCA9PT0gIkVOIikgewogICAgICB0eXBlc1tpXSA9IGxhc3RUeXBlID09PSAiQUwiID8gIkFOIiA6ICJFTiI7CiAgICB9IGVsc2UgaWYgKHQgPT09ICJSIiB8fCB0ID09PSAiTCIgfHwgdCA9PT0gIkFMIikgewogICAgICBsYXN0VHlwZSA9IHQ7CiAgICB9CiAgfQoKICBmb3IgKGkgPSAwOyBpIDwgc3RyTGVuZ3RoOyArK2kpIHsKICAgIHQgPSB0eXBlc1tpXTsKCiAgICBpZiAodCA9PT0gIkFMIikgewogICAgICB0eXBlc1tpXSA9ICJSIjsKICAgIH0KICB9CgogIGZvciAoaSA9IDE7IGkgPCBzdHJMZW5ndGggLSAxOyArK2kpIHsKICAgIGlmICh0eXBlc1tpXSA9PT0gIkVTIiAmJiB0eXBlc1tpIC0gMV0gPT09ICJFTiIgJiYgdHlwZXNbaSArIDFdID09PSAiRU4iKSB7CiAgICAgIHR5cGVzW2ldID0gIkVOIjsKICAgIH0KCiAgICBpZiAodHlwZXNbaV0gPT09ICJDUyIgJiYgKHR5cGVzW2kgLSAxXSA9PT0gIkVOIiB8fCB0eXBlc1tpIC0gMV0gPT09ICJBTiIpICYmIHR5cGVzW2kgKyAxXSA9PT0gdHlwZXNbaSAtIDFdKSB7CiAgICAgIHR5cGVzW2ldID0gdHlwZXNbaSAtIDFdOwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICBpZiAodHlwZXNbaV0gPT09ICJFTiIpIHsKICAgICAgZm9yIChsZXQgaiA9IGkgLSAxOyBqID49IDA7IC0taikgewogICAgICAgIGlmICh0eXBlc1tqXSAhPT0gIkVUIikgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICB0eXBlc1tqXSA9ICJFTiI7CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGogPSBpICsgMTsgaiA8IHN0ckxlbmd0aDsgKytqKSB7CiAgICAgICAgaWYgKHR5cGVzW2pdICE9PSAiRVQiKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHR5cGVzW2pdID0gIkVOIjsKICAgICAgfQogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICB0ID0gdHlwZXNbaV07CgogICAgaWYgKHQgPT09ICJXUyIgfHwgdCA9PT0gIkVTIiB8fCB0ID09PSAiRVQiIHx8IHQgPT09ICJDUyIpIHsKICAgICAgdHlwZXNbaV0gPSAiT04iOwogICAgfQogIH0KCiAgbGFzdFR5cGUgPSBzb3I7CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgdCA9IHR5cGVzW2ldOwoKICAgIGlmICh0ID09PSAiRU4iKSB7CiAgICAgIHR5cGVzW2ldID0gbGFzdFR5cGUgPT09ICJMIiA/ICJMIiA6ICJFTiI7CiAgICB9IGVsc2UgaWYgKHQgPT09ICJSIiB8fCB0ID09PSAiTCIpIHsKICAgICAgbGFzdFR5cGUgPSB0OwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICBpZiAodHlwZXNbaV0gPT09ICJPTiIpIHsKICAgICAgY29uc3QgZW5kID0gZmluZFVuZXF1YWwodHlwZXMsIGkgKyAxLCAiT04iKTsKICAgICAgbGV0IGJlZm9yZSA9IHNvcjsKCiAgICAgIGlmIChpID4gMCkgewogICAgICAgIGJlZm9yZSA9IHR5cGVzW2kgLSAxXTsKICAgICAgfQoKICAgICAgbGV0IGFmdGVyID0gZW9yOwoKICAgICAgaWYgKGVuZCArIDEgPCBzdHJMZW5ndGgpIHsKICAgICAgICBhZnRlciA9IHR5cGVzW2VuZCArIDFdOwogICAgICB9CgogICAgICBpZiAoYmVmb3JlICE9PSAiTCIpIHsKICAgICAgICBiZWZvcmUgPSAiUiI7CiAgICAgIH0KCiAgICAgIGlmIChhZnRlciAhPT0gIkwiKSB7CiAgICAgICAgYWZ0ZXIgPSAiUiI7CiAgICAgIH0KCiAgICAgIGlmIChiZWZvcmUgPT09IGFmdGVyKSB7CiAgICAgICAgc2V0VmFsdWVzKHR5cGVzLCBpLCBlbmQsIGJlZm9yZSk7CiAgICAgIH0KCiAgICAgIGkgPSBlbmQgLSAxOwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICBpZiAodHlwZXNbaV0gPT09ICJPTiIpIHsKICAgICAgdHlwZXNbaV0gPSBlOwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICB0ID0gdHlwZXNbaV07CgogICAgaWYgKGlzRXZlbihsZXZlbHNbaV0pKSB7CiAgICAgIGlmICh0ID09PSAiUiIpIHsKICAgICAgICBsZXZlbHNbaV0gKz0gMTsKICAgICAgfSBlbHNlIGlmICh0ID09PSAiQU4iIHx8IHQgPT09ICJFTiIpIHsKICAgICAgICBsZXZlbHNbaV0gKz0gMjsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKHQgPT09ICJMIiB8fCB0ID09PSAiQU4iIHx8IHQgPT09ICJFTiIpIHsKICAgICAgICBsZXZlbHNbaV0gKz0gMTsKICAgICAgfQogICAgfQogIH0KCiAgbGV0IGhpZ2hlc3RMZXZlbCA9IC0xOwogIGxldCBsb3dlc3RPZGRMZXZlbCA9IDk5OwogIGxldCBsZXZlbDsKCiAgZm9yIChpID0gMCwgaWkgPSBsZXZlbHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgbGV2ZWwgPSBsZXZlbHNbaV07CgogICAgaWYgKGhpZ2hlc3RMZXZlbCA8IGxldmVsKSB7CiAgICAgIGhpZ2hlc3RMZXZlbCA9IGxldmVsOwogICAgfQoKICAgIGlmIChsb3dlc3RPZGRMZXZlbCA+IGxldmVsICYmIGlzT2RkKGxldmVsKSkgewogICAgICBsb3dlc3RPZGRMZXZlbCA9IGxldmVsOwogICAgfQogIH0KCiAgZm9yIChsZXZlbCA9IGhpZ2hlc3RMZXZlbDsgbGV2ZWwgPj0gbG93ZXN0T2RkTGV2ZWw7IC0tbGV2ZWwpIHsKICAgIGxldCBzdGFydCA9IC0xOwoKICAgIGZvciAoaSA9IDAsIGlpID0gbGV2ZWxzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgaWYgKGxldmVsc1tpXSA8IGxldmVsKSB7CiAgICAgICAgaWYgKHN0YXJ0ID49IDApIHsKICAgICAgICAgIHJldmVyc2VWYWx1ZXMoY2hhcnMsIHN0YXJ0LCBpKTsKICAgICAgICAgIHN0YXJ0ID0gLTE7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHN0YXJ0IDwgMCkgewogICAgICAgIHN0YXJ0ID0gaTsKICAgICAgfQogICAgfQoKICAgIGlmIChzdGFydCA+PSAwKSB7CiAgICAgIHJldmVyc2VWYWx1ZXMoY2hhcnMsIHN0YXJ0LCBsZXZlbHMubGVuZ3RoKTsKICAgIH0KICB9CgogIGZvciAoaSA9IDAsIGlpID0gY2hhcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgY29uc3QgY2ggPSBjaGFyc1tpXTsKCiAgICBpZiAoY2ggPT09ICI8IiB8fCBjaCA9PT0gIj4iKSB7CiAgICAgIGNoYXJzW2ldID0gIiI7CiAgICB9CiAgfQoKICByZXR1cm4gY3JlYXRlQmlkaVRleHQoY2hhcnMuam9pbigiIiksIGlzTFRSKTsKfQoKLyoqKi8gfSksCi8qIDE4NiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTXVybXVySGFzaDNfNjQgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY29uc3QgU0VFRCA9IDB4YzNkMmUxZjA7CmNvbnN0IE1BU0tfSElHSCA9IDB4ZmZmZjAwMDA7CmNvbnN0IE1BU0tfTE9XID0gMHhmZmZmOwoKY2xhc3MgTXVybXVySGFzaDNfNjQgewogIGNvbnN0cnVjdG9yKHNlZWQpIHsKICAgIHRoaXMuaDEgPSBzZWVkID8gc2VlZCAmIDB4ZmZmZmZmZmYgOiBTRUVEOwogICAgdGhpcy5oMiA9IHNlZWQgPyBzZWVkICYgMHhmZmZmZmZmZiA6IFNFRUQ7CiAgfQoKICB1cGRhdGUoaW5wdXQpIHsKICAgIGxldCBkYXRhLCBsZW5ndGg7CgogICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gInN0cmluZyIpIHsKICAgICAgZGF0YSA9IG5ldyBVaW50OEFycmF5KGlucHV0Lmxlbmd0aCAqIDIpOwogICAgICBsZW5ndGggPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gaW5wdXQubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbnN0IGNvZGUgPSBpbnB1dC5jaGFyQ29kZUF0KGkpOwoKICAgICAgICBpZiAoY29kZSA8PSAweGZmKSB7CiAgICAgICAgICBkYXRhW2xlbmd0aCsrXSA9IGNvZGU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRhdGFbbGVuZ3RoKytdID0gY29kZSA+Pj4gODsKICAgICAgICAgIGRhdGFbbGVuZ3RoKytdID0gY29kZSAmIDB4ZmY7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKCgwLCBfdXRpbC5pc0FycmF5QnVmZmVyKShpbnB1dCkpIHsKICAgICAgZGF0YSA9IGlucHV0LnNsaWNlKCk7CiAgICAgIGxlbmd0aCA9IGRhdGEuYnl0ZUxlbmd0aDsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiV3JvbmcgZGF0YSBmb3JtYXQgaW4gTXVybXVySGFzaDNfNjRfdXBkYXRlLiAiICsgIklucHV0IG11c3QgYmUgYSBzdHJpbmcgb3IgYXJyYXkuIik7CiAgICB9CgogICAgY29uc3QgYmxvY2tDb3VudHMgPSBsZW5ndGggPj4gMjsKICAgIGNvbnN0IHRhaWxMZW5ndGggPSBsZW5ndGggLSBibG9ja0NvdW50cyAqIDQ7CiAgICBjb25zdCBkYXRhVWludDMyID0gbmV3IFVpbnQzMkFycmF5KGRhdGEuYnVmZmVyLCAwLCBibG9ja0NvdW50cyk7CiAgICBsZXQgazEgPSAwLAogICAgICAgIGsyID0gMDsKICAgIGxldCBoMSA9IHRoaXMuaDEsCiAgICAgICAgaDIgPSB0aGlzLmgyOwogICAgY29uc3QgQzEgPSAweGNjOWUyZDUxLAogICAgICAgICAgQzIgPSAweDFiODczNTkzOwogICAgY29uc3QgQzFfTE9XID0gQzEgJiBNQVNLX0xPVywKICAgICAgICAgIEMyX0xPVyA9IEMyICYgTUFTS19MT1c7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9ja0NvdW50czsgaSsrKSB7CiAgICAgIGlmIChpICYgMSkgewogICAgICAgIGsxID0gZGF0YVVpbnQzMltpXTsKICAgICAgICBrMSA9IGsxICogQzEgJiBNQVNLX0hJR0ggfCBrMSAqIEMxX0xPVyAmIE1BU0tfTE9XOwogICAgICAgIGsxID0gazEgPDwgMTUgfCBrMSA+Pj4gMTc7CiAgICAgICAgazEgPSBrMSAqIEMyICYgTUFTS19ISUdIIHwgazEgKiBDMl9MT1cgJiBNQVNLX0xPVzsKICAgICAgICBoMSBePSBrMTsKICAgICAgICBoMSA9IGgxIDw8IDEzIHwgaDEgPj4+IDE5OwogICAgICAgIGgxID0gaDEgKiA1ICsgMHhlNjU0NmI2NDsKICAgICAgfSBlbHNlIHsKICAgICAgICBrMiA9IGRhdGFVaW50MzJbaV07CiAgICAgICAgazIgPSBrMiAqIEMxICYgTUFTS19ISUdIIHwgazIgKiBDMV9MT1cgJiBNQVNLX0xPVzsKICAgICAgICBrMiA9IGsyIDw8IDE1IHwgazIgPj4+IDE3OwogICAgICAgIGsyID0gazIgKiBDMiAmIE1BU0tfSElHSCB8IGsyICogQzJfTE9XICYgTUFTS19MT1c7CiAgICAgICAgaDIgXj0gazI7CiAgICAgICAgaDIgPSBoMiA8PCAxMyB8IGgyID4+PiAxOTsKICAgICAgICBoMiA9IGgyICogNSArIDB4ZTY1NDZiNjQ7CiAgICAgIH0KICAgIH0KCiAgICBrMSA9IDA7CgogICAgc3dpdGNoICh0YWlsTGVuZ3RoKSB7CiAgICAgIGNhc2UgMzoKICAgICAgICBrMSBePSBkYXRhW2Jsb2NrQ291bnRzICogNCArIDJdIDw8IDE2OwoKICAgICAgY2FzZSAyOgogICAgICAgIGsxIF49IGRhdGFbYmxvY2tDb3VudHMgKiA0ICsgMV0gPDwgODsKCiAgICAgIGNhc2UgMToKICAgICAgICBrMSBePSBkYXRhW2Jsb2NrQ291bnRzICogNF07CiAgICAgICAgazEgPSBrMSAqIEMxICYgTUFTS19ISUdIIHwgazEgKiBDMV9MT1cgJiBNQVNLX0xPVzsKICAgICAgICBrMSA9IGsxIDw8IDE1IHwgazEgPj4+IDE3OwogICAgICAgIGsxID0gazEgKiBDMiAmIE1BU0tfSElHSCB8IGsxICogQzJfTE9XICYgTUFTS19MT1c7CgogICAgICAgIGlmIChibG9ja0NvdW50cyAmIDEpIHsKICAgICAgICAgIGgxIF49IGsxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoMiBePSBrMTsKICAgICAgICB9CgogICAgfQoKICAgIHRoaXMuaDEgPSBoMTsKICAgIHRoaXMuaDIgPSBoMjsKICB9CgogIGhleGRpZ2VzdCgpIHsKICAgIGxldCBoMSA9IHRoaXMuaDEsCiAgICAgICAgaDIgPSB0aGlzLmgyOwogICAgaDEgXj0gaDIgPj4+IDE7CiAgICBoMSA9IGgxICogMHhlZDU1OGNjZCAmIE1BU0tfSElHSCB8IGgxICogMHg4Y2NkICYgTUFTS19MT1c7CiAgICBoMiA9IGgyICogMHhmZjUxYWZkNyAmIE1BU0tfSElHSCB8ICgoaDIgPDwgMTYgfCBoMSA+Pj4gMTYpICogMHhhZmQ3ZWQ1NSAmIE1BU0tfSElHSCkgPj4+IDE2OwogICAgaDEgXj0gaDIgPj4+IDE7CiAgICBoMSA9IGgxICogMHgxYTg1ZWM1MyAmIE1BU0tfSElHSCB8IGgxICogMHhlYzUzICYgTUFTS19MT1c7CiAgICBoMiA9IGgyICogMHhjNGNlYjlmZSAmIE1BU0tfSElHSCB8ICgoaDIgPDwgMTYgfCBoMSA+Pj4gMTYpICogMHhiOWZlMWE4NSAmIE1BU0tfSElHSCkgPj4+IDE2OwogICAgaDEgXj0gaDIgPj4+IDE7CiAgICBjb25zdCBoZXgxID0gKGgxID4+PiAwKS50b1N0cmluZygxNiksCiAgICAgICAgICBoZXgyID0gKGgyID4+PiAwKS50b1N0cmluZygxNik7CiAgICByZXR1cm4gaGV4MS5wYWRTdGFydCg4LCAiMCIpICsgaGV4Mi5wYWRTdGFydCg4LCAiMCIpOwogIH0KCn0KCmV4cG9ydHMuTXVybXVySGFzaDNfNjQgPSBNdXJtdXJIYXNoM182NDsKCi8qKiovIH0pLAovKiAxODcgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk9wZXJhdG9yTGlzdCA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpmdW5jdGlvbiBhZGRTdGF0ZShwYXJlbnRTdGF0ZSwgcGF0dGVybiwgY2hlY2tGbiwgaXRlcmF0ZUZuLCBwcm9jZXNzRm4pIHsKICBsZXQgc3RhdGUgPSBwYXJlbnRTdGF0ZTsKCiAgZm9yIChsZXQgaSA9IDAsIGlpID0gcGF0dGVybi5sZW5ndGggLSAxOyBpIDwgaWk7IGkrKykgewogICAgY29uc3QgaXRlbSA9IHBhdHRlcm5baV07CiAgICBzdGF0ZSA9IHN0YXRlW2l0ZW1dIHx8IChzdGF0ZVtpdGVtXSA9IFtdKTsKICB9CgogIHN0YXRlW3BhdHRlcm4uYXQoLTEpXSA9IHsKICAgIGNoZWNrRm4sCiAgICBpdGVyYXRlRm4sCiAgICBwcm9jZXNzRm4KICB9Owp9Cgpjb25zdCBJbml0aWFsU3RhdGUgPSBbXTsKYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLnNhdmUsIF91dGlsLk9QUy50cmFuc2Zvcm0sIF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdCwgX3V0aWwuT1BTLnJlc3RvcmVdLCBudWxsLCBmdW5jdGlvbiBpdGVyYXRlSW5saW5lSW1hZ2VHcm91cChjb250ZXh0LCBpKSB7CiAgY29uc3QgZm5BcnJheSA9IGNvbnRleHQuZm5BcnJheTsKICBjb25zdCBpRmlyc3RTYXZlID0gY29udGV4dC5pQ3VyciAtIDM7CiAgY29uc3QgcG9zID0gKGkgLSBpRmlyc3RTYXZlKSAlIDQ7CgogIHN3aXRjaCAocG9zKSB7CiAgICBjYXNlIDA6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMuc2F2ZTsKCiAgICBjYXNlIDE6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMudHJhbnNmb3JtOwoKICAgIGNhc2UgMjoKICAgICAgcmV0dXJuIGZuQXJyYXlbaV0gPT09IF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdDsKCiAgICBjYXNlIDM6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMucmVzdG9yZTsKICB9CgogIHRocm93IG5ldyBFcnJvcihgaXRlcmF0ZUlubGluZUltYWdlR3JvdXAgLSBpbnZhbGlkIHBvczogJHtwb3N9YCk7Cn0sIGZ1bmN0aW9uIGZvdW5kSW5saW5lSW1hZ2VHcm91cChjb250ZXh0LCBpKSB7CiAgY29uc3QgTUlOX0lNQUdFU19JTl9JTkxJTkVfSU1BR0VTX0JMT0NLID0gMTA7CiAgY29uc3QgTUFYX0lNQUdFU19JTl9JTkxJTkVfSU1BR0VTX0JMT0NLID0gMjAwOwogIGNvbnN0IE1BWF9XSURUSCA9IDEwMDA7CiAgY29uc3QgSU1BR0VfUEFERElORyA9IDE7CiAgY29uc3QgZm5BcnJheSA9IGNvbnRleHQuZm5BcnJheSwKICAgICAgICBhcmdzQXJyYXkgPSBjb250ZXh0LmFyZ3NBcnJheTsKICBjb25zdCBjdXJyID0gY29udGV4dC5pQ3VycjsKICBjb25zdCBpRmlyc3RTYXZlID0gY3VyciAtIDM7CiAgY29uc3QgaUZpcnN0VHJhbnNmb3JtID0gY3VyciAtIDI7CiAgY29uc3QgaUZpcnN0UElJWE8gPSBjdXJyIC0gMTsKICBjb25zdCBjb3VudCA9IE1hdGgubWluKE1hdGguZmxvb3IoKGkgLSBpRmlyc3RTYXZlKSAvIDQpLCBNQVhfSU1BR0VTX0lOX0lOTElORV9JTUFHRVNfQkxPQ0spOwoKICBpZiAoY291bnQgPCBNSU5fSU1BR0VTX0lOX0lOTElORV9JTUFHRVNfQkxPQ0spIHsKICAgIHJldHVybiBpIC0gKGkgLSBpRmlyc3RTYXZlKSAlIDQ7CiAgfQoKICBsZXQgbWF4WCA9IDA7CiAgY29uc3QgbWFwID0gW107CiAgbGV0IG1heExpbmVIZWlnaHQgPSAwOwogIGxldCBjdXJyZW50WCA9IElNQUdFX1BBRERJTkcsCiAgICAgIGN1cnJlbnRZID0gSU1BR0VfUEFERElORzsKCiAgZm9yIChsZXQgcSA9IDA7IHEgPCBjb3VudDsgcSsrKSB7CiAgICBjb25zdCB0cmFuc2Zvcm0gPSBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtICsgKHEgPDwgMildOwogICAgY29uc3QgaW1nID0gYXJnc0FycmF5W2lGaXJzdFBJSVhPICsgKHEgPDwgMildWzBdOwoKICAgIGlmIChjdXJyZW50WCArIGltZy53aWR0aCA+IE1BWF9XSURUSCkgewogICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgY3VycmVudFgpOwogICAgICBjdXJyZW50WSArPSBtYXhMaW5lSGVpZ2h0ICsgMiAqIElNQUdFX1BBRERJTkc7CiAgICAgIGN1cnJlbnRYID0gMDsKICAgICAgbWF4TGluZUhlaWdodCA9IDA7CiAgICB9CgogICAgbWFwLnB1c2goewogICAgICB0cmFuc2Zvcm0sCiAgICAgIHg6IGN1cnJlbnRYLAogICAgICB5OiBjdXJyZW50WSwKICAgICAgdzogaW1nLndpZHRoLAogICAgICBoOiBpbWcuaGVpZ2h0CiAgICB9KTsKICAgIGN1cnJlbnRYICs9IGltZy53aWR0aCArIDIgKiBJTUFHRV9QQURESU5HOwogICAgbWF4TGluZUhlaWdodCA9IE1hdGgubWF4KG1heExpbmVIZWlnaHQsIGltZy5oZWlnaHQpOwogIH0KCiAgY29uc3QgaW1nV2lkdGggPSBNYXRoLm1heChtYXhYLCBjdXJyZW50WCkgKyBJTUFHRV9QQURESU5HOwogIGNvbnN0IGltZ0hlaWdodCA9IGN1cnJlbnRZICsgbWF4TGluZUhlaWdodCArIElNQUdFX1BBRERJTkc7CiAgY29uc3QgaW1nRGF0YSA9IG5ldyBVaW50OEFycmF5KGltZ1dpZHRoICogaW1nSGVpZ2h0ICogNCk7CiAgY29uc3QgaW1nUm93U2l6ZSA9IGltZ1dpZHRoIDw8IDI7CgogIGZvciAobGV0IHEgPSAwOyBxIDwgY291bnQ7IHErKykgewogICAgY29uc3QgZGF0YSA9IGFyZ3NBcnJheVtpRmlyc3RQSUlYTyArIChxIDw8IDIpXVswXS5kYXRhOwogICAgY29uc3Qgcm93U2l6ZSA9IG1hcFtxXS53IDw8IDI7CiAgICBsZXQgZGF0YU9mZnNldCA9IDA7CiAgICBsZXQgb2Zmc2V0ID0gbWFwW3FdLnggKyBtYXBbcV0ueSAqIGltZ1dpZHRoIDw8IDI7CiAgICBpbWdEYXRhLnNldChkYXRhLnN1YmFycmF5KDAsIHJvd1NpemUpLCBvZmZzZXQgLSBpbWdSb3dTaXplKTsKCiAgICBmb3IgKGxldCBrID0gMCwga2sgPSBtYXBbcV0uaDsgayA8IGtrOyBrKyspIHsKICAgICAgaW1nRGF0YS5zZXQoZGF0YS5zdWJhcnJheShkYXRhT2Zmc2V0LCBkYXRhT2Zmc2V0ICsgcm93U2l6ZSksIG9mZnNldCk7CiAgICAgIGRhdGFPZmZzZXQgKz0gcm93U2l6ZTsKICAgICAgb2Zmc2V0ICs9IGltZ1Jvd1NpemU7CiAgICB9CgogICAgaW1nRGF0YS5zZXQoZGF0YS5zdWJhcnJheShkYXRhT2Zmc2V0IC0gcm93U2l6ZSwgZGF0YU9mZnNldCksIG9mZnNldCk7CgogICAgd2hpbGUgKG9mZnNldCA+PSAwKSB7CiAgICAgIGRhdGFbb2Zmc2V0IC0gNF0gPSBkYXRhW29mZnNldF07CiAgICAgIGRhdGFbb2Zmc2V0IC0gM10gPSBkYXRhW29mZnNldCArIDFdOwogICAgICBkYXRhW29mZnNldCAtIDJdID0gZGF0YVtvZmZzZXQgKyAyXTsKICAgICAgZGF0YVtvZmZzZXQgLSAxXSA9IGRhdGFbb2Zmc2V0ICsgM107CiAgICAgIGRhdGFbb2Zmc2V0ICsgcm93U2l6ZV0gPSBkYXRhW29mZnNldCArIHJvd1NpemUgLSA0XTsKICAgICAgZGF0YVtvZmZzZXQgKyByb3dTaXplICsgMV0gPSBkYXRhW29mZnNldCArIHJvd1NpemUgLSAzXTsKICAgICAgZGF0YVtvZmZzZXQgKyByb3dTaXplICsgMl0gPSBkYXRhW29mZnNldCArIHJvd1NpemUgLSAyXTsKICAgICAgZGF0YVtvZmZzZXQgKyByb3dTaXplICsgM10gPSBkYXRhW29mZnNldCArIHJvd1NpemUgLSAxXTsKICAgICAgb2Zmc2V0IC09IGltZ1Jvd1NpemU7CiAgICB9CiAgfQoKICBmbkFycmF5LnNwbGljZShpRmlyc3RTYXZlLCBjb3VudCAqIDQsIF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdEdyb3VwKTsKICBhcmdzQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgW3sKICAgIHdpZHRoOiBpbWdXaWR0aCwKICAgIGhlaWdodDogaW1nSGVpZ2h0LAogICAga2luZDogX3V0aWwuSW1hZ2VLaW5kLlJHQkFfMzJCUFAsCiAgICBkYXRhOiBpbWdEYXRhCiAgfSwgbWFwXSk7CiAgcmV0dXJuIGlGaXJzdFNhdmUgKyAxOwp9KTsKYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLnNhdmUsIF91dGlsLk9QUy50cmFuc2Zvcm0sIF91dGlsLk9QUy5wYWludEltYWdlTWFza1hPYmplY3QsIF91dGlsLk9QUy5yZXN0b3JlXSwgbnVsbCwgZnVuY3Rpb24gaXRlcmF0ZUltYWdlTWFza0dyb3VwKGNvbnRleHQsIGkpIHsKICBjb25zdCBmbkFycmF5ID0gY29udGV4dC5mbkFycmF5OwogIGNvbnN0IGlGaXJzdFNhdmUgPSBjb250ZXh0LmlDdXJyIC0gMzsKICBjb25zdCBwb3MgPSAoaSAtIGlGaXJzdFNhdmUpICUgNDsKCiAgc3dpdGNoIChwb3MpIHsKICAgIGNhc2UgMDoKICAgICAgcmV0dXJuIGZuQXJyYXlbaV0gPT09IF91dGlsLk9QUy5zYXZlOwoKICAgIGNhc2UgMToKICAgICAgcmV0dXJuIGZuQXJyYXlbaV0gPT09IF91dGlsLk9QUy50cmFuc2Zvcm07CgogICAgY2FzZSAyOgogICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdDsKCiAgICBjYXNlIDM6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMucmVzdG9yZTsKICB9CgogIHRocm93IG5ldyBFcnJvcihgaXRlcmF0ZUltYWdlTWFza0dyb3VwIC0gaW52YWxpZCBwb3M6ICR7cG9zfWApOwp9LCBmdW5jdGlvbiBmb3VuZEltYWdlTWFza0dyb3VwKGNvbnRleHQsIGkpIHsKICBjb25zdCBNSU5fSU1BR0VTX0lOX01BU0tTX0JMT0NLID0gMTA7CiAgY29uc3QgTUFYX0lNQUdFU19JTl9NQVNLU19CTE9DSyA9IDEwMDsKICBjb25zdCBNQVhfU0FNRV9JTUFHRVNfSU5fTUFTS1NfQkxPQ0sgPSAxMDAwOwogIGNvbnN0IGZuQXJyYXkgPSBjb250ZXh0LmZuQXJyYXksCiAgICAgICAgYXJnc0FycmF5ID0gY29udGV4dC5hcmdzQXJyYXk7CiAgY29uc3QgY3VyciA9IGNvbnRleHQuaUN1cnI7CiAgY29uc3QgaUZpcnN0U2F2ZSA9IGN1cnIgLSAzOwogIGNvbnN0IGlGaXJzdFRyYW5zZm9ybSA9IGN1cnIgLSAyOwogIGNvbnN0IGlGaXJzdFBJTVhPID0gY3VyciAtIDE7CiAgbGV0IGNvdW50ID0gTWF0aC5mbG9vcigoaSAtIGlGaXJzdFNhdmUpIC8gNCk7CgogIGlmIChjb3VudCA8IE1JTl9JTUFHRVNfSU5fTUFTS1NfQkxPQ0spIHsKICAgIHJldHVybiBpIC0gKGkgLSBpRmlyc3RTYXZlKSAlIDQ7CiAgfQoKICBsZXQgaXNTYW1lSW1hZ2UgPSBmYWxzZTsKICBsZXQgaVRyYW5zZm9ybSwgdHJhbnNmb3JtQXJnczsKICBjb25zdCBmaXJzdFBJTVhPQXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RQSU1YT11bMF07CiAgY29uc3QgZmlyc3RUcmFuc2Zvcm1BcmcwID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bMF0sCiAgICAgICAgZmlyc3RUcmFuc2Zvcm1BcmcxID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bMV0sCiAgICAgICAgZmlyc3RUcmFuc2Zvcm1BcmcyID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bMl0sCiAgICAgICAgZmlyc3RUcmFuc2Zvcm1BcmczID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bM107CgogIGlmIChmaXJzdFRyYW5zZm9ybUFyZzEgPT09IGZpcnN0VHJhbnNmb3JtQXJnMikgewogICAgaXNTYW1lSW1hZ2UgPSB0cnVlOwogICAgaVRyYW5zZm9ybSA9IGlGaXJzdFRyYW5zZm9ybSArIDQ7CiAgICBsZXQgaVBJTVhPID0gaUZpcnN0UElNWE8gKyA0OwoKICAgIGZvciAobGV0IHEgPSAxOyBxIDwgY291bnQ7IHErKywgaVRyYW5zZm9ybSArPSA0LCBpUElNWE8gKz0gNCkgewogICAgICB0cmFuc2Zvcm1BcmdzID0gYXJnc0FycmF5W2lUcmFuc2Zvcm1dOwoKICAgICAgaWYgKGFyZ3NBcnJheVtpUElNWE9dWzBdICE9PSBmaXJzdFBJTVhPQXJnMCB8fCB0cmFuc2Zvcm1BcmdzWzBdICE9PSBmaXJzdFRyYW5zZm9ybUFyZzAgfHwgdHJhbnNmb3JtQXJnc1sxXSAhPT0gZmlyc3RUcmFuc2Zvcm1BcmcxIHx8IHRyYW5zZm9ybUFyZ3NbMl0gIT09IGZpcnN0VHJhbnNmb3JtQXJnMiB8fCB0cmFuc2Zvcm1BcmdzWzNdICE9PSBmaXJzdFRyYW5zZm9ybUFyZzMpIHsKICAgICAgICBpZiAocSA8IE1JTl9JTUFHRVNfSU5fTUFTS1NfQkxPQ0spIHsKICAgICAgICAgIGlzU2FtZUltYWdlID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvdW50ID0gcTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICBpZiAoaXNTYW1lSW1hZ2UpIHsKICAgIGNvdW50ID0gTWF0aC5taW4oY291bnQsIE1BWF9TQU1FX0lNQUdFU19JTl9NQVNLU19CTE9DSyk7CiAgICBjb25zdCBwb3NpdGlvbnMgPSBuZXcgRmxvYXQzMkFycmF5KGNvdW50ICogMik7CiAgICBpVHJhbnNmb3JtID0gaUZpcnN0VHJhbnNmb3JtOwoKICAgIGZvciAobGV0IHEgPSAwOyBxIDwgY291bnQ7IHErKywgaVRyYW5zZm9ybSArPSA0KSB7CiAgICAgIHRyYW5zZm9ybUFyZ3MgPSBhcmdzQXJyYXlbaVRyYW5zZm9ybV07CiAgICAgIHBvc2l0aW9uc1txIDw8IDFdID0gdHJhbnNmb3JtQXJnc1s0XTsKICAgICAgcG9zaXRpb25zWyhxIDw8IDEpICsgMV0gPSB0cmFuc2Zvcm1BcmdzWzVdOwogICAgfQoKICAgIGZuQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdFJlcGVhdCk7CiAgICBhcmdzQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgW2ZpcnN0UElNWE9BcmcwLCBmaXJzdFRyYW5zZm9ybUFyZzAsIGZpcnN0VHJhbnNmb3JtQXJnMSwgZmlyc3RUcmFuc2Zvcm1BcmcyLCBmaXJzdFRyYW5zZm9ybUFyZzMsIHBvc2l0aW9uc10pOwogIH0gZWxzZSB7CiAgICBjb3VudCA9IE1hdGgubWluKGNvdW50LCBNQVhfSU1BR0VTX0lOX01BU0tTX0JMT0NLKTsKICAgIGNvbnN0IGltYWdlcyA9IFtdOwoKICAgIGZvciAobGV0IHEgPSAwOyBxIDwgY291bnQ7IHErKykgewogICAgICB0cmFuc2Zvcm1BcmdzID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybSArIChxIDw8IDIpXTsKICAgICAgY29uc3QgbWFza1BhcmFtcyA9IGFyZ3NBcnJheVtpRmlyc3RQSU1YTyArIChxIDw8IDIpXVswXTsKICAgICAgaW1hZ2VzLnB1c2goewogICAgICAgIGRhdGE6IG1hc2tQYXJhbXMuZGF0YSwKICAgICAgICB3aWR0aDogbWFza1BhcmFtcy53aWR0aCwKICAgICAgICBoZWlnaHQ6IG1hc2tQYXJhbXMuaGVpZ2h0LAogICAgICAgIGludGVycG9sYXRlOiBtYXNrUGFyYW1zLmludGVycG9sYXRlLAogICAgICAgIGNvdW50OiBtYXNrUGFyYW1zLmNvdW50LAogICAgICAgIHRyYW5zZm9ybTogdHJhbnNmb3JtQXJncwogICAgICB9KTsKICAgIH0KCiAgICBmbkFycmF5LnNwbGljZShpRmlyc3RTYXZlLCBjb3VudCAqIDQsIF91dGlsLk9QUy5wYWludEltYWdlTWFza1hPYmplY3RHcm91cCk7CiAgICBhcmdzQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgW2ltYWdlc10pOwogIH0KCiAgcmV0dXJuIGlGaXJzdFNhdmUgKyAxOwp9KTsKYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLnNhdmUsIF91dGlsLk9QUy50cmFuc2Zvcm0sIF91dGlsLk9QUy5wYWludEltYWdlWE9iamVjdCwgX3V0aWwuT1BTLnJlc3RvcmVdLCBmdW5jdGlvbiAoY29udGV4dCkgewogIGNvbnN0IGFyZ3NBcnJheSA9IGNvbnRleHQuYXJnc0FycmF5OwogIGNvbnN0IGlGaXJzdFRyYW5zZm9ybSA9IGNvbnRleHQuaUN1cnIgLSAyOwogIHJldHVybiBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVsxXSA9PT0gMCAmJiBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVsyXSA9PT0gMDsKfSwgZnVuY3Rpb24gaXRlcmF0ZUltYWdlR3JvdXAoY29udGV4dCwgaSkgewogIGNvbnN0IGZuQXJyYXkgPSBjb250ZXh0LmZuQXJyYXksCiAgICAgICAgYXJnc0FycmF5ID0gY29udGV4dC5hcmdzQXJyYXk7CiAgY29uc3QgaUZpcnN0U2F2ZSA9IGNvbnRleHQuaUN1cnIgLSAzOwogIGNvbnN0IHBvcyA9IChpIC0gaUZpcnN0U2F2ZSkgJSA0OwoKICBzd2l0Y2ggKHBvcykgewogICAgY2FzZSAwOgogICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLnNhdmU7CgogICAgY2FzZSAxOgogICAgICBpZiAoZm5BcnJheVtpXSAhPT0gX3V0aWwuT1BTLnRyYW5zZm9ybSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgY29uc3QgaUZpcnN0VHJhbnNmb3JtID0gY29udGV4dC5pQ3VyciAtIDI7CiAgICAgIGNvbnN0IGZpcnN0VHJhbnNmb3JtQXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RUcmFuc2Zvcm1dWzBdOwogICAgICBjb25zdCBmaXJzdFRyYW5zZm9ybUFyZzMgPSBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVszXTsKCiAgICAgIGlmIChhcmdzQXJyYXlbaV1bMF0gIT09IGZpcnN0VHJhbnNmb3JtQXJnMCB8fCBhcmdzQXJyYXlbaV1bMV0gIT09IDAgfHwgYXJnc0FycmF5W2ldWzJdICE9PSAwIHx8IGFyZ3NBcnJheVtpXVszXSAhPT0gZmlyc3RUcmFuc2Zvcm1BcmczKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKCiAgICBjYXNlIDI6CiAgICAgIGlmIChmbkFycmF5W2ldICE9PSBfdXRpbC5PUFMucGFpbnRJbWFnZVhPYmplY3QpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGlGaXJzdFBJWE8gPSBjb250ZXh0LmlDdXJyIC0gMTsKICAgICAgY29uc3QgZmlyc3RQSVhPQXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RQSVhPXVswXTsKCiAgICAgIGlmIChhcmdzQXJyYXlbaV1bMF0gIT09IGZpcnN0UElYT0FyZzApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwoKICAgIGNhc2UgMzoKICAgICAgcmV0dXJuIGZuQXJyYXlbaV0gPT09IF91dGlsLk9QUy5yZXN0b3JlOwogIH0KCiAgdGhyb3cgbmV3IEVycm9yKGBpdGVyYXRlSW1hZ2VHcm91cCAtIGludmFsaWQgcG9zOiAke3Bvc31gKTsKfSwgZnVuY3Rpb24gKGNvbnRleHQsIGkpIHsKICBjb25zdCBNSU5fSU1BR0VTX0lOX0JMT0NLID0gMzsKICBjb25zdCBNQVhfSU1BR0VTX0lOX0JMT0NLID0gMTAwMDsKICBjb25zdCBmbkFycmF5ID0gY29udGV4dC5mbkFycmF5LAogICAgICAgIGFyZ3NBcnJheSA9IGNvbnRleHQuYXJnc0FycmF5OwogIGNvbnN0IGN1cnIgPSBjb250ZXh0LmlDdXJyOwogIGNvbnN0IGlGaXJzdFNhdmUgPSBjdXJyIC0gMzsKICBjb25zdCBpRmlyc3RUcmFuc2Zvcm0gPSBjdXJyIC0gMjsKICBjb25zdCBpRmlyc3RQSVhPID0gY3VyciAtIDE7CiAgY29uc3QgZmlyc3RQSVhPQXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RQSVhPXVswXTsKICBjb25zdCBmaXJzdFRyYW5zZm9ybUFyZzAgPSBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVswXTsKICBjb25zdCBmaXJzdFRyYW5zZm9ybUFyZzMgPSBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVszXTsKICBjb25zdCBjb3VudCA9IE1hdGgubWluKE1hdGguZmxvb3IoKGkgLSBpRmlyc3RTYXZlKSAvIDQpLCBNQVhfSU1BR0VTX0lOX0JMT0NLKTsKCiAgaWYgKGNvdW50IDwgTUlOX0lNQUdFU19JTl9CTE9DSykgewogICAgcmV0dXJuIGkgLSAoaSAtIGlGaXJzdFNhdmUpICUgNDsKICB9CgogIGNvbnN0IHBvc2l0aW9ucyA9IG5ldyBGbG9hdDMyQXJyYXkoY291bnQgKiAyKTsKICBsZXQgaVRyYW5zZm9ybSA9IGlGaXJzdFRyYW5zZm9ybTsKCiAgZm9yIChsZXQgcSA9IDA7IHEgPCBjb3VudDsgcSsrLCBpVHJhbnNmb3JtICs9IDQpIHsKICAgIGNvbnN0IHRyYW5zZm9ybUFyZ3MgPSBhcmdzQXJyYXlbaVRyYW5zZm9ybV07CiAgICBwb3NpdGlvbnNbcSA8PCAxXSA9IHRyYW5zZm9ybUFyZ3NbNF07CiAgICBwb3NpdGlvbnNbKHEgPDwgMSkgKyAxXSA9IHRyYW5zZm9ybUFyZ3NbNV07CiAgfQoKICBjb25zdCBhcmdzID0gW2ZpcnN0UElYT0FyZzAsIGZpcnN0VHJhbnNmb3JtQXJnMCwgZmlyc3RUcmFuc2Zvcm1BcmczLCBwb3NpdGlvbnNdOwogIGZuQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgX3V0aWwuT1BTLnBhaW50SW1hZ2VYT2JqZWN0UmVwZWF0KTsKICBhcmdzQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgYXJncyk7CiAgcmV0dXJuIGlGaXJzdFNhdmUgKyAxOwp9KTsKYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLmJlZ2luVGV4dCwgX3V0aWwuT1BTLnNldEZvbnQsIF91dGlsLk9QUy5zZXRUZXh0TWF0cml4LCBfdXRpbC5PUFMuc2hvd1RleHQsIF91dGlsLk9QUy5lbmRUZXh0XSwgbnVsbCwgZnVuY3Rpb24gaXRlcmF0ZVNob3dUZXh0R3JvdXAoY29udGV4dCwgaSkgewogIGNvbnN0IGZuQXJyYXkgPSBjb250ZXh0LmZuQXJyYXksCiAgICAgICAgYXJnc0FycmF5ID0gY29udGV4dC5hcmdzQXJyYXk7CiAgY29uc3QgaUZpcnN0U2F2ZSA9IGNvbnRleHQuaUN1cnIgLSA0OwogIGNvbnN0IHBvcyA9IChpIC0gaUZpcnN0U2F2ZSkgJSA1OwoKICBzd2l0Y2ggKHBvcykgewogICAgY2FzZSAwOgogICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLmJlZ2luVGV4dDsKCiAgICBjYXNlIDE6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMuc2V0Rm9udDsKCiAgICBjYXNlIDI6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMuc2V0VGV4dE1hdHJpeDsKCiAgICBjYXNlIDM6CiAgICAgIGlmIChmbkFycmF5W2ldICE9PSBfdXRpbC5PUFMuc2hvd1RleHQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGlGaXJzdFNldEZvbnQgPSBjb250ZXh0LmlDdXJyIC0gMzsKICAgICAgY29uc3QgZmlyc3RTZXRGb250QXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RTZXRGb250XVswXTsKICAgICAgY29uc3QgZmlyc3RTZXRGb250QXJnMSA9IGFyZ3NBcnJheVtpRmlyc3RTZXRGb250XVsxXTsKCiAgICAgIGlmIChhcmdzQXJyYXlbaV1bMF0gIT09IGZpcnN0U2V0Rm9udEFyZzAgfHwgYXJnc0FycmF5W2ldWzFdICE9PSBmaXJzdFNldEZvbnRBcmcxKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKCiAgICBjYXNlIDQ6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMuZW5kVGV4dDsKICB9CgogIHRocm93IG5ldyBFcnJvcihgaXRlcmF0ZVNob3dUZXh0R3JvdXAgLSBpbnZhbGlkIHBvczogJHtwb3N9YCk7Cn0sIGZ1bmN0aW9uIChjb250ZXh0LCBpKSB7CiAgY29uc3QgTUlOX0NIQVJTX0lOX0JMT0NLID0gMzsKICBjb25zdCBNQVhfQ0hBUlNfSU5fQkxPQ0sgPSAxMDAwOwogIGNvbnN0IGZuQXJyYXkgPSBjb250ZXh0LmZuQXJyYXksCiAgICAgICAgYXJnc0FycmF5ID0gY29udGV4dC5hcmdzQXJyYXk7CiAgY29uc3QgY3VyciA9IGNvbnRleHQuaUN1cnI7CiAgY29uc3QgaUZpcnN0QmVnaW5UZXh0ID0gY3VyciAtIDQ7CiAgY29uc3QgaUZpcnN0U2V0Rm9udCA9IGN1cnIgLSAzOwogIGNvbnN0IGlGaXJzdFNldFRleHRNYXRyaXggPSBjdXJyIC0gMjsKICBjb25zdCBpRmlyc3RTaG93VGV4dCA9IGN1cnIgLSAxOwogIGNvbnN0IGlGaXJzdEVuZFRleHQgPSBjdXJyOwogIGNvbnN0IGZpcnN0U2V0Rm9udEFyZzAgPSBhcmdzQXJyYXlbaUZpcnN0U2V0Rm9udF1bMF07CiAgY29uc3QgZmlyc3RTZXRGb250QXJnMSA9IGFyZ3NBcnJheVtpRmlyc3RTZXRGb250XVsxXTsKICBsZXQgY291bnQgPSBNYXRoLm1pbihNYXRoLmZsb29yKChpIC0gaUZpcnN0QmVnaW5UZXh0KSAvIDUpLCBNQVhfQ0hBUlNfSU5fQkxPQ0spOwoKICBpZiAoY291bnQgPCBNSU5fQ0hBUlNfSU5fQkxPQ0spIHsKICAgIHJldHVybiBpIC0gKGkgLSBpRmlyc3RCZWdpblRleHQpICUgNTsKICB9CgogIGxldCBpRmlyc3QgPSBpRmlyc3RCZWdpblRleHQ7CgogIGlmIChpRmlyc3RCZWdpblRleHQgPj0gNCAmJiBmbkFycmF5W2lGaXJzdEJlZ2luVGV4dCAtIDRdID09PSBmbkFycmF5W2lGaXJzdFNldEZvbnRdICYmIGZuQXJyYXlbaUZpcnN0QmVnaW5UZXh0IC0gM10gPT09IGZuQXJyYXlbaUZpcnN0U2V0VGV4dE1hdHJpeF0gJiYgZm5BcnJheVtpRmlyc3RCZWdpblRleHQgLSAyXSA9PT0gZm5BcnJheVtpRmlyc3RTaG93VGV4dF0gJiYgZm5BcnJheVtpRmlyc3RCZWdpblRleHQgLSAxXSA9PT0gZm5BcnJheVtpRmlyc3RFbmRUZXh0XSAmJiBhcmdzQXJyYXlbaUZpcnN0QmVnaW5UZXh0IC0gNF1bMF0gPT09IGZpcnN0U2V0Rm9udEFyZzAgJiYgYXJnc0FycmF5W2lGaXJzdEJlZ2luVGV4dCAtIDRdWzFdID09PSBmaXJzdFNldEZvbnRBcmcxKSB7CiAgICBjb3VudCsrOwogICAgaUZpcnN0IC09IDU7CiAgfQoKICBsZXQgaUVuZFRleHQgPSBpRmlyc3QgKyA0OwoKICBmb3IgKGxldCBxID0gMTsgcSA8IGNvdW50OyBxKyspIHsKICAgIGZuQXJyYXkuc3BsaWNlKGlFbmRUZXh0LCAzKTsKICAgIGFyZ3NBcnJheS5zcGxpY2UoaUVuZFRleHQsIDMpOwogICAgaUVuZFRleHQgKz0gMjsKICB9CgogIHJldHVybiBpRW5kVGV4dCArIDE7Cn0pOwoKY2xhc3MgTnVsbE9wdGltaXplciB7CiAgY29uc3RydWN0b3IocXVldWUpIHsKICAgIHRoaXMucXVldWUgPSBxdWV1ZTsKICB9CgogIF9vcHRpbWl6ZSgpIHt9CgogIHB1c2goZm4sIGFyZ3MpIHsKICAgIHRoaXMucXVldWUuZm5BcnJheS5wdXNoKGZuKTsKICAgIHRoaXMucXVldWUuYXJnc0FycmF5LnB1c2goYXJncyk7CgogICAgdGhpcy5fb3B0aW1pemUoKTsKICB9CgogIGZsdXNoKCkge30KCiAgcmVzZXQoKSB7fQoKfQoKY2xhc3MgUXVldWVPcHRpbWl6ZXIgZXh0ZW5kcyBOdWxsT3B0aW1pemVyIHsKICBjb25zdHJ1Y3RvcihxdWV1ZSkgewogICAgc3VwZXIocXVldWUpOwogICAgdGhpcy5zdGF0ZSA9IG51bGw7CiAgICB0aGlzLmNvbnRleHQgPSB7CiAgICAgIGlDdXJyOiAwLAogICAgICBmbkFycmF5OiBxdWV1ZS5mbkFycmF5LAogICAgICBhcmdzQXJyYXk6IHF1ZXVlLmFyZ3NBcnJheQogICAgfTsKICAgIHRoaXMubWF0Y2ggPSBudWxsOwogICAgdGhpcy5sYXN0UHJvY2Vzc2VkID0gMDsKICB9CgogIF9vcHRpbWl6ZSgpIHsKICAgIGNvbnN0IGZuQXJyYXkgPSB0aGlzLnF1ZXVlLmZuQXJyYXk7CiAgICBsZXQgaSA9IHRoaXMubGFzdFByb2Nlc3NlZCwKICAgICAgICBpaSA9IGZuQXJyYXkubGVuZ3RoOwogICAgbGV0IHN0YXRlID0gdGhpcy5zdGF0ZTsKICAgIGxldCBtYXRjaCA9IHRoaXMubWF0Y2g7CgogICAgaWYgKCFzdGF0ZSAmJiAhbWF0Y2ggJiYgaSArIDEgPT09IGlpICYmICFJbml0aWFsU3RhdGVbZm5BcnJheVtpXV0pIHsKICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkID0gaWk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5jb250ZXh0OwoKICAgIHdoaWxlIChpIDwgaWkpIHsKICAgICAgaWYgKG1hdGNoKSB7CiAgICAgICAgY29uc3QgaXRlcmF0ZSA9ICgwLCBtYXRjaC5pdGVyYXRlRm4pKGNvbnRleHQsIGkpOwoKICAgICAgICBpZiAoaXRlcmF0ZSkgewogICAgICAgICAgaSsrOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBpID0gKDAsIG1hdGNoLnByb2Nlc3NGbikoY29udGV4dCwgaSArIDEpOwogICAgICAgIGlpID0gZm5BcnJheS5sZW5ndGg7CiAgICAgICAgbWF0Y2ggPSBudWxsOwogICAgICAgIHN0YXRlID0gbnVsbDsKCiAgICAgICAgaWYgKGkgPj0gaWkpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgc3RhdGUgPSAoc3RhdGUgfHwgSW5pdGlhbFN0YXRlKVtmbkFycmF5W2ldXTsKCiAgICAgIGlmICghc3RhdGUgfHwgQXJyYXkuaXNBcnJheShzdGF0ZSkpIHsKICAgICAgICBpKys7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnRleHQuaUN1cnIgPSBpOwogICAgICBpKys7CgogICAgICBpZiAoc3RhdGUuY2hlY2tGbiAmJiAhKDAsIHN0YXRlLmNoZWNrRm4pKGNvbnRleHQpKSB7CiAgICAgICAgc3RhdGUgPSBudWxsOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBtYXRjaCA9IHN0YXRlOwogICAgICBzdGF0ZSA9IG51bGw7CiAgICB9CgogICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgdGhpcy5tYXRjaCA9IG1hdGNoOwogICAgdGhpcy5sYXN0UHJvY2Vzc2VkID0gaTsKICB9CgogIGZsdXNoKCkgewogICAgd2hpbGUgKHRoaXMubWF0Y2gpIHsKICAgICAgY29uc3QgbGVuZ3RoID0gdGhpcy5xdWV1ZS5mbkFycmF5Lmxlbmd0aDsKICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkID0gKDAsIHRoaXMubWF0Y2gucHJvY2Vzc0ZuKSh0aGlzLmNvbnRleHQsIGxlbmd0aCk7CiAgICAgIHRoaXMubWF0Y2ggPSBudWxsOwogICAgICB0aGlzLnN0YXRlID0gbnVsbDsKCiAgICAgIHRoaXMuX29wdGltaXplKCk7CiAgICB9CiAgfQoKICByZXNldCgpIHsKICAgIHRoaXMuc3RhdGUgPSBudWxsOwogICAgdGhpcy5tYXRjaCA9IG51bGw7CiAgICB0aGlzLmxhc3RQcm9jZXNzZWQgPSAwOwogIH0KCn0KCmNsYXNzIE9wZXJhdG9yTGlzdCB7CiAgc3RhdGljIGdldCBDSFVOS19TSVpFKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJDSFVOS19TSVpFIiwgMTAwMCk7CiAgfQoKICBzdGF0aWMgZ2V0IENIVU5LX1NJWkVfQUJPVVQoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIkNIVU5LX1NJWkVfQUJPVVQiLCB0aGlzLkNIVU5LX1NJWkUgLSA1KTsKICB9CgogIGNvbnN0cnVjdG9yKCkgewogICAgbGV0IGludGVudCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMDsKICAgIGxldCBzdHJlYW1TaW5rID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7CiAgICB0aGlzLl9zdHJlYW1TaW5rID0gc3RyZWFtU2luazsKICAgIHRoaXMuZm5BcnJheSA9IFtdOwogICAgdGhpcy5hcmdzQXJyYXkgPSBbXTsKCiAgICBpZiAoc3RyZWFtU2luayAmJiAhKGludGVudCAmIF91dGlsLlJlbmRlcmluZ0ludGVudEZsYWcuT1BMSVNUKSkgewogICAgICB0aGlzLm9wdGltaXplciA9IG5ldyBRdWV1ZU9wdGltaXplcih0aGlzKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMub3B0aW1pemVyID0gbmV3IE51bGxPcHRpbWl6ZXIodGhpcyk7CiAgICB9CgogICAgdGhpcy5kZXBlbmRlbmNpZXMgPSBuZXcgU2V0KCk7CiAgICB0aGlzLl90b3RhbExlbmd0aCA9IDA7CiAgICB0aGlzLndlaWdodCA9IDA7CiAgICB0aGlzLl9yZXNvbHZlZCA9IHN0cmVhbVNpbmsgPyBudWxsIDogUHJvbWlzZS5yZXNvbHZlKCk7CiAgfQoKICBnZXQgbGVuZ3RoKCkgewogICAgcmV0dXJuIHRoaXMuYXJnc0FycmF5Lmxlbmd0aDsKICB9CgogIGdldCByZWFkeSgpIHsKICAgIHJldHVybiB0aGlzLl9yZXNvbHZlZCB8fCB0aGlzLl9zdHJlYW1TaW5rLnJlYWR5OwogIH0KCiAgZ2V0IHRvdGFsTGVuZ3RoKCkgewogICAgcmV0dXJuIHRoaXMuX3RvdGFsTGVuZ3RoICsgdGhpcy5sZW5ndGg7CiAgfQoKICBhZGRPcChmbiwgYXJncykgewogICAgdGhpcy5vcHRpbWl6ZXIucHVzaChmbiwgYXJncyk7CiAgICB0aGlzLndlaWdodCsrOwoKICAgIGlmICh0aGlzLl9zdHJlYW1TaW5rKSB7CiAgICAgIGlmICh0aGlzLndlaWdodCA+PSBPcGVyYXRvckxpc3QuQ0hVTktfU0laRSkgewogICAgICAgIHRoaXMuZmx1c2goKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLndlaWdodCA+PSBPcGVyYXRvckxpc3QuQ0hVTktfU0laRV9BQk9VVCAmJiAoZm4gPT09IF91dGlsLk9QUy5yZXN0b3JlIHx8IGZuID09PSBfdXRpbC5PUFMuZW5kVGV4dCkpIHsKICAgICAgICB0aGlzLmZsdXNoKCk7CiAgICAgIH0KICAgIH0KICB9CgogIGFkZEltYWdlT3BzKGZuLCBhcmdzLCBvcHRpb25hbENvbnRlbnQpIHsKICAgIGlmIChvcHRpb25hbENvbnRlbnQgIT09IHVuZGVmaW5lZCkgewogICAgICB0aGlzLmFkZE9wKF91dGlsLk9QUy5iZWdpbk1hcmtlZENvbnRlbnRQcm9wcywgWyJPQyIsIG9wdGlvbmFsQ29udGVudF0pOwogICAgfQoKICAgIHRoaXMuYWRkT3AoZm4sIGFyZ3MpOwoKICAgIGlmIChvcHRpb25hbENvbnRlbnQgIT09IHVuZGVmaW5lZCkgewogICAgICB0aGlzLmFkZE9wKF91dGlsLk9QUy5lbmRNYXJrZWRDb250ZW50LCBbXSk7CiAgICB9CiAgfQoKICBhZGREZXBlbmRlbmN5KGRlcGVuZGVuY3kpIHsKICAgIGlmICh0aGlzLmRlcGVuZGVuY2llcy5oYXMoZGVwZW5kZW5jeSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuZGVwZW5kZW5jaWVzLmFkZChkZXBlbmRlbmN5KTsKICAgIHRoaXMuYWRkT3AoX3V0aWwuT1BTLmRlcGVuZGVuY3ksIFtkZXBlbmRlbmN5XSk7CiAgfQoKICBhZGREZXBlbmRlbmNpZXMoZGVwZW5kZW5jaWVzKSB7CiAgICBmb3IgKGNvbnN0IGRlcGVuZGVuY3kgb2YgZGVwZW5kZW5jaWVzKSB7CiAgICAgIHRoaXMuYWRkRGVwZW5kZW5jeShkZXBlbmRlbmN5KTsKICAgIH0KICB9CgogIGFkZE9wTGlzdChvcExpc3QpIHsKICAgIGlmICghKG9wTGlzdCBpbnN0YW5jZW9mIE9wZXJhdG9yTGlzdCkpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCdhZGRPcExpc3QgLSBpZ25vcmluZyBpbnZhbGlkICJvcExpc3QiIHBhcmFtZXRlci4nKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGZvciAoY29uc3QgZGVwZW5kZW5jeSBvZiBvcExpc3QuZGVwZW5kZW5jaWVzKSB7CiAgICAgIHRoaXMuZGVwZW5kZW5jaWVzLmFkZChkZXBlbmRlbmN5KTsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBvcExpc3QubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICB0aGlzLmFkZE9wKG9wTGlzdC5mbkFycmF5W2ldLCBvcExpc3QuYXJnc0FycmF5W2ldKTsKICAgIH0KICB9CgogIGdldElSKCkgewogICAgcmV0dXJuIHsKICAgICAgZm5BcnJheTogdGhpcy5mbkFycmF5LAogICAgICBhcmdzQXJyYXk6IHRoaXMuYXJnc0FycmF5LAogICAgICBsZW5ndGg6IHRoaXMubGVuZ3RoCiAgICB9OwogIH0KCiAgZ2V0IF90cmFuc2ZlcnMoKSB7CiAgICBjb25zdCB0cmFuc2ZlcnMgPSBbXTsKICAgIGNvbnN0IHsKICAgICAgZm5BcnJheSwKICAgICAgYXJnc0FycmF5LAogICAgICBsZW5ndGgKICAgIH0gPSB0aGlzOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgc3dpdGNoIChmbkFycmF5W2ldKSB7CiAgICAgICAgY2FzZSBfdXRpbC5PUFMucGFpbnRJbmxpbmVJbWFnZVhPYmplY3Q6CiAgICAgICAgY2FzZSBfdXRpbC5PUFMucGFpbnRJbmxpbmVJbWFnZVhPYmplY3RHcm91cDoKICAgICAgICBjYXNlIF91dGlsLk9QUy5wYWludEltYWdlTWFza1hPYmplY3Q6CiAgICAgICAgICBjb25zdCBhcmcgPSBhcmdzQXJyYXlbaV1bMF07CgogICAgICAgICAgaWYgKCFhcmcuY2FjaGVkICYmIGFyZy5kYXRhICYmIGFyZy5kYXRhLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7CiAgICAgICAgICAgIHRyYW5zZmVycy5wdXNoKGFyZy5kYXRhLmJ1ZmZlcik7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdHJhbnNmZXJzOwogIH0KCiAgZmx1c2goKSB7CiAgICBsZXQgbGFzdENodW5rID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgIGxldCBzZXBhcmF0ZUFubm90cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDsKICAgIHRoaXMub3B0aW1pemVyLmZsdXNoKCk7CiAgICBjb25zdCBsZW5ndGggPSB0aGlzLmxlbmd0aDsKICAgIHRoaXMuX3RvdGFsTGVuZ3RoICs9IGxlbmd0aDsKCiAgICB0aGlzLl9zdHJlYW1TaW5rLmVucXVldWUoewogICAgICBmbkFycmF5OiB0aGlzLmZuQXJyYXksCiAgICAgIGFyZ3NBcnJheTogdGhpcy5hcmdzQXJyYXksCiAgICAgIGxhc3RDaHVuaywKICAgICAgc2VwYXJhdGVBbm5vdHMsCiAgICAgIGxlbmd0aAogICAgfSwgMSwgdGhpcy5fdHJhbnNmZXJzKTsKCiAgICB0aGlzLmRlcGVuZGVuY2llcy5jbGVhcigpOwogICAgdGhpcy5mbkFycmF5Lmxlbmd0aCA9IDA7CiAgICB0aGlzLmFyZ3NBcnJheS5sZW5ndGggPSAwOwogICAgdGhpcy53ZWlnaHQgPSAwOwogICAgdGhpcy5vcHRpbWl6ZXIucmVzZXQoKTsKICB9Cgp9CgpleHBvcnRzLk9wZXJhdG9yTGlzdCA9IE9wZXJhdG9yTGlzdDsKCi8qKiovIH0pLAovKiAxODggKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlBERkltYWdlID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfaW1hZ2VfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE4OSk7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzIpOwoKdmFyIF9jb2xvcnNwYWNlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzkpOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDQpOwoKdmFyIF9qcGVnX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTUyKTsKCnZhciBfanB4ID0gX193X3BkZmpzX3JlcXVpcmVfXygxNTUpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwoKZnVuY3Rpb24gZGVjb2RlQW5kQ2xhbXAodmFsdWUsIGFkZGVuZCwgY29lZmZpY2llbnQsIG1heCkgewogIHZhbHVlID0gYWRkZW5kICsgdmFsdWUgKiBjb2VmZmljaWVudDsKCiAgaWYgKHZhbHVlIDwgMCkgewogICAgdmFsdWUgPSAwOwogIH0gZWxzZSBpZiAodmFsdWUgPiBtYXgpIHsKICAgIHZhbHVlID0gbWF4OwogIH0KCiAgcmV0dXJuIHZhbHVlOwp9CgpmdW5jdGlvbiByZXNpemVJbWFnZU1hc2soc3JjLCBicGMsIHcxLCBoMSwgdzIsIGgyKSB7CiAgY29uc3QgbGVuZ3RoID0gdzIgKiBoMjsKICBsZXQgZGVzdDsKCiAgaWYgKGJwYyA8PSA4KSB7CiAgICBkZXN0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTsKICB9IGVsc2UgaWYgKGJwYyA8PSAxNikgewogICAgZGVzdCA9IG5ldyBVaW50MTZBcnJheShsZW5ndGgpOwogIH0gZWxzZSB7CiAgICBkZXN0ID0gbmV3IFVpbnQzMkFycmF5KGxlbmd0aCk7CiAgfQoKICBjb25zdCB4UmF0aW8gPSB3MSAvIHcyOwogIGNvbnN0IHlSYXRpbyA9IGgxIC8gaDI7CiAgbGV0IGksCiAgICAgIGosCiAgICAgIHB5LAogICAgICBuZXdJbmRleCA9IDAsCiAgICAgIG9sZEluZGV4OwogIGNvbnN0IHhTY2FsZWQgPSBuZXcgVWludDE2QXJyYXkodzIpOwogIGNvbnN0IHcxU2NhbmxpbmUgPSB3MTsKCiAgZm9yIChpID0gMDsgaSA8IHcyOyBpKyspIHsKICAgIHhTY2FsZWRbaV0gPSBNYXRoLmZsb29yKGkgKiB4UmF0aW8pOwogIH0KCiAgZm9yIChpID0gMDsgaSA8IGgyOyBpKyspIHsKICAgIHB5ID0gTWF0aC5mbG9vcihpICogeVJhdGlvKSAqIHcxU2NhbmxpbmU7CgogICAgZm9yIChqID0gMDsgaiA8IHcyOyBqKyspIHsKICAgICAgb2xkSW5kZXggPSBweSArIHhTY2FsZWRbal07CiAgICAgIGRlc3RbbmV3SW5kZXgrK10gPSBzcmNbb2xkSW5kZXhdOwogICAgfQogIH0KCiAgcmV0dXJuIGRlc3Q7Cn0KCmNsYXNzIFBERkltYWdlIHsKICBjb25zdHJ1Y3RvcihfcmVmKSB7CiAgICBsZXQgewogICAgICB4cmVmLAogICAgICByZXMsCiAgICAgIGltYWdlLAogICAgICBpc0lubGluZSA9IGZhbHNlLAogICAgICBzbWFzayA9IG51bGwsCiAgICAgIG1hc2sgPSBudWxsLAogICAgICBpc01hc2sgPSBmYWxzZSwKICAgICAgcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgfSA9IF9yZWY7CiAgICB0aGlzLmltYWdlID0gaW1hZ2U7CiAgICBjb25zdCBkaWN0ID0gaW1hZ2UuZGljdDsKICAgIGNvbnN0IGZpbHRlciA9IGRpY3QuZ2V0KCJGIiwgIkZpbHRlciIpOwogICAgbGV0IGZpbHRlck5hbWU7CgogICAgaWYgKGZpbHRlciBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgZmlsdGVyTmFtZSA9IGZpbHRlci5uYW1lOwogICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGZpbHRlcikpIHsKICAgICAgY29uc3QgZmlsdGVyWmVybyA9IHhyZWYuZmV0Y2hJZlJlZihmaWx0ZXJbMF0pOwoKICAgICAgaWYgKGZpbHRlclplcm8gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgZmlsdGVyTmFtZSA9IGZpbHRlclplcm8ubmFtZTsKICAgICAgfQogICAgfQoKICAgIHN3aXRjaCAoZmlsdGVyTmFtZSkgewogICAgICBjYXNlICJKUFhEZWNvZGUiOgogICAgICAgIGNvbnN0IGpweEltYWdlID0gbmV3IF9qcHguSnB4SW1hZ2UoKTsKICAgICAgICBqcHhJbWFnZS5wYXJzZUltYWdlUHJvcGVydGllcyhpbWFnZS5zdHJlYW0pOwogICAgICAgIGltYWdlLnN0cmVhbS5yZXNldCgpOwogICAgICAgIGltYWdlLndpZHRoID0ganB4SW1hZ2Uud2lkdGg7CiAgICAgICAgaW1hZ2UuaGVpZ2h0ID0ganB4SW1hZ2UuaGVpZ2h0OwogICAgICAgIGltYWdlLmJpdHNQZXJDb21wb25lbnQgPSBqcHhJbWFnZS5iaXRzUGVyQ29tcG9uZW50OwogICAgICAgIGltYWdlLm51bUNvbXBzID0ganB4SW1hZ2UuY29tcG9uZW50c0NvdW50OwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiSkJJRzJEZWNvZGUiOgogICAgICAgIGltYWdlLmJpdHNQZXJDb21wb25lbnQgPSAxOwogICAgICAgIGltYWdlLm51bUNvbXBzID0gMTsKICAgICAgICBicmVhazsKICAgIH0KCiAgICBsZXQgd2lkdGggPSBkaWN0LmdldCgiVyIsICJXaWR0aCIpOwogICAgbGV0IGhlaWdodCA9IGRpY3QuZ2V0KCJIIiwgIkhlaWdodCIpOwoKICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKGltYWdlLndpZHRoKSAmJiBpbWFnZS53aWR0aCA+IDAgJiYgTnVtYmVyLmlzSW50ZWdlcihpbWFnZS5oZWlnaHQpICYmIGltYWdlLmhlaWdodCA+IDAgJiYgKGltYWdlLndpZHRoICE9PSB3aWR0aCB8fCBpbWFnZS5oZWlnaHQgIT09IGhlaWdodCkpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJQREZJbWFnZSAtIHVzaW5nIHRoZSBXaWR0aC9IZWlnaHQgb2YgdGhlIGltYWdlIGRhdGEsICIgKyAicmF0aGVyIHRoYW4gdGhlIGltYWdlIGRpY3Rpb25hcnkuIik7CiAgICAgIHdpZHRoID0gaW1hZ2Uud2lkdGg7CiAgICAgIGhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgIH0KCiAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBJbnZhbGlkIGltYWdlIHdpZHRoOiAke3dpZHRofSBvciBoZWlnaHQ6ICR7aGVpZ2h0fWApOwogICAgfQoKICAgIHRoaXMud2lkdGggPSB3aWR0aDsKICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwogICAgdGhpcy5pbnRlcnBvbGF0ZSA9IGRpY3QuZ2V0KCJJIiwgIkludGVycG9sYXRlIik7CiAgICB0aGlzLmltYWdlTWFzayA9IGRpY3QuZ2V0KCJJTSIsICJJbWFnZU1hc2siKSB8fCBmYWxzZTsKICAgIHRoaXMubWF0dGUgPSBkaWN0LmdldCgiTWF0dGUiKSB8fCBmYWxzZTsKICAgIGxldCBiaXRzUGVyQ29tcG9uZW50ID0gaW1hZ2UuYml0c1BlckNvbXBvbmVudDsKCiAgICBpZiAoIWJpdHNQZXJDb21wb25lbnQpIHsKICAgICAgYml0c1BlckNvbXBvbmVudCA9IGRpY3QuZ2V0KCJCUEMiLCAiQml0c1BlckNvbXBvbmVudCIpOwoKICAgICAgaWYgKCFiaXRzUGVyQ29tcG9uZW50KSB7CiAgICAgICAgaWYgKHRoaXMuaW1hZ2VNYXNrKSB7CiAgICAgICAgICBiaXRzUGVyQ29tcG9uZW50ID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBCaXRzIHBlciBjb21wb25lbnQgbWlzc2luZyBpbiBpbWFnZTogJHt0aGlzLmltYWdlTWFza31gKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLmJwYyA9IGJpdHNQZXJDb21wb25lbnQ7CgogICAgaWYgKCF0aGlzLmltYWdlTWFzaykgewogICAgICBsZXQgY29sb3JTcGFjZSA9IGRpY3QuZ2V0UmF3KCJDUyIpIHx8IGRpY3QuZ2V0UmF3KCJDb2xvclNwYWNlIik7CgogICAgICBpZiAoIWNvbG9yU3BhY2UpIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkpQWCBpbWFnZXMgKHdoaWNoIGRvIG5vdCByZXF1aXJlIGNvbG9yIHNwYWNlcykiKTsKCiAgICAgICAgc3dpdGNoIChpbWFnZS5udW1Db21wcykgewogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjb2xvclNwYWNlID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkRldmljZUdyYXkiKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjb2xvclNwYWNlID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkRldmljZVJHQiIpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGNvbG9yU3BhY2UgPSBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRGV2aWNlQ01ZSyIpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEpQWCBpbWFnZXMgd2l0aCAke2ltYWdlLm51bUNvbXBzfSBjb2xvciBjb21wb25lbnRzIG5vdCBzdXBwb3J0ZWQuYCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmNvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnBhcnNlKHsKICAgICAgICBjczogY29sb3JTcGFjZSwKICAgICAgICB4cmVmLAogICAgICAgIHJlc291cmNlczogaXNJbmxpbmUgPyByZXMgOiBudWxsLAogICAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeSwKICAgICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgICB9KTsKICAgICAgdGhpcy5udW1Db21wcyA9IHRoaXMuY29sb3JTcGFjZS5udW1Db21wczsKICAgIH0KCiAgICB0aGlzLmRlY29kZSA9IGRpY3QuZ2V0QXJyYXkoIkQiLCAiRGVjb2RlIik7CiAgICB0aGlzLm5lZWRzRGVjb2RlID0gZmFsc2U7CgogICAgaWYgKHRoaXMuZGVjb2RlICYmICh0aGlzLmNvbG9yU3BhY2UgJiYgIXRoaXMuY29sb3JTcGFjZS5pc0RlZmF1bHREZWNvZGUodGhpcy5kZWNvZGUsIGJpdHNQZXJDb21wb25lbnQpIHx8IGlzTWFzayAmJiAhX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5pc0RlZmF1bHREZWNvZGUodGhpcy5kZWNvZGUsIDEpKSkgewogICAgICB0aGlzLm5lZWRzRGVjb2RlID0gdHJ1ZTsKICAgICAgY29uc3QgbWF4ID0gKDEgPDwgYml0c1BlckNvbXBvbmVudCkgLSAxOwogICAgICB0aGlzLmRlY29kZUNvZWZmaWNpZW50cyA9IFtdOwogICAgICB0aGlzLmRlY29kZUFkZGVuZHMgPSBbXTsKICAgICAgY29uc3QgaXNJbmRleGVkID0gdGhpcy5jb2xvclNwYWNlICYmIHRoaXMuY29sb3JTcGFjZS5uYW1lID09PSAiSW5kZXhlZCI7CgogICAgICBmb3IgKGxldCBpID0gMCwgaiA9IDA7IGkgPCB0aGlzLmRlY29kZS5sZW5ndGg7IGkgKz0gMiwgKytqKSB7CiAgICAgICAgY29uc3QgZG1pbiA9IHRoaXMuZGVjb2RlW2ldOwogICAgICAgIGNvbnN0IGRtYXggPSB0aGlzLmRlY29kZVtpICsgMV07CiAgICAgICAgdGhpcy5kZWNvZGVDb2VmZmljaWVudHNbal0gPSBpc0luZGV4ZWQgPyAoZG1heCAtIGRtaW4pIC8gbWF4IDogZG1heCAtIGRtaW47CiAgICAgICAgdGhpcy5kZWNvZGVBZGRlbmRzW2pdID0gaXNJbmRleGVkID8gZG1pbiA6IG1heCAqIGRtaW47CiAgICAgIH0KICAgIH0KCiAgICBpZiAoc21hc2spIHsKICAgICAgdGhpcy5zbWFzayA9IG5ldyBQREZJbWFnZSh7CiAgICAgICAgeHJlZiwKICAgICAgICByZXMsCiAgICAgICAgaW1hZ2U6IHNtYXNrLAogICAgICAgIGlzSW5saW5lLAogICAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeSwKICAgICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgICB9KTsKICAgIH0gZWxzZSBpZiAobWFzaykgewogICAgICBpZiAobWFzayBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgICAgY29uc3QgbWFza0RpY3QgPSBtYXNrLmRpY3QsCiAgICAgICAgICAgICAgaW1hZ2VNYXNrID0gbWFza0RpY3QuZ2V0KCJJTSIsICJJbWFnZU1hc2siKTsKCiAgICAgICAgaWYgKCFpbWFnZU1hc2spIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSWdub3JpbmcgL01hc2sgaW4gaW1hZ2Ugd2l0aG91dCAvSW1hZ2VNYXNrLiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLm1hc2sgPSBuZXcgUERGSW1hZ2UoewogICAgICAgICAgICB4cmVmLAogICAgICAgICAgICByZXMsCiAgICAgICAgICAgIGltYWdlOiBtYXNrLAogICAgICAgICAgICBpc0lubGluZSwKICAgICAgICAgICAgaXNNYXNrOiB0cnVlLAogICAgICAgICAgICBwZGZGdW5jdGlvbkZhY3RvcnksCiAgICAgICAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5tYXNrID0gbWFzazsKICAgICAgfQogICAgfQogIH0KCiAgc3RhdGljIGFzeW5jIGJ1aWxkSW1hZ2UoX3JlZjIpIHsKICAgIGxldCB7CiAgICAgIHhyZWYsCiAgICAgIHJlcywKICAgICAgaW1hZ2UsCiAgICAgIGlzSW5saW5lID0gZmFsc2UsCiAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeSwKICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgIH0gPSBfcmVmMjsKICAgIGNvbnN0IGltYWdlRGF0YSA9IGltYWdlOwogICAgbGV0IHNtYXNrRGF0YSA9IG51bGw7CiAgICBsZXQgbWFza0RhdGEgPSBudWxsOwogICAgY29uc3Qgc21hc2sgPSBpbWFnZS5kaWN0LmdldCgiU01hc2siKTsKICAgIGNvbnN0IG1hc2sgPSBpbWFnZS5kaWN0LmdldCgiTWFzayIpOwoKICAgIGlmIChzbWFzaykgewogICAgICBpZiAoc21hc2sgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgIHNtYXNrRGF0YSA9IHNtYXNrOwogICAgICB9IGVsc2UgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiVW5zdXBwb3J0ZWQgL1NNYXNrIGZvcm1hdC4iKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChtYXNrKSB7CiAgICAgIGlmIChtYXNrIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0gfHwgQXJyYXkuaXNBcnJheShtYXNrKSkgewogICAgICAgIG1hc2tEYXRhID0gbWFzazsKICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIlVuc3VwcG9ydGVkIC9NYXNrIGZvcm1hdC4iKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBuZXcgUERGSW1hZ2UoewogICAgICB4cmVmLAogICAgICByZXMsCiAgICAgIGltYWdlOiBpbWFnZURhdGEsCiAgICAgIGlzSW5saW5lLAogICAgICBzbWFzazogc21hc2tEYXRhLAogICAgICBtYXNrOiBtYXNrRGF0YSwKICAgICAgcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgfSk7CiAgfQoKICBzdGF0aWMgY3JlYXRlUmF3TWFzayhfcmVmMykgewogICAgbGV0IHsKICAgICAgaW1nQXJyYXksCiAgICAgIHdpZHRoLAogICAgICBoZWlnaHQsCiAgICAgIGltYWdlSXNGcm9tRGVjb2RlU3RyZWFtLAogICAgICBpbnZlcnNlRGVjb2RlLAogICAgICBpbnRlcnBvbGF0ZQogICAgfSA9IF9yZWYzOwogICAgY29uc3QgY29tcHV0ZWRMZW5ndGggPSAod2lkdGggKyA3ID4+IDMpICogaGVpZ2h0OwogICAgY29uc3QgYWN0dWFsTGVuZ3RoID0gaW1nQXJyYXkuYnl0ZUxlbmd0aDsKICAgIGNvbnN0IGhhdmVGdWxsRGF0YSA9IGNvbXB1dGVkTGVuZ3RoID09PSBhY3R1YWxMZW5ndGg7CiAgICBsZXQgZGF0YSwgaTsKCiAgICBpZiAoaW1hZ2VJc0Zyb21EZWNvZGVTdHJlYW0gJiYgKCFpbnZlcnNlRGVjb2RlIHx8IGhhdmVGdWxsRGF0YSkpIHsKICAgICAgZGF0YSA9IGltZ0FycmF5OwogICAgfSBlbHNlIGlmICghaW52ZXJzZURlY29kZSkgewogICAgICBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoaW1nQXJyYXkpOwogICAgfSBlbHNlIHsKICAgICAgZGF0YSA9IG5ldyBVaW50OEFycmF5KGNvbXB1dGVkTGVuZ3RoKTsKICAgICAgZGF0YS5zZXQoaW1nQXJyYXkpOwogICAgICBkYXRhLmZpbGwoMHhmZiwgYWN0dWFsTGVuZ3RoKTsKICAgIH0KCiAgICBpZiAoaW52ZXJzZURlY29kZSkgewogICAgICBmb3IgKGkgPSAwOyBpIDwgYWN0dWFsTGVuZ3RoOyBpKyspIHsKICAgICAgICBkYXRhW2ldIF49IDB4ZmY7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gewogICAgICBkYXRhLAogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICBpbnRlcnBvbGF0ZQogICAgfTsKICB9CgogIHN0YXRpYyBjcmVhdGVNYXNrKF9yZWY0KSB7CiAgICBsZXQgewogICAgICBpbWdBcnJheSwKICAgICAgd2lkdGgsCiAgICAgIGhlaWdodCwKICAgICAgaW1hZ2VJc0Zyb21EZWNvZGVTdHJlYW0sCiAgICAgIGludmVyc2VEZWNvZGUsCiAgICAgIGludGVycG9sYXRlCiAgICB9ID0gX3JlZjQ7CiAgICBjb25zdCBpc1NpbmdsZU9wYXF1ZVBpeGVsID0gd2lkdGggPT09IDEgJiYgaGVpZ2h0ID09PSAxICYmIGludmVyc2VEZWNvZGUgPT09IChpbWdBcnJheS5sZW5ndGggPT09IDAgfHwgISEoaW1nQXJyYXlbMF0gJiAxMjgpKTsKCiAgICBpZiAoaXNTaW5nbGVPcGFxdWVQaXhlbCkgewogICAgICByZXR1cm4gewogICAgICAgIGlzU2luZ2xlT3BhcXVlUGl4ZWwKICAgICAgfTsKICAgIH0KCiAgICBpZiAoX3V0aWwuRmVhdHVyZVRlc3QuaXNPZmZzY3JlZW5DYW52YXNTdXBwb3J0ZWQpIHsKICAgICAgY29uc3QgY2FudmFzID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGltZ0RhdGEgPSBjdHguY3JlYXRlSW1hZ2VEYXRhKHdpZHRoLCBoZWlnaHQpOwogICAgICAoMCwgX2ltYWdlX3V0aWxzLmFwcGx5TWFza0ltYWdlRGF0YSkoewogICAgICAgIHNyYzogaW1nQXJyYXksCiAgICAgICAgZGVzdDogaW1nRGF0YS5kYXRhLAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBpbnZlcnNlRGVjb2RlCiAgICAgIH0pOwogICAgICBjdHgucHV0SW1hZ2VEYXRhKGltZ0RhdGEsIDAsIDApOwogICAgICBjb25zdCBiaXRtYXAgPSBjYW52YXMudHJhbnNmZXJUb0ltYWdlQml0bWFwKCk7CiAgICAgIHJldHVybiB7CiAgICAgICAgZGF0YTogbnVsbCwKICAgICAgICB3aWR0aCwKICAgICAgICBoZWlnaHQsCiAgICAgICAgaW50ZXJwb2xhdGUsCiAgICAgICAgYml0bWFwCiAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIHRoaXMuY3JlYXRlUmF3TWFzayh7CiAgICAgIGltZ0FycmF5LAogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICBpbnZlcnNlRGVjb2RlLAogICAgICBpbWFnZUlzRnJvbURlY29kZVN0cmVhbSwKICAgICAgaW50ZXJwb2xhdGUKICAgIH0pOwogIH0KCiAgZ2V0IGRyYXdXaWR0aCgpIHsKICAgIHJldHVybiBNYXRoLm1heCh0aGlzLndpZHRoLCB0aGlzLnNtYXNrICYmIHRoaXMuc21hc2sud2lkdGggfHwgMCwgdGhpcy5tYXNrICYmIHRoaXMubWFzay53aWR0aCB8fCAwKTsKICB9CgogIGdldCBkcmF3SGVpZ2h0KCkgewogICAgcmV0dXJuIE1hdGgubWF4KHRoaXMuaGVpZ2h0LCB0aGlzLnNtYXNrICYmIHRoaXMuc21hc2suaGVpZ2h0IHx8IDAsIHRoaXMubWFzayAmJiB0aGlzLm1hc2suaGVpZ2h0IHx8IDApOwogIH0KCiAgZGVjb2RlQnVmZmVyKGJ1ZmZlcikgewogICAgY29uc3QgYnBjID0gdGhpcy5icGM7CiAgICBjb25zdCBudW1Db21wcyA9IHRoaXMubnVtQ29tcHM7CiAgICBjb25zdCBkZWNvZGVBZGRlbmRzID0gdGhpcy5kZWNvZGVBZGRlbmRzOwogICAgY29uc3QgZGVjb2RlQ29lZmZpY2llbnRzID0gdGhpcy5kZWNvZGVDb2VmZmljaWVudHM7CiAgICBjb25zdCBtYXggPSAoMSA8PCBicGMpIC0gMTsKICAgIGxldCBpLCBpaTsKCiAgICBpZiAoYnBjID09PSAxKSB7CiAgICAgIGZvciAoaSA9IDAsIGlpID0gYnVmZmVyLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBidWZmZXJbaV0gPSArIWJ1ZmZlcltpXTsKICAgICAgfQoKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBpbmRleCA9IDA7CgogICAgZm9yIChpID0gMCwgaWkgPSB0aGlzLndpZHRoICogdGhpcy5oZWlnaHQ7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbnVtQ29tcHM7IGorKykgewogICAgICAgIGJ1ZmZlcltpbmRleF0gPSBkZWNvZGVBbmRDbGFtcChidWZmZXJbaW5kZXhdLCBkZWNvZGVBZGRlbmRzW2pdLCBkZWNvZGVDb2VmZmljaWVudHNbal0sIG1heCk7CiAgICAgICAgaW5kZXgrKzsKICAgICAgfQogICAgfQogIH0KCiAgZ2V0Q29tcG9uZW50cyhidWZmZXIpIHsKICAgIGNvbnN0IGJwYyA9IHRoaXMuYnBjOwoKICAgIGlmIChicGMgPT09IDgpIHsKICAgICAgcmV0dXJuIGJ1ZmZlcjsKICAgIH0KCiAgICBjb25zdCB3aWR0aCA9IHRoaXMud2lkdGg7CiAgICBjb25zdCBoZWlnaHQgPSB0aGlzLmhlaWdodDsKICAgIGNvbnN0IG51bUNvbXBzID0gdGhpcy5udW1Db21wczsKICAgIGNvbnN0IGxlbmd0aCA9IHdpZHRoICogaGVpZ2h0ICogbnVtQ29tcHM7CiAgICBsZXQgYnVmZmVyUG9zID0gMDsKICAgIGxldCBvdXRwdXQ7CgogICAgaWYgKGJwYyA8PSA4KSB7CiAgICAgIG91dHB1dCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7CiAgICB9IGVsc2UgaWYgKGJwYyA8PSAxNikgewogICAgICBvdXRwdXQgPSBuZXcgVWludDE2QXJyYXkobGVuZ3RoKTsKICAgIH0gZWxzZSB7CiAgICAgIG91dHB1dCA9IG5ldyBVaW50MzJBcnJheShsZW5ndGgpOwogICAgfQoKICAgIGNvbnN0IHJvd0NvbXBzID0gd2lkdGggKiBudW1Db21wczsKICAgIGNvbnN0IG1heCA9ICgxIDw8IGJwYykgLSAxOwogICAgbGV0IGkgPSAwLAogICAgICAgIGlpLAogICAgICAgIGJ1ZjsKCiAgICBpZiAoYnBjID09PSAxKSB7CiAgICAgIGxldCBtYXNrLCBsb29wMUVuZCwgbG9vcDJFbmQ7CgogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGhlaWdodDsgaisrKSB7CiAgICAgICAgbG9vcDFFbmQgPSBpICsgKHJvd0NvbXBzICYgfjcpOwogICAgICAgIGxvb3AyRW5kID0gaSArIHJvd0NvbXBzOwoKICAgICAgICB3aGlsZSAoaSA8IGxvb3AxRW5kKSB7CiAgICAgICAgICBidWYgPSBidWZmZXJbYnVmZmVyUG9zKytdOwogICAgICAgICAgb3V0cHV0W2ldID0gYnVmID4+IDcgJiAxOwogICAgICAgICAgb3V0cHV0W2kgKyAxXSA9IGJ1ZiA+PiA2ICYgMTsKICAgICAgICAgIG91dHB1dFtpICsgMl0gPSBidWYgPj4gNSAmIDE7CiAgICAgICAgICBvdXRwdXRbaSArIDNdID0gYnVmID4+IDQgJiAxOwogICAgICAgICAgb3V0cHV0W2kgKyA0XSA9IGJ1ZiA+PiAzICYgMTsKICAgICAgICAgIG91dHB1dFtpICsgNV0gPSBidWYgPj4gMiAmIDE7CiAgICAgICAgICBvdXRwdXRbaSArIDZdID0gYnVmID4+IDEgJiAxOwogICAgICAgICAgb3V0cHV0W2kgKyA3XSA9IGJ1ZiAmIDE7CiAgICAgICAgICBpICs9IDg7CiAgICAgICAgfQoKICAgICAgICBpZiAoaSA8IGxvb3AyRW5kKSB7CiAgICAgICAgICBidWYgPSBidWZmZXJbYnVmZmVyUG9zKytdOwogICAgICAgICAgbWFzayA9IDEyODsKCiAgICAgICAgICB3aGlsZSAoaSA8IGxvb3AyRW5kKSB7CiAgICAgICAgICAgIG91dHB1dFtpKytdID0gKyEhKGJ1ZiAmIG1hc2spOwogICAgICAgICAgICBtYXNrID4+PSAxOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbGV0IGJpdHMgPSAwOwogICAgICBidWYgPSAwOwoKICAgICAgZm9yIChpID0gMCwgaWkgPSBsZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgaWYgKGkgJSByb3dDb21wcyA9PT0gMCkgewogICAgICAgICAgYnVmID0gMDsKICAgICAgICAgIGJpdHMgPSAwOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKGJpdHMgPCBicGMpIHsKICAgICAgICAgIGJ1ZiA9IGJ1ZiA8PCA4IHwgYnVmZmVyW2J1ZmZlclBvcysrXTsKICAgICAgICAgIGJpdHMgKz0gODsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHJlbWFpbmluZ0JpdHMgPSBiaXRzIC0gYnBjOwogICAgICAgIGxldCB2YWx1ZSA9IGJ1ZiA+PiByZW1haW5pbmdCaXRzOwoKICAgICAgICBpZiAodmFsdWUgPCAwKSB7CiAgICAgICAgICB2YWx1ZSA9IDA7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+IG1heCkgewogICAgICAgICAgdmFsdWUgPSBtYXg7CiAgICAgICAgfQoKICAgICAgICBvdXRwdXRbaV0gPSB2YWx1ZTsKICAgICAgICBidWYgJj0gKDEgPDwgcmVtYWluaW5nQml0cykgLSAxOwogICAgICAgIGJpdHMgPSByZW1haW5pbmdCaXRzOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG91dHB1dDsKICB9CgogIGZpbGxPcGFjaXR5KHJnYmFCdWYsIHdpZHRoLCBoZWlnaHQsIGFjdHVhbEhlaWdodCwgaW1hZ2UpIHsKICAgIGNvbnN0IHNtYXNrID0gdGhpcy5zbWFzazsKICAgIGNvbnN0IG1hc2sgPSB0aGlzLm1hc2s7CiAgICBsZXQgYWxwaGFCdWYsIHN3LCBzaCwgaSwgaWksIGo7CgogICAgaWYgKHNtYXNrKSB7CiAgICAgIHN3ID0gc21hc2sud2lkdGg7CiAgICAgIHNoID0gc21hc2suaGVpZ2h0OwogICAgICBhbHBoYUJ1ZiA9IG5ldyBVaW50OENsYW1wZWRBcnJheShzdyAqIHNoKTsKICAgICAgc21hc2suZmlsbEdyYXlCdWZmZXIoYWxwaGFCdWYpOwoKICAgICAgaWYgKHN3ICE9PSB3aWR0aCB8fCBzaCAhPT0gaGVpZ2h0KSB7CiAgICAgICAgYWxwaGFCdWYgPSByZXNpemVJbWFnZU1hc2soYWxwaGFCdWYsIHNtYXNrLmJwYywgc3csIHNoLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgfQogICAgfSBlbHNlIGlmIChtYXNrKSB7CiAgICAgIGlmIChtYXNrIGluc3RhbmNlb2YgUERGSW1hZ2UpIHsKICAgICAgICBzdyA9IG1hc2sud2lkdGg7CiAgICAgICAgc2ggPSBtYXNrLmhlaWdodDsKICAgICAgICBhbHBoYUJ1ZiA9IG5ldyBVaW50OENsYW1wZWRBcnJheShzdyAqIHNoKTsKICAgICAgICBtYXNrLm51bUNvbXBzID0gMTsKICAgICAgICBtYXNrLmZpbGxHcmF5QnVmZmVyKGFscGhhQnVmKTsKCiAgICAgICAgZm9yIChpID0gMCwgaWkgPSBzdyAqIHNoOyBpIDwgaWk7ICsraSkgewogICAgICAgICAgYWxwaGFCdWZbaV0gPSAyNTUgLSBhbHBoYUJ1ZltpXTsKICAgICAgICB9CgogICAgICAgIGlmIChzdyAhPT0gd2lkdGggfHwgc2ggIT09IGhlaWdodCkgewogICAgICAgICAgYWxwaGFCdWYgPSByZXNpemVJbWFnZU1hc2soYWxwaGFCdWYsIG1hc2suYnBjLCBzdywgc2gsIHdpZHRoLCBoZWlnaHQpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KG1hc2spKSB7CiAgICAgICAgYWxwaGFCdWYgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwogICAgICAgIGNvbnN0IG51bUNvbXBzID0gdGhpcy5udW1Db21wczsKCiAgICAgICAgZm9yIChpID0gMCwgaWkgPSB3aWR0aCAqIGhlaWdodDsgaSA8IGlpOyArK2kpIHsKICAgICAgICAgIGxldCBvcGFjaXR5ID0gMDsKICAgICAgICAgIGNvbnN0IGltYWdlT2Zmc2V0ID0gaSAqIG51bUNvbXBzOwoKICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBudW1Db21wczsgKytqKSB7CiAgICAgICAgICAgIGNvbnN0IGNvbG9yID0gaW1hZ2VbaW1hZ2VPZmZzZXQgKyBqXTsKICAgICAgICAgICAgY29uc3QgbWFza09mZnNldCA9IGogKiAyOwoKICAgICAgICAgICAgaWYgKGNvbG9yIDwgbWFza1ttYXNrT2Zmc2V0XSB8fCBjb2xvciA+IG1hc2tbbWFza09mZnNldCArIDFdKSB7CiAgICAgICAgICAgICAgb3BhY2l0eSA9IDI1NTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGFscGhhQnVmW2ldID0gb3BhY2l0eTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbmtub3duIG1hc2sgZm9ybWF0LiIpOwogICAgICB9CiAgICB9CgogICAgaWYgKGFscGhhQnVmKSB7CiAgICAgIGZvciAoaSA9IDAsIGogPSAzLCBpaSA9IHdpZHRoICogYWN0dWFsSGVpZ2h0OyBpIDwgaWk7ICsraSwgaiArPSA0KSB7CiAgICAgICAgcmdiYUJ1ZltqXSA9IGFscGhhQnVmW2ldOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBmb3IgKGkgPSAwLCBqID0gMywgaWkgPSB3aWR0aCAqIGFjdHVhbEhlaWdodDsgaSA8IGlpOyArK2ksIGogKz0gNCkgewogICAgICAgIHJnYmFCdWZbal0gPSAyNTU7CiAgICAgIH0KICAgIH0KICB9CgogIHVuZG9QcmVibGVuZChidWZmZXIsIHdpZHRoLCBoZWlnaHQpIHsKICAgIGNvbnN0IG1hdHRlID0gdGhpcy5zbWFzayAmJiB0aGlzLnNtYXNrLm1hdHRlOwoKICAgIGlmICghbWF0dGUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG1hdHRlUmdiID0gdGhpcy5jb2xvclNwYWNlLmdldFJnYihtYXR0ZSwgMCk7CiAgICBjb25zdCBtYXR0ZVIgPSBtYXR0ZVJnYlswXTsKICAgIGNvbnN0IG1hdHRlRyA9IG1hdHRlUmdiWzFdOwogICAgY29uc3QgbWF0dGVCID0gbWF0dGVSZ2JbMl07CiAgICBjb25zdCBsZW5ndGggPSB3aWR0aCAqIGhlaWdodCAqIDQ7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gNCkgewogICAgICBjb25zdCBhbHBoYSA9IGJ1ZmZlcltpICsgM107CgogICAgICBpZiAoYWxwaGEgPT09IDApIHsKICAgICAgICBidWZmZXJbaV0gPSAyNTU7CiAgICAgICAgYnVmZmVyW2kgKyAxXSA9IDI1NTsKICAgICAgICBidWZmZXJbaSArIDJdID0gMjU1OwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBrID0gMjU1IC8gYWxwaGE7CiAgICAgIGJ1ZmZlcltpXSA9IChidWZmZXJbaV0gLSBtYXR0ZVIpICogayArIG1hdHRlUjsKICAgICAgYnVmZmVyW2kgKyAxXSA9IChidWZmZXJbaSArIDFdIC0gbWF0dGVHKSAqIGsgKyBtYXR0ZUc7CiAgICAgIGJ1ZmZlcltpICsgMl0gPSAoYnVmZmVyW2kgKyAyXSAtIG1hdHRlQikgKiBrICsgbWF0dGVCOwogICAgfQogIH0KCiAgY3JlYXRlSW1hZ2VEYXRhKCkgewogICAgbGV0IGZvcmNlUkdCQSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CiAgICBjb25zdCBkcmF3V2lkdGggPSB0aGlzLmRyYXdXaWR0aDsKICAgIGNvbnN0IGRyYXdIZWlnaHQgPSB0aGlzLmRyYXdIZWlnaHQ7CiAgICBjb25zdCBpbWdEYXRhID0gewogICAgICB3aWR0aDogZHJhd1dpZHRoLAogICAgICBoZWlnaHQ6IGRyYXdIZWlnaHQsCiAgICAgIGludGVycG9sYXRlOiB0aGlzLmludGVycG9sYXRlLAogICAgICBraW5kOiAwLAogICAgICBkYXRhOiBudWxsCiAgICB9OwogICAgY29uc3QgbnVtQ29tcHMgPSB0aGlzLm51bUNvbXBzOwogICAgY29uc3Qgb3JpZ2luYWxXaWR0aCA9IHRoaXMud2lkdGg7CiAgICBjb25zdCBvcmlnaW5hbEhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgY29uc3QgYnBjID0gdGhpcy5icGM7CiAgICBjb25zdCByb3dCeXRlcyA9IG9yaWdpbmFsV2lkdGggKiBudW1Db21wcyAqIGJwYyArIDcgPj4gMzsKCiAgICBpZiAoIWZvcmNlUkdCQSkgewogICAgICBsZXQga2luZDsKCiAgICAgIGlmICh0aGlzLmNvbG9yU3BhY2UubmFtZSA9PT0gIkRldmljZUdyYXkiICYmIGJwYyA9PT0gMSkgewogICAgICAgIGtpbmQgPSBfdXRpbC5JbWFnZUtpbmQuR1JBWVNDQUxFXzFCUFA7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5jb2xvclNwYWNlLm5hbWUgPT09ICJEZXZpY2VSR0IiICYmIGJwYyA9PT0gOCAmJiAhdGhpcy5uZWVkc0RlY29kZSkgewogICAgICAgIGtpbmQgPSBfdXRpbC5JbWFnZUtpbmQuUkdCXzI0QlBQOwogICAgICB9CgogICAgICBpZiAoa2luZCAmJiAhdGhpcy5zbWFzayAmJiAhdGhpcy5tYXNrICYmIGRyYXdXaWR0aCA9PT0gb3JpZ2luYWxXaWR0aCAmJiBkcmF3SGVpZ2h0ID09PSBvcmlnaW5hbEhlaWdodCkgewogICAgICAgIGltZ0RhdGEua2luZCA9IGtpbmQ7CiAgICAgICAgaW1nRGF0YS5kYXRhID0gdGhpcy5nZXRJbWFnZUJ5dGVzKG9yaWdpbmFsSGVpZ2h0ICogcm93Qnl0ZXMsIHt9KTsKCiAgICAgICAgaWYgKHRoaXMubmVlZHNEZWNvZGUpIHsKICAgICAgICAgICgwLCBfdXRpbC5hc3NlcnQpKGtpbmQgPT09IF91dGlsLkltYWdlS2luZC5HUkFZU0NBTEVfMUJQUCwgIlBERkltYWdlLmNyZWF0ZUltYWdlRGF0YTogVGhlIGltYWdlIG11c3QgYmUgZ3JheXNjYWxlLiIpOwogICAgICAgICAgY29uc3QgYnVmZmVyID0gaW1nRGF0YS5kYXRhOwoKICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGJ1ZmZlci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgIGJ1ZmZlcltpXSBePSAweGZmOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGltZ0RhdGE7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmltYWdlIGluc3RhbmNlb2YgX2pwZWdfc3RyZWFtLkpwZWdTdHJlYW0gJiYgIXRoaXMuc21hc2sgJiYgIXRoaXMubWFzaykgewogICAgICAgIGxldCBpbWFnZUxlbmd0aCA9IG9yaWdpbmFsSGVpZ2h0ICogcm93Qnl0ZXM7CgogICAgICAgIHN3aXRjaCAodGhpcy5jb2xvclNwYWNlLm5hbWUpIHsKICAgICAgICAgIGNhc2UgIkRldmljZUdyYXkiOgogICAgICAgICAgICBpbWFnZUxlbmd0aCAqPSAzOwoKICAgICAgICAgIGNhc2UgIkRldmljZVJHQiI6CiAgICAgICAgICBjYXNlICJEZXZpY2VDTVlLIjoKICAgICAgICAgICAgaW1nRGF0YS5raW5kID0gX3V0aWwuSW1hZ2VLaW5kLlJHQl8yNEJQUDsKICAgICAgICAgICAgaW1nRGF0YS5kYXRhID0gdGhpcy5nZXRJbWFnZUJ5dGVzKGltYWdlTGVuZ3RoLCB7CiAgICAgICAgICAgICAgZHJhd1dpZHRoLAogICAgICAgICAgICAgIGRyYXdIZWlnaHQsCiAgICAgICAgICAgICAgZm9yY2VSR0I6IHRydWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiBpbWdEYXRhOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGNvbnN0IGltZ0FycmF5ID0gdGhpcy5nZXRJbWFnZUJ5dGVzKG9yaWdpbmFsSGVpZ2h0ICogcm93Qnl0ZXMsIHsKICAgICAgaW50ZXJuYWw6IHRydWUKICAgIH0pOwogICAgY29uc3QgYWN0dWFsSGVpZ2h0ID0gMCB8IGltZ0FycmF5Lmxlbmd0aCAvIHJvd0J5dGVzICogZHJhd0hlaWdodCAvIG9yaWdpbmFsSGVpZ2h0OwogICAgY29uc3QgY29tcHMgPSB0aGlzLmdldENvbXBvbmVudHMoaW1nQXJyYXkpOwogICAgbGV0IGFscGhhMDEsIG1heWJlVW5kb1ByZWJsZW5kOwoKICAgIGlmICghZm9yY2VSR0JBICYmICF0aGlzLnNtYXNrICYmICF0aGlzLm1hc2spIHsKICAgICAgaW1nRGF0YS5raW5kID0gX3V0aWwuSW1hZ2VLaW5kLlJHQl8yNEJQUDsKICAgICAgaW1nRGF0YS5kYXRhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGRyYXdXaWR0aCAqIGRyYXdIZWlnaHQgKiAzKTsKICAgICAgYWxwaGEwMSA9IDA7CiAgICAgIG1heWJlVW5kb1ByZWJsZW5kID0gZmFsc2U7CiAgICB9IGVsc2UgewogICAgICBpbWdEYXRhLmtpbmQgPSBfdXRpbC5JbWFnZUtpbmQuUkdCQV8zMkJQUDsKICAgICAgaW1nRGF0YS5kYXRhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGRyYXdXaWR0aCAqIGRyYXdIZWlnaHQgKiA0KTsKICAgICAgYWxwaGEwMSA9IDE7CiAgICAgIG1heWJlVW5kb1ByZWJsZW5kID0gdHJ1ZTsKICAgICAgdGhpcy5maWxsT3BhY2l0eShpbWdEYXRhLmRhdGEsIGRyYXdXaWR0aCwgZHJhd0hlaWdodCwgYWN0dWFsSGVpZ2h0LCBjb21wcyk7CiAgICB9CgogICAgaWYgKHRoaXMubmVlZHNEZWNvZGUpIHsKICAgICAgdGhpcy5kZWNvZGVCdWZmZXIoY29tcHMpOwogICAgfQoKICAgIHRoaXMuY29sb3JTcGFjZS5maWxsUmdiKGltZ0RhdGEuZGF0YSwgb3JpZ2luYWxXaWR0aCwgb3JpZ2luYWxIZWlnaHQsIGRyYXdXaWR0aCwgZHJhd0hlaWdodCwgYWN0dWFsSGVpZ2h0LCBicGMsIGNvbXBzLCBhbHBoYTAxKTsKCiAgICBpZiAobWF5YmVVbmRvUHJlYmxlbmQpIHsKICAgICAgdGhpcy51bmRvUHJlYmxlbmQoaW1nRGF0YS5kYXRhLCBkcmF3V2lkdGgsIGFjdHVhbEhlaWdodCk7CiAgICB9CgogICAgcmV0dXJuIGltZ0RhdGE7CiAgfQoKICBmaWxsR3JheUJ1ZmZlcihidWZmZXIpIHsKICAgIGNvbnN0IG51bUNvbXBzID0gdGhpcy5udW1Db21wczsKCiAgICBpZiAobnVtQ29tcHMgIT09IDEpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBSZWFkaW5nIGdyYXkgc2NhbGUgZnJvbSBhIGNvbG9yIGltYWdlOiAke251bUNvbXBzfWApOwogICAgfQoKICAgIGNvbnN0IHdpZHRoID0gdGhpcy53aWR0aDsKICAgIGNvbnN0IGhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgY29uc3QgYnBjID0gdGhpcy5icGM7CiAgICBjb25zdCByb3dCeXRlcyA9IHdpZHRoICogbnVtQ29tcHMgKiBicGMgKyA3ID4+IDM7CiAgICBjb25zdCBpbWdBcnJheSA9IHRoaXMuZ2V0SW1hZ2VCeXRlcyhoZWlnaHQgKiByb3dCeXRlcywgewogICAgICBpbnRlcm5hbDogdHJ1ZQogICAgfSk7CiAgICBjb25zdCBjb21wcyA9IHRoaXMuZ2V0Q29tcG9uZW50cyhpbWdBcnJheSk7CiAgICBsZXQgaSwgbGVuZ3RoOwoKICAgIGlmIChicGMgPT09IDEpIHsKICAgICAgbGVuZ3RoID0gd2lkdGggKiBoZWlnaHQ7CgogICAgICBpZiAodGhpcy5uZWVkc0RlY29kZSkgewogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgICAgYnVmZmVyW2ldID0gY29tcHNbaV0gLSAxICYgMjU1OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgICAgIGJ1ZmZlcltpXSA9IC1jb21wc1tpXSAmIDI1NTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy5uZWVkc0RlY29kZSkgewogICAgICB0aGlzLmRlY29kZUJ1ZmZlcihjb21wcyk7CiAgICB9CgogICAgbGVuZ3RoID0gd2lkdGggKiBoZWlnaHQ7CiAgICBjb25zdCBzY2FsZSA9IDI1NSAvICgoMSA8PCBicGMpIC0gMSk7CgogICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgIGJ1ZmZlcltpXSA9IHNjYWxlICogY29tcHNbaV07CiAgICB9CiAgfQoKICBnZXRJbWFnZUJ5dGVzKGxlbmd0aCwgX3JlZjUpIHsKICAgIGxldCB7CiAgICAgIGRyYXdXaWR0aCwKICAgICAgZHJhd0hlaWdodCwKICAgICAgZm9yY2VSR0IgPSBmYWxzZSwKICAgICAgaW50ZXJuYWwgPSBmYWxzZQogICAgfSA9IF9yZWY1OwogICAgdGhpcy5pbWFnZS5yZXNldCgpOwogICAgdGhpcy5pbWFnZS5kcmF3V2lkdGggPSBkcmF3V2lkdGggfHwgdGhpcy53aWR0aDsKICAgIHRoaXMuaW1hZ2UuZHJhd0hlaWdodCA9IGRyYXdIZWlnaHQgfHwgdGhpcy5oZWlnaHQ7CiAgICB0aGlzLmltYWdlLmZvcmNlUkdCID0gISFmb3JjZVJHQjsKICAgIGNvbnN0IGltYWdlQnl0ZXMgPSB0aGlzLmltYWdlLmdldEJ5dGVzKGxlbmd0aCk7CgogICAgaWYgKGludGVybmFsIHx8IHRoaXMuaW1hZ2UgaW5zdGFuY2VvZiBfZGVjb2RlX3N0cmVhbS5EZWNvZGVTdHJlYW0pIHsKICAgICAgcmV0dXJuIGltYWdlQnl0ZXM7CiAgICB9CgogICAgKDAsIF91dGlsLmFzc2VydCkoaW1hZ2VCeXRlcyBpbnN0YW5jZW9mIFVpbnQ4QXJyYXksICdQREZJbWFnZS5nZXRJbWFnZUJ5dGVzOiBVbnN1cHBvcnRlZCAiaW1hZ2VCeXRlcyIgdHlwZS4nKTsKICAgIHJldHVybiBuZXcgVWludDhBcnJheShpbWFnZUJ5dGVzKTsKICB9Cgp9CgpleHBvcnRzLlBERkltYWdlID0gUERGSW1hZ2U7CgovKioqLyB9KSwKLyogMTg5ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5hcHBseU1hc2tJbWFnZURhdGEgPSBhcHBseU1hc2tJbWFnZURhdGE7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKZnVuY3Rpb24gYXBwbHlNYXNrSW1hZ2VEYXRhKF9yZWYpIHsKICBsZXQgewogICAgc3JjLAogICAgc3JjUG9zID0gMCwKICAgIGRlc3QsCiAgICBkZXN0UG9zID0gMCwKICAgIHdpZHRoLAogICAgaGVpZ2h0LAogICAgaW52ZXJzZURlY29kZSA9IGZhbHNlCiAgfSA9IF9yZWY7CiAgY29uc3Qgb3BhcXVlID0gX3V0aWwuRmVhdHVyZVRlc3QuaXNMaXR0bGVFbmRpYW4gPyAweGZmMDAwMDAwIDogMHgwMDAwMDBmZjsKICBjb25zdCBbemVyb01hcHBpbmcsIG9uZU1hcHBpbmddID0gIWludmVyc2VEZWNvZGUgPyBbb3BhcXVlLCAwXSA6IFswLCBvcGFxdWVdOwogIGNvbnN0IHdpZHRoSW5Tb3VyY2UgPSB3aWR0aCA+PiAzOwogIGNvbnN0IHdpZHRoUmVtYWluZGVyID0gd2lkdGggJiA3OwogIGNvbnN0IHNyY0xlbmd0aCA9IHNyYy5sZW5ndGg7CiAgZGVzdCA9IG5ldyBVaW50MzJBcnJheShkZXN0LmJ1ZmZlcik7CgogIGZvciAobGV0IGkgPSAwOyBpIDwgaGVpZ2h0OyBpKyspIHsKICAgIGZvciAoY29uc3QgbWF4ID0gc3JjUG9zICsgd2lkdGhJblNvdXJjZTsgc3JjUG9zIDwgbWF4OyBzcmNQb3MrKykgewogICAgICBjb25zdCBlbGVtID0gc3JjUG9zIDwgc3JjTGVuZ3RoID8gc3JjW3NyY1Bvc10gOiAyNTU7CiAgICAgIGRlc3RbZGVzdFBvcysrXSA9IGVsZW0gJiAwYjEwMDAwMDAwID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgICBkZXN0W2Rlc3RQb3MrK10gPSBlbGVtICYgMGIxMDAwMDAwID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgICBkZXN0W2Rlc3RQb3MrK10gPSBlbGVtICYgMGIxMDAwMDAgPyBvbmVNYXBwaW5nIDogemVyb01hcHBpbmc7CiAgICAgIGRlc3RbZGVzdFBvcysrXSA9IGVsZW0gJiAwYjEwMDAwID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgICBkZXN0W2Rlc3RQb3MrK10gPSBlbGVtICYgMGIxMDAwID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgICBkZXN0W2Rlc3RQb3MrK10gPSBlbGVtICYgMGIxMDAgPyBvbmVNYXBwaW5nIDogemVyb01hcHBpbmc7CiAgICAgIGRlc3RbZGVzdFBvcysrXSA9IGVsZW0gJiAwYjEwID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgICBkZXN0W2Rlc3RQb3MrK10gPSBlbGVtICYgMGIxID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgfQoKICAgIGlmICh3aWR0aFJlbWFpbmRlciA9PT0gMCkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBjb25zdCBlbGVtID0gc3JjUG9zIDwgc3JjTGVuZ3RoID8gc3JjW3NyY1BvcysrXSA6IDI1NTsKCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHdpZHRoUmVtYWluZGVyOyBqKyspIHsKICAgICAgZGVzdFtkZXN0UG9zKytdID0gZWxlbSAmIDEgPDwgNyAtIGogPyBvbmVNYXBwaW5nIDogemVyb01hcHBpbmc7CiAgICB9CiAgfQoKICByZXR1cm4gewogICAgc3JjUG9zLAogICAgZGVzdFBvcwogIH07Cn0KCi8qKiovIH0pLAovKiAxOTAgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmluY3JlbWVudGFsVXBkYXRlID0gaW5jcmVtZW50YWxVcGRhdGU7CmV4cG9ydHMud3JpdGVEaWN0ID0gd3JpdGVEaWN0OwpleHBvcnRzLndyaXRlT2JqZWN0ID0gd3JpdGVPYmplY3Q7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKdmFyIF94bWxfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTEpOwoKdmFyIF9iYXNlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMyKTsKCnZhciBfY3J5cHRvID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTIpOwoKZnVuY3Rpb24gd3JpdGVPYmplY3QocmVmLCBvYmosIGJ1ZmZlciwgdHJhbnNmb3JtKSB7CiAgYnVmZmVyLnB1c2goYCR7cmVmLm51bX0gJHtyZWYuZ2VufSBvYmpcbmApOwoKICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgd3JpdGVEaWN0KG9iaiwgYnVmZmVyLCB0cmFuc2Zvcm0pOwogIH0gZWxzZSBpZiAob2JqIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgIHdyaXRlU3RyZWFtKG9iaiwgYnVmZmVyLCB0cmFuc2Zvcm0pOwogIH0KCiAgYnVmZmVyLnB1c2goIlxuZW5kb2JqXG4iKTsKfQoKZnVuY3Rpb24gd3JpdGVEaWN0KGRpY3QsIGJ1ZmZlciwgdHJhbnNmb3JtKSB7CiAgYnVmZmVyLnB1c2goIjw8Iik7CgogIGZvciAoY29uc3Qga2V5IG9mIGRpY3QuZ2V0S2V5cygpKSB7CiAgICBidWZmZXIucHVzaChgIC8keygwLCBfY29yZV91dGlscy5lc2NhcGVQREZOYW1lKShrZXkpfSBgKTsKICAgIHdyaXRlVmFsdWUoZGljdC5nZXRSYXcoa2V5KSwgYnVmZmVyLCB0cmFuc2Zvcm0pOwogIH0KCiAgYnVmZmVyLnB1c2goIj4+Iik7Cn0KCmZ1bmN0aW9uIHdyaXRlU3RyZWFtKHN0cmVhbSwgYnVmZmVyLCB0cmFuc2Zvcm0pIHsKICB3cml0ZURpY3Qoc3RyZWFtLmRpY3QsIGJ1ZmZlciwgdHJhbnNmb3JtKTsKICBidWZmZXIucHVzaCgiIHN0cmVhbVxuIik7CiAgbGV0IHN0cmluZyA9IHN0cmVhbS5nZXRTdHJpbmcoKTsKCiAgaWYgKHRyYW5zZm9ybSAhPT0gbnVsbCkgewogICAgc3RyaW5nID0gdHJhbnNmb3JtLmVuY3J5cHRTdHJpbmcoc3RyaW5nKTsKICB9CgogIGJ1ZmZlci5wdXNoKHN0cmluZywgIlxuZW5kc3RyZWFtXG4iKTsKfQoKZnVuY3Rpb24gd3JpdGVBcnJheShhcnJheSwgYnVmZmVyLCB0cmFuc2Zvcm0pIHsKICBidWZmZXIucHVzaCgiWyIpOwogIGxldCBmaXJzdCA9IHRydWU7CgogIGZvciAoY29uc3QgdmFsIG9mIGFycmF5KSB7CiAgICBpZiAoIWZpcnN0KSB7CiAgICAgIGJ1ZmZlci5wdXNoKCIgIik7CiAgICB9IGVsc2UgewogICAgICBmaXJzdCA9IGZhbHNlOwogICAgfQoKICAgIHdyaXRlVmFsdWUodmFsLCBidWZmZXIsIHRyYW5zZm9ybSk7CiAgfQoKICBidWZmZXIucHVzaCgiXSIpOwp9CgpmdW5jdGlvbiB3cml0ZVZhbHVlKHZhbHVlLCBidWZmZXIsIHRyYW5zZm9ybSkgewogIGlmICh2YWx1ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgIGJ1ZmZlci5wdXNoKGAvJHsoMCwgX2NvcmVfdXRpbHMuZXNjYXBlUERGTmFtZSkodmFsdWUubmFtZSl9YCk7CiAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgYnVmZmVyLnB1c2goYCR7dmFsdWUubnVtfSAke3ZhbHVlLmdlbn0gUmApOwogIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgIHdyaXRlQXJyYXkodmFsdWUsIGJ1ZmZlciwgdHJhbnNmb3JtKTsKICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIpIHsKICAgIGlmICh0cmFuc2Zvcm0gIT09IG51bGwpIHsKICAgICAgdmFsdWUgPSB0cmFuc2Zvcm0uZW5jcnlwdFN0cmluZyh2YWx1ZSk7CiAgICB9CgogICAgYnVmZmVyLnB1c2goYCgkeygwLCBfdXRpbC5lc2NhcGVTdHJpbmcpKHZhbHVlKX0pYCk7CiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICJudW1iZXIiKSB7CiAgICBidWZmZXIucHVzaCgoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKHZhbHVlKSk7CiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICJib29sZWFuIikgewogICAgYnVmZmVyLnB1c2godmFsdWUudG9TdHJpbmcoKSk7CiAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgIHdyaXRlRGljdCh2YWx1ZSwgYnVmZmVyLCB0cmFuc2Zvcm0pOwogIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgd3JpdGVTdHJlYW0odmFsdWUsIGJ1ZmZlciwgdHJhbnNmb3JtKTsKICB9IGVsc2UgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICBidWZmZXIucHVzaCgibnVsbCIpOwogIH0gZWxzZSB7CiAgICAoMCwgX3V0aWwud2FybikoYFVuaGFuZGxlZCB2YWx1ZSBpbiB3cml0ZXI6ICR7dHlwZW9mIHZhbHVlfSwgcGxlYXNlIGZpbGUgYSBidWcuYCk7CiAgfQp9CgpmdW5jdGlvbiB3cml0ZUludChudW1iZXIsIHNpemUsIG9mZnNldCwgYnVmZmVyKSB7CiAgZm9yIChsZXQgaSA9IHNpemUgKyBvZmZzZXQgLSAxOyBpID4gb2Zmc2V0IC0gMTsgaS0tKSB7CiAgICBidWZmZXJbaV0gPSBudW1iZXIgJiAweGZmOwogICAgbnVtYmVyID4+PSA4OwogIH0KCiAgcmV0dXJuIG9mZnNldCArIHNpemU7Cn0KCmZ1bmN0aW9uIHdyaXRlU3RyaW5nKHN0cmluZywgb2Zmc2V0LCBidWZmZXIpIHsKICBmb3IgKGxldCBpID0gMCwgbGVuID0gc3RyaW5nLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICBidWZmZXJbb2Zmc2V0ICsgaV0gPSBzdHJpbmcuY2hhckNvZGVBdChpKSAmIDB4ZmY7CiAgfQp9CgpmdW5jdGlvbiBjb21wdXRlTUQ1KGZpbGVzaXplLCB4cmVmSW5mbykgewogIGNvbnN0IHRpbWUgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTsKICBjb25zdCBmaWxlbmFtZSA9IHhyZWZJbmZvLmZpbGVuYW1lIHx8ICIiOwogIGNvbnN0IG1kNUJ1ZmZlciA9IFt0aW1lLnRvU3RyaW5nKCksIGZpbGVuYW1lLCBmaWxlc2l6ZS50b1N0cmluZygpXTsKICBsZXQgbWQ1QnVmZmVyTGVuID0gbWQ1QnVmZmVyLnJlZHVjZSgoYSwgc3RyKSA9PiBhICsgc3RyLmxlbmd0aCwgMCk7CgogIGZvciAoY29uc3QgdmFsdWUgb2YgT2JqZWN0LnZhbHVlcyh4cmVmSW5mby5pbmZvKSkgewogICAgbWQ1QnVmZmVyLnB1c2godmFsdWUpOwogICAgbWQ1QnVmZmVyTGVuICs9IHZhbHVlLmxlbmd0aDsKICB9CgogIGNvbnN0IGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkobWQ1QnVmZmVyTGVuKTsKICBsZXQgb2Zmc2V0ID0gMDsKCiAgZm9yIChjb25zdCBzdHIgb2YgbWQ1QnVmZmVyKSB7CiAgICB3cml0ZVN0cmluZyhzdHIsIG9mZnNldCwgYXJyYXkpOwogICAgb2Zmc2V0ICs9IHN0ci5sZW5ndGg7CiAgfQoKICByZXR1cm4gKDAsIF91dGlsLmJ5dGVzVG9TdHJpbmcpKCgwLCBfY3J5cHRvLmNhbGN1bGF0ZU1ENSkoYXJyYXkpKTsKfQoKZnVuY3Rpb24gd3JpdGVYRkFEYXRhRm9yQWNyb2Zvcm0oc3RyLCBuZXdSZWZzKSB7CiAgY29uc3QgeG1sID0gbmV3IF94bWxfcGFyc2VyLlNpbXBsZVhNTFBhcnNlcih7CiAgICBoYXNBdHRyaWJ1dGVzOiB0cnVlCiAgfSkucGFyc2VGcm9tU3RyaW5nKHN0cik7CgogIGZvciAoY29uc3QgewogICAgeGZhCiAgfSBvZiBuZXdSZWZzKSB7CiAgICBpZiAoIXhmYSkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBjb25zdCB7CiAgICAgIHBhdGgsCiAgICAgIHZhbHVlCiAgICB9ID0geGZhOwoKICAgIGlmICghcGF0aCkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBjb25zdCBub2RlID0geG1sLmRvY3VtZW50RWxlbWVudC5zZWFyY2hOb2RlKCgwLCBfY29yZV91dGlscy5wYXJzZVhGQVBhdGgpKHBhdGgpLCAwKTsKCiAgICBpZiAobm9kZSkgewogICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgICBub2RlLmNoaWxkTm9kZXMgPSB2YWx1ZS5tYXAodmFsID0+IG5ldyBfeG1sX3BhcnNlci5TaW1wbGVET01Ob2RlKCJ2YWx1ZSIsIHZhbCkpOwogICAgICB9IGVsc2UgewogICAgICAgIG5vZGUuY2hpbGROb2RlcyA9IFtuZXcgX3htbF9wYXJzZXIuU2ltcGxlRE9NTm9kZSgiI3RleHQiLCB2YWx1ZSldOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAoMCwgX3V0aWwud2FybikoYE5vZGUgbm90IGZvdW5kIGZvciBwYXRoOiAke3BhdGh9YCk7CiAgICB9CiAgfQoKICBjb25zdCBidWZmZXIgPSBbXTsKICB4bWwuZG9jdW1lbnRFbGVtZW50LmR1bXAoYnVmZmVyKTsKICByZXR1cm4gYnVmZmVyLmpvaW4oIiIpOwp9CgpmdW5jdGlvbiB1cGRhdGVYRkEoX3JlZikgewogIGxldCB7CiAgICB4ZmFEYXRhLAogICAgeGZhRGF0YXNldHNSZWYsCiAgICBoYXNYZmFEYXRhc2V0c0VudHJ5LAogICAgYWNyb0Zvcm1SZWYsCiAgICBhY3JvRm9ybSwKICAgIG5ld1JlZnMsCiAgICB4cmVmLAogICAgeHJlZkluZm8KICB9ID0gX3JlZjsKCiAgaWYgKHhyZWYgPT09IG51bGwpIHsKICAgIHJldHVybjsKICB9CgogIGlmICghaGFzWGZhRGF0YXNldHNFbnRyeSkgewogICAgaWYgKCFhY3JvRm9ybVJlZikgewogICAgICAoMCwgX3V0aWwud2FybikoIlhGQSAtIENhbm5vdCBzYXZlIGl0Iik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBvbGRYZmEgPSBhY3JvRm9ybS5nZXQoIlhGQSIpOwogICAgY29uc3QgbmV3WGZhID0gb2xkWGZhLnNsaWNlKCk7CiAgICBuZXdYZmEuc3BsaWNlKDIsIDAsICJkYXRhc2V0cyIpOwogICAgbmV3WGZhLnNwbGljZSgzLCAwLCB4ZmFEYXRhc2V0c1JlZik7CiAgICBhY3JvRm9ybS5zZXQoIlhGQSIsIG5ld1hmYSk7CiAgICBjb25zdCBlbmNyeXB0ID0geHJlZi5lbmNyeXB0OwogICAgbGV0IHRyYW5zZm9ybSA9IG51bGw7CgogICAgaWYgKGVuY3J5cHQpIHsKICAgICAgdHJhbnNmb3JtID0gZW5jcnlwdC5jcmVhdGVDaXBoZXJUcmFuc2Zvcm0oYWNyb0Zvcm1SZWYubnVtLCBhY3JvRm9ybVJlZi5nZW4pOwogICAgfQoKICAgIGNvbnN0IGJ1ZmZlciA9IFtgJHthY3JvRm9ybVJlZi5udW19ICR7YWNyb0Zvcm1SZWYuZ2VufSBvYmpcbmBdOwogICAgd3JpdGVEaWN0KGFjcm9Gb3JtLCBidWZmZXIsIHRyYW5zZm9ybSk7CiAgICBidWZmZXIucHVzaCgiXG4iKTsKICAgIGFjcm9Gb3JtLnNldCgiWEZBIiwgb2xkWGZhKTsKICAgIG5ld1JlZnMucHVzaCh7CiAgICAgIHJlZjogYWNyb0Zvcm1SZWYsCiAgICAgIGRhdGE6IGJ1ZmZlci5qb2luKCIiKQogICAgfSk7CiAgfQoKICBpZiAoeGZhRGF0YSA9PT0gbnVsbCkgewogICAgY29uc3QgZGF0YXNldHMgPSB4cmVmLmZldGNoSWZSZWYoeGZhRGF0YXNldHNSZWYpOwogICAgeGZhRGF0YSA9IHdyaXRlWEZBRGF0YUZvckFjcm9mb3JtKGRhdGFzZXRzLmdldFN0cmluZygpLCBuZXdSZWZzKTsKICB9CgogIGNvbnN0IGVuY3J5cHQgPSB4cmVmLmVuY3J5cHQ7CgogIGlmIChlbmNyeXB0KSB7CiAgICBjb25zdCB0cmFuc2Zvcm0gPSBlbmNyeXB0LmNyZWF0ZUNpcGhlclRyYW5zZm9ybSh4ZmFEYXRhc2V0c1JlZi5udW0sIHhmYURhdGFzZXRzUmVmLmdlbik7CiAgICB4ZmFEYXRhID0gdHJhbnNmb3JtLmVuY3J5cHRTdHJpbmcoeGZhRGF0YSk7CiAgfQoKICBjb25zdCBkYXRhID0gYCR7eGZhRGF0YXNldHNSZWYubnVtfSAke3hmYURhdGFzZXRzUmVmLmdlbn0gb2JqXG5gICsgYDw8IC9UeXBlIC9FbWJlZGRlZEZpbGUgL0xlbmd0aCAke3hmYURhdGEubGVuZ3RofT4+XG5zdHJlYW1cbmAgKyB4ZmFEYXRhICsgIlxuZW5kc3RyZWFtXG5lbmRvYmpcbiI7CiAgbmV3UmVmcy5wdXNoKHsKICAgIHJlZjogeGZhRGF0YXNldHNSZWYsCiAgICBkYXRhCiAgfSk7Cn0KCmZ1bmN0aW9uIGluY3JlbWVudGFsVXBkYXRlKF9yZWYyKSB7CiAgbGV0IHsKICAgIG9yaWdpbmFsRGF0YSwKICAgIHhyZWZJbmZvLAogICAgbmV3UmVmcywKICAgIHhyZWYgPSBudWxsLAogICAgaGFzWGZhID0gZmFsc2UsCiAgICB4ZmFEYXRhc2V0c1JlZiA9IG51bGwsCiAgICBoYXNYZmFEYXRhc2V0c0VudHJ5ID0gZmFsc2UsCiAgICBhY3JvRm9ybVJlZiA9IG51bGwsCiAgICBhY3JvRm9ybSA9IG51bGwsCiAgICB4ZmFEYXRhID0gbnVsbAogIH0gPSBfcmVmMjsKCiAgaWYgKGhhc1hmYSkgewogICAgdXBkYXRlWEZBKHsKICAgICAgeGZhRGF0YSwKICAgICAgeGZhRGF0YXNldHNSZWYsCiAgICAgIGhhc1hmYURhdGFzZXRzRW50cnksCiAgICAgIGFjcm9Gb3JtUmVmLAogICAgICBhY3JvRm9ybSwKICAgICAgbmV3UmVmcywKICAgICAgeHJlZiwKICAgICAgeHJlZkluZm8KICAgIH0pOwogIH0KCiAgY29uc3QgbmV3WHJlZiA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KG51bGwpOwogIGNvbnN0IHJlZkZvclhyZWZUYWJsZSA9IHhyZWZJbmZvLm5ld1JlZjsKICBsZXQgYnVmZmVyLCBiYXNlT2Zmc2V0OwogIGNvbnN0IGxhc3RCeXRlID0gb3JpZ2luYWxEYXRhLmF0KC0xKTsKCiAgaWYgKGxhc3RCeXRlID09PSAweDBhIHx8IGxhc3RCeXRlID09PSAweDBkKSB7CiAgICBidWZmZXIgPSBbXTsKICAgIGJhc2VPZmZzZXQgPSBvcmlnaW5hbERhdGEubGVuZ3RoOwogIH0gZWxzZSB7CiAgICBidWZmZXIgPSBbIlxuIl07CiAgICBiYXNlT2Zmc2V0ID0gb3JpZ2luYWxEYXRhLmxlbmd0aCArIDE7CiAgfQoKICBuZXdYcmVmLnNldCgiU2l6ZSIsIHJlZkZvclhyZWZUYWJsZS5udW0gKyAxKTsKICBuZXdYcmVmLnNldCgiUHJldiIsIHhyZWZJbmZvLnN0YXJ0WFJlZik7CiAgbmV3WHJlZi5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiWFJlZiIpKTsKCiAgaWYgKHhyZWZJbmZvLnJvb3RSZWYgIT09IG51bGwpIHsKICAgIG5ld1hyZWYuc2V0KCJSb290IiwgeHJlZkluZm8ucm9vdFJlZik7CiAgfQoKICBpZiAoeHJlZkluZm8uaW5mb1JlZiAhPT0gbnVsbCkgewogICAgbmV3WHJlZi5zZXQoIkluZm8iLCB4cmVmSW5mby5pbmZvUmVmKTsKICB9CgogIGlmICh4cmVmSW5mby5lbmNyeXB0UmVmICE9PSBudWxsKSB7CiAgICBuZXdYcmVmLnNldCgiRW5jcnlwdCIsIHhyZWZJbmZvLmVuY3J5cHRSZWYpOwogIH0KCiAgbmV3UmVmcy5wdXNoKHsKICAgIHJlZjogcmVmRm9yWHJlZlRhYmxlLAogICAgZGF0YTogIiIKICB9KTsKICBuZXdSZWZzID0gbmV3UmVmcy5zb3J0KChhLCBiKSA9PiB7CiAgICByZXR1cm4gYS5yZWYubnVtIC0gYi5yZWYubnVtOwogIH0pOwogIGNvbnN0IHhyZWZUYWJsZURhdGEgPSBbWzAsIDEsIDB4ZmZmZl1dOwogIGNvbnN0IGluZGV4ZXMgPSBbMCwgMV07CiAgbGV0IG1heE9mZnNldCA9IDA7CgogIGZvciAoY29uc3QgewogICAgcmVmLAogICAgZGF0YQogIH0gb2YgbmV3UmVmcykgewogICAgbWF4T2Zmc2V0ID0gTWF0aC5tYXgobWF4T2Zmc2V0LCBiYXNlT2Zmc2V0KTsKICAgIHhyZWZUYWJsZURhdGEucHVzaChbMSwgYmFzZU9mZnNldCwgTWF0aC5taW4ocmVmLmdlbiwgMHhmZmZmKV0pOwogICAgYmFzZU9mZnNldCArPSBkYXRhLmxlbmd0aDsKICAgIGluZGV4ZXMucHVzaChyZWYubnVtLCAxKTsKICAgIGJ1ZmZlci5wdXNoKGRhdGEpOwogIH0KCiAgbmV3WHJlZi5zZXQoIkluZGV4IiwgaW5kZXhlcyk7CgogIGlmIChBcnJheS5pc0FycmF5KHhyZWZJbmZvLmZpbGVJZHMpICYmIHhyZWZJbmZvLmZpbGVJZHMubGVuZ3RoID4gMCkgewogICAgY29uc3QgbWQ1ID0gY29tcHV0ZU1ENShiYXNlT2Zmc2V0LCB4cmVmSW5mbyk7CiAgICBuZXdYcmVmLnNldCgiSUQiLCBbeHJlZkluZm8uZmlsZUlkc1swXSwgbWQ1XSk7CiAgfQoKICBjb25zdCBvZmZzZXRTaXplID0gTWF0aC5jZWlsKE1hdGgubG9nMihtYXhPZmZzZXQpIC8gOCk7CiAgY29uc3Qgc2l6ZXMgPSBbMSwgb2Zmc2V0U2l6ZSwgMl07CiAgY29uc3Qgc3RydWN0U2l6ZSA9IHNpemVzWzBdICsgc2l6ZXNbMV0gKyBzaXplc1syXTsKICBjb25zdCB0YWJsZUxlbmd0aCA9IHN0cnVjdFNpemUgKiB4cmVmVGFibGVEYXRhLmxlbmd0aDsKICBuZXdYcmVmLnNldCgiVyIsIHNpemVzKTsKICBuZXdYcmVmLnNldCgiTGVuZ3RoIiwgdGFibGVMZW5ndGgpOwogIGJ1ZmZlci5wdXNoKGAke3JlZkZvclhyZWZUYWJsZS5udW19ICR7cmVmRm9yWHJlZlRhYmxlLmdlbn0gb2JqXG5gKTsKICB3cml0ZURpY3QobmV3WHJlZiwgYnVmZmVyLCBudWxsKTsKICBidWZmZXIucHVzaCgiIHN0cmVhbVxuIik7CiAgY29uc3QgYnVmZmVyTGVuID0gYnVmZmVyLnJlZHVjZSgoYSwgc3RyKSA9PiBhICsgc3RyLmxlbmd0aCwgMCk7CiAgY29uc3QgZm9vdGVyID0gYFxuZW5kc3RyZWFtXG5lbmRvYmpcbnN0YXJ0eHJlZlxuJHtiYXNlT2Zmc2V0fVxuJSVFT0ZcbmA7CiAgY29uc3QgYXJyYXkgPSBuZXcgVWludDhBcnJheShvcmlnaW5hbERhdGEubGVuZ3RoICsgYnVmZmVyTGVuICsgdGFibGVMZW5ndGggKyBmb290ZXIubGVuZ3RoKTsKICBhcnJheS5zZXQob3JpZ2luYWxEYXRhKTsKICBsZXQgb2Zmc2V0ID0gb3JpZ2luYWxEYXRhLmxlbmd0aDsKCiAgZm9yIChjb25zdCBzdHIgb2YgYnVmZmVyKSB7CiAgICB3cml0ZVN0cmluZyhzdHIsIG9mZnNldCwgYXJyYXkpOwogICAgb2Zmc2V0ICs9IHN0ci5sZW5ndGg7CiAgfQoKICBmb3IgKGNvbnN0IFt0eXBlLCBvYmpPZmZzZXQsIGdlbl0gb2YgeHJlZlRhYmxlRGF0YSkgewogICAgb2Zmc2V0ID0gd3JpdGVJbnQodHlwZSwgc2l6ZXNbMF0sIG9mZnNldCwgYXJyYXkpOwogICAgb2Zmc2V0ID0gd3JpdGVJbnQob2JqT2Zmc2V0LCBzaXplc1sxXSwgb2Zmc2V0LCBhcnJheSk7CiAgICBvZmZzZXQgPSB3cml0ZUludChnZW4sIHNpemVzWzJdLCBvZmZzZXQsIGFycmF5KTsKICB9CgogIHdyaXRlU3RyaW5nKGZvb3Rlciwgb2Zmc2V0LCBhcnJheSk7CiAgcmV0dXJuIGFycmF5Owp9CgovKioqLyB9KSwKLyogMTkxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5YTUxQYXJzZXJFcnJvckNvZGUgPSBleHBvcnRzLlhNTFBhcnNlckJhc2UgPSBleHBvcnRzLlNpbXBsZVhNTFBhcnNlciA9IGV4cG9ydHMuU2ltcGxlRE9NTm9kZSA9IHZvaWQgMDsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMxKTsKCmNvbnN0IFhNTFBhcnNlckVycm9yQ29kZSA9IHsKICBOb0Vycm9yOiAwLAogIEVuZE9mRG9jdW1lbnQ6IC0xLAogIFVudGVybWluYXRlZENkYXQ6IC0yLAogIFVudGVybWluYXRlZFhtbERlY2xhcmF0aW9uOiAtMywKICBVbnRlcm1pbmF0ZWREb2N0eXBlRGVjbGFyYXRpb246IC00LAogIFVudGVybWluYXRlZENvbW1lbnQ6IC01LAogIE1hbGZvcm1lZEVsZW1lbnQ6IC02LAogIE91dE9mTWVtb3J5OiAtNywKICBVbnRlcm1pbmF0ZWRBdHRyaWJ1dGVWYWx1ZTogLTgsCiAgVW50ZXJtaW5hdGVkRWxlbWVudDogLTksCiAgRWxlbWVudE5ldmVyQmVndW46IC0xMAp9OwpleHBvcnRzLlhNTFBhcnNlckVycm9yQ29kZSA9IFhNTFBhcnNlckVycm9yQ29kZTsKCmZ1bmN0aW9uIGlzV2hpdGVzcGFjZShzLCBpbmRleCkgewogIGNvbnN0IGNoID0gc1tpbmRleF07CiAgcmV0dXJuIGNoID09PSAiICIgfHwgY2ggPT09ICJcbiIgfHwgY2ggPT09ICJcciIgfHwgY2ggPT09ICJcdCI7Cn0KCmZ1bmN0aW9uIGlzV2hpdGVzcGFjZVN0cmluZyhzKSB7CiAgZm9yIChsZXQgaSA9IDAsIGlpID0gcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBpZiAoIWlzV2hpdGVzcGFjZShzLCBpKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICByZXR1cm4gdHJ1ZTsKfQoKY2xhc3MgWE1MUGFyc2VyQmFzZSB7CiAgX3Jlc29sdmVFbnRpdGllcyhzKSB7CiAgICByZXR1cm4gcy5yZXBsYWNlKC8mKFteO10rKTsvZywgKGFsbCwgZW50aXR5KSA9PiB7CiAgICAgIGlmIChlbnRpdHkuc3Vic3RyaW5nKDAsIDIpID09PSAiI3giKSB7CiAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ29kZVBvaW50KHBhcnNlSW50KGVudGl0eS5zdWJzdHJpbmcoMiksIDE2KSk7CiAgICAgIH0gZWxzZSBpZiAoZW50aXR5LnN1YnN0cmluZygwLCAxKSA9PT0gIiMiKSB7CiAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ29kZVBvaW50KHBhcnNlSW50KGVudGl0eS5zdWJzdHJpbmcoMSksIDEwKSk7CiAgICAgIH0KCiAgICAgIHN3aXRjaCAoZW50aXR5KSB7CiAgICAgICAgY2FzZSAibHQiOgogICAgICAgICAgcmV0dXJuICI8IjsKCiAgICAgICAgY2FzZSAiZ3QiOgogICAgICAgICAgcmV0dXJuICI+IjsKCiAgICAgICAgY2FzZSAiYW1wIjoKICAgICAgICAgIHJldHVybiAiJiI7CgogICAgICAgIGNhc2UgInF1b3QiOgogICAgICAgICAgcmV0dXJuICciJzsKCiAgICAgICAgY2FzZSAiYXBvcyI6CiAgICAgICAgICByZXR1cm4gIiciOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5vblJlc29sdmVFbnRpdHkoZW50aXR5KTsKICAgIH0pOwogIH0KCiAgX3BhcnNlQ29udGVudChzLCBzdGFydCkgewogICAgY29uc3QgYXR0cmlidXRlcyA9IFtdOwogICAgbGV0IHBvcyA9IHN0YXJ0OwoKICAgIGZ1bmN0aW9uIHNraXBXcygpIHsKICAgICAgd2hpbGUgKHBvcyA8IHMubGVuZ3RoICYmIGlzV2hpdGVzcGFjZShzLCBwb3MpKSB7CiAgICAgICAgKytwb3M7CiAgICAgIH0KICAgIH0KCiAgICB3aGlsZSAocG9zIDwgcy5sZW5ndGggJiYgIWlzV2hpdGVzcGFjZShzLCBwb3MpICYmIHNbcG9zXSAhPT0gIj4iICYmIHNbcG9zXSAhPT0gIi8iKSB7CiAgICAgICsrcG9zOwogICAgfQoKICAgIGNvbnN0IG5hbWUgPSBzLnN1YnN0cmluZyhzdGFydCwgcG9zKTsKICAgIHNraXBXcygpOwoKICAgIHdoaWxlIChwb3MgPCBzLmxlbmd0aCAmJiBzW3Bvc10gIT09ICI+IiAmJiBzW3Bvc10gIT09ICIvIiAmJiBzW3Bvc10gIT09ICI/IikgewogICAgICBza2lwV3MoKTsKICAgICAgbGV0IGF0dHJOYW1lID0gIiIsCiAgICAgICAgICBhdHRyVmFsdWUgPSAiIjsKCiAgICAgIHdoaWxlIChwb3MgPCBzLmxlbmd0aCAmJiAhaXNXaGl0ZXNwYWNlKHMsIHBvcykgJiYgc1twb3NdICE9PSAiPSIpIHsKICAgICAgICBhdHRyTmFtZSArPSBzW3Bvc107CiAgICAgICAgKytwb3M7CiAgICAgIH0KCiAgICAgIHNraXBXcygpOwoKICAgICAgaWYgKHNbcG9zXSAhPT0gIj0iKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgICsrcG9zOwogICAgICBza2lwV3MoKTsKICAgICAgY29uc3QgYXR0ckVuZENoYXIgPSBzW3Bvc107CgogICAgICBpZiAoYXR0ckVuZENoYXIgIT09ICciJyAmJiBhdHRyRW5kQ2hhciAhPT0gIiciKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF0dHJFbmRJbmRleCA9IHMuaW5kZXhPZihhdHRyRW5kQ2hhciwgKytwb3MpOwoKICAgICAgaWYgKGF0dHJFbmRJbmRleCA8IDApIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgYXR0clZhbHVlID0gcy5zdWJzdHJpbmcocG9zLCBhdHRyRW5kSW5kZXgpOwogICAgICBhdHRyaWJ1dGVzLnB1c2goewogICAgICAgIG5hbWU6IGF0dHJOYW1lLAogICAgICAgIHZhbHVlOiB0aGlzLl9yZXNvbHZlRW50aXRpZXMoYXR0clZhbHVlKQogICAgICB9KTsKICAgICAgcG9zID0gYXR0ckVuZEluZGV4ICsgMTsKICAgICAgc2tpcFdzKCk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgbmFtZSwKICAgICAgYXR0cmlidXRlcywKICAgICAgcGFyc2VkOiBwb3MgLSBzdGFydAogICAgfTsKICB9CgogIF9wYXJzZVByb2Nlc3NpbmdJbnN0cnVjdGlvbihzLCBzdGFydCkgewogICAgbGV0IHBvcyA9IHN0YXJ0OwoKICAgIGZ1bmN0aW9uIHNraXBXcygpIHsKICAgICAgd2hpbGUgKHBvcyA8IHMubGVuZ3RoICYmIGlzV2hpdGVzcGFjZShzLCBwb3MpKSB7CiAgICAgICAgKytwb3M7CiAgICAgIH0KICAgIH0KCiAgICB3aGlsZSAocG9zIDwgcy5sZW5ndGggJiYgIWlzV2hpdGVzcGFjZShzLCBwb3MpICYmIHNbcG9zXSAhPT0gIj4iICYmIHNbcG9zXSAhPT0gIj8iICYmIHNbcG9zXSAhPT0gIi8iKSB7CiAgICAgICsrcG9zOwogICAgfQoKICAgIGNvbnN0IG5hbWUgPSBzLnN1YnN0cmluZyhzdGFydCwgcG9zKTsKICAgIHNraXBXcygpOwogICAgY29uc3QgYXR0clN0YXJ0ID0gcG9zOwoKICAgIHdoaWxlIChwb3MgPCBzLmxlbmd0aCAmJiAoc1twb3NdICE9PSAiPyIgfHwgc1twb3MgKyAxXSAhPT0gIj4iKSkgewogICAgICArK3BvczsKICAgIH0KCiAgICBjb25zdCB2YWx1ZSA9IHMuc3Vic3RyaW5nKGF0dHJTdGFydCwgcG9zKTsKICAgIHJldHVybiB7CiAgICAgIG5hbWUsCiAgICAgIHZhbHVlLAogICAgICBwYXJzZWQ6IHBvcyAtIHN0YXJ0CiAgICB9OwogIH0KCiAgcGFyc2VYbWwocykgewogICAgbGV0IGkgPSAwOwoKICAgIHdoaWxlIChpIDwgcy5sZW5ndGgpIHsKICAgICAgY29uc3QgY2ggPSBzW2ldOwogICAgICBsZXQgaiA9IGk7CgogICAgICBpZiAoY2ggPT09ICI8IikgewogICAgICAgICsrajsKICAgICAgICBjb25zdCBjaDIgPSBzW2pdOwogICAgICAgIGxldCBxOwoKICAgICAgICBzd2l0Y2ggKGNoMikgewogICAgICAgICAgY2FzZSAiLyI6CiAgICAgICAgICAgICsrajsKICAgICAgICAgICAgcSA9IHMuaW5kZXhPZigiPiIsIGopOwoKICAgICAgICAgICAgaWYgKHEgPCAwKSB7CiAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKFhNTFBhcnNlckVycm9yQ29kZS5VbnRlcm1pbmF0ZWRFbGVtZW50KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMub25FbmRFbGVtZW50KHMuc3Vic3RyaW5nKGosIHEpKTsKICAgICAgICAgICAgaiA9IHEgKyAxOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICI/IjoKICAgICAgICAgICAgKytqOwoKICAgICAgICAgICAgY29uc3QgcGkgPSB0aGlzLl9wYXJzZVByb2Nlc3NpbmdJbnN0cnVjdGlvbihzLCBqKTsKCiAgICAgICAgICAgIGlmIChzLnN1YnN0cmluZyhqICsgcGkucGFyc2VkLCBqICsgcGkucGFyc2VkICsgMikgIT09ICI/PiIpIHsKICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoWE1MUGFyc2VyRXJyb3JDb2RlLlVudGVybWluYXRlZFhtbERlY2xhcmF0aW9uKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMub25QaShwaS5uYW1lLCBwaS52YWx1ZSk7CiAgICAgICAgICAgIGogKz0gcGkucGFyc2VkICsgMjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiISI6CiAgICAgICAgICAgIGlmIChzLnN1YnN0cmluZyhqICsgMSwgaiArIDMpID09PSAiLS0iKSB7CiAgICAgICAgICAgICAgcSA9IHMuaW5kZXhPZigiLS0+IiwgaiArIDMpOwoKICAgICAgICAgICAgICBpZiAocSA8IDApIHsKICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcihYTUxQYXJzZXJFcnJvckNvZGUuVW50ZXJtaW5hdGVkQ29tbWVudCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0aGlzLm9uQ29tbWVudChzLnN1YnN0cmluZyhqICsgMywgcSkpOwogICAgICAgICAgICAgIGogPSBxICsgMzsKICAgICAgICAgICAgfSBlbHNlIGlmIChzLnN1YnN0cmluZyhqICsgMSwgaiArIDgpID09PSAiW0NEQVRBWyIpIHsKICAgICAgICAgICAgICBxID0gcy5pbmRleE9mKCJdXT4iLCBqICsgOCk7CgogICAgICAgICAgICAgIGlmIChxIDwgMCkgewogICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKFhNTFBhcnNlckVycm9yQ29kZS5VbnRlcm1pbmF0ZWRDZGF0KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRoaXMub25DZGF0YShzLnN1YnN0cmluZyhqICsgOCwgcSkpOwogICAgICAgICAgICAgIGogPSBxICsgMzsKICAgICAgICAgICAgfSBlbHNlIGlmIChzLnN1YnN0cmluZyhqICsgMSwgaiArIDgpID09PSAiRE9DVFlQRSIpIHsKICAgICAgICAgICAgICBjb25zdCBxMiA9IHMuaW5kZXhPZigiWyIsIGogKyA4KTsKICAgICAgICAgICAgICBsZXQgY29tcGxleERvY3R5cGUgPSBmYWxzZTsKICAgICAgICAgICAgICBxID0gcy5pbmRleE9mKCI+IiwgaiArIDgpOwoKICAgICAgICAgICAgICBpZiAocSA8IDApIHsKICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcihYTUxQYXJzZXJFcnJvckNvZGUuVW50ZXJtaW5hdGVkRG9jdHlwZURlY2xhcmF0aW9uKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChxMiA+IDAgJiYgcSA+IHEyKSB7CiAgICAgICAgICAgICAgICBxID0gcy5pbmRleE9mKCJdPiIsIGogKyA4KTsKCiAgICAgICAgICAgICAgICBpZiAocSA8IDApIHsKICAgICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKFhNTFBhcnNlckVycm9yQ29kZS5VbnRlcm1pbmF0ZWREb2N0eXBlRGVjbGFyYXRpb24pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29tcGxleERvY3R5cGUgPSB0cnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgZG9jdHlwZUNvbnRlbnQgPSBzLnN1YnN0cmluZyhqICsgOCwgcSArIChjb21wbGV4RG9jdHlwZSA/IDEgOiAwKSk7CiAgICAgICAgICAgICAgdGhpcy5vbkRvY3R5cGUoZG9jdHlwZUNvbnRlbnQpOwogICAgICAgICAgICAgIGogPSBxICsgKGNvbXBsZXhEb2N0eXBlID8gMiA6IDEpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMub25FcnJvcihYTUxQYXJzZXJFcnJvckNvZGUuTWFsZm9ybWVkRWxlbWVudCk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBjb25zdCBjb250ZW50ID0gdGhpcy5fcGFyc2VDb250ZW50KHMsIGopOwoKICAgICAgICAgICAgaWYgKGNvbnRlbnQgPT09IG51bGwpIHsKICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoWE1MUGFyc2VyRXJyb3JDb2RlLk1hbGZvcm1lZEVsZW1lbnQpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGlzQ2xvc2VkID0gZmFsc2U7CgogICAgICAgICAgICBpZiAocy5zdWJzdHJpbmcoaiArIGNvbnRlbnQucGFyc2VkLCBqICsgY29udGVudC5wYXJzZWQgKyAyKSA9PT0gIi8+IikgewogICAgICAgICAgICAgIGlzQ2xvc2VkID0gdHJ1ZTsKICAgICAgICAgICAgfSBlbHNlIGlmIChzLnN1YnN0cmluZyhqICsgY29udGVudC5wYXJzZWQsIGogKyBjb250ZW50LnBhcnNlZCArIDEpICE9PSAiPiIpIHsKICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoWE1MUGFyc2VyRXJyb3JDb2RlLlVudGVybWluYXRlZEVsZW1lbnQpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5vbkJlZ2luRWxlbWVudChjb250ZW50Lm5hbWUsIGNvbnRlbnQuYXR0cmlidXRlcywgaXNDbG9zZWQpOwogICAgICAgICAgICBqICs9IGNvbnRlbnQucGFyc2VkICsgKGlzQ2xvc2VkID8gMiA6IDEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgd2hpbGUgKGogPCBzLmxlbmd0aCAmJiBzW2pdICE9PSAiPCIpIHsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHRleHQgPSBzLnN1YnN0cmluZyhpLCBqKTsKICAgICAgICB0aGlzLm9uVGV4dCh0aGlzLl9yZXNvbHZlRW50aXRpZXModGV4dCkpOwogICAgICB9CgogICAgICBpID0gajsKICAgIH0KICB9CgogIG9uUmVzb2x2ZUVudGl0eShuYW1lKSB7CiAgICByZXR1cm4gYCYke25hbWV9O2A7CiAgfQoKICBvblBpKG5hbWUsIHZhbHVlKSB7fQoKICBvbkNvbW1lbnQodGV4dCkge30KCiAgb25DZGF0YSh0ZXh0KSB7fQoKICBvbkRvY3R5cGUoZG9jdHlwZUNvbnRlbnQpIHt9CgogIG9uVGV4dCh0ZXh0KSB7fQoKICBvbkJlZ2luRWxlbWVudChuYW1lLCBhdHRyaWJ1dGVzLCBpc0VtcHR5KSB7fQoKICBvbkVuZEVsZW1lbnQobmFtZSkge30KCiAgb25FcnJvcihjb2RlKSB7fQoKfQoKZXhwb3J0cy5YTUxQYXJzZXJCYXNlID0gWE1MUGFyc2VyQmFzZTsKCmNsYXNzIFNpbXBsZURPTU5vZGUgewogIGNvbnN0cnVjdG9yKG5vZGVOYW1lLCBub2RlVmFsdWUpIHsKICAgIHRoaXMubm9kZU5hbWUgPSBub2RlTmFtZTsKICAgIHRoaXMubm9kZVZhbHVlID0gbm9kZVZhbHVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJwYXJlbnROb2RlIiwgewogICAgICB2YWx1ZTogbnVsbCwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0KCiAgZ2V0IGZpcnN0Q2hpbGQoKSB7CiAgICByZXR1cm4gdGhpcy5jaGlsZE5vZGVzICYmIHRoaXMuY2hpbGROb2Rlc1swXTsKICB9CgogIGdldCBuZXh0U2libGluZygpIHsKICAgIGNvbnN0IGNoaWxkTm9kZXMgPSB0aGlzLnBhcmVudE5vZGUuY2hpbGROb2RlczsKCiAgICBpZiAoIWNoaWxkTm9kZXMpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICBjb25zdCBpbmRleCA9IGNoaWxkTm9kZXMuaW5kZXhPZih0aGlzKTsKCiAgICBpZiAoaW5kZXggPT09IC0xKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgcmV0dXJuIGNoaWxkTm9kZXNbaW5kZXggKyAxXTsKICB9CgogIGdldCB0ZXh0Q29udGVudCgpIHsKICAgIGlmICghdGhpcy5jaGlsZE5vZGVzKSB7CiAgICAgIHJldHVybiB0aGlzLm5vZGVWYWx1ZSB8fCAiIjsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5jaGlsZE5vZGVzLm1hcChmdW5jdGlvbiAoY2hpbGQpIHsKICAgICAgcmV0dXJuIGNoaWxkLnRleHRDb250ZW50OwogICAgfSkuam9pbigiIik7CiAgfQoKICBnZXQgY2hpbGRyZW4oKSB7CiAgICByZXR1cm4gdGhpcy5jaGlsZE5vZGVzIHx8IFtdOwogIH0KCiAgaGFzQ2hpbGROb2RlcygpIHsKICAgIHJldHVybiB0aGlzLmNoaWxkTm9kZXMgJiYgdGhpcy5jaGlsZE5vZGVzLmxlbmd0aCA+IDA7CiAgfQoKICBzZWFyY2hOb2RlKHBhdGhzLCBwb3MpIHsKICAgIGlmIChwb3MgPj0gcGF0aHMubGVuZ3RoKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIGNvbnN0IGNvbXBvbmVudCA9IHBhdGhzW3Bvc107CiAgICBjb25zdCBzdGFjayA9IFtdOwogICAgbGV0IG5vZGUgPSB0aGlzOwoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGlmIChjb21wb25lbnQubmFtZSA9PT0gbm9kZS5ub2RlTmFtZSkgewogICAgICAgIGlmIChjb21wb25lbnQucG9zID09PSAwKSB7CiAgICAgICAgICBjb25zdCByZXMgPSBub2RlLnNlYXJjaE5vZGUocGF0aHMsIHBvcyArIDEpOwoKICAgICAgICAgIGlmIChyZXMgIT09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHN0YWNrLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IFtwYXJlbnRdID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBsZXQgc2libGluZ1BvcyA9IDA7CgogICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBwYXJlbnQuY2hpbGROb2RlcykgewogICAgICAgICAgICBpZiAoY29tcG9uZW50Lm5hbWUgPT09IGNoaWxkLm5vZGVOYW1lKSB7CiAgICAgICAgICAgICAgaWYgKHNpYmxpbmdQb3MgPT09IGNvbXBvbmVudC5wb3MpIHsKICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5zZWFyY2hOb2RlKHBhdGhzLCBwb3MgKyAxKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNpYmxpbmdQb3MrKzsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBub2RlLnNlYXJjaE5vZGUocGF0aHMsIHBvcyArIDEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKG5vZGUuY2hpbGROb2RlcyAmJiBub2RlLmNoaWxkTm9kZXMubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgc3RhY2sucHVzaChbbm9kZSwgMF0pOwogICAgICAgIG5vZGUgPSBub2RlLmNoaWxkTm9kZXNbMF07CiAgICAgIH0gZWxzZSBpZiAoc3RhY2subGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgY29uc3QgW3BhcmVudCwgY3VycmVudFBvc10gPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGNvbnN0IG5ld1BvcyA9IGN1cnJlbnRQb3MgKyAxOwoKICAgICAgICAgIGlmIChuZXdQb3MgPCBwYXJlbnQuY2hpbGROb2Rlcy5sZW5ndGgpIHsKICAgICAgICAgICAgc3RhY2sucHVzaChbcGFyZW50LCBuZXdQb3NdKTsKICAgICAgICAgICAgbm9kZSA9IHBhcmVudC5jaGlsZE5vZGVzW25ld1Bvc107CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBkdW1wKGJ1ZmZlcikgewogICAgaWYgKHRoaXMubm9kZU5hbWUgPT09ICIjdGV4dCIpIHsKICAgICAgYnVmZmVyLnB1c2goKDAsIF9jb3JlX3V0aWxzLmVuY29kZVRvWG1sU3RyaW5nKSh0aGlzLm5vZGVWYWx1ZSkpOwogICAgICByZXR1cm47CiAgICB9CgogICAgYnVmZmVyLnB1c2goYDwke3RoaXMubm9kZU5hbWV9YCk7CgogICAgaWYgKHRoaXMuYXR0cmlidXRlcykgewogICAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZSBvZiB0aGlzLmF0dHJpYnV0ZXMpIHsKICAgICAgICBidWZmZXIucHVzaChgICR7YXR0cmlidXRlLm5hbWV9PSIkeygwLCBfY29yZV91dGlscy5lbmNvZGVUb1htbFN0cmluZykoYXR0cmlidXRlLnZhbHVlKX0iYCk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5oYXNDaGlsZE5vZGVzKCkpIHsKICAgICAgYnVmZmVyLnB1c2goIj4iKTsKCiAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5jaGlsZE5vZGVzKSB7CiAgICAgICAgY2hpbGQuZHVtcChidWZmZXIpOwogICAgICB9CgogICAgICBidWZmZXIucHVzaChgPC8ke3RoaXMubm9kZU5hbWV9PmApOwogICAgfSBlbHNlIGlmICh0aGlzLm5vZGVWYWx1ZSkgewogICAgICBidWZmZXIucHVzaChgPiR7KDAsIF9jb3JlX3V0aWxzLmVuY29kZVRvWG1sU3RyaW5nKSh0aGlzLm5vZGVWYWx1ZSl9PC8ke3RoaXMubm9kZU5hbWV9PmApOwogICAgfSBlbHNlIHsKICAgICAgYnVmZmVyLnB1c2goIi8+Iik7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5TaW1wbGVET01Ob2RlID0gU2ltcGxlRE9NTm9kZTsKCmNsYXNzIFNpbXBsZVhNTFBhcnNlciBleHRlbmRzIFhNTFBhcnNlckJhc2UgewogIGNvbnN0cnVjdG9yKF9yZWYpIHsKICAgIGxldCB7CiAgICAgIGhhc0F0dHJpYnV0ZXMgPSBmYWxzZSwKICAgICAgbG93ZXJDYXNlTmFtZSA9IGZhbHNlCiAgICB9ID0gX3JlZjsKICAgIHN1cGVyKCk7CiAgICB0aGlzLl9jdXJyZW50RnJhZ21lbnQgPSBudWxsOwogICAgdGhpcy5fc3RhY2sgPSBudWxsOwogICAgdGhpcy5fZXJyb3JDb2RlID0gWE1MUGFyc2VyRXJyb3JDb2RlLk5vRXJyb3I7CiAgICB0aGlzLl9oYXNBdHRyaWJ1dGVzID0gaGFzQXR0cmlidXRlczsKICAgIHRoaXMuX2xvd2VyQ2FzZU5hbWUgPSBsb3dlckNhc2VOYW1lOwogIH0KCiAgcGFyc2VGcm9tU3RyaW5nKGRhdGEpIHsKICAgIHRoaXMuX2N1cnJlbnRGcmFnbWVudCA9IFtdOwogICAgdGhpcy5fc3RhY2sgPSBbXTsKICAgIHRoaXMuX2Vycm9yQ29kZSA9IFhNTFBhcnNlckVycm9yQ29kZS5Ob0Vycm9yOwogICAgdGhpcy5wYXJzZVhtbChkYXRhKTsKCiAgICBpZiAodGhpcy5fZXJyb3JDb2RlICE9PSBYTUxQYXJzZXJFcnJvckNvZGUuTm9FcnJvcikgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIGNvbnN0IFtkb2N1bWVudEVsZW1lbnRdID0gdGhpcy5fY3VycmVudEZyYWdtZW50OwoKICAgIGlmICghZG9jdW1lbnRFbGVtZW50KSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgZG9jdW1lbnRFbGVtZW50CiAgICB9OwogIH0KCiAgb25UZXh0KHRleHQpIHsKICAgIGlmIChpc1doaXRlc3BhY2VTdHJpbmcodGV4dCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG5vZGUgPSBuZXcgU2ltcGxlRE9NTm9kZSgiI3RleHQiLCB0ZXh0KTsKCiAgICB0aGlzLl9jdXJyZW50RnJhZ21lbnQucHVzaChub2RlKTsKICB9CgogIG9uQ2RhdGEodGV4dCkgewogICAgY29uc3Qgbm9kZSA9IG5ldyBTaW1wbGVET01Ob2RlKCIjdGV4dCIsIHRleHQpOwoKICAgIHRoaXMuX2N1cnJlbnRGcmFnbWVudC5wdXNoKG5vZGUpOwogIH0KCiAgb25CZWdpbkVsZW1lbnQobmFtZSwgYXR0cmlidXRlcywgaXNFbXB0eSkgewogICAgaWYgKHRoaXMuX2xvd2VyQ2FzZU5hbWUpIHsKICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKICAgIH0KCiAgICBjb25zdCBub2RlID0gbmV3IFNpbXBsZURPTU5vZGUobmFtZSk7CiAgICBub2RlLmNoaWxkTm9kZXMgPSBbXTsKCiAgICBpZiAodGhpcy5faGFzQXR0cmlidXRlcykgewogICAgICBub2RlLmF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzOwogICAgfQoKICAgIHRoaXMuX2N1cnJlbnRGcmFnbWVudC5wdXNoKG5vZGUpOwoKICAgIGlmIChpc0VtcHR5KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9zdGFjay5wdXNoKHRoaXMuX2N1cnJlbnRGcmFnbWVudCk7CgogICAgdGhpcy5fY3VycmVudEZyYWdtZW50ID0gbm9kZS5jaGlsZE5vZGVzOwogIH0KCiAgb25FbmRFbGVtZW50KG5hbWUpIHsKICAgIHRoaXMuX2N1cnJlbnRGcmFnbWVudCA9IHRoaXMuX3N0YWNrLnBvcCgpIHx8IFtdOwoKICAgIGNvbnN0IGxhc3RFbGVtZW50ID0gdGhpcy5fY3VycmVudEZyYWdtZW50LmF0KC0xKTsKCiAgICBpZiAoIWxhc3RFbGVtZW50KSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGxhc3RFbGVtZW50LmNoaWxkTm9kZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBsYXN0RWxlbWVudC5jaGlsZE5vZGVzW2ldLnBhcmVudE5vZGUgPSBsYXN0RWxlbWVudDsKICAgIH0KCiAgICByZXR1cm4gbGFzdEVsZW1lbnQ7CiAgfQoKICBvbkVycm9yKGNvZGUpIHsKICAgIHRoaXMuX2Vycm9yQ29kZSA9IGNvZGU7CiAgfQoKfQoKZXhwb3J0cy5TaW1wbGVYTUxQYXJzZXIgPSBTaW1wbGVYTUxQYXJzZXI7CgovKioqLyB9KSwKLyogMTkyICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5jYWxjdWxhdGVTSEEyNTYgPSBleHBvcnRzLmNhbGN1bGF0ZU1ENSA9IGV4cG9ydHMuUERGMjAgPSBleHBvcnRzLlBERjE3ID0gZXhwb3J0cy5DaXBoZXJUcmFuc2Zvcm1GYWN0b3J5ID0gZXhwb3J0cy5BUkNGb3VyQ2lwaGVyID0gZXhwb3J0cy5BRVMyNTZDaXBoZXIgPSBleHBvcnRzLkFFUzEyOENpcGhlciA9IHZvaWQgMDsKZXhwb3J0cy5jYWxjdWxhdGVTSEEzODQgPSBjYWxjdWxhdGVTSEEzODQ7CmV4cG9ydHMuY2FsY3VsYXRlU0hBNTEyID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMwKTsKCnZhciBfZGVjcnlwdF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5Myk7CgpjbGFzcyBBUkNGb3VyQ2lwaGVyIHsKICBjb25zdHJ1Y3RvcihrZXkpIHsKICAgIHRoaXMuYSA9IDA7CiAgICB0aGlzLmIgPSAwOwogICAgY29uc3QgcyA9IG5ldyBVaW50OEFycmF5KDI1Nik7CiAgICBjb25zdCBrZXlMZW5ndGggPSBrZXkubGVuZ3RoOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpIHsKICAgICAgc1tpXSA9IGk7CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgMjU2OyArK2kpIHsKICAgICAgY29uc3QgdG1wID0gc1tpXTsKICAgICAgaiA9IGogKyB0bXAgKyBrZXlbaSAlIGtleUxlbmd0aF0gJiAweGZmOwogICAgICBzW2ldID0gc1tqXTsKICAgICAgc1tqXSA9IHRtcDsKICAgIH0KCiAgICB0aGlzLnMgPSBzOwogIH0KCiAgZW5jcnlwdEJsb2NrKGRhdGEpIHsKICAgIGxldCBhID0gdGhpcy5hLAogICAgICAgIGIgPSB0aGlzLmI7CiAgICBjb25zdCBzID0gdGhpcy5zOwogICAgY29uc3QgbiA9IGRhdGEubGVuZ3RoOwogICAgY29uc3Qgb3V0cHV0ID0gbmV3IFVpbnQ4QXJyYXkobik7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgYSA9IGEgKyAxICYgMHhmZjsKICAgICAgY29uc3QgdG1wID0gc1thXTsKICAgICAgYiA9IGIgKyB0bXAgJiAweGZmOwogICAgICBjb25zdCB0bXAyID0gc1tiXTsKICAgICAgc1thXSA9IHRtcDI7CiAgICAgIHNbYl0gPSB0bXA7CiAgICAgIG91dHB1dFtpXSA9IGRhdGFbaV0gXiBzW3RtcCArIHRtcDIgJiAweGZmXTsKICAgIH0KCiAgICB0aGlzLmEgPSBhOwogICAgdGhpcy5iID0gYjsKICAgIHJldHVybiBvdXRwdXQ7CiAgfQoKICBkZWNyeXB0QmxvY2soZGF0YSkgewogICAgcmV0dXJuIHRoaXMuZW5jcnlwdEJsb2NrKGRhdGEpOwogIH0KCiAgZW5jcnlwdChkYXRhKSB7CiAgICByZXR1cm4gdGhpcy5lbmNyeXB0QmxvY2soZGF0YSk7CiAgfQoKfQoKZXhwb3J0cy5BUkNGb3VyQ2lwaGVyID0gQVJDRm91ckNpcGhlcjsKCmNvbnN0IGNhbGN1bGF0ZU1ENSA9IGZ1bmN0aW9uIGNhbGN1bGF0ZU1ENUNsb3N1cmUoKSB7CiAgY29uc3QgciA9IG5ldyBVaW50OEFycmF5KFs3LCAxMiwgMTcsIDIyLCA3LCAxMiwgMTcsIDIyLCA3LCAxMiwgMTcsIDIyLCA3LCAxMiwgMTcsIDIyLCA1LCA5LCAxNCwgMjAsIDUsIDksIDE0LCAyMCwgNSwgOSwgMTQsIDIwLCA1LCA5LCAxNCwgMjAsIDQsIDExLCAxNiwgMjMsIDQsIDExLCAxNiwgMjMsIDQsIDExLCAxNiwgMjMsIDQsIDExLCAxNiwgMjMsIDYsIDEwLCAxNSwgMjEsIDYsIDEwLCAxNSwgMjEsIDYsIDEwLCAxNSwgMjEsIDYsIDEwLCAxNSwgMjFdKTsKICBjb25zdCBrID0gbmV3IEludDMyQXJyYXkoWy02ODA4NzY5MzYsIC0zODk1NjQ1ODYsIDYwNjEwNTgxOSwgLTEwNDQ1MjUzMzAsIC0xNzY0MTg4OTcsIDEyMDAwODA0MjYsIC0xNDczMjMxMzQxLCAtNDU3MDU5ODMsIDE3NzAwMzU0MTYsIC0xOTU4NDE0NDE3LCAtNDIwNjMsIC0xOTkwNDA0MTYyLCAxODA0NjAzNjgyLCAtNDAzNDExMDEsIC0xNTAyMDAyMjkwLCAxMjM2NTM1MzI5LCAtMTY1Nzk2NTEwLCAtMTA2OTUwMTYzMiwgNjQzNzE3NzEzLCAtMzczODk3MzAyLCAtNzAxNTU4NjkxLCAzODAxNjA4MywgLTY2MDQ3ODMzNSwgLTQwNTUzNzg0OCwgNTY4NDQ2NDM4LCAtMTAxOTgwMzY5MCwgLTE4NzM2Mzk2MSwgMTE2MzUzMTUwMSwgLTE0NDQ2ODE0NjcsIC01MTQwMzc4NCwgMTczNTMyODQ3MywgLTE5MjY2MDc3MzQsIC0zNzg1NTgsIC0yMDIyNTc0NDYzLCAxODM5MDMwNTYyLCAtMzUzMDk1NTYsIC0xNTMwOTkyMDYwLCAxMjcyODkzMzUzLCAtMTU1NDk3NjMyLCAtMTA5NDczMDY0MCwgNjgxMjc5MTc0LCAtMzU4NTM3MjIyLCAtNzIyNTIxOTc5LCA3NjAyOTE4OSwgLTY0MDM2NDQ4NywgLTQyMTgxNTgzNSwgNTMwNzQyNTIwLCAtOTk1MzM4NjUxLCAtMTk4NjMwODQ0LCAxMTI2ODkxNDE1LCAtMTQxNjM1NDkwNSwgLTU3NDM0MDU1LCAxNzAwNDg1NTcxLCAtMTg5NDk4NjYwNiwgLTEwNTE1MjMsIC0yMDU0OTIyNzk5LCAxODczMzEzMzU5LCAtMzA2MTE3NDQsIC0xNTYwMTk4MzgwLCAxMzA5MTUxNjQ5LCAtMTQ1NTIzMDcwLCAtMTEyMDIxMDM3OSwgNzE4Nzg3MjU5LCAtMzQzNDg1NTUxXSk7CgogIGZ1bmN0aW9uIGhhc2goZGF0YSwgb2Zmc2V0LCBsZW5ndGgpIHsKICAgIGxldCBoMCA9IDE3MzI1ODQxOTMsCiAgICAgICAgaDEgPSAtMjcxNzMzODc5LAogICAgICAgIGgyID0gLTE3MzI1ODQxOTQsCiAgICAgICAgaDMgPSAyNzE3MzM4Nzg7CiAgICBjb25zdCBwYWRkZWRMZW5ndGggPSBsZW5ndGggKyA3MiAmIH42MzsKICAgIGNvbnN0IHBhZGRlZCA9IG5ldyBVaW50OEFycmF5KHBhZGRlZExlbmd0aCk7CiAgICBsZXQgaSwgajsKCiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgcGFkZGVkW2ldID0gZGF0YVtvZmZzZXQrK107CiAgICB9CgogICAgcGFkZGVkW2krK10gPSAweDgwOwogICAgY29uc3QgbiA9IHBhZGRlZExlbmd0aCAtIDg7CgogICAgd2hpbGUgKGkgPCBuKSB7CiAgICAgIHBhZGRlZFtpKytdID0gMDsKICAgIH0KCiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA8PCAzICYgMHhmZjsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoID4+IDUgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gMTMgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gMjEgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4+IDI5ICYgMHhmZjsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIGNvbnN0IHcgPSBuZXcgSW50MzJBcnJheSgxNik7CgogICAgZm9yIChpID0gMDsgaSA8IHBhZGRlZExlbmd0aDspIHsKICAgICAgZm9yIChqID0gMDsgaiA8IDE2OyArK2osIGkgKz0gNCkgewogICAgICAgIHdbal0gPSBwYWRkZWRbaV0gfCBwYWRkZWRbaSArIDFdIDw8IDggfCBwYWRkZWRbaSArIDJdIDw8IDE2IHwgcGFkZGVkW2kgKyAzXSA8PCAyNDsKICAgICAgfQoKICAgICAgbGV0IGEgPSBoMCwKICAgICAgICAgIGIgPSBoMSwKICAgICAgICAgIGMgPSBoMiwKICAgICAgICAgIGQgPSBoMywKICAgICAgICAgIGYsCiAgICAgICAgICBnOwoKICAgICAgZm9yIChqID0gMDsgaiA8IDY0OyArK2opIHsKICAgICAgICBpZiAoaiA8IDE2KSB7CiAgICAgICAgICBmID0gYiAmIGMgfCB+YiAmIGQ7CiAgICAgICAgICBnID0gajsKICAgICAgICB9IGVsc2UgaWYgKGogPCAzMikgewogICAgICAgICAgZiA9IGQgJiBiIHwgfmQgJiBjOwogICAgICAgICAgZyA9IDUgKiBqICsgMSAmIDE1OwogICAgICAgIH0gZWxzZSBpZiAoaiA8IDQ4KSB7CiAgICAgICAgICBmID0gYiBeIGMgXiBkOwogICAgICAgICAgZyA9IDMgKiBqICsgNSAmIDE1OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmID0gYyBeIChiIHwgfmQpOwogICAgICAgICAgZyA9IDcgKiBqICYgMTU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCB0bXAgPSBkLAogICAgICAgICAgICAgIHJvdGF0ZUFyZyA9IGEgKyBmICsga1tqXSArIHdbZ10gfCAwLAogICAgICAgICAgICAgIHJvdGF0ZSA9IHJbal07CiAgICAgICAgZCA9IGM7CiAgICAgICAgYyA9IGI7CiAgICAgICAgYiA9IGIgKyAocm90YXRlQXJnIDw8IHJvdGF0ZSB8IHJvdGF0ZUFyZyA+Pj4gMzIgLSByb3RhdGUpIHwgMDsKICAgICAgICBhID0gdG1wOwogICAgICB9CgogICAgICBoMCA9IGgwICsgYSB8IDA7CiAgICAgIGgxID0gaDEgKyBiIHwgMDsKICAgICAgaDIgPSBoMiArIGMgfCAwOwogICAgICBoMyA9IGgzICsgZCB8IDA7CiAgICB9CgogICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFtoMCAmIDB4RkYsIGgwID4+IDggJiAweEZGLCBoMCA+PiAxNiAmIDB4RkYsIGgwID4+PiAyNCAmIDB4RkYsIGgxICYgMHhGRiwgaDEgPj4gOCAmIDB4RkYsIGgxID4+IDE2ICYgMHhGRiwgaDEgPj4+IDI0ICYgMHhGRiwgaDIgJiAweEZGLCBoMiA+PiA4ICYgMHhGRiwgaDIgPj4gMTYgJiAweEZGLCBoMiA+Pj4gMjQgJiAweEZGLCBoMyAmIDB4RkYsIGgzID4+IDggJiAweEZGLCBoMyA+PiAxNiAmIDB4RkYsIGgzID4+PiAyNCAmIDB4RkZdKTsKICB9CgogIHJldHVybiBoYXNoOwp9KCk7CgpleHBvcnRzLmNhbGN1bGF0ZU1ENSA9IGNhbGN1bGF0ZU1ENTsKCmNsYXNzIFdvcmQ2NCB7CiAgY29uc3RydWN0b3IoaGlnaEludGVnZXIsIGxvd0ludGVnZXIpIHsKICAgIHRoaXMuaGlnaCA9IGhpZ2hJbnRlZ2VyIHwgMDsKICAgIHRoaXMubG93ID0gbG93SW50ZWdlciB8IDA7CiAgfQoKICBhbmQod29yZCkgewogICAgdGhpcy5oaWdoICY9IHdvcmQuaGlnaDsKICAgIHRoaXMubG93ICY9IHdvcmQubG93OwogIH0KCiAgeG9yKHdvcmQpIHsKICAgIHRoaXMuaGlnaCBePSB3b3JkLmhpZ2g7CiAgICB0aGlzLmxvdyBePSB3b3JkLmxvdzsKICB9CgogIG9yKHdvcmQpIHsKICAgIHRoaXMuaGlnaCB8PSB3b3JkLmhpZ2g7CiAgICB0aGlzLmxvdyB8PSB3b3JkLmxvdzsKICB9CgogIHNoaWZ0UmlnaHQocGxhY2VzKSB7CiAgICBpZiAocGxhY2VzID49IDMyKSB7CiAgICAgIHRoaXMubG93ID0gdGhpcy5oaWdoID4+PiBwbGFjZXMgLSAzMiB8IDA7CiAgICAgIHRoaXMuaGlnaCA9IDA7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmxvdyA9IHRoaXMubG93ID4+PiBwbGFjZXMgfCB0aGlzLmhpZ2ggPDwgMzIgLSBwbGFjZXM7CiAgICAgIHRoaXMuaGlnaCA9IHRoaXMuaGlnaCA+Pj4gcGxhY2VzIHwgMDsKICAgIH0KICB9CgogIHNoaWZ0TGVmdChwbGFjZXMpIHsKICAgIGlmIChwbGFjZXMgPj0gMzIpIHsKICAgICAgdGhpcy5oaWdoID0gdGhpcy5sb3cgPDwgcGxhY2VzIC0gMzI7CiAgICAgIHRoaXMubG93ID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaGlnaCA9IHRoaXMuaGlnaCA8PCBwbGFjZXMgfCB0aGlzLmxvdyA+Pj4gMzIgLSBwbGFjZXM7CiAgICAgIHRoaXMubG93IDw8PSBwbGFjZXM7CiAgICB9CiAgfQoKICByb3RhdGVSaWdodChwbGFjZXMpIHsKICAgIGxldCBsb3csIGhpZ2g7CgogICAgaWYgKHBsYWNlcyAmIDMyKSB7CiAgICAgIGhpZ2ggPSB0aGlzLmxvdzsKICAgICAgbG93ID0gdGhpcy5oaWdoOwogICAgfSBlbHNlIHsKICAgICAgbG93ID0gdGhpcy5sb3c7CiAgICAgIGhpZ2ggPSB0aGlzLmhpZ2g7CiAgICB9CgogICAgcGxhY2VzICY9IDMxOwogICAgdGhpcy5sb3cgPSBsb3cgPj4+IHBsYWNlcyB8IGhpZ2ggPDwgMzIgLSBwbGFjZXM7CiAgICB0aGlzLmhpZ2ggPSBoaWdoID4+PiBwbGFjZXMgfCBsb3cgPDwgMzIgLSBwbGFjZXM7CiAgfQoKICBub3QoKSB7CiAgICB0aGlzLmhpZ2ggPSB+dGhpcy5oaWdoOwogICAgdGhpcy5sb3cgPSB+dGhpcy5sb3c7CiAgfQoKICBhZGQod29yZCkgewogICAgY29uc3QgbG93QWRkID0gKHRoaXMubG93ID4+PiAwKSArICh3b3JkLmxvdyA+Pj4gMCk7CiAgICBsZXQgaGlnaEFkZCA9ICh0aGlzLmhpZ2ggPj4+IDApICsgKHdvcmQuaGlnaCA+Pj4gMCk7CgogICAgaWYgKGxvd0FkZCA+IDB4ZmZmZmZmZmYpIHsKICAgICAgaGlnaEFkZCArPSAxOwogICAgfQoKICAgIHRoaXMubG93ID0gbG93QWRkIHwgMDsKICAgIHRoaXMuaGlnaCA9IGhpZ2hBZGQgfCAwOwogIH0KCiAgY29weVRvKGJ5dGVzLCBvZmZzZXQpIHsKICAgIGJ5dGVzW29mZnNldF0gPSB0aGlzLmhpZ2ggPj4+IDI0ICYgMHhmZjsKICAgIGJ5dGVzW29mZnNldCArIDFdID0gdGhpcy5oaWdoID4+IDE2ICYgMHhmZjsKICAgIGJ5dGVzW29mZnNldCArIDJdID0gdGhpcy5oaWdoID4+IDggJiAweGZmOwogICAgYnl0ZXNbb2Zmc2V0ICsgM10gPSB0aGlzLmhpZ2ggJiAweGZmOwogICAgYnl0ZXNbb2Zmc2V0ICsgNF0gPSB0aGlzLmxvdyA+Pj4gMjQgJiAweGZmOwogICAgYnl0ZXNbb2Zmc2V0ICsgNV0gPSB0aGlzLmxvdyA+PiAxNiAmIDB4ZmY7CiAgICBieXRlc1tvZmZzZXQgKyA2XSA9IHRoaXMubG93ID4+IDggJiAweGZmOwogICAgYnl0ZXNbb2Zmc2V0ICsgN10gPSB0aGlzLmxvdyAmIDB4ZmY7CiAgfQoKICBhc3NpZ24od29yZCkgewogICAgdGhpcy5oaWdoID0gd29yZC5oaWdoOwogICAgdGhpcy5sb3cgPSB3b3JkLmxvdzsKICB9Cgp9Cgpjb25zdCBjYWxjdWxhdGVTSEEyNTYgPSBmdW5jdGlvbiBjYWxjdWxhdGVTSEEyNTZDbG9zdXJlKCkgewogIGZ1bmN0aW9uIHJvdHIoeCwgbikgewogICAgcmV0dXJuIHggPj4+IG4gfCB4IDw8IDMyIC0gbjsKICB9CgogIGZ1bmN0aW9uIGNoKHgsIHksIHopIHsKICAgIHJldHVybiB4ICYgeSBeIH54ICYgejsKICB9CgogIGZ1bmN0aW9uIG1haih4LCB5LCB6KSB7CiAgICByZXR1cm4geCAmIHkgXiB4ICYgeiBeIHkgJiB6OwogIH0KCiAgZnVuY3Rpb24gc2lnbWEoeCkgewogICAgcmV0dXJuIHJvdHIoeCwgMikgXiByb3RyKHgsIDEzKSBeIHJvdHIoeCwgMjIpOwogIH0KCiAgZnVuY3Rpb24gc2lnbWFQcmltZSh4KSB7CiAgICByZXR1cm4gcm90cih4LCA2KSBeIHJvdHIoeCwgMTEpIF4gcm90cih4LCAyNSk7CiAgfQoKICBmdW5jdGlvbiBsaXR0bGVTaWdtYSh4KSB7CiAgICByZXR1cm4gcm90cih4LCA3KSBeIHJvdHIoeCwgMTgpIF4geCA+Pj4gMzsKICB9CgogIGZ1bmN0aW9uIGxpdHRsZVNpZ21hUHJpbWUoeCkgewogICAgcmV0dXJuIHJvdHIoeCwgMTcpIF4gcm90cih4LCAxOSkgXiB4ID4+PiAxMDsKICB9CgogIGNvbnN0IGsgPSBbMHg0MjhhMmY5OCwgMHg3MTM3NDQ5MSwgMHhiNWMwZmJjZiwgMHhlOWI1ZGJhNSwgMHgzOTU2YzI1YiwgMHg1OWYxMTFmMSwgMHg5MjNmODJhNCwgMHhhYjFjNWVkNSwgMHhkODA3YWE5OCwgMHgxMjgzNWIwMSwgMHgyNDMxODViZSwgMHg1NTBjN2RjMywgMHg3MmJlNWQ3NCwgMHg4MGRlYjFmZSwgMHg5YmRjMDZhNywgMHhjMTliZjE3NCwgMHhlNDliNjljMSwgMHhlZmJlNDc4NiwgMHgwZmMxOWRjNiwgMHgyNDBjYTFjYywgMHgyZGU5MmM2ZiwgMHg0YTc0ODRhYSwgMHg1Y2IwYTlkYywgMHg3NmY5ODhkYSwgMHg5ODNlNTE1MiwgMHhhODMxYzY2ZCwgMHhiMDAzMjdjOCwgMHhiZjU5N2ZjNywgMHhjNmUwMGJmMywgMHhkNWE3OTE0NywgMHgwNmNhNjM1MSwgMHgxNDI5Mjk2NywgMHgyN2I3MGE4NSwgMHgyZTFiMjEzOCwgMHg0ZDJjNmRmYywgMHg1MzM4MGQxMywgMHg2NTBhNzM1NCwgMHg3NjZhMGFiYiwgMHg4MWMyYzkyZSwgMHg5MjcyMmM4NSwgMHhhMmJmZThhMSwgMHhhODFhNjY0YiwgMHhjMjRiOGI3MCwgMHhjNzZjNTFhMywgMHhkMTkyZTgxOSwgMHhkNjk5MDYyNCwgMHhmNDBlMzU4NSwgMHgxMDZhYTA3MCwgMHgxOWE0YzExNiwgMHgxZTM3NmMwOCwgMHgyNzQ4Nzc0YywgMHgzNGIwYmNiNSwgMHgzOTFjMGNiMywgMHg0ZWQ4YWE0YSwgMHg1YjljY2E0ZiwgMHg2ODJlNmZmMywgMHg3NDhmODJlZSwgMHg3OGE1NjM2ZiwgMHg4NGM4NzgxNCwgMHg4Y2M3MDIwOCwgMHg5MGJlZmZmYSwgMHhhNDUwNmNlYiwgMHhiZWY5YTNmNywgMHhjNjcxNzhmMl07CgogIGZ1bmN0aW9uIGhhc2goZGF0YSwgb2Zmc2V0LCBsZW5ndGgpIHsKICAgIGxldCBoMCA9IDB4NmEwOWU2NjcsCiAgICAgICAgaDEgPSAweGJiNjdhZTg1LAogICAgICAgIGgyID0gMHgzYzZlZjM3MiwKICAgICAgICBoMyA9IDB4YTU0ZmY1M2EsCiAgICAgICAgaDQgPSAweDUxMGU1MjdmLAogICAgICAgIGg1ID0gMHg5YjA1Njg4YywKICAgICAgICBoNiA9IDB4MWY4M2Q5YWIsCiAgICAgICAgaDcgPSAweDViZTBjZDE5OwogICAgY29uc3QgcGFkZGVkTGVuZ3RoID0gTWF0aC5jZWlsKChsZW5ndGggKyA5KSAvIDY0KSAqIDY0OwogICAgY29uc3QgcGFkZGVkID0gbmV3IFVpbnQ4QXJyYXkocGFkZGVkTGVuZ3RoKTsKICAgIGxldCBpLCBqOwoKICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICBwYWRkZWRbaV0gPSBkYXRhW29mZnNldCsrXTsKICAgIH0KCiAgICBwYWRkZWRbaSsrXSA9IDB4ODA7CiAgICBjb25zdCBuID0gcGFkZGVkTGVuZ3RoIC0gODsKCiAgICB3aGlsZSAoaSA8IG4pIHsKICAgICAgcGFkZGVkW2krK10gPSAwOwogICAgfQoKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoID4+PiAyOSAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+PiAyMSAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+PiAxMyAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+PiA1ICYgMHhmZjsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoIDw8IDMgJiAweGZmOwogICAgY29uc3QgdyA9IG5ldyBVaW50MzJBcnJheSg2NCk7CgogICAgZm9yIChpID0gMDsgaSA8IHBhZGRlZExlbmd0aDspIHsKICAgICAgZm9yIChqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgICB3W2pdID0gcGFkZGVkW2ldIDw8IDI0IHwgcGFkZGVkW2kgKyAxXSA8PCAxNiB8IHBhZGRlZFtpICsgMl0gPDwgOCB8IHBhZGRlZFtpICsgM107CiAgICAgICAgaSArPSA0OwogICAgICB9CgogICAgICBmb3IgKGogPSAxNjsgaiA8IDY0OyArK2opIHsKICAgICAgICB3W2pdID0gbGl0dGxlU2lnbWFQcmltZSh3W2ogLSAyXSkgKyB3W2ogLSA3XSArIGxpdHRsZVNpZ21hKHdbaiAtIDE1XSkgKyB3W2ogLSAxNl0gfCAwOwogICAgICB9CgogICAgICBsZXQgYSA9IGgwLAogICAgICAgICAgYiA9IGgxLAogICAgICAgICAgYyA9IGgyLAogICAgICAgICAgZCA9IGgzLAogICAgICAgICAgZSA9IGg0LAogICAgICAgICAgZiA9IGg1LAogICAgICAgICAgZyA9IGg2LAogICAgICAgICAgaCA9IGg3LAogICAgICAgICAgdDEsCiAgICAgICAgICB0MjsKCiAgICAgIGZvciAoaiA9IDA7IGogPCA2NDsgKytqKSB7CiAgICAgICAgdDEgPSBoICsgc2lnbWFQcmltZShlKSArIGNoKGUsIGYsIGcpICsga1tqXSArIHdbal07CiAgICAgICAgdDIgPSBzaWdtYShhKSArIG1haihhLCBiLCBjKTsKICAgICAgICBoID0gZzsKICAgICAgICBnID0gZjsKICAgICAgICBmID0gZTsKICAgICAgICBlID0gZCArIHQxIHwgMDsKICAgICAgICBkID0gYzsKICAgICAgICBjID0gYjsKICAgICAgICBiID0gYTsKICAgICAgICBhID0gdDEgKyB0MiB8IDA7CiAgICAgIH0KCiAgICAgIGgwID0gaDAgKyBhIHwgMDsKICAgICAgaDEgPSBoMSArIGIgfCAwOwogICAgICBoMiA9IGgyICsgYyB8IDA7CiAgICAgIGgzID0gaDMgKyBkIHwgMDsKICAgICAgaDQgPSBoNCArIGUgfCAwOwogICAgICBoNSA9IGg1ICsgZiB8IDA7CiAgICAgIGg2ID0gaDYgKyBnIHwgMDsKICAgICAgaDcgPSBoNyArIGggfCAwOwogICAgfQoKICAgIHJldHVybiBuZXcgVWludDhBcnJheShbaDAgPj4gMjQgJiAweEZGLCBoMCA+PiAxNiAmIDB4RkYsIGgwID4+IDggJiAweEZGLCBoMCAmIDB4RkYsIGgxID4+IDI0ICYgMHhGRiwgaDEgPj4gMTYgJiAweEZGLCBoMSA+PiA4ICYgMHhGRiwgaDEgJiAweEZGLCBoMiA+PiAyNCAmIDB4RkYsIGgyID4+IDE2ICYgMHhGRiwgaDIgPj4gOCAmIDB4RkYsIGgyICYgMHhGRiwgaDMgPj4gMjQgJiAweEZGLCBoMyA+PiAxNiAmIDB4RkYsIGgzID4+IDggJiAweEZGLCBoMyAmIDB4RkYsIGg0ID4+IDI0ICYgMHhGRiwgaDQgPj4gMTYgJiAweEZGLCBoNCA+PiA4ICYgMHhGRiwgaDQgJiAweEZGLCBoNSA+PiAyNCAmIDB4RkYsIGg1ID4+IDE2ICYgMHhGRiwgaDUgPj4gOCAmIDB4RkYsIGg1ICYgMHhGRiwgaDYgPj4gMjQgJiAweEZGLCBoNiA+PiAxNiAmIDB4RkYsIGg2ID4+IDggJiAweEZGLCBoNiAmIDB4RkYsIGg3ID4+IDI0ICYgMHhGRiwgaDcgPj4gMTYgJiAweEZGLCBoNyA+PiA4ICYgMHhGRiwgaDcgJiAweEZGXSk7CiAgfQoKICByZXR1cm4gaGFzaDsKfSgpOwoKZXhwb3J0cy5jYWxjdWxhdGVTSEEyNTYgPSBjYWxjdWxhdGVTSEEyNTY7Cgpjb25zdCBjYWxjdWxhdGVTSEE1MTIgPSBmdW5jdGlvbiBjYWxjdWxhdGVTSEE1MTJDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGNoKHJlc3VsdCwgeCwgeSwgeiwgdG1wKSB7CiAgICByZXN1bHQuYXNzaWduKHgpOwogICAgcmVzdWx0LmFuZCh5KTsKICAgIHRtcC5hc3NpZ24oeCk7CiAgICB0bXAubm90KCk7CiAgICB0bXAuYW5kKHopOwogICAgcmVzdWx0Lnhvcih0bXApOwogIH0KCiAgZnVuY3Rpb24gbWFqKHJlc3VsdCwgeCwgeSwgeiwgdG1wKSB7CiAgICByZXN1bHQuYXNzaWduKHgpOwogICAgcmVzdWx0LmFuZCh5KTsKICAgIHRtcC5hc3NpZ24oeCk7CiAgICB0bXAuYW5kKHopOwogICAgcmVzdWx0Lnhvcih0bXApOwogICAgdG1wLmFzc2lnbih5KTsKICAgIHRtcC5hbmQoeik7CiAgICByZXN1bHQueG9yKHRtcCk7CiAgfQoKICBmdW5jdGlvbiBzaWdtYShyZXN1bHQsIHgsIHRtcCkgewogICAgcmVzdWx0LmFzc2lnbih4KTsKICAgIHJlc3VsdC5yb3RhdGVSaWdodCgyOCk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLnJvdGF0ZVJpZ2h0KDM0KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICAgIHRtcC5hc3NpZ24oeCk7CiAgICB0bXAucm90YXRlUmlnaHQoMzkpOwogICAgcmVzdWx0Lnhvcih0bXApOwogIH0KCiAgZnVuY3Rpb24gc2lnbWFQcmltZShyZXN1bHQsIHgsIHRtcCkgewogICAgcmVzdWx0LmFzc2lnbih4KTsKICAgIHJlc3VsdC5yb3RhdGVSaWdodCgxNCk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLnJvdGF0ZVJpZ2h0KDE4KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICAgIHRtcC5hc3NpZ24oeCk7CiAgICB0bXAucm90YXRlUmlnaHQoNDEpOwogICAgcmVzdWx0Lnhvcih0bXApOwogIH0KCiAgZnVuY3Rpb24gbGl0dGxlU2lnbWEocmVzdWx0LCB4LCB0bXApIHsKICAgIHJlc3VsdC5hc3NpZ24oeCk7CiAgICByZXN1bHQucm90YXRlUmlnaHQoMSk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLnJvdGF0ZVJpZ2h0KDgpOwogICAgcmVzdWx0Lnhvcih0bXApOwogICAgdG1wLmFzc2lnbih4KTsKICAgIHRtcC5zaGlmdFJpZ2h0KDcpOwogICAgcmVzdWx0Lnhvcih0bXApOwogIH0KCiAgZnVuY3Rpb24gbGl0dGxlU2lnbWFQcmltZShyZXN1bHQsIHgsIHRtcCkgewogICAgcmVzdWx0LmFzc2lnbih4KTsKICAgIHJlc3VsdC5yb3RhdGVSaWdodCgxOSk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLnJvdGF0ZVJpZ2h0KDYxKTsKICAgIHJlc3VsdC54b3IodG1wKTsKICAgIHRtcC5hc3NpZ24oeCk7CiAgICB0bXAuc2hpZnRSaWdodCg2KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICB9CgogIGNvbnN0IGsgPSBbbmV3IFdvcmQ2NCgweDQyOGEyZjk4LCAweGQ3MjhhZTIyKSwgbmV3IFdvcmQ2NCgweDcxMzc0NDkxLCAweDIzZWY2NWNkKSwgbmV3IFdvcmQ2NCgweGI1YzBmYmNmLCAweGVjNGQzYjJmKSwgbmV3IFdvcmQ2NCgweGU5YjVkYmE1LCAweDgxODlkYmJjKSwgbmV3IFdvcmQ2NCgweDM5NTZjMjViLCAweGYzNDhiNTM4KSwgbmV3IFdvcmQ2NCgweDU5ZjExMWYxLCAweGI2MDVkMDE5KSwgbmV3IFdvcmQ2NCgweDkyM2Y4MmE0LCAweGFmMTk0ZjliKSwgbmV3IFdvcmQ2NCgweGFiMWM1ZWQ1LCAweGRhNmQ4MTE4KSwgbmV3IFdvcmQ2NCgweGQ4MDdhYTk4LCAweGEzMDMwMjQyKSwgbmV3IFdvcmQ2NCgweDEyODM1YjAxLCAweDQ1NzA2ZmJlKSwgbmV3IFdvcmQ2NCgweDI0MzE4NWJlLCAweDRlZTRiMjhjKSwgbmV3IFdvcmQ2NCgweDU1MGM3ZGMzLCAweGQ1ZmZiNGUyKSwgbmV3IFdvcmQ2NCgweDcyYmU1ZDc0LCAweGYyN2I4OTZmKSwgbmV3IFdvcmQ2NCgweDgwZGViMWZlLCAweDNiMTY5NmIxKSwgbmV3IFdvcmQ2NCgweDliZGMwNmE3LCAweDI1YzcxMjM1KSwgbmV3IFdvcmQ2NCgweGMxOWJmMTc0LCAweGNmNjkyNjk0KSwgbmV3IFdvcmQ2NCgweGU0OWI2OWMxLCAweDllZjE0YWQyKSwgbmV3IFdvcmQ2NCgweGVmYmU0Nzg2LCAweDM4NGYyNWUzKSwgbmV3IFdvcmQ2NCgweDBmYzE5ZGM2LCAweDhiOGNkNWI1KSwgbmV3IFdvcmQ2NCgweDI0MGNhMWNjLCAweDc3YWM5YzY1KSwgbmV3IFdvcmQ2NCgweDJkZTkyYzZmLCAweDU5MmIwMjc1KSwgbmV3IFdvcmQ2NCgweDRhNzQ4NGFhLCAweDZlYTZlNDgzKSwgbmV3IFdvcmQ2NCgweDVjYjBhOWRjLCAweGJkNDFmYmQ0KSwgbmV3IFdvcmQ2NCgweDc2Zjk4OGRhLCAweDgzMTE1M2I1KSwgbmV3IFdvcmQ2NCgweDk4M2U1MTUyLCAweGVlNjZkZmFiKSwgbmV3IFdvcmQ2NCgweGE4MzFjNjZkLCAweDJkYjQzMjEwKSwgbmV3IFdvcmQ2NCgweGIwMDMyN2M4LCAweDk4ZmIyMTNmKSwgbmV3IFdvcmQ2NCgweGJmNTk3ZmM3LCAweGJlZWYwZWU0KSwgbmV3IFdvcmQ2NCgweGM2ZTAwYmYzLCAweDNkYTg4ZmMyKSwgbmV3IFdvcmQ2NCgweGQ1YTc5MTQ3LCAweDkzMGFhNzI1KSwgbmV3IFdvcmQ2NCgweDA2Y2E2MzUxLCAweGUwMDM4MjZmKSwgbmV3IFdvcmQ2NCgweDE0MjkyOTY3LCAweDBhMGU2ZTcwKSwgbmV3IFdvcmQ2NCgweDI3YjcwYTg1LCAweDQ2ZDIyZmZjKSwgbmV3IFdvcmQ2NCgweDJlMWIyMTM4LCAweDVjMjZjOTI2KSwgbmV3IFdvcmQ2NCgweDRkMmM2ZGZjLCAweDVhYzQyYWVkKSwgbmV3IFdvcmQ2NCgweDUzMzgwZDEzLCAweDlkOTViM2RmKSwgbmV3IFdvcmQ2NCgweDY1MGE3MzU0LCAweDhiYWY2M2RlKSwgbmV3IFdvcmQ2NCgweDc2NmEwYWJiLCAweDNjNzdiMmE4KSwgbmV3IFdvcmQ2NCgweDgxYzJjOTJlLCAweDQ3ZWRhZWU2KSwgbmV3IFdvcmQ2NCgweDkyNzIyYzg1LCAweDE0ODIzNTNiKSwgbmV3IFdvcmQ2NCgweGEyYmZlOGExLCAweDRjZjEwMzY0KSwgbmV3IFdvcmQ2NCgweGE4MWE2NjRiLCAweGJjNDIzMDAxKSwgbmV3IFdvcmQ2NCgweGMyNGI4YjcwLCAweGQwZjg5NzkxKSwgbmV3IFdvcmQ2NCgweGM3NmM1MWEzLCAweDA2NTRiZTMwKSwgbmV3IFdvcmQ2NCgweGQxOTJlODE5LCAweGQ2ZWY1MjE4KSwgbmV3IFdvcmQ2NCgweGQ2OTkwNjI0LCAweDU1NjVhOTEwKSwgbmV3IFdvcmQ2NCgweGY0MGUzNTg1LCAweDU3NzEyMDJhKSwgbmV3IFdvcmQ2NCgweDEwNmFhMDcwLCAweDMyYmJkMWI4KSwgbmV3IFdvcmQ2NCgweDE5YTRjMTE2LCAweGI4ZDJkMGM4KSwgbmV3IFdvcmQ2NCgweDFlMzc2YzA4LCAweDUxNDFhYjUzKSwgbmV3IFdvcmQ2NCgweDI3NDg3NzRjLCAweGRmOGVlYjk5KSwgbmV3IFdvcmQ2NCgweDM0YjBiY2I1LCAweGUxOWI0OGE4KSwgbmV3IFdvcmQ2NCgweDM5MWMwY2IzLCAweGM1Yzk1YTYzKSwgbmV3IFdvcmQ2NCgweDRlZDhhYTRhLCAweGUzNDE4YWNiKSwgbmV3IFdvcmQ2NCgweDViOWNjYTRmLCAweDc3NjNlMzczKSwgbmV3IFdvcmQ2NCgweDY4MmU2ZmYzLCAweGQ2YjJiOGEzKSwgbmV3IFdvcmQ2NCgweDc0OGY4MmVlLCAweDVkZWZiMmZjKSwgbmV3IFdvcmQ2NCgweDc4YTU2MzZmLCAweDQzMTcyZjYwKSwgbmV3IFdvcmQ2NCgweDg0Yzg3ODE0LCAweGExZjBhYjcyKSwgbmV3IFdvcmQ2NCgweDhjYzcwMjA4LCAweDFhNjQzOWVjKSwgbmV3IFdvcmQ2NCgweDkwYmVmZmZhLCAweDIzNjMxZTI4KSwgbmV3IFdvcmQ2NCgweGE0NTA2Y2ViLCAweGRlODJiZGU5KSwgbmV3IFdvcmQ2NCgweGJlZjlhM2Y3LCAweGIyYzY3OTE1KSwgbmV3IFdvcmQ2NCgweGM2NzE3OGYyLCAweGUzNzI1MzJiKSwgbmV3IFdvcmQ2NCgweGNhMjczZWNlLCAweGVhMjY2MTljKSwgbmV3IFdvcmQ2NCgweGQxODZiOGM3LCAweDIxYzBjMjA3KSwgbmV3IFdvcmQ2NCgweGVhZGE3ZGQ2LCAweGNkZTBlYjFlKSwgbmV3IFdvcmQ2NCgweGY1N2Q0ZjdmLCAweGVlNmVkMTc4KSwgbmV3IFdvcmQ2NCgweDA2ZjA2N2FhLCAweDcyMTc2ZmJhKSwgbmV3IFdvcmQ2NCgweDBhNjM3ZGM1LCAweGEyYzg5OGE2KSwgbmV3IFdvcmQ2NCgweDExM2Y5ODA0LCAweGJlZjkwZGFlKSwgbmV3IFdvcmQ2NCgweDFiNzEwYjM1LCAweDEzMWM0NzFiKSwgbmV3IFdvcmQ2NCgweDI4ZGI3N2Y1LCAweDIzMDQ3ZDg0KSwgbmV3IFdvcmQ2NCgweDMyY2FhYjdiLCAweDQwYzcyNDkzKSwgbmV3IFdvcmQ2NCgweDNjOWViZTBhLCAweDE1YzliZWJjKSwgbmV3IFdvcmQ2NCgweDQzMWQ2N2M0LCAweDljMTAwZDRjKSwgbmV3IFdvcmQ2NCgweDRjYzVkNGJlLCAweGNiM2U0MmI2KSwgbmV3IFdvcmQ2NCgweDU5N2YyOTljLCAweGZjNjU3ZTJhKSwgbmV3IFdvcmQ2NCgweDVmY2I2ZmFiLCAweDNhZDZmYWVjKSwgbmV3IFdvcmQ2NCgweDZjNDQxOThjLCAweDRhNDc1ODE3KV07CgogIGZ1bmN0aW9uIGhhc2goZGF0YSwgb2Zmc2V0LCBsZW5ndGgpIHsKICAgIGxldCBtb2RlMzg0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKICAgIGxldCBoMCwgaDEsIGgyLCBoMywgaDQsIGg1LCBoNiwgaDc7CgogICAgaWYgKCFtb2RlMzg0KSB7CiAgICAgIGgwID0gbmV3IFdvcmQ2NCgweDZhMDllNjY3LCAweGYzYmNjOTA4KTsKICAgICAgaDEgPSBuZXcgV29yZDY0KDB4YmI2N2FlODUsIDB4ODRjYWE3M2IpOwogICAgICBoMiA9IG5ldyBXb3JkNjQoMHgzYzZlZjM3MiwgMHhmZTk0ZjgyYik7CiAgICAgIGgzID0gbmV3IFdvcmQ2NCgweGE1NGZmNTNhLCAweDVmMWQzNmYxKTsKICAgICAgaDQgPSBuZXcgV29yZDY0KDB4NTEwZTUyN2YsIDB4YWRlNjgyZDEpOwogICAgICBoNSA9IG5ldyBXb3JkNjQoMHg5YjA1Njg4YywgMHgyYjNlNmMxZik7CiAgICAgIGg2ID0gbmV3IFdvcmQ2NCgweDFmODNkOWFiLCAweGZiNDFiZDZiKTsKICAgICAgaDcgPSBuZXcgV29yZDY0KDB4NWJlMGNkMTksIDB4MTM3ZTIxNzkpOwogICAgfSBlbHNlIHsKICAgICAgaDAgPSBuZXcgV29yZDY0KDB4Y2JiYjlkNWQsIDB4YzEwNTllZDgpOwogICAgICBoMSA9IG5ldyBXb3JkNjQoMHg2MjlhMjkyYSwgMHgzNjdjZDUwNyk7CiAgICAgIGgyID0gbmV3IFdvcmQ2NCgweDkxNTkwMTVhLCAweDMwNzBkZDE3KTsKICAgICAgaDMgPSBuZXcgV29yZDY0KDB4MTUyZmVjZDgsIDB4ZjcwZTU5MzkpOwogICAgICBoNCA9IG5ldyBXb3JkNjQoMHg2NzMzMjY2NywgMHhmZmMwMGIzMSk7CiAgICAgIGg1ID0gbmV3IFdvcmQ2NCgweDhlYjQ0YTg3LCAweDY4NTgxNTExKTsKICAgICAgaDYgPSBuZXcgV29yZDY0KDB4ZGIwYzJlMGQsIDB4NjRmOThmYTcpOwogICAgICBoNyA9IG5ldyBXb3JkNjQoMHg0N2I1NDgxZCwgMHhiZWZhNGZhNCk7CiAgICB9CgogICAgY29uc3QgcGFkZGVkTGVuZ3RoID0gTWF0aC5jZWlsKChsZW5ndGggKyAxNykgLyAxMjgpICogMTI4OwogICAgY29uc3QgcGFkZGVkID0gbmV3IFVpbnQ4QXJyYXkocGFkZGVkTGVuZ3RoKTsKICAgIGxldCBpLCBqOwoKICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICBwYWRkZWRbaV0gPSBkYXRhW29mZnNldCsrXTsKICAgIH0KCiAgICBwYWRkZWRbaSsrXSA9IDB4ODA7CiAgICBjb25zdCBuID0gcGFkZGVkTGVuZ3RoIC0gMTY7CgogICAgd2hpbGUgKGkgPCBuKSB7CiAgICAgIHBhZGRlZFtpKytdID0gMDsKICAgIH0KCiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+Pj4gMjkgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gMjEgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gMTMgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gNSAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA8PCAzICYgMHhmZjsKICAgIGNvbnN0IHcgPSBuZXcgQXJyYXkoODApOwoKICAgIGZvciAoaSA9IDA7IGkgPCA4MDsgaSsrKSB7CiAgICAgIHdbaV0gPSBuZXcgV29yZDY0KDAsIDApOwogICAgfQoKICAgIGxldCBhID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBiID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBjID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIGxldCBkID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBlID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBmID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIGxldCBnID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBoID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIGNvbnN0IHQxID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICAgIHQyID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIGNvbnN0IHRtcDEgPSBuZXcgV29yZDY0KDAsIDApLAogICAgICAgICAgdG1wMiA9IG5ldyBXb3JkNjQoMCwgMCk7CiAgICBsZXQgdG1wMzsKCiAgICBmb3IgKGkgPSAwOyBpIDwgcGFkZGVkTGVuZ3RoOykgewogICAgICBmb3IgKGogPSAwOyBqIDwgMTY7ICsraikgewogICAgICAgIHdbal0uaGlnaCA9IHBhZGRlZFtpXSA8PCAyNCB8IHBhZGRlZFtpICsgMV0gPDwgMTYgfCBwYWRkZWRbaSArIDJdIDw8IDggfCBwYWRkZWRbaSArIDNdOwogICAgICAgIHdbal0ubG93ID0gcGFkZGVkW2kgKyA0XSA8PCAyNCB8IHBhZGRlZFtpICsgNV0gPDwgMTYgfCBwYWRkZWRbaSArIDZdIDw8IDggfCBwYWRkZWRbaSArIDddOwogICAgICAgIGkgKz0gODsKICAgICAgfQoKICAgICAgZm9yIChqID0gMTY7IGogPCA4MDsgKytqKSB7CiAgICAgICAgdG1wMyA9IHdbal07CiAgICAgICAgbGl0dGxlU2lnbWFQcmltZSh0bXAzLCB3W2ogLSAyXSwgdG1wMik7CiAgICAgICAgdG1wMy5hZGQod1tqIC0gN10pOwogICAgICAgIGxpdHRsZVNpZ21hKHRtcDEsIHdbaiAtIDE1XSwgdG1wMik7CiAgICAgICAgdG1wMy5hZGQodG1wMSk7CiAgICAgICAgdG1wMy5hZGQod1tqIC0gMTZdKTsKICAgICAgfQoKICAgICAgYS5hc3NpZ24oaDApOwogICAgICBiLmFzc2lnbihoMSk7CiAgICAgIGMuYXNzaWduKGgyKTsKICAgICAgZC5hc3NpZ24oaDMpOwogICAgICBlLmFzc2lnbihoNCk7CiAgICAgIGYuYXNzaWduKGg1KTsKICAgICAgZy5hc3NpZ24oaDYpOwogICAgICBoLmFzc2lnbihoNyk7CgogICAgICBmb3IgKGogPSAwOyBqIDwgODA7ICsraikgewogICAgICAgIHQxLmFzc2lnbihoKTsKICAgICAgICBzaWdtYVByaW1lKHRtcDEsIGUsIHRtcDIpOwogICAgICAgIHQxLmFkZCh0bXAxKTsKICAgICAgICBjaCh0bXAxLCBlLCBmLCBnLCB0bXAyKTsKICAgICAgICB0MS5hZGQodG1wMSk7CiAgICAgICAgdDEuYWRkKGtbal0pOwogICAgICAgIHQxLmFkZCh3W2pdKTsKICAgICAgICBzaWdtYSh0MiwgYSwgdG1wMik7CiAgICAgICAgbWFqKHRtcDEsIGEsIGIsIGMsIHRtcDIpOwogICAgICAgIHQyLmFkZCh0bXAxKTsKICAgICAgICB0bXAzID0gaDsKICAgICAgICBoID0gZzsKICAgICAgICBnID0gZjsKICAgICAgICBmID0gZTsKICAgICAgICBkLmFkZCh0MSk7CiAgICAgICAgZSA9IGQ7CiAgICAgICAgZCA9IGM7CiAgICAgICAgYyA9IGI7CiAgICAgICAgYiA9IGE7CiAgICAgICAgdG1wMy5hc3NpZ24odDEpOwogICAgICAgIHRtcDMuYWRkKHQyKTsKICAgICAgICBhID0gdG1wMzsKICAgICAgfQoKICAgICAgaDAuYWRkKGEpOwogICAgICBoMS5hZGQoYik7CiAgICAgIGgyLmFkZChjKTsKICAgICAgaDMuYWRkKGQpOwogICAgICBoNC5hZGQoZSk7CiAgICAgIGg1LmFkZChmKTsKICAgICAgaDYuYWRkKGcpOwogICAgICBoNy5hZGQoaCk7CiAgICB9CgogICAgbGV0IHJlc3VsdDsKCiAgICBpZiAoIW1vZGUzODQpIHsKICAgICAgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoNjQpOwogICAgICBoMC5jb3B5VG8ocmVzdWx0LCAwKTsKICAgICAgaDEuY29weVRvKHJlc3VsdCwgOCk7CiAgICAgIGgyLmNvcHlUbyhyZXN1bHQsIDE2KTsKICAgICAgaDMuY29weVRvKHJlc3VsdCwgMjQpOwogICAgICBoNC5jb3B5VG8ocmVzdWx0LCAzMik7CiAgICAgIGg1LmNvcHlUbyhyZXN1bHQsIDQwKTsKICAgICAgaDYuY29weVRvKHJlc3VsdCwgNDgpOwogICAgICBoNy5jb3B5VG8ocmVzdWx0LCA1Nik7CiAgICB9IGVsc2UgewogICAgICByZXN1bHQgPSBuZXcgVWludDhBcnJheSg0OCk7CiAgICAgIGgwLmNvcHlUbyhyZXN1bHQsIDApOwogICAgICBoMS5jb3B5VG8ocmVzdWx0LCA4KTsKICAgICAgaDIuY29weVRvKHJlc3VsdCwgMTYpOwogICAgICBoMy5jb3B5VG8ocmVzdWx0LCAyNCk7CiAgICAgIGg0LmNvcHlUbyhyZXN1bHQsIDMyKTsKICAgICAgaDUuY29weVRvKHJlc3VsdCwgNDApOwogICAgfQoKICAgIHJldHVybiByZXN1bHQ7CiAgfQoKICByZXR1cm4gaGFzaDsKfSgpOwoKZXhwb3J0cy5jYWxjdWxhdGVTSEE1MTIgPSBjYWxjdWxhdGVTSEE1MTI7CgpmdW5jdGlvbiBjYWxjdWxhdGVTSEEzODQoZGF0YSwgb2Zmc2V0LCBsZW5ndGgpIHsKICByZXR1cm4gY2FsY3VsYXRlU0hBNTEyKGRhdGEsIG9mZnNldCwgbGVuZ3RoLCB0cnVlKTsKfQoKY2xhc3MgTnVsbENpcGhlciB7CiAgZGVjcnlwdEJsb2NrKGRhdGEpIHsKICAgIHJldHVybiBkYXRhOwogIH0KCiAgZW5jcnlwdChkYXRhKSB7CiAgICByZXR1cm4gZGF0YTsKICB9Cgp9CgpjbGFzcyBBRVNCYXNlQ2lwaGVyIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBBRVNCYXNlQ2lwaGVyKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBpbml0aWFsaXplIEFFU0Jhc2VDaXBoZXIuIik7CiAgICB9CgogICAgdGhpcy5fcyA9IG5ldyBVaW50OEFycmF5KFsweDYzLCAweDdjLCAweDc3LCAweDdiLCAweGYyLCAweDZiLCAweDZmLCAweGM1LCAweDMwLCAweDAxLCAweDY3LCAweDJiLCAweGZlLCAweGQ3LCAweGFiLCAweDc2LCAweGNhLCAweDgyLCAweGM5LCAweDdkLCAweGZhLCAweDU5LCAweDQ3LCAweGYwLCAweGFkLCAweGQ0LCAweGEyLCAweGFmLCAweDljLCAweGE0LCAweDcyLCAweGMwLCAweGI3LCAweGZkLCAweDkzLCAweDI2LCAweDM2LCAweDNmLCAweGY3LCAweGNjLCAweDM0LCAweGE1LCAweGU1LCAweGYxLCAweDcxLCAweGQ4LCAweDMxLCAweDE1LCAweDA0LCAweGM3LCAweDIzLCAweGMzLCAweDE4LCAweDk2LCAweDA1LCAweDlhLCAweDA3LCAweDEyLCAweDgwLCAweGUyLCAweGViLCAweDI3LCAweGIyLCAweDc1LCAweDA5LCAweDgzLCAweDJjLCAweDFhLCAweDFiLCAweDZlLCAweDVhLCAweGEwLCAweDUyLCAweDNiLCAweGQ2LCAweGIzLCAweDI5LCAweGUzLCAweDJmLCAweDg0LCAweDUzLCAweGQxLCAweDAwLCAweGVkLCAweDIwLCAweGZjLCAweGIxLCAweDViLCAweDZhLCAweGNiLCAweGJlLCAweDM5LCAweDRhLCAweDRjLCAweDU4LCAweGNmLCAweGQwLCAweGVmLCAweGFhLCAweGZiLCAweDQzLCAweDRkLCAweDMzLCAweDg1LCAweDQ1LCAweGY5LCAweDAyLCAweDdmLCAweDUwLCAweDNjLCAweDlmLCAweGE4LCAweDUxLCAweGEzLCAweDQwLCAweDhmLCAweDkyLCAweDlkLCAweDM4LCAweGY1LCAweGJjLCAweGI2LCAweGRhLCAweDIxLCAweDEwLCAweGZmLCAweGYzLCAweGQyLCAweGNkLCAweDBjLCAweDEzLCAweGVjLCAweDVmLCAweDk3LCAweDQ0LCAweDE3LCAweGM0LCAweGE3LCAweDdlLCAweDNkLCAweDY0LCAweDVkLCAweDE5LCAweDczLCAweDYwLCAweDgxLCAweDRmLCAweGRjLCAweDIyLCAweDJhLCAweDkwLCAweDg4LCAweDQ2LCAweGVlLCAweGI4LCAweDE0LCAweGRlLCAweDVlLCAweDBiLCAweGRiLCAweGUwLCAweDMyLCAweDNhLCAweDBhLCAweDQ5LCAweDA2LCAweDI0LCAweDVjLCAweGMyLCAweGQzLCAweGFjLCAweDYyLCAweDkxLCAweDk1LCAweGU0LCAweDc5LCAweGU3LCAweGM4LCAweDM3LCAweDZkLCAweDhkLCAweGQ1LCAweDRlLCAweGE5LCAweDZjLCAweDU2LCAweGY0LCAweGVhLCAweDY1LCAweDdhLCAweGFlLCAweDA4LCAweGJhLCAweDc4LCAweDI1LCAweDJlLCAweDFjLCAweGE2LCAweGI0LCAweGM2LCAweGU4LCAweGRkLCAweDc0LCAweDFmLCAweDRiLCAweGJkLCAweDhiLCAweDhhLCAweDcwLCAweDNlLCAweGI1LCAweDY2LCAweDQ4LCAweDAzLCAweGY2LCAweDBlLCAweDYxLCAweDM1LCAweDU3LCAweGI5LCAweDg2LCAweGMxLCAweDFkLCAweDllLCAweGUxLCAweGY4LCAweDk4LCAweDExLCAweDY5LCAweGQ5LCAweDhlLCAweDk0LCAweDliLCAweDFlLCAweDg3LCAweGU5LCAweGNlLCAweDU1LCAweDI4LCAweGRmLCAweDhjLCAweGExLCAweDg5LCAweDBkLCAweGJmLCAweGU2LCAweDQyLCAweDY4LCAweDQxLCAweDk5LCAweDJkLCAweDBmLCAweGIwLCAweDU0LCAweGJiLCAweDE2XSk7CiAgICB0aGlzLl9pbnZfcyA9IG5ldyBVaW50OEFycmF5KFsweDUyLCAweDA5LCAweDZhLCAweGQ1LCAweDMwLCAweDM2LCAweGE1LCAweDM4LCAweGJmLCAweDQwLCAweGEzLCAweDllLCAweDgxLCAweGYzLCAweGQ3LCAweGZiLCAweDdjLCAweGUzLCAweDM5LCAweDgyLCAweDliLCAweDJmLCAweGZmLCAweDg3LCAweDM0LCAweDhlLCAweDQzLCAweDQ0LCAweGM0LCAweGRlLCAweGU5LCAweGNiLCAweDU0LCAweDdiLCAweDk0LCAweDMyLCAweGE2LCAweGMyLCAweDIzLCAweDNkLCAweGVlLCAweDRjLCAweDk1LCAweDBiLCAweDQyLCAweGZhLCAweGMzLCAweDRlLCAweDA4LCAweDJlLCAweGExLCAweDY2LCAweDI4LCAweGQ5LCAweDI0LCAweGIyLCAweDc2LCAweDViLCAweGEyLCAweDQ5LCAweDZkLCAweDhiLCAweGQxLCAweDI1LCAweDcyLCAweGY4LCAweGY2LCAweDY0LCAweDg2LCAweDY4LCAweDk4LCAweDE2LCAweGQ0LCAweGE0LCAweDVjLCAweGNjLCAweDVkLCAweDY1LCAweGI2LCAweDkyLCAweDZjLCAweDcwLCAweDQ4LCAweDUwLCAweGZkLCAweGVkLCAweGI5LCAweGRhLCAweDVlLCAweDE1LCAweDQ2LCAweDU3LCAweGE3LCAweDhkLCAweDlkLCAweDg0LCAweDkwLCAweGQ4LCAweGFiLCAweDAwLCAweDhjLCAweGJjLCAweGQzLCAweDBhLCAweGY3LCAweGU0LCAweDU4LCAweDA1LCAweGI4LCAweGIzLCAweDQ1LCAweDA2LCAweGQwLCAweDJjLCAweDFlLCAweDhmLCAweGNhLCAweDNmLCAweDBmLCAweDAyLCAweGMxLCAweGFmLCAweGJkLCAweDAzLCAweDAxLCAweDEzLCAweDhhLCAweDZiLCAweDNhLCAweDkxLCAweDExLCAweDQxLCAweDRmLCAweDY3LCAweGRjLCAweGVhLCAweDk3LCAweGYyLCAweGNmLCAweGNlLCAweGYwLCAweGI0LCAweGU2LCAweDczLCAweDk2LCAweGFjLCAweDc0LCAweDIyLCAweGU3LCAweGFkLCAweDM1LCAweDg1LCAweGUyLCAweGY5LCAweDM3LCAweGU4LCAweDFjLCAweDc1LCAweGRmLCAweDZlLCAweDQ3LCAweGYxLCAweDFhLCAweDcxLCAweDFkLCAweDI5LCAweGM1LCAweDg5LCAweDZmLCAweGI3LCAweDYyLCAweDBlLCAweGFhLCAweDE4LCAweGJlLCAweDFiLCAweGZjLCAweDU2LCAweDNlLCAweDRiLCAweGM2LCAweGQyLCAweDc5LCAweDIwLCAweDlhLCAweGRiLCAweGMwLCAweGZlLCAweDc4LCAweGNkLCAweDVhLCAweGY0LCAweDFmLCAweGRkLCAweGE4LCAweDMzLCAweDg4LCAweDA3LCAweGM3LCAweDMxLCAweGIxLCAweDEyLCAweDEwLCAweDU5LCAweDI3LCAweDgwLCAweGVjLCAweDVmLCAweDYwLCAweDUxLCAweDdmLCAweGE5LCAweDE5LCAweGI1LCAweDRhLCAweDBkLCAweDJkLCAweGU1LCAweDdhLCAweDlmLCAweDkzLCAweGM5LCAweDljLCAweGVmLCAweGEwLCAweGUwLCAweDNiLCAweDRkLCAweGFlLCAweDJhLCAweGY1LCAweGIwLCAweGM4LCAweGViLCAweGJiLCAweDNjLCAweDgzLCAweDUzLCAweDk5LCAweDYxLCAweDE3LCAweDJiLCAweDA0LCAweDdlLCAweGJhLCAweDc3LCAweGQ2LCAweDI2LCAweGUxLCAweDY5LCAweDE0LCAweDYzLCAweDU1LCAweDIxLCAweDBjLCAweDdkXSk7CiAgICB0aGlzLl9taXggPSBuZXcgVWludDMyQXJyYXkoWzB4MDAwMDAwMDAsIDB4MGUwOTBkMGIsIDB4MWMxMjFhMTYsIDB4MTIxYjE3MWQsIDB4MzgyNDM0MmMsIDB4MzYyZDM5MjcsIDB4MjQzNjJlM2EsIDB4MmEzZjIzMzEsIDB4NzA0ODY4NTgsIDB4N2U0MTY1NTMsIDB4NmM1YTcyNGUsIDB4NjI1MzdmNDUsIDB4NDg2YzVjNzQsIDB4NDY2NTUxN2YsIDB4NTQ3ZTQ2NjIsIDB4NWE3NzRiNjksIDB4ZTA5MGQwYjAsIDB4ZWU5OWRkYmIsIDB4ZmM4MmNhYTYsIDB4ZjI4YmM3YWQsIDB4ZDhiNGU0OWMsIDB4ZDZiZGU5OTcsIDB4YzRhNmZlOGEsIDB4Y2FhZmYzODEsIDB4OTBkOGI4ZTgsIDB4OWVkMWI1ZTMsIDB4OGNjYWEyZmUsIDB4ODJjM2FmZjUsIDB4YThmYzhjYzQsIDB4YTZmNTgxY2YsIDB4YjRlZTk2ZDIsIDB4YmFlNzliZDksIDB4ZGIzYmJiN2IsIDB4ZDUzMmI2NzAsIDB4YzcyOWExNmQsIDB4YzkyMGFjNjYsIDB4ZTMxZjhmNTcsIDB4ZWQxNjgyNWMsIDB4ZmYwZDk1NDEsIDB4ZjEwNDk4NGEsIDB4YWI3M2QzMjMsIDB4YTU3YWRlMjgsIDB4Yjc2MWM5MzUsIDB4Yjk2OGM0M2UsIDB4OTM1N2U3MGYsIDB4OWQ1ZWVhMDQsIDB4OGY0NWZkMTksIDB4ODE0Y2YwMTIsIDB4M2JhYjZiY2IsIDB4MzVhMjY2YzAsIDB4MjdiOTcxZGQsIDB4MjliMDdjZDYsIDB4MDM4ZjVmZTcsIDB4MGQ4NjUyZWMsIDB4MWY5ZDQ1ZjEsIDB4MTE5NDQ4ZmEsIDB4NGJlMzAzOTMsIDB4NDVlYTBlOTgsIDB4NTdmMTE5ODUsIDB4NTlmODE0OGUsIDB4NzNjNzM3YmYsIDB4N2RjZTNhYjQsIDB4NmZkNTJkYTksIDB4NjFkYzIwYTIsIDB4YWQ3NjZkZjYsIDB4YTM3ZjYwZmQsIDB4YjE2NDc3ZTAsIDB4YmY2ZDdhZWIsIDB4OTU1MjU5ZGEsIDB4OWI1YjU0ZDEsIDB4ODk0MDQzY2MsIDB4ODc0OTRlYzcsIDB4ZGQzZTA1YWUsIDB4ZDMzNzA4YTUsIDB4YzEyYzFmYjgsIDB4Y2YyNTEyYjMsIDB4ZTUxYTMxODIsIDB4ZWIxMzNjODksIDB4ZjkwODJiOTQsIDB4ZjcwMTI2OWYsIDB4NGRlNmJkNDYsIDB4NDNlZmIwNGQsIDB4NTFmNGE3NTAsIDB4NWZmZGFhNWIsIDB4NzVjMjg5NmEsIDB4N2JjYjg0NjEsIDB4NjlkMDkzN2MsIDB4NjdkOTllNzcsIDB4M2RhZWQ1MWUsIDB4MzNhN2Q4MTUsIDB4MjFiY2NmMDgsIDB4MmZiNWMyMDMsIDB4MDU4YWUxMzIsIDB4MGI4M2VjMzksIDB4MTk5OGZiMjQsIDB4MTc5MWY2MmYsIDB4NzY0ZGQ2OGQsIDB4Nzg0NGRiODYsIDB4NmE1ZmNjOWIsIDB4NjQ1NmMxOTAsIDB4NGU2OWUyYTEsIDB4NDA2MGVmYWEsIDB4NTI3YmY4YjcsIDB4NWM3MmY1YmMsIDB4MDYwNWJlZDUsIDB4MDgwY2IzZGUsIDB4MWExN2E0YzMsIDB4MTQxZWE5YzgsIDB4M2UyMThhZjksIDB4MzAyODg3ZjIsIDB4MjIzMzkwZWYsIDB4MmMzYTlkZTQsIDB4OTZkZDA2M2QsIDB4OThkNDBiMzYsIDB4OGFjZjFjMmIsIDB4ODRjNjExMjAsIDB4YWVmOTMyMTEsIDB4YTBmMDNmMWEsIDB4YjJlYjI4MDcsIDB4YmNlMjI1MGMsIDB4ZTY5NTZlNjUsIDB4ZTg5YzYzNmUsIDB4ZmE4Nzc0NzMsIDB4ZjQ4ZTc5NzgsIDB4ZGViMTVhNDksIDB4ZDBiODU3NDIsIDB4YzJhMzQwNWYsIDB4Y2NhYTRkNTQsIDB4NDFlY2RhZjcsIDB4NGZlNWQ3ZmMsIDB4NWRmZWMwZTEsIDB4NTNmN2NkZWEsIDB4NzljOGVlZGIsIDB4NzdjMWUzZDAsIDB4NjVkYWY0Y2QsIDB4NmJkM2Y5YzYsIDB4MzFhNGIyYWYsIDB4M2ZhZGJmYTQsIDB4MmRiNmE4YjksIDB4MjNiZmE1YjIsIDB4MDk4MDg2ODMsIDB4MDc4OThiODgsIDB4MTU5MjljOTUsIDB4MWI5YjkxOWUsIDB4YTE3YzBhNDcsIDB4YWY3NTA3NGMsIDB4YmQ2ZTEwNTEsIDB4YjM2NzFkNWEsIDB4OTk1ODNlNmIsIDB4OTc1MTMzNjAsIDB4ODU0YTI0N2QsIDB4OGI0MzI5NzYsIDB4ZDEzNDYyMWYsIDB4ZGYzZDZmMTQsIDB4Y2QyNjc4MDksIDB4YzMyZjc1MDIsIDB4ZTkxMDU2MzMsIDB4ZTcxOTViMzgsIDB4ZjUwMjRjMjUsIDB4ZmIwYjQxMmUsIDB4OWFkNzYxOGMsIDB4OTRkZTZjODcsIDB4ODZjNTdiOWEsIDB4ODhjYzc2OTEsIDB4YTJmMzU1YTAsIDB4YWNmYTU4YWIsIDB4YmVlMTRmYjYsIDB4YjBlODQyYmQsIDB4ZWE5ZjA5ZDQsIDB4ZTQ5NjA0ZGYsIDB4ZjY4ZDEzYzIsIDB4Zjg4NDFlYzksIDB4ZDJiYjNkZjgsIDB4ZGNiMjMwZjMsIDB4Y2VhOTI3ZWUsIDB4YzBhMDJhZTUsIDB4N2E0N2IxM2MsIDB4NzQ0ZWJjMzcsIDB4NjY1NWFiMmEsIDB4Njg1Y2E2MjEsIDB4NDI2Mzg1MTAsIDB4NGM2YTg4MWIsIDB4NWU3MTlmMDYsIDB4NTA3ODkyMGQsIDB4MGEwZmQ5NjQsIDB4MDQwNmQ0NmYsIDB4MTYxZGMzNzIsIDB4MTgxNGNlNzksIDB4MzIyYmVkNDgsIDB4M2MyMmUwNDMsIDB4MmUzOWY3NWUsIDB4MjAzMGZhNTUsIDB4ZWM5YWI3MDEsIDB4ZTI5M2JhMGEsIDB4ZjA4OGFkMTcsIDB4ZmU4MWEwMWMsIDB4ZDRiZTgzMmQsIDB4ZGFiNzhlMjYsIDB4YzhhYzk5M2IsIDB4YzZhNTk0MzAsIDB4OWNkMmRmNTksIDB4OTJkYmQyNTIsIDB4ODBjMGM1NGYsIDB4OGVjOWM4NDQsIDB4YTRmNmViNzUsIDB4YWFmZmU2N2UsIDB4YjhlNGYxNjMsIDB4YjZlZGZjNjgsIDB4MGMwYTY3YjEsIDB4MDIwMzZhYmEsIDB4MTAxODdkYTcsIDB4MWUxMTcwYWMsIDB4MzQyZTUzOWQsIDB4M2EyNzVlOTYsIDB4MjgzYzQ5OGIsIDB4MjYzNTQ0ODAsIDB4N2M0MjBmZTksIDB4NzI0YjAyZTIsIDB4NjA1MDE1ZmYsIDB4NmU1OTE4ZjQsIDB4NDQ2NjNiYzUsIDB4NGE2ZjM2Y2UsIDB4NTg3NDIxZDMsIDB4NTY3ZDJjZDgsIDB4MzdhMTBjN2EsIDB4MzlhODAxNzEsIDB4MmJiMzE2NmMsIDB4MjViYTFiNjcsIDB4MGY4NTM4NTYsIDB4MDE4YzM1NWQsIDB4MTM5NzIyNDAsIDB4MWQ5ZTJmNGIsIDB4NDdlOTY0MjIsIDB4NDllMDY5MjksIDB4NWJmYjdlMzQsIDB4NTVmMjczM2YsIDB4N2ZjZDUwMGUsIDB4NzFjNDVkMDUsIDB4NjNkZjRhMTgsIDB4NmRkNjQ3MTMsIDB4ZDczMWRjY2EsIDB4ZDkzOGQxYzEsIDB4Y2IyM2M2ZGMsIDB4YzUyYWNiZDcsIDB4ZWYxNWU4ZTYsIDB4ZTExY2U1ZWQsIDB4ZjMwN2YyZjAsIDB4ZmQwZWZmZmIsIDB4YTc3OWI0OTIsIDB4YTk3MGI5OTksIDB4YmI2YmFlODQsIDB4YjU2MmEzOGYsIDB4OWY1ZDgwYmUsIDB4OTE1NDhkYjUsIDB4ODM0ZjlhYTgsIDB4OGQ0Njk3YTNdKTsKICAgIHRoaXMuX21peENvbCA9IG5ldyBVaW50OEFycmF5KDI1Nik7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7IGkrKykgewogICAgICBpZiAoaSA8IDEyOCkgewogICAgICAgIHRoaXMuX21peENvbFtpXSA9IGkgPDwgMTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLl9taXhDb2xbaV0gPSBpIDw8IDEgXiAweDFiOwogICAgICB9CiAgICB9CgogICAgdGhpcy5idWZmZXIgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICB0aGlzLmJ1ZmZlclBvc2l0aW9uID0gMDsKICB9CgogIF9leHBhbmRLZXkoY2lwaGVyS2V5KSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgY2FsbCBgX2V4cGFuZEtleWAgb24gdGhlIGJhc2UgY2xhc3MiKTsKICB9CgogIF9kZWNyeXB0KGlucHV0LCBrZXkpIHsKICAgIGxldCB0LCB1LCB2OwogICAgY29uc3Qgc3RhdGUgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICBzdGF0ZS5zZXQoaW5wdXQpOwoKICAgIGZvciAobGV0IGogPSAwLCBrID0gdGhpcy5fa2V5U2l6ZTsgaiA8IDE2OyArK2osICsraykgewogICAgICBzdGF0ZVtqXSBePSBrZXlba107CiAgICB9CgogICAgZm9yIChsZXQgaSA9IHRoaXMuX2N5Y2xlc09mUmVwZXRpdGlvbiAtIDE7IGkgPj0gMTsgLS1pKSB7CiAgICAgIHQgPSBzdGF0ZVsxM107CiAgICAgIHN0YXRlWzEzXSA9IHN0YXRlWzldOwogICAgICBzdGF0ZVs5XSA9IHN0YXRlWzVdOwogICAgICBzdGF0ZVs1XSA9IHN0YXRlWzFdOwogICAgICBzdGF0ZVsxXSA9IHQ7CiAgICAgIHQgPSBzdGF0ZVsxNF07CiAgICAgIHUgPSBzdGF0ZVsxMF07CiAgICAgIHN0YXRlWzE0XSA9IHN0YXRlWzZdOwogICAgICBzdGF0ZVsxMF0gPSBzdGF0ZVsyXTsKICAgICAgc3RhdGVbNl0gPSB0OwogICAgICBzdGF0ZVsyXSA9IHU7CiAgICAgIHQgPSBzdGF0ZVsxNV07CiAgICAgIHUgPSBzdGF0ZVsxMV07CiAgICAgIHYgPSBzdGF0ZVs3XTsKICAgICAgc3RhdGVbMTVdID0gc3RhdGVbM107CiAgICAgIHN0YXRlWzExXSA9IHQ7CiAgICAgIHN0YXRlWzddID0gdTsKICAgICAgc3RhdGVbM10gPSB2OwoKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxNjsgKytqKSB7CiAgICAgICAgc3RhdGVbal0gPSB0aGlzLl9pbnZfc1tzdGF0ZVtqXV07CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGogPSAwLCBrID0gaSAqIDE2OyBqIDwgMTY7ICsraiwgKytrKSB7CiAgICAgICAgc3RhdGVbal0gXj0ga2V5W2tdOwogICAgICB9CgogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyBqICs9IDQpIHsKICAgICAgICBjb25zdCBzMCA9IHRoaXMuX21peFtzdGF0ZVtqXV07CiAgICAgICAgY29uc3QgczEgPSB0aGlzLl9taXhbc3RhdGVbaiArIDFdXTsKICAgICAgICBjb25zdCBzMiA9IHRoaXMuX21peFtzdGF0ZVtqICsgMl1dOwogICAgICAgIGNvbnN0IHMzID0gdGhpcy5fbWl4W3N0YXRlW2ogKyAzXV07CiAgICAgICAgdCA9IHMwIF4gczEgPj4+IDggXiBzMSA8PCAyNCBeIHMyID4+PiAxNiBeIHMyIDw8IDE2IF4gczMgPj4+IDI0IF4gczMgPDwgODsKICAgICAgICBzdGF0ZVtqXSA9IHQgPj4+IDI0ICYgMHhmZjsKICAgICAgICBzdGF0ZVtqICsgMV0gPSB0ID4+IDE2ICYgMHhmZjsKICAgICAgICBzdGF0ZVtqICsgMl0gPSB0ID4+IDggJiAweGZmOwogICAgICAgIHN0YXRlW2ogKyAzXSA9IHQgJiAweGZmOwogICAgICB9CiAgICB9CgogICAgdCA9IHN0YXRlWzEzXTsKICAgIHN0YXRlWzEzXSA9IHN0YXRlWzldOwogICAgc3RhdGVbOV0gPSBzdGF0ZVs1XTsKICAgIHN0YXRlWzVdID0gc3RhdGVbMV07CiAgICBzdGF0ZVsxXSA9IHQ7CiAgICB0ID0gc3RhdGVbMTRdOwogICAgdSA9IHN0YXRlWzEwXTsKICAgIHN0YXRlWzE0XSA9IHN0YXRlWzZdOwogICAgc3RhdGVbMTBdID0gc3RhdGVbMl07CiAgICBzdGF0ZVs2XSA9IHQ7CiAgICBzdGF0ZVsyXSA9IHU7CiAgICB0ID0gc3RhdGVbMTVdOwogICAgdSA9IHN0YXRlWzExXTsKICAgIHYgPSBzdGF0ZVs3XTsKICAgIHN0YXRlWzE1XSA9IHN0YXRlWzNdOwogICAgc3RhdGVbMTFdID0gdDsKICAgIHN0YXRlWzddID0gdTsKICAgIHN0YXRlWzNdID0gdjsKCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgc3RhdGVbal0gPSB0aGlzLl9pbnZfc1tzdGF0ZVtqXV07CiAgICAgIHN0YXRlW2pdIF49IGtleVtqXTsKICAgIH0KCiAgICByZXR1cm4gc3RhdGU7CiAgfQoKICBfZW5jcnlwdChpbnB1dCwga2V5KSB7CiAgICBjb25zdCBzID0gdGhpcy5fczsKICAgIGxldCB0LCB1LCB2OwogICAgY29uc3Qgc3RhdGUgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICBzdGF0ZS5zZXQoaW5wdXQpOwoKICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTY7ICsraikgewogICAgICBzdGF0ZVtqXSBePSBrZXlbal07CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDE7IGkgPCB0aGlzLl9jeWNsZXNPZlJlcGV0aXRpb247IGkrKykgewogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgICBzdGF0ZVtqXSA9IHNbc3RhdGVbal1dOwogICAgICB9CgogICAgICB2ID0gc3RhdGVbMV07CiAgICAgIHN0YXRlWzFdID0gc3RhdGVbNV07CiAgICAgIHN0YXRlWzVdID0gc3RhdGVbOV07CiAgICAgIHN0YXRlWzldID0gc3RhdGVbMTNdOwogICAgICBzdGF0ZVsxM10gPSB2OwogICAgICB2ID0gc3RhdGVbMl07CiAgICAgIHUgPSBzdGF0ZVs2XTsKICAgICAgc3RhdGVbMl0gPSBzdGF0ZVsxMF07CiAgICAgIHN0YXRlWzZdID0gc3RhdGVbMTRdOwogICAgICBzdGF0ZVsxMF0gPSB2OwogICAgICBzdGF0ZVsxNF0gPSB1OwogICAgICB2ID0gc3RhdGVbM107CiAgICAgIHUgPSBzdGF0ZVs3XTsKICAgICAgdCA9IHN0YXRlWzExXTsKICAgICAgc3RhdGVbM10gPSBzdGF0ZVsxNV07CiAgICAgIHN0YXRlWzddID0gdjsKICAgICAgc3RhdGVbMTFdID0gdTsKICAgICAgc3RhdGVbMTVdID0gdDsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTY7IGogKz0gNCkgewogICAgICAgIGNvbnN0IHMwID0gc3RhdGVbaiArIDBdOwogICAgICAgIGNvbnN0IHMxID0gc3RhdGVbaiArIDFdOwogICAgICAgIGNvbnN0IHMyID0gc3RhdGVbaiArIDJdOwogICAgICAgIGNvbnN0IHMzID0gc3RhdGVbaiArIDNdOwogICAgICAgIHQgPSBzMCBeIHMxIF4gczIgXiBzMzsKICAgICAgICBzdGF0ZVtqICsgMF0gXj0gdCBeIHRoaXMuX21peENvbFtzMCBeIHMxXTsKICAgICAgICBzdGF0ZVtqICsgMV0gXj0gdCBeIHRoaXMuX21peENvbFtzMSBeIHMyXTsKICAgICAgICBzdGF0ZVtqICsgMl0gXj0gdCBeIHRoaXMuX21peENvbFtzMiBeIHMzXTsKICAgICAgICBzdGF0ZVtqICsgM10gXj0gdCBeIHRoaXMuX21peENvbFtzMyBeIHMwXTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IDAsIGsgPSBpICogMTY7IGogPCAxNjsgKytqLCArK2spIHsKICAgICAgICBzdGF0ZVtqXSBePSBrZXlba107CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgc3RhdGVbal0gPSBzW3N0YXRlW2pdXTsKICAgIH0KCiAgICB2ID0gc3RhdGVbMV07CiAgICBzdGF0ZVsxXSA9IHN0YXRlWzVdOwogICAgc3RhdGVbNV0gPSBzdGF0ZVs5XTsKICAgIHN0YXRlWzldID0gc3RhdGVbMTNdOwogICAgc3RhdGVbMTNdID0gdjsKICAgIHYgPSBzdGF0ZVsyXTsKICAgIHUgPSBzdGF0ZVs2XTsKICAgIHN0YXRlWzJdID0gc3RhdGVbMTBdOwogICAgc3RhdGVbNl0gPSBzdGF0ZVsxNF07CiAgICBzdGF0ZVsxMF0gPSB2OwogICAgc3RhdGVbMTRdID0gdTsKICAgIHYgPSBzdGF0ZVszXTsKICAgIHUgPSBzdGF0ZVs3XTsKICAgIHQgPSBzdGF0ZVsxMV07CiAgICBzdGF0ZVszXSA9IHN0YXRlWzE1XTsKICAgIHN0YXRlWzddID0gdjsKICAgIHN0YXRlWzExXSA9IHU7CiAgICBzdGF0ZVsxNV0gPSB0OwoKICAgIGZvciAobGV0IGogPSAwLCBrID0gdGhpcy5fa2V5U2l6ZTsgaiA8IDE2OyArK2osICsraykgewogICAgICBzdGF0ZVtqXSBePSBrZXlba107CiAgICB9CgogICAgcmV0dXJuIHN0YXRlOwogIH0KCiAgX2RlY3J5cHRCbG9jazIoZGF0YSwgZmluYWxpemUpIHsKICAgIGNvbnN0IHNvdXJjZUxlbmd0aCA9IGRhdGEubGVuZ3RoOwogICAgbGV0IGJ1ZmZlciA9IHRoaXMuYnVmZmVyLAogICAgICAgIGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyUG9zaXRpb247CiAgICBjb25zdCByZXN1bHQgPSBbXTsKICAgIGxldCBpdiA9IHRoaXMuaXY7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzb3VyY2VMZW5ndGg7ICsraSkgewogICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoXSA9IGRhdGFbaV07CiAgICAgICsrYnVmZmVyTGVuZ3RoOwoKICAgICAgaWYgKGJ1ZmZlckxlbmd0aCA8IDE2KSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHBsYWluID0gdGhpcy5fZGVjcnlwdChidWZmZXIsIHRoaXMuX2tleSk7CgogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgICBwbGFpbltqXSBePSBpdltqXTsKICAgICAgfQoKICAgICAgaXYgPSBidWZmZXI7CiAgICAgIHJlc3VsdC5wdXNoKHBsYWluKTsKICAgICAgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMTYpOwogICAgICBidWZmZXJMZW5ndGggPSAwOwogICAgfQoKICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyOwogICAgdGhpcy5idWZmZXJMZW5ndGggPSBidWZmZXJMZW5ndGg7CiAgICB0aGlzLml2ID0gaXY7CgogICAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApOwogICAgfQoKICAgIGxldCBvdXRwdXRMZW5ndGggPSAxNiAqIHJlc3VsdC5sZW5ndGg7CgogICAgaWYgKGZpbmFsaXplKSB7CiAgICAgIGNvbnN0IGxhc3RCbG9jayA9IHJlc3VsdC5hdCgtMSk7CiAgICAgIGxldCBwc0xlbiA9IGxhc3RCbG9ja1sxNV07CgogICAgICBpZiAocHNMZW4gPD0gMTYpIHsKICAgICAgICBmb3IgKGxldCBpID0gMTUsIGlpID0gMTYgLSBwc0xlbjsgaSA+PSBpaTsgLS1pKSB7CiAgICAgICAgICBpZiAobGFzdEJsb2NrW2ldICE9PSBwc0xlbikgewogICAgICAgICAgICBwc0xlbiA9IDA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgb3V0cHV0TGVuZ3RoIC09IHBzTGVuOwogICAgICAgIHJlc3VsdFtyZXN1bHQubGVuZ3RoIC0gMV0gPSBsYXN0QmxvY2suc3ViYXJyYXkoMCwgMTYgLSBwc0xlbik7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBvdXRwdXQgPSBuZXcgVWludDhBcnJheShvdXRwdXRMZW5ndGgpOwoKICAgIGZvciAobGV0IGkgPSAwLCBqID0gMCwgaWkgPSByZXN1bHQubGVuZ3RoOyBpIDwgaWk7ICsraSwgaiArPSAxNikgewogICAgICBvdXRwdXQuc2V0KHJlc3VsdFtpXSwgaik7CiAgICB9CgogICAgcmV0dXJuIG91dHB1dDsKICB9CgogIGRlY3J5cHRCbG9jayhkYXRhLCBmaW5hbGl6ZSkgewogICAgbGV0IGl2ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBudWxsOwogICAgY29uc3Qgc291cmNlTGVuZ3RoID0gZGF0YS5sZW5ndGg7CiAgICBjb25zdCBidWZmZXIgPSB0aGlzLmJ1ZmZlcjsKICAgIGxldCBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlclBvc2l0aW9uOwoKICAgIGlmIChpdikgewogICAgICB0aGlzLml2ID0gaXY7CiAgICB9IGVsc2UgewogICAgICBmb3IgKGxldCBpID0gMDsgYnVmZmVyTGVuZ3RoIDwgMTYgJiYgaSA8IHNvdXJjZUxlbmd0aDsgKytpLCArK2J1ZmZlckxlbmd0aCkgewogICAgICAgIGJ1ZmZlcltidWZmZXJMZW5ndGhdID0gZGF0YVtpXTsKICAgICAgfQoKICAgICAgaWYgKGJ1ZmZlckxlbmd0aCA8IDE2KSB7CiAgICAgICAgdGhpcy5idWZmZXJMZW5ndGggPSBidWZmZXJMZW5ndGg7CiAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApOwogICAgICB9CgogICAgICB0aGlzLml2ID0gYnVmZmVyOwogICAgICBkYXRhID0gZGF0YS5zdWJhcnJheSgxNik7CiAgICB9CgogICAgdGhpcy5idWZmZXIgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IDA7CiAgICB0aGlzLmRlY3J5cHRCbG9jayA9IHRoaXMuX2RlY3J5cHRCbG9jazI7CiAgICByZXR1cm4gdGhpcy5kZWNyeXB0QmxvY2soZGF0YSwgZmluYWxpemUpOwogIH0KCiAgZW5jcnlwdChkYXRhLCBpdikgewogICAgY29uc3Qgc291cmNlTGVuZ3RoID0gZGF0YS5sZW5ndGg7CiAgICBsZXQgYnVmZmVyID0gdGhpcy5idWZmZXIsCiAgICAgICAgYnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXJQb3NpdGlvbjsKICAgIGNvbnN0IHJlc3VsdCA9IFtdOwoKICAgIGlmICghaXYpIHsKICAgICAgaXYgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzb3VyY2VMZW5ndGg7ICsraSkgewogICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoXSA9IGRhdGFbaV07CiAgICAgICsrYnVmZmVyTGVuZ3RoOwoKICAgICAgaWYgKGJ1ZmZlckxlbmd0aCA8IDE2KSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTY7ICsraikgewogICAgICAgIGJ1ZmZlcltqXSBePSBpdltqXTsKICAgICAgfQoKICAgICAgY29uc3QgY2lwaGVyID0gdGhpcy5fZW5jcnlwdChidWZmZXIsIHRoaXMuX2tleSk7CgogICAgICBpdiA9IGNpcGhlcjsKICAgICAgcmVzdWx0LnB1c2goY2lwaGVyKTsKICAgICAgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMTYpOwogICAgICBidWZmZXJMZW5ndGggPSAwOwogICAgfQoKICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyOwogICAgdGhpcy5idWZmZXJMZW5ndGggPSBidWZmZXJMZW5ndGg7CiAgICB0aGlzLml2ID0gaXY7CgogICAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApOwogICAgfQoKICAgIGNvbnN0IG91dHB1dExlbmd0aCA9IDE2ICogcmVzdWx0Lmxlbmd0aDsKICAgIGNvbnN0IG91dHB1dCA9IG5ldyBVaW50OEFycmF5KG91dHB1dExlbmd0aCk7CgogICAgZm9yIChsZXQgaSA9IDAsIGogPSAwLCBpaSA9IHJlc3VsdC5sZW5ndGg7IGkgPCBpaTsgKytpLCBqICs9IDE2KSB7CiAgICAgIG91dHB1dC5zZXQocmVzdWx0W2ldLCBqKTsKICAgIH0KCiAgICByZXR1cm4gb3V0cHV0OwogIH0KCn0KCmNsYXNzIEFFUzEyOENpcGhlciBleHRlbmRzIEFFU0Jhc2VDaXBoZXIgewogIGNvbnN0cnVjdG9yKGtleSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMuX2N5Y2xlc09mUmVwZXRpdGlvbiA9IDEwOwogICAgdGhpcy5fa2V5U2l6ZSA9IDE2MDsKICAgIHRoaXMuX3Jjb24gPSBuZXcgVWludDhBcnJheShbMHg4ZCwgMHgwMSwgMHgwMiwgMHgwNCwgMHgwOCwgMHgxMCwgMHgyMCwgMHg0MCwgMHg4MCwgMHgxYiwgMHgzNiwgMHg2YywgMHhkOCwgMHhhYiwgMHg0ZCwgMHg5YSwgMHgyZiwgMHg1ZSwgMHhiYywgMHg2MywgMHhjNiwgMHg5NywgMHgzNSwgMHg2YSwgMHhkNCwgMHhiMywgMHg3ZCwgMHhmYSwgMHhlZiwgMHhjNSwgMHg5MSwgMHgzOSwgMHg3MiwgMHhlNCwgMHhkMywgMHhiZCwgMHg2MSwgMHhjMiwgMHg5ZiwgMHgyNSwgMHg0YSwgMHg5NCwgMHgzMywgMHg2NiwgMHhjYywgMHg4MywgMHgxZCwgMHgzYSwgMHg3NCwgMHhlOCwgMHhjYiwgMHg4ZCwgMHgwMSwgMHgwMiwgMHgwNCwgMHgwOCwgMHgxMCwgMHgyMCwgMHg0MCwgMHg4MCwgMHgxYiwgMHgzNiwgMHg2YywgMHhkOCwgMHhhYiwgMHg0ZCwgMHg5YSwgMHgyZiwgMHg1ZSwgMHhiYywgMHg2MywgMHhjNiwgMHg5NywgMHgzNSwgMHg2YSwgMHhkNCwgMHhiMywgMHg3ZCwgMHhmYSwgMHhlZiwgMHhjNSwgMHg5MSwgMHgzOSwgMHg3MiwgMHhlNCwgMHhkMywgMHhiZCwgMHg2MSwgMHhjMiwgMHg5ZiwgMHgyNSwgMHg0YSwgMHg5NCwgMHgzMywgMHg2NiwgMHhjYywgMHg4MywgMHgxZCwgMHgzYSwgMHg3NCwgMHhlOCwgMHhjYiwgMHg4ZCwgMHgwMSwgMHgwMiwgMHgwNCwgMHgwOCwgMHgxMCwgMHgyMCwgMHg0MCwgMHg4MCwgMHgxYiwgMHgzNiwgMHg2YywgMHhkOCwgMHhhYiwgMHg0ZCwgMHg5YSwgMHgyZiwgMHg1ZSwgMHhiYywgMHg2MywgMHhjNiwgMHg5NywgMHgzNSwgMHg2YSwgMHhkNCwgMHhiMywgMHg3ZCwgMHhmYSwgMHhlZiwgMHhjNSwgMHg5MSwgMHgzOSwgMHg3MiwgMHhlNCwgMHhkMywgMHhiZCwgMHg2MSwgMHhjMiwgMHg5ZiwgMHgyNSwgMHg0YSwgMHg5NCwgMHgzMywgMHg2NiwgMHhjYywgMHg4MywgMHgxZCwgMHgzYSwgMHg3NCwgMHhlOCwgMHhjYiwgMHg4ZCwgMHgwMSwgMHgwMiwgMHgwNCwgMHgwOCwgMHgxMCwgMHgyMCwgMHg0MCwgMHg4MCwgMHgxYiwgMHgzNiwgMHg2YywgMHhkOCwgMHhhYiwgMHg0ZCwgMHg5YSwgMHgyZiwgMHg1ZSwgMHhiYywgMHg2MywgMHhjNiwgMHg5NywgMHgzNSwgMHg2YSwgMHhkNCwgMHhiMywgMHg3ZCwgMHhmYSwgMHhlZiwgMHhjNSwgMHg5MSwgMHgzOSwgMHg3MiwgMHhlNCwgMHhkMywgMHhiZCwgMHg2MSwgMHhjMiwgMHg5ZiwgMHgyNSwgMHg0YSwgMHg5NCwgMHgzMywgMHg2NiwgMHhjYywgMHg4MywgMHgxZCwgMHgzYSwgMHg3NCwgMHhlOCwgMHhjYiwgMHg4ZCwgMHgwMSwgMHgwMiwgMHgwNCwgMHgwOCwgMHgxMCwgMHgyMCwgMHg0MCwgMHg4MCwgMHgxYiwgMHgzNiwgMHg2YywgMHhkOCwgMHhhYiwgMHg0ZCwgMHg5YSwgMHgyZiwgMHg1ZSwgMHhiYywgMHg2MywgMHhjNiwgMHg5NywgMHgzNSwgMHg2YSwgMHhkNCwgMHhiMywgMHg3ZCwgMHhmYSwgMHhlZiwgMHhjNSwgMHg5MSwgMHgzOSwgMHg3MiwgMHhlNCwgMHhkMywgMHhiZCwgMHg2MSwgMHhjMiwgMHg5ZiwgMHgyNSwgMHg0YSwgMHg5NCwgMHgzMywgMHg2NiwgMHhjYywgMHg4MywgMHgxZCwgMHgzYSwgMHg3NCwgMHhlOCwgMHhjYiwgMHg4ZF0pOwogICAgdGhpcy5fa2V5ID0gdGhpcy5fZXhwYW5kS2V5KGtleSk7CiAgfQoKICBfZXhwYW5kS2V5KGNpcGhlcktleSkgewogICAgY29uc3QgYiA9IDE3NjsKICAgIGNvbnN0IHMgPSB0aGlzLl9zOwogICAgY29uc3QgcmNvbiA9IHRoaXMuX3Jjb247CiAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDhBcnJheShiKTsKICAgIHJlc3VsdC5zZXQoY2lwaGVyS2V5KTsKCiAgICBmb3IgKGxldCBqID0gMTYsIGkgPSAxOyBqIDwgYjsgKytpKSB7CiAgICAgIGxldCB0MSA9IHJlc3VsdFtqIC0gM107CiAgICAgIGxldCB0MiA9IHJlc3VsdFtqIC0gMl07CiAgICAgIGxldCB0MyA9IHJlc3VsdFtqIC0gMV07CiAgICAgIGxldCB0NCA9IHJlc3VsdFtqIC0gNF07CiAgICAgIHQxID0gc1t0MV07CiAgICAgIHQyID0gc1t0Ml07CiAgICAgIHQzID0gc1t0M107CiAgICAgIHQ0ID0gc1t0NF07CiAgICAgIHQxIF49IHJjb25baV07CgogICAgICBmb3IgKGxldCBuID0gMDsgbiA8IDQ7ICsrbikgewogICAgICAgIHJlc3VsdFtqXSA9IHQxIF49IHJlc3VsdFtqIC0gMTZdOwogICAgICAgIGorKzsKICAgICAgICByZXN1bHRbal0gPSB0MiBePSByZXN1bHRbaiAtIDE2XTsKICAgICAgICBqKys7CiAgICAgICAgcmVzdWx0W2pdID0gdDMgXj0gcmVzdWx0W2ogLSAxNl07CiAgICAgICAgaisrOwogICAgICAgIHJlc3VsdFtqXSA9IHQ0IF49IHJlc3VsdFtqIC0gMTZdOwogICAgICAgIGorKzsKICAgICAgfQogICAgfQoKICAgIHJldHVybiByZXN1bHQ7CiAgfQoKfQoKZXhwb3J0cy5BRVMxMjhDaXBoZXIgPSBBRVMxMjhDaXBoZXI7CgpjbGFzcyBBRVMyNTZDaXBoZXIgZXh0ZW5kcyBBRVNCYXNlQ2lwaGVyIHsKICBjb25zdHJ1Y3RvcihrZXkpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLl9jeWNsZXNPZlJlcGV0aXRpb24gPSAxNDsKICAgIHRoaXMuX2tleVNpemUgPSAyMjQ7CiAgICB0aGlzLl9rZXkgPSB0aGlzLl9leHBhbmRLZXkoa2V5KTsKICB9CgogIF9leHBhbmRLZXkoY2lwaGVyS2V5KSB7CiAgICBjb25zdCBiID0gMjQwOwogICAgY29uc3QgcyA9IHRoaXMuX3M7CiAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDhBcnJheShiKTsKICAgIHJlc3VsdC5zZXQoY2lwaGVyS2V5KTsKICAgIGxldCByID0gMTsKICAgIGxldCB0MSwgdDIsIHQzLCB0NDsKCiAgICBmb3IgKGxldCBqID0gMzIsIGkgPSAxOyBqIDwgYjsgKytpKSB7CiAgICAgIGlmIChqICUgMzIgPT09IDE2KSB7CiAgICAgICAgdDEgPSBzW3QxXTsKICAgICAgICB0MiA9IHNbdDJdOwogICAgICAgIHQzID0gc1t0M107CiAgICAgICAgdDQgPSBzW3Q0XTsKICAgICAgfSBlbHNlIGlmIChqICUgMzIgPT09IDApIHsKICAgICAgICB0MSA9IHJlc3VsdFtqIC0gM107CiAgICAgICAgdDIgPSByZXN1bHRbaiAtIDJdOwogICAgICAgIHQzID0gcmVzdWx0W2ogLSAxXTsKICAgICAgICB0NCA9IHJlc3VsdFtqIC0gNF07CiAgICAgICAgdDEgPSBzW3QxXTsKICAgICAgICB0MiA9IHNbdDJdOwogICAgICAgIHQzID0gc1t0M107CiAgICAgICAgdDQgPSBzW3Q0XTsKICAgICAgICB0MSBePSByOwoKICAgICAgICBpZiAoKHIgPDw9IDEpID49IDI1NikgewogICAgICAgICAgciA9IChyIF4gMHgxYikgJiAweGZmOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCA0OyArK24pIHsKICAgICAgICByZXN1bHRbal0gPSB0MSBePSByZXN1bHRbaiAtIDMyXTsKICAgICAgICBqKys7CiAgICAgICAgcmVzdWx0W2pdID0gdDIgXj0gcmVzdWx0W2ogLSAzMl07CiAgICAgICAgaisrOwogICAgICAgIHJlc3VsdFtqXSA9IHQzIF49IHJlc3VsdFtqIC0gMzJdOwogICAgICAgIGorKzsKICAgICAgICByZXN1bHRbal0gPSB0NCBePSByZXN1bHRbaiAtIDMyXTsKICAgICAgICBqKys7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcmVzdWx0OwogIH0KCn0KCmV4cG9ydHMuQUVTMjU2Q2lwaGVyID0gQUVTMjU2Q2lwaGVyOwoKY2xhc3MgUERGMTcgewogIGNoZWNrT3duZXJQYXNzd29yZChwYXNzd29yZCwgb3duZXJWYWxpZGF0aW9uU2FsdCwgdXNlckJ5dGVzLCBvd25lclBhc3N3b3JkKSB7CiAgICBjb25zdCBoYXNoRGF0YSA9IG5ldyBVaW50OEFycmF5KHBhc3N3b3JkLmxlbmd0aCArIDU2KTsKICAgIGhhc2hEYXRhLnNldChwYXNzd29yZCwgMCk7CiAgICBoYXNoRGF0YS5zZXQob3duZXJWYWxpZGF0aW9uU2FsdCwgcGFzc3dvcmQubGVuZ3RoKTsKICAgIGhhc2hEYXRhLnNldCh1c2VyQnl0ZXMsIHBhc3N3b3JkLmxlbmd0aCArIG93bmVyVmFsaWRhdGlvblNhbHQubGVuZ3RoKTsKICAgIGNvbnN0IHJlc3VsdCA9IGNhbGN1bGF0ZVNIQTI1NihoYXNoRGF0YSwgMCwgaGFzaERhdGEubGVuZ3RoKTsKICAgIHJldHVybiAoMCwgX3V0aWwuaXNBcnJheUVxdWFsKShyZXN1bHQsIG93bmVyUGFzc3dvcmQpOwogIH0KCiAgY2hlY2tVc2VyUGFzc3dvcmQocGFzc3dvcmQsIHVzZXJWYWxpZGF0aW9uU2FsdCwgdXNlclBhc3N3b3JkKSB7CiAgICBjb25zdCBoYXNoRGF0YSA9IG5ldyBVaW50OEFycmF5KHBhc3N3b3JkLmxlbmd0aCArIDgpOwogICAgaGFzaERhdGEuc2V0KHBhc3N3b3JkLCAwKTsKICAgIGhhc2hEYXRhLnNldCh1c2VyVmFsaWRhdGlvblNhbHQsIHBhc3N3b3JkLmxlbmd0aCk7CiAgICBjb25zdCByZXN1bHQgPSBjYWxjdWxhdGVTSEEyNTYoaGFzaERhdGEsIDAsIGhhc2hEYXRhLmxlbmd0aCk7CiAgICByZXR1cm4gKDAsIF91dGlsLmlzQXJyYXlFcXVhbCkocmVzdWx0LCB1c2VyUGFzc3dvcmQpOwogIH0KCiAgZ2V0T3duZXJLZXkocGFzc3dvcmQsIG93bmVyS2V5U2FsdCwgdXNlckJ5dGVzLCBvd25lckVuY3J5cHRpb24pIHsKICAgIGNvbnN0IGhhc2hEYXRhID0gbmV3IFVpbnQ4QXJyYXkocGFzc3dvcmQubGVuZ3RoICsgNTYpOwogICAgaGFzaERhdGEuc2V0KHBhc3N3b3JkLCAwKTsKICAgIGhhc2hEYXRhLnNldChvd25lcktleVNhbHQsIHBhc3N3b3JkLmxlbmd0aCk7CiAgICBoYXNoRGF0YS5zZXQodXNlckJ5dGVzLCBwYXNzd29yZC5sZW5ndGggKyBvd25lcktleVNhbHQubGVuZ3RoKTsKICAgIGNvbnN0IGtleSA9IGNhbGN1bGF0ZVNIQTI1NihoYXNoRGF0YSwgMCwgaGFzaERhdGEubGVuZ3RoKTsKICAgIGNvbnN0IGNpcGhlciA9IG5ldyBBRVMyNTZDaXBoZXIoa2V5KTsKICAgIHJldHVybiBjaXBoZXIuZGVjcnlwdEJsb2NrKG93bmVyRW5jcnlwdGlvbiwgZmFsc2UsIG5ldyBVaW50OEFycmF5KDE2KSk7CiAgfQoKICBnZXRVc2VyS2V5KHBhc3N3b3JkLCB1c2VyS2V5U2FsdCwgdXNlckVuY3J5cHRpb24pIHsKICAgIGNvbnN0IGhhc2hEYXRhID0gbmV3IFVpbnQ4QXJyYXkocGFzc3dvcmQubGVuZ3RoICsgOCk7CiAgICBoYXNoRGF0YS5zZXQocGFzc3dvcmQsIDApOwogICAgaGFzaERhdGEuc2V0KHVzZXJLZXlTYWx0LCBwYXNzd29yZC5sZW5ndGgpOwogICAgY29uc3Qga2V5ID0gY2FsY3VsYXRlU0hBMjU2KGhhc2hEYXRhLCAwLCBoYXNoRGF0YS5sZW5ndGgpOwogICAgY29uc3QgY2lwaGVyID0gbmV3IEFFUzI1NkNpcGhlcihrZXkpOwogICAgcmV0dXJuIGNpcGhlci5kZWNyeXB0QmxvY2sodXNlckVuY3J5cHRpb24sIGZhbHNlLCBuZXcgVWludDhBcnJheSgxNikpOwogIH0KCn0KCmV4cG9ydHMuUERGMTcgPSBQREYxNzsKCmNvbnN0IFBERjIwID0gZnVuY3Rpb24gUERGMjBDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGNhbGN1bGF0ZVBERjIwSGFzaChwYXNzd29yZCwgaW5wdXQsIHVzZXJCeXRlcykgewogICAgbGV0IGsgPSBjYWxjdWxhdGVTSEEyNTYoaW5wdXQsIDAsIGlucHV0Lmxlbmd0aCkuc3ViYXJyYXkoMCwgMzIpOwogICAgbGV0IGUgPSBbMF07CiAgICBsZXQgaSA9IDA7CgogICAgd2hpbGUgKGkgPCA2NCB8fCBlLmF0KC0xKSA+IGkgLSAzMikgewogICAgICBjb25zdCBjb21iaW5lZExlbmd0aCA9IHBhc3N3b3JkLmxlbmd0aCArIGsubGVuZ3RoICsgdXNlckJ5dGVzLmxlbmd0aCwKICAgICAgICAgICAgY29tYmluZWRBcnJheSA9IG5ldyBVaW50OEFycmF5KGNvbWJpbmVkTGVuZ3RoKTsKICAgICAgbGV0IHdyaXRlT2Zmc2V0ID0gMDsKICAgICAgY29tYmluZWRBcnJheS5zZXQocGFzc3dvcmQsIHdyaXRlT2Zmc2V0KTsKICAgICAgd3JpdGVPZmZzZXQgKz0gcGFzc3dvcmQubGVuZ3RoOwogICAgICBjb21iaW5lZEFycmF5LnNldChrLCB3cml0ZU9mZnNldCk7CiAgICAgIHdyaXRlT2Zmc2V0ICs9IGsubGVuZ3RoOwogICAgICBjb21iaW5lZEFycmF5LnNldCh1c2VyQnl0ZXMsIHdyaXRlT2Zmc2V0KTsKICAgICAgY29uc3QgazEgPSBuZXcgVWludDhBcnJheShjb21iaW5lZExlbmd0aCAqIDY0KTsKCiAgICAgIGZvciAobGV0IGogPSAwLCBwb3MgPSAwOyBqIDwgNjQ7IGorKywgcG9zICs9IGNvbWJpbmVkTGVuZ3RoKSB7CiAgICAgICAgazEuc2V0KGNvbWJpbmVkQXJyYXksIHBvcyk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGNpcGhlciA9IG5ldyBBRVMxMjhDaXBoZXIoay5zdWJhcnJheSgwLCAxNikpOwogICAgICBlID0gY2lwaGVyLmVuY3J5cHQoazEsIGsuc3ViYXJyYXkoMTYsIDMyKSk7CiAgICAgIGxldCByZW1haW5kZXIgPSAwOwoKICAgICAgZm9yIChsZXQgeiA9IDA7IHogPCAxNjsgeisrKSB7CiAgICAgICAgcmVtYWluZGVyICo9IDI1NiAlIDM7CiAgICAgICAgcmVtYWluZGVyICU9IDM7CiAgICAgICAgcmVtYWluZGVyICs9IChlW3pdID4+PiAwKSAlIDM7CiAgICAgICAgcmVtYWluZGVyICU9IDM7CiAgICAgIH0KCiAgICAgIGlmIChyZW1haW5kZXIgPT09IDApIHsKICAgICAgICBrID0gY2FsY3VsYXRlU0hBMjU2KGUsIDAsIGUubGVuZ3RoKTsKICAgICAgfSBlbHNlIGlmIChyZW1haW5kZXIgPT09IDEpIHsKICAgICAgICBrID0gY2FsY3VsYXRlU0hBMzg0KGUsIDAsIGUubGVuZ3RoKTsKICAgICAgfSBlbHNlIGlmIChyZW1haW5kZXIgPT09IDIpIHsKICAgICAgICBrID0gY2FsY3VsYXRlU0hBNTEyKGUsIDAsIGUubGVuZ3RoKTsKICAgICAgfQoKICAgICAgaSsrOwogICAgfQoKICAgIHJldHVybiBrLnN1YmFycmF5KDAsIDMyKTsKICB9CgogIGNsYXNzIFBERjIwIHsKICAgIGhhc2gocGFzc3dvcmQsIGNvbmNhdEJ5dGVzLCB1c2VyQnl0ZXMpIHsKICAgICAgcmV0dXJuIGNhbGN1bGF0ZVBERjIwSGFzaChwYXNzd29yZCwgY29uY2F0Qnl0ZXMsIHVzZXJCeXRlcyk7CiAgICB9CgogICAgY2hlY2tPd25lclBhc3N3b3JkKHBhc3N3b3JkLCBvd25lclZhbGlkYXRpb25TYWx0LCB1c2VyQnl0ZXMsIG93bmVyUGFzc3dvcmQpIHsKICAgICAgY29uc3QgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheShwYXNzd29yZC5sZW5ndGggKyA1Nik7CiAgICAgIGhhc2hEYXRhLnNldChwYXNzd29yZCwgMCk7CiAgICAgIGhhc2hEYXRhLnNldChvd25lclZhbGlkYXRpb25TYWx0LCBwYXNzd29yZC5sZW5ndGgpOwogICAgICBoYXNoRGF0YS5zZXQodXNlckJ5dGVzLCBwYXNzd29yZC5sZW5ndGggKyBvd25lclZhbGlkYXRpb25TYWx0Lmxlbmd0aCk7CiAgICAgIGNvbnN0IHJlc3VsdCA9IGNhbGN1bGF0ZVBERjIwSGFzaChwYXNzd29yZCwgaGFzaERhdGEsIHVzZXJCeXRlcyk7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuaXNBcnJheUVxdWFsKShyZXN1bHQsIG93bmVyUGFzc3dvcmQpOwogICAgfQoKICAgIGNoZWNrVXNlclBhc3N3b3JkKHBhc3N3b3JkLCB1c2VyVmFsaWRhdGlvblNhbHQsIHVzZXJQYXNzd29yZCkgewogICAgICBjb25zdCBoYXNoRGF0YSA9IG5ldyBVaW50OEFycmF5KHBhc3N3b3JkLmxlbmd0aCArIDgpOwogICAgICBoYXNoRGF0YS5zZXQocGFzc3dvcmQsIDApOwogICAgICBoYXNoRGF0YS5zZXQodXNlclZhbGlkYXRpb25TYWx0LCBwYXNzd29yZC5sZW5ndGgpOwogICAgICBjb25zdCByZXN1bHQgPSBjYWxjdWxhdGVQREYyMEhhc2gocGFzc3dvcmQsIGhhc2hEYXRhLCBbXSk7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuaXNBcnJheUVxdWFsKShyZXN1bHQsIHVzZXJQYXNzd29yZCk7CiAgICB9CgogICAgZ2V0T3duZXJLZXkocGFzc3dvcmQsIG93bmVyS2V5U2FsdCwgdXNlckJ5dGVzLCBvd25lckVuY3J5cHRpb24pIHsKICAgICAgY29uc3QgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheShwYXNzd29yZC5sZW5ndGggKyA1Nik7CiAgICAgIGhhc2hEYXRhLnNldChwYXNzd29yZCwgMCk7CiAgICAgIGhhc2hEYXRhLnNldChvd25lcktleVNhbHQsIHBhc3N3b3JkLmxlbmd0aCk7CiAgICAgIGhhc2hEYXRhLnNldCh1c2VyQnl0ZXMsIHBhc3N3b3JkLmxlbmd0aCArIG93bmVyS2V5U2FsdC5sZW5ndGgpOwogICAgICBjb25zdCBrZXkgPSBjYWxjdWxhdGVQREYyMEhhc2gocGFzc3dvcmQsIGhhc2hEYXRhLCB1c2VyQnl0ZXMpOwogICAgICBjb25zdCBjaXBoZXIgPSBuZXcgQUVTMjU2Q2lwaGVyKGtleSk7CiAgICAgIHJldHVybiBjaXBoZXIuZGVjcnlwdEJsb2NrKG93bmVyRW5jcnlwdGlvbiwgZmFsc2UsIG5ldyBVaW50OEFycmF5KDE2KSk7CiAgICB9CgogICAgZ2V0VXNlcktleShwYXNzd29yZCwgdXNlcktleVNhbHQsIHVzZXJFbmNyeXB0aW9uKSB7CiAgICAgIGNvbnN0IGhhc2hEYXRhID0gbmV3IFVpbnQ4QXJyYXkocGFzc3dvcmQubGVuZ3RoICsgOCk7CiAgICAgIGhhc2hEYXRhLnNldChwYXNzd29yZCwgMCk7CiAgICAgIGhhc2hEYXRhLnNldCh1c2VyS2V5U2FsdCwgcGFzc3dvcmQubGVuZ3RoKTsKICAgICAgY29uc3Qga2V5ID0gY2FsY3VsYXRlUERGMjBIYXNoKHBhc3N3b3JkLCBoYXNoRGF0YSwgW10pOwogICAgICBjb25zdCBjaXBoZXIgPSBuZXcgQUVTMjU2Q2lwaGVyKGtleSk7CiAgICAgIHJldHVybiBjaXBoZXIuZGVjcnlwdEJsb2NrKHVzZXJFbmNyeXB0aW9uLCBmYWxzZSwgbmV3IFVpbnQ4QXJyYXkoMTYpKTsKICAgIH0KCiAgfQoKICByZXR1cm4gUERGMjA7Cn0oKTsKCmV4cG9ydHMuUERGMjAgPSBQREYyMDsKCmNsYXNzIENpcGhlclRyYW5zZm9ybSB7CiAgY29uc3RydWN0b3Ioc3RyaW5nQ2lwaGVyQ29uc3RydWN0b3IsIHN0cmVhbUNpcGhlckNvbnN0cnVjdG9yKSB7CiAgICB0aGlzLlN0cmluZ0NpcGhlckNvbnN0cnVjdG9yID0gc3RyaW5nQ2lwaGVyQ29uc3RydWN0b3I7CiAgICB0aGlzLlN0cmVhbUNpcGhlckNvbnN0cnVjdG9yID0gc3RyZWFtQ2lwaGVyQ29uc3RydWN0b3I7CiAgfQoKICBjcmVhdGVTdHJlYW0oc3RyZWFtLCBsZW5ndGgpIHsKICAgIGNvbnN0IGNpcGhlciA9IG5ldyB0aGlzLlN0cmVhbUNpcGhlckNvbnN0cnVjdG9yKCk7CiAgICByZXR1cm4gbmV3IF9kZWNyeXB0X3N0cmVhbS5EZWNyeXB0U3RyZWFtKHN0cmVhbSwgbGVuZ3RoLCBmdW5jdGlvbiBjaXBoZXJUcmFuc2Zvcm1EZWNyeXB0U3RyZWFtKGRhdGEsIGZpbmFsaXplKSB7CiAgICAgIHJldHVybiBjaXBoZXIuZGVjcnlwdEJsb2NrKGRhdGEsIGZpbmFsaXplKTsKICAgIH0pOwogIH0KCiAgZGVjcnlwdFN0cmluZyhzKSB7CiAgICBjb25zdCBjaXBoZXIgPSBuZXcgdGhpcy5TdHJpbmdDaXBoZXJDb25zdHJ1Y3RvcigpOwogICAgbGV0IGRhdGEgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykocyk7CiAgICBkYXRhID0gY2lwaGVyLmRlY3J5cHRCbG9jayhkYXRhLCB0cnVlKTsKICAgIHJldHVybiAoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoZGF0YSk7CiAgfQoKICBlbmNyeXB0U3RyaW5nKHMpIHsKICAgIGNvbnN0IGNpcGhlciA9IG5ldyB0aGlzLlN0cmluZ0NpcGhlckNvbnN0cnVjdG9yKCk7CgogICAgaWYgKGNpcGhlciBpbnN0YW5jZW9mIEFFU0Jhc2VDaXBoZXIpIHsKICAgICAgY29uc3Qgc3RyTGVuID0gcy5sZW5ndGg7CiAgICAgIGNvbnN0IHBhZCA9IDE2IC0gc3RyTGVuICUgMTY7CiAgICAgIHMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShwYWQpLnJlcGVhdChwYWQpOwogICAgICBjb25zdCBpdiA9IG5ldyBVaW50OEFycmF5KDE2KTsKCiAgICAgIGlmICh0eXBlb2YgY3J5cHRvICE9PSAidW5kZWZpbmVkIikgewogICAgICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMoaXYpOwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7IGkrKykgewogICAgICAgICAgaXZbaV0gPSBNYXRoLmZsb29yKDI1NiAqIE1hdGgucmFuZG9tKCkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgbGV0IGRhdGEgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykocyk7CiAgICAgIGRhdGEgPSBjaXBoZXIuZW5jcnlwdChkYXRhLCBpdik7CiAgICAgIGNvbnN0IGJ1ZiA9IG5ldyBVaW50OEFycmF5KDE2ICsgZGF0YS5sZW5ndGgpOwogICAgICBidWYuc2V0KGl2KTsKICAgICAgYnVmLnNldChkYXRhLCAxNik7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoYnVmKTsKICAgIH0KCiAgICBsZXQgZGF0YSA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShzKTsKICAgIGRhdGEgPSBjaXBoZXIuZW5jcnlwdChkYXRhKTsKICAgIHJldHVybiAoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoZGF0YSk7CiAgfQoKfQoKY29uc3QgQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeSA9IGZ1bmN0aW9uIENpcGhlclRyYW5zZm9ybUZhY3RvcnlDbG9zdXJlKCkgewogIGNvbnN0IGRlZmF1bHRQYXNzd29yZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzB4MjgsIDB4YmYsIDB4NGUsIDB4NWUsIDB4NGUsIDB4NzUsIDB4OGEsIDB4NDEsIDB4NjQsIDB4MDAsIDB4NGUsIDB4NTYsIDB4ZmYsIDB4ZmEsIDB4MDEsIDB4MDgsIDB4MmUsIDB4MmUsIDB4MDAsIDB4YjYsIDB4ZDAsIDB4NjgsIDB4M2UsIDB4ODAsIDB4MmYsIDB4MGMsIDB4YTksIDB4ZmUsIDB4NjQsIDB4NTMsIDB4NjksIDB4N2FdKTsKCiAgZnVuY3Rpb24gY3JlYXRlRW5jcnlwdGlvbktleTIwKHJldmlzaW9uLCBwYXNzd29yZCwgb3duZXJQYXNzd29yZCwgb3duZXJWYWxpZGF0aW9uU2FsdCwgb3duZXJLZXlTYWx0LCB1Qnl0ZXMsIHVzZXJQYXNzd29yZCwgdXNlclZhbGlkYXRpb25TYWx0LCB1c2VyS2V5U2FsdCwgb3duZXJFbmNyeXB0aW9uLCB1c2VyRW5jcnlwdGlvbiwgcGVybXMpIHsKICAgIGlmIChwYXNzd29yZCkgewogICAgICBjb25zdCBwYXNzd29yZExlbmd0aCA9IE1hdGgubWluKDEyNywgcGFzc3dvcmQubGVuZ3RoKTsKICAgICAgcGFzc3dvcmQgPSBwYXNzd29yZC5zdWJhcnJheSgwLCBwYXNzd29yZExlbmd0aCk7CiAgICB9IGVsc2UgewogICAgICBwYXNzd29yZCA9IFtdOwogICAgfQoKICAgIGxldCBwZGZBbGdvcml0aG07CgogICAgaWYgKHJldmlzaW9uID09PSA2KSB7CiAgICAgIHBkZkFsZ29yaXRobSA9IG5ldyBQREYyMCgpOwogICAgfSBlbHNlIHsKICAgICAgcGRmQWxnb3JpdGhtID0gbmV3IFBERjE3KCk7CiAgICB9CgogICAgaWYgKHBkZkFsZ29yaXRobS5jaGVja1VzZXJQYXNzd29yZChwYXNzd29yZCwgdXNlclZhbGlkYXRpb25TYWx0LCB1c2VyUGFzc3dvcmQpKSB7CiAgICAgIHJldHVybiBwZGZBbGdvcml0aG0uZ2V0VXNlcktleShwYXNzd29yZCwgdXNlcktleVNhbHQsIHVzZXJFbmNyeXB0aW9uKTsKICAgIH0gZWxzZSBpZiAocGFzc3dvcmQubGVuZ3RoICYmIHBkZkFsZ29yaXRobS5jaGVja093bmVyUGFzc3dvcmQocGFzc3dvcmQsIG93bmVyVmFsaWRhdGlvblNhbHQsIHVCeXRlcywgb3duZXJQYXNzd29yZCkpIHsKICAgICAgcmV0dXJuIHBkZkFsZ29yaXRobS5nZXRPd25lcktleShwYXNzd29yZCwgb3duZXJLZXlTYWx0LCB1Qnl0ZXMsIG93bmVyRW5jcnlwdGlvbik7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBmdW5jdGlvbiBwcmVwYXJlS2V5RGF0YShmaWxlSWQsIHBhc3N3b3JkLCBvd25lclBhc3N3b3JkLCB1c2VyUGFzc3dvcmQsIGZsYWdzLCByZXZpc2lvbiwga2V5TGVuZ3RoLCBlbmNyeXB0TWV0YWRhdGEpIHsKICAgIGNvbnN0IGhhc2hEYXRhU2l6ZSA9IDQwICsgb3duZXJQYXNzd29yZC5sZW5ndGggKyBmaWxlSWQubGVuZ3RoOwogICAgY29uc3QgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheShoYXNoRGF0YVNpemUpOwogICAgbGV0IGkgPSAwLAogICAgICAgIGosCiAgICAgICAgbjsKCiAgICBpZiAocGFzc3dvcmQpIHsKICAgICAgbiA9IE1hdGgubWluKDMyLCBwYXNzd29yZC5sZW5ndGgpOwoKICAgICAgZm9yICg7IGkgPCBuOyArK2kpIHsKICAgICAgICBoYXNoRGF0YVtpXSA9IHBhc3N3b3JkW2ldOwogICAgICB9CiAgICB9CgogICAgaiA9IDA7CgogICAgd2hpbGUgKGkgPCAzMikgewogICAgICBoYXNoRGF0YVtpKytdID0gZGVmYXVsdFBhc3N3b3JkQnl0ZXNbaisrXTsKICAgIH0KCiAgICBmb3IgKGogPSAwLCBuID0gb3duZXJQYXNzd29yZC5sZW5ndGg7IGogPCBuOyArK2opIHsKICAgICAgaGFzaERhdGFbaSsrXSA9IG93bmVyUGFzc3dvcmRbal07CiAgICB9CgogICAgaGFzaERhdGFbaSsrXSA9IGZsYWdzICYgMHhmZjsKICAgIGhhc2hEYXRhW2krK10gPSBmbGFncyA+PiA4ICYgMHhmZjsKICAgIGhhc2hEYXRhW2krK10gPSBmbGFncyA+PiAxNiAmIDB4ZmY7CiAgICBoYXNoRGF0YVtpKytdID0gZmxhZ3MgPj4+IDI0ICYgMHhmZjsKCiAgICBmb3IgKGogPSAwLCBuID0gZmlsZUlkLmxlbmd0aDsgaiA8IG47ICsraikgewogICAgICBoYXNoRGF0YVtpKytdID0gZmlsZUlkW2pdOwogICAgfQoKICAgIGlmIChyZXZpc2lvbiA+PSA0ICYmICFlbmNyeXB0TWV0YWRhdGEpIHsKICAgICAgaGFzaERhdGFbaSsrXSA9IDB4ZmY7CiAgICAgIGhhc2hEYXRhW2krK10gPSAweGZmOwogICAgICBoYXNoRGF0YVtpKytdID0gMHhmZjsKICAgICAgaGFzaERhdGFbaSsrXSA9IDB4ZmY7CiAgICB9CgogICAgbGV0IGhhc2ggPSBjYWxjdWxhdGVNRDUoaGFzaERhdGEsIDAsIGkpOwogICAgY29uc3Qga2V5TGVuZ3RoSW5CeXRlcyA9IGtleUxlbmd0aCA+PiAzOwoKICAgIGlmIChyZXZpc2lvbiA+PSAzKSB7CiAgICAgIGZvciAoaiA9IDA7IGogPCA1MDsgKytqKSB7CiAgICAgICAgaGFzaCA9IGNhbGN1bGF0ZU1ENShoYXNoLCAwLCBrZXlMZW5ndGhJbkJ5dGVzKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGVuY3J5cHRpb25LZXkgPSBoYXNoLnN1YmFycmF5KDAsIGtleUxlbmd0aEluQnl0ZXMpOwogICAgbGV0IGNpcGhlciwgY2hlY2tEYXRhOwoKICAgIGlmIChyZXZpc2lvbiA+PSAzKSB7CiAgICAgIGZvciAoaSA9IDA7IGkgPCAzMjsgKytpKSB7CiAgICAgICAgaGFzaERhdGFbaV0gPSBkZWZhdWx0UGFzc3dvcmRCeXRlc1tpXTsKICAgICAgfQoKICAgICAgZm9yIChqID0gMCwgbiA9IGZpbGVJZC5sZW5ndGg7IGogPCBuOyArK2opIHsKICAgICAgICBoYXNoRGF0YVtpKytdID0gZmlsZUlkW2pdOwogICAgICB9CgogICAgICBjaXBoZXIgPSBuZXcgQVJDRm91ckNpcGhlcihlbmNyeXB0aW9uS2V5KTsKICAgICAgY2hlY2tEYXRhID0gY2lwaGVyLmVuY3J5cHRCbG9jayhjYWxjdWxhdGVNRDUoaGFzaERhdGEsIDAsIGkpKTsKICAgICAgbiA9IGVuY3J5cHRpb25LZXkubGVuZ3RoOwogICAgICBjb25zdCBkZXJpdmVkS2V5ID0gbmV3IFVpbnQ4QXJyYXkobik7CgogICAgICBmb3IgKGogPSAxOyBqIDw9IDE5OyArK2opIHsKICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IG47ICsraykgewogICAgICAgICAgZGVyaXZlZEtleVtrXSA9IGVuY3J5cHRpb25LZXlba10gXiBqOwogICAgICAgIH0KCiAgICAgICAgY2lwaGVyID0gbmV3IEFSQ0ZvdXJDaXBoZXIoZGVyaXZlZEtleSk7CiAgICAgICAgY2hlY2tEYXRhID0gY2lwaGVyLmVuY3J5cHRCbG9jayhjaGVja0RhdGEpOwogICAgICB9CgogICAgICBmb3IgKGogPSAwLCBuID0gY2hlY2tEYXRhLmxlbmd0aDsgaiA8IG47ICsraikgewogICAgICAgIGlmICh1c2VyUGFzc3dvcmRbal0gIT09IGNoZWNrRGF0YVtqXSkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjaXBoZXIgPSBuZXcgQVJDRm91ckNpcGhlcihlbmNyeXB0aW9uS2V5KTsKICAgICAgY2hlY2tEYXRhID0gY2lwaGVyLmVuY3J5cHRCbG9jayhkZWZhdWx0UGFzc3dvcmRCeXRlcyk7CgogICAgICBmb3IgKGogPSAwLCBuID0gY2hlY2tEYXRhLmxlbmd0aDsgaiA8IG47ICsraikgewogICAgICAgIGlmICh1c2VyUGFzc3dvcmRbal0gIT09IGNoZWNrRGF0YVtqXSkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGVuY3J5cHRpb25LZXk7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVVc2VyUGFzc3dvcmQocGFzc3dvcmQsIG93bmVyUGFzc3dvcmQsIHJldmlzaW9uLCBrZXlMZW5ndGgpIHsKICAgIGNvbnN0IGhhc2hEYXRhID0gbmV3IFVpbnQ4QXJyYXkoMzIpOwogICAgbGV0IGkgPSAwOwogICAgY29uc3QgbiA9IE1hdGgubWluKDMyLCBwYXNzd29yZC5sZW5ndGgpOwoKICAgIGZvciAoOyBpIDwgbjsgKytpKSB7CiAgICAgIGhhc2hEYXRhW2ldID0gcGFzc3dvcmRbaV07CiAgICB9CgogICAgbGV0IGogPSAwOwoKICAgIHdoaWxlIChpIDwgMzIpIHsKICAgICAgaGFzaERhdGFbaSsrXSA9IGRlZmF1bHRQYXNzd29yZEJ5dGVzW2orK107CiAgICB9CgogICAgbGV0IGhhc2ggPSBjYWxjdWxhdGVNRDUoaGFzaERhdGEsIDAsIGkpOwogICAgY29uc3Qga2V5TGVuZ3RoSW5CeXRlcyA9IGtleUxlbmd0aCA+PiAzOwoKICAgIGlmIChyZXZpc2lvbiA+PSAzKSB7CiAgICAgIGZvciAoaiA9IDA7IGogPCA1MDsgKytqKSB7CiAgICAgICAgaGFzaCA9IGNhbGN1bGF0ZU1ENShoYXNoLCAwLCBoYXNoLmxlbmd0aCk7CiAgICAgIH0KICAgIH0KCiAgICBsZXQgY2lwaGVyLCB1c2VyUGFzc3dvcmQ7CgogICAgaWYgKHJldmlzaW9uID49IDMpIHsKICAgICAgdXNlclBhc3N3b3JkID0gb3duZXJQYXNzd29yZDsKICAgICAgY29uc3QgZGVyaXZlZEtleSA9IG5ldyBVaW50OEFycmF5KGtleUxlbmd0aEluQnl0ZXMpOwoKICAgICAgZm9yIChqID0gMTk7IGogPj0gMDsgai0tKSB7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBrZXlMZW5ndGhJbkJ5dGVzOyArK2spIHsKICAgICAgICAgIGRlcml2ZWRLZXlba10gPSBoYXNoW2tdIF4gajsKICAgICAgICB9CgogICAgICAgIGNpcGhlciA9IG5ldyBBUkNGb3VyQ2lwaGVyKGRlcml2ZWRLZXkpOwogICAgICAgIHVzZXJQYXNzd29yZCA9IGNpcGhlci5lbmNyeXB0QmxvY2sodXNlclBhc3N3b3JkKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgY2lwaGVyID0gbmV3IEFSQ0ZvdXJDaXBoZXIoaGFzaC5zdWJhcnJheSgwLCBrZXlMZW5ndGhJbkJ5dGVzKSk7CiAgICAgIHVzZXJQYXNzd29yZCA9IGNpcGhlci5lbmNyeXB0QmxvY2sob3duZXJQYXNzd29yZCk7CiAgICB9CgogICAgcmV0dXJuIHVzZXJQYXNzd29yZDsKICB9CgogIGNvbnN0IGlkZW50aXR5TmFtZSA9IF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJJZGVudGl0eSIpOwoKICBmdW5jdGlvbiBidWlsZE9iamVjdEtleShudW0sIGdlbiwgZW5jcnlwdGlvbktleSkgewogICAgbGV0IGlzQWVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKICAgIGNvbnN0IGtleSA9IG5ldyBVaW50OEFycmF5KGVuY3J5cHRpb25LZXkubGVuZ3RoICsgOSk7CiAgICBjb25zdCBuID0gZW5jcnlwdGlvbktleS5sZW5ndGg7CiAgICBsZXQgaTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgKytpKSB7CiAgICAgIGtleVtpXSA9IGVuY3J5cHRpb25LZXlbaV07CiAgICB9CgogICAga2V5W2krK10gPSBudW0gJiAweGZmOwogICAga2V5W2krK10gPSBudW0gPj4gOCAmIDB4ZmY7CiAgICBrZXlbaSsrXSA9IG51bSA+PiAxNiAmIDB4ZmY7CiAgICBrZXlbaSsrXSA9IGdlbiAmIDB4ZmY7CiAgICBrZXlbaSsrXSA9IGdlbiA+PiA4ICYgMHhmZjsKCiAgICBpZiAoaXNBZXMpIHsKICAgICAga2V5W2krK10gPSAweDczOwogICAgICBrZXlbaSsrXSA9IDB4NDE7CiAgICAgIGtleVtpKytdID0gMHg2YzsKICAgICAga2V5W2krK10gPSAweDU0OwogICAgfQoKICAgIGNvbnN0IGhhc2ggPSBjYWxjdWxhdGVNRDUoa2V5LCAwLCBpKTsKICAgIHJldHVybiBoYXNoLnN1YmFycmF5KDAsIE1hdGgubWluKGVuY3J5cHRpb25LZXkubGVuZ3RoICsgNSwgMTYpKTsKICB9CgogIGZ1bmN0aW9uIGJ1aWxkQ2lwaGVyQ29uc3RydWN0b3IoY2YsIG5hbWUsIG51bSwgZ2VuLCBrZXkpIHsKICAgIGlmICghKG5hbWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgY3J5cHQgZmlsdGVyIG5hbWUuIik7CiAgICB9CgogICAgY29uc3QgY3J5cHRGaWx0ZXIgPSBjZi5nZXQobmFtZS5uYW1lKTsKICAgIGxldCBjZm07CgogICAgaWYgKGNyeXB0RmlsdGVyICE9PSBudWxsICYmIGNyeXB0RmlsdGVyICE9PSB1bmRlZmluZWQpIHsKICAgICAgY2ZtID0gY3J5cHRGaWx0ZXIuZ2V0KCJDRk0iKTsKICAgIH0KCiAgICBpZiAoIWNmbSB8fCBjZm0ubmFtZSA9PT0gIk5vbmUiKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiBjaXBoZXJUcmFuc2Zvcm1GYWN0b3J5QnVpbGRDaXBoZXJDb25zdHJ1Y3Rvck5vbmUoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBOdWxsQ2lwaGVyKCk7CiAgICAgIH07CiAgICB9CgogICAgaWYgKGNmbS5uYW1lID09PSAiVjIiKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiBjaXBoZXJUcmFuc2Zvcm1GYWN0b3J5QnVpbGRDaXBoZXJDb25zdHJ1Y3RvclYyKCkgewogICAgICAgIHJldHVybiBuZXcgQVJDRm91ckNpcGhlcihidWlsZE9iamVjdEtleShudW0sIGdlbiwga2V5LCBmYWxzZSkpOwogICAgICB9OwogICAgfQoKICAgIGlmIChjZm0ubmFtZSA9PT0gIkFFU1YyIikgewogICAgICByZXR1cm4gZnVuY3Rpb24gY2lwaGVyVHJhbnNmb3JtRmFjdG9yeUJ1aWxkQ2lwaGVyQ29uc3RydWN0b3JBRVNWMigpIHsKICAgICAgICByZXR1cm4gbmV3IEFFUzEyOENpcGhlcihidWlsZE9iamVjdEtleShudW0sIGdlbiwga2V5LCB0cnVlKSk7CiAgICAgIH07CiAgICB9CgogICAgaWYgKGNmbS5uYW1lID09PSAiQUVTVjMiKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiBjaXBoZXJUcmFuc2Zvcm1GYWN0b3J5QnVpbGRDaXBoZXJDb25zdHJ1Y3RvckFFU1YzKCkgewogICAgICAgIHJldHVybiBuZXcgQUVTMjU2Q2lwaGVyKGtleSk7CiAgICAgIH07CiAgICB9CgogICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbmtub3duIGNyeXB0byBtZXRob2QiKTsKICB9CgogIGNsYXNzIENpcGhlclRyYW5zZm9ybUZhY3RvcnkgewogICAgY29uc3RydWN0b3IoZGljdCwgZmlsZUlkLCBwYXNzd29yZCkgewogICAgICBjb25zdCBmaWx0ZXIgPSBkaWN0LmdldCgiRmlsdGVyIik7CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGZpbHRlciwgIlN0YW5kYXJkIikpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoInVua25vd24gZW5jcnlwdGlvbiBtZXRob2QiKTsKICAgICAgfQoKICAgICAgdGhpcy5maWx0ZXJOYW1lID0gZmlsdGVyLm5hbWU7CiAgICAgIHRoaXMuZGljdCA9IGRpY3Q7CiAgICAgIGNvbnN0IGFsZ29yaXRobSA9IGRpY3QuZ2V0KCJWIik7CgogICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoYWxnb3JpdGhtKSB8fCBhbGdvcml0aG0gIT09IDEgJiYgYWxnb3JpdGhtICE9PSAyICYmIGFsZ29yaXRobSAhPT0gNCAmJiBhbGdvcml0aG0gIT09IDUpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoInVuc3VwcG9ydGVkIGVuY3J5cHRpb24gYWxnb3JpdGhtIik7CiAgICAgIH0KCiAgICAgIHRoaXMuYWxnb3JpdGhtID0gYWxnb3JpdGhtOwogICAgICBsZXQga2V5TGVuZ3RoID0gZGljdC5nZXQoIkxlbmd0aCIpOwoKICAgICAgaWYgKCFrZXlMZW5ndGgpIHsKICAgICAgICBpZiAoYWxnb3JpdGhtIDw9IDMpIHsKICAgICAgICAgIGtleUxlbmd0aCA9IDQwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCBjZkRpY3QgPSBkaWN0LmdldCgiQ0YiKTsKICAgICAgICAgIGNvbnN0IHN0cmVhbUNyeXB0b05hbWUgPSBkaWN0LmdldCgiU3RtRiIpOwoKICAgICAgICAgIGlmIChjZkRpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ICYmIHN0cmVhbUNyeXB0b05hbWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgIGNmRGljdC5zdXBwcmVzc0VuY3J5cHRpb24gPSB0cnVlOwogICAgICAgICAgICBjb25zdCBoYW5kbGVyRGljdCA9IGNmRGljdC5nZXQoc3RyZWFtQ3J5cHRvTmFtZS5uYW1lKTsKICAgICAgICAgICAga2V5TGVuZ3RoID0gaGFuZGxlckRpY3QgJiYgaGFuZGxlckRpY3QuZ2V0KCJMZW5ndGgiKSB8fCAxMjg7CgogICAgICAgICAgICBpZiAoa2V5TGVuZ3RoIDwgNDApIHsKICAgICAgICAgICAgICBrZXlMZW5ndGggPDw9IDM7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihrZXlMZW5ndGgpIHx8IGtleUxlbmd0aCA8IDQwIHx8IGtleUxlbmd0aCAlIDggIT09IDApIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoImludmFsaWQga2V5IGxlbmd0aCIpOwogICAgICB9CgogICAgICBjb25zdCBvd25lclBhc3N3b3JkID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGRpY3QuZ2V0KCJPIikpLnN1YmFycmF5KDAsIDMyKTsKICAgICAgY29uc3QgdXNlclBhc3N3b3JkID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGRpY3QuZ2V0KCJVIikpLnN1YmFycmF5KDAsIDMyKTsKICAgICAgY29uc3QgZmxhZ3MgPSBkaWN0LmdldCgiUCIpOwogICAgICBjb25zdCByZXZpc2lvbiA9IGRpY3QuZ2V0KCJSIik7CiAgICAgIGNvbnN0IGVuY3J5cHRNZXRhZGF0YSA9IChhbGdvcml0aG0gPT09IDQgfHwgYWxnb3JpdGhtID09PSA1KSAmJiBkaWN0LmdldCgiRW5jcnlwdE1ldGFkYXRhIikgIT09IGZhbHNlOwogICAgICB0aGlzLmVuY3J5cHRNZXRhZGF0YSA9IGVuY3J5cHRNZXRhZGF0YTsKICAgICAgY29uc3QgZmlsZUlkQnl0ZXMgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZmlsZUlkKTsKICAgICAgbGV0IHBhc3N3b3JkQnl0ZXM7CgogICAgICBpZiAocGFzc3dvcmQpIHsKICAgICAgICBpZiAocmV2aXNpb24gPT09IDYpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHBhc3N3b3JkID0gKDAsIF91dGlsLnV0ZjhTdHJpbmdUb1N0cmluZykocGFzc3dvcmQpOwogICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJDaXBoZXJUcmFuc2Zvcm1GYWN0b3J5OiAiICsgIlVuYWJsZSB0byBjb252ZXJ0IFVURjggZW5jb2RlZCBwYXNzd29yZC4iKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHBhc3N3b3JkQnl0ZXMgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykocGFzc3dvcmQpOwogICAgICB9CgogICAgICBsZXQgZW5jcnlwdGlvbktleTsKCiAgICAgIGlmIChhbGdvcml0aG0gIT09IDUpIHsKICAgICAgICBlbmNyeXB0aW9uS2V5ID0gcHJlcGFyZUtleURhdGEoZmlsZUlkQnl0ZXMsIHBhc3N3b3JkQnl0ZXMsIG93bmVyUGFzc3dvcmQsIHVzZXJQYXNzd29yZCwgZmxhZ3MsIHJldmlzaW9uLCBrZXlMZW5ndGgsIGVuY3J5cHRNZXRhZGF0YSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3Qgb3duZXJWYWxpZGF0aW9uU2FsdCA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShkaWN0LmdldCgiTyIpKS5zdWJhcnJheSgzMiwgNDApOwogICAgICAgIGNvbnN0IG93bmVyS2V5U2FsdCA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShkaWN0LmdldCgiTyIpKS5zdWJhcnJheSg0MCwgNDgpOwogICAgICAgIGNvbnN0IHVCeXRlcyA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShkaWN0LmdldCgiVSIpKS5zdWJhcnJheSgwLCA0OCk7CiAgICAgICAgY29uc3QgdXNlclZhbGlkYXRpb25TYWx0ID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGRpY3QuZ2V0KCJVIikpLnN1YmFycmF5KDMyLCA0MCk7CiAgICAgICAgY29uc3QgdXNlcktleVNhbHQgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIlUiKSkuc3ViYXJyYXkoNDAsIDQ4KTsKICAgICAgICBjb25zdCBvd25lckVuY3J5cHRpb24gPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIk9FIikpOwogICAgICAgIGNvbnN0IHVzZXJFbmNyeXB0aW9uID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGRpY3QuZ2V0KCJVRSIpKTsKICAgICAgICBjb25zdCBwZXJtcyA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShkaWN0LmdldCgiUGVybXMiKSk7CiAgICAgICAgZW5jcnlwdGlvbktleSA9IGNyZWF0ZUVuY3J5cHRpb25LZXkyMChyZXZpc2lvbiwgcGFzc3dvcmRCeXRlcywgb3duZXJQYXNzd29yZCwgb3duZXJWYWxpZGF0aW9uU2FsdCwgb3duZXJLZXlTYWx0LCB1Qnl0ZXMsIHVzZXJQYXNzd29yZCwgdXNlclZhbGlkYXRpb25TYWx0LCB1c2VyS2V5U2FsdCwgb3duZXJFbmNyeXB0aW9uLCB1c2VyRW5jcnlwdGlvbiwgcGVybXMpOwogICAgICB9CgogICAgICBpZiAoIWVuY3J5cHRpb25LZXkgJiYgIXBhc3N3b3JkKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLlBhc3N3b3JkRXhjZXB0aW9uKCJObyBwYXNzd29yZCBnaXZlbiIsIF91dGlsLlBhc3N3b3JkUmVzcG9uc2VzLk5FRURfUEFTU1dPUkQpOwogICAgICB9IGVsc2UgaWYgKCFlbmNyeXB0aW9uS2V5ICYmIHBhc3N3b3JkKSB7CiAgICAgICAgY29uc3QgZGVjb2RlZFBhc3N3b3JkID0gZGVjb2RlVXNlclBhc3N3b3JkKHBhc3N3b3JkQnl0ZXMsIG93bmVyUGFzc3dvcmQsIHJldmlzaW9uLCBrZXlMZW5ndGgpOwogICAgICAgIGVuY3J5cHRpb25LZXkgPSBwcmVwYXJlS2V5RGF0YShmaWxlSWRCeXRlcywgZGVjb2RlZFBhc3N3b3JkLCBvd25lclBhc3N3b3JkLCB1c2VyUGFzc3dvcmQsIGZsYWdzLCByZXZpc2lvbiwga2V5TGVuZ3RoLCBlbmNyeXB0TWV0YWRhdGEpOwogICAgICB9CgogICAgICBpZiAoIWVuY3J5cHRpb25LZXkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuUGFzc3dvcmRFeGNlcHRpb24oIkluY29ycmVjdCBQYXNzd29yZCIsIF91dGlsLlBhc3N3b3JkUmVzcG9uc2VzLklOQ09SUkVDVF9QQVNTV09SRCk7CiAgICAgIH0KCiAgICAgIHRoaXMuZW5jcnlwdGlvbktleSA9IGVuY3J5cHRpb25LZXk7CgogICAgICBpZiAoYWxnb3JpdGhtID49IDQpIHsKICAgICAgICBjb25zdCBjZiA9IGRpY3QuZ2V0KCJDRiIpOwoKICAgICAgICBpZiAoY2YgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgICBjZi5zdXBwcmVzc0VuY3J5cHRpb24gPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jZiA9IGNmOwogICAgICAgIHRoaXMuc3RtZiA9IGRpY3QuZ2V0KCJTdG1GIikgfHwgaWRlbnRpdHlOYW1lOwogICAgICAgIHRoaXMuc3RyZiA9IGRpY3QuZ2V0KCJTdHJGIikgfHwgaWRlbnRpdHlOYW1lOwogICAgICAgIHRoaXMuZWZmID0gZGljdC5nZXQoIkVGRiIpIHx8IHRoaXMuc3RtZjsKICAgICAgfQogICAgfQoKICAgIGNyZWF0ZUNpcGhlclRyYW5zZm9ybShudW0sIGdlbikgewogICAgICBpZiAodGhpcy5hbGdvcml0aG0gPT09IDQgfHwgdGhpcy5hbGdvcml0aG0gPT09IDUpIHsKICAgICAgICByZXR1cm4gbmV3IENpcGhlclRyYW5zZm9ybShidWlsZENpcGhlckNvbnN0cnVjdG9yKHRoaXMuY2YsIHRoaXMuc3RyZiwgbnVtLCBnZW4sIHRoaXMuZW5jcnlwdGlvbktleSksIGJ1aWxkQ2lwaGVyQ29uc3RydWN0b3IodGhpcy5jZiwgdGhpcy5zdG1mLCBudW0sIGdlbiwgdGhpcy5lbmNyeXB0aW9uS2V5KSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGtleSA9IGJ1aWxkT2JqZWN0S2V5KG51bSwgZ2VuLCB0aGlzLmVuY3J5cHRpb25LZXksIGZhbHNlKTsKCiAgICAgIGNvbnN0IGNpcGhlckNvbnN0cnVjdG9yID0gZnVuY3Rpb24gYnVpbGRDaXBoZXJDaXBoZXJDb25zdHJ1Y3RvcigpIHsKICAgICAgICByZXR1cm4gbmV3IEFSQ0ZvdXJDaXBoZXIoa2V5KTsKICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgQ2lwaGVyVHJhbnNmb3JtKGNpcGhlckNvbnN0cnVjdG9yLCBjaXBoZXJDb25zdHJ1Y3Rvcik7CiAgICB9CgogIH0KCiAgcmV0dXJuIENpcGhlclRyYW5zZm9ybUZhY3Rvcnk7Cn0oKTsKCmV4cG9ydHMuQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeSA9IENpcGhlclRyYW5zZm9ybUZhY3Rvcnk7CgovKioqLyB9KSwKLyogMTkzICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5EZWNyeXB0U3RyZWFtID0gdm9pZCAwOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDQpOwoKY29uc3QgY2h1bmtTaXplID0gNTEyOwoKY2xhc3MgRGVjcnlwdFN0cmVhbSBleHRlbmRzIF9kZWNvZGVfc3RyZWFtLkRlY29kZVN0cmVhbSB7CiAgY29uc3RydWN0b3Ioc3RyLCBtYXliZUxlbmd0aCwgZGVjcnlwdCkgewogICAgc3VwZXIobWF5YmVMZW5ndGgpOwogICAgdGhpcy5zdHIgPSBzdHI7CiAgICB0aGlzLmRpY3QgPSBzdHIuZGljdDsKICAgIHRoaXMuZGVjcnlwdCA9IGRlY3J5cHQ7CiAgICB0aGlzLm5leHRDaHVuayA9IG51bGw7CiAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7CiAgfQoKICByZWFkQmxvY2soKSB7CiAgICBsZXQgY2h1bms7CgogICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHsKICAgICAgY2h1bmsgPSB0aGlzLm5leHRDaHVuazsKICAgIH0gZWxzZSB7CiAgICAgIGNodW5rID0gdGhpcy5zdHIuZ2V0Qnl0ZXMoY2h1bmtTaXplKTsKICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7CiAgICB9CgogICAgaWYgKCFjaHVuayB8fCBjaHVuay5sZW5ndGggPT09IDApIHsKICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5uZXh0Q2h1bmsgPSB0aGlzLnN0ci5nZXRCeXRlcyhjaHVua1NpemUpOwogICAgY29uc3QgaGFzTW9yZURhdGEgPSB0aGlzLm5leHRDaHVuayAmJiB0aGlzLm5leHRDaHVuay5sZW5ndGggPiAwOwogICAgY29uc3QgZGVjcnlwdCA9IHRoaXMuZGVjcnlwdDsKICAgIGNodW5rID0gZGVjcnlwdChjaHVuaywgIWhhc01vcmVEYXRhKTsKICAgIGxldCBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIGNvbnN0IG4gPSBjaHVuay5sZW5ndGgsCiAgICAgICAgICBidWZmZXIgPSB0aGlzLmVuc3VyZUJ1ZmZlcihidWZmZXJMZW5ndGggKyBuKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykgewogICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoKytdID0gY2h1bmtbaV07CiAgICB9CgogICAgdGhpcy5idWZmZXJMZW5ndGggPSBidWZmZXJMZW5ndGg7CiAgfQoKfQoKZXhwb3J0cy5EZWNyeXB0U3RyZWFtID0gRGVjcnlwdFN0cmVhbTsKCi8qKiovIH0pLAovKiAxOTQgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkNhdGFsb2cgPSB2b2lkIDA7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwoKdmFyIF9uYW1lX251bWJlcl90cmVlID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTUpOwoKdmFyIF9iYXNlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMyKTsKCnZhciBfY2xlYW51cF9oZWxwZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5Nik7Cgp2YXIgX2NvbG9yc3BhY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzOSk7Cgp2YXIgX2ZpbGVfc3BlYyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk3KTsKCnZhciBfaW1hZ2VfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE4NCk7Cgp2YXIgX21ldGFkYXRhX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk4KTsKCnZhciBfc3RydWN0X3RyZWUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5OSk7CgpmdW5jdGlvbiBmZXRjaERlc3RpbmF0aW9uKGRlc3QpIHsKICBpZiAoZGVzdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgIGRlc3QgPSBkZXN0LmdldCgiRCIpOwogIH0KCiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoZGVzdCkgPyBkZXN0IDogbnVsbDsKfQoKY2xhc3MgQ2F0YWxvZyB7CiAgY29uc3RydWN0b3IocGRmTWFuYWdlciwgeHJlZikgewogICAgdGhpcy5wZGZNYW5hZ2VyID0gcGRmTWFuYWdlcjsKICAgIHRoaXMueHJlZiA9IHhyZWY7CiAgICB0aGlzLl9jYXREaWN0ID0geHJlZi5nZXRDYXRhbG9nT2JqKCk7CgogICAgaWYgKCEodGhpcy5fY2F0RGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQ2F0YWxvZyBvYmplY3QgaXMgbm90IGEgZGljdGlvbmFyeS4iKTsKICAgIH0KCiAgICB0aGlzLnRvcGxldmVsUGFnZXNEaWN0OwogICAgdGhpcy5fYWN0dWFsTnVtUGFnZXMgPSBudWxsOwogICAgdGhpcy5mb250Q2FjaGUgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0Q2FjaGUoKTsKICAgIHRoaXMuYnVpbHRJbkNNYXBDYWNoZSA9IG5ldyBNYXAoKTsKICAgIHRoaXMuc3RhbmRhcmRGb250RGF0YUNhY2hlID0gbmV3IE1hcCgpOwogICAgdGhpcy5nbG9iYWxJbWFnZUNhY2hlID0gbmV3IF9pbWFnZV91dGlscy5HbG9iYWxJbWFnZUNhY2hlKCk7CiAgICB0aGlzLnBhZ2VLaWRzQ291bnRDYWNoZSA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXRDYWNoZSgpOwogICAgdGhpcy5wYWdlSW5kZXhDYWNoZSA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXRDYWNoZSgpOwogICAgdGhpcy5ub25CbGVuZE1vZGVzU2V0ID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogIH0KCiAgZ2V0IHZlcnNpb24oKSB7CiAgICBjb25zdCB2ZXJzaW9uID0gdGhpcy5fY2F0RGljdC5nZXQoIlZlcnNpb24iKTsKCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInZlcnNpb24iLCB2ZXJzaW9uIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IHZlcnNpb24ubmFtZSA6IG51bGwpOwogIH0KCiAgZ2V0IGxhbmcoKSB7CiAgICBjb25zdCBsYW5nID0gdGhpcy5fY2F0RGljdC5nZXQoIkxhbmciKTsKCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImxhbmciLCB0eXBlb2YgbGFuZyA9PT0gInN0cmluZyIgPyAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGxhbmcpIDogbnVsbCk7CiAgfQoKICBnZXQgbmVlZHNSZW5kZXJpbmcoKSB7CiAgICBjb25zdCBuZWVkc1JlbmRlcmluZyA9IHRoaXMuX2NhdERpY3QuZ2V0KCJOZWVkc1JlbmRlcmluZyIpOwoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAibmVlZHNSZW5kZXJpbmciLCB0eXBlb2YgbmVlZHNSZW5kZXJpbmcgPT09ICJib29sZWFuIiA/IG5lZWRzUmVuZGVyaW5nIDogZmFsc2UpOwogIH0KCiAgZ2V0IGNvbGxlY3Rpb24oKSB7CiAgICBsZXQgY29sbGVjdGlvbiA9IG51bGw7CgogICAgdHJ5IHsKICAgICAgY29uc3Qgb2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIkNvbGxlY3Rpb24iKTsKCiAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ICYmIG9iai5zaXplID4gMCkgewogICAgICAgIGNvbGxlY3Rpb24gPSBvYmo7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgdGhyb3cgZXg7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC5pbmZvKSgiQ2Fubm90IGZldGNoIENvbGxlY3Rpb24gZW50cnk7IGFzc3VtaW5nIG5vIGNvbGxlY3Rpb24gaXMgcHJlc2VudC4iKTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImNvbGxlY3Rpb24iLCBjb2xsZWN0aW9uKTsKICB9CgogIGdldCBhY3JvRm9ybSgpIHsKICAgIGxldCBhY3JvRm9ybSA9IG51bGw7CgogICAgdHJ5IHsKICAgICAgY29uc3Qgb2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIkFjcm9Gb3JtIik7CgogICAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiBvYmouc2l6ZSA+IDApIHsKICAgICAgICBhY3JvRm9ybSA9IG9iajsKICAgICAgfQogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLmluZm8pKCJDYW5ub3QgZmV0Y2ggQWNyb0Zvcm0gZW50cnk7IGFzc3VtaW5nIG5vIGZvcm1zIGFyZSBwcmVzZW50LiIpOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYWNyb0Zvcm0iLCBhY3JvRm9ybSk7CiAgfQoKICBnZXQgYWNyb0Zvcm1SZWYoKSB7CiAgICBjb25zdCB2YWx1ZSA9IHRoaXMuX2NhdERpY3QuZ2V0UmF3KCJBY3JvRm9ybSIpOwoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYWNyb0Zvcm1SZWYiLCB2YWx1ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZiA/IHZhbHVlIDogbnVsbCk7CiAgfQoKICBnZXQgbWV0YWRhdGEoKSB7CiAgICBjb25zdCBzdHJlYW1SZWYgPSB0aGlzLl9jYXREaWN0LmdldFJhdygiTWV0YWRhdGEiKTsKCiAgICBpZiAoIShzdHJlYW1SZWYgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAibWV0YWRhdGEiLCBudWxsKTsKICAgIH0KCiAgICBsZXQgbWV0YWRhdGEgPSBudWxsOwoKICAgIHRyeSB7CiAgICAgIGNvbnN0IHN1cHByZXNzRW5jcnlwdGlvbiA9ICEodGhpcy54cmVmLmVuY3J5cHQgJiYgdGhpcy54cmVmLmVuY3J5cHQuZW5jcnlwdE1ldGFkYXRhKTsKICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy54cmVmLmZldGNoKHN0cmVhbVJlZiwgc3VwcHJlc3NFbmNyeXB0aW9uKTsKCiAgICAgIGlmIChzdHJlYW0gaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSAmJiBzdHJlYW0uZGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICBjb25zdCB0eXBlID0gc3RyZWFtLmRpY3QuZ2V0KCJUeXBlIik7CiAgICAgICAgY29uc3Qgc3VidHlwZSA9IHN0cmVhbS5kaWN0LmdldCgiU3VidHlwZSIpOwoKICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkodHlwZSwgIk1ldGFkYXRhIikgJiYgKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoc3VidHlwZSwgIlhNTCIpKSB7CiAgICAgICAgICBjb25zdCBkYXRhID0gKDAsIF91dGlsLnN0cmluZ1RvVVRGOFN0cmluZykoc3RyZWFtLmdldFN0cmluZygpKTsKCiAgICAgICAgICBpZiAoZGF0YSkgewogICAgICAgICAgICBtZXRhZGF0YSA9IG5ldyBfbWV0YWRhdGFfcGFyc2VyLk1ldGFkYXRhUGFyc2VyKGRhdGEpLnNlcmlhbGl6YWJsZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgdGhyb3cgZXg7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC5pbmZvKShgU2tpcHBpbmcgaW52YWxpZCBNZXRhZGF0YTogIiR7ZXh9Ii5gKTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIm1ldGFkYXRhIiwgbWV0YWRhdGEpOwogIH0KCiAgZ2V0IG1hcmtJbmZvKCkgewogICAgbGV0IG1hcmtJbmZvID0gbnVsbDsKCiAgICB0cnkgewogICAgICBtYXJrSW5mbyA9IHRoaXMuX3JlYWRNYXJrSW5mbygpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKCJVbmFibGUgdG8gcmVhZCBtYXJrIGluZm8uIik7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJtYXJrSW5mbyIsIG1hcmtJbmZvKTsKICB9CgogIF9yZWFkTWFya0luZm8oKSB7CiAgICBjb25zdCBvYmogPSB0aGlzLl9jYXREaWN0LmdldCgiTWFya0luZm8iKTsKCiAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBtYXJrSW5mbyA9IHsKICAgICAgTWFya2VkOiBmYWxzZSwKICAgICAgVXNlclByb3BlcnRpZXM6IGZhbHNlLAogICAgICBTdXNwZWN0czogZmFsc2UKICAgIH07CgogICAgZm9yIChjb25zdCBrZXkgaW4gbWFya0luZm8pIHsKICAgICAgY29uc3QgdmFsdWUgPSBvYmouZ2V0KGtleSk7CgogICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAiYm9vbGVhbiIpIHsKICAgICAgICBtYXJrSW5mb1trZXldID0gdmFsdWU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbWFya0luZm87CiAgfQoKICBnZXQgc3RydWN0VHJlZVJvb3QoKSB7CiAgICBsZXQgc3RydWN0VHJlZSA9IG51bGw7CgogICAgdHJ5IHsKICAgICAgc3RydWN0VHJlZSA9IHRoaXMuX3JlYWRTdHJ1Y3RUcmVlUm9vdCgpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKCJVbmFibGUgcmVhZCB0byBzdHJ1Y3RUcmVlUm9vdCBpbmZvLiIpOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAic3RydWN0VHJlZVJvb3QiLCBzdHJ1Y3RUcmVlKTsKICB9CgogIF9yZWFkU3RydWN0VHJlZVJvb3QoKSB7CiAgICBjb25zdCBvYmogPSB0aGlzLl9jYXREaWN0LmdldCgiU3RydWN0VHJlZVJvb3QiKTsKCiAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCByb290ID0gbmV3IF9zdHJ1Y3RfdHJlZS5TdHJ1Y3RUcmVlUm9vdChvYmopOwogICAgcm9vdC5pbml0KCk7CiAgICByZXR1cm4gcm9vdDsKICB9CgogIGdldCB0b3BsZXZlbFBhZ2VzRGljdCgpIHsKICAgIGNvbnN0IHBhZ2VzT2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIlBhZ2VzIik7CgogICAgaWYgKCEocGFnZXNPYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgdG9wLWxldmVsIHBhZ2VzIGRpY3Rpb25hcnkuIik7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ0b3BsZXZlbFBhZ2VzRGljdCIsIHBhZ2VzT2JqKTsKICB9CgogIGdldCBkb2N1bWVudE91dGxpbmUoKSB7CiAgICBsZXQgb2JqID0gbnVsbDsKCiAgICB0cnkgewogICAgICBvYmogPSB0aGlzLl9yZWFkRG9jdW1lbnRPdXRsaW5lKCk7CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGV4OwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoIlVuYWJsZSB0byByZWFkIGRvY3VtZW50IG91dGxpbmUuIik7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJkb2N1bWVudE91dGxpbmUiLCBvYmopOwogIH0KCiAgX3JlYWREb2N1bWVudE91dGxpbmUoKSB7CiAgICBsZXQgb2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIk91dGxpbmVzIik7CgogICAgaWYgKCEob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgb2JqID0gb2JqLmdldFJhdygiRmlyc3QiKTsKCiAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHJvb3QgPSB7CiAgICAgIGl0ZW1zOiBbXQogICAgfTsKICAgIGNvbnN0IHF1ZXVlID0gW3sKICAgICAgb2JqLAogICAgICBwYXJlbnQ6IHJvb3QKICAgIH1dOwogICAgY29uc3QgcHJvY2Vzc2VkID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogICAgcHJvY2Vzc2VkLnB1dChvYmopOwogICAgY29uc3QgeHJlZiA9IHRoaXMueHJlZiwKICAgICAgICAgIGJsYWNrQ29sb3IgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoMyk7CgogICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCA+IDApIHsKICAgICAgY29uc3QgaSA9IHF1ZXVlLnNoaWZ0KCk7CiAgICAgIGNvbnN0IG91dGxpbmVEaWN0ID0geHJlZi5mZXRjaElmUmVmKGkub2JqKTsKCiAgICAgIGlmIChvdXRsaW5lRGljdCA9PT0gbnVsbCkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAoIW91dGxpbmVEaWN0LmhhcygiVGl0bGUiKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBvdXRsaW5lIGl0ZW0gZW5jb3VudGVyZWQuIik7CiAgICAgIH0KCiAgICAgIGNvbnN0IGRhdGEgPSB7CiAgICAgICAgdXJsOiBudWxsLAogICAgICAgIGRlc3Q6IG51bGwKICAgICAgfTsKICAgICAgQ2F0YWxvZy5wYXJzZURlc3REaWN0aW9uYXJ5KHsKICAgICAgICBkZXN0RGljdDogb3V0bGluZURpY3QsCiAgICAgICAgcmVzdWx0T2JqOiBkYXRhLAogICAgICAgIGRvY0Jhc2VVcmw6IHRoaXMucGRmTWFuYWdlci5kb2NCYXNlVXJsCiAgICAgIH0pOwogICAgICBjb25zdCB0aXRsZSA9IG91dGxpbmVEaWN0LmdldCgiVGl0bGUiKTsKICAgICAgY29uc3QgZmxhZ3MgPSBvdXRsaW5lRGljdC5nZXQoIkYiKSB8fCAwOwogICAgICBjb25zdCBjb2xvciA9IG91dGxpbmVEaWN0LmdldEFycmF5KCJDIik7CiAgICAgIGNvbnN0IGNvdW50ID0gb3V0bGluZURpY3QuZ2V0KCJDb3VudCIpOwogICAgICBsZXQgcmdiQ29sb3IgPSBibGFja0NvbG9yOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY29sb3IpICYmIGNvbG9yLmxlbmd0aCA9PT0gMyAmJiAoY29sb3JbMF0gIT09IDAgfHwgY29sb3JbMV0gIT09IDAgfHwgY29sb3JbMl0gIT09IDApKSB7CiAgICAgICAgcmdiQ29sb3IgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMucmdiLmdldFJnYihjb2xvciwgMCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG91dGxpbmVJdGVtID0gewogICAgICAgIGRlc3Q6IGRhdGEuZGVzdCwKICAgICAgICB1cmw6IGRhdGEudXJsLAogICAgICAgIHVuc2FmZVVybDogZGF0YS51bnNhZmVVcmwsCiAgICAgICAgbmV3V2luZG93OiBkYXRhLm5ld1dpbmRvdywKICAgICAgICB0aXRsZTogKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKSh0aXRsZSksCiAgICAgICAgY29sb3I6IHJnYkNvbG9yLAogICAgICAgIGNvdW50OiBOdW1iZXIuaXNJbnRlZ2VyKGNvdW50KSA/IGNvdW50IDogdW5kZWZpbmVkLAogICAgICAgIGJvbGQ6ICEhKGZsYWdzICYgMiksCiAgICAgICAgaXRhbGljOiAhIShmbGFncyAmIDEpLAogICAgICAgIGl0ZW1zOiBbXQogICAgICB9OwogICAgICBpLnBhcmVudC5pdGVtcy5wdXNoKG91dGxpbmVJdGVtKTsKICAgICAgb2JqID0gb3V0bGluZURpY3QuZ2V0UmF3KCJGaXJzdCIpOwoKICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZiAmJiAhcHJvY2Vzc2VkLmhhcyhvYmopKSB7CiAgICAgICAgcXVldWUucHVzaCh7CiAgICAgICAgICBvYmosCiAgICAgICAgICBwYXJlbnQ6IG91dGxpbmVJdGVtCiAgICAgICAgfSk7CiAgICAgICAgcHJvY2Vzc2VkLnB1dChvYmopOwogICAgICB9CgogICAgICBvYmogPSBvdXRsaW5lRGljdC5nZXRSYXcoIk5leHQiKTsKCiAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYgJiYgIXByb2Nlc3NlZC5oYXMob2JqKSkgewogICAgICAgIHF1ZXVlLnB1c2goewogICAgICAgICAgb2JqLAogICAgICAgICAgcGFyZW50OiBpLnBhcmVudAogICAgICAgIH0pOwogICAgICAgIHByb2Nlc3NlZC5wdXQob2JqKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiByb290Lml0ZW1zLmxlbmd0aCA+IDAgPyByb290Lml0ZW1zIDogbnVsbDsKICB9CgogIGdldCBwZXJtaXNzaW9ucygpIHsKICAgIGxldCBwZXJtaXNzaW9ucyA9IG51bGw7CgogICAgdHJ5IHsKICAgICAgcGVybWlzc2lvbnMgPSB0aGlzLl9yZWFkUGVybWlzc2lvbnMoKTsKICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgdGhyb3cgZXg7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC53YXJuKSgiVW5hYmxlIHRvIHJlYWQgcGVybWlzc2lvbnMuIik7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJwZXJtaXNzaW9ucyIsIHBlcm1pc3Npb25zKTsKICB9CgogIF9yZWFkUGVybWlzc2lvbnMoKSB7CiAgICBjb25zdCBlbmNyeXB0ID0gdGhpcy54cmVmLnRyYWlsZXIuZ2V0KCJFbmNyeXB0Iik7CgogICAgaWYgKCEoZW5jcnlwdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGxldCBmbGFncyA9IGVuY3J5cHQuZ2V0KCJQIik7CgogICAgaWYgKHR5cGVvZiBmbGFncyAhPT0gIm51bWJlciIpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgZmxhZ3MgKz0gMiAqKiAzMjsKICAgIGNvbnN0IHBlcm1pc3Npb25zID0gW107CgogICAgZm9yIChjb25zdCBrZXkgaW4gX3V0aWwuUGVybWlzc2lvbkZsYWcpIHsKICAgICAgY29uc3QgdmFsdWUgPSBfdXRpbC5QZXJtaXNzaW9uRmxhZ1trZXldOwoKICAgICAgaWYgKGZsYWdzICYgdmFsdWUpIHsKICAgICAgICBwZXJtaXNzaW9ucy5wdXNoKHZhbHVlKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBwZXJtaXNzaW9uczsKICB9CgogIGdldCBvcHRpb25hbENvbnRlbnRDb25maWcoKSB7CiAgICBsZXQgY29uZmlnID0gbnVsbDsKCiAgICB0cnkgewogICAgICBjb25zdCBwcm9wZXJ0aWVzID0gdGhpcy5fY2F0RGljdC5nZXQoIk9DUHJvcGVydGllcyIpOwoKICAgICAgaWYgKCFwcm9wZXJ0aWVzKSB7CiAgICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJvcHRpb25hbENvbnRlbnRDb25maWciLCBudWxsKTsKICAgICAgfQoKICAgICAgY29uc3QgZGVmYXVsdENvbmZpZyA9IHByb3BlcnRpZXMuZ2V0KCJEIik7CgogICAgICBpZiAoIWRlZmF1bHRDb25maWcpIHsKICAgICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIm9wdGlvbmFsQ29udGVudENvbmZpZyIsIG51bGwpOwogICAgICB9CgogICAgICBjb25zdCBncm91cHNEYXRhID0gcHJvcGVydGllcy5nZXQoIk9DR3MiKTsKCiAgICAgIGlmICghQXJyYXkuaXNBcnJheShncm91cHNEYXRhKSkgewogICAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAib3B0aW9uYWxDb250ZW50Q29uZmlnIiwgbnVsbCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGdyb3VwcyA9IFtdOwogICAgICBjb25zdCBncm91cFJlZnMgPSBbXTsKCiAgICAgIGZvciAoY29uc3QgZ3JvdXBSZWYgb2YgZ3JvdXBzRGF0YSkgewogICAgICAgIGlmICghKGdyb3VwUmVmIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBncm91cFJlZnMucHVzaChncm91cFJlZik7CiAgICAgICAgY29uc3QgZ3JvdXAgPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZihncm91cFJlZik7CiAgICAgICAgZ3JvdXBzLnB1c2goewogICAgICAgICAgaWQ6IGdyb3VwUmVmLnRvU3RyaW5nKCksCiAgICAgICAgICBuYW1lOiB0eXBlb2YgZ3JvdXAuZ2V0KCJOYW1lIikgPT09ICJzdHJpbmciID8gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShncm91cC5nZXQoIk5hbWUiKSkgOiBudWxsLAogICAgICAgICAgaW50ZW50OiB0eXBlb2YgZ3JvdXAuZ2V0KCJJbnRlbnQiKSA9PT0gInN0cmluZyIgPyAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGdyb3VwLmdldCgiSW50ZW50IikpIDogbnVsbAogICAgICAgIH0pOwogICAgICB9CgogICAgICBjb25maWcgPSB0aGlzLl9yZWFkT3B0aW9uYWxDb250ZW50Q29uZmlnKGRlZmF1bHRDb25maWcsIGdyb3VwUmVmcyk7CiAgICAgIGNvbmZpZy5ncm91cHMgPSBncm91cHM7CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGV4OwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoYFVuYWJsZSB0byByZWFkIG9wdGlvbmFsIGNvbnRlbnQgY29uZmlnOiAke2V4fWApOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAib3B0aW9uYWxDb250ZW50Q29uZmlnIiwgY29uZmlnKTsKICB9CgogIF9yZWFkT3B0aW9uYWxDb250ZW50Q29uZmlnKGNvbmZpZywgY29udGVudEdyb3VwUmVmcykgewogICAgZnVuY3Rpb24gcGFyc2VPbk9mZihyZWZzKSB7CiAgICAgIGNvbnN0IG9uUGFyc2VkID0gW107CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShyZWZzKSkgewogICAgICAgIGZvciAoY29uc3QgdmFsdWUgb2YgcmVmcykgewogICAgICAgICAgaWYgKCEodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjb250ZW50R3JvdXBSZWZzLmluY2x1ZGVzKHZhbHVlKSkgewogICAgICAgICAgICBvblBhcnNlZC5wdXNoKHZhbHVlLnRvU3RyaW5nKCkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG9uUGFyc2VkOwogICAgfQoKICAgIGZ1bmN0aW9uIHBhcnNlT3JkZXIocmVmcykgewogICAgICBsZXQgbmVzdGVkTGV2ZWxzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAwOwoKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHJlZnMpKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IG9yZGVyID0gW107CgogICAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIHJlZnMpIHsKICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYgJiYgY29udGVudEdyb3VwUmVmcy5pbmNsdWRlcyh2YWx1ZSkpIHsKICAgICAgICAgIHBhcnNlZE9yZGVyUmVmcy5wdXQodmFsdWUpOwogICAgICAgICAgb3JkZXIucHVzaCh2YWx1ZS50b1N0cmluZygpKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgbmVzdGVkT3JkZXIgPSBwYXJzZU5lc3RlZE9yZGVyKHZhbHVlLCBuZXN0ZWRMZXZlbHMpOwoKICAgICAgICBpZiAobmVzdGVkT3JkZXIpIHsKICAgICAgICAgIG9yZGVyLnB1c2gobmVzdGVkT3JkZXIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKG5lc3RlZExldmVscyA+IDApIHsKICAgICAgICByZXR1cm4gb3JkZXI7CiAgICAgIH0KCiAgICAgIGNvbnN0IGhpZGRlbkdyb3VwcyA9IFtdOwoKICAgICAgZm9yIChjb25zdCBncm91cFJlZiBvZiBjb250ZW50R3JvdXBSZWZzKSB7CiAgICAgICAgaWYgKHBhcnNlZE9yZGVyUmVmcy5oYXMoZ3JvdXBSZWYpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGhpZGRlbkdyb3Vwcy5wdXNoKGdyb3VwUmVmLnRvU3RyaW5nKCkpOwogICAgICB9CgogICAgICBpZiAoaGlkZGVuR3JvdXBzLmxlbmd0aCkgewogICAgICAgIG9yZGVyLnB1c2goewogICAgICAgICAgbmFtZTogbnVsbCwKICAgICAgICAgIG9yZGVyOiBoaWRkZW5Hcm91cHMKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIG9yZGVyOwogICAgfQoKICAgIGZ1bmN0aW9uIHBhcnNlTmVzdGVkT3JkZXIocmVmLCBuZXN0ZWRMZXZlbHMpIHsKICAgICAgaWYgKCsrbmVzdGVkTGV2ZWxzID4gTUFYX05FU1RFRF9MRVZFTFMpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoInBhcnNlTmVzdGVkT3JkZXIgLSByZWFjaGVkIE1BWF9ORVNURURfTEVWRUxTLiIpOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBjb25zdCB2YWx1ZSA9IHhyZWYuZmV0Y2hJZlJlZihyZWYpOwoKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBjb25zdCBuZXN0ZWROYW1lID0geHJlZi5mZXRjaElmUmVmKHZhbHVlWzBdKTsKCiAgICAgIGlmICh0eXBlb2YgbmVzdGVkTmFtZSAhPT0gInN0cmluZyIpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgY29uc3QgbmVzdGVkT3JkZXIgPSBwYXJzZU9yZGVyKHZhbHVlLnNsaWNlKDEpLCBuZXN0ZWRMZXZlbHMpOwoKICAgICAgaWYgKCFuZXN0ZWRPcmRlciB8fCAhbmVzdGVkT3JkZXIubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShuZXN0ZWROYW1lKSwKICAgICAgICBvcmRlcjogbmVzdGVkT3JkZXIKICAgICAgfTsKICAgIH0KCiAgICBjb25zdCB4cmVmID0gdGhpcy54cmVmLAogICAgICAgICAgcGFyc2VkT3JkZXJSZWZzID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpLAogICAgICAgICAgTUFYX05FU1RFRF9MRVZFTFMgPSAxMDsKICAgIHJldHVybiB7CiAgICAgIG5hbWU6IHR5cGVvZiBjb25maWcuZ2V0KCJOYW1lIikgPT09ICJzdHJpbmciID8gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShjb25maWcuZ2V0KCJOYW1lIikpIDogbnVsbCwKICAgICAgY3JlYXRvcjogdHlwZW9mIGNvbmZpZy5nZXQoIkNyZWF0b3IiKSA9PT0gInN0cmluZyIgPyAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGNvbmZpZy5nZXQoIkNyZWF0b3IiKSkgOiBudWxsLAogICAgICBiYXNlU3RhdGU6IGNvbmZpZy5nZXQoIkJhc2VTdGF0ZSIpIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IGNvbmZpZy5nZXQoIkJhc2VTdGF0ZSIpLm5hbWUgOiBudWxsLAogICAgICBvbjogcGFyc2VPbk9mZihjb25maWcuZ2V0KCJPTiIpKSwKICAgICAgb2ZmOiBwYXJzZU9uT2ZmKGNvbmZpZy5nZXQoIk9GRiIpKSwKICAgICAgb3JkZXI6IHBhcnNlT3JkZXIoY29uZmlnLmdldCgiT3JkZXIiKSksCiAgICAgIGdyb3VwczogbnVsbAogICAgfTsKICB9CgogIHNldEFjdHVhbE51bVBhZ2VzKCkgewogICAgbGV0IG51bSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbnVsbDsKICAgIHRoaXMuX2FjdHVhbE51bVBhZ2VzID0gbnVtOwogIH0KCiAgZ2V0IGhhc0FjdHVhbE51bVBhZ2VzKCkgewogICAgcmV0dXJuIHRoaXMuX2FjdHVhbE51bVBhZ2VzICE9PSBudWxsOwogIH0KCiAgZ2V0IF9wYWdlc0NvdW50KCkgewogICAgY29uc3Qgb2JqID0gdGhpcy50b3BsZXZlbFBhZ2VzRGljdC5nZXQoIkNvdW50Iik7CgogICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKG9iaikpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJQYWdlIGNvdW50IGluIHRvcC1sZXZlbCBwYWdlcyBkaWN0aW9uYXJ5IGlzIG5vdCBhbiBpbnRlZ2VyLiIpOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiX3BhZ2VzQ291bnQiLCBvYmopOwogIH0KCiAgZ2V0IG51bVBhZ2VzKCkgewogICAgcmV0dXJuIHRoaXMuaGFzQWN0dWFsTnVtUGFnZXMgPyB0aGlzLl9hY3R1YWxOdW1QYWdlcyA6IHRoaXMuX3BhZ2VzQ291bnQ7CiAgfQoKICBnZXQgZGVzdGluYXRpb25zKCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5fcmVhZERlc3RzKCksCiAgICAgICAgICBkZXN0cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9uYW1lX251bWJlcl90cmVlLk5hbWVUcmVlKSB7CiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIG9iai5nZXRBbGwoKSkgewogICAgICAgIGNvbnN0IGRlc3QgPSBmZXRjaERlc3RpbmF0aW9uKHZhbHVlKTsKCiAgICAgICAgaWYgKGRlc3QpIHsKICAgICAgICAgIGRlc3RzWygwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoa2V5KV0gPSBkZXN0OwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIG9iai5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgICAgY29uc3QgZGVzdCA9IGZldGNoRGVzdGluYXRpb24odmFsdWUpOwoKICAgICAgICBpZiAoZGVzdCkgewogICAgICAgICAgZGVzdHNba2V5XSA9IGRlc3Q7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImRlc3RpbmF0aW9ucyIsIGRlc3RzKTsKICB9CgogIGdldERlc3RpbmF0aW9uKGlkKSB7CiAgICBjb25zdCBvYmogPSB0aGlzLl9yZWFkRGVzdHMoKTsKCiAgICBpZiAob2JqIGluc3RhbmNlb2YgX25hbWVfbnVtYmVyX3RyZWUuTmFtZVRyZWUpIHsKICAgICAgY29uc3QgZGVzdCA9IGZldGNoRGVzdGluYXRpb24ob2JqLmdldChpZCkpOwoKICAgICAgaWYgKGRlc3QpIHsKICAgICAgICByZXR1cm4gZGVzdDsKICAgICAgfQoKICAgICAgY29uc3QgYWxsRGVzdCA9IHRoaXMuZGVzdGluYXRpb25zW2lkXTsKCiAgICAgIGlmIChhbGxEZXN0KSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBGb3VuZCAiJHtpZH0iIGF0IGFuIGluY29ycmVjdCBwb3NpdGlvbiBpbiB0aGUgTmFtZVRyZWUuYCk7CiAgICAgICAgcmV0dXJuIGFsbERlc3Q7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBjb25zdCBkZXN0ID0gZmV0Y2hEZXN0aW5hdGlvbihvYmouZ2V0KGlkKSk7CgogICAgICBpZiAoZGVzdCkgewogICAgICAgIHJldHVybiBkZXN0OwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBfcmVhZERlc3RzKCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIk5hbWVzIik7CgogICAgaWYgKG9iaiAmJiBvYmouaGFzKCJEZXN0cyIpKSB7CiAgICAgIHJldHVybiBuZXcgX25hbWVfbnVtYmVyX3RyZWUuTmFtZVRyZWUob2JqLmdldFJhdygiRGVzdHMiKSwgdGhpcy54cmVmKTsKICAgIH0gZWxzZSBpZiAodGhpcy5fY2F0RGljdC5oYXMoIkRlc3RzIikpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NhdERpY3QuZ2V0KCJEZXN0cyIpOwogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBnZXQgcGFnZUxhYmVscygpIHsKICAgIGxldCBvYmogPSBudWxsOwoKICAgIHRyeSB7CiAgICAgIG9iaiA9IHRoaXMuX3JlYWRQYWdlTGFiZWxzKCk7CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGV4OwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoIlVuYWJsZSB0byByZWFkIHBhZ2UgbGFiZWxzLiIpOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAicGFnZUxhYmVscyIsIG9iaik7CiAgfQoKICBfcmVhZFBhZ2VMYWJlbHMoKSB7CiAgICBjb25zdCBvYmogPSB0aGlzLl9jYXREaWN0LmdldFJhdygiUGFnZUxhYmVscyIpOwoKICAgIGlmICghb2JqKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHBhZ2VMYWJlbHMgPSBuZXcgQXJyYXkodGhpcy5udW1QYWdlcyk7CiAgICBsZXQgc3R5bGUgPSBudWxsLAogICAgICAgIHByZWZpeCA9ICIiOwogICAgY29uc3QgbnVtYmVyVHJlZSA9IG5ldyBfbmFtZV9udW1iZXJfdHJlZS5OdW1iZXJUcmVlKG9iaiwgdGhpcy54cmVmKTsKICAgIGNvbnN0IG51bXMgPSBudW1iZXJUcmVlLmdldEFsbCgpOwogICAgbGV0IGN1cnJlbnRMYWJlbCA9ICIiLAogICAgICAgIGN1cnJlbnRJbmRleCA9IDE7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdGhpcy5udW1QYWdlczsgaSA8IGlpOyBpKyspIHsKICAgICAgY29uc3QgbGFiZWxEaWN0ID0gbnVtcy5nZXQoaSk7CgogICAgICBpZiAobGFiZWxEaWN0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBpZiAoIShsYWJlbERpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJQYWdlTGFiZWwgaXMgbm90IGEgZGljdGlvbmFyeS4iKTsKICAgICAgICB9CgogICAgICAgIGlmIChsYWJlbERpY3QuaGFzKCJUeXBlIikgJiYgISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGxhYmVsRGljdC5nZXQoIlR5cGUiKSwgIlBhZ2VMYWJlbCIpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgdHlwZSBpbiBQYWdlTGFiZWwgZGljdGlvbmFyeS4iKTsKICAgICAgICB9CgogICAgICAgIGlmIChsYWJlbERpY3QuaGFzKCJTIikpIHsKICAgICAgICAgIGNvbnN0IHMgPSBsYWJlbERpY3QuZ2V0KCJTIik7CgogICAgICAgICAgaWYgKCEocyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBzdHlsZSBpbiBQYWdlTGFiZWwgZGljdGlvbmFyeS4iKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdHlsZSA9IHMubmFtZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3R5bGUgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgaWYgKGxhYmVsRGljdC5oYXMoIlAiKSkgewogICAgICAgICAgY29uc3QgcCA9IGxhYmVsRGljdC5nZXQoIlAiKTsKCiAgICAgICAgICBpZiAodHlwZW9mIHAgIT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBwcmVmaXggaW4gUGFnZUxhYmVsIGRpY3Rpb25hcnkuIik7CiAgICAgICAgICB9CgogICAgICAgICAgcHJlZml4ID0gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcHJlZml4ID0gIiI7CiAgICAgICAgfQoKICAgICAgICBpZiAobGFiZWxEaWN0LmhhcygiU3QiKSkgewogICAgICAgICAgY29uc3Qgc3QgPSBsYWJlbERpY3QuZ2V0KCJTdCIpOwoKICAgICAgICAgIGlmICghKE51bWJlci5pc0ludGVnZXIoc3QpICYmIHN0ID49IDEpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBzdGFydCBpbiBQYWdlTGFiZWwgZGljdGlvbmFyeS4iKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjdXJyZW50SW5kZXggPSBzdDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3VycmVudEluZGV4ID0gMTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHN3aXRjaCAoc3R5bGUpIHsKICAgICAgICBjYXNlICJEIjoKICAgICAgICAgIGN1cnJlbnRMYWJlbCA9IGN1cnJlbnRJbmRleDsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJSIjoKICAgICAgICBjYXNlICJyIjoKICAgICAgICAgIGN1cnJlbnRMYWJlbCA9ICgwLCBfY29yZV91dGlscy50b1JvbWFuTnVtZXJhbHMpKGN1cnJlbnRJbmRleCwgc3R5bGUgPT09ICJyIik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiQSI6CiAgICAgICAgY2FzZSAiYSI6CiAgICAgICAgICBjb25zdCBMSU1JVCA9IDI2OwogICAgICAgICAgY29uc3QgQV9VUFBFUl9DQVNFID0gMHg0MSwKICAgICAgICAgICAgICAgIEFfTE9XRVJfQ0FTRSA9IDB4NjE7CiAgICAgICAgICBjb25zdCBiYXNlQ2hhckNvZGUgPSBzdHlsZSA9PT0gImEiID8gQV9MT1dFUl9DQVNFIDogQV9VUFBFUl9DQVNFOwogICAgICAgICAgY29uc3QgbGV0dGVySW5kZXggPSBjdXJyZW50SW5kZXggLSAxOwogICAgICAgICAgY29uc3QgY2hhcmFjdGVyID0gU3RyaW5nLmZyb21DaGFyQ29kZShiYXNlQ2hhckNvZGUgKyBsZXR0ZXJJbmRleCAlIExJTUlUKTsKICAgICAgICAgIGN1cnJlbnRMYWJlbCA9IGNoYXJhY3Rlci5yZXBlYXQoTWF0aC5mbG9vcihsZXR0ZXJJbmRleCAvIExJTUlUKSArIDEpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBpZiAoc3R5bGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBJbnZhbGlkIHN0eWxlICIke3N0eWxlfSIgaW4gUGFnZUxhYmVsIGRpY3Rpb25hcnkuYCk7CiAgICAgICAgICB9CgogICAgICAgICAgY3VycmVudExhYmVsID0gIiI7CiAgICAgIH0KCiAgICAgIHBhZ2VMYWJlbHNbaV0gPSBwcmVmaXggKyBjdXJyZW50TGFiZWw7CiAgICAgIGN1cnJlbnRJbmRleCsrOwogICAgfQoKICAgIHJldHVybiBwYWdlTGFiZWxzOwogIH0KCiAgZ2V0IHBhZ2VMYXlvdXQoKSB7CiAgICBjb25zdCBvYmogPSB0aGlzLl9jYXREaWN0LmdldCgiUGFnZUxheW91dCIpOwoKICAgIGxldCBwYWdlTGF5b3V0ID0gIiI7CgogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgc3dpdGNoIChvYmoubmFtZSkgewogICAgICAgIGNhc2UgIlNpbmdsZVBhZ2UiOgogICAgICAgIGNhc2UgIk9uZUNvbHVtbiI6CiAgICAgICAgY2FzZSAiVHdvQ29sdW1uTGVmdCI6CiAgICAgICAgY2FzZSAiVHdvQ29sdW1uUmlnaHQiOgogICAgICAgIGNhc2UgIlR3b1BhZ2VMZWZ0IjoKICAgICAgICBjYXNlICJUd29QYWdlUmlnaHQiOgogICAgICAgICAgcGFnZUxheW91dCA9IG9iai5uYW1lOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJwYWdlTGF5b3V0IiwgcGFnZUxheW91dCk7CiAgfQoKICBnZXQgcGFnZU1vZGUoKSB7CiAgICBjb25zdCBvYmogPSB0aGlzLl9jYXREaWN0LmdldCgiUGFnZU1vZGUiKTsKCiAgICBsZXQgcGFnZU1vZGUgPSAiVXNlTm9uZSI7CgogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgc3dpdGNoIChvYmoubmFtZSkgewogICAgICAgIGNhc2UgIlVzZU5vbmUiOgogICAgICAgIGNhc2UgIlVzZU91dGxpbmVzIjoKICAgICAgICBjYXNlICJVc2VUaHVtYnMiOgogICAgICAgIGNhc2UgIkZ1bGxTY3JlZW4iOgogICAgICAgIGNhc2UgIlVzZU9DIjoKICAgICAgICBjYXNlICJVc2VBdHRhY2htZW50cyI6CiAgICAgICAgICBwYWdlTW9kZSA9IG9iai5uYW1lOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJwYWdlTW9kZSIsIHBhZ2VNb2RlKTsKICB9CgogIGdldCB2aWV3ZXJQcmVmZXJlbmNlcygpIHsKICAgIGNvbnN0IG9iaiA9IHRoaXMuX2NhdERpY3QuZ2V0KCJWaWV3ZXJQcmVmZXJlbmNlcyIpOwoKICAgIGlmICghKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAidmlld2VyUHJlZmVyZW5jZXMiLCBudWxsKTsKICAgIH0KCiAgICBsZXQgcHJlZnMgPSBudWxsOwoKICAgIGZvciAoY29uc3Qga2V5IG9mIG9iai5nZXRLZXlzKCkpIHsKICAgICAgY29uc3QgdmFsdWUgPSBvYmouZ2V0KGtleSk7CiAgICAgIGxldCBwcmVmVmFsdWU7CgogICAgICBzd2l0Y2ggKGtleSkgewogICAgICAgIGNhc2UgIkhpZGVUb29sYmFyIjoKICAgICAgICBjYXNlICJIaWRlTWVudWJhciI6CiAgICAgICAgY2FzZSAiSGlkZVdpbmRvd1VJIjoKICAgICAgICBjYXNlICJGaXRXaW5kb3ciOgogICAgICAgIGNhc2UgIkNlbnRlcldpbmRvdyI6CiAgICAgICAgY2FzZSAiRGlzcGxheURvY1RpdGxlIjoKICAgICAgICBjYXNlICJQaWNrVHJheUJ5UERGU2l6ZSI6CiAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAiYm9vbGVhbiIpIHsKICAgICAgICAgICAgcHJlZlZhbHVlID0gdmFsdWU7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIk5vbkZ1bGxTY3JlZW5QYWdlTW9kZSI6CiAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgIHN3aXRjaCAodmFsdWUubmFtZSkgewogICAgICAgICAgICAgIGNhc2UgIlVzZU5vbmUiOgogICAgICAgICAgICAgIGNhc2UgIlVzZU91dGxpbmVzIjoKICAgICAgICAgICAgICBjYXNlICJVc2VUaHVtYnMiOgogICAgICAgICAgICAgIGNhc2UgIlVzZU9DIjoKICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9IHZhbHVlLm5hbWU7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9ICJVc2VOb25lIjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJEaXJlY3Rpb24iOgogICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICBzd2l0Y2ggKHZhbHVlLm5hbWUpIHsKICAgICAgICAgICAgICBjYXNlICJMMlIiOgogICAgICAgICAgICAgIGNhc2UgIlIyTCI6CiAgICAgICAgICAgICAgICBwcmVmVmFsdWUgPSB2YWx1ZS5uYW1lOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBwcmVmVmFsdWUgPSAiTDJSIjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJWaWV3QXJlYSI6CiAgICAgICAgY2FzZSAiVmlld0NsaXAiOgogICAgICAgIGNhc2UgIlByaW50QXJlYSI6CiAgICAgICAgY2FzZSAiUHJpbnRDbGlwIjoKICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgICAgc3dpdGNoICh2YWx1ZS5uYW1lKSB7CiAgICAgICAgICAgICAgY2FzZSAiTWVkaWFCb3giOgogICAgICAgICAgICAgIGNhc2UgIkNyb3BCb3giOgogICAgICAgICAgICAgIGNhc2UgIkJsZWVkQm94IjoKICAgICAgICAgICAgICBjYXNlICJUcmltQm94IjoKICAgICAgICAgICAgICBjYXNlICJBcnRCb3giOgogICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gdmFsdWUubmFtZTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gIkNyb3BCb3giOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlByaW50U2NhbGluZyI6CiAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgIHN3aXRjaCAodmFsdWUubmFtZSkgewogICAgICAgICAgICAgIGNhc2UgIk5vbmUiOgogICAgICAgICAgICAgIGNhc2UgIkFwcERlZmF1bHQiOgogICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gdmFsdWUubmFtZTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gIkFwcERlZmF1bHQiOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIkR1cGxleCI6CiAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgIHN3aXRjaCAodmFsdWUubmFtZSkgewogICAgICAgICAgICAgIGNhc2UgIlNpbXBsZXgiOgogICAgICAgICAgICAgIGNhc2UgIkR1cGxleEZsaXBTaG9ydEVkZ2UiOgogICAgICAgICAgICAgIGNhc2UgIkR1cGxleEZsaXBMb25nRWRnZSI6CiAgICAgICAgICAgICAgICBwcmVmVmFsdWUgPSB2YWx1ZS5uYW1lOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBwcmVmVmFsdWUgPSAiTm9uZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiUHJpbnRQYWdlUmFuZ2UiOgogICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCAlIDIgPT09IDApIHsKICAgICAgICAgICAgY29uc3QgaXNWYWxpZCA9IHZhbHVlLmV2ZXJ5KChwYWdlLCBpLCBhcnIpID0+IHsKICAgICAgICAgICAgICByZXR1cm4gTnVtYmVyLmlzSW50ZWdlcihwYWdlKSAmJiBwYWdlID4gMCAmJiAoaSA9PT0gMCB8fCBwYWdlID49IGFycltpIC0gMV0pICYmIHBhZ2UgPD0gdGhpcy5udW1QYWdlczsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAoaXNWYWxpZCkgewogICAgICAgICAgICAgIHByZWZWYWx1ZSA9IHZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIk51bUNvcGllcyI6CiAgICAgICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSkgJiYgdmFsdWUgPiAwKSB7CiAgICAgICAgICAgIHByZWZWYWx1ZSA9IHZhbHVlOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBJZ25vcmluZyBub24tc3RhbmRhcmQga2V5IGluIFZpZXdlclByZWZlcmVuY2VzOiAke2tleX0uYCk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKHByZWZWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBCYWQgdmFsdWUsIGZvciBrZXkgIiR7a2V5fSIsIGluIFZpZXdlclByZWZlcmVuY2VzOiAke3ZhbHVlfS5gKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKCFwcmVmcykgewogICAgICAgIHByZWZzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgfQoKICAgICAgcHJlZnNba2V5XSA9IHByZWZWYWx1ZTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInZpZXdlclByZWZlcmVuY2VzIiwgcHJlZnMpOwogIH0KCiAgZ2V0IG9wZW5BY3Rpb24oKSB7CiAgICBjb25zdCBvYmogPSB0aGlzLl9jYXREaWN0LmdldCgiT3BlbkFjdGlvbiIpOwoKICAgIGNvbnN0IG9wZW5BY3Rpb24gPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIGNvbnN0IGRlc3REaWN0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QodGhpcy54cmVmKTsKICAgICAgZGVzdERpY3Quc2V0KCJBIiwgb2JqKTsKICAgICAgY29uc3QgcmVzdWx0T2JqID0gewogICAgICAgIHVybDogbnVsbCwKICAgICAgICBkZXN0OiBudWxsLAogICAgICAgIGFjdGlvbjogbnVsbAogICAgICB9OwogICAgICBDYXRhbG9nLnBhcnNlRGVzdERpY3Rpb25hcnkoewogICAgICAgIGRlc3REaWN0LAogICAgICAgIHJlc3VsdE9iagogICAgICB9KTsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlc3VsdE9iai5kZXN0KSkgewogICAgICAgIG9wZW5BY3Rpb24uZGVzdCA9IHJlc3VsdE9iai5kZXN0OwogICAgICB9IGVsc2UgaWYgKHJlc3VsdE9iai5hY3Rpb24pIHsKICAgICAgICBvcGVuQWN0aW9uLmFjdGlvbiA9IHJlc3VsdE9iai5hY3Rpb247CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7CiAgICAgIG9wZW5BY3Rpb24uZGVzdCA9IG9iajsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIm9wZW5BY3Rpb24iLCAoMCwgX3V0aWwub2JqZWN0U2l6ZSkob3BlbkFjdGlvbikgPiAwID8gb3BlbkFjdGlvbiA6IG51bGwpOwogIH0KCiAgZ2V0IGF0dGFjaG1lbnRzKCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIk5hbWVzIik7CgogICAgbGV0IGF0dGFjaG1lbnRzID0gbnVsbDsKCiAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiBvYmouaGFzKCJFbWJlZGRlZEZpbGVzIikpIHsKICAgICAgY29uc3QgbmFtZVRyZWUgPSBuZXcgX25hbWVfbnVtYmVyX3RyZWUuTmFtZVRyZWUob2JqLmdldFJhdygiRW1iZWRkZWRGaWxlcyIpLCB0aGlzLnhyZWYpOwoKICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgbmFtZVRyZWUuZ2V0QWxsKCkpIHsKICAgICAgICBjb25zdCBmcyA9IG5ldyBfZmlsZV9zcGVjLkZpbGVTcGVjKHZhbHVlLCB0aGlzLnhyZWYpOwoKICAgICAgICBpZiAoIWF0dGFjaG1lbnRzKSB7CiAgICAgICAgICBhdHRhY2htZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgfQoKICAgICAgICBhdHRhY2htZW50c1soMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGtleSldID0gZnMuc2VyaWFsaXphYmxlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJhdHRhY2htZW50cyIsIGF0dGFjaG1lbnRzKTsKICB9CgogIGdldCB4ZmFJbWFnZXMoKSB7CiAgICBjb25zdCBvYmogPSB0aGlzLl9jYXREaWN0LmdldCgiTmFtZXMiKTsKCiAgICBsZXQgeGZhSW1hZ2VzID0gbnVsbDsKCiAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiBvYmouaGFzKCJYRkFJbWFnZXMiKSkgewogICAgICBjb25zdCBuYW1lVHJlZSA9IG5ldyBfbmFtZV9udW1iZXJfdHJlZS5OYW1lVHJlZShvYmouZ2V0UmF3KCJYRkFJbWFnZXMiKSwgdGhpcy54cmVmKTsKCiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIG5hbWVUcmVlLmdldEFsbCgpKSB7CiAgICAgICAgaWYgKCF4ZmFJbWFnZXMpIHsKICAgICAgICAgIHhmYUltYWdlcyA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHRoaXMueHJlZik7CiAgICAgICAgfQoKICAgICAgICB4ZmFJbWFnZXMuc2V0KCgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoa2V5KSwgdmFsdWUpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ4ZmFJbWFnZXMiLCB4ZmFJbWFnZXMpOwogIH0KCiAgX2NvbGxlY3RKYXZhU2NyaXB0KCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIk5hbWVzIik7CgogICAgbGV0IGphdmFTY3JpcHQgPSBudWxsOwoKICAgIGZ1bmN0aW9uIGFwcGVuZElmSmF2YVNjcmlwdERpY3QobmFtZSwganNEaWN0KSB7CiAgICAgIGlmICghKGpzRGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGpzRGljdC5nZXQoIlMiKSwgIkphdmFTY3JpcHQiKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgbGV0IGpzID0ganNEaWN0LmdldCgiSlMiKTsKCiAgICAgIGlmIChqcyBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgICAganMgPSBqcy5nZXRTdHJpbmcoKTsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YganMgIT09ICJzdHJpbmciKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoamF2YVNjcmlwdCA9PT0gbnVsbCkgewogICAgICAgIGphdmFTY3JpcHQgPSBuZXcgTWFwKCk7CiAgICAgIH0KCiAgICAgIGpzID0gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShqcykucmVwbGFjZSgvXHUwMDAwL2csICIiKTsKICAgICAgamF2YVNjcmlwdC5zZXQobmFtZSwganMpOwogICAgfQoKICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ICYmIG9iai5oYXMoIkphdmFTY3JpcHQiKSkgewogICAgICBjb25zdCBuYW1lVHJlZSA9IG5ldyBfbmFtZV9udW1iZXJfdHJlZS5OYW1lVHJlZShvYmouZ2V0UmF3KCJKYXZhU2NyaXB0IiksIHRoaXMueHJlZik7CgogICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBuYW1lVHJlZS5nZXRBbGwoKSkgewogICAgICAgIGFwcGVuZElmSmF2YVNjcmlwdERpY3QoKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShrZXkpLCB2YWx1ZSk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBvcGVuQWN0aW9uID0gdGhpcy5fY2F0RGljdC5nZXQoIk9wZW5BY3Rpb24iKTsKCiAgICBpZiAob3BlbkFjdGlvbikgewogICAgICBhcHBlbmRJZkphdmFTY3JpcHREaWN0KCJPcGVuQWN0aW9uIiwgb3BlbkFjdGlvbik7CiAgICB9CgogICAgcmV0dXJuIGphdmFTY3JpcHQ7CiAgfQoKICBnZXQgamF2YVNjcmlwdCgpIHsKICAgIGNvbnN0IGphdmFTY3JpcHQgPSB0aGlzLl9jb2xsZWN0SmF2YVNjcmlwdCgpOwoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiamF2YVNjcmlwdCIsIGphdmFTY3JpcHQgPyBbLi4uamF2YVNjcmlwdC52YWx1ZXMoKV0gOiBudWxsKTsKICB9CgogIGdldCBqc0FjdGlvbnMoKSB7CiAgICBjb25zdCBqYXZhU2NyaXB0ID0gdGhpcy5fY29sbGVjdEphdmFTY3JpcHQoKTsKCiAgICBsZXQgYWN0aW9ucyA9ICgwLCBfY29yZV91dGlscy5jb2xsZWN0QWN0aW9ucykodGhpcy54cmVmLCB0aGlzLl9jYXREaWN0LCBfdXRpbC5Eb2N1bWVudEFjdGlvbkV2ZW50VHlwZSk7CgogICAgaWYgKGphdmFTY3JpcHQpIHsKICAgICAgaWYgKCFhY3Rpb25zKSB7CiAgICAgICAgYWN0aW9ucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgIH0KCiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsXSBvZiBqYXZhU2NyaXB0KSB7CiAgICAgICAgaWYgKGtleSBpbiBhY3Rpb25zKSB7CiAgICAgICAgICBhY3Rpb25zW2tleV0ucHVzaCh2YWwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhY3Rpb25zW2tleV0gPSBbdmFsXTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImpzQWN0aW9ucyIsIGFjdGlvbnMpOwogIH0KCiAgYXN5bmMgZm9udEZhbGxiYWNrKGlkLCBoYW5kbGVyKSB7CiAgICBjb25zdCB0cmFuc2xhdGVkRm9udHMgPSBhd2FpdCBQcm9taXNlLmFsbCh0aGlzLmZvbnRDYWNoZSk7CgogICAgZm9yIChjb25zdCB0cmFuc2xhdGVkRm9udCBvZiB0cmFuc2xhdGVkRm9udHMpIHsKICAgICAgaWYgKHRyYW5zbGF0ZWRGb250LmxvYWRlZE5hbWUgPT09IGlkKSB7CiAgICAgICAgdHJhbnNsYXRlZEZvbnQuZmFsbGJhY2soaGFuZGxlcik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgfQoKICBhc3luYyBjbGVhbnVwKCkgewogICAgbGV0IG1hbnVhbGx5VHJpZ2dlcmVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgICgwLCBfY2xlYW51cF9oZWxwZXIuY2xlYXJHbG9iYWxDYWNoZXMpKCk7CiAgICB0aGlzLmdsb2JhbEltYWdlQ2FjaGUuY2xlYXIobWFudWFsbHlUcmlnZ2VyZWQpOwogICAgdGhpcy5wYWdlS2lkc0NvdW50Q2FjaGUuY2xlYXIoKTsKICAgIHRoaXMucGFnZUluZGV4Q2FjaGUuY2xlYXIoKTsKICAgIHRoaXMubm9uQmxlbmRNb2Rlc1NldC5jbGVhcigpOwogICAgY29uc3QgdHJhbnNsYXRlZEZvbnRzID0gYXdhaXQgUHJvbWlzZS5hbGwodGhpcy5mb250Q2FjaGUpOwoKICAgIGZvciAoY29uc3QgewogICAgICBkaWN0CiAgICB9IG9mIHRyYW5zbGF0ZWRGb250cykgewogICAgICBkZWxldGUgZGljdC5jYWNoZUtleTsKICAgIH0KCiAgICB0aGlzLmZvbnRDYWNoZS5jbGVhcigpOwogICAgdGhpcy5idWlsdEluQ01hcENhY2hlLmNsZWFyKCk7CiAgICB0aGlzLnN0YW5kYXJkRm9udERhdGFDYWNoZS5jbGVhcigpOwogIH0KCiAgYXN5bmMgZ2V0UGFnZURpY3QocGFnZUluZGV4KSB7CiAgICBjb25zdCBub2Rlc1RvVmlzaXQgPSBbdGhpcy50b3BsZXZlbFBhZ2VzRGljdF07CiAgICBjb25zdCB2aXNpdGVkTm9kZXMgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KCk7CgogICAgY29uc3QgcGFnZXNSZWYgPSB0aGlzLl9jYXREaWN0LmdldFJhdygiUGFnZXMiKTsKCiAgICBpZiAocGFnZXNSZWYgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgdmlzaXRlZE5vZGVzLnB1dChwYWdlc1JlZik7CiAgICB9CgogICAgY29uc3QgeHJlZiA9IHRoaXMueHJlZiwKICAgICAgICAgIHBhZ2VLaWRzQ291bnRDYWNoZSA9IHRoaXMucGFnZUtpZHNDb3VudENhY2hlLAogICAgICAgICAgcGFnZUluZGV4Q2FjaGUgPSB0aGlzLnBhZ2VJbmRleENhY2hlOwogICAgbGV0IGN1cnJlbnRQYWdlSW5kZXggPSAwOwoKICAgIHdoaWxlIChub2Rlc1RvVmlzaXQubGVuZ3RoKSB7CiAgICAgIGNvbnN0IGN1cnJlbnROb2RlID0gbm9kZXNUb1Zpc2l0LnBvcCgpOwoKICAgICAgaWYgKGN1cnJlbnROb2RlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgY29uc3QgY291bnQgPSBwYWdlS2lkc0NvdW50Q2FjaGUuZ2V0KGN1cnJlbnROb2RlKTsKCiAgICAgICAgaWYgKGNvdW50ID49IDAgJiYgY3VycmVudFBhZ2VJbmRleCArIGNvdW50IDw9IHBhZ2VJbmRleCkgewogICAgICAgICAgY3VycmVudFBhZ2VJbmRleCArPSBjb3VudDsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHZpc2l0ZWROb2Rlcy5oYXMoY3VycmVudE5vZGUpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlBhZ2VzIHRyZWUgY29udGFpbnMgY2lyY3VsYXIgcmVmZXJlbmNlLiIpOwogICAgICAgIH0KCiAgICAgICAgdmlzaXRlZE5vZGVzLnB1dChjdXJyZW50Tm9kZSk7CiAgICAgICAgY29uc3Qgb2JqID0gYXdhaXQgeHJlZi5mZXRjaEFzeW5jKGN1cnJlbnROb2RlKTsKCiAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICAgIGxldCB0eXBlID0gb2JqLmdldFJhdygiVHlwZSIpOwoKICAgICAgICAgIGlmICh0eXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICAgIHR5cGUgPSBhd2FpdCB4cmVmLmZldGNoQXN5bmModHlwZSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHR5cGUsICJQYWdlIikgfHwgIW9iai5oYXMoIktpZHMiKSkgewogICAgICAgICAgICBpZiAoIXBhZ2VLaWRzQ291bnRDYWNoZS5oYXMoY3VycmVudE5vZGUpKSB7CiAgICAgICAgICAgICAgcGFnZUtpZHNDb3VudENhY2hlLnB1dChjdXJyZW50Tm9kZSwgMSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICghcGFnZUluZGV4Q2FjaGUuaGFzKGN1cnJlbnROb2RlKSkgewogICAgICAgICAgICAgIHBhZ2VJbmRleENhY2hlLnB1dChjdXJyZW50Tm9kZSwgY3VycmVudFBhZ2VJbmRleCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChjdXJyZW50UGFnZUluZGV4ID09PSBwYWdlSW5kZXgpIHsKICAgICAgICAgICAgICByZXR1cm4gW29iaiwgY3VycmVudE5vZGVdOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjdXJyZW50UGFnZUluZGV4Kys7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbm9kZXNUb1Zpc2l0LnB1c2gob2JqKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKCEoY3VycmVudE5vZGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUGFnZSBkaWN0aW9uYXJ5IGtpZCByZWZlcmVuY2UgcG9pbnRzIHRvIHdyb25nIHR5cGUgb2Ygb2JqZWN0LiIpOwogICAgICB9CgogICAgICBjb25zdCB7CiAgICAgICAgb2JqSWQKICAgICAgfSA9IGN1cnJlbnROb2RlOwogICAgICBsZXQgY291bnQgPSBjdXJyZW50Tm9kZS5nZXRSYXcoIkNvdW50Iik7CgogICAgICBpZiAoY291bnQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICBjb3VudCA9IGF3YWl0IHhyZWYuZmV0Y2hBc3luYyhjb3VudCk7CiAgICAgIH0KCiAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKGNvdW50KSAmJiBjb3VudCA+PSAwKSB7CiAgICAgICAgaWYgKG9iaklkICYmICFwYWdlS2lkc0NvdW50Q2FjaGUuaGFzKG9iaklkKSkgewogICAgICAgICAgcGFnZUtpZHNDb3VudENhY2hlLnB1dChvYmpJZCwgY291bnQpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGN1cnJlbnRQYWdlSW5kZXggKyBjb3VudCA8PSBwYWdlSW5kZXgpIHsKICAgICAgICAgIGN1cnJlbnRQYWdlSW5kZXggKz0gY291bnQ7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGxldCBraWRzID0gY3VycmVudE5vZGUuZ2V0UmF3KCJLaWRzIik7CgogICAgICBpZiAoa2lkcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgIGtpZHMgPSBhd2FpdCB4cmVmLmZldGNoQXN5bmMoa2lkcyk7CiAgICAgIH0KCiAgICAgIGlmICghQXJyYXkuaXNBcnJheShraWRzKSkgewogICAgICAgIGxldCB0eXBlID0gY3VycmVudE5vZGUuZ2V0UmF3KCJUeXBlIik7CgogICAgICAgIGlmICh0eXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICB0eXBlID0gYXdhaXQgeHJlZi5mZXRjaEFzeW5jKHR5cGUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHR5cGUsICJQYWdlIikgfHwgIWN1cnJlbnROb2RlLmhhcygiS2lkcyIpKSB7CiAgICAgICAgICBpZiAoY3VycmVudFBhZ2VJbmRleCA9PT0gcGFnZUluZGV4KSB7CiAgICAgICAgICAgIHJldHVybiBbY3VycmVudE5vZGUsIG51bGxdOwogICAgICAgICAgfQoKICAgICAgICAgIGN1cnJlbnRQYWdlSW5kZXgrKzsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJQYWdlIGRpY3Rpb25hcnkga2lkcyBvYmplY3QgaXMgbm90IGFuIGFycmF5LiIpOwogICAgICB9CgogICAgICBmb3IgKGxldCBsYXN0ID0ga2lkcy5sZW5ndGggLSAxOyBsYXN0ID49IDA7IGxhc3QtLSkgewogICAgICAgIG5vZGVzVG9WaXNpdC5wdXNoKGtpZHNbbGFzdF0pOwogICAgICB9CiAgICB9CgogICAgdGhyb3cgbmV3IEVycm9yKGBQYWdlIGluZGV4ICR7cGFnZUluZGV4fSBub3QgZm91bmQuYCk7CiAgfQoKICBhc3luYyBnZXRBbGxQYWdlRGljdHMoKSB7CiAgICBsZXQgcmVjb3ZlcnlNb2RlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgIGNvbnN0IHF1ZXVlID0gW3sKICAgICAgY3VycmVudE5vZGU6IHRoaXMudG9wbGV2ZWxQYWdlc0RpY3QsCiAgICAgIHBvc0luS2lkczogMAogICAgfV07CiAgICBjb25zdCB2aXNpdGVkTm9kZXMgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KCk7CgogICAgY29uc3QgcGFnZXNSZWYgPSB0aGlzLl9jYXREaWN0LmdldFJhdygiUGFnZXMiKTsKCiAgICBpZiAocGFnZXNSZWYgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgdmlzaXRlZE5vZGVzLnB1dChwYWdlc1JlZik7CiAgICB9CgogICAgY29uc3QgbWFwID0gbmV3IE1hcCgpLAogICAgICAgICAgeHJlZiA9IHRoaXMueHJlZiwKICAgICAgICAgIHBhZ2VJbmRleENhY2hlID0gdGhpcy5wYWdlSW5kZXhDYWNoZTsKICAgIGxldCBwYWdlSW5kZXggPSAwOwoKICAgIGZ1bmN0aW9uIGFkZFBhZ2VEaWN0KHBhZ2VEaWN0LCBwYWdlUmVmKSB7CiAgICAgIGlmIChwYWdlUmVmICYmICFwYWdlSW5kZXhDYWNoZS5oYXMocGFnZVJlZikpIHsKICAgICAgICBwYWdlSW5kZXhDYWNoZS5wdXQocGFnZVJlZiwgcGFnZUluZGV4KTsKICAgICAgfQoKICAgICAgbWFwLnNldChwYWdlSW5kZXgrKywgW3BhZ2VEaWN0LCBwYWdlUmVmXSk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkUGFnZUVycm9yKGVycm9yKSB7CiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLlhSZWZFbnRyeUV4Y2VwdGlvbiAmJiAhcmVjb3ZlcnlNb2RlKSB7CiAgICAgICAgdGhyb3cgZXJyb3I7CiAgICAgIH0KCiAgICAgIG1hcC5zZXQocGFnZUluZGV4KyssIFtlcnJvciwgbnVsbF0pOwogICAgfQoKICAgIHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwKSB7CiAgICAgIGNvbnN0IHF1ZXVlSXRlbSA9IHF1ZXVlLmF0KC0xKTsKICAgICAgY29uc3QgewogICAgICAgIGN1cnJlbnROb2RlLAogICAgICAgIHBvc0luS2lkcwogICAgICB9ID0gcXVldWVJdGVtOwogICAgICBsZXQga2lkcyA9IGN1cnJlbnROb2RlLmdldFJhdygiS2lkcyIpOwoKICAgICAgaWYgKGtpZHMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICB0cnkgewogICAgICAgICAga2lkcyA9IGF3YWl0IHhyZWYuZmV0Y2hBc3luYyhraWRzKTsKICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgYWRkUGFnZUVycm9yKGV4KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGtpZHMpKSB7CiAgICAgICAgYWRkUGFnZUVycm9yKG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUGFnZSBkaWN0aW9uYXJ5IGtpZHMgb2JqZWN0IGlzIG5vdCBhbiBhcnJheS4iKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmIChwb3NJbktpZHMgPj0ga2lkcy5sZW5ndGgpIHsKICAgICAgICBxdWV1ZS5wb3AoKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3Qga2lkT2JqID0ga2lkc1twb3NJbktpZHNdOwogICAgICBsZXQgb2JqOwoKICAgICAgaWYgKGtpZE9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgIGlmICh2aXNpdGVkTm9kZXMuaGFzKGtpZE9iaikpIHsKICAgICAgICAgIGFkZFBhZ2VFcnJvcihuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlBhZ2VzIHRyZWUgY29udGFpbnMgY2lyY3VsYXIgcmVmZXJlbmNlLiIpKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgdmlzaXRlZE5vZGVzLnB1dChraWRPYmopOwoKICAgICAgICB0cnkgewogICAgICAgICAgb2JqID0gYXdhaXQgeHJlZi5mZXRjaEFzeW5jKGtpZE9iaik7CiAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgIGFkZFBhZ2VFcnJvcihleCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb2JqID0ga2lkT2JqOwogICAgICB9CgogICAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgIGFkZFBhZ2VFcnJvcihuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlBhZ2UgZGljdGlvbmFyeSBraWQgcmVmZXJlbmNlIHBvaW50cyB0byB3cm9uZyB0eXBlIG9mIG9iamVjdC4iKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGxldCB0eXBlID0gb2JqLmdldFJhdygiVHlwZSIpOwoKICAgICAgaWYgKHR5cGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICB0cnkgewogICAgICAgICAgdHlwZSA9IGF3YWl0IHhyZWYuZmV0Y2hBc3luYyh0eXBlKTsKICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgYWRkUGFnZUVycm9yKGV4KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHR5cGUsICJQYWdlIikgfHwgIW9iai5oYXMoIktpZHMiKSkgewogICAgICAgIGFkZFBhZ2VEaWN0KG9iaiwga2lkT2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmID8ga2lkT2JqIDogbnVsbCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcXVldWUucHVzaCh7CiAgICAgICAgICBjdXJyZW50Tm9kZTogb2JqLAogICAgICAgICAgcG9zSW5LaWRzOiAwCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHF1ZXVlSXRlbS5wb3NJbktpZHMrKzsKICAgIH0KCiAgICByZXR1cm4gbWFwOwogIH0KCiAgZ2V0UGFnZUluZGV4KHBhZ2VSZWYpIHsKICAgIGNvbnN0IGNhY2hlZFBhZ2VJbmRleCA9IHRoaXMucGFnZUluZGV4Q2FjaGUuZ2V0KHBhZ2VSZWYpOwoKICAgIGlmIChjYWNoZWRQYWdlSW5kZXggIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNhY2hlZFBhZ2VJbmRleCk7CiAgICB9CgogICAgY29uc3QgeHJlZiA9IHRoaXMueHJlZjsKCiAgICBmdW5jdGlvbiBwYWdlc0JlZm9yZVJlZihraWRSZWYpIHsKICAgICAgbGV0IHRvdGFsID0gMCwKICAgICAgICAgIHBhcmVudFJlZjsKICAgICAgcmV0dXJuIHhyZWYuZmV0Y2hBc3luYyhraWRSZWYpLnRoZW4oZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzUmVmc0VxdWFsKShraWRSZWYsIHBhZ2VSZWYpICYmICEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShub2RlLCAiUGFnZSIpICYmICEobm9kZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgJiYgIW5vZGUuaGFzKCJUeXBlIikgJiYgbm9kZS5oYXMoIkNvbnRlbnRzIikpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlRoZSByZWZlcmVuY2UgZG9lcyBub3QgcG9pbnQgdG8gYSAvUGFnZSBkaWN0aW9uYXJ5LiIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFub2RlKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIGlmICghKG5vZGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJOb2RlIG11c3QgYmUgYSBkaWN0aW9uYXJ5LiIpOwogICAgICAgIH0KCiAgICAgICAgcGFyZW50UmVmID0gbm9kZS5nZXRSYXcoIlBhcmVudCIpOwogICAgICAgIHJldHVybiBub2RlLmdldEFzeW5jKCJQYXJlbnQiKTsKICAgICAgfSkudGhlbihmdW5jdGlvbiAocGFyZW50KSB7CiAgICAgICAgaWYgKCFwYXJlbnQpIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgaWYgKCEocGFyZW50IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUGFyZW50IG11c3QgYmUgYSBkaWN0aW9uYXJ5LiIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHBhcmVudC5nZXRBc3luYygiS2lkcyIpOwogICAgICB9KS50aGVuKGZ1bmN0aW9uIChraWRzKSB7CiAgICAgICAgaWYgKCFraWRzKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGtpZFByb21pc2VzID0gW107CiAgICAgICAgbGV0IGZvdW5kID0gZmFsc2U7CgogICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGtpZHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgY29uc3Qga2lkID0ga2lkc1tpXTsKCiAgICAgICAgICBpZiAoIShraWQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiS2lkIG11c3QgYmUgYSByZWZlcmVuY2UuIik7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc1JlZnNFcXVhbCkoa2lkLCBraWRSZWYpKSB7CiAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAga2lkUHJvbWlzZXMucHVzaCh4cmVmLmZldGNoQXN5bmMoa2lkKS50aGVuKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAgICAgaWYgKCEob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIktpZCBub2RlIG11c3QgYmUgYSBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAob2JqLmhhcygiQ291bnQiKSkgewogICAgICAgICAgICAgIHRvdGFsICs9IG9iai5nZXQoIkNvdW50Iik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdG90YWwrKzsKICAgICAgICAgICAgfQogICAgICAgICAgfSkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJLaWQgcmVmZXJlbmNlIG5vdCBmb3VuZCBpbiBwYXJlbnQncyBraWRzLiIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGtpZFByb21pc2VzKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBbdG90YWwsIHBhcmVudFJlZl07CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIGxldCB0b3RhbCA9IDA7CgogICAgY29uc3QgbmV4dCA9IHJlZiA9PiBwYWdlc0JlZm9yZVJlZihyZWYpLnRoZW4oYXJncyA9PiB7CiAgICAgIGlmICghYXJncykgewogICAgICAgIHRoaXMucGFnZUluZGV4Q2FjaGUucHV0KHBhZ2VSZWYsIHRvdGFsKTsKICAgICAgICByZXR1cm4gdG90YWw7CiAgICAgIH0KCiAgICAgIGNvbnN0IFtjb3VudCwgcGFyZW50UmVmXSA9IGFyZ3M7CiAgICAgIHRvdGFsICs9IGNvdW50OwogICAgICByZXR1cm4gbmV4dChwYXJlbnRSZWYpOwogICAgfSk7CgogICAgcmV0dXJuIG5leHQocGFnZVJlZik7CiAgfQoKICBnZXQgYmFzZVVybCgpIHsKICAgIGNvbnN0IHVyaSA9IHRoaXMuX2NhdERpY3QuZ2V0KCJVUkkiKTsKCiAgICBpZiAodXJpIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBjb25zdCBiYXNlID0gdXJpLmdldCgiQmFzZSIpOwoKICAgICAgaWYgKHR5cGVvZiBiYXNlID09PSAic3RyaW5nIikgewogICAgICAgIGNvbnN0IGFic29sdXRlVXJsID0gKDAsIF91dGlsLmNyZWF0ZVZhbGlkQWJzb2x1dGVVcmwpKGJhc2UsIG51bGwsIHsKICAgICAgICAgIHRyeUNvbnZlcnRFbmNvZGluZzogdHJ1ZQogICAgICAgIH0pOwoKICAgICAgICBpZiAoYWJzb2x1dGVVcmwpIHsKICAgICAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYmFzZVVybCIsIGFic29sdXRlVXJsLmhyZWYpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYmFzZVVybCIsIG51bGwpOwogIH0KCiAgc3RhdGljIHBhcnNlRGVzdERpY3Rpb25hcnkocGFyYW1zKSB7CiAgICBjb25zdCBkZXN0RGljdCA9IHBhcmFtcy5kZXN0RGljdDsKCiAgICBpZiAoIShkZXN0RGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKSgicGFyc2VEZXN0RGljdGlvbmFyeTogYGRlc3REaWN0YCBtdXN0IGJlIGEgZGljdGlvbmFyeS4iKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHJlc3VsdE9iaiA9IHBhcmFtcy5yZXN1bHRPYmo7CgogICAgaWYgKHR5cGVvZiByZXN1bHRPYmogIT09ICJvYmplY3QiKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKSgicGFyc2VEZXN0RGljdGlvbmFyeTogYHJlc3VsdE9iamAgbXVzdCBiZSBhbiBvYmplY3QuIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBkb2NCYXNlVXJsID0gcGFyYW1zLmRvY0Jhc2VVcmwgfHwgbnVsbDsKICAgIGxldCBhY3Rpb24gPSBkZXN0RGljdC5nZXQoIkEiKSwKICAgICAgICB1cmwsCiAgICAgICAgZGVzdDsKCiAgICBpZiAoIShhY3Rpb24gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICBpZiAoZGVzdERpY3QuaGFzKCJEZXN0IikpIHsKICAgICAgICBhY3Rpb24gPSBkZXN0RGljdC5nZXQoIkRlc3QiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBhY3Rpb24gPSBkZXN0RGljdC5nZXQoIkFBIik7CgogICAgICAgIGlmIChhY3Rpb24gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgICBpZiAoYWN0aW9uLmhhcygiRCIpKSB7CiAgICAgICAgICAgIGFjdGlvbiA9IGFjdGlvbi5nZXQoIkQiKTsKICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLmhhcygiVSIpKSB7CiAgICAgICAgICAgIGFjdGlvbiA9IGFjdGlvbi5nZXQoIlUiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAoYWN0aW9uIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBjb25zdCBhY3Rpb25UeXBlID0gYWN0aW9uLmdldCgiUyIpOwoKICAgICAgaWYgKCEoYWN0aW9uVHlwZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJwYXJzZURlc3REaWN0aW9uYXJ5OiBJbnZhbGlkIHR5cGUgaW4gQWN0aW9uIGRpY3Rpb25hcnkuIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBhY3Rpb25OYW1lID0gYWN0aW9uVHlwZS5uYW1lOwoKICAgICAgc3dpdGNoIChhY3Rpb25OYW1lKSB7CiAgICAgICAgY2FzZSAiUmVzZXRGb3JtIjoKICAgICAgICAgIGNvbnN0IGZsYWdzID0gYWN0aW9uLmdldCgiRmxhZ3MiKTsKICAgICAgICAgIGNvbnN0IGluY2x1ZGUgPSAoKHR5cGVvZiBmbGFncyA9PT0gIm51bWJlciIgPyBmbGFncyA6IDApICYgMSkgPT09IDA7CiAgICAgICAgICBjb25zdCBmaWVsZHMgPSBbXTsKICAgICAgICAgIGNvbnN0IHJlZnMgPSBbXTsKCiAgICAgICAgICBmb3IgKGNvbnN0IG9iaiBvZiBhY3Rpb24uZ2V0KCJGaWVsZHMiKSB8fCBbXSkgewogICAgICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICAgICAgcmVmcy5wdXNoKG9iai50b1N0cmluZygpKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb2JqID09PSAic3RyaW5nIikgewogICAgICAgICAgICAgIGZpZWxkcy5wdXNoKCgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykob2JqKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXN1bHRPYmoucmVzZXRGb3JtID0gewogICAgICAgICAgICBmaWVsZHMsCiAgICAgICAgICAgIHJlZnMsCiAgICAgICAgICAgIGluY2x1ZGUKICAgICAgICAgIH07CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiVVJJIjoKICAgICAgICAgIHVybCA9IGFjdGlvbi5nZXQoIlVSSSIpOwoKICAgICAgICAgIGlmICh1cmwgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgIHVybCA9ICIvIiArIHVybC5uYW1lOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJHb1RvIjoKICAgICAgICAgIGRlc3QgPSBhY3Rpb24uZ2V0KCJEIik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiTGF1bmNoIjoKICAgICAgICBjYXNlICJHb1RvUiI6CiAgICAgICAgICBjb25zdCB1cmxEaWN0ID0gYWN0aW9uLmdldCgiRiIpOwoKICAgICAgICAgIGlmICh1cmxEaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgICAgICB1cmwgPSB1cmxEaWN0LmdldCgiRiIpIHx8IG51bGw7CiAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB1cmxEaWN0ID09PSAic3RyaW5nIikgewogICAgICAgICAgICB1cmwgPSB1cmxEaWN0OwogICAgICAgICAgfQoKICAgICAgICAgIGxldCByZW1vdGVEZXN0ID0gYWN0aW9uLmdldCgiRCIpOwoKICAgICAgICAgIGlmIChyZW1vdGVEZXN0KSB7CiAgICAgICAgICAgIGlmIChyZW1vdGVEZXN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICAgIHJlbW90ZURlc3QgPSByZW1vdGVEZXN0Lm5hbWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0eXBlb2YgdXJsID09PSAic3RyaW5nIikgewogICAgICAgICAgICAgIGNvbnN0IGJhc2VVcmwgPSB1cmwuc3BsaXQoIiMiKVswXTsKCiAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZW1vdGVEZXN0ID09PSAic3RyaW5nIikgewogICAgICAgICAgICAgICAgdXJsID0gYmFzZVVybCArICIjIiArIHJlbW90ZURlc3Q7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHJlbW90ZURlc3QpKSB7CiAgICAgICAgICAgICAgICB1cmwgPSBiYXNlVXJsICsgIiMiICsgSlNPTi5zdHJpbmdpZnkocmVtb3RlRGVzdCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgbmV3V2luZG93ID0gYWN0aW9uLmdldCgiTmV3V2luZG93Iik7CgogICAgICAgICAgaWYgKHR5cGVvZiBuZXdXaW5kb3cgPT09ICJib29sZWFuIikgewogICAgICAgICAgICByZXN1bHRPYmoubmV3V2luZG93ID0gbmV3V2luZG93OwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJOYW1lZCI6CiAgICAgICAgICBjb25zdCBuYW1lZEFjdGlvbiA9IGFjdGlvbi5nZXQoIk4iKTsKCiAgICAgICAgICBpZiAobmFtZWRBY3Rpb24gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgIHJlc3VsdE9iai5hY3Rpb24gPSBuYW1lZEFjdGlvbi5uYW1lOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJKYXZhU2NyaXB0IjoKICAgICAgICAgIGNvbnN0IGpzQWN0aW9uID0gYWN0aW9uLmdldCgiSlMiKTsKICAgICAgICAgIGxldCBqczsKCiAgICAgICAgICBpZiAoanNBY3Rpb24gaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgICAgICBqcyA9IGpzQWN0aW9uLmdldFN0cmluZygpOwogICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YganNBY3Rpb24gPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgIGpzID0ganNBY3Rpb247CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QganNVUkwgPSBqcyAmJiAoMCwgX2NvcmVfdXRpbHMucmVjb3ZlckpzVVJMKSgoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGpzKSk7CgogICAgICAgICAgaWYgKGpzVVJMKSB7CiAgICAgICAgICAgIHVybCA9IGpzVVJMLnVybDsKICAgICAgICAgICAgcmVzdWx0T2JqLm5ld1dpbmRvdyA9IGpzVVJMLm5ld1dpbmRvdzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBpZiAoYWN0aW9uTmFtZSA9PT0gIkphdmFTY3JpcHQiIHx8IGFjdGlvbk5hbWUgPT09ICJTdWJtaXRGb3JtIikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYHBhcnNlRGVzdERpY3Rpb25hcnkgLSB1bnN1cHBvcnRlZCBhY3Rpb246ICIke2FjdGlvbk5hbWV9Ii5gKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGRlc3REaWN0LmhhcygiRGVzdCIpKSB7CiAgICAgIGRlc3QgPSBkZXN0RGljdC5nZXQoIkRlc3QiKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIHVybCA9PT0gInN0cmluZyIpIHsKICAgICAgY29uc3QgYWJzb2x1dGVVcmwgPSAoMCwgX3V0aWwuY3JlYXRlVmFsaWRBYnNvbHV0ZVVybCkodXJsLCBkb2NCYXNlVXJsLCB7CiAgICAgICAgYWRkRGVmYXVsdFByb3RvY29sOiB0cnVlLAogICAgICAgIHRyeUNvbnZlcnRFbmNvZGluZzogdHJ1ZQogICAgICB9KTsKCiAgICAgIGlmIChhYnNvbHV0ZVVybCkgewogICAgICAgIHJlc3VsdE9iai51cmwgPSBhYnNvbHV0ZVVybC5ocmVmOwogICAgICB9CgogICAgICByZXN1bHRPYmoudW5zYWZlVXJsID0gdXJsOwogICAgfQoKICAgIGlmIChkZXN0KSB7CiAgICAgIGlmIChkZXN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgIGRlc3QgPSBkZXN0Lm5hbWU7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgZGVzdCA9PT0gInN0cmluZyIpIHsKICAgICAgICByZXN1bHRPYmouZGVzdCA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZGVzdCk7CiAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShkZXN0KSkgewogICAgICAgIHJlc3VsdE9iai5kZXN0ID0gZGVzdDsKICAgICAgfQogICAgfQogIH0KCn0KCmV4cG9ydHMuQ2F0YWxvZyA9IENhdGFsb2c7CgovKioqLyB9KSwKLyogMTk1ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5OdW1iZXJUcmVlID0gZXhwb3J0cy5OYW1lVHJlZSA9IHZvaWQgMDsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMwKTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpjbGFzcyBOYW1lT3JOdW1iZXJUcmVlIHsKICBjb25zdHJ1Y3Rvcihyb290LCB4cmVmLCB0eXBlKSB7CiAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gTmFtZU9yTnVtYmVyVHJlZSkgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgaW5pdGlhbGl6ZSBOYW1lT3JOdW1iZXJUcmVlLiIpOwogICAgfQoKICAgIHRoaXMucm9vdCA9IHJvb3Q7CiAgICB0aGlzLnhyZWYgPSB4cmVmOwogICAgdGhpcy5fdHlwZSA9IHR5cGU7CiAgfQoKICBnZXRBbGwoKSB7CiAgICBjb25zdCBtYXAgPSBuZXcgTWFwKCk7CgogICAgaWYgKCF0aGlzLnJvb3QpIHsKICAgICAgcmV0dXJuIG1hcDsKICAgIH0KCiAgICBjb25zdCB4cmVmID0gdGhpcy54cmVmOwogICAgY29uc3QgcHJvY2Vzc2VkID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogICAgcHJvY2Vzc2VkLnB1dCh0aGlzLnJvb3QpOwogICAgY29uc3QgcXVldWUgPSBbdGhpcy5yb290XTsKCiAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkgewogICAgICBjb25zdCBvYmogPSB4cmVmLmZldGNoSWZSZWYocXVldWUuc2hpZnQoKSk7CgogICAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAob2JqLmhhcygiS2lkcyIpKSB7CiAgICAgICAgY29uc3Qga2lkcyA9IG9iai5nZXQoIktpZHMiKTsKCiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGtpZHMpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGZvciAoY29uc3Qga2lkIG9mIGtpZHMpIHsKICAgICAgICAgIGlmIChwcm9jZXNzZWQuaGFzKGtpZCkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBEdXBsaWNhdGUgZW50cnkgaW4gIiR7dGhpcy5fdHlwZX0iIHRyZWUuYCk7CiAgICAgICAgICB9CgogICAgICAgICAgcXVldWUucHVzaChraWQpOwogICAgICAgICAgcHJvY2Vzc2VkLnB1dChraWQpOwogICAgICAgIH0KCiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGVudHJpZXMgPSBvYmouZ2V0KHRoaXMuX3R5cGUpOwoKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGVudHJpZXMpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGVudHJpZXMubGVuZ3RoOyBpIDwgaWk7IGkgKz0gMikgewogICAgICAgIG1hcC5zZXQoeHJlZi5mZXRjaElmUmVmKGVudHJpZXNbaV0pLCB4cmVmLmZldGNoSWZSZWYoZW50cmllc1tpICsgMV0pKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBtYXA7CiAgfQoKICBnZXQoa2V5KSB7CiAgICBpZiAoIXRoaXMucm9vdCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCB4cmVmID0gdGhpcy54cmVmOwogICAgbGV0IGtpZHNPckVudHJpZXMgPSB4cmVmLmZldGNoSWZSZWYodGhpcy5yb290KTsKICAgIGxldCBsb29wQ291bnQgPSAwOwogICAgY29uc3QgTUFYX0xFVkVMUyA9IDEwOwoKICAgIHdoaWxlIChraWRzT3JFbnRyaWVzLmhhcygiS2lkcyIpKSB7CiAgICAgIGlmICgrK2xvb3BDb3VudCA+IE1BWF9MRVZFTFMpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYFNlYXJjaCBkZXB0aCBsaW1pdCByZWFjaGVkIGZvciAiJHt0aGlzLl90eXBlfSIgdHJlZS5gKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgY29uc3Qga2lkcyA9IGtpZHNPckVudHJpZXMuZ2V0KCJLaWRzIik7CgogICAgICBpZiAoIUFycmF5LmlzQXJyYXkoa2lkcykpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgbGV0IGwgPSAwLAogICAgICAgICAgciA9IGtpZHMubGVuZ3RoIC0gMTsKCiAgICAgIHdoaWxlIChsIDw9IHIpIHsKICAgICAgICBjb25zdCBtID0gbCArIHIgPj4gMTsKICAgICAgICBjb25zdCBraWQgPSB4cmVmLmZldGNoSWZSZWYoa2lkc1ttXSk7CiAgICAgICAgY29uc3QgbGltaXRzID0ga2lkLmdldCgiTGltaXRzIik7CgogICAgICAgIGlmIChrZXkgPCB4cmVmLmZldGNoSWZSZWYobGltaXRzWzBdKSkgewogICAgICAgICAgciA9IG0gLSAxOwogICAgICAgIH0gZWxzZSBpZiAoa2V5ID4geHJlZi5mZXRjaElmUmVmKGxpbWl0c1sxXSkpIHsKICAgICAgICAgIGwgPSBtICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAga2lkc09yRW50cmllcyA9IGtpZDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGwgPiByKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBlbnRyaWVzID0ga2lkc09yRW50cmllcy5nZXQodGhpcy5fdHlwZSk7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoZW50cmllcykpIHsKICAgICAgbGV0IGwgPSAwLAogICAgICAgICAgciA9IGVudHJpZXMubGVuZ3RoIC0gMjsKCiAgICAgIHdoaWxlIChsIDw9IHIpIHsKICAgICAgICBjb25zdCB0bXAgPSBsICsgciA+PiAxLAogICAgICAgICAgICAgIG0gPSB0bXAgKyAodG1wICYgMSk7CiAgICAgICAgY29uc3QgY3VycmVudEtleSA9IHhyZWYuZmV0Y2hJZlJlZihlbnRyaWVzW21dKTsKCiAgICAgICAgaWYgKGtleSA8IGN1cnJlbnRLZXkpIHsKICAgICAgICAgIHIgPSBtIC0gMjsKICAgICAgICB9IGVsc2UgaWYgKGtleSA+IGN1cnJlbnRLZXkpIHsKICAgICAgICAgIGwgPSBtICsgMjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHhyZWYuZmV0Y2hJZlJlZihlbnRyaWVzW20gKyAxXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKfQoKY2xhc3MgTmFtZVRyZWUgZXh0ZW5kcyBOYW1lT3JOdW1iZXJUcmVlIHsKICBjb25zdHJ1Y3Rvcihyb290LCB4cmVmKSB7CiAgICBzdXBlcihyb290LCB4cmVmLCAiTmFtZXMiKTsKICB9Cgp9CgpleHBvcnRzLk5hbWVUcmVlID0gTmFtZVRyZWU7CgpjbGFzcyBOdW1iZXJUcmVlIGV4dGVuZHMgTmFtZU9yTnVtYmVyVHJlZSB7CiAgY29uc3RydWN0b3Iocm9vdCwgeHJlZikgewogICAgc3VwZXIocm9vdCwgeHJlZiwgIk51bXMiKTsKICB9Cgp9CgpleHBvcnRzLk51bWJlclRyZWUgPSBOdW1iZXJUcmVlOwoKLyoqKi8gfSksCi8qIDE5NiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuY2xlYXJHbG9iYWxDYWNoZXMgPSBjbGVhckdsb2JhbENhY2hlczsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMwKTsKCnZhciBfdW5pY29kZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTY1KTsKCmZ1bmN0aW9uIGNsZWFyR2xvYmFsQ2FjaGVzKCkgewogICgwLCBfcHJpbWl0aXZlcy5jbGVhclByaW1pdGl2ZUNhY2hlcykoKTsKICAoMCwgX3VuaWNvZGUuY2xlYXJVbmljb2RlQ2FjaGVzKSgpOwp9CgovKioqLyB9KSwKLyogMTk3ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5GaWxlU3BlYyA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwoKZnVuY3Rpb24gcGlja1BsYXRmb3JtSXRlbShkaWN0KSB7CiAgaWYgKGRpY3QuaGFzKCJVRiIpKSB7CiAgICByZXR1cm4gZGljdC5nZXQoIlVGIik7CiAgfSBlbHNlIGlmIChkaWN0LmhhcygiRiIpKSB7CiAgICByZXR1cm4gZGljdC5nZXQoIkYiKTsKICB9IGVsc2UgaWYgKGRpY3QuaGFzKCJVbml4IikpIHsKICAgIHJldHVybiBkaWN0LmdldCgiVW5peCIpOwogIH0gZWxzZSBpZiAoZGljdC5oYXMoIk1hYyIpKSB7CiAgICByZXR1cm4gZGljdC5nZXQoIk1hYyIpOwogIH0gZWxzZSBpZiAoZGljdC5oYXMoIkRPUyIpKSB7CiAgICByZXR1cm4gZGljdC5nZXQoIkRPUyIpOwogIH0KCiAgcmV0dXJuIG51bGw7Cn0KCmNsYXNzIEZpbGVTcGVjIHsKICBjb25zdHJ1Y3Rvcihyb290LCB4cmVmKSB7CiAgICBpZiAoIShyb290IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMueHJlZiA9IHhyZWY7CiAgICB0aGlzLnJvb3QgPSByb290OwoKICAgIGlmIChyb290LmhhcygiRlMiKSkgewogICAgICB0aGlzLmZzID0gcm9vdC5nZXQoIkZTIik7CiAgICB9CgogICAgdGhpcy5kZXNjcmlwdGlvbiA9IHJvb3QuaGFzKCJEZXNjIikgPyAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKHJvb3QuZ2V0KCJEZXNjIikpIDogIiI7CgogICAgaWYgKHJvb3QuaGFzKCJSRiIpKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKSgiUmVsYXRlZCBmaWxlIHNwZWNpZmljYXRpb25zIGFyZSBub3Qgc3VwcG9ydGVkIik7CiAgICB9CgogICAgdGhpcy5jb250ZW50QXZhaWxhYmxlID0gdHJ1ZTsKCiAgICBpZiAoIXJvb3QuaGFzKCJFRiIpKSB7CiAgICAgIHRoaXMuY29udGVudEF2YWlsYWJsZSA9IGZhbHNlOwogICAgICAoMCwgX3V0aWwud2FybikoIk5vbi1lbWJlZGRlZCBmaWxlIHNwZWNpZmljYXRpb25zIGFyZSBub3Qgc3VwcG9ydGVkIik7CiAgICB9CiAgfQoKICBnZXQgZmlsZW5hbWUoKSB7CiAgICBpZiAoIXRoaXMuX2ZpbGVuYW1lICYmIHRoaXMucm9vdCkgewogICAgICBjb25zdCBmaWxlbmFtZSA9IHBpY2tQbGF0Zm9ybUl0ZW0odGhpcy5yb290KSB8fCAidW5uYW1lZCI7CiAgICAgIHRoaXMuX2ZpbGVuYW1lID0gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShmaWxlbmFtZSkucmVwbGFjZSgvXFxcXC9nLCAiXFwiKS5yZXBsYWNlKC9cXFwvL2csICIvIikucmVwbGFjZSgvXFwvZywgIi8iKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5fZmlsZW5hbWU7CiAgfQoKICBnZXQgY29udGVudCgpIHsKICAgIGlmICghdGhpcy5jb250ZW50QXZhaWxhYmxlKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmICghdGhpcy5jb250ZW50UmVmICYmIHRoaXMucm9vdCkgewogICAgICB0aGlzLmNvbnRlbnRSZWYgPSBwaWNrUGxhdGZvcm1JdGVtKHRoaXMucm9vdC5nZXQoIkVGIikpOwogICAgfQoKICAgIGxldCBjb250ZW50ID0gbnVsbDsKCiAgICBpZiAodGhpcy5jb250ZW50UmVmKSB7CiAgICAgIGNvbnN0IGZpbGVPYmogPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZih0aGlzLmNvbnRlbnRSZWYpOwoKICAgICAgaWYgKGZpbGVPYmogaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgIGNvbnRlbnQgPSBmaWxlT2JqLmdldEJ5dGVzKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJFbWJlZGRlZCBmaWxlIHNwZWNpZmljYXRpb24gcG9pbnRzIHRvIG5vbi1leGlzdGluZy9pbnZhbGlkIGNvbnRlbnQiKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJFbWJlZGRlZCBmaWxlIHNwZWNpZmljYXRpb24gZG9lcyBub3QgaGF2ZSBhIGNvbnRlbnQiKTsKICAgIH0KCiAgICByZXR1cm4gY29udGVudDsKICB9CgogIGdldCBzZXJpYWxpemFibGUoKSB7CiAgICByZXR1cm4gewogICAgICBmaWxlbmFtZTogdGhpcy5maWxlbmFtZSwKICAgICAgY29udGVudDogdGhpcy5jb250ZW50CiAgICB9OwogIH0KCn0KCmV4cG9ydHMuRmlsZVNwZWMgPSBGaWxlU3BlYzsKCi8qKiovIH0pLAovKiAxOTggKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk1ldGFkYXRhUGFyc2VyID0gdm9pZCAwOwoKdmFyIF94bWxfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTEpOwoKY2xhc3MgTWV0YWRhdGFQYXJzZXIgewogIGNvbnN0cnVjdG9yKGRhdGEpIHsKICAgIGRhdGEgPSB0aGlzLl9yZXBhaXIoZGF0YSk7CiAgICBjb25zdCBwYXJzZXIgPSBuZXcgX3htbF9wYXJzZXIuU2ltcGxlWE1MUGFyc2VyKHsKICAgICAgbG93ZXJDYXNlTmFtZTogdHJ1ZQogICAgfSk7CiAgICBjb25zdCB4bWxEb2N1bWVudCA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoZGF0YSk7CiAgICB0aGlzLl9tZXRhZGF0YU1hcCA9IG5ldyBNYXAoKTsKICAgIHRoaXMuX2RhdGEgPSBkYXRhOwoKICAgIGlmICh4bWxEb2N1bWVudCkgewogICAgICB0aGlzLl9wYXJzZSh4bWxEb2N1bWVudCk7CiAgICB9CiAgfQoKICBfcmVwYWlyKGRhdGEpIHsKICAgIHJldHVybiBkYXRhLnJlcGxhY2UoL15bXjxdKy8sICIiKS5yZXBsYWNlKC8+XFwzNzZcXDM3NyhbXjxdKykvZywgZnVuY3Rpb24gKGFsbCwgY29kZXMpIHsKICAgICAgY29uc3QgYnl0ZXMgPSBjb2Rlcy5yZXBsYWNlKC9cXChbMC0zXSkoWzAtN10pKFswLTddKS9nLCBmdW5jdGlvbiAoY29kZSwgZDEsIGQyLCBkMykgewogICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGQxICogNjQgKyBkMiAqIDggKyBkMyAqIDEpOwogICAgICB9KS5yZXBsYWNlKC8mKGFtcHxhcG9zfGd0fGx0fHF1b3QpOy9nLCBmdW5jdGlvbiAoc3RyLCBuYW1lKSB7CiAgICAgICAgc3dpdGNoIChuYW1lKSB7CiAgICAgICAgICBjYXNlICJhbXAiOgogICAgICAgICAgICByZXR1cm4gIiYiOwoKICAgICAgICAgIGNhc2UgImFwb3MiOgogICAgICAgICAgICByZXR1cm4gIiciOwoKICAgICAgICAgIGNhc2UgImd0IjoKICAgICAgICAgICAgcmV0dXJuICI+IjsKCiAgICAgICAgICBjYXNlICJsdCI6CiAgICAgICAgICAgIHJldHVybiAiPCI7CgogICAgICAgICAgY2FzZSAicXVvdCI6CiAgICAgICAgICAgIHJldHVybiAnIic7CiAgICAgICAgfQoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYF9yZXBhaXI6ICR7bmFtZX0gaXNuJ3QgZGVmaW5lZC5gKTsKICAgICAgfSk7CiAgICAgIGNvbnN0IGNoYXJCdWYgPSBbXTsKCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGJ5dGVzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHsKICAgICAgICBjb25zdCBjb2RlID0gYnl0ZXMuY2hhckNvZGVBdChpKSAqIDI1NiArIGJ5dGVzLmNoYXJDb2RlQXQoaSArIDEpOwoKICAgICAgICBpZiAoY29kZSA+PSAzMiAmJiBjb2RlIDwgMTI3ICYmIGNvZGUgIT09IDYwICYmIGNvZGUgIT09IDYyICYmIGNvZGUgIT09IDM4KSB7CiAgICAgICAgICBjaGFyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjb2RlKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYXJCdWYucHVzaCgiJiN4IiArICgweDEwMDAwICsgY29kZSkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKSArICI7Iik7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gIj4iICsgY2hhckJ1Zi5qb2luKCIiKTsKICAgIH0pOwogIH0KCiAgX2dldFNlcXVlbmNlKGVudHJ5KSB7CiAgICBjb25zdCBuYW1lID0gZW50cnkubm9kZU5hbWU7CgogICAgaWYgKG5hbWUgIT09ICJyZGY6YmFnIiAmJiBuYW1lICE9PSAicmRmOnNlcSIgJiYgbmFtZSAhPT0gInJkZjphbHQiKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHJldHVybiBlbnRyeS5jaGlsZE5vZGVzLmZpbHRlcihub2RlID0+IG5vZGUubm9kZU5hbWUgPT09ICJyZGY6bGkiKTsKICB9CgogIF9wYXJzZUFycmF5KGVudHJ5KSB7CiAgICBpZiAoIWVudHJ5Lmhhc0NoaWxkTm9kZXMoKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgW3NlcU5vZGVdID0gZW50cnkuY2hpbGROb2RlczsKICAgIGNvbnN0IHNlcXVlbmNlID0gdGhpcy5fZ2V0U2VxdWVuY2Uoc2VxTm9kZSkgfHwgW107CgogICAgdGhpcy5fbWV0YWRhdGFNYXAuc2V0KGVudHJ5Lm5vZGVOYW1lLCBzZXF1ZW5jZS5tYXAobm9kZSA9PiBub2RlLnRleHRDb250ZW50LnRyaW0oKSkpOwogIH0KCiAgX3BhcnNlKHhtbERvY3VtZW50KSB7CiAgICBsZXQgcmRmID0geG1sRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKICAgIGlmIChyZGYubm9kZU5hbWUgIT09ICJyZGY6cmRmIikgewogICAgICByZGYgPSByZGYuZmlyc3RDaGlsZDsKCiAgICAgIHdoaWxlIChyZGYgJiYgcmRmLm5vZGVOYW1lICE9PSAicmRmOnJkZiIpIHsKICAgICAgICByZGYgPSByZGYubmV4dFNpYmxpbmc7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXJkZiB8fCByZGYubm9kZU5hbWUgIT09ICJyZGY6cmRmIiB8fCAhcmRmLmhhc0NoaWxkTm9kZXMoKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgZm9yIChjb25zdCBkZXNjIG9mIHJkZi5jaGlsZE5vZGVzKSB7CiAgICAgIGlmIChkZXNjLm5vZGVOYW1lICE9PSAicmRmOmRlc2NyaXB0aW9uIikgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGRlc2MuY2hpbGROb2RlcykgewogICAgICAgIGNvbnN0IG5hbWUgPSBlbnRyeS5ub2RlTmFtZTsKCiAgICAgICAgc3dpdGNoIChuYW1lKSB7CiAgICAgICAgICBjYXNlICIjdGV4dCI6CiAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgIGNhc2UgImRjOmNyZWF0b3IiOgogICAgICAgICAgY2FzZSAiZGM6c3ViamVjdCI6CiAgICAgICAgICAgIHRoaXMuX3BhcnNlQXJyYXkoZW50cnkpOwoKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB0aGlzLl9tZXRhZGF0YU1hcC5zZXQobmFtZSwgZW50cnkudGV4dENvbnRlbnQudHJpbSgpKTsKICAgICAgfQogICAgfQogIH0KCiAgZ2V0IHNlcmlhbGl6YWJsZSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBhcnNlZERhdGE6IHRoaXMuX21ldGFkYXRhTWFwLAogICAgICByYXdEYXRhOiB0aGlzLl9kYXRhCiAgICB9OwogIH0KCn0KCmV4cG9ydHMuTWV0YWRhdGFQYXJzZXIgPSBNZXRhZGF0YVBhcnNlcjsKCi8qKiovIH0pLAovKiAxOTkgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlN0cnVjdFRyZWVSb290ID0gZXhwb3J0cy5TdHJ1Y3RUcmVlUGFnZSA9IHZvaWQgMDsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMwKTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX25hbWVfbnVtYmVyX3RyZWUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5NSk7Cgpjb25zdCBNQVhfREVQVEggPSA0MDsKY29uc3QgU3RydWN0RWxlbWVudFR5cGUgPSB7CiAgUEFHRV9DT05URU5UOiAiUEFHRV9DT05URU5UIiwKICBTVFJFQU1fQ09OVEVOVDogIlNUUkVBTV9DT05URU5UIiwKICBPQkpFQ1Q6ICJPQkpFQ1QiLAogIEVMRU1FTlQ6ICJFTEVNRU5UIgp9OwoKY2xhc3MgU3RydWN0VHJlZVJvb3QgewogIGNvbnN0cnVjdG9yKHJvb3REaWN0KSB7CiAgICB0aGlzLmRpY3QgPSByb290RGljdDsKICAgIHRoaXMucm9sZU1hcCA9IG5ldyBNYXAoKTsKICB9CgogIGluaXQoKSB7CiAgICB0aGlzLnJlYWRSb2xlTWFwKCk7CiAgfQoKICByZWFkUm9sZU1hcCgpIHsKICAgIGNvbnN0IHJvbGVNYXBEaWN0ID0gdGhpcy5kaWN0LmdldCgiUm9sZU1hcCIpOwoKICAgIGlmICghKHJvbGVNYXBEaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHJvbGVNYXBEaWN0LmZvckVhY2goKGtleSwgdmFsdWUpID0+IHsKICAgICAgaWYgKCEodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5yb2xlTWFwLnNldChrZXksIHZhbHVlLm5hbWUpOwogICAgfSk7CiAgfQoKfQoKZXhwb3J0cy5TdHJ1Y3RUcmVlUm9vdCA9IFN0cnVjdFRyZWVSb290OwoKY2xhc3MgU3RydWN0RWxlbWVudE5vZGUgewogIGNvbnN0cnVjdG9yKHRyZWUsIGRpY3QpIHsKICAgIHRoaXMudHJlZSA9IHRyZWU7CiAgICB0aGlzLmRpY3QgPSBkaWN0OwogICAgdGhpcy5raWRzID0gW107CiAgICB0aGlzLnBhcnNlS2lkcygpOwogIH0KCiAgZ2V0IHJvbGUoKSB7CiAgICBjb25zdCBuYW1lT2JqID0gdGhpcy5kaWN0LmdldCgiUyIpOwogICAgY29uc3QgbmFtZSA9IG5hbWVPYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gbmFtZU9iai5uYW1lIDogIiI7CiAgICBjb25zdCB7CiAgICAgIHJvb3QKICAgIH0gPSB0aGlzLnRyZWU7CgogICAgaWYgKHJvb3Qucm9sZU1hcC5oYXMobmFtZSkpIHsKICAgICAgcmV0dXJuIHJvb3Qucm9sZU1hcC5nZXQobmFtZSk7CiAgICB9CgogICAgcmV0dXJuIG5hbWU7CiAgfQoKICBwYXJzZUtpZHMoKSB7CiAgICBsZXQgcGFnZU9iaklkID0gbnVsbDsKICAgIGNvbnN0IG9ialJlZiA9IHRoaXMuZGljdC5nZXRSYXcoIlBnIik7CgogICAgaWYgKG9ialJlZiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICBwYWdlT2JqSWQgPSBvYmpSZWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICBjb25zdCBraWRzID0gdGhpcy5kaWN0LmdldCgiSyIpOwoKICAgIGlmIChBcnJheS5pc0FycmF5KGtpZHMpKSB7CiAgICAgIGZvciAoY29uc3Qga2lkIG9mIGtpZHMpIHsKICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5wYXJzZUtpZChwYWdlT2JqSWQsIGtpZCk7CgogICAgICAgIGlmIChlbGVtZW50KSB7CiAgICAgICAgICB0aGlzLmtpZHMucHVzaChlbGVtZW50KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnBhcnNlS2lkKHBhZ2VPYmpJZCwga2lkcyk7CgogICAgICBpZiAoZWxlbWVudCkgewogICAgICAgIHRoaXMua2lkcy5wdXNoKGVsZW1lbnQpOwogICAgICB9CiAgICB9CiAgfQoKICBwYXJzZUtpZChwYWdlT2JqSWQsIGtpZCkgewogICAgaWYgKE51bWJlci5pc0ludGVnZXIoa2lkKSkgewogICAgICBpZiAodGhpcy50cmVlLnBhZ2VEaWN0Lm9iaklkICE9PSBwYWdlT2JqSWQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBTdHJ1Y3RFbGVtZW50KHsKICAgICAgICB0eXBlOiBTdHJ1Y3RFbGVtZW50VHlwZS5QQUdFX0NPTlRFTlQsCiAgICAgICAgbWNpZDoga2lkLAogICAgICAgIHBhZ2VPYmpJZAogICAgICB9KTsKICAgIH0KCiAgICBsZXQga2lkRGljdCA9IG51bGw7CgogICAgaWYgKGtpZCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICBraWREaWN0ID0gdGhpcy5kaWN0LnhyZWYuZmV0Y2goa2lkKTsKICAgIH0gZWxzZSBpZiAoa2lkIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBraWREaWN0ID0ga2lkOwogICAgfQoKICAgIGlmICgha2lkRGljdCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBwYWdlUmVmID0ga2lkRGljdC5nZXRSYXcoIlBnIik7CgogICAgaWYgKHBhZ2VSZWYgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgcGFnZU9iaklkID0gcGFnZVJlZi50b1N0cmluZygpOwogICAgfQoKICAgIGNvbnN0IHR5cGUgPSBraWREaWN0LmdldCgiVHlwZSIpIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IGtpZERpY3QuZ2V0KCJUeXBlIikubmFtZSA6IG51bGw7CgogICAgaWYgKHR5cGUgPT09ICJNQ1IiKSB7CiAgICAgIGlmICh0aGlzLnRyZWUucGFnZURpY3Qub2JqSWQgIT09IHBhZ2VPYmpJZCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IFN0cnVjdEVsZW1lbnQoewogICAgICAgIHR5cGU6IFN0cnVjdEVsZW1lbnRUeXBlLlNUUkVBTV9DT05URU5ULAogICAgICAgIHJlZk9iaklkOiBraWREaWN0LmdldFJhdygiU3RtIikgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYgPyBraWREaWN0LmdldFJhdygiU3RtIikudG9TdHJpbmcoKSA6IG51bGwsCiAgICAgICAgcGFnZU9iaklkLAogICAgICAgIG1jaWQ6IGtpZERpY3QuZ2V0KCJNQ0lEIikKICAgICAgfSk7CiAgICB9CgogICAgaWYgKHR5cGUgPT09ICJPQkpSIikgewogICAgICBpZiAodGhpcy50cmVlLnBhZ2VEaWN0Lm9iaklkICE9PSBwYWdlT2JqSWQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBTdHJ1Y3RFbGVtZW50KHsKICAgICAgICB0eXBlOiBTdHJ1Y3RFbGVtZW50VHlwZS5PQkpFQ1QsCiAgICAgICAgcmVmT2JqSWQ6IGtpZERpY3QuZ2V0UmF3KCJPYmoiKSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZiA/IGtpZERpY3QuZ2V0UmF3KCJPYmoiKS50b1N0cmluZygpIDogbnVsbCwKICAgICAgICBwYWdlT2JqSWQKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIG5ldyBTdHJ1Y3RFbGVtZW50KHsKICAgICAgdHlwZTogU3RydWN0RWxlbWVudFR5cGUuRUxFTUVOVCwKICAgICAgZGljdDoga2lkRGljdAogICAgfSk7CiAgfQoKfQoKY2xhc3MgU3RydWN0RWxlbWVudCB7CiAgY29uc3RydWN0b3IoX3JlZikgewogICAgbGV0IHsKICAgICAgdHlwZSwKICAgICAgZGljdCA9IG51bGwsCiAgICAgIG1jaWQgPSBudWxsLAogICAgICBwYWdlT2JqSWQgPSBudWxsLAogICAgICByZWZPYmpJZCA9IG51bGwKICAgIH0gPSBfcmVmOwogICAgdGhpcy50eXBlID0gdHlwZTsKICAgIHRoaXMuZGljdCA9IGRpY3Q7CiAgICB0aGlzLm1jaWQgPSBtY2lkOwogICAgdGhpcy5wYWdlT2JqSWQgPSBwYWdlT2JqSWQ7CiAgICB0aGlzLnJlZk9iaklkID0gcmVmT2JqSWQ7CiAgICB0aGlzLnBhcmVudE5vZGUgPSBudWxsOwogIH0KCn0KCmNsYXNzIFN0cnVjdFRyZWVQYWdlIHsKICBjb25zdHJ1Y3RvcihzdHJ1Y3RUcmVlUm9vdCwgcGFnZURpY3QpIHsKICAgIHRoaXMucm9vdCA9IHN0cnVjdFRyZWVSb290OwogICAgdGhpcy5yb290RGljdCA9IHN0cnVjdFRyZWVSb290ID8gc3RydWN0VHJlZVJvb3QuZGljdCA6IG51bGw7CiAgICB0aGlzLnBhZ2VEaWN0ID0gcGFnZURpY3Q7CiAgICB0aGlzLm5vZGVzID0gW107CiAgfQoKICBwYXJzZSgpIHsKICAgIGlmICghdGhpcy5yb290IHx8ICF0aGlzLnJvb3REaWN0KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBwYXJlbnRUcmVlID0gdGhpcy5yb290RGljdC5nZXQoIlBhcmVudFRyZWUiKTsKCiAgICBpZiAoIXBhcmVudFRyZWUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGlkID0gdGhpcy5wYWdlRGljdC5nZXQoIlN0cnVjdFBhcmVudHMiKTsKCiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoaWQpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBudW1iZXJUcmVlID0gbmV3IF9uYW1lX251bWJlcl90cmVlLk51bWJlclRyZWUocGFyZW50VHJlZSwgdGhpcy5yb290RGljdC54cmVmKTsKICAgIGNvbnN0IHBhcmVudEFycmF5ID0gbnVtYmVyVHJlZS5nZXQoaWQpOwoKICAgIGlmICghQXJyYXkuaXNBcnJheShwYXJlbnRBcnJheSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG1hcCA9IG5ldyBNYXAoKTsKCiAgICBmb3IgKGNvbnN0IHJlZiBvZiBwYXJlbnRBcnJheSkgewogICAgICBpZiAocmVmIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgdGhpcy5hZGROb2RlKHRoaXMucm9vdERpY3QueHJlZi5mZXRjaChyZWYpLCBtYXApOwogICAgICB9CiAgICB9CiAgfQoKICBhZGROb2RlKGRpY3QsIG1hcCkgewogICAgbGV0IGxldmVsID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAwOwoKICAgIGlmIChsZXZlbCA+IE1BWF9ERVBUSCkgewogICAgICAoMCwgX3V0aWwud2FybikoIlN0cnVjdFRyZWUgTUFYX0RFUFRIIHJlYWNoZWQuIik7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmIChtYXAuaGFzKGRpY3QpKSB7CiAgICAgIHJldHVybiBtYXAuZ2V0KGRpY3QpOwogICAgfQoKICAgIGNvbnN0IGVsZW1lbnQgPSBuZXcgU3RydWN0RWxlbWVudE5vZGUodGhpcywgZGljdCk7CiAgICBtYXAuc2V0KGRpY3QsIGVsZW1lbnQpOwogICAgY29uc3QgcGFyZW50ID0gZGljdC5nZXQoIlAiKTsKCiAgICBpZiAoIXBhcmVudCB8fCAoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShwYXJlbnQuZ2V0KCJUeXBlIiksICJTdHJ1Y3RUcmVlUm9vdCIpKSB7CiAgICAgIGlmICghdGhpcy5hZGRUb3BMZXZlbE5vZGUoZGljdCwgZWxlbWVudCkpIHsKICAgICAgICBtYXAuZGVsZXRlKGRpY3QpOwogICAgICB9CgogICAgICByZXR1cm4gZWxlbWVudDsKICAgIH0KCiAgICBjb25zdCBwYXJlbnROb2RlID0gdGhpcy5hZGROb2RlKHBhcmVudCwgbWFwLCBsZXZlbCArIDEpOwoKICAgIGlmICghcGFyZW50Tm9kZSkgewogICAgICByZXR1cm4gZWxlbWVudDsKICAgIH0KCiAgICBsZXQgc2F2ZSA9IGZhbHNlOwoKICAgIGZvciAoY29uc3Qga2lkIG9mIHBhcmVudE5vZGUua2lkcykgewogICAgICBpZiAoa2lkLnR5cGUgPT09IFN0cnVjdEVsZW1lbnRUeXBlLkVMRU1FTlQgJiYga2lkLmRpY3QgPT09IGRpY3QpIHsKICAgICAgICBraWQucGFyZW50Tm9kZSA9IGVsZW1lbnQ7CiAgICAgICAgc2F2ZSA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXNhdmUpIHsKICAgICAgbWFwLmRlbGV0ZShkaWN0KTsKICAgIH0KCiAgICByZXR1cm4gZWxlbWVudDsKICB9CgogIGFkZFRvcExldmVsTm9kZShkaWN0LCBlbGVtZW50KSB7CiAgICBjb25zdCBvYmogPSB0aGlzLnJvb3REaWN0LmdldCgiSyIpOwoKICAgIGlmICghb2JqKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBpZiAob2JqLm9iaklkICE9PSBkaWN0Lm9iaklkKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB0aGlzLm5vZGVzWzBdID0gZWxlbWVudDsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgaWYgKCFBcnJheS5pc0FycmF5KG9iaikpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgbGV0IHNhdmUgPSBmYWxzZTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9iai5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBraWRSZWYgPSBvYmpbaV07CgogICAgICBpZiAoa2lkUmVmICYmIGtpZFJlZi50b1N0cmluZygpID09PSBkaWN0Lm9iaklkKSB7CiAgICAgICAgdGhpcy5ub2Rlc1tpXSA9IGVsZW1lbnQ7CiAgICAgICAgc2F2ZSA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc2F2ZTsKICB9CgogIGdldCBzZXJpYWxpemFibGUoKSB7CiAgICBmdW5jdGlvbiBub2RlVG9TZXJpYWxpemFibGUobm9kZSwgcGFyZW50KSB7CiAgICAgIGxldCBsZXZlbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogMDsKCiAgICAgIGlmIChsZXZlbCA+IE1BWF9ERVBUSCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiU3RydWN0VHJlZSB0b28gZGVlcCB0byBiZSBmdWxseSBzZXJpYWxpemVkLiIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgb2JqID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgb2JqLnJvbGUgPSBub2RlLnJvbGU7CiAgICAgIG9iai5jaGlsZHJlbiA9IFtdOwogICAgICBwYXJlbnQuY2hpbGRyZW4ucHVzaChvYmopOwogICAgICBjb25zdCBhbHQgPSBub2RlLmRpY3QuZ2V0KCJBbHQiKTsKCiAgICAgIGlmICh0eXBlb2YgYWx0ID09PSAic3RyaW5nIikgewogICAgICAgIG9iai5hbHQgPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGFsdCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxhbmcgPSBub2RlLmRpY3QuZ2V0KCJMYW5nIik7CgogICAgICBpZiAodHlwZW9mIGxhbmcgPT09ICJzdHJpbmciKSB7CiAgICAgICAgb2JqLmxhbmcgPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGxhbmcpOwogICAgICB9CgogICAgICBmb3IgKGNvbnN0IGtpZCBvZiBub2RlLmtpZHMpIHsKICAgICAgICBjb25zdCBraWRFbGVtZW50ID0ga2lkLnR5cGUgPT09IFN0cnVjdEVsZW1lbnRUeXBlLkVMRU1FTlQgPyBraWQucGFyZW50Tm9kZSA6IG51bGw7CgogICAgICAgIGlmIChraWRFbGVtZW50KSB7CiAgICAgICAgICBub2RlVG9TZXJpYWxpemFibGUoa2lkRWxlbWVudCwgb2JqLCBsZXZlbCArIDEpOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSBlbHNlIGlmIChraWQudHlwZSA9PT0gU3RydWN0RWxlbWVudFR5cGUuUEFHRV9DT05URU5UIHx8IGtpZC50eXBlID09PSBTdHJ1Y3RFbGVtZW50VHlwZS5TVFJFQU1fQ09OVEVOVCkgewogICAgICAgICAgb2JqLmNoaWxkcmVuLnB1c2goewogICAgICAgICAgICB0eXBlOiAiY29udGVudCIsCiAgICAgICAgICAgIGlkOiBgcGFnZSR7a2lkLnBhZ2VPYmpJZH1fbWNpZCR7a2lkLm1jaWR9YAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChraWQudHlwZSA9PT0gU3RydWN0RWxlbWVudFR5cGUuT0JKRUNUKSB7CiAgICAgICAgICBvYmouY2hpbGRyZW4ucHVzaCh7CiAgICAgICAgICAgIHR5cGU6ICJvYmplY3QiLAogICAgICAgICAgICBpZDoga2lkLnJlZk9iaklkCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCByb290ID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHJvb3QuY2hpbGRyZW4gPSBbXTsKICAgIHJvb3Qucm9sZSA9ICJSb290IjsKCiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXMubm9kZXMpIHsKICAgICAgaWYgKCFjaGlsZCkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBub2RlVG9TZXJpYWxpemFibGUoY2hpbGQsIHJvb3QpOwogICAgfQoKICAgIHJldHVybiByb290OwogIH0KCn0KCmV4cG9ydHMuU3RydWN0VHJlZVBhZ2UgPSBTdHJ1Y3RUcmVlUGFnZTsKCi8qKiovIH0pLAovKiAyMDAgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk9iamVjdExvYWRlciA9IHZvaWQgMDsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMwKTsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMik7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKZnVuY3Rpb24gbWF5SGF2ZUNoaWxkcmVuKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmIHx8IHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCB8fCB2YWx1ZSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtIHx8IEFycmF5LmlzQXJyYXkodmFsdWUpOwp9CgpmdW5jdGlvbiBhZGRDaGlsZHJlbihub2RlLCBub2Rlc1RvVmlzaXQpIHsKICBpZiAobm9kZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgIG5vZGUgPSBub2RlLmdldFJhd1ZhbHVlcygpOwogIH0gZWxzZSBpZiAobm9kZSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICBub2RlID0gbm9kZS5kaWN0LmdldFJhd1ZhbHVlcygpOwogIH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkobm9kZSkpIHsKICAgIHJldHVybjsKICB9CgogIGZvciAoY29uc3QgcmF3VmFsdWUgb2Ygbm9kZSkgewogICAgaWYgKG1heUhhdmVDaGlsZHJlbihyYXdWYWx1ZSkpIHsKICAgICAgbm9kZXNUb1Zpc2l0LnB1c2gocmF3VmFsdWUpOwogICAgfQogIH0KfQoKY2xhc3MgT2JqZWN0TG9hZGVyIHsKICBjb25zdHJ1Y3RvcihkaWN0LCBrZXlzLCB4cmVmKSB7CiAgICB0aGlzLmRpY3QgPSBkaWN0OwogICAgdGhpcy5rZXlzID0ga2V5czsKICAgIHRoaXMueHJlZiA9IHhyZWY7CiAgICB0aGlzLnJlZlNldCA9IG51bGw7CiAgfQoKICBhc3luYyBsb2FkKCkgewogICAgaWYgKHRoaXMueHJlZi5zdHJlYW0uaXNEYXRhTG9hZGVkKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgY29uc3QgewogICAgICBrZXlzLAogICAgICBkaWN0CiAgICB9ID0gdGhpczsKICAgIHRoaXMucmVmU2V0ID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogICAgY29uc3Qgbm9kZXNUb1Zpc2l0ID0gW107CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0ga2V5cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IHJhd1ZhbHVlID0gZGljdC5nZXRSYXcoa2V5c1tpXSk7CgogICAgICBpZiAocmF3VmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIG5vZGVzVG9WaXNpdC5wdXNoKHJhd1ZhbHVlKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0aGlzLl93YWxrKG5vZGVzVG9WaXNpdCk7CiAgfQoKICBhc3luYyBfd2Fsayhub2Rlc1RvVmlzaXQpIHsKICAgIGNvbnN0IG5vZGVzVG9SZXZpc2l0ID0gW107CiAgICBjb25zdCBwZW5kaW5nUmVxdWVzdHMgPSBbXTsKCiAgICB3aGlsZSAobm9kZXNUb1Zpc2l0Lmxlbmd0aCkgewogICAgICBsZXQgY3VycmVudE5vZGUgPSBub2Rlc1RvVmlzaXQucG9wKCk7CgogICAgICBpZiAoY3VycmVudE5vZGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICBpZiAodGhpcy5yZWZTZXQuaGFzKGN1cnJlbnROb2RlKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB0cnkgewogICAgICAgICAgdGhpcy5yZWZTZXQucHV0KGN1cnJlbnROb2RlKTsKICAgICAgICAgIGN1cnJlbnROb2RlID0gdGhpcy54cmVmLmZldGNoKGN1cnJlbnROb2RlKTsKICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgaWYgKCEoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBPYmplY3RMb2FkZXIuX3dhbGsgLSByZXF1ZXN0aW5nIGFsbCBkYXRhOiAiJHtleH0iLmApOwogICAgICAgICAgICB0aGlzLnJlZlNldCA9IG51bGw7CiAgICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgICBtYW5hZ2VyCiAgICAgICAgICAgIH0gPSB0aGlzLnhyZWYuc3RyZWFtOwogICAgICAgICAgICByZXR1cm4gbWFuYWdlci5yZXF1ZXN0QWxsQ2h1bmtzKCk7CiAgICAgICAgICB9CgogICAgICAgICAgbm9kZXNUb1JldmlzaXQucHVzaChjdXJyZW50Tm9kZSk7CiAgICAgICAgICBwZW5kaW5nUmVxdWVzdHMucHVzaCh7CiAgICAgICAgICAgIGJlZ2luOiBleC5iZWdpbiwKICAgICAgICAgICAgZW5kOiBleC5lbmQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGN1cnJlbnROb2RlIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgICBjb25zdCBiYXNlU3RyZWFtcyA9IGN1cnJlbnROb2RlLmdldEJhc2VTdHJlYW1zKCk7CgogICAgICAgIGlmIChiYXNlU3RyZWFtcykgewogICAgICAgICAgbGV0IGZvdW5kTWlzc2luZ0RhdGEgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKGNvbnN0IHN0cmVhbSBvZiBiYXNlU3RyZWFtcykgewogICAgICAgICAgICBpZiAoc3RyZWFtLmlzRGF0YUxvYWRlZCkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3VuZE1pc3NpbmdEYXRhID0gdHJ1ZTsKICAgICAgICAgICAgcGVuZGluZ1JlcXVlc3RzLnB1c2goewogICAgICAgICAgICAgIGJlZ2luOiBzdHJlYW0uc3RhcnQsCiAgICAgICAgICAgICAgZW5kOiBzdHJlYW0uZW5kCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChmb3VuZE1pc3NpbmdEYXRhKSB7CiAgICAgICAgICAgIG5vZGVzVG9SZXZpc2l0LnB1c2goY3VycmVudE5vZGUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgYWRkQ2hpbGRyZW4oY3VycmVudE5vZGUsIG5vZGVzVG9WaXNpdCk7CiAgICB9CgogICAgaWYgKHBlbmRpbmdSZXF1ZXN0cy5sZW5ndGgpIHsKICAgICAgYXdhaXQgdGhpcy54cmVmLnN0cmVhbS5tYW5hZ2VyLnJlcXVlc3RSYW5nZXMocGVuZGluZ1JlcXVlc3RzKTsKCiAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlc1RvUmV2aXNpdCkgewogICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICB0aGlzLnJlZlNldC5yZW1vdmUobm9kZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5fd2Fsayhub2Rlc1RvUmV2aXNpdCk7CiAgICB9CgogICAgdGhpcy5yZWZTZXQgPSBudWxsOwogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9Cgp9CgpleHBvcnRzLk9iamVjdExvYWRlciA9IE9iamVjdExvYWRlcjsKCi8qKiovIH0pLAovKiAyMDEgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlhGQUZhY3RvcnkgPSB2b2lkIDA7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMik7Cgp2YXIgX2JpbmQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNik7Cgp2YXIgX2RhdGEgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxMik7Cgp2YXIgX2ZvbnRzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTApOwoKdmFyIF91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAzKTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMjEzKTsKCnZhciBfeGh0bWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyMyk7CgpjbGFzcyBYRkFGYWN0b3J5IHsKICBjb25zdHJ1Y3RvcihkYXRhKSB7CiAgICB0cnkgewogICAgICB0aGlzLnJvb3QgPSBuZXcgX3BhcnNlci5YRkFQYXJzZXIoKS5wYXJzZShYRkFGYWN0b3J5Ll9jcmVhdGVEb2N1bWVudChkYXRhKSk7CiAgICAgIGNvbnN0IGJpbmRlciA9IG5ldyBfYmluZC5CaW5kZXIodGhpcy5yb290KTsKICAgICAgdGhpcy5mb3JtID0gYmluZGVyLmJpbmQoKTsKICAgICAgdGhpcy5kYXRhSGFuZGxlciA9IG5ldyBfZGF0YS5EYXRhSGFuZGxlcih0aGlzLnJvb3QsIGJpbmRlci5nZXREYXRhKCkpOwogICAgICB0aGlzLmZvcm1bX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdLnRlbXBsYXRlID0gdGhpcy5mb3JtOwogICAgfSBjYXRjaCAoZSkgewogICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIGFuIGVycm9yIG9jY3VycmVkIGR1cmluZyBwYXJzaW5nIGFuZCBiaW5kaW5nOiAke2V9YCk7CiAgICB9CiAgfQoKICBpc1ZhbGlkKCkgewogICAgcmV0dXJuIHRoaXMucm9vdCAmJiB0aGlzLmZvcm07CiAgfQoKICBfY3JlYXRlUGFnZXNIZWxwZXIoKSB7CiAgICBjb25zdCBpdGVyYXRvciA9IHRoaXMuZm9ybVtfeGZhX29iamVjdC4kdG9QYWdlc10oKTsKCiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICBjb25zdCBuZXh0SXRlcmF0aW9uID0gKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IGl0ZXJhdG9yLm5leHQoKTsKCiAgICAgICAgICBpZiAodmFsdWUuZG9uZSkgewogICAgICAgICAgICByZXNvbHZlKHZhbHVlLnZhbHVlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNldFRpbWVvdXQobmV4dEl0ZXJhdGlvbiwgMCk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgcmVqZWN0KGUpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHNldFRpbWVvdXQobmV4dEl0ZXJhdGlvbiwgMCk7CiAgICB9KTsKICB9CgogIGFzeW5jIF9jcmVhdGVQYWdlcygpIHsKICAgIHRyeSB7CiAgICAgIHRoaXMucGFnZXMgPSBhd2FpdCB0aGlzLl9jcmVhdGVQYWdlc0hlbHBlcigpOwogICAgICB0aGlzLmRpbXMgPSB0aGlzLnBhZ2VzLmNoaWxkcmVuLm1hcChjID0+IHsKICAgICAgICBjb25zdCB7CiAgICAgICAgICB3aWR0aCwKICAgICAgICAgIGhlaWdodAogICAgICAgIH0gPSBjLmF0dHJpYnV0ZXMuc3R5bGU7CiAgICAgICAgcmV0dXJuIFswLCAwLCBwYXJzZUludCh3aWR0aCksIHBhcnNlSW50KGhlaWdodCldOwogICAgICB9KTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBhbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgbGF5b3V0OiAke2V9YCk7CiAgICB9CiAgfQoKICBnZXRCb3VuZGluZ0JveChwYWdlSW5kZXgpIHsKICAgIHJldHVybiB0aGlzLmRpbXNbcGFnZUluZGV4XTsKICB9CgogIGFzeW5jIGdldE51bVBhZ2VzKCkgewogICAgaWYgKCF0aGlzLnBhZ2VzKSB7CiAgICAgIGF3YWl0IHRoaXMuX2NyZWF0ZVBhZ2VzKCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuZGltcy5sZW5ndGg7CiAgfQoKICBzZXRJbWFnZXMoaW1hZ2VzKSB7CiAgICB0aGlzLmZvcm1bX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdLmltYWdlcyA9IGltYWdlczsKICB9CgogIHNldEZvbnRzKGZvbnRzKSB7CiAgICB0aGlzLmZvcm1bX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdLmZvbnRGaW5kZXIgPSBuZXcgX2ZvbnRzLkZvbnRGaW5kZXIoZm9udHMpOwogICAgY29uc3QgbWlzc2luZ0ZvbnRzID0gW107CgogICAgZm9yIChsZXQgdHlwZWZhY2Ugb2YgdGhpcy5mb3JtW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXS51c2VkVHlwZWZhY2VzKSB7CiAgICAgIHR5cGVmYWNlID0gKDAsIF91dGlscy5zdHJpcFF1b3RlcykodHlwZWZhY2UpOwoKICAgICAgY29uc3QgZm9udCA9IHRoaXMuZm9ybVtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0uZm9udEZpbmRlci5maW5kKHR5cGVmYWNlKTsKCiAgICAgIGlmICghZm9udCkgewogICAgICAgIG1pc3NpbmdGb250cy5wdXNoKHR5cGVmYWNlKTsKICAgICAgfQogICAgfQoKICAgIGlmIChtaXNzaW5nRm9udHMubGVuZ3RoID4gMCkgewogICAgICByZXR1cm4gbWlzc2luZ0ZvbnRzOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgYXBwZW5kRm9udHMoZm9udHMsIHJlYWxseU1pc3NpbmdGb250cykgewogICAgdGhpcy5mb3JtW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXS5mb250RmluZGVyLmFkZChmb250cywgcmVhbGx5TWlzc2luZ0ZvbnRzKTsKICB9CgogIGFzeW5jIGdldFBhZ2VzKCkgewogICAgaWYgKCF0aGlzLnBhZ2VzKSB7CiAgICAgIGF3YWl0IHRoaXMuX2NyZWF0ZVBhZ2VzKCk7CiAgICB9CgogICAgY29uc3QgcGFnZXMgPSB0aGlzLnBhZ2VzOwogICAgdGhpcy5wYWdlcyA9IG51bGw7CiAgICByZXR1cm4gcGFnZXM7CiAgfQoKICBzZXJpYWxpemVEYXRhKHN0b3JhZ2UpIHsKICAgIHJldHVybiB0aGlzLmRhdGFIYW5kbGVyLnNlcmlhbGl6ZShzdG9yYWdlKTsKICB9CgogIHN0YXRpYyBfY3JlYXRlRG9jdW1lbnQoZGF0YSkgewogICAgaWYgKCFkYXRhWyIveGRwOnhkcCJdKSB7CiAgICAgIHJldHVybiBkYXRhWyJ4ZHA6eGRwIl07CiAgICB9CgogICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoZGF0YSkuam9pbigiIik7CiAgfQoKICBzdGF0aWMgZ2V0UmljaFRleHRBc0h0bWwocmMpIHsKICAgIGlmICghcmMgfHwgdHlwZW9mIHJjICE9PSAic3RyaW5nIikgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICB0cnkgewogICAgICBsZXQgcm9vdCA9IG5ldyBfcGFyc2VyLlhGQVBhcnNlcihfeGh0bWwuWGh0bWxOYW1lc3BhY2UsIHRydWUpLnBhcnNlKHJjKTsKCiAgICAgIGlmICghWyJib2R5IiwgInhodG1sIl0uaW5jbHVkZXMocm9vdFtfeGZhX29iamVjdC4kbm9kZU5hbWVdKSkgewogICAgICAgIGNvbnN0IG5ld1Jvb3QgPSBfeGh0bWwuWGh0bWxOYW1lc3BhY2UuYm9keSh7fSk7CgogICAgICAgIG5ld1Jvb3RbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXShyb290KTsKCiAgICAgICAgcm9vdCA9IG5ld1Jvb3Q7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlc3VsdCA9IHJvb3RbX3hmYV9vYmplY3QuJHRvSFRNTF0oKTsKCiAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgY29uc3QgewogICAgICAgIGh0bWwKICAgICAgfSA9IHJlc3VsdDsKICAgICAgY29uc3QgewogICAgICAgIGF0dHJpYnV0ZXMKICAgICAgfSA9IGh0bWw7CgogICAgICBpZiAoYXR0cmlidXRlcykgewogICAgICAgIGlmIChhdHRyaWJ1dGVzLmNsYXNzKSB7CiAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gYXR0cmlidXRlcy5jbGFzcy5maWx0ZXIoYXR0ciA9PiAhYXR0ci5zdGFydHNXaXRoKCJ4ZmEiKSk7CiAgICAgICAgfQoKICAgICAgICBhdHRyaWJ1dGVzLmRpciA9ICJhdXRvIjsKICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICBodG1sLAogICAgICAgIHN0cjogcm9vdFtfeGZhX29iamVjdC4kdGV4dF0oKQogICAgICB9OwogICAgfSBjYXRjaCAoZSkgewogICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIGFuIGVycm9yIG9jY3VycmVkIGR1cmluZyBwYXJzaW5nIG9mIHJpY2ggdGV4dDogJHtlfWApOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCn0KCmV4cG9ydHMuWEZBRmFjdG9yeSA9IFhGQUZhY3Rvcnk7CgovKioqLyB9KSwKLyogMjAyICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5YbWxPYmplY3QgPSBleHBvcnRzLlhGQU9iamVjdEFycmF5ID0gZXhwb3J0cy5YRkFPYmplY3QgPSBleHBvcnRzLlhGQUF0dHJpYnV0ZSA9IGV4cG9ydHMuU3RyaW5nT2JqZWN0ID0gZXhwb3J0cy5PcHRpb25PYmplY3QgPSBleHBvcnRzLk9wdGlvbjEwID0gZXhwb3J0cy5PcHRpb24wMSA9IGV4cG9ydHMuSW50ZWdlck9iamVjdCA9IGV4cG9ydHMuQ29udGVudE9iamVjdCA9IGV4cG9ydHMuJHVpZCA9IGV4cG9ydHMuJHRvU3R5bGUgPSBleHBvcnRzLiR0b1N0cmluZyA9IGV4cG9ydHMuJHRvUGFnZXMgPSBleHBvcnRzLiR0b0hUTUwgPSBleHBvcnRzLiR0ZXh0ID0gZXhwb3J0cy4kdGFiSW5kZXggPSBleHBvcnRzLiRzZXRWYWx1ZSA9IGV4cG9ydHMuJHNldFNldEF0dHJpYnV0ZXMgPSBleHBvcnRzLiRzZXRJZCA9IGV4cG9ydHMuJHNlYXJjaE5vZGUgPSBleHBvcnRzLiRyb290ID0gZXhwb3J0cy4kcmVzb2x2ZVByb3RvdHlwZXMgPSBleHBvcnRzLiRyZW1vdmVDaGlsZCA9IGV4cG9ydHMuJHB1c2hQYXJhID0gZXhwb3J0cy4kcHVzaEdseXBocyA9IGV4cG9ydHMuJHBvcFBhcmEgPSBleHBvcnRzLiRvblRleHQgPSBleHBvcnRzLiRvbkNoaWxkQ2hlY2sgPSBleHBvcnRzLiRvbkNoaWxkID0gZXhwb3J0cy4kbnNBdHRyaWJ1dGVzID0gZXhwb3J0cy4kbm9kZU5hbWUgPSBleHBvcnRzLiRuYW1lc3BhY2VJZCA9IGV4cG9ydHMuJGlzVXNhYmxlID0gZXhwb3J0cy4kaXNUcmFuc3BhcmVudCA9IGV4cG9ydHMuJGlzVGhlcmVNb3JlV2lkdGggPSBleHBvcnRzLiRpc1NwbGl0dGFibGUgPSBleHBvcnRzLiRpc05zQWdub3N0aWMgPSBleHBvcnRzLiRpc0Rlc2NlbmRlbnQgPSBleHBvcnRzLiRpc0RhdGFWYWx1ZSA9IGV4cG9ydHMuJGlzQ0RBVEFYbWwgPSBleHBvcnRzLiRpc0JpbmRhYmxlID0gZXhwb3J0cy4kaW5zZXJ0QXQgPSBleHBvcnRzLiRpbmRleE9mID0gZXhwb3J0cy4kaWRzID0gZXhwb3J0cy4kaGFzU2V0dGFibGVWYWx1ZSA9IGV4cG9ydHMuJGdsb2JhbERhdGEgPSBleHBvcnRzLiRnZXRUZW1wbGF0ZVJvb3QgPSBleHBvcnRzLiRnZXRTdWJmb3JtUGFyZW50ID0gZXhwb3J0cy4kZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXQgPSBleHBvcnRzLiRnZXRQYXJlbnQgPSBleHBvcnRzLiRnZXROZXh0UGFnZSA9IGV4cG9ydHMuJGdldEV4dHJhID0gZXhwb3J0cy4kZ2V0RGF0YVZhbHVlID0gZXhwb3J0cy4kZ2V0Q29udGFpbmVkQ2hpbGRyZW4gPSBleHBvcnRzLiRnZXRDaGlsZHJlbkJ5TmFtZUl0ID0gZXhwb3J0cy4kZ2V0Q2hpbGRyZW5CeU5hbWUgPSBleHBvcnRzLiRnZXRDaGlsZHJlbkJ5Q2xhc3MgPSBleHBvcnRzLiRnZXRDaGlsZHJlbiA9IGV4cG9ydHMuJGdldEF2YWlsYWJsZVNwYWNlID0gZXhwb3J0cy4kZ2V0QXR0cmlidXRlcyA9IGV4cG9ydHMuJGdldEF0dHJpYnV0ZUl0ID0gZXhwb3J0cy4kZmx1c2hIVE1MID0gZXhwb3J0cy4kZmluYWxpemUgPSBleHBvcnRzLiRleHRyYSA9IGV4cG9ydHMuJGR1bXAgPSBleHBvcnRzLiRkYXRhID0gZXhwb3J0cy4kY29udGVudCA9IGV4cG9ydHMuJGNvbnN1bWVkID0gZXhwb3J0cy4kY2xvbmUgPSBleHBvcnRzLiRjbGVhbnVwID0gZXhwb3J0cy4kY2xlYW5QYWdlID0gZXhwb3J0cy4kY2xlYW4gPSBleHBvcnRzLiRjaGlsZHJlblRvSFRNTCA9IGV4cG9ydHMuJGFwcGVuZENoaWxkID0gZXhwb3J0cy4kYWRkSFRNTCA9IGV4cG9ydHMuJGFjY2VwdFdoaXRlc3BhY2UgPSB2b2lkIDA7Cgp2YXIgX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDMpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMxKTsKCnZhciBfbmFtZXNwYWNlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA0KTsKCnZhciBfc29tID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDUpOwoKY29uc3QgJGFjY2VwdFdoaXRlc3BhY2UgPSBTeW1ib2woKTsKZXhwb3J0cy4kYWNjZXB0V2hpdGVzcGFjZSA9ICRhY2NlcHRXaGl0ZXNwYWNlOwpjb25zdCAkYWRkSFRNTCA9IFN5bWJvbCgpOwpleHBvcnRzLiRhZGRIVE1MID0gJGFkZEhUTUw7CmNvbnN0ICRhcHBlbmRDaGlsZCA9IFN5bWJvbCgpOwpleHBvcnRzLiRhcHBlbmRDaGlsZCA9ICRhcHBlbmRDaGlsZDsKY29uc3QgJGNoaWxkcmVuVG9IVE1MID0gU3ltYm9sKCk7CmV4cG9ydHMuJGNoaWxkcmVuVG9IVE1MID0gJGNoaWxkcmVuVG9IVE1MOwpjb25zdCAkY2xlYW4gPSBTeW1ib2woKTsKZXhwb3J0cy4kY2xlYW4gPSAkY2xlYW47CmNvbnN0ICRjbGVhblBhZ2UgPSBTeW1ib2woKTsKZXhwb3J0cy4kY2xlYW5QYWdlID0gJGNsZWFuUGFnZTsKY29uc3QgJGNsZWFudXAgPSBTeW1ib2woKTsKZXhwb3J0cy4kY2xlYW51cCA9ICRjbGVhbnVwOwpjb25zdCAkY2xvbmUgPSBTeW1ib2woKTsKZXhwb3J0cy4kY2xvbmUgPSAkY2xvbmU7CmNvbnN0ICRjb25zdW1lZCA9IFN5bWJvbCgpOwpleHBvcnRzLiRjb25zdW1lZCA9ICRjb25zdW1lZDsKY29uc3QgJGNvbnRlbnQgPSBTeW1ib2woImNvbnRlbnQiKTsKZXhwb3J0cy4kY29udGVudCA9ICRjb250ZW50Owpjb25zdCAkZGF0YSA9IFN5bWJvbCgiZGF0YSIpOwpleHBvcnRzLiRkYXRhID0gJGRhdGE7CmNvbnN0ICRkdW1wID0gU3ltYm9sKCk7CmV4cG9ydHMuJGR1bXAgPSAkZHVtcDsKY29uc3QgJGV4dHJhID0gU3ltYm9sKCJleHRyYSIpOwpleHBvcnRzLiRleHRyYSA9ICRleHRyYTsKY29uc3QgJGZpbmFsaXplID0gU3ltYm9sKCk7CmV4cG9ydHMuJGZpbmFsaXplID0gJGZpbmFsaXplOwpjb25zdCAkZmx1c2hIVE1MID0gU3ltYm9sKCk7CmV4cG9ydHMuJGZsdXNoSFRNTCA9ICRmbHVzaEhUTUw7CmNvbnN0ICRnZXRBdHRyaWJ1dGVJdCA9IFN5bWJvbCgpOwpleHBvcnRzLiRnZXRBdHRyaWJ1dGVJdCA9ICRnZXRBdHRyaWJ1dGVJdDsKY29uc3QgJGdldEF0dHJpYnV0ZXMgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0QXR0cmlidXRlcyA9ICRnZXRBdHRyaWJ1dGVzOwpjb25zdCAkZ2V0QXZhaWxhYmxlU3BhY2UgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0QXZhaWxhYmxlU3BhY2UgPSAkZ2V0QXZhaWxhYmxlU3BhY2U7CmNvbnN0ICRnZXRDaGlsZHJlbkJ5Q2xhc3MgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0Q2hpbGRyZW5CeUNsYXNzID0gJGdldENoaWxkcmVuQnlDbGFzczsKY29uc3QgJGdldENoaWxkcmVuQnlOYW1lID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdldENoaWxkcmVuQnlOYW1lID0gJGdldENoaWxkcmVuQnlOYW1lOwpjb25zdCAkZ2V0Q2hpbGRyZW5CeU5hbWVJdCA9IFN5bWJvbCgpOwpleHBvcnRzLiRnZXRDaGlsZHJlbkJ5TmFtZUl0ID0gJGdldENoaWxkcmVuQnlOYW1lSXQ7CmNvbnN0ICRnZXREYXRhVmFsdWUgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0RGF0YVZhbHVlID0gJGdldERhdGFWYWx1ZTsKY29uc3QgJGdldEV4dHJhID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdldEV4dHJhID0gJGdldEV4dHJhOwpjb25zdCAkZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXQgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXQgPSAkZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXQ7CmNvbnN0ICRnZXRDaGlsZHJlbiA9IFN5bWJvbCgpOwpleHBvcnRzLiRnZXRDaGlsZHJlbiA9ICRnZXRDaGlsZHJlbjsKY29uc3QgJGdldENvbnRhaW5lZENoaWxkcmVuID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdldENvbnRhaW5lZENoaWxkcmVuID0gJGdldENvbnRhaW5lZENoaWxkcmVuOwpjb25zdCAkZ2V0TmV4dFBhZ2UgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0TmV4dFBhZ2UgPSAkZ2V0TmV4dFBhZ2U7CmNvbnN0ICRnZXRTdWJmb3JtUGFyZW50ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdldFN1YmZvcm1QYXJlbnQgPSAkZ2V0U3ViZm9ybVBhcmVudDsKY29uc3QgJGdldFBhcmVudCA9IFN5bWJvbCgpOwpleHBvcnRzLiRnZXRQYXJlbnQgPSAkZ2V0UGFyZW50Owpjb25zdCAkZ2V0VGVtcGxhdGVSb290ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdldFRlbXBsYXRlUm9vdCA9ICRnZXRUZW1wbGF0ZVJvb3Q7CmNvbnN0ICRnbG9iYWxEYXRhID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdsb2JhbERhdGEgPSAkZ2xvYmFsRGF0YTsKY29uc3QgJGhhc1NldHRhYmxlVmFsdWUgPSBTeW1ib2woKTsKZXhwb3J0cy4kaGFzU2V0dGFibGVWYWx1ZSA9ICRoYXNTZXR0YWJsZVZhbHVlOwpjb25zdCAkaWRzID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlkcyA9ICRpZHM7CmNvbnN0ICRpbmRleE9mID0gU3ltYm9sKCk7CmV4cG9ydHMuJGluZGV4T2YgPSAkaW5kZXhPZjsKY29uc3QgJGluc2VydEF0ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGluc2VydEF0ID0gJGluc2VydEF0Owpjb25zdCAkaXNDREFUQVhtbCA9IFN5bWJvbCgpOwpleHBvcnRzLiRpc0NEQVRBWG1sID0gJGlzQ0RBVEFYbWw7CmNvbnN0ICRpc0JpbmRhYmxlID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlzQmluZGFibGUgPSAkaXNCaW5kYWJsZTsKY29uc3QgJGlzRGF0YVZhbHVlID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlzRGF0YVZhbHVlID0gJGlzRGF0YVZhbHVlOwpjb25zdCAkaXNEZXNjZW5kZW50ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlzRGVzY2VuZGVudCA9ICRpc0Rlc2NlbmRlbnQ7CmNvbnN0ICRpc05zQWdub3N0aWMgPSBTeW1ib2woKTsKZXhwb3J0cy4kaXNOc0Fnbm9zdGljID0gJGlzTnNBZ25vc3RpYzsKY29uc3QgJGlzU3BsaXR0YWJsZSA9IFN5bWJvbCgpOwpleHBvcnRzLiRpc1NwbGl0dGFibGUgPSAkaXNTcGxpdHRhYmxlOwpjb25zdCAkaXNUaGVyZU1vcmVXaWR0aCA9IFN5bWJvbCgpOwpleHBvcnRzLiRpc1RoZXJlTW9yZVdpZHRoID0gJGlzVGhlcmVNb3JlV2lkdGg7CmNvbnN0ICRpc1RyYW5zcGFyZW50ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlzVHJhbnNwYXJlbnQgPSAkaXNUcmFuc3BhcmVudDsKY29uc3QgJGlzVXNhYmxlID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlzVXNhYmxlID0gJGlzVXNhYmxlOwpjb25zdCAkbGFzdEF0dHJpYnV0ZSA9IFN5bWJvbCgpOwpjb25zdCAkbmFtZXNwYWNlSWQgPSBTeW1ib2woIm5hbWVzcGFjZUlkIik7CmV4cG9ydHMuJG5hbWVzcGFjZUlkID0gJG5hbWVzcGFjZUlkOwpjb25zdCAkbm9kZU5hbWUgPSBTeW1ib2woIm5vZGVOYW1lIik7CmV4cG9ydHMuJG5vZGVOYW1lID0gJG5vZGVOYW1lOwpjb25zdCAkbnNBdHRyaWJ1dGVzID0gU3ltYm9sKCk7CmV4cG9ydHMuJG5zQXR0cmlidXRlcyA9ICRuc0F0dHJpYnV0ZXM7CmNvbnN0ICRvbkNoaWxkID0gU3ltYm9sKCk7CmV4cG9ydHMuJG9uQ2hpbGQgPSAkb25DaGlsZDsKY29uc3QgJG9uQ2hpbGRDaGVjayA9IFN5bWJvbCgpOwpleHBvcnRzLiRvbkNoaWxkQ2hlY2sgPSAkb25DaGlsZENoZWNrOwpjb25zdCAkb25UZXh0ID0gU3ltYm9sKCk7CmV4cG9ydHMuJG9uVGV4dCA9ICRvblRleHQ7CmNvbnN0ICRwdXNoR2x5cGhzID0gU3ltYm9sKCk7CmV4cG9ydHMuJHB1c2hHbHlwaHMgPSAkcHVzaEdseXBoczsKY29uc3QgJHBvcFBhcmEgPSBTeW1ib2woKTsKZXhwb3J0cy4kcG9wUGFyYSA9ICRwb3BQYXJhOwpjb25zdCAkcHVzaFBhcmEgPSBTeW1ib2woKTsKZXhwb3J0cy4kcHVzaFBhcmEgPSAkcHVzaFBhcmE7CmNvbnN0ICRyZW1vdmVDaGlsZCA9IFN5bWJvbCgpOwpleHBvcnRzLiRyZW1vdmVDaGlsZCA9ICRyZW1vdmVDaGlsZDsKY29uc3QgJHJvb3QgPSBTeW1ib2woInJvb3QiKTsKZXhwb3J0cy4kcm9vdCA9ICRyb290Owpjb25zdCAkcmVzb2x2ZVByb3RvdHlwZXMgPSBTeW1ib2woKTsKZXhwb3J0cy4kcmVzb2x2ZVByb3RvdHlwZXMgPSAkcmVzb2x2ZVByb3RvdHlwZXM7CmNvbnN0ICRzZWFyY2hOb2RlID0gU3ltYm9sKCk7CmV4cG9ydHMuJHNlYXJjaE5vZGUgPSAkc2VhcmNoTm9kZTsKY29uc3QgJHNldElkID0gU3ltYm9sKCk7CmV4cG9ydHMuJHNldElkID0gJHNldElkOwpjb25zdCAkc2V0U2V0QXR0cmlidXRlcyA9IFN5bWJvbCgpOwpleHBvcnRzLiRzZXRTZXRBdHRyaWJ1dGVzID0gJHNldFNldEF0dHJpYnV0ZXM7CmNvbnN0ICRzZXRWYWx1ZSA9IFN5bWJvbCgpOwpleHBvcnRzLiRzZXRWYWx1ZSA9ICRzZXRWYWx1ZTsKY29uc3QgJHRhYkluZGV4ID0gU3ltYm9sKCk7CmV4cG9ydHMuJHRhYkluZGV4ID0gJHRhYkluZGV4Owpjb25zdCAkdGV4dCA9IFN5bWJvbCgpOwpleHBvcnRzLiR0ZXh0ID0gJHRleHQ7CmNvbnN0ICR0b1BhZ2VzID0gU3ltYm9sKCk7CmV4cG9ydHMuJHRvUGFnZXMgPSAkdG9QYWdlczsKY29uc3QgJHRvSFRNTCA9IFN5bWJvbCgpOwpleHBvcnRzLiR0b0hUTUwgPSAkdG9IVE1MOwpjb25zdCAkdG9TdHJpbmcgPSBTeW1ib2woKTsKZXhwb3J0cy4kdG9TdHJpbmcgPSAkdG9TdHJpbmc7CmNvbnN0ICR0b1N0eWxlID0gU3ltYm9sKCk7CmV4cG9ydHMuJHRvU3R5bGUgPSAkdG9TdHlsZTsKY29uc3QgJHVpZCA9IFN5bWJvbCgidWlkIik7CmV4cG9ydHMuJHVpZCA9ICR1aWQ7Cgpjb25zdCBfYXBwbHlQcm90b3R5cGUgPSBTeW1ib2woKTsKCmNvbnN0IF9hdHRyaWJ1dGVzID0gU3ltYm9sKCk7Cgpjb25zdCBfYXR0cmlidXRlTmFtZXMgPSBTeW1ib2woKTsKCmNvbnN0IF9jaGlsZHJlbiA9IFN5bWJvbCgiX2NoaWxkcmVuIik7Cgpjb25zdCBfY2xvbmVBdHRyaWJ1dGUgPSBTeW1ib2woKTsKCmNvbnN0IF9kYXRhVmFsdWUgPSBTeW1ib2woKTsKCmNvbnN0IF9kZWZhdWx0VmFsdWUgPSBTeW1ib2woKTsKCmNvbnN0IF9maWx0ZXJlZENoaWxkcmVuR2VuZXJhdG9yID0gU3ltYm9sKCk7Cgpjb25zdCBfZ2V0UHJvdG90eXBlID0gU3ltYm9sKCk7Cgpjb25zdCBfZ2V0VW5zZXRBdHRyaWJ1dGVzID0gU3ltYm9sKCk7Cgpjb25zdCBfaGFzQ2hpbGRyZW4gPSBTeW1ib2woKTsKCmNvbnN0IF9tYXggPSBTeW1ib2woKTsKCmNvbnN0IF9vcHRpb25zID0gU3ltYm9sKCk7Cgpjb25zdCBfcGFyZW50ID0gU3ltYm9sKCJwYXJlbnQiKTsKCmNvbnN0IF9yZXNvbHZlUHJvdG90eXBlc0hlbHBlciA9IFN5bWJvbCgpOwoKY29uc3QgX3NldEF0dHJpYnV0ZXMgPSBTeW1ib2woKTsKCmNvbnN0IF92YWxpZGF0b3IgPSBTeW1ib2woKTsKCmxldCB1aWQgPSAwOwpjb25zdCBOU19EQVRBU0VUUyA9IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy5kYXRhc2V0cy5pZDsKCmNsYXNzIFhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IobnNJZCwgbmFtZSkgewogICAgbGV0IGhhc0NoaWxkcmVuID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKICAgIHRoaXNbJG5hbWVzcGFjZUlkXSA9IG5zSWQ7CiAgICB0aGlzWyRub2RlTmFtZV0gPSBuYW1lOwogICAgdGhpc1tfaGFzQ2hpbGRyZW5dID0gaGFzQ2hpbGRyZW47CiAgICB0aGlzW19wYXJlbnRdID0gbnVsbDsKICAgIHRoaXNbX2NoaWxkcmVuXSA9IFtdOwogICAgdGhpc1skdWlkXSA9IGAke25hbWV9JHt1aWQrK31gOwogICAgdGhpc1skZ2xvYmFsRGF0YV0gPSBudWxsOwogIH0KCiAgWyRvbkNoaWxkXShjaGlsZCkgewogICAgaWYgKCF0aGlzW19oYXNDaGlsZHJlbl0gfHwgIXRoaXNbJG9uQ2hpbGRDaGVja10oY2hpbGQpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBjb25zdCBuYW1lID0gY2hpbGRbJG5vZGVOYW1lXTsKICAgIGNvbnN0IG5vZGUgPSB0aGlzW25hbWVdOwoKICAgIGlmIChub2RlIGluc3RhbmNlb2YgWEZBT2JqZWN0QXJyYXkpIHsKICAgICAgaWYgKG5vZGUucHVzaChjaGlsZCkpIHsKICAgICAgICB0aGlzWyRhcHBlbmRDaGlsZF0oY2hpbGQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAobm9kZSAhPT0gbnVsbCkgewogICAgICAgIHRoaXNbJHJlbW92ZUNoaWxkXShub2RlKTsKICAgICAgfQoKICAgICAgdGhpc1tuYW1lXSA9IGNoaWxkOwogICAgICB0aGlzWyRhcHBlbmRDaGlsZF0oY2hpbGQpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBsZXQgaWQgPSAiIjsKCiAgICBpZiAodGhpcy5pZCkgewogICAgICBpZCA9IGAgKGlkOiAke3RoaXMuaWR9KWA7CiAgICB9IGVsc2UgaWYgKHRoaXMubmFtZSkgewogICAgICBpZCA9IGAgKG5hbWU6ICR7dGhpcy5uYW1lfSAke3RoaXMuaC52YWx1ZX0pYDsKICAgIH0KCiAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIG5vZGUgIiR7dGhpc1skbm9kZU5hbWVdfSIke2lkfSBoYXMgYWxyZWFkeSBlbm91Z2ggIiR7bmFtZX0iIWApOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgWyRvbkNoaWxkQ2hlY2tdKGNoaWxkKSB7CiAgICByZXR1cm4gdGhpcy5oYXNPd25Qcm9wZXJ0eShjaGlsZFskbm9kZU5hbWVdKSAmJiBjaGlsZFskbmFtZXNwYWNlSWRdID09PSB0aGlzWyRuYW1lc3BhY2VJZF07CiAgfQoKICBbJGlzTnNBZ25vc3RpY10oKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBbJGFjY2VwdFdoaXRlc3BhY2VdKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgWyRpc0NEQVRBWG1sXSgpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIFskaXNCaW5kYWJsZV0oKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBbJHBvcFBhcmFdKCkgewogICAgaWYgKHRoaXMucGFyYSkgewogICAgICB0aGlzWyRnZXRUZW1wbGF0ZVJvb3RdKClbJGV4dHJhXS5wYXJhU3RhY2sucG9wKCk7CiAgICB9CiAgfQoKICBbJHB1c2hQYXJhXSgpIHsKICAgIHRoaXNbJGdldFRlbXBsYXRlUm9vdF0oKVskZXh0cmFdLnBhcmFTdGFjay5wdXNoKHRoaXMucGFyYSk7CiAgfQoKICBbJHNldElkXShpZHMpIHsKICAgIGlmICh0aGlzLmlkICYmIHRoaXNbJG5hbWVzcGFjZUlkXSA9PT0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLnRlbXBsYXRlLmlkKSB7CiAgICAgIGlkcy5zZXQodGhpcy5pZCwgdGhpcyk7CiAgICB9CiAgfQoKICBbJGdldFRlbXBsYXRlUm9vdF0oKSB7CiAgICByZXR1cm4gdGhpc1skZ2xvYmFsRGF0YV0udGVtcGxhdGU7CiAgfQoKICBbJGlzU3BsaXR0YWJsZV0oKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBbJGlzVGhlcmVNb3JlV2lkdGhdKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgWyRhcHBlbmRDaGlsZF0oY2hpbGQpIHsKICAgIGNoaWxkW19wYXJlbnRdID0gdGhpczsKCiAgICB0aGlzW19jaGlsZHJlbl0ucHVzaChjaGlsZCk7CgogICAgaWYgKCFjaGlsZFskZ2xvYmFsRGF0YV0gJiYgdGhpc1skZ2xvYmFsRGF0YV0pIHsKICAgICAgY2hpbGRbJGdsb2JhbERhdGFdID0gdGhpc1skZ2xvYmFsRGF0YV07CiAgICB9CiAgfQoKICBbJHJlbW92ZUNoaWxkXShjaGlsZCkgewogICAgY29uc3QgaSA9IHRoaXNbX2NoaWxkcmVuXS5pbmRleE9mKGNoaWxkKTsKCiAgICB0aGlzW19jaGlsZHJlbl0uc3BsaWNlKGksIDEpOwogIH0KCiAgWyRoYXNTZXR0YWJsZVZhbHVlXSgpIHsKICAgIHJldHVybiB0aGlzLmhhc093blByb3BlcnR5KCJ2YWx1ZSIpOwogIH0KCiAgWyRzZXRWYWx1ZV0oXykge30KCiAgWyRvblRleHRdKF8pIHt9CgogIFskZmluYWxpemVdKCkge30KCiAgWyRjbGVhbl0oYnVpbGRlcikgewogICAgZGVsZXRlIHRoaXNbX2hhc0NoaWxkcmVuXTsKCiAgICBpZiAodGhpc1skY2xlYW51cF0pIHsKICAgICAgYnVpbGRlci5jbGVhbih0aGlzWyRjbGVhbnVwXSk7CiAgICAgIGRlbGV0ZSB0aGlzWyRjbGVhbnVwXTsKICAgIH0KICB9CgogIFskaW5kZXhPZl0oY2hpbGQpIHsKICAgIHJldHVybiB0aGlzW19jaGlsZHJlbl0uaW5kZXhPZihjaGlsZCk7CiAgfQoKICBbJGluc2VydEF0XShpLCBjaGlsZCkgewogICAgY2hpbGRbX3BhcmVudF0gPSB0aGlzOwoKICAgIHRoaXNbX2NoaWxkcmVuXS5zcGxpY2UoaSwgMCwgY2hpbGQpOwoKICAgIGlmICghY2hpbGRbJGdsb2JhbERhdGFdICYmIHRoaXNbJGdsb2JhbERhdGFdKSB7CiAgICAgIGNoaWxkWyRnbG9iYWxEYXRhXSA9IHRoaXNbJGdsb2JhbERhdGFdOwogICAgfQogIH0KCiAgWyRpc1RyYW5zcGFyZW50XSgpIHsKICAgIHJldHVybiAhdGhpcy5uYW1lOwogIH0KCiAgWyRsYXN0QXR0cmlidXRlXSgpIHsKICAgIHJldHVybiAiIjsKICB9CgogIFskdGV4dF0oKSB7CiAgICBpZiAodGhpc1tfY2hpbGRyZW5dLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gdGhpc1skY29udGVudF07CiAgICB9CgogICAgcmV0dXJuIHRoaXNbX2NoaWxkcmVuXS5tYXAoYyA9PiBjWyR0ZXh0XSgpKS5qb2luKCIiKTsKICB9CgogIGdldCBbX2F0dHJpYnV0ZU5hbWVzXSgpIHsKICAgIGNvbnN0IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpOwoKICAgIGlmICghcHJvdG8uX2F0dHJpYnV0ZXMpIHsKICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHByb3RvLl9hdHRyaWJ1dGVzID0gbmV3IFNldCgpOwoKICAgICAgZm9yIChjb25zdCBuYW1lIG9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKSB7CiAgICAgICAgaWYgKHRoaXNbbmFtZV0gPT09IG51bGwgfHwgdGhpc1tuYW1lXSBpbnN0YW5jZW9mIFhGQU9iamVjdCB8fCB0aGlzW25hbWVdIGluc3RhbmNlb2YgWEZBT2JqZWN0QXJyYXkpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgYXR0cmlidXRlcy5hZGQobmFtZSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgX2F0dHJpYnV0ZU5hbWVzLCBwcm90by5fYXR0cmlidXRlcyk7CiAgfQoKICBbJGlzRGVzY2VuZGVudF0ocGFyZW50KSB7CiAgICBsZXQgbm9kZSA9IHRoaXM7CgogICAgd2hpbGUgKG5vZGUpIHsKICAgICAgaWYgKG5vZGUgPT09IHBhcmVudCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBub2RlID0gbm9kZVskZ2V0UGFyZW50XSgpOwogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIFskZ2V0UGFyZW50XSgpIHsKICAgIHJldHVybiB0aGlzW19wYXJlbnRdOwogIH0KCiAgWyRnZXRTdWJmb3JtUGFyZW50XSgpIHsKICAgIHJldHVybiB0aGlzWyRnZXRQYXJlbnRdKCk7CiAgfQoKICBbJGdldENoaWxkcmVuXSgpIHsKICAgIGxldCBuYW1lID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsOwoKICAgIGlmICghbmFtZSkgewogICAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dOwogICAgfQoKICAgIHJldHVybiB0aGlzW25hbWVdOwogIH0KCiAgWyRkdW1wXSgpIHsKICAgIGNvbnN0IGR1bXBlZCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgaWYgKHRoaXNbJGNvbnRlbnRdKSB7CiAgICAgIGR1bXBlZC4kY29udGVudCA9IHRoaXNbJGNvbnRlbnRdOwogICAgfQoKICAgIGZvciAoY29uc3QgbmFtZSBvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkgewogICAgICBjb25zdCB2YWx1ZSA9IHRoaXNbbmFtZV07CgogICAgICBpZiAodmFsdWUgPT09IG51bGwpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgWEZBT2JqZWN0KSB7CiAgICAgICAgZHVtcGVkW25hbWVdID0gdmFsdWVbJGR1bXBdKCk7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBYRkFPYmplY3RBcnJheSkgewogICAgICAgIGlmICghdmFsdWUuaXNFbXB0eSgpKSB7CiAgICAgICAgICBkdW1wZWRbbmFtZV0gPSB2YWx1ZS5kdW1wKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGR1bXBlZFtuYW1lXSA9IHZhbHVlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGR1bXBlZDsKICB9CgogIFskdG9TdHlsZV0oKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIFskdG9IVE1MXSgpIHsKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICB9CgogICpbJGdldENvbnRhaW5lZENoaWxkcmVuXSgpIHsKICAgIGZvciAoY29uc3Qgbm9kZSBvZiB0aGlzWyRnZXRDaGlsZHJlbl0oKSkgewogICAgICB5aWVsZCBub2RlOwogICAgfQogIH0KCiAgKltfZmlsdGVyZWRDaGlsZHJlbkdlbmVyYXRvcl0oZmlsdGVyLCBpbmNsdWRlKSB7CiAgICBmb3IgKGNvbnN0IG5vZGUgb2YgdGhpc1skZ2V0Q29udGFpbmVkQ2hpbGRyZW5dKCkpIHsKICAgICAgaWYgKCFmaWx0ZXIgfHwgaW5jbHVkZSA9PT0gZmlsdGVyLmhhcyhub2RlWyRub2RlTmFtZV0pKSB7CiAgICAgICAgY29uc3QgYXZhaWxhYmxlU3BhY2UgPSB0aGlzWyRnZXRBdmFpbGFibGVTcGFjZV0oKTsKICAgICAgICBjb25zdCByZXMgPSBub2RlWyR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKTsKCiAgICAgICAgaWYgKCFyZXMuc3VjY2VzcykgewogICAgICAgICAgdGhpc1skZXh0cmFdLmZhaWxpbmdOb2RlID0gbm9kZTsKICAgICAgICB9CgogICAgICAgIHlpZWxkIHJlczsKICAgICAgfQogICAgfQogIH0KCiAgWyRmbHVzaEhUTUxdKCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBbJGFkZEhUTUxdKGh0bWwsIGJib3gpIHsKICAgIHRoaXNbJGV4dHJhXS5jaGlsZHJlbi5wdXNoKGh0bWwpOwogIH0KCiAgWyRnZXRBdmFpbGFibGVTcGFjZV0oKSB7fQoKICBbJGNoaWxkcmVuVG9IVE1MXShfcmVmKSB7CiAgICBsZXQgewogICAgICBmaWx0ZXIgPSBudWxsLAogICAgICBpbmNsdWRlID0gdHJ1ZQogICAgfSA9IF9yZWY7CgogICAgaWYgKCF0aGlzWyRleHRyYV0uZ2VuZXJhdG9yKSB7CiAgICAgIHRoaXNbJGV4dHJhXS5nZW5lcmF0b3IgPSB0aGlzW19maWx0ZXJlZENoaWxkcmVuR2VuZXJhdG9yXShmaWx0ZXIsIGluY2x1ZGUpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgYXZhaWxhYmxlU3BhY2UgPSB0aGlzWyRnZXRBdmFpbGFibGVTcGFjZV0oKTsKICAgICAgY29uc3QgcmVzID0gdGhpc1skZXh0cmFdLmZhaWxpbmdOb2RlWyR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKTsKCiAgICAgIGlmICghcmVzLnN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gcmVzOwogICAgICB9CgogICAgICBpZiAocmVzLmh0bWwpIHsKICAgICAgICB0aGlzWyRhZGRIVE1MXShyZXMuaHRtbCwgcmVzLmJib3gpOwogICAgICB9CgogICAgICBkZWxldGUgdGhpc1skZXh0cmFdLmZhaWxpbmdOb2RlOwogICAgfQoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGNvbnN0IGdlbiA9IHRoaXNbJGV4dHJhXS5nZW5lcmF0b3IubmV4dCgpOwoKICAgICAgaWYgKGdlbi5kb25lKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlcyA9IGdlbi52YWx1ZTsKCiAgICAgIGlmICghcmVzLnN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gcmVzOwogICAgICB9CgogICAgICBpZiAocmVzLmh0bWwpIHsKICAgICAgICB0aGlzWyRhZGRIVE1MXShyZXMuaHRtbCwgcmVzLmJib3gpOwogICAgICB9CiAgICB9CgogICAgdGhpc1skZXh0cmFdLmdlbmVyYXRvciA9IG51bGw7CiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgfQoKICBbJHNldFNldEF0dHJpYnV0ZXNdKGF0dHJpYnV0ZXMpIHsKICAgIHRoaXNbX3NldEF0dHJpYnV0ZXNdID0gbmV3IFNldChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSk7CiAgfQoKICBbX2dldFVuc2V0QXR0cmlidXRlc10ocHJvdG9BdHRyaWJ1dGVzKSB7CiAgICBjb25zdCBhbGxBdHRyID0gdGhpc1tfYXR0cmlidXRlTmFtZXNdOwogICAgY29uc3Qgc2V0QXR0ciA9IHRoaXNbX3NldEF0dHJpYnV0ZXNdOwogICAgcmV0dXJuIFsuLi5wcm90b0F0dHJpYnV0ZXNdLmZpbHRlcih4ID0+IGFsbEF0dHIuaGFzKHgpICYmICFzZXRBdHRyLmhhcyh4KSk7CiAgfQoKICBbJHJlc29sdmVQcm90b3R5cGVzXShpZHMpIHsKICAgIGxldCBhbmNlc3RvcnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IG5ldyBTZXQoKTsKCiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXNbX2NoaWxkcmVuXSkgewogICAgICBjaGlsZFtfcmVzb2x2ZVByb3RvdHlwZXNIZWxwZXJdKGlkcywgYW5jZXN0b3JzKTsKICAgIH0KICB9CgogIFtfcmVzb2x2ZVByb3RvdHlwZXNIZWxwZXJdKGlkcywgYW5jZXN0b3JzKSB7CiAgICBjb25zdCBwcm90byA9IHRoaXNbX2dldFByb3RvdHlwZV0oaWRzLCBhbmNlc3RvcnMpOwoKICAgIGlmIChwcm90bykgewogICAgICB0aGlzW19hcHBseVByb3RvdHlwZV0ocHJvdG8sIGlkcywgYW5jZXN0b3JzKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXNbJHJlc29sdmVQcm90b3R5cGVzXShpZHMsIGFuY2VzdG9ycyk7CiAgICB9CiAgfQoKICBbX2dldFByb3RvdHlwZV0oaWRzLCBhbmNlc3RvcnMpIHsKICAgIGNvbnN0IHsKICAgICAgdXNlLAogICAgICB1c2VocmVmCiAgICB9ID0gdGhpczsKCiAgICBpZiAoIXVzZSAmJiAhdXNlaHJlZikgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBsZXQgcHJvdG8gPSBudWxsOwogICAgbGV0IHNvbUV4cHJlc3Npb24gPSBudWxsOwogICAgbGV0IGlkID0gbnVsbDsKICAgIGxldCByZWYgPSB1c2U7CgogICAgaWYgKHVzZWhyZWYpIHsKICAgICAgcmVmID0gdXNlaHJlZjsKCiAgICAgIGlmICh1c2VocmVmLnN0YXJ0c1dpdGgoIiNzb20oIikgJiYgdXNlaHJlZi5lbmRzV2l0aCgiKSIpKSB7CiAgICAgICAgc29tRXhwcmVzc2lvbiA9IHVzZWhyZWYuc2xpY2UoIiNzb20oIi5sZW5ndGgsIHVzZWhyZWYubGVuZ3RoIC0gMSk7CiAgICAgIH0gZWxzZSBpZiAodXNlaHJlZi5zdGFydHNXaXRoKCIuI3NvbSgiKSAmJiB1c2VocmVmLmVuZHNXaXRoKCIpIikpIHsKICAgICAgICBzb21FeHByZXNzaW9uID0gdXNlaHJlZi5zbGljZSgiLiNzb20oIi5sZW5ndGgsIHVzZWhyZWYubGVuZ3RoIC0gMSk7CiAgICAgIH0gZWxzZSBpZiAodXNlaHJlZi5zdGFydHNXaXRoKCIjIikpIHsKICAgICAgICBpZCA9IHVzZWhyZWYuc2xpY2UoMSk7CiAgICAgIH0gZWxzZSBpZiAodXNlaHJlZi5zdGFydHNXaXRoKCIuIyIpKSB7CiAgICAgICAgaWQgPSB1c2VocmVmLnNsaWNlKDIpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKHVzZS5zdGFydHNXaXRoKCIjIikpIHsKICAgICAgaWQgPSB1c2Uuc2xpY2UoMSk7CiAgICB9IGVsc2UgewogICAgICBzb21FeHByZXNzaW9uID0gdXNlOwogICAgfQoKICAgIHRoaXMudXNlID0gdGhpcy51c2VocmVmID0gIiI7CgogICAgaWYgKGlkKSB7CiAgICAgIHByb3RvID0gaWRzLmdldChpZCk7CiAgICB9IGVsc2UgewogICAgICBwcm90byA9ICgwLCBfc29tLnNlYXJjaE5vZGUpKGlkcy5nZXQoJHJvb3QpLCB0aGlzLCBzb21FeHByZXNzaW9uLCB0cnVlLCBmYWxzZSk7CgogICAgICBpZiAocHJvdG8pIHsKICAgICAgICBwcm90byA9IHByb3RvWzBdOwogICAgICB9CiAgICB9CgogICAgaWYgKCFwcm90bykgewogICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEludmFsaWQgcHJvdG90eXBlIHJlZmVyZW5jZTogJHtyZWZ9LmApOwogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBpZiAocHJvdG9bJG5vZGVOYW1lXSAhPT0gdGhpc1skbm9kZU5hbWVdKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gSW5jb21wYXRpYmxlIHByb3RvdHlwZTogJHtwcm90b1skbm9kZU5hbWVdfSAhPT0gJHt0aGlzWyRub2RlTmFtZV19LmApOwogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBpZiAoYW5jZXN0b3JzLmhhcyhwcm90bykpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBDeWNsZSBkZXRlY3RlZCBpbiBwcm90b3R5cGVzIHVzZS5gKTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgYW5jZXN0b3JzLmFkZChwcm90byk7CgogICAgY29uc3QgcHJvdG9Qcm90byA9IHByb3RvW19nZXRQcm90b3R5cGVdKGlkcywgYW5jZXN0b3JzKTsKCiAgICBpZiAocHJvdG9Qcm90bykgewogICAgICBwcm90b1tfYXBwbHlQcm90b3R5cGVdKHByb3RvUHJvdG8sIGlkcywgYW5jZXN0b3JzKTsKICAgIH0KCiAgICBwcm90b1skcmVzb2x2ZVByb3RvdHlwZXNdKGlkcywgYW5jZXN0b3JzKTsKICAgIGFuY2VzdG9ycy5kZWxldGUocHJvdG8pOwogICAgcmV0dXJuIHByb3RvOwogIH0KCiAgW19hcHBseVByb3RvdHlwZV0ocHJvdG8sIGlkcywgYW5jZXN0b3JzKSB7CiAgICBpZiAoYW5jZXN0b3JzLmhhcyhwcm90bykpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBDeWNsZSBkZXRlY3RlZCBpbiBwcm90b3R5cGVzIHVzZS5gKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICghdGhpc1skY29udGVudF0gJiYgcHJvdG9bJGNvbnRlbnRdKSB7CiAgICAgIHRoaXNbJGNvbnRlbnRdID0gcHJvdG9bJGNvbnRlbnRdOwogICAgfQoKICAgIGNvbnN0IG5ld0FuY2VzdG9ycyA9IG5ldyBTZXQoYW5jZXN0b3JzKTsKICAgIG5ld0FuY2VzdG9ycy5hZGQocHJvdG8pOwoKICAgIGZvciAoY29uc3QgdW5zZXRBdHRyTmFtZSBvZiB0aGlzW19nZXRVbnNldEF0dHJpYnV0ZXNdKHByb3RvW19zZXRBdHRyaWJ1dGVzXSkpIHsKICAgICAgdGhpc1t1bnNldEF0dHJOYW1lXSA9IHByb3RvW3Vuc2V0QXR0ck5hbWVdOwoKICAgICAgaWYgKHRoaXNbX3NldEF0dHJpYnV0ZXNdKSB7CiAgICAgICAgdGhpc1tfc2V0QXR0cmlidXRlc10uYWRkKHVuc2V0QXR0ck5hbWUpOwogICAgICB9CiAgICB9CgogICAgZm9yIChjb25zdCBuYW1lIG9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKSB7CiAgICAgIGlmICh0aGlzW19hdHRyaWJ1dGVOYW1lc10uaGFzKG5hbWUpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZhbHVlID0gdGhpc1tuYW1lXTsKICAgICAgY29uc3QgcHJvdG9WYWx1ZSA9IHByb3RvW25hbWVdOwoKICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgWEZBT2JqZWN0QXJyYXkpIHsKICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHZhbHVlW19jaGlsZHJlbl0pIHsKICAgICAgICAgIGNoaWxkW19yZXNvbHZlUHJvdG90eXBlc0hlbHBlcl0oaWRzLCBhbmNlc3RvcnMpOwogICAgICAgIH0KCiAgICAgICAgZm9yIChsZXQgaSA9IHZhbHVlW19jaGlsZHJlbl0ubGVuZ3RoLCBpaSA9IHByb3RvVmFsdWVbX2NoaWxkcmVuXS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICBjb25zdCBjaGlsZCA9IHByb3RvW19jaGlsZHJlbl1baV1bJGNsb25lXSgpOwoKICAgICAgICAgIGlmICh2YWx1ZS5wdXNoKGNoaWxkKSkgewogICAgICAgICAgICBjaGlsZFtfcGFyZW50XSA9IHRoaXM7CgogICAgICAgICAgICB0aGlzW19jaGlsZHJlbl0ucHVzaChjaGlsZCk7CgogICAgICAgICAgICBjaGlsZFtfcmVzb2x2ZVByb3RvdHlwZXNIZWxwZXJdKGlkcywgYW5jZXN0b3JzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkgewogICAgICAgIHZhbHVlWyRyZXNvbHZlUHJvdG90eXBlc10oaWRzLCBhbmNlc3RvcnMpOwoKICAgICAgICBpZiAocHJvdG9WYWx1ZSkgewogICAgICAgICAgdmFsdWVbX2FwcGx5UHJvdG90eXBlXShwcm90b1ZhbHVlLCBpZHMsIGFuY2VzdG9ycyk7CiAgICAgICAgfQoKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKHByb3RvVmFsdWUgIT09IG51bGwpIHsKICAgICAgICBjb25zdCBjaGlsZCA9IHByb3RvVmFsdWVbJGNsb25lXSgpOwogICAgICAgIGNoaWxkW19wYXJlbnRdID0gdGhpczsKICAgICAgICB0aGlzW25hbWVdID0gY2hpbGQ7CgogICAgICAgIHRoaXNbX2NoaWxkcmVuXS5wdXNoKGNoaWxkKTsKCiAgICAgICAgY2hpbGRbX3Jlc29sdmVQcm90b3R5cGVzSGVscGVyXShpZHMsIGFuY2VzdG9ycyk7CiAgICAgIH0KICAgIH0KICB9CgogIHN0YXRpYyBbX2Nsb25lQXR0cmlidXRlXShvYmopIHsKICAgIGlmIChBcnJheS5pc0FycmF5KG9iaikpIHsKICAgICAgcmV0dXJuIG9iai5tYXAoeCA9PiBYRkFPYmplY3RbX2Nsb25lQXR0cmlidXRlXSh4KSk7CiAgICB9CgogICAgaWYgKHR5cGVvZiBvYmogPT09ICJvYmplY3QiICYmIG9iaiAhPT0gbnVsbCkgewogICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgb2JqKTsKICAgIH0KCiAgICByZXR1cm4gb2JqOwogIH0KCiAgWyRjbG9uZV0oKSB7CiAgICBjb25zdCBjbG9uZSA9IE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpKTsKCiAgICBmb3IgKGNvbnN0ICRzeW1ib2wgb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyh0aGlzKSkgewogICAgICB0cnkgewogICAgICAgIGNsb25lWyRzeW1ib2xdID0gdGhpc1skc3ltYm9sXTsKICAgICAgfSBjYXRjaCAoXykgewogICAgICAgICgwLCBfdXRpbC5zaGFkb3cpKGNsb25lLCAkc3ltYm9sLCB0aGlzWyRzeW1ib2xdKTsKICAgICAgfQogICAgfQoKICAgIGNsb25lWyR1aWRdID0gYCR7Y2xvbmVbJG5vZGVOYW1lXX0ke3VpZCsrfWA7CiAgICBjbG9uZVtfY2hpbGRyZW5dID0gW107CgogICAgZm9yIChjb25zdCBuYW1lIG9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKSB7CiAgICAgIGlmICh0aGlzW19hdHRyaWJ1dGVOYW1lc10uaGFzKG5hbWUpKSB7CiAgICAgICAgY2xvbmVbbmFtZV0gPSBYRkFPYmplY3RbX2Nsb25lQXR0cmlidXRlXSh0aGlzW25hbWVdKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgdmFsdWUgPSB0aGlzW25hbWVdOwoKICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgWEZBT2JqZWN0QXJyYXkpIHsKICAgICAgICBjbG9uZVtuYW1lXSA9IG5ldyBYRkFPYmplY3RBcnJheSh2YWx1ZVtfbWF4XSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2xvbmVbbmFtZV0gPSBudWxsOwogICAgICB9CiAgICB9CgogICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzW19jaGlsZHJlbl0pIHsKICAgICAgY29uc3QgbmFtZSA9IGNoaWxkWyRub2RlTmFtZV07CiAgICAgIGNvbnN0IGNsb25lZENoaWxkID0gY2hpbGRbJGNsb25lXSgpOwoKICAgICAgY2xvbmVbX2NoaWxkcmVuXS5wdXNoKGNsb25lZENoaWxkKTsKCiAgICAgIGNsb25lZENoaWxkW19wYXJlbnRdID0gY2xvbmU7CgogICAgICBpZiAoY2xvbmVbbmFtZV0gPT09IG51bGwpIHsKICAgICAgICBjbG9uZVtuYW1lXSA9IGNsb25lZENoaWxkOwogICAgICB9IGVsc2UgewogICAgICAgIGNsb25lW25hbWVdW19jaGlsZHJlbl0ucHVzaChjbG9uZWRDaGlsZCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gY2xvbmU7CiAgfQoKICBbJGdldENoaWxkcmVuXSgpIHsKICAgIGxldCBuYW1lID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsOwoKICAgIGlmICghbmFtZSkgewogICAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dOwogICAgfQoKICAgIHJldHVybiB0aGlzW19jaGlsZHJlbl0uZmlsdGVyKGMgPT4gY1skbm9kZU5hbWVdID09PSBuYW1lKTsKICB9CgogIFskZ2V0Q2hpbGRyZW5CeUNsYXNzXShuYW1lKSB7CiAgICByZXR1cm4gdGhpc1tuYW1lXTsKICB9CgogIFskZ2V0Q2hpbGRyZW5CeU5hbWVdKG5hbWUsIGFsbFRyYW5zcGFyZW50KSB7CiAgICBsZXQgZmlyc3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHRydWU7CiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzWyRnZXRDaGlsZHJlbkJ5TmFtZUl0XShuYW1lLCBhbGxUcmFuc3BhcmVudCwgZmlyc3QpKTsKICB9CgogICpbJGdldENoaWxkcmVuQnlOYW1lSXRdKG5hbWUsIGFsbFRyYW5zcGFyZW50KSB7CiAgICBsZXQgZmlyc3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHRydWU7CgogICAgaWYgKG5hbWUgPT09ICJwYXJlbnQiKSB7CiAgICAgIHlpZWxkIHRoaXNbX3BhcmVudF07CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXNbX2NoaWxkcmVuXSkgewogICAgICBpZiAoY2hpbGRbJG5vZGVOYW1lXSA9PT0gbmFtZSkgewogICAgICAgIHlpZWxkIGNoaWxkOwogICAgICB9CgogICAgICBpZiAoY2hpbGQubmFtZSA9PT0gbmFtZSkgewogICAgICAgIHlpZWxkIGNoaWxkOwogICAgICB9CgogICAgICBpZiAoYWxsVHJhbnNwYXJlbnQgfHwgY2hpbGRbJGlzVHJhbnNwYXJlbnRdKCkpIHsKICAgICAgICB5aWVsZCogY2hpbGRbJGdldENoaWxkcmVuQnlOYW1lSXRdKG5hbWUsIGFsbFRyYW5zcGFyZW50LCBmYWxzZSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoZmlyc3QgJiYgdGhpc1tfYXR0cmlidXRlTmFtZXNdLmhhcyhuYW1lKSkgewogICAgICB5aWVsZCBuZXcgWEZBQXR0cmlidXRlKHRoaXMsIG5hbWUsIHRoaXNbbmFtZV0pOwogICAgfQogIH0KCn0KCmV4cG9ydHMuWEZBT2JqZWN0ID0gWEZBT2JqZWN0OwoKY2xhc3MgWEZBT2JqZWN0QXJyYXkgewogIGNvbnN0cnVjdG9yKCkgewogICAgbGV0IG1heCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogSW5maW5pdHk7CiAgICB0aGlzW19tYXhdID0gbWF4OwogICAgdGhpc1tfY2hpbGRyZW5dID0gW107CiAgfQoKICBwdXNoKGNoaWxkKSB7CiAgICBjb25zdCBsZW4gPSB0aGlzW19jaGlsZHJlbl0ubGVuZ3RoOwoKICAgIGlmIChsZW4gPD0gdGhpc1tfbWF4XSkgewogICAgICB0aGlzW19jaGlsZHJlbl0ucHVzaChjaGlsZCk7CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIG5vZGUgIiR7Y2hpbGRbJG5vZGVOYW1lXX0iIGFjY2VwdHMgbm8gbW9yZSB0aGFuICR7dGhpc1tfbWF4XX0gY2hpbGRyZW5gKTsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGlzRW1wdHkoKSB7CiAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dLmxlbmd0aCA9PT0gMDsKICB9CgogIGR1bXAoKSB7CiAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dLmxlbmd0aCA9PT0gMSA/IHRoaXNbX2NoaWxkcmVuXVswXVskZHVtcF0oKSA6IHRoaXNbX2NoaWxkcmVuXS5tYXAoeCA9PiB4WyRkdW1wXSgpKTsKICB9CgogIFskY2xvbmVdKCkgewogICAgY29uc3QgY2xvbmUgPSBuZXcgWEZBT2JqZWN0QXJyYXkodGhpc1tfbWF4XSk7CiAgICBjbG9uZVtfY2hpbGRyZW5dID0gdGhpc1tfY2hpbGRyZW5dLm1hcChjID0+IGNbJGNsb25lXSgpKTsKICAgIHJldHVybiBjbG9uZTsKICB9CgogIGdldCBjaGlsZHJlbigpIHsKICAgIHJldHVybiB0aGlzW19jaGlsZHJlbl07CiAgfQoKICBjbGVhcigpIHsKICAgIHRoaXNbX2NoaWxkcmVuXS5sZW5ndGggPSAwOwogIH0KCn0KCmV4cG9ydHMuWEZBT2JqZWN0QXJyYXkgPSBYRkFPYmplY3RBcnJheTsKCmNsYXNzIFhGQUF0dHJpYnV0ZSB7CiAgY29uc3RydWN0b3Iobm9kZSwgbmFtZSwgdmFsdWUpIHsKICAgIHRoaXNbX3BhcmVudF0gPSBub2RlOwogICAgdGhpc1skbm9kZU5hbWVdID0gbmFtZTsKICAgIHRoaXNbJGNvbnRlbnRdID0gdmFsdWU7CiAgICB0aGlzWyRjb25zdW1lZF0gPSBmYWxzZTsKICAgIHRoaXNbJHVpZF0gPSBgYXR0cmlidXRlJHt1aWQrK31gOwogIH0KCiAgWyRnZXRQYXJlbnRdKCkgewogICAgcmV0dXJuIHRoaXNbX3BhcmVudF07CiAgfQoKICBbJGlzRGF0YVZhbHVlXSgpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgWyRnZXREYXRhVmFsdWVdKCkgewogICAgcmV0dXJuIHRoaXNbJGNvbnRlbnRdLnRyaW0oKTsKICB9CgogIFskc2V0VmFsdWVdKHZhbHVlKSB7CiAgICB2YWx1ZSA9IHZhbHVlLnZhbHVlIHx8ICIiOwogICAgdGhpc1skY29udGVudF0gPSB2YWx1ZS50b1N0cmluZygpOwogIH0KCiAgWyR0ZXh0XSgpIHsKICAgIHJldHVybiB0aGlzWyRjb250ZW50XTsKICB9CgogIFskaXNEZXNjZW5kZW50XShwYXJlbnQpIHsKICAgIHJldHVybiB0aGlzW19wYXJlbnRdID09PSBwYXJlbnQgfHwgdGhpc1tfcGFyZW50XVskaXNEZXNjZW5kZW50XShwYXJlbnQpOwogIH0KCn0KCmV4cG9ydHMuWEZBQXR0cmlidXRlID0gWEZBQXR0cmlidXRlOwoKY2xhc3MgWG1sT2JqZWN0IGV4dGVuZHMgWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3Rvcihuc0lkLCBuYW1lKSB7CiAgICBsZXQgYXR0cmlidXRlcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307CiAgICBzdXBlcihuc0lkLCBuYW1lKTsKICAgIHRoaXNbJGNvbnRlbnRdID0gIiI7CiAgICB0aGlzW19kYXRhVmFsdWVdID0gbnVsbDsKCiAgICBpZiAobmFtZSAhPT0gIiN0ZXh0IikgewogICAgICBjb25zdCBtYXAgPSBuZXcgTWFwKCk7CiAgICAgIHRoaXNbX2F0dHJpYnV0ZXNdID0gbWFwOwoKICAgICAgZm9yIChjb25zdCBbYXR0ck5hbWUsIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhhdHRyaWJ1dGVzKSkgewogICAgICAgIG1hcC5zZXQoYXR0ck5hbWUsIG5ldyBYRkFBdHRyaWJ1dGUodGhpcywgYXR0ck5hbWUsIHZhbHVlKSk7CiAgICAgIH0KCiAgICAgIGlmIChhdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KCRuc0F0dHJpYnV0ZXMpKSB7CiAgICAgICAgY29uc3QgZGF0YU5vZGUgPSBhdHRyaWJ1dGVzWyRuc0F0dHJpYnV0ZXNdLnhmYS5kYXRhTm9kZTsKCiAgICAgICAgaWYgKGRhdGFOb2RlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmIChkYXRhTm9kZSA9PT0gImRhdGFHcm91cCIpIHsKICAgICAgICAgICAgdGhpc1tfZGF0YVZhbHVlXSA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhTm9kZSA9PT0gImRhdGFWYWx1ZSIpIHsKICAgICAgICAgICAgdGhpc1tfZGF0YVZhbHVlXSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdGhpc1skY29uc3VtZWRdID0gZmFsc2U7CiAgfQoKICBbJHRvU3RyaW5nXShidWYpIHsKICAgIGNvbnN0IHRhZ05hbWUgPSB0aGlzWyRub2RlTmFtZV07CgogICAgaWYgKHRhZ05hbWUgPT09ICIjdGV4dCIpIHsKICAgICAgYnVmLnB1c2goKDAsIF9jb3JlX3V0aWxzLmVuY29kZVRvWG1sU3RyaW5nKSh0aGlzWyRjb250ZW50XSkpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgdXRmOFRhZ05hbWUgPSAoMCwgX3V0aWwudXRmOFN0cmluZ1RvU3RyaW5nKSh0YWdOYW1lKTsKICAgIGNvbnN0IHByZWZpeCA9IHRoaXNbJG5hbWVzcGFjZUlkXSA9PT0gTlNfREFUQVNFVFMgPyAieGZhOiIgOiAiIjsKICAgIGJ1Zi5wdXNoKGA8JHtwcmVmaXh9JHt1dGY4VGFnTmFtZX1gKTsKCiAgICBmb3IgKGNvbnN0IFtuYW1lLCB2YWx1ZV0gb2YgdGhpc1tfYXR0cmlidXRlc10uZW50cmllcygpKSB7CiAgICAgIGNvbnN0IHV0ZjhOYW1lID0gKDAsIF91dGlsLnV0ZjhTdHJpbmdUb1N0cmluZykobmFtZSk7CiAgICAgIGJ1Zi5wdXNoKGAgJHt1dGY4TmFtZX09IiR7KDAsIF9jb3JlX3V0aWxzLmVuY29kZVRvWG1sU3RyaW5nKSh2YWx1ZVskY29udGVudF0pfSJgKTsKICAgIH0KCiAgICBpZiAodGhpc1tfZGF0YVZhbHVlXSAhPT0gbnVsbCkgewogICAgICBpZiAodGhpc1tfZGF0YVZhbHVlXSkgewogICAgICAgIGJ1Zi5wdXNoKGAgeGZhOmRhdGFOb2RlPSJkYXRhVmFsdWUiYCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYnVmLnB1c2goYCB4ZmE6ZGF0YU5vZGU9ImRhdGFHcm91cCJgKTsKICAgICAgfQogICAgfQoKICAgIGlmICghdGhpc1skY29udGVudF0gJiYgdGhpc1tfY2hpbGRyZW5dLmxlbmd0aCA9PT0gMCkgewogICAgICBidWYucHVzaCgiLz4iKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGJ1Zi5wdXNoKCI+Iik7CgogICAgaWYgKHRoaXNbJGNvbnRlbnRdKSB7CiAgICAgIGlmICh0eXBlb2YgdGhpc1skY29udGVudF0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgYnVmLnB1c2goKDAsIF9jb3JlX3V0aWxzLmVuY29kZVRvWG1sU3RyaW5nKSh0aGlzWyRjb250ZW50XSkpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXNbJGNvbnRlbnRdWyR0b1N0cmluZ10oYnVmKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzW19jaGlsZHJlbl0pIHsKICAgICAgICBjaGlsZFskdG9TdHJpbmddKGJ1Zik7CiAgICAgIH0KICAgIH0KCiAgICBidWYucHVzaChgPC8ke3ByZWZpeH0ke3V0ZjhUYWdOYW1lfT5gKTsKICB9CgogIFskb25DaGlsZF0oY2hpbGQpIHsKICAgIGlmICh0aGlzWyRjb250ZW50XSkgewogICAgICBjb25zdCBub2RlID0gbmV3IFhtbE9iamVjdCh0aGlzWyRuYW1lc3BhY2VJZF0sICIjdGV4dCIpOwogICAgICB0aGlzWyRhcHBlbmRDaGlsZF0obm9kZSk7CiAgICAgIG5vZGVbJGNvbnRlbnRdID0gdGhpc1skY29udGVudF07CiAgICAgIHRoaXNbJGNvbnRlbnRdID0gIiI7CiAgICB9CgogICAgdGhpc1skYXBwZW5kQ2hpbGRdKGNoaWxkKTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgWyRvblRleHRdKHN0cikgewogICAgdGhpc1skY29udGVudF0gKz0gc3RyOwogIH0KCiAgWyRmaW5hbGl6ZV0oKSB7CiAgICBpZiAodGhpc1skY29udGVudF0gJiYgdGhpc1tfY2hpbGRyZW5dLmxlbmd0aCA+IDApIHsKICAgICAgY29uc3Qgbm9kZSA9IG5ldyBYbWxPYmplY3QodGhpc1skbmFtZXNwYWNlSWRdLCAiI3RleHQiKTsKICAgICAgdGhpc1skYXBwZW5kQ2hpbGRdKG5vZGUpOwogICAgICBub2RlWyRjb250ZW50XSA9IHRoaXNbJGNvbnRlbnRdOwogICAgICBkZWxldGUgdGhpc1skY29udGVudF07CiAgICB9CiAgfQoKICBbJHRvSFRNTF0oKSB7CiAgICBpZiAodGhpc1skbm9kZU5hbWVdID09PSAiI3RleHQiKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgICBuYW1lOiAiI3RleHQiLAogICAgICAgIHZhbHVlOiB0aGlzWyRjb250ZW50XQogICAgICB9KTsKICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgfQoKICBbJGdldENoaWxkcmVuXSgpIHsKICAgIGxldCBuYW1lID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsOwoKICAgIGlmICghbmFtZSkgewogICAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dOwogICAgfQoKICAgIHJldHVybiB0aGlzW19jaGlsZHJlbl0uZmlsdGVyKGMgPT4gY1skbm9kZU5hbWVdID09PSBuYW1lKTsKICB9CgogIFskZ2V0QXR0cmlidXRlc10oKSB7CiAgICByZXR1cm4gdGhpc1tfYXR0cmlidXRlc107CiAgfQoKICBbJGdldENoaWxkcmVuQnlDbGFzc10obmFtZSkgewogICAgY29uc3QgdmFsdWUgPSB0aGlzW19hdHRyaWJ1dGVzXS5nZXQobmFtZSk7CgogICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQoKICAgIHJldHVybiB0aGlzWyRnZXRDaGlsZHJlbl0obmFtZSk7CiAgfQoKICAqWyRnZXRDaGlsZHJlbkJ5TmFtZUl0XShuYW1lLCBhbGxUcmFuc3BhcmVudCkgewogICAgY29uc3QgdmFsdWUgPSB0aGlzW19hdHRyaWJ1dGVzXS5nZXQobmFtZSk7CgogICAgaWYgKHZhbHVlKSB7CiAgICAgIHlpZWxkIHZhbHVlOwogICAgfQoKICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpc1tfY2hpbGRyZW5dKSB7CiAgICAgIGlmIChjaGlsZFskbm9kZU5hbWVdID09PSBuYW1lKSB7CiAgICAgICAgeWllbGQgY2hpbGQ7CiAgICAgIH0KCiAgICAgIGlmIChhbGxUcmFuc3BhcmVudCkgewogICAgICAgIHlpZWxkKiBjaGlsZFskZ2V0Q2hpbGRyZW5CeU5hbWVJdF0obmFtZSwgYWxsVHJhbnNwYXJlbnQpOwogICAgICB9CiAgICB9CiAgfQoKICAqWyRnZXRBdHRyaWJ1dGVJdF0obmFtZSwgc2tpcENvbnN1bWVkKSB7CiAgICBjb25zdCB2YWx1ZSA9IHRoaXNbX2F0dHJpYnV0ZXNdLmdldChuYW1lKTsKCiAgICBpZiAodmFsdWUgJiYgKCFza2lwQ29uc3VtZWQgfHwgIXZhbHVlWyRjb25zdW1lZF0pKSB7CiAgICAgIHlpZWxkIHZhbHVlOwogICAgfQoKICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpc1tfY2hpbGRyZW5dKSB7CiAgICAgIHlpZWxkKiBjaGlsZFskZ2V0QXR0cmlidXRlSXRdKG5hbWUsIHNraXBDb25zdW1lZCk7CiAgICB9CiAgfQoKICAqWyRnZXRSZWFsQ2hpbGRyZW5CeU5hbWVJdF0obmFtZSwgYWxsVHJhbnNwYXJlbnQsIHNraXBDb25zdW1lZCkgewogICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzW19jaGlsZHJlbl0pIHsKICAgICAgaWYgKGNoaWxkWyRub2RlTmFtZV0gPT09IG5hbWUgJiYgKCFza2lwQ29uc3VtZWQgfHwgIWNoaWxkWyRjb25zdW1lZF0pKSB7CiAgICAgICAgeWllbGQgY2hpbGQ7CiAgICAgIH0KCiAgICAgIGlmIChhbGxUcmFuc3BhcmVudCkgewogICAgICAgIHlpZWxkKiBjaGlsZFskZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXRdKG5hbWUsIGFsbFRyYW5zcGFyZW50LCBza2lwQ29uc3VtZWQpOwogICAgICB9CiAgICB9CiAgfQoKICBbJGlzRGF0YVZhbHVlXSgpIHsKICAgIGlmICh0aGlzW19kYXRhVmFsdWVdID09PSBudWxsKSB7CiAgICAgIHJldHVybiB0aGlzW19jaGlsZHJlbl0ubGVuZ3RoID09PSAwIHx8IHRoaXNbX2NoaWxkcmVuXVswXVskbmFtZXNwYWNlSWRdID09PSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMueGh0bWwuaWQ7CiAgICB9CgogICAgcmV0dXJuIHRoaXNbX2RhdGFWYWx1ZV07CiAgfQoKICBbJGdldERhdGFWYWx1ZV0oKSB7CiAgICBpZiAodGhpc1tfZGF0YVZhbHVlXSA9PT0gbnVsbCkgewogICAgICBpZiAodGhpc1tfY2hpbGRyZW5dLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiB0aGlzWyRjb250ZW50XS50cmltKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzW19jaGlsZHJlbl1bMF1bJG5hbWVzcGFjZUlkXSA9PT0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLnhodG1sLmlkKSB7CiAgICAgICAgcmV0dXJuIHRoaXNbX2NoaWxkcmVuXVswXVskdGV4dF0oKS50cmltKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHJldHVybiB0aGlzWyRjb250ZW50XS50cmltKCk7CiAgfQoKICBbJHNldFZhbHVlXSh2YWx1ZSkgewogICAgdmFsdWUgPSB2YWx1ZS52YWx1ZSB8fCAiIjsKICAgIHRoaXNbJGNvbnRlbnRdID0gdmFsdWUudG9TdHJpbmcoKTsKICB9CgogIFskZHVtcF0oKSB7CiAgICBsZXQgaGFzTlMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgY29uc3QgZHVtcGVkID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICBpZiAoaGFzTlMpIHsKICAgICAgZHVtcGVkLiRucyA9IHRoaXNbJG5hbWVzcGFjZUlkXTsKICAgIH0KCiAgICBpZiAodGhpc1skY29udGVudF0pIHsKICAgICAgZHVtcGVkLiRjb250ZW50ID0gdGhpc1skY29udGVudF07CiAgICB9CgogICAgZHVtcGVkLiRuYW1lID0gdGhpc1skbm9kZU5hbWVdOwogICAgZHVtcGVkLmNoaWxkcmVuID0gW107CgogICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzW19jaGlsZHJlbl0pIHsKICAgICAgZHVtcGVkLmNoaWxkcmVuLnB1c2goY2hpbGRbJGR1bXBdKGhhc05TKSk7CiAgICB9CgogICAgZHVtcGVkLmF0dHJpYnV0ZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGZvciAoY29uc3QgW25hbWUsIHZhbHVlXSBvZiB0aGlzW19hdHRyaWJ1dGVzXSkgewogICAgICBkdW1wZWQuYXR0cmlidXRlc1tuYW1lXSA9IHZhbHVlWyRjb250ZW50XTsKICAgIH0KCiAgICByZXR1cm4gZHVtcGVkOwogIH0KCn0KCmV4cG9ydHMuWG1sT2JqZWN0ID0gWG1sT2JqZWN0OwoKY2xhc3MgQ29udGVudE9iamVjdCBleHRlbmRzIFhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IobnNJZCwgbmFtZSkgewogICAgc3VwZXIobnNJZCwgbmFtZSk7CiAgICB0aGlzWyRjb250ZW50XSA9ICIiOwogIH0KCiAgWyRvblRleHRdKHRleHQpIHsKICAgIHRoaXNbJGNvbnRlbnRdICs9IHRleHQ7CiAgfQoKICBbJGZpbmFsaXplXSgpIHt9Cgp9CgpleHBvcnRzLkNvbnRlbnRPYmplY3QgPSBDb250ZW50T2JqZWN0OwoKY2xhc3MgT3B0aW9uT2JqZWN0IGV4dGVuZHMgQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IobnNJZCwgbmFtZSwgb3B0aW9ucykgewogICAgc3VwZXIobnNJZCwgbmFtZSk7CiAgICB0aGlzW19vcHRpb25zXSA9IG9wdGlvbnM7CiAgfQoKICBbJGZpbmFsaXplXSgpIHsKICAgIHRoaXNbJGNvbnRlbnRdID0gKDAsIF91dGlscy5nZXRLZXl3b3JkKSh7CiAgICAgIGRhdGE6IHRoaXNbJGNvbnRlbnRdLAogICAgICBkZWZhdWx0VmFsdWU6IHRoaXNbX29wdGlvbnNdWzBdLAogICAgICB2YWxpZGF0ZTogayA9PiB0aGlzW19vcHRpb25zXS5pbmNsdWRlcyhrKQogICAgfSk7CiAgfQoKICBbJGNsZWFuXShidWlsZGVyKSB7CiAgICBzdXBlclskY2xlYW5dKGJ1aWxkZXIpOwogICAgZGVsZXRlIHRoaXNbX29wdGlvbnNdOwogIH0KCn0KCmV4cG9ydHMuT3B0aW9uT2JqZWN0ID0gT3B0aW9uT2JqZWN0OwoKY2xhc3MgU3RyaW5nT2JqZWN0IGV4dGVuZHMgQ29udGVudE9iamVjdCB7CiAgWyRmaW5hbGl6ZV0oKSB7CiAgICB0aGlzWyRjb250ZW50XSA9IHRoaXNbJGNvbnRlbnRdLnRyaW0oKTsKICB9Cgp9CgpleHBvcnRzLlN0cmluZ09iamVjdCA9IFN0cmluZ09iamVjdDsKCmNsYXNzIEludGVnZXJPYmplY3QgZXh0ZW5kcyBDb250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3Rvcihuc0lkLCBuYW1lLCBkZWZhdWx0VmFsdWUsIHZhbGlkYXRvcikgewogICAgc3VwZXIobnNJZCwgbmFtZSk7CiAgICB0aGlzW19kZWZhdWx0VmFsdWVdID0gZGVmYXVsdFZhbHVlOwogICAgdGhpc1tfdmFsaWRhdG9yXSA9IHZhbGlkYXRvcjsKICB9CgogIFskZmluYWxpemVdKCkgewogICAgdGhpc1skY29udGVudF0gPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogdGhpc1skY29udGVudF0sCiAgICAgIGRlZmF1bHRWYWx1ZTogdGhpc1tfZGVmYXVsdFZhbHVlXSwKICAgICAgdmFsaWRhdGU6IHRoaXNbX3ZhbGlkYXRvcl0KICAgIH0pOwogIH0KCiAgWyRjbGVhbl0oYnVpbGRlcikgewogICAgc3VwZXJbJGNsZWFuXShidWlsZGVyKTsKICAgIGRlbGV0ZSB0aGlzW19kZWZhdWx0VmFsdWVdOwogICAgZGVsZXRlIHRoaXNbX3ZhbGlkYXRvcl07CiAgfQoKfQoKZXhwb3J0cy5JbnRlZ2VyT2JqZWN0ID0gSW50ZWdlck9iamVjdDsKCmNsYXNzIE9wdGlvbjAxIGV4dGVuZHMgSW50ZWdlck9iamVjdCB7CiAgY29uc3RydWN0b3IobnNJZCwgbmFtZSkgewogICAgc3VwZXIobnNJZCwgbmFtZSwgMCwgbiA9PiBuID09PSAxKTsKICB9Cgp9CgpleHBvcnRzLk9wdGlvbjAxID0gT3B0aW9uMDE7CgpjbGFzcyBPcHRpb24xMCBleHRlbmRzIEludGVnZXJPYmplY3QgewogIGNvbnN0cnVjdG9yKG5zSWQsIG5hbWUpIHsKICAgIHN1cGVyKG5zSWQsIG5hbWUsIDEsIG4gPT4gbiA9PT0gMCk7CiAgfQoKfQoKZXhwb3J0cy5PcHRpb24xMCA9IE9wdGlvbjEwOwoKLyoqKi8gfSksCi8qIDIwMyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuSFRNTFJlc3VsdCA9IHZvaWQgMDsKZXhwb3J0cy5nZXRCQm94ID0gZ2V0QkJveDsKZXhwb3J0cy5nZXRDb2xvciA9IGdldENvbG9yOwpleHBvcnRzLmdldEZsb2F0ID0gZ2V0RmxvYXQ7CmV4cG9ydHMuZ2V0SW50ZWdlciA9IGdldEludGVnZXI7CmV4cG9ydHMuZ2V0S2V5d29yZCA9IGdldEtleXdvcmQ7CmV4cG9ydHMuZ2V0TWVhc3VyZW1lbnQgPSBnZXRNZWFzdXJlbWVudDsKZXhwb3J0cy5nZXRSYXRpbyA9IGdldFJhdGlvOwpleHBvcnRzLmdldFJlbGV2YW50ID0gZ2V0UmVsZXZhbnQ7CmV4cG9ydHMuZ2V0U3RyaW5nT3B0aW9uID0gZ2V0U3RyaW5nT3B0aW9uOwpleHBvcnRzLnN0cmlwUXVvdGVzID0gc3RyaXBRdW90ZXM7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY29uc3QgZGltQ29udmVydGVycyA9IHsKICBwdDogeCA9PiB4LAogIGNtOiB4ID0+IHggLyAyLjU0ICogNzIsCiAgbW06IHggPT4geCAvICgxMCAqIDIuNTQpICogNzIsCiAgaW46IHggPT4geCAqIDcyLAogIHB4OiB4ID0+IHgKfTsKY29uc3QgbWVhc3VyZW1lbnRQYXR0ZXJuID0gLyhbKy1dP1xkK1wuP1xkKikoLiopLzsKCmZ1bmN0aW9uIHN0cmlwUXVvdGVzKHN0cikgewogIGlmIChzdHIuc3RhcnRzV2l0aCgiJyIpIHx8IHN0ci5zdGFydHNXaXRoKCciJykpIHsKICAgIHJldHVybiBzdHIuc2xpY2UoMSwgc3RyLmxlbmd0aCAtIDEpOwogIH0KCiAgcmV0dXJuIHN0cjsKfQoKZnVuY3Rpb24gZ2V0SW50ZWdlcihfcmVmKSB7CiAgbGV0IHsKICAgIGRhdGEsCiAgICBkZWZhdWx0VmFsdWUsCiAgICB2YWxpZGF0ZQogIH0gPSBfcmVmOwoKICBpZiAoIWRhdGEpIHsKICAgIHJldHVybiBkZWZhdWx0VmFsdWU7CiAgfQoKICBkYXRhID0gZGF0YS50cmltKCk7CiAgY29uc3QgbiA9IHBhcnNlSW50KGRhdGEsIDEwKTsKCiAgaWYgKCFpc05hTihuKSAmJiB2YWxpZGF0ZShuKSkgewogICAgcmV0dXJuIG47CiAgfQoKICByZXR1cm4gZGVmYXVsdFZhbHVlOwp9CgpmdW5jdGlvbiBnZXRGbG9hdChfcmVmMikgewogIGxldCB7CiAgICBkYXRhLAogICAgZGVmYXVsdFZhbHVlLAogICAgdmFsaWRhdGUKICB9ID0gX3JlZjI7CgogIGlmICghZGF0YSkgewogICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTsKICB9CgogIGRhdGEgPSBkYXRhLnRyaW0oKTsKICBjb25zdCBuID0gcGFyc2VGbG9hdChkYXRhKTsKCiAgaWYgKCFpc05hTihuKSAmJiB2YWxpZGF0ZShuKSkgewogICAgcmV0dXJuIG47CiAgfQoKICByZXR1cm4gZGVmYXVsdFZhbHVlOwp9CgpmdW5jdGlvbiBnZXRLZXl3b3JkKF9yZWYzKSB7CiAgbGV0IHsKICAgIGRhdGEsCiAgICBkZWZhdWx0VmFsdWUsCiAgICB2YWxpZGF0ZQogIH0gPSBfcmVmMzsKCiAgaWYgKCFkYXRhKSB7CiAgICByZXR1cm4gZGVmYXVsdFZhbHVlOwogIH0KCiAgZGF0YSA9IGRhdGEudHJpbSgpOwoKICBpZiAodmFsaWRhdGUoZGF0YSkpIHsKICAgIHJldHVybiBkYXRhOwogIH0KCiAgcmV0dXJuIGRlZmF1bHRWYWx1ZTsKfQoKZnVuY3Rpb24gZ2V0U3RyaW5nT3B0aW9uKGRhdGEsIG9wdGlvbnMpIHsKICByZXR1cm4gZ2V0S2V5d29yZCh7CiAgICBkYXRhLAogICAgZGVmYXVsdFZhbHVlOiBvcHRpb25zWzBdLAogICAgdmFsaWRhdGU6IGsgPT4gb3B0aW9ucy5pbmNsdWRlcyhrKQogIH0pOwp9CgpmdW5jdGlvbiBnZXRNZWFzdXJlbWVudChzdHIpIHsKICBsZXQgZGVmID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAiMCI7CiAgZGVmID0gZGVmIHx8ICIwIjsKCiAgaWYgKCFzdHIpIHsKICAgIHJldHVybiBnZXRNZWFzdXJlbWVudChkZWYpOwogIH0KCiAgY29uc3QgbWF0Y2ggPSBzdHIudHJpbSgpLm1hdGNoKG1lYXN1cmVtZW50UGF0dGVybik7CgogIGlmICghbWF0Y2gpIHsKICAgIHJldHVybiBnZXRNZWFzdXJlbWVudChkZWYpOwogIH0KCiAgY29uc3QgWywgdmFsdWVTdHIsIHVuaXRdID0gbWF0Y2g7CiAgY29uc3QgdmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlU3RyKTsKCiAgaWYgKGlzTmFOKHZhbHVlKSkgewogICAgcmV0dXJuIGdldE1lYXN1cmVtZW50KGRlZik7CiAgfQoKICBpZiAodmFsdWUgPT09IDApIHsKICAgIHJldHVybiAwOwogIH0KCiAgY29uc3QgY29udiA9IGRpbUNvbnZlcnRlcnNbdW5pdF07CgogIGlmIChjb252KSB7CiAgICByZXR1cm4gY29udih2YWx1ZSk7CiAgfQoKICByZXR1cm4gdmFsdWU7Cn0KCmZ1bmN0aW9uIGdldFJhdGlvKGRhdGEpIHsKICBpZiAoIWRhdGEpIHsKICAgIHJldHVybiB7CiAgICAgIG51bTogMSwKICAgICAgZGVuOiAxCiAgICB9OwogIH0KCiAgY29uc3QgcmF0aW8gPSBkYXRhLnRyaW0oKS5zcGxpdCgvXHMqOlxzKi8pLm1hcCh4ID0+IHBhcnNlRmxvYXQoeCkpLmZpbHRlcih4ID0+ICFpc05hTih4KSk7CgogIGlmIChyYXRpby5sZW5ndGggPT09IDEpIHsKICAgIHJhdGlvLnB1c2goMSk7CiAgfQoKICBpZiAocmF0aW8ubGVuZ3RoID09PSAwKSB7CiAgICByZXR1cm4gewogICAgICBudW06IDEsCiAgICAgIGRlbjogMQogICAgfTsKICB9CgogIGNvbnN0IFtudW0sIGRlbl0gPSByYXRpbzsKICByZXR1cm4gewogICAgbnVtLAogICAgZGVuCiAgfTsKfQoKZnVuY3Rpb24gZ2V0UmVsZXZhbnQoZGF0YSkgewogIGlmICghZGF0YSkgewogICAgcmV0dXJuIFtdOwogIH0KCiAgcmV0dXJuIGRhdGEudHJpbSgpLnNwbGl0KC9ccysvKS5tYXAoZSA9PiB7CiAgICByZXR1cm4gewogICAgICBleGNsdWRlZDogZVswXSA9PT0gIi0iLAogICAgICB2aWV3bmFtZTogZS5zdWJzdHJpbmcoMSkKICAgIH07CiAgfSk7Cn0KCmZ1bmN0aW9uIGdldENvbG9yKGRhdGEpIHsKICBsZXQgZGVmID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBbMCwgMCwgMF07CiAgbGV0IFtyLCBnLCBiXSA9IGRlZjsKCiAgaWYgKCFkYXRhKSB7CiAgICByZXR1cm4gewogICAgICByLAogICAgICBnLAogICAgICBiCiAgICB9OwogIH0KCiAgY29uc3QgY29sb3IgPSBkYXRhLnRyaW0oKS5zcGxpdCgvXHMqLFxzKi8pLm1hcChjID0+IE1hdGgubWluKE1hdGgubWF4KDAsIHBhcnNlSW50KGMudHJpbSgpLCAxMCkpLCAyNTUpKS5tYXAoYyA9PiBpc05hTihjKSA/IDAgOiBjKTsKCiAgaWYgKGNvbG9yLmxlbmd0aCA8IDMpIHsKICAgIHJldHVybiB7CiAgICAgIHIsCiAgICAgIGcsCiAgICAgIGIKICAgIH07CiAgfQoKICBbciwgZywgYl0gPSBjb2xvcjsKICByZXR1cm4gewogICAgciwKICAgIGcsCiAgICBiCiAgfTsKfQoKZnVuY3Rpb24gZ2V0QkJveChkYXRhKSB7CiAgY29uc3QgZGVmID0gLTE7CgogIGlmICghZGF0YSkgewogICAgcmV0dXJuIHsKICAgICAgeDogZGVmLAogICAgICB5OiBkZWYsCiAgICAgIHdpZHRoOiBkZWYsCiAgICAgIGhlaWdodDogZGVmCiAgICB9OwogIH0KCiAgY29uc3QgYmJveCA9IGRhdGEudHJpbSgpLnNwbGl0KC9ccyosXHMqLykubWFwKG0gPT4gZ2V0TWVhc3VyZW1lbnQobSwgIi0xIikpOwoKICBpZiAoYmJveC5sZW5ndGggPCA0IHx8IGJib3hbMl0gPCAwIHx8IGJib3hbM10gPCAwKSB7CiAgICByZXR1cm4gewogICAgICB4OiBkZWYsCiAgICAgIHk6IGRlZiwKICAgICAgd2lkdGg6IGRlZiwKICAgICAgaGVpZ2h0OiBkZWYKICAgIH07CiAgfQoKICBjb25zdCBbeCwgeSwgd2lkdGgsIGhlaWdodF0gPSBiYm94OwogIHJldHVybiB7CiAgICB4LAogICAgeSwKICAgIHdpZHRoLAogICAgaGVpZ2h0CiAgfTsKfQoKY2xhc3MgSFRNTFJlc3VsdCB7CiAgc3RhdGljIGdldCBGQUlMVVJFKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJGQUlMVVJFIiwgbmV3IEhUTUxSZXN1bHQoZmFsc2UsIG51bGwsIG51bGwsIG51bGwpKTsKICB9CgogIHN0YXRpYyBnZXQgRU1QVFkoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIkVNUFRZIiwgbmV3IEhUTUxSZXN1bHQodHJ1ZSwgbnVsbCwgbnVsbCwgbnVsbCkpOwogIH0KCiAgY29uc3RydWN0b3Ioc3VjY2VzcywgaHRtbCwgYmJveCwgYnJlYWtOb2RlKSB7CiAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzOwogICAgdGhpcy5odG1sID0gaHRtbDsKICAgIHRoaXMuYmJveCA9IGJib3g7CiAgICB0aGlzLmJyZWFrTm9kZSA9IGJyZWFrTm9kZTsKICB9CgogIGlzQnJlYWsoKSB7CiAgICByZXR1cm4gISF0aGlzLmJyZWFrTm9kZTsKICB9CgogIHN0YXRpYyBicmVha05vZGUobm9kZSkgewogICAgcmV0dXJuIG5ldyBIVE1MUmVzdWx0KGZhbHNlLCBudWxsLCBudWxsLCBub2RlKTsKICB9CgogIHN0YXRpYyBzdWNjZXNzKGh0bWwpIHsKICAgIGxldCBiYm94ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsOwogICAgcmV0dXJuIG5ldyBIVE1MUmVzdWx0KHRydWUsIGh0bWwsIGJib3gsIG51bGwpOwogIH0KCn0KCmV4cG9ydHMuSFRNTFJlc3VsdCA9IEhUTUxSZXN1bHQ7CgovKioqLyB9KSwKLyogMjA0ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5OYW1lc3BhY2VJZHMgPSBleHBvcnRzLiRidWlsZFhGQU9iamVjdCA9IHZvaWQgMDsKY29uc3QgJGJ1aWxkWEZBT2JqZWN0ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGJ1aWxkWEZBT2JqZWN0ID0gJGJ1aWxkWEZBT2JqZWN0Owpjb25zdCBOYW1lc3BhY2VJZHMgPSB7CiAgY29uZmlnOiB7CiAgICBpZDogMCwKICAgIGNoZWNrOiBucyA9PiBucy5zdGFydHNXaXRoKCJodHRwOi8vd3d3LnhmYS5vcmcvc2NoZW1hL3hjaS8iKQogIH0sCiAgY29ubmVjdGlvblNldDogewogICAgaWQ6IDEsCiAgICBjaGVjazogbnMgPT4gbnMuc3RhcnRzV2l0aCgiaHR0cDovL3d3dy54ZmEub3JnL3NjaGVtYS94ZmEtY29ubmVjdGlvbi1zZXQvIikKICB9LAogIGRhdGFzZXRzOiB7CiAgICBpZDogMiwKICAgIGNoZWNrOiBucyA9PiBucy5zdGFydHNXaXRoKCJodHRwOi8vd3d3LnhmYS5vcmcvc2NoZW1hL3hmYS1kYXRhLyIpCiAgfSwKICBmb3JtOiB7CiAgICBpZDogMywKICAgIGNoZWNrOiBucyA9PiBucy5zdGFydHNXaXRoKCJodHRwOi8vd3d3LnhmYS5vcmcvc2NoZW1hL3hmYS1mb3JtLyIpCiAgfSwKICBsb2NhbGVTZXQ6IHsKICAgIGlkOiA0LAogICAgY2hlY2s6IG5zID0+IG5zLnN0YXJ0c1dpdGgoImh0dHA6Ly93d3cueGZhLm9yZy9zY2hlbWEveGZhLWxvY2FsZS1zZXQvIikKICB9LAogIHBkZjogewogICAgaWQ6IDUsCiAgICBjaGVjazogbnMgPT4gbnMgPT09ICJodHRwOi8vbnMuYWRvYmUuY29tL3hkcC9wZGYvIgogIH0sCiAgc2lnbmF0dXJlOiB7CiAgICBpZDogNiwKICAgIGNoZWNrOiBucyA9PiBucyA9PT0gImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiCiAgfSwKICBzb3VyY2VTZXQ6IHsKICAgIGlkOiA3LAogICAgY2hlY2s6IG5zID0+IG5zLnN0YXJ0c1dpdGgoImh0dHA6Ly93d3cueGZhLm9yZy9zY2hlbWEveGZhLXNvdXJjZS1zZXQvIikKICB9LAogIHN0eWxlc2hlZXQ6IHsKICAgIGlkOiA4LAogICAgY2hlY2s6IG5zID0+IG5zID09PSAiaHR0cDovL3d3dy53My5vcmcvMTk5OS9YU0wvVHJhbnNmb3JtIgogIH0sCiAgdGVtcGxhdGU6IHsKICAgIGlkOiA5LAogICAgY2hlY2s6IG5zID0+IG5zLnN0YXJ0c1dpdGgoImh0dHA6Ly93d3cueGZhLm9yZy9zY2hlbWEveGZhLXRlbXBsYXRlLyIpCiAgfSwKICB4ZGM6IHsKICAgIGlkOiAxMCwKICAgIGNoZWNrOiBucyA9PiBucy5zdGFydHNXaXRoKCJodHRwOi8vd3d3LnhmYS5vcmcvc2NoZW1hL3hkYy8iKQogIH0sCiAgeGRwOiB7CiAgICBpZDogMTEsCiAgICBjaGVjazogbnMgPT4gbnMgPT09ICJodHRwOi8vbnMuYWRvYmUuY29tL3hkcC8iCiAgfSwKICB4ZmRmOiB7CiAgICBpZDogMTIsCiAgICBjaGVjazogbnMgPT4gbnMgPT09ICJodHRwOi8vbnMuYWRvYmUuY29tL3hmZGYvIgogIH0sCiAgeGh0bWw6IHsKICAgIGlkOiAxMywKICAgIGNoZWNrOiBucyA9PiBucyA9PT0gImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiCiAgfSwKICB4bXBtZXRhOiB7CiAgICBpZDogMTQsCiAgICBjaGVjazogbnMgPT4gbnMgPT09ICJodHRwOi8vbnMuYWRvYmUuY29tL3htcG1ldGEvIgogIH0KfTsKZXhwb3J0cy5OYW1lc3BhY2VJZHMgPSBOYW1lc3BhY2VJZHM7CgovKioqLyB9KSwKLyogMjA1ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5jcmVhdGVEYXRhTm9kZSA9IGNyZWF0ZURhdGFOb2RlOwpleHBvcnRzLnNlYXJjaE5vZGUgPSBzZWFyY2hOb2RlOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDIpOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDQpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNvbnN0IG5hbWVQYXR0ZXJuID0gL15bXi5bXSsvOwpjb25zdCBpbmRleFBhdHRlcm4gPSAvXlteXF1dKy87CmNvbnN0IG9wZXJhdG9ycyA9IHsKICBkb3Q6IDAsCiAgZG90RG90OiAxLAogIGRvdEhhc2g6IDIsCiAgZG90QnJhY2tldDogMywKICBkb3RQYXJlbjogNAp9Owpjb25zdCBzaG9ydGN1dHMgPSBuZXcgTWFwKFtbIiRkYXRhIiwgKHJvb3QsIGN1cnJlbnQpID0+IHJvb3QuZGF0YXNldHMgPyByb290LmRhdGFzZXRzLmRhdGEgOiByb290XSwgWyIkcmVjb3JkIiwgKHJvb3QsIGN1cnJlbnQpID0+IChyb290LmRhdGFzZXRzID8gcm9vdC5kYXRhc2V0cy5kYXRhIDogcm9vdClbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuXSgpWzBdXSwgWyIkdGVtcGxhdGUiLCAocm9vdCwgY3VycmVudCkgPT4gcm9vdC50ZW1wbGF0ZV0sIFsiJGNvbm5lY3Rpb25TZXQiLCAocm9vdCwgY3VycmVudCkgPT4gcm9vdC5jb25uZWN0aW9uU2V0XSwgWyIkZm9ybSIsIChyb290LCBjdXJyZW50KSA9PiByb290LmZvcm1dLCBbIiRsYXlvdXQiLCAocm9vdCwgY3VycmVudCkgPT4gcm9vdC5sYXlvdXRdLCBbIiRob3N0IiwgKHJvb3QsIGN1cnJlbnQpID0+IHJvb3QuaG9zdF0sIFsiJGRhdGFXaW5kb3ciLCAocm9vdCwgY3VycmVudCkgPT4gcm9vdC5kYXRhV2luZG93XSwgWyIkZXZlbnQiLCAocm9vdCwgY3VycmVudCkgPT4gcm9vdC5ldmVudF0sIFsiISIsIChyb290LCBjdXJyZW50KSA9PiByb290LmRhdGFzZXRzXSwgWyIkeGZhIiwgKHJvb3QsIGN1cnJlbnQpID0+IHJvb3RdLCBbInhmYSIsIChyb290LCBjdXJyZW50KSA9PiByb290XSwgWyIkIiwgKHJvb3QsIGN1cnJlbnQpID0+IGN1cnJlbnRdXSk7CmNvbnN0IHNvbUNhY2hlID0gbmV3IFdlYWtNYXAoKTsKY29uc3QgTlNfREFUQVNFVFMgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMuZGF0YXNldHMuaWQ7CgpmdW5jdGlvbiBwYXJzZUluZGV4KGluZGV4KSB7CiAgaW5kZXggPSBpbmRleC50cmltKCk7CgogIGlmIChpbmRleCA9PT0gIioiKSB7CiAgICByZXR1cm4gSW5maW5pdHk7CiAgfQoKICByZXR1cm4gcGFyc2VJbnQoaW5kZXgsIDEwKSB8fCAwOwp9CgpmdW5jdGlvbiBwYXJzZUV4cHJlc3Npb24oZXhwciwgZG90RG90QWxsb3dlZCkgewogIGxldCBub0V4cHIgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHRydWU7CiAgbGV0IG1hdGNoID0gZXhwci5tYXRjaChuYW1lUGF0dGVybik7CgogIGlmICghbWF0Y2gpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgbGV0IFtuYW1lXSA9IG1hdGNoOwogIGNvbnN0IHBhcnNlZCA9IFt7CiAgICBuYW1lLAogICAgY2FjaGVOYW1lOiAiLiIgKyBuYW1lLAogICAgaW5kZXg6IDAsCiAgICBqczogbnVsbCwKICAgIGZvcm1DYWxjOiBudWxsLAogICAgb3BlcmF0b3I6IG9wZXJhdG9ycy5kb3QKICB9XTsKICBsZXQgcG9zID0gbmFtZS5sZW5ndGg7CgogIHdoaWxlIChwb3MgPCBleHByLmxlbmd0aCkgewogICAgY29uc3Qgc3BvcyA9IHBvczsKICAgIGNvbnN0IGNoYXIgPSBleHByLmNoYXJBdChwb3MrKyk7CgogICAgaWYgKGNoYXIgPT09ICJbIikgewogICAgICBtYXRjaCA9IGV4cHIuc2xpY2UocG9zKS5tYXRjaChpbmRleFBhdHRlcm4pOwoKICAgICAgaWYgKCFtYXRjaCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiWEZBIC0gSW52YWxpZCBpbmRleCBpbiBTT00gZXhwcmVzc2lvbiIpOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBwYXJzZWQuYXQoLTEpLmluZGV4ID0gcGFyc2VJbmRleChtYXRjaFswXSk7CiAgICAgIHBvcyArPSBtYXRjaFswXS5sZW5ndGggKyAxOwogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBsZXQgb3BlcmF0b3I7CgogICAgc3dpdGNoIChleHByLmNoYXJBdChwb3MpKSB7CiAgICAgIGNhc2UgIi4iOgogICAgICAgIGlmICghZG90RG90QWxsb3dlZCkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBwb3MrKzsKICAgICAgICBvcGVyYXRvciA9IG9wZXJhdG9ycy5kb3REb3Q7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICIjIjoKICAgICAgICBwb3MrKzsKICAgICAgICBvcGVyYXRvciA9IG9wZXJhdG9ycy5kb3RIYXNoOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiWyI6CiAgICAgICAgaWYgKG5vRXhwcikgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBTT00gZXhwcmVzc2lvbiBjb250YWlucyBhIEZvcm1DYWxjIHN1YmV4cHJlc3Npb24gd2hpY2ggaXMgbm90IHN1cHBvcnRlZCBmb3Igbm93LiIpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBvcGVyYXRvciA9IG9wZXJhdG9ycy5kb3RCcmFja2V0OwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiKCI6CiAgICAgICAgaWYgKG5vRXhwcikgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBTT00gZXhwcmVzc2lvbiBjb250YWlucyBhIEphdmFTY3JpcHQgc3ViZXhwcmVzc2lvbiB3aGljaCBpcyBub3Qgc3VwcG9ydGVkIGZvciBub3cuIik7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIG9wZXJhdG9yID0gb3BlcmF0b3JzLmRvdFBhcmVuOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICBvcGVyYXRvciA9IG9wZXJhdG9ycy5kb3Q7CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgbWF0Y2ggPSBleHByLnNsaWNlKHBvcykubWF0Y2gobmFtZVBhdHRlcm4pOwoKICAgIGlmICghbWF0Y2gpIHsKICAgICAgYnJlYWs7CiAgICB9CgogICAgW25hbWVdID0gbWF0Y2g7CiAgICBwb3MgKz0gbmFtZS5sZW5ndGg7CiAgICBwYXJzZWQucHVzaCh7CiAgICAgIG5hbWUsCiAgICAgIGNhY2hlTmFtZTogZXhwci5zbGljZShzcG9zLCBwb3MpLAogICAgICBvcGVyYXRvciwKICAgICAgaW5kZXg6IDAsCiAgICAgIGpzOiBudWxsLAogICAgICBmb3JtQ2FsYzogbnVsbAogICAgfSk7CiAgfQoKICByZXR1cm4gcGFyc2VkOwp9CgpmdW5jdGlvbiBzZWFyY2hOb2RlKHJvb3QsIGNvbnRhaW5lciwgZXhwcikgewogIGxldCBkb3REb3RBbGxvd2VkID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiB0cnVlOwogIGxldCB1c2VDYWNoZSA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogdHJ1ZTsKICBjb25zdCBwYXJzZWQgPSBwYXJzZUV4cHJlc3Npb24oZXhwciwgZG90RG90QWxsb3dlZCk7CgogIGlmICghcGFyc2VkKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IGZuID0gc2hvcnRjdXRzLmdldChwYXJzZWRbMF0ubmFtZSk7CiAgbGV0IGkgPSAwOwogIGxldCBpc1F1YWxpZmllZDsKCiAgaWYgKGZuKSB7CiAgICBpc1F1YWxpZmllZCA9IHRydWU7CiAgICByb290ID0gW2ZuKHJvb3QsIGNvbnRhaW5lcildOwogICAgaSA9IDE7CiAgfSBlbHNlIHsKICAgIGlzUXVhbGlmaWVkID0gY29udGFpbmVyID09PSBudWxsOwogICAgcm9vdCA9IFtjb250YWluZXIgfHwgcm9vdF07CiAgfQoKICBmb3IgKGxldCBpaSA9IHBhcnNlZC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCB7CiAgICAgIG5hbWUsCiAgICAgIGNhY2hlTmFtZSwKICAgICAgb3BlcmF0b3IsCiAgICAgIGluZGV4CiAgICB9ID0gcGFyc2VkW2ldOwogICAgY29uc3Qgbm9kZXMgPSBbXTsKCiAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygcm9vdCkgewogICAgICBpZiAoIShub2RlIGluc3RhbmNlb2YgX3hmYV9vYmplY3QuWEZBT2JqZWN0KSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBsZXQgY2hpbGRyZW4sIGNhY2hlZDsKCiAgICAgIGlmICh1c2VDYWNoZSkgewogICAgICAgIGNhY2hlZCA9IHNvbUNhY2hlLmdldChub2RlKTsKCiAgICAgICAgaWYgKCFjYWNoZWQpIHsKICAgICAgICAgIGNhY2hlZCA9IG5ldyBNYXAoKTsKICAgICAgICAgIHNvbUNhY2hlLnNldChub2RlLCBjYWNoZWQpOwogICAgICAgIH0KCiAgICAgICAgY2hpbGRyZW4gPSBjYWNoZWQuZ2V0KGNhY2hlTmFtZSk7CiAgICAgIH0KCiAgICAgIGlmICghY2hpbGRyZW4pIHsKICAgICAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7CiAgICAgICAgICBjYXNlIG9wZXJhdG9ycy5kb3Q6CiAgICAgICAgICAgIGNoaWxkcmVuID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5CeU5hbWVdKG5hbWUsIGZhbHNlKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBvcGVyYXRvcnMuZG90RG90OgogICAgICAgICAgICBjaGlsZHJlbiA9IG5vZGVbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuQnlOYW1lXShuYW1lLCB0cnVlKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBvcGVyYXRvcnMuZG90SGFzaDoKICAgICAgICAgICAgY2hpbGRyZW4gPSBub2RlW194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbkJ5Q2xhc3NdKG5hbWUpOwoKICAgICAgICAgICAgaWYgKGNoaWxkcmVuIGluc3RhbmNlb2YgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkpIHsKICAgICAgICAgICAgICBjaGlsZHJlbiA9IGNoaWxkcmVuLmNoaWxkcmVuOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNoaWxkcmVuID0gW2NoaWxkcmVuXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAodXNlQ2FjaGUpIHsKICAgICAgICAgIGNhY2hlZC5zZXQoY2FjaGVOYW1lLCBjaGlsZHJlbik7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgIG5vZGVzLnB1c2goY2hpbGRyZW4pOwogICAgICB9CiAgICB9CgogICAgaWYgKG5vZGVzLmxlbmd0aCA9PT0gMCAmJiAhaXNRdWFsaWZpZWQgJiYgaSA9PT0gMCkgewogICAgICBjb25zdCBwYXJlbnQgPSBjb250YWluZXJbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICAgIGNvbnRhaW5lciA9IHBhcmVudDsKCiAgICAgIGlmICghY29udGFpbmVyKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGkgPSAtMTsKICAgICAgcm9vdCA9IFtjb250YWluZXJdOwogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBpZiAoaXNGaW5pdGUoaW5kZXgpKSB7CiAgICAgIHJvb3QgPSBub2Rlcy5maWx0ZXIobm9kZSA9PiBpbmRleCA8IG5vZGUubGVuZ3RoKS5tYXAobm9kZSA9PiBub2RlW2luZGV4XSk7CiAgICB9IGVsc2UgewogICAgICByb290ID0gbm9kZXMuZmxhdCgpOwogICAgfQogIH0KCiAgaWYgKHJvb3QubGVuZ3RoID09PSAwKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIHJldHVybiByb290Owp9CgpmdW5jdGlvbiBjcmVhdGVOb2Rlcyhyb290LCBwYXRoKSB7CiAgbGV0IG5vZGUgPSBudWxsOwoKICBmb3IgKGNvbnN0IHsKICAgIG5hbWUsCiAgICBpbmRleAogIH0gb2YgcGF0aCkgewogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gIWlzRmluaXRlKGluZGV4KSA/IDAgOiBpbmRleDsgaSA8PSBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IG5zSWQgPSByb290W194ZmFfb2JqZWN0LiRuYW1lc3BhY2VJZF0gPT09IE5TX0RBVEFTRVRTID8gLTEgOiByb290W194ZmFfb2JqZWN0LiRuYW1lc3BhY2VJZF07CiAgICAgIG5vZGUgPSBuZXcgX3hmYV9vYmplY3QuWG1sT2JqZWN0KG5zSWQsIG5hbWUpOwoKICAgICAgcm9vdFtfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKG5vZGUpOwogICAgfQoKICAgIHJvb3QgPSBub2RlOwogIH0KCiAgcmV0dXJuIG5vZGU7Cn0KCmZ1bmN0aW9uIGNyZWF0ZURhdGFOb2RlKHJvb3QsIGNvbnRhaW5lciwgZXhwcikgewogIGNvbnN0IHBhcnNlZCA9IHBhcnNlRXhwcmVzc2lvbihleHByKTsKCiAgaWYgKCFwYXJzZWQpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgaWYgKHBhcnNlZC5zb21lKHggPT4geC5vcGVyYXRvciA9PT0gb3BlcmF0b3JzLmRvdERvdCkpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgY29uc3QgZm4gPSBzaG9ydGN1dHMuZ2V0KHBhcnNlZFswXS5uYW1lKTsKICBsZXQgaSA9IDA7CgogIGlmIChmbikgewogICAgcm9vdCA9IGZuKHJvb3QsIGNvbnRhaW5lcik7CiAgICBpID0gMTsKICB9IGVsc2UgewogICAgcm9vdCA9IGNvbnRhaW5lciB8fCByb290OwogIH0KCiAgZm9yIChsZXQgaWkgPSBwYXJzZWQubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgY29uc3QgewogICAgICBuYW1lLAogICAgICBvcGVyYXRvciwKICAgICAgaW5kZXgKICAgIH0gPSBwYXJzZWRbaV07CgogICAgaWYgKCFpc0Zpbml0ZShpbmRleCkpIHsKICAgICAgcGFyc2VkW2ldLmluZGV4ID0gMDsKICAgICAgcmV0dXJuIGNyZWF0ZU5vZGVzKHJvb3QsIHBhcnNlZC5zbGljZShpKSk7CiAgICB9CgogICAgbGV0IGNoaWxkcmVuOwoKICAgIHN3aXRjaCAob3BlcmF0b3IpIHsKICAgICAgY2FzZSBvcGVyYXRvcnMuZG90OgogICAgICAgIGNoaWxkcmVuID0gcm9vdFtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5CeU5hbWVdKG5hbWUsIGZhbHNlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2Ugb3BlcmF0b3JzLmRvdERvdDoKICAgICAgICBjaGlsZHJlbiA9IHJvb3RbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuQnlOYW1lXShuYW1lLCB0cnVlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2Ugb3BlcmF0b3JzLmRvdEhhc2g6CiAgICAgICAgY2hpbGRyZW4gPSByb290W194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbkJ5Q2xhc3NdKG5hbWUpOwoKICAgICAgICBpZiAoY2hpbGRyZW4gaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSkgewogICAgICAgICAgY2hpbGRyZW4gPSBjaGlsZHJlbi5jaGlsZHJlbjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY2hpbGRyZW4gPSBbY2hpbGRyZW5dOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIGJyZWFrOwogICAgfQoKICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIGNyZWF0ZU5vZGVzKHJvb3QsIHBhcnNlZC5zbGljZShpKSk7CiAgICB9CgogICAgaWYgKGluZGV4IDwgY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baW5kZXhdOwoKICAgICAgaWYgKCEoY2hpbGQgaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFPYmplY3QpKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBDYW5ub3QgY3JlYXRlIGEgbm9kZS5gKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcm9vdCA9IGNoaWxkOwogICAgfSBlbHNlIHsKICAgICAgcGFyc2VkW2ldLmluZGV4ID0gaW5kZXggLSBjaGlsZHJlbi5sZW5ndGg7CiAgICAgIHJldHVybiBjcmVhdGVOb2Rlcyhyb290LCBwYXJzZWQuc2xpY2UoaSkpOwogICAgfQogIH0KCiAgcmV0dXJuIG51bGw7Cn0KCi8qKiovIH0pLAovKiAyMDYgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkJpbmRlciA9IHZvaWQgMDsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAyKTsKCnZhciBfdGVtcGxhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNyk7Cgp2YXIgX3NvbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA1KTsKCnZhciBfbmFtZXNwYWNlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA0KTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgpjb25zdCBOU19EQVRBU0VUUyA9IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy5kYXRhc2V0cy5pZDsKCmZ1bmN0aW9uIGNyZWF0ZVRleHQoY29udGVudCkgewogIGNvbnN0IG5vZGUgPSBuZXcgX3RlbXBsYXRlLlRleHQoe30pOwogIG5vZGVbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gY29udGVudDsKICByZXR1cm4gbm9kZTsKfQoKY2xhc3MgQmluZGVyIHsKICBjb25zdHJ1Y3Rvcihyb290KSB7CiAgICB0aGlzLnJvb3QgPSByb290OwogICAgdGhpcy5kYXRhc2V0cyA9IHJvb3QuZGF0YXNldHM7CgogICAgaWYgKHJvb3QuZGF0YXNldHMgJiYgcm9vdC5kYXRhc2V0cy5kYXRhKSB7CiAgICAgIHRoaXMuZGF0YSA9IHJvb3QuZGF0YXNldHMuZGF0YTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZGF0YSA9IG5ldyBfeGZhX29iamVjdC5YbWxPYmplY3QoX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLmRhdGFzZXRzLmlkLCAiZGF0YSIpOwogICAgfQoKICAgIHRoaXMuZW1wdHlNZXJnZSA9IHRoaXMuZGF0YVtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5dKCkubGVuZ3RoID09PSAwOwogICAgdGhpcy5yb290LmZvcm0gPSB0aGlzLmZvcm0gPSByb290LnRlbXBsYXRlW194ZmFfb2JqZWN0LiRjbG9uZV0oKTsKICB9CgogIF9pc0NvbnN1bWVEYXRhKCkgewogICAgcmV0dXJuICF0aGlzLmVtcHR5TWVyZ2UgJiYgdGhpcy5fbWVyZ2VNb2RlOwogIH0KCiAgX2lzTWF0Y2hUZW1wbGF0ZSgpIHsKICAgIHJldHVybiAhdGhpcy5faXNDb25zdW1lRGF0YSgpOwogIH0KCiAgYmluZCgpIHsKICAgIHRoaXMuX2JpbmRFbGVtZW50KHRoaXMuZm9ybSwgdGhpcy5kYXRhKTsKCiAgICByZXR1cm4gdGhpcy5mb3JtOwogIH0KCiAgZ2V0RGF0YSgpIHsKICAgIHJldHVybiB0aGlzLmRhdGE7CiAgfQoKICBfYmluZFZhbHVlKGZvcm1Ob2RlLCBkYXRhLCBwaWN0dXJlKSB7CiAgICBmb3JtTm9kZVtfeGZhX29iamVjdC4kZGF0YV0gPSBkYXRhOwoKICAgIGlmIChmb3JtTm9kZVtfeGZhX29iamVjdC4kaGFzU2V0dGFibGVWYWx1ZV0oKSkgewogICAgICBpZiAoZGF0YVtfeGZhX29iamVjdC4kaXNEYXRhVmFsdWVdKCkpIHsKICAgICAgICBjb25zdCB2YWx1ZSA9IGRhdGFbX3hmYV9vYmplY3QuJGdldERhdGFWYWx1ZV0oKTsKCiAgICAgICAgZm9ybU5vZGVbX3hmYV9vYmplY3QuJHNldFZhbHVlXShjcmVhdGVUZXh0KHZhbHVlKSk7CiAgICAgIH0gZWxzZSBpZiAoZm9ybU5vZGUgaW5zdGFuY2VvZiBfdGVtcGxhdGUuRmllbGQgJiYgZm9ybU5vZGUudWkgJiYgZm9ybU5vZGUudWkuY2hvaWNlTGlzdCAmJiBmb3JtTm9kZS51aS5jaG9pY2VMaXN0Lm9wZW4gPT09ICJtdWx0aVNlbGVjdCIpIHsKICAgICAgICBjb25zdCB2YWx1ZSA9IGRhdGFbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuXSgpLm1hcChjaGlsZCA9PiBjaGlsZFtfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpKS5qb2luKCJcbiIpOwoKICAgICAgICBmb3JtTm9kZVtfeGZhX29iamVjdC4kc2V0VmFsdWVdKGNyZWF0ZVRleHQodmFsdWUpKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLl9pc0NvbnN1bWVEYXRhKCkpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIE5vZGVzIGhhdmVuJ3QgdGhlIHNhbWUgdHlwZS5gKTsKICAgICAgfQogICAgfSBlbHNlIGlmICghZGF0YVtfeGZhX29iamVjdC4kaXNEYXRhVmFsdWVdKCkgfHwgdGhpcy5faXNNYXRjaFRlbXBsYXRlKCkpIHsKICAgICAgdGhpcy5fYmluZEVsZW1lbnQoZm9ybU5vZGUsIGRhdGEpOwogICAgfSBlbHNlIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBOb2RlcyBoYXZlbid0IHRoZSBzYW1lIHR5cGUuYCk7CiAgICB9CiAgfQoKICBfZmluZERhdGFCeU5hbWVUb0NvbnN1bWUobmFtZSwgaXNWYWx1ZSwgZGF0YU5vZGUsIGdsb2JhbCkgewogICAgaWYgKCFuYW1lKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGxldCBnZW5lcmF0b3IsIG1hdGNoOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgIGdlbmVyYXRvciA9IGRhdGFOb2RlW194ZmFfb2JqZWN0LiRnZXRSZWFsQ2hpbGRyZW5CeU5hbWVJdF0obmFtZSwgZmFsc2UsIHRydWUpOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBtYXRjaCA9IGdlbmVyYXRvci5uZXh0KCkudmFsdWU7CgogICAgICAgIGlmICghbWF0Y2gpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKGlzVmFsdWUgPT09IG1hdGNoW194ZmFfb2JqZWN0LiRpc0RhdGFWYWx1ZV0oKSkgewogICAgICAgICAgcmV0dXJuIG1hdGNoOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGRhdGFOb2RlW194ZmFfb2JqZWN0LiRuYW1lc3BhY2VJZF0gPT09IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy5kYXRhc2V0cy5pZCAmJiBkYXRhTm9kZVtfeGZhX29iamVjdC4kbm9kZU5hbWVdID09PSAiZGF0YSIpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgZGF0YU5vZGUgPSBkYXRhTm9kZVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwogICAgfQoKICAgIGlmICghZ2xvYmFsKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGdlbmVyYXRvciA9IHRoaXMuZGF0YVtfeGZhX29iamVjdC4kZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXRdKG5hbWUsIHRydWUsIGZhbHNlKTsKICAgIG1hdGNoID0gZ2VuZXJhdG9yLm5leHQoKS52YWx1ZTsKCiAgICBpZiAobWF0Y2gpIHsKICAgICAgcmV0dXJuIG1hdGNoOwogICAgfQoKICAgIGdlbmVyYXRvciA9IHRoaXMuZGF0YVtfeGZhX29iamVjdC4kZ2V0QXR0cmlidXRlSXRdKG5hbWUsIHRydWUpOwogICAgbWF0Y2ggPSBnZW5lcmF0b3IubmV4dCgpLnZhbHVlOwoKICAgIGlmIChtYXRjaCAmJiBtYXRjaFtfeGZhX29iamVjdC4kaXNEYXRhVmFsdWVdKCkpIHsKICAgICAgcmV0dXJuIG1hdGNoOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgX3NldFByb3BlcnRpZXMoZm9ybU5vZGUsIGRhdGFOb2RlKSB7CiAgICBpZiAoIWZvcm1Ob2RlLmhhc093blByb3BlcnR5KCJzZXRQcm9wZXJ0eSIpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBmb3IgKGNvbnN0IHsKICAgICAgcmVmLAogICAgICB0YXJnZXQsCiAgICAgIGNvbm5lY3Rpb24KICAgIH0gb2YgZm9ybU5vZGUuc2V0UHJvcGVydHkuY2hpbGRyZW4pIHsKICAgICAgaWYgKGNvbm5lY3Rpb24pIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKCFyZWYpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3Qgbm9kZXMgPSAoMCwgX3NvbS5zZWFyY2hOb2RlKSh0aGlzLnJvb3QsIGRhdGFOb2RlLCByZWYsIGZhbHNlLCBmYWxzZSk7CgogICAgICBpZiAoIW5vZGVzKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIHJlZmVyZW5jZTogJHtyZWZ9LmApOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBbbm9kZV0gPSBub2RlczsKCiAgICAgIGlmICghbm9kZVtfeGZhX29iamVjdC4kaXNEZXNjZW5kZW50XSh0aGlzLmRhdGEpKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIG5vZGU6IG11c3QgYmUgYSBkYXRhIG5vZGUuYCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHRhcmdldE5vZGVzID0gKDAsIF9zb20uc2VhcmNoTm9kZSkodGhpcy5yb290LCBmb3JtTm9kZSwgdGFyZ2V0LCBmYWxzZSwgZmFsc2UpOwoKICAgICAgaWYgKCF0YXJnZXROb2RlcykgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gSW52YWxpZCB0YXJnZXQ6ICR7dGFyZ2V0fS5gKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgW3RhcmdldE5vZGVdID0gdGFyZ2V0Tm9kZXM7CgogICAgICBpZiAoIXRhcmdldE5vZGVbX3hmYV9vYmplY3QuJGlzRGVzY2VuZGVudF0oZm9ybU5vZGUpKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIHRhcmdldDogbXVzdCBiZSBhIHByb3BlcnR5IG9yIHN1YnByb3BlcnR5LmApOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCB0YXJnZXRQYXJlbnQgPSB0YXJnZXROb2RlW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgICBpZiAodGFyZ2V0Tm9kZSBpbnN0YW5jZW9mIF90ZW1wbGF0ZS5TZXRQcm9wZXJ0eSB8fCB0YXJnZXRQYXJlbnQgaW5zdGFuY2VvZiBfdGVtcGxhdGUuU2V0UHJvcGVydHkpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEludmFsaWQgdGFyZ2V0OiBjYW5ub3QgYmUgYSBzZXRQcm9wZXJ0eSBvciBvbmUgb2YgaXRzIHByb3BlcnRpZXMuYCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmICh0YXJnZXROb2RlIGluc3RhbmNlb2YgX3RlbXBsYXRlLkJpbmRJdGVtcyB8fCB0YXJnZXRQYXJlbnQgaW5zdGFuY2VvZiBfdGVtcGxhdGUuQmluZEl0ZW1zKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIHRhcmdldDogY2Fubm90IGJlIGEgYmluZEl0ZW1zIG9yIG9uZSBvZiBpdHMgcHJvcGVydGllcy5gKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgY29udGVudCA9IG5vZGVbX3hmYV9vYmplY3QuJHRleHRdKCk7CgogICAgICBjb25zdCBuYW1lID0gdGFyZ2V0Tm9kZVtfeGZhX29iamVjdC4kbm9kZU5hbWVdOwoKICAgICAgaWYgKHRhcmdldE5vZGUgaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFBdHRyaWJ1dGUpIHsKICAgICAgICBjb25zdCBhdHRycyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgYXR0cnNbbmFtZV0gPSBjb250ZW50OwogICAgICAgIGNvbnN0IG9iaiA9IFJlZmxlY3QuY29uc3RydWN0KE9iamVjdC5nZXRQcm90b3R5cGVPZih0YXJnZXRQYXJlbnQpLmNvbnN0cnVjdG9yLCBbYXR0cnNdKTsKICAgICAgICB0YXJnZXRQYXJlbnRbbmFtZV0gPSBvYmpbbmFtZV07CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmICghdGFyZ2V0Tm9kZS5oYXNPd25Qcm9wZXJ0eShfeGZhX29iamVjdC4kY29udGVudCkpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEludmFsaWQgbm9kZSB0byB1c2UgaW4gc2V0UHJvcGVydHlgKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdGFyZ2V0Tm9kZVtfeGZhX29iamVjdC4kZGF0YV0gPSBub2RlOwogICAgICB0YXJnZXROb2RlW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IGNvbnRlbnQ7CgogICAgICB0YXJnZXROb2RlW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKTsKICAgIH0KICB9CgogIF9iaW5kSXRlbXMoZm9ybU5vZGUsIGRhdGFOb2RlKSB7CiAgICBpZiAoIWZvcm1Ob2RlLmhhc093blByb3BlcnR5KCJpdGVtcyIpIHx8ICFmb3JtTm9kZS5oYXNPd25Qcm9wZXJ0eSgiYmluZEl0ZW1zIikgfHwgZm9ybU5vZGUuYmluZEl0ZW1zLmlzRW1wdHkoKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgZm9yIChjb25zdCBpdGVtIG9mIGZvcm1Ob2RlLml0ZW1zLmNoaWxkcmVuKSB7CiAgICAgIGZvcm1Ob2RlW194ZmFfb2JqZWN0LiRyZW1vdmVDaGlsZF0oaXRlbSk7CiAgICB9CgogICAgZm9ybU5vZGUuaXRlbXMuY2xlYXIoKTsKICAgIGNvbnN0IGxhYmVscyA9IG5ldyBfdGVtcGxhdGUuSXRlbXMoe30pOwogICAgY29uc3QgdmFsdWVzID0gbmV3IF90ZW1wbGF0ZS5JdGVtcyh7fSk7CgogICAgZm9ybU5vZGVbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXShsYWJlbHMpOwoKICAgIGZvcm1Ob2RlLml0ZW1zLnB1c2gobGFiZWxzKTsKCiAgICBmb3JtTm9kZVtfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKHZhbHVlcyk7CgogICAgZm9ybU5vZGUuaXRlbXMucHVzaCh2YWx1ZXMpOwoKICAgIGZvciAoY29uc3QgewogICAgICByZWYsCiAgICAgIGxhYmVsUmVmLAogICAgICB2YWx1ZVJlZiwKICAgICAgY29ubmVjdGlvbgogICAgfSBvZiBmb3JtTm9kZS5iaW5kSXRlbXMuY2hpbGRyZW4pIHsKICAgICAgaWYgKGNvbm5lY3Rpb24pIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKCFyZWYpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3Qgbm9kZXMgPSAoMCwgX3NvbS5zZWFyY2hOb2RlKSh0aGlzLnJvb3QsIGRhdGFOb2RlLCByZWYsIGZhbHNlLCBmYWxzZSk7CgogICAgICBpZiAoIW5vZGVzKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIHJlZmVyZW5jZTogJHtyZWZ9LmApOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHsKICAgICAgICBpZiAoIW5vZGVbX3hmYV9vYmplY3QuJGlzRGVzY2VuZGVudF0odGhpcy5kYXRhc2V0cykpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gSW52YWxpZCByZWYgKCR7cmVmfSk6IG11c3QgYmUgYSBkYXRhc2V0cyBjaGlsZC5gKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgbGFiZWxOb2RlcyA9ICgwLCBfc29tLnNlYXJjaE5vZGUpKHRoaXMucm9vdCwgbm9kZSwgbGFiZWxSZWYsIHRydWUsIGZhbHNlKTsKCiAgICAgICAgaWYgKCFsYWJlbE5vZGVzKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEludmFsaWQgbGFiZWw6ICR7bGFiZWxSZWZ9LmApOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBbbGFiZWxOb2RlXSA9IGxhYmVsTm9kZXM7CgogICAgICAgIGlmICghbGFiZWxOb2RlW194ZmFfb2JqZWN0LiRpc0Rlc2NlbmRlbnRdKHRoaXMuZGF0YXNldHMpKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEludmFsaWQgbGFiZWw6IG11c3QgYmUgYSBkYXRhc2V0cyBjaGlsZC5gKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgdmFsdWVOb2RlcyA9ICgwLCBfc29tLnNlYXJjaE5vZGUpKHRoaXMucm9vdCwgbm9kZSwgdmFsdWVSZWYsIHRydWUsIGZhbHNlKTsKCiAgICAgICAgaWYgKCF2YWx1ZU5vZGVzKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEludmFsaWQgdmFsdWU6ICR7dmFsdWVSZWZ9LmApOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBbdmFsdWVOb2RlXSA9IHZhbHVlTm9kZXM7CgogICAgICAgIGlmICghdmFsdWVOb2RlW194ZmFfb2JqZWN0LiRpc0Rlc2NlbmRlbnRdKHRoaXMuZGF0YXNldHMpKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEludmFsaWQgdmFsdWU6IG11c3QgYmUgYSBkYXRhc2V0cyBjaGlsZC5gKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgbGFiZWwgPSBjcmVhdGVUZXh0KGxhYmVsTm9kZVtfeGZhX29iamVjdC4kdGV4dF0oKSk7CiAgICAgICAgY29uc3QgdmFsdWUgPSBjcmVhdGVUZXh0KHZhbHVlTm9kZVtfeGZhX29iamVjdC4kdGV4dF0oKSk7CgogICAgICAgIGxhYmVsc1tfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKGxhYmVsKTsKCiAgICAgICAgbGFiZWxzLnRleHQucHVzaChsYWJlbCk7CgogICAgICAgIHZhbHVlc1tfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKHZhbHVlKTsKCiAgICAgICAgdmFsdWVzLnRleHQucHVzaCh2YWx1ZSk7CiAgICAgIH0KICAgIH0KICB9CgogIF9iaW5kT2NjdXJyZW5jZXMoZm9ybU5vZGUsIG1hdGNoZXMsIHBpY3R1cmUpIHsKICAgIGxldCBiYXNlQ2xvbmU7CgogICAgaWYgKG1hdGNoZXMubGVuZ3RoID4gMSkgewogICAgICBiYXNlQ2xvbmUgPSBmb3JtTm9kZVtfeGZhX29iamVjdC4kY2xvbmVdKCk7CgogICAgICBiYXNlQ2xvbmVbX3hmYV9vYmplY3QuJHJlbW92ZUNoaWxkXShiYXNlQ2xvbmUub2NjdXIpOwoKICAgICAgYmFzZUNsb25lLm9jY3VyID0gbnVsbDsKICAgIH0KCiAgICB0aGlzLl9iaW5kVmFsdWUoZm9ybU5vZGUsIG1hdGNoZXNbMF0sIHBpY3R1cmUpOwoKICAgIHRoaXMuX3NldFByb3BlcnRpZXMoZm9ybU5vZGUsIG1hdGNoZXNbMF0pOwoKICAgIHRoaXMuX2JpbmRJdGVtcyhmb3JtTm9kZSwgbWF0Y2hlc1swXSk7CgogICAgaWYgKG1hdGNoZXMubGVuZ3RoID09PSAxKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBwYXJlbnQgPSBmb3JtTm9kZVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IG5hbWUgPSBmb3JtTm9kZVtfeGZhX29iamVjdC4kbm9kZU5hbWVdOwoKICAgIGNvbnN0IHBvcyA9IHBhcmVudFtfeGZhX29iamVjdC4kaW5kZXhPZl0oZm9ybU5vZGUpOwoKICAgIGZvciAobGV0IGkgPSAxLCBpaSA9IG1hdGNoZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCBtYXRjaCA9IG1hdGNoZXNbaV07CgogICAgICBjb25zdCBjbG9uZSA9IGJhc2VDbG9uZVtfeGZhX29iamVjdC4kY2xvbmVdKCk7CgogICAgICBwYXJlbnRbbmFtZV0ucHVzaChjbG9uZSk7CgogICAgICBwYXJlbnRbX3hmYV9vYmplY3QuJGluc2VydEF0XShwb3MgKyBpLCBjbG9uZSk7CgogICAgICB0aGlzLl9iaW5kVmFsdWUoY2xvbmUsIG1hdGNoLCBwaWN0dXJlKTsKCiAgICAgIHRoaXMuX3NldFByb3BlcnRpZXMoY2xvbmUsIG1hdGNoKTsKCiAgICAgIHRoaXMuX2JpbmRJdGVtcyhjbG9uZSwgbWF0Y2gpOwogICAgfQogIH0KCiAgX2NyZWF0ZU9jY3VycmVuY2VzKGZvcm1Ob2RlKSB7CiAgICBpZiAoIXRoaXMuZW1wdHlNZXJnZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgewogICAgICBvY2N1cgogICAgfSA9IGZvcm1Ob2RlOwoKICAgIGlmICghb2NjdXIgfHwgb2NjdXIuaW5pdGlhbCA8PSAxKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBwYXJlbnQgPSBmb3JtTm9kZVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IG5hbWUgPSBmb3JtTm9kZVtfeGZhX29iamVjdC4kbm9kZU5hbWVdOwoKICAgIGlmICghKHBhcmVudFtuYW1lXSBpbnN0YW5jZW9mIF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IGN1cnJlbnROdW1iZXI7CgogICAgaWYgKGZvcm1Ob2RlLm5hbWUpIHsKICAgICAgY3VycmVudE51bWJlciA9IHBhcmVudFtuYW1lXS5jaGlsZHJlbi5maWx0ZXIoZSA9PiBlLm5hbWUgPT09IGZvcm1Ob2RlLm5hbWUpLmxlbmd0aDsKICAgIH0gZWxzZSB7CiAgICAgIGN1cnJlbnROdW1iZXIgPSBwYXJlbnRbbmFtZV0uY2hpbGRyZW4ubGVuZ3RoOwogICAgfQoKICAgIGNvbnN0IHBvcyA9IHBhcmVudFtfeGZhX29iamVjdC4kaW5kZXhPZl0oZm9ybU5vZGUpICsgMTsKICAgIGNvbnN0IGlpID0gb2NjdXIuaW5pdGlhbCAtIGN1cnJlbnROdW1iZXI7CgogICAgaWYgKGlpKSB7CiAgICAgIGNvbnN0IG5vZGVDbG9uZSA9IGZvcm1Ob2RlW194ZmFfb2JqZWN0LiRjbG9uZV0oKTsKCiAgICAgIG5vZGVDbG9uZVtfeGZhX29iamVjdC4kcmVtb3ZlQ2hpbGRdKG5vZGVDbG9uZS5vY2N1cik7CgogICAgICBub2RlQ2xvbmUub2NjdXIgPSBudWxsOwogICAgICBwYXJlbnRbbmFtZV0ucHVzaChub2RlQ2xvbmUpOwoKICAgICAgcGFyZW50W194ZmFfb2JqZWN0LiRpbnNlcnRBdF0ocG9zLCBub2RlQ2xvbmUpOwoKICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29uc3QgY2xvbmUgPSBub2RlQ2xvbmVbX3hmYV9vYmplY3QuJGNsb25lXSgpOwoKICAgICAgICBwYXJlbnRbbmFtZV0ucHVzaChjbG9uZSk7CgogICAgICAgIHBhcmVudFtfeGZhX29iamVjdC4kaW5zZXJ0QXRdKHBvcyArIGksIGNsb25lKTsKICAgICAgfQogICAgfQogIH0KCiAgX2dldE9jY3VySW5mbyhmb3JtTm9kZSkgewogICAgY29uc3QgewogICAgICBuYW1lLAogICAgICBvY2N1cgogICAgfSA9IGZvcm1Ob2RlOwoKICAgIGlmICghb2NjdXIgfHwgIW5hbWUpIHsKICAgICAgcmV0dXJuIFsxLCAxXTsKICAgIH0KCiAgICBjb25zdCBtYXggPSBvY2N1ci5tYXggPT09IC0xID8gSW5maW5pdHkgOiBvY2N1ci5tYXg7CiAgICByZXR1cm4gW29jY3VyLm1pbiwgbWF4XTsKICB9CgogIF9zZXRBbmRCaW5kKGZvcm1Ob2RlLCBkYXRhTm9kZSkgewogICAgdGhpcy5fc2V0UHJvcGVydGllcyhmb3JtTm9kZSwgZGF0YU5vZGUpOwoKICAgIHRoaXMuX2JpbmRJdGVtcyhmb3JtTm9kZSwgZGF0YU5vZGUpOwoKICAgIHRoaXMuX2JpbmRFbGVtZW50KGZvcm1Ob2RlLCBkYXRhTm9kZSk7CiAgfQoKICBfYmluZEVsZW1lbnQoZm9ybU5vZGUsIGRhdGFOb2RlKSB7CiAgICBjb25zdCB1c2VsZXNzTm9kZXMgPSBbXTsKCiAgICB0aGlzLl9jcmVhdGVPY2N1cnJlbmNlcyhmb3JtTm9kZSk7CgogICAgZm9yIChjb25zdCBjaGlsZCBvZiBmb3JtTm9kZVtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5dKCkpIHsKICAgICAgaWYgKGNoaWxkW194ZmFfb2JqZWN0LiRkYXRhXSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAodGhpcy5fbWVyZ2VNb2RlID09PSB1bmRlZmluZWQgJiYgY2hpbGRbX3hmYV9vYmplY3QuJG5vZGVOYW1lXSA9PT0gInN1YmZvcm0iKSB7CiAgICAgICAgdGhpcy5fbWVyZ2VNb2RlID0gY2hpbGQubWVyZ2VNb2RlID09PSAiY29uc3VtZURhdGEiOwoKICAgICAgICBjb25zdCBkYXRhQ2hpbGRyZW4gPSBkYXRhTm9kZVtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5dKCk7CgogICAgICAgIGlmIChkYXRhQ2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhpcy5fYmluZE9jY3VycmVuY2VzKGNoaWxkLCBbZGF0YUNoaWxkcmVuWzBdXSwgbnVsbCk7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmVtcHR5TWVyZ2UpIHsKICAgICAgICAgIGNvbnN0IG5zSWQgPSBkYXRhTm9kZVtfeGZhX29iamVjdC4kbmFtZXNwYWNlSWRdID09PSBOU19EQVRBU0VUUyA/IC0xIDogZGF0YU5vZGVbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXTsKICAgICAgICAgIGNvbnN0IGRhdGFDaGlsZCA9IGNoaWxkW194ZmFfb2JqZWN0LiRkYXRhXSA9IG5ldyBfeGZhX29iamVjdC5YbWxPYmplY3QobnNJZCwgY2hpbGQubmFtZSB8fCAicm9vdCIpOwoKICAgICAgICAgIGRhdGFOb2RlW194ZmFfb2JqZWN0LiRhcHBlbmRDaGlsZF0oZGF0YUNoaWxkKTsKCiAgICAgICAgICB0aGlzLl9iaW5kRWxlbWVudChjaGlsZCwgZGF0YUNoaWxkKTsKICAgICAgICB9CgogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAoIWNoaWxkW194ZmFfb2JqZWN0LiRpc0JpbmRhYmxlXSgpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGxldCBnbG9iYWwgPSBmYWxzZTsKICAgICAgbGV0IHBpY3R1cmUgPSBudWxsOwogICAgICBsZXQgcmVmID0gbnVsbDsKICAgICAgbGV0IG1hdGNoID0gbnVsbDsKCiAgICAgIGlmIChjaGlsZC5iaW5kKSB7CiAgICAgICAgc3dpdGNoIChjaGlsZC5iaW5kLm1hdGNoKSB7CiAgICAgICAgICBjYXNlICJub25lIjoKICAgICAgICAgICAgdGhpcy5fc2V0QW5kQmluZChjaGlsZCwgZGF0YU5vZGUpOwoKICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgY2FzZSAiZ2xvYmFsIjoKICAgICAgICAgICAgZ2xvYmFsID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiZGF0YVJlZiI6CiAgICAgICAgICAgIGlmICghY2hpbGQuYmluZC5yZWYpIHsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIHJlZiBpcyBlbXB0eSBpbiBub2RlICR7Y2hpbGRbX3hmYV9vYmplY3QuJG5vZGVOYW1lXX0uYCk7CgogICAgICAgICAgICAgIHRoaXMuX3NldEFuZEJpbmQoY2hpbGQsIGRhdGFOb2RlKTsKCiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJlZiA9IGNoaWxkLmJpbmQucmVmOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmIChjaGlsZC5iaW5kLnBpY3R1cmUpIHsKICAgICAgICAgIHBpY3R1cmUgPSBjaGlsZC5iaW5kLnBpY3R1cmVbX3hmYV9vYmplY3QuJGNvbnRlbnRdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgW21pbiwgbWF4XSA9IHRoaXMuX2dldE9jY3VySW5mbyhjaGlsZCk7CgogICAgICBpZiAocmVmKSB7CiAgICAgICAgbWF0Y2ggPSAoMCwgX3NvbS5zZWFyY2hOb2RlKSh0aGlzLnJvb3QsIGRhdGFOb2RlLCByZWYsIHRydWUsIGZhbHNlKTsKCiAgICAgICAgaWYgKG1hdGNoID09PSBudWxsKSB7CiAgICAgICAgICBtYXRjaCA9ICgwLCBfc29tLmNyZWF0ZURhdGFOb2RlKSh0aGlzLmRhdGEsIGRhdGFOb2RlLCByZWYpOwoKICAgICAgICAgIGlmICghbWF0Y2gpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoaXMuX2lzQ29uc3VtZURhdGEoKSkgewogICAgICAgICAgICBtYXRjaFtfeGZhX29iamVjdC4kY29uc3VtZWRdID0gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLl9zZXRBbmRCaW5kKGNoaWxkLCBtYXRjaCk7CgogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICh0aGlzLl9pc0NvbnN1bWVEYXRhKCkpIHsKICAgICAgICAgICAgbWF0Y2ggPSBtYXRjaC5maWx0ZXIobm9kZSA9PiAhbm9kZVtfeGZhX29iamVjdC4kY29uc3VtZWRdKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobWF0Y2gubGVuZ3RoID4gbWF4KSB7CiAgICAgICAgICAgIG1hdGNoID0gbWF0Y2guc2xpY2UoMCwgbWF4KTsKICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2gubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIG1hdGNoID0gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobWF0Y2ggJiYgdGhpcy5faXNDb25zdW1lRGF0YSgpKSB7CiAgICAgICAgICAgIG1hdGNoLmZvckVhY2gobm9kZSA9PiB7CiAgICAgICAgICAgICAgbm9kZVtfeGZhX29iamVjdC4kY29uc3VtZWRdID0gdHJ1ZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICghY2hpbGQubmFtZSkgewogICAgICAgICAgdGhpcy5fc2V0QW5kQmluZChjaGlsZCwgZGF0YU5vZGUpOwoKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuX2lzQ29uc3VtZURhdGEoKSkgewogICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IFtdOwoKICAgICAgICAgIHdoaWxlIChtYXRjaGVzLmxlbmd0aCA8IG1heCkgewogICAgICAgICAgICBjb25zdCBmb3VuZCA9IHRoaXMuX2ZpbmREYXRhQnlOYW1lVG9Db25zdW1lKGNoaWxkLm5hbWUsIGNoaWxkW194ZmFfb2JqZWN0LiRoYXNTZXR0YWJsZVZhbHVlXSgpLCBkYXRhTm9kZSwgZ2xvYmFsKTsKCiAgICAgICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm91bmRbX3hmYV9vYmplY3QuJGNvbnN1bWVkXSA9IHRydWU7CiAgICAgICAgICAgIG1hdGNoZXMucHVzaChmb3VuZCk7CiAgICAgICAgICB9CgogICAgICAgICAgbWF0Y2ggPSBtYXRjaGVzLmxlbmd0aCA+IDAgPyBtYXRjaGVzIDogbnVsbDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbWF0Y2ggPSBkYXRhTm9kZVtfeGZhX29iamVjdC4kZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXRdKGNoaWxkLm5hbWUsIGZhbHNlLCB0aGlzLmVtcHR5TWVyZ2UpLm5leHQoKS52YWx1ZTsKCiAgICAgICAgICBpZiAoIW1hdGNoKSB7CiAgICAgICAgICAgIGlmIChtaW4gPT09IDApIHsKICAgICAgICAgICAgICB1c2VsZXNzTm9kZXMucHVzaChjaGlsZCk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IG5zSWQgPSBkYXRhTm9kZVtfeGZhX29iamVjdC4kbmFtZXNwYWNlSWRdID09PSBOU19EQVRBU0VUUyA/IC0xIDogZGF0YU5vZGVbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXTsKICAgICAgICAgICAgbWF0Y2ggPSBjaGlsZFtfeGZhX29iamVjdC4kZGF0YV0gPSBuZXcgX3hmYV9vYmplY3QuWG1sT2JqZWN0KG5zSWQsIGNoaWxkLm5hbWUpOwoKICAgICAgICAgICAgaWYgKHRoaXMuZW1wdHlNZXJnZSkgewogICAgICAgICAgICAgIG1hdGNoW194ZmFfb2JqZWN0LiRjb25zdW1lZF0gPSB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBkYXRhTm9kZVtfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKG1hdGNoKTsKCiAgICAgICAgICAgIHRoaXMuX3NldEFuZEJpbmQoY2hpbGQsIG1hdGNoKTsKCiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLmVtcHR5TWVyZ2UpIHsKICAgICAgICAgICAgbWF0Y2hbX3hmYV9vYmplY3QuJGNvbnN1bWVkXSA9IHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgbWF0Y2ggPSBbbWF0Y2hdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKG1hdGNoKSB7CiAgICAgICAgdGhpcy5fYmluZE9jY3VycmVuY2VzKGNoaWxkLCBtYXRjaCwgcGljdHVyZSk7CiAgICAgIH0gZWxzZSBpZiAobWluID4gMCkgewogICAgICAgIHRoaXMuX3NldEFuZEJpbmQoY2hpbGQsIGRhdGFOb2RlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB1c2VsZXNzTm9kZXMucHVzaChjaGlsZCk7CiAgICAgIH0KICAgIH0KCiAgICB1c2VsZXNzTm9kZXMuZm9yRWFjaChub2RlID0+IG5vZGVbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKVtfeGZhX29iamVjdC4kcmVtb3ZlQ2hpbGRdKG5vZGUpKTsKICB9Cgp9CgpleHBvcnRzLkJpbmRlciA9IEJpbmRlcjsKCi8qKiovIH0pLAovKiAyMDcgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlZhbHVlID0gZXhwb3J0cy5UZXh0ID0gZXhwb3J0cy5UZW1wbGF0ZU5hbWVzcGFjZSA9IGV4cG9ydHMuVGVtcGxhdGUgPSBleHBvcnRzLlNldFByb3BlcnR5ID0gZXhwb3J0cy5JdGVtcyA9IGV4cG9ydHMuRmllbGQgPSBleHBvcnRzLkJpbmRJdGVtcyA9IHZvaWQgMDsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAyKTsKCnZhciBfbmFtZXNwYWNlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA0KTsKCnZhciBfbGF5b3V0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDgpOwoKdmFyIF9odG1sX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDkpOwoKdmFyIF91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAzKTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2ZvbnRzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTApOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKdmFyIF9zb20gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNSk7Cgpjb25zdCBURU1QTEFURV9OU19JRCA9IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy50ZW1wbGF0ZS5pZDsKY29uc3QgU1ZHX05TID0gImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIjsKY29uc3QgTUFYX0FUVEVNUFRTX0ZPUl9MUlRCX0xBWU9VVCA9IDI7CmNvbnN0IE1BWF9FTVBUWV9QQUdFUyA9IDM7CmNvbnN0IERFRkFVTFRfVEFCX0lOREVYID0gNTAwMDsKY29uc3QgSEVBRElOR19QQVRURVJOID0gL15IKFxkKykkLzsKY29uc3QgTUlNRVMgPSBuZXcgU2V0KFsiaW1hZ2UvZ2lmIiwgImltYWdlL2pwZWciLCAiaW1hZ2UvanBnIiwgImltYWdlL3BqcGVnIiwgImltYWdlL3BuZyIsICJpbWFnZS9hcG5nIiwgImltYWdlL3gtcG5nIiwgImltYWdlL2JtcCIsICJpbWFnZS94LW1zLWJtcCIsICJpbWFnZS90aWZmIiwgImltYWdlL3RpZiIsICJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iXSk7CmNvbnN0IElNQUdFU19IRUFERVJTID0gW1tbMHg0MiwgMHg0ZF0sICJpbWFnZS9ibXAiXSwgW1sweGZmLCAweGQ4LCAweGZmXSwgImltYWdlL2pwZWciXSwgW1sweDQ5LCAweDQ5LCAweDJhLCAweDAwXSwgImltYWdlL3RpZmYiXSwgW1sweDRkLCAweDRkLCAweDAwLCAweDJhXSwgImltYWdlL3RpZmYiXSwgW1sweDQ3LCAweDQ5LCAweDQ2LCAweDM4LCAweDM5LCAweDYxXSwgImltYWdlL2dpZiJdLCBbWzB4ODksIDB4NTAsIDB4NGUsIDB4NDcsIDB4MGQsIDB4MGEsIDB4MWEsIDB4MGFdLCAiaW1hZ2UvcG5nIl1dOwoKZnVuY3Rpb24gZ2V0Qm9yZGVyRGltcyhub2RlKSB7CiAgaWYgKCFub2RlIHx8ICFub2RlLmJvcmRlcikgewogICAgcmV0dXJuIHsKICAgICAgdzogMCwKICAgICAgaDogMAogICAgfTsKICB9CgogIGNvbnN0IGJvcmRlckV4dHJhID0gbm9kZS5ib3JkZXJbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpOwoKICBpZiAoIWJvcmRlckV4dHJhKSB7CiAgICByZXR1cm4gewogICAgICB3OiAwLAogICAgICBoOiAwCiAgICB9OwogIH0KCiAgcmV0dXJuIHsKICAgIHc6IGJvcmRlckV4dHJhLndpZHRoc1swXSArIGJvcmRlckV4dHJhLndpZHRoc1syXSArIGJvcmRlckV4dHJhLmluc2V0c1swXSArIGJvcmRlckV4dHJhLmluc2V0c1syXSwKICAgIGg6IGJvcmRlckV4dHJhLndpZHRoc1sxXSArIGJvcmRlckV4dHJhLndpZHRoc1szXSArIGJvcmRlckV4dHJhLmluc2V0c1sxXSArIGJvcmRlckV4dHJhLmluc2V0c1szXQogIH07Cn0KCmZ1bmN0aW9uIGhhc01hcmdpbihub2RlKSB7CiAgcmV0dXJuIG5vZGUubWFyZ2luICYmIChub2RlLm1hcmdpbi50b3BJbnNldCB8fCBub2RlLm1hcmdpbi5yaWdodEluc2V0IHx8IG5vZGUubWFyZ2luLmJvdHRvbUluc2V0IHx8IG5vZGUubWFyZ2luLmxlZnRJbnNldCk7Cn0KCmZ1bmN0aW9uIF9zZXRWYWx1ZSh0ZW1wbGF0ZU5vZGUsIHZhbHVlKSB7CiAgaWYgKCF0ZW1wbGF0ZU5vZGUudmFsdWUpIHsKICAgIGNvbnN0IG5vZGVWYWx1ZSA9IG5ldyBWYWx1ZSh7fSk7CgogICAgdGVtcGxhdGVOb2RlW194ZmFfb2JqZWN0LiRhcHBlbmRDaGlsZF0obm9kZVZhbHVlKTsKCiAgICB0ZW1wbGF0ZU5vZGUudmFsdWUgPSBub2RlVmFsdWU7CiAgfQoKICB0ZW1wbGF0ZU5vZGUudmFsdWVbX3hmYV9vYmplY3QuJHNldFZhbHVlXSh2YWx1ZSk7Cn0KCmZ1bmN0aW9uKiBnZXRDb250YWluZWRDaGlsZHJlbihub2RlKSB7CiAgZm9yIChjb25zdCBjaGlsZCBvZiBub2RlW194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbl0oKSkgewogICAgaWYgKGNoaWxkIGluc3RhbmNlb2YgU3ViZm9ybVNldCkgewogICAgICB5aWVsZCogY2hpbGRbX3hmYV9vYmplY3QuJGdldENvbnRhaW5lZENoaWxkcmVuXSgpOwogICAgICBjb250aW51ZTsKICAgIH0KCiAgICB5aWVsZCBjaGlsZDsKICB9Cn0KCmZ1bmN0aW9uIGlzUmVxdWlyZWQobm9kZSkgewogIHJldHVybiBub2RlLnZhbGlkYXRlICYmIG5vZGUudmFsaWRhdGUubnVsbFRlc3QgPT09ICJlcnJvciI7Cn0KCmZ1bmN0aW9uIHNldFRhYkluZGV4KG5vZGUpIHsKICB3aGlsZSAobm9kZSkgewogICAgaWYgKCFub2RlLnRyYXZlcnNhbCkgewogICAgICBub2RlW194ZmFfb2JqZWN0LiR0YWJJbmRleF0gPSBub2RlW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKClbX3hmYV9vYmplY3QuJHRhYkluZGV4XTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChub2RlW194ZmFfb2JqZWN0LiR0YWJJbmRleF0pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBuZXh0ID0gbnVsbDsKCiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG5vZGUudHJhdmVyc2FsW194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbl0oKSkgewogICAgICBpZiAoY2hpbGQub3BlcmF0aW9uID09PSAibmV4dCIpIHsKICAgICAgICBuZXh0ID0gY2hpbGQ7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIW5leHQgfHwgIW5leHQucmVmKSB7CiAgICAgIG5vZGVbX3hmYV9vYmplY3QuJHRhYkluZGV4XSA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKVtfeGZhX29iamVjdC4kdGFiSW5kZXhdOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3Qgcm9vdCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKTsKCiAgICBub2RlW194ZmFfb2JqZWN0LiR0YWJJbmRleF0gPSArK3Jvb3RbX3hmYV9vYmplY3QuJHRhYkluZGV4XTsKCiAgICBjb25zdCByZWYgPSByb290W194ZmFfb2JqZWN0LiRzZWFyY2hOb2RlXShuZXh0LnJlZiwgbm9kZSk7CgogICAgaWYgKCFyZWYpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIG5vZGUgPSByZWZbMF07CiAgfQp9CgpmdW5jdGlvbiBhcHBseUFzc2lzdChvYmosIGF0dHJpYnV0ZXMpIHsKICBjb25zdCBhc3Npc3QgPSBvYmouYXNzaXN0OwoKICBpZiAoYXNzaXN0KSB7CiAgICBjb25zdCBhc3Npc3RUaXRsZSA9IGFzc2lzdFtfeGZhX29iamVjdC4kdG9IVE1MXSgpOwoKICAgIGlmIChhc3Npc3RUaXRsZSkgewogICAgICBhdHRyaWJ1dGVzLnRpdGxlID0gYXNzaXN0VGl0bGU7CiAgICB9CgogICAgY29uc3Qgcm9sZSA9IGFzc2lzdC5yb2xlOwogICAgY29uc3QgbWF0Y2ggPSByb2xlLm1hdGNoKEhFQURJTkdfUEFUVEVSTik7CgogICAgaWYgKG1hdGNoKSB7CiAgICAgIGNvbnN0IGFyaWFSb2xlID0gImhlYWRpbmciOwogICAgICBjb25zdCBhcmlhTGV2ZWwgPSBtYXRjaFsxXTsKICAgICAgYXR0cmlidXRlcy5yb2xlID0gYXJpYVJvbGU7CiAgICAgIGF0dHJpYnV0ZXNbImFyaWEtbGV2ZWwiXSA9IGFyaWFMZXZlbDsKICAgIH0KICB9CgogIGlmIChvYmoubGF5b3V0ID09PSAidGFibGUiKSB7CiAgICBhdHRyaWJ1dGVzLnJvbGUgPSAidGFibGUiOwogIH0gZWxzZSBpZiAob2JqLmxheW91dCA9PT0gInJvdyIpIHsKICAgIGF0dHJpYnV0ZXMucm9sZSA9ICJyb3ciOwogIH0gZWxzZSB7CiAgICBjb25zdCBwYXJlbnQgPSBvYmpbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBpZiAocGFyZW50LmxheW91dCA9PT0gInJvdyIpIHsKICAgICAgaWYgKHBhcmVudC5hc3Npc3QgJiYgcGFyZW50LmFzc2lzdC5yb2xlID09PSAiVEgiKSB7CiAgICAgICAgYXR0cmlidXRlcy5yb2xlID0gImNvbHVtbmhlYWRlciI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYXR0cmlidXRlcy5yb2xlID0gImNlbGwiOwogICAgICB9CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBhcmlhTGFiZWwob2JqKSB7CiAgaWYgKCFvYmouYXNzaXN0KSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IGFzc2lzdCA9IG9iai5hc3Npc3Q7CgogIGlmIChhc3Npc3Quc3BlYWsgJiYgYXNzaXN0LnNwZWFrW194ZmFfb2JqZWN0LiRjb250ZW50XSAhPT0gIiIpIHsKICAgIHJldHVybiBhc3Npc3Quc3BlYWtbX3hmYV9vYmplY3QuJGNvbnRlbnRdOwogIH0KCiAgaWYgKGFzc2lzdC50b29sVGlwKSB7CiAgICByZXR1cm4gYXNzaXN0LnRvb2xUaXBbX3hmYV9vYmplY3QuJGNvbnRlbnRdOwogIH0KCiAgcmV0dXJuIG51bGw7Cn0KCmZ1bmN0aW9uIHZhbHVlVG9IdG1sKHZhbHVlKSB7CiAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgbmFtZTogImRpdiIsCiAgICBhdHRyaWJ1dGVzOiB7CiAgICAgIGNsYXNzOiBbInhmYVJpY2giXSwKICAgICAgc3R5bGU6IE9iamVjdC5jcmVhdGUobnVsbCkKICAgIH0sCiAgICBjaGlsZHJlbjogW3sKICAgICAgbmFtZTogInNwYW4iLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgc3R5bGU6IE9iamVjdC5jcmVhdGUobnVsbCkKICAgICAgfSwKICAgICAgdmFsdWUKICAgIH1dCiAgfSk7Cn0KCmZ1bmN0aW9uIHNldEZpcnN0VW5zcGxpdHRhYmxlKG5vZGUpIHsKICBjb25zdCByb290ID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpOwoKICBpZiAocm9vdFtfeGZhX29iamVjdC4kZXh0cmFdLmZpcnN0VW5zcGxpdHRhYmxlID09PSBudWxsKSB7CiAgICByb290W194ZmFfb2JqZWN0LiRleHRyYV0uZmlyc3RVbnNwbGl0dGFibGUgPSBub2RlOwogICAgcm9vdFtfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSA9IHRydWU7CiAgfQp9CgpmdW5jdGlvbiB1bnNldEZpcnN0VW5zcGxpdHRhYmxlKG5vZGUpIHsKICBjb25zdCByb290ID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpOwoKICBpZiAocm9vdFtfeGZhX29iamVjdC4kZXh0cmFdLmZpcnN0VW5zcGxpdHRhYmxlID09PSBub2RlKSB7CiAgICByb290W194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlID0gZmFsc2U7CiAgfQp9CgpmdW5jdGlvbiBoYW5kbGVCcmVhayhub2RlKSB7CiAgaWYgKG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgaWYgKG5vZGUudGFyZ2V0VHlwZSA9PT0gImF1dG8iKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBjb25zdCByb290ID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpOwoKICBsZXQgdGFyZ2V0ID0gbnVsbDsKCiAgaWYgKG5vZGUudGFyZ2V0KSB7CiAgICB0YXJnZXQgPSByb290W194ZmFfb2JqZWN0LiRzZWFyY2hOb2RlXShub2RlLnRhcmdldCwgbm9kZVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpKTsKCiAgICBpZiAoIXRhcmdldCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdGFyZ2V0ID0gdGFyZ2V0WzBdOwogIH0KCiAgY29uc3QgewogICAgY3VycmVudFBhZ2VBcmVhLAogICAgY3VycmVudENvbnRlbnRBcmVhCiAgfSA9IHJvb3RbX3hmYV9vYmplY3QuJGV4dHJhXTsKCiAgaWYgKG5vZGUudGFyZ2V0VHlwZSA9PT0gInBhZ2VBcmVhIikgewogICAgaWYgKCEodGFyZ2V0IGluc3RhbmNlb2YgUGFnZUFyZWEpKSB7CiAgICAgIHRhcmdldCA9IG51bGw7CiAgICB9CgogICAgaWYgKG5vZGUuc3RhcnROZXcpIHsKICAgICAgbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLnRhcmdldCA9IHRhcmdldCB8fCBjdXJyZW50UGFnZUFyZWE7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIGlmICh0YXJnZXQgJiYgdGFyZ2V0ICE9PSBjdXJyZW50UGFnZUFyZWEpIHsKICAgICAgbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLnRhcmdldCA9IHRhcmdldDsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgaWYgKCEodGFyZ2V0IGluc3RhbmNlb2YgQ29udGVudEFyZWEpKSB7CiAgICB0YXJnZXQgPSBudWxsOwogIH0KCiAgY29uc3QgcGFnZUFyZWEgPSB0YXJnZXQgJiYgdGFyZ2V0W194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogIGxldCBpbmRleDsKICBsZXQgbmV4dFBhZ2VBcmVhID0gcGFnZUFyZWE7CgogIGlmIChub2RlLnN0YXJ0TmV3KSB7CiAgICBpZiAodGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvbnRlbnRBcmVhcyA9IHBhZ2VBcmVhLmNvbnRlbnRBcmVhLmNoaWxkcmVuOwogICAgICBjb25zdCBpbmRleEZvckN1cnJlbnQgPSBjb250ZW50QXJlYXMuaW5kZXhPZihjdXJyZW50Q29udGVudEFyZWEpOwogICAgICBjb25zdCBpbmRleEZvclRhcmdldCA9IGNvbnRlbnRBcmVhcy5pbmRleE9mKHRhcmdldCk7CgogICAgICBpZiAoaW5kZXhGb3JDdXJyZW50ICE9PSAtMSAmJiBpbmRleEZvckN1cnJlbnQgPCBpbmRleEZvclRhcmdldCkgewogICAgICAgIG5leHRQYWdlQXJlYSA9IG51bGw7CiAgICAgIH0KCiAgICAgIGluZGV4ID0gaW5kZXhGb3JUYXJnZXQgLSAxOwogICAgfSBlbHNlIHsKICAgICAgaW5kZXggPSBjdXJyZW50UGFnZUFyZWEuY29udGVudEFyZWEuY2hpbGRyZW4uaW5kZXhPZihjdXJyZW50Q29udGVudEFyZWEpOwogICAgfQogIH0gZWxzZSBpZiAodGFyZ2V0ICYmIHRhcmdldCAhPT0gY3VycmVudENvbnRlbnRBcmVhKSB7CiAgICBjb25zdCBjb250ZW50QXJlYXMgPSBwYWdlQXJlYS5jb250ZW50QXJlYS5jaGlsZHJlbjsKICAgIGluZGV4ID0gY29udGVudEFyZWFzLmluZGV4T2YodGFyZ2V0KSAtIDE7CiAgICBuZXh0UGFnZUFyZWEgPSBwYWdlQXJlYSA9PT0gY3VycmVudFBhZ2VBcmVhID8gbnVsbCA6IHBhZ2VBcmVhOwogIH0gZWxzZSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0udGFyZ2V0ID0gbmV4dFBhZ2VBcmVhOwogIG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS5pbmRleCA9IGluZGV4OwogIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBoYW5kbGVPdmVyZmxvdyhub2RlLCBleHRyYU5vZGUsIHNwYWNlKSB7CiAgY29uc3Qgcm9vdCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKTsKCiAgY29uc3Qgc2F2ZWQgPSByb290W194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlOwogIGNvbnN0IHNhdmVkTWV0aG9kID0gZXh0cmFOb2RlW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XTsKCiAgZXh0cmFOb2RlW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSA9ICgpID0+IG5vZGU7CgogIHJvb3RbX3hmYV9vYmplY3QuJGV4dHJhXS5ub0xheW91dEZhaWx1cmUgPSB0cnVlOwoKICBjb25zdCByZXMgPSBleHRyYU5vZGVbX3hmYV9vYmplY3QuJHRvSFRNTF0oc3BhY2UpOwoKICBub2RlW194ZmFfb2JqZWN0LiRhZGRIVE1MXShyZXMuaHRtbCwgcmVzLmJib3gpOwoKICByb290W194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlID0gc2F2ZWQ7CiAgZXh0cmFOb2RlW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSA9IHNhdmVkTWV0aG9kOwp9CgpjbGFzcyBBcHBlYXJhbmNlRmlsdGVyIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImFwcGVhcmFuY2VGaWx0ZXIiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgQXJjIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImFyYyIsIHRydWUpOwogICAgdGhpcy5jaXJjdWxhciA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmNpcmN1bGFyLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy5oYW5kID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaGFuZCwgWyJldmVuIiwgImxlZnQiLCAicmlnaHQiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMuc3RhcnRBbmdsZSA9ICgwLCBfdXRpbHMuZ2V0RmxvYXQpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5zdGFydEFuZ2xlLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHRydWUKICAgIH0pOwogICAgdGhpcy5zd2VlcEFuZ2xlID0gKDAsIF91dGlscy5nZXRGbG9hdCkoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnN3ZWVwQW5nbGUsCiAgICAgIGRlZmF1bHRWYWx1ZTogMzYwLAogICAgICB2YWxpZGF0ZTogeCA9PiB0cnVlCiAgICB9KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmVkZ2UgPSBudWxsOwogICAgdGhpcy5maWxsID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXSgpIHsKICAgIGNvbnN0IGVkZ2UgPSB0aGlzLmVkZ2UgfHwgbmV3IEVkZ2Uoe30pOwoKICAgIGNvbnN0IGVkZ2VTdHlsZSA9IGVkZ2VbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCk7CgogICAgY29uc3Qgc3R5bGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGlmICh0aGlzLmZpbGwgJiYgdGhpcy5maWxsLnByZXNlbmNlID09PSAidmlzaWJsZSIpIHsKICAgICAgT2JqZWN0LmFzc2lnbihzdHlsZSwgdGhpcy5maWxsW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpKTsKICAgIH0gZWxzZSB7CiAgICAgIHN0eWxlLmZpbGwgPSAidHJhbnNwYXJlbnQiOwogICAgfQoKICAgIHN0eWxlLnN0cm9rZVdpZHRoID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykoZWRnZS5wcmVzZW5jZSA9PT0gInZpc2libGUiID8gZWRnZS50aGlja25lc3MgOiAwKTsKICAgIHN0eWxlLnN0cm9rZSA9IGVkZ2VTdHlsZS5jb2xvcjsKICAgIGxldCBhcmM7CiAgICBjb25zdCBhdHRyaWJ1dGVzID0gewogICAgICB4bWxuczogU1ZHX05TLAogICAgICBzdHlsZTogewogICAgICAgIHdpZHRoOiAiMTAwJSIsCiAgICAgICAgaGVpZ2h0OiAiMTAwJSIsCiAgICAgICAgb3ZlcmZsb3c6ICJ2aXNpYmxlIgogICAgICB9CiAgICB9OwoKICAgIGlmICh0aGlzLnN3ZWVwQW5nbGUgPT09IDM2MCkgewogICAgICBhcmMgPSB7CiAgICAgICAgbmFtZTogImVsbGlwc2UiLAogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIHhtbG5zOiBTVkdfTlMsCiAgICAgICAgICBjeDogIjUwJSIsCiAgICAgICAgICBjeTogIjUwJSIsCiAgICAgICAgICByeDogIjUwJSIsCiAgICAgICAgICByeTogIjUwJSIsCiAgICAgICAgICBzdHlsZQogICAgICAgIH0KICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IHN0YXJ0QW5nbGUgPSB0aGlzLnN0YXJ0QW5nbGUgKiBNYXRoLlBJIC8gMTgwOwogICAgICBjb25zdCBzd2VlcEFuZ2xlID0gdGhpcy5zd2VlcEFuZ2xlICogTWF0aC5QSSAvIDE4MDsKICAgICAgY29uc3QgbGFyZ2VBcmMgPSB0aGlzLnN3ZWVwQW5nbGUgPiAxODAgPyAxIDogMDsKICAgICAgY29uc3QgW3gxLCB5MSwgeDIsIHkyXSA9IFs1MCAqICgxICsgTWF0aC5jb3Moc3RhcnRBbmdsZSkpLCA1MCAqICgxIC0gTWF0aC5zaW4oc3RhcnRBbmdsZSkpLCA1MCAqICgxICsgTWF0aC5jb3Moc3RhcnRBbmdsZSArIHN3ZWVwQW5nbGUpKSwgNTAgKiAoMSAtIE1hdGguc2luKHN0YXJ0QW5nbGUgKyBzd2VlcEFuZ2xlKSldOwogICAgICBhcmMgPSB7CiAgICAgICAgbmFtZTogInBhdGgiLAogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIHhtbG5zOiBTVkdfTlMsCiAgICAgICAgICBkOiBgTSAke3gxfSAke3kxfSBBIDUwIDUwIDAgJHtsYXJnZUFyY30gMCAke3gyfSAke3kyfWAsCiAgICAgICAgICB2ZWN0b3JFZmZlY3Q6ICJub24tc2NhbGluZy1zdHJva2UiLAogICAgICAgICAgc3R5bGUKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5hc3NpZ24oYXR0cmlidXRlcywgewogICAgICAgIHZpZXdCb3g6ICIwIDAgMTAwIDEwMCIsCiAgICAgICAgcHJlc2VydmVBc3BlY3RSYXRpbzogIm5vbmUiCiAgICAgIH0pOwogICAgfQoKICAgIGNvbnN0IHN2ZyA9IHsKICAgICAgbmFtZTogInN2ZyIsCiAgICAgIGNoaWxkcmVuOiBbYXJjXSwKICAgICAgYXR0cmlidXRlcwogICAgfTsKCiAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKClbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBpZiAoaGFzTWFyZ2luKHBhcmVudCkpIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICAgIG5hbWU6ICJkaXYiLAogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgIGRpc3BsYXk6ICJpbmxpbmUiLAogICAgICAgICAgICB3aWR0aDogIjEwMCUiLAogICAgICAgICAgICBoZWlnaHQ6ICIxMDAlIgogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgY2hpbGRyZW46IFtzdmddCiAgICAgIH0pOwogICAgfQoKICAgIHN2Zy5hdHRyaWJ1dGVzLnN0eWxlLnBvc2l0aW9uID0gImFic29sdXRlIjsKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHN2Zyk7CiAgfQoKfQoKY2xhc3MgQXJlYSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJhcmVhIiwgdHJ1ZSk7CiAgICB0aGlzLmNvbFNwYW4gPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5jb2xTcGFuLAogICAgICBkZWZhdWx0VmFsdWU6IDEsCiAgICAgIHZhbGlkYXRlOiBuID0+IG4gPj0gMSB8fCBuID09PSAtMQogICAgfSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucmVsZXZhbnQgPSAoMCwgX3V0aWxzLmdldFJlbGV2YW50KShhdHRyaWJ1dGVzLnJlbGV2YW50KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLnggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLngsICIwcHQiKTsKICAgIHRoaXMueSA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMueSwgIjBwdCIpOwogICAgdGhpcy5kZXNjID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMuYXJlYSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kcmF3ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4T2JqZWN0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4Y2xHcm91cCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5maWVsZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zdWJmb3JtID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnN1YmZvcm1TZXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9CgogICpbX3hmYV9vYmplY3QuJGdldENvbnRhaW5lZENoaWxkcmVuXSgpIHsKICAgIHlpZWxkKiBnZXRDb250YWluZWRDaGlsZHJlbih0aGlzKTsKICB9CgogIFtfeGZhX29iamVjdC4kaXNUcmFuc3BhcmVudF0oKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIFtfeGZhX29iamVjdC4kaXNCaW5kYWJsZV0oKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIFtfeGZhX29iamVjdC4kYWRkSFRNTF0oaHRtbCwgYmJveCkgewogICAgY29uc3QgW3gsIHksIHcsIGhdID0gYmJveDsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS53aWR0aCA9IE1hdGgubWF4KHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS53aWR0aCwgeCArIHcpOwogICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmhlaWdodCA9IE1hdGgubWF4KHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5oZWlnaHQsIHkgKyBoKTsKCiAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uY2hpbGRyZW4ucHVzaChodG1sKTsKICB9CgogIFtfeGZhX29iamVjdC4kZ2V0QXZhaWxhYmxlU3BhY2VdKCkgewogICAgcmV0dXJuIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5hdmFpbGFibGVTcGFjZTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgY29uc3Qgc3R5bGUgPSAoMCwgX2h0bWxfdXRpbHMudG9TdHlsZSkodGhpcywgInBvc2l0aW9uIik7CiAgICBjb25zdCBhdHRyaWJ1dGVzID0gewogICAgICBzdHlsZSwKICAgICAgaWQ6IHRoaXNbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgIGNsYXNzOiBbInhmYUFyZWEiXQogICAgfTsKCiAgICBpZiAoKDAsIF9odG1sX3V0aWxzLmlzUHJpbnRPbmx5KSh0aGlzKSkgewogICAgICBhdHRyaWJ1dGVzLmNsYXNzLnB1c2goInhmYVByaW50T25seSIpOwogICAgfQoKICAgIGlmICh0aGlzLm5hbWUpIHsKICAgICAgYXR0cmlidXRlcy54ZmFOYW1lID0gdGhpcy5uYW1lOwogICAgfQoKICAgIGNvbnN0IGNoaWxkcmVuID0gW107CiAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSB7CiAgICAgIGNoaWxkcmVuLAogICAgICB3aWR0aDogMCwKICAgICAgaGVpZ2h0OiAwLAogICAgICBhdmFpbGFibGVTcGFjZQogICAgfTsKCiAgICBjb25zdCByZXN1bHQgPSB0aGlzW194ZmFfb2JqZWN0LiRjaGlsZHJlblRvSFRNTF0oewogICAgICBmaWx0ZXI6IG5ldyBTZXQoWyJhcmVhIiwgImRyYXciLCAiZmllbGQiLCAiZXhjbEdyb3VwIiwgInN1YmZvcm0iLCAic3ViZm9ybVNldCJdKSwKICAgICAgaW5jbHVkZTogdHJ1ZQogICAgfSk7CgogICAgaWYgKCFyZXN1bHQuc3VjY2VzcykgewogICAgICBpZiAocmVzdWx0LmlzQnJlYWsoKSkgewogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0KCiAgICAgIGRlbGV0ZSB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV07CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5GQUlMVVJFOwogICAgfQoKICAgIHN0eWxlLndpZHRoID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLndpZHRoKTsKICAgIHN0eWxlLmhlaWdodCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5oZWlnaHQpOwogICAgY29uc3QgaHRtbCA9IHsKICAgICAgbmFtZTogImRpdiIsCiAgICAgIGF0dHJpYnV0ZXMsCiAgICAgIGNoaWxkcmVuCiAgICB9OwogICAgY29uc3QgYmJveCA9IFt0aGlzLngsIHRoaXMueSwgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLndpZHRoLCB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uaGVpZ2h0XTsKICAgIGRlbGV0ZSB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV07CiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcyhodG1sLCBiYm94KTsKICB9Cgp9CgpjbGFzcyBBc3Npc3QgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiYXNzaXN0IiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMucm9sZSA9IGF0dHJpYnV0ZXMucm9sZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLnNwZWFrID0gbnVsbDsKICAgIHRoaXMudG9vbFRpcCA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oKSB7CiAgICByZXR1cm4gdGhpcy50b29sVGlwICYmIHRoaXMudG9vbFRpcFtfeGZhX29iamVjdC4kY29udGVudF0gPyB0aGlzLnRvb2xUaXBbX3hmYV9vYmplY3QuJGNvbnRlbnRdIDogbnVsbDsKICB9Cgp9CgpjbGFzcyBCYXJjb2RlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImJhcmNvZGUiLCB0cnVlKTsKICAgIHRoaXMuY2hhckVuY29kaW5nID0gKDAsIF91dGlscy5nZXRLZXl3b3JkKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuY2hhckVuY29kaW5nID8gYXR0cmlidXRlcy5jaGFyRW5jb2RpbmcudG9Mb3dlckNhc2UoKSA6ICIiLAogICAgICBkZWZhdWx0VmFsdWU6ICIiLAogICAgICB2YWxpZGF0ZTogayA9PiBbInV0Zi04IiwgImJpZy1maXZlIiwgImZvbnRzcGVjaWZpYyIsICJnYmsiLCAiZ2ItMTgwMzAiLCAiZ2ItMjMxMiIsICJrc2MtNTYwMSIsICJub25lIiwgInNoaWZ0LWppcyIsICJ1Y3MtMiIsICJ1dGYtMTYiXS5pbmNsdWRlcyhrKSB8fCBrLm1hdGNoKC9pc28tODg1OS1cZHsyfS8pCiAgICB9KTsKICAgIHRoaXMuY2hlY2tzdW0gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5jaGVja3N1bSwgWyJub25lIiwgIjFtb2QxMCIsICIxbW9kMTBfMW1vZDExIiwgIjJtb2QxMCIsICJhdXRvIl0pOwogICAgdGhpcy5kYXRhQ29sdW1uQ291bnQgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5kYXRhQ29sdW1uQ291bnQsCiAgICAgIGRlZmF1bHRWYWx1ZTogLTEsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPj0gMAogICAgfSk7CiAgICB0aGlzLmRhdGFMZW5ndGggPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5kYXRhTGVuZ3RoLAogICAgICBkZWZhdWx0VmFsdWU6IC0xLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAKICAgIH0pOwogICAgdGhpcy5kYXRhUHJlcCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmRhdGFQcmVwLCBbIm5vbmUiLCAiZmxhdGVDb21wcmVzcyJdKTsKICAgIHRoaXMuZGF0YVJvd0NvdW50ID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuZGF0YVJvd0NvdW50LAogICAgICBkZWZhdWx0VmFsdWU6IC0xLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAKICAgIH0pOwogICAgdGhpcy5lbmRDaGFyID0gYXR0cmlidXRlcy5lbmRDaGFyIHx8ICIiOwogICAgdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmVycm9yQ29ycmVjdGlvbkxldmVsLAogICAgICBkZWZhdWx0VmFsdWU6IC0xLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAgJiYgeCA8PSA4CiAgICB9KTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5tb2R1bGVIZWlnaHQgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1vZHVsZUhlaWdodCwgIjVtbSIpOwogICAgdGhpcy5tb2R1bGVXaWR0aCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubW9kdWxlV2lkdGgsICIwLjI1bW0iKTsKICAgIHRoaXMucHJpbnRDaGVja0RpZ2l0ID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMucHJpbnRDaGVja0RpZ2l0LAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy5yb3dDb2x1bW5SYXRpbyA9ICgwLCBfdXRpbHMuZ2V0UmF0aW8pKGF0dHJpYnV0ZXMucm93Q29sdW1uUmF0aW8pOwogICAgdGhpcy5zdGFydENoYXIgPSBhdHRyaWJ1dGVzLnN0YXJ0Q2hhciB8fCAiIjsKICAgIHRoaXMudGV4dExvY2F0aW9uID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudGV4dExvY2F0aW9uLCBbImJlbG93IiwgImFib3ZlIiwgImFib3ZlRW1iZWRkZWQiLCAiYmVsb3dFbWJlZGRlZCIsICJub25lIl0pOwogICAgdGhpcy50cnVuY2F0ZSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnRydW5jYXRlLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSA/IGF0dHJpYnV0ZXMudHlwZS50b0xvd2VyQ2FzZSgpIDogIiIsIFsiYXp0ZWMiLCAiY29kYWJhciIsICJjb2RlMm9mNWluZHVzdHJpYWwiLCAiY29kZTJvZjVpbnRlcmxlYXZlZCIsICJjb2RlMm9mNW1hdHJpeCIsICJjb2RlMm9mNXN0YW5kYXJkIiwgImNvZGUzb2Y5IiwgImNvZGUzb2Y5ZXh0ZW5kZWQiLCAiY29kZTExIiwgImNvZGU0OSIsICJjb2RlOTMiLCAiY29kZTEyOCIsICJjb2RlMTI4YSIsICJjb2RlMTI4YiIsICJjb2RlMTI4YyIsICJjb2RlMTI4c3NjYyIsICJkYXRhbWF0cml4IiwgImVhbjgiLCAiZWFuOGFkZDIiLCAiZWFuOGFkZDUiLCAiZWFuMTMiLCAiZWFuMTNhZGQyIiwgImVhbjEzYWRkNSIsICJlYW4xM3B3Y2QiLCAiZmltIiwgImxvZ21hcnMiLCAibWF4aWNvZGUiLCAibXNpIiwgInBkZjQxNyIsICJwZGY0MTdtYWNybyIsICJwbGVzc2V5IiwgInBvc3RhdXNjdXN0MiIsICJwb3N0YXVzY3VzdDMiLCAicG9zdGF1c3JlcGx5cGFpZCIsICJwb3N0YXVzc3RhbmRhcmQiLCAicG9zdHVrcm00c2NjIiwgInBvc3R1c2RwYmMiLCAicG9zdHVzaW1iIiwgInBvc3R1c3N0YW5kYXJkIiwgInBvc3R1czV6aXAiLCAicXJjb2RlIiwgInJmaWQiLCAicnNzMTQiLCAicnNzMTRleHBhbmRlZCIsICJyc3MxNGxpbWl0ZWQiLCAicnNzMTRzdGFja2VkIiwgInJzczE0c3RhY2tlZG9tbmkiLCAicnNzMTR0cnVuY2F0ZWQiLCAidGVsZXBlbiIsICJ1Y2MxMjgiLCAidWNjMTI4cmFuZG9tIiwgInVjYzEyOHNzY2MiLCAidXBjYSIsICJ1cGNhYWRkMiIsICJ1cGNhYWRkNSIsICJ1cGNhcHdjZCIsICJ1cGNlIiwgInVwY2VhZGQyIiwgInVwY2VhZGQ1IiwgInVwY2VhbjIiLCAidXBjZWFuNSIsICJ1cHNtYXhpY29kZSJdKTsKICAgIHRoaXMudXBzTW9kZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnVwc01vZGUsIFsidXNDYXJyaWVyIiwgImludGVybmF0aW9uYWxDYXJyaWVyIiwgInNlY3VyZVN5bWJvbCIsICJzdGFuZGFyZFN5bWJvbCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLndpZGVOYXJyb3dSYXRpbyA9ICgwLCBfdXRpbHMuZ2V0UmF0aW8pKGF0dHJpYnV0ZXMud2lkZU5hcnJvd1JhdGlvKTsKICAgIHRoaXMuZW5jcnlwdCA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgQmluZCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJiaW5kIiwgdHJ1ZSk7CiAgICB0aGlzLm1hdGNoID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMubWF0Y2gsIFsib25jZSIsICJkYXRhUmVmIiwgImdsb2JhbCIsICJub25lIl0pOwogICAgdGhpcy5yZWYgPSBhdHRyaWJ1dGVzLnJlZiB8fCAiIjsKICAgIHRoaXMucGljdHVyZSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgQmluZEl0ZW1zIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImJpbmRJdGVtcyIpOwogICAgdGhpcy5jb25uZWN0aW9uID0gYXR0cmlidXRlcy5jb25uZWN0aW9uIHx8ICIiOwogICAgdGhpcy5sYWJlbFJlZiA9IGF0dHJpYnV0ZXMubGFiZWxSZWYgfHwgIiI7CiAgICB0aGlzLnJlZiA9IGF0dHJpYnV0ZXMucmVmIHx8ICIiOwogICAgdGhpcy52YWx1ZVJlZiA9IGF0dHJpYnV0ZXMudmFsdWVSZWYgfHwgIiI7CiAgfQoKfQoKZXhwb3J0cy5CaW5kSXRlbXMgPSBCaW5kSXRlbXM7CgpjbGFzcyBCb29rZW5kIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImJvb2tlbmQiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5sZWFkZXIgPSBhdHRyaWJ1dGVzLmxlYWRlciB8fCAiIjsKICAgIHRoaXMudHJhaWxlciA9IGF0dHJpYnV0ZXMudHJhaWxlciB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgQm9vbGVhbkVsZW1lbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJib29sZWFuIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIHJldHVybiB2YWx1ZVRvSHRtbCh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9PT0gMSA/ICIxIiA6ICIwIik7CiAgfQoKfQoKY2xhc3MgQm9yZGVyIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImJvcmRlciIsIHRydWUpOwogICAgdGhpcy5icmVhayA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmJyZWFrLCBbImNsb3NlIiwgIm9wZW4iXSk7CiAgICB0aGlzLmhhbmQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5oYW5kLCBbImV2ZW4iLCAibGVmdCIsICJyaWdodCJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5wcmVzZW5jZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnByZXNlbmNlLCBbInZpc2libGUiLCAiaGlkZGVuIiwgImluYWN0aXZlIiwgImludmlzaWJsZSJdKTsKICAgIHRoaXMucmVsZXZhbnQgPSAoMCwgX3V0aWxzLmdldFJlbGV2YW50KShhdHRyaWJ1dGVzLnJlbGV2YW50KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmNvcm5lciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSg0KTsKICAgIHRoaXMuZWRnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSg0KTsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMuZmlsbCA9IG51bGw7CiAgICB0aGlzLm1hcmdpbiA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpIHsKICAgIGlmICghdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdKSB7CiAgICAgIGNvbnN0IGVkZ2VzID0gdGhpcy5lZGdlLmNoaWxkcmVuLnNsaWNlKCk7CgogICAgICBpZiAoZWRnZXMubGVuZ3RoIDwgNCkgewogICAgICAgIGNvbnN0IGRlZmF1bHRFZGdlID0gZWRnZXMuYXQoLTEpIHx8IG5ldyBFZGdlKHt9KTsKCiAgICAgICAgZm9yIChsZXQgaSA9IGVkZ2VzLmxlbmd0aDsgaSA8IDQ7IGkrKykgewogICAgICAgICAgZWRnZXMucHVzaChkZWZhdWx0RWRnZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zdCB3aWR0aHMgPSBlZGdlcy5tYXAoZWRnZSA9PiBlZGdlLnRoaWNrbmVzcyk7CiAgICAgIGNvbnN0IGluc2V0cyA9IFswLCAwLCAwLCAwXTsKCiAgICAgIGlmICh0aGlzLm1hcmdpbikgewogICAgICAgIGluc2V0c1swXSA9IHRoaXMubWFyZ2luLnRvcEluc2V0OwogICAgICAgIGluc2V0c1sxXSA9IHRoaXMubWFyZ2luLnJpZ2h0SW5zZXQ7CiAgICAgICAgaW5zZXRzWzJdID0gdGhpcy5tYXJnaW4uYm90dG9tSW5zZXQ7CiAgICAgICAgaW5zZXRzWzNdID0gdGhpcy5tYXJnaW4ubGVmdEluc2V0OwogICAgICB9CgogICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSB7CiAgICAgICAgd2lkdGhzLAogICAgICAgIGluc2V0cywKICAgICAgICBlZGdlcwogICAgICB9OwogICAgfQoKICAgIHJldHVybiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV07CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgewogICAgY29uc3QgewogICAgICBlZGdlcwogICAgfSA9IHRoaXNbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpOwoKICAgIGNvbnN0IGVkZ2VTdHlsZXMgPSBlZGdlcy5tYXAobm9kZSA9PiB7CiAgICAgIGNvbnN0IHN0eWxlID0gbm9kZVtfeGZhX29iamVjdC4kdG9TdHlsZV0oKTsKCiAgICAgIHN0eWxlLmNvbG9yID0gc3R5bGUuY29sb3IgfHwgIiMwMDAwMDAiOwogICAgICByZXR1cm4gc3R5bGU7CiAgICB9KTsKICAgIGNvbnN0IHN0eWxlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICBpZiAodGhpcy5tYXJnaW4pIHsKICAgICAgT2JqZWN0LmFzc2lnbihzdHlsZSwgdGhpcy5tYXJnaW5bX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkpOwogICAgfQoKICAgIGlmICh0aGlzLmZpbGwgJiYgdGhpcy5maWxsLnByZXNlbmNlID09PSAidmlzaWJsZSIpIHsKICAgICAgT2JqZWN0LmFzc2lnbihzdHlsZSwgdGhpcy5maWxsW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpKTsKICAgIH0KCiAgICBpZiAodGhpcy5jb3JuZXIuY2hpbGRyZW4uc29tZShub2RlID0+IG5vZGUucmFkaXVzICE9PSAwKSkgewogICAgICBjb25zdCBjb3JuZXJTdHlsZXMgPSB0aGlzLmNvcm5lci5jaGlsZHJlbi5tYXAobm9kZSA9PiBub2RlW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpKTsKCiAgICAgIGlmIChjb3JuZXJTdHlsZXMubGVuZ3RoID09PSAyIHx8IGNvcm5lclN0eWxlcy5sZW5ndGggPT09IDMpIHsKICAgICAgICBjb25zdCBsYXN0ID0gY29ybmVyU3R5bGVzLmF0KC0xKTsKCiAgICAgICAgZm9yIChsZXQgaSA9IGNvcm5lclN0eWxlcy5sZW5ndGg7IGkgPCA0OyBpKyspIHsKICAgICAgICAgIGNvcm5lclN0eWxlcy5wdXNoKGxhc3QpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgc3R5bGUuYm9yZGVyUmFkaXVzID0gY29ybmVyU3R5bGVzLm1hcChzID0+IHMucmFkaXVzKS5qb2luKCIgIik7CiAgICB9CgogICAgc3dpdGNoICh0aGlzLnByZXNlbmNlKSB7CiAgICAgIGNhc2UgImludmlzaWJsZSI6CiAgICAgIGNhc2UgImhpZGRlbiI6CiAgICAgICAgc3R5bGUuYm9yZGVyU3R5bGUgPSAiIjsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImluYWN0aXZlIjoKICAgICAgICBzdHlsZS5ib3JkZXJTdHlsZSA9ICJub25lIjsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgc3R5bGUuYm9yZGVyU3R5bGUgPSBlZGdlU3R5bGVzLm1hcChzID0+IHMuc3R5bGUpLmpvaW4oIiAiKTsKICAgICAgICBicmVhazsKICAgIH0KCiAgICBzdHlsZS5ib3JkZXJXaWR0aCA9IGVkZ2VTdHlsZXMubWFwKHMgPT4gcy53aWR0aCkuam9pbigiICIpOwogICAgc3R5bGUuYm9yZGVyQ29sb3IgPSBlZGdlU3R5bGVzLm1hcChzID0+IHMuY29sb3IpLmpvaW4oIiAiKTsKICAgIHJldHVybiBzdHlsZTsKICB9Cgp9CgpjbGFzcyBCcmVhayBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJicmVhayIsIHRydWUpOwogICAgdGhpcy5hZnRlciA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmFmdGVyLCBbImF1dG8iLCAiY29udGVudEFyZWEiLCAicGFnZUFyZWEiLCAicGFnZUV2ZW4iLCAicGFnZU9kZCJdKTsKICAgIHRoaXMuYWZ0ZXJUYXJnZXQgPSBhdHRyaWJ1dGVzLmFmdGVyVGFyZ2V0IHx8ICIiOwogICAgdGhpcy5iZWZvcmUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5iZWZvcmUsIFsiYXV0byIsICJjb250ZW50QXJlYSIsICJwYWdlQXJlYSIsICJwYWdlRXZlbiIsICJwYWdlT2RkIl0pOwogICAgdGhpcy5iZWZvcmVUYXJnZXQgPSBhdHRyaWJ1dGVzLmJlZm9yZVRhcmdldCB8fCAiIjsKICAgIHRoaXMuYm9va2VuZExlYWRlciA9IGF0dHJpYnV0ZXMuYm9va2VuZExlYWRlciB8fCAiIjsKICAgIHRoaXMuYm9va2VuZFRyYWlsZXIgPSBhdHRyaWJ1dGVzLmJvb2tlbmRUcmFpbGVyIHx8ICIiOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm92ZXJmbG93TGVhZGVyID0gYXR0cmlidXRlcy5vdmVyZmxvd0xlYWRlciB8fCAiIjsKICAgIHRoaXMub3ZlcmZsb3dUYXJnZXQgPSBhdHRyaWJ1dGVzLm92ZXJmbG93VGFyZ2V0IHx8ICIiOwogICAgdGhpcy5vdmVyZmxvd1RyYWlsZXIgPSBhdHRyaWJ1dGVzLm92ZXJmbG93VHJhaWxlciB8fCAiIjsKICAgIHRoaXMuc3RhcnROZXcgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5zdGFydE5ldywKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgQnJlYWtBZnRlciBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJicmVha0FmdGVyIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubGVhZGVyID0gYXR0cmlidXRlcy5sZWFkZXIgfHwgIiI7CiAgICB0aGlzLnN0YXJ0TmV3ID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuc3RhcnROZXcsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMQogICAgfSk7CiAgICB0aGlzLnRhcmdldCA9IGF0dHJpYnV0ZXMudGFyZ2V0IHx8ICIiOwogICAgdGhpcy50YXJnZXRUeXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudGFyZ2V0VHlwZSwgWyJhdXRvIiwgImNvbnRlbnRBcmVhIiwgInBhZ2VBcmVhIl0pOwogICAgdGhpcy50cmFpbGVyID0gYXR0cmlidXRlcy50cmFpbGVyIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuc2NyaXB0ID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBCcmVha0JlZm9yZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJicmVha0JlZm9yZSIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmxlYWRlciA9IGF0dHJpYnV0ZXMubGVhZGVyIHx8ICIiOwogICAgdGhpcy5zdGFydE5ldyA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnN0YXJ0TmV3LAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy50YXJnZXQgPSBhdHRyaWJ1dGVzLnRhcmdldCB8fCAiIjsKICAgIHRoaXMudGFyZ2V0VHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnRhcmdldFR5cGUsIFsiYXV0byIsICJjb250ZW50QXJlYSIsICJwYWdlQXJlYSJdKTsKICAgIHRoaXMudHJhaWxlciA9IGF0dHJpYnV0ZXMudHJhaWxlciB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLnNjcmlwdCA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9IHt9OwogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkZBSUxVUkU7CiAgfQoKfQoKY2xhc3MgQnV0dG9uIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImJ1dHRvbiIsIHRydWUpOwogICAgdGhpcy5oaWdobGlnaHQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5oaWdobGlnaHQsIFsiaW52ZXJ0ZWQiLCAibm9uZSIsICJvdXRsaW5lIiwgInB1c2giXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGNvbnN0IHBhcmVudCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBjb25zdCBncmFuZHBhID0gcGFyZW50W194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgY29uc3QgaHRtbEJ1dHRvbiA9IHsKICAgICAgbmFtZTogImJ1dHRvbiIsCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBpZDogdGhpc1tfeGZhX29iamVjdC4kdWlkXSwKICAgICAgICBjbGFzczogWyJ4ZmFCdXR0b24iXSwKICAgICAgICBzdHlsZToge30KICAgICAgfSwKICAgICAgY2hpbGRyZW46IFtdCiAgICB9OwoKICAgIGZvciAoY29uc3QgZXZlbnQgb2YgZ3JhbmRwYS5ldmVudC5jaGlsZHJlbikgewogICAgICBpZiAoZXZlbnQuYWN0aXZpdHkgIT09ICJjbGljayIgfHwgIWV2ZW50LnNjcmlwdCkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBqc1VSTCA9ICgwLCBfY29yZV91dGlscy5yZWNvdmVySnNVUkwpKGV2ZW50LnNjcmlwdFtfeGZhX29iamVjdC4kY29udGVudF0pOwoKICAgICAgaWYgKCFqc1VSTCkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBocmVmID0gKDAsIF9odG1sX3V0aWxzLmZpeFVSTCkoanNVUkwudXJsKTsKCiAgICAgIGlmICghaHJlZikgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBodG1sQnV0dG9uLmNoaWxkcmVuLnB1c2goewogICAgICAgIG5hbWU6ICJhIiwKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBpZDogImxpbmsiICsgdGhpc1tfeGZhX29iamVjdC4kdWlkXSwKICAgICAgICAgIGhyZWYsCiAgICAgICAgICBuZXdXaW5kb3c6IGpzVVJMLm5ld1dpbmRvdywKICAgICAgICAgIGNsYXNzOiBbInhmYUxpbmsiXSwKICAgICAgICAgIHN0eWxlOiB7fQogICAgICAgIH0sCiAgICAgICAgY2hpbGRyZW46IFtdCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKGh0bWxCdXR0b24pOwogIH0KCn0KCmNsYXNzIENhbGN1bGF0ZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJjYWxjdWxhdGUiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5vdmVycmlkZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm92ZXJyaWRlLCBbImRpc2FibGVkIiwgImVycm9yIiwgImlnbm9yZSIsICJ3YXJuaW5nIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMubWVzc2FnZSA9IG51bGw7CiAgICB0aGlzLnNjcmlwdCA9IG51bGw7CiAgfQoKfQoKY2xhc3MgQ2FwdGlvbiBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJjYXB0aW9uIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMucGxhY2VtZW50ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucGxhY2VtZW50LCBbImxlZnQiLCAiYm90dG9tIiwgImlubGluZSIsICJyaWdodCIsICJ0b3AiXSk7CiAgICB0aGlzLnByZXNlbmNlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucHJlc2VuY2UsIFsidmlzaWJsZSIsICJoaWRkZW4iLCAiaW5hY3RpdmUiLCAiaW52aXNpYmxlIl0pOwogICAgdGhpcy5yZXNlcnZlID0gTWF0aC5jZWlsKCgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMucmVzZXJ2ZSkpOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMuZm9udCA9IG51bGw7CiAgICB0aGlzLm1hcmdpbiA9IG51bGw7CiAgICB0aGlzLnBhcmEgPSBudWxsOwogICAgdGhpcy52YWx1ZSA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHNldFZhbHVlXSh2YWx1ZSkgewogICAgX3NldFZhbHVlKHRoaXMsIHZhbHVlKTsKICB9CgogIFtfeGZhX29iamVjdC4kZ2V0RXh0cmFdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBpZiAoIXRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSkgewogICAgICBsZXQgewogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodAogICAgICB9ID0gYXZhaWxhYmxlU3BhY2U7CgogICAgICBzd2l0Y2ggKHRoaXMucGxhY2VtZW50KSB7CiAgICAgICAgY2FzZSAibGVmdCI6CiAgICAgICAgY2FzZSAicmlnaHQiOgogICAgICAgIGNhc2UgImlubGluZSI6CiAgICAgICAgICB3aWR0aCA9IHRoaXMucmVzZXJ2ZSA8PSAwID8gd2lkdGggOiB0aGlzLnJlc2VydmU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAidG9wIjoKICAgICAgICBjYXNlICJib3R0b20iOgogICAgICAgICAgaGVpZ2h0ID0gdGhpcy5yZXNlcnZlIDw9IDAgPyBoZWlnaHQgOiB0aGlzLnJlc2VydmU7CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gKDAsIF9odG1sX3V0aWxzLmxheW91dE5vZGUpKHRoaXMsIHsKICAgICAgICB3aWR0aCwKICAgICAgICBoZWlnaHQKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgaWYgKCF0aGlzLnZhbHVlKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICAgIH0KCiAgICB0aGlzW194ZmFfb2JqZWN0LiRwdXNoUGFyYV0oKTsKCiAgICBjb25zdCB2YWx1ZSA9IHRoaXMudmFsdWVbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpLmh0bWw7CgogICAgaWYgKCF2YWx1ZSkgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRwb3BQYXJhXSgpOwoKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgfQoKICAgIGNvbnN0IHNhdmVkUmVzZXJ2ZSA9IHRoaXMucmVzZXJ2ZTsKCiAgICBpZiAodGhpcy5yZXNlcnZlIDw9IDApIHsKICAgICAgY29uc3QgewogICAgICAgIHcsCiAgICAgICAgaAogICAgICB9ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0RXh0cmFdKGF2YWlsYWJsZVNwYWNlKTsKCiAgICAgIHN3aXRjaCAodGhpcy5wbGFjZW1lbnQpIHsKICAgICAgICBjYXNlICJsZWZ0IjoKICAgICAgICBjYXNlICJyaWdodCI6CiAgICAgICAgY2FzZSAiaW5saW5lIjoKICAgICAgICAgIHRoaXMucmVzZXJ2ZSA9IHc7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAidG9wIjoKICAgICAgICBjYXNlICJib3R0b20iOgogICAgICAgICAgdGhpcy5yZXNlcnZlID0gaDsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgY29uc3QgY2hpbGRyZW4gPSBbXTsKCiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgewogICAgICBjaGlsZHJlbi5wdXNoKHsKICAgICAgICBuYW1lOiAiI3RleHQiLAogICAgICAgIHZhbHVlCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgY2hpbGRyZW4ucHVzaCh2YWx1ZSk7CiAgICB9CgogICAgY29uc3Qgc3R5bGUgPSAoMCwgX2h0bWxfdXRpbHMudG9TdHlsZSkodGhpcywgImZvbnQiLCAibWFyZ2luIiwgInZpc2liaWxpdHkiKTsKCiAgICBzd2l0Y2ggKHRoaXMucGxhY2VtZW50KSB7CiAgICAgIGNhc2UgImxlZnQiOgogICAgICBjYXNlICJyaWdodCI6CiAgICAgICAgaWYgKHRoaXMucmVzZXJ2ZSA+IDApIHsKICAgICAgICAgIHN0eWxlLndpZHRoID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5yZXNlcnZlKTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAidG9wIjoKICAgICAgY2FzZSAiYm90dG9tIjoKICAgICAgICBpZiAodGhpcy5yZXNlcnZlID4gMCkgewogICAgICAgICAgc3R5bGUuaGVpZ2h0ID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5yZXNlcnZlKTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwogICAgfQoKICAgICgwLCBfaHRtbF91dGlscy5zZXRQYXJhKSh0aGlzLCBudWxsLCB2YWx1ZSk7CgogICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICB0aGlzLnJlc2VydmUgPSBzYXZlZFJlc2VydmU7CiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgIG5hbWU6ICJkaXYiLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgc3R5bGUsCiAgICAgICAgY2xhc3M6IFsieGZhQ2FwdGlvbiJdCiAgICAgIH0sCiAgICAgIGNoaWxkcmVuCiAgICB9KTsKICB9Cgp9CgpjbGFzcyBDZXJ0aWZpY2F0ZSBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJjZXJ0aWZpY2F0ZSIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIENlcnRpZmljYXRlcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJjZXJ0aWZpY2F0ZXMiLCB0cnVlKTsKICAgIHRoaXMuY3JlZGVudGlhbFNlcnZlclBvbGljeSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmNyZWRlbnRpYWxTZXJ2ZXJQb2xpY3ksIFsib3B0aW9uYWwiLCAicmVxdWlyZWQiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXJsID0gYXR0cmlidXRlcy51cmwgfHwgIiI7CiAgICB0aGlzLnVybFBvbGljeSA9IGF0dHJpYnV0ZXMudXJsUG9saWN5IHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZW5jcnlwdGlvbiA9IG51bGw7CiAgICB0aGlzLmlzc3VlcnMgPSBudWxsOwogICAgdGhpcy5rZXlVc2FnZSA9IG51bGw7CiAgICB0aGlzLm9pZHMgPSBudWxsOwogICAgdGhpcy5zaWduaW5nID0gbnVsbDsKICAgIHRoaXMuc3ViamVjdEROcyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgQ2hlY2tCdXR0b24gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiY2hlY2tCdXR0b24iLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5tYXJrID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMubWFyaywgWyJkZWZhdWx0IiwgImNoZWNrIiwgImNpcmNsZSIsICJjcm9zcyIsICJkaWFtb25kIiwgInNxdWFyZSIsICJzdGFyIl0pOwogICAgdGhpcy5zaGFwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnNoYXBlLCBbInNxdWFyZSIsICJyb3VuZCJdKTsKICAgIHRoaXMuc2l6ZSA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMuc2l6ZSwgIjEwcHQiKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmJvcmRlciA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLm1hcmdpbiA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKCJtYXJnaW4iKTsKICAgIGNvbnN0IHNpemUgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLnNpemUpOwogICAgc3R5bGUud2lkdGggPSBzdHlsZS5oZWlnaHQgPSBzaXplOwogICAgbGV0IHR5cGU7CiAgICBsZXQgY2xhc3NOYW1lOwogICAgbGV0IGdyb3VwSWQ7CgogICAgY29uc3QgZmllbGQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKClbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBjb25zdCBpdGVtcyA9IGZpZWxkLml0ZW1zLmNoaWxkcmVuLmxlbmd0aCAmJiBmaWVsZC5pdGVtcy5jaGlsZHJlblswXVtfeGZhX29iamVjdC4kdG9IVE1MXSgpLmh0bWwgfHwgW107CiAgICBjb25zdCBleHBvcnRlZFZhbHVlID0gewogICAgICBvbjogKGl0ZW1zWzBdICE9PSB1bmRlZmluZWQgPyBpdGVtc1swXSA6ICJvbiIpLnRvU3RyaW5nKCksCiAgICAgIG9mZjogKGl0ZW1zWzFdICE9PSB1bmRlZmluZWQgPyBpdGVtc1sxXSA6ICJvZmYiKS50b1N0cmluZygpCiAgICB9OwogICAgY29uc3QgdmFsdWUgPSBmaWVsZC52YWx1ZSAmJiBmaWVsZC52YWx1ZVtfeGZhX29iamVjdC4kdGV4dF0oKSB8fCAib2ZmIjsKICAgIGNvbnN0IGNoZWNrZWQgPSB2YWx1ZSA9PT0gZXhwb3J0ZWRWYWx1ZS5vbiB8fCB1bmRlZmluZWQ7CgogICAgY29uc3QgY29udGFpbmVyID0gZmllbGRbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCk7CgogICAgY29uc3QgZmllbGRJZCA9IGZpZWxkW194ZmFfb2JqZWN0LiR1aWRdOwogICAgbGV0IGRhdGFJZDsKCiAgICBpZiAoY29udGFpbmVyIGluc3RhbmNlb2YgRXhjbEdyb3VwKSB7CiAgICAgIGdyb3VwSWQgPSBjb250YWluZXJbX3hmYV9vYmplY3QuJHVpZF07CiAgICAgIHR5cGUgPSAicmFkaW8iOwogICAgICBjbGFzc05hbWUgPSAieGZhUmFkaW8iOwogICAgICBkYXRhSWQgPSBjb250YWluZXJbX3hmYV9vYmplY3QuJGRhdGFdICYmIGNvbnRhaW5lcltfeGZhX29iamVjdC4kZGF0YV1bX3hmYV9vYmplY3QuJHVpZF0gfHwgY29udGFpbmVyW194ZmFfb2JqZWN0LiR1aWRdOwogICAgfSBlbHNlIHsKICAgICAgdHlwZSA9ICJjaGVja2JveCI7CiAgICAgIGNsYXNzTmFtZSA9ICJ4ZmFDaGVja2JveCI7CiAgICAgIGRhdGFJZCA9IGZpZWxkW194ZmFfb2JqZWN0LiRkYXRhXSAmJiBmaWVsZFtfeGZhX29iamVjdC4kZGF0YV1bX3hmYV9vYmplY3QuJHVpZF0gfHwgZmllbGRbX3hmYV9vYmplY3QuJHVpZF07CiAgICB9CgogICAgY29uc3QgaW5wdXQgPSB7CiAgICAgIG5hbWU6ICJpbnB1dCIsCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBjbGFzczogW2NsYXNzTmFtZV0sCiAgICAgICAgc3R5bGUsCiAgICAgICAgZmllbGRJZCwKICAgICAgICBkYXRhSWQsCiAgICAgICAgdHlwZSwKICAgICAgICBjaGVja2VkLAogICAgICAgIHhmYU9uOiBleHBvcnRlZFZhbHVlLm9uLAogICAgICAgIHhmYU9mZjogZXhwb3J0ZWRWYWx1ZS5vZmYsCiAgICAgICAgImFyaWEtbGFiZWwiOiBhcmlhTGFiZWwoZmllbGQpLAogICAgICAgICJhcmlhLXJlcXVpcmVkIjogZmFsc2UKICAgICAgfQogICAgfTsKCiAgICBpZiAoZ3JvdXBJZCkgewogICAgICBpbnB1dC5hdHRyaWJ1dGVzLm5hbWUgPSBncm91cElkOwogICAgfQoKICAgIGlmIChpc1JlcXVpcmVkKGZpZWxkKSkgewogICAgICBpbnB1dC5hdHRyaWJ1dGVzWyJhcmlhLXJlcXVpcmVkIl0gPSB0cnVlOwogICAgICBpbnB1dC5hdHRyaWJ1dGVzLnJlcXVpcmVkID0gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgIG5hbWU6ICJsYWJlbCIsCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBjbGFzczogWyJ4ZmFMYWJlbCJdCiAgICAgIH0sCiAgICAgIGNoaWxkcmVuOiBbaW5wdXRdCiAgICB9KTsKICB9Cgp9CgpjbGFzcyBDaG9pY2VMaXN0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImNob2ljZUxpc3QiLCB0cnVlKTsKICAgIHRoaXMuY29tbWl0T24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5jb21taXRPbiwgWyJzZWxlY3QiLCAiZXhpdCJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5vcGVuID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMub3BlbiwgWyJ1c2VyQ29udHJvbCIsICJhbHdheXMiLCAibXVsdGlTZWxlY3QiLCAib25FbnRyeSJdKTsKICAgIHRoaXMudGV4dEVudHJ5ID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMudGV4dEVudHJ5LAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYm9yZGVyID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMubWFyZ2luID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgY29uc3Qgc3R5bGUgPSAoMCwgX2h0bWxfdXRpbHMudG9TdHlsZSkodGhpcywgImJvcmRlciIsICJtYXJnaW4iKTsKCiAgICBjb25zdCB1aSA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBjb25zdCBmaWVsZCA9IHVpW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgY29uc3QgZm9udFNpemUgPSBmaWVsZC5mb250ICYmIGZpZWxkLmZvbnQuc2l6ZSB8fCAxMDsKICAgIGNvbnN0IG9wdGlvblN0eWxlID0gewogICAgICBmb250U2l6ZTogYGNhbGMoJHtmb250U2l6ZX1weCAqIHZhcigtLXNjYWxlLWZhY3RvcikpYAogICAgfTsKICAgIGNvbnN0IGNoaWxkcmVuID0gW107CgogICAgaWYgKGZpZWxkLml0ZW1zLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgY29uc3QgaXRlbXMgPSBmaWVsZC5pdGVtczsKICAgICAgbGV0IGRpc3BsYXllZEluZGV4ID0gMDsKICAgICAgbGV0IHNhdmVJbmRleCA9IDA7CgogICAgICBpZiAoaXRlbXMuY2hpbGRyZW4ubGVuZ3RoID09PSAyKSB7CiAgICAgICAgZGlzcGxheWVkSW5kZXggPSBpdGVtcy5jaGlsZHJlblswXS5zYXZlOwogICAgICAgIHNhdmVJbmRleCA9IDEgLSBkaXNwbGF5ZWRJbmRleDsKICAgICAgfQoKICAgICAgY29uc3QgZGlzcGxheWVkID0gaXRlbXMuY2hpbGRyZW5bZGlzcGxheWVkSW5kZXhdW194ZmFfb2JqZWN0LiR0b0hUTUxdKCkuaHRtbDsKCiAgICAgIGNvbnN0IHZhbHVlcyA9IGl0ZW1zLmNoaWxkcmVuW3NhdmVJbmRleF1bX3hmYV9vYmplY3QuJHRvSFRNTF0oKS5odG1sOwoKICAgICAgbGV0IHNlbGVjdGVkID0gZmFsc2U7CiAgICAgIGNvbnN0IHZhbHVlID0gZmllbGQudmFsdWUgJiYgZmllbGQudmFsdWVbX3hmYV9vYmplY3QuJHRleHRdKCkgfHwgIiI7CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBkaXNwbGF5ZWQubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbnN0IG9wdGlvbiA9IHsKICAgICAgICAgIG5hbWU6ICJvcHRpb24iLAogICAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgICB2YWx1ZTogdmFsdWVzW2ldIHx8IGRpc3BsYXllZFtpXSwKICAgICAgICAgICAgc3R5bGU6IG9wdGlvblN0eWxlCiAgICAgICAgICB9LAogICAgICAgICAgdmFsdWU6IGRpc3BsYXllZFtpXQogICAgICAgIH07CgogICAgICAgIGlmICh2YWx1ZXNbaV0gPT09IHZhbHVlKSB7CiAgICAgICAgICBvcHRpb24uYXR0cmlidXRlcy5zZWxlY3RlZCA9IHNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGNoaWxkcmVuLnB1c2gob3B0aW9uKTsKICAgICAgfQoKICAgICAgaWYgKCFzZWxlY3RlZCkgewogICAgICAgIGNoaWxkcmVuLnNwbGljZSgwLCAwLCB7CiAgICAgICAgICBuYW1lOiAib3B0aW9uIiwKICAgICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgICAgaGlkZGVuOiB0cnVlLAogICAgICAgICAgICBzZWxlY3RlZDogdHJ1ZQogICAgICAgICAgfSwKICAgICAgICAgIHZhbHVlOiAiICIKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IHNlbGVjdEF0dHJpYnV0ZXMgPSB7CiAgICAgIGNsYXNzOiBbInhmYVNlbGVjdCJdLAogICAgICBmaWVsZElkOiBmaWVsZFtfeGZhX29iamVjdC4kdWlkXSwKICAgICAgZGF0YUlkOiBmaWVsZFtfeGZhX29iamVjdC4kZGF0YV0gJiYgZmllbGRbX3hmYV9vYmplY3QuJGRhdGFdW194ZmFfb2JqZWN0LiR1aWRdIHx8IGZpZWxkW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICBzdHlsZSwKICAgICAgImFyaWEtbGFiZWwiOiBhcmlhTGFiZWwoZmllbGQpLAogICAgICAiYXJpYS1yZXF1aXJlZCI6IGZhbHNlCiAgICB9OwoKICAgIGlmIChpc1JlcXVpcmVkKGZpZWxkKSkgewogICAgICBzZWxlY3RBdHRyaWJ1dGVzWyJhcmlhLXJlcXVpcmVkIl0gPSB0cnVlOwogICAgICBzZWxlY3RBdHRyaWJ1dGVzLnJlcXVpcmVkID0gdHJ1ZTsKICAgIH0KCiAgICBpZiAodGhpcy5vcGVuID09PSAibXVsdGlTZWxlY3QiKSB7CiAgICAgIHNlbGVjdEF0dHJpYnV0ZXMubXVsdGlwbGUgPSB0cnVlOwogICAgfQoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgbmFtZTogImxhYmVsIiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIGNsYXNzOiBbInhmYUxhYmVsIl0KICAgICAgfSwKICAgICAgY2hpbGRyZW46IFt7CiAgICAgICAgbmFtZTogInNlbGVjdCIsCiAgICAgICAgY2hpbGRyZW4sCiAgICAgICAgYXR0cmlidXRlczogc2VsZWN0QXR0cmlidXRlcwogICAgICB9XQogICAgfSk7CiAgfQoKfQoKY2xhc3MgQ29sb3IgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiY29sb3IiLCB0cnVlKTsKICAgIHRoaXMuY1NwYWNlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuY1NwYWNlLCBbIlNSR0IiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLnZhbHVlID0gYXR0cmlidXRlcy52YWx1ZSA/ICgwLCBfdXRpbHMuZ2V0Q29sb3IpKGF0dHJpYnV0ZXMudmFsdWUpIDogIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJGhhc1NldHRhYmxlVmFsdWVdKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIHsKICAgIHJldHVybiB0aGlzLnZhbHVlID8gX3V0aWwuVXRpbC5tYWtlSGV4Q29sb3IodGhpcy52YWx1ZS5yLCB0aGlzLnZhbHVlLmcsIHRoaXMudmFsdWUuYikgOiBudWxsOwogIH0KCn0KCmNsYXNzIENvbWIgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiY29tYiIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm51bWJlck9mQ2VsbHMgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5udW1iZXJPZkNlbGxzLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPj0gMAogICAgfSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIENvbm5lY3QgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiY29ubmVjdCIsIHRydWUpOwogICAgdGhpcy5jb25uZWN0aW9uID0gYXR0cmlidXRlcy5jb25uZWN0aW9uIHx8ICIiOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnJlZiA9IGF0dHJpYnV0ZXMucmVmIHx8ICIiOwogICAgdGhpcy51c2FnZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnVzYWdlLCBbImV4cG9ydEFuZEltcG9ydCIsICJleHBvcnRPbmx5IiwgImltcG9ydE9ubHkiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5waWN0dXJlID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBDb250ZW50QXJlYSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJjb250ZW50QXJlYSIsIHRydWUpOwogICAgdGhpcy5oID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5oKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5yZWxldmFudCA9ICgwLCBfdXRpbHMuZ2V0UmVsZXZhbnQpKGF0dHJpYnV0ZXMucmVsZXZhbnQpOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMudyA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMudyk7CiAgICB0aGlzLnggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLngsICIwcHQiKTsKICAgIHRoaXMueSA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMueSwgIjBwdCIpOwogICAgdGhpcy5kZXNjID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgY29uc3QgbGVmdCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMueCk7CiAgICBjb25zdCB0b3AgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLnkpOwogICAgY29uc3Qgc3R5bGUgPSB7CiAgICAgIGxlZnQsCiAgICAgIHRvcCwKICAgICAgd2lkdGg6ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMudyksCiAgICAgIGhlaWdodDogKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5oKQogICAgfTsKICAgIGNvbnN0IGNsYXNzTmFtZXMgPSBbInhmYUNvbnRlbnRhcmVhIl07CgogICAgaWYgKCgwLCBfaHRtbF91dGlscy5pc1ByaW50T25seSkodGhpcykpIHsKICAgICAgY2xhc3NOYW1lcy5wdXNoKCJ4ZmFQcmludE9ubHkiKTsKICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgIG5hbWU6ICJkaXYiLAogICAgICBjaGlsZHJlbjogW10sCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBzdHlsZSwKICAgICAgICBjbGFzczogY2xhc3NOYW1lcywKICAgICAgICBpZDogdGhpc1tfeGZhX29iamVjdC4kdWlkXQogICAgICB9CiAgICB9KTsKICB9Cgp9CgpjbGFzcyBDb3JuZXIgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiY29ybmVyIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMuaW52ZXJ0ZWQgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5pbnZlcnRlZCwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMuam9pbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmpvaW4sIFsic3F1YXJlIiwgInJvdW5kIl0pOwogICAgdGhpcy5wcmVzZW5jZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnByZXNlbmNlLCBbInZpc2libGUiLCAiaGlkZGVuIiwgImluYWN0aXZlIiwgImludmlzaWJsZSJdKTsKICAgIHRoaXMucmFkaXVzID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5yYWRpdXMpOwogICAgdGhpcy5zdHJva2UgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5zdHJva2UsIFsic29saWQiLCAiZGFzaERvdCIsICJkYXNoRG90RG90IiwgImRhc2hlZCIsICJkb3R0ZWQiLCAiZW1ib3NzZWQiLCAiZXRjaGVkIiwgImxvd2VyZWQiLCAicmFpc2VkIl0pOwogICAgdGhpcy50aGlja25lc3MgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnRoaWNrbmVzcywgIjAuNXB0Iik7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5jb2xvciA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgewogICAgY29uc3Qgc3R5bGUgPSAoMCwgX2h0bWxfdXRpbHMudG9TdHlsZSkodGhpcywgInZpc2liaWxpdHkiKTsKICAgIHN0eWxlLnJhZGl1cyA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMuam9pbiA9PT0gInNxdWFyZSIgPyAwIDogdGhpcy5yYWRpdXMpOwogICAgcmV0dXJuIHN0eWxlOwogIH0KCn0KCmNsYXNzIERhdGVFbGVtZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJkYXRlIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIGNvbnN0IGRhdGUgPSB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50cmltKCk7CgogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSBkYXRlID8gbmV3IERhdGUoZGF0ZSkgOiBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICByZXR1cm4gdmFsdWVUb0h0bWwodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPyB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50b1N0cmluZygpIDogIiIpOwogIH0KCn0KCmNsYXNzIERhdGVUaW1lIGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJkYXRlVGltZSIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICBjb25zdCBkYXRlID0gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpOwoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gZGF0ZSA/IG5ldyBEYXRlKGRhdGUpIDogbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgcmV0dXJuIHZhbHVlVG9IdG1sKHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID8gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udG9TdHJpbmcoKSA6ICIiKTsKICB9Cgp9CgpjbGFzcyBEYXRlVGltZUVkaXQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZGF0ZVRpbWVFZGl0IiwgdHJ1ZSk7CiAgICB0aGlzLmhTY3JvbGxQb2xpY3kgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5oU2Nyb2xsUG9saWN5LCBbImF1dG8iLCAib2ZmIiwgIm9uIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnBpY2tlciA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnBpY2tlciwgWyJob3N0IiwgIm5vbmUiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5ib3JkZXIgPSBudWxsOwogICAgdGhpcy5jb21iID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMubWFyZ2luID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgY29uc3Qgc3R5bGUgPSAoMCwgX2h0bWxfdXRpbHMudG9TdHlsZSkodGhpcywgImJvcmRlciIsICJmb250IiwgIm1hcmdpbiIpOwoKICAgIGNvbnN0IGZpZWxkID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgY29uc3QgaHRtbCA9IHsKICAgICAgbmFtZTogImlucHV0IiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICBmaWVsZElkOiBmaWVsZFtfeGZhX29iamVjdC4kdWlkXSwKICAgICAgICBkYXRhSWQ6IGZpZWxkW194ZmFfb2JqZWN0LiRkYXRhXSAmJiBmaWVsZFtfeGZhX29iamVjdC4kZGF0YV1bX3hmYV9vYmplY3QuJHVpZF0gfHwgZmllbGRbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgICAgY2xhc3M6IFsieGZhVGV4dGZpZWxkIl0sCiAgICAgICAgc3R5bGUsCiAgICAgICAgImFyaWEtbGFiZWwiOiBhcmlhTGFiZWwoZmllbGQpLAogICAgICAgICJhcmlhLXJlcXVpcmVkIjogZmFsc2UKICAgICAgfQogICAgfTsKCiAgICBpZiAoaXNSZXF1aXJlZChmaWVsZCkpIHsKICAgICAgaHRtbC5hdHRyaWJ1dGVzWyJhcmlhLXJlcXVpcmVkIl0gPSB0cnVlOwogICAgICBodG1sLmF0dHJpYnV0ZXMucmVxdWlyZWQgPSB0cnVlOwogICAgfQoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgbmFtZTogImxhYmVsIiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIGNsYXNzOiBbInhmYUxhYmVsIl0KICAgICAgfSwKICAgICAgY2hpbGRyZW46IFtodG1sXQogICAgfSk7CiAgfQoKfQoKY2xhc3MgRGVjaW1hbCBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZGVjaW1hbCIpOwogICAgdGhpcy5mcmFjRGlnaXRzID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuZnJhY0RpZ2l0cywKICAgICAgZGVmYXVsdFZhbHVlOiAyLAogICAgICB2YWxpZGF0ZTogeCA9PiB0cnVlCiAgICB9KTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5sZWFkRGlnaXRzID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMubGVhZERpZ2l0cywKICAgICAgZGVmYXVsdFZhbHVlOiAtMSwKICAgICAgdmFsaWRhdGU6IHggPT4gdHJ1ZQogICAgfSk7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICBjb25zdCBudW1iZXIgPSBwYXJzZUZsb2F0KHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKSk7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IGlzTmFOKG51bWJlcikgPyBudWxsIDogbnVtYmVyOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICByZXR1cm4gdmFsdWVUb0h0bWwodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gIT09IG51bGwgPyB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50b1N0cmluZygpIDogIiIpOwogIH0KCn0KCmNsYXNzIERlZmF1bHRVaSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJkZWZhdWx0VWkiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBEZXNjIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImRlc2MiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYm9vbGVhbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRhdGVUaW1lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRlY2ltYWwgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZXhEYXRhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmZsb2F0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmltYWdlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmludGVnZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGV4dCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy50aW1lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgRGlnZXN0TWV0aG9kIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImRpZ2VzdE1ldGhvZCIsIFsiIiwgIlNIQTEiLCAiU0hBMjU2IiwgIlNIQTUxMiIsICJSSVBFTUQxNjAiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgRGlnZXN0TWV0aG9kcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJkaWdlc3RNZXRob2RzIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnR5cGUsIFsib3B0aW9uYWwiLCAicmVxdWlyZWQiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5kaWdlc3RNZXRob2QgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBEcmF3IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImRyYXciLCB0cnVlKTsKICAgIHRoaXMuYW5jaG9yVHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmFuY2hvclR5cGUsIFsidG9wTGVmdCIsICJib3R0b21DZW50ZXIiLCAiYm90dG9tTGVmdCIsICJib3R0b21SaWdodCIsICJtaWRkbGVDZW50ZXIiLCAibWlkZGxlTGVmdCIsICJtaWRkbGVSaWdodCIsICJ0b3BDZW50ZXIiLCAidG9wUmlnaHQiXSk7CiAgICB0aGlzLmNvbFNwYW4gPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5jb2xTcGFuLAogICAgICBkZWZhdWx0VmFsdWU6IDEsCiAgICAgIHZhbGlkYXRlOiBuID0+IG4gPj0gMSB8fCBuID09PSAtMQogICAgfSk7CiAgICB0aGlzLmggPSBhdHRyaWJ1dGVzLmggPyAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLmgpIDogIiI7CiAgICB0aGlzLmhBbGlnbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmhBbGlnbiwgWyJsZWZ0IiwgImNlbnRlciIsICJqdXN0aWZ5IiwgImp1c3RpZnlBbGwiLCAicmFkaXgiLCAicmlnaHQiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubG9jYWxlID0gYXR0cmlidXRlcy5sb2NhbGUgfHwgIiI7CiAgICB0aGlzLm1heEggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1heEgsICIwcHQiKTsKICAgIHRoaXMubWF4VyA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWF4VywgIjBwdCIpOwogICAgdGhpcy5taW5IID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5taW5ILCAiMHB0Iik7CiAgICB0aGlzLm1pblcgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1pblcsICIwcHQiKTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucHJlc2VuY2UgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5wcmVzZW5jZSwgWyJ2aXNpYmxlIiwgImhpZGRlbiIsICJpbmFjdGl2ZSIsICJpbnZpc2libGUiXSk7CiAgICB0aGlzLnJlbGV2YW50ID0gKDAsIF91dGlscy5nZXRSZWxldmFudCkoYXR0cmlidXRlcy5yZWxldmFudCk7CiAgICB0aGlzLnJvdGF0ZSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnJvdGF0ZSwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ICUgOTAgPT09IDAKICAgIH0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMudyA9IGF0dHJpYnV0ZXMudyA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMudykgOiAiIjsKICAgIHRoaXMueCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMueCwgIjBwdCIpOwogICAgdGhpcy55ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy55LCAiMHB0Iik7CiAgICB0aGlzLmFzc2lzdCA9IG51bGw7CiAgICB0aGlzLmJvcmRlciA9IG51bGw7CiAgICB0aGlzLmNhcHRpb24gPSBudWxsOwogICAgdGhpcy5kZXNjID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMuZm9udCA9IG51bGw7CiAgICB0aGlzLmtlZXAgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogICAgdGhpcy5wYXJhID0gbnVsbDsKICAgIHRoaXMudHJhdmVyc2FsID0gbnVsbDsKICAgIHRoaXMudWkgPSBudWxsOwogICAgdGhpcy52YWx1ZSA9IG51bGw7CiAgICB0aGlzLnNldFByb3BlcnR5ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKICBbX3hmYV9vYmplY3QuJHNldFZhbHVlXSh2YWx1ZSkgewogICAgX3NldFZhbHVlKHRoaXMsIHZhbHVlKTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgc2V0VGFiSW5kZXgodGhpcyk7CgogICAgaWYgKHRoaXMucHJlc2VuY2UgPT09ICJoaWRkZW4iIHx8IHRoaXMucHJlc2VuY2UgPT09ICJpbmFjdGl2ZSIpIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgfQoKICAgICgwLCBfaHRtbF91dGlscy5maXhEaW1lbnNpb25zKSh0aGlzKTsKCiAgICB0aGlzW194ZmFfb2JqZWN0LiRwdXNoUGFyYV0oKTsKCiAgICBjb25zdCBzYXZlZFcgPSB0aGlzLnc7CiAgICBjb25zdCBzYXZlZEggPSB0aGlzLmg7CiAgICBjb25zdCB7CiAgICAgIHcsCiAgICAgIGgsCiAgICAgIGlzQnJva2VuCiAgICB9ID0gKDAsIF9odG1sX3V0aWxzLmxheW91dE5vZGUpKHRoaXMsIGF2YWlsYWJsZVNwYWNlKTsKCiAgICBpZiAodyAmJiB0aGlzLncgPT09ICIiKSB7CiAgICAgIGlmIChpc0Jyb2tlbiAmJiB0aGlzW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSgpW194ZmFfb2JqZWN0LiRpc1RoZXJlTW9yZVdpZHRoXSgpKSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkZBSUxVUkU7CiAgICAgIH0KCiAgICAgIHRoaXMudyA9IHc7CiAgICB9CgogICAgaWYgKGggJiYgdGhpcy5oID09PSAiIikgewogICAgICB0aGlzLmggPSBoOwogICAgfQoKICAgIHNldEZpcnN0VW5zcGxpdHRhYmxlKHRoaXMpOwoKICAgIGlmICghKDAsIF9sYXlvdXQuY2hlY2tEaW1lbnNpb25zKSh0aGlzLCBhdmFpbGFibGVTcGFjZSkpIHsKICAgICAgdGhpcy53ID0gc2F2ZWRXOwogICAgICB0aGlzLmggPSBzYXZlZEg7CgogICAgICB0aGlzW194ZmFfb2JqZWN0LiRwb3BQYXJhXSgpOwoKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkZBSUxVUkU7CiAgICB9CgogICAgdW5zZXRGaXJzdFVuc3BsaXR0YWJsZSh0aGlzKTsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJmb250IiwgImhBbGlnbiIsICJkaW1lbnNpb25zIiwgInBvc2l0aW9uIiwgInByZXNlbmNlIiwgInJvdGF0ZSIsICJhbmNob3JUeXBlIiwgImJvcmRlciIsICJtYXJnaW4iKTsKICAgICgwLCBfaHRtbF91dGlscy5zZXRNaW5NYXhEaW1lbnNpb25zKSh0aGlzLCBzdHlsZSk7CgogICAgaWYgKHN0eWxlLm1hcmdpbikgewogICAgICBzdHlsZS5wYWRkaW5nID0gc3R5bGUubWFyZ2luOwogICAgICBkZWxldGUgc3R5bGUubWFyZ2luOwogICAgfQoKICAgIGNvbnN0IGNsYXNzTmFtZXMgPSBbInhmYURyYXciXTsKCiAgICBpZiAodGhpcy5mb250KSB7CiAgICAgIGNsYXNzTmFtZXMucHVzaCgieGZhRm9udCIpOwogICAgfQoKICAgIGlmICgoMCwgX2h0bWxfdXRpbHMuaXNQcmludE9ubHkpKHRoaXMpKSB7CiAgICAgIGNsYXNzTmFtZXMucHVzaCgieGZhUHJpbnRPbmx5Iik7CiAgICB9CgogICAgY29uc3QgYXR0cmlidXRlcyA9IHsKICAgICAgc3R5bGUsCiAgICAgIGlkOiB0aGlzW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICBjbGFzczogY2xhc3NOYW1lcwogICAgfTsKCiAgICBpZiAodGhpcy5uYW1lKSB7CiAgICAgIGF0dHJpYnV0ZXMueGZhTmFtZSA9IHRoaXMubmFtZTsKICAgIH0KCiAgICBjb25zdCBodG1sID0gewogICAgICBuYW1lOiAiZGl2IiwKICAgICAgYXR0cmlidXRlcywKICAgICAgY2hpbGRyZW46IFtdCiAgICB9OwogICAgYXBwbHlBc3Npc3QodGhpcywgYXR0cmlidXRlcyk7CiAgICBjb25zdCBiYm94ID0gKDAsIF9odG1sX3V0aWxzLmNvbXB1dGVCYm94KSh0aGlzLCBodG1sLCBhdmFpbGFibGVTcGFjZSk7CiAgICBjb25zdCB2YWx1ZSA9IHRoaXMudmFsdWUgPyB0aGlzLnZhbHVlW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKS5odG1sIDogbnVsbDsKCiAgICBpZiAodmFsdWUgPT09IG51bGwpIHsKICAgICAgdGhpcy53ID0gc2F2ZWRXOwogICAgICB0aGlzLmggPSBzYXZlZEg7CgogICAgICB0aGlzW194ZmFfb2JqZWN0LiRwb3BQYXJhXSgpOwoKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoKDAsIF9odG1sX3V0aWxzLmNyZWF0ZVdyYXBwZXIpKHRoaXMsIGh0bWwpLCBiYm94KTsKICAgIH0KCiAgICBodG1sLmNoaWxkcmVuLnB1c2godmFsdWUpOwogICAgKDAsIF9odG1sX3V0aWxzLnNldFBhcmEpKHRoaXMsIHN0eWxlLCB2YWx1ZSk7CiAgICB0aGlzLncgPSBzYXZlZFc7CiAgICB0aGlzLmggPSBzYXZlZEg7CgogICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcygoMCwgX2h0bWxfdXRpbHMuY3JlYXRlV3JhcHBlcikodGhpcywgaHRtbCksIGJib3gpOwogIH0KCn0KCmNsYXNzIEVkZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZWRnZSIsIHRydWUpOwogICAgdGhpcy5jYXAgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5jYXAsIFsic3F1YXJlIiwgImJ1dHQiLCAicm91bmQiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMucHJlc2VuY2UgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5wcmVzZW5jZSwgWyJ2aXNpYmxlIiwgImhpZGRlbiIsICJpbmFjdGl2ZSIsICJpbnZpc2libGUiXSk7CiAgICB0aGlzLnN0cm9rZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnN0cm9rZSwgWyJzb2xpZCIsICJkYXNoRG90IiwgImRhc2hEb3REb3QiLCAiZGFzaGVkIiwgImRvdHRlZCIsICJlbWJvc3NlZCIsICJldGNoZWQiLCAibG93ZXJlZCIsICJyYWlzZWQiXSk7CiAgICB0aGlzLnRoaWNrbmVzcyA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMudGhpY2tuZXNzLCAiMC41cHQiKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmNvbG9yID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9TdHlsZV0oKSB7CiAgICBjb25zdCBzdHlsZSA9ICgwLCBfaHRtbF91dGlscy50b1N0eWxlKSh0aGlzLCAidmlzaWJpbGl0eSIpOwogICAgT2JqZWN0LmFzc2lnbihzdHlsZSwgewogICAgICBsaW5lY2FwOiB0aGlzLmNhcCwKICAgICAgd2lkdGg6ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMudGhpY2tuZXNzKSwKICAgICAgY29sb3I6IHRoaXMuY29sb3IgPyB0aGlzLmNvbG9yW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIDogIiMwMDAwMDAiLAogICAgICBzdHlsZTogIiIKICAgIH0pOwoKICAgIGlmICh0aGlzLnByZXNlbmNlICE9PSAidmlzaWJsZSIpIHsKICAgICAgc3R5bGUuc3R5bGUgPSAibm9uZSI7CiAgICB9IGVsc2UgewogICAgICBzd2l0Y2ggKHRoaXMuc3Ryb2tlKSB7CiAgICAgICAgY2FzZSAic29saWQiOgogICAgICAgICAgc3R5bGUuc3R5bGUgPSAic29saWQiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImRhc2hEb3QiOgogICAgICAgICAgc3R5bGUuc3R5bGUgPSAiZGFzaGVkIjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJkYXNoRG90RG90IjoKICAgICAgICAgIHN0eWxlLnN0eWxlID0gImRhc2hlZCI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZGFzaGVkIjoKICAgICAgICAgIHN0eWxlLnN0eWxlID0gImRhc2hlZCI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZG90dGVkIjoKICAgICAgICAgIHN0eWxlLnN0eWxlID0gImRvdHRlZCI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZW1ib3NzZWQiOgogICAgICAgICAgc3R5bGUuc3R5bGUgPSAicmlkZ2UiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImV0Y2hlZCI6CiAgICAgICAgICBzdHlsZS5zdHlsZSA9ICJncm9vdmUiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImxvd2VyZWQiOgogICAgICAgICAgc3R5bGUuc3R5bGUgPSAiaW5zZXQiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInJhaXNlZCI6CiAgICAgICAgICBzdHlsZS5zdHlsZSA9ICJvdXRzZXQiOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc3R5bGU7CiAgfQoKfQoKY2xhc3MgRW5jb2RpbmcgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZW5jb2RpbmciLCBbImFkYmUueDUwOS5yc2Ffc2hhMSIsICJhZGJlLnBrY3M3LmRldGFjaGVkIiwgImFkYmUucGtjczcuc2hhMSJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBFbmNvZGluZ3MgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZW5jb2RpbmdzIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnR5cGUsIFsib3B0aW9uYWwiLCAicmVxdWlyZWQiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5lbmNvZGluZyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIEVuY3J5cHQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZW5jcnlwdCIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5jZXJ0aWZpY2F0ZSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgRW5jcnlwdERhdGEgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZW5jcnlwdERhdGEiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5vcGVyYXRpb24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5vcGVyYXRpb24sIFsiZW5jcnlwdCIsICJkZWNyeXB0Il0pOwogICAgdGhpcy50YXJnZXQgPSBhdHRyaWJ1dGVzLnRhcmdldCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmZpbHRlciA9IG51bGw7CiAgICB0aGlzLm1hbmlmZXN0ID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBFbmNyeXB0aW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImVuY3J5cHRpb24iLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmNlcnRpZmljYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgRW5jcnlwdGlvbk1ldGhvZCBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJlbmNyeXB0aW9uTWV0aG9kIiwgWyIiLCAiQUVTMjU2LUNCQyIsICJUUklQTEVERVMtQ0JDIiwgIkFFUzEyOC1DQkMiLCAiQUVTMTkyLUNCQyJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBFbmNyeXB0aW9uTWV0aG9kcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJlbmNyeXB0aW9uTWV0aG9kcyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZW5jcnlwdGlvbk1ldGhvZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIEV2ZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImV2ZW50IiwgdHJ1ZSk7CiAgICB0aGlzLmFjdGl2aXR5ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuYWN0aXZpdHksIFsiY2xpY2siLCAiY2hhbmdlIiwgImRvY0Nsb3NlIiwgImRvY1JlYWR5IiwgImVudGVyIiwgImV4aXQiLCAiZnVsbCIsICJpbmRleENoYW5nZSIsICJpbml0aWFsaXplIiwgIm1vdXNlRG93biIsICJtb3VzZUVudGVyIiwgIm1vdXNlRXhpdCIsICJtb3VzZVVwIiwgInBvc3RFeGVjdXRlIiwgInBvc3RPcGVuIiwgInBvc3RQcmludCIsICJwb3N0U2F2ZSIsICJwb3N0U2lnbiIsICJwb3N0U3VibWl0IiwgInByZUV4ZWN1dGUiLCAicHJlT3BlbiIsICJwcmVQcmludCIsICJwcmVTYXZlIiwgInByZVNpZ24iLCAicHJlU3VibWl0IiwgInJlYWR5IiwgInZhbGlkYXRpb25TdGF0ZSJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5saXN0ZW4gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5saXN0ZW4sIFsicmVmT25seSIsICJyZWZBbmREZXNjZW5kZW50cyJdKTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucmVmID0gYXR0cmlidXRlcy5yZWYgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5lbmNyeXB0RGF0YSA9IG51bGw7CiAgICB0aGlzLmV4ZWN1dGUgPSBudWxsOwogICAgdGhpcy5zY3JpcHQgPSBudWxsOwogICAgdGhpcy5zaWduRGF0YSA9IG51bGw7CiAgICB0aGlzLnN1Ym1pdCA9IG51bGw7CiAgfQoKfQoKY2xhc3MgRXhEYXRhIGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJleERhdGEiKTsKICAgIHRoaXMuY29udGVudFR5cGUgPSBhdHRyaWJ1dGVzLmNvbnRlbnRUeXBlIHx8ICIiOwogICAgdGhpcy5ocmVmID0gYXR0cmlidXRlcy5ocmVmIHx8ICIiOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm1heExlbmd0aCA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLm1heExlbmd0aCwKICAgICAgZGVmYXVsdFZhbHVlOiAtMSwKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAtMQogICAgfSk7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnJpZCA9IGF0dHJpYnV0ZXMucmlkIHx8ICIiOwogICAgdGhpcy50cmFuc2ZlckVuY29kaW5nID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHJhbnNmZXJFbmNvZGluZywgWyJub25lIiwgImJhc2U2NCIsICJwYWNrYWdlIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9CgogIFtfeGZhX29iamVjdC4kaXNDREFUQVhtbF0oKSB7CiAgICByZXR1cm4gdGhpcy5jb250ZW50VHlwZSA9PT0gInRleHQvaHRtbCI7CiAgfQoKICBbX3hmYV9vYmplY3QuJG9uQ2hpbGRdKGNoaWxkKSB7CiAgICBpZiAodGhpcy5jb250ZW50VHlwZSA9PT0gInRleHQvaHRtbCIgJiYgY2hpbGRbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXSA9PT0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLnhodG1sLmlkKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gY2hpbGQ7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGlmICh0aGlzLmNvbnRlbnRUeXBlID09PSAidGV4dC94bWwiKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gY2hpbGQ7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgaWYgKHRoaXMuY29udGVudFR5cGUgIT09ICJ0ZXh0L2h0bWwiIHx8ICF0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgICB9CgogICAgcmV0dXJuIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKTsKICB9Cgp9CgpjbGFzcyBFeE9iamVjdCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJleE9iamVjdCIsIHRydWUpOwogICAgdGhpcy5hcmNoaXZlID0gYXR0cmlidXRlcy5hcmNoaXZlIHx8ICIiOwogICAgdGhpcy5jbGFzc0lkID0gYXR0cmlidXRlcy5jbGFzc0lkIHx8ICIiOwogICAgdGhpcy5jb2RlQmFzZSA9IGF0dHJpYnV0ZXMuY29kZUJhc2UgfHwgIiI7CiAgICB0aGlzLmNvZGVUeXBlID0gYXR0cmlidXRlcy5jb2RlVHlwZSB8fCAiIjsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMuYm9vbGVhbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRhdGVUaW1lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRlY2ltYWwgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZXhEYXRhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4T2JqZWN0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmZsb2F0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmltYWdlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmludGVnZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGV4dCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy50aW1lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgRXhjbEdyb3VwIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImV4Y2xHcm91cCIsIHRydWUpOwogICAgdGhpcy5hY2Nlc3MgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5hY2Nlc3MsIFsib3BlbiIsICJub25JbnRlcmFjdGl2ZSIsICJwcm90ZWN0ZWQiLCAicmVhZE9ubHkiXSk7CiAgICB0aGlzLmFjY2Vzc0tleSA9IGF0dHJpYnV0ZXMuYWNjZXNzS2V5IHx8ICIiOwogICAgdGhpcy5hbmNob3JUeXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuYW5jaG9yVHlwZSwgWyJ0b3BMZWZ0IiwgImJvdHRvbUNlbnRlciIsICJib3R0b21MZWZ0IiwgImJvdHRvbVJpZ2h0IiwgIm1pZGRsZUNlbnRlciIsICJtaWRkbGVMZWZ0IiwgIm1pZGRsZVJpZ2h0IiwgInRvcENlbnRlciIsICJ0b3BSaWdodCJdKTsKICAgIHRoaXMuY29sU3BhbiA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmNvbFNwYW4sCiAgICAgIGRlZmF1bHRWYWx1ZTogMSwKICAgICAgdmFsaWRhdGU6IG4gPT4gbiA+PSAxIHx8IG4gPT09IC0xCiAgICB9KTsKICAgIHRoaXMuaCA9IGF0dHJpYnV0ZXMuaCA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMuaCkgOiAiIjsKICAgIHRoaXMuaEFsaWduID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaEFsaWduLCBbImxlZnQiLCAiY2VudGVyIiwgImp1c3RpZnkiLCAianVzdGlmeUFsbCIsICJyYWRpeCIsICJyaWdodCJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5sYXlvdXQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5sYXlvdXQsIFsicG9zaXRpb24iLCAibHItdGIiLCAicmwtcm93IiwgInJsLXRiIiwgInJvdyIsICJ0YWJsZSIsICJ0YiJdKTsKICAgIHRoaXMubWF4SCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWF4SCwgIjBwdCIpOwogICAgdGhpcy5tYXhXID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5tYXhXLCAiMHB0Iik7CiAgICB0aGlzLm1pbkggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1pbkgsICIwcHQiKTsKICAgIHRoaXMubWluVyA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWluVywgIjBwdCIpOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5wcmVzZW5jZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnByZXNlbmNlLCBbInZpc2libGUiLCAiaGlkZGVuIiwgImluYWN0aXZlIiwgImludmlzaWJsZSJdKTsKICAgIHRoaXMucmVsZXZhbnQgPSAoMCwgX3V0aWxzLmdldFJlbGV2YW50KShhdHRyaWJ1dGVzLnJlbGV2YW50KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLncgPSBhdHRyaWJ1dGVzLncgPyAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLncpIDogIiI7CiAgICB0aGlzLnggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLngsICIwcHQiKTsKICAgIHRoaXMueSA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMueSwgIjBwdCIpOwogICAgdGhpcy5hc3Npc3QgPSBudWxsOwogICAgdGhpcy5iaW5kID0gbnVsbDsKICAgIHRoaXMuYm9yZGVyID0gbnVsbDsKICAgIHRoaXMuY2FsY3VsYXRlID0gbnVsbDsKICAgIHRoaXMuY2FwdGlvbiA9IG51bGw7CiAgICB0aGlzLmRlc2MgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogICAgdGhpcy5wYXJhID0gbnVsbDsKICAgIHRoaXMudHJhdmVyc2FsID0gbnVsbDsKICAgIHRoaXMudmFsaWRhdGUgPSBudWxsOwogICAgdGhpcy5jb25uZWN0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV2ZW50ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmZpZWxkID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnNldFByb3BlcnR5ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzQmluZGFibGVdKCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBbX3hmYV9vYmplY3QuJGhhc1NldHRhYmxlVmFsdWVdKCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBbX3hmYV9vYmplY3QuJHNldFZhbHVlXSh2YWx1ZSkgewogICAgZm9yIChjb25zdCBmaWVsZCBvZiB0aGlzLmZpZWxkLmNoaWxkcmVuKSB7CiAgICAgIGlmICghZmllbGQudmFsdWUpIHsKICAgICAgICBjb25zdCBub2RlVmFsdWUgPSBuZXcgVmFsdWUoe30pOwoKICAgICAgICBmaWVsZFtfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKG5vZGVWYWx1ZSk7CgogICAgICAgIGZpZWxkLnZhbHVlID0gbm9kZVZhbHVlOwogICAgICB9CgogICAgICBmaWVsZC52YWx1ZVtfeGZhX29iamVjdC4kc2V0VmFsdWVdKHZhbHVlKTsKICAgIH0KICB9CgogIFtfeGZhX29iamVjdC4kaXNUaGVyZU1vcmVXaWR0aF0oKSB7CiAgICByZXR1cm4gdGhpcy5sYXlvdXQuZW5kc1dpdGgoIi10YiIpICYmIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5hdHRlbXB0ID09PSAwICYmIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5udW1iZXJJbkxpbmUgPiAwIHx8IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKVtfeGZhX29iamVjdC4kaXNUaGVyZU1vcmVXaWR0aF0oKTsKICB9CgogIFtfeGZhX29iamVjdC4kaXNTcGxpdHRhYmxlXSgpIHsKICAgIGNvbnN0IHBhcmVudCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCk7CgogICAgaWYgKCFwYXJlbnRbX3hmYV9vYmplY3QuJGlzU3BsaXR0YWJsZV0oKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5faXNTcGxpdHRhYmxlICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5faXNTcGxpdHRhYmxlOwogICAgfQoKICAgIGlmICh0aGlzLmxheW91dCA9PT0gInBvc2l0aW9uIiB8fCB0aGlzLmxheW91dC5pbmNsdWRlcygicm93IikpIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLl9pc1NwbGl0dGFibGUgPSBmYWxzZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmIChwYXJlbnQubGF5b3V0ICYmIHBhcmVudC5sYXlvdXQuZW5kc1dpdGgoIi10YiIpICYmIHBhcmVudFtfeGZhX29iamVjdC4kZXh0cmFdLm51bWJlckluTGluZSAhPT0gMCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLl9pc1NwbGl0dGFibGUgPSB0cnVlOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZsdXNoSFRNTF0oKSB7CiAgICByZXR1cm4gKDAsIF9sYXlvdXQuZmx1c2hIVE1MKSh0aGlzKTsKICB9CgogIFtfeGZhX29iamVjdC4kYWRkSFRNTF0oaHRtbCwgYmJveCkgewogICAgKDAsIF9sYXlvdXQuYWRkSFRNTCkodGhpcywgaHRtbCwgYmJveCk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGdldEF2YWlsYWJsZVNwYWNlXSgpIHsKICAgIHJldHVybiAoMCwgX2xheW91dC5nZXRBdmFpbGFibGVTcGFjZSkodGhpcyk7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIHNldFRhYkluZGV4KHRoaXMpOwoKICAgIGlmICh0aGlzLnByZXNlbmNlID09PSAiaGlkZGVuIiB8fCB0aGlzLnByZXNlbmNlID09PSAiaW5hY3RpdmUiIHx8IHRoaXMuaCA9PT0gMCB8fCB0aGlzLncgPT09IDApIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgfQoKICAgICgwLCBfaHRtbF91dGlscy5maXhEaW1lbnNpb25zKSh0aGlzKTsKICAgIGNvbnN0IGNoaWxkcmVuID0gW107CiAgICBjb25zdCBhdHRyaWJ1dGVzID0gewogICAgICBpZDogdGhpc1tfeGZhX29iamVjdC4kdWlkXSwKICAgICAgY2xhc3M6IFtdCiAgICB9OwogICAgKDAsIF9odG1sX3V0aWxzLnNldEFjY2VzcykodGhpcywgYXR0cmlidXRlcy5jbGFzcyk7CgogICAgaWYgKCF0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0pIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIH0KCiAgICBPYmplY3QuYXNzaWduKHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSwgewogICAgICBjaGlsZHJlbiwKICAgICAgYXR0cmlidXRlcywKICAgICAgYXR0ZW1wdDogMCwKICAgICAgbGluZTogbnVsbCwKICAgICAgbnVtYmVySW5MaW5lOiAwLAogICAgICBhdmFpbGFibGVTcGFjZTogewogICAgICAgIHdpZHRoOiBNYXRoLm1pbih0aGlzLncgfHwgSW5maW5pdHksIGF2YWlsYWJsZVNwYWNlLndpZHRoKSwKICAgICAgICBoZWlnaHQ6IE1hdGgubWluKHRoaXMuaCB8fCBJbmZpbml0eSwgYXZhaWxhYmxlU3BhY2UuaGVpZ2h0KQogICAgICB9LAogICAgICB3aWR0aDogMCwKICAgICAgaGVpZ2h0OiAwLAogICAgICBwcmV2SGVpZ2h0OiAwLAogICAgICBjdXJyZW50V2lkdGg6IDAKICAgIH0pOwoKICAgIGNvbnN0IGlzU3BsaXR0YWJsZSA9IHRoaXNbX3hmYV9vYmplY3QuJGlzU3BsaXR0YWJsZV0oKTsKCiAgICBpZiAoIWlzU3BsaXR0YWJsZSkgewogICAgICBzZXRGaXJzdFVuc3BsaXR0YWJsZSh0aGlzKTsKICAgIH0KCiAgICBpZiAoISgwLCBfbGF5b3V0LmNoZWNrRGltZW5zaW9ucykodGhpcywgYXZhaWxhYmxlU3BhY2UpKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5GQUlMVVJFOwogICAgfQoKICAgIGNvbnN0IGZpbHRlciA9IG5ldyBTZXQoWyJmaWVsZCJdKTsKCiAgICBpZiAodGhpcy5sYXlvdXQuaW5jbHVkZXMoInJvdyIpKSB7CiAgICAgIGNvbnN0IGNvbHVtbldpZHRocyA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCkuY29sdW1uV2lkdGhzOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY29sdW1uV2lkdGhzKSAmJiBjb2x1bW5XaWR0aHMubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5jb2x1bW5XaWR0aHMgPSBjb2x1bW5XaWR0aHM7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmN1cnJlbnRDb2x1bW4gPSAwOwogICAgICB9CiAgICB9CgogICAgY29uc3Qgc3R5bGUgPSAoMCwgX2h0bWxfdXRpbHMudG9TdHlsZSkodGhpcywgImFuY2hvclR5cGUiLCAiZGltZW5zaW9ucyIsICJwb3NpdGlvbiIsICJwcmVzZW5jZSIsICJib3JkZXIiLCAibWFyZ2luIiwgImhBbGlnbiIpOwogICAgY29uc3QgY2xhc3NOYW1lcyA9IFsieGZhRXhjbGdyb3VwIl07CiAgICBjb25zdCBjbCA9ICgwLCBfaHRtbF91dGlscy5sYXlvdXRDbGFzcykodGhpcyk7CgogICAgaWYgKGNsKSB7CiAgICAgIGNsYXNzTmFtZXMucHVzaChjbCk7CiAgICB9CgogICAgaWYgKCgwLCBfaHRtbF91dGlscy5pc1ByaW50T25seSkodGhpcykpIHsKICAgICAgY2xhc3NOYW1lcy5wdXNoKCJ4ZmFQcmludE9ubHkiKTsKICAgIH0KCiAgICBhdHRyaWJ1dGVzLnN0eWxlID0gc3R5bGU7CiAgICBhdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3NOYW1lczsKCiAgICBpZiAodGhpcy5uYW1lKSB7CiAgICAgIGF0dHJpYnV0ZXMueGZhTmFtZSA9IHRoaXMubmFtZTsKICAgIH0KCiAgICB0aGlzW194ZmFfb2JqZWN0LiRwdXNoUGFyYV0oKTsKCiAgICBjb25zdCBpc0xyVGIgPSB0aGlzLmxheW91dCA9PT0gImxyLXRiIiB8fCB0aGlzLmxheW91dCA9PT0gInJsLXRiIjsKICAgIGNvbnN0IG1heFJ1biA9IGlzTHJUYiA/IE1BWF9BVFRFTVBUU19GT1JfTFJUQl9MQVlPVVQgOiAxOwoKICAgIGZvciAoOyB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0ZW1wdCA8IG1heFJ1bjsgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQrKykgewogICAgICBpZiAoaXNMclRiICYmIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5hdHRlbXB0ID09PSBNQVhfQVRURU1QVFNfRk9SX0xSVEJfTEFZT1VUIC0gMSkgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5udW1iZXJJbkxpbmUgPSAwOwogICAgICB9CgogICAgICBjb25zdCByZXN1bHQgPSB0aGlzW194ZmFfb2JqZWN0LiRjaGlsZHJlblRvSFRNTF0oewogICAgICAgIGZpbHRlciwKICAgICAgICBpbmNsdWRlOiB0cnVlCiAgICAgIH0pOwoKICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmIChyZXN1bHQuaXNCcmVhaygpKSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfQoKICAgICAgaWYgKGlzTHJUYiAmJiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0ZW1wdCA9PT0gMCAmJiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVySW5MaW5lID09PSAwICYmICF0aGlzW194ZmFfb2JqZWN0LiRnZXRUZW1wbGF0ZVJvb3RdKClbX3hmYV9vYmplY3QuJGV4dHJhXS5ub0xheW91dEZhaWx1cmUpIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0ZW1wdCA9IG1heFJ1bjsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHRoaXNbX3hmYV9vYmplY3QuJHBvcFBhcmFdKCk7CgogICAgaWYgKCFpc1NwbGl0dGFibGUpIHsKICAgICAgdW5zZXRGaXJzdFVuc3BsaXR0YWJsZSh0aGlzKTsKICAgIH0KCiAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgPT09IG1heFJ1bikgewogICAgICBpZiAoIWlzU3BsaXR0YWJsZSkgewogICAgICAgIGRlbGV0ZSB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV07CiAgICAgIH0KCiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5GQUlMVVJFOwogICAgfQoKICAgIGxldCBtYXJnaW5IID0gMDsKICAgIGxldCBtYXJnaW5WID0gMDsKCiAgICBpZiAodGhpcy5tYXJnaW4pIHsKICAgICAgbWFyZ2luSCA9IHRoaXMubWFyZ2luLmxlZnRJbnNldCArIHRoaXMubWFyZ2luLnJpZ2h0SW5zZXQ7CiAgICAgIG1hcmdpblYgPSB0aGlzLm1hcmdpbi50b3BJbnNldCArIHRoaXMubWFyZ2luLmJvdHRvbUluc2V0OwogICAgfQoKICAgIGNvbnN0IHdpZHRoID0gTWF0aC5tYXgodGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLndpZHRoICsgbWFyZ2luSCwgdGhpcy53IHx8IDApOwogICAgY29uc3QgaGVpZ2h0ID0gTWF0aC5tYXgodGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmhlaWdodCArIG1hcmdpblYsIHRoaXMuaCB8fCAwKTsKICAgIGNvbnN0IGJib3ggPSBbdGhpcy54LCB0aGlzLnksIHdpZHRoLCBoZWlnaHRdOwoKICAgIGlmICh0aGlzLncgPT09ICIiKSB7CiAgICAgIHN0eWxlLndpZHRoID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykod2lkdGgpOwogICAgfQoKICAgIGlmICh0aGlzLmggPT09ICIiKSB7CiAgICAgIHN0eWxlLmhlaWdodCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKGhlaWdodCk7CiAgICB9CgogICAgY29uc3QgaHRtbCA9IHsKICAgICAgbmFtZTogImRpdiIsCiAgICAgIGF0dHJpYnV0ZXMsCiAgICAgIGNoaWxkcmVuCiAgICB9OwogICAgYXBwbHlBc3Npc3QodGhpcywgYXR0cmlidXRlcyk7CiAgICBkZWxldGUgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdOwogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoKDAsIF9odG1sX3V0aWxzLmNyZWF0ZVdyYXBwZXIpKHRoaXMsIGh0bWwpLCBiYm94KTsKICB9Cgp9CgpjbGFzcyBFeGVjdXRlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImV4ZWN1dGUiKTsKICAgIHRoaXMuY29ubmVjdGlvbiA9IGF0dHJpYnV0ZXMuY29ubmVjdGlvbiB8fCAiIjsKICAgIHRoaXMuZXhlY3V0ZVR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5leGVjdXRlVHlwZSwgWyJpbXBvcnQiLCAicmVtZXJnZSJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5ydW5BdCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnJ1bkF0LCBbImNsaWVudCIsICJib3RoIiwgInNlcnZlciJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgRXh0cmFzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImV4dHJhcyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5ib29sZWFuID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRhdGUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGF0ZVRpbWUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGVjaW1hbCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leERhdGEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZXh0cmFzID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmZsb2F0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmltYWdlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmludGVnZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGV4dCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy50aW1lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgRmllbGQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZmllbGQiLCB0cnVlKTsKICAgIHRoaXMuYWNjZXNzID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuYWNjZXNzLCBbIm9wZW4iLCAibm9uSW50ZXJhY3RpdmUiLCAicHJvdGVjdGVkIiwgInJlYWRPbmx5Il0pOwogICAgdGhpcy5hY2Nlc3NLZXkgPSBhdHRyaWJ1dGVzLmFjY2Vzc0tleSB8fCAiIjsKICAgIHRoaXMuYW5jaG9yVHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmFuY2hvclR5cGUsIFsidG9wTGVmdCIsICJib3R0b21DZW50ZXIiLCAiYm90dG9tTGVmdCIsICJib3R0b21SaWdodCIsICJtaWRkbGVDZW50ZXIiLCAibWlkZGxlTGVmdCIsICJtaWRkbGVSaWdodCIsICJ0b3BDZW50ZXIiLCAidG9wUmlnaHQiXSk7CiAgICB0aGlzLmNvbFNwYW4gPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5jb2xTcGFuLAogICAgICBkZWZhdWx0VmFsdWU6IDEsCiAgICAgIHZhbGlkYXRlOiBuID0+IG4gPj0gMSB8fCBuID09PSAtMQogICAgfSk7CiAgICB0aGlzLmggPSBhdHRyaWJ1dGVzLmggPyAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLmgpIDogIiI7CiAgICB0aGlzLmhBbGlnbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmhBbGlnbiwgWyJsZWZ0IiwgImNlbnRlciIsICJqdXN0aWZ5IiwgImp1c3RpZnlBbGwiLCAicmFkaXgiLCAicmlnaHQiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubG9jYWxlID0gYXR0cmlidXRlcy5sb2NhbGUgfHwgIiI7CiAgICB0aGlzLm1heEggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1heEgsICIwcHQiKTsKICAgIHRoaXMubWF4VyA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWF4VywgIjBwdCIpOwogICAgdGhpcy5taW5IID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5taW5ILCAiMHB0Iik7CiAgICB0aGlzLm1pblcgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1pblcsICIwcHQiKTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucHJlc2VuY2UgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5wcmVzZW5jZSwgWyJ2aXNpYmxlIiwgImhpZGRlbiIsICJpbmFjdGl2ZSIsICJpbnZpc2libGUiXSk7CiAgICB0aGlzLnJlbGV2YW50ID0gKDAsIF91dGlscy5nZXRSZWxldmFudCkoYXR0cmlidXRlcy5yZWxldmFudCk7CiAgICB0aGlzLnJvdGF0ZSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnJvdGF0ZSwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ICUgOTAgPT09IDAKICAgIH0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMudyA9IGF0dHJpYnV0ZXMudyA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMudykgOiAiIjsKICAgIHRoaXMueCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMueCwgIjBwdCIpOwogICAgdGhpcy55ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy55LCAiMHB0Iik7CiAgICB0aGlzLmFzc2lzdCA9IG51bGw7CiAgICB0aGlzLmJpbmQgPSBudWxsOwogICAgdGhpcy5ib3JkZXIgPSBudWxsOwogICAgdGhpcy5jYWxjdWxhdGUgPSBudWxsOwogICAgdGhpcy5jYXB0aW9uID0gbnVsbDsKICAgIHRoaXMuZGVzYyA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLmZvbnQgPSBudWxsOwogICAgdGhpcy5mb3JtYXQgPSBudWxsOwogICAgdGhpcy5pdGVtcyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgyKTsKICAgIHRoaXMua2VlcCA9IG51bGw7CiAgICB0aGlzLm1hcmdpbiA9IG51bGw7CiAgICB0aGlzLnBhcmEgPSBudWxsOwogICAgdGhpcy50cmF2ZXJzYWwgPSBudWxsOwogICAgdGhpcy51aSA9IG51bGw7CiAgICB0aGlzLnZhbGlkYXRlID0gbnVsbDsKICAgIHRoaXMudmFsdWUgPSBudWxsOwogICAgdGhpcy5iaW5kSXRlbXMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuY29ubmVjdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5ldmVudCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zZXRQcm9wZXJ0eSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRpc0JpbmRhYmxlXSgpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgW194ZmFfb2JqZWN0LiRzZXRWYWx1ZV0odmFsdWUpIHsKICAgIF9zZXRWYWx1ZSh0aGlzLCB2YWx1ZSk7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIHNldFRhYkluZGV4KHRoaXMpOwoKICAgIGlmICghdGhpcy51aSkgewogICAgICB0aGlzLnVpID0gbmV3IFVpKHt9KTsKICAgICAgdGhpcy51aVtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0gPSB0aGlzW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXTsKCiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXSh0aGlzLnVpKTsKCiAgICAgIGxldCBub2RlOwoKICAgICAgc3dpdGNoICh0aGlzLml0ZW1zLmNoaWxkcmVuLmxlbmd0aCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIG5vZGUgPSBuZXcgVGV4dEVkaXQoe30pOwogICAgICAgICAgdGhpcy51aS50ZXh0RWRpdCA9IG5vZGU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxOgogICAgICAgICAgbm9kZSA9IG5ldyBDaGVja0J1dHRvbih7fSk7CiAgICAgICAgICB0aGlzLnVpLmNoZWNrQnV0dG9uID0gbm9kZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBub2RlID0gbmV3IENob2ljZUxpc3Qoe30pOwogICAgICAgICAgdGhpcy51aS5jaG9pY2VMaXN0ID0gbm9kZTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICB0aGlzLnVpW194ZmFfb2JqZWN0LiRhcHBlbmRDaGlsZF0obm9kZSk7CiAgICB9CgogICAgaWYgKCF0aGlzLnVpIHx8IHRoaXMucHJlc2VuY2UgPT09ICJoaWRkZW4iIHx8IHRoaXMucHJlc2VuY2UgPT09ICJpbmFjdGl2ZSIgfHwgdGhpcy5oID09PSAwIHx8IHRoaXMudyA9PT0gMCkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgICB9CgogICAgaWYgKHRoaXMuY2FwdGlvbikgewogICAgICBkZWxldGUgdGhpcy5jYXB0aW9uW194ZmFfb2JqZWN0LiRleHRyYV07CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kcHVzaFBhcmFdKCk7CgogICAgY29uc3QgY2FwdGlvbiA9IHRoaXMuY2FwdGlvbiA/IHRoaXMuY2FwdGlvbltfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkuaHRtbCA6IG51bGw7CiAgICBjb25zdCBzYXZlZFcgPSB0aGlzLnc7CiAgICBjb25zdCBzYXZlZEggPSB0aGlzLmg7CiAgICBsZXQgbWFyZ2luSCA9IDA7CiAgICBsZXQgbWFyZ2luViA9IDA7CgogICAgaWYgKHRoaXMubWFyZ2luKSB7CiAgICAgIG1hcmdpbkggPSB0aGlzLm1hcmdpbi5sZWZ0SW5zZXQgKyB0aGlzLm1hcmdpbi5yaWdodEluc2V0OwogICAgICBtYXJnaW5WID0gdGhpcy5tYXJnaW4udG9wSW5zZXQgKyB0aGlzLm1hcmdpbi5ib3R0b21JbnNldDsKICAgIH0KCiAgICBsZXQgYm9yZGVyRGltcyA9IG51bGw7CgogICAgaWYgKHRoaXMudyA9PT0gIiIgfHwgdGhpcy5oID09PSAiIikgewogICAgICBsZXQgd2lkdGggPSBudWxsOwogICAgICBsZXQgaGVpZ2h0ID0gbnVsbDsKICAgICAgbGV0IHVpVyA9IDA7CiAgICAgIGxldCB1aUggPSAwOwoKICAgICAgaWYgKHRoaXMudWkuY2hlY2tCdXR0b24pIHsKICAgICAgICB1aVcgPSB1aUggPSB0aGlzLnVpLmNoZWNrQnV0dG9uLnNpemU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgewogICAgICAgICAgdywKICAgICAgICAgIGgKICAgICAgICB9ID0gKDAsIF9odG1sX3V0aWxzLmxheW91dE5vZGUpKHRoaXMsIGF2YWlsYWJsZVNwYWNlKTsKCiAgICAgICAgaWYgKHcgIT09IG51bGwpIHsKICAgICAgICAgIHVpVyA9IHc7CiAgICAgICAgICB1aUggPSBoOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB1aUggPSAoMCwgX2ZvbnRzLmdldE1ldHJpY3MpKHRoaXMuZm9udCwgdHJ1ZSkubGluZU5vR2FwOwogICAgICAgIH0KICAgICAgfQoKICAgICAgYm9yZGVyRGltcyA9IGdldEJvcmRlckRpbXModGhpcy51aVtfeGZhX29iamVjdC4kZ2V0RXh0cmFdKCkpOwogICAgICB1aVcgKz0gYm9yZGVyRGltcy53OwogICAgICB1aUggKz0gYm9yZGVyRGltcy5oOwoKICAgICAgaWYgKHRoaXMuY2FwdGlvbikgewogICAgICAgIGNvbnN0IHsKICAgICAgICAgIHcsCiAgICAgICAgICBoLAogICAgICAgICAgaXNCcm9rZW4KICAgICAgICB9ID0gdGhpcy5jYXB0aW9uW194ZmFfb2JqZWN0LiRnZXRFeHRyYV0oYXZhaWxhYmxlU3BhY2UpOwoKICAgICAgICBpZiAoaXNCcm9rZW4gJiYgdGhpc1tfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKVtfeGZhX29iamVjdC4kaXNUaGVyZU1vcmVXaWR0aF0oKSkgewogICAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICAgICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRkFJTFVSRTsKICAgICAgICB9CgogICAgICAgIHdpZHRoID0gdzsKICAgICAgICBoZWlnaHQgPSBoOwoKICAgICAgICBzd2l0Y2ggKHRoaXMuY2FwdGlvbi5wbGFjZW1lbnQpIHsKICAgICAgICAgIGNhc2UgImxlZnQiOgogICAgICAgICAgY2FzZSAicmlnaHQiOgogICAgICAgICAgY2FzZSAiaW5saW5lIjoKICAgICAgICAgICAgd2lkdGggKz0gdWlXOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJ0b3AiOgogICAgICAgICAgY2FzZSAiYm90dG9tIjoKICAgICAgICAgICAgaGVpZ2h0ICs9IHVpSDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHdpZHRoID0gdWlXOwogICAgICAgIGhlaWdodCA9IHVpSDsKICAgICAgfQoKICAgICAgaWYgKHdpZHRoICYmIHRoaXMudyA9PT0gIiIpIHsKICAgICAgICB3aWR0aCArPSBtYXJnaW5IOwogICAgICAgIHRoaXMudyA9IE1hdGgubWluKHRoaXMubWF4VyA8PSAwID8gSW5maW5pdHkgOiB0aGlzLm1heFcsIHRoaXMubWluVyArIDEgPCB3aWR0aCA/IHdpZHRoIDogdGhpcy5taW5XKTsKICAgICAgfQoKICAgICAgaWYgKGhlaWdodCAmJiB0aGlzLmggPT09ICIiKSB7CiAgICAgICAgaGVpZ2h0ICs9IG1hcmdpblY7CiAgICAgICAgdGhpcy5oID0gTWF0aC5taW4odGhpcy5tYXhIIDw9IDAgPyBJbmZpbml0eSA6IHRoaXMubWF4SCwgdGhpcy5taW5IICsgMSA8IGhlaWdodCA/IGhlaWdodCA6IHRoaXMubWluSCk7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzW194ZmFfb2JqZWN0LiRwb3BQYXJhXSgpOwoKICAgICgwLCBfaHRtbF91dGlscy5maXhEaW1lbnNpb25zKSh0aGlzKTsKICAgIHNldEZpcnN0VW5zcGxpdHRhYmxlKHRoaXMpOwoKICAgIGlmICghKDAsIF9sYXlvdXQuY2hlY2tEaW1lbnNpb25zKSh0aGlzLCBhdmFpbGFibGVTcGFjZSkpIHsKICAgICAgdGhpcy53ID0gc2F2ZWRXOwogICAgICB0aGlzLmggPSBzYXZlZEg7CgogICAgICB0aGlzW194ZmFfb2JqZWN0LiRwb3BQYXJhXSgpOwoKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkZBSUxVUkU7CiAgICB9CgogICAgdW5zZXRGaXJzdFVuc3BsaXR0YWJsZSh0aGlzKTsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJmb250IiwgImRpbWVuc2lvbnMiLCAicG9zaXRpb24iLCAicm90YXRlIiwgImFuY2hvclR5cGUiLCAicHJlc2VuY2UiLCAibWFyZ2luIiwgImhBbGlnbiIpOwogICAgKDAsIF9odG1sX3V0aWxzLnNldE1pbk1heERpbWVuc2lvbnMpKHRoaXMsIHN0eWxlKTsKICAgIGNvbnN0IGNsYXNzTmFtZXMgPSBbInhmYUZpZWxkIl07CgogICAgaWYgKHRoaXMuZm9udCkgewogICAgICBjbGFzc05hbWVzLnB1c2goInhmYUZvbnQiKTsKICAgIH0KCiAgICBpZiAoKDAsIF9odG1sX3V0aWxzLmlzUHJpbnRPbmx5KSh0aGlzKSkgewogICAgICBjbGFzc05hbWVzLnB1c2goInhmYVByaW50T25seSIpOwogICAgfQoKICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7CiAgICAgIHN0eWxlLAogICAgICBpZDogdGhpc1tfeGZhX29iamVjdC4kdWlkXSwKICAgICAgY2xhc3M6IGNsYXNzTmFtZXMKICAgIH07CgogICAgaWYgKHN0eWxlLm1hcmdpbikgewogICAgICBzdHlsZS5wYWRkaW5nID0gc3R5bGUubWFyZ2luOwogICAgICBkZWxldGUgc3R5bGUubWFyZ2luOwogICAgfQoKICAgICgwLCBfaHRtbF91dGlscy5zZXRBY2Nlc3MpKHRoaXMsIGNsYXNzTmFtZXMpOwoKICAgIGlmICh0aGlzLm5hbWUpIHsKICAgICAgYXR0cmlidXRlcy54ZmFOYW1lID0gdGhpcy5uYW1lOwogICAgfQoKICAgIGNvbnN0IGNoaWxkcmVuID0gW107CiAgICBjb25zdCBodG1sID0gewogICAgICBuYW1lOiAiZGl2IiwKICAgICAgYXR0cmlidXRlcywKICAgICAgY2hpbGRyZW4KICAgIH07CiAgICBhcHBseUFzc2lzdCh0aGlzLCBhdHRyaWJ1dGVzKTsKICAgIGNvbnN0IGJvcmRlclN0eWxlID0gdGhpcy5ib3JkZXIgPyB0aGlzLmJvcmRlcltfeGZhX29iamVjdC4kdG9TdHlsZV0oKSA6IG51bGw7CiAgICBjb25zdCBiYm94ID0gKDAsIF9odG1sX3V0aWxzLmNvbXB1dGVCYm94KSh0aGlzLCBodG1sLCBhdmFpbGFibGVTcGFjZSk7CgogICAgY29uc3QgdWkgPSB0aGlzLnVpW194ZmFfb2JqZWN0LiR0b0hUTUxdKCkuaHRtbDsKCiAgICBpZiAoIXVpKSB7CiAgICAgIE9iamVjdC5hc3NpZ24oc3R5bGUsIGJvcmRlclN0eWxlKTsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoKDAsIF9odG1sX3V0aWxzLmNyZWF0ZVdyYXBwZXIpKHRoaXMsIGh0bWwpLCBiYm94KTsKICAgIH0KCiAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kdGFiSW5kZXhdKSB7CiAgICAgIGlmICh1aS5jaGlsZHJlbiAmJiB1aS5jaGlsZHJlblswXSkgewogICAgICAgIHVpLmNoaWxkcmVuWzBdLmF0dHJpYnV0ZXMudGFiaW5kZXggPSB0aGlzW194ZmFfb2JqZWN0LiR0YWJJbmRleF07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdWkuYXR0cmlidXRlcy50YWJpbmRleCA9IHRoaXNbX3hmYV9vYmplY3QuJHRhYkluZGV4XTsKICAgICAgfQogICAgfQoKICAgIGlmICghdWkuYXR0cmlidXRlcy5zdHlsZSkgewogICAgICB1aS5hdHRyaWJ1dGVzLnN0eWxlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIH0KCiAgICBsZXQgYUVsZW1lbnQgPSBudWxsOwoKICAgIGlmICh0aGlzLnVpLmJ1dHRvbikgewogICAgICBpZiAodWkuY2hpbGRyZW4ubGVuZ3RoID09PSAxKSB7CiAgICAgICAgW2FFbGVtZW50XSA9IHVpLmNoaWxkcmVuLnNwbGljZSgwLCAxKTsKICAgICAgfQoKICAgICAgT2JqZWN0LmFzc2lnbih1aS5hdHRyaWJ1dGVzLnN0eWxlLCBib3JkZXJTdHlsZSk7CiAgICB9IGVsc2UgewogICAgICBPYmplY3QuYXNzaWduKHN0eWxlLCBib3JkZXJTdHlsZSk7CiAgICB9CgogICAgY2hpbGRyZW4ucHVzaCh1aSk7CgogICAgaWYgKHRoaXMudmFsdWUpIHsKICAgICAgaWYgKHRoaXMudWkuaW1hZ2VFZGl0KSB7CiAgICAgICAgdWkuY2hpbGRyZW4ucHVzaCh0aGlzLnZhbHVlW194ZmFfb2JqZWN0LiR0b0hUTUxdKCkuaHRtbCk7CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMudWkuYnV0dG9uKSB7CiAgICAgICAgbGV0IHZhbHVlID0gIiI7CgogICAgICAgIGlmICh0aGlzLnZhbHVlLmV4RGF0YSkgewogICAgICAgICAgdmFsdWUgPSB0aGlzLnZhbHVlLmV4RGF0YVtfeGZhX29iamVjdC4kdGV4dF0oKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMudmFsdWUudGV4dCkgewogICAgICAgICAgdmFsdWUgPSB0aGlzLnZhbHVlLnRleHRbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCBodG1sVmFsdWUgPSB0aGlzLnZhbHVlW194ZmFfb2JqZWN0LiR0b0hUTUxdKCkuaHRtbDsKCiAgICAgICAgICBpZiAoaHRtbFZhbHVlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHZhbHVlID0gaHRtbFZhbHVlLmNoaWxkcmVuWzBdLnZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMudWkudGV4dEVkaXQgJiYgdGhpcy52YWx1ZS50ZXh0ICYmIHRoaXMudmFsdWUudGV4dC5tYXhDaGFycykgewogICAgICAgICAgdWkuY2hpbGRyZW5bMF0uYXR0cmlidXRlcy5tYXhMZW5ndGggPSB0aGlzLnZhbHVlLnRleHQubWF4Q2hhcnM7CiAgICAgICAgfQoKICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgIGlmICh0aGlzLnVpLm51bWVyaWNFZGl0KSB7CiAgICAgICAgICAgIHZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7CiAgICAgICAgICAgIHZhbHVlID0gaXNOYU4odmFsdWUpID8gIiIgOiB2YWx1ZS50b1N0cmluZygpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh1aS5jaGlsZHJlblswXS5uYW1lID09PSAidGV4dGFyZWEiKSB7CiAgICAgICAgICAgIHVpLmNoaWxkcmVuWzBdLmF0dHJpYnV0ZXMudGV4dENvbnRlbnQgPSB2YWx1ZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVpLmNoaWxkcmVuWzBdLmF0dHJpYnV0ZXMudmFsdWUgPSB2YWx1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXRoaXMudWkuaW1hZ2VFZGl0ICYmIHVpLmNoaWxkcmVuICYmIHVpLmNoaWxkcmVuWzBdICYmIHRoaXMuaCkgewogICAgICBib3JkZXJEaW1zID0gYm9yZGVyRGltcyB8fCBnZXRCb3JkZXJEaW1zKHRoaXMudWlbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpKTsKICAgICAgbGV0IGNhcHRpb25IZWlnaHQgPSAwOwoKICAgICAgaWYgKHRoaXMuY2FwdGlvbiAmJiBbInRvcCIsICJib3R0b20iXS5pbmNsdWRlcyh0aGlzLmNhcHRpb24ucGxhY2VtZW50KSkgewogICAgICAgIGNhcHRpb25IZWlnaHQgPSB0aGlzLmNhcHRpb24ucmVzZXJ2ZTsKCiAgICAgICAgaWYgKGNhcHRpb25IZWlnaHQgPD0gMCkgewogICAgICAgICAgY2FwdGlvbkhlaWdodCA9IHRoaXMuY2FwdGlvbltfeGZhX29iamVjdC4kZ2V0RXh0cmFdKGF2YWlsYWJsZVNwYWNlKS5oOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgaW5wdXRIZWlnaHQgPSB0aGlzLmggLSBjYXB0aW9uSGVpZ2h0IC0gbWFyZ2luViAtIGJvcmRlckRpbXMuaDsKICAgICAgICB1aS5jaGlsZHJlblswXS5hdHRyaWJ1dGVzLnN0eWxlLmhlaWdodCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKGlucHV0SGVpZ2h0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB1aS5jaGlsZHJlblswXS5hdHRyaWJ1dGVzLnN0eWxlLmhlaWdodCA9ICIxMDAlIjsKICAgICAgfQogICAgfQoKICAgIGlmIChhRWxlbWVudCkgewogICAgICB1aS5jaGlsZHJlbi5wdXNoKGFFbGVtZW50KTsKICAgIH0KCiAgICBpZiAoIWNhcHRpb24pIHsKICAgICAgaWYgKHVpLmF0dHJpYnV0ZXMuY2xhc3MpIHsKICAgICAgICB1aS5hdHRyaWJ1dGVzLmNsYXNzLnB1c2goInhmYUxlZnQiKTsKICAgICAgfQoKICAgICAgdGhpcy53ID0gc2F2ZWRXOwogICAgICB0aGlzLmggPSBzYXZlZEg7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKCgwLCBfaHRtbF91dGlscy5jcmVhdGVXcmFwcGVyKSh0aGlzLCBodG1sKSwgYmJveCk7CiAgICB9CgogICAgaWYgKHRoaXMudWkuYnV0dG9uKSB7CiAgICAgIGlmIChzdHlsZS5wYWRkaW5nKSB7CiAgICAgICAgZGVsZXRlIHN0eWxlLnBhZGRpbmc7CiAgICAgIH0KCiAgICAgIGlmIChjYXB0aW9uLm5hbWUgPT09ICJkaXYiKSB7CiAgICAgICAgY2FwdGlvbi5uYW1lID0gInNwYW4iOwogICAgICB9CgogICAgICB1aS5jaGlsZHJlbi5wdXNoKGNhcHRpb24pOwogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcyhodG1sLCBiYm94KTsKICAgIH0gZWxzZSBpZiAodGhpcy51aS5jaGVja0J1dHRvbikgewogICAgICBjYXB0aW9uLmF0dHJpYnV0ZXMuY2xhc3NbMF0gPSAieGZhQ2FwdGlvbkZvckNoZWNrQnV0dG9uIjsKICAgIH0KCiAgICBpZiAoIXVpLmF0dHJpYnV0ZXMuY2xhc3MpIHsKICAgICAgdWkuYXR0cmlidXRlcy5jbGFzcyA9IFtdOwogICAgfQoKICAgIHVpLmNoaWxkcmVuLnNwbGljZSgwLCAwLCBjYXB0aW9uKTsKCiAgICBzd2l0Y2ggKHRoaXMuY2FwdGlvbi5wbGFjZW1lbnQpIHsKICAgICAgY2FzZSAibGVmdCI6CiAgICAgICAgdWkuYXR0cmlidXRlcy5jbGFzcy5wdXNoKCJ4ZmFMZWZ0Iik7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJyaWdodCI6CiAgICAgICAgdWkuYXR0cmlidXRlcy5jbGFzcy5wdXNoKCJ4ZmFSaWdodCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAidG9wIjoKICAgICAgICB1aS5hdHRyaWJ1dGVzLmNsYXNzLnB1c2goInhmYVRvcCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiYm90dG9tIjoKICAgICAgICB1aS5hdHRyaWJ1dGVzLmNsYXNzLnB1c2goInhmYUJvdHRvbSIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiaW5saW5lIjoKICAgICAgICB1aS5hdHRyaWJ1dGVzLmNsYXNzLnB1c2goInhmYUxlZnQiKTsKICAgICAgICBicmVhazsKICAgIH0KCiAgICB0aGlzLncgPSBzYXZlZFc7CiAgICB0aGlzLmggPSBzYXZlZEg7CiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcygoMCwgX2h0bWxfdXRpbHMuY3JlYXRlV3JhcHBlcikodGhpcywgaHRtbCksIGJib3gpOwogIH0KCn0KCmV4cG9ydHMuRmllbGQgPSBGaWVsZDsKCmNsYXNzIEZpbGwgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZmlsbCIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnByZXNlbmNlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucHJlc2VuY2UsIFsidmlzaWJsZSIsICJoaWRkZW4iLCAiaW5hY3RpdmUiLCAiaW52aXNpYmxlIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuY29sb3IgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5saW5lYXIgPSBudWxsOwogICAgdGhpcy5wYXR0ZXJuID0gbnVsbDsKICAgIHRoaXMucmFkaWFsID0gbnVsbDsKICAgIHRoaXMuc29saWQgPSBudWxsOwogICAgdGhpcy5zdGlwcGxlID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9TdHlsZV0oKSB7CiAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgY29uc3QgZ3JhbmRwYSA9IHBhcmVudFtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IGdncmFuZHBhID0gZ3JhbmRwYVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IHN0eWxlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIGxldCBwcm9wTmFtZSA9ICJjb2xvciI7CiAgICBsZXQgYWx0UHJvcE5hbWUgPSBwcm9wTmFtZTsKCiAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgQm9yZGVyKSB7CiAgICAgIHByb3BOYW1lID0gImJhY2tncm91bmQtY29sb3IiOwogICAgICBhbHRQcm9wTmFtZSA9ICJiYWNrZ3JvdW5kIjsKCiAgICAgIGlmIChnZ3JhbmRwYSBpbnN0YW5jZW9mIFVpKSB7CiAgICAgICAgc3R5bGUuYmFja2dyb3VuZENvbG9yID0gIndoaXRlIjsKICAgICAgfQogICAgfQoKICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBSZWN0YW5nbGUgfHwgcGFyZW50IGluc3RhbmNlb2YgQXJjKSB7CiAgICAgIHByb3BOYW1lID0gYWx0UHJvcE5hbWUgPSAiZmlsbCI7CiAgICAgIHN0eWxlLmZpbGwgPSAid2hpdGUiOwogICAgfQoKICAgIGZvciAoY29uc3QgbmFtZSBvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkgewogICAgICBpZiAobmFtZSA9PT0gImV4dHJhcyIgfHwgbmFtZSA9PT0gImNvbG9yIikgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBvYmogPSB0aGlzW25hbWVdOwoKICAgICAgaWYgKCEob2JqIGluc3RhbmNlb2YgX3hmYV9vYmplY3QuWEZBT2JqZWN0KSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBjb2xvciA9IG9ialtfeGZhX29iamVjdC4kdG9TdHlsZV0odGhpcy5jb2xvcik7CgogICAgICBpZiAoY29sb3IpIHsKICAgICAgICBzdHlsZVtjb2xvci5zdGFydHNXaXRoKCIjIikgPyBwcm9wTmFtZSA6IGFsdFByb3BOYW1lXSA9IGNvbG9yOwogICAgICB9CgogICAgICByZXR1cm4gc3R5bGU7CiAgICB9CgogICAgaWYgKHRoaXMuY29sb3IgJiYgdGhpcy5jb2xvci52YWx1ZSkgewogICAgICBjb25zdCBjb2xvciA9IHRoaXMuY29sb3JbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCk7CgogICAgICBzdHlsZVtjb2xvci5zdGFydHNXaXRoKCIjIikgPyBwcm9wTmFtZSA6IGFsdFByb3BOYW1lXSA9IGNvbG9yOwogICAgfQoKICAgIHJldHVybiBzdHlsZTsKICB9Cgp9CgpjbGFzcyBGaWx0ZXIgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZmlsdGVyIiwgdHJ1ZSk7CiAgICB0aGlzLmFkZFJldm9jYXRpb25JbmZvID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuYWRkUmV2b2NhdGlvbkluZm8sIFsiIiwgInJlcXVpcmVkIiwgIm9wdGlvbmFsIiwgIm5vbmUiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLnZlcnNpb24gPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogdGhpcy52ZXJzaW9uLAogICAgICBkZWZhdWx0VmFsdWU6IDUsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPj0gMSAmJiB4IDw9IDUKICAgIH0pOwogICAgdGhpcy5hcHBlYXJhbmNlRmlsdGVyID0gbnVsbDsKICAgIHRoaXMuY2VydGlmaWNhdGVzID0gbnVsbDsKICAgIHRoaXMuZGlnZXN0TWV0aG9kcyA9IG51bGw7CiAgICB0aGlzLmVuY29kaW5ncyA9IG51bGw7CiAgICB0aGlzLmVuY3J5cHRpb25NZXRob2RzID0gbnVsbDsKICAgIHRoaXMuaGFuZGxlciA9IG51bGw7CiAgICB0aGlzLmxvY2tEb2N1bWVudCA9IG51bGw7CiAgICB0aGlzLm1kcCA9IG51bGw7CiAgICB0aGlzLnJlYXNvbnMgPSBudWxsOwogICAgdGhpcy50aW1lU3RhbXAgPSBudWxsOwogIH0KCn0KCmNsYXNzIEZsb2F0IGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJmbG9hdCIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICBjb25zdCBudW1iZXIgPSBwYXJzZUZsb2F0KHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKSk7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IGlzTmFOKG51bWJlcikgPyBudWxsIDogbnVtYmVyOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICByZXR1cm4gdmFsdWVUb0h0bWwodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gIT09IG51bGwgPyB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50b1N0cmluZygpIDogIiIpOwogIH0KCn0KCmNsYXNzIEZvbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZm9udCIsIHRydWUpOwogICAgdGhpcy5iYXNlbGluZVNoaWZ0ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5iYXNlbGluZVNoaWZ0KTsKICAgIHRoaXMuZm9udEhvcml6b250YWxTY2FsZSA9ICgwLCBfdXRpbHMuZ2V0RmxvYXQpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5mb250SG9yaXpvbnRhbFNjYWxlLAogICAgICBkZWZhdWx0VmFsdWU6IDEwMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAwCiAgICB9KTsKICAgIHRoaXMuZm9udFZlcnRpY2FsU2NhbGUgPSAoMCwgX3V0aWxzLmdldEZsb2F0KSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuZm9udFZlcnRpY2FsU2NhbGUsCiAgICAgIGRlZmF1bHRWYWx1ZTogMTAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAKICAgIH0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmtlcm5pbmdNb2RlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMua2VybmluZ01vZGUsIFsibm9uZSIsICJwYWlyIl0pOwogICAgdGhpcy5sZXR0ZXJTcGFjaW5nID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5sZXR0ZXJTcGFjaW5nLCAiMCIpOwogICAgdGhpcy5saW5lVGhyb3VnaCA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmxpbmVUaHJvdWdoLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEgfHwgeCA9PT0gMgogICAgfSk7CiAgICB0aGlzLmxpbmVUaHJvdWdoUGVyaW9kID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMubGluZVRocm91Z2hQZXJpb2QsIFsiYWxsIiwgIndvcmQiXSk7CiAgICB0aGlzLm92ZXJsaW5lID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMub3ZlcmxpbmUsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMSB8fCB4ID09PSAyCiAgICB9KTsKICAgIHRoaXMub3ZlcmxpbmVQZXJpb2QgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5vdmVybGluZVBlcmlvZCwgWyJhbGwiLCAid29yZCJdKTsKICAgIHRoaXMucG9zdHVyZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnBvc3R1cmUsIFsibm9ybWFsIiwgIml0YWxpYyJdKTsKICAgIHRoaXMuc2l6ZSA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMuc2l6ZSwgIjEwcHQiKTsKICAgIHRoaXMudHlwZWZhY2UgPSBhdHRyaWJ1dGVzLnR5cGVmYWNlIHx8ICJDb3VyaWVyIjsKICAgIHRoaXMudW5kZXJsaW5lID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMudW5kZXJsaW5lLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEgfHwgeCA9PT0gMgogICAgfSk7CiAgICB0aGlzLnVuZGVybGluZVBlcmlvZCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnVuZGVybGluZVBlcmlvZCwgWyJhbGwiLCAid29yZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLndlaWdodCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLndlaWdodCwgWyJub3JtYWwiLCAiYm9sZCJdKTsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMuZmlsbCA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJGNsZWFuXShidWlsZGVyKSB7CiAgICBzdXBlcltfeGZhX29iamVjdC4kY2xlYW5dKGJ1aWxkZXIpOwoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdLnVzZWRUeXBlZmFjZXMuYWRkKHRoaXMudHlwZWZhY2UpOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIHsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJmaWxsIik7CiAgICBjb25zdCBjb2xvciA9IHN0eWxlLmNvbG9yOwoKICAgIGlmIChjb2xvcikgewogICAgICBpZiAoY29sb3IgPT09ICIjMDAwMDAwIikgewogICAgICAgIGRlbGV0ZSBzdHlsZS5jb2xvcjsKICAgICAgfSBlbHNlIGlmICghY29sb3Iuc3RhcnRzV2l0aCgiIyIpKSB7CiAgICAgICAgc3R5bGUuYmFja2dyb3VuZCA9IGNvbG9yOwogICAgICAgIHN0eWxlLmJhY2tncm91bmRDbGlwID0gInRleHQiOwogICAgICAgIHN0eWxlLmNvbG9yID0gInRyYW5zcGFyZW50IjsKICAgICAgfQogICAgfQoKICAgIGlmICh0aGlzLmJhc2VsaW5lU2hpZnQpIHsKICAgICAgc3R5bGUudmVydGljYWxBbGlnbiA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMuYmFzZWxpbmVTaGlmdCk7CiAgICB9CgogICAgc3R5bGUuZm9udEtlcm5pbmcgPSB0aGlzLmtlcm5pbmdNb2RlID09PSAibm9uZSIgPyAibm9uZSIgOiAibm9ybWFsIjsKICAgIHN0eWxlLmxldHRlclNwYWNpbmcgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLmxldHRlclNwYWNpbmcpOwoKICAgIGlmICh0aGlzLmxpbmVUaHJvdWdoICE9PSAwKSB7CiAgICAgIHN0eWxlLnRleHREZWNvcmF0aW9uID0gImxpbmUtdGhyb3VnaCI7CgogICAgICBpZiAodGhpcy5saW5lVGhyb3VnaCA9PT0gMikgewogICAgICAgIHN0eWxlLnRleHREZWNvcmF0aW9uU3R5bGUgPSAiZG91YmxlIjsKICAgICAgfQogICAgfQoKICAgIGlmICh0aGlzLm92ZXJsaW5lICE9PSAwKSB7CiAgICAgIHN0eWxlLnRleHREZWNvcmF0aW9uID0gIm92ZXJsaW5lIjsKCiAgICAgIGlmICh0aGlzLm92ZXJsaW5lID09PSAyKSB7CiAgICAgICAgc3R5bGUudGV4dERlY29yYXRpb25TdHlsZSA9ICJkb3VibGUiOwogICAgICB9CiAgICB9CgogICAgc3R5bGUuZm9udFN0eWxlID0gdGhpcy5wb3N0dXJlOwogICAgc3R5bGUuZm9udFNpemUgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSgwLjk5ICogdGhpcy5zaXplKTsKICAgICgwLCBfaHRtbF91dGlscy5zZXRGb250RmFtaWx5KSh0aGlzLCB0aGlzLCB0aGlzW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXS5mb250RmluZGVyLCBzdHlsZSk7CgogICAgaWYgKHRoaXMudW5kZXJsaW5lICE9PSAwKSB7CiAgICAgIHN0eWxlLnRleHREZWNvcmF0aW9uID0gInVuZGVybGluZSI7CgogICAgICBpZiAodGhpcy51bmRlcmxpbmUgPT09IDIpIHsKICAgICAgICBzdHlsZS50ZXh0RGVjb3JhdGlvblN0eWxlID0gImRvdWJsZSI7CiAgICAgIH0KICAgIH0KCiAgICBzdHlsZS5mb250V2VpZ2h0ID0gdGhpcy53ZWlnaHQ7CiAgICByZXR1cm4gc3R5bGU7CiAgfQoKfQoKY2xhc3MgRm9ybWF0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImZvcm1hdCIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5waWN0dXJlID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBIYW5kbGVyIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImhhbmRsZXIiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgSHlwaGVuYXRpb24gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiaHlwaGVuYXRpb24iKTsKICAgIHRoaXMuZXhjbHVkZUFsbENhcHMgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5leGNsdWRlQWxsQ2FwcywKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMuZXhjbHVkZUluaXRpYWxDYXAgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5leGNsdWRlSW5pdGlhbENhcCwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMuaHlwaGVuYXRlID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuaHlwaGVuYXRlLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnB1c2hDaGFyYWN0ZXJDb3VudCA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnB1c2hDaGFyYWN0ZXJDb3VudCwKICAgICAgZGVmYXVsdFZhbHVlOiAzLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAKICAgIH0pOwogICAgdGhpcy5yZW1haW5DaGFyYWN0ZXJDb3VudCA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnJlbWFpbkNoYXJhY3RlckNvdW50LAogICAgICBkZWZhdWx0VmFsdWU6IDMsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPj0gMAogICAgfSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy53b3JkQ2hhcmFjdGVyQ291bnQgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy53b3JkQ2hhcmFjdGVyQ291bnQsCiAgICAgIGRlZmF1bHRWYWx1ZTogNywKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAwCiAgICB9KTsKICB9Cgp9CgpjbGFzcyBJbWFnZSBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJpbWFnZSIpOwogICAgdGhpcy5hc3BlY3QgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5hc3BlY3QsIFsiZml0IiwgImFjdHVhbCIsICJoZWlnaHQiLCAibm9uZSIsICJ3aWR0aCJdKTsKICAgIHRoaXMuY29udGVudFR5cGUgPSBhdHRyaWJ1dGVzLmNvbnRlbnRUeXBlIHx8ICIiOwogICAgdGhpcy5ocmVmID0gYXR0cmlidXRlcy5ocmVmIHx8ICIiOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnRyYW5zZmVyRW5jb2RpbmcgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50cmFuc2ZlckVuY29kaW5nLCBbImJhc2U2NCIsICJub25lIiwgInBhY2thZ2UiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKCkgewogICAgaWYgKHRoaXMuY29udGVudFR5cGUgJiYgIU1JTUVTLmhhcyh0aGlzLmNvbnRlbnRUeXBlLnRvTG93ZXJDYXNlKCkpKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICAgIH0KCiAgICBsZXQgYnVmZmVyID0gdGhpc1tfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0uaW1hZ2VzICYmIHRoaXNbX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdLmltYWdlcy5nZXQodGhpcy5ocmVmKTsKCiAgICBpZiAoIWJ1ZmZlciAmJiAodGhpcy5ocmVmIHx8ICF0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSkpIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgfQoKICAgIGlmICghYnVmZmVyICYmIHRoaXMudHJhbnNmZXJFbmNvZGluZyA9PT0gImJhc2U2NCIpIHsKICAgICAgYnVmZmVyID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGF0b2IodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0pKTsKICAgIH0KCiAgICBpZiAoIWJ1ZmZlcikgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgICB9CgogICAgaWYgKCF0aGlzLmNvbnRlbnRUeXBlKSB7CiAgICAgIGZvciAoY29uc3QgW2hlYWRlciwgdHlwZV0gb2YgSU1BR0VTX0hFQURFUlMpIHsKICAgICAgICBpZiAoYnVmZmVyLmxlbmd0aCA+IGhlYWRlci5sZW5ndGggJiYgaGVhZGVyLmV2ZXJ5KCh4LCBpKSA9PiB4ID09PSBidWZmZXJbaV0pKSB7CiAgICAgICAgICB0aGlzLmNvbnRlbnRUeXBlID0gdHlwZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmNvbnRlbnRUeXBlKSB7CiAgICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgICB9CiAgICB9CgogICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtidWZmZXJdLCB7CiAgICAgIHR5cGU6IHRoaXMuY29udGVudFR5cGUKICAgIH0pOwogICAgbGV0IHN0eWxlOwoKICAgIHN3aXRjaCAodGhpcy5hc3BlY3QpIHsKICAgICAgY2FzZSAiZml0IjoKICAgICAgY2FzZSAiYWN0dWFsIjoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImhlaWdodCI6CiAgICAgICAgc3R5bGUgPSB7CiAgICAgICAgICBoZWlnaHQ6ICIxMDAlIiwKICAgICAgICAgIG9iamVjdEZpdDogImZpbGwiCiAgICAgICAgfTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgIm5vbmUiOgogICAgICAgIHN0eWxlID0gewogICAgICAgICAgd2lkdGg6ICIxMDAlIiwKICAgICAgICAgIGhlaWdodDogIjEwMCUiLAogICAgICAgICAgb2JqZWN0Rml0OiAiZmlsbCIKICAgICAgICB9OwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAid2lkdGgiOgogICAgICAgIHN0eWxlID0gewogICAgICAgICAgd2lkdGg6ICIxMDAlIiwKICAgICAgICAgIG9iamVjdEZpdDogImZpbGwiCiAgICAgICAgfTsKICAgICAgICBicmVhazsKICAgIH0KCiAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICBuYW1lOiAiaW1nIiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIGNsYXNzOiBbInhmYUltYWdlIl0sCiAgICAgICAgc3R5bGUsCiAgICAgICAgc3JjOiBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpLAogICAgICAgIGFsdDogcGFyZW50ID8gYXJpYUxhYmVsKHBhcmVudFtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpKSA6IG51bGwKICAgICAgfQogICAgfSk7CiAgfQoKfQoKY2xhc3MgSW1hZ2VFZGl0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImltYWdlRWRpdCIsIHRydWUpOwogICAgdGhpcy5kYXRhID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuZGF0YSwgWyJsaW5rIiwgImVtYmVkIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5ib3JkZXIgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBpZiAodGhpcy5kYXRhID09PSAiZW1iZWQiKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgICBuYW1lOiAiZGl2IiwKICAgICAgICBjaGlsZHJlbjogW10sCiAgICAgICAgYXR0cmlidXRlczoge30KICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogIH0KCn0KCmNsYXNzIEludGVnZXIgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImludGVnZXIiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgY29uc3QgbnVtYmVyID0gcGFyc2VJbnQodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpLCAxMCk7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IGlzTmFOKG51bWJlcikgPyBudWxsIDogbnVtYmVyOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICByZXR1cm4gdmFsdWVUb0h0bWwodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gIT09IG51bGwgPyB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50b1N0cmluZygpIDogIiIpOwogIH0KCn0KCmNsYXNzIElzc3VlcnMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiaXNzdWVycyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuY2VydGlmaWNhdGUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBJdGVtcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJpdGVtcyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnByZXNlbmNlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucHJlc2VuY2UsIFsidmlzaWJsZSIsICJoaWRkZW4iLCAiaW5hY3RpdmUiLCAiaW52aXNpYmxlIl0pOwogICAgdGhpcy5yZWYgPSBhdHRyaWJ1dGVzLnJlZiB8fCAiIjsKICAgIHRoaXMuc2F2ZSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnNhdmUsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMQogICAgfSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5ib29sZWFuID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRhdGUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGF0ZVRpbWUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGVjaW1hbCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leERhdGEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZmxvYXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuaW1hZ2UgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuaW50ZWdlciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy50ZXh0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRpbWUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXSgpIHsKICAgIGNvbnN0IG91dHB1dCA9IFtdOwoKICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpc1tfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5dKCkpIHsKICAgICAgb3V0cHV0LnB1c2goY2hpbGRbX3hmYV9vYmplY3QuJHRleHRdKCkpOwogICAgfQoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKG91dHB1dCk7CiAgfQoKfQoKZXhwb3J0cy5JdGVtcyA9IEl0ZW1zOwoKY2xhc3MgS2VlcCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJrZWVwIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIGNvbnN0IG9wdGlvbnMgPSBbIm5vbmUiLCAiY29udGVudEFyZWEiLCAicGFnZUFyZWEiXTsKICAgIHRoaXMuaW50YWN0ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaW50YWN0LCBvcHRpb25zKTsKICAgIHRoaXMubmV4dCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm5leHQsIG9wdGlvbnMpOwogICAgdGhpcy5wcmV2aW91cyA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnByZXZpb3VzLCBvcHRpb25zKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgS2V5VXNhZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAia2V5VXNhZ2UiKTsKICAgIGNvbnN0IG9wdGlvbnMgPSBbIiIsICJ5ZXMiLCAibm8iXTsKICAgIHRoaXMuY3JsU2lnbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmNybFNpZ24sIG9wdGlvbnMpOwogICAgdGhpcy5kYXRhRW5jaXBoZXJtZW50ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuZGF0YUVuY2lwaGVybWVudCwgb3B0aW9ucyk7CiAgICB0aGlzLmRlY2lwaGVyT25seSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmRlY2lwaGVyT25seSwgb3B0aW9ucyk7CiAgICB0aGlzLmRpZ2l0YWxTaWduYXR1cmUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5kaWdpdGFsU2lnbmF0dXJlLCBvcHRpb25zKTsKICAgIHRoaXMuZW5jaXBoZXJPbmx5ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuZW5jaXBoZXJPbmx5LCBvcHRpb25zKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5rZXlBZ3JlZW1lbnQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5rZXlBZ3JlZW1lbnQsIG9wdGlvbnMpOwogICAgdGhpcy5rZXlDZXJ0U2lnbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmtleUNlcnRTaWduLCBvcHRpb25zKTsKICAgIHRoaXMua2V5RW5jaXBoZXJtZW50ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMua2V5RW5jaXBoZXJtZW50LCBvcHRpb25zKTsKICAgIHRoaXMubm9uUmVwdWRpYXRpb24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5ub25SZXB1ZGlhdGlvbiwgb3B0aW9ucyk7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBMaW5lIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImxpbmUiLCB0cnVlKTsKICAgIHRoaXMuaGFuZCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmhhbmQsIFsiZXZlbiIsICJsZWZ0IiwgInJpZ2h0Il0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnNsb3BlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuc2xvcGUsIFsiXFwiLCAiLyJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmVkZ2UgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKCkgewogICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgY29uc3QgZWRnZSA9IHRoaXMuZWRnZSB8fCBuZXcgRWRnZSh7fSk7CgogICAgY29uc3QgZWRnZVN0eWxlID0gZWRnZVtfeGZhX29iamVjdC4kdG9TdHlsZV0oKTsKCiAgICBjb25zdCBzdHlsZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICBjb25zdCB0aGlja25lc3MgPSBlZGdlLnByZXNlbmNlID09PSAidmlzaWJsZSIgPyBlZGdlLnRoaWNrbmVzcyA6IDA7CiAgICBzdHlsZS5zdHJva2VXaWR0aCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaWNrbmVzcyk7CiAgICBzdHlsZS5zdHJva2UgPSBlZGdlU3R5bGUuY29sb3I7CiAgICBsZXQgeDEsIHkxLCB4MiwgeTI7CiAgICBsZXQgd2lkdGggPSAiMTAwJSI7CiAgICBsZXQgaGVpZ2h0ID0gIjEwMCUiOwoKICAgIGlmIChwYXJlbnQudyA8PSB0aGlja25lc3MpIHsKICAgICAgW3gxLCB5MSwgeDIsIHkyXSA9IFsiNTAlIiwgMCwgIjUwJSIsICIxMDAlIl07CiAgICAgIHdpZHRoID0gc3R5bGUuc3Ryb2tlV2lkdGg7CiAgICB9IGVsc2UgaWYgKHBhcmVudC5oIDw9IHRoaWNrbmVzcykgewogICAgICBbeDEsIHkxLCB4MiwgeTJdID0gWzAsICI1MCUiLCAiMTAwJSIsICI1MCUiXTsKICAgICAgaGVpZ2h0ID0gc3R5bGUuc3Ryb2tlV2lkdGg7CiAgICB9IGVsc2UgewogICAgICBpZiAodGhpcy5zbG9wZSA9PT0gIlxcIikgewogICAgICAgIFt4MSwgeTEsIHgyLCB5Ml0gPSBbMCwgMCwgIjEwMCUiLCAiMTAwJSJdOwogICAgICB9IGVsc2UgewogICAgICAgIFt4MSwgeTEsIHgyLCB5Ml0gPSBbMCwgIjEwMCUiLCAiMTAwJSIsIDBdOwogICAgICB9CiAgICB9CgogICAgY29uc3QgbGluZSA9IHsKICAgICAgbmFtZTogImxpbmUiLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgeG1sbnM6IFNWR19OUywKICAgICAgICB4MSwKICAgICAgICB5MSwKICAgICAgICB4MiwKICAgICAgICB5MiwKICAgICAgICBzdHlsZQogICAgICB9CiAgICB9OwogICAgY29uc3Qgc3ZnID0gewogICAgICBuYW1lOiAic3ZnIiwKICAgICAgY2hpbGRyZW46IFtsaW5lXSwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIHhtbG5zOiBTVkdfTlMsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICBvdmVyZmxvdzogInZpc2libGUiCiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIGlmIChoYXNNYXJnaW4ocGFyZW50KSkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgICAgbmFtZTogImRpdiIsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgc3R5bGU6IHsKICAgICAgICAgICAgZGlzcGxheTogImlubGluZSIsCiAgICAgICAgICAgIHdpZHRoOiAiMTAwJSIsCiAgICAgICAgICAgIGhlaWdodDogIjEwMCUiCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjaGlsZHJlbjogW3N2Z10KICAgICAgfSk7CiAgICB9CgogICAgc3ZnLmF0dHJpYnV0ZXMuc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiOwogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3Moc3ZnKTsKICB9Cgp9CgpjbGFzcyBMaW5lYXIgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAibGluZWFyIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnR5cGUsIFsidG9SaWdodCIsICJ0b0JvdHRvbSIsICJ0b0xlZnQiLCAidG9Ub3AiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5jb2xvciA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvU3R5bGVdKHN0YXJ0Q29sb3IpIHsKICAgIHN0YXJ0Q29sb3IgPSBzdGFydENvbG9yID8gc3RhcnRDb2xvcltfeGZhX29iamVjdC4kdG9TdHlsZV0oKSA6ICIjRkZGRkZGIjsKICAgIGNvbnN0IHRyYW5zZiA9IHRoaXMudHlwZS5yZXBsYWNlKC8oW1JCTFRdKS8sICIgJDEiKS50b0xvd2VyQ2FzZSgpOwogICAgY29uc3QgZW5kQ29sb3IgPSB0aGlzLmNvbG9yID8gdGhpcy5jb2xvcltfeGZhX29iamVjdC4kdG9TdHlsZV0oKSA6ICIjMDAwMDAwIjsKICAgIHJldHVybiBgbGluZWFyLWdyYWRpZW50KCR7dHJhbnNmfSwgJHtzdGFydENvbG9yfSwgJHtlbmRDb2xvcn0pYDsKICB9Cgp9CgpjbGFzcyBMb2NrRG9jdW1lbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImxvY2tEb2N1bWVudCIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0sIFsiYXV0byIsICIwIiwgIjEiXSk7CiAgfQoKfQoKY2xhc3MgTWFuaWZlc3QgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAibWFuaWZlc3QiLCB0cnVlKTsKICAgIHRoaXMuYWN0aW9uID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuYWN0aW9uLCBbImluY2x1ZGUiLCAiYWxsIiwgImV4Y2x1ZGUiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLnJlZiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIE1hcmdpbiBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJtYXJnaW4iLCB0cnVlKTsKICAgIHRoaXMuYm90dG9tSW5zZXQgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLmJvdHRvbUluc2V0LCAiMCIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmxlZnRJbnNldCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubGVmdEluc2V0LCAiMCIpOwogICAgdGhpcy5yaWdodEluc2V0ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5yaWdodEluc2V0LCAiMCIpOwogICAgdGhpcy50b3BJbnNldCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMudG9wSW5zZXQsICIwIik7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1hcmdpbjogKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy50b3BJbnNldCkgKyAiICIgKyAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLnJpZ2h0SW5zZXQpICsgIiAiICsgKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5ib3R0b21JbnNldCkgKyAiICIgKyAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLmxlZnRJbnNldCkKICAgIH07CiAgfQoKfQoKY2xhc3MgTWRwIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgIm1kcCIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnBlcm1pc3Npb25zID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMucGVybWlzc2lvbnMsCiAgICAgIGRlZmF1bHRWYWx1ZTogMiwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMSB8fCB4ID09PSAzCiAgICB9KTsKICAgIHRoaXMuc2lnbmF0dXJlVHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnNpZ25hdHVyZVR5cGUsIFsiZmlsbGVyIiwgImF1dGhvciJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgTWVkaXVtIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgIm1lZGl1bSIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmltYWdpbmdCQm94ID0gKDAsIF91dGlscy5nZXRCQm94KShhdHRyaWJ1dGVzLmltYWdpbmdCQm94KTsKICAgIHRoaXMubG9uZyA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubG9uZyk7CiAgICB0aGlzLm9yaWVudGF0aW9uID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMub3JpZW50YXRpb24sIFsicG9ydHJhaXQiLCAibGFuZHNjYXBlIl0pOwogICAgdGhpcy5zaG9ydCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMuc2hvcnQpOwogICAgdGhpcy5zdG9jayA9IGF0dHJpYnV0ZXMuc3RvY2sgfHwgIiI7CiAgICB0aGlzLnRyYXlJbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnRyYXlJbiwgWyJhdXRvIiwgImRlbGVnYXRlIiwgInBhZ2VGcm9udCJdKTsKICAgIHRoaXMudHJheU91dCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnRyYXlPdXQsIFsiYXV0byIsICJkZWxlZ2F0ZSJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgTWVzc2FnZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJtZXNzYWdlIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLnRleHQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBOdW1lcmljRWRpdCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJudW1lcmljRWRpdCIsIHRydWUpOwogICAgdGhpcy5oU2Nyb2xsUG9saWN5ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaFNjcm9sbFBvbGljeSwgWyJhdXRvIiwgIm9mZiIsICJvbiJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYm9yZGVyID0gbnVsbDsKICAgIHRoaXMuY29tYiA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLm1hcmdpbiA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJib3JkZXIiLCAiZm9udCIsICJtYXJnaW4iKTsKCiAgICBjb25zdCBmaWVsZCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IGh0bWwgPSB7CiAgICAgIG5hbWU6ICJpbnB1dCIsCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICB0eXBlOiAidGV4dCIsCiAgICAgICAgZmllbGRJZDogZmllbGRbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgICAgZGF0YUlkOiBmaWVsZFtfeGZhX29iamVjdC4kZGF0YV0gJiYgZmllbGRbX3hmYV9vYmplY3QuJGRhdGFdW194ZmFfb2JqZWN0LiR1aWRdIHx8IGZpZWxkW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICAgIGNsYXNzOiBbInhmYVRleHRmaWVsZCJdLAogICAgICAgIHN0eWxlLAogICAgICAgICJhcmlhLWxhYmVsIjogYXJpYUxhYmVsKGZpZWxkKSwKICAgICAgICAiYXJpYS1yZXF1aXJlZCI6IGZhbHNlCiAgICAgIH0KICAgIH07CgogICAgaWYgKGlzUmVxdWlyZWQoZmllbGQpKSB7CiAgICAgIGh0bWwuYXR0cmlidXRlc1siYXJpYS1yZXF1aXJlZCJdID0gdHJ1ZTsKICAgICAgaHRtbC5hdHRyaWJ1dGVzLnJlcXVpcmVkID0gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgIG5hbWU6ICJsYWJlbCIsCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBjbGFzczogWyJ4ZmFMYWJlbCJdCiAgICAgIH0sCiAgICAgIGNoaWxkcmVuOiBbaHRtbF0KICAgIH0pOwogIH0KCn0KCmNsYXNzIE9jY3VyIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgIm9jY3VyIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMuaW5pdGlhbCA9IGF0dHJpYnV0ZXMuaW5pdGlhbCAhPT0gIiIgPyAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5pbml0aWFsLAogICAgICBkZWZhdWx0VmFsdWU6ICIiLAogICAgICB2YWxpZGF0ZTogeCA9PiB0cnVlCiAgICB9KSA6ICIiOwogICAgdGhpcy5tYXggPSBhdHRyaWJ1dGVzLm1heCAhPT0gIiIgPyAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5tYXgsCiAgICAgIGRlZmF1bHRWYWx1ZTogMSwKICAgICAgdmFsaWRhdGU6IHggPT4gdHJ1ZQogICAgfSkgOiAiIjsKICAgIHRoaXMubWluID0gYXR0cmlidXRlcy5taW4gIT09ICIiID8gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMubWluLAogICAgICBkZWZhdWx0VmFsdWU6IDEsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHRydWUKICAgIH0pIDogIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiRjbGVhbl0oKSB7CiAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgY29uc3Qgb3JpZ2luYWxNaW4gPSB0aGlzLm1pbjsKCiAgICBpZiAodGhpcy5taW4gPT09ICIiKSB7CiAgICAgIHRoaXMubWluID0gcGFyZW50IGluc3RhbmNlb2YgUGFnZUFyZWEgfHwgcGFyZW50IGluc3RhbmNlb2YgUGFnZVNldCA/IDAgOiAxOwogICAgfQoKICAgIGlmICh0aGlzLm1heCA9PT0gIiIpIHsKICAgICAgaWYgKG9yaWdpbmFsTWluID09PSAiIikgewogICAgICAgIHRoaXMubWF4ID0gcGFyZW50IGluc3RhbmNlb2YgUGFnZUFyZWEgfHwgcGFyZW50IGluc3RhbmNlb2YgUGFnZVNldCA/IC0xIDogMTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLm1heCA9IHRoaXMubWluOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMubWF4ICE9PSAtMSAmJiB0aGlzLm1heCA8IHRoaXMubWluKSB7CiAgICAgIHRoaXMubWF4ID0gdGhpcy5taW47CiAgICB9CgogICAgaWYgKHRoaXMuaW5pdGlhbCA9PT0gIiIpIHsKICAgICAgdGhpcy5pbml0aWFsID0gcGFyZW50IGluc3RhbmNlb2YgVGVtcGxhdGUgPyAxIDogdGhpcy5taW47CiAgICB9CiAgfQoKfQoKY2xhc3MgT2lkIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgIm9pZCIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIE9pZHMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAib2lkcyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMub2lkID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgT3ZlcmZsb3cgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAib3ZlcmZsb3ciKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5sZWFkZXIgPSBhdHRyaWJ1dGVzLmxlYWRlciB8fCAiIjsKICAgIHRoaXMudGFyZ2V0ID0gYXR0cmlidXRlcy50YXJnZXQgfHwgIiI7CiAgICB0aGlzLnRyYWlsZXIgPSBhdHRyaWJ1dGVzLnRyYWlsZXIgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCiAgW194ZmFfb2JqZWN0LiRnZXRFeHRyYV0oKSB7CiAgICBpZiAoIXRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSkgewogICAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgICBjb25zdCByb290ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpOwoKICAgICAgY29uc3QgdGFyZ2V0ID0gcm9vdFtfeGZhX29iamVjdC4kc2VhcmNoTm9kZV0odGhpcy50YXJnZXQsIHBhcmVudCk7CgogICAgICBjb25zdCBsZWFkZXIgPSByb290W194ZmFfb2JqZWN0LiRzZWFyY2hOb2RlXSh0aGlzLmxlYWRlciwgcGFyZW50KTsKCiAgICAgIGNvbnN0IHRyYWlsZXIgPSByb290W194ZmFfb2JqZWN0LiRzZWFyY2hOb2RlXSh0aGlzLnRyYWlsZXIsIHBhcmVudCk7CgogICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSB7CiAgICAgICAgdGFyZ2V0OiB0YXJnZXQgJiYgdGFyZ2V0WzBdIHx8IG51bGwsCiAgICAgICAgbGVhZGVyOiBsZWFkZXIgJiYgbGVhZGVyWzBdIHx8IG51bGwsCiAgICAgICAgdHJhaWxlcjogdHJhaWxlciAmJiB0cmFpbGVyWzBdIHx8IG51bGwsCiAgICAgICAgYWRkTGVhZGVyOiBmYWxzZSwKICAgICAgICBhZGRUcmFpbGVyOiBmYWxzZQogICAgICB9OwogICAgfQoKICAgIHJldHVybiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV07CiAgfQoKfQoKY2xhc3MgUGFnZUFyZWEgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAicGFnZUFyZWEiLCB0cnVlKTsKICAgIHRoaXMuYmxhbmtPck5vdEJsYW5rID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuYmxhbmtPck5vdEJsYW5rLCBbImFueSIsICJibGFuayIsICJub3RCbGFuayJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5pbml0aWFsTnVtYmVyID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuaW5pdGlhbE51bWJlciwKICAgICAgZGVmYXVsdFZhbHVlOiAxLAogICAgICB2YWxpZGF0ZTogeCA9PiB0cnVlCiAgICB9KTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMubnVtYmVyZWQgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5udW1iZXJlZCwKICAgICAgZGVmYXVsdFZhbHVlOiAxLAogICAgICB2YWxpZGF0ZTogeCA9PiB0cnVlCiAgICB9KTsKICAgIHRoaXMub2RkT3JFdmVuID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMub2RkT3JFdmVuLCBbImFueSIsICJldmVuIiwgIm9kZCJdKTsKICAgIHRoaXMucGFnZVBvc2l0aW9uID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucGFnZVBvc2l0aW9uLCBbImFueSIsICJmaXJzdCIsICJsYXN0IiwgIm9ubHkiLCAicmVzdCJdKTsKICAgIHRoaXMucmVsZXZhbnQgPSAoMCwgX3V0aWxzLmdldFJlbGV2YW50KShhdHRyaWJ1dGVzLnJlbGV2YW50KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmRlc2MgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5tZWRpdW0gPSBudWxsOwogICAgdGhpcy5vY2N1ciA9IG51bGw7CiAgICB0aGlzLmFyZWEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuY29udGVudEFyZWEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZHJhdyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leGNsR3JvdXAgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZmllbGQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc3ViZm9ybSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRpc1VzYWJsZV0oKSB7CiAgICBpZiAoIXRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSkgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSB7CiAgICAgICAgbnVtYmVyT2ZVc2U6IDAKICAgICAgfTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuICF0aGlzLm9jY3VyIHx8IHRoaXMub2NjdXIubWF4ID09PSAtMSB8fCB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVyT2ZVc2UgPCB0aGlzLm9jY3VyLm1heDsKICB9CgogIFtfeGZhX29iamVjdC4kY2xlYW5QYWdlXSgpIHsKICAgIGRlbGV0ZSB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV07CiAgfQoKICBbX3hmYV9vYmplY3QuJGdldE5leHRQYWdlXSgpIHsKICAgIGlmICghdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9IHsKICAgICAgICBudW1iZXJPZlVzZTogMAogICAgICB9OwogICAgfQoKICAgIGNvbnN0IHBhcmVudCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBpZiAocGFyZW50LnJlbGF0aW9uID09PSAib3JkZXJlZE9jY3VycmVuY2UiKSB7CiAgICAgIGlmICh0aGlzW194ZmFfb2JqZWN0LiRpc1VzYWJsZV0oKSkgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5udW1iZXJPZlVzZSArPSAxOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHBhcmVudFtfeGZhX29iamVjdC4kZ2V0TmV4dFBhZ2VdKCk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGdldEF2YWlsYWJsZVNwYWNlXSgpIHsKICAgIHJldHVybiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uc3BhY2UgfHwgewogICAgICB3aWR0aDogMCwKICAgICAgaGVpZ2h0OiAwCiAgICB9OwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKCkgewogICAgaWYgKCF0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0pIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gewogICAgICAgIG51bWJlck9mVXNlOiAxCiAgICAgIH07CiAgICB9CgogICAgY29uc3QgY2hpbGRyZW4gPSBbXTsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5jaGlsZHJlbiA9IGNoaWxkcmVuOwogICAgY29uc3Qgc3R5bGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGlmICh0aGlzLm1lZGl1bSAmJiB0aGlzLm1lZGl1bS5zaG9ydCAmJiB0aGlzLm1lZGl1bS5sb25nKSB7CiAgICAgIHN0eWxlLndpZHRoID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5tZWRpdW0uc2hvcnQpOwogICAgICBzdHlsZS5oZWlnaHQgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLm1lZGl1bS5sb25nKTsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLnNwYWNlID0gewogICAgICAgIHdpZHRoOiB0aGlzLm1lZGl1bS5zaG9ydCwKICAgICAgICBoZWlnaHQ6IHRoaXMubWVkaXVtLmxvbmcKICAgICAgfTsKCiAgICAgIGlmICh0aGlzLm1lZGl1bS5vcmllbnRhdGlvbiA9PT0gImxhbmRzY2FwZSIpIHsKICAgICAgICBjb25zdCB4ID0gc3R5bGUud2lkdGg7CiAgICAgICAgc3R5bGUud2lkdGggPSBzdHlsZS5oZWlnaHQ7CiAgICAgICAgc3R5bGUuaGVpZ2h0ID0geDsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uc3BhY2UgPSB7CiAgICAgICAgICB3aWR0aDogdGhpcy5tZWRpdW0ubG9uZywKICAgICAgICAgIGhlaWdodDogdGhpcy5tZWRpdW0uc2hvcnQKICAgICAgICB9OwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAoMCwgX3V0aWwud2FybikoIlhGQSAtIE5vIG1lZGl1bSBzcGVjaWZpZWQgaW4gcGFnZUFyZWE6IHBsZWFzZSBmaWxlIGEgYnVnLiIpOwogICAgfQoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNoaWxkcmVuVG9IVE1MXSh7CiAgICAgIGZpbHRlcjogbmV3IFNldChbImFyZWEiLCAiZHJhdyIsICJmaWVsZCIsICJzdWJmb3JtIl0pLAogICAgICBpbmNsdWRlOiB0cnVlCiAgICB9KTsKCiAgICB0aGlzW194ZmFfb2JqZWN0LiRjaGlsZHJlblRvSFRNTF0oewogICAgICBmaWx0ZXI6IG5ldyBTZXQoWyJjb250ZW50QXJlYSJdKSwKICAgICAgaW5jbHVkZTogdHJ1ZQogICAgfSk7CgogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICBuYW1lOiAiZGl2IiwKICAgICAgY2hpbGRyZW4sCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBjbGFzczogWyJ4ZmFQYWdlIl0sCiAgICAgICAgaWQ6IHRoaXNbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgICAgc3R5bGUsCiAgICAgICAgeGZhTmFtZTogdGhpcy5uYW1lCiAgICAgIH0KICAgIH0pOwogIH0KCn0KCmNsYXNzIFBhZ2VTZXQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAicGFnZVNldCIsIHRydWUpOwogICAgdGhpcy5kdXBsZXhJbXBvc2l0aW9uID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuZHVwbGV4SW1wb3NpdGlvbiwgWyJsb25nRWRnZSIsICJzaG9ydEVkZ2UiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucmVsYXRpb24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5yZWxhdGlvbiwgWyJvcmRlcmVkT2NjdXJyZW5jZSIsICJkdXBsZXhQYWdpbmF0ZWQiLCAic2ltcGxleFBhZ2luYXRlZCJdKTsKICAgIHRoaXMucmVsZXZhbnQgPSAoMCwgX3V0aWxzLmdldFJlbGV2YW50KShhdHRyaWJ1dGVzLnJlbGV2YW50KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLm9jY3VyID0gbnVsbDsKICAgIHRoaXMucGFnZUFyZWEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucGFnZVNldCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRjbGVhblBhZ2VdKCkgewogICAgZm9yIChjb25zdCBwYWdlIG9mIHRoaXMucGFnZUFyZWEuY2hpbGRyZW4pIHsKICAgICAgcGFnZVtfeGZhX29iamVjdC4kY2xlYW5QYWdlXSgpOwogICAgfQoKICAgIGZvciAoY29uc3QgcGFnZSBvZiB0aGlzLnBhZ2VTZXQuY2hpbGRyZW4pIHsKICAgICAgcGFnZVtfeGZhX29iamVjdC4kY2xlYW5QYWdlXSgpOwogICAgfQogIH0KCiAgW194ZmFfb2JqZWN0LiRpc1VzYWJsZV0oKSB7CiAgICByZXR1cm4gIXRoaXMub2NjdXIgfHwgdGhpcy5vY2N1ci5tYXggPT09IC0xIHx8IHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5udW1iZXJPZlVzZSA8IHRoaXMub2NjdXIubWF4OwogIH0KCiAgW194ZmFfb2JqZWN0LiRnZXROZXh0UGFnZV0oKSB7CiAgICBpZiAoIXRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSkgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSB7CiAgICAgICAgbnVtYmVyT2ZVc2U6IDEsCiAgICAgICAgcGFnZUluZGV4OiAtMSwKICAgICAgICBwYWdlU2V0SW5kZXg6IC0xCiAgICAgIH07CiAgICB9CgogICAgaWYgKHRoaXMucmVsYXRpb24gPT09ICJvcmRlcmVkT2NjdXJyZW5jZSIpIHsKICAgICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5wYWdlSW5kZXggKyAxIDwgdGhpcy5wYWdlQXJlYS5jaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ucGFnZUluZGV4ICs9IDE7CiAgICAgICAgY29uc3QgcGFnZUFyZWEgPSB0aGlzLnBhZ2VBcmVhLmNoaWxkcmVuW3RoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5wYWdlSW5kZXhdOwogICAgICAgIHJldHVybiBwYWdlQXJlYVtfeGZhX29iamVjdC4kZ2V0TmV4dFBhZ2VdKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ucGFnZVNldEluZGV4ICsgMSA8IHRoaXMucGFnZVNldC5jaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ucGFnZVNldEluZGV4ICs9IDE7CiAgICAgICAgcmV0dXJuIHRoaXMucGFnZVNldC5jaGlsZHJlblt0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ucGFnZVNldEluZGV4XVtfeGZhX29iamVjdC4kZ2V0TmV4dFBhZ2VdKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzW194ZmFfb2JqZWN0LiRpc1VzYWJsZV0oKSkgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5udW1iZXJPZlVzZSArPSAxOwogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5wYWdlSW5kZXggPSAtMTsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ucGFnZVNldEluZGV4ID0gLTE7CiAgICAgICAgcmV0dXJuIHRoaXNbX3hmYV9vYmplY3QuJGdldE5leHRQYWdlXSgpOwogICAgICB9CgogICAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgUGFnZVNldCkgewogICAgICAgIHJldHVybiBwYXJlbnRbX3hmYV9vYmplY3QuJGdldE5leHRQYWdlXSgpOwogICAgICB9CgogICAgICB0aGlzW194ZmFfb2JqZWN0LiRjbGVhblBhZ2VdKCk7CgogICAgICByZXR1cm4gdGhpc1tfeGZhX29iamVjdC4kZ2V0TmV4dFBhZ2VdKCk7CiAgICB9CgogICAgY29uc3QgcGFnZU51bWJlciA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKVtfeGZhX29iamVjdC4kZXh0cmFdLnBhZ2VOdW1iZXI7CgogICAgY29uc3QgcGFyaXR5ID0gcGFnZU51bWJlciAlIDIgPT09IDAgPyAiZXZlbiIgOiAib2RkIjsKICAgIGNvbnN0IHBvc2l0aW9uID0gcGFnZU51bWJlciA9PT0gMCA/ICJmaXJzdCIgOiAicmVzdCI7CiAgICBsZXQgcGFnZSA9IHRoaXMucGFnZUFyZWEuY2hpbGRyZW4uZmluZChwID0+IHAub2RkT3JFdmVuID09PSBwYXJpdHkgJiYgcC5wYWdlUG9zaXRpb24gPT09IHBvc2l0aW9uKTsKCiAgICBpZiAocGFnZSkgewogICAgICByZXR1cm4gcGFnZTsKICAgIH0KCiAgICBwYWdlID0gdGhpcy5wYWdlQXJlYS5jaGlsZHJlbi5maW5kKHAgPT4gcC5vZGRPckV2ZW4gPT09ICJhbnkiICYmIHAucGFnZVBvc2l0aW9uID09PSBwb3NpdGlvbik7CgogICAgaWYgKHBhZ2UpIHsKICAgICAgcmV0dXJuIHBhZ2U7CiAgICB9CgogICAgcGFnZSA9IHRoaXMucGFnZUFyZWEuY2hpbGRyZW4uZmluZChwID0+IHAub2RkT3JFdmVuID09PSAiYW55IiAmJiBwLnBhZ2VQb3NpdGlvbiA9PT0gImFueSIpOwoKICAgIGlmIChwYWdlKSB7CiAgICAgIHJldHVybiBwYWdlOwogICAgfQoKICAgIHJldHVybiB0aGlzLnBhZ2VBcmVhLmNoaWxkcmVuWzBdOwogIH0KCn0KCmNsYXNzIFBhcmEgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAicGFyYSIsIHRydWUpOwogICAgdGhpcy5oQWxpZ24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5oQWxpZ24sIFsibGVmdCIsICJjZW50ZXIiLCAianVzdGlmeSIsICJqdXN0aWZ5QWxsIiwgInJhZGl4IiwgInJpZ2h0Il0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmxpbmVIZWlnaHQgPSBhdHRyaWJ1dGVzLmxpbmVIZWlnaHQgPyAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLmxpbmVIZWlnaHQsICIwcHQiKSA6ICIiOwogICAgdGhpcy5tYXJnaW5MZWZ0ID0gYXR0cmlidXRlcy5tYXJnaW5MZWZ0ID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5tYXJnaW5MZWZ0LCAiMHB0IikgOiAiIjsKICAgIHRoaXMubWFyZ2luUmlnaHQgPSBhdHRyaWJ1dGVzLm1hcmdpblJpZ2h0ID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5tYXJnaW5SaWdodCwgIjBwdCIpIDogIiI7CiAgICB0aGlzLm9ycGhhbnMgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5vcnBoYW5zLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPj0gMAogICAgfSk7CiAgICB0aGlzLnByZXNlcnZlID0gYXR0cmlidXRlcy5wcmVzZXJ2ZSB8fCAiIjsKICAgIHRoaXMucmFkaXhPZmZzZXQgPSBhdHRyaWJ1dGVzLnJhZGl4T2Zmc2V0ID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5yYWRpeE9mZnNldCwgIjBwdCIpIDogIiI7CiAgICB0aGlzLnNwYWNlQWJvdmUgPSBhdHRyaWJ1dGVzLnNwYWNlQWJvdmUgPyAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnNwYWNlQWJvdmUsICIwcHQiKSA6ICIiOwogICAgdGhpcy5zcGFjZUJlbG93ID0gYXR0cmlidXRlcy5zcGFjZUJlbG93ID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5zcGFjZUJlbG93LCAiMHB0IikgOiAiIjsKICAgIHRoaXMudGFiRGVmYXVsdCA9IGF0dHJpYnV0ZXMudGFiRGVmYXVsdCA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHRoaXMudGFiRGVmYXVsdCkgOiAiIjsKICAgIHRoaXMudGFiU3RvcHMgPSAoYXR0cmlidXRlcy50YWJTdG9wcyB8fCAiIikudHJpbSgpLnNwbGl0KC9ccysvKS5tYXAoKHgsIGkpID0+IGkgJSAyID09PSAxID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoeCkgOiB4KTsKICAgIHRoaXMudGV4dEluZGVudCA9IGF0dHJpYnV0ZXMudGV4dEluZGVudCA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMudGV4dEluZGVudCwgIjBwdCIpIDogIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy52QWxpZ24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy52QWxpZ24sIFsidG9wIiwgImJvdHRvbSIsICJtaWRkbGUiXSk7CiAgICB0aGlzLndpZG93cyA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLndpZG93cywKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAKICAgIH0pOwogICAgdGhpcy5oeXBoZW5hdGlvbiA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgewogICAgY29uc3Qgc3R5bGUgPSAoMCwgX2h0bWxfdXRpbHMudG9TdHlsZSkodGhpcywgImhBbGlnbiIpOwoKICAgIGlmICh0aGlzLm1hcmdpbkxlZnQgIT09ICIiKSB7CiAgICAgIHN0eWxlLnBhZGRpbmdMZWZ0ID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5tYXJnaW5MZWZ0KTsKICAgIH0KCiAgICBpZiAodGhpcy5tYXJnaW5SaWdodCAhPT0gIiIpIHsKICAgICAgc3R5bGUucGFkZGluZ2lnaHQgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLm1hcmdpblJpZ2h0KTsKICAgIH0KCiAgICBpZiAodGhpcy5zcGFjZUFib3ZlICE9PSAiIikgewogICAgICBzdHlsZS5wYWRkaW5nVG9wID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5zcGFjZUFib3ZlKTsKICAgIH0KCiAgICBpZiAodGhpcy5zcGFjZUJlbG93ICE9PSAiIikgewogICAgICBzdHlsZS5wYWRkaW5nQm90dG9tID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5zcGFjZUJlbG93KTsKICAgIH0KCiAgICBpZiAodGhpcy50ZXh0SW5kZW50ICE9PSAiIikgewogICAgICBzdHlsZS50ZXh0SW5kZW50ID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy50ZXh0SW5kZW50KTsKICAgICAgKDAsIF9odG1sX3V0aWxzLmZpeFRleHRJbmRlbnQpKHN0eWxlKTsKICAgIH0KCiAgICBpZiAodGhpcy5saW5lSGVpZ2h0ID4gMCkgewogICAgICBzdHlsZS5saW5lSGVpZ2h0ID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5saW5lSGVpZ2h0KTsKICAgIH0KCiAgICBpZiAodGhpcy50YWJEZWZhdWx0ICE9PSAiIikgewogICAgICBzdHlsZS50YWJTaXplID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy50YWJEZWZhdWx0KTsKICAgIH0KCiAgICBpZiAodGhpcy50YWJTdG9wcy5sZW5ndGggPiAwKSB7fQoKICAgIGlmICh0aGlzLmh5cGhlbmF0YXRpb24pIHsKICAgICAgT2JqZWN0LmFzc2lnbihzdHlsZSwgdGhpcy5oeXBoZW5hdGF0aW9uW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpKTsKICAgIH0KCiAgICByZXR1cm4gc3R5bGU7CiAgfQoKfQoKY2xhc3MgUGFzc3dvcmRFZGl0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInBhc3N3b3JkRWRpdCIsIHRydWUpOwogICAgdGhpcy5oU2Nyb2xsUG9saWN5ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaFNjcm9sbFBvbGljeSwgWyJhdXRvIiwgIm9mZiIsICJvbiJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5wYXNzd29yZENoYXIgPSBhdHRyaWJ1dGVzLnBhc3N3b3JkQ2hhciB8fCAiKiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5ib3JkZXIgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogIH0KCn0KCmNsYXNzIFBhdHRlcm4gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAicGF0dGVybiIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbImNyb3NzSGF0Y2giLCAiY3Jvc3NEaWFnb25hbCIsICJkaWFnb25hbExlZnQiLCAiZGlhZ29uYWxSaWdodCIsICJob3Jpem9udGFsIiwgInZlcnRpY2FsIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuY29sb3IgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b1N0eWxlXShzdGFydENvbG9yKSB7CiAgICBzdGFydENvbG9yID0gc3RhcnRDb2xvciA/IHN0YXJ0Q29sb3JbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgOiAiI0ZGRkZGRiI7CiAgICBjb25zdCBlbmRDb2xvciA9IHRoaXMuY29sb3IgPyB0aGlzLmNvbG9yW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIDogIiMwMDAwMDAiOwogICAgY29uc3Qgd2lkdGggPSA1OwogICAgY29uc3QgY21kID0gInJlcGVhdGluZy1saW5lYXItZ3JhZGllbnQiOwogICAgY29uc3QgY29sb3JzID0gYCR7c3RhcnRDb2xvcn0sJHtzdGFydENvbG9yfSAke3dpZHRofXB4LCR7ZW5kQ29sb3J9ICR7d2lkdGh9cHgsJHtlbmRDb2xvcn0gJHsyICogd2lkdGh9cHhgOwoKICAgIHN3aXRjaCAodGhpcy50eXBlKSB7CiAgICAgIGNhc2UgImNyb3NzSGF0Y2giOgogICAgICAgIHJldHVybiBgJHtjbWR9KHRvIHRvcCwke2NvbG9yc30pICR7Y21kfSh0byByaWdodCwke2NvbG9yc30pYDsKCiAgICAgIGNhc2UgImNyb3NzRGlhZ29uYWwiOgogICAgICAgIHJldHVybiBgJHtjbWR9KDQ1ZGVnLCR7Y29sb3JzfSkgJHtjbWR9KC00NWRlZywke2NvbG9yc30pYDsKCiAgICAgIGNhc2UgImRpYWdvbmFsTGVmdCI6CiAgICAgICAgcmV0dXJuIGAke2NtZH0oNDVkZWcsJHtjb2xvcnN9KWA7CgogICAgICBjYXNlICJkaWFnb25hbFJpZ2h0IjoKICAgICAgICByZXR1cm4gYCR7Y21kfSgtNDVkZWcsJHtjb2xvcnN9KWA7CgogICAgICBjYXNlICJob3Jpem9udGFsIjoKICAgICAgICByZXR1cm4gYCR7Y21kfSh0byB0b3AsJHtjb2xvcnN9KWA7CgogICAgICBjYXNlICJ2ZXJ0aWNhbCI6CiAgICAgICAgcmV0dXJuIGAke2NtZH0odG8gcmlnaHQsJHtjb2xvcnN9KWA7CiAgICB9CgogICAgcmV0dXJuICIiOwogIH0KCn0KCmNsYXNzIFBpY3R1cmUgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAicGljdHVyZSIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIFByb3RvIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInByb3RvIiwgdHJ1ZSk7CiAgICB0aGlzLmFwcGVhcmFuY2VGaWx0ZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuYXJjID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmFyZWEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuYXNzaXN0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmJhcmNvZGUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuYmluZEl0ZW1zID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmJvb2tlbmQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuYm9vbGVhbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5ib3JkZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuYnJlYWsgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuYnJlYWtBZnRlciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5icmVha0JlZm9yZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5idXR0b24gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuY2FsY3VsYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNhcHRpb24gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuY2VydGlmaWNhdGUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuY2VydGlmaWNhdGVzID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNoZWNrQnV0dG9uID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNob2ljZUxpc3QgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuY29sb3IgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuY29tYiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5jb25uZWN0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNvbnRlbnRBcmVhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNvcm5lciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRhdGVUaW1lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRhdGVUaW1lRWRpdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kZWNpbWFsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRlZmF1bHRVaSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kZXNjID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRpZ2VzdE1ldGhvZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kaWdlc3RNZXRob2RzID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRyYXcgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZWRnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5lbmNvZGluZyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5lbmNvZGluZ3MgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZW5jcnlwdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5lbmNyeXB0RGF0YSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5lbmNyeXB0aW9uID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmVuY3J5cHRpb25NZXRob2QgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZW5jcnlwdGlvbk1ldGhvZHMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZXZlbnQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZXhEYXRhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4T2JqZWN0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4Y2xHcm91cCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leGVjdXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4dHJhcyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5maWVsZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5maWxsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmZpbHRlciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5mbG9hdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5mb250ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmZvcm1hdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5oYW5kbGVyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmh5cGhlbmF0aW9uID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmltYWdlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmltYWdlRWRpdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbnRlZ2VyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmlzc3VlcnMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuaXRlbXMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMua2VlcCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5rZXlVc2FnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5saW5lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmxpbmVhciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5sb2NrRG9jdW1lbnQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMubWFuaWZlc3QgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMubWFyZ2luID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLm1kcCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5tZWRpdW0gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMubWVzc2FnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5udW1lcmljRWRpdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5vY2N1ciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5vaWQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMub2lkcyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5vdmVyZmxvdyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5wYWdlQXJlYSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5wYWdlU2V0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnBhcmEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucGFzc3dvcmRFZGl0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnBhdHRlcm4gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucGljdHVyZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5yYWRpYWwgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucmVhc29uID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnJlYXNvbnMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucmVjdGFuZ2xlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnJlZiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zY3JpcHQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc2V0UHJvcGVydHkgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc2lnbkRhdGEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc2lnbmF0dXJlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnNpZ25pbmcgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc29saWQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc3BlYWsgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc3RpcHBsZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zdWJmb3JtID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnN1YmZvcm1TZXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc3ViamVjdEROID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnN1YmplY3RETnMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc3VibWl0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRleHQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGV4dEVkaXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGltZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy50aW1lU3RhbXAgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudG9vbFRpcCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy50cmF2ZXJzYWwgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudHJhdmVyc2UgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudWkgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudmFsaWRhdGUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudmFsdWUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudmFyaWFibGVzID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgUmFkaWFsIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInJhZGlhbCIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbInRvRWRnZSIsICJ0b0NlbnRlciJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmNvbG9yID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9TdHlsZV0oc3RhcnRDb2xvcikgewogICAgc3RhcnRDb2xvciA9IHN0YXJ0Q29sb3IgPyBzdGFydENvbG9yW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIDogIiNGRkZGRkYiOwogICAgY29uc3QgZW5kQ29sb3IgPSB0aGlzLmNvbG9yID8gdGhpcy5jb2xvcltfeGZhX29iamVjdC4kdG9TdHlsZV0oKSA6ICIjMDAwMDAwIjsKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMudHlwZSA9PT0gInRvRWRnZSIgPyBgJHtzdGFydENvbG9yfSwke2VuZENvbG9yfWAgOiBgJHtlbmRDb2xvcn0sJHtzdGFydENvbG9yfWA7CiAgICByZXR1cm4gYHJhZGlhbC1ncmFkaWVudChjaXJjbGUgYXQgY2VudGVyLCAke2NvbG9yc30pYDsKICB9Cgp9CgpjbGFzcyBSZWFzb24gZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAicmVhc29uIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgUmVhc29ucyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJyZWFzb25zIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnR5cGUsIFsib3B0aW9uYWwiLCAicmVxdWlyZWQiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5yZWFzb24gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBSZWN0YW5nbGUgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAicmVjdGFuZ2xlIiwgdHJ1ZSk7CiAgICB0aGlzLmhhbmQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5oYW5kLCBbImV2ZW4iLCAibGVmdCIsICJyaWdodCJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuY29ybmVyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KDQpOwogICAgdGhpcy5lZGdlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KDQpOwogICAgdGhpcy5maWxsID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXSgpIHsKICAgIGNvbnN0IGVkZ2UgPSB0aGlzLmVkZ2UuY2hpbGRyZW4ubGVuZ3RoID8gdGhpcy5lZGdlLmNoaWxkcmVuWzBdIDogbmV3IEVkZ2Uoe30pOwoKICAgIGNvbnN0IGVkZ2VTdHlsZSA9IGVkZ2VbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCk7CgogICAgY29uc3Qgc3R5bGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGlmICh0aGlzLmZpbGwgJiYgdGhpcy5maWxsLnByZXNlbmNlID09PSAidmlzaWJsZSIpIHsKICAgICAgT2JqZWN0LmFzc2lnbihzdHlsZSwgdGhpcy5maWxsW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpKTsKICAgIH0gZWxzZSB7CiAgICAgIHN0eWxlLmZpbGwgPSAidHJhbnNwYXJlbnQiOwogICAgfQoKICAgIHN0eWxlLnN0cm9rZVdpZHRoID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykoZWRnZS5wcmVzZW5jZSA9PT0gInZpc2libGUiID8gZWRnZS50aGlja25lc3MgOiAwKTsKICAgIHN0eWxlLnN0cm9rZSA9IGVkZ2VTdHlsZS5jb2xvcjsKICAgIGNvbnN0IGNvcm5lciA9IHRoaXMuY29ybmVyLmNoaWxkcmVuLmxlbmd0aCA/IHRoaXMuY29ybmVyLmNoaWxkcmVuWzBdIDogbmV3IENvcm5lcih7fSk7CgogICAgY29uc3QgY29ybmVyU3R5bGUgPSBjb3JuZXJbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCk7CgogICAgY29uc3QgcmVjdCA9IHsKICAgICAgbmFtZTogInJlY3QiLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgeG1sbnM6IFNWR19OUywKICAgICAgICB3aWR0aDogIjEwMCUiLAogICAgICAgIGhlaWdodDogIjEwMCUiLAogICAgICAgIHg6IDAsCiAgICAgICAgeTogMCwKICAgICAgICByeDogY29ybmVyU3R5bGUucmFkaXVzLAogICAgICAgIHJ5OiBjb3JuZXJTdHlsZS5yYWRpdXMsCiAgICAgICAgc3R5bGUKICAgICAgfQogICAgfTsKICAgIGNvbnN0IHN2ZyA9IHsKICAgICAgbmFtZTogInN2ZyIsCiAgICAgIGNoaWxkcmVuOiBbcmVjdF0sCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICB4bWxuczogU1ZHX05TLAogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICBvdmVyZmxvdzogInZpc2libGUiCiAgICAgICAgfSwKICAgICAgICB3aWR0aDogIjEwMCUiLAogICAgICAgIGhlaWdodDogIjEwMCUiCiAgICAgIH0KICAgIH07CgogICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgaWYgKGhhc01hcmdpbihwYXJlbnQpKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgICBuYW1lOiAiZGl2IiwKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBzdHlsZTogewogICAgICAgICAgICBkaXNwbGF5OiAiaW5saW5lIiwKICAgICAgICAgICAgd2lkdGg6ICIxMDAlIiwKICAgICAgICAgICAgaGVpZ2h0OiAiMTAwJSIKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGNoaWxkcmVuOiBbc3ZnXQogICAgICB9KTsKICAgIH0KCiAgICBzdmcuYXR0cmlidXRlcy5zdHlsZS5wb3NpdGlvbiA9ICJhYnNvbHV0ZSI7CiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcyhzdmcpOwogIH0KCn0KCmNsYXNzIFJlZkVsZW1lbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAicmVmIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgU2NyaXB0IGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInNjcmlwdCIpOwogICAgdGhpcy5iaW5kaW5nID0gYXR0cmlidXRlcy5iaW5kaW5nIHx8ICIiOwogICAgdGhpcy5jb250ZW50VHlwZSA9IGF0dHJpYnV0ZXMuY29udGVudFR5cGUgfHwgIiI7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucnVuQXQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5ydW5BdCwgWyJjbGllbnQiLCAiYm90aCIsICJzZXJ2ZXIiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIFNldFByb3BlcnR5IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInNldFByb3BlcnR5Iik7CiAgICB0aGlzLmNvbm5lY3Rpb24gPSBhdHRyaWJ1dGVzLmNvbm5lY3Rpb24gfHwgIiI7CiAgICB0aGlzLnJlZiA9IGF0dHJpYnV0ZXMucmVmIHx8ICIiOwogICAgdGhpcy50YXJnZXQgPSBhdHRyaWJ1dGVzLnRhcmdldCB8fCAiIjsKICB9Cgp9CgpleHBvcnRzLlNldFByb3BlcnR5ID0gU2V0UHJvcGVydHk7CgpjbGFzcyBTaWduRGF0YSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJzaWduRGF0YSIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm9wZXJhdGlvbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm9wZXJhdGlvbiwgWyJzaWduIiwgImNsZWFyIiwgInZlcmlmeSJdKTsKICAgIHRoaXMucmVmID0gYXR0cmlidXRlcy5yZWYgfHwgIiI7CiAgICB0aGlzLnRhcmdldCA9IGF0dHJpYnV0ZXMudGFyZ2V0IHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZmlsdGVyID0gbnVsbDsKICAgIHRoaXMubWFuaWZlc3QgPSBudWxsOwogIH0KCn0KCmNsYXNzIFNpZ25hdHVyZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJzaWduYXR1cmUiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJQREYxLjMiLCAiUERGMS42Il0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYm9yZGVyID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMuZmlsdGVyID0gbnVsbDsKICAgIHRoaXMubWFuaWZlc3QgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogIH0KCn0KCmNsYXNzIFNpZ25pbmcgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAic2lnbmluZyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuY2VydGlmaWNhdGUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBTb2xpZCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJzb2xpZCIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b1N0eWxlXShzdGFydENvbG9yKSB7CiAgICByZXR1cm4gc3RhcnRDb2xvciA/IHN0YXJ0Q29sb3JbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgOiAiI0ZGRkZGRiI7CiAgfQoKfQoKY2xhc3MgU3BlYWsgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAic3BlYWsiKTsKICAgIHRoaXMuZGlzYWJsZSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmRpc2FibGUsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMQogICAgfSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMucHJpb3JpdHkgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5wcmlvcml0eSwgWyJjdXN0b20iLCAiY2FwdGlvbiIsICJuYW1lIiwgInRvb2xUaXAiXSk7CiAgICB0aGlzLnJpZCA9IGF0dHJpYnV0ZXMucmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBTdGlwcGxlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInN0aXBwbGUiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5yYXRlID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMucmF0ZSwKICAgICAgZGVmYXVsdFZhbHVlOiA1MCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAwICYmIHggPD0gMTAwCiAgICB9KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmNvbG9yID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9TdHlsZV0oYmdDb2xvcikgewogICAgY29uc3QgYWxwaGEgPSB0aGlzLnJhdGUgLyAxMDA7CiAgICByZXR1cm4gX3V0aWwuVXRpbC5tYWtlSGV4Q29sb3IoTWF0aC5yb3VuZChiZ0NvbG9yLnZhbHVlLnIgKiAoMSAtIGFscGhhKSArIHRoaXMudmFsdWUuciAqIGFscGhhKSwgTWF0aC5yb3VuZChiZ0NvbG9yLnZhbHVlLmcgKiAoMSAtIGFscGhhKSArIHRoaXMudmFsdWUuZyAqIGFscGhhKSwgTWF0aC5yb3VuZChiZ0NvbG9yLnZhbHVlLmIgKiAoMSAtIGFscGhhKSArIHRoaXMudmFsdWUuYiAqIGFscGhhKSk7CiAgfQoKfQoKY2xhc3MgU3ViZm9ybSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJzdWJmb3JtIiwgdHJ1ZSk7CiAgICB0aGlzLmFjY2VzcyA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmFjY2VzcywgWyJvcGVuIiwgIm5vbkludGVyYWN0aXZlIiwgInByb3RlY3RlZCIsICJyZWFkT25seSJdKTsKICAgIHRoaXMuYWxsb3dNYWNybyA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmFsbG93TWFjcm8sCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMQogICAgfSk7CiAgICB0aGlzLmFuY2hvclR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5hbmNob3JUeXBlLCBbInRvcExlZnQiLCAiYm90dG9tQ2VudGVyIiwgImJvdHRvbUxlZnQiLCAiYm90dG9tUmlnaHQiLCAibWlkZGxlQ2VudGVyIiwgIm1pZGRsZUxlZnQiLCAibWlkZGxlUmlnaHQiLCAidG9wQ2VudGVyIiwgInRvcFJpZ2h0Il0pOwogICAgdGhpcy5jb2xTcGFuID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuY29sU3BhbiwKICAgICAgZGVmYXVsdFZhbHVlOiAxLAogICAgICB2YWxpZGF0ZTogbiA9PiBuID49IDEgfHwgbiA9PT0gLTEKICAgIH0pOwogICAgdGhpcy5jb2x1bW5XaWR0aHMgPSAoYXR0cmlidXRlcy5jb2x1bW5XaWR0aHMgfHwgIiIpLnRyaW0oKS5zcGxpdCgvXHMrLykubWFwKHggPT4geCA9PT0gIi0xIiA/IC0xIDogKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoeCkpOwogICAgdGhpcy5oID0gYXR0cmlidXRlcy5oID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5oKSA6ICIiOwogICAgdGhpcy5oQWxpZ24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5oQWxpZ24sIFsibGVmdCIsICJjZW50ZXIiLCAianVzdGlmeSIsICJqdXN0aWZ5QWxsIiwgInJhZGl4IiwgInJpZ2h0Il0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmxheW91dCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmxheW91dCwgWyJwb3NpdGlvbiIsICJsci10YiIsICJybC1yb3ciLCAicmwtdGIiLCAicm93IiwgInRhYmxlIiwgInRiIl0pOwogICAgdGhpcy5sb2NhbGUgPSBhdHRyaWJ1dGVzLmxvY2FsZSB8fCAiIjsKICAgIHRoaXMubWF4SCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWF4SCwgIjBwdCIpOwogICAgdGhpcy5tYXhXID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5tYXhXLCAiMHB0Iik7CiAgICB0aGlzLm1lcmdlTW9kZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm1lcmdlTW9kZSwgWyJjb25zdW1lRGF0YSIsICJtYXRjaFRlbXBsYXRlIl0pOwogICAgdGhpcy5taW5IID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5taW5ILCAiMHB0Iik7CiAgICB0aGlzLm1pblcgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1pblcsICIwcHQiKTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucHJlc2VuY2UgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5wcmVzZW5jZSwgWyJ2aXNpYmxlIiwgImhpZGRlbiIsICJpbmFjdGl2ZSIsICJpbnZpc2libGUiXSk7CiAgICB0aGlzLnJlbGV2YW50ID0gKDAsIF91dGlscy5nZXRSZWxldmFudCkoYXR0cmlidXRlcy5yZWxldmFudCk7CiAgICB0aGlzLnJlc3RvcmVTdGF0ZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnJlc3RvcmVTdGF0ZSwgWyJtYW51YWwiLCAiYXV0byJdKTsKICAgIHRoaXMuc2NvcGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5zY29wZSwgWyJuYW1lIiwgIm5vbmUiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy53ID0gYXR0cmlidXRlcy53ID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy53KSA6ICIiOwogICAgdGhpcy54ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy54LCAiMHB0Iik7CiAgICB0aGlzLnkgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnksICIwcHQiKTsKICAgIHRoaXMuYXNzaXN0ID0gbnVsbDsKICAgIHRoaXMuYmluZCA9IG51bGw7CiAgICB0aGlzLmJvb2tlbmQgPSBudWxsOwogICAgdGhpcy5ib3JkZXIgPSBudWxsOwogICAgdGhpcy5icmVhayA9IG51bGw7CiAgICB0aGlzLmNhbGN1bGF0ZSA9IG51bGw7CiAgICB0aGlzLmRlc2MgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5rZWVwID0gbnVsbDsKICAgIHRoaXMubWFyZ2luID0gbnVsbDsKICAgIHRoaXMub2NjdXIgPSBudWxsOwogICAgdGhpcy5vdmVyZmxvdyA9IG51bGw7CiAgICB0aGlzLnBhZ2VTZXQgPSBudWxsOwogICAgdGhpcy5wYXJhID0gbnVsbDsKICAgIHRoaXMudHJhdmVyc2FsID0gbnVsbDsKICAgIHRoaXMudmFsaWRhdGUgPSBudWxsOwogICAgdGhpcy52YXJpYWJsZXMgPSBudWxsOwogICAgdGhpcy5hcmVhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmJyZWFrQWZ0ZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuYnJlYWtCZWZvcmUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuY29ubmVjdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kcmF3ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV2ZW50ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4T2JqZWN0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4Y2xHcm91cCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5maWVsZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5wcm90byA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zZXRQcm9wZXJ0eSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zdWJmb3JtID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnN1YmZvcm1TZXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9CgogIFtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKSB7CiAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIFN1YmZvcm1TZXQpIHsKICAgICAgcmV0dXJuIHBhcmVudFtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKTsKICAgIH0KCiAgICByZXR1cm4gcGFyZW50OwogIH0KCiAgW194ZmFfb2JqZWN0LiRpc0JpbmRhYmxlXSgpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgW194ZmFfb2JqZWN0LiRpc1RoZXJlTW9yZVdpZHRoXSgpIHsKICAgIHJldHVybiB0aGlzLmxheW91dC5lbmRzV2l0aCgiLXRiIikgJiYgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgPT09IDAgJiYgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLm51bWJlckluTGluZSA+IDAgfHwgdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpW194ZmFfb2JqZWN0LiRpc1RoZXJlTW9yZVdpZHRoXSgpOwogIH0KCiAgKltfeGZhX29iamVjdC4kZ2V0Q29udGFpbmVkQ2hpbGRyZW5dKCkgewogICAgeWllbGQqIGdldENvbnRhaW5lZENoaWxkcmVuKHRoaXMpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmbHVzaEhUTUxdKCkgewogICAgcmV0dXJuICgwLCBfbGF5b3V0LmZsdXNoSFRNTCkodGhpcyk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGFkZEhUTUxdKGh0bWwsIGJib3gpIHsKICAgICgwLCBfbGF5b3V0LmFkZEhUTUwpKHRoaXMsIGh0bWwsIGJib3gpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRnZXRBdmFpbGFibGVTcGFjZV0oKSB7CiAgICByZXR1cm4gKDAsIF9sYXlvdXQuZ2V0QXZhaWxhYmxlU3BhY2UpKHRoaXMpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRpc1NwbGl0dGFibGVdKCkgewogICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKTsKCiAgICBpZiAoIXBhcmVudFtfeGZhX29iamVjdC4kaXNTcGxpdHRhYmxlXSgpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLl9pc1NwbGl0dGFibGUgIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLl9pc1NwbGl0dGFibGU7CiAgICB9CgogICAgaWYgKHRoaXMubGF5b3V0ID09PSAicG9zaXRpb24iIHx8IHRoaXMubGF5b3V0LmluY2x1ZGVzKCJyb3ciKSkgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uX2lzU3BsaXR0YWJsZSA9IGZhbHNlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKHRoaXMua2VlcCAmJiB0aGlzLmtlZXAuaW50YWN0ICE9PSAibm9uZSIpIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLl9pc1NwbGl0dGFibGUgPSBmYWxzZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmIChwYXJlbnQubGF5b3V0ICYmIHBhcmVudC5sYXlvdXQuZW5kc1dpdGgoIi10YiIpICYmIHBhcmVudFtfeGZhX29iamVjdC4kZXh0cmFdLm51bWJlckluTGluZSAhPT0gMCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLl9pc1NwbGl0dGFibGUgPSB0cnVlOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIHNldFRhYkluZGV4KHRoaXMpOwoKICAgIGlmICh0aGlzLmJyZWFrKSB7CiAgICAgIGlmICh0aGlzLmJyZWFrLmFmdGVyICE9PSAiYXV0byIgfHwgdGhpcy5icmVhay5hZnRlclRhcmdldCAhPT0gIiIpIHsKICAgICAgICBjb25zdCBub2RlID0gbmV3IEJyZWFrQWZ0ZXIoewogICAgICAgICAgdGFyZ2V0VHlwZTogdGhpcy5icmVhay5hZnRlciwKICAgICAgICAgIHRhcmdldDogdGhpcy5icmVhay5hZnRlclRhcmdldCwKICAgICAgICAgIHN0YXJ0TmV3OiB0aGlzLmJyZWFrLnN0YXJ0TmV3LnRvU3RyaW5nKCkKICAgICAgICB9KTsKICAgICAgICBub2RlW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXSA9IHRoaXNbX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdOwoKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRhcHBlbmRDaGlsZF0obm9kZSk7CgogICAgICAgIHRoaXMuYnJlYWtBZnRlci5wdXNoKG5vZGUpOwogICAgICB9CgogICAgICBpZiAodGhpcy5icmVhay5iZWZvcmUgIT09ICJhdXRvIiB8fCB0aGlzLmJyZWFrLmJlZm9yZVRhcmdldCAhPT0gIiIpIHsKICAgICAgICBjb25zdCBub2RlID0gbmV3IEJyZWFrQmVmb3JlKHsKICAgICAgICAgIHRhcmdldFR5cGU6IHRoaXMuYnJlYWsuYmVmb3JlLAogICAgICAgICAgdGFyZ2V0OiB0aGlzLmJyZWFrLmJlZm9yZVRhcmdldCwKICAgICAgICAgIHN0YXJ0TmV3OiB0aGlzLmJyZWFrLnN0YXJ0TmV3LnRvU3RyaW5nKCkKICAgICAgICB9KTsKICAgICAgICBub2RlW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXSA9IHRoaXNbX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdOwoKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRhcHBlbmRDaGlsZF0obm9kZSk7CgogICAgICAgIHRoaXMuYnJlYWtCZWZvcmUucHVzaChub2RlKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuYnJlYWsub3ZlcmZsb3dUYXJnZXQgIT09ICIiKSB7CiAgICAgICAgY29uc3Qgbm9kZSA9IG5ldyBPdmVyZmxvdyh7CiAgICAgICAgICB0YXJnZXQ6IHRoaXMuYnJlYWsub3ZlcmZsb3dUYXJnZXQsCiAgICAgICAgICBsZWFkZXI6IHRoaXMuYnJlYWsub3ZlcmZsb3dMZWFkZXIsCiAgICAgICAgICB0cmFpbGVyOiB0aGlzLmJyZWFrLm92ZXJmbG93VHJhaWxlcgogICAgICAgIH0pOwogICAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdID0gdGhpc1tfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV07CgogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXShub2RlKTsKCiAgICAgICAgdGhpcy5vdmVyZmxvdy5wdXNoKG5vZGUpOwogICAgICB9CgogICAgICB0aGlzW194ZmFfb2JqZWN0LiRyZW1vdmVDaGlsZF0odGhpcy5icmVhayk7CgogICAgICB0aGlzLmJyZWFrID0gbnVsbDsKICAgIH0KCiAgICBpZiAodGhpcy5wcmVzZW5jZSA9PT0gImhpZGRlbiIgfHwgdGhpcy5wcmVzZW5jZSA9PT0gImluYWN0aXZlIikgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgICB9CgogICAgaWYgKHRoaXMuYnJlYWtCZWZvcmUuY2hpbGRyZW4ubGVuZ3RoID4gMSB8fCB0aGlzLmJyZWFrQWZ0ZXIuY2hpbGRyZW4ubGVuZ3RoID4gMSkgewogICAgICAoMCwgX3V0aWwud2FybikoIlhGQSAtIFNldmVyYWwgYnJlYWtCZWZvcmUgb3IgYnJlYWtBZnRlciBpbiBzdWJmb3JtczogcGxlYXNlIGZpbGUgYSBidWcuIik7CiAgICB9CgogICAgaWYgKHRoaXMuYnJlYWtCZWZvcmUuY2hpbGRyZW4ubGVuZ3RoID49IDEpIHsKICAgICAgY29uc3QgYnJlYWtCZWZvcmUgPSB0aGlzLmJyZWFrQmVmb3JlLmNoaWxkcmVuWzBdOwoKICAgICAgaWYgKGhhbmRsZUJyZWFrKGJyZWFrQmVmb3JlKSkgewogICAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5icmVha05vZGUoYnJlYWtCZWZvcmUpOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSAmJiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYWZ0ZXJCcmVha0FmdGVyKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICAgIH0KCiAgICAoMCwgX2h0bWxfdXRpbHMuZml4RGltZW5zaW9ucykodGhpcyk7CiAgICBjb25zdCBjaGlsZHJlbiA9IFtdOwogICAgY29uc3QgYXR0cmlidXRlcyA9IHsKICAgICAgaWQ6IHRoaXNbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgIGNsYXNzOiBbXQogICAgfTsKICAgICgwLCBfaHRtbF91dGlscy5zZXRBY2Nlc3MpKHRoaXMsIGF0dHJpYnV0ZXMuY2xhc3MpOwoKICAgIGlmICghdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB9CgogICAgT2JqZWN0LmFzc2lnbih0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0sIHsKICAgICAgY2hpbGRyZW4sCiAgICAgIGxpbmU6IG51bGwsCiAgICAgIGF0dHJpYnV0ZXMsCiAgICAgIGF0dGVtcHQ6IDAsCiAgICAgIG51bWJlckluTGluZTogMCwKICAgICAgYXZhaWxhYmxlU3BhY2U6IHsKICAgICAgICB3aWR0aDogTWF0aC5taW4odGhpcy53IHx8IEluZmluaXR5LCBhdmFpbGFibGVTcGFjZS53aWR0aCksCiAgICAgICAgaGVpZ2h0OiBNYXRoLm1pbih0aGlzLmggfHwgSW5maW5pdHksIGF2YWlsYWJsZVNwYWNlLmhlaWdodCkKICAgICAgfSwKICAgICAgd2lkdGg6IDAsCiAgICAgIGhlaWdodDogMCwKICAgICAgcHJldkhlaWdodDogMCwKICAgICAgY3VycmVudFdpZHRoOiAwCiAgICB9KTsKCiAgICBjb25zdCByb290ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpOwoKICAgIGNvbnN0IHNhdmVkTm9MYXlvdXRGYWlsdXJlID0gcm9vdFtfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZTsKCiAgICBjb25zdCBpc1NwbGl0dGFibGUgPSB0aGlzW194ZmFfb2JqZWN0LiRpc1NwbGl0dGFibGVdKCk7CgogICAgaWYgKCFpc1NwbGl0dGFibGUpIHsKICAgICAgc2V0Rmlyc3RVbnNwbGl0dGFibGUodGhpcyk7CiAgICB9CgogICAgaWYgKCEoMCwgX2xheW91dC5jaGVja0RpbWVuc2lvbnMpKHRoaXMsIGF2YWlsYWJsZVNwYWNlKSkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRkFJTFVSRTsKICAgIH0KCiAgICBjb25zdCBmaWx0ZXIgPSBuZXcgU2V0KFsiYXJlYSIsICJkcmF3IiwgImV4Y2xHcm91cCIsICJmaWVsZCIsICJzdWJmb3JtIiwgInN1YmZvcm1TZXQiXSk7CgogICAgaWYgKHRoaXMubGF5b3V0LmluY2x1ZGVzKCJyb3ciKSkgewogICAgICBjb25zdCBjb2x1bW5XaWR0aHMgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSgpLmNvbHVtbldpZHRoczsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbHVtbldpZHRocykgJiYgY29sdW1uV2lkdGhzLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uY29sdW1uV2lkdGhzID0gY29sdW1uV2lkdGhzOwogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5jdXJyZW50Q29sdW1uID0gMDsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJhbmNob3JUeXBlIiwgImRpbWVuc2lvbnMiLCAicG9zaXRpb24iLCAicHJlc2VuY2UiLCAiYm9yZGVyIiwgIm1hcmdpbiIsICJoQWxpZ24iKTsKICAgIGNvbnN0IGNsYXNzTmFtZXMgPSBbInhmYVN1YmZvcm0iXTsKICAgIGNvbnN0IGNsID0gKDAsIF9odG1sX3V0aWxzLmxheW91dENsYXNzKSh0aGlzKTsKCiAgICBpZiAoY2wpIHsKICAgICAgY2xhc3NOYW1lcy5wdXNoKGNsKTsKICAgIH0KCiAgICBhdHRyaWJ1dGVzLnN0eWxlID0gc3R5bGU7CiAgICBhdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3NOYW1lczsKCiAgICBpZiAodGhpcy5uYW1lKSB7CiAgICAgIGF0dHJpYnV0ZXMueGZhTmFtZSA9IHRoaXMubmFtZTsKICAgIH0KCiAgICBpZiAodGhpcy5vdmVyZmxvdykgewogICAgICBjb25zdCBvdmVyZmxvd0V4dHJhID0gdGhpcy5vdmVyZmxvd1tfeGZhX29iamVjdC4kZ2V0RXh0cmFdKCk7CgogICAgICBpZiAob3ZlcmZsb3dFeHRyYS5hZGRMZWFkZXIpIHsKICAgICAgICBvdmVyZmxvd0V4dHJhLmFkZExlYWRlciA9IGZhbHNlOwogICAgICAgIGhhbmRsZU92ZXJmbG93KHRoaXMsIG92ZXJmbG93RXh0cmEubGVhZGVyLCBhdmFpbGFibGVTcGFjZSk7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzW194ZmFfb2JqZWN0LiRwdXNoUGFyYV0oKTsKCiAgICBjb25zdCBpc0xyVGIgPSB0aGlzLmxheW91dCA9PT0gImxyLXRiIiB8fCB0aGlzLmxheW91dCA9PT0gInJsLXRiIjsKICAgIGNvbnN0IG1heFJ1biA9IGlzTHJUYiA/IE1BWF9BVFRFTVBUU19GT1JfTFJUQl9MQVlPVVQgOiAxOwoKICAgIGZvciAoOyB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0ZW1wdCA8IG1heFJ1bjsgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQrKykgewogICAgICBpZiAoaXNMclRiICYmIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5hdHRlbXB0ID09PSBNQVhfQVRURU1QVFNfRk9SX0xSVEJfTEFZT1VUIC0gMSkgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5udW1iZXJJbkxpbmUgPSAwOwogICAgICB9CgogICAgICBjb25zdCByZXN1bHQgPSB0aGlzW194ZmFfb2JqZWN0LiRjaGlsZHJlblRvSFRNTF0oewogICAgICAgIGZpbHRlciwKICAgICAgICBpbmNsdWRlOiB0cnVlCiAgICAgIH0pOwoKICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmIChyZXN1bHQuaXNCcmVhaygpKSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfQoKICAgICAgaWYgKGlzTHJUYiAmJiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0ZW1wdCA9PT0gMCAmJiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVySW5MaW5lID09PSAwICYmICFyb290W194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlKSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgPSBtYXhSdW47CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzW194ZmFfb2JqZWN0LiRwb3BQYXJhXSgpOwoKICAgIGlmICghaXNTcGxpdHRhYmxlKSB7CiAgICAgIHVuc2V0Rmlyc3RVbnNwbGl0dGFibGUodGhpcyk7CiAgICB9CgogICAgcm9vdFtfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSA9IHNhdmVkTm9MYXlvdXRGYWlsdXJlOwoKICAgIGlmICh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0ZW1wdCA9PT0gbWF4UnVuKSB7CiAgICAgIGlmICh0aGlzLm92ZXJmbG93KSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpW194ZmFfb2JqZWN0LiRleHRyYV0ub3ZlcmZsb3dOb2RlID0gdGhpcy5vdmVyZmxvdzsKICAgICAgfQoKICAgICAgaWYgKCFpc1NwbGl0dGFibGUpIHsKICAgICAgICBkZWxldGUgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdOwogICAgICB9CgogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRkFJTFVSRTsKICAgIH0KCiAgICBpZiAodGhpcy5vdmVyZmxvdykgewogICAgICBjb25zdCBvdmVyZmxvd0V4dHJhID0gdGhpcy5vdmVyZmxvd1tfeGZhX29iamVjdC4kZ2V0RXh0cmFdKCk7CgogICAgICBpZiAob3ZlcmZsb3dFeHRyYS5hZGRUcmFpbGVyKSB7CiAgICAgICAgb3ZlcmZsb3dFeHRyYS5hZGRUcmFpbGVyID0gZmFsc2U7CiAgICAgICAgaGFuZGxlT3ZlcmZsb3codGhpcywgb3ZlcmZsb3dFeHRyYS50cmFpbGVyLCBhdmFpbGFibGVTcGFjZSk7CiAgICAgIH0KICAgIH0KCiAgICBsZXQgbWFyZ2luSCA9IDA7CiAgICBsZXQgbWFyZ2luViA9IDA7CgogICAgaWYgKHRoaXMubWFyZ2luKSB7CiAgICAgIG1hcmdpbkggPSB0aGlzLm1hcmdpbi5sZWZ0SW5zZXQgKyB0aGlzLm1hcmdpbi5yaWdodEluc2V0OwogICAgICBtYXJnaW5WID0gdGhpcy5tYXJnaW4udG9wSW5zZXQgKyB0aGlzLm1hcmdpbi5ib3R0b21JbnNldDsKICAgIH0KCiAgICBjb25zdCB3aWR0aCA9IE1hdGgubWF4KHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS53aWR0aCArIG1hcmdpbkgsIHRoaXMudyB8fCAwKTsKICAgIGNvbnN0IGhlaWdodCA9IE1hdGgubWF4KHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5oZWlnaHQgKyBtYXJnaW5WLCB0aGlzLmggfHwgMCk7CiAgICBjb25zdCBiYm94ID0gW3RoaXMueCwgdGhpcy55LCB3aWR0aCwgaGVpZ2h0XTsKCiAgICBpZiAodGhpcy53ID09PSAiIikgewogICAgICBzdHlsZS53aWR0aCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHdpZHRoKTsKICAgIH0KCiAgICBpZiAodGhpcy5oID09PSAiIikgewogICAgICBzdHlsZS5oZWlnaHQgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKShoZWlnaHQpOwogICAgfQoKICAgIGlmICgoc3R5bGUud2lkdGggPT09ICIwcHgiIHx8IHN0eWxlLmhlaWdodCA9PT0gIjBweCIpICYmIGNoaWxkcmVuLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgICB9CgogICAgY29uc3QgaHRtbCA9IHsKICAgICAgbmFtZTogImRpdiIsCiAgICAgIGF0dHJpYnV0ZXMsCiAgICAgIGNoaWxkcmVuCiAgICB9OwogICAgYXBwbHlBc3Npc3QodGhpcywgYXR0cmlidXRlcyk7CgogICAgY29uc3QgcmVzdWx0ID0gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcygoMCwgX2h0bWxfdXRpbHMuY3JlYXRlV3JhcHBlcikodGhpcywgaHRtbCksIGJib3gpOwoKICAgIGlmICh0aGlzLmJyZWFrQWZ0ZXIuY2hpbGRyZW4ubGVuZ3RoID49IDEpIHsKICAgICAgY29uc3QgYnJlYWtBZnRlciA9IHRoaXMuYnJlYWtBZnRlci5jaGlsZHJlblswXTsKCiAgICAgIGlmIChoYW5kbGVCcmVhayhicmVha0FmdGVyKSkgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5hZnRlckJyZWFrQWZ0ZXIgPSByZXN1bHQ7CiAgICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LmJyZWFrTm9kZShicmVha0FmdGVyKTsKICAgICAgfQogICAgfQoKICAgIGRlbGV0ZSB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV07CiAgICByZXR1cm4gcmVzdWx0OwogIH0KCn0KCmNsYXNzIFN1YmZvcm1TZXQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAic3ViZm9ybVNldCIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnJlbGF0aW9uID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucmVsYXRpb24sIFsib3JkZXJlZCIsICJjaG9pY2UiLCAidW5vcmRlcmVkIl0pOwogICAgdGhpcy5yZWxldmFudCA9ICgwLCBfdXRpbHMuZ2V0UmVsZXZhbnQpKGF0dHJpYnV0ZXMucmVsZXZhbnQpOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYm9va2VuZCA9IG51bGw7CiAgICB0aGlzLmJyZWFrID0gbnVsbDsKICAgIHRoaXMuZGVzYyA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLm9jY3VyID0gbnVsbDsKICAgIHRoaXMub3ZlcmZsb3cgPSBudWxsOwogICAgdGhpcy5icmVha0FmdGVyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmJyZWFrQmVmb3JlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnN1YmZvcm0gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc3ViZm9ybVNldCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCiAgKltfeGZhX29iamVjdC4kZ2V0Q29udGFpbmVkQ2hpbGRyZW5dKCkgewogICAgeWllbGQqIGdldENvbnRhaW5lZENoaWxkcmVuKHRoaXMpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSgpIHsKICAgIGxldCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgd2hpbGUgKCEocGFyZW50IGluc3RhbmNlb2YgU3ViZm9ybSkpIHsKICAgICAgcGFyZW50ID0gcGFyZW50W194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CiAgICB9CgogICAgcmV0dXJuIHBhcmVudDsKICB9CgogIFtfeGZhX29iamVjdC4kaXNCaW5kYWJsZV0oKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgpjbGFzcyBTdWJqZWN0RE4gZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInN1YmplY3RETiIpOwogICAgdGhpcy5kZWxpbWl0ZXIgPSBhdHRyaWJ1dGVzLmRlbGltaXRlciB8fCAiLCI7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gbmV3IE1hcCh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS5zcGxpdCh0aGlzLmRlbGltaXRlcikubWFwKGt2ID0+IHsKICAgICAga3YgPSBrdi5zcGxpdCgiPSIsIDIpOwogICAgICBrdlswXSA9IGt2WzBdLnRyaW0oKTsKICAgICAgcmV0dXJuIGt2OwogICAgfSkpOwogIH0KCn0KCmNsYXNzIFN1YmplY3RETnMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAic3ViamVjdEROcyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuc3ViamVjdEROID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgU3VibWl0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInN1Ym1pdCIsIHRydWUpOwogICAgdGhpcy5lbWJlZFBERiA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmVtYmVkUERGLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy5mb3JtYXQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5mb3JtYXQsIFsieGRwIiwgImZvcm1kYXRhIiwgInBkZiIsICJ1cmxlbmNvZGVkIiwgInhmZCIsICJ4bWwiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudGFyZ2V0ID0gYXR0cmlidXRlcy50YXJnZXQgfHwgIiI7CiAgICB0aGlzLnRleHRFbmNvZGluZyA9ICgwLCBfdXRpbHMuZ2V0S2V5d29yZCkoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnRleHRFbmNvZGluZyA/IGF0dHJpYnV0ZXMudGV4dEVuY29kaW5nLnRvTG93ZXJDYXNlKCkgOiAiIiwKICAgICAgZGVmYXVsdFZhbHVlOiAiIiwKICAgICAgdmFsaWRhdGU6IGsgPT4gWyJ1dGYtOCIsICJiaWctZml2ZSIsICJmb250c3BlY2lmaWMiLCAiZ2JrIiwgImdiLTE4MDMwIiwgImdiLTIzMTIiLCAia3NjLTU2MDEiLCAibm9uZSIsICJzaGlmdC1qaXMiLCAidWNzLTIiLCAidXRmLTE2Il0uaW5jbHVkZXMoaykgfHwgay5tYXRjaCgvaXNvLTg4NTktXGR7Mn0vKQogICAgfSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy54ZHBDb250ZW50ID0gYXR0cmlidXRlcy54ZHBDb250ZW50IHx8ICIiOwogICAgdGhpcy5lbmNyeXB0ID0gbnVsbDsKICAgIHRoaXMuZW5jcnlwdERhdGEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc2lnbkRhdGEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBUZW1wbGF0ZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJ0ZW1wbGF0ZSIsIHRydWUpOwogICAgdGhpcy5iYXNlUHJvZmlsZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmJhc2VQcm9maWxlLCBbImZ1bGwiLCAiaW50ZXJhY3RpdmVGb3JtcyJdKTsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMuc3ViZm9ybSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICBpZiAodGhpcy5zdWJmb3JtLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkgewogICAgICAoMCwgX3V0aWwud2FybikoIlhGQSAtIE5vIHN1YmZvcm1zIGluIHRlbXBsYXRlIG5vZGUuIik7CiAgICB9CgogICAgaWYgKHRoaXMuc3ViZm9ybS5jaGlsZHJlbi5sZW5ndGggPj0gMikgewogICAgICAoMCwgX3V0aWwud2FybikoIlhGQSAtIFNldmVyYWwgc3ViZm9ybXMgaW4gdGVtcGxhdGUgbm9kZTogcGxlYXNlIGZpbGUgYSBidWcuIik7CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kdGFiSW5kZXhdID0gREVGQVVMVF9UQUJfSU5ERVg7CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzU3BsaXR0YWJsZV0oKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIFtfeGZhX29iamVjdC4kc2VhcmNoTm9kZV0oZXhwciwgY29udGFpbmVyKSB7CiAgICBpZiAoZXhwci5zdGFydHNXaXRoKCIjIikpIHsKICAgICAgcmV0dXJuIFt0aGlzW194ZmFfb2JqZWN0LiRpZHNdLmdldChleHByLnNsaWNlKDEpKV07CiAgICB9CgogICAgcmV0dXJuICgwLCBfc29tLnNlYXJjaE5vZGUpKHRoaXMsIGNvbnRhaW5lciwgZXhwciwgdHJ1ZSwgdHJ1ZSk7CiAgfQoKICAqW194ZmFfb2JqZWN0LiR0b1BhZ2VzXSgpIHsKICAgIGlmICghdGhpcy5zdWJmb3JtLmNoaWxkcmVuLmxlbmd0aCkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgICAgbmFtZTogImRpdiIsCiAgICAgICAgY2hpbGRyZW46IFtdCiAgICAgIH0pOwogICAgfQoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9IHsKICAgICAgb3ZlcmZsb3dOb2RlOiBudWxsLAogICAgICBmaXJzdFVuc3BsaXR0YWJsZTogbnVsbCwKICAgICAgY3VycmVudENvbnRlbnRBcmVhOiBudWxsLAogICAgICBjdXJyZW50UGFnZUFyZWE6IG51bGwsCiAgICAgIG5vTGF5b3V0RmFpbHVyZTogZmFsc2UsCiAgICAgIHBhZ2VOdW1iZXI6IDEsCiAgICAgIHBhZ2VQb3NpdGlvbjogImZpcnN0IiwKICAgICAgb2RkT3JFdmVuOiAib2RkIiwKICAgICAgYmxhbmtPck5vdEJsYW5rOiAibm9uQmxhbmsiLAogICAgICBwYXJhU3RhY2s6IFtdCiAgICB9OwogICAgY29uc3Qgcm9vdCA9IHRoaXMuc3ViZm9ybS5jaGlsZHJlblswXTsKCiAgICByb290LnBhZ2VTZXRbX3hmYV9vYmplY3QuJGNsZWFuUGFnZV0oKTsKCiAgICBjb25zdCBwYWdlQXJlYXMgPSByb290LnBhZ2VTZXQucGFnZUFyZWEuY2hpbGRyZW47CiAgICBjb25zdCBtYWluSHRtbCA9IHsKICAgICAgbmFtZTogImRpdiIsCiAgICAgIGNoaWxkcmVuOiBbXQogICAgfTsKICAgIGxldCBwYWdlQXJlYSA9IG51bGw7CiAgICBsZXQgYnJlYWtCZWZvcmUgPSBudWxsOwogICAgbGV0IGJyZWFrQmVmb3JlVGFyZ2V0ID0gbnVsbDsKCiAgICBpZiAocm9vdC5icmVha0JlZm9yZS5jaGlsZHJlbi5sZW5ndGggPj0gMSkgewogICAgICBicmVha0JlZm9yZSA9IHJvb3QuYnJlYWtCZWZvcmUuY2hpbGRyZW5bMF07CiAgICAgIGJyZWFrQmVmb3JlVGFyZ2V0ID0gYnJlYWtCZWZvcmUudGFyZ2V0OwogICAgfSBlbHNlIGlmIChyb290LnN1YmZvcm0uY2hpbGRyZW4ubGVuZ3RoID49IDEgJiYgcm9vdC5zdWJmb3JtLmNoaWxkcmVuWzBdLmJyZWFrQmVmb3JlLmNoaWxkcmVuLmxlbmd0aCA+PSAxKSB7CiAgICAgIGJyZWFrQmVmb3JlID0gcm9vdC5zdWJmb3JtLmNoaWxkcmVuWzBdLmJyZWFrQmVmb3JlLmNoaWxkcmVuWzBdOwogICAgICBicmVha0JlZm9yZVRhcmdldCA9IGJyZWFrQmVmb3JlLnRhcmdldDsKICAgIH0gZWxzZSBpZiAocm9vdC5icmVhayAmJiByb290LmJyZWFrLmJlZm9yZVRhcmdldCkgewogICAgICBicmVha0JlZm9yZSA9IHJvb3QuYnJlYWs7CiAgICAgIGJyZWFrQmVmb3JlVGFyZ2V0ID0gYnJlYWtCZWZvcmUuYmVmb3JlVGFyZ2V0OwogICAgfSBlbHNlIGlmIChyb290LnN1YmZvcm0uY2hpbGRyZW4ubGVuZ3RoID49IDEgJiYgcm9vdC5zdWJmb3JtLmNoaWxkcmVuWzBdLmJyZWFrICYmIHJvb3Quc3ViZm9ybS5jaGlsZHJlblswXS5icmVhay5iZWZvcmVUYXJnZXQpIHsKICAgICAgYnJlYWtCZWZvcmUgPSByb290LnN1YmZvcm0uY2hpbGRyZW5bMF0uYnJlYWs7CiAgICAgIGJyZWFrQmVmb3JlVGFyZ2V0ID0gYnJlYWtCZWZvcmUuYmVmb3JlVGFyZ2V0OwogICAgfQoKICAgIGlmIChicmVha0JlZm9yZSkgewogICAgICBjb25zdCB0YXJnZXQgPSB0aGlzW194ZmFfb2JqZWN0LiRzZWFyY2hOb2RlXShicmVha0JlZm9yZVRhcmdldCwgYnJlYWtCZWZvcmVbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKSk7CgogICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgUGFnZUFyZWEpIHsKICAgICAgICBwYWdlQXJlYSA9IHRhcmdldDsKICAgICAgICBicmVha0JlZm9yZVtfeGZhX29iamVjdC4kZXh0cmFdID0ge307CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXBhZ2VBcmVhKSB7CiAgICAgIHBhZ2VBcmVhID0gcGFnZUFyZWFzWzBdOwogICAgfQoKICAgIHBhZ2VBcmVhW194ZmFfb2JqZWN0LiRleHRyYV0gPSB7CiAgICAgIG51bWJlck9mVXNlOiAxCiAgICB9OwoKICAgIGNvbnN0IHBhZ2VBcmVhUGFyZW50ID0gcGFnZUFyZWFbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBwYWdlQXJlYVBhcmVudFtfeGZhX29iamVjdC4kZXh0cmFdID0gewogICAgICBudW1iZXJPZlVzZTogMSwKICAgICAgcGFnZUluZGV4OiBwYWdlQXJlYVBhcmVudC5wYWdlQXJlYS5jaGlsZHJlbi5pbmRleE9mKHBhZ2VBcmVhKSwKICAgICAgcGFnZVNldEluZGV4OiAwCiAgICB9OwogICAgbGV0IHRhcmdldFBhZ2VBcmVhOwogICAgbGV0IGxlYWRlciA9IG51bGw7CiAgICBsZXQgdHJhaWxlciA9IG51bGw7CiAgICBsZXQgaGFzU29tZXRoaW5nID0gdHJ1ZTsKICAgIGxldCBoYXNTb21ldGhpbmdDb3VudGVyID0gMDsKICAgIGxldCBzdGFydEluZGV4ID0gMDsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBpZiAoIWhhc1NvbWV0aGluZykgewogICAgICAgIG1haW5IdG1sLmNoaWxkcmVuLnBvcCgpOwoKICAgICAgICBpZiAoKytoYXNTb21ldGhpbmdDb3VudGVyID09PSBNQVhfRU1QVFlfUEFHRVMpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiWEZBIC0gU29tZXRoaW5nIGdvZXMgd3Jvbmc6IHBsZWFzZSBmaWxlIGEgYnVnLiIpOwogICAgICAgICAgcmV0dXJuIG1haW5IdG1sOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBoYXNTb21ldGhpbmdDb3VudGVyID0gMDsKICAgICAgfQoKICAgICAgdGFyZ2V0UGFnZUFyZWEgPSBudWxsOwogICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uY3VycmVudFBhZ2VBcmVhID0gcGFnZUFyZWE7CgogICAgICBjb25zdCBwYWdlID0gcGFnZUFyZWFbX3hmYV9vYmplY3QuJHRvSFRNTF0oKS5odG1sOwoKICAgICAgbWFpbkh0bWwuY2hpbGRyZW4ucHVzaChwYWdlKTsKCiAgICAgIGlmIChsZWFkZXIpIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlID0gdHJ1ZTsKICAgICAgICBwYWdlLmNoaWxkcmVuLnB1c2gobGVhZGVyW194ZmFfb2JqZWN0LiR0b0hUTUxdKHBhZ2VBcmVhW194ZmFfb2JqZWN0LiRleHRyYV0uc3BhY2UpLmh0bWwpOwogICAgICAgIGxlYWRlciA9IG51bGw7CiAgICAgIH0KCiAgICAgIGlmICh0cmFpbGVyKSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSA9IHRydWU7CiAgICAgICAgcGFnZS5jaGlsZHJlbi5wdXNoKHRyYWlsZXJbX3hmYV9vYmplY3QuJHRvSFRNTF0ocGFnZUFyZWFbX3hmYV9vYmplY3QuJGV4dHJhXS5zcGFjZSkuaHRtbCk7CiAgICAgICAgdHJhaWxlciA9IG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IGNvbnRlbnRBcmVhcyA9IHBhZ2VBcmVhLmNvbnRlbnRBcmVhLmNoaWxkcmVuOwogICAgICBjb25zdCBodG1sQ29udGVudEFyZWFzID0gcGFnZS5jaGlsZHJlbi5maWx0ZXIobm9kZSA9PiBub2RlLmF0dHJpYnV0ZXMuY2xhc3MuaW5jbHVkZXMoInhmYUNvbnRlbnRhcmVhIikpOwogICAgICBoYXNTb21ldGhpbmcgPSBmYWxzZTsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmZpcnN0VW5zcGxpdHRhYmxlID0gbnVsbDsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSA9IGZhbHNlOwoKICAgICAgY29uc3QgZmx1c2ggPSBpbmRleCA9PiB7CiAgICAgICAgY29uc3QgaHRtbCA9IHJvb3RbX3hmYV9vYmplY3QuJGZsdXNoSFRNTF0oKTsKCiAgICAgICAgaWYgKGh0bWwpIHsKICAgICAgICAgIGhhc1NvbWV0aGluZyA9IGhhc1NvbWV0aGluZyB8fCBodG1sLmNoaWxkcmVuICYmIGh0bWwuY2hpbGRyZW4ubGVuZ3RoICE9PSAwOwogICAgICAgICAgaHRtbENvbnRlbnRBcmVhc1tpbmRleF0uY2hpbGRyZW4ucHVzaChodG1sKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBmb3IgKGxldCBpID0gc3RhcnRJbmRleCwgaWkgPSBjb250ZW50QXJlYXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbnN0IGNvbnRlbnRBcmVhID0gdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmN1cnJlbnRDb250ZW50QXJlYSA9IGNvbnRlbnRBcmVhc1tpXTsKICAgICAgICBjb25zdCBzcGFjZSA9IHsKICAgICAgICAgIHdpZHRoOiBjb250ZW50QXJlYS53LAogICAgICAgICAgaGVpZ2h0OiBjb250ZW50QXJlYS5oCiAgICAgICAgfTsKICAgICAgICBzdGFydEluZGV4ID0gMDsKCiAgICAgICAgaWYgKGxlYWRlcikgewogICAgICAgICAgaHRtbENvbnRlbnRBcmVhc1tpXS5jaGlsZHJlbi5wdXNoKGxlYWRlcltfeGZhX29iamVjdC4kdG9IVE1MXShzcGFjZSkuaHRtbCk7CiAgICAgICAgICBsZWFkZXIgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRyYWlsZXIpIHsKICAgICAgICAgIGh0bWxDb250ZW50QXJlYXNbaV0uY2hpbGRyZW4ucHVzaCh0cmFpbGVyW194ZmFfb2JqZWN0LiR0b0hUTUxdKHNwYWNlKS5odG1sKTsKICAgICAgICAgIHRyYWlsZXIgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgaHRtbCA9IHJvb3RbX3hmYV9vYmplY3QuJHRvSFRNTF0oc3BhY2UpOwoKICAgICAgICBpZiAoaHRtbC5zdWNjZXNzKSB7CiAgICAgICAgICBpZiAoaHRtbC5odG1sKSB7CiAgICAgICAgICAgIGhhc1NvbWV0aGluZyA9IGhhc1NvbWV0aGluZyB8fCBodG1sLmh0bWwuY2hpbGRyZW4gJiYgaHRtbC5odG1sLmNoaWxkcmVuLmxlbmd0aCAhPT0gMDsKICAgICAgICAgICAgaHRtbENvbnRlbnRBcmVhc1tpXS5jaGlsZHJlbi5wdXNoKGh0bWwuaHRtbCk7CiAgICAgICAgICB9IGVsc2UgaWYgKCFoYXNTb21ldGhpbmcgJiYgbWFpbkh0bWwuY2hpbGRyZW4ubGVuZ3RoID4gMSkgewogICAgICAgICAgICBtYWluSHRtbC5jaGlsZHJlbi5wb3AoKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbWFpbkh0bWw7CiAgICAgICAgfQoKICAgICAgICBpZiAoaHRtbC5pc0JyZWFrKCkpIHsKICAgICAgICAgIGNvbnN0IG5vZGUgPSBodG1sLmJyZWFrTm9kZTsKICAgICAgICAgIGZsdXNoKGkpOwoKICAgICAgICAgIGlmIChub2RlLnRhcmdldFR5cGUgPT09ICJhdXRvIikgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobm9kZS5sZWFkZXIpIHsKICAgICAgICAgICAgbGVhZGVyID0gdGhpc1tfeGZhX29iamVjdC4kc2VhcmNoTm9kZV0obm9kZS5sZWFkZXIsIG5vZGVbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKSk7CiAgICAgICAgICAgIGxlYWRlciA9IGxlYWRlciA/IGxlYWRlclswXSA6IG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG5vZGUudHJhaWxlcikgewogICAgICAgICAgICB0cmFpbGVyID0gdGhpc1tfeGZhX29iamVjdC4kc2VhcmNoTm9kZV0obm9kZS50cmFpbGVyLCBub2RlW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCkpOwogICAgICAgICAgICB0cmFpbGVyID0gdHJhaWxlciA/IHRyYWlsZXJbMF0gOiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChub2RlLnRhcmdldFR5cGUgPT09ICJwYWdlQXJlYSIpIHsKICAgICAgICAgICAgdGFyZ2V0UGFnZUFyZWEgPSBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0udGFyZ2V0OwogICAgICAgICAgICBpID0gSW5maW5pdHk7CiAgICAgICAgICB9IGVsc2UgaWYgKCFub2RlW194ZmFfb2JqZWN0LiRleHRyYV0udGFyZ2V0KSB7CiAgICAgICAgICAgIGkgPSBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uaW5kZXg7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0YXJnZXRQYWdlQXJlYSA9IG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS50YXJnZXQ7CiAgICAgICAgICAgIHN0YXJ0SW5kZXggPSBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uaW5kZXggKyAxOwogICAgICAgICAgICBpID0gSW5maW5pdHk7CiAgICAgICAgICB9CgogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLm92ZXJmbG93Tm9kZSkgewogICAgICAgICAgY29uc3Qgbm9kZSA9IHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5vdmVyZmxvd05vZGU7CiAgICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ub3ZlcmZsb3dOb2RlID0gbnVsbDsKCiAgICAgICAgICBjb25zdCBvdmVyZmxvd0V4dHJhID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0RXh0cmFdKCk7CgogICAgICAgICAgY29uc3QgdGFyZ2V0ID0gb3ZlcmZsb3dFeHRyYS50YXJnZXQ7CiAgICAgICAgICBvdmVyZmxvd0V4dHJhLmFkZExlYWRlciA9IG92ZXJmbG93RXh0cmEubGVhZGVyICE9PSBudWxsOwogICAgICAgICAgb3ZlcmZsb3dFeHRyYS5hZGRUcmFpbGVyID0gb3ZlcmZsb3dFeHRyYS50cmFpbGVyICE9PSBudWxsOwogICAgICAgICAgZmx1c2goaSk7CiAgICAgICAgICBjb25zdCBjdXJyZW50SW5kZXggPSBpOwogICAgICAgICAgaSA9IEluZmluaXR5OwoKICAgICAgICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBQYWdlQXJlYSkgewogICAgICAgICAgICB0YXJnZXRQYWdlQXJlYSA9IHRhcmdldDsKICAgICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0IGluc3RhbmNlb2YgQ29udGVudEFyZWEpIHsKICAgICAgICAgICAgY29uc3QgaW5kZXggPSBjb250ZW50QXJlYXMuaW5kZXhPZih0YXJnZXQpOwoKICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgICAgICAgIGlmIChpbmRleCA+IGN1cnJlbnRJbmRleCkgewogICAgICAgICAgICAgICAgaSA9IGluZGV4IC0gMTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3RhcnRJbmRleCA9IGluZGV4OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0YXJnZXRQYWdlQXJlYSA9IHRhcmdldFtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwogICAgICAgICAgICAgIHN0YXJ0SW5kZXggPSB0YXJnZXRQYWdlQXJlYS5jb250ZW50QXJlYS5jaGlsZHJlbi5pbmRleE9mKHRhcmdldCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGZsdXNoKGkpOwogICAgICB9CgogICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ucGFnZU51bWJlciArPSAxOwoKICAgICAgaWYgKHRhcmdldFBhZ2VBcmVhKSB7CiAgICAgICAgaWYgKHRhcmdldFBhZ2VBcmVhW194ZmFfb2JqZWN0LiRpc1VzYWJsZV0oKSkgewogICAgICAgICAgdGFyZ2V0UGFnZUFyZWFbX3hmYV9vYmplY3QuJGV4dHJhXS5udW1iZXJPZlVzZSArPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0YXJnZXRQYWdlQXJlYSA9IG51bGw7CiAgICAgICAgfQogICAgICB9CgogICAgICBwYWdlQXJlYSA9IHRhcmdldFBhZ2VBcmVhIHx8IHBhZ2VBcmVhW194ZmFfb2JqZWN0LiRnZXROZXh0UGFnZV0oKTsKICAgICAgeWllbGQgbnVsbDsKICAgIH0KICB9Cgp9CgpleHBvcnRzLlRlbXBsYXRlID0gVGVtcGxhdGU7CgpjbGFzcyBUZXh0IGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJ0ZXh0Iik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubWF4Q2hhcnMgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5tYXhDaGFycywKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAKICAgIH0pOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5yaWQgPSBhdHRyaWJ1dGVzLnJpZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKICBbX3hmYV9vYmplY3QuJGFjY2VwdFdoaXRlc3BhY2VdKCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBbX3hmYV9vYmplY3QuJG9uQ2hpbGRdKGNoaWxkKSB7CiAgICBpZiAoY2hpbGRbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXSA9PT0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLnhodG1sLmlkKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gY2hpbGQ7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gSW52YWxpZCBjb250ZW50IGluIFRleHQ6ICR7Y2hpbGRbX3hmYV9vYmplY3QuJG5vZGVOYW1lXX0uYCk7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBbX3hmYV9vYmplY3QuJG9uVGV4dF0oc3RyKSB7CiAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFPYmplY3QpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHN1cGVyW194ZmFfb2JqZWN0LiRvblRleHRdKHN0cik7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIGlmICh0eXBlb2YgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPT09ICJzdHJpbmciKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0ucmVwbGFjZSgvXHJcbi9nLCAiXG4iKTsKICAgIH0KICB9CgogIFtfeGZhX29iamVjdC4kZ2V0RXh0cmFdKCkgewogICAgaWYgKHR5cGVvZiB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9PT0gInN0cmluZyIpIHsKICAgICAgcmV0dXJuIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnNwbGl0KC9bXHUyMDI5XHUyMDI4XG5dLykucmVkdWNlKChhY2MsIGxpbmUpID0+IHsKICAgICAgICBpZiAobGluZSkgewogICAgICAgICAgYWNjLnB1c2gobGluZSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYWNjOwogICAgICB9LCBbXSkuam9pbigiXG4iKTsKICAgIH0KCiAgICByZXR1cm4gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF1bX3hmYV9vYmplY3QuJHRleHRdKCk7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGlmICh0eXBlb2YgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPT09ICJzdHJpbmciKSB7CiAgICAgIGNvbnN0IGh0bWwgPSB2YWx1ZVRvSHRtbCh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSkuaHRtbDsKCiAgICAgIGlmICh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS5pbmNsdWRlcygiXHUyMDI5IikpIHsKICAgICAgICBodG1sLm5hbWUgPSAiZGl2IjsKICAgICAgICBodG1sLmNoaWxkcmVuID0gW107CgogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnNwbGl0KCJcdTIwMjkiKS5tYXAocGFyYSA9PiBwYXJhLnNwbGl0KC9bXHUyMDI4XG5dLykucmVkdWNlKChhY2MsIGxpbmUpID0+IHsKICAgICAgICAgIGFjYy5wdXNoKHsKICAgICAgICAgICAgbmFtZTogInNwYW4iLAogICAgICAgICAgICB2YWx1ZTogbGluZQogICAgICAgICAgfSwgewogICAgICAgICAgICBuYW1lOiAiYnIiCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBhY2M7CiAgICAgICAgfSwgW10pKS5mb3JFYWNoKGxpbmVzID0+IHsKICAgICAgICAgIGh0bWwuY2hpbGRyZW4ucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICJwIiwKICAgICAgICAgICAgY2hpbGRyZW46IGxpbmVzCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICgvW1x1MjAyOFxuXS8udGVzdCh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSkpIHsKICAgICAgICBodG1sLm5hbWUgPSAiZGl2IjsKICAgICAgICBodG1sLmNoaWxkcmVuID0gW107CgogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnNwbGl0KC9bXHUyMDI4XG5dLykuZm9yRWFjaChsaW5lID0+IHsKICAgICAgICAgIGh0bWwuY2hpbGRyZW4ucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICJzcGFuIiwKICAgICAgICAgICAgdmFsdWU6IGxpbmUKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbmFtZTogImJyIgogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKGh0bWwpOwogICAgfQoKICAgIHJldHVybiB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XVtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSk7CiAgfQoKfQoKZXhwb3J0cy5UZXh0ID0gVGV4dDsKCmNsYXNzIFRleHRFZGl0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInRleHRFZGl0IiwgdHJ1ZSk7CiAgICB0aGlzLmFsbG93UmljaFRleHQgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5hbGxvd1JpY2hUZXh0LAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy5oU2Nyb2xsUG9saWN5ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaFNjcm9sbFBvbGljeSwgWyJhdXRvIiwgIm9mZiIsICJvbiJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5tdWx0aUxpbmUgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5tdWx0aUxpbmUsCiAgICAgIGRlZmF1bHRWYWx1ZTogIiIsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDAgfHwgeCA9PT0gMQogICAgfSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy52U2Nyb2xsUG9saWN5ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudlNjcm9sbFBvbGljeSwgWyJhdXRvIiwgIm9mZiIsICJvbiJdKTsKICAgIHRoaXMuYm9yZGVyID0gbnVsbDsKICAgIHRoaXMuY29tYiA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLm1hcmdpbiA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJib3JkZXIiLCAiZm9udCIsICJtYXJnaW4iKTsKICAgIGxldCBodG1sOwoKICAgIGNvbnN0IGZpZWxkID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgaWYgKHRoaXMubXVsdGlMaW5lID09PSAiIikgewogICAgICB0aGlzLm11bHRpTGluZSA9IGZpZWxkIGluc3RhbmNlb2YgRHJhdyA/IDEgOiAwOwogICAgfQoKICAgIGlmICh0aGlzLm11bHRpTGluZSA9PT0gMSkgewogICAgICBodG1sID0gewogICAgICAgIG5hbWU6ICJ0ZXh0YXJlYSIsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgZGF0YUlkOiBmaWVsZFtfeGZhX29iamVjdC4kZGF0YV0gJiYgZmllbGRbX3hmYV9vYmplY3QuJGRhdGFdW194ZmFfb2JqZWN0LiR1aWRdIHx8IGZpZWxkW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICAgICAgZmllbGRJZDogZmllbGRbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgICAgICBjbGFzczogWyJ4ZmFUZXh0ZmllbGQiXSwKICAgICAgICAgIHN0eWxlLAogICAgICAgICAgImFyaWEtbGFiZWwiOiBhcmlhTGFiZWwoZmllbGQpLAogICAgICAgICAgImFyaWEtcmVxdWlyZWQiOiBmYWxzZQogICAgICAgIH0KICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIGh0bWwgPSB7CiAgICAgICAgbmFtZTogImlucHV0IiwKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICB0eXBlOiAidGV4dCIsCiAgICAgICAgICBkYXRhSWQ6IGZpZWxkW194ZmFfb2JqZWN0LiRkYXRhXSAmJiBmaWVsZFtfeGZhX29iamVjdC4kZGF0YV1bX3hmYV9vYmplY3QuJHVpZF0gfHwgZmllbGRbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgICAgICBmaWVsZElkOiBmaWVsZFtfeGZhX29iamVjdC4kdWlkXSwKICAgICAgICAgIGNsYXNzOiBbInhmYVRleHRmaWVsZCJdLAogICAgICAgICAgc3R5bGUsCiAgICAgICAgICAiYXJpYS1sYWJlbCI6IGFyaWFMYWJlbChmaWVsZCksCiAgICAgICAgICAiYXJpYS1yZXF1aXJlZCI6IGZhbHNlCiAgICAgICAgfQogICAgICB9OwogICAgfQoKICAgIGlmIChpc1JlcXVpcmVkKGZpZWxkKSkgewogICAgICBodG1sLmF0dHJpYnV0ZXNbImFyaWEtcmVxdWlyZWQiXSA9IHRydWU7CiAgICAgIGh0bWwuYXR0cmlidXRlcy5yZXF1aXJlZCA9IHRydWU7CiAgICB9CgogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICBuYW1lOiAibGFiZWwiLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgY2xhc3M6IFsieGZhTGFiZWwiXQogICAgICB9LAogICAgICBjaGlsZHJlbjogW2h0bWxdCiAgICB9KTsKICB9Cgp9CgpjbGFzcyBUaW1lIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInRpbWUiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgY29uc3QgZGF0ZSA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKTsKCiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IGRhdGUgPyBuZXcgRGF0ZShkYXRlKSA6IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIHJldHVybiB2YWx1ZVRvSHRtbCh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA/IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRvU3RyaW5nKCkgOiAiIik7CiAgfQoKfQoKY2xhc3MgVGltZVN0YW1wIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInRpbWVTdGFtcCIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnNlcnZlciA9IGF0dHJpYnV0ZXMuc2VydmVyIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgVG9vbFRpcCBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJ0b29sVGlwIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMucmlkID0gYXR0cmlidXRlcy5yaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIFRyYXZlcnNhbCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJ0cmF2ZXJzYWwiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMudHJhdmVyc2UgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBUcmF2ZXJzZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJ0cmF2ZXJzZSIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm9wZXJhdGlvbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm9wZXJhdGlvbiwgWyJuZXh0IiwgImJhY2siLCAiZG93biIsICJmaXJzdCIsICJsZWZ0IiwgInJpZ2h0IiwgInVwIl0pOwogICAgdGhpcy5yZWYgPSBhdHRyaWJ1dGVzLnJlZiB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLnNjcmlwdCA9IG51bGw7CiAgfQoKICBnZXQgbmFtZSgpIHsKICAgIHJldHVybiB0aGlzLm9wZXJhdGlvbjsKICB9CgogIFtfeGZhX29iamVjdC4kaXNUcmFuc3BhcmVudF0oKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKfQoKY2xhc3MgVWkgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAidWkiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMucGljdHVyZSA9IG51bGw7CiAgICB0aGlzLmJhcmNvZGUgPSBudWxsOwogICAgdGhpcy5idXR0b24gPSBudWxsOwogICAgdGhpcy5jaGVja0J1dHRvbiA9IG51bGw7CiAgICB0aGlzLmNob2ljZUxpc3QgPSBudWxsOwogICAgdGhpcy5kYXRlVGltZUVkaXQgPSBudWxsOwogICAgdGhpcy5kZWZhdWx0VWkgPSBudWxsOwogICAgdGhpcy5pbWFnZUVkaXQgPSBudWxsOwogICAgdGhpcy5udW1lcmljRWRpdCA9IG51bGw7CiAgICB0aGlzLnBhc3N3b3JkRWRpdCA9IG51bGw7CiAgICB0aGlzLnNpZ25hdHVyZSA9IG51bGw7CiAgICB0aGlzLnRleHRFZGl0ID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kZ2V0RXh0cmFdKCkgewogICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkgewogICAgICAgIGlmIChuYW1lID09PSAiZXh0cmFzIiB8fCBuYW1lID09PSAicGljdHVyZSIpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgb2JqID0gdGhpc1tuYW1lXTsKCiAgICAgICAgaWYgKCEob2JqIGluc3RhbmNlb2YgX3hmYV9vYmplY3QuWEZBT2JqZWN0KSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSBvYmo7CiAgICAgICAgcmV0dXJuIG9iajsKICAgICAgfQoKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gbnVsbDsKICAgIH0KCiAgICByZXR1cm4gdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBjb25zdCBvYmogPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRFeHRyYV0oKTsKCiAgICBpZiAob2JqKSB7CiAgICAgIHJldHVybiBvYmpbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpOwogICAgfQoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICB9Cgp9CgpjbGFzcyBWYWxpZGF0ZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJ2YWxpZGF0ZSIsIHRydWUpOwogICAgdGhpcy5mb3JtYXRUZXN0ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuZm9ybWF0VGVzdCwgWyJ3YXJuaW5nIiwgImRpc2FibGVkIiwgImVycm9yIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm51bGxUZXN0ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMubnVsbFRlc3QsIFsiZGlzYWJsZWQiLCAiZXJyb3IiLCAid2FybmluZyJdKTsKICAgIHRoaXMuc2NyaXB0VGVzdCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnNjcmlwdFRlc3QsIFsiZXJyb3IiLCAiZGlzYWJsZWQiLCAid2FybmluZyJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLm1lc3NhZ2UgPSBudWxsOwogICAgdGhpcy5waWN0dXJlID0gbnVsbDsKICAgIHRoaXMuc2NyaXB0ID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBWYWx1ZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJ2YWx1ZSIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm92ZXJyaWRlID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMub3ZlcnJpZGUsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMQogICAgfSk7CiAgICB0aGlzLnJlbGV2YW50ID0gKDAsIF91dGlscy5nZXRSZWxldmFudCkoYXR0cmlidXRlcy5yZWxldmFudCk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5hcmMgPSBudWxsOwogICAgdGhpcy5ib29sZWFuID0gbnVsbDsKICAgIHRoaXMuZGF0ZSA9IG51bGw7CiAgICB0aGlzLmRhdGVUaW1lID0gbnVsbDsKICAgIHRoaXMuZGVjaW1hbCA9IG51bGw7CiAgICB0aGlzLmV4RGF0YSA9IG51bGw7CiAgICB0aGlzLmZsb2F0ID0gbnVsbDsKICAgIHRoaXMuaW1hZ2UgPSBudWxsOwogICAgdGhpcy5pbnRlZ2VyID0gbnVsbDsKICAgIHRoaXMubGluZSA9IG51bGw7CiAgICB0aGlzLnJlY3RhbmdsZSA9IG51bGw7CiAgICB0aGlzLnRleHQgPSBudWxsOwogICAgdGhpcy50aW1lID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kc2V0VmFsdWVdKHZhbHVlKSB7CiAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIEZpZWxkKSB7CiAgICAgIGlmIChwYXJlbnQudWkgJiYgcGFyZW50LnVpLmltYWdlRWRpdCkgewogICAgICAgIGlmICghdGhpcy5pbWFnZSkgewogICAgICAgICAgdGhpcy5pbWFnZSA9IG5ldyBJbWFnZSh7fSk7CgogICAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKHRoaXMuaW1hZ2UpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5pbWFnZVtfeGZhX29iamVjdC4kY29udGVudF0gPSB2YWx1ZVtfeGZhX29iamVjdC4kY29udGVudF07CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CgogICAgY29uc3QgdmFsdWVOYW1lID0gdmFsdWVbX3hmYV9vYmplY3QuJG5vZGVOYW1lXTsKCiAgICBpZiAodGhpc1t2YWx1ZU5hbWVdICE9PSBudWxsKSB7CiAgICAgIHRoaXNbdmFsdWVOYW1lXVtfeGZhX29iamVjdC4kY29udGVudF0gPSB2YWx1ZVtfeGZhX29iamVjdC4kY29udGVudF07CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBmb3IgKGNvbnN0IG5hbWUgb2YgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykpIHsKICAgICAgY29uc3Qgb2JqID0gdGhpc1tuYW1lXTsKCiAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFPYmplY3QpIHsKICAgICAgICB0aGlzW25hbWVdID0gbnVsbDsKCiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kcmVtb3ZlQ2hpbGRdKG9iaik7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzW3ZhbHVlW194ZmFfb2JqZWN0LiRub2RlTmFtZV1dID0gdmFsdWU7CgogICAgdGhpc1tfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKHZhbHVlKTsKICB9CgogIFtfeGZhX29iamVjdC4kdGV4dF0oKSB7CiAgICBpZiAodGhpcy5leERhdGEpIHsKICAgICAgaWYgKHR5cGVvZiB0aGlzLmV4RGF0YVtfeGZhX29iamVjdC4kY29udGVudF0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZXhEYXRhW194ZmFfb2JqZWN0LiRjb250ZW50XS50cmltKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmV4RGF0YVtfeGZhX29iamVjdC4kY29udGVudF1bX3hmYV9vYmplY3QuJHRleHRdKCkudHJpbSgpOwogICAgfQoKICAgIGZvciAoY29uc3QgbmFtZSBvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkgewogICAgICBpZiAobmFtZSA9PT0gImltYWdlIikgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBvYmogPSB0aGlzW25hbWVdOwoKICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF94ZmFfb2JqZWN0LlhGQU9iamVjdCkgewogICAgICAgIHJldHVybiAob2JqW194ZmFfb2JqZWN0LiRjb250ZW50XSB8fCAiIikudG9TdHJpbmcoKS50cmltKCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgZm9yIChjb25zdCBuYW1lIG9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKSB7CiAgICAgIGNvbnN0IG9iaiA9IHRoaXNbbmFtZV07CgogICAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFPYmplY3QpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBvYmpbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpOwogICAgfQoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICB9Cgp9CgpleHBvcnRzLlZhbHVlID0gVmFsdWU7CgpjbGFzcyBWYXJpYWJsZXMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAidmFyaWFibGVzIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmJvb2xlYW4gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGF0ZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kYXRlVGltZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kZWNpbWFsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4RGF0YSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5mbG9hdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbWFnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbnRlZ2VyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLm1hbmlmZXN0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnNjcmlwdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy50ZXh0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRpbWUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9CgogIFtfeGZhX29iamVjdC4kaXNUcmFuc3BhcmVudF0oKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgpjbGFzcyBUZW1wbGF0ZU5hbWVzcGFjZSB7CiAgc3RhdGljIFtfbmFtZXNwYWNlcy4kYnVpbGRYRkFPYmplY3RdKG5hbWUsIGF0dHJpYnV0ZXMpIHsKICAgIGlmIChUZW1wbGF0ZU5hbWVzcGFjZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICBjb25zdCBub2RlID0gVGVtcGxhdGVOYW1lc3BhY2VbbmFtZV0oYXR0cmlidXRlcyk7CgogICAgICBub2RlW194ZmFfb2JqZWN0LiRzZXRTZXRBdHRyaWJ1dGVzXShhdHRyaWJ1dGVzKTsKCiAgICAgIHJldHVybiBub2RlOwogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBzdGF0aWMgYXBwZWFyYW5jZUZpbHRlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBBcHBlYXJhbmNlRmlsdGVyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBhcmMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQXJjKGF0dHJzKTsKICB9CgogIHN0YXRpYyBhcmVhKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEFyZWEoYXR0cnMpOwogIH0KCiAgc3RhdGljIGFzc2lzdChhdHRycykgewogICAgcmV0dXJuIG5ldyBBc3Npc3QoYXR0cnMpOwogIH0KCiAgc3RhdGljIGJhcmNvZGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQmFyY29kZShhdHRycyk7CiAgfQoKICBzdGF0aWMgYmluZChhdHRycykgewogICAgcmV0dXJuIG5ldyBCaW5kKGF0dHJzKTsKICB9CgogIHN0YXRpYyBiaW5kSXRlbXMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQmluZEl0ZW1zKGF0dHJzKTsKICB9CgogIHN0YXRpYyBib29rZW5kKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJvb2tlbmQoYXR0cnMpOwogIH0KCiAgc3RhdGljIGJvb2xlYW4oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQm9vbGVhbkVsZW1lbnQoYXR0cnMpOwogIH0KCiAgc3RhdGljIGJvcmRlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBCb3JkZXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIGJyZWFrKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJyZWFrKGF0dHJzKTsKICB9CgogIHN0YXRpYyBicmVha0FmdGVyKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJyZWFrQWZ0ZXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIGJyZWFrQmVmb3JlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJyZWFrQmVmb3JlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBidXR0b24oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQnV0dG9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjYWxjdWxhdGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ2FsY3VsYXRlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjYXB0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENhcHRpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIGNlcnRpZmljYXRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENlcnRpZmljYXRlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjZXJ0aWZpY2F0ZXMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ2VydGlmaWNhdGVzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjaGVja0J1dHRvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBDaGVja0J1dHRvbihhdHRycyk7CiAgfQoKICBzdGF0aWMgY2hvaWNlTGlzdChhdHRycykgewogICAgcmV0dXJuIG5ldyBDaG9pY2VMaXN0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb2xvcihhdHRycykgewogICAgcmV0dXJuIG5ldyBDb2xvcihhdHRycyk7CiAgfQoKICBzdGF0aWMgY29tYihhdHRycykgewogICAgcmV0dXJuIG5ldyBDb21iKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb25uZWN0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENvbm5lY3QoYXR0cnMpOwogIH0KCiAgc3RhdGljIGNvbnRlbnRBcmVhKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENvbnRlbnRBcmVhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb3JuZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29ybmVyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkYXRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERhdGVFbGVtZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBkYXRlVGltZShhdHRycykgewogICAgcmV0dXJuIG5ldyBEYXRlVGltZShhdHRycyk7CiAgfQoKICBzdGF0aWMgZGF0ZVRpbWVFZGl0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERhdGVUaW1lRWRpdChhdHRycyk7CiAgfQoKICBzdGF0aWMgZGVjaW1hbChhdHRycykgewogICAgcmV0dXJuIG5ldyBEZWNpbWFsKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkZWZhdWx0VWkoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGVmYXVsdFVpKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkZXNjKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERlc2MoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRpZ2VzdE1ldGhvZChhdHRycykgewogICAgcmV0dXJuIG5ldyBEaWdlc3RNZXRob2QoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRpZ2VzdE1ldGhvZHMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGlnZXN0TWV0aG9kcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgZHJhdyhhdHRycykgewogICAgcmV0dXJuIG5ldyBEcmF3KGF0dHJzKTsKICB9CgogIHN0YXRpYyBlZGdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVkZ2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVuY29kaW5nKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVuY29kaW5nKGF0dHJzKTsKICB9CgogIHN0YXRpYyBlbmNvZGluZ3MoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRW5jb2RpbmdzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBlbmNyeXB0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVuY3J5cHQoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVuY3J5cHREYXRhKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVuY3J5cHREYXRhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBlbmNyeXB0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVuY3J5cHRpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIGVuY3J5cHRpb25NZXRob2QoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRW5jcnlwdGlvbk1ldGhvZChhdHRycyk7CiAgfQoKICBzdGF0aWMgZW5jcnlwdGlvbk1ldGhvZHMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRW5jcnlwdGlvbk1ldGhvZHMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGV2ZW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEV2ZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBleERhdGEoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRXhEYXRhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBleE9iamVjdChhdHRycykgewogICAgcmV0dXJuIG5ldyBFeE9iamVjdChhdHRycyk7CiAgfQoKICBzdGF0aWMgZXhjbEdyb3VwKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEV4Y2xHcm91cChhdHRycyk7CiAgfQoKICBzdGF0aWMgZXhlY3V0ZShhdHRycykgewogICAgcmV0dXJuIG5ldyBFeGVjdXRlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBleHRyYXMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRXh0cmFzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBmaWVsZChhdHRycykgewogICAgcmV0dXJuIG5ldyBGaWVsZChhdHRycyk7CiAgfQoKICBzdGF0aWMgZmlsbChhdHRycykgewogICAgcmV0dXJuIG5ldyBGaWxsKGF0dHJzKTsKICB9CgogIHN0YXRpYyBmaWx0ZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRmlsdGVyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBmbG9hdChhdHRycykgewogICAgcmV0dXJuIG5ldyBGbG9hdChhdHRycyk7CiAgfQoKICBzdGF0aWMgZm9udChhdHRycykgewogICAgcmV0dXJuIG5ldyBGb250KGF0dHJzKTsKICB9CgogIHN0YXRpYyBmb3JtYXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRm9ybWF0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBoYW5kbGVyKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEhhbmRsZXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIGh5cGhlbmF0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEh5cGhlbmF0aW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBpbWFnZShhdHRycykgewogICAgcmV0dXJuIG5ldyBJbWFnZShhdHRycyk7CiAgfQoKICBzdGF0aWMgaW1hZ2VFZGl0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEltYWdlRWRpdChhdHRycyk7CiAgfQoKICBzdGF0aWMgaW50ZWdlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBJbnRlZ2VyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBpc3N1ZXJzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IElzc3VlcnMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGl0ZW1zKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEl0ZW1zKGF0dHJzKTsKICB9CgogIHN0YXRpYyBrZWVwKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEtlZXAoYXR0cnMpOwogIH0KCiAgc3RhdGljIGtleVVzYWdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEtleVVzYWdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsaW5lKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IExpbmUoYXR0cnMpOwogIH0KCiAgc3RhdGljIGxpbmVhcihhdHRycykgewogICAgcmV0dXJuIG5ldyBMaW5lYXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIGxvY2tEb2N1bWVudChhdHRycykgewogICAgcmV0dXJuIG5ldyBMb2NrRG9jdW1lbnQoYXR0cnMpOwogIH0KCiAgc3RhdGljIG1hbmlmZXN0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1hbmlmZXN0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBtYXJnaW4oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTWFyZ2luKGF0dHJzKTsKICB9CgogIHN0YXRpYyBtZHAoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTWRwKGF0dHJzKTsKICB9CgogIHN0YXRpYyBtZWRpdW0oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTWVkaXVtKGF0dHJzKTsKICB9CgogIHN0YXRpYyBtZXNzYWdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1lc3NhZ2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIG51bWVyaWNFZGl0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE51bWVyaWNFZGl0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBvY2N1cihhdHRycykgewogICAgcmV0dXJuIG5ldyBPY2N1cihhdHRycyk7CiAgfQoKICBzdGF0aWMgb2lkKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE9pZChhdHRycyk7CiAgfQoKICBzdGF0aWMgb2lkcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBPaWRzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBvdmVyZmxvdyhhdHRycykgewogICAgcmV0dXJuIG5ldyBPdmVyZmxvdyhhdHRycyk7CiAgfQoKICBzdGF0aWMgcGFnZUFyZWEoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGFnZUFyZWEoYXR0cnMpOwogIH0KCiAgc3RhdGljIHBhZ2VTZXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGFnZVNldChhdHRycyk7CiAgfQoKICBzdGF0aWMgcGFyYShhdHRycykgewogICAgcmV0dXJuIG5ldyBQYXJhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwYXNzd29yZEVkaXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGFzc3dvcmRFZGl0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBwYXR0ZXJuKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBhdHRlcm4oYXR0cnMpOwogIH0KCiAgc3RhdGljIHBpY3R1cmUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGljdHVyZShhdHRycyk7CiAgfQoKICBzdGF0aWMgcHJvdG8oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUHJvdG8oYXR0cnMpOwogIH0KCiAgc3RhdGljIHJhZGlhbChhdHRycykgewogICAgcmV0dXJuIG5ldyBSYWRpYWwoYXR0cnMpOwogIH0KCiAgc3RhdGljIHJlYXNvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBSZWFzb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIHJlYXNvbnMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUmVhc29ucyhhdHRycyk7CiAgfQoKICBzdGF0aWMgcmVjdGFuZ2xlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFJlY3RhbmdsZShhdHRycyk7CiAgfQoKICBzdGF0aWMgcmVmKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFJlZkVsZW1lbnQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHNjcmlwdChhdHRycykgewogICAgcmV0dXJuIG5ldyBTY3JpcHQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHNldFByb3BlcnR5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFNldFByb3BlcnR5KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzaWduRGF0YShhdHRycykgewogICAgcmV0dXJuIG5ldyBTaWduRGF0YShhdHRycyk7CiAgfQoKICBzdGF0aWMgc2lnbmF0dXJlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFNpZ25hdHVyZShhdHRycyk7CiAgfQoKICBzdGF0aWMgc2lnbmluZyhhdHRycykgewogICAgcmV0dXJuIG5ldyBTaWduaW5nKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzb2xpZChhdHRycykgewogICAgcmV0dXJuIG5ldyBTb2xpZChhdHRycyk7CiAgfQoKICBzdGF0aWMgc3BlYWsoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3BlYWsoYXR0cnMpOwogIH0KCiAgc3RhdGljIHN0aXBwbGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3RpcHBsZShhdHRycyk7CiAgfQoKICBzdGF0aWMgc3ViZm9ybShhdHRycykgewogICAgcmV0dXJuIG5ldyBTdWJmb3JtKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdWJmb3JtU2V0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFN1YmZvcm1TZXQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHN1YmplY3RETihhdHRycykgewogICAgcmV0dXJuIG5ldyBTdWJqZWN0RE4oYXR0cnMpOwogIH0KCiAgc3RhdGljIHN1YmplY3RETnMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3ViamVjdEROcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgc3VibWl0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFN1Ym1pdChhdHRycyk7CiAgfQoKICBzdGF0aWMgdGVtcGxhdGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVGVtcGxhdGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRleHQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVGV4dChhdHRycyk7CiAgfQoKICBzdGF0aWMgdGV4dEVkaXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVGV4dEVkaXQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRpbWUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVGltZShhdHRycyk7CiAgfQoKICBzdGF0aWMgdGltZVN0YW1wKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRpbWVTdGFtcChhdHRycyk7CiAgfQoKICBzdGF0aWMgdG9vbFRpcChhdHRycykgewogICAgcmV0dXJuIG5ldyBUb29sVGlwKGF0dHJzKTsKICB9CgogIHN0YXRpYyB0cmF2ZXJzYWwoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVHJhdmVyc2FsKGF0dHJzKTsKICB9CgogIHN0YXRpYyB0cmF2ZXJzZShhdHRycykgewogICAgcmV0dXJuIG5ldyBUcmF2ZXJzZShhdHRycyk7CiAgfQoKICBzdGF0aWMgdWkoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVWkoYXR0cnMpOwogIH0KCiAgc3RhdGljIHZhbGlkYXRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFZhbGlkYXRlKGF0dHJzKTsKICB9CgogIHN0YXRpYyB2YWx1ZShhdHRycykgewogICAgcmV0dXJuIG5ldyBWYWx1ZShhdHRycyk7CiAgfQoKICBzdGF0aWMgdmFyaWFibGVzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFZhcmlhYmxlcyhhdHRycyk7CiAgfQoKfQoKZXhwb3J0cy5UZW1wbGF0ZU5hbWVzcGFjZSA9IFRlbXBsYXRlTmFtZXNwYWNlOwoKLyoqKi8gfSksCi8qIDIwOCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuYWRkSFRNTCA9IGFkZEhUTUw7CmV4cG9ydHMuY2hlY2tEaW1lbnNpb25zID0gY2hlY2tEaW1lbnNpb25zOwpleHBvcnRzLmZsdXNoSFRNTCA9IGZsdXNoSFRNTDsKZXhwb3J0cy5nZXRBdmFpbGFibGVTcGFjZSA9IGdldEF2YWlsYWJsZVNwYWNlOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDIpOwoKdmFyIF9odG1sX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDkpOwoKZnVuY3Rpb24gY3JlYXRlTGluZShub2RlLCBjaGlsZHJlbikgewogIHJldHVybiB7CiAgICBuYW1lOiAiZGl2IiwKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgY2xhc3M6IFtub2RlLmxheW91dCA9PT0gImxyLXRiIiA/ICJ4ZmFMciIgOiAieGZhUmwiXQogICAgfSwKICAgIGNoaWxkcmVuCiAgfTsKfQoKZnVuY3Rpb24gZmx1c2hIVE1MKG5vZGUpIHsKICBpZiAoIW5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXSkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBjb25zdCBhdHRyaWJ1dGVzID0gbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLmF0dHJpYnV0ZXM7CiAgY29uc3QgaHRtbCA9IHsKICAgIG5hbWU6ICJkaXYiLAogICAgYXR0cmlidXRlcywKICAgIGNoaWxkcmVuOiBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uY2hpbGRyZW4KICB9OwoKICBpZiAobm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLmZhaWxpbmdOb2RlKSB7CiAgICBjb25zdCBodG1sRnJvbUZhaWxpbmcgPSBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uZmFpbGluZ05vZGVbX3hmYV9vYmplY3QuJGZsdXNoSFRNTF0oKTsKCiAgICBpZiAoaHRtbEZyb21GYWlsaW5nKSB7CiAgICAgIGlmIChub2RlLmxheW91dC5lbmRzV2l0aCgiLXRiIikpIHsKICAgICAgICBodG1sLmNoaWxkcmVuLnB1c2goY3JlYXRlTGluZShub2RlLCBbaHRtbEZyb21GYWlsaW5nXSkpOwogICAgICB9IGVsc2UgewogICAgICAgIGh0bWwuY2hpbGRyZW4ucHVzaChodG1sRnJvbUZhaWxpbmcpOwogICAgICB9CiAgICB9CiAgfQoKICBpZiAoaHRtbC5jaGlsZHJlbi5sZW5ndGggPT09IDApIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgcmV0dXJuIGh0bWw7Cn0KCmZ1bmN0aW9uIGFkZEhUTUwobm9kZSwgaHRtbCwgYmJveCkgewogIGNvbnN0IGV4dHJhID0gbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdOwogIGNvbnN0IGF2YWlsYWJsZVNwYWNlID0gZXh0cmEuYXZhaWxhYmxlU3BhY2U7CiAgY29uc3QgW3gsIHksIHcsIGhdID0gYmJveDsKCiAgc3dpdGNoIChub2RlLmxheW91dCkgewogICAgY2FzZSAicG9zaXRpb24iOgogICAgICB7CiAgICAgICAgZXh0cmEud2lkdGggPSBNYXRoLm1heChleHRyYS53aWR0aCwgeCArIHcpOwogICAgICAgIGV4dHJhLmhlaWdodCA9IE1hdGgubWF4KGV4dHJhLmhlaWdodCwgeSArIGgpOwogICAgICAgIGV4dHJhLmNoaWxkcmVuLnB1c2goaHRtbCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICBjYXNlICJsci10YiI6CiAgICBjYXNlICJybC10YiI6CiAgICAgIGlmICghZXh0cmEubGluZSB8fCBleHRyYS5hdHRlbXB0ID09PSAxKSB7CiAgICAgICAgZXh0cmEubGluZSA9IGNyZWF0ZUxpbmUobm9kZSwgW10pOwogICAgICAgIGV4dHJhLmNoaWxkcmVuLnB1c2goZXh0cmEubGluZSk7CiAgICAgICAgZXh0cmEubnVtYmVySW5MaW5lID0gMDsKICAgICAgfQoKICAgICAgZXh0cmEubnVtYmVySW5MaW5lICs9IDE7CiAgICAgIGV4dHJhLmxpbmUuY2hpbGRyZW4ucHVzaChodG1sKTsKCiAgICAgIGlmIChleHRyYS5hdHRlbXB0ID09PSAwKSB7CiAgICAgICAgZXh0cmEuY3VycmVudFdpZHRoICs9IHc7CiAgICAgICAgZXh0cmEuaGVpZ2h0ID0gTWF0aC5tYXgoZXh0cmEuaGVpZ2h0LCBleHRyYS5wcmV2SGVpZ2h0ICsgaCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZXh0cmEuY3VycmVudFdpZHRoID0gdzsKICAgICAgICBleHRyYS5wcmV2SGVpZ2h0ID0gZXh0cmEuaGVpZ2h0OwogICAgICAgIGV4dHJhLmhlaWdodCArPSBoOwogICAgICAgIGV4dHJhLmF0dGVtcHQgPSAwOwogICAgICB9CgogICAgICBleHRyYS53aWR0aCA9IE1hdGgubWF4KGV4dHJhLndpZHRoLCBleHRyYS5jdXJyZW50V2lkdGgpOwogICAgICBicmVhazsKCiAgICBjYXNlICJybC1yb3ciOgogICAgY2FzZSAicm93IjoKICAgICAgewogICAgICAgIGV4dHJhLmNoaWxkcmVuLnB1c2goaHRtbCk7CiAgICAgICAgZXh0cmEud2lkdGggKz0gdzsKICAgICAgICBleHRyYS5oZWlnaHQgPSBNYXRoLm1heChleHRyYS5oZWlnaHQsIGgpOwogICAgICAgIGNvbnN0IGhlaWdodCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKGV4dHJhLmhlaWdodCk7CgogICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgZXh0cmEuY2hpbGRyZW4pIHsKICAgICAgICAgIGNoaWxkLmF0dHJpYnV0ZXMuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0OwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICBjYXNlICJ0YWJsZSI6CiAgICAgIHsKICAgICAgICBleHRyYS53aWR0aCA9IE1hdGgubWluKGF2YWlsYWJsZVNwYWNlLndpZHRoLCBNYXRoLm1heChleHRyYS53aWR0aCwgdykpOwogICAgICAgIGV4dHJhLmhlaWdodCArPSBoOwogICAgICAgIGV4dHJhLmNoaWxkcmVuLnB1c2goaHRtbCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICBjYXNlICJ0YiI6CiAgICAgIHsKICAgICAgICBleHRyYS53aWR0aCA9IE1hdGgubWluKGF2YWlsYWJsZVNwYWNlLndpZHRoLCBNYXRoLm1heChleHRyYS53aWR0aCwgdykpOwogICAgICAgIGV4dHJhLmhlaWdodCArPSBoOwogICAgICAgIGV4dHJhLmNoaWxkcmVuLnB1c2goaHRtbCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGdldEF2YWlsYWJsZVNwYWNlKG5vZGUpIHsKICBjb25zdCBhdmFpbGFibGVTcGFjZSA9IG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS5hdmFpbGFibGVTcGFjZTsKICBjb25zdCBtYXJnaW5WID0gbm9kZS5tYXJnaW4gPyBub2RlLm1hcmdpbi50b3BJbnNldCArIG5vZGUubWFyZ2luLmJvdHRvbUluc2V0IDogMDsKICBjb25zdCBtYXJnaW5IID0gbm9kZS5tYXJnaW4gPyBub2RlLm1hcmdpbi5sZWZ0SW5zZXQgKyBub2RlLm1hcmdpbi5yaWdodEluc2V0IDogMDsKCiAgc3dpdGNoIChub2RlLmxheW91dCkgewogICAgY2FzZSAibHItdGIiOgogICAgY2FzZSAicmwtdGIiOgogICAgICBpZiAobm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgPT09IDApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgd2lkdGg6IGF2YWlsYWJsZVNwYWNlLndpZHRoIC0gbWFyZ2luSCAtIG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS5jdXJyZW50V2lkdGgsCiAgICAgICAgICBoZWlnaHQ6IGF2YWlsYWJsZVNwYWNlLmhlaWdodCAtIG1hcmdpblYgLSBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0ucHJldkhlaWdodAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgd2lkdGg6IGF2YWlsYWJsZVNwYWNlLndpZHRoIC0gbWFyZ2luSCwKICAgICAgICBoZWlnaHQ6IGF2YWlsYWJsZVNwYWNlLmhlaWdodCAtIG1hcmdpblYgLSBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uaGVpZ2h0CiAgICAgIH07CgogICAgY2FzZSAicmwtcm93IjoKICAgIGNhc2UgInJvdyI6CiAgICAgIGNvbnN0IHdpZHRoID0gbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLmNvbHVtbldpZHRocy5zbGljZShub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uY3VycmVudENvbHVtbikucmVkdWNlKChhLCB4KSA9PiBhICsgeCk7CgogICAgICByZXR1cm4gewogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodDogYXZhaWxhYmxlU3BhY2UuaGVpZ2h0IC0gbWFyZ2luSAogICAgICB9OwoKICAgIGNhc2UgInRhYmxlIjoKICAgIGNhc2UgInRiIjoKICAgICAgcmV0dXJuIHsKICAgICAgICB3aWR0aDogYXZhaWxhYmxlU3BhY2Uud2lkdGggLSBtYXJnaW5ILAogICAgICAgIGhlaWdodDogYXZhaWxhYmxlU3BhY2UuaGVpZ2h0IC0gbWFyZ2luViAtIG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS5oZWlnaHQKICAgICAgfTsKCiAgICBjYXNlICJwb3NpdGlvbiI6CiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gYXZhaWxhYmxlU3BhY2U7CiAgfQp9CgpmdW5jdGlvbiBnZXRUcmFuc2Zvcm1lZEJCb3gobm9kZSkgewogIGxldCB3ID0gbm9kZS53ID09PSAiIiA/IE5hTiA6IG5vZGUudzsKICBsZXQgaCA9IG5vZGUuaCA9PT0gIiIgPyBOYU4gOiBub2RlLmg7CiAgbGV0IFtjZW50ZXJYLCBjZW50ZXJZXSA9IFswLCAwXTsKCiAgc3dpdGNoIChub2RlLmFuY2hvclR5cGUgfHwgIiIpIHsKICAgIGNhc2UgImJvdHRvbUNlbnRlciI6CiAgICAgIFtjZW50ZXJYLCBjZW50ZXJZXSA9IFt3IC8gMiwgaF07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgImJvdHRvbUxlZnQiOgogICAgICBbY2VudGVyWCwgY2VudGVyWV0gPSBbMCwgaF07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgImJvdHRvbVJpZ2h0IjoKICAgICAgW2NlbnRlclgsIGNlbnRlclldID0gW3csIGhdOwogICAgICBicmVhazsKCiAgICBjYXNlICJtaWRkbGVDZW50ZXIiOgogICAgICBbY2VudGVyWCwgY2VudGVyWV0gPSBbdyAvIDIsIGggLyAyXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAibWlkZGxlTGVmdCI6CiAgICAgIFtjZW50ZXJYLCBjZW50ZXJZXSA9IFswLCBoIC8gMl07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgIm1pZGRsZVJpZ2h0IjoKICAgICAgW2NlbnRlclgsIGNlbnRlclldID0gW3csIGggLyAyXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAidG9wQ2VudGVyIjoKICAgICAgW2NlbnRlclgsIGNlbnRlclldID0gW3cgLyAyLCAwXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAidG9wUmlnaHQiOgogICAgICBbY2VudGVyWCwgY2VudGVyWV0gPSBbdywgMF07CiAgICAgIGJyZWFrOwogIH0KCiAgbGV0IHgsIHk7CgogIHN3aXRjaCAobm9kZS5yb3RhdGUgfHwgMCkgewogICAgY2FzZSAwOgogICAgICBbeCwgeV0gPSBbLWNlbnRlclgsIC1jZW50ZXJZXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA5MDoKICAgICAgW3gsIHldID0gWy1jZW50ZXJZLCBjZW50ZXJYXTsKICAgICAgW3csIGhdID0gW2gsIC13XTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAxODA6CiAgICAgIFt4LCB5XSA9IFtjZW50ZXJYLCBjZW50ZXJZXTsKICAgICAgW3csIGhdID0gWy13LCAtaF07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMjcwOgogICAgICBbeCwgeV0gPSBbY2VudGVyWSwgLWNlbnRlclhdOwogICAgICBbdywgaF0gPSBbLWgsIHddOwogICAgICBicmVhazsKICB9CgogIHJldHVybiBbbm9kZS54ICsgeCArIE1hdGgubWluKDAsIHcpLCBub2RlLnkgKyB5ICsgTWF0aC5taW4oMCwgaCksIE1hdGguYWJzKHcpLCBNYXRoLmFicyhoKV07Cn0KCmZ1bmN0aW9uIGNoZWNrRGltZW5zaW9ucyhub2RlLCBzcGFjZSkgewogIGlmIChub2RlW194ZmFfb2JqZWN0LiRnZXRUZW1wbGF0ZVJvb3RdKClbX3hmYV9vYmplY3QuJGV4dHJhXS5maXJzdFVuc3BsaXR0YWJsZSA9PT0gbnVsbCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBpZiAobm9kZS53ID09PSAwIHx8IG5vZGUuaCA9PT0gMCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBjb25zdCBFUlJPUiA9IDI7CgogIGNvbnN0IHBhcmVudCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCk7CgogIGNvbnN0IGF0dGVtcHQgPSBwYXJlbnRbX3hmYV9vYmplY3QuJGV4dHJhXSAmJiBwYXJlbnRbX3hmYV9vYmplY3QuJGV4dHJhXS5hdHRlbXB0IHx8IDA7CiAgY29uc3QgWywgeSwgdywgaF0gPSBnZXRUcmFuc2Zvcm1lZEJCb3gobm9kZSk7CgogIHN3aXRjaCAocGFyZW50LmxheW91dCkgewogICAgY2FzZSAibHItdGIiOgogICAgY2FzZSAicmwtdGIiOgogICAgICBpZiAoYXR0ZW1wdCA9PT0gMCkgewogICAgICAgIGlmICghbm9kZVtfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpW194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlKSB7CiAgICAgICAgICBpZiAobm9kZS5oICE9PSAiIiAmJiBNYXRoLnJvdW5kKGggLSBzcGFjZS5oZWlnaHQpID4gRVJST1IpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChub2RlLncgIT09ICIiKSB7CiAgICAgICAgICAgIGlmIChNYXRoLnJvdW5kKHcgLSBzcGFjZS53aWR0aCkgPD0gRVJST1IpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHBhcmVudFtfeGZhX29iamVjdC4kZXh0cmFdLm51bWJlckluTGluZSA9PT0gMCkgewogICAgICAgICAgICAgIHJldHVybiBzcGFjZS5oZWlnaHQgPiBFUlJPUjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBzcGFjZS53aWR0aCA+IEVSUk9SOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5vZGUudyAhPT0gIiIpIHsKICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHcgLSBzcGFjZS53aWR0aCkgPD0gRVJST1I7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc3BhY2Uud2lkdGggPiBFUlJPUjsKICAgICAgfQoKICAgICAgaWYgKG5vZGVbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKVtfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAobm9kZS5oICE9PSAiIiAmJiBNYXRoLnJvdW5kKGggLSBzcGFjZS5oZWlnaHQpID4gRVJST1IpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmIChub2RlLncgPT09ICIiIHx8IE1hdGgucm91bmQodyAtIHNwYWNlLndpZHRoKSA8PSBFUlJPUikgewogICAgICAgIHJldHVybiBzcGFjZS5oZWlnaHQgPiBFUlJPUjsKICAgICAgfQoKICAgICAgaWYgKHBhcmVudFtfeGZhX29iamVjdC4kaXNUaGVyZU1vcmVXaWR0aF0oKSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNwYWNlLmhlaWdodCA+IEVSUk9SOwoKICAgIGNhc2UgInRhYmxlIjoKICAgIGNhc2UgInRiIjoKICAgICAgaWYgKG5vZGVbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKVtfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAobm9kZS5oICE9PSAiIiAmJiAhbm9kZVtfeGZhX29iamVjdC4kaXNTcGxpdHRhYmxlXSgpKSB7CiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoaCAtIHNwYWNlLmhlaWdodCkgPD0gRVJST1I7CiAgICAgIH0KCiAgICAgIGlmIChub2RlLncgPT09ICIiIHx8IE1hdGgucm91bmQodyAtIHNwYWNlLndpZHRoKSA8PSBFUlJPUikgewogICAgICAgIHJldHVybiBzcGFjZS5oZWlnaHQgPiBFUlJPUjsKICAgICAgfQoKICAgICAgaWYgKHBhcmVudFtfeGZhX29iamVjdC4kaXNUaGVyZU1vcmVXaWR0aF0oKSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNwYWNlLmhlaWdodCA+IEVSUk9SOwoKICAgIGNhc2UgInBvc2l0aW9uIjoKICAgICAgaWYgKG5vZGVbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKVtfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAobm9kZS5oID09PSAiIiB8fCBNYXRoLnJvdW5kKGggKyB5IC0gc3BhY2UuaGVpZ2h0KSA8PSBFUlJPUikgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBjb25zdCBhcmVhID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpW194ZmFfb2JqZWN0LiRleHRyYV0uY3VycmVudENvbnRlbnRBcmVhOwoKICAgICAgcmV0dXJuIGggKyB5ID4gYXJlYS5oOwoKICAgIGNhc2UgInJsLXJvdyI6CiAgICBjYXNlICJyb3ciOgogICAgICBpZiAobm9kZVtfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpW194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChub2RlLmggIT09ICIiKSB7CiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoaCAtIHNwYWNlLmhlaWdodCkgPD0gRVJST1I7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwoKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiB0cnVlOwogIH0KfQoKLyoqKi8gfSksCi8qIDIwOSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuY29tcHV0ZUJib3ggPSBjb21wdXRlQmJveDsKZXhwb3J0cy5jcmVhdGVXcmFwcGVyID0gY3JlYXRlV3JhcHBlcjsKZXhwb3J0cy5maXhEaW1lbnNpb25zID0gZml4RGltZW5zaW9uczsKZXhwb3J0cy5maXhUZXh0SW5kZW50ID0gZml4VGV4dEluZGVudDsKZXhwb3J0cy5maXhVUkwgPSBmaXhVUkw7CmV4cG9ydHMuaXNQcmludE9ubHkgPSBpc1ByaW50T25seTsKZXhwb3J0cy5sYXlvdXRDbGFzcyA9IGxheW91dENsYXNzOwpleHBvcnRzLmxheW91dE5vZGUgPSBsYXlvdXROb2RlOwpleHBvcnRzLm1lYXN1cmVUb1N0cmluZyA9IG1lYXN1cmVUb1N0cmluZzsKZXhwb3J0cy5zZXRBY2Nlc3MgPSBzZXRBY2Nlc3M7CmV4cG9ydHMuc2V0Rm9udEZhbWlseSA9IHNldEZvbnRGYW1pbHk7CmV4cG9ydHMuc2V0TWluTWF4RGltZW5zaW9ucyA9IHNldE1pbk1heERpbWVuc2lvbnM7CmV4cG9ydHMuc2V0UGFyYSA9IHNldFBhcmE7CmV4cG9ydHMudG9TdHlsZSA9IHRvU3R5bGU7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMik7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAzKTsKCnZhciBfZm9udHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxMCk7Cgp2YXIgX3RleHQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxMSk7CgpmdW5jdGlvbiBtZWFzdXJlVG9TdHJpbmcobSkgewogIGlmICh0eXBlb2YgbSA9PT0gInN0cmluZyIpIHsKICAgIHJldHVybiAiMHB4IjsKICB9CgogIHJldHVybiBOdW1iZXIuaXNJbnRlZ2VyKG0pID8gYCR7bX1weGAgOiBgJHttLnRvRml4ZWQoMil9cHhgOwp9Cgpjb25zdCBjb252ZXJ0ZXJzID0gewogIGFuY2hvclR5cGUobm9kZSwgc3R5bGUpIHsKICAgIGNvbnN0IHBhcmVudCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCk7CgogICAgaWYgKCFwYXJlbnQgfHwgcGFyZW50LmxheW91dCAmJiBwYXJlbnQubGF5b3V0ICE9PSAicG9zaXRpb24iKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoISgidHJhbnNmb3JtIiBpbiBzdHlsZSkpIHsKICAgICAgc3R5bGUudHJhbnNmb3JtID0gIiI7CiAgICB9CgogICAgc3dpdGNoIChub2RlLmFuY2hvclR5cGUpIHsKICAgICAgY2FzZSAiYm90dG9tQ2VudGVyIjoKICAgICAgICBzdHlsZS50cmFuc2Zvcm0gKz0gInRyYW5zbGF0ZSgtNTAlLCAtMTAwJSkiOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiYm90dG9tTGVmdCI6CiAgICAgICAgc3R5bGUudHJhbnNmb3JtICs9ICJ0cmFuc2xhdGUoMCwtMTAwJSkiOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiYm90dG9tUmlnaHQiOgogICAgICAgIHN0eWxlLnRyYW5zZm9ybSArPSAidHJhbnNsYXRlKC0xMDAlLC0xMDAlKSI7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJtaWRkbGVDZW50ZXIiOgogICAgICAgIHN0eWxlLnRyYW5zZm9ybSArPSAidHJhbnNsYXRlKC01MCUsLTUwJSkiOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAibWlkZGxlTGVmdCI6CiAgICAgICAgc3R5bGUudHJhbnNmb3JtICs9ICJ0cmFuc2xhdGUoMCwtNTAlKSI7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJtaWRkbGVSaWdodCI6CiAgICAgICAgc3R5bGUudHJhbnNmb3JtICs9ICJ0cmFuc2xhdGUoLTEwMCUsLTUwJSkiOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAidG9wQ2VudGVyIjoKICAgICAgICBzdHlsZS50cmFuc2Zvcm0gKz0gInRyYW5zbGF0ZSgtNTAlLDApIjsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgInRvcFJpZ2h0IjoKICAgICAgICBzdHlsZS50cmFuc2Zvcm0gKz0gInRyYW5zbGF0ZSgtMTAwJSwwKSI7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfSwKCiAgZGltZW5zaW9ucyhub2RlLCBzdHlsZSkgewogICAgY29uc3QgcGFyZW50ID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKTsKCiAgICBsZXQgd2lkdGggPSBub2RlLnc7CiAgICBjb25zdCBoZWlnaHQgPSBub2RlLmg7CgogICAgaWYgKHBhcmVudC5sYXlvdXQgJiYgcGFyZW50LmxheW91dC5pbmNsdWRlcygicm93IikpIHsKICAgICAgY29uc3QgZXh0cmEgPSBwYXJlbnRbX3hmYV9vYmplY3QuJGV4dHJhXTsKICAgICAgY29uc3QgY29sU3BhbiA9IG5vZGUuY29sU3BhbjsKICAgICAgbGV0IHc7CgogICAgICBpZiAoY29sU3BhbiA9PT0gLTEpIHsKICAgICAgICB3ID0gZXh0cmEuY29sdW1uV2lkdGhzLnNsaWNlKGV4dHJhLmN1cnJlbnRDb2x1bW4pLnJlZHVjZSgoYSwgeCkgPT4gYSArIHgsIDApOwogICAgICAgIGV4dHJhLmN1cnJlbnRDb2x1bW4gPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIHcgPSBleHRyYS5jb2x1bW5XaWR0aHMuc2xpY2UoZXh0cmEuY3VycmVudENvbHVtbiwgZXh0cmEuY3VycmVudENvbHVtbiArIGNvbFNwYW4pLnJlZHVjZSgoYSwgeCkgPT4gYSArIHgsIDApOwogICAgICAgIGV4dHJhLmN1cnJlbnRDb2x1bW4gPSAoZXh0cmEuY3VycmVudENvbHVtbiArIG5vZGUuY29sU3BhbikgJSBleHRyYS5jb2x1bW5XaWR0aHMubGVuZ3RoOwogICAgICB9CgogICAgICBpZiAoIWlzTmFOKHcpKSB7CiAgICAgICAgd2lkdGggPSBub2RlLncgPSB3OwogICAgICB9CiAgICB9CgogICAgaWYgKHdpZHRoICE9PSAiIikgewogICAgICBzdHlsZS53aWR0aCA9IG1lYXN1cmVUb1N0cmluZyh3aWR0aCk7CiAgICB9IGVsc2UgewogICAgICBzdHlsZS53aWR0aCA9ICJhdXRvIjsKICAgIH0KCiAgICBpZiAoaGVpZ2h0ICE9PSAiIikgewogICAgICBzdHlsZS5oZWlnaHQgPSBtZWFzdXJlVG9TdHJpbmcoaGVpZ2h0KTsKICAgIH0gZWxzZSB7CiAgICAgIHN0eWxlLmhlaWdodCA9ICJhdXRvIjsKICAgIH0KICB9LAoKICBwb3NpdGlvbihub2RlLCBzdHlsZSkgewogICAgY29uc3QgcGFyZW50ID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKTsKCiAgICBpZiAocGFyZW50ICYmIHBhcmVudC5sYXlvdXQgJiYgcGFyZW50LmxheW91dCAhPT0gInBvc2l0aW9uIikgewogICAgICByZXR1cm47CiAgICB9CgogICAgc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiOwogICAgc3R5bGUubGVmdCA9IG1lYXN1cmVUb1N0cmluZyhub2RlLngpOwogICAgc3R5bGUudG9wID0gbWVhc3VyZVRvU3RyaW5nKG5vZGUueSk7CiAgfSwKCiAgcm90YXRlKG5vZGUsIHN0eWxlKSB7CiAgICBpZiAobm9kZS5yb3RhdGUpIHsKICAgICAgaWYgKCEoInRyYW5zZm9ybSIgaW4gc3R5bGUpKSB7CiAgICAgICAgc3R5bGUudHJhbnNmb3JtID0gIiI7CiAgICAgIH0KCiAgICAgIHN0eWxlLnRyYW5zZm9ybSArPSBgcm90YXRlKC0ke25vZGUucm90YXRlfWRlZylgOwogICAgICBzdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSAidG9wIGxlZnQiOwogICAgfQogIH0sCgogIHByZXNlbmNlKG5vZGUsIHN0eWxlKSB7CiAgICBzd2l0Y2ggKG5vZGUucHJlc2VuY2UpIHsKICAgICAgY2FzZSAiaW52aXNpYmxlIjoKICAgICAgICBzdHlsZS52aXNpYmlsaXR5ID0gImhpZGRlbiI7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJoaWRkZW4iOgogICAgICBjYXNlICJpbmFjdGl2ZSI6CiAgICAgICAgc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICBicmVhazsKICAgIH0KICB9LAoKICBoQWxpZ24obm9kZSwgc3R5bGUpIHsKICAgIGlmIChub2RlW194ZmFfb2JqZWN0LiRub2RlTmFtZV0gPT09ICJwYXJhIikgewogICAgICBzd2l0Y2ggKG5vZGUuaEFsaWduKSB7CiAgICAgICAgY2FzZSAianVzdGlmeUFsbCI6CiAgICAgICAgICBzdHlsZS50ZXh0QWxpZ24gPSAianVzdGlmeS1hbGwiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInJhZGl4IjoKICAgICAgICAgIHN0eWxlLnRleHRBbGlnbiA9ICJsZWZ0IjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgc3R5bGUudGV4dEFsaWduID0gbm9kZS5oQWxpZ247CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHN3aXRjaCAobm9kZS5oQWxpZ24pIHsKICAgICAgICBjYXNlICJsZWZ0IjoKICAgICAgICAgIHN0eWxlLmFsaWduU2VsZiA9ICJzdGFydCI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiY2VudGVyIjoKICAgICAgICAgIHN0eWxlLmFsaWduU2VsZiA9ICJjZW50ZXIiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInJpZ2h0IjoKICAgICAgICAgIHN0eWxlLmFsaWduU2VsZiA9ICJlbmQiOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICB9LAoKICBtYXJnaW4obm9kZSwgc3R5bGUpIHsKICAgIGlmIChub2RlLm1hcmdpbikgewogICAgICBzdHlsZS5tYXJnaW4gPSBub2RlLm1hcmdpbltfeGZhX29iamVjdC4kdG9TdHlsZV0oKS5tYXJnaW47CiAgICB9CiAgfQoKfTsKCmZ1bmN0aW9uIHNldE1pbk1heERpbWVuc2lvbnMobm9kZSwgc3R5bGUpIHsKICBjb25zdCBwYXJlbnQgPSBub2RlW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSgpOwoKICBpZiAocGFyZW50LmxheW91dCA9PT0gInBvc2l0aW9uIikgewogICAgaWYgKG5vZGUubWluVyA+IDApIHsKICAgICAgc3R5bGUubWluV2lkdGggPSBtZWFzdXJlVG9TdHJpbmcobm9kZS5taW5XKTsKICAgIH0KCiAgICBpZiAobm9kZS5tYXhXID4gMCkgewogICAgICBzdHlsZS5tYXhXaWR0aCA9IG1lYXN1cmVUb1N0cmluZyhub2RlLm1heFcpOwogICAgfQoKICAgIGlmIChub2RlLm1pbkggPiAwKSB7CiAgICAgIHN0eWxlLm1pbkhlaWdodCA9IG1lYXN1cmVUb1N0cmluZyhub2RlLm1pbkgpOwogICAgfQoKICAgIGlmIChub2RlLm1heEggPiAwKSB7CiAgICAgIHN0eWxlLm1heEhlaWdodCA9IG1lYXN1cmVUb1N0cmluZyhub2RlLm1heEgpOwogICAgfQogIH0KfQoKZnVuY3Rpb24gbGF5b3V0VGV4dCh0ZXh0LCB4ZmFGb250LCBtYXJnaW4sIGxpbmVIZWlnaHQsIGZvbnRGaW5kZXIsIHdpZHRoKSB7CiAgY29uc3QgbWVhc3VyZSA9IG5ldyBfdGV4dC5UZXh0TWVhc3VyZSh4ZmFGb250LCBtYXJnaW4sIGxpbmVIZWlnaHQsIGZvbnRGaW5kZXIpOwoKICBpZiAodHlwZW9mIHRleHQgPT09ICJzdHJpbmciKSB7CiAgICBtZWFzdXJlLmFkZFN0cmluZyh0ZXh0KTsKICB9IGVsc2UgewogICAgdGV4dFtfeGZhX29iamVjdC4kcHVzaEdseXBoc10obWVhc3VyZSk7CiAgfQoKICByZXR1cm4gbWVhc3VyZS5jb21wdXRlKHdpZHRoKTsKfQoKZnVuY3Rpb24gbGF5b3V0Tm9kZShub2RlLCBhdmFpbGFibGVTcGFjZSkgewogIGxldCBoZWlnaHQgPSBudWxsOwogIGxldCB3aWR0aCA9IG51bGw7CiAgbGV0IGlzQnJva2VuID0gZmFsc2U7CgogIGlmICgoIW5vZGUudyB8fCAhbm9kZS5oKSAmJiBub2RlLnZhbHVlKSB7CiAgICBsZXQgbWFyZ2luSCA9IDA7CiAgICBsZXQgbWFyZ2luViA9IDA7CgogICAgaWYgKG5vZGUubWFyZ2luKSB7CiAgICAgIG1hcmdpbkggPSBub2RlLm1hcmdpbi5sZWZ0SW5zZXQgKyBub2RlLm1hcmdpbi5yaWdodEluc2V0OwogICAgICBtYXJnaW5WID0gbm9kZS5tYXJnaW4udG9wSW5zZXQgKyBub2RlLm1hcmdpbi5ib3R0b21JbnNldDsKICAgIH0KCiAgICBsZXQgbGluZUhlaWdodCA9IG51bGw7CiAgICBsZXQgbWFyZ2luID0gbnVsbDsKCiAgICBpZiAobm9kZS5wYXJhKSB7CiAgICAgIG1hcmdpbiA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgIGxpbmVIZWlnaHQgPSBub2RlLnBhcmEubGluZUhlaWdodCA9PT0gIiIgPyBudWxsIDogbm9kZS5wYXJhLmxpbmVIZWlnaHQ7CiAgICAgIG1hcmdpbi50b3AgPSBub2RlLnBhcmEuc3BhY2VBYm92ZSA9PT0gIiIgPyAwIDogbm9kZS5wYXJhLnNwYWNlQWJvdmU7CiAgICAgIG1hcmdpbi5ib3R0b20gPSBub2RlLnBhcmEuc3BhY2VCZWxvdyA9PT0gIiIgPyAwIDogbm9kZS5wYXJhLnNwYWNlQmVsb3c7CiAgICAgIG1hcmdpbi5sZWZ0ID0gbm9kZS5wYXJhLm1hcmdpbkxlZnQgPT09ICIiID8gMCA6IG5vZGUucGFyYS5tYXJnaW5MZWZ0OwogICAgICBtYXJnaW4ucmlnaHQgPSBub2RlLnBhcmEubWFyZ2luUmlnaHQgPT09ICIiID8gMCA6IG5vZGUucGFyYS5tYXJnaW5SaWdodDsKICAgIH0KCiAgICBsZXQgZm9udCA9IG5vZGUuZm9udDsKCiAgICBpZiAoIWZvbnQpIHsKICAgICAgY29uc3Qgcm9vdCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKTsKCiAgICAgIGxldCBwYXJlbnQgPSBub2RlW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgICB3aGlsZSAocGFyZW50ICYmIHBhcmVudCAhPT0gcm9vdCkgewogICAgICAgIGlmIChwYXJlbnQuZm9udCkgewogICAgICAgICAgZm9udCA9IHBhcmVudC5mb250OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBwYXJlbnQgPSBwYXJlbnRbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IG1heFdpZHRoID0gKG5vZGUudyB8fCBhdmFpbGFibGVTcGFjZS53aWR0aCkgLSBtYXJnaW5IOwogICAgY29uc3QgZm9udEZpbmRlciA9IG5vZGVbX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdLmZvbnRGaW5kZXI7CgogICAgaWYgKG5vZGUudmFsdWUuZXhEYXRhICYmIG5vZGUudmFsdWUuZXhEYXRhW194ZmFfb2JqZWN0LiRjb250ZW50XSAmJiBub2RlLnZhbHVlLmV4RGF0YS5jb250ZW50VHlwZSA9PT0gInRleHQvaHRtbCIpIHsKICAgICAgY29uc3QgcmVzID0gbGF5b3V0VGV4dChub2RlLnZhbHVlLmV4RGF0YVtfeGZhX29iamVjdC4kY29udGVudF0sIGZvbnQsIG1hcmdpbiwgbGluZUhlaWdodCwgZm9udEZpbmRlciwgbWF4V2lkdGgpOwogICAgICB3aWR0aCA9IHJlcy53aWR0aDsKICAgICAgaGVpZ2h0ID0gcmVzLmhlaWdodDsKICAgICAgaXNCcm9rZW4gPSByZXMuaXNCcm9rZW47CiAgICB9IGVsc2UgewogICAgICBjb25zdCB0ZXh0ID0gbm9kZS52YWx1ZVtfeGZhX29iamVjdC4kdGV4dF0oKTsKCiAgICAgIGlmICh0ZXh0KSB7CiAgICAgICAgY29uc3QgcmVzID0gbGF5b3V0VGV4dCh0ZXh0LCBmb250LCBtYXJnaW4sIGxpbmVIZWlnaHQsIGZvbnRGaW5kZXIsIG1heFdpZHRoKTsKICAgICAgICB3aWR0aCA9IHJlcy53aWR0aDsKICAgICAgICBoZWlnaHQgPSByZXMuaGVpZ2h0OwogICAgICAgIGlzQnJva2VuID0gcmVzLmlzQnJva2VuOwogICAgICB9CiAgICB9CgogICAgaWYgKHdpZHRoICE9PSBudWxsICYmICFub2RlLncpIHsKICAgICAgd2lkdGggKz0gbWFyZ2luSDsKICAgIH0KCiAgICBpZiAoaGVpZ2h0ICE9PSBudWxsICYmICFub2RlLmgpIHsKICAgICAgaGVpZ2h0ICs9IG1hcmdpblY7CiAgICB9CiAgfQoKICByZXR1cm4gewogICAgdzogd2lkdGgsCiAgICBoOiBoZWlnaHQsCiAgICBpc0Jyb2tlbgogIH07Cn0KCmZ1bmN0aW9uIGNvbXB1dGVCYm94KG5vZGUsIGh0bWwsIGF2YWlsYWJsZVNwYWNlKSB7CiAgbGV0IGJib3g7CgogIGlmIChub2RlLncgIT09ICIiICYmIG5vZGUuaCAhPT0gIiIpIHsKICAgIGJib3ggPSBbbm9kZS54LCBub2RlLnksIG5vZGUudywgbm9kZS5oXTsKICB9IGVsc2UgewogICAgaWYgKCFhdmFpbGFibGVTcGFjZSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBsZXQgd2lkdGggPSBub2RlLnc7CgogICAgaWYgKHdpZHRoID09PSAiIikgewogICAgICBpZiAobm9kZS5tYXhXID09PSAwKSB7CiAgICAgICAgY29uc3QgcGFyZW50ID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKTsKCiAgICAgICAgaWYgKHBhcmVudC5sYXlvdXQgPT09ICJwb3NpdGlvbiIgJiYgcGFyZW50LncgIT09ICIiKSB7CiAgICAgICAgICB3aWR0aCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdpZHRoID0gbm9kZS5taW5XOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB3aWR0aCA9IE1hdGgubWluKG5vZGUubWF4VywgYXZhaWxhYmxlU3BhY2Uud2lkdGgpOwogICAgICB9CgogICAgICBodG1sLmF0dHJpYnV0ZXMuc3R5bGUud2lkdGggPSBtZWFzdXJlVG9TdHJpbmcod2lkdGgpOwogICAgfQoKICAgIGxldCBoZWlnaHQgPSBub2RlLmg7CgogICAgaWYgKGhlaWdodCA9PT0gIiIpIHsKICAgICAgaWYgKG5vZGUubWF4SCA9PT0gMCkgewogICAgICAgIGNvbnN0IHBhcmVudCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCk7CgogICAgICAgIGlmIChwYXJlbnQubGF5b3V0ID09PSAicG9zaXRpb24iICYmIHBhcmVudC5oICE9PSAiIikgewogICAgICAgICAgaGVpZ2h0ID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaGVpZ2h0ID0gbm9kZS5taW5IOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBoZWlnaHQgPSBNYXRoLm1pbihub2RlLm1heEgsIGF2YWlsYWJsZVNwYWNlLmhlaWdodCk7CiAgICAgIH0KCiAgICAgIGh0bWwuYXR0cmlidXRlcy5zdHlsZS5oZWlnaHQgPSBtZWFzdXJlVG9TdHJpbmcoaGVpZ2h0KTsKICAgIH0KCiAgICBiYm94ID0gW25vZGUueCwgbm9kZS55LCB3aWR0aCwgaGVpZ2h0XTsKICB9CgogIHJldHVybiBiYm94Owp9CgpmdW5jdGlvbiBmaXhEaW1lbnNpb25zKG5vZGUpIHsKICBjb25zdCBwYXJlbnQgPSBub2RlW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSgpOwoKICBpZiAocGFyZW50LmxheW91dCAmJiBwYXJlbnQubGF5b3V0LmluY2x1ZGVzKCJyb3ciKSkgewogICAgY29uc3QgZXh0cmEgPSBwYXJlbnRbX3hmYV9vYmplY3QuJGV4dHJhXTsKICAgIGNvbnN0IGNvbFNwYW4gPSBub2RlLmNvbFNwYW47CiAgICBsZXQgd2lkdGg7CgogICAgaWYgKGNvbFNwYW4gPT09IC0xKSB7CiAgICAgIHdpZHRoID0gZXh0cmEuY29sdW1uV2lkdGhzLnNsaWNlKGV4dHJhLmN1cnJlbnRDb2x1bW4pLnJlZHVjZSgoYSwgdykgPT4gYSArIHcsIDApOwogICAgfSBlbHNlIHsKICAgICAgd2lkdGggPSBleHRyYS5jb2x1bW5XaWR0aHMuc2xpY2UoZXh0cmEuY3VycmVudENvbHVtbiwgZXh0cmEuY3VycmVudENvbHVtbiArIGNvbFNwYW4pLnJlZHVjZSgoYSwgdykgPT4gYSArIHcsIDApOwogICAgfQoKICAgIGlmICghaXNOYU4od2lkdGgpKSB7CiAgICAgIG5vZGUudyA9IHdpZHRoOwogICAgfQogIH0KCiAgaWYgKHBhcmVudC5sYXlvdXQgJiYgcGFyZW50LmxheW91dCAhPT0gInBvc2l0aW9uIikgewogICAgbm9kZS54ID0gbm9kZS55ID0gMDsKICB9CgogIGlmIChub2RlLmxheW91dCA9PT0gInRhYmxlIikgewogICAgaWYgKG5vZGUudyA9PT0gIiIgJiYgQXJyYXkuaXNBcnJheShub2RlLmNvbHVtbldpZHRocykpIHsKICAgICAgbm9kZS53ID0gbm9kZS5jb2x1bW5XaWR0aHMucmVkdWNlKChhLCB4KSA9PiBhICsgeCwgMCk7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBsYXlvdXRDbGFzcyhub2RlKSB7CiAgc3dpdGNoIChub2RlLmxheW91dCkgewogICAgY2FzZSAicG9zaXRpb24iOgogICAgICByZXR1cm4gInhmYVBvc2l0aW9uIjsKCiAgICBjYXNlICJsci10YiI6CiAgICAgIHJldHVybiAieGZhTHJUYiI7CgogICAgY2FzZSAicmwtcm93IjoKICAgICAgcmV0dXJuICJ4ZmFSbFJvdyI7CgogICAgY2FzZSAicmwtdGIiOgogICAgICByZXR1cm4gInhmYVJsVGIiOwoKICAgIGNhc2UgInJvdyI6CiAgICAgIHJldHVybiAieGZhUm93IjsKCiAgICBjYXNlICJ0YWJsZSI6CiAgICAgIHJldHVybiAieGZhVGFibGUiOwoKICAgIGNhc2UgInRiIjoKICAgICAgcmV0dXJuICJ4ZmFUYiI7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuICJ4ZmFQb3NpdGlvbiI7CiAgfQp9CgpmdW5jdGlvbiB0b1N0eWxlKG5vZGUpIHsKICBjb25zdCBzdHlsZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBuYW1lcyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICBuYW1lc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07CiAgfQoKICBmb3IgKGNvbnN0IG5hbWUgb2YgbmFtZXMpIHsKICAgIGNvbnN0IHZhbHVlID0gbm9kZVtuYW1lXTsKCiAgICBpZiAodmFsdWUgPT09IG51bGwpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgaWYgKGNvbnZlcnRlcnMuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgY29udmVydGVyc1tuYW1lXShub2RlLCBzdHlsZSk7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIF94ZmFfb2JqZWN0LlhGQU9iamVjdCkgewogICAgICBjb25zdCBuZXdTdHlsZSA9IHZhbHVlW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpOwoKICAgICAgaWYgKG5ld1N0eWxlKSB7CiAgICAgICAgT2JqZWN0LmFzc2lnbihzdHlsZSwgbmV3U3R5bGUpOwogICAgICB9IGVsc2UgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgKERFQlVHKSAtIFhGQSAtIHN0eWxlIGZvciAke25hbWV9IG5vdCBpbXBsZW1lbnRlZCB5ZXRgKTsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIHN0eWxlOwp9CgpmdW5jdGlvbiBjcmVhdGVXcmFwcGVyKG5vZGUsIGh0bWwpIHsKICBjb25zdCB7CiAgICBhdHRyaWJ1dGVzCiAgfSA9IGh0bWw7CiAgY29uc3QgewogICAgc3R5bGUKICB9ID0gYXR0cmlidXRlczsKICBjb25zdCB3cmFwcGVyID0gewogICAgbmFtZTogImRpdiIsCiAgICBhdHRyaWJ1dGVzOiB7CiAgICAgIGNsYXNzOiBbInhmYVdyYXBwZXIiXSwKICAgICAgc3R5bGU6IE9iamVjdC5jcmVhdGUobnVsbCkKICAgIH0sCiAgICBjaGlsZHJlbjogW10KICB9OwogIGF0dHJpYnV0ZXMuY2xhc3MucHVzaCgieGZhV3JhcHBlZCIpOwoKICBpZiAobm9kZS5ib3JkZXIpIHsKICAgIGNvbnN0IHsKICAgICAgd2lkdGhzLAogICAgICBpbnNldHMKICAgIH0gPSBub2RlLmJvcmRlcltfeGZhX29iamVjdC4kZXh0cmFdOwogICAgbGV0IHdpZHRoLCBoZWlnaHQ7CiAgICBsZXQgdG9wID0gaW5zZXRzWzBdOwogICAgbGV0IGxlZnQgPSBpbnNldHNbM107CiAgICBjb25zdCBpbnNldHNIID0gaW5zZXRzWzBdICsgaW5zZXRzWzJdOwogICAgY29uc3QgaW5zZXRzVyA9IGluc2V0c1sxXSArIGluc2V0c1szXTsKCiAgICBzd2l0Y2ggKG5vZGUuYm9yZGVyLmhhbmQpIHsKICAgICAgY2FzZSAiZXZlbiI6CiAgICAgICAgdG9wIC09IHdpZHRoc1swXSAvIDI7CiAgICAgICAgbGVmdCAtPSB3aWR0aHNbM10gLyAyOwogICAgICAgIHdpZHRoID0gYGNhbGMoMTAwJSArICR7KHdpZHRoc1sxXSArIHdpZHRoc1szXSkgLyAyIC0gaW5zZXRzV31weClgOwogICAgICAgIGhlaWdodCA9IGBjYWxjKDEwMCUgKyAkeyh3aWR0aHNbMF0gKyB3aWR0aHNbMl0pIC8gMiAtIGluc2V0c0h9cHgpYDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImxlZnQiOgogICAgICAgIHRvcCAtPSB3aWR0aHNbMF07CiAgICAgICAgbGVmdCAtPSB3aWR0aHNbM107CiAgICAgICAgd2lkdGggPSBgY2FsYygxMDAlICsgJHt3aWR0aHNbMV0gKyB3aWR0aHNbM10gLSBpbnNldHNXfXB4KWA7CiAgICAgICAgaGVpZ2h0ID0gYGNhbGMoMTAwJSArICR7d2lkdGhzWzBdICsgd2lkdGhzWzJdIC0gaW5zZXRzSH1weClgOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAicmlnaHQiOgogICAgICAgIHdpZHRoID0gaW5zZXRzVyA/IGBjYWxjKDEwMCUgLSAke2luc2V0c1d9cHgpYCA6ICIxMDAlIjsKICAgICAgICBoZWlnaHQgPSBpbnNldHNIID8gYGNhbGMoMTAwJSAtICR7aW5zZXRzSH1weClgIDogIjEwMCUiOwogICAgICAgIGJyZWFrOwogICAgfQoKICAgIGNvbnN0IGNsYXNzTmFtZXMgPSBbInhmYUJvcmRlciJdOwoKICAgIGlmIChpc1ByaW50T25seShub2RlLmJvcmRlcikpIHsKICAgICAgY2xhc3NOYW1lcy5wdXNoKCJ4ZmFQcmludE9ubHkiKTsKICAgIH0KCiAgICBjb25zdCBib3JkZXIgPSB7CiAgICAgIG5hbWU6ICJkaXYiLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgY2xhc3M6IGNsYXNzTmFtZXMsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHRvcDogYCR7dG9wfXB4YCwKICAgICAgICAgIGxlZnQ6IGAke2xlZnR9cHhgLAogICAgICAgICAgd2lkdGgsCiAgICAgICAgICBoZWlnaHQKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGNoaWxkcmVuOiBbXQogICAgfTsKCiAgICBmb3IgKGNvbnN0IGtleSBvZiBbImJvcmRlciIsICJib3JkZXJXaWR0aCIsICJib3JkZXJDb2xvciIsICJib3JkZXJSYWRpdXMiLCAiYm9yZGVyU3R5bGUiXSkgewogICAgICBpZiAoc3R5bGVba2V5XSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgYm9yZGVyLmF0dHJpYnV0ZXMuc3R5bGVba2V5XSA9IHN0eWxlW2tleV07CiAgICAgICAgZGVsZXRlIHN0eWxlW2tleV07CiAgICAgIH0KICAgIH0KCiAgICB3cmFwcGVyLmNoaWxkcmVuLnB1c2goYm9yZGVyLCBodG1sKTsKICB9IGVsc2UgewogICAgd3JhcHBlci5jaGlsZHJlbi5wdXNoKGh0bWwpOwogIH0KCiAgZm9yIChjb25zdCBrZXkgb2YgWyJiYWNrZ3JvdW5kIiwgImJhY2tncm91bmRDbGlwIiwgInRvcCIsICJsZWZ0IiwgIndpZHRoIiwgImhlaWdodCIsICJtaW5XaWR0aCIsICJtaW5IZWlnaHQiLCAibWF4V2lkdGgiLCAibWF4SGVpZ2h0IiwgInRyYW5zZm9ybSIsICJ0cmFuc2Zvcm1PcmlnaW4iLCAidmlzaWJpbGl0eSJdKSB7CiAgICBpZiAoc3R5bGVba2V5XSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHdyYXBwZXIuYXR0cmlidXRlcy5zdHlsZVtrZXldID0gc3R5bGVba2V5XTsKICAgICAgZGVsZXRlIHN0eWxlW2tleV07CiAgICB9CiAgfQoKICBpZiAoc3R5bGUucG9zaXRpb24gPT09ICJhYnNvbHV0ZSIpIHsKICAgIHdyYXBwZXIuYXR0cmlidXRlcy5zdHlsZS5wb3NpdGlvbiA9ICJhYnNvbHV0ZSI7CiAgfSBlbHNlIHsKICAgIHdyYXBwZXIuYXR0cmlidXRlcy5zdHlsZS5wb3NpdGlvbiA9ICJyZWxhdGl2ZSI7CiAgfQoKICBkZWxldGUgc3R5bGUucG9zaXRpb247CgogIGlmIChzdHlsZS5hbGlnblNlbGYpIHsKICAgIHdyYXBwZXIuYXR0cmlidXRlcy5zdHlsZS5hbGlnblNlbGYgPSBzdHlsZS5hbGlnblNlbGY7CiAgICBkZWxldGUgc3R5bGUuYWxpZ25TZWxmOwogIH0KCiAgcmV0dXJuIHdyYXBwZXI7Cn0KCmZ1bmN0aW9uIGZpeFRleHRJbmRlbnQoc3R5bGVzKSB7CiAgY29uc3QgaW5kZW50ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoc3R5bGVzLnRleHRJbmRlbnQsICIwcHgiKTsKCiAgaWYgKGluZGVudCA+PSAwKSB7CiAgICByZXR1cm47CiAgfQoKICBjb25zdCBhbGlnbiA9IHN0eWxlcy50ZXh0QWxpZ24gPT09ICJyaWdodCIgPyAicmlnaHQiIDogImxlZnQiOwogIGNvbnN0IG5hbWUgPSAicGFkZGluZyIgKyAoYWxpZ24gPT09ICJsZWZ0IiA/ICJMZWZ0IiA6ICJSaWdodCIpOwogIGNvbnN0IHBhZGRpbmcgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShzdHlsZXNbbmFtZV0sICIwcHgiKTsKICBzdHlsZXNbbmFtZV0gPSBgJHtwYWRkaW5nIC0gaW5kZW50fXB4YDsKfQoKZnVuY3Rpb24gc2V0QWNjZXNzKG5vZGUsIGNsYXNzTmFtZXMpIHsKICBzd2l0Y2ggKG5vZGUuYWNjZXNzKSB7CiAgICBjYXNlICJub25JbnRlcmFjdGl2ZSI6CiAgICAgIGNsYXNzTmFtZXMucHVzaCgieGZhTm9uSW50ZXJhY3RpdmUiKTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAicmVhZE9ubHkiOgogICAgICBjbGFzc05hbWVzLnB1c2goInhmYVJlYWRPbmx5Iik7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgInByb3RlY3RlZCI6CiAgICAgIGNsYXNzTmFtZXMucHVzaCgieGZhRGlzYWJsZWQiKTsKICAgICAgYnJlYWs7CiAgfQp9CgpmdW5jdGlvbiBpc1ByaW50T25seShub2RlKSB7CiAgcmV0dXJuIG5vZGUucmVsZXZhbnQubGVuZ3RoID4gMCAmJiAhbm9kZS5yZWxldmFudFswXS5leGNsdWRlZCAmJiBub2RlLnJlbGV2YW50WzBdLnZpZXduYW1lID09PSAicHJpbnQiOwp9CgpmdW5jdGlvbiBnZXRDdXJyZW50UGFyYShub2RlKSB7CiAgY29uc3Qgc3RhY2sgPSBub2RlW194ZmFfb2JqZWN0LiRnZXRUZW1wbGF0ZVJvb3RdKClbX3hmYV9vYmplY3QuJGV4dHJhXS5wYXJhU3RhY2s7CgogIHJldHVybiBzdGFjay5sZW5ndGggPyBzdGFjay5hdCgtMSkgOiBudWxsOwp9CgpmdW5jdGlvbiBzZXRQYXJhKG5vZGUsIG5vZGVTdHlsZSwgdmFsdWUpIHsKICBpZiAodmFsdWUuYXR0cmlidXRlcy5jbGFzcyAmJiB2YWx1ZS5hdHRyaWJ1dGVzLmNsYXNzLmluY2x1ZGVzKCJ4ZmFSaWNoIikpIHsKICAgIGlmIChub2RlU3R5bGUpIHsKICAgICAgaWYgKG5vZGUuaCA9PT0gIiIpIHsKICAgICAgICBub2RlU3R5bGUuaGVpZ2h0ID0gImF1dG8iOwogICAgICB9CgogICAgICBpZiAobm9kZS53ID09PSAiIikgewogICAgICAgIG5vZGVTdHlsZS53aWR0aCA9ICJhdXRvIjsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IHBhcmEgPSBnZXRDdXJyZW50UGFyYShub2RlKTsKCiAgICBpZiAocGFyYSkgewogICAgICBjb25zdCB2YWx1ZVN0eWxlID0gdmFsdWUuYXR0cmlidXRlcy5zdHlsZTsKICAgICAgdmFsdWVTdHlsZS5kaXNwbGF5ID0gImZsZXgiOwogICAgICB2YWx1ZVN0eWxlLmZsZXhEaXJlY3Rpb24gPSAiY29sdW1uIjsKCiAgICAgIHN3aXRjaCAocGFyYS52QWxpZ24pIHsKICAgICAgICBjYXNlICJ0b3AiOgogICAgICAgICAgdmFsdWVTdHlsZS5qdXN0aWZ5Q29udGVudCA9ICJzdGFydCI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiYm90dG9tIjoKICAgICAgICAgIHZhbHVlU3R5bGUuanVzdGlmeUNvbnRlbnQgPSAiZW5kIjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJtaWRkbGUiOgogICAgICAgICAgdmFsdWVTdHlsZS5qdXN0aWZ5Q29udGVudCA9ICJjZW50ZXIiOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGNvbnN0IHBhcmFTdHlsZSA9IHBhcmFbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCk7CgogICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbF0gb2YgT2JqZWN0LmVudHJpZXMocGFyYVN0eWxlKSkgewogICAgICAgIGlmICghKGtleSBpbiB2YWx1ZVN0eWxlKSkgewogICAgICAgICAgdmFsdWVTdHlsZVtrZXldID0gdmFsOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQoKZnVuY3Rpb24gc2V0Rm9udEZhbWlseSh4ZmFGb250LCBub2RlLCBmb250RmluZGVyLCBzdHlsZSkgewogIGlmICghZm9udEZpbmRlcikgewogICAgZGVsZXRlIHN0eWxlLmZvbnRGYW1pbHk7CiAgICByZXR1cm47CiAgfQoKICBjb25zdCBuYW1lID0gKDAsIF91dGlscy5zdHJpcFF1b3RlcykoeGZhRm9udC50eXBlZmFjZSk7CiAgc3R5bGUuZm9udEZhbWlseSA9IGAiJHtuYW1lfSJgOwogIGNvbnN0IHR5cGVmYWNlID0gZm9udEZpbmRlci5maW5kKG5hbWUpOwoKICBpZiAodHlwZWZhY2UpIHsKICAgIGNvbnN0IHsKICAgICAgZm9udEZhbWlseQogICAgfSA9IHR5cGVmYWNlLnJlZ3VsYXIuY3NzRm9udEluZm87CgogICAgaWYgKGZvbnRGYW1pbHkgIT09IG5hbWUpIHsKICAgICAgc3R5bGUuZm9udEZhbWlseSA9IGAiJHtmb250RmFtaWx5fSJgOwogICAgfQoKICAgIGNvbnN0IHBhcmEgPSBnZXRDdXJyZW50UGFyYShub2RlKTsKCiAgICBpZiAocGFyYSAmJiBwYXJhLmxpbmVIZWlnaHQgIT09ICIiKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoc3R5bGUubGluZUhlaWdodCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgcGRmRm9udCA9ICgwLCBfZm9udHMuc2VsZWN0Rm9udCkoeGZhRm9udCwgdHlwZWZhY2UpOwoKICAgIGlmIChwZGZGb250KSB7CiAgICAgIHN0eWxlLmxpbmVIZWlnaHQgPSBNYXRoLm1heCgxLjIsIHBkZkZvbnQubGluZUhlaWdodCk7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBmaXhVUkwoc3RyKSB7CiAgY29uc3QgYWJzb2x1dGVVcmwgPSAoMCwgX3V0aWwuY3JlYXRlVmFsaWRBYnNvbHV0ZVVybCkoc3RyLCBudWxsLCB7CiAgICBhZGREZWZhdWx0UHJvdG9jb2w6IHRydWUsCiAgICB0cnlDb252ZXJ0RW5jb2Rpbmc6IHRydWUKICB9KTsKICByZXR1cm4gYWJzb2x1dGVVcmwgPyBhYnNvbHV0ZVVybC5ocmVmIDogbnVsbDsKfQoKLyoqKi8gfSksCi8qIDIxMCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuRm9udEZpbmRlciA9IHZvaWQgMDsKZXhwb3J0cy5nZXRNZXRyaWNzID0gZ2V0TWV0cmljczsKZXhwb3J0cy5zZWxlY3RGb250ID0gc2VsZWN0Rm9udDsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAyKTsKCnZhciBfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMyk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY2xhc3MgRm9udEZpbmRlciB7CiAgY29uc3RydWN0b3IocGRmRm9udHMpIHsKICAgIHRoaXMuZm9udHMgPSBuZXcgTWFwKCk7CiAgICB0aGlzLmNhY2hlID0gbmV3IE1hcCgpOwogICAgdGhpcy53YXJuZWQgPSBuZXcgU2V0KCk7CiAgICB0aGlzLmRlZmF1bHRGb250ID0gbnVsbDsKICAgIHRoaXMuYWRkKHBkZkZvbnRzKTsKICB9CgogIGFkZChwZGZGb250cykgewogICAgbGV0IHJlYWxseU1pc3NpbmdGb250cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDsKCiAgICBmb3IgKGNvbnN0IHBkZkZvbnQgb2YgcGRmRm9udHMpIHsKICAgICAgdGhpcy5hZGRQZGZGb250KHBkZkZvbnQpOwogICAgfQoKICAgIGZvciAoY29uc3QgcGRmRm9udCBvZiB0aGlzLmZvbnRzLnZhbHVlcygpKSB7CiAgICAgIGlmICghcGRmRm9udC5yZWd1bGFyKSB7CiAgICAgICAgcGRmRm9udC5yZWd1bGFyID0gcGRmRm9udC5pdGFsaWMgfHwgcGRmRm9udC5ib2xkIHx8IHBkZkZvbnQuYm9sZGl0YWxpYzsKICAgICAgfQogICAgfQoKICAgIGlmICghcmVhbGx5TWlzc2luZ0ZvbnRzIHx8IHJlYWxseU1pc3NpbmdGb250cy5zaXplID09PSAwKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBteXJpYWQgPSB0aGlzLmZvbnRzLmdldCgiUGRmSlMtRmFsbGJhY2stUGRmSlMtWEZBIik7CgogICAgZm9yIChjb25zdCBtaXNzaW5nIG9mIHJlYWxseU1pc3NpbmdGb250cykgewogICAgICB0aGlzLmZvbnRzLnNldChtaXNzaW5nLCBteXJpYWQpOwogICAgfQogIH0KCiAgYWRkUGRmRm9udChwZGZGb250KSB7CiAgICBjb25zdCBjc3NGb250SW5mbyA9IHBkZkZvbnQuY3NzRm9udEluZm87CiAgICBjb25zdCBuYW1lID0gY3NzRm9udEluZm8uZm9udEZhbWlseTsKICAgIGxldCBmb250ID0gdGhpcy5mb250cy5nZXQobmFtZSk7CgogICAgaWYgKCFmb250KSB7CiAgICAgIGZvbnQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICB0aGlzLmZvbnRzLnNldChuYW1lLCBmb250KTsKCiAgICAgIGlmICghdGhpcy5kZWZhdWx0Rm9udCkgewogICAgICAgIHRoaXMuZGVmYXVsdEZvbnQgPSBmb250OwogICAgICB9CiAgICB9CgogICAgbGV0IHByb3BlcnR5ID0gIiI7CiAgICBjb25zdCBmb250V2VpZ2h0ID0gcGFyc2VGbG9hdChjc3NGb250SW5mby5mb250V2VpZ2h0KTsKCiAgICBpZiAocGFyc2VGbG9hdChjc3NGb250SW5mby5pdGFsaWNBbmdsZSkgIT09IDApIHsKICAgICAgcHJvcGVydHkgPSBmb250V2VpZ2h0ID49IDcwMCA/ICJib2xkaXRhbGljIiA6ICJpdGFsaWMiOwogICAgfSBlbHNlIGlmIChmb250V2VpZ2h0ID49IDcwMCkgewogICAgICBwcm9wZXJ0eSA9ICJib2xkIjsKICAgIH0KCiAgICBpZiAoIXByb3BlcnR5KSB7CiAgICAgIGlmIChwZGZGb250Lm5hbWUuaW5jbHVkZXMoIkJvbGQiKSB8fCBwZGZGb250LnBzTmFtZSAmJiBwZGZGb250LnBzTmFtZS5pbmNsdWRlcygiQm9sZCIpKSB7CiAgICAgICAgcHJvcGVydHkgPSAiYm9sZCI7CiAgICAgIH0KCiAgICAgIGlmIChwZGZGb250Lm5hbWUuaW5jbHVkZXMoIkl0YWxpYyIpIHx8IHBkZkZvbnQubmFtZS5lbmRzV2l0aCgiSXQiKSB8fCBwZGZGb250LnBzTmFtZSAmJiAocGRmRm9udC5wc05hbWUuaW5jbHVkZXMoIkl0YWxpYyIpIHx8IHBkZkZvbnQucHNOYW1lLmVuZHNXaXRoKCJJdCIpKSkgewogICAgICAgIHByb3BlcnR5ICs9ICJpdGFsaWMiOwogICAgICB9CiAgICB9CgogICAgaWYgKCFwcm9wZXJ0eSkgewogICAgICBwcm9wZXJ0eSA9ICJyZWd1bGFyIjsKICAgIH0KCiAgICBmb250W3Byb3BlcnR5XSA9IHBkZkZvbnQ7CiAgfQoKICBnZXREZWZhdWx0KCkgewogICAgcmV0dXJuIHRoaXMuZGVmYXVsdEZvbnQ7CiAgfQoKICBmaW5kKGZvbnROYW1lKSB7CiAgICBsZXQgbXVzdFdhcm4gPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRydWU7CiAgICBsZXQgZm9udCA9IHRoaXMuZm9udHMuZ2V0KGZvbnROYW1lKSB8fCB0aGlzLmNhY2hlLmdldChmb250TmFtZSk7CgogICAgaWYgKGZvbnQpIHsKICAgICAgcmV0dXJuIGZvbnQ7CiAgICB9CgogICAgY29uc3QgcGF0dGVybiA9IC8sfC18X3wgfGJvbGRpdGFsaWN8Ym9sZHxpdGFsaWN8cmVndWxhcnxpdC9naTsKICAgIGxldCBuYW1lID0gZm9udE5hbWUucmVwbGFjZShwYXR0ZXJuLCAiIik7CiAgICBmb250ID0gdGhpcy5mb250cy5nZXQobmFtZSk7CgogICAgaWYgKGZvbnQpIHsKICAgICAgdGhpcy5jYWNoZS5zZXQoZm9udE5hbWUsIGZvbnQpOwogICAgICByZXR1cm4gZm9udDsKICAgIH0KCiAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpOwogICAgY29uc3QgbWF5YmUgPSBbXTsKCiAgICBmb3IgKGNvbnN0IFtmYW1pbHksIHBkZkZvbnRdIG9mIHRoaXMuZm9udHMuZW50cmllcygpKSB7CiAgICAgIGlmIChmYW1pbHkucmVwbGFjZShwYXR0ZXJuLCAiIikudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKG5hbWUpKSB7CiAgICAgICAgbWF5YmUucHVzaChwZGZGb250KTsKICAgICAgfQogICAgfQoKICAgIGlmIChtYXliZS5sZW5ndGggPT09IDApIHsKICAgICAgZm9yIChjb25zdCBbLCBwZGZGb250XSBvZiB0aGlzLmZvbnRzLmVudHJpZXMoKSkgewogICAgICAgIGlmIChwZGZGb250LnJlZ3VsYXIubmFtZSAmJiBwZGZGb250LnJlZ3VsYXIubmFtZS5yZXBsYWNlKHBhdHRlcm4sICIiKS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgobmFtZSkpIHsKICAgICAgICAgIG1heWJlLnB1c2gocGRmRm9udCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKG1heWJlLmxlbmd0aCA9PT0gMCkgewogICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC9wc210fG10L2dpLCAiIik7CgogICAgICBmb3IgKGNvbnN0IFtmYW1pbHksIHBkZkZvbnRdIG9mIHRoaXMuZm9udHMuZW50cmllcygpKSB7CiAgICAgICAgaWYgKGZhbWlseS5yZXBsYWNlKHBhdHRlcm4sICIiKS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgobmFtZSkpIHsKICAgICAgICAgIG1heWJlLnB1c2gocGRmRm9udCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKG1heWJlLmxlbmd0aCA9PT0gMCkgewogICAgICBmb3IgKGNvbnN0IHBkZkZvbnQgb2YgdGhpcy5mb250cy52YWx1ZXMoKSkgewogICAgICAgIGlmIChwZGZGb250LnJlZ3VsYXIubmFtZSAmJiBwZGZGb250LnJlZ3VsYXIubmFtZS5yZXBsYWNlKHBhdHRlcm4sICIiKS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgobmFtZSkpIHsKICAgICAgICAgIG1heWJlLnB1c2gocGRmRm9udCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKG1heWJlLmxlbmd0aCA+PSAxKSB7CiAgICAgIGlmIChtYXliZS5sZW5ndGggIT09IDEgJiYgbXVzdFdhcm4pIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIFRvbyBtYW55IGNob2ljZXMgdG8gZ3Vlc3MgdGhlIGNvcnJlY3QgZm9udDogJHtmb250TmFtZX1gKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWNoZS5zZXQoZm9udE5hbWUsIG1heWJlWzBdKTsKICAgICAgcmV0dXJuIG1heWJlWzBdOwogICAgfQoKICAgIGlmIChtdXN0V2FybiAmJiAhdGhpcy53YXJuZWQuaGFzKGZvbnROYW1lKSkgewogICAgICB0aGlzLndhcm5lZC5hZGQoZm9udE5hbWUpOwogICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIENhbm5vdCBmaW5kIHRoZSBmb250OiAke2ZvbnROYW1lfWApOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCn0KCmV4cG9ydHMuRm9udEZpbmRlciA9IEZvbnRGaW5kZXI7CgpmdW5jdGlvbiBzZWxlY3RGb250KHhmYUZvbnQsIHR5cGVmYWNlKSB7CiAgaWYgKHhmYUZvbnQucG9zdHVyZSA9PT0gIml0YWxpYyIpIHsKICAgIGlmICh4ZmFGb250LndlaWdodCA9PT0gImJvbGQiKSB7CiAgICAgIHJldHVybiB0eXBlZmFjZS5ib2xkaXRhbGljOwogICAgfQoKICAgIHJldHVybiB0eXBlZmFjZS5pdGFsaWM7CiAgfSBlbHNlIGlmICh4ZmFGb250LndlaWdodCA9PT0gImJvbGQiKSB7CiAgICByZXR1cm4gdHlwZWZhY2UuYm9sZDsKICB9CgogIHJldHVybiB0eXBlZmFjZS5yZWd1bGFyOwp9CgpmdW5jdGlvbiBnZXRNZXRyaWNzKHhmYUZvbnQpIHsKICBsZXQgcmVhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgbGV0IHBkZkZvbnQgPSBudWxsOwoKICBpZiAoeGZhRm9udCkgewogICAgY29uc3QgbmFtZSA9ICgwLCBfdXRpbHMuc3RyaXBRdW90ZXMpKHhmYUZvbnQudHlwZWZhY2UpOwoKICAgIGNvbnN0IHR5cGVmYWNlID0geGZhRm9udFtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0uZm9udEZpbmRlci5maW5kKG5hbWUpOwoKICAgIHBkZkZvbnQgPSBzZWxlY3RGb250KHhmYUZvbnQsIHR5cGVmYWNlKTsKICB9CgogIGlmICghcGRmRm9udCkgewogICAgcmV0dXJuIHsKICAgICAgbGluZUhlaWdodDogMTIsCiAgICAgIGxpbmVHYXA6IDIsCiAgICAgIGxpbmVOb0dhcDogMTAKICAgIH07CiAgfQoKICBjb25zdCBzaXplID0geGZhRm9udC5zaXplIHx8IDEwOwogIGNvbnN0IGxpbmVIZWlnaHQgPSBwZGZGb250LmxpbmVIZWlnaHQgPyBNYXRoLm1heChyZWFsID8gMCA6IDEuMiwgcGRmRm9udC5saW5lSGVpZ2h0KSA6IDEuMjsKICBjb25zdCBsaW5lR2FwID0gcGRmRm9udC5saW5lR2FwID09PSB1bmRlZmluZWQgPyAwLjIgOiBwZGZGb250LmxpbmVHYXA7CiAgcmV0dXJuIHsKICAgIGxpbmVIZWlnaHQ6IGxpbmVIZWlnaHQgKiBzaXplLAogICAgbGluZUdhcDogbGluZUdhcCAqIHNpemUsCiAgICBsaW5lTm9HYXA6IE1hdGgubWF4KDEsIGxpbmVIZWlnaHQgLSBsaW5lR2FwKSAqIHNpemUKICB9Owp9CgovKioqLyB9KSwKLyogMjExICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5UZXh0TWVhc3VyZSA9IHZvaWQgMDsKCnZhciBfZm9udHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxMCk7Cgpjb25zdCBXSURUSF9GQUNUT1IgPSAxLjAyOwoKY2xhc3MgRm9udEluZm8gewogIGNvbnN0cnVjdG9yKHhmYUZvbnQsIG1hcmdpbiwgbGluZUhlaWdodCwgZm9udEZpbmRlcikgewogICAgdGhpcy5saW5lSGVpZ2h0ID0gbGluZUhlaWdodDsKICAgIHRoaXMucGFyYU1hcmdpbiA9IG1hcmdpbiB8fCB7CiAgICAgIHRvcDogMCwKICAgICAgYm90dG9tOiAwLAogICAgICBsZWZ0OiAwLAogICAgICByaWdodDogMAogICAgfTsKCiAgICBpZiAoIXhmYUZvbnQpIHsKICAgICAgW3RoaXMucGRmRm9udCwgdGhpcy54ZmFGb250XSA9IHRoaXMuZGVmYXVsdEZvbnQoZm9udEZpbmRlcik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnhmYUZvbnQgPSB7CiAgICAgIHR5cGVmYWNlOiB4ZmFGb250LnR5cGVmYWNlLAogICAgICBwb3N0dXJlOiB4ZmFGb250LnBvc3R1cmUsCiAgICAgIHdlaWdodDogeGZhRm9udC53ZWlnaHQsCiAgICAgIHNpemU6IHhmYUZvbnQuc2l6ZSwKICAgICAgbGV0dGVyU3BhY2luZzogeGZhRm9udC5sZXR0ZXJTcGFjaW5nCiAgICB9OwogICAgY29uc3QgdHlwZWZhY2UgPSBmb250RmluZGVyLmZpbmQoeGZhRm9udC50eXBlZmFjZSk7CgogICAgaWYgKCF0eXBlZmFjZSkgewogICAgICBbdGhpcy5wZGZGb250LCB0aGlzLnhmYUZvbnRdID0gdGhpcy5kZWZhdWx0Rm9udChmb250RmluZGVyKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMucGRmRm9udCA9ICgwLCBfZm9udHMuc2VsZWN0Rm9udCkoeGZhRm9udCwgdHlwZWZhY2UpOwoKICAgIGlmICghdGhpcy5wZGZGb250KSB7CiAgICAgIFt0aGlzLnBkZkZvbnQsIHRoaXMueGZhRm9udF0gPSB0aGlzLmRlZmF1bHRGb250KGZvbnRGaW5kZXIpOwogICAgfQogIH0KCiAgZGVmYXVsdEZvbnQoZm9udEZpbmRlcikgewogICAgY29uc3QgZm9udCA9IGZvbnRGaW5kZXIuZmluZCgiSGVsdmV0aWNhIiwgZmFsc2UpIHx8IGZvbnRGaW5kZXIuZmluZCgiTXlyaWFkIFBybyIsIGZhbHNlKSB8fCBmb250RmluZGVyLmZpbmQoIkFyaWFsIiwgZmFsc2UpIHx8IGZvbnRGaW5kZXIuZ2V0RGVmYXVsdCgpOwoKICAgIGlmIChmb250ICYmIGZvbnQucmVndWxhcikgewogICAgICBjb25zdCBwZGZGb250ID0gZm9udC5yZWd1bGFyOwogICAgICBjb25zdCBpbmZvID0gcGRmRm9udC5jc3NGb250SW5mbzsKICAgICAgY29uc3QgeGZhRm9udCA9IHsKICAgICAgICB0eXBlZmFjZTogaW5mby5mb250RmFtaWx5LAogICAgICAgIHBvc3R1cmU6ICJub3JtYWwiLAogICAgICAgIHdlaWdodDogIm5vcm1hbCIsCiAgICAgICAgc2l6ZTogMTAsCiAgICAgICAgbGV0dGVyU3BhY2luZzogMAogICAgICB9OwogICAgICByZXR1cm4gW3BkZkZvbnQsIHhmYUZvbnRdOwogICAgfQoKICAgIGNvbnN0IHhmYUZvbnQgPSB7CiAgICAgIHR5cGVmYWNlOiAiQ291cmllciIsCiAgICAgIHBvc3R1cmU6ICJub3JtYWwiLAogICAgICB3ZWlnaHQ6ICJub3JtYWwiLAogICAgICBzaXplOiAxMCwKICAgICAgbGV0dGVyU3BhY2luZzogMAogICAgfTsKICAgIHJldHVybiBbbnVsbCwgeGZhRm9udF07CiAgfQoKfQoKY2xhc3MgRm9udFNlbGVjdG9yIHsKICBjb25zdHJ1Y3RvcihkZWZhdWx0WGZhRm9udCwgZGVmYXVsdFBhcmFNYXJnaW4sIGRlZmF1bHRMaW5lSGVpZ2h0LCBmb250RmluZGVyKSB7CiAgICB0aGlzLmZvbnRGaW5kZXIgPSBmb250RmluZGVyOwogICAgdGhpcy5zdGFjayA9IFtuZXcgRm9udEluZm8oZGVmYXVsdFhmYUZvbnQsIGRlZmF1bHRQYXJhTWFyZ2luLCBkZWZhdWx0TGluZUhlaWdodCwgZm9udEZpbmRlcildOwogIH0KCiAgcHVzaERhdGEoeGZhRm9udCwgbWFyZ2luLCBsaW5lSGVpZ2h0KSB7CiAgICBjb25zdCBsYXN0Rm9udCA9IHRoaXMuc3RhY2suYXQoLTEpOwoKICAgIGZvciAoY29uc3QgbmFtZSBvZiBbInR5cGVmYWNlIiwgInBvc3R1cmUiLCAid2VpZ2h0IiwgInNpemUiLCAibGV0dGVyU3BhY2luZyJdKSB7CiAgICAgIGlmICgheGZhRm9udFtuYW1lXSkgewogICAgICAgIHhmYUZvbnRbbmFtZV0gPSBsYXN0Rm9udC54ZmFGb250W25hbWVdOwogICAgICB9CiAgICB9CgogICAgZm9yIChjb25zdCBuYW1lIG9mIFsidG9wIiwgImJvdHRvbSIsICJsZWZ0IiwgInJpZ2h0Il0pIHsKICAgICAgaWYgKGlzTmFOKG1hcmdpbltuYW1lXSkpIHsKICAgICAgICBtYXJnaW5bbmFtZV0gPSBsYXN0Rm9udC5wYXJhTWFyZ2luW25hbWVdOwogICAgICB9CiAgICB9CgogICAgY29uc3QgZm9udEluZm8gPSBuZXcgRm9udEluZm8oeGZhRm9udCwgbWFyZ2luLCBsaW5lSGVpZ2h0IHx8IGxhc3RGb250LmxpbmVIZWlnaHQsIHRoaXMuZm9udEZpbmRlcik7CgogICAgaWYgKCFmb250SW5mby5wZGZGb250KSB7CiAgICAgIGZvbnRJbmZvLnBkZkZvbnQgPSBsYXN0Rm9udC5wZGZGb250OwogICAgfQoKICAgIHRoaXMuc3RhY2sucHVzaChmb250SW5mbyk7CiAgfQoKICBwb3BGb250KCkgewogICAgdGhpcy5zdGFjay5wb3AoKTsKICB9CgogIHRvcEZvbnQoKSB7CiAgICByZXR1cm4gdGhpcy5zdGFjay5hdCgtMSk7CiAgfQoKfQoKY2xhc3MgVGV4dE1lYXN1cmUgewogIGNvbnN0cnVjdG9yKGRlZmF1bHRYZmFGb250LCBkZWZhdWx0UGFyYU1hcmdpbiwgZGVmYXVsdExpbmVIZWlnaHQsIGZvbnRzKSB7CiAgICB0aGlzLmdseXBocyA9IFtdOwogICAgdGhpcy5mb250U2VsZWN0b3IgPSBuZXcgRm9udFNlbGVjdG9yKGRlZmF1bHRYZmFGb250LCBkZWZhdWx0UGFyYU1hcmdpbiwgZGVmYXVsdExpbmVIZWlnaHQsIGZvbnRzKTsKICAgIHRoaXMuZXh0cmFIZWlnaHQgPSAwOwogIH0KCiAgcHVzaERhdGEoeGZhRm9udCwgbWFyZ2luLCBsaW5lSGVpZ2h0KSB7CiAgICB0aGlzLmZvbnRTZWxlY3Rvci5wdXNoRGF0YSh4ZmFGb250LCBtYXJnaW4sIGxpbmVIZWlnaHQpOwogIH0KCiAgcG9wRm9udCh4ZmFGb250KSB7CiAgICByZXR1cm4gdGhpcy5mb250U2VsZWN0b3IucG9wRm9udCgpOwogIH0KCiAgYWRkUGFyYSgpIHsKICAgIGNvbnN0IGxhc3RGb250ID0gdGhpcy5mb250U2VsZWN0b3IudG9wRm9udCgpOwogICAgdGhpcy5leHRyYUhlaWdodCArPSBsYXN0Rm9udC5wYXJhTWFyZ2luLnRvcCArIGxhc3RGb250LnBhcmFNYXJnaW4uYm90dG9tOwogIH0KCiAgYWRkU3RyaW5nKHN0cikgewogICAgaWYgKCFzdHIpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGxhc3RGb250ID0gdGhpcy5mb250U2VsZWN0b3IudG9wRm9udCgpOwogICAgY29uc3QgZm9udFNpemUgPSBsYXN0Rm9udC54ZmFGb250LnNpemU7CgogICAgaWYgKGxhc3RGb250LnBkZkZvbnQpIHsKICAgICAgY29uc3QgbGV0dGVyU3BhY2luZyA9IGxhc3RGb250LnhmYUZvbnQubGV0dGVyU3BhY2luZzsKICAgICAgY29uc3QgcGRmRm9udCA9IGxhc3RGb250LnBkZkZvbnQ7CiAgICAgIGNvbnN0IGZvbnRMaW5lSGVpZ2h0ID0gcGRmRm9udC5saW5lSGVpZ2h0IHx8IDEuMjsKICAgICAgY29uc3QgbGluZUhlaWdodCA9IGxhc3RGb250LmxpbmVIZWlnaHQgfHwgTWF0aC5tYXgoMS4yLCBmb250TGluZUhlaWdodCkgKiBmb250U2l6ZTsKICAgICAgY29uc3QgbGluZUdhcCA9IHBkZkZvbnQubGluZUdhcCA9PT0gdW5kZWZpbmVkID8gMC4yIDogcGRmRm9udC5saW5lR2FwOwogICAgICBjb25zdCBub0dhcCA9IGZvbnRMaW5lSGVpZ2h0IC0gbGluZUdhcDsKICAgICAgY29uc3QgZmlyc3RMaW5lSGVpZ2h0ID0gTWF0aC5tYXgoMSwgbm9HYXApICogZm9udFNpemU7CiAgICAgIGNvbnN0IHNjYWxlID0gZm9udFNpemUgLyAxMDAwOwogICAgICBjb25zdCBmYWxsYmFja1dpZHRoID0gcGRmRm9udC5kZWZhdWx0V2lkdGggfHwgcGRmRm9udC5jaGFyc1RvR2x5cGhzKCIgIilbMF0ud2lkdGg7CgogICAgICBmb3IgKGNvbnN0IGxpbmUgb2Ygc3RyLnNwbGl0KC9bXHUyMDI5XG5dLykpIHsKICAgICAgICBjb25zdCBlbmNvZGVkTGluZSA9IHBkZkZvbnQuZW5jb2RlU3RyaW5nKGxpbmUpLmpvaW4oIiIpOwogICAgICAgIGNvbnN0IGdseXBocyA9IHBkZkZvbnQuY2hhcnNUb0dseXBocyhlbmNvZGVkTGluZSk7CgogICAgICAgIGZvciAoY29uc3QgZ2x5cGggb2YgZ2x5cGhzKSB7CiAgICAgICAgICBjb25zdCB3aWR0aCA9IGdseXBoLndpZHRoIHx8IGZhbGxiYWNrV2lkdGg7CiAgICAgICAgICB0aGlzLmdseXBocy5wdXNoKFt3aWR0aCAqIHNjYWxlICsgbGV0dGVyU3BhY2luZywgbGluZUhlaWdodCwgZmlyc3RMaW5lSGVpZ2h0LCBnbHlwaC51bmljb2RlLCBmYWxzZV0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5nbHlwaHMucHVzaChbMCwgMCwgMCwgIlxuIiwgdHJ1ZV0pOwogICAgICB9CgogICAgICB0aGlzLmdseXBocy5wb3AoKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGZvciAoY29uc3QgbGluZSBvZiBzdHIuc3BsaXQoL1tcdTIwMjlcbl0vKSkgewogICAgICBmb3IgKGNvbnN0IGNoYXIgb2YgbGluZS5zcGxpdCgiIikpIHsKICAgICAgICB0aGlzLmdseXBocy5wdXNoKFtmb250U2l6ZSwgMS4yICogZm9udFNpemUsIGZvbnRTaXplLCBjaGFyLCBmYWxzZV0pOwogICAgICB9CgogICAgICB0aGlzLmdseXBocy5wdXNoKFswLCAwLCAwLCAiXG4iLCB0cnVlXSk7CiAgICB9CgogICAgdGhpcy5nbHlwaHMucG9wKCk7CiAgfQoKICBjb21wdXRlKG1heFdpZHRoKSB7CiAgICBsZXQgbGFzdFNwYWNlUG9zID0gLTEsCiAgICAgICAgbGFzdFNwYWNlV2lkdGggPSAwLAogICAgICAgIHdpZHRoID0gMCwKICAgICAgICBoZWlnaHQgPSAwLAogICAgICAgIGN1cnJlbnRMaW5lV2lkdGggPSAwLAogICAgICAgIGN1cnJlbnRMaW5lSGVpZ2h0ID0gMDsKICAgIGxldCBpc0Jyb2tlbiA9IGZhbHNlOwogICAgbGV0IGlzRmlyc3RMaW5lID0gdHJ1ZTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB0aGlzLmdseXBocy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IFtnbHlwaFdpZHRoLCBsaW5lSGVpZ2h0LCBmaXJzdExpbmVIZWlnaHQsIGNoYXIsIGlzRU9MXSA9IHRoaXMuZ2x5cGhzW2ldOwogICAgICBjb25zdCBpc1NwYWNlID0gY2hhciA9PT0gIiAiOwogICAgICBjb25zdCBnbHlwaEhlaWdodCA9IGlzRmlyc3RMaW5lID8gZmlyc3RMaW5lSGVpZ2h0IDogbGluZUhlaWdodDsKCiAgICAgIGlmIChpc0VPTCkgewogICAgICAgIHdpZHRoID0gTWF0aC5tYXgod2lkdGgsIGN1cnJlbnRMaW5lV2lkdGgpOwogICAgICAgIGN1cnJlbnRMaW5lV2lkdGggPSAwOwogICAgICAgIGhlaWdodCArPSBjdXJyZW50TGluZUhlaWdodDsKICAgICAgICBjdXJyZW50TGluZUhlaWdodCA9IGdseXBoSGVpZ2h0OwogICAgICAgIGxhc3RTcGFjZVBvcyA9IC0xOwogICAgICAgIGxhc3RTcGFjZVdpZHRoID0gMDsKICAgICAgICBpc0ZpcnN0TGluZSA9IGZhbHNlOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAoaXNTcGFjZSkgewogICAgICAgIGlmIChjdXJyZW50TGluZVdpZHRoICsgZ2x5cGhXaWR0aCA+IG1heFdpZHRoKSB7CiAgICAgICAgICB3aWR0aCA9IE1hdGgubWF4KHdpZHRoLCBjdXJyZW50TGluZVdpZHRoKTsKICAgICAgICAgIGN1cnJlbnRMaW5lV2lkdGggPSAwOwogICAgICAgICAgaGVpZ2h0ICs9IGN1cnJlbnRMaW5lSGVpZ2h0OwogICAgICAgICAgY3VycmVudExpbmVIZWlnaHQgPSBnbHlwaEhlaWdodDsKICAgICAgICAgIGxhc3RTcGFjZVBvcyA9IC0xOwogICAgICAgICAgbGFzdFNwYWNlV2lkdGggPSAwOwogICAgICAgICAgaXNCcm9rZW4gPSB0cnVlOwogICAgICAgICAgaXNGaXJzdExpbmUgPSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3VycmVudExpbmVIZWlnaHQgPSBNYXRoLm1heChnbHlwaEhlaWdodCwgY3VycmVudExpbmVIZWlnaHQpOwogICAgICAgICAgbGFzdFNwYWNlV2lkdGggPSBjdXJyZW50TGluZVdpZHRoOwogICAgICAgICAgY3VycmVudExpbmVXaWR0aCArPSBnbHlwaFdpZHRoOwogICAgICAgICAgbGFzdFNwYWNlUG9zID0gaTsKICAgICAgICB9CgogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAoY3VycmVudExpbmVXaWR0aCArIGdseXBoV2lkdGggPiBtYXhXaWR0aCkgewogICAgICAgIGhlaWdodCArPSBjdXJyZW50TGluZUhlaWdodDsKICAgICAgICBjdXJyZW50TGluZUhlaWdodCA9IGdseXBoSGVpZ2h0OwoKICAgICAgICBpZiAobGFzdFNwYWNlUG9zICE9PSAtMSkgewogICAgICAgICAgaSA9IGxhc3RTcGFjZVBvczsKICAgICAgICAgIHdpZHRoID0gTWF0aC5tYXgod2lkdGgsIGxhc3RTcGFjZVdpZHRoKTsKICAgICAgICAgIGN1cnJlbnRMaW5lV2lkdGggPSAwOwogICAgICAgICAgbGFzdFNwYWNlUG9zID0gLTE7CiAgICAgICAgICBsYXN0U3BhY2VXaWR0aCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdpZHRoID0gTWF0aC5tYXgod2lkdGgsIGN1cnJlbnRMaW5lV2lkdGgpOwogICAgICAgICAgY3VycmVudExpbmVXaWR0aCA9IGdseXBoV2lkdGg7CiAgICAgICAgfQoKICAgICAgICBpc0Jyb2tlbiA9IHRydWU7CiAgICAgICAgaXNGaXJzdExpbmUgPSBmYWxzZTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY3VycmVudExpbmVXaWR0aCArPSBnbHlwaFdpZHRoOwogICAgICBjdXJyZW50TGluZUhlaWdodCA9IE1hdGgubWF4KGdseXBoSGVpZ2h0LCBjdXJyZW50TGluZUhlaWdodCk7CiAgICB9CgogICAgd2lkdGggPSBNYXRoLm1heCh3aWR0aCwgY3VycmVudExpbmVXaWR0aCk7CiAgICBoZWlnaHQgKz0gY3VycmVudExpbmVIZWlnaHQgKyB0aGlzLmV4dHJhSGVpZ2h0OwogICAgcmV0dXJuIHsKICAgICAgd2lkdGg6IFdJRFRIX0ZBQ1RPUiAqIHdpZHRoLAogICAgICBoZWlnaHQsCiAgICAgIGlzQnJva2VuCiAgICB9OwogIH0KCn0KCmV4cG9ydHMuVGV4dE1lYXN1cmUgPSBUZXh0TWVhc3VyZTsKCi8qKiovIH0pLAovKiAyMTIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkRhdGFIYW5kbGVyID0gdm9pZCAwOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDIpOwoKY2xhc3MgRGF0YUhhbmRsZXIgewogIGNvbnN0cnVjdG9yKHJvb3QsIGRhdGEpIHsKICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICB0aGlzLmRhdGFzZXQgPSByb290LmRhdGFzZXRzIHx8IG51bGw7CiAgfQoKICBzZXJpYWxpemUoc3RvcmFnZSkgewogICAgY29uc3Qgc3RhY2sgPSBbWy0xLCB0aGlzLmRhdGFbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuXSgpXV07CgogICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgY29uc3QgbGFzdCA9IHN0YWNrLmF0KC0xKTsKICAgICAgY29uc3QgW2ksIGNoaWxkcmVuXSA9IGxhc3Q7CgogICAgICBpZiAoaSArIDEgPT09IGNoaWxkcmVuLmxlbmd0aCkgewogICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBjaGlsZCA9IGNoaWxkcmVuWysrbGFzdFswXV07CiAgICAgIGNvbnN0IHN0b3JhZ2VFbnRyeSA9IHN0b3JhZ2UuZ2V0KGNoaWxkW194ZmFfb2JqZWN0LiR1aWRdKTsKCiAgICAgIGlmIChzdG9yYWdlRW50cnkpIHsKICAgICAgICBjaGlsZFtfeGZhX29iamVjdC4kc2V0VmFsdWVdKHN0b3JhZ2VFbnRyeSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGNoaWxkW194ZmFfb2JqZWN0LiRnZXRBdHRyaWJ1dGVzXSgpOwoKICAgICAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIGF0dHJpYnV0ZXMudmFsdWVzKCkpIHsKICAgICAgICAgIGNvbnN0IGVudHJ5ID0gc3RvcmFnZS5nZXQodmFsdWVbX3hmYV9vYmplY3QuJHVpZF0pOwoKICAgICAgICAgIGlmIChlbnRyeSkgewogICAgICAgICAgICB2YWx1ZVtfeGZhX29iamVjdC4kc2V0VmFsdWVdKGVudHJ5KTsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3Qgbm9kZXMgPSBjaGlsZFtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5dKCk7CgogICAgICBpZiAobm9kZXMubGVuZ3RoID4gMCkgewogICAgICAgIHN0YWNrLnB1c2goWy0xLCBub2Rlc10pOwogICAgICB9CiAgICB9CgogICAgY29uc3QgYnVmID0gW2A8eGZhOmRhdGFzZXRzIHhtbG5zOnhmYT0iaHR0cDovL3d3dy54ZmEub3JnL3NjaGVtYS94ZmEtZGF0YS8xLjAvIj5gXTsKCiAgICBpZiAodGhpcy5kYXRhc2V0KSB7CiAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5kYXRhc2V0W194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbl0oKSkgewogICAgICAgIGlmIChjaGlsZFtfeGZhX29iamVjdC4kbm9kZU5hbWVdICE9PSAiZGF0YSIpIHsKICAgICAgICAgIGNoaWxkW194ZmFfb2JqZWN0LiR0b1N0cmluZ10oYnVmKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLmRhdGFbX3hmYV9vYmplY3QuJHRvU3RyaW5nXShidWYpOwoKICAgIGJ1Zi5wdXNoKCI8L3hmYTpkYXRhc2V0cz4iKTsKICAgIHJldHVybiBidWYuam9pbigiIik7CiAgfQoKfQoKZXhwb3J0cy5EYXRhSGFuZGxlciA9IERhdGFIYW5kbGVyOwoKLyoqKi8gfSksCi8qIDIxMyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuWEZBUGFyc2VyID0gdm9pZCAwOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDIpOwoKdmFyIF94bWxfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTEpOwoKdmFyIF9idWlsZGVyID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTQpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNsYXNzIFhGQVBhcnNlciBleHRlbmRzIF94bWxfcGFyc2VyLlhNTFBhcnNlckJhc2UgewogIGNvbnN0cnVjdG9yKCkgewogICAgbGV0IHJvb3ROYW1lU3BhY2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IG51bGw7CiAgICBsZXQgcmljaFRleHQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgc3VwZXIoKTsKICAgIHRoaXMuX2J1aWxkZXIgPSBuZXcgX2J1aWxkZXIuQnVpbGRlcihyb290TmFtZVNwYWNlKTsKICAgIHRoaXMuX3N0YWNrID0gW107CiAgICB0aGlzLl9nbG9iYWxEYXRhID0gewogICAgICB1c2VkVHlwZWZhY2VzOiBuZXcgU2V0KCkKICAgIH07CiAgICB0aGlzLl9pZHMgPSBuZXcgTWFwKCk7CiAgICB0aGlzLl9jdXJyZW50ID0gdGhpcy5fYnVpbGRlci5idWlsZFJvb3QodGhpcy5faWRzKTsKICAgIHRoaXMuX2Vycm9yQ29kZSA9IF94bWxfcGFyc2VyLlhNTFBhcnNlckVycm9yQ29kZS5Ob0Vycm9yOwogICAgdGhpcy5fd2hpdGVSZWdleCA9IC9eXHMrJC87CiAgICB0aGlzLl9uYnNwcyA9IC9ceGEwKy9nOwogICAgdGhpcy5fcmljaFRleHQgPSByaWNoVGV4dDsKICB9CgogIHBhcnNlKGRhdGEpIHsKICAgIHRoaXMucGFyc2VYbWwoZGF0YSk7CgogICAgaWYgKHRoaXMuX2Vycm9yQ29kZSAhPT0gX3htbF9wYXJzZXIuWE1MUGFyc2VyRXJyb3JDb2RlLk5vRXJyb3IpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB0aGlzLl9jdXJyZW50W194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKTsKCiAgICByZXR1cm4gdGhpcy5fY3VycmVudC5lbGVtZW50OwogIH0KCiAgb25UZXh0KHRleHQpIHsKICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UodGhpcy5fbmJzcHMsIG1hdGNoID0+IG1hdGNoLnNsaWNlKDEpICsgIiAiKTsKCiAgICBpZiAodGhpcy5fcmljaFRleHQgfHwgdGhpcy5fY3VycmVudFtfeGZhX29iamVjdC4kYWNjZXB0V2hpdGVzcGFjZV0oKSkgewogICAgICB0aGlzLl9jdXJyZW50W194ZmFfb2JqZWN0LiRvblRleHRdKHRleHQsIHRoaXMuX3JpY2hUZXh0KTsKCiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy5fd2hpdGVSZWdleC50ZXN0KHRleHQpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9jdXJyZW50W194ZmFfb2JqZWN0LiRvblRleHRdKHRleHQudHJpbSgpKTsKICB9CgogIG9uQ2RhdGEodGV4dCkgewogICAgdGhpcy5fY3VycmVudFtfeGZhX29iamVjdC4kb25UZXh0XSh0ZXh0KTsKICB9CgogIF9ta0F0dHJpYnV0ZXMoYXR0cmlidXRlcywgdGFnTmFtZSkgewogICAgbGV0IG5hbWVzcGFjZSA9IG51bGw7CiAgICBsZXQgcHJlZml4ZXMgPSBudWxsOwogICAgY29uc3QgYXR0cmlidXRlT2JqID0gT2JqZWN0LmNyZWF0ZSh7fSk7CgogICAgZm9yIChjb25zdCB7CiAgICAgIG5hbWUsCiAgICAgIHZhbHVlCiAgICB9IG9mIGF0dHJpYnV0ZXMpIHsKICAgICAgaWYgKG5hbWUgPT09ICJ4bWxucyIpIHsKICAgICAgICBpZiAoIW5hbWVzcGFjZSkgewogICAgICAgICAgbmFtZXNwYWNlID0gdmFsdWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gbXVsdGlwbGUgbmFtZXNwYWNlIGRlZmluaXRpb24gaW4gPCR7dGFnTmFtZX0+YCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG5hbWUuc3RhcnRzV2l0aCgieG1sbnM6IikpIHsKICAgICAgICBjb25zdCBwcmVmaXggPSBuYW1lLnN1YnN0cmluZygieG1sbnM6Ii5sZW5ndGgpOwoKICAgICAgICBpZiAoIXByZWZpeGVzKSB7CiAgICAgICAgICBwcmVmaXhlcyA9IFtdOwogICAgICAgIH0KCiAgICAgICAgcHJlZml4ZXMucHVzaCh7CiAgICAgICAgICBwcmVmaXgsCiAgICAgICAgICB2YWx1ZQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGkgPSBuYW1lLmluZGV4T2YoIjoiKTsKCiAgICAgICAgaWYgKGkgPT09IC0xKSB7CiAgICAgICAgICBhdHRyaWJ1dGVPYmpbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGV0IG5zQXR0cnMgPSBhdHRyaWJ1dGVPYmpbX3hmYV9vYmplY3QuJG5zQXR0cmlidXRlc107CgogICAgICAgICAgaWYgKCFuc0F0dHJzKSB7CiAgICAgICAgICAgIG5zQXR0cnMgPSBhdHRyaWJ1dGVPYmpbX3hmYV9vYmplY3QuJG5zQXR0cmlidXRlc10gPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IFtucywgYXR0ck5hbWVdID0gW25hbWUuc2xpY2UoMCwgaSksIG5hbWUuc2xpY2UoaSArIDEpXTsKICAgICAgICAgIGxldCBhdHRycyA9IG5zQXR0cnNbbnNdOwoKICAgICAgICAgIGlmICghYXR0cnMpIHsKICAgICAgICAgICAgYXR0cnMgPSBuc0F0dHJzW25zXSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgYXR0cnNbYXR0ck5hbWVdID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIFtuYW1lc3BhY2UsIHByZWZpeGVzLCBhdHRyaWJ1dGVPYmpdOwogIH0KCiAgX2dldE5hbWVBbmRQcmVmaXgobmFtZSwgbnNBZ25vc3RpYykgewogICAgY29uc3QgaSA9IG5hbWUuaW5kZXhPZigiOiIpOwoKICAgIGlmIChpID09PSAtMSkgewogICAgICByZXR1cm4gW25hbWUsIG51bGxdOwogICAgfQoKICAgIHJldHVybiBbbmFtZS5zdWJzdHJpbmcoaSArIDEpLCBuc0Fnbm9zdGljID8gIiIgOiBuYW1lLnN1YnN0cmluZygwLCBpKV07CiAgfQoKICBvbkJlZ2luRWxlbWVudCh0YWdOYW1lLCBhdHRyaWJ1dGVzLCBpc0VtcHR5KSB7CiAgICBjb25zdCBbbmFtZXNwYWNlLCBwcmVmaXhlcywgYXR0cmlidXRlc09ial0gPSB0aGlzLl9ta0F0dHJpYnV0ZXMoYXR0cmlidXRlcywgdGFnTmFtZSk7CgogICAgY29uc3QgW25hbWUsIG5zUHJlZml4XSA9IHRoaXMuX2dldE5hbWVBbmRQcmVmaXgodGFnTmFtZSwgdGhpcy5fYnVpbGRlci5pc05zQWdub3N0aWMoKSk7CgogICAgY29uc3Qgbm9kZSA9IHRoaXMuX2J1aWxkZXIuYnVpbGQoewogICAgICBuc1ByZWZpeCwKICAgICAgbmFtZSwKICAgICAgYXR0cmlidXRlczogYXR0cmlidXRlc09iaiwKICAgICAgbmFtZXNwYWNlLAogICAgICBwcmVmaXhlcwogICAgfSk7CgogICAgbm9kZVtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0gPSB0aGlzLl9nbG9iYWxEYXRhOwoKICAgIGlmIChpc0VtcHR5KSB7CiAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpOwoKICAgICAgaWYgKHRoaXMuX2N1cnJlbnRbX3hmYV9vYmplY3QuJG9uQ2hpbGRdKG5vZGUpKSB7CiAgICAgICAgbm9kZVtfeGZhX29iamVjdC4kc2V0SWRdKHRoaXMuX2lkcyk7CiAgICAgIH0KCiAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGNsZWFuXSh0aGlzLl9idWlsZGVyKTsKCiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9zdGFjay5wdXNoKHRoaXMuX2N1cnJlbnQpOwoKICAgIHRoaXMuX2N1cnJlbnQgPSBub2RlOwogIH0KCiAgb25FbmRFbGVtZW50KG5hbWUpIHsKICAgIGNvbnN0IG5vZGUgPSB0aGlzLl9jdXJyZW50OwoKICAgIGlmIChub2RlW194ZmFfb2JqZWN0LiRpc0NEQVRBWG1sXSgpICYmIHR5cGVvZiBub2RlW194ZmFfb2JqZWN0LiRjb250ZW50XSA9PT0gInN0cmluZyIpIHsKICAgICAgY29uc3QgcGFyc2VyID0gbmV3IFhGQVBhcnNlcigpOwogICAgICBwYXJzZXIuX2dsb2JhbERhdGEgPSB0aGlzLl9nbG9iYWxEYXRhOwogICAgICBjb25zdCByb290ID0gcGFyc2VyLnBhcnNlKG5vZGVbX3hmYV9vYmplY3QuJGNvbnRlbnRdKTsKICAgICAgbm9kZVtfeGZhX29iamVjdC4kY29udGVudF0gPSBudWxsOwoKICAgICAgbm9kZVtfeGZhX29iamVjdC4kb25DaGlsZF0ocm9vdCk7CiAgICB9CgogICAgbm9kZVtfeGZhX29iamVjdC4kZmluYWxpemVdKCk7CgogICAgdGhpcy5fY3VycmVudCA9IHRoaXMuX3N0YWNrLnBvcCgpOwoKICAgIGlmICh0aGlzLl9jdXJyZW50W194ZmFfb2JqZWN0LiRvbkNoaWxkXShub2RlKSkgewogICAgICBub2RlW194ZmFfb2JqZWN0LiRzZXRJZF0odGhpcy5faWRzKTsKICAgIH0KCiAgICBub2RlW194ZmFfb2JqZWN0LiRjbGVhbl0odGhpcy5fYnVpbGRlcik7CiAgfQoKICBvbkVycm9yKGNvZGUpIHsKICAgIHRoaXMuX2Vycm9yQ29kZSA9IGNvZGU7CiAgfQoKfQoKZXhwb3J0cy5YRkFQYXJzZXIgPSBYRkFQYXJzZXI7CgovKioqLyB9KSwKLyogMjE0ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5CdWlsZGVyID0gdm9pZCAwOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDQpOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDIpOwoKdmFyIF9zZXR1cCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjE1KTsKCnZhciBfdGVtcGxhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNyk7Cgp2YXIgX3Vua25vd24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyNCk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY2xhc3MgUm9vdCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoaWRzKSB7CiAgICBzdXBlcigtMSwgInJvb3QiLCBPYmplY3QuY3JlYXRlKG51bGwpKTsKICAgIHRoaXMuZWxlbWVudCA9IG51bGw7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRpZHNdID0gaWRzOwogIH0KCiAgW194ZmFfb2JqZWN0LiRvbkNoaWxkXShjaGlsZCkgewogICAgdGhpcy5lbGVtZW50ID0gY2hpbGQ7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgc3VwZXJbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpOwoKICAgIGlmICh0aGlzLmVsZW1lbnQudGVtcGxhdGUgaW5zdGFuY2VvZiBfdGVtcGxhdGUuVGVtcGxhdGUpIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kaWRzXS5zZXQoX3hmYV9vYmplY3QuJHJvb3QsIHRoaXMuZWxlbWVudCk7CgogICAgICB0aGlzLmVsZW1lbnQudGVtcGxhdGVbX3hmYV9vYmplY3QuJHJlc29sdmVQcm90b3R5cGVzXSh0aGlzW194ZmFfb2JqZWN0LiRpZHNdKTsKCiAgICAgIHRoaXMuZWxlbWVudC50ZW1wbGF0ZVtfeGZhX29iamVjdC4kaWRzXSA9IHRoaXNbX3hmYV9vYmplY3QuJGlkc107CiAgICB9CiAgfQoKfQoKY2xhc3MgRW1wdHkgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoLTEsICIiLCBPYmplY3QuY3JlYXRlKG51bGwpKTsKICB9CgogIFtfeGZhX29iamVjdC4kb25DaGlsZF0oXykgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCn0KCmNsYXNzIEJ1aWxkZXIgewogIGNvbnN0cnVjdG9yKCkgewogICAgbGV0IHJvb3ROYW1lU3BhY2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IG51bGw7CiAgICB0aGlzLl9uYW1lc3BhY2VTdGFjayA9IFtdOwogICAgdGhpcy5fbnNBZ25vc3RpY0xldmVsID0gMDsKICAgIHRoaXMuX25hbWVzcGFjZVByZWZpeGVzID0gbmV3IE1hcCgpOwogICAgdGhpcy5fbmFtZXNwYWNlcyA9IG5ldyBNYXAoKTsKICAgIHRoaXMuX25leHROc0lkID0gTWF0aC5tYXgoLi4uT2JqZWN0LnZhbHVlcyhfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMpLm1hcChfcmVmID0+IHsKICAgICAgbGV0IHsKICAgICAgICBpZAogICAgICB9ID0gX3JlZjsKICAgICAgcmV0dXJuIGlkOwogICAgfSkpOwogICAgdGhpcy5fY3VycmVudE5hbWVzcGFjZSA9IHJvb3ROYW1lU3BhY2UgfHwgbmV3IF91bmtub3duLlVua25vd25OYW1lc3BhY2UoKyt0aGlzLl9uZXh0TnNJZCk7CiAgfQoKICBidWlsZFJvb3QoaWRzKSB7CiAgICByZXR1cm4gbmV3IFJvb3QoaWRzKTsKICB9CgogIGJ1aWxkKF9yZWYyKSB7CiAgICBsZXQgewogICAgICBuc1ByZWZpeCwKICAgICAgbmFtZSwKICAgICAgYXR0cmlidXRlcywKICAgICAgbmFtZXNwYWNlLAogICAgICBwcmVmaXhlcwogICAgfSA9IF9yZWYyOwogICAgY29uc3QgaGFzTmFtZXNwYWNlRGVmID0gbmFtZXNwYWNlICE9PSBudWxsOwoKICAgIGlmIChoYXNOYW1lc3BhY2VEZWYpIHsKICAgICAgdGhpcy5fbmFtZXNwYWNlU3RhY2sucHVzaCh0aGlzLl9jdXJyZW50TmFtZXNwYWNlKTsKCiAgICAgIHRoaXMuX2N1cnJlbnROYW1lc3BhY2UgPSB0aGlzLl9zZWFyY2hOYW1lc3BhY2UobmFtZXNwYWNlKTsKICAgIH0KCiAgICBpZiAocHJlZml4ZXMpIHsKICAgICAgdGhpcy5fYWRkTmFtZXNwYWNlUHJlZml4KHByZWZpeGVzKTsKICAgIH0KCiAgICBpZiAoYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShfeGZhX29iamVjdC4kbnNBdHRyaWJ1dGVzKSkgewogICAgICBjb25zdCBkYXRhVGVtcGxhdGUgPSBfc2V0dXAuTmFtZXNwYWNlU2V0VXAuZGF0YXNldHM7CiAgICAgIGNvbnN0IG5zQXR0cnMgPSBhdHRyaWJ1dGVzW194ZmFfb2JqZWN0LiRuc0F0dHJpYnV0ZXNdOwogICAgICBsZXQgeGZhQXR0cnMgPSBudWxsOwoKICAgICAgZm9yIChjb25zdCBbbnMsIGF0dHJzXSBvZiBPYmplY3QuZW50cmllcyhuc0F0dHJzKSkgewogICAgICAgIGNvbnN0IG5zVG9Vc2UgPSB0aGlzLl9nZXROYW1lc3BhY2VUb1VzZShucyk7CgogICAgICAgIGlmIChuc1RvVXNlID09PSBkYXRhVGVtcGxhdGUpIHsKICAgICAgICAgIHhmYUF0dHJzID0gewogICAgICAgICAgICB4ZmE6IGF0dHJzCiAgICAgICAgICB9OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoeGZhQXR0cnMpIHsKICAgICAgICBhdHRyaWJ1dGVzW194ZmFfb2JqZWN0LiRuc0F0dHJpYnV0ZXNdID0geGZhQXR0cnM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGVsZXRlIGF0dHJpYnV0ZXNbX3hmYV9vYmplY3QuJG5zQXR0cmlidXRlc107CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBuYW1lc3BhY2VUb1VzZSA9IHRoaXMuX2dldE5hbWVzcGFjZVRvVXNlKG5zUHJlZml4KTsKCiAgICBjb25zdCBub2RlID0gbmFtZXNwYWNlVG9Vc2UgJiYgbmFtZXNwYWNlVG9Vc2VbX25hbWVzcGFjZXMuJGJ1aWxkWEZBT2JqZWN0XShuYW1lLCBhdHRyaWJ1dGVzKSB8fCBuZXcgRW1wdHkoKTsKCiAgICBpZiAobm9kZVtfeGZhX29iamVjdC4kaXNOc0Fnbm9zdGljXSgpKSB7CiAgICAgIHRoaXMuX25zQWdub3N0aWNMZXZlbCsrOwogICAgfQoKICAgIGlmIChoYXNOYW1lc3BhY2VEZWYgfHwgcHJlZml4ZXMgfHwgbm9kZVtfeGZhX29iamVjdC4kaXNOc0Fnbm9zdGljXSgpKSB7CiAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGNsZWFudXBdID0gewogICAgICAgIGhhc05hbWVzcGFjZTogaGFzTmFtZXNwYWNlRGVmLAogICAgICAgIHByZWZpeGVzLAogICAgICAgIG5zQWdub3N0aWM6IG5vZGVbX3hmYV9vYmplY3QuJGlzTnNBZ25vc3RpY10oKQogICAgICB9OwogICAgfQoKICAgIHJldHVybiBub2RlOwogIH0KCiAgaXNOc0Fnbm9zdGljKCkgewogICAgcmV0dXJuIHRoaXMuX25zQWdub3N0aWNMZXZlbCA+IDA7CiAgfQoKICBfc2VhcmNoTmFtZXNwYWNlKG5zTmFtZSkgewogICAgbGV0IG5zID0gdGhpcy5fbmFtZXNwYWNlcy5nZXQobnNOYW1lKTsKCiAgICBpZiAobnMpIHsKICAgICAgcmV0dXJuIG5zOwogICAgfQoKICAgIGZvciAoY29uc3QgW25hbWUsIHsKICAgICAgY2hlY2sKICAgIH1dIG9mIE9iamVjdC5lbnRyaWVzKF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcykpIHsKICAgICAgaWYgKGNoZWNrKG5zTmFtZSkpIHsKICAgICAgICBucyA9IF9zZXR1cC5OYW1lc3BhY2VTZXRVcFtuYW1lXTsKCiAgICAgICAgaWYgKG5zKSB7CiAgICAgICAgICB0aGlzLl9uYW1lc3BhY2VzLnNldChuc05hbWUsIG5zKTsKCiAgICAgICAgICByZXR1cm4gbnM7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIG5zID0gbmV3IF91bmtub3duLlVua25vd25OYW1lc3BhY2UoKyt0aGlzLl9uZXh0TnNJZCk7CgogICAgdGhpcy5fbmFtZXNwYWNlcy5zZXQobnNOYW1lLCBucyk7CgogICAgcmV0dXJuIG5zOwogIH0KCiAgX2FkZE5hbWVzcGFjZVByZWZpeChwcmVmaXhlcykgewogICAgZm9yIChjb25zdCB7CiAgICAgIHByZWZpeCwKICAgICAgdmFsdWUKICAgIH0gb2YgcHJlZml4ZXMpIHsKICAgICAgY29uc3QgbmFtZXNwYWNlID0gdGhpcy5fc2VhcmNoTmFtZXNwYWNlKHZhbHVlKTsKCiAgICAgIGxldCBwcmVmaXhTdGFjayA9IHRoaXMuX25hbWVzcGFjZVByZWZpeGVzLmdldChwcmVmaXgpOwoKICAgICAgaWYgKCFwcmVmaXhTdGFjaykgewogICAgICAgIHByZWZpeFN0YWNrID0gW107CgogICAgICAgIHRoaXMuX25hbWVzcGFjZVByZWZpeGVzLnNldChwcmVmaXgsIHByZWZpeFN0YWNrKTsKICAgICAgfQoKICAgICAgcHJlZml4U3RhY2sucHVzaChuYW1lc3BhY2UpOwogICAgfQogIH0KCiAgX2dldE5hbWVzcGFjZVRvVXNlKHByZWZpeCkgewogICAgaWYgKCFwcmVmaXgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnROYW1lc3BhY2U7CiAgICB9CgogICAgY29uc3QgcHJlZml4U3RhY2sgPSB0aGlzLl9uYW1lc3BhY2VQcmVmaXhlcy5nZXQocHJlZml4KTsKCiAgICBpZiAocHJlZml4U3RhY2sgJiYgcHJlZml4U3RhY2subGVuZ3RoID4gMCkgewogICAgICByZXR1cm4gcHJlZml4U3RhY2suYXQoLTEpOwogICAgfQoKICAgICgwLCBfdXRpbC53YXJuKShgVW5rbm93biBuYW1lc3BhY2UgcHJlZml4OiAke3ByZWZpeH0uYCk7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNsZWFuKGRhdGEpIHsKICAgIGNvbnN0IHsKICAgICAgaGFzTmFtZXNwYWNlLAogICAgICBwcmVmaXhlcywKICAgICAgbnNBZ25vc3RpYwogICAgfSA9IGRhdGE7CgogICAgaWYgKGhhc05hbWVzcGFjZSkgewogICAgICB0aGlzLl9jdXJyZW50TmFtZXNwYWNlID0gdGhpcy5fbmFtZXNwYWNlU3RhY2sucG9wKCk7CiAgICB9CgogICAgaWYgKHByZWZpeGVzKSB7CiAgICAgIHByZWZpeGVzLmZvckVhY2goX3JlZjMgPT4gewogICAgICAgIGxldCB7CiAgICAgICAgICBwcmVmaXgKICAgICAgICB9ID0gX3JlZjM7CgogICAgICAgIHRoaXMuX25hbWVzcGFjZVByZWZpeGVzLmdldChwcmVmaXgpLnBvcCgpOwogICAgICB9KTsKICAgIH0KCiAgICBpZiAobnNBZ25vc3RpYykgewogICAgICB0aGlzLl9uc0Fnbm9zdGljTGV2ZWwtLTsKICAgIH0KICB9Cgp9CgpleHBvcnRzLkJ1aWxkZXIgPSBCdWlsZGVyOwoKLyoqKi8gfSksCi8qIDIxNSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTmFtZXNwYWNlU2V0VXAgPSB2b2lkIDA7Cgp2YXIgX2NvbmZpZyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjE2KTsKCnZhciBfY29ubmVjdGlvbl9zZXQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxNyk7Cgp2YXIgX2RhdGFzZXRzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTgpOwoKdmFyIF9sb2NhbGVfc2V0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTkpOwoKdmFyIF9zaWduYXR1cmUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyMCk7Cgp2YXIgX3N0eWxlc2hlZXQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyMSk7Cgp2YXIgX3RlbXBsYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDcpOwoKdmFyIF94ZHAgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyMik7Cgp2YXIgX3hodG1sID0gX193X3BkZmpzX3JlcXVpcmVfXygyMjMpOwoKY29uc3QgTmFtZXNwYWNlU2V0VXAgPSB7CiAgY29uZmlnOiBfY29uZmlnLkNvbmZpZ05hbWVzcGFjZSwKICBjb25uZWN0aW9uOiBfY29ubmVjdGlvbl9zZXQuQ29ubmVjdGlvblNldE5hbWVzcGFjZSwKICBkYXRhc2V0czogX2RhdGFzZXRzLkRhdGFzZXRzTmFtZXNwYWNlLAogIGxvY2FsZVNldDogX2xvY2FsZV9zZXQuTG9jYWxlU2V0TmFtZXNwYWNlLAogIHNpZ25hdHVyZTogX3NpZ25hdHVyZS5TaWduYXR1cmVOYW1lc3BhY2UsCiAgc3R5bGVzaGVldDogX3N0eWxlc2hlZXQuU3R5bGVzaGVldE5hbWVzcGFjZSwKICB0ZW1wbGF0ZTogX3RlbXBsYXRlLlRlbXBsYXRlTmFtZXNwYWNlLAogIHhkcDogX3hkcC5YZHBOYW1lc3BhY2UsCiAgeGh0bWw6IF94aHRtbC5YaHRtbE5hbWVzcGFjZQp9OwpleHBvcnRzLk5hbWVzcGFjZVNldFVwID0gTmFtZXNwYWNlU2V0VXA7CgovKioqLyB9KSwKLyogMjE2ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Db25maWdOYW1lc3BhY2UgPSB2b2lkIDA7Cgp2YXIgX25hbWVzcGFjZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNCk7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMik7Cgp2YXIgX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDMpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNvbnN0IENPTkZJR19OU19JRCA9IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy5jb25maWcuaWQ7CgpjbGFzcyBBY3JvYmF0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJhY3JvYmF0IiwgdHJ1ZSk7CiAgICB0aGlzLmFjcm9iYXQ3ID0gbnVsbDsKICAgIHRoaXMuYXV0b1NhdmUgPSBudWxsOwogICAgdGhpcy5jb21tb24gPSBudWxsOwogICAgdGhpcy52YWxpZGF0ZSA9IG51bGw7CiAgICB0aGlzLnZhbGlkYXRlQXBwcm92YWxTaWduYXR1cmVzID0gbnVsbDsKICAgIHRoaXMuc3VibWl0VXJsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgQWNyb2JhdDcgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFjcm9iYXQ3IiwgdHJ1ZSk7CiAgICB0aGlzLmR5bmFtaWNSZW5kZXIgPSBudWxsOwogIH0KCn0KCmNsYXNzIEFEQkVfSlNDb25zb2xlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJBREJFX0pTQ29uc29sZSIsIFsiZGVsZWdhdGUiLCAiRW5hYmxlIiwgIkRpc2FibGUiXSk7CiAgfQoKfQoKY2xhc3MgQURCRV9KU0RlYnVnZ2VyIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJBREJFX0pTRGVidWdnZXIiLCBbImRlbGVnYXRlIiwgIkVuYWJsZSIsICJEaXNhYmxlIl0pOwogIH0KCn0KCmNsYXNzIEFkZFNpbGVudFByaW50IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFkZFNpbGVudFByaW50Iik7CiAgfQoKfQoKY2xhc3MgQWRkVmlld2VyUHJlZmVyZW5jZXMgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiYWRkVmlld2VyUHJlZmVyZW5jZXMiKTsKICB9Cgp9CgpjbGFzcyBBZGp1c3REYXRhIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMTAgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFkanVzdERhdGEiKTsKICB9Cgp9CgpjbGFzcyBBZG9iZUV4dGVuc2lvbkxldmVsIGV4dGVuZHMgX3hmYV9vYmplY3QuSW50ZWdlck9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiYWRvYmVFeHRlbnNpb25MZXZlbCIsIDAsIG4gPT4gbiA+PSAxICYmIG4gPD0gOCk7CiAgfQoKfQoKY2xhc3MgQWdlbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFnZW50IiwgdHJ1ZSk7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgPyBhdHRyaWJ1dGVzLm5hbWUudHJpbSgpIDogIiI7CiAgICB0aGlzLmNvbW1vbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIEFsd2F5c0VtYmVkIGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiYWx3YXlzRW1iZWQiKTsKICB9Cgp9CgpjbGFzcyBBbWQgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFtZCIpOwogIH0KCn0KCmNsYXNzIEFyZWEgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFyZWEiKTsKICAgIHRoaXMubGV2ZWwgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5sZXZlbCwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogbiA9PiBuID49IDEgJiYgbiA8PSAzCiAgICB9KTsKICAgIHRoaXMubmFtZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm5hbWUsIFsiIiwgImJhcmNvZGUiLCAiY29yZWluaXQiLCAiZGV2aWNlRHJpdmVyIiwgImZvbnQiLCAiZ2VuZXJhbCIsICJsYXlvdXQiLCAibWVyZ2UiLCAic2NyaXB0IiwgInNpZ25hdHVyZSIsICJzb3VyY2VTZXQiLCAidGVtcGxhdGVDYWNoZSJdKTsKICB9Cgp9CgpjbGFzcyBBdHRyaWJ1dGVzIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJhdHRyaWJ1dGVzIiwgWyJwcmVzZXJ2ZSIsICJkZWxlZ2F0ZSIsICJpZ25vcmUiXSk7CiAgfQoKfQoKY2xhc3MgQXV0b1NhdmUgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImF1dG9TYXZlIiwgWyJkaXNhYmxlZCIsICJlbmFibGVkIl0pOwogIH0KCn0KCmNsYXNzIEJhc2UgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImJhc2UiKTsKICB9Cgp9CgpjbGFzcyBCYXRjaE91dHB1dCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiYmF0Y2hPdXRwdXQiKTsKICAgIHRoaXMuZm9ybWF0ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuZm9ybWF0LCBbIm5vbmUiLCAiY29uY2F0IiwgInppcCIsICJ6aXBDb21wcmVzcyJdKTsKICB9Cgp9CgpjbGFzcyBCZWhhdmlvck92ZXJyaWRlIGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiYmVoYXZpb3JPdmVycmlkZSIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IG5ldyBNYXAodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpLnNwbGl0KC9ccysvKS5maWx0ZXIoeCA9PiB4LmluY2x1ZGVzKCI6IikpLm1hcCh4ID0+IHguc3BsaXQoIjoiLCAyKSkpOwogIH0KCn0KCmNsYXNzIENhY2hlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJjYWNoZSIsIHRydWUpOwogICAgdGhpcy50ZW1wbGF0ZUNhY2hlID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBDaGFuZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiY2hhbmdlIik7CiAgfQoKfQoKY2xhc3MgQ29tbW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJjb21tb24iLCB0cnVlKTsKICAgIHRoaXMuZGF0YSA9IG51bGw7CiAgICB0aGlzLmxvY2FsZSA9IG51bGw7CiAgICB0aGlzLmxvY2FsZVNldCA9IG51bGw7CiAgICB0aGlzLm1lc3NhZ2luZyA9IG51bGw7CiAgICB0aGlzLnN1cHByZXNzQmFubmVyID0gbnVsbDsKICAgIHRoaXMudGVtcGxhdGUgPSBudWxsOwogICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnaW5nID0gbnVsbDsKICAgIHRoaXMudmVyc2lvbkNvbnRyb2wgPSBudWxsOwogICAgdGhpcy5sb2cgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBDb21wcmVzcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiY29tcHJlc3MiKTsKICAgIHRoaXMuc2NvcGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5zY29wZSwgWyJpbWFnZU9ubHkiLCAiZG9jdW1lbnQiXSk7CiAgfQoKfQoKY2xhc3MgQ29tcHJlc3NMb2dpY2FsU3RydWN0dXJlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImNvbXByZXNzTG9naWNhbFN0cnVjdHVyZSIpOwogIH0KCn0KCmNsYXNzIENvbXByZXNzT2JqZWN0U3RyZWFtIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMTAgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImNvbXByZXNzT2JqZWN0U3RyZWFtIik7CiAgfQoKfQoKY2xhc3MgQ29tcHJlc3Npb24gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImNvbXByZXNzaW9uIiwgdHJ1ZSk7CiAgICB0aGlzLmNvbXByZXNzTG9naWNhbFN0cnVjdHVyZSA9IG51bGw7CiAgICB0aGlzLmNvbXByZXNzT2JqZWN0U3RyZWFtID0gbnVsbDsKICAgIHRoaXMubGV2ZWwgPSBudWxsOwogICAgdGhpcy50eXBlID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBDb25maWcgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImNvbmZpZyIsIHRydWUpOwogICAgdGhpcy5hY3JvYmF0ID0gbnVsbDsKICAgIHRoaXMucHJlc2VudCA9IG51bGw7CiAgICB0aGlzLnRyYWNlID0gbnVsbDsKICAgIHRoaXMuYWdlbnQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBDb25mb3JtYW5jZSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiY29uZm9ybWFuY2UiLCBbIkEiLCAiQiJdKTsKICB9Cgp9CgpjbGFzcyBDb250ZW50Q29weSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJjb250ZW50Q29weSIpOwogIH0KCn0KCmNsYXNzIENvcGllcyBleHRlbmRzIF94ZmFfb2JqZWN0LkludGVnZXJPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImNvcGllcyIsIDEsIG4gPT4gbiA+PSAxKTsKICB9Cgp9CgpjbGFzcyBDcmVhdG9yIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJjcmVhdG9yIik7CiAgfQoKfQoKY2xhc3MgQ3VycmVudFBhZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5JbnRlZ2VyT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJjdXJyZW50UGFnZSIsIDAsIG4gPT4gbiA+PSAwKTsKICB9Cgp9CgpjbGFzcyBEYXRhIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJkYXRhIiwgdHJ1ZSk7CiAgICB0aGlzLmFkanVzdERhdGEgPSBudWxsOwogICAgdGhpcy5hdHRyaWJ1dGVzID0gbnVsbDsKICAgIHRoaXMuaW5jcmVtZW50YWxMb2FkID0gbnVsbDsKICAgIHRoaXMub3V0cHV0WFNMID0gbnVsbDsKICAgIHRoaXMucmFuZ2UgPSBudWxsOwogICAgdGhpcy5yZWNvcmQgPSBudWxsOwogICAgdGhpcy5zdGFydE5vZGUgPSBudWxsOwogICAgdGhpcy51cmkgPSBudWxsOwogICAgdGhpcy53aW5kb3cgPSBudWxsOwogICAgdGhpcy54c2wgPSBudWxsOwogICAgdGhpcy5leGNsdWRlTlMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudHJhbnNmb3JtID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgRGVidWcgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImRlYnVnIiwgdHJ1ZSk7CiAgICB0aGlzLnVyaSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgRGVmYXVsdFR5cGVmYWNlIGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZGVmYXVsdFR5cGVmYWNlIik7CiAgICB0aGlzLndyaXRpbmdTY3JpcHQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy53cml0aW5nU2NyaXB0LCBbIioiLCAiQXJhYmljIiwgIkN5cmlsbGljIiwgIkVhc3RFdXJvcGVhblJvbWFuIiwgIkdyZWVrIiwgIkhlYnJldyIsICJKYXBhbmVzZSIsICJLb3JlYW4iLCAiUm9tYW4iLCAiU2ltcGxpZmllZENoaW5lc2UiLCAiVGhhaSIsICJUcmFkaXRpb25hbENoaW5lc2UiLCAiVmlldG5hbWVzZSJdKTsKICB9Cgp9CgpjbGFzcyBEZXN0aW5hdGlvbiBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZGVzdGluYXRpb24iLCBbInBkZiIsICJwY2wiLCAicHMiLCAid2ViQ2xpZW50IiwgInpwbCJdKTsKICB9Cgp9CgpjbGFzcyBEb2N1bWVudEFzc2VtYmx5IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImRvY3VtZW50QXNzZW1ibHkiKTsKICB9Cgp9CgpjbGFzcyBEcml2ZXIgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImRyaXZlciIsIHRydWUpOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lID8gYXR0cmlidXRlcy5uYW1lLnRyaW0oKSA6ICIiOwogICAgdGhpcy5mb250SW5mbyA9IG51bGw7CiAgICB0aGlzLnhkYyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgRHVwbGV4T3B0aW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJkdXBsZXhPcHRpb24iLCBbInNpbXBsZXgiLCAiZHVwbGV4RmxpcExvbmdFZGdlIiwgImR1cGxleEZsaXBTaG9ydEVkZ2UiXSk7CiAgfQoKfQoKY2xhc3MgRHluYW1pY1JlbmRlciBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZHluYW1pY1JlbmRlciIsIFsiZm9yYmlkZGVuIiwgInJlcXVpcmVkIl0pOwogIH0KCn0KCmNsYXNzIEVtYmVkIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImVtYmVkIik7CiAgfQoKfQoKY2xhc3MgRW5jcnlwdCBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJlbmNyeXB0Iik7CiAgfQoKfQoKY2xhc3MgRW5jcnlwdGlvbiBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZW5jcnlwdGlvbiIsIHRydWUpOwogICAgdGhpcy5lbmNyeXB0ID0gbnVsbDsKICAgIHRoaXMuZW5jcnlwdGlvbkxldmVsID0gbnVsbDsKICAgIHRoaXMucGVybWlzc2lvbnMgPSBudWxsOwogIH0KCn0KCmNsYXNzIEVuY3J5cHRpb25MZXZlbCBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZW5jcnlwdGlvbkxldmVsIiwgWyI0MGJpdCIsICIxMjhiaXQiXSk7CiAgfQoKfQoKY2xhc3MgRW5mb3JjZSBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZW5mb3JjZSIpOwogIH0KCn0KCmNsYXNzIEVxdWF0ZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZXF1YXRlIik7CiAgICB0aGlzLmZvcmNlID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuZm9yY2UsCiAgICAgIGRlZmF1bHRWYWx1ZTogMSwKICAgICAgdmFsaWRhdGU6IG4gPT4gbiA9PT0gMAogICAgfSk7CiAgICB0aGlzLmZyb20gPSBhdHRyaWJ1dGVzLmZyb20gfHwgIiI7CiAgICB0aGlzLnRvID0gYXR0cmlidXRlcy50byB8fCAiIjsKICB9Cgp9CgpjbGFzcyBFcXVhdGVSYW5nZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZXF1YXRlUmFuZ2UiKTsKICAgIHRoaXMuZnJvbSA9IGF0dHJpYnV0ZXMuZnJvbSB8fCAiIjsKICAgIHRoaXMudG8gPSBhdHRyaWJ1dGVzLnRvIHx8ICIiOwogICAgdGhpcy5fdW5pY29kZVJhbmdlID0gYXR0cmlidXRlcy51bmljb2RlUmFuZ2UgfHwgIiI7CiAgfQoKICBnZXQgdW5pY29kZVJhbmdlKCkgewogICAgY29uc3QgcmFuZ2VzID0gW107CiAgICBjb25zdCB1bmljb2RlUmVnZXggPSAvVVwrKFswLTlhLWZBLUZdKykvOwogICAgY29uc3QgdW5pY29kZVJhbmdlID0gdGhpcy5fdW5pY29kZVJhbmdlOwoKICAgIGZvciAobGV0IHJhbmdlIG9mIHVuaWNvZGVSYW5nZS5zcGxpdCgiLCIpLm1hcCh4ID0+IHgudHJpbSgpKS5maWx0ZXIoeCA9PiAhIXgpKSB7CiAgICAgIHJhbmdlID0gcmFuZ2Uuc3BsaXQoIi0iLCAyKS5tYXAoeCA9PiB7CiAgICAgICAgY29uc3QgZm91bmQgPSB4Lm1hdGNoKHVuaWNvZGVSZWdleCk7CgogICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHBhcnNlSW50KGZvdW5kWzFdLCAxNik7CiAgICAgIH0pOwoKICAgICAgaWYgKHJhbmdlLmxlbmd0aCA9PT0gMSkgewogICAgICAgIHJhbmdlLnB1c2gocmFuZ2VbMF0pOwogICAgICB9CgogICAgICByYW5nZXMucHVzaChyYW5nZSk7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ1bmljb2RlUmFuZ2UiLCByYW5nZXMpOwogIH0KCn0KCmNsYXNzIEV4Y2x1ZGUgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJleGNsdWRlIik7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpLnNwbGl0KC9ccysvKS5maWx0ZXIoeCA9PiB4ICYmIFsiY2FsY3VsYXRlIiwgImNsb3NlIiwgImVudGVyIiwgImV4aXQiLCAiaW5pdGlhbGl6ZSIsICJyZWFkeSIsICJ2YWxpZGF0ZSJdLmluY2x1ZGVzKHgpKTsKICB9Cgp9CgpjbGFzcyBFeGNsdWRlTlMgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImV4Y2x1ZGVOUyIpOwogIH0KCn0KCmNsYXNzIEZsaXBMYWJlbCBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZmxpcExhYmVsIiwgWyJ1c2VQcmludGVyU2V0dGluZyIsICJvbiIsICJvZmYiXSk7CiAgfQoKfQoKY2xhc3MgRm9udEluZm8gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImZvbnRJbmZvIiwgdHJ1ZSk7CiAgICB0aGlzLmVtYmVkID0gbnVsbDsKICAgIHRoaXMubWFwID0gbnVsbDsKICAgIHRoaXMuc3Vic2V0QmVsb3cgPSBudWxsOwogICAgdGhpcy5hbHdheXNFbWJlZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kZWZhdWx0VHlwZWZhY2UgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMubmV2ZXJFbWJlZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIEZvcm1GaWVsZEZpbGxpbmcgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZm9ybUZpZWxkRmlsbGluZyIpOwogIH0KCn0KCmNsYXNzIEdyb3VwUGFyZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJncm91cFBhcmVudCIpOwogIH0KCn0KCmNsYXNzIElmRW1wdHkgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImlmRW1wdHkiLCBbImRhdGFWYWx1ZSIsICJkYXRhR3JvdXAiLCAiaWdub3JlIiwgInJlbW92ZSJdKTsKICB9Cgp9CgpjbGFzcyBJbmNsdWRlWERQQ29udGVudCBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiaW5jbHVkZVhEUENvbnRlbnQiKTsKICB9Cgp9CgpjbGFzcyBJbmNyZW1lbnRhbExvYWQgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImluY3JlbWVudGFsTG9hZCIsIFsibm9uZSIsICJmb3J3YXJkT25seSJdKTsKICB9Cgp9CgpjbGFzcyBJbmNyZW1lbnRhbE1lcmdlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImluY3JlbWVudGFsTWVyZ2UiKTsKICB9Cgp9CgpjbGFzcyBJbnRlcmFjdGl2ZSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJpbnRlcmFjdGl2ZSIpOwogIH0KCn0KCmNsYXNzIEpvZyBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiam9nIiwgWyJ1c2VQcmludGVyU2V0dGluZyIsICJub25lIiwgInBhZ2VTZXQiXSk7CiAgfQoKfQoKY2xhc3MgTGFiZWxQcmludGVyIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJsYWJlbFByaW50ZXIiLCB0cnVlKTsKICAgIHRoaXMubmFtZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm5hbWUsIFsienBsIiwgImRwbCIsICJpcGwiLCAidGNwbCJdKTsKICAgIHRoaXMuYmF0Y2hPdXRwdXQgPSBudWxsOwogICAgdGhpcy5mbGlwTGFiZWwgPSBudWxsOwogICAgdGhpcy5mb250SW5mbyA9IG51bGw7CiAgICB0aGlzLnhkYyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgTGF5b3V0IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJsYXlvdXQiLCBbInBhZ2luYXRlIiwgInBhbmVsIl0pOwogIH0KCn0KCmNsYXNzIExldmVsIGV4dGVuZHMgX3hmYV9vYmplY3QuSW50ZWdlck9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAibGV2ZWwiLCAwLCBuID0+IG4gPiAwKTsKICB9Cgp9CgpjbGFzcyBMaW5lYXJpemVkIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImxpbmVhcml6ZWQiKTsKICB9Cgp9CgpjbGFzcyBMb2NhbGUgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImxvY2FsZSIpOwogIH0KCn0KCmNsYXNzIExvY2FsZVNldCBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAibG9jYWxlU2V0Iik7CiAgfQoKfQoKY2xhc3MgTG9nIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJsb2ciLCB0cnVlKTsKICAgIHRoaXMubW9kZSA9IG51bGw7CiAgICB0aGlzLnRocmVzaG9sZCA9IG51bGw7CiAgICB0aGlzLnRvID0gbnVsbDsKICAgIHRoaXMudXJpID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBNYXBFbGVtZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJtYXAiLCB0cnVlKTsKICAgIHRoaXMuZXF1YXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmVxdWF0ZVJhbmdlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgTWVkaXVtSW5mbyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAibWVkaXVtSW5mbyIsIHRydWUpOwogICAgdGhpcy5tYXAgPSBudWxsOwogIH0KCn0KCmNsYXNzIE1lc3NhZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm1lc3NhZ2UiLCB0cnVlKTsKICAgIHRoaXMubXNnSWQgPSBudWxsOwogICAgdGhpcy5zZXZlcml0eSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgTWVzc2FnaW5nIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJtZXNzYWdpbmciLCB0cnVlKTsKICAgIHRoaXMubWVzc2FnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIE1vZGUgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm1vZGUiLCBbImFwcGVuZCIsICJvdmVyd3JpdGUiXSk7CiAgfQoKfQoKY2xhc3MgTW9kaWZ5QW5ub3RzIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm1vZGlmeUFubm90cyIpOwogIH0KCn0KCmNsYXNzIE1zZ0lkIGV4dGVuZHMgX3hmYV9vYmplY3QuSW50ZWdlck9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAibXNnSWQiLCAxLCBuID0+IG4gPj0gMSk7CiAgfQoKfQoKY2xhc3MgTmFtZUF0dHIgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm5hbWVBdHRyIik7CiAgfQoKfQoKY2xhc3MgTmV2ZXJFbWJlZCBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm5ldmVyRW1iZWQiKTsKICB9Cgp9CgpjbGFzcyBOdW1iZXJPZkNvcGllcyBleHRlbmRzIF94ZmFfb2JqZWN0LkludGVnZXJPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm51bWJlck9mQ29waWVzIiwgbnVsbCwgbiA9PiBuID49IDIgJiYgbiA8PSA1KTsKICB9Cgp9CgpjbGFzcyBPcGVuQWN0aW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJvcGVuQWN0aW9uIiwgdHJ1ZSk7CiAgICB0aGlzLmRlc3RpbmF0aW9uID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBPdXRwdXQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm91dHB1dCIsIHRydWUpOwogICAgdGhpcy50byA9IG51bGw7CiAgICB0aGlzLnR5cGUgPSBudWxsOwogICAgdGhpcy51cmkgPSBudWxsOwogIH0KCn0KCmNsYXNzIE91dHB1dEJpbiBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAib3V0cHV0QmluIik7CiAgfQoKfQoKY2xhc3MgT3V0cHV0WFNMIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJvdXRwdXRYU0wiLCB0cnVlKTsKICAgIHRoaXMudXJpID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBPdmVycHJpbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm92ZXJwcmludCIsIFsibm9uZSIsICJib3RoIiwgImRyYXciLCAiZmllbGQiXSk7CiAgfQoKfQoKY2xhc3MgUGFja2V0cyBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAicGFja2V0cyIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPT09ICIqIikgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50cmltKCkuc3BsaXQoL1xzKy8pLmZpbHRlcih4ID0+IFsiY29uZmlnIiwgImRhdGFzZXRzIiwgInRlbXBsYXRlIiwgInhmZGYiLCAieHNsdCJdLmluY2x1ZGVzKHgpKTsKICB9Cgp9CgpjbGFzcyBQYWdlT2Zmc2V0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwYWdlT2Zmc2V0Iik7CiAgICB0aGlzLnggPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy54LAogICAgICBkZWZhdWx0VmFsdWU6ICJ1c2VYRENTZXR0aW5nIiwKICAgICAgdmFsaWRhdGU6IG4gPT4gdHJ1ZQogICAgfSk7CiAgICB0aGlzLnkgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy55LAogICAgICBkZWZhdWx0VmFsdWU6ICJ1c2VYRENTZXR0aW5nIiwKICAgICAgdmFsaWRhdGU6IG4gPT4gdHJ1ZQogICAgfSk7CiAgfQoKfQoKY2xhc3MgUGFnZVJhbmdlIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwYWdlUmFuZ2UiKTsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgY29uc3QgbnVtYmVycyA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKS5zcGxpdCgvXHMrLykubWFwKHggPT4gcGFyc2VJbnQoeCwgMTApKTsKCiAgICBjb25zdCByYW5nZXMgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBudW1iZXJzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHsKICAgICAgcmFuZ2VzLnB1c2gobnVtYmVycy5zbGljZShpLCBpICsgMikpOwogICAgfQoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gcmFuZ2VzOwogIH0KCn0KCmNsYXNzIFBhZ2luYXRpb24gZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInBhZ2luYXRpb24iLCBbInNpbXBsZXgiLCAiZHVwbGV4U2hvcnRFZGdlIiwgImR1cGxleExvbmdFZGdlIl0pOwogIH0KCn0KCmNsYXNzIFBhZ2luYXRpb25PdmVycmlkZSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAicGFnaW5hdGlvbk92ZXJyaWRlIiwgWyJub25lIiwgImZvcmNlRHVwbGV4IiwgImZvcmNlRHVwbGV4TG9uZ0VkZ2UiLCAiZm9yY2VEdXBsZXhTaG9ydEVkZ2UiLCAiZm9yY2VTaW1wbGV4Il0pOwogIH0KCn0KCmNsYXNzIFBhcnQgZXh0ZW5kcyBfeGZhX29iamVjdC5JbnRlZ2VyT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwYXJ0IiwgMSwgbiA9PiBmYWxzZSk7CiAgfQoKfQoKY2xhc3MgUGNsIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwY2wiLCB0cnVlKTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMuYmF0Y2hPdXRwdXQgPSBudWxsOwogICAgdGhpcy5mb250SW5mbyA9IG51bGw7CiAgICB0aGlzLmpvZyA9IG51bGw7CiAgICB0aGlzLm1lZGl1bUluZm8gPSBudWxsOwogICAgdGhpcy5vdXRwdXRCaW4gPSBudWxsOwogICAgdGhpcy5wYWdlT2Zmc2V0ID0gbnVsbDsKICAgIHRoaXMuc3RhcGxlID0gbnVsbDsKICAgIHRoaXMueGRjID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBQZGYgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInBkZiIsIHRydWUpOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5hZG9iZUV4dGVuc2lvbkxldmVsID0gbnVsbDsKICAgIHRoaXMuYmF0Y2hPdXRwdXQgPSBudWxsOwogICAgdGhpcy5jb21wcmVzc2lvbiA9IG51bGw7CiAgICB0aGlzLmNyZWF0b3IgPSBudWxsOwogICAgdGhpcy5lbmNyeXB0aW9uID0gbnVsbDsKICAgIHRoaXMuZm9udEluZm8gPSBudWxsOwogICAgdGhpcy5pbnRlcmFjdGl2ZSA9IG51bGw7CiAgICB0aGlzLmxpbmVhcml6ZWQgPSBudWxsOwogICAgdGhpcy5vcGVuQWN0aW9uID0gbnVsbDsKICAgIHRoaXMucGRmYSA9IG51bGw7CiAgICB0aGlzLnByb2R1Y2VyID0gbnVsbDsKICAgIHRoaXMucmVuZGVyUG9saWN5ID0gbnVsbDsKICAgIHRoaXMuc2NyaXB0TW9kZWwgPSBudWxsOwogICAgdGhpcy5zaWxlbnRQcmludCA9IG51bGw7CiAgICB0aGlzLnN1Ym1pdEZvcm1hdCA9IG51bGw7CiAgICB0aGlzLnRhZ2dlZCA9IG51bGw7CiAgICB0aGlzLnZlcnNpb24gPSBudWxsOwogICAgdGhpcy52aWV3ZXJQcmVmZXJlbmNlcyA9IG51bGw7CiAgICB0aGlzLnhkYyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgUGRmYSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAicGRmYSIsIHRydWUpOwogICAgdGhpcy5hbWQgPSBudWxsOwogICAgdGhpcy5jb25mb3JtYW5jZSA9IG51bGw7CiAgICB0aGlzLmluY2x1ZGVYRFBDb250ZW50ID0gbnVsbDsKICAgIHRoaXMucGFydCA9IG51bGw7CiAgfQoKfQoKY2xhc3MgUGVybWlzc2lvbnMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInBlcm1pc3Npb25zIiwgdHJ1ZSk7CiAgICB0aGlzLmFjY2Vzc2libGVDb250ZW50ID0gbnVsbDsKICAgIHRoaXMuY2hhbmdlID0gbnVsbDsKICAgIHRoaXMuY29udGVudENvcHkgPSBudWxsOwogICAgdGhpcy5kb2N1bWVudEFzc2VtYmx5ID0gbnVsbDsKICAgIHRoaXMuZm9ybUZpZWxkRmlsbGluZyA9IG51bGw7CiAgICB0aGlzLm1vZGlmeUFubm90cyA9IG51bGw7CiAgICB0aGlzLnBsYWludGV4dE1ldGFkYXRhID0gbnVsbDsKICAgIHRoaXMucHJpbnQgPSBudWxsOwogICAgdGhpcy5wcmludEhpZ2hRdWFsaXR5ID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBQaWNrVHJheUJ5UERGU2l6ZSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwaWNrVHJheUJ5UERGU2l6ZSIpOwogIH0KCn0KCmNsYXNzIFBpY3R1cmUgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInBpY3R1cmUiKTsKICB9Cgp9CgpjbGFzcyBQbGFpbnRleHRNZXRhZGF0YSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwbGFpbnRleHRNZXRhZGF0YSIpOwogIH0KCn0KCmNsYXNzIFByZXNlbmNlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcmVzZW5jZSIsIFsicHJlc2VydmUiLCAiZGlzc29sdmUiLCAiZGlzc29sdmVTdHJ1Y3R1cmUiLCAiaWdub3JlIiwgInJlbW92ZSJdKTsKICB9Cgp9CgpjbGFzcyBQcmVzZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcmVzZW50IiwgdHJ1ZSk7CiAgICB0aGlzLmJlaGF2aW9yT3ZlcnJpZGUgPSBudWxsOwogICAgdGhpcy5jYWNoZSA9IG51bGw7CiAgICB0aGlzLmNvbW1vbiA9IG51bGw7CiAgICB0aGlzLmNvcGllcyA9IG51bGw7CiAgICB0aGlzLmRlc3RpbmF0aW9uID0gbnVsbDsKICAgIHRoaXMuaW5jcmVtZW50YWxNZXJnZSA9IG51bGw7CiAgICB0aGlzLmxheW91dCA9IG51bGw7CiAgICB0aGlzLm91dHB1dCA9IG51bGw7CiAgICB0aGlzLm92ZXJwcmludCA9IG51bGw7CiAgICB0aGlzLnBhZ2luYXRpb24gPSBudWxsOwogICAgdGhpcy5wYWdpbmF0aW9uT3ZlcnJpZGUgPSBudWxsOwogICAgdGhpcy5zY3JpcHQgPSBudWxsOwogICAgdGhpcy52YWxpZGF0ZSA9IG51bGw7CiAgICB0aGlzLnhkcCA9IG51bGw7CiAgICB0aGlzLmRyaXZlciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5sYWJlbFByaW50ZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucGNsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnBkZiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5wcyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zdWJtaXRVcmwgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMud2ViQ2xpZW50ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnpwbCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIFByaW50IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInByaW50Iik7CiAgfQoKfQoKY2xhc3MgUHJpbnRIaWdoUXVhbGl0eSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcmludEhpZ2hRdWFsaXR5Iik7CiAgfQoKfQoKY2xhc3MgUHJpbnRTY2FsaW5nIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcmludFNjYWxpbmciLCBbImFwcGRlZmF1bHQiLCAibm9TY2FsaW5nIl0pOwogIH0KCn0KCmNsYXNzIFByaW50ZXJOYW1lIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcmludGVyTmFtZSIpOwogIH0KCn0KCmNsYXNzIFByb2R1Y2VyIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcm9kdWNlciIpOwogIH0KCn0KCmNsYXNzIFBzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcyIsIHRydWUpOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5iYXRjaE91dHB1dCA9IG51bGw7CiAgICB0aGlzLmZvbnRJbmZvID0gbnVsbDsKICAgIHRoaXMuam9nID0gbnVsbDsKICAgIHRoaXMubWVkaXVtSW5mbyA9IG51bGw7CiAgICB0aGlzLm91dHB1dEJpbiA9IG51bGw7CiAgICB0aGlzLnN0YXBsZSA9IG51bGw7CiAgICB0aGlzLnhkYyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgUmFuZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJyYW5nZSIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKS5zcGxpdCgvXHMqLFxzKi8sIDIpLm1hcChyYW5nZSA9PiByYW5nZS5zcGxpdCgiLSIpLm1hcCh4ID0+IHBhcnNlSW50KHgudHJpbSgpLCAxMCkpKS5maWx0ZXIocmFuZ2UgPT4gcmFuZ2UuZXZlcnkoeCA9PiAhaXNOYU4oeCkpKS5tYXAocmFuZ2UgPT4gewogICAgICBpZiAocmFuZ2UubGVuZ3RoID09PSAxKSB7CiAgICAgICAgcmFuZ2UucHVzaChyYW5nZVswXSk7CiAgICAgIH0KCiAgICAgIHJldHVybiByYW5nZTsKICAgIH0pOwogIH0KCn0KCmNsYXNzIFJlY29yZCBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInJlY29yZCIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKTsKICAgIGNvbnN0IG4gPSBwYXJzZUludCh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSwgMTApOwoKICAgIGlmICghaXNOYU4obikgJiYgbiA+PSAwKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gbjsKICAgIH0KICB9Cgp9CgpjbGFzcyBSZWxldmFudCBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInJlbGV2YW50Iik7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpLnNwbGl0KC9ccysvKTsKICB9Cgp9CgpjbGFzcyBSZW5hbWUgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJyZW5hbWUiKTsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50cmltKCk7CgogICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgieG1sIikgfHwgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0ubWF0Y2gobmV3IFJlZ0V4cCgiW1xccHtMfV9dW1xccHtMfVxcZC5fXFxwe019LV0qIiwgInUiKSkpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBSZW5hbWU6IGludmFsaWQgWEZBIG5hbWUiKTsKICAgIH0KICB9Cgp9CgpjbGFzcyBSZW5kZXJQb2xpY3kgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInJlbmRlclBvbGljeSIsIFsic2VydmVyIiwgImNsaWVudCJdKTsKICB9Cgp9CgpjbGFzcyBSdW5TY3JpcHRzIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJydW5TY3JpcHRzIiwgWyJib3RoIiwgImNsaWVudCIsICJub25lIiwgInNlcnZlciJdKTsKICB9Cgp9CgpjbGFzcyBTY3JpcHQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInNjcmlwdCIsIHRydWUpOwogICAgdGhpcy5jdXJyZW50UGFnZSA9IG51bGw7CiAgICB0aGlzLmV4Y2x1ZGUgPSBudWxsOwogICAgdGhpcy5ydW5TY3JpcHRzID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBTY3JpcHRNb2RlbCBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAic2NyaXB0TW9kZWwiLCBbIlhGQSIsICJub25lIl0pOwogIH0KCn0KCmNsYXNzIFNldmVyaXR5IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJzZXZlcml0eSIsIFsiaWdub3JlIiwgImVycm9yIiwgImluZm9ybWF0aW9uIiwgInRyYWNlIiwgIndhcm5pbmciXSk7CiAgfQoKfQoKY2xhc3MgU2lsZW50UHJpbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInNpbGVudFByaW50IiwgdHJ1ZSk7CiAgICB0aGlzLmFkZFNpbGVudFByaW50ID0gbnVsbDsKICAgIHRoaXMucHJpbnRlck5hbWUgPSBudWxsOwogIH0KCn0KCmNsYXNzIFN0YXBsZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAic3RhcGxlIik7CiAgICB0aGlzLm1vZGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5tb2RlLCBbInVzZVByaW50ZXJTZXR0aW5nIiwgIm9uIiwgIm9mZiJdKTsKICB9Cgp9CgpjbGFzcyBTdGFydE5vZGUgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInN0YXJ0Tm9kZSIpOwogIH0KCn0KCmNsYXNzIFN0YXJ0UGFnZSBleHRlbmRzIF94ZmFfb2JqZWN0LkludGVnZXJPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInN0YXJ0UGFnZSIsIDAsIG4gPT4gdHJ1ZSk7CiAgfQoKfQoKY2xhc3MgU3VibWl0Rm9ybWF0IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJzdWJtaXRGb3JtYXQiLCBbImh0bWwiLCAiZGVsZWdhdGUiLCAiZmRmIiwgInhtbCIsICJwZGYiXSk7CiAgfQoKfQoKY2xhc3MgU3VibWl0VXJsIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJzdWJtaXRVcmwiKTsKICB9Cgp9CgpjbGFzcyBTdWJzZXRCZWxvdyBleHRlbmRzIF94ZmFfb2JqZWN0LkludGVnZXJPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInN1YnNldEJlbG93IiwgMTAwLCBuID0+IG4gPj0gMCAmJiBuIDw9IDEwMCk7CiAgfQoKfQoKY2xhc3MgU3VwcHJlc3NCYW5uZXIgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAic3VwcHJlc3NCYW5uZXIiKTsKICB9Cgp9CgpjbGFzcyBUYWdnZWQgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAidGFnZ2VkIik7CiAgfQoKfQoKY2xhc3MgVGVtcGxhdGUgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInRlbXBsYXRlIiwgdHJ1ZSk7CiAgICB0aGlzLmJhc2UgPSBudWxsOwogICAgdGhpcy5yZWxldmFudCA9IG51bGw7CiAgICB0aGlzLnN0YXJ0UGFnZSA9IG51bGw7CiAgICB0aGlzLnVyaSA9IG51bGw7CiAgICB0aGlzLnhzbCA9IG51bGw7CiAgfQoKfQoKY2xhc3MgVGhyZXNob2xkIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ0aHJlc2hvbGQiLCBbInRyYWNlIiwgImVycm9yIiwgImluZm9ybWF0aW9uIiwgIndhcm5pbmciXSk7CiAgfQoKfQoKY2xhc3MgVG8gZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInRvIiwgWyJudWxsIiwgIm1lbW9yeSIsICJzdGRlcnIiLCAic3Rkb3V0IiwgInN5c3RlbSIsICJ1cmkiXSk7CiAgfQoKfQoKY2xhc3MgVGVtcGxhdGVDYWNoZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAidGVtcGxhdGVDYWNoZSIpOwogICAgdGhpcy5tYXhFbnRyaWVzID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMubWF4RW50cmllcywKICAgICAgZGVmYXVsdFZhbHVlOiA1LAogICAgICB2YWxpZGF0ZTogbiA9PiBuID49IDAKICAgIH0pOwogIH0KCn0KCmNsYXNzIFRyYWNlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ0cmFjZSIsIHRydWUpOwogICAgdGhpcy5hcmVhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgVHJhbnNmb3JtIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ0cmFuc2Zvcm0iLCB0cnVlKTsKICAgIHRoaXMuZ3JvdXBQYXJlbnQgPSBudWxsOwogICAgdGhpcy5pZkVtcHR5ID0gbnVsbDsKICAgIHRoaXMubmFtZUF0dHIgPSBudWxsOwogICAgdGhpcy5waWN0dXJlID0gbnVsbDsKICAgIHRoaXMucHJlc2VuY2UgPSBudWxsOwogICAgdGhpcy5yZW5hbWUgPSBudWxsOwogICAgdGhpcy53aGl0ZXNwYWNlID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBUeXBlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ0eXBlIiwgWyJub25lIiwgImFzY2lpODUiLCAiYXNjaWlIZXgiLCAiY2NpdHRmYXgiLCAiZmxhdGUiLCAibHp3IiwgInJ1bkxlbmd0aCIsICJuYXRpdmUiLCAieGRwIiwgIm1lcmdlZFhEUCJdKTsKICB9Cgp9CgpjbGFzcyBVcmkgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInVyaSIpOwogIH0KCn0KCmNsYXNzIFZhbGlkYXRlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ2YWxpZGF0ZSIsIFsicHJlU3VibWl0IiwgInByZVByaW50IiwgInByZUV4ZWN1dGUiLCAicHJlU2F2ZSJdKTsKICB9Cgp9CgpjbGFzcyBWYWxpZGF0ZUFwcHJvdmFsU2lnbmF0dXJlcyBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInZhbGlkYXRlQXBwcm92YWxTaWduYXR1cmVzIik7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpLnNwbGl0KC9ccysvKS5maWx0ZXIoeCA9PiBbImRvY1JlYWR5IiwgInBvc3RTaWduIl0uaW5jbHVkZXMoeCkpOwogIH0KCn0KCmNsYXNzIFZhbGlkYXRpb25NZXNzYWdpbmcgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInZhbGlkYXRpb25NZXNzYWdpbmciLCBbImFsbE1lc3NhZ2VzSW5kaXZpZHVhbGx5IiwgImFsbE1lc3NhZ2VzVG9nZXRoZXIiLCAiZmlyc3RNZXNzYWdlT25seSIsICJub01lc3NhZ2VzIl0pOwogIH0KCn0KCmNsYXNzIFZlcnNpb24gZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInZlcnNpb24iLCBbIjEuNyIsICIxLjYiLCAiMS41IiwgIjEuNCIsICIxLjMiLCAiMS4yIl0pOwogIH0KCn0KCmNsYXNzIFZlcnNpb25Db250cm9sIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJWZXJzaW9uQ29udHJvbCIpOwogICAgdGhpcy5vdXRwdXRCZWxvdyA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm91dHB1dEJlbG93LCBbIndhcm4iLCAiZXJyb3IiLCAidXBkYXRlIl0pOwogICAgdGhpcy5zb3VyY2VBYm92ZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnNvdXJjZUFib3ZlLCBbIndhcm4iLCAiZXJyb3IiXSk7CiAgICB0aGlzLnNvdXJjZUJlbG93ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuc291cmNlQmVsb3csIFsidXBkYXRlIiwgIm1haW50YWluIl0pOwogIH0KCn0KCmNsYXNzIFZpZXdlclByZWZlcmVuY2VzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ2aWV3ZXJQcmVmZXJlbmNlcyIsIHRydWUpOwogICAgdGhpcy5BREJFX0pTQ29uc29sZSA9IG51bGw7CiAgICB0aGlzLkFEQkVfSlNEZWJ1Z2dlciA9IG51bGw7CiAgICB0aGlzLmFkZFZpZXdlclByZWZlcmVuY2VzID0gbnVsbDsKICAgIHRoaXMuZHVwbGV4T3B0aW9uID0gbnVsbDsKICAgIHRoaXMuZW5mb3JjZSA9IG51bGw7CiAgICB0aGlzLm51bWJlck9mQ29waWVzID0gbnVsbDsKICAgIHRoaXMucGFnZVJhbmdlID0gbnVsbDsKICAgIHRoaXMucGlja1RyYXlCeVBERlNpemUgPSBudWxsOwogICAgdGhpcy5wcmludFNjYWxpbmcgPSBudWxsOwogIH0KCn0KCmNsYXNzIFdlYkNsaWVudCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAid2ViQ2xpZW50IiwgdHJ1ZSk7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgPyBhdHRyaWJ1dGVzLm5hbWUudHJpbSgpIDogIiI7CiAgICB0aGlzLmZvbnRJbmZvID0gbnVsbDsKICAgIHRoaXMueGRjID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBXaGl0ZXNwYWNlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ3aGl0ZXNwYWNlIiwgWyJwcmVzZXJ2ZSIsICJsdHJpbSIsICJub3JtYWxpemUiLCAicnRyaW0iLCAidHJpbSJdKTsKICB9Cgp9CgpjbGFzcyBXaW5kb3cgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ3aW5kb3ciKTsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgY29uc3QgcGFpciA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKS5zcGxpdCgvXHMqLFxzKi8sIDIpLm1hcCh4ID0+IHBhcnNlSW50KHgsIDEwKSk7CgogICAgaWYgKHBhaXIuc29tZSh4ID0+IGlzTmFOKHgpKSkgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IFswLCAwXTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChwYWlyLmxlbmd0aCA9PT0gMSkgewogICAgICBwYWlyLnB1c2gocGFpclswXSk7CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSBwYWlyOwogIH0KCn0KCmNsYXNzIFhkYyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAieGRjIiwgdHJ1ZSk7CiAgICB0aGlzLnVyaSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy54c2wgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBYZHAgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInhkcCIsIHRydWUpOwogICAgdGhpcy5wYWNrZXRzID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBYc2wgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInhzbCIsIHRydWUpOwogICAgdGhpcy5kZWJ1ZyA9IG51bGw7CiAgICB0aGlzLnVyaSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgWnBsIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ6cGwiLCB0cnVlKTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSA/IGF0dHJpYnV0ZXMubmFtZS50cmltKCkgOiAiIjsKICAgIHRoaXMuYmF0Y2hPdXRwdXQgPSBudWxsOwogICAgdGhpcy5mbGlwTGFiZWwgPSBudWxsOwogICAgdGhpcy5mb250SW5mbyA9IG51bGw7CiAgICB0aGlzLnhkYyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgQ29uZmlnTmFtZXNwYWNlIHsKICBzdGF0aWMgW19uYW1lc3BhY2VzLiRidWlsZFhGQU9iamVjdF0obmFtZSwgYXR0cmlidXRlcykgewogICAgaWYgKENvbmZpZ05hbWVzcGFjZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICByZXR1cm4gQ29uZmlnTmFtZXNwYWNlW25hbWVdKGF0dHJpYnV0ZXMpOwogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBzdGF0aWMgYWNyb2JhdChhdHRycykgewogICAgcmV0dXJuIG5ldyBBY3JvYmF0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBhY3JvYmF0NyhhdHRycykgewogICAgcmV0dXJuIG5ldyBBY3JvYmF0NyhhdHRycyk7CiAgfQoKICBzdGF0aWMgQURCRV9KU0NvbnNvbGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQURCRV9KU0NvbnNvbGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIEFEQkVfSlNEZWJ1Z2dlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBBREJFX0pTRGVidWdnZXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIGFkZFNpbGVudFByaW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEFkZFNpbGVudFByaW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBhZGRWaWV3ZXJQcmVmZXJlbmNlcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBBZGRWaWV3ZXJQcmVmZXJlbmNlcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgYWRqdXN0RGF0YShhdHRycykgewogICAgcmV0dXJuIG5ldyBBZGp1c3REYXRhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBhZG9iZUV4dGVuc2lvbkxldmVsKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEFkb2JlRXh0ZW5zaW9uTGV2ZWwoYXR0cnMpOwogIH0KCiAgc3RhdGljIGFnZW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEFnZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBhbHdheXNFbWJlZChhdHRycykgewogICAgcmV0dXJuIG5ldyBBbHdheXNFbWJlZChhdHRycyk7CiAgfQoKICBzdGF0aWMgYW1kKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEFtZChhdHRycyk7CiAgfQoKICBzdGF0aWMgYXJlYShhdHRycykgewogICAgcmV0dXJuIG5ldyBBcmVhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBhdHRyaWJ1dGVzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEF0dHJpYnV0ZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGF1dG9TYXZlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEF1dG9TYXZlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBiYXNlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJhc2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGJhdGNoT3V0cHV0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJhdGNoT3V0cHV0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBiZWhhdmlvck92ZXJyaWRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJlaGF2aW9yT3ZlcnJpZGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIGNhY2hlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENhY2hlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjaGFuZ2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ2hhbmdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb21tb24oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29tbW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb21wcmVzcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBDb21wcmVzcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgY29tcHJlc3NMb2dpY2FsU3RydWN0dXJlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENvbXByZXNzTG9naWNhbFN0cnVjdHVyZShhdHRycyk7CiAgfQoKICBzdGF0aWMgY29tcHJlc3NPYmplY3RTdHJlYW0oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29tcHJlc3NPYmplY3RTdHJlYW0oYXR0cnMpOwogIH0KCiAgc3RhdGljIGNvbXByZXNzaW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENvbXByZXNzaW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb25maWcoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29uZmlnKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb25mb3JtYW5jZShhdHRycykgewogICAgcmV0dXJuIG5ldyBDb25mb3JtYW5jZShhdHRycyk7CiAgfQoKICBzdGF0aWMgY29udGVudENvcHkoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29udGVudENvcHkoYXR0cnMpOwogIH0KCiAgc3RhdGljIGNvcGllcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBDb3BpZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGNyZWF0b3IoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ3JlYXRvcihhdHRycyk7CiAgfQoKICBzdGF0aWMgY3VycmVudFBhZ2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ3VycmVudFBhZ2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRhdGEoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGF0YShhdHRycyk7CiAgfQoKICBzdGF0aWMgZGVidWcoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGVidWcoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRlZmF1bHRUeXBlZmFjZShhdHRycykgewogICAgcmV0dXJuIG5ldyBEZWZhdWx0VHlwZWZhY2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRlc3RpbmF0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERlc3RpbmF0aW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkb2N1bWVudEFzc2VtYmx5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERvY3VtZW50QXNzZW1ibHkoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRyaXZlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBEcml2ZXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIGR1cGxleE9wdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBEdXBsZXhPcHRpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIGR5bmFtaWNSZW5kZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRHluYW1pY1JlbmRlcihhdHRycyk7CiAgfQoKICBzdGF0aWMgZW1iZWQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRW1iZWQoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVuY3J5cHQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRW5jcnlwdChhdHRycyk7CiAgfQoKICBzdGF0aWMgZW5jcnlwdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBFbmNyeXB0aW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBlbmNyeXB0aW9uTGV2ZWwoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRW5jcnlwdGlvbkxldmVsKGF0dHJzKTsKICB9CgogIHN0YXRpYyBlbmZvcmNlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVuZm9yY2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVxdWF0ZShhdHRycykgewogICAgcmV0dXJuIG5ldyBFcXVhdGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVxdWF0ZVJhbmdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVxdWF0ZVJhbmdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBleGNsdWRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEV4Y2x1ZGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIGV4Y2x1ZGVOUyhhdHRycykgewogICAgcmV0dXJuIG5ldyBFeGNsdWRlTlMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGZsaXBMYWJlbChhdHRycykgewogICAgcmV0dXJuIG5ldyBGbGlwTGFiZWwoYXR0cnMpOwogIH0KCiAgc3RhdGljIGZvbnRJbmZvKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEZvbnRJbmZvKGF0dHJzKTsKICB9CgogIHN0YXRpYyBmb3JtRmllbGRGaWxsaW5nKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEZvcm1GaWVsZEZpbGxpbmcoYXR0cnMpOwogIH0KCiAgc3RhdGljIGdyb3VwUGFyZW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEdyb3VwUGFyZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBpZkVtcHR5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IElmRW1wdHkoYXR0cnMpOwogIH0KCiAgc3RhdGljIGluY2x1ZGVYRFBDb250ZW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEluY2x1ZGVYRFBDb250ZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBpbmNyZW1lbnRhbExvYWQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgSW5jcmVtZW50YWxMb2FkKGF0dHJzKTsKICB9CgogIHN0YXRpYyBpbmNyZW1lbnRhbE1lcmdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEluY3JlbWVudGFsTWVyZ2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGludGVyYWN0aXZlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEludGVyYWN0aXZlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBqb2coYXR0cnMpIHsKICAgIHJldHVybiBuZXcgSm9nKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsYWJlbFByaW50ZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTGFiZWxQcmludGVyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsYXlvdXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTGF5b3V0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBsZXZlbChhdHRycykgewogICAgcmV0dXJuIG5ldyBMZXZlbChhdHRycyk7CiAgfQoKICBzdGF0aWMgbGluZWFyaXplZChhdHRycykgewogICAgcmV0dXJuIG5ldyBMaW5lYXJpemVkKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsb2NhbGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTG9jYWxlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsb2NhbGVTZXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTG9jYWxlU2V0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBsb2coYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTG9nKGF0dHJzKTsKICB9CgogIHN0YXRpYyBtYXAoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTWFwRWxlbWVudChhdHRycyk7CiAgfQoKICBzdGF0aWMgbWVkaXVtSW5mbyhhdHRycykgewogICAgcmV0dXJuIG5ldyBNZWRpdW1JbmZvKGF0dHJzKTsKICB9CgogIHN0YXRpYyBtZXNzYWdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1lc3NhZ2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIG1lc3NhZ2luZyhhdHRycykgewogICAgcmV0dXJuIG5ldyBNZXNzYWdpbmcoYXR0cnMpOwogIH0KCiAgc3RhdGljIG1vZGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTW9kZShhdHRycyk7CiAgfQoKICBzdGF0aWMgbW9kaWZ5QW5ub3RzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1vZGlmeUFubm90cyhhdHRycyk7CiAgfQoKICBzdGF0aWMgbXNnSWQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTXNnSWQoYXR0cnMpOwogIH0KCiAgc3RhdGljIG5hbWVBdHRyKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE5hbWVBdHRyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBuZXZlckVtYmVkKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE5ldmVyRW1iZWQoYXR0cnMpOwogIH0KCiAgc3RhdGljIG51bWJlck9mQ29waWVzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE51bWJlck9mQ29waWVzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBvcGVuQWN0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE9wZW5BY3Rpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIG91dHB1dChhdHRycykgewogICAgcmV0dXJuIG5ldyBPdXRwdXQoYXR0cnMpOwogIH0KCiAgc3RhdGljIG91dHB1dEJpbihhdHRycykgewogICAgcmV0dXJuIG5ldyBPdXRwdXRCaW4oYXR0cnMpOwogIH0KCiAgc3RhdGljIG91dHB1dFhTTChhdHRycykgewogICAgcmV0dXJuIG5ldyBPdXRwdXRYU0woYXR0cnMpOwogIH0KCiAgc3RhdGljIG92ZXJwcmludChhdHRycykgewogICAgcmV0dXJuIG5ldyBPdmVycHJpbnQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHBhY2tldHMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGFja2V0cyhhdHRycyk7CiAgfQoKICBzdGF0aWMgcGFnZU9mZnNldChhdHRycykgewogICAgcmV0dXJuIG5ldyBQYWdlT2Zmc2V0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBwYWdlUmFuZ2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGFnZVJhbmdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwYWdpbmF0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBhZ2luYXRpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIHBhZ2luYXRpb25PdmVycmlkZShhdHRycykgewogICAgcmV0dXJuIG5ldyBQYWdpbmF0aW9uT3ZlcnJpZGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHBhcnQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGFydChhdHRycyk7CiAgfQoKICBzdGF0aWMgcGNsKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBjbChhdHRycyk7CiAgfQoKICBzdGF0aWMgcGRmKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBkZihhdHRycyk7CiAgfQoKICBzdGF0aWMgcGRmYShhdHRycykgewogICAgcmV0dXJuIG5ldyBQZGZhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwZXJtaXNzaW9ucyhhdHRycykgewogICAgcmV0dXJuIG5ldyBQZXJtaXNzaW9ucyhhdHRycyk7CiAgfQoKICBzdGF0aWMgcGlja1RyYXlCeVBERlNpemUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGlja1RyYXlCeVBERlNpemUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHBpY3R1cmUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGljdHVyZShhdHRycyk7CiAgfQoKICBzdGF0aWMgcGxhaW50ZXh0TWV0YWRhdGEoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGxhaW50ZXh0TWV0YWRhdGEoYXR0cnMpOwogIH0KCiAgc3RhdGljIHByZXNlbmNlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByZXNlbmNlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwcmVzZW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByZXNlbnQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHByaW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByaW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBwcmludEhpZ2hRdWFsaXR5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByaW50SGlnaFF1YWxpdHkoYXR0cnMpOwogIH0KCiAgc3RhdGljIHByaW50U2NhbGluZyhhdHRycykgewogICAgcmV0dXJuIG5ldyBQcmludFNjYWxpbmcoYXR0cnMpOwogIH0KCiAgc3RhdGljIHByaW50ZXJOYW1lKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByaW50ZXJOYW1lKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwcm9kdWNlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBQcm9kdWNlcihhdHRycyk7CiAgfQoKICBzdGF0aWMgcHMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUHMoYXR0cnMpOwogIH0KCiAgc3RhdGljIHJhbmdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFJhbmdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyByZWNvcmQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUmVjb3JkKGF0dHJzKTsKICB9CgogIHN0YXRpYyByZWxldmFudChhdHRycykgewogICAgcmV0dXJuIG5ldyBSZWxldmFudChhdHRycyk7CiAgfQoKICBzdGF0aWMgcmVuYW1lKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFJlbmFtZShhdHRycyk7CiAgfQoKICBzdGF0aWMgcmVuZGVyUG9saWN5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFJlbmRlclBvbGljeShhdHRycyk7CiAgfQoKICBzdGF0aWMgcnVuU2NyaXB0cyhhdHRycykgewogICAgcmV0dXJuIG5ldyBSdW5TY3JpcHRzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzY3JpcHQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU2NyaXB0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzY3JpcHRNb2RlbChhdHRycykgewogICAgcmV0dXJuIG5ldyBTY3JpcHRNb2RlbChhdHRycyk7CiAgfQoKICBzdGF0aWMgc2V2ZXJpdHkoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU2V2ZXJpdHkoYXR0cnMpOwogIH0KCiAgc3RhdGljIHNpbGVudFByaW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFNpbGVudFByaW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdGFwbGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3RhcGxlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdGFydE5vZGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3RhcnROb2RlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdGFydFBhZ2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3RhcnRQYWdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdWJtaXRGb3JtYXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3VibWl0Rm9ybWF0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdWJtaXRVcmwoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3VibWl0VXJsKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdWJzZXRCZWxvdyhhdHRycykgewogICAgcmV0dXJuIG5ldyBTdWJzZXRCZWxvdyhhdHRycyk7CiAgfQoKICBzdGF0aWMgc3VwcHJlc3NCYW5uZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3VwcHJlc3NCYW5uZXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRhZ2dlZChhdHRycykgewogICAgcmV0dXJuIG5ldyBUYWdnZWQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRlbXBsYXRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRlbXBsYXRlKGF0dHJzKTsKICB9CgogIHN0YXRpYyB0ZW1wbGF0ZUNhY2hlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRlbXBsYXRlQ2FjaGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRocmVzaG9sZChhdHRycykgewogICAgcmV0dXJuIG5ldyBUaHJlc2hvbGQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRvKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRvKGF0dHJzKTsKICB9CgogIHN0YXRpYyB0cmFjZShhdHRycykgewogICAgcmV0dXJuIG5ldyBUcmFjZShhdHRycyk7CiAgfQoKICBzdGF0aWMgdHJhbnNmb3JtKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRyYW5zZm9ybShhdHRycyk7CiAgfQoKICBzdGF0aWMgdHlwZShhdHRycykgewogICAgcmV0dXJuIG5ldyBUeXBlKGF0dHJzKTsKICB9CgogIHN0YXRpYyB1cmkoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVXJpKGF0dHJzKTsKICB9CgogIHN0YXRpYyB2YWxpZGF0ZShhdHRycykgewogICAgcmV0dXJuIG5ldyBWYWxpZGF0ZShhdHRycyk7CiAgfQoKICBzdGF0aWMgdmFsaWRhdGVBcHByb3ZhbFNpZ25hdHVyZXMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVmFsaWRhdGVBcHByb3ZhbFNpZ25hdHVyZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIHZhbGlkYXRpb25NZXNzYWdpbmcoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVmFsaWRhdGlvbk1lc3NhZ2luZyhhdHRycyk7CiAgfQoKICBzdGF0aWMgdmVyc2lvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBWZXJzaW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyB2ZXJzaW9uQ29udHJvbChhdHRycykgewogICAgcmV0dXJuIG5ldyBWZXJzaW9uQ29udHJvbChhdHRycyk7CiAgfQoKICBzdGF0aWMgdmlld2VyUHJlZmVyZW5jZXMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVmlld2VyUHJlZmVyZW5jZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIHdlYkNsaWVudChhdHRycykgewogICAgcmV0dXJuIG5ldyBXZWJDbGllbnQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHdoaXRlc3BhY2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgV2hpdGVzcGFjZShhdHRycyk7CiAgfQoKICBzdGF0aWMgd2luZG93KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFdpbmRvdyhhdHRycyk7CiAgfQoKICBzdGF0aWMgeGRjKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFhkYyhhdHRycyk7CiAgfQoKICBzdGF0aWMgeGRwKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFhkcChhdHRycyk7CiAgfQoKICBzdGF0aWMgeHNsKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFhzbChhdHRycyk7CiAgfQoKICBzdGF0aWMgenBsKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFpwbChhdHRycyk7CiAgfQoKfQoKZXhwb3J0cy5Db25maWdOYW1lc3BhY2UgPSBDb25maWdOYW1lc3BhY2U7CgovKioqLyB9KSwKLyogMjE3ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Db25uZWN0aW9uU2V0TmFtZXNwYWNlID0gdm9pZCAwOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDQpOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDIpOwoKY29uc3QgQ09OTkVDVElPTl9TRVRfTlNfSUQgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMuY29ubmVjdGlvblNldC5pZDsKCmNsYXNzIENvbm5lY3Rpb25TZXQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTk5FQ1RJT05fU0VUX05TX0lELCAiY29ubmVjdGlvblNldCIsIHRydWUpOwogICAgdGhpcy53c2RsQ29ubmVjdGlvbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy54bWxDb25uZWN0aW9uID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnhzZENvbm5lY3Rpb24gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBFZmZlY3RpdmVJbnB1dFBvbGljeSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09OTkVDVElPTl9TRVRfTlNfSUQsICJlZmZlY3RpdmVJbnB1dFBvbGljeSIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIEVmZmVjdGl2ZU91dHB1dFBvbGljeSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09OTkVDVElPTl9TRVRfTlNfSUQsICJlZmZlY3RpdmVPdXRwdXRQb2xpY3kiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBPcGVyYXRpb24gZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTk5FQ1RJT05fU0VUX05TX0lELCAib3BlcmF0aW9uIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMuaW5wdXQgPSBhdHRyaWJ1dGVzLmlucHV0IHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5vdXRwdXQgPSBhdHRyaWJ1dGVzLm91dHB1dCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgUm9vdEVsZW1lbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTk5FQ1RJT05fU0VUX05TX0lELCAicm9vdEVsZW1lbnQiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBTb2FwQWN0aW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05ORUNUSU9OX1NFVF9OU19JRCwgInNvYXBBY3Rpb24iKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBTb2FwQWRkcmVzcyBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09OTkVDVElPTl9TRVRfTlNfSUQsICJzb2FwQWRkcmVzcyIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIFVyaSBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09OTkVDVElPTl9TRVRfTlNfSUQsICJ1cmkiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBXc2RsQWRkcmVzcyBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09OTkVDVElPTl9TRVRfTlNfSUQsICJ3c2RsQWRkcmVzcyIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIFdzZGxDb25uZWN0aW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05ORUNUSU9OX1NFVF9OU19JRCwgIndzZGxDb25uZWN0aW9uIiwgdHJ1ZSk7CiAgICB0aGlzLmRhdGFEZXNjcmlwdGlvbiA9IGF0dHJpYnV0ZXMuZGF0YURlc2NyaXB0aW9uIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5lZmZlY3RpdmVJbnB1dFBvbGljeSA9IG51bGw7CiAgICB0aGlzLmVmZmVjdGl2ZU91dHB1dFBvbGljeSA9IG51bGw7CiAgICB0aGlzLm9wZXJhdGlvbiA9IG51bGw7CiAgICB0aGlzLnNvYXBBY3Rpb24gPSBudWxsOwogICAgdGhpcy5zb2FwQWRkcmVzcyA9IG51bGw7CiAgICB0aGlzLndzZGxBZGRyZXNzID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBYbWxDb25uZWN0aW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05ORUNUSU9OX1NFVF9OU19JRCwgInhtbENvbm5lY3Rpb24iLCB0cnVlKTsKICAgIHRoaXMuZGF0YURlc2NyaXB0aW9uID0gYXR0cmlidXRlcy5kYXRhRGVzY3JpcHRpb24gfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVyaSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgWHNkQ29ubmVjdGlvbiBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09OTkVDVElPTl9TRVRfTlNfSUQsICJ4c2RDb25uZWN0aW9uIiwgdHJ1ZSk7CiAgICB0aGlzLmRhdGFEZXNjcmlwdGlvbiA9IGF0dHJpYnV0ZXMuZGF0YURlc2NyaXB0aW9uIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5yb290RWxlbWVudCA9IG51bGw7CiAgICB0aGlzLnVyaSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgQ29ubmVjdGlvblNldE5hbWVzcGFjZSB7CiAgc3RhdGljIFtfbmFtZXNwYWNlcy4kYnVpbGRYRkFPYmplY3RdKG5hbWUsIGF0dHJpYnV0ZXMpIHsKICAgIGlmIChDb25uZWN0aW9uU2V0TmFtZXNwYWNlLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgIHJldHVybiBDb25uZWN0aW9uU2V0TmFtZXNwYWNlW25hbWVdKGF0dHJpYnV0ZXMpOwogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBzdGF0aWMgY29ubmVjdGlvblNldChhdHRycykgewogICAgcmV0dXJuIG5ldyBDb25uZWN0aW9uU2V0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBlZmZlY3RpdmVJbnB1dFBvbGljeShhdHRycykgewogICAgcmV0dXJuIG5ldyBFZmZlY3RpdmVJbnB1dFBvbGljeShhdHRycyk7CiAgfQoKICBzdGF0aWMgZWZmZWN0aXZlT3V0cHV0UG9saWN5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVmZmVjdGl2ZU91dHB1dFBvbGljeShhdHRycyk7CiAgfQoKICBzdGF0aWMgb3BlcmF0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE9wZXJhdGlvbihhdHRycyk7CiAgfQoKICBzdGF0aWMgcm9vdEVsZW1lbnQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUm9vdEVsZW1lbnQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHNvYXBBY3Rpb24oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU29hcEFjdGlvbihhdHRycyk7CiAgfQoKICBzdGF0aWMgc29hcEFkZHJlc3MoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU29hcEFkZHJlc3MoYXR0cnMpOwogIH0KCiAgc3RhdGljIHVyaShhdHRycykgewogICAgcmV0dXJuIG5ldyBVcmkoYXR0cnMpOwogIH0KCiAgc3RhdGljIHdzZGxBZGRyZXNzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFdzZGxBZGRyZXNzKGF0dHJzKTsKICB9CgogIHN0YXRpYyB3c2RsQ29ubmVjdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBXc2RsQ29ubmVjdGlvbihhdHRycyk7CiAgfQoKICBzdGF0aWMgeG1sQ29ubmVjdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBYbWxDb25uZWN0aW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyB4c2RDb25uZWN0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFhzZENvbm5lY3Rpb24oYXR0cnMpOwogIH0KCn0KCmV4cG9ydHMuQ29ubmVjdGlvblNldE5hbWVzcGFjZSA9IENvbm5lY3Rpb25TZXROYW1lc3BhY2U7CgovKioqLyB9KSwKLyogMjE4ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5EYXRhc2V0c05hbWVzcGFjZSA9IHZvaWQgMDsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAyKTsKCnZhciBfbmFtZXNwYWNlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA0KTsKCmNvbnN0IERBVEFTRVRTX05TX0lEID0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLmRhdGFzZXRzLmlkOwoKY2xhc3MgRGF0YSBleHRlbmRzIF94ZmFfb2JqZWN0LlhtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoREFUQVNFVFNfTlNfSUQsICJkYXRhIiwgYXR0cmlidXRlcyk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzTnNBZ25vc3RpY10oKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cgp9CgpjbGFzcyBEYXRhc2V0cyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoREFUQVNFVFNfTlNfSUQsICJkYXRhc2V0cyIsIHRydWUpOwogICAgdGhpcy5kYXRhID0gbnVsbDsKICAgIHRoaXMuU2lnbmF0dXJlID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kb25DaGlsZF0oY2hpbGQpIHsKICAgIGNvbnN0IG5hbWUgPSBjaGlsZFtfeGZhX29iamVjdC4kbm9kZU5hbWVdOwoKICAgIGlmIChuYW1lID09PSAiZGF0YSIgJiYgY2hpbGRbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXSA9PT0gREFUQVNFVFNfTlNfSUQgfHwgbmFtZSA9PT0gIlNpZ25hdHVyZSIgJiYgY2hpbGRbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXSA9PT0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLnNpZ25hdHVyZS5pZCkgewogICAgICB0aGlzW25hbWVdID0gY2hpbGQ7CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKGNoaWxkKTsKICB9Cgp9CgpjbGFzcyBEYXRhc2V0c05hbWVzcGFjZSB7CiAgc3RhdGljIFtfbmFtZXNwYWNlcy4kYnVpbGRYRkFPYmplY3RdKG5hbWUsIGF0dHJpYnV0ZXMpIHsKICAgIGlmIChEYXRhc2V0c05hbWVzcGFjZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICByZXR1cm4gRGF0YXNldHNOYW1lc3BhY2VbbmFtZV0oYXR0cmlidXRlcyk7CiAgICB9CgogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIHN0YXRpYyBkYXRhc2V0cyhhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IERhdGFzZXRzKGF0dHJpYnV0ZXMpOwogIH0KCiAgc3RhdGljIGRhdGEoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBEYXRhKGF0dHJpYnV0ZXMpOwogIH0KCn0KCmV4cG9ydHMuRGF0YXNldHNOYW1lc3BhY2UgPSBEYXRhc2V0c05hbWVzcGFjZTsKCi8qKiovIH0pLAovKiAyMTkgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkxvY2FsZVNldE5hbWVzcGFjZSA9IHZvaWQgMDsKCnZhciBfbmFtZXNwYWNlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA0KTsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAyKTsKCnZhciBfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMyk7Cgpjb25zdCBMT0NBTEVfU0VUX05TX0lEID0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLmxvY2FsZVNldC5pZDsKCmNsYXNzIENhbGVuZGFyU3ltYm9scyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgImNhbGVuZGFyU3ltYm9scyIsIHRydWUpOwogICAgdGhpcy5uYW1lID0gImdyZWdvcmlhbiI7CiAgICB0aGlzLmRheU5hbWVzID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KDIpOwogICAgdGhpcy5lcmFOYW1lcyA9IG51bGw7CiAgICB0aGlzLm1lcmlkaWVtTmFtZXMgPSBudWxsOwogICAgdGhpcy5tb250aE5hbWVzID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KDIpOwogIH0KCn0KCmNsYXNzIEN1cnJlbmN5U3ltYm9sIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAiY3VycmVuY3lTeW1ib2wiKTsKICAgIHRoaXMubmFtZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm5hbWUsIFsic3ltYm9sIiwgImlzb25hbWUiLCAiZGVjaW1hbCJdKTsKICB9Cgp9CgpjbGFzcyBDdXJyZW5jeVN5bWJvbHMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJjdXJyZW5jeVN5bWJvbHMiLCB0cnVlKTsKICAgIHRoaXMuY3VycmVuY3lTeW1ib2wgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoMyk7CiAgfQoKfQoKY2xhc3MgRGF0ZVBhdHRlcm4gZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJkYXRlUGF0dGVybiIpOwogICAgdGhpcy5uYW1lID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMubmFtZSwgWyJmdWxsIiwgImxvbmciLCAibWVkIiwgInNob3J0Il0pOwogIH0KCn0KCmNsYXNzIERhdGVQYXR0ZXJucyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgImRhdGVQYXR0ZXJucyIsIHRydWUpOwogICAgdGhpcy5kYXRlUGF0dGVybiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSg0KTsKICB9Cgp9CgpjbGFzcyBEYXRlVGltZVN5bWJvbHMgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAiZGF0ZVRpbWVTeW1ib2xzIik7CiAgfQoKfQoKY2xhc3MgRGF5IGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAiZGF5Iik7CiAgfQoKfQoKY2xhc3MgRGF5TmFtZXMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJkYXlOYW1lcyIsIHRydWUpOwogICAgdGhpcy5hYmJyID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuYWJiciwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMuZGF5ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KDcpOwogIH0KCn0KCmNsYXNzIEVyYSBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgImVyYSIpOwogIH0KCn0KCmNsYXNzIEVyYU5hbWVzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAiZXJhTmFtZXMiLCB0cnVlKTsKICAgIHRoaXMuZXJhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KDIpOwogIH0KCn0KCmNsYXNzIExvY2FsZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgImxvY2FsZSIsIHRydWUpOwogICAgdGhpcy5kZXNjID0gYXR0cmlidXRlcy5kZXNjIHx8ICIiOwogICAgdGhpcy5uYW1lID0gImlzb25hbWUiOwogICAgdGhpcy5jYWxlbmRhclN5bWJvbHMgPSBudWxsOwogICAgdGhpcy5jdXJyZW5jeVN5bWJvbHMgPSBudWxsOwogICAgdGhpcy5kYXRlUGF0dGVybnMgPSBudWxsOwogICAgdGhpcy5kYXRlVGltZVN5bWJvbHMgPSBudWxsOwogICAgdGhpcy5udW1iZXJQYXR0ZXJucyA9IG51bGw7CiAgICB0aGlzLm51bWJlclN5bWJvbHMgPSBudWxsOwogICAgdGhpcy50aW1lUGF0dGVybnMgPSBudWxsOwogICAgdGhpcy50eXBlRmFjZXMgPSBudWxsOwogIH0KCn0KCmNsYXNzIExvY2FsZVNldCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgImxvY2FsZVNldCIsIHRydWUpOwogICAgdGhpcy5sb2NhbGUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBNZXJpZGllbSBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgIm1lcmlkaWVtIik7CiAgfQoKfQoKY2xhc3MgTWVyaWRpZW1OYW1lcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgIm1lcmlkaWVtTmFtZXMiLCB0cnVlKTsKICAgIHRoaXMubWVyaWRpZW0gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoMik7CiAgfQoKfQoKY2xhc3MgTW9udGggZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJtb250aCIpOwogIH0KCn0KCmNsYXNzIE1vbnRoTmFtZXMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJtb250aE5hbWVzIiwgdHJ1ZSk7CiAgICB0aGlzLmFiYnIgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5hYmJyLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy5tb250aCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgxMik7CiAgfQoKfQoKY2xhc3MgTnVtYmVyUGF0dGVybiBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgIm51bWJlclBhdHRlcm4iKTsKICAgIHRoaXMubmFtZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm5hbWUsIFsiZnVsbCIsICJsb25nIiwgIm1lZCIsICJzaG9ydCJdKTsKICB9Cgp9CgpjbGFzcyBOdW1iZXJQYXR0ZXJucyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgIm51bWJlclBhdHRlcm5zIiwgdHJ1ZSk7CiAgICB0aGlzLm51bWJlclBhdHRlcm4gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoNCk7CiAgfQoKfQoKY2xhc3MgTnVtYmVyU3ltYm9sIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAibnVtYmVyU3ltYm9sIik7CiAgICB0aGlzLm5hbWUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5uYW1lLCBbImRlY2ltYWwiLCAiZ3JvdXBpbmciLCAicGVyY2VudCIsICJtaW51cyIsICJ6ZXJvIl0pOwogIH0KCn0KCmNsYXNzIE51bWJlclN5bWJvbHMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJudW1iZXJTeW1ib2xzIiwgdHJ1ZSk7CiAgICB0aGlzLm51bWJlclN5bWJvbCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSg1KTsKICB9Cgp9CgpjbGFzcyBUaW1lUGF0dGVybiBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgInRpbWVQYXR0ZXJuIik7CiAgICB0aGlzLm5hbWUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5uYW1lLCBbImZ1bGwiLCAibG9uZyIsICJtZWQiLCAic2hvcnQiXSk7CiAgfQoKfQoKY2xhc3MgVGltZVBhdHRlcm5zIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAidGltZVBhdHRlcm5zIiwgdHJ1ZSk7CiAgICB0aGlzLnRpbWVQYXR0ZXJuID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KDQpOwogIH0KCn0KCmNsYXNzIFR5cGVGYWNlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAidHlwZUZhY2UiLCB0cnVlKTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8ICIiOwogIH0KCn0KCmNsYXNzIFR5cGVGYWNlcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgInR5cGVGYWNlcyIsIHRydWUpOwogICAgdGhpcy50eXBlRmFjZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIExvY2FsZVNldE5hbWVzcGFjZSB7CiAgc3RhdGljIFtfbmFtZXNwYWNlcy4kYnVpbGRYRkFPYmplY3RdKG5hbWUsIGF0dHJpYnV0ZXMpIHsKICAgIGlmIChMb2NhbGVTZXROYW1lc3BhY2UuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgcmV0dXJuIExvY2FsZVNldE5hbWVzcGFjZVtuYW1lXShhdHRyaWJ1dGVzKTsKICAgIH0KCiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgc3RhdGljIGNhbGVuZGFyU3ltYm9scyhhdHRycykgewogICAgcmV0dXJuIG5ldyBDYWxlbmRhclN5bWJvbHMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGN1cnJlbmN5U3ltYm9sKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEN1cnJlbmN5U3ltYm9sKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjdXJyZW5jeVN5bWJvbHMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ3VycmVuY3lTeW1ib2xzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkYXRlUGF0dGVybihhdHRycykgewogICAgcmV0dXJuIG5ldyBEYXRlUGF0dGVybihhdHRycyk7CiAgfQoKICBzdGF0aWMgZGF0ZVBhdHRlcm5zKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERhdGVQYXR0ZXJucyhhdHRycyk7CiAgfQoKICBzdGF0aWMgZGF0ZVRpbWVTeW1ib2xzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERhdGVUaW1lU3ltYm9scyhhdHRycyk7CiAgfQoKICBzdGF0aWMgZGF5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERheShhdHRycyk7CiAgfQoKICBzdGF0aWMgZGF5TmFtZXMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGF5TmFtZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVyYShhdHRycykgewogICAgcmV0dXJuIG5ldyBFcmEoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVyYU5hbWVzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVyYU5hbWVzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsb2NhbGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTG9jYWxlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsb2NhbGVTZXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTG9jYWxlU2V0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBtZXJpZGllbShhdHRycykgewogICAgcmV0dXJuIG5ldyBNZXJpZGllbShhdHRycyk7CiAgfQoKICBzdGF0aWMgbWVyaWRpZW1OYW1lcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBNZXJpZGllbU5hbWVzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBtb250aChhdHRycykgewogICAgcmV0dXJuIG5ldyBNb250aChhdHRycyk7CiAgfQoKICBzdGF0aWMgbW9udGhOYW1lcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBNb250aE5hbWVzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBudW1iZXJQYXR0ZXJuKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE51bWJlclBhdHRlcm4oYXR0cnMpOwogIH0KCiAgc3RhdGljIG51bWJlclBhdHRlcm5zKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE51bWJlclBhdHRlcm5zKGF0dHJzKTsKICB9CgogIHN0YXRpYyBudW1iZXJTeW1ib2woYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTnVtYmVyU3ltYm9sKGF0dHJzKTsKICB9CgogIHN0YXRpYyBudW1iZXJTeW1ib2xzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE51bWJlclN5bWJvbHMoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRpbWVQYXR0ZXJuKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRpbWVQYXR0ZXJuKGF0dHJzKTsKICB9CgogIHN0YXRpYyB0aW1lUGF0dGVybnMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVGltZVBhdHRlcm5zKGF0dHJzKTsKICB9CgogIHN0YXRpYyB0eXBlRmFjZShhdHRycykgewogICAgcmV0dXJuIG5ldyBUeXBlRmFjZShhdHRycyk7CiAgfQoKICBzdGF0aWMgdHlwZUZhY2VzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFR5cGVGYWNlcyhhdHRycyk7CiAgfQoKfQoKZXhwb3J0cy5Mb2NhbGVTZXROYW1lc3BhY2UgPSBMb2NhbGVTZXROYW1lc3BhY2U7CgovKioqLyB9KSwKLyogMjIwICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5TaWduYXR1cmVOYW1lc3BhY2UgPSB2b2lkIDA7Cgp2YXIgX25hbWVzcGFjZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNCk7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMik7Cgpjb25zdCBTSUdOQVRVUkVfTlNfSUQgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMuc2lnbmF0dXJlLmlkOwoKY2xhc3MgU2lnbmF0dXJlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihTSUdOQVRVUkVfTlNfSUQsICJzaWduYXR1cmUiLCB0cnVlKTsKICB9Cgp9CgpjbGFzcyBTaWduYXR1cmVOYW1lc3BhY2UgewogIHN0YXRpYyBbX25hbWVzcGFjZXMuJGJ1aWxkWEZBT2JqZWN0XShuYW1lLCBhdHRyaWJ1dGVzKSB7CiAgICBpZiAoU2lnbmF0dXJlTmFtZXNwYWNlLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgIHJldHVybiBTaWduYXR1cmVOYW1lc3BhY2VbbmFtZV0oYXR0cmlidXRlcyk7CiAgICB9CgogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIHN0YXRpYyBzaWduYXR1cmUoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBTaWduYXR1cmUoYXR0cmlidXRlcyk7CiAgfQoKfQoKZXhwb3J0cy5TaWduYXR1cmVOYW1lc3BhY2UgPSBTaWduYXR1cmVOYW1lc3BhY2U7CgovKioqLyB9KSwKLyogMjIxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5TdHlsZXNoZWV0TmFtZXNwYWNlID0gdm9pZCAwOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDQpOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDIpOwoKY29uc3QgU1RZTEVTSEVFVF9OU19JRCA9IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy5zdHlsZXNoZWV0LmlkOwoKY2xhc3MgU3R5bGVzaGVldCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoU1RZTEVTSEVFVF9OU19JRCwgInN0eWxlc2hlZXQiLCB0cnVlKTsKICB9Cgp9CgpjbGFzcyBTdHlsZXNoZWV0TmFtZXNwYWNlIHsKICBzdGF0aWMgW19uYW1lc3BhY2VzLiRidWlsZFhGQU9iamVjdF0obmFtZSwgYXR0cmlidXRlcykgewogICAgaWYgKFN0eWxlc2hlZXROYW1lc3BhY2UuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgcmV0dXJuIFN0eWxlc2hlZXROYW1lc3BhY2VbbmFtZV0oYXR0cmlidXRlcyk7CiAgICB9CgogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIHN0YXRpYyBzdHlsZXNoZWV0KGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBuZXcgU3R5bGVzaGVldChhdHRyaWJ1dGVzKTsKICB9Cgp9CgpleHBvcnRzLlN0eWxlc2hlZXROYW1lc3BhY2UgPSBTdHlsZXNoZWV0TmFtZXNwYWNlOwoKLyoqKi8gfSksCi8qIDIyMiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuWGRwTmFtZXNwYWNlID0gdm9pZCAwOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDQpOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDIpOwoKY29uc3QgWERQX05TX0lEID0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLnhkcC5pZDsKCmNsYXNzIFhkcCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoWERQX05TX0lELCAieGRwIiwgdHJ1ZSk7CiAgICB0aGlzLnV1aWQgPSBhdHRyaWJ1dGVzLnV1aWQgfHwgIiI7CiAgICB0aGlzLnRpbWVTdGFtcCA9IGF0dHJpYnV0ZXMudGltZVN0YW1wIHx8ICIiOwogICAgdGhpcy5jb25maWcgPSBudWxsOwogICAgdGhpcy5jb25uZWN0aW9uU2V0ID0gbnVsbDsKICAgIHRoaXMuZGF0YXNldHMgPSBudWxsOwogICAgdGhpcy5sb2NhbGVTZXQgPSBudWxsOwogICAgdGhpcy5zdHlsZXNoZWV0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRlbXBsYXRlID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kb25DaGlsZENoZWNrXShjaGlsZCkgewogICAgY29uc3QgbnMgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHNbY2hpbGRbX3hmYV9vYmplY3QuJG5vZGVOYW1lXV07CiAgICByZXR1cm4gbnMgJiYgY2hpbGRbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXSA9PT0gbnMuaWQ7CiAgfQoKfQoKY2xhc3MgWGRwTmFtZXNwYWNlIHsKICBzdGF0aWMgW19uYW1lc3BhY2VzLiRidWlsZFhGQU9iamVjdF0obmFtZSwgYXR0cmlidXRlcykgewogICAgaWYgKFhkcE5hbWVzcGFjZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICByZXR1cm4gWGRwTmFtZXNwYWNlW25hbWVdKGF0dHJpYnV0ZXMpOwogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBzdGF0aWMgeGRwKGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBuZXcgWGRwKGF0dHJpYnV0ZXMpOwogIH0KCn0KCmV4cG9ydHMuWGRwTmFtZXNwYWNlID0gWGRwTmFtZXNwYWNlOwoKLyoqKi8gfSksCi8qIDIyMyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuWGh0bWxOYW1lc3BhY2UgPSB2b2lkIDA7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMik7Cgp2YXIgX25hbWVzcGFjZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNCk7Cgp2YXIgX2h0bWxfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwOSk7Cgp2YXIgX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDMpOwoKY29uc3QgWEhUTUxfTlNfSUQgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMueGh0bWwuaWQ7CmNvbnN0ICRyaWNoVGV4dCA9IFN5bWJvbCgpOwpjb25zdCBWQUxJRF9TVFlMRVMgPSBuZXcgU2V0KFsiY29sb3IiLCAiZm9udCIsICJmb250LWZhbWlseSIsICJmb250LXNpemUiLCAiZm9udC1zdHJldGNoIiwgImZvbnQtc3R5bGUiLCAiZm9udC13ZWlnaHQiLCAibWFyZ2luIiwgIm1hcmdpbi1ib3R0b20iLCAibWFyZ2luLWxlZnQiLCAibWFyZ2luLXJpZ2h0IiwgIm1hcmdpbi10b3AiLCAibGV0dGVyLXNwYWNpbmciLCAibGluZS1oZWlnaHQiLCAib3JwaGFucyIsICJwYWdlLWJyZWFrLWFmdGVyIiwgInBhZ2UtYnJlYWstYmVmb3JlIiwgInBhZ2UtYnJlYWstaW5zaWRlIiwgInRhYi1pbnRlcnZhbCIsICJ0YWItc3RvcCIsICJ0ZXh0LWFsaWduIiwgInRleHQtZGVjb3JhdGlvbiIsICJ0ZXh0LWluZGVudCIsICJ2ZXJ0aWNhbC1hbGlnbiIsICJ3aWRvd3MiLCAia2VybmluZy1tb2RlIiwgInhmYS1mb250LWhvcml6b250YWwtc2NhbGUiLCAieGZhLWZvbnQtdmVydGljYWwtc2NhbGUiLCAieGZhLXNwYWNlcnVuIiwgInhmYS10YWItc3RvcHMiXSk7CmNvbnN0IFN0eWxlTWFwcGluZyA9IG5ldyBNYXAoW1sicGFnZS1icmVhay1hZnRlciIsICJicmVha0FmdGVyIl0sIFsicGFnZS1icmVhay1iZWZvcmUiLCAiYnJlYWtCZWZvcmUiXSwgWyJwYWdlLWJyZWFrLWluc2lkZSIsICJicmVha0luc2lkZSJdLCBbImtlcm5pbmctbW9kZSIsIHZhbHVlID0+IHZhbHVlID09PSAibm9uZSIgPyAibm9uZSIgOiAibm9ybWFsIl0sIFsieGZhLWZvbnQtaG9yaXpvbnRhbC1zY2FsZSIsIHZhbHVlID0+IGBzY2FsZVgoJHtNYXRoLm1heCgwLCBNYXRoLm1pbihwYXJzZUludCh2YWx1ZSkgLyAxMDApKS50b0ZpeGVkKDIpfSlgXSwgWyJ4ZmEtZm9udC12ZXJ0aWNhbC1zY2FsZSIsIHZhbHVlID0+IGBzY2FsZVkoJHtNYXRoLm1heCgwLCBNYXRoLm1pbihwYXJzZUludCh2YWx1ZSkgLyAxMDApKS50b0ZpeGVkKDIpfSlgXSwgWyJ4ZmEtc3BhY2VydW4iLCAiIl0sIFsieGZhLXRhYi1zdG9wcyIsICIiXSwgWyJmb250LXNpemUiLCAodmFsdWUsIG9yaWdpbmFsKSA9PiB7CiAgdmFsdWUgPSBvcmlnaW5hbC5mb250U2l6ZSA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKTsKICByZXR1cm4gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykoMC45OSAqIHZhbHVlKTsKfV0sIFsibGV0dGVyLXNwYWNpbmciLCB2YWx1ZSA9PiAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSgoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSkpXSwgWyJsaW5lLWhlaWdodCIsIHZhbHVlID0+ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKCgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKSldLCBbIm1hcmdpbiIsIHZhbHVlID0+ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKCgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKSldLCBbIm1hcmdpbi1ib3R0b20iLCB2YWx1ZSA9PiAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSgoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSkpXSwgWyJtYXJnaW4tbGVmdCIsIHZhbHVlID0+ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKCgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKSldLCBbIm1hcmdpbi1yaWdodCIsIHZhbHVlID0+ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKCgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKSldLCBbIm1hcmdpbi10b3AiLCB2YWx1ZSA9PiAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSgoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSkpXSwgWyJ0ZXh0LWluZGVudCIsIHZhbHVlID0+ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKCgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKSldLCBbImZvbnQtZmFtaWx5IiwgdmFsdWUgPT4gdmFsdWVdLCBbInZlcnRpY2FsLWFsaWduIiwgdmFsdWUgPT4gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykoKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkodmFsdWUpKV1dKTsKY29uc3Qgc3BhY2VzUmVnRXhwID0gL1xzKy9nOwpjb25zdCBjcmxmUmVnRXhwID0gL1tcclxuXSsvZzsKY29uc3QgY3JsZkZvclJpY2hUZXh0UmVnRXhwID0gL1xyXG4/L2c7CgpmdW5jdGlvbiBtYXBTdHlsZShzdHlsZVN0ciwgbm9kZSwgcmljaFRleHQpIHsKICBjb25zdCBzdHlsZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogIGlmICghc3R5bGVTdHIpIHsKICAgIHJldHVybiBzdHlsZTsKICB9CgogIGNvbnN0IG9yaWdpbmFsID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2Ygc3R5bGVTdHIuc3BsaXQoIjsiKS5tYXAocyA9PiBzLnNwbGl0KCI6IiwgMikpKSB7CiAgICBjb25zdCBtYXBwaW5nID0gU3R5bGVNYXBwaW5nLmdldChrZXkpOwoKICAgIGlmIChtYXBwaW5nID09PSAiIikgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBsZXQgbmV3VmFsdWUgPSB2YWx1ZTsKCiAgICBpZiAobWFwcGluZykgewogICAgICBpZiAodHlwZW9mIG1hcHBpbmcgPT09ICJzdHJpbmciKSB7CiAgICAgICAgbmV3VmFsdWUgPSBtYXBwaW5nOwogICAgICB9IGVsc2UgewogICAgICAgIG5ld1ZhbHVlID0gbWFwcGluZyh2YWx1ZSwgb3JpZ2luYWwpOwogICAgICB9CiAgICB9CgogICAgaWYgKGtleS5lbmRzV2l0aCgic2NhbGUiKSkgewogICAgICBpZiAoc3R5bGUudHJhbnNmb3JtKSB7CiAgICAgICAgc3R5bGUudHJhbnNmb3JtID0gYCR7c3R5bGVba2V5XX0gJHtuZXdWYWx1ZX1gOwogICAgICB9IGVsc2UgewogICAgICAgIHN0eWxlLnRyYW5zZm9ybSA9IG5ld1ZhbHVlOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBzdHlsZVtrZXkucmVwbGFjZUFsbCgvLShbYS16QS1aXSkvZywgKF8sIHgpID0+IHgudG9VcHBlckNhc2UoKSldID0gbmV3VmFsdWU7CiAgICB9CiAgfQoKICBpZiAoc3R5bGUuZm9udEZhbWlseSkgewogICAgKDAsIF9odG1sX3V0aWxzLnNldEZvbnRGYW1pbHkpKHsKICAgICAgdHlwZWZhY2U6IHN0eWxlLmZvbnRGYW1pbHksCiAgICAgIHdlaWdodDogc3R5bGUuZm9udFdlaWdodCB8fCAibm9ybWFsIiwKICAgICAgcG9zdHVyZTogc3R5bGUuZm9udFN0eWxlIHx8ICJub3JtYWwiLAogICAgICBzaXplOiBvcmlnaW5hbC5mb250U2l6ZSB8fCAwCiAgICB9LCBub2RlLCBub2RlW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXS5mb250RmluZGVyLCBzdHlsZSk7CiAgfQoKICBpZiAocmljaFRleHQgJiYgc3R5bGUudmVydGljYWxBbGlnbiAmJiBzdHlsZS52ZXJ0aWNhbEFsaWduICE9PSAiMHB4IiAmJiBzdHlsZS5mb250U2l6ZSkgewogICAgY29uc3QgU1VCX1NVUEVSX1NDUklQVF9GQUNUT1IgPSAwLjU4MzsKICAgIGNvbnN0IFZFUlRJQ0FMX0ZBQ1RPUiA9IDAuMzMzOwogICAgY29uc3QgZm9udFNpemUgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShzdHlsZS5mb250U2l6ZSk7CiAgICBzdHlsZS5mb250U2l6ZSA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKGZvbnRTaXplICogU1VCX1NVUEVSX1NDUklQVF9GQUNUT1IpOwogICAgc3R5bGUudmVydGljYWxBbGlnbiA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKE1hdGguc2lnbigoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShzdHlsZS52ZXJ0aWNhbEFsaWduKSkgKiBmb250U2l6ZSAqIFZFUlRJQ0FMX0ZBQ1RPUik7CiAgfQoKICBpZiAocmljaFRleHQgJiYgc3R5bGUuZm9udFNpemUpIHsKICAgIHN0eWxlLmZvbnRTaXplID0gYGNhbGMoJHtzdHlsZS5mb250U2l6ZX0gKiB2YXIoLS1zY2FsZS1mYWN0b3IpKWA7CiAgfQoKICAoMCwgX2h0bWxfdXRpbHMuZml4VGV4dEluZGVudCkoc3R5bGUpOwogIHJldHVybiBzdHlsZTsKfQoKZnVuY3Rpb24gY2hlY2tTdHlsZShub2RlKSB7CiAgaWYgKCFub2RlLnN0eWxlKSB7CiAgICByZXR1cm4gIiI7CiAgfQoKICByZXR1cm4gbm9kZS5zdHlsZS50cmltKCkuc3BsaXQoL1xzKjtccyovKS5maWx0ZXIocyA9PiAhIXMpLm1hcChzID0+IHMuc3BsaXQoL1xzKjpccyovLCAyKSkuZmlsdGVyKF9yZWYgPT4gewogICAgbGV0IFtrZXksIHZhbHVlXSA9IF9yZWY7CgogICAgaWYgKGtleSA9PT0gImZvbnQtZmFtaWx5IikgewogICAgICBub2RlW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXS51c2VkVHlwZWZhY2VzLmFkZCh2YWx1ZSk7CiAgICB9CgogICAgcmV0dXJuIFZBTElEX1NUWUxFUy5oYXMoa2V5KTsKICB9KS5tYXAoa3YgPT4ga3Yuam9pbigiOiIpKS5qb2luKCI7Iik7Cn0KCmNvbnN0IE5vV2hpdGVzID0gbmV3IFNldChbImJvZHkiLCAiaHRtbCJdKTsKCmNsYXNzIFhodG1sT2JqZWN0IGV4dGVuZHMgX3hmYV9vYmplY3QuWG1sT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzLCBuYW1lKSB7CiAgICBzdXBlcihYSFRNTF9OU19JRCwgbmFtZSk7CiAgICB0aGlzWyRyaWNoVGV4dF0gPSBmYWxzZTsKICAgIHRoaXMuc3R5bGUgPSBhdHRyaWJ1dGVzLnN0eWxlIHx8ICIiOwogIH0KCiAgW194ZmFfb2JqZWN0LiRjbGVhbl0oYnVpbGRlcikgewogICAgc3VwZXJbX3hmYV9vYmplY3QuJGNsZWFuXShidWlsZGVyKTsKCiAgICB0aGlzLnN0eWxlID0gY2hlY2tTdHlsZSh0aGlzKTsKICB9CgogIFtfeGZhX29iamVjdC4kYWNjZXB0V2hpdGVzcGFjZV0oKSB7CiAgICByZXR1cm4gIU5vV2hpdGVzLmhhcyh0aGlzW194ZmFfb2JqZWN0LiRub2RlTmFtZV0pOwogIH0KCiAgW194ZmFfb2JqZWN0LiRvblRleHRdKHN0cikgewogICAgbGV0IHJpY2hUZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKCiAgICBpZiAoIXJpY2hUZXh0KSB7CiAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKGNybGZSZWdFeHAsICIiKTsKCiAgICAgIGlmICghdGhpcy5zdHlsZS5pbmNsdWRlcygieGZhLXNwYWNlcnVuOnllcyIpKSB7CiAgICAgICAgc3RyID0gc3RyLnJlcGxhY2Uoc3BhY2VzUmVnRXhwLCAiICIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzWyRyaWNoVGV4dF0gPSB0cnVlOwogICAgfQoKICAgIGlmIChzdHIpIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gKz0gc3RyOwogICAgfQogIH0KCiAgW194ZmFfb2JqZWN0LiRwdXNoR2x5cGhzXShtZWFzdXJlKSB7CiAgICBsZXQgbXVzdFBvcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogdHJ1ZTsKICAgIGNvbnN0IHhmYUZvbnQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgY29uc3QgbWFyZ2luID0gewogICAgICB0b3A6IE5hTiwKICAgICAgYm90dG9tOiBOYU4sCiAgICAgIGxlZnQ6IE5hTiwKICAgICAgcmlnaHQ6IE5hTgogICAgfTsKICAgIGxldCBsaW5lSGVpZ2h0ID0gbnVsbDsKCiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiB0aGlzLnN0eWxlLnNwbGl0KCI7IikubWFwKHMgPT4gcy5zcGxpdCgiOiIsIDIpKSkgewogICAgICBzd2l0Y2ggKGtleSkgewogICAgICAgIGNhc2UgImZvbnQtZmFtaWx5IjoKICAgICAgICAgIHhmYUZvbnQudHlwZWZhY2UgPSAoMCwgX3V0aWxzLnN0cmlwUXVvdGVzKSh2YWx1ZSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZm9udC1zaXplIjoKICAgICAgICAgIHhmYUZvbnQuc2l6ZSA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJmb250LXdlaWdodCI6CiAgICAgICAgICB4ZmFGb250LndlaWdodCA9IHZhbHVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImZvbnQtc3R5bGUiOgogICAgICAgICAgeGZhRm9udC5wb3N0dXJlID0gdmFsdWU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibGV0dGVyLXNwYWNpbmciOgogICAgICAgICAgeGZhRm9udC5sZXR0ZXJTcGFjaW5nID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkodmFsdWUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIm1hcmdpbiI6CiAgICAgICAgICBjb25zdCB2YWx1ZXMgPSB2YWx1ZS5zcGxpdCgvIFx0LykubWFwKHggPT4gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoeCkpOwoKICAgICAgICAgIHN3aXRjaCAodmFsdWVzLmxlbmd0aCkgewogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgbWFyZ2luLnRvcCA9IG1hcmdpbi5ib3R0b20gPSBtYXJnaW4ubGVmdCA9IG1hcmdpbi5yaWdodCA9IHZhbHVlc1swXTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBtYXJnaW4udG9wID0gbWFyZ2luLmJvdHRvbSA9IHZhbHVlc1swXTsKICAgICAgICAgICAgICBtYXJnaW4ubGVmdCA9IG1hcmdpbi5yaWdodCA9IHZhbHVlc1sxXTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBtYXJnaW4udG9wID0gdmFsdWVzWzBdOwogICAgICAgICAgICAgIG1hcmdpbi5ib3R0b20gPSB2YWx1ZXNbMl07CiAgICAgICAgICAgICAgbWFyZ2luLmxlZnQgPSBtYXJnaW4ucmlnaHQgPSB2YWx1ZXNbMV07CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgbWFyZ2luLnRvcCA9IHZhbHVlc1swXTsKICAgICAgICAgICAgICBtYXJnaW4ubGVmdCA9IHZhbHVlc1sxXTsKICAgICAgICAgICAgICBtYXJnaW4uYm90dG9tID0gdmFsdWVzWzJdOwogICAgICAgICAgICAgIG1hcmdpbi5yaWdodCA9IHZhbHVlc1szXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibWFyZ2luLXRvcCI6CiAgICAgICAgICBtYXJnaW4udG9wID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkodmFsdWUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIm1hcmdpbi1ib3R0b20iOgogICAgICAgICAgbWFyZ2luLmJvdHRvbSA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJtYXJnaW4tbGVmdCI6CiAgICAgICAgICBtYXJnaW4ubGVmdCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJtYXJnaW4tcmlnaHQiOgogICAgICAgICAgbWFyZ2luLnJpZ2h0ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkodmFsdWUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImxpbmUtaGVpZ2h0IjoKICAgICAgICAgIGxpbmVIZWlnaHQgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSk7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIG1lYXN1cmUucHVzaERhdGEoeGZhRm9udCwgbWFyZ2luLCBsaW5lSGVpZ2h0KTsKCiAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0pIHsKICAgICAgbWVhc3VyZS5hZGRTdHJpbmcodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0pOwogICAgfSBlbHNlIHsKICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzW194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbl0oKSkgewogICAgICAgIGlmIChjaGlsZFtfeGZhX29iamVjdC4kbm9kZU5hbWVdID09PSAiI3RleHQiKSB7CiAgICAgICAgICBtZWFzdXJlLmFkZFN0cmluZyhjaGlsZFtfeGZhX29iamVjdC4kY29udGVudF0pOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjaGlsZFtfeGZhX29iamVjdC4kcHVzaEdseXBoc10obWVhc3VyZSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAobXVzdFBvcCkgewogICAgICBtZWFzdXJlLnBvcEZvbnQoKTsKICAgIH0KICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgY29uc3QgY2hpbGRyZW4gPSBbXTsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9IHsKICAgICAgY2hpbGRyZW4KICAgIH07CgogICAgdGhpc1tfeGZhX29iamVjdC4kY2hpbGRyZW5Ub0hUTUxdKHt9KTsKCiAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID09PSAwICYmICF0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgICB9CgogICAgbGV0IHZhbHVlOwoKICAgIGlmICh0aGlzWyRyaWNoVGV4dF0pIHsKICAgICAgdmFsdWUgPSB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA/IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnJlcGxhY2UoY3JsZkZvclJpY2hUZXh0UmVnRXhwLCAiXG4iKSA6IHVuZGVmaW5lZDsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlID0gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gfHwgdW5kZWZpbmVkOwogICAgfQoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgbmFtZTogdGhpc1tfeGZhX29iamVjdC4kbm9kZU5hbWVdLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgaHJlZjogdGhpcy5ocmVmLAogICAgICAgIHN0eWxlOiBtYXBTdHlsZSh0aGlzLnN0eWxlLCB0aGlzLCB0aGlzWyRyaWNoVGV4dF0pCiAgICAgIH0sCiAgICAgIGNoaWxkcmVuLAogICAgICB2YWx1ZQogICAgfSk7CiAgfQoKfQoKY2xhc3MgQSBleHRlbmRzIFhodG1sT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihhdHRyaWJ1dGVzLCAiYSIpOwogICAgdGhpcy5ocmVmID0gKDAsIF9odG1sX3V0aWxzLmZpeFVSTCkoYXR0cmlidXRlcy5ocmVmKSB8fCAiIjsKICB9Cgp9CgpjbGFzcyBCIGV4dGVuZHMgWGh0bWxPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKGF0dHJpYnV0ZXMsICJiIik7CiAgfQoKICBbX3hmYV9vYmplY3QuJHB1c2hHbHlwaHNdKG1lYXN1cmUpIHsKICAgIG1lYXN1cmUucHVzaEZvbnQoewogICAgICB3ZWlnaHQ6ICJib2xkIgogICAgfSk7CgogICAgc3VwZXJbX3hmYV9vYmplY3QuJHB1c2hHbHlwaHNdKG1lYXN1cmUpOwoKICAgIG1lYXN1cmUucG9wRm9udCgpOwogIH0KCn0KCmNsYXNzIEJvZHkgZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgImJvZHkiKTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgY29uc3QgcmVzID0gc3VwZXJbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpOwoKICAgIGNvbnN0IHsKICAgICAgaHRtbAogICAgfSA9IHJlczsKCiAgICBpZiAoIWh0bWwpIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgfQoKICAgIGh0bWwubmFtZSA9ICJkaXYiOwogICAgaHRtbC5hdHRyaWJ1dGVzLmNsYXNzID0gWyJ4ZmFSaWNoIl07CiAgICByZXR1cm4gcmVzOwogIH0KCn0KCmNsYXNzIEJyIGV4dGVuZHMgWGh0bWxPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKGF0dHJpYnV0ZXMsICJiciIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0ZXh0XSgpIHsKICAgIHJldHVybiAiXG4iOwogIH0KCiAgW194ZmFfb2JqZWN0LiRwdXNoR2x5cGhzXShtZWFzdXJlKSB7CiAgICBtZWFzdXJlLmFkZFN0cmluZygiXG4iKTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICBuYW1lOiAiYnIiCiAgICB9KTsKICB9Cgp9CgpjbGFzcyBIdG1sIGV4dGVuZHMgWGh0bWxPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKGF0dHJpYnV0ZXMsICJodG1sIik7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGNvbnN0IGNoaWxkcmVuID0gW107CiAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSB7CiAgICAgIGNoaWxkcmVuCiAgICB9OwoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNoaWxkcmVuVG9IVE1MXSh7fSk7CgogICAgaWYgKGNoaWxkcmVuLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgICAgbmFtZTogImRpdiIsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgY2xhc3M6IFsieGZhUmljaCJdLAogICAgICAgICAgc3R5bGU6IHt9CiAgICAgICAgfSwKICAgICAgICB2YWx1ZTogdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gfHwgIiIKICAgICAgfSk7CiAgICB9CgogICAgaWYgKGNoaWxkcmVuLmxlbmd0aCA9PT0gMSkgewogICAgICBjb25zdCBjaGlsZCA9IGNoaWxkcmVuWzBdOwoKICAgICAgaWYgKGNoaWxkLmF0dHJpYnV0ZXMgJiYgY2hpbGQuYXR0cmlidXRlcy5jbGFzcy5pbmNsdWRlcygieGZhUmljaCIpKSB7CiAgICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoY2hpbGQpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICBuYW1lOiAiZGl2IiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIGNsYXNzOiBbInhmYVJpY2giXSwKICAgICAgICBzdHlsZToge30KICAgICAgfSwKICAgICAgY2hpbGRyZW4KICAgIH0pOwogIH0KCn0KCmNsYXNzIEkgZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgImkiKTsKICB9CgogIFtfeGZhX29iamVjdC4kcHVzaEdseXBoc10obWVhc3VyZSkgewogICAgbWVhc3VyZS5wdXNoRm9udCh7CiAgICAgIHBvc3R1cmU6ICJpdGFsaWMiCiAgICB9KTsKCiAgICBzdXBlcltfeGZhX29iamVjdC4kcHVzaEdseXBoc10obWVhc3VyZSk7CgogICAgbWVhc3VyZS5wb3BGb250KCk7CiAgfQoKfQoKY2xhc3MgTGkgZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgImxpIik7CiAgfQoKfQoKY2xhc3MgT2wgZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgIm9sIik7CiAgfQoKfQoKY2xhc3MgUCBleHRlbmRzIFhodG1sT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihhdHRyaWJ1dGVzLCAicCIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRwdXNoR2x5cGhzXShtZWFzdXJlKSB7CiAgICBzdXBlcltfeGZhX29iamVjdC4kcHVzaEdseXBoc10obWVhc3VyZSwgZmFsc2UpOwoKICAgIG1lYXN1cmUuYWRkU3RyaW5nKCJcbiIpOwogICAgbWVhc3VyZS5hZGRQYXJhKCk7CiAgICBtZWFzdXJlLnBvcEZvbnQoKTsKICB9CgogIFtfeGZhX29iamVjdC4kdGV4dF0oKSB7CiAgICBjb25zdCBzaWJsaW5ncyA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKVtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5dKCk7CgogICAgaWYgKHNpYmxpbmdzLmF0KC0xKSA9PT0gdGhpcykgewogICAgICByZXR1cm4gc3VwZXJbX3hmYV9vYmplY3QuJHRleHRdKCk7CiAgICB9CgogICAgcmV0dXJuIHN1cGVyW194ZmFfb2JqZWN0LiR0ZXh0XSgpICsgIlxuIjsKICB9Cgp9CgpjbGFzcyBTcGFuIGV4dGVuZHMgWGh0bWxPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKGF0dHJpYnV0ZXMsICJzcGFuIik7CiAgfQoKfQoKY2xhc3MgU3ViIGV4dGVuZHMgWGh0bWxPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKGF0dHJpYnV0ZXMsICJzdWIiKTsKICB9Cgp9CgpjbGFzcyBTdXAgZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgInN1cCIpOwogIH0KCn0KCmNsYXNzIFVsIGV4dGVuZHMgWGh0bWxPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKGF0dHJpYnV0ZXMsICJ1bCIpOwogIH0KCn0KCmNsYXNzIFhodG1sTmFtZXNwYWNlIHsKICBzdGF0aWMgW19uYW1lc3BhY2VzLiRidWlsZFhGQU9iamVjdF0obmFtZSwgYXR0cmlidXRlcykgewogICAgaWYgKFhodG1sTmFtZXNwYWNlLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgIHJldHVybiBYaHRtbE5hbWVzcGFjZVtuYW1lXShhdHRyaWJ1dGVzKTsKICAgIH0KCiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgc3RhdGljIGEoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBBKGF0dHJpYnV0ZXMpOwogIH0KCiAgc3RhdGljIGIoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBCKGF0dHJpYnV0ZXMpOwogIH0KCiAgc3RhdGljIGJvZHkoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBCb2R5KGF0dHJpYnV0ZXMpOwogIH0KCiAgc3RhdGljIGJyKGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBuZXcgQnIoYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgaHRtbChhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IEh0bWwoYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgaShhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IEkoYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgbGkoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBMaShhdHRyaWJ1dGVzKTsKICB9CgogIHN0YXRpYyBvbChhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IE9sKGF0dHJpYnV0ZXMpOwogIH0KCiAgc3RhdGljIHAoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBQKGF0dHJpYnV0ZXMpOwogIH0KCiAgc3RhdGljIHNwYW4oYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBTcGFuKGF0dHJpYnV0ZXMpOwogIH0KCiAgc3RhdGljIHN1YihhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IFN1YihhdHRyaWJ1dGVzKTsKICB9CgogIHN0YXRpYyBzdXAoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBTdXAoYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgdWwoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBVbChhdHRyaWJ1dGVzKTsKICB9Cgp9CgpleHBvcnRzLlhodG1sTmFtZXNwYWNlID0gWGh0bWxOYW1lc3BhY2U7CgovKioqLyB9KSwKLyogMjI0ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Vbmtub3duTmFtZXNwYWNlID0gdm9pZCAwOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDQpOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDIpOwoKY2xhc3MgVW5rbm93bk5hbWVzcGFjZSB7CiAgY29uc3RydWN0b3IobnNJZCkgewogICAgdGhpcy5uYW1lc3BhY2VJZCA9IG5zSWQ7CiAgfQoKICBbX25hbWVzcGFjZXMuJGJ1aWxkWEZBT2JqZWN0XShuYW1lLCBhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IF94ZmFfb2JqZWN0LlhtbE9iamVjdCh0aGlzLm5hbWVzcGFjZUlkLCBuYW1lLCBhdHRyaWJ1dGVzKTsKICB9Cgp9CgpleHBvcnRzLlVua25vd25OYW1lc3BhY2UgPSBVbmtub3duTmFtZXNwYWNlOwoKLyoqKi8gfSksCi8qIDIyNSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuRGF0YXNldFJlYWRlciA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMSk7Cgp2YXIgX3htbF9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5MSk7CgpmdW5jdGlvbiBkZWNvZGVTdHJpbmcoc3RyKSB7CiAgdHJ5IHsKICAgIHJldHVybiAoMCwgX3V0aWwuc3RyaW5nVG9VVEY4U3RyaW5nKShzdHIpOwogIH0gY2F0Y2ggKGV4KSB7CiAgICAoMCwgX3V0aWwud2FybikoYFVURi04IGRlY29kaW5nIGZhaWxlZDogIiR7ZXh9Ii5gKTsKICAgIHJldHVybiBzdHI7CiAgfQp9CgpjbGFzcyBEYXRhc2V0WE1MUGFyc2VyIGV4dGVuZHMgX3htbF9wYXJzZXIuU2ltcGxlWE1MUGFyc2VyIHsKICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICBzdXBlcihvcHRpb25zKTsKICAgIHRoaXMubm9kZSA9IG51bGw7CiAgfQoKICBvbkVuZEVsZW1lbnQobmFtZSkgewogICAgY29uc3Qgbm9kZSA9IHN1cGVyLm9uRW5kRWxlbWVudChuYW1lKTsKCiAgICBpZiAobm9kZSAmJiBuYW1lID09PSAieGZhOmRhdGFzZXRzIikgewogICAgICB0aGlzLm5vZGUgPSBub2RlOwogICAgICB0aHJvdyBuZXcgRXJyb3IoIkFib3J0aW5nIERhdGFzZXRYTUxQYXJzZXIuIik7CiAgICB9CiAgfQoKfQoKY2xhc3MgRGF0YXNldFJlYWRlciB7CiAgY29uc3RydWN0b3IoZGF0YSkgewogICAgaWYgKGRhdGEuZGF0YXNldHMpIHsKICAgICAgdGhpcy5ub2RlID0gbmV3IF94bWxfcGFyc2VyLlNpbXBsZVhNTFBhcnNlcih7CiAgICAgICAgaGFzQXR0cmlidXRlczogdHJ1ZQogICAgICB9KS5wYXJzZUZyb21TdHJpbmcoZGF0YS5kYXRhc2V0cykuZG9jdW1lbnRFbGVtZW50OwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgcGFyc2VyID0gbmV3IERhdGFzZXRYTUxQYXJzZXIoewogICAgICAgIGhhc0F0dHJpYnV0ZXM6IHRydWUKICAgICAgfSk7CgogICAgICB0cnkgewogICAgICAgIHBhcnNlci5wYXJzZUZyb21TdHJpbmcoZGF0YVsieGRwOnhkcCJdKTsKICAgICAgfSBjYXRjaCAoXykge30KCiAgICAgIHRoaXMubm9kZSA9IHBhcnNlci5ub2RlOwogICAgfQogIH0KCiAgZ2V0VmFsdWUocGF0aCkgewogICAgaWYgKCF0aGlzLm5vZGUgfHwgIXBhdGgpIHsKICAgICAgcmV0dXJuICIiOwogICAgfQoKICAgIGNvbnN0IG5vZGUgPSB0aGlzLm5vZGUuc2VhcmNoTm9kZSgoMCwgX2NvcmVfdXRpbHMucGFyc2VYRkFQYXRoKShwYXRoKSwgMCk7CgogICAgaWYgKCFub2RlKSB7CiAgICAgIHJldHVybiAiIjsKICAgIH0KCiAgICBjb25zdCBmaXJzdCA9IG5vZGUuZmlyc3RDaGlsZDsKCiAgICBpZiAoZmlyc3QgJiYgZmlyc3Qubm9kZU5hbWUgPT09ICJ2YWx1ZSIpIHsKICAgICAgcmV0dXJuIG5vZGUuY2hpbGRyZW4ubWFwKGNoaWxkID0+IGRlY29kZVN0cmluZyhjaGlsZC50ZXh0Q29udGVudCkpOwogICAgfQoKICAgIHJldHVybiBkZWNvZGVTdHJpbmcobm9kZS50ZXh0Q29udGVudCk7CiAgfQoKfQoKZXhwb3J0cy5EYXRhc2V0UmVhZGVyID0gRGF0YXNldFJlYWRlcjsKCi8qKiovIH0pLAovKiAyMjYgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlhSZWYgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwoKdmFyIF9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0Mik7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzIpOwoKdmFyIF9jcnlwdG8gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5Mik7CgpjbGFzcyBYUmVmIHsKICBjb25zdHJ1Y3RvcihzdHJlYW0sIHBkZk1hbmFnZXIpIHsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5wZGZNYW5hZ2VyID0gcGRmTWFuYWdlcjsKICAgIHRoaXMuZW50cmllcyA9IFtdOwogICAgdGhpcy54cmVmc3RtcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB0aGlzLl9jYWNoZU1hcCA9IG5ldyBNYXAoKTsKICAgIHRoaXMuX3BlbmRpbmdSZWZzID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogICAgdGhpcy5zdGF0cyA9IG5ldyBfY29yZV91dGlscy5Eb2NTdGF0cyhwZGZNYW5hZ2VyLm1zZ0hhbmRsZXIpOwogICAgdGhpcy5fbmV3UmVmTnVtID0gbnVsbDsKICB9CgogIGdldE5ld1JlZigpIHsKICAgIGlmICh0aGlzLl9uZXdSZWZOdW0gPT09IG51bGwpIHsKICAgICAgdGhpcy5fbmV3UmVmTnVtID0gdGhpcy5lbnRyaWVzLmxlbmd0aCB8fCAxOwogICAgfQoKICAgIHJldHVybiBfcHJpbWl0aXZlcy5SZWYuZ2V0KHRoaXMuX25ld1JlZk51bSsrLCAwKTsKICB9CgogIHJlc2V0TmV3UmVmKCkgewogICAgdGhpcy5fbmV3UmVmTnVtID0gbnVsbDsKICB9CgogIHNldFN0YXJ0WFJlZihzdGFydFhSZWYpIHsKICAgIHRoaXMuc3RhcnRYUmVmUXVldWUgPSBbc3RhcnRYUmVmXTsKICB9CgogIHBhcnNlKCkgewogICAgbGV0IHJlY292ZXJ5TW9kZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CiAgICBsZXQgdHJhaWxlckRpY3Q7CgogICAgaWYgKCFyZWNvdmVyeU1vZGUpIHsKICAgICAgdHJhaWxlckRpY3QgPSB0aGlzLnJlYWRYUmVmKCk7CiAgICB9IGVsc2UgewogICAgICAoMCwgX3V0aWwud2FybikoIkluZGV4aW5nIGFsbCBQREYgb2JqZWN0cyIpOwogICAgICB0cmFpbGVyRGljdCA9IHRoaXMuaW5kZXhPYmplY3RzKCk7CiAgICB9CgogICAgdHJhaWxlckRpY3QuYXNzaWduWHJlZih0aGlzKTsKICAgIHRoaXMudHJhaWxlciA9IHRyYWlsZXJEaWN0OwogICAgbGV0IGVuY3J5cHQ7CgogICAgdHJ5IHsKICAgICAgZW5jcnlwdCA9IHRyYWlsZXJEaWN0LmdldCgiRW5jcnlwdCIpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGBYUmVmLnBhcnNlIC0gSW52YWxpZCAiRW5jcnlwdCIgcmVmZXJlbmNlOiAiJHtleH0iLmApOwogICAgfQoKICAgIGlmIChlbmNyeXB0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBjb25zdCBpZHMgPSB0cmFpbGVyRGljdC5nZXQoIklEIik7CiAgICAgIGNvbnN0IGZpbGVJZCA9IGlkcyAmJiBpZHMubGVuZ3RoID8gaWRzWzBdIDogIiI7CiAgICAgIGVuY3J5cHQuc3VwcHJlc3NFbmNyeXB0aW9uID0gdHJ1ZTsKICAgICAgdGhpcy5lbmNyeXB0ID0gbmV3IF9jcnlwdG8uQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeShlbmNyeXB0LCBmaWxlSWQsIHRoaXMucGRmTWFuYWdlci5wYXNzd29yZCk7CiAgICB9CgogICAgbGV0IHJvb3Q7CgogICAgdHJ5IHsKICAgICAgcm9vdCA9IHRyYWlsZXJEaWN0LmdldCgiUm9vdCIpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGBYUmVmLnBhcnNlIC0gSW52YWxpZCAiUm9vdCIgcmVmZXJlbmNlOiAiJHtleH0iLmApOwogICAgfQoKICAgIGlmIChyb290IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHBhZ2VzID0gcm9vdC5nZXQoIlBhZ2VzIik7CgogICAgICAgIGlmIChwYWdlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICAgIHRoaXMucm9vdCA9IHJvb3Q7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IGNhdGNoIChleCkgewogICAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgICB0aHJvdyBleDsKICAgICAgICB9CgogICAgICAgICgwLCBfdXRpbC53YXJuKShgWFJlZi5wYXJzZSAtIEludmFsaWQgIlBhZ2VzIiByZWZlcmVuY2U6ICIke2V4fSIuYCk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXJlY292ZXJ5TW9kZSkgewogICAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuWFJlZlBhcnNlRXhjZXB0aW9uKCk7CiAgICB9CgogICAgdGhyb3cgbmV3IF91dGlsLkludmFsaWRQREZFeGNlcHRpb24oIkludmFsaWQgUm9vdCByZWZlcmVuY2UuIik7CiAgfQoKICBwcm9jZXNzWFJlZlRhYmxlKHBhcnNlcikgewogICAgaWYgKCEoInRhYmxlU3RhdGUiIGluIHRoaXMpKSB7CiAgICAgIHRoaXMudGFibGVTdGF0ZSA9IHsKICAgICAgICBlbnRyeU51bTogMCwKICAgICAgICBzdHJlYW1Qb3M6IHBhcnNlci5sZXhlci5zdHJlYW0ucG9zLAogICAgICAgIHBhcnNlckJ1ZjE6IHBhcnNlci5idWYxLAogICAgICAgIHBhcnNlckJ1ZjI6IHBhcnNlci5idWYyCiAgICAgIH07CiAgICB9CgogICAgY29uc3Qgb2JqID0gdGhpcy5yZWFkWFJlZlRhYmxlKHBhcnNlcik7CgogICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iaiwgInRyYWlsZXIiKSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiB0YWJsZTogY291bGQgbm90IGZpbmQgdHJhaWxlciBkaWN0aW9uYXJ5Iik7CiAgICB9CgogICAgbGV0IGRpY3QgPSBwYXJzZXIuZ2V0T2JqKCk7CgogICAgaWYgKCEoZGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpICYmIGRpY3QuZGljdCkgewogICAgICBkaWN0ID0gZGljdC5kaWN0OwogICAgfQoKICAgIGlmICghKGRpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiB0YWJsZTogY291bGQgbm90IHBhcnNlIHRyYWlsZXIgZGljdGlvbmFyeSIpOwogICAgfQoKICAgIGRlbGV0ZSB0aGlzLnRhYmxlU3RhdGU7CiAgICByZXR1cm4gZGljdDsKICB9CgogIHJlYWRYUmVmVGFibGUocGFyc2VyKSB7CiAgICBjb25zdCBzdHJlYW0gPSBwYXJzZXIubGV4ZXIuc3RyZWFtOwogICAgY29uc3QgdGFibGVTdGF0ZSA9IHRoaXMudGFibGVTdGF0ZTsKICAgIHN0cmVhbS5wb3MgPSB0YWJsZVN0YXRlLnN0cmVhbVBvczsKICAgIHBhcnNlci5idWYxID0gdGFibGVTdGF0ZS5wYXJzZXJCdWYxOwogICAgcGFyc2VyLmJ1ZjIgPSB0YWJsZVN0YXRlLnBhcnNlckJ1ZjI7CiAgICBsZXQgb2JqOwoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGlmICghKCJmaXJzdEVudHJ5TnVtIiBpbiB0YWJsZVN0YXRlKSB8fCAhKCJlbnRyeUNvdW50IiBpbiB0YWJsZVN0YXRlKSkgewogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iaiA9IHBhcnNlci5nZXRPYmooKSwgInRyYWlsZXIiKSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICB0YWJsZVN0YXRlLmZpcnN0RW50cnlOdW0gPSBvYmo7CiAgICAgICAgdGFibGVTdGF0ZS5lbnRyeUNvdW50ID0gcGFyc2VyLmdldE9iaigpOwogICAgICB9CgogICAgICBsZXQgZmlyc3QgPSB0YWJsZVN0YXRlLmZpcnN0RW50cnlOdW07CiAgICAgIGNvbnN0IGNvdW50ID0gdGFibGVTdGF0ZS5lbnRyeUNvdW50OwoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGZpcnN0KSB8fCAhTnVtYmVyLmlzSW50ZWdlcihjb3VudCkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiB0YWJsZTogd3JvbmcgdHlwZXMgaW4gc3Vic2VjdGlvbiBoZWFkZXIiKTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IHRhYmxlU3RhdGUuZW50cnlOdW07IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgdGFibGVTdGF0ZS5zdHJlYW1Qb3MgPSBzdHJlYW0ucG9zOwogICAgICAgIHRhYmxlU3RhdGUuZW50cnlOdW0gPSBpOwogICAgICAgIHRhYmxlU3RhdGUucGFyc2VyQnVmMSA9IHBhcnNlci5idWYxOwogICAgICAgIHRhYmxlU3RhdGUucGFyc2VyQnVmMiA9IHBhcnNlci5idWYyOwogICAgICAgIGNvbnN0IGVudHJ5ID0ge307CiAgICAgICAgZW50cnkub2Zmc2V0ID0gcGFyc2VyLmdldE9iaigpOwogICAgICAgIGVudHJ5LmdlbiA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgICBjb25zdCB0eXBlID0gcGFyc2VyLmdldE9iaigpOwoKICAgICAgICBpZiAodHlwZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkNtZCkgewogICAgICAgICAgc3dpdGNoICh0eXBlLmNtZCkgewogICAgICAgICAgICBjYXNlICJmIjoKICAgICAgICAgICAgICBlbnRyeS5mcmVlID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgIm4iOgogICAgICAgICAgICAgIGVudHJ5LnVuY29tcHJlc3NlZCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoZW50cnkub2Zmc2V0KSB8fCAhTnVtYmVyLmlzSW50ZWdlcihlbnRyeS5nZW4pIHx8ICEoZW50cnkuZnJlZSB8fCBlbnRyeS51bmNvbXByZXNzZWQpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgZW50cnkgaW4gWFJlZiBzdWJzZWN0aW9uOiAke2ZpcnN0fSwgJHtjb3VudH1gKTsKICAgICAgICB9CgogICAgICAgIGlmIChpID09PSAwICYmIGVudHJ5LmZyZWUgJiYgZmlyc3QgPT09IDEpIHsKICAgICAgICAgIGZpcnN0ID0gMDsKICAgICAgICB9CgogICAgICAgIGlmICghdGhpcy5lbnRyaWVzW2kgKyBmaXJzdF0pIHsKICAgICAgICAgIHRoaXMuZW50cmllc1tpICsgZmlyc3RdID0gZW50cnk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0YWJsZVN0YXRlLmVudHJ5TnVtID0gMDsKICAgICAgdGFibGVTdGF0ZS5zdHJlYW1Qb3MgPSBzdHJlYW0ucG9zOwogICAgICB0YWJsZVN0YXRlLnBhcnNlckJ1ZjEgPSBwYXJzZXIuYnVmMTsKICAgICAgdGFibGVTdGF0ZS5wYXJzZXJCdWYyID0gcGFyc2VyLmJ1ZjI7CiAgICAgIGRlbGV0ZSB0YWJsZVN0YXRlLmZpcnN0RW50cnlOdW07CiAgICAgIGRlbGV0ZSB0YWJsZVN0YXRlLmVudHJ5Q291bnQ7CiAgICB9CgogICAgaWYgKHRoaXMuZW50cmllc1swXSAmJiAhdGhpcy5lbnRyaWVzWzBdLmZyZWUpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIFhSZWYgdGFibGU6IHVuZXhwZWN0ZWQgZmlyc3Qgb2JqZWN0Iik7CiAgICB9CgogICAgcmV0dXJuIG9iajsKICB9CgogIHByb2Nlc3NYUmVmU3RyZWFtKHN0cmVhbSkgewogICAgaWYgKCEoInN0cmVhbVN0YXRlIiBpbiB0aGlzKSkgewogICAgICBjb25zdCBzdHJlYW1QYXJhbWV0ZXJzID0gc3RyZWFtLmRpY3Q7CiAgICAgIGNvbnN0IGJ5dGVXaWR0aHMgPSBzdHJlYW1QYXJhbWV0ZXJzLmdldCgiVyIpOwogICAgICBsZXQgcmFuZ2UgPSBzdHJlYW1QYXJhbWV0ZXJzLmdldCgiSW5kZXgiKTsKCiAgICAgIGlmICghcmFuZ2UpIHsKICAgICAgICByYW5nZSA9IFswLCBzdHJlYW1QYXJhbWV0ZXJzLmdldCgiU2l6ZSIpXTsKICAgICAgfQoKICAgICAgdGhpcy5zdHJlYW1TdGF0ZSA9IHsKICAgICAgICBlbnRyeVJhbmdlczogcmFuZ2UsCiAgICAgICAgYnl0ZVdpZHRocywKICAgICAgICBlbnRyeU51bTogMCwKICAgICAgICBzdHJlYW1Qb3M6IHN0cmVhbS5wb3MKICAgICAgfTsKICAgIH0KCiAgICB0aGlzLnJlYWRYUmVmU3RyZWFtKHN0cmVhbSk7CiAgICBkZWxldGUgdGhpcy5zdHJlYW1TdGF0ZTsKICAgIHJldHVybiBzdHJlYW0uZGljdDsKICB9CgogIHJlYWRYUmVmU3RyZWFtKHN0cmVhbSkgewogICAgY29uc3Qgc3RyZWFtU3RhdGUgPSB0aGlzLnN0cmVhbVN0YXRlOwogICAgc3RyZWFtLnBvcyA9IHN0cmVhbVN0YXRlLnN0cmVhbVBvczsKICAgIGNvbnN0IFt0eXBlRmllbGRXaWR0aCwgb2Zmc2V0RmllbGRXaWR0aCwgZ2VuZXJhdGlvbkZpZWxkV2lkdGhdID0gc3RyZWFtU3RhdGUuYnl0ZVdpZHRoczsKICAgIGNvbnN0IGVudHJ5UmFuZ2VzID0gc3RyZWFtU3RhdGUuZW50cnlSYW5nZXM7CgogICAgd2hpbGUgKGVudHJ5UmFuZ2VzLmxlbmd0aCA+IDApIHsKICAgICAgY29uc3QgW2ZpcnN0LCBuXSA9IGVudHJ5UmFuZ2VzOwoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGZpcnN0KSB8fCAhTnVtYmVyLmlzSW50ZWdlcihuKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW52YWxpZCBYUmVmIHJhbmdlIGZpZWxkczogJHtmaXJzdH0sICR7bn1gKTsKICAgICAgfQoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKHR5cGVGaWVsZFdpZHRoKSB8fCAhTnVtYmVyLmlzSW50ZWdlcihvZmZzZXRGaWVsZFdpZHRoKSB8fCAhTnVtYmVyLmlzSW50ZWdlcihnZW5lcmF0aW9uRmllbGRXaWR0aCkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgWFJlZiBlbnRyeSBmaWVsZHMgbGVuZ3RoOiAke2ZpcnN0fSwgJHtufWApOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gc3RyZWFtU3RhdGUuZW50cnlOdW07IGkgPCBuOyArK2kpIHsKICAgICAgICBzdHJlYW1TdGF0ZS5lbnRyeU51bSA9IGk7CiAgICAgICAgc3RyZWFtU3RhdGUuc3RyZWFtUG9zID0gc3RyZWFtLnBvczsKICAgICAgICBsZXQgdHlwZSA9IDAsCiAgICAgICAgICAgIG9mZnNldCA9IDAsCiAgICAgICAgICAgIGdlbmVyYXRpb24gPSAwOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHR5cGVGaWVsZFdpZHRoOyArK2opIHsKICAgICAgICAgIGNvbnN0IHR5cGVCeXRlID0gc3RyZWFtLmdldEJ5dGUoKTsKCiAgICAgICAgICBpZiAodHlwZUJ5dGUgPT09IC0xKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBYUmVmIGJ5dGVXaWR0aHMgJ3R5cGUnLiIpOwogICAgICAgICAgfQoKICAgICAgICAgIHR5cGUgPSB0eXBlIDw8IDggfCB0eXBlQnl0ZTsKICAgICAgICB9CgogICAgICAgIGlmICh0eXBlRmllbGRXaWR0aCA9PT0gMCkgewogICAgICAgICAgdHlwZSA9IDE7CiAgICAgICAgfQoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG9mZnNldEZpZWxkV2lkdGg7ICsraikgewogICAgICAgICAgY29uc3Qgb2Zmc2V0Qnl0ZSA9IHN0cmVhbS5nZXRCeXRlKCk7CgogICAgICAgICAgaWYgKG9mZnNldEJ5dGUgPT09IC0xKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBYUmVmIGJ5dGVXaWR0aHMgJ29mZnNldCcuIik7CiAgICAgICAgICB9CgogICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0IDw8IDggfCBvZmZzZXRCeXRlOwogICAgICAgIH0KCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBnZW5lcmF0aW9uRmllbGRXaWR0aDsgKytqKSB7CiAgICAgICAgICBjb25zdCBnZW5lcmF0aW9uQnl0ZSA9IHN0cmVhbS5nZXRCeXRlKCk7CgogICAgICAgICAgaWYgKGdlbmVyYXRpb25CeXRlID09PSAtMSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiBieXRlV2lkdGhzICdnZW5lcmF0aW9uJy4iKTsKICAgICAgICAgIH0KCiAgICAgICAgICBnZW5lcmF0aW9uID0gZ2VuZXJhdGlvbiA8PCA4IHwgZ2VuZXJhdGlvbkJ5dGU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBlbnRyeSA9IHt9OwogICAgICAgIGVudHJ5Lm9mZnNldCA9IG9mZnNldDsKICAgICAgICBlbnRyeS5nZW4gPSBnZW5lcmF0aW9uOwoKICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgZW50cnkuZnJlZSA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgZW50cnkudW5jb21wcmVzc2VkID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgWFJlZiBlbnRyeSB0eXBlOiAke3R5cGV9YCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXRoaXMuZW50cmllc1tmaXJzdCArIGldKSB7CiAgICAgICAgICB0aGlzLmVudHJpZXNbZmlyc3QgKyBpXSA9IGVudHJ5OwogICAgICAgIH0KICAgICAgfQoKICAgICAgc3RyZWFtU3RhdGUuZW50cnlOdW0gPSAwOwogICAgICBzdHJlYW1TdGF0ZS5zdHJlYW1Qb3MgPSBzdHJlYW0ucG9zOwogICAgICBlbnRyeVJhbmdlcy5zcGxpY2UoMCwgMik7CiAgICB9CiAgfQoKICBpbmRleE9iamVjdHMoKSB7CiAgICBjb25zdCBUQUIgPSAweDksCiAgICAgICAgICBMRiA9IDB4YSwKICAgICAgICAgIENSID0gMHhkLAogICAgICAgICAgU1BBQ0UgPSAweDIwOwogICAgY29uc3QgUEVSQ0VOVCA9IDB4MjUsCiAgICAgICAgICBMVCA9IDB4M2M7CgogICAgZnVuY3Rpb24gcmVhZFRva2VuKGRhdGEsIG9mZnNldCkgewogICAgICBsZXQgdG9rZW4gPSAiIiwKICAgICAgICAgIGNoID0gZGF0YVtvZmZzZXRdOwoKICAgICAgd2hpbGUgKGNoICE9PSBMRiAmJiBjaCAhPT0gQ1IgJiYgY2ggIT09IExUKSB7CiAgICAgICAgaWYgKCsrb2Zmc2V0ID49IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHRva2VuICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpOwogICAgICAgIGNoID0gZGF0YVtvZmZzZXRdOwogICAgICB9CgogICAgICByZXR1cm4gdG9rZW47CiAgICB9CgogICAgZnVuY3Rpb24gc2tpcFVudGlsKGRhdGEsIG9mZnNldCwgd2hhdCkgewogICAgICBjb25zdCBsZW5ndGggPSB3aGF0Lmxlbmd0aCwKICAgICAgICAgICAgZGF0YUxlbmd0aCA9IGRhdGEubGVuZ3RoOwogICAgICBsZXQgc2tpcHBlZCA9IDA7CgogICAgICB3aGlsZSAob2Zmc2V0IDwgZGF0YUxlbmd0aCkgewogICAgICAgIGxldCBpID0gMDsKCiAgICAgICAgd2hpbGUgKGkgPCBsZW5ndGggJiYgZGF0YVtvZmZzZXQgKyBpXSA9PT0gd2hhdFtpXSkgewogICAgICAgICAgKytpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGkgPj0gbGVuZ3RoKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIG9mZnNldCsrOwogICAgICAgIHNraXBwZWQrKzsKICAgICAgfQoKICAgICAgcmV0dXJuIHNraXBwZWQ7CiAgICB9CgogICAgY29uc3Qgb2JqUmVnRXhwID0gL14oXGQrKVxzKyhcZCspXHMrb2JqXGIvOwogICAgY29uc3QgZW5kb2JqUmVnRXhwID0gL1xiZW5kb2JqW1xiXHNdJC87CiAgICBjb25zdCBuZXN0ZWRPYmpSZWdFeHAgPSAvXHMrKFxkK1xzK1xkK1xzK29ialtcYlxzPF0pJC87CiAgICBjb25zdCBDSEVDS19DT05URU5UX0xFTkdUSCA9IDI1OwogICAgY29uc3QgdHJhaWxlckJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzExNiwgMTE0LCA5NywgMTA1LCAxMDgsIDEwMSwgMTE0XSk7CiAgICBjb25zdCBzdGFydHhyZWZCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxMTUsIDExNiwgOTcsIDExNCwgMTE2LCAxMjAsIDExNCwgMTAxLCAxMDJdKTsKICAgIGNvbnN0IG9iakJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzExMSwgOTgsIDEwNl0pOwogICAgY29uc3QgeHJlZkJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzQ3LCA4OCwgODIsIDEwMSwgMTAyXSk7CiAgICB0aGlzLmVudHJpZXMubGVuZ3RoID0gMDsKCiAgICB0aGlzLl9jYWNoZU1hcC5jbGVhcigpOwoKICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuc3RyZWFtOwogICAgc3RyZWFtLnBvcyA9IDA7CiAgICBjb25zdCBidWZmZXIgPSBzdHJlYW0uZ2V0Qnl0ZXMoKSwKICAgICAgICAgIGxlbmd0aCA9IGJ1ZmZlci5sZW5ndGg7CiAgICBsZXQgcG9zaXRpb24gPSBzdHJlYW0uc3RhcnQ7CiAgICBjb25zdCB0cmFpbGVycyA9IFtdLAogICAgICAgICAgeHJlZlN0bXMgPSBbXTsKCiAgICB3aGlsZSAocG9zaXRpb24gPCBsZW5ndGgpIHsKICAgICAgbGV0IGNoID0gYnVmZmVyW3Bvc2l0aW9uXTsKCiAgICAgIGlmIChjaCA9PT0gVEFCIHx8IGNoID09PSBMRiB8fCBjaCA9PT0gQ1IgfHwgY2ggPT09IFNQQUNFKSB7CiAgICAgICAgKytwb3NpdGlvbjsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKGNoID09PSBQRVJDRU5UKSB7CiAgICAgICAgZG8gewogICAgICAgICAgKytwb3NpdGlvbjsKCiAgICAgICAgICBpZiAocG9zaXRpb24gPj0gbGVuZ3RoKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGNoID0gYnVmZmVyW3Bvc2l0aW9uXTsKICAgICAgICB9IHdoaWxlIChjaCAhPT0gTEYgJiYgY2ggIT09IENSKTsKCiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHRva2VuID0gcmVhZFRva2VuKGJ1ZmZlciwgcG9zaXRpb24pOwogICAgICBsZXQgbTsKCiAgICAgIGlmICh0b2tlbi5zdGFydHNXaXRoKCJ4cmVmIikgJiYgKHRva2VuLmxlbmd0aCA9PT0gNCB8fCAvXHMvLnRlc3QodG9rZW5bNF0pKSkgewogICAgICAgIHBvc2l0aW9uICs9IHNraXBVbnRpbChidWZmZXIsIHBvc2l0aW9uLCB0cmFpbGVyQnl0ZXMpOwogICAgICAgIHRyYWlsZXJzLnB1c2gocG9zaXRpb24pOwogICAgICAgIHBvc2l0aW9uICs9IHNraXBVbnRpbChidWZmZXIsIHBvc2l0aW9uLCBzdGFydHhyZWZCeXRlcyk7CiAgICAgIH0gZWxzZSBpZiAobSA9IG9ialJlZ0V4cC5leGVjKHRva2VuKSkgewogICAgICAgIGNvbnN0IG51bSA9IG1bMV0gfCAwLAogICAgICAgICAgICAgIGdlbiA9IG1bMl0gfCAwOwogICAgICAgIGxldCBjb250ZW50TGVuZ3RoLAogICAgICAgICAgICBzdGFydFBvcyA9IHBvc2l0aW9uICsgdG9rZW4ubGVuZ3RoLAogICAgICAgICAgICB1cGRhdGVFbnRyaWVzID0gZmFsc2U7CgogICAgICAgIGlmICghdGhpcy5lbnRyaWVzW251bV0pIHsKICAgICAgICAgIHVwZGF0ZUVudHJpZXMgPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbnRyaWVzW251bV0uZ2VuID09PSBnZW4pIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHBhcnNlciA9IG5ldyBfcGFyc2VyLlBhcnNlcih7CiAgICAgICAgICAgICAgbGV4ZXI6IG5ldyBfcGFyc2VyLkxleGVyKHN0cmVhbS5tYWtlU3ViU3RyZWFtKHN0YXJ0UG9zKSkKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHBhcnNlci5nZXRPYmooKTsKICAgICAgICAgICAgdXBkYXRlRW50cmllcyA9IHRydWU7CiAgICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5QYXJzZXJFT0ZFeGNlcHRpb24pIHsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoYGluZGV4T2JqZWN0cyAtLSBjaGVja2luZyBvYmplY3QgKCR7dG9rZW59KTogIiR7ZXh9Ii5gKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB1cGRhdGVFbnRyaWVzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHVwZGF0ZUVudHJpZXMpIHsKICAgICAgICAgIHRoaXMuZW50cmllc1tudW1dID0gewogICAgICAgICAgICBvZmZzZXQ6IHBvc2l0aW9uIC0gc3RyZWFtLnN0YXJ0LAogICAgICAgICAgICBnZW4sCiAgICAgICAgICAgIHVuY29tcHJlc3NlZDogdHJ1ZQogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHdoaWxlIChzdGFydFBvcyA8IGJ1ZmZlci5sZW5ndGgpIHsKICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHN0YXJ0UG9zICsgc2tpcFVudGlsKGJ1ZmZlciwgc3RhcnRQb3MsIG9iakJ5dGVzKSArIDQ7CiAgICAgICAgICBjb250ZW50TGVuZ3RoID0gZW5kUG9zIC0gcG9zaXRpb247CiAgICAgICAgICBjb25zdCBjaGVja1BvcyA9IE1hdGgubWF4KGVuZFBvcyAtIENIRUNLX0NPTlRFTlRfTEVOR1RILCBzdGFydFBvcyk7CiAgICAgICAgICBjb25zdCB0b2tlblN0ciA9ICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShidWZmZXIuc3ViYXJyYXkoY2hlY2tQb3MsIGVuZFBvcykpOwoKICAgICAgICAgIGlmIChlbmRvYmpSZWdFeHAudGVzdCh0b2tlblN0cikpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBvYmpUb2tlbiA9IG5lc3RlZE9ialJlZ0V4cC5leGVjKHRva2VuU3RyKTsKCiAgICAgICAgICAgIGlmIChvYmpUb2tlbiAmJiBvYmpUb2tlblsxXSkgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgnaW5kZXhPYmplY3RzOiBGb3VuZCBuZXcgIm9iaiIgaW5zaWRlIG9mIGFub3RoZXIgIm9iaiIsICcgKyAnY2F1c2VkIGJ5IG1pc3NpbmcgImVuZG9iaiIgLS0gdHJ5aW5nIHRvIHJlY292ZXIuJyk7CiAgICAgICAgICAgICAgY29udGVudExlbmd0aCAtPSBvYmpUb2tlblsxXS5sZW5ndGg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBzdGFydFBvcyA9IGVuZFBvczsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGNvbnRlbnQgPSBidWZmZXIuc3ViYXJyYXkocG9zaXRpb24sIHBvc2l0aW9uICsgY29udGVudExlbmd0aCk7CiAgICAgICAgY29uc3QgeHJlZlRhZ09mZnNldCA9IHNraXBVbnRpbChjb250ZW50LCAwLCB4cmVmQnl0ZXMpOwoKICAgICAgICBpZiAoeHJlZlRhZ09mZnNldCA8IGNvbnRlbnRMZW5ndGggJiYgY29udGVudFt4cmVmVGFnT2Zmc2V0ICsgNV0gPCA2NCkgewogICAgICAgICAgeHJlZlN0bXMucHVzaChwb3NpdGlvbiAtIHN0cmVhbS5zdGFydCk7CiAgICAgICAgICB0aGlzLnhyZWZzdG1zW3Bvc2l0aW9uIC0gc3RyZWFtLnN0YXJ0XSA9IDE7CiAgICAgICAgfQoKICAgICAgICBwb3NpdGlvbiArPSBjb250ZW50TGVuZ3RoOwogICAgICB9IGVsc2UgaWYgKHRva2VuLnN0YXJ0c1dpdGgoInRyYWlsZXIiKSAmJiAodG9rZW4ubGVuZ3RoID09PSA3IHx8IC9ccy8udGVzdCh0b2tlbls3XSkpKSB7CiAgICAgICAgdHJhaWxlcnMucHVzaChwb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb24gKz0gc2tpcFVudGlsKGJ1ZmZlciwgcG9zaXRpb24sIHN0YXJ0eHJlZkJ5dGVzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwb3NpdGlvbiArPSB0b2tlbi5sZW5ndGggKyAxOwogICAgICB9CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0geHJlZlN0bXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICB0aGlzLnN0YXJ0WFJlZlF1ZXVlLnB1c2goeHJlZlN0bXNbaV0pOwogICAgICB0aGlzLnJlYWRYUmVmKHRydWUpOwogICAgfQoKICAgIGxldCB0cmFpbGVyRGljdDsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB0cmFpbGVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIHN0cmVhbS5wb3MgPSB0cmFpbGVyc1tpXTsKICAgICAgY29uc3QgcGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgICBsZXhlcjogbmV3IF9wYXJzZXIuTGV4ZXIoc3RyZWFtKSwKICAgICAgICB4cmVmOiB0aGlzLAogICAgICAgIGFsbG93U3RyZWFtczogdHJ1ZSwKICAgICAgICByZWNvdmVyeU1vZGU6IHRydWUKICAgICAgfSk7CiAgICAgIGNvbnN0IG9iaiA9IHBhcnNlci5nZXRPYmooKTsKCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmosICJ0cmFpbGVyIikpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgZGljdCA9IHBhcnNlci5nZXRPYmooKTsKCiAgICAgIGlmICghKGRpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJvb3REaWN0ID0gZGljdC5nZXQoIlJvb3QiKTsKCiAgICAgICAgaWYgKCEocm9vdERpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBwYWdlc0RpY3QgPSByb290RGljdC5nZXQoIlBhZ2VzIik7CgogICAgICAgIGlmICghKHBhZ2VzRGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHBhZ2VzQ291bnQgPSBwYWdlc0RpY3QuZ2V0KCJDb3VudCIpOwoKICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIocGFnZXNDb3VudCkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKGRpY3QuaGFzKCJJRCIpKSB7CiAgICAgICAgcmV0dXJuIGRpY3Q7CiAgICAgIH0KCiAgICAgIHRyYWlsZXJEaWN0ID0gZGljdDsKICAgIH0KCiAgICBpZiAodHJhaWxlckRpY3QpIHsKICAgICAgcmV0dXJuIHRyYWlsZXJEaWN0OwogICAgfQoKICAgIGlmICh0aGlzLnRvcERpY3QpIHsKICAgICAgcmV0dXJuIHRoaXMudG9wRGljdDsKICAgIH0KCiAgICB0aHJvdyBuZXcgX3V0aWwuSW52YWxpZFBERkV4Y2VwdGlvbigiSW52YWxpZCBQREYgc3RydWN0dXJlLiIpOwogIH0KCiAgcmVhZFhSZWYoKSB7CiAgICBsZXQgcmVjb3ZlcnlNb2RlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuc3RyZWFtOwogICAgY29uc3Qgc3RhcnRYUmVmUGFyc2VkQ2FjaGUgPSBuZXcgU2V0KCk7CgogICAgdHJ5IHsKICAgICAgd2hpbGUgKHRoaXMuc3RhcnRYUmVmUXVldWUubGVuZ3RoKSB7CiAgICAgICAgY29uc3Qgc3RhcnRYUmVmID0gdGhpcy5zdGFydFhSZWZRdWV1ZVswXTsKCiAgICAgICAgaWYgKHN0YXJ0WFJlZlBhcnNlZENhY2hlLmhhcyhzdGFydFhSZWYpKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoInJlYWRYUmVmIC0gc2tpcHBpbmcgWFJlZiB0YWJsZSBzaW5jZSBpdCB3YXMgYWxyZWFkeSBwYXJzZWQuIik7CiAgICAgICAgICB0aGlzLnN0YXJ0WFJlZlF1ZXVlLnNoaWZ0KCk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHN0YXJ0WFJlZlBhcnNlZENhY2hlLmFkZChzdGFydFhSZWYpOwogICAgICAgIHN0cmVhbS5wb3MgPSBzdGFydFhSZWYgKyBzdHJlYW0uc3RhcnQ7CiAgICAgICAgY29uc3QgcGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgICAgIGxleGVyOiBuZXcgX3BhcnNlci5MZXhlcihzdHJlYW0pLAogICAgICAgICAgeHJlZjogdGhpcywKICAgICAgICAgIGFsbG93U3RyZWFtczogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIGxldCBvYmogPSBwYXJzZXIuZ2V0T2JqKCk7CiAgICAgICAgbGV0IGRpY3Q7CgogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iaiwgInhyZWYiKSkgewogICAgICAgICAgZGljdCA9IHRoaXMucHJvY2Vzc1hSZWZUYWJsZShwYXJzZXIpOwoKICAgICAgICAgIGlmICghdGhpcy50b3BEaWN0KSB7CiAgICAgICAgICAgIHRoaXMudG9wRGljdCA9IGRpY3Q7CiAgICAgICAgICB9CgogICAgICAgICAgb2JqID0gZGljdC5nZXQoIlhSZWZTdG0iKTsKCiAgICAgICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihvYmopKSB7CiAgICAgICAgICAgIGNvbnN0IHBvcyA9IG9iajsKCiAgICAgICAgICAgIGlmICghKHBvcyBpbiB0aGlzLnhyZWZzdG1zKSkgewogICAgICAgICAgICAgIHRoaXMueHJlZnN0bXNbcG9zXSA9IDE7CiAgICAgICAgICAgICAgdGhpcy5zdGFydFhSZWZRdWV1ZS5wdXNoKHBvcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKE51bWJlci5pc0ludGVnZXIob2JqKSkgewogICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKHBhcnNlci5nZXRPYmooKSkgfHwgISgwLCBfcHJpbWl0aXZlcy5pc0NtZCkocGFyc2VyLmdldE9iaigpLCAib2JqIikgfHwgISgob2JqID0gcGFyc2VyLmdldE9iaigpKSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiBzdHJlYW0iKTsKICAgICAgICAgIH0KCiAgICAgICAgICBkaWN0ID0gdGhpcy5wcm9jZXNzWFJlZlN0cmVhbShvYmopOwoKICAgICAgICAgIGlmICghdGhpcy50b3BEaWN0KSB7CiAgICAgICAgICAgIHRoaXMudG9wRGljdCA9IGRpY3Q7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFkaWN0KSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiRmFpbGVkIHRvIHJlYWQgWFJlZiBzdHJlYW0iKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIFhSZWYgc3RyZWFtIGhlYWRlciIpOwogICAgICAgIH0KCiAgICAgICAgb2JqID0gZGljdC5nZXQoIlByZXYiKTsKCiAgICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIob2JqKSkgewogICAgICAgICAgdGhpcy5zdGFydFhSZWZRdWV1ZS5wdXNoKG9iaik7CiAgICAgICAgfSBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgIHRoaXMuc3RhcnRYUmVmUXVldWUucHVzaChvYmoubnVtKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuc3RhcnRYUmVmUXVldWUuc2hpZnQoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMudG9wRGljdDsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgaWYgKGUgaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGU7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC5pbmZvKSgiKHdoaWxlIHJlYWRpbmcgWFJlZik6ICIgKyBlKTsKICAgICAgdGhpcy5zdGFydFhSZWZRdWV1ZS5zaGlmdCgpOwogICAgfQoKICAgIGlmIChyZWNvdmVyeU1vZGUpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuWFJlZlBhcnNlRXhjZXB0aW9uKCk7CiAgfQoKICBnZXRFbnRyeShpKSB7CiAgICBjb25zdCB4cmVmRW50cnkgPSB0aGlzLmVudHJpZXNbaV07CgogICAgaWYgKHhyZWZFbnRyeSAmJiAheHJlZkVudHJ5LmZyZWUgJiYgeHJlZkVudHJ5Lm9mZnNldCkgewogICAgICByZXR1cm4geHJlZkVudHJ5OwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgZmV0Y2hJZlJlZihvYmopIHsKICAgIGxldCBzdXBwcmVzc0VuY3J5cHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwoKICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gob2JqLCBzdXBwcmVzc0VuY3J5cHRpb24pOwogICAgfQoKICAgIHJldHVybiBvYmo7CiAgfQoKICBmZXRjaChyZWYpIHsKICAgIGxldCBzdXBwcmVzc0VuY3J5cHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwoKICAgIGlmICghKHJlZiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJyZWYgb2JqZWN0IGlzIG5vdCBhIHJlZmVyZW5jZSIpOwogICAgfQoKICAgIGNvbnN0IG51bSA9IHJlZi5udW07CgogICAgY29uc3QgY2FjaGVFbnRyeSA9IHRoaXMuX2NhY2hlTWFwLmdldChudW0pOwoKICAgIGlmIChjYWNoZUVudHJ5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKGNhY2hlRW50cnkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ICYmICFjYWNoZUVudHJ5Lm9iaklkKSB7CiAgICAgICAgY2FjaGVFbnRyeS5vYmpJZCA9IHJlZi50b1N0cmluZygpOwogICAgICB9CgogICAgICByZXR1cm4gY2FjaGVFbnRyeTsKICAgIH0KCiAgICBsZXQgeHJlZkVudHJ5ID0gdGhpcy5nZXRFbnRyeShudW0pOwoKICAgIGlmICh4cmVmRW50cnkgPT09IG51bGwpIHsKICAgICAgdGhpcy5fY2FjaGVNYXAuc2V0KG51bSwgeHJlZkVudHJ5KTsKCiAgICAgIHJldHVybiB4cmVmRW50cnk7CiAgICB9CgogICAgaWYgKHRoaXMuX3BlbmRpbmdSZWZzLmhhcyhyZWYpKSB7CiAgICAgIHRoaXMuX3BlbmRpbmdSZWZzLnJlbW92ZShyZWYpOwoKICAgICAgKDAsIF91dGlsLndhcm4pKGBJZ25vcmluZyBjaXJjdWxhciByZWZlcmVuY2U6ICR7cmVmfS5gKTsKICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkNJUkNVTEFSX1JFRjsKICAgIH0KCiAgICB0aGlzLl9wZW5kaW5nUmVmcy5wdXQocmVmKTsKCiAgICB0cnkgewogICAgICBpZiAoeHJlZkVudHJ5LnVuY29tcHJlc3NlZCkgewogICAgICAgIHhyZWZFbnRyeSA9IHRoaXMuZmV0Y2hVbmNvbXByZXNzZWQocmVmLCB4cmVmRW50cnksIHN1cHByZXNzRW5jcnlwdGlvbik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgeHJlZkVudHJ5ID0gdGhpcy5mZXRjaENvbXByZXNzZWQocmVmLCB4cmVmRW50cnksIHN1cHByZXNzRW5jcnlwdGlvbik7CiAgICAgIH0KCiAgICAgIHRoaXMuX3BlbmRpbmdSZWZzLnJlbW92ZShyZWYpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgdGhpcy5fcGVuZGluZ1JlZnMucmVtb3ZlKHJlZik7CgogICAgICB0aHJvdyBleDsKICAgIH0KCiAgICBpZiAoeHJlZkVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICB4cmVmRW50cnkub2JqSWQgPSByZWYudG9TdHJpbmcoKTsKICAgIH0gZWxzZSBpZiAoeHJlZkVudHJ5IGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgeHJlZkVudHJ5LmRpY3Qub2JqSWQgPSByZWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICByZXR1cm4geHJlZkVudHJ5OwogIH0KCiAgZmV0Y2hVbmNvbXByZXNzZWQocmVmLCB4cmVmRW50cnkpIHsKICAgIGxldCBzdXBwcmVzc0VuY3J5cHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlOwogICAgY29uc3QgZ2VuID0gcmVmLmdlbjsKICAgIGxldCBudW0gPSByZWYubnVtOwoKICAgIGlmICh4cmVmRW50cnkuZ2VuICE9PSBnZW4pIHsKICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLlhSZWZFbnRyeUV4Y2VwdGlvbihgSW5jb25zaXN0ZW50IGdlbmVyYXRpb24gaW4gWFJlZjogJHtyZWZ9YCk7CiAgICB9CgogICAgY29uc3Qgc3RyZWFtID0gdGhpcy5zdHJlYW0ubWFrZVN1YlN0cmVhbSh4cmVmRW50cnkub2Zmc2V0ICsgdGhpcy5zdHJlYW0uc3RhcnQpOwogICAgY29uc3QgcGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgbGV4ZXI6IG5ldyBfcGFyc2VyLkxleGVyKHN0cmVhbSksCiAgICAgIHhyZWY6IHRoaXMsCiAgICAgIGFsbG93U3RyZWFtczogdHJ1ZQogICAgfSk7CiAgICBjb25zdCBvYmoxID0gcGFyc2VyLmdldE9iaigpOwogICAgY29uc3Qgb2JqMiA9IHBhcnNlci5nZXRPYmooKTsKICAgIGNvbnN0IG9iajMgPSBwYXJzZXIuZ2V0T2JqKCk7CgogICAgaWYgKG9iajEgIT09IG51bSB8fCBvYmoyICE9PSBnZW4gfHwgIShvYmozIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuQ21kKSkgewogICAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuWFJlZkVudHJ5RXhjZXB0aW9uKGBCYWQgKHVuY29tcHJlc3NlZCkgWFJlZiBlbnRyeTogJHtyZWZ9YCk7CiAgICB9CgogICAgaWYgKG9iajMuY21kICE9PSAib2JqIikgewogICAgICBpZiAob2JqMy5jbWQuc3RhcnRzV2l0aCgib2JqIikpIHsKICAgICAgICBudW0gPSBwYXJzZUludChvYmozLmNtZC5zdWJzdHJpbmcoMyksIDEwKTsKCiAgICAgICAgaWYgKCFOdW1iZXIuaXNOYU4obnVtKSkgewogICAgICAgICAgcmV0dXJuIG51bTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5YUmVmRW50cnlFeGNlcHRpb24oYEJhZCAodW5jb21wcmVzc2VkKSBYUmVmIGVudHJ5OiAke3JlZn1gKTsKICAgIH0KCiAgICBpZiAodGhpcy5lbmNyeXB0ICYmICFzdXBwcmVzc0VuY3J5cHRpb24pIHsKICAgICAgeHJlZkVudHJ5ID0gcGFyc2VyLmdldE9iaih0aGlzLmVuY3J5cHQuY3JlYXRlQ2lwaGVyVHJhbnNmb3JtKG51bSwgZ2VuKSk7CiAgICB9IGVsc2UgewogICAgICB4cmVmRW50cnkgPSBwYXJzZXIuZ2V0T2JqKCk7CiAgICB9CgogICAgaWYgKCEoeHJlZkVudHJ5IGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pKSB7CiAgICAgIHRoaXMuX2NhY2hlTWFwLnNldChudW0sIHhyZWZFbnRyeSk7CiAgICB9CgogICAgcmV0dXJuIHhyZWZFbnRyeTsKICB9CgogIGZldGNoQ29tcHJlc3NlZChyZWYsIHhyZWZFbnRyeSkgewogICAgbGV0IHN1cHByZXNzRW5jcnlwdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICBjb25zdCB0YWJsZU9mZnNldCA9IHhyZWZFbnRyeS5vZmZzZXQ7CiAgICBjb25zdCBzdHJlYW0gPSB0aGlzLmZldGNoKF9wcmltaXRpdmVzLlJlZi5nZXQodGFibGVPZmZzZXQsIDApKTsKCiAgICBpZiAoIShzdHJlYW0gaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJiYWQgT2JqU3RtIHN0cmVhbSIpOwogICAgfQoKICAgIGNvbnN0IGZpcnN0ID0gc3RyZWFtLmRpY3QuZ2V0KCJGaXJzdCIpOwogICAgY29uc3QgbiA9IHN0cmVhbS5kaWN0LmdldCgiTiIpOwoKICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihmaXJzdCkgfHwgIU51bWJlci5pc0ludGVnZXIobikpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJpbnZhbGlkIGZpcnN0IGFuZCBuIHBhcmFtZXRlcnMgZm9yIE9ialN0bSBzdHJlYW0iKTsKICAgIH0KCiAgICBsZXQgcGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgbGV4ZXI6IG5ldyBfcGFyc2VyLkxleGVyKHN0cmVhbSksCiAgICAgIHhyZWY6IHRoaXMsCiAgICAgIGFsbG93U3RyZWFtczogdHJ1ZQogICAgfSk7CiAgICBjb25zdCBudW1zID0gbmV3IEFycmF5KG4pOwogICAgY29uc3Qgb2Zmc2V0cyA9IG5ldyBBcnJheShuKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47ICsraSkgewogICAgICBjb25zdCBudW0gPSBwYXJzZXIuZ2V0T2JqKCk7CgogICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIobnVtKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgaW52YWxpZCBvYmplY3QgbnVtYmVyIGluIHRoZSBPYmpTdG0gc3RyZWFtOiAke251bX1gKTsKICAgICAgfQoKICAgICAgY29uc3Qgb2Zmc2V0ID0gcGFyc2VyLmdldE9iaigpOwoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKG9mZnNldCkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYGludmFsaWQgb2JqZWN0IG9mZnNldCBpbiB0aGUgT2JqU3RtIHN0cmVhbTogJHtvZmZzZXR9YCk7CiAgICAgIH0KCiAgICAgIG51bXNbaV0gPSBudW07CiAgICAgIG9mZnNldHNbaV0gPSBvZmZzZXQ7CiAgICB9CgogICAgY29uc3Qgc3RhcnQgPSAoc3RyZWFtLnN0YXJ0IHx8IDApICsgZmlyc3Q7CiAgICBjb25zdCBlbnRyaWVzID0gbmV3IEFycmF5KG4pOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgKytpKSB7CiAgICAgIGNvbnN0IGxlbmd0aCA9IGkgPCBuIC0gMSA/IG9mZnNldHNbaSArIDFdIC0gb2Zmc2V0c1tpXSA6IHVuZGVmaW5lZDsKCiAgICAgIGlmIChsZW5ndGggPCAwKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIG9mZnNldCBpbiB0aGUgT2JqU3RtIHN0cmVhbS4iKTsKICAgICAgfQoKICAgICAgcGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgICBsZXhlcjogbmV3IF9wYXJzZXIuTGV4ZXIoc3RyZWFtLm1ha2VTdWJTdHJlYW0oc3RhcnQgKyBvZmZzZXRzW2ldLCBsZW5ndGgsIHN0cmVhbS5kaWN0KSksCiAgICAgICAgeHJlZjogdGhpcywKICAgICAgICBhbGxvd1N0cmVhbXM6IHRydWUKICAgICAgfSk7CiAgICAgIGNvbnN0IG9iaiA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgZW50cmllc1tpXSA9IG9iajsKCiAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBudW0gPSBudW1zW2ldLAogICAgICAgICAgICBlbnRyeSA9IHRoaXMuZW50cmllc1tudW1dOwoKICAgICAgaWYgKGVudHJ5ICYmIGVudHJ5Lm9mZnNldCA9PT0gdGFibGVPZmZzZXQgJiYgZW50cnkuZ2VuID09PSBpKSB7CiAgICAgICAgdGhpcy5fY2FjaGVNYXAuc2V0KG51bSwgb2JqKTsKICAgICAgfQogICAgfQoKICAgIHhyZWZFbnRyeSA9IGVudHJpZXNbeHJlZkVudHJ5Lmdlbl07CgogICAgaWYgKHhyZWZFbnRyeSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5YUmVmRW50cnlFeGNlcHRpb24oYEJhZCAoY29tcHJlc3NlZCkgWFJlZiBlbnRyeTogJHtyZWZ9YCk7CiAgICB9CgogICAgcmV0dXJuIHhyZWZFbnRyeTsKICB9CgogIGFzeW5jIGZldGNoSWZSZWZBc3luYyhvYmosIHN1cHByZXNzRW5jcnlwdGlvbikgewogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICByZXR1cm4gdGhpcy5mZXRjaEFzeW5jKG9iaiwgc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgIH0KCiAgICByZXR1cm4gb2JqOwogIH0KCiAgYXN5bmMgZmV0Y2hBc3luYyhyZWYsIHN1cHByZXNzRW5jcnlwdGlvbikgewogICAgdHJ5IHsKICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gocmVmLCBzdXBwcmVzc0VuY3J5cHRpb24pOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKCEoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikpIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgYXdhaXQgdGhpcy5wZGZNYW5hZ2VyLnJlcXVlc3RSYW5nZShleC5iZWdpbiwgZXguZW5kKTsKICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hBc3luYyhyZWYsIHN1cHByZXNzRW5jcnlwdGlvbik7CiAgICB9CiAgfQoKICBnZXRDYXRhbG9nT2JqKCkgewogICAgcmV0dXJuIHRoaXMucm9vdDsKICB9Cgp9CgpleHBvcnRzLlhSZWYgPSBYUmVmOwoKLyoqKi8gfSksCi8qIDIyNyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTWVzc2FnZUhhbmRsZXIgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY29uc3QgQ2FsbGJhY2tLaW5kID0gewogIFVOS05PV046IDAsCiAgREFUQTogMSwKICBFUlJPUjogMgp9Owpjb25zdCBTdHJlYW1LaW5kID0gewogIFVOS05PV046IDAsCiAgQ0FOQ0VMOiAxLAogIENBTkNFTF9DT01QTEVURTogMiwKICBDTE9TRTogMywKICBFTlFVRVVFOiA0LAogIEVSUk9SOiA1LAogIFBVTEw6IDYsCiAgUFVMTF9DT01QTEVURTogNywKICBTVEFSVF9DT01QTEVURTogOAp9OwoKZnVuY3Rpb24gd3JhcFJlYXNvbihyZWFzb24pIHsKICBpZiAoIShyZWFzb24gaW5zdGFuY2VvZiBFcnJvciB8fCB0eXBlb2YgcmVhc29uID09PSAib2JqZWN0IiAmJiByZWFzb24gIT09IG51bGwpKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCd3cmFwUmVhc29uOiBFeHBlY3RlZCAicmVhc29uIiB0byBiZSBhIChwb3NzaWJseSBjbG9uZWQpIEVycm9yLicpOwogIH0KCiAgc3dpdGNoIChyZWFzb24ubmFtZSkgewogICAgY2FzZSAiQWJvcnRFeGNlcHRpb24iOgogICAgICByZXR1cm4gbmV3IF91dGlsLkFib3J0RXhjZXB0aW9uKHJlYXNvbi5tZXNzYWdlKTsKCiAgICBjYXNlICJNaXNzaW5nUERGRXhjZXB0aW9uIjoKICAgICAgcmV0dXJuIG5ldyBfdXRpbC5NaXNzaW5nUERGRXhjZXB0aW9uKHJlYXNvbi5tZXNzYWdlKTsKCiAgICBjYXNlICJQYXNzd29yZEV4Y2VwdGlvbiI6CiAgICAgIHJldHVybiBuZXcgX3V0aWwuUGFzc3dvcmRFeGNlcHRpb24ocmVhc29uLm1lc3NhZ2UsIHJlYXNvbi5jb2RlKTsKCiAgICBjYXNlICJVbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb24iOgogICAgICByZXR1cm4gbmV3IF91dGlsLlVuZXhwZWN0ZWRSZXNwb25zZUV4Y2VwdGlvbihyZWFzb24ubWVzc2FnZSwgcmVhc29uLnN0YXR1cyk7CgogICAgY2FzZSAiVW5rbm93bkVycm9yRXhjZXB0aW9uIjoKICAgICAgcmV0dXJuIG5ldyBfdXRpbC5Vbmtub3duRXJyb3JFeGNlcHRpb24ocmVhc29uLm1lc3NhZ2UsIHJlYXNvbi5kZXRhaWxzKTsKCiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gbmV3IF91dGlsLlVua25vd25FcnJvckV4Y2VwdGlvbihyZWFzb24ubWVzc2FnZSwgcmVhc29uLnRvU3RyaW5nKCkpOwogIH0KfQoKY2xhc3MgTWVzc2FnZUhhbmRsZXIgewogIGNvbnN0cnVjdG9yKHNvdXJjZU5hbWUsIHRhcmdldE5hbWUsIGNvbU9iaikgewogICAgdGhpcy5zb3VyY2VOYW1lID0gc291cmNlTmFtZTsKICAgIHRoaXMudGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7CiAgICB0aGlzLmNvbU9iaiA9IGNvbU9iajsKICAgIHRoaXMuY2FsbGJhY2tJZCA9IDE7CiAgICB0aGlzLnN0cmVhbUlkID0gMTsKICAgIHRoaXMuc3RyZWFtU2lua3MgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy5zdHJlYW1Db250cm9sbGVycyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB0aGlzLmNhbGxiYWNrQ2FwYWJpbGl0aWVzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMuYWN0aW9uSGFuZGxlciA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgdGhpcy5fb25Db21PYmpPbk1lc3NhZ2UgPSBldmVudCA9PiB7CiAgICAgIGNvbnN0IGRhdGEgPSBldmVudC5kYXRhOwoKICAgICAgaWYgKGRhdGEudGFyZ2V0TmFtZSAhPT0gdGhpcy5zb3VyY2VOYW1lKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoZGF0YS5zdHJlYW0pIHsKICAgICAgICB0aGlzLl9wcm9jZXNzU3RyZWFtTWVzc2FnZShkYXRhKTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoZGF0YS5jYWxsYmFjaykgewogICAgICAgIGNvbnN0IGNhbGxiYWNrSWQgPSBkYXRhLmNhbGxiYWNrSWQ7CiAgICAgICAgY29uc3QgY2FwYWJpbGl0eSA9IHRoaXMuY2FsbGJhY2tDYXBhYmlsaXRpZXNbY2FsbGJhY2tJZF07CgogICAgICAgIGlmICghY2FwYWJpbGl0eSkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgcmVzb2x2ZSBjYWxsYmFjayAke2NhbGxiYWNrSWR9YCk7CiAgICAgICAgfQoKICAgICAgICBkZWxldGUgdGhpcy5jYWxsYmFja0NhcGFiaWxpdGllc1tjYWxsYmFja0lkXTsKCiAgICAgICAgaWYgKGRhdGEuY2FsbGJhY2sgPT09IENhbGxiYWNrS2luZC5EQVRBKSB7CiAgICAgICAgICBjYXBhYmlsaXR5LnJlc29sdmUoZGF0YS5kYXRhKTsKICAgICAgICB9IGVsc2UgaWYgKGRhdGEuY2FsbGJhY2sgPT09IENhbGxiYWNrS2luZC5FUlJPUikgewogICAgICAgICAgY2FwYWJpbGl0eS5yZWplY3Qod3JhcFJlYXNvbihkYXRhLnJlYXNvbikpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgY2FsbGJhY2sgY2FzZSIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBhY3Rpb24gPSB0aGlzLmFjdGlvbkhhbmRsZXJbZGF0YS5hY3Rpb25dOwoKICAgICAgaWYgKCFhY3Rpb24pIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gYWN0aW9uIGZyb20gd29ya2VyOiAke2RhdGEuYWN0aW9ufWApOwogICAgICB9CgogICAgICBpZiAoZGF0YS5jYWxsYmFja0lkKSB7CiAgICAgICAgY29uc3QgY2JTb3VyY2VOYW1lID0gdGhpcy5zb3VyY2VOYW1lOwogICAgICAgIGNvbnN0IGNiVGFyZ2V0TmFtZSA9IGRhdGEuc291cmNlTmFtZTsKICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgcmVzb2x2ZShhY3Rpb24oZGF0YS5kYXRhKSk7CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBzb3VyY2VOYW1lOiBjYlNvdXJjZU5hbWUsCiAgICAgICAgICAgIHRhcmdldE5hbWU6IGNiVGFyZ2V0TmFtZSwKICAgICAgICAgICAgY2FsbGJhY2s6IENhbGxiYWNrS2luZC5EQVRBLAogICAgICAgICAgICBjYWxsYmFja0lkOiBkYXRhLmNhbGxiYWNrSWQsCiAgICAgICAgICAgIGRhdGE6IHJlc3VsdAogICAgICAgICAgfSk7CiAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgc291cmNlTmFtZTogY2JTb3VyY2VOYW1lLAogICAgICAgICAgICB0YXJnZXROYW1lOiBjYlRhcmdldE5hbWUsCiAgICAgICAgICAgIGNhbGxiYWNrOiBDYWxsYmFja0tpbmQuRVJST1IsCiAgICAgICAgICAgIGNhbGxiYWNrSWQ6IGRhdGEuY2FsbGJhY2tJZCwKICAgICAgICAgICAgcmVhc29uOiB3cmFwUmVhc29uKHJlYXNvbikKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRhdGEuc3RyZWFtSWQpIHsKICAgICAgICB0aGlzLl9jcmVhdGVTdHJlYW1TaW5rKGRhdGEpOwoKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGFjdGlvbihkYXRhLmRhdGEpOwogICAgfTsKCiAgICBjb21PYmouYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIHRoaXMuX29uQ29tT2JqT25NZXNzYWdlKTsKICB9CgogIG9uKGFjdGlvbk5hbWUsIGhhbmRsZXIpIHsKICAgIGNvbnN0IGFoID0gdGhpcy5hY3Rpb25IYW5kbGVyOwoKICAgIGlmIChhaFthY3Rpb25OYW1lXSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZXJlIGlzIGFscmVhZHkgYW4gYWN0aW9uTmFtZSBjYWxsZWQgIiR7YWN0aW9uTmFtZX0iYCk7CiAgICB9CgogICAgYWhbYWN0aW9uTmFtZV0gPSBoYW5kbGVyOwogIH0KCiAgc2VuZChhY3Rpb25OYW1lLCBkYXRhLCB0cmFuc2ZlcnMpIHsKICAgIHRoaXMuY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgc291cmNlTmFtZTogdGhpcy5zb3VyY2VOYW1lLAogICAgICB0YXJnZXROYW1lOiB0aGlzLnRhcmdldE5hbWUsCiAgICAgIGFjdGlvbjogYWN0aW9uTmFtZSwKICAgICAgZGF0YQogICAgfSwgdHJhbnNmZXJzKTsKICB9CgogIHNlbmRXaXRoUHJvbWlzZShhY3Rpb25OYW1lLCBkYXRhLCB0cmFuc2ZlcnMpIHsKICAgIGNvbnN0IGNhbGxiYWNrSWQgPSB0aGlzLmNhbGxiYWNrSWQrKzsKICAgIGNvbnN0IGNhcGFiaWxpdHkgPSAoMCwgX3V0aWwuY3JlYXRlUHJvbWlzZUNhcGFiaWxpdHkpKCk7CiAgICB0aGlzLmNhbGxiYWNrQ2FwYWJpbGl0aWVzW2NhbGxiYWNrSWRdID0gY2FwYWJpbGl0eTsKCiAgICB0cnkgewogICAgICB0aGlzLmNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgc291cmNlTmFtZTogdGhpcy5zb3VyY2VOYW1lLAogICAgICAgIHRhcmdldE5hbWU6IHRoaXMudGFyZ2V0TmFtZSwKICAgICAgICBhY3Rpb246IGFjdGlvbk5hbWUsCiAgICAgICAgY2FsbGJhY2tJZCwKICAgICAgICBkYXRhCiAgICAgIH0sIHRyYW5zZmVycyk7CiAgICB9IGNhdGNoIChleCkgewogICAgICBjYXBhYmlsaXR5LnJlamVjdChleCk7CiAgICB9CgogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9CgogIHNlbmRXaXRoU3RyZWFtKGFjdGlvbk5hbWUsIGRhdGEsIHF1ZXVlaW5nU3RyYXRlZ3ksIHRyYW5zZmVycykgewogICAgY29uc3Qgc3RyZWFtSWQgPSB0aGlzLnN0cmVhbUlkKyssCiAgICAgICAgICBzb3VyY2VOYW1lID0gdGhpcy5zb3VyY2VOYW1lLAogICAgICAgICAgdGFyZ2V0TmFtZSA9IHRoaXMudGFyZ2V0TmFtZSwKICAgICAgICAgIGNvbU9iaiA9IHRoaXMuY29tT2JqOwogICAgcmV0dXJuIG5ldyBSZWFkYWJsZVN0cmVhbSh7CiAgICAgIHN0YXJ0OiBjb250cm9sbGVyID0+IHsKICAgICAgICBjb25zdCBzdGFydENhcGFiaWxpdHkgPSAoMCwgX3V0aWwuY3JlYXRlUHJvbWlzZUNhcGFiaWxpdHkpKCk7CiAgICAgICAgdGhpcy5zdHJlYW1Db250cm9sbGVyc1tzdHJlYW1JZF0gPSB7CiAgICAgICAgICBjb250cm9sbGVyLAogICAgICAgICAgc3RhcnRDYWxsOiBzdGFydENhcGFiaWxpdHksCiAgICAgICAgICBwdWxsQ2FsbDogbnVsbCwKICAgICAgICAgIGNhbmNlbENhbGw6IG51bGwsCiAgICAgICAgICBpc0Nsb3NlZDogZmFsc2UKICAgICAgICB9OwogICAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBzb3VyY2VOYW1lLAogICAgICAgICAgdGFyZ2V0TmFtZSwKICAgICAgICAgIGFjdGlvbjogYWN0aW9uTmFtZSwKICAgICAgICAgIHN0cmVhbUlkLAogICAgICAgICAgZGF0YSwKICAgICAgICAgIGRlc2lyZWRTaXplOiBjb250cm9sbGVyLmRlc2lyZWRTaXplCiAgICAgICAgfSwgdHJhbnNmZXJzKTsKICAgICAgICByZXR1cm4gc3RhcnRDYXBhYmlsaXR5LnByb21pc2U7CiAgICAgIH0sCiAgICAgIHB1bGw6IGNvbnRyb2xsZXIgPT4gewogICAgICAgIGNvbnN0IHB1bGxDYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgICAgIHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdLnB1bGxDYWxsID0gcHVsbENhcGFiaWxpdHk7CiAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIHNvdXJjZU5hbWUsCiAgICAgICAgICB0YXJnZXROYW1lLAogICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLlBVTEwsCiAgICAgICAgICBzdHJlYW1JZCwKICAgICAgICAgIGRlc2lyZWRTaXplOiBjb250cm9sbGVyLmRlc2lyZWRTaXplCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHB1bGxDYXBhYmlsaXR5LnByb21pc2U7CiAgICAgIH0sCiAgICAgIGNhbmNlbDogcmVhc29uID0+IHsKICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KShyZWFzb24gaW5zdGFuY2VvZiBFcnJvciwgImNhbmNlbCBtdXN0IGhhdmUgYSB2YWxpZCByZWFzb24iKTsKICAgICAgICBjb25zdCBjYW5jZWxDYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgICAgIHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdLmNhbmNlbENhbGwgPSBjYW5jZWxDYXBhYmlsaXR5OwogICAgICAgIHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdLmlzQ2xvc2VkID0gdHJ1ZTsKICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgc291cmNlTmFtZSwKICAgICAgICAgIHRhcmdldE5hbWUsCiAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuQ0FOQ0VMLAogICAgICAgICAgc3RyZWFtSWQsCiAgICAgICAgICByZWFzb246IHdyYXBSZWFzb24ocmVhc29uKQogICAgICAgIH0pOwogICAgICAgIHJldHVybiBjYW5jZWxDYXBhYmlsaXR5LnByb21pc2U7CiAgICAgIH0KICAgIH0sIHF1ZXVlaW5nU3RyYXRlZ3kpOwogIH0KCiAgX2NyZWF0ZVN0cmVhbVNpbmsoZGF0YSkgewogICAgY29uc3Qgc3RyZWFtSWQgPSBkYXRhLnN0cmVhbUlkLAogICAgICAgICAgc291cmNlTmFtZSA9IHRoaXMuc291cmNlTmFtZSwKICAgICAgICAgIHRhcmdldE5hbWUgPSBkYXRhLnNvdXJjZU5hbWUsCiAgICAgICAgICBjb21PYmogPSB0aGlzLmNvbU9iajsKICAgIGNvbnN0IHNlbGYgPSB0aGlzLAogICAgICAgICAgYWN0aW9uID0gdGhpcy5hY3Rpb25IYW5kbGVyW2RhdGEuYWN0aW9uXTsKICAgIGNvbnN0IHN0cmVhbVNpbmsgPSB7CiAgICAgIGVucXVldWUoY2h1bmspIHsKICAgICAgICBsZXQgc2l6ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogMTsKICAgICAgICBsZXQgdHJhbnNmZXJzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CgogICAgICAgIGlmICh0aGlzLmlzQ2FuY2VsbGVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCBsYXN0RGVzaXJlZFNpemUgPSB0aGlzLmRlc2lyZWRTaXplOwogICAgICAgIHRoaXMuZGVzaXJlZFNpemUgLT0gc2l6ZTsKCiAgICAgICAgaWYgKGxhc3REZXNpcmVkU2l6ZSA+IDAgJiYgdGhpcy5kZXNpcmVkU2l6ZSA8PSAwKSB7CiAgICAgICAgICB0aGlzLnNpbmtDYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgICAgICAgdGhpcy5yZWFkeSA9IHRoaXMuc2lua0NhcGFiaWxpdHkucHJvbWlzZTsKICAgICAgICB9CgogICAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBzb3VyY2VOYW1lLAogICAgICAgICAgdGFyZ2V0TmFtZSwKICAgICAgICAgIHN0cmVhbTogU3RyZWFtS2luZC5FTlFVRVVFLAogICAgICAgICAgc3RyZWFtSWQsCiAgICAgICAgICBjaHVuawogICAgICAgIH0sIHRyYW5zZmVycyk7CiAgICAgIH0sCgogICAgICBjbG9zZSgpIHsKICAgICAgICBpZiAodGhpcy5pc0NhbmNlbGxlZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5pc0NhbmNlbGxlZCA9IHRydWU7CiAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIHNvdXJjZU5hbWUsCiAgICAgICAgICB0YXJnZXROYW1lLAogICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLkNMT1NFLAogICAgICAgICAgc3RyZWFtSWQKICAgICAgICB9KTsKICAgICAgICBkZWxldGUgc2VsZi5zdHJlYW1TaW5rc1tzdHJlYW1JZF07CiAgICAgIH0sCgogICAgICBlcnJvcihyZWFzb24pIHsKICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KShyZWFzb24gaW5zdGFuY2VvZiBFcnJvciwgImVycm9yIG11c3QgaGF2ZSBhIHZhbGlkIHJlYXNvbiIpOwoKICAgICAgICBpZiAodGhpcy5pc0NhbmNlbGxlZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5pc0NhbmNlbGxlZCA9IHRydWU7CiAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIHNvdXJjZU5hbWUsCiAgICAgICAgICB0YXJnZXROYW1lLAogICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLkVSUk9SLAogICAgICAgICAgc3RyZWFtSWQsCiAgICAgICAgICByZWFzb246IHdyYXBSZWFzb24ocmVhc29uKQogICAgICAgIH0pOwogICAgICB9LAoKICAgICAgc2lua0NhcGFiaWxpdHk6ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKSwKICAgICAgb25QdWxsOiBudWxsLAogICAgICBvbkNhbmNlbDogbnVsbCwKICAgICAgaXNDYW5jZWxsZWQ6IGZhbHNlLAogICAgICBkZXNpcmVkU2l6ZTogZGF0YS5kZXNpcmVkU2l6ZSwKICAgICAgcmVhZHk6IG51bGwKICAgIH07CiAgICBzdHJlYW1TaW5rLnNpbmtDYXBhYmlsaXR5LnJlc29sdmUoKTsKICAgIHN0cmVhbVNpbmsucmVhZHkgPSBzdHJlYW1TaW5rLnNpbmtDYXBhYmlsaXR5LnByb21pc2U7CiAgICB0aGlzLnN0cmVhbVNpbmtzW3N0cmVhbUlkXSA9IHN0cmVhbVNpbms7CiAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICByZXNvbHZlKGFjdGlvbihkYXRhLmRhdGEsIHN0cmVhbVNpbmspKTsKICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgIHNvdXJjZU5hbWUsCiAgICAgICAgdGFyZ2V0TmFtZSwKICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuU1RBUlRfQ09NUExFVEUsCiAgICAgICAgc3RyZWFtSWQsCiAgICAgICAgc3VjY2VzczogdHJ1ZQogICAgICB9KTsKICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICBzb3VyY2VOYW1lLAogICAgICAgIHRhcmdldE5hbWUsCiAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLlNUQVJUX0NPTVBMRVRFLAogICAgICAgIHN0cmVhbUlkLAogICAgICAgIHJlYXNvbjogd3JhcFJlYXNvbihyZWFzb24pCiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBfcHJvY2Vzc1N0cmVhbU1lc3NhZ2UoZGF0YSkgewogICAgY29uc3Qgc3RyZWFtSWQgPSBkYXRhLnN0cmVhbUlkLAogICAgICAgICAgc291cmNlTmFtZSA9IHRoaXMuc291cmNlTmFtZSwKICAgICAgICAgIHRhcmdldE5hbWUgPSBkYXRhLnNvdXJjZU5hbWUsCiAgICAgICAgICBjb21PYmogPSB0aGlzLmNvbU9iajsKICAgIGNvbnN0IHN0cmVhbUNvbnRyb2xsZXIgPSB0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXSwKICAgICAgICAgIHN0cmVhbVNpbmsgPSB0aGlzLnN0cmVhbVNpbmtzW3N0cmVhbUlkXTsKCiAgICBzd2l0Y2ggKGRhdGEuc3RyZWFtKSB7CiAgICAgIGNhc2UgU3RyZWFtS2luZC5TVEFSVF9DT01QTEVURToKICAgICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgICBzdHJlYW1Db250cm9sbGVyLnN0YXJ0Q2FsbC5yZXNvbHZlKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0cmVhbUNvbnRyb2xsZXIuc3RhcnRDYWxsLnJlamVjdCh3cmFwUmVhc29uKGRhdGEucmVhc29uKSk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgU3RyZWFtS2luZC5QVUxMX0NPTVBMRVRFOgogICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgIHN0cmVhbUNvbnRyb2xsZXIucHVsbENhbGwucmVzb2x2ZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdHJlYW1Db250cm9sbGVyLnB1bGxDYWxsLnJlamVjdCh3cmFwUmVhc29uKGRhdGEucmVhc29uKSk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgU3RyZWFtS2luZC5QVUxMOgogICAgICAgIGlmICghc3RyZWFtU2luaykgewogICAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgc291cmNlTmFtZSwKICAgICAgICAgICAgdGFyZ2V0TmFtZSwKICAgICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLlBVTExfQ09NUExFVEUsCiAgICAgICAgICAgIHN0cmVhbUlkLAogICAgICAgICAgICBzdWNjZXNzOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0cmVhbVNpbmsuZGVzaXJlZFNpemUgPD0gMCAmJiBkYXRhLmRlc2lyZWRTaXplID4gMCkgewogICAgICAgICAgc3RyZWFtU2luay5zaW5rQ2FwYWJpbGl0eS5yZXNvbHZlKCk7CiAgICAgICAgfQoKICAgICAgICBzdHJlYW1TaW5rLmRlc2lyZWRTaXplID0gZGF0YS5kZXNpcmVkU2l6ZTsKICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgcmVzb2x2ZShzdHJlYW1TaW5rLm9uUHVsbCAmJiBzdHJlYW1TaW5rLm9uUHVsbCgpKTsKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIHNvdXJjZU5hbWUsCiAgICAgICAgICAgIHRhcmdldE5hbWUsCiAgICAgICAgICAgIHN0cmVhbTogU3RyZWFtS2luZC5QVUxMX0NPTVBMRVRFLAogICAgICAgICAgICBzdHJlYW1JZCwKICAgICAgICAgICAgc3VjY2VzczogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgc291cmNlTmFtZSwKICAgICAgICAgICAgdGFyZ2V0TmFtZSwKICAgICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLlBVTExfQ09NUExFVEUsCiAgICAgICAgICAgIHN0cmVhbUlkLAogICAgICAgICAgICByZWFzb246IHdyYXBSZWFzb24ocmVhc29uKQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFN0cmVhbUtpbmQuRU5RVUVVRToKICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KShzdHJlYW1Db250cm9sbGVyLCAiZW5xdWV1ZSBzaG91bGQgaGF2ZSBzdHJlYW0gY29udHJvbGxlciIpOwoKICAgICAgICBpZiAoc3RyZWFtQ29udHJvbGxlci5pc0Nsb3NlZCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBzdHJlYW1Db250cm9sbGVyLmNvbnRyb2xsZXIuZW5xdWV1ZShkYXRhLmNodW5rKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgU3RyZWFtS2luZC5DTE9TRToKICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KShzdHJlYW1Db250cm9sbGVyLCAiY2xvc2Ugc2hvdWxkIGhhdmUgc3RyZWFtIGNvbnRyb2xsZXIiKTsKCiAgICAgICAgaWYgKHN0cmVhbUNvbnRyb2xsZXIuaXNDbG9zZWQpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgc3RyZWFtQ29udHJvbGxlci5pc0Nsb3NlZCA9IHRydWU7CiAgICAgICAgc3RyZWFtQ29udHJvbGxlci5jb250cm9sbGVyLmNsb3NlKCk7CgogICAgICAgIHRoaXMuX2RlbGV0ZVN0cmVhbUNvbnRyb2xsZXIoc3RyZWFtQ29udHJvbGxlciwgc3RyZWFtSWQpOwoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgU3RyZWFtS2luZC5FUlJPUjoKICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KShzdHJlYW1Db250cm9sbGVyLCAiZXJyb3Igc2hvdWxkIGhhdmUgc3RyZWFtIGNvbnRyb2xsZXIiKTsKICAgICAgICBzdHJlYW1Db250cm9sbGVyLmNvbnRyb2xsZXIuZXJyb3Iod3JhcFJlYXNvbihkYXRhLnJlYXNvbikpOwoKICAgICAgICB0aGlzLl9kZWxldGVTdHJlYW1Db250cm9sbGVyKHN0cmVhbUNvbnRyb2xsZXIsIHN0cmVhbUlkKTsKCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFN0cmVhbUtpbmQuQ0FOQ0VMX0NPTVBMRVRFOgogICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgIHN0cmVhbUNvbnRyb2xsZXIuY2FuY2VsQ2FsbC5yZXNvbHZlKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0cmVhbUNvbnRyb2xsZXIuY2FuY2VsQ2FsbC5yZWplY3Qod3JhcFJlYXNvbihkYXRhLnJlYXNvbikpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5fZGVsZXRlU3RyZWFtQ29udHJvbGxlcihzdHJlYW1Db250cm9sbGVyLCBzdHJlYW1JZCk7CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBTdHJlYW1LaW5kLkNBTkNFTDoKICAgICAgICBpZiAoIXN0cmVhbVNpbmspIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgIHJlc29sdmUoc3RyZWFtU2luay5vbkNhbmNlbCAmJiBzdHJlYW1TaW5rLm9uQ2FuY2VsKHdyYXBSZWFzb24oZGF0YS5yZWFzb24pKSk7CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBzb3VyY2VOYW1lLAogICAgICAgICAgICB0YXJnZXROYW1lLAogICAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuQ0FOQ0VMX0NPTVBMRVRFLAogICAgICAgICAgICBzdHJlYW1JZCwKICAgICAgICAgICAgc3VjY2VzczogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgc291cmNlTmFtZSwKICAgICAgICAgICAgdGFyZ2V0TmFtZSwKICAgICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLkNBTkNFTF9DT01QTEVURSwKICAgICAgICAgICAgc3RyZWFtSWQsCiAgICAgICAgICAgIHJlYXNvbjogd3JhcFJlYXNvbihyZWFzb24pCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICBzdHJlYW1TaW5rLnNpbmtDYXBhYmlsaXR5LnJlamVjdCh3cmFwUmVhc29uKGRhdGEucmVhc29uKSk7CiAgICAgICAgc3RyZWFtU2luay5pc0NhbmNlbGxlZCA9IHRydWU7CiAgICAgICAgZGVsZXRlIHRoaXMuc3RyZWFtU2lua3Nbc3RyZWFtSWRdOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgc3RyZWFtIGNhc2UiKTsKICAgIH0KICB9CgogIGFzeW5jIF9kZWxldGVTdHJlYW1Db250cm9sbGVyKHN0cmVhbUNvbnRyb2xsZXIsIHN0cmVhbUlkKSB7CiAgICBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoW3N0cmVhbUNvbnRyb2xsZXIuc3RhcnRDYWxsICYmIHN0cmVhbUNvbnRyb2xsZXIuc3RhcnRDYWxsLnByb21pc2UsIHN0cmVhbUNvbnRyb2xsZXIucHVsbENhbGwgJiYgc3RyZWFtQ29udHJvbGxlci5wdWxsQ2FsbC5wcm9taXNlLCBzdHJlYW1Db250cm9sbGVyLmNhbmNlbENhbGwgJiYgc3RyZWFtQ29udHJvbGxlci5jYW5jZWxDYWxsLnByb21pc2VdKTsKICAgIGRlbGV0ZSB0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXTsKICB9CgogIGRlc3Ryb3koKSB7CiAgICB0aGlzLmNvbU9iai5yZW1vdmVFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgdGhpcy5fb25Db21PYmpPbk1lc3NhZ2UpOwogIH0KCn0KCmV4cG9ydHMuTWVzc2FnZUhhbmRsZXIgPSBNZXNzYWdlSGFuZGxlcjsKCi8qKiovIH0pLAovKiAyMjggKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlBERldvcmtlclN0cmVhbSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpjbGFzcyBQREZXb3JrZXJTdHJlYW0gewogIGNvbnN0cnVjdG9yKG1zZ0hhbmRsZXIpIHsKICAgIHRoaXMuX21zZ0hhbmRsZXIgPSBtc2dIYW5kbGVyOwogICAgdGhpcy5fY29udGVudExlbmd0aCA9IG51bGw7CiAgICB0aGlzLl9mdWxsUmVxdWVzdFJlYWRlciA9IG51bGw7CiAgICB0aGlzLl9yYW5nZVJlcXVlc3RSZWFkZXJzID0gW107CiAgfQoKICBnZXRGdWxsUmVhZGVyKCkgewogICAgKDAsIF91dGlsLmFzc2VydCkoIXRoaXMuX2Z1bGxSZXF1ZXN0UmVhZGVyLCAiUERGV29ya2VyU3RyZWFtLmdldEZ1bGxSZWFkZXIgY2FuIG9ubHkgYmUgY2FsbGVkIG9uY2UuIik7CiAgICB0aGlzLl9mdWxsUmVxdWVzdFJlYWRlciA9IG5ldyBQREZXb3JrZXJTdHJlYW1SZWFkZXIodGhpcy5fbXNnSGFuZGxlcik7CiAgICByZXR1cm4gdGhpcy5fZnVsbFJlcXVlc3RSZWFkZXI7CiAgfQoKICBnZXRSYW5nZVJlYWRlcihiZWdpbiwgZW5kKSB7CiAgICBjb25zdCByZWFkZXIgPSBuZXcgUERGV29ya2VyU3RyZWFtUmFuZ2VSZWFkZXIoYmVnaW4sIGVuZCwgdGhpcy5fbXNnSGFuZGxlcik7CgogICAgdGhpcy5fcmFuZ2VSZXF1ZXN0UmVhZGVycy5wdXNoKHJlYWRlcik7CgogICAgcmV0dXJuIHJlYWRlcjsKICB9CgogIGNhbmNlbEFsbFJlcXVlc3RzKHJlYXNvbikgewogICAgaWYgKHRoaXMuX2Z1bGxSZXF1ZXN0UmVhZGVyKSB7CiAgICAgIHRoaXMuX2Z1bGxSZXF1ZXN0UmVhZGVyLmNhbmNlbChyZWFzb24pOwogICAgfQoKICAgIGZvciAoY29uc3QgcmVhZGVyIG9mIHRoaXMuX3JhbmdlUmVxdWVzdFJlYWRlcnMuc2xpY2UoMCkpIHsKICAgICAgcmVhZGVyLmNhbmNlbChyZWFzb24pOwogICAgfQogIH0KCn0KCmV4cG9ydHMuUERGV29ya2VyU3RyZWFtID0gUERGV29ya2VyU3RyZWFtOwoKY2xhc3MgUERGV29ya2VyU3RyZWFtUmVhZGVyIHsKICBjb25zdHJ1Y3Rvcihtc2dIYW5kbGVyKSB7CiAgICB0aGlzLl9tc2dIYW5kbGVyID0gbXNnSGFuZGxlcjsKICAgIHRoaXMub25Qcm9ncmVzcyA9IG51bGw7CiAgICB0aGlzLl9jb250ZW50TGVuZ3RoID0gbnVsbDsKICAgIHRoaXMuX2lzUmFuZ2VTdXBwb3J0ZWQgPSBmYWxzZTsKICAgIHRoaXMuX2lzU3RyZWFtaW5nU3VwcG9ydGVkID0gZmFsc2U7CgogICAgY29uc3QgcmVhZGFibGVTdHJlYW0gPSB0aGlzLl9tc2dIYW5kbGVyLnNlbmRXaXRoU3RyZWFtKCJHZXRSZWFkZXIiKTsKCiAgICB0aGlzLl9yZWFkZXIgPSByZWFkYWJsZVN0cmVhbS5nZXRSZWFkZXIoKTsKICAgIHRoaXMuX2hlYWRlcnNSZWFkeSA9IHRoaXMuX21zZ0hhbmRsZXIuc2VuZFdpdGhQcm9taXNlKCJSZWFkZXJIZWFkZXJzUmVhZHkiKS50aGVuKGRhdGEgPT4gewogICAgICB0aGlzLl9pc1N0cmVhbWluZ1N1cHBvcnRlZCA9IGRhdGEuaXNTdHJlYW1pbmdTdXBwb3J0ZWQ7CiAgICAgIHRoaXMuX2lzUmFuZ2VTdXBwb3J0ZWQgPSBkYXRhLmlzUmFuZ2VTdXBwb3J0ZWQ7CiAgICAgIHRoaXMuX2NvbnRlbnRMZW5ndGggPSBkYXRhLmNvbnRlbnRMZW5ndGg7CiAgICB9KTsKICB9CgogIGdldCBoZWFkZXJzUmVhZHkoKSB7CiAgICByZXR1cm4gdGhpcy5faGVhZGVyc1JlYWR5OwogIH0KCiAgZ2V0IGNvbnRlbnRMZW5ndGgoKSB7CiAgICByZXR1cm4gdGhpcy5fY29udGVudExlbmd0aDsKICB9CgogIGdldCBpc1N0cmVhbWluZ1N1cHBvcnRlZCgpIHsKICAgIHJldHVybiB0aGlzLl9pc1N0cmVhbWluZ1N1cHBvcnRlZDsKICB9CgogIGdldCBpc1JhbmdlU3VwcG9ydGVkKCkgewogICAgcmV0dXJuIHRoaXMuX2lzUmFuZ2VTdXBwb3J0ZWQ7CiAgfQoKICBhc3luYyByZWFkKCkgewogICAgY29uc3QgewogICAgICB2YWx1ZSwKICAgICAgZG9uZQogICAgfSA9IGF3YWl0IHRoaXMuX3JlYWRlci5yZWFkKCk7CgogICAgaWYgKGRvbmUpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB2YWx1ZTogdW5kZWZpbmVkLAogICAgICAgIGRvbmU6IHRydWUKICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICB2YWx1ZTogdmFsdWUuYnVmZmVyLAogICAgICBkb25lOiBmYWxzZQogICAgfTsKICB9CgogIGNhbmNlbChyZWFzb24pIHsKICAgIHRoaXMuX3JlYWRlci5jYW5jZWwocmVhc29uKTsKICB9Cgp9CgpjbGFzcyBQREZXb3JrZXJTdHJlYW1SYW5nZVJlYWRlciB7CiAgY29uc3RydWN0b3IoYmVnaW4sIGVuZCwgbXNnSGFuZGxlcikgewogICAgdGhpcy5fbXNnSGFuZGxlciA9IG1zZ0hhbmRsZXI7CiAgICB0aGlzLm9uUHJvZ3Jlc3MgPSBudWxsOwoKICAgIGNvbnN0IHJlYWRhYmxlU3RyZWFtID0gdGhpcy5fbXNnSGFuZGxlci5zZW5kV2l0aFN0cmVhbSgiR2V0UmFuZ2VSZWFkZXIiLCB7CiAgICAgIGJlZ2luLAogICAgICBlbmQKICAgIH0pOwoKICAgIHRoaXMuX3JlYWRlciA9IHJlYWRhYmxlU3RyZWFtLmdldFJlYWRlcigpOwogIH0KCiAgZ2V0IGlzU3RyZWFtaW5nU3VwcG9ydGVkKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgYXN5bmMgcmVhZCgpIHsKICAgIGNvbnN0IHsKICAgICAgdmFsdWUsCiAgICAgIGRvbmUKICAgIH0gPSBhd2FpdCB0aGlzLl9yZWFkZXIucmVhZCgpOwoKICAgIGlmIChkb25lKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCwKICAgICAgICBkb25lOiB0cnVlCiAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgdmFsdWU6IHZhbHVlLmJ1ZmZlciwKICAgICAgZG9uZTogZmFsc2UKICAgIH07CiAgfQoKICBjYW5jZWwocmVhc29uKSB7CiAgICB0aGlzLl9yZWFkZXIuY2FuY2VsKHJlYXNvbik7CiAgfQoKfQoKLyoqKi8gfSkKLyoqKioqKi8gCV0pOwovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9OwovKioqKioqLyAJCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193X3BkZmpzX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCXZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdOwovKioqKioqLyAJCWlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkgewovKioqKioqLyAJCQlyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAkJfQovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCS8vIG5vIG1vZHVsZS5pZCBuZWVkZWQKLyoqKioqKi8gCQkJLy8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWQKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJX193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXyk7Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8gCQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJLyogd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzICovCi8qKioqKiovIAkoKCkgPT4gewovKioqKioqLyAJCS8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHMKLyoqKioqKi8gCQlfX3dfcGRmanNfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4gewovKioqKioqLyAJCQlmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7Ci8qKioqKiovIAkJCQlpZihfX3dfcGRmanNfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193X3BkZmpzX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHsKLyoqKioqKi8gCQkJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pOwovKioqKioqLyAJCQkJfQovKioqKioqLyAJCQl9Ci8qKioqKiovIAkJfTsKLyoqKioqKi8gCX0pKCk7Ci8qKioqKiovIAkKLyoqKioqKi8gCS8qIHdlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQgKi8KLyoqKioqKi8gCSgoKSA9PiB7Ci8qKioqKiovIAkJX193X3BkZmpzX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKQovKioqKioqLyAJfSkoKTsKLyoqKioqKi8gCQovKioqKioqLyAJLyogd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCAqLwovKioqKioqLyAJKCgpID0+IHsKLyoqKioqKi8gCQkvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzCi8qKioqKiovIAkJX193X3BkZmpzX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHsKLyoqKioqKi8gCQkJaWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7Ci8qKioqKiovIAkJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTsKLyoqKioqKi8gCQkJfQovKioqKioqLyAJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pOwovKioqKioqLyAJCX07Ci8qKioqKiovIAl9KSgpOwovKioqKioqLyAJCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0ge307Ci8vIFRoaXMgZW50cnkgbmVlZCB0byBiZSB3cmFwcGVkIGluIGFuIElJRkUgYmVjYXVzZSBpdCBuZWVkIHRvIGJlIGluIHN0cmljdCBtb2RlLgooKCkgPT4gewoidXNlIHN0cmljdCI7CnZhciBleHBvcnRzID0gX193ZWJwYWNrX2V4cG9ydHNfXzsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJXb3JrZXJNZXNzYWdlSGFuZGxlciIsICh7CiAgZW51bWVyYWJsZTogdHJ1ZSwKICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBfd29ya2VyLldvcmtlck1lc3NhZ2VIYW5kbGVyOwogIH0KfSkpOwoKdmFyIF93b3JrZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEpOwoKY29uc3QgcGRmanNWZXJzaW9uID0gJzIuMTYuMTA1JzsKY29uc3QgcGRmanNCdWlsZCA9ICcxNzJjY2RiZTUnOwp9KSgpOwoKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfZXhwb3J0c19fOwovKioqKioqLyB9KSgpCjsKfSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXBkZi53b3JrZXIuanMubWFw",typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:_documentCurrentScript&&_documentCurrentScript.tagName.toUpperCase()==="SCRIPT"&&_documentCurrentScript.src||new URL("index.umd.js",document.baseURI).href).toString();class DesmyPDFReader extends React2.Component{canvasRef=React2.createRef();state={pdf:null,currentPage:1,totalPages:0,scale:1.5,isLoading:!1};componentDidMount(){this.setupWorker(),this.loadDocument(this.props.src)}componentDidUpdate(A,l){A.src!==this.props.src?this.loadDocument(this.props.src):(l.currentPage!==this.state.currentPage||l.scale!==this.state.scale)&&this.renderPage(this.state.currentPage)}setupWorker=()=>{pdfExports.GlobalWorkerOptions.workerSrc=workerSrc};loadDocument=async A=>{if(A){this.setState({isLoading:!0});try{let l;if(typeof A=="string"){const a=await fetch(A);if(!a.ok)throw new Error(`Failed to fetch PDF: ${a.status} ${a.statusText}`);const n=await a.arrayBuffer();l=new Uint8Array(n)}else if(A instanceof File){const a=await A.arrayBuffer();l=new Uint8Array(a)}else return;const t=await pdfExports.getDocument({data:l}).promise;this.setState({pdf:t,totalPages:t.numPages,currentPage:1},()=>{this.renderPage(1)})}catch(l){console.error("Error loading PDF:",l),alert("Failed to load PDF. Please ensure it is a valid file or URL."),this.setState({isLoading:!1})}}};renderPage=async A=>{const{pdf:l,scale:o}=this.state;if(l){this.setState({isLoading:!0});try{const t=await l.getPage(A),a=t.getViewport({scale:o}),n=this.canvasRef.current;if(!n)return;const B=n.getContext("2d");n.height=a.height,n.width=a.width,await t.render({canvasContext:B,viewport:a}).promise}catch(t){console.error("Error rendering page:",t)}finally{this.setState({isLoading:!1})}}};goToPrevPage=()=>{this.setState(A=>({currentPage:Math.max(A.currentPage-1,1)}))};goToNextPage=()=>{this.setState(A=>({currentPage:Math.min(A.currentPage+1,A.totalPages)}))};zoomIn=()=>{this.setState(A=>({scale:Math.min(A.scale+.25,3)}))};zoomOut=()=>{this.setState(A=>({scale:Math.max(A.scale-.25,.5)}))};render(){const{className:A}=this.props,{currentPage:l,totalPages:o,scale:t,isLoading:a}=this.state;return jsxRuntimeExports.jsxs("div",{className:A,style:{position:"relative"},children:[a&&jsxRuntimeExports.jsx("div",{style:{position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",zIndex:10,background:"rgba(255,255,255,0.9)",padding:"0.5rem 1rem",borderRadius:"6px",fontSize:"1rem",fontWeight:500},children:"Loading..."}),jsxRuntimeExports.jsx("canvas",{ref:this.canvasRef,style:{width:"100%",opacity:a?.4:1}})]})}}const DesmyThemeContext=React2.createContext({theme:"light",toggleTheme:()=>{}});class DesmyCommons{getFileSize(A){let l=A.size;const o=["Bytes","KB","MB","GB"];let t=0;for(;l>900;)l/=1024,t++;return`${Math.round(l*100)/100} ${o[t]}`}getExtension(A){return A.split(".").pop()}getFileName(A){return A.split("/").pop()}isValidHttpUrl(A){let l;try{l=new URL(A)}catch{return!1}return/https?/.test(l.protocol)}makeUniqueid(A=10){let l="";const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=o.length;for(let a=0;a<A;a++)l+=o.charAt(Math.floor(Math.random()*t));return l}nameToText(A){return A.split("_").join(" ")}getRandomColor(){const A="0123456789ABCDEF";let l="#";for(let o=0;o<6;o++)l+=A[Math.floor(Math.random()*16)];return l}toSentenceCase=A=>A.toLowerCase().replace(/_/g," ").replace(/(?:^|\s)\S/g,l=>l.toUpperCase());generateKey=()=>Math.floor(Math.random()*100)+1;concat(A,l){return`${A} ${l}`}isObject(A){return typeof A=="object"&&A!==null&&!Array.isArray(A)&&!(A instanceof File)}isEmptyOrNull(A,l=!1){if(A==null)return!0;if(Array.isArray(A))return A.length===0;if(typeof A=="object"&&!Array.isArray(A)&&!(A instanceof File)){const o=Object.keys(A);return o.length===0?!0:l?o.every(t=>{const a=A[t];return typeof a=="string"?a.trim()==="":typeof a=="boolean"?a===!1:typeof a=="number"?a===0:Array.isArray(a)?a.length===0:a instanceof File?a.size===0:typeof a=="object"&&a!==null?Object.keys(a).length===0:a==null}):!o.some(t=>{const a=A[t];return typeof a=="string"?a.trim()!=="":typeof a=="boolean"?a===!0:typeof a=="number"?a!==0:Array.isArray(a)?a.length!==0:a instanceof File?a.size!==0:typeof a=="object"&&a!==null?Object.keys(a).length!==0:a!=null})}return A instanceof File?A.size===0:A===""}toBoolean(A){return String(A).toLowerCase()==="true"}toStringDefault(A,l=""){return this.isEmptyOrNull(A)?`${l}`:`${A}`}getDefaultValue=A=>A&&typeof A=="object"&&"id"in A?String(A.id):this.toStringDefault(A,"");toString(A){return`${A}`}isEmpty(A){return A===""||A===void 0||A===null}validatePasswords(A,l){return A!==""&&A===l}isValidDate(A){const l=typeof A=="string"?new Date(A):A;return!isNaN(l.getTime())}validatePassword(A){const l=/[A-Z]/.test(A),o=/[a-z]/.test(A),t=/\d/.test(A),a=/[~`!#@$%^&*+=\-[\]\\';,/{}|\\":<>?]/.test(A),n=A.length>=8;return{hasUppercase:l,hasLowercase:o,hasNumber:t,hasSpecialCharacter:a,has8Characters:n,allValidationsPassed:l&&o&&t&&a&&n}}isNotEmpty(A){return A!==""}columnHead(A){let l=A.split("_");return l.length>1&&l.slice(-1)[0].toLowerCase()?l.slice(0,-1).join(" ").toUpperCase():l.join(" ").toUpperCase()}convertUnderscoreToSpaceString(A){return A.replace(/_/g," ")}isDarkTheme(){return localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches}forceTheme(A){A==="dark"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light"))}async syncTheme(A){const l=window.matchMedia("(prefers-color-scheme: dark)").matches,o=localStorage.getItem("color-theme"),t=o?o==="dark":l;this.forceTheme(t?"dark":"light"),this.listenForSystemThemeChanges(),A&&A(t)}listenForSystemThemeChanges(){const A=window.matchMedia("(prefers-color-scheme: dark)"),l=o=>{const t=o.matches;this.forceTheme(t?"dark":"light")};A.addEventListener("change",l)}async imageSize(A){return new Promise((l,o)=>{try{const t=new FileReader;t.onload=()=>{const a=new Image;a.onload=()=>{l({width:a.width,height:a.height})},a.src=t.result},t.onerror=a=>{o(a)},t.readAsDataURL(A)}catch(t){o(t)}})}capitalizeEachWord(A){return A.toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")}formatDateString(A){const l=A.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!l)throw new Error("Invalid date format. Please provide date in dd/mm/yyyy format.");const[,o,t,a]=l;return`${a}-${t}-${o}`}formatDate(A){const l=new Date(A),o=l.getFullYear(),t=String(l.getMonth()+1).padStart(2,"0"),a=String(l.getDate()).padStart(2,"0");return`${o}-${t}-${a}`}validateEmail=A=>{const l=A.indexOf("@"),o=A.lastIndexOf(".");if(l<=0||l===A.length-1||o<l+2||o===A.length-1)return!1;const t=A.slice(l+1,o);return!(!t||t.includes("@")||t.includes(" ")||A.slice(o+1).length<2)};convertNumber(A){return Math.abs(A)>=1e6?(A/1e6).toString().substring(0,4)+"M":Math.abs(A)>=1e3?(A/1e3).toString().substring(0,4)+"k":A.toString()}daysLeft(A){const l=new Date(A),o=new Date,t=l.getTime()-o.getTime();return Math.ceil(t/(1e3*3600*24))}formatDateToCustomFormat(A){const o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][A.getDay()],t=A.getDate(),n=["January","February","March","April","May","June","July","August","September","October","November","December"][A.getMonth()],B=A.getFullYear();function R(H){if(H>=11&&H<=13)return"th";switch(H%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}const r=R(t);return`${o}, ${t}${r} ${n}, ${B}`}getTimeAgoAndCustomDate(A){const l=new Date,o=new Date(A),t=l.getTime()-o.getTime();if(l<o)return"Future date";const a=Math.floor(t/1e3);return a<60?`${a} seconds ago`:a<3600?`${Math.floor(a/60)} minutes ago`:a<86400?`${Math.floor(a/3600)} hours ago`:a<2592e3?`${Math.floor(a/86400)} days ago`:o.toLocaleString("en-US",{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"})}roundTo2dp(A){const l=parseFloat(A);return isNaN(l)?A:(Math.round(l*100)/100).toFixed(2)}getParamUrl(A){const l=window.location.pathname.split("/"),o=l.indexOf(A);return o!==-1&&o+1<l.length?l[o+1]:""}}const DesmyCommons$1=new DesmyCommons;class DesmyThemeProvider extends React2.Component{constructor(A){super(A);const l=localStorage.getItem("color-theme")||"light";this.state={theme:l},this.syncTheme()}toggleTheme=()=>{this.setState(A=>({theme:A.theme==="light"?"dark":"light"}),()=>{DesmyCommons$1.forceTheme(this.state.theme)})};syncTheme=()=>{const A=window.matchMedia("(prefers-color-scheme: dark)").matches,l=localStorage.getItem("color-theme"),t=l==="dark"||l==="light"?l==="dark":A;DesmyCommons$1.forceTheme(t?"dark":"light"),DesmyCommons$1.listenForSystemThemeChanges()};render(){const{theme:A}=this.state,{children:l}=this.props;return jsxRuntimeExports.jsx(DesmyThemeContext.Provider,{value:{theme:A,toggleTheme:this.toggleTheme},children:l})}}var dist={},hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1,Object.defineProperty(dist,"__esModule",{value:!0}),dist.parse=n,dist.serialize=r;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,A=/^[\u0021-\u003A\u003C-\u007E]*$/,l=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,o=/^[\u0020-\u003A\u003D-\u007E]*$/,t=Object.prototype.toString,a=(()=>{const k=function(){};return k.prototype=Object.create(null),k})();function n(k,iI){const lI=new a,CI=k.length;if(CI<2)return lI;const sI=iI?.decode||H;let oI=0;do{const E=k.indexOf("=",oI);if(E===-1)break;const _=k.indexOf(";",oI),gI=_===-1?CI:_;if(E>gI){oI=k.lastIndexOf(";",E-1)+1;continue}const M=B(k,oI,E),O=R(k,E,M),dI=k.slice(M,O);if(lI[dI]===void 0){let eI=B(k,E+1,gI),aI=R(k,gI,eI);const WI=sI(k.slice(eI,aI));lI[dI]=WI}oI=gI+1}while(oI<CI);return lI}function B(k,iI,lI){do{const CI=k.charCodeAt(iI);if(CI!==32&&CI!==9)return iI}while(++iI<lI);return lI}function R(k,iI,lI){for(;iI>lI;){const CI=k.charCodeAt(--iI);if(CI!==32&&CI!==9)return iI+1}return lI}function r(k,iI,lI){const CI=lI?.encode||encodeURIComponent;if(!e.test(k))throw new TypeError(`argument name is invalid: ${k}`);const sI=CI(iI);if(!A.test(sI))throw new TypeError(`argument val is invalid: ${iI}`);let oI=k+"="+sI;if(!lI)return oI;if(lI.maxAge!==void 0){if(!Number.isInteger(lI.maxAge))throw new TypeError(`option maxAge is invalid: ${lI.maxAge}`);oI+="; Max-Age="+lI.maxAge}if(lI.domain){if(!l.test(lI.domain))throw new TypeError(`option domain is invalid: ${lI.domain}`);oI+="; Domain="+lI.domain}if(lI.path){if(!o.test(lI.path))throw new TypeError(`option path is invalid: ${lI.path}`);oI+="; Path="+lI.path}if(lI.expires){if(!II(lI.expires)||!Number.isFinite(lI.expires.valueOf()))throw new TypeError(`option expires is invalid: ${lI.expires}`);oI+="; Expires="+lI.expires.toUTCString()}if(lI.httpOnly&&(oI+="; HttpOnly"),lI.secure&&(oI+="; Secure"),lI.partitioned&&(oI+="; Partitioned"),lI.priority)switch(typeof lI.priority=="string"?lI.priority.toLowerCase():void 0){case"low":oI+="; Priority=Low";break;case"medium":oI+="; Priority=Medium";break;case"high":oI+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${lI.priority}`)}if(lI.sameSite)switch(typeof lI.sameSite=="string"?lI.sameSite.toLowerCase():lI.sameSite){case!0:case"strict":oI+="; SameSite=Strict";break;case"lax":oI+="; SameSite=Lax";break;case"none":oI+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${lI.sameSite}`)}return oI}function H(k){if(k.indexOf("%")===-1)return k;try{return decodeURIComponent(k)}catch{return k}}function II(k){return t.call(k)==="[object Date]"}return dist}requireDist();/**
 * react-router v7.5.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function invariant(e,A){if(e===!1||e===null||typeof e>"u")throw new Error(A)}function warning(e,A){if(!e){typeof console<"u"&&console.warn(A);try{throw new Error(A)}catch{}}}function createPath({pathname:e="/",search:A="",hash:l=""}){return A&&A!=="?"&&(e+=A.charAt(0)==="?"?A:"?"+A),l&&l!=="#"&&(e+=l.charAt(0)==="#"?l:"#"+l),e}function parsePath(e){let A={};if(e){let l=e.indexOf("#");l>=0&&(A.hash=e.substring(l),e=e.substring(0,l));let o=e.indexOf("?");o>=0&&(A.search=e.substring(o),e=e.substring(0,o)),e&&(A.pathname=e)}return A}function matchRoutes(e,A,l="/"){return matchRoutesImpl(e,A,l,!1)}function matchRoutesImpl(e,A,l,o){let t=typeof A=="string"?parsePath(A):A,a=stripBasename(t.pathname||"/",l);if(a==null)return null;let n=flattenRoutes(e);rankRouteBranches(n);let B=null;for(let R=0;B==null&&R<n.length;++R){let r=decodePath(a);B=matchRouteBranch(n[R],r,o)}return B}function flattenRoutes(e,A=[],l=[],o=""){let t=(a,n,B)=>{let R={relativePath:B===void 0?a.path||"":B,caseSensitive:a.caseSensitive===!0,childrenIndex:n,route:a};R.relativePath.startsWith("/")&&(invariant(R.relativePath.startsWith(o),`Absolute route path "${R.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),R.relativePath=R.relativePath.slice(o.length));let r=joinPaths([o,R.relativePath]),H=l.concat(R);a.children&&a.children.length>0&&(invariant(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${r}".`),flattenRoutes(a.children,A,H,r)),!(a.path==null&&!a.index)&&A.push({path:r,score:computeScore(r,a.index),routesMeta:H})};return e.forEach((a,n)=>{if(a.path===""||!a.path?.includes("?"))t(a,n);else for(let B of explodeOptionalSegments(a.path))t(a,n,B)}),A}function explodeOptionalSegments(e){let A=e.split("/");if(A.length===0)return[];let[l,...o]=A,t=l.endsWith("?"),a=l.replace(/\?$/,"");if(o.length===0)return t?[a,""]:[a];let n=explodeOptionalSegments(o.join("/")),B=[];return B.push(...n.map(R=>R===""?a:[a,R].join("/"))),t&&B.push(...n),B.map(R=>e.startsWith("/")&&R===""?"/":R)}function rankRouteBranches(e){e.sort((A,l)=>A.score!==l.score?l.score-A.score:compareIndexes(A.routesMeta.map(o=>o.childrenIndex),l.routesMeta.map(o=>o.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,A){let l=e.split("/"),o=l.length;return l.some(isSplat)&&(o+=splatPenalty),A&&(o+=indexRouteValue),l.filter(t=>!isSplat(t)).reduce((t,a)=>t+(paramRe.test(a)?dynamicSegmentValue:a===""?emptySegmentValue:staticSegmentValue),o)}function compareIndexes(e,A){return e.length===A.length&&e.slice(0,-1).every((o,t)=>o===A[t])?e[e.length-1]-A[A.length-1]:0}function matchRouteBranch(e,A,l=!1){let{routesMeta:o}=e,t={},a="/",n=[];for(let B=0;B<o.length;++B){let R=o[B],r=B===o.length-1,H=a==="/"?A:A.slice(a.length)||"/",II=matchPath({path:R.relativePath,caseSensitive:R.caseSensitive,end:r},H),k=R.route;if(!II&&r&&l&&!o[o.length-1].route.index&&(II=matchPath({path:R.relativePath,caseSensitive:R.caseSensitive,end:!1},H)),!II)return null;Object.assign(t,II.params),n.push({params:t,pathname:joinPaths([a,II.pathname]),pathnameBase:normalizePathname(joinPaths([a,II.pathnameBase])),route:k}),II.pathnameBase!=="/"&&(a=joinPaths([a,II.pathnameBase]))}return n}function matchPath(e,A){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[l,o]=compilePath(e.path,e.caseSensitive,e.end),t=A.match(l);if(!t)return null;let a=t[0],n=a.replace(/(.)\/+$/,"$1"),B=t.slice(1);return{params:o.reduce((r,{paramName:H,isOptional:II},k)=>{if(H==="*"){let lI=B[k]||"";n=a.slice(0,a.length-lI.length).replace(/(.)\/+$/,"$1")}const iI=B[k];return II&&!iI?r[H]=void 0:r[H]=(iI||"").replace(/%2F/g,"/"),r},{}),pathname:a,pathnameBase:n,pattern:e}}function compilePath(e,A=!1,l=!0){warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let o=[],t="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(n,B,R)=>(o.push({paramName:B,isOptional:R!=null}),R?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(o.push({paramName:"*"}),t+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):l?t+="\\/*$":e!==""&&e!=="/"&&(t+="(?:(?=\\/|$))"),[new RegExp(t,A?void 0:"i"),o]}function decodePath(e){try{return e.split("/").map(A=>decodeURIComponent(A).replace(/\//g,"%2F")).join("/")}catch(A){return warning(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${A}).`),e}}function stripBasename(e,A){if(A==="/")return e;if(!e.toLowerCase().startsWith(A.toLowerCase()))return null;let l=A.endsWith("/")?A.length-1:A.length,o=e.charAt(l);return o&&o!=="/"?null:e.slice(l)||"/"}function resolvePath(e,A="/"){let{pathname:l,search:o="",hash:t=""}=typeof e=="string"?parsePath(e):e;return{pathname:l?l.startsWith("/")?l:resolvePathname(l,A):A,search:normalizeSearch(o),hash:normalizeHash(t)}}function resolvePathname(e,A){let l=A.replace(/\/+$/,"").split("/");return e.split("/").forEach(t=>{t===".."?l.length>1&&l.pop():t!=="."&&l.push(t)}),l.length>1?l.join("/"):"/"}function getInvalidPathError(e,A,l,o){return`Cannot include a '${e}' character in a manually specified \`to.${A}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${l}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(e){return e.filter((A,l)=>l===0||A.route.path&&A.route.path.length>0)}function getResolveToMatches(e){let A=getPathContributingMatches(e);return A.map((l,o)=>o===A.length-1?l.pathname:l.pathnameBase)}function resolveTo(e,A,l,o=!1){let t;typeof e=="string"?t=parsePath(e):(t={...e},invariant(!t.pathname||!t.pathname.includes("?"),getInvalidPathError("?","pathname","search",t)),invariant(!t.pathname||!t.pathname.includes("#"),getInvalidPathError("#","pathname","hash",t)),invariant(!t.search||!t.search.includes("#"),getInvalidPathError("#","search","hash",t)));let a=e===""||t.pathname==="",n=a?"/":t.pathname,B;if(n==null)B=l;else{let II=A.length-1;if(!o&&n.startsWith("..")){let k=n.split("/");for(;k[0]==="..";)k.shift(),II-=1;t.pathname=k.join("/")}B=II>=0?A[II]:"/"}let R=resolvePath(t,B),r=n&&n!=="/"&&n.endsWith("/"),H=(a||n===".")&&l.endsWith("/");return!R.pathname.endsWith("/")&&(r||H)&&(R.pathname+="/"),R}var joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=React2__namespace.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=React2__namespace.createContext(null);DataRouterStateContext.displayName="DataRouterState";var ViewTransitionContext=React2__namespace.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=React2__namespace.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=React2__namespace.createContext(null);AwaitContext.displayName="Await";var NavigationContext=React2__namespace.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=React2__namespace.createContext(null);LocationContext.displayName="Location";var RouteContext=React2__namespace.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=React2__namespace.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(e,{relative:A}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:l,navigator:o}=React2__namespace.useContext(NavigationContext),{hash:t,pathname:a,search:n}=useResolvedPath(e,{relative:A}),B=a;return l!=="/"&&(B=a==="/"?l:joinPaths([l,a])),o.createHref({pathname:B,search:n,hash:t})}function useInRouterContext(){return React2__namespace.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),React2__namespace.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(e){React2__namespace.useContext(NavigationContext).static||React2__namespace.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=React2__namespace.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let e=React2__namespace.useContext(DataRouterContext),{basename:A,navigator:l}=React2__namespace.useContext(NavigationContext),{matches:o}=React2__namespace.useContext(RouteContext),{pathname:t}=useLocation(),a=JSON.stringify(getResolveToMatches(o)),n=React2__namespace.useRef(!1);return useIsomorphicLayoutEffect(()=>{n.current=!0}),React2__namespace.useCallback((R,r={})=>{if(warning(n.current,navigateEffectWarning),!n.current)return;if(typeof R=="number"){l.go(R);return}let H=resolveTo(R,JSON.parse(a),t,r.relative==="path");e==null&&A!=="/"&&(H.pathname=H.pathname==="/"?A:joinPaths([A,H.pathname])),(r.replace?l.replace:l.push)(H,r.state,r)},[A,l,a,t,e])}React2__namespace.createContext(null);function useResolvedPath(e,{relative:A}={}){let{matches:l}=React2__namespace.useContext(RouteContext),{pathname:o}=useLocation(),t=JSON.stringify(getResolveToMatches(l));return React2__namespace.useMemo(()=>resolveTo(e,JSON.parse(t),o,A==="path"),[e,t,o,A])}function useRoutesImpl(e,A,l,o){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:t,static:a}=React2__namespace.useContext(NavigationContext),{matches:n}=React2__namespace.useContext(RouteContext),B=n[n.length-1],R=B?B.params:{},r=B?B.pathname:"/",H=B?B.pathnameBase:"/",II=B&&B.route;{let E=II&&II.path||"";warningOnce(r,!II||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${r}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let k=useLocation(),iI;iI=k;let lI=iI.pathname||"/",CI=lI;if(H!=="/"){let E=H.replace(/^\//,"").split("/");CI="/"+lI.replace(/^\//,"").split("/").slice(E.length).join("/")}let sI=!a&&l&&l.matches&&l.matches.length>0?l.matches:matchRoutes(e,{pathname:CI});return warning(II||sI!=null,`No routes matched location "${iI.pathname}${iI.search}${iI.hash}" `),warning(sI==null||sI[sI.length-1].route.element!==void 0||sI[sI.length-1].route.Component!==void 0||sI[sI.length-1].route.lazy!==void 0,`Matched leaf route at location "${iI.pathname}${iI.search}${iI.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),_renderMatches(sI&&sI.map(E=>Object.assign({},E,{params:Object.assign({},R,E.params),pathname:joinPaths([H,t.encodeLocation?t.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?H:joinPaths([H,t.encodeLocation?t.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),n,l,o)}function DefaultErrorComponent(){let e=useRouteError(),A=isRouteErrorResponse(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),l=e instanceof Error?e.stack:null,o="rgba(200,200,200, 0.5)",t={padding:"0.5rem",backgroundColor:o},a={padding:"2px 4px",backgroundColor:o},n=null;return console.error("Error handled by React Router default ErrorBoundary:",e),n=React2__namespace.createElement(React2__namespace.Fragment,null,React2__namespace.createElement("p",null,"ð¿ Hey developer ð"),React2__namespace.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",React2__namespace.createElement("code",{style:a},"ErrorBoundary")," or"," ",React2__namespace.createElement("code",{style:a},"errorElement")," prop on your route.")),React2__namespace.createElement(React2__namespace.Fragment,null,React2__namespace.createElement("h2",null,"Unexpected Application Error!"),React2__namespace.createElement("h3",{style:{fontStyle:"italic"}},A),l?React2__namespace.createElement("pre",{style:t},l):null,n)}var defaultErrorElement=React2__namespace.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends React2__namespace.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,A){return A.location!==e.location||A.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:A.error,location:A.location,revalidation:e.revalidation||A.revalidation}}componentDidCatch(e,A){console.error("React Router caught the following error during render",e,A)}render(){return this.state.error!==void 0?React2__namespace.createElement(RouteContext.Provider,{value:this.props.routeContext},React2__namespace.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:e,match:A,children:l}){let o=React2__namespace.useContext(DataRouterContext);return o&&o.static&&o.staticContext&&(A.route.errorElement||A.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=A.route.id),React2__namespace.createElement(RouteContext.Provider,{value:e},l)}function _renderMatches(e,A=[],l=null,o=null){if(e==null){if(!l)return null;if(l.errors)e=l.matches;else if(A.length===0&&!l.initialized&&l.matches.length>0)e=l.matches;else return null}let t=e,a=l?.errors;if(a!=null){let R=t.findIndex(r=>r.route.id&&a?.[r.route.id]!==void 0);invariant(R>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),t=t.slice(0,Math.min(t.length,R+1))}let n=!1,B=-1;if(l)for(let R=0;R<t.length;R++){let r=t[R];if((r.route.HydrateFallback||r.route.hydrateFallbackElement)&&(B=R),r.route.id){let{loaderData:H,errors:II}=l,k=r.route.loader&&!H.hasOwnProperty(r.route.id)&&(!II||II[r.route.id]===void 0);if(r.route.lazy||k){n=!0,B>=0?t=t.slice(0,B+1):t=[t[0]];break}}}return t.reduceRight((R,r,H)=>{let II,k=!1,iI=null,lI=null;l&&(II=a&&r.route.id?a[r.route.id]:void 0,iI=r.route.errorElement||defaultErrorElement,n&&(B<0&&H===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),k=!0,lI=null):B===H&&(k=!0,lI=r.route.hydrateFallbackElement||null)));let CI=A.concat(t.slice(0,H+1)),sI=()=>{let oI;return II?oI=iI:k?oI=lI:r.route.Component?oI=React2__namespace.createElement(r.route.Component,null):r.route.element?oI=r.route.element:oI=R,React2__namespace.createElement(RenderedRoute,{match:r,routeContext:{outlet:R,matches:CI,isDataRoute:l!=null},children:oI})};return l&&(r.route.ErrorBoundary||r.route.errorElement||H===0)?React2__namespace.createElement(RenderErrorBoundary,{location:l.location,revalidation:l.revalidation,component:iI,error:II,children:sI(),routeContext:{outlet:null,matches:CI,isDataRoute:!0}}):sI()},null)}function getDataRouterConsoleError(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(e){let A=React2__namespace.useContext(DataRouterContext);return invariant(A,getDataRouterConsoleError(e)),A}function useDataRouterState(e){let A=React2__namespace.useContext(DataRouterStateContext);return invariant(A,getDataRouterConsoleError(e)),A}function useRouteContext(e){let A=React2__namespace.useContext(RouteContext);return invariant(A,getDataRouterConsoleError(e)),A}function useCurrentRouteId(e){let A=useRouteContext(e),l=A.matches[A.matches.length-1];return invariant(l.route.id,`${e} can only be used on routes that contain a unique "id"`),l.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){let e=React2__namespace.useContext(RouteErrorContext),A=useDataRouterState("useRouteError"),l=useCurrentRouteId("useRouteError");return e!==void 0?e:A.errors?.[l]}function useNavigateStable(){let{router:e}=useDataRouterContext("useNavigate"),A=useCurrentRouteId("useNavigate"),l=React2__namespace.useRef(!1);return useIsomorphicLayoutEffect(()=>{l.current=!0}),React2__namespace.useCallback(async(t,a={})=>{warning(l.current,navigateEffectWarning),l.current&&(typeof t=="number"?e.navigate(t):await e.navigate(t,{fromRouteId:A,...a}))},[e,A])}var alreadyWarned={};function warningOnce(e,A,l){!A&&!alreadyWarned[e]&&(alreadyWarned[e]=!0,warning(!1,l))}React2__namespace.memo(DataRoutes);function DataRoutes({routes:e,future:A,state:l}){return useRoutesImpl(e,void 0,l,A)}function Route(e){invariant(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(e){return e!=null&&typeof e.tagName=="string"}function isButtonElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="button"}function isFormElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="form"}function isInputElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="input"}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,A){return e.button===0&&(!A||A==="_self")&&!isModifiedEvent(e)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(e){return e!=null&&!supportedFormEncTypes.has(e)?(warning(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):e}function getFormSubmissionInfo(e,A){let l,o,t,a,n;if(isFormElement(e)){let B=e.getAttribute("action");o=B?stripBasename(B,A):null,l=e.getAttribute("method")||defaultMethod,t=getFormEncType(e.getAttribute("enctype"))||defaultEncType,a=new FormData(e)}else if(isButtonElement(e)||isInputElement(e)&&(e.type==="submit"||e.type==="image")){let B=e.form;if(B==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let R=e.getAttribute("formaction")||B.getAttribute("action");if(o=R?stripBasename(R,A):null,l=e.getAttribute("formmethod")||B.getAttribute("method")||defaultMethod,t=getFormEncType(e.getAttribute("formenctype"))||getFormEncType(B.getAttribute("enctype"))||defaultEncType,a=new FormData(B,e),!isFormDataSubmitterSupported()){let{name:r,type:H,value:II}=e;if(H==="image"){let k=r?`${r}.`:"";a.append(`${k}x`,"0"),a.append(`${k}y`,"0")}else r&&a.append(r,II)}}else{if(isHtmlElement(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');l=defaultMethod,o=null,t=defaultEncType,n=e}return a&&t==="text/plain"&&(n=a,a=void 0),{action:o,method:l.toLowerCase(),encType:t,formData:a,body:n}}function invariant2(e,A){if(e===!1||e===null||typeof e>"u")throw new Error(A)}async function loadRouteModule(e,A){if(e.id in A)return A[e.id];try{let l=await import(e.module);return A[e.id]=l,l}catch(l){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(l),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function getKeyedPrefetchLinks(e,A,l){let o=await Promise.all(e.map(async t=>{let a=A.routes[t.route.id];if(a){let n=await loadRouteModule(a,l);return n.links?n.links():[]}return[]}));return dedupeLinkDescriptors(o.flat(1).filter(isHtmlLinkDescriptor).filter(t=>t.rel==="stylesheet"||t.rel==="preload").map(t=>t.rel==="stylesheet"?{...t,rel:"prefetch",as:"style"}:{...t,rel:"prefetch"}))}function getNewMatchesForLinks(e,A,l,o,t,a){let n=(R,r)=>l[r]?R.route.id!==l[r].route.id:!0,B=(R,r)=>l[r].pathname!==R.pathname||l[r].route.path?.endsWith("*")&&l[r].params["*"]!==R.params["*"];return a==="assets"?A.filter((R,r)=>n(R,r)||B(R,r)):a==="data"?A.filter((R,r)=>{let H=o.routes[R.route.id];if(!H||!H.hasLoader)return!1;if(n(R,r)||B(R,r))return!0;if(R.route.shouldRevalidate){let II=R.route.shouldRevalidate({currentUrl:new URL(t.pathname+t.search+t.hash,window.origin),currentParams:l[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:R.params,defaultShouldRevalidate:!0});if(typeof II=="boolean")return II}return!0}):[]}function getModuleLinkHrefs(e,A,{includeHydrateFallback:l}={}){return dedupeHrefs(e.map(o=>{let t=A.routes[o.route.id];if(!t)return[];let a=[t.module];return t.clientActionModule&&(a=a.concat(t.clientActionModule)),t.clientLoaderModule&&(a=a.concat(t.clientLoaderModule)),l&&t.hydrateFallbackModule&&(a=a.concat(t.hydrateFallbackModule)),t.imports&&(a=a.concat(t.imports)),a}).flat(1))}function dedupeHrefs(e){return[...new Set(e)]}function sortKeys(e){let A={},l=Object.keys(e).sort();for(let o of l)A[o]=e[o];return A}function dedupeLinkDescriptors(e,A){let l=new Set;return new Set(A),e.reduce((o,t)=>{let a=JSON.stringify(sortKeys(t));return l.has(a)||(l.add(a),o.push({key:a,link:t})),o},[])}var NO_BODY_STATUS_CODES=new Set([100,101,204,205]);function singleFetchUrl(e,A){let l=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return l.pathname==="/"?l.pathname="_root.data":A&&stripBasename(l.pathname,A)==="/"?l.pathname=`${A.replace(/\/$/,"")}/_root.data`:l.pathname=`${l.pathname.replace(/\/$/,"")}.data`,l}function useDataRouterContext2(){let e=React2__namespace.useContext(DataRouterContext);return invariant2(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function useDataRouterStateContext(){let e=React2__namespace.useContext(DataRouterStateContext);return invariant2(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var FrameworkContext=React2__namespace.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let e=React2__namespace.useContext(FrameworkContext);return invariant2(e,"You must render this element inside a <HydratedRouter> element"),e}function usePrefetchBehavior(e,A){let l=React2__namespace.useContext(FrameworkContext),[o,t]=React2__namespace.useState(!1),[a,n]=React2__namespace.useState(!1),{onFocus:B,onBlur:R,onMouseEnter:r,onMouseLeave:H,onTouchStart:II}=A,k=React2__namespace.useRef(null);React2__namespace.useEffect(()=>{if(e==="render"&&n(!0),e==="viewport"){let CI=oI=>{oI.forEach(E=>{n(E.isIntersecting)})},sI=new IntersectionObserver(CI,{threshold:.5});return k.current&&sI.observe(k.current),()=>{sI.disconnect()}}},[e]),React2__namespace.useEffect(()=>{if(o){let CI=setTimeout(()=>{n(!0)},100);return()=>{clearTimeout(CI)}}},[o]);let iI=()=>{t(!0)},lI=()=>{t(!1),n(!1)};return l?e!=="intent"?[a,k,{}]:[a,k,{onFocus:composeEventHandlers(B,iI),onBlur:composeEventHandlers(R,lI),onMouseEnter:composeEventHandlers(r,iI),onMouseLeave:composeEventHandlers(H,lI),onTouchStart:composeEventHandlers(II,iI)}]:[!1,k,{}]}function composeEventHandlers(e,A){return l=>{e&&e(l),l.defaultPrevented||A(l)}}function PrefetchPageLinks({page:e,...A}){let{router:l}=useDataRouterContext2(),o=React2__namespace.useMemo(()=>matchRoutes(l.routes,e,l.basename),[l.routes,e,l.basename]);return o?React2__namespace.createElement(PrefetchPageLinksImpl,{page:e,matches:o,...A}):null}function useKeyedPrefetchLinks(e){let{manifest:A,routeModules:l}=useFrameworkContext(),[o,t]=React2__namespace.useState([]);return React2__namespace.useEffect(()=>{let a=!1;return getKeyedPrefetchLinks(e,A,l).then(n=>{a||t(n)}),()=>{a=!0}},[e,A,l]),o}function PrefetchPageLinksImpl({page:e,matches:A,...l}){let o=useLocation(),{manifest:t,routeModules:a}=useFrameworkContext(),{basename:n}=useDataRouterContext2(),{loaderData:B,matches:R}=useDataRouterStateContext(),r=React2__namespace.useMemo(()=>getNewMatchesForLinks(e,A,R,t,o,"data"),[e,A,R,t,o]),H=React2__namespace.useMemo(()=>getNewMatchesForLinks(e,A,R,t,o,"assets"),[e,A,R,t,o]),II=React2__namespace.useMemo(()=>{if(e===o.pathname+o.search+o.hash)return[];let lI=new Set,CI=!1;if(A.forEach(oI=>{let E=t.routes[oI.route.id];!E||!E.hasLoader||(!r.some(_=>_.route.id===oI.route.id)&&oI.route.id in B&&a[oI.route.id]?.shouldRevalidate||E.hasClientLoader?CI=!0:lI.add(oI.route.id))}),lI.size===0)return[];let sI=singleFetchUrl(e,n);return CI&&lI.size>0&&sI.searchParams.set("_routes",A.filter(oI=>lI.has(oI.route.id)).map(oI=>oI.route.id).join(",")),[sI.pathname+sI.search]},[n,B,o,t,r,A,e,a]),k=React2__namespace.useMemo(()=>getModuleLinkHrefs(H,t),[H,t]),iI=useKeyedPrefetchLinks(H);return React2__namespace.createElement(React2__namespace.Fragment,null,II.map(lI=>React2__namespace.createElement("link",{key:lI,rel:"prefetch",as:"fetch",href:lI,...l})),k.map(lI=>React2__namespace.createElement("link",{key:lI,rel:"modulepreload",href:lI,...l})),iI.map(({key:lI,link:CI})=>React2__namespace.createElement("link",{key:lI,...CI})))}function mergeRefs(...e){return A=>{e.forEach(l=>{typeof l=="function"?l(A):l!=null&&(l.current=A)})}}var isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser&&(window.__reactRouterVersion="7.5.3")}catch(e){}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=React2__namespace.forwardRef(function e({onClick:A,discover:l="render",prefetch:o="none",relative:t,reloadDocument:a,replace:n,state:B,target:R,to:r,preventScrollReset:H,viewTransition:II,...k},iI){let{basename:lI}=React2__namespace.useContext(NavigationContext),CI=typeof r=="string"&&ABSOLUTE_URL_REGEX2.test(r),sI,oI=!1;if(typeof r=="string"&&CI&&(sI=r,isBrowser))try{let aI=new URL(window.location.href),WI=r.startsWith("//")?new URL(aI.protocol+r):new URL(r),GI=stripBasename(WI.pathname,lI);WI.origin===aI.origin&&GI!=null?r=GI+WI.search+WI.hash:oI=!0}catch{warning(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=useHref(r,{relative:t}),[_,gI,M]=usePrefetchBehavior(o,k),O=useLinkClickHandler(r,{replace:n,state:B,target:R,preventScrollReset:H,relative:t,viewTransition:II});function dI(aI){A&&A(aI),aI.defaultPrevented||O(aI)}let eI=React2__namespace.createElement("a",{...k,...M,href:sI||E,onClick:oI||a?A:dI,ref:mergeRefs(iI,gI),target:R,"data-discover":!CI&&l==="render"?"true":void 0});return _&&!CI?React2__namespace.createElement(React2__namespace.Fragment,null,eI,React2__namespace.createElement(PrefetchPageLinks,{page:E})):eI});Link.displayName="Link";var NavLink=React2__namespace.forwardRef(function e({"aria-current":A="page",caseSensitive:l=!1,className:o="",end:t=!1,style:a,to:n,viewTransition:B,children:R,...r},H){let II=useResolvedPath(n,{relative:r.relative}),k=useLocation(),iI=React2__namespace.useContext(DataRouterStateContext),{navigator:lI,basename:CI}=React2__namespace.useContext(NavigationContext),sI=iI!=null&&useViewTransitionState(II)&&B===!0,oI=lI.encodeLocation?lI.encodeLocation(II).pathname:II.pathname,E=k.pathname,_=iI&&iI.navigation&&iI.navigation.location?iI.navigation.location.pathname:null;l||(E=E.toLowerCase(),_=_?_.toLowerCase():null,oI=oI.toLowerCase()),_&&CI&&(_=stripBasename(_,CI)||_);const gI=oI!=="/"&&oI.endsWith("/")?oI.length-1:oI.length;let M=E===oI||!t&&E.startsWith(oI)&&E.charAt(gI)==="/",O=_!=null&&(_===oI||!t&&_.startsWith(oI)&&_.charAt(oI.length)==="/"),dI={isActive:M,isPending:O,isTransitioning:sI},eI=M?A:void 0,aI;typeof o=="function"?aI=o(dI):aI=[o,M?"active":null,O?"pending":null,sI?"transitioning":null].filter(Boolean).join(" ");let WI=typeof a=="function"?a(dI):a;return React2__namespace.createElement(Link,{...r,"aria-current":eI,className:aI,ref:H,style:WI,to:n,viewTransition:B},typeof R=="function"?R(dI):R)});NavLink.displayName="NavLink";var Form=React2__namespace.forwardRef(({discover:e="render",fetcherKey:A,navigate:l,reloadDocument:o,replace:t,state:a,method:n=defaultMethod,action:B,onSubmit:R,relative:r,preventScrollReset:H,viewTransition:II,...k},iI)=>{let lI=useSubmit(),CI=useFormAction(B,{relative:r}),sI=n.toLowerCase()==="get"?"get":"post",oI=typeof B=="string"&&ABSOLUTE_URL_REGEX2.test(B),E=_=>{if(R&&R(_),_.defaultPrevented)return;_.preventDefault();let gI=_.nativeEvent.submitter,M=gI?.getAttribute("formmethod")||n;lI(gI||_.currentTarget,{fetcherKey:A,method:M,navigate:l,replace:t,state:a,relative:r,preventScrollReset:H,viewTransition:II})};return React2__namespace.createElement("form",{ref:iI,method:sI,action:CI,onSubmit:o?R:E,...k,"data-discover":!oI&&e==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(e){let A=React2__namespace.useContext(DataRouterContext);return invariant(A,getDataRouterConsoleError2(e)),A}function useLinkClickHandler(e,{target:A,replace:l,state:o,preventScrollReset:t,relative:a,viewTransition:n}={}){let B=useNavigate(),R=useLocation(),r=useResolvedPath(e,{relative:a});return React2__namespace.useCallback(H=>{if(shouldProcessLinkClick(H,A)){H.preventDefault();let II=l!==void 0?l:createPath(R)===createPath(r);B(e,{replace:II,state:o,preventScrollReset:t,relative:a,viewTransition:n})}},[R,B,r,l,o,A,e,t,a,n])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:e}=useDataRouterContext3("useSubmit"),{basename:A}=React2__namespace.useContext(NavigationContext),l=useRouteId();return React2__namespace.useCallback(async(o,t={})=>{let{action:a,method:n,encType:B,formData:R,body:r}=getFormSubmissionInfo(o,A);if(t.navigate===!1){let H=t.fetcherKey||getUniqueFetcherId();await e.fetch(H,l,t.action||a,{preventScrollReset:t.preventScrollReset,formData:R,body:r,formMethod:t.method||n,formEncType:t.encType||B,flushSync:t.flushSync})}else await e.navigate(t.action||a,{preventScrollReset:t.preventScrollReset,formData:R,body:r,formMethod:t.method||n,formEncType:t.encType||B,replace:t.replace,state:t.state,fromRouteId:l,flushSync:t.flushSync,viewTransition:t.viewTransition})},[e,A,l])}function useFormAction(e,{relative:A}={}){let{basename:l}=React2__namespace.useContext(NavigationContext),o=React2__namespace.useContext(RouteContext);invariant(o,"useFormAction must be used inside a RouteContext");let[t]=o.matches.slice(-1),a={...useResolvedPath(e||".",{relative:A})},n=useLocation();if(e==null){a.search=n.search;let B=new URLSearchParams(a.search),R=B.getAll("index");if(R.some(H=>H==="")){B.delete("index"),R.filter(II=>II).forEach(II=>B.append("index",II));let H=B.toString();a.search=H?`?${H}`:""}}return(!e||e===".")&&t.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),l!=="/"&&(a.pathname=a.pathname==="/"?l:joinPaths([l,a.pathname])),createPath(a)}function useViewTransitionState(e,A={}){let l=React2__namespace.useContext(ViewTransitionContext);invariant(l!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=useDataRouterContext3("useViewTransitionState"),t=useResolvedPath(e,{relative:A.relative});if(!l.isTransitioning)return!1;let a=stripBasename(l.currentLocation.pathname,o)||l.currentLocation.pathname,n=stripBasename(l.nextLocation.pathname,o)||l.nextLocation.pathname;return matchPath(t.pathname,n)!=null||matchPath(t.pathname,a)!=null}new TextEncoder,[...NO_BODY_STATUS_CODES],React2.createContext(null);const extractRouteParams=(e,A=window?.location?.pathname||"")=>{if(!e)return{};const l=e.split("/").filter(a=>a),o=A.split("/").filter(a=>a);let t={};for(let a=0;a<l.length;a++)if(l[a].startsWith(":")){let n=l[a].replace(":","").replace("?",""),B=l[a].endsWith("?");if(o[a]!==void 0)t[n]=o[a];else if(!B)throw new Error(`Missing required route parameter: ${n}`)}return t},DesmyWithRouter=e=>class extends React2.Component{render(){const{path:A,...l}=this.props,o=A?extractRouteParams(A):{};return jsxRuntimeExports.jsx(e,{...l,routePath:A,params:Object.keys(o).length?o:void 0})}},DesmyRenderRoutes=e=>e.map(({path:A,element:l,children:o},t)=>{let a=l;return React2.isValidElement(l)&&(a=React2.cloneElement(l,{path:A})),jsxRuntimeExports.jsx(Route,{path:A,element:a,children:o&&DesmyRenderRoutes(o)},t)});var DesmyState=(e=>(e.SPECIFIC_GROUP_SIZE="SPECIFIC_GROUP_SIZE",e.ORGANIZATIONAL_UNIT_GROUPS="ORGANIZATIONAL_UNIT_GROUPS",e.TOTAL_COURSE_COUNT="TOTAL_COURSE_COUNT",e.CREDIT_HOUR_LIMITS="CREDIT_HOUR_LIMITS",e.PROGRAMME_TYPE="PROGRAMME_TYPE",e.FACULTY_COURSES="FACULTY_COURSES",e.RELOAD_ACCOUNT="RELOAD_ACCOUNT",e.COURSE="COURSE",e.LOADING="LOADING",e.SPECIFIC_COURSE="SPECIFIC_COURSE",e.ERROR="ERROR",e.SUCCESS="SUCCESS",e.BOOLEAN="BOOLEAN",e.DROPDOWN="DROPDOWN",e.CAMPUS="CAMPUS",e.APPROVED="APPROVED",e.SUBMITTED="SUBMITTED",e.CONFIRMED="CONFIRMED",e.STUDENT_GROUPS="STUDENT_GROUPS",e.STARTED="STARTED",e.NOT_STARTED="NOT_STARTED",e.ACTIVE="ACTIVE",e.ACCREDITED="ACCREDITED",e.ACCEPTED="ACCEPTED",e.CREATED="CREATED",e.LOADED="LOADED",e.LOCKED="LOCKED",e.RUNNING="RUNNING",e.ADMITTED="ADMITTED",e.ADMIT="ADMIT",e.COMMITTEE="COMMITTEE",e.BOARD="BOARD",e.UPDATED="UPDATED",e.NO="NO",e.YES="YES",e.COURSE_ALLOCATION="COURSE_ALLOCATION",e.ELECTIVE="ELECTIVE",e.CORE="CORE",e.NOTIFICATION="NOTIFICATION",e.NOTIFICATION_ALERT="NOTIFICATION_ALERT",e.NOTIFICATION_ALERT_CLOSE="NOTIFICATION_ALERT_CLOSE",e.HEALTHY="HEALTHY",e.UNHEALTHY="UNHEALTHY",e.TEACHING="TEACHING",e.NONTEACHING="NONTEACHING",e.STUDENTS="STUDENTS",e.APPLICANTS="APPLICANTS",e.PROGRAMMES="PROGRAMMES",e.APPOINTMENT="APPOINTMENT",e.UNITS="UNITS",e.SUBGROUPS="SUBGROUPS",e.CURRICULUM="CURRICULUM",e.EXAMINATIONS="EXAMINATIONS",e.LEAVE="LEAVE",e.ORGANIZATIONAL_UNITS="ORGANIZATIONAL_UNITS",e.PROGRESS="PROGRESS",e.COMPLETED="COMPLETED",e.QUALIFIED="QUALIFIED",e.WAITING="WAITING",e.NAVIGATION="NAVIGATION",e.PENDING="PENDING",e.RECOMMENDED="RECOMMENDED",e.INACTIVE="INACTIVE",e.IN_PROGRESS="IN_PROGRESS",e.CIRRICULUM="CIRRICULUM",e.NOTICE="NOTICE",e.OPEN_SIDEBAR="OPEN_SIDEBAR",e.OPEN="OPEN",e.TESTING="TESTING",e.VOUCHER_ACCESS_TOKEN="v_access_token",e.ACCESS_TOKEN="access_token",e.CLIENT_ACCESS_TOKEN="client_token",e.APPLICATION_ACCESS_TOKEN="a_token",e.APPLICATION="APPLICATION",e.APPLY_AS_AWAITING="APPLY_AS_AWAITING",e.UPLOAD_RESULTS="UPLOAD_RESULTS",e.TEXT="TEXT",e.TEXTAREA="TEXTAREA",e.EMAIL="EMAIL",e.PHONE="PHONE",e.PHONE_NUMBER="PHONE_NUMBER",e.NUMBER="NUMBER",e.PASSWORD="PASSWORD",e.DOCUMENT="DOCUMENT",e.EDIT="EDIT",e.DELETE="DELETE",e.ACADEMIC="ACADEMIC",e.NONACADEMIC="NONACADEMIC",e.INTERNATIONAL="INTERNATIONAL",e.VOUCHER_PARAM="VOUCHER_PARAM",e.VOUCHER="VOUCHER",e.EMAIL_ADDRESS="EMAIL_ADDRESS",e.MOBILE_MONEY="MOBILE_MONEY",e.LOCAL="LOCAL",e.FRONT="FRONT",e.ADMISSION="ADMISSION",e.MEDIA_CAPTURED="MEDIA_CAPTURED",e.FEMALE="FEMALE",e.MALE="MALE",e.DATASETTABLE_REQUEST="DATASETTABLE_REQUEST",e.SMALL="SMALL",e.NORMAL="NORMAL",e.LARGE="LARGE",e.COMBOBOX="COMBOBOX",e.AGGREGATE="AGGREGATE",e.AUTOMATIC="AUTOMATIC",e.MANUAL="MANUAL",e.INTERVIEW="INTERVIEW",e.PASS="PASS",e.FAIL="FAIL",e.ENTRANCE_EXAMS="ENTRANCE_EXAMS",e.REJECT="REJECT",e.SYSTEM_GET_STARTED="SYSTEM_GET_STARTED",e.COURSE_POLICY="COURSE_POLICY",e.REJECTED="REJECTED",e.COURSES="COURSES",e.GRADE_CUT_OFF_POINT_STATE="GRADE_CUT_OFF_POINT_STATE",e.AGGREGATE_CUT_OFF_POINT_STATE="AGGREGATE_CUT_OFF_POINT_STATE",e.GENDER_CUT_OFF_POINT_STATE="GENDER_CUT_OFF_POINT_STATE",e.MATURE_INVITATION="MATURE_INVITATION",e.RESULTS="RESULTS",e.FILE_UPLOAD="FILE_UPLOAD",e.COURSE_REMOVED="COURSE_REMOVED",e.COURSE_ADDED="COURSE_ADDED",e.RECOMMENDATION_LETTER="RECOMMENDATION_LETTER",e.ERROR_MESSAGE="Please check your internet connection and retry again. Please contact us if the issue persists. ",e.POSITIONS="POSITIONS",e.WASSCE_RESULTS="WASSCE_RESULTS",e.NEW_SITTING="NEW_SITTING",e.REFEREE="REFEREE",e.CERTIFICATE="CERTIFICATE",e.TRANSCRIPT="TRANSCRIPT",e.CERTIFICATES_AND_TRANSCRIPTS="CERTIFICATES_AND_TRANSCRIPTS",e.RECOMMENDATION_LETTERS="RECOMMENDATION_LETTERS",e.SECONDARY_SCHOOL_DOCUMENTS="SECONDARY_SCHOOL_DOCUMENTS",e.UPDATE_INFORMATION="UPDATE_INFORMATION",e.SUB_CAMPUSES="SUB_CAMPUSES",e.CONTINUOUS_ASSESSMENT="CONTINUOUS_ASSESSMENT",e.END_OF_SEMESTER="END_OF_SEMESTER",e.CAMPUSES="CAMPUSES",e.VOUCHER_FEES="VOUCHER_FEES",e.REPORT="REPORT",e.NEW_DOCUMENT="NEW_DOCUMENT",e.OTHERS="OTHERS",e.COURSE_QUOTA="COURSE_QUOTA",e.RE_ACCREDITATION="RE_ACCREDITATION",e.ACCREDITATION="ACCREDITATION",e.REGULAR="REGULAR",e.INTERNAL="INTERNAL",e.EXTERNAL="EXTERNAL",e.COLOR="COLOR",e.SEARCH="SEARCH",e.IMMEDIATELY="IMMEDIATELY",e.CUSTOM="CUSTOM",e.ACTING="ACTING",e.SUBSTANTIVE="SUBSTANTIVE",e.CURRENT_ACADEMIC_YEAR="CURRENT_ACADEMIC_YEAR",e.DURATION_OF_ENTIRE_PROGRAMME="DURATION_OF_ENTIRE_PROGRAMME",e.REMAINDER_OF_PROGRAMME="REMAINDER_OF_PROGRAMME",e.SPECIFIC="SPECIFIC",e.UPLOAD_MANAGER_REQUEST="UPLOAD_MANAGER_REQUEST",e.INTERVIEW_INVITATION="INTERVIEW_INVITATION",e.ALL="ALL",e.ALL_TEACHING_WITH_SPECIFIC_NON_TEACHING="ALL_TEACHING_WITH_SPECIFIC_NON_TEACHING",e.ALL_NON_TEACHING_WITH_SPECIFIC_TEACHING="ALL_NON_TEACHING_WITH_SPECIFIC_TEACHING",e.SPECIFIC_TEACHING_AND_NON_TEACHING="SPECIFIC_TEACHING_AND_NON_TEACHING",e.ABSOLUTE_AMOUNT="ABSOLUTE_AMOUNT",e.ENTRY_MODE="ENTRY_MODE",e.AMOUNT="AMOUNT",e.DECIMAL="DECIMAL",e.PERCENTAGE_OF_TOTAL_FEES_DUE="PERCENTAGE_OF_TOTAL_FEES_DUE",e.REFUND="REFUND",e.OWING="OWING",e.NONE="NONE",e.FEE_PARAM="",e.NON_SCORING="NON_SCORING",e.SCORING="SCORING",e.NOMINATING_AUTHORITY="NOMINATING_AUTHORITY",e.APPOINTING_AUTHORITY="APPOINTING_AUTHORITY",e.CHANGE_PROGRAMME="CHANGE_PROGRAMME",e.CHANGE_PASSWORD="CHANGE_PASSWORD",e.EDIT_PROFILE="EDIT_PROFILE",e.PUBLISHED_RESULTS="PUBLISHED_RESULTS",e.PUBLISHED="PUBLISHED",e.UNIVERSITY="UNIVERSITY",e))(DesmyState||{});function bind(e,A){return function(){return e.apply(A,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,{iterator,toStringTag}=Symbol,kindOf=(e=>A=>{const l=toString.call(A);return e[l]||(e[l]=l.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=e=>(e=e.toLowerCase(),A=>kindOf(A)===e),typeOfTest=e=>A=>typeof A===e,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(e){return e!==null&&!isUndefined(e)&&e.constructor!==null&&!isUndefined(e.constructor)&&isFunction$1(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(e){let A;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?A=ArrayBuffer.isView(e):A=e&&e.buffer&&isArrayBuffer(e.buffer),A}const isString=typeOfTest("string"),isFunction$1=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=e=>e!==null&&typeof e=="object",isBoolean=e=>e===!0||e===!1,isPlainObject=e=>{if(kindOf(e)!=="object")return!1;const A=getPrototypeOf(e);return(A===null||A===Object.prototype||Object.getPrototypeOf(A)===null)&&!(toStringTag in e)&&!(iterator in e)},isDate$1=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=e=>isObject(e)&&isFunction$1(e.pipe),isFormData=e=>{let A;return e&&(typeof FormData=="function"&&e instanceof FormData||isFunction$1(e.append)&&((A=kindOf(e))==="formdata"||A==="object"&&isFunction$1(e.toString)&&e.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach$1(e,A,{allOwnKeys:l=!1}={}){if(e===null||typeof e>"u")return;let o,t;if(typeof e!="object"&&(e=[e]),isArray(e))for(o=0,t=e.length;o<t;o++)A.call(null,e[o],o,e);else{const a=l?Object.getOwnPropertyNames(e):Object.keys(e),n=a.length;let B;for(o=0;o<n;o++)B=a[o],A.call(null,e[B],B,e)}}function findKey$1(e,A){A=A.toLowerCase();const l=Object.keys(e);let o=l.length,t;for(;o-- >0;)if(t=l[o],A===t.toLowerCase())return t;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=e=>!isUndefined(e)&&e!==_global;function merge(){const{caseless:e}=isContextDefined(this)&&this||{},A={},l=(o,t)=>{const a=e&&findKey$1(A,t)||t;isPlainObject(A[a])&&isPlainObject(o)?A[a]=merge(A[a],o):isPlainObject(o)?A[a]=merge({},o):isArray(o)?A[a]=o.slice():A[a]=o};for(let o=0,t=arguments.length;o<t;o++)arguments[o]&&forEach$1(arguments[o],l);return A}const extend=(e,A,l,{allOwnKeys:o}={})=>(forEach$1(A,(t,a)=>{l&&isFunction$1(t)?e[a]=bind(t,l):e[a]=t},{allOwnKeys:o}),e),stripBOM=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),inherits=(e,A,l,o)=>{e.prototype=Object.create(A.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:A.prototype}),l&&Object.assign(e.prototype,l)},toFlatObject=(e,A,l,o)=>{let t,a,n;const B={};if(A=A||{},e==null)return A;do{for(t=Object.getOwnPropertyNames(e),a=t.length;a-- >0;)n=t[a],(!o||o(n,e,A))&&!B[n]&&(A[n]=e[n],B[n]=!0);e=l!==!1&&getPrototypeOf(e)}while(e&&(!l||l(e,A))&&e!==Object.prototype);return A},endsWith=(e,A,l)=>{e=String(e),(l===void 0||l>e.length)&&(l=e.length),l-=A.length;const o=e.indexOf(A,l);return o!==-1&&o===l},toArray=e=>{if(!e)return null;if(isArray(e))return e;let A=e.length;if(!isNumber(A))return null;const l=new Array(A);for(;A-- >0;)l[A]=e[A];return l},isTypedArray=(e=>A=>e&&A instanceof e)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(e,A)=>{const o=(e&&e[iterator]).call(e);let t;for(;(t=o.next())&&!t.done;){const a=t.value;A.call(e,a[0],a[1])}},matchAll=(e,A)=>{let l;const o=[];for(;(l=e.exec(A))!==null;)o.push(l);return o},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(l,o,t){return o.toUpperCase()+t}),hasOwnProperty=(({hasOwnProperty:e})=>(A,l)=>e.call(A,l))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(e,A)=>{const l=Object.getOwnPropertyDescriptors(e),o={};forEach$1(l,(t,a)=>{let n;(n=A(t,a,e))!==!1&&(o[a]=n||t)}),Object.defineProperties(e,o)},freezeMethods=e=>{reduceDescriptors(e,(A,l)=>{if(isFunction$1(e)&&["arguments","caller","callee"].indexOf(l)!==-1)return!1;const o=e[l];if(isFunction$1(o)){if(A.enumerable=!1,"writable"in A){A.writable=!1;return}A.set||(A.set=()=>{throw Error("Can not rewrite read-only method '"+l+"'")})}})},toObjectSet=(e,A)=>{const l={},o=t=>{t.forEach(a=>{l[a]=!0})};return isArray(e)?o(e):o(String(e).split(A)),l},noop$2=()=>{},toFiniteNumber=(e,A)=>e!=null&&Number.isFinite(e=+e)?e:A;function isSpecCompliantForm(e){return!!(e&&isFunction$1(e.append)&&e[toStringTag]==="FormData"&&e[iterator])}const toJSONObject=e=>{const A=new Array(10),l=(o,t)=>{if(isObject(o)){if(A.indexOf(o)>=0)return;if(!("toJSON"in o)){A[t]=o;const a=isArray(o)?[]:{};return forEach$1(o,(n,B)=>{const R=l(n,t+1);!isUndefined(R)&&(a[B]=R)}),A[t]=void 0,a}}return o};return l(e,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=e=>e&&(isObject(e)||isFunction$1(e))&&isFunction$1(e.then)&&isFunction$1(e.catch),_setImmediate=((e,A)=>e?setImmediate:A?((l,o)=>(_global.addEventListener("message",({source:t,data:a})=>{t===_global&&a===l&&o.length&&o.shift()()},!1),t=>{o.push(t),_global.postMessage(l,"*")}))(`axios@${Math.random()}`,[]):l=>setTimeout(l))(typeof setImmediate=="function",isFunction$1(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,isIterable=e=>e!=null&&isFunction$1(e[iterator]),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate:isDate$1,isFile,isBlob,isRegExp,isFunction:isFunction$1,isStream,isURLSearchParams,isTypedArray,isFileList,forEach:forEach$1,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop:noop$2,toFiniteNumber,findKey:findKey$1,global:_global,isContextDefined,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap,isIterable};function AxiosError$1(e,A,l,o,t){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",A&&(this.code=A),l&&(this.config=l),o&&(this.request=o),t&&(this.response=t,this.status=t.status?t.status:null)}utils$1.inherits(AxiosError$1,Error,{toJSON:function e(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError$1.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{descriptors[e]={value:e}}),Object.defineProperties(AxiosError$1,descriptors),Object.defineProperty(prototype$1,"isAxiosError",{value:!0}),AxiosError$1.from=(e,A,l,o,t,a)=>{const n=Object.create(prototype$1);return utils$1.toFlatObject(e,n,function(R){return R!==Error.prototype},B=>B!=="isAxiosError"),AxiosError$1.call(n,e.message,A,l,o,t),n.cause=e,n.name=e.name,a&&Object.assign(n,a),n};const httpAdapter=null;function isVisitable(e){return utils$1.isPlainObject(e)||utils$1.isArray(e)}function removeBrackets(e){return utils$1.endsWith(e,"[]")?e.slice(0,-2):e}function renderKey(e,A,l){return e?e.concat(A).map(function(t,a){return t=removeBrackets(t),!l&&a?"["+t+"]":t}).join(l?".":""):A}function isFlatArray(e){return utils$1.isArray(e)&&!e.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function e(A){return/^is[A-Z]/.test(A)});function toFormData$1(e,A,l){if(!utils$1.isObject(e))throw new TypeError("target must be an object");A=A||new FormData,l=utils$1.toFlatObject(l,{metaTokens:!0,dots:!1,indexes:!1},!1,function(CI,sI){return!utils$1.isUndefined(sI[CI])});const o=l.metaTokens,t=l.visitor||H,a=l.dots,n=l.indexes,R=(l.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(A);if(!utils$1.isFunction(t))throw new TypeError("visitor must be a function");function r(lI){if(lI===null)return"";if(utils$1.isDate(lI))return lI.toISOString();if(!R&&utils$1.isBlob(lI))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(lI)||utils$1.isTypedArray(lI)?R&&typeof Blob=="function"?new Blob([lI]):Buffer.from(lI):lI}function H(lI,CI,sI){let oI=lI;if(lI&&!sI&&typeof lI=="object"){if(utils$1.endsWith(CI,"{}"))CI=o?CI:CI.slice(0,-2),lI=JSON.stringify(lI);else if(utils$1.isArray(lI)&&isFlatArray(lI)||(utils$1.isFileList(lI)||utils$1.endsWith(CI,"[]"))&&(oI=utils$1.toArray(lI)))return CI=removeBrackets(CI),oI.forEach(function(_,gI){!(utils$1.isUndefined(_)||_===null)&&A.append(n===!0?renderKey([CI],gI,a):n===null?CI:CI+"[]",r(_))}),!1}return isVisitable(lI)?!0:(A.append(renderKey(sI,CI,a),r(lI)),!1)}const II=[],k=Object.assign(predicates,{defaultVisitor:H,convertValue:r,isVisitable});function iI(lI,CI){if(!utils$1.isUndefined(lI)){if(II.indexOf(lI)!==-1)throw Error("Circular reference detected in "+CI.join("."));II.push(lI),utils$1.forEach(lI,function(oI,E){(!(utils$1.isUndefined(oI)||oI===null)&&t.call(A,oI,utils$1.isString(E)?E.trim():E,CI,k))===!0&&iI(oI,CI?CI.concat(E):[E])}),II.pop()}}if(!utils$1.isObject(e))throw new TypeError("data must be an object");return iI(e),A}function encode$1(e){const A={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(o){return A[o]})}function AxiosURLSearchParams(e,A){this._pairs=[],e&&toFormData$1(e,this,A)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function e(A,l){this._pairs.push([A,l])},prototype.toString=function e(A){const l=A?function(o){return A.call(this,o,encode$1)}:encode$1;return this._pairs.map(function(t){return l(t[0])+"="+l(t[1])},"").join("&")};function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(e,A,l){if(!A)return e;const o=l&&l.encode||encode;utils$1.isFunction(l)&&(l={serialize:l});const t=l&&l.serialize;let a;if(t?a=t(A,l):a=utils$1.isURLSearchParams(A)?A.toString():new AxiosURLSearchParams(A,l).toString(o),a){const n=e.indexOf("#");n!==-1&&(e=e.slice(0,n)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class InterceptorManager{constructor(){this.handlers=[]}use(A,l,o){return this.handlers.push({fulfilled:A,rejected:l,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(A){this.handlers[A]&&(this.handlers[A]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(A){utils$1.forEach(this.handlers,function(o){o!==null&&A(o)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(e,A){return toFormData$1(e,new platform.classes.URLSearchParams,Object.assign({visitor:function(l,o,t,a){return platform.isNode&&utils$1.isBuffer(l)?(this.append(o,l.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},A))}function parsePropPath(e){return utils$1.matchAll(/\w+|\[(\w*)]/g,e).map(A=>A[0]==="[]"?"":A[1]||A[0])}function arrayToObject(e){const A={},l=Object.keys(e);let o;const t=l.length;let a;for(o=0;o<t;o++)a=l[o],A[a]=e[a];return A}function formDataToJSON(e){function A(l,o,t,a){let n=l[a++];if(n==="__proto__")return!0;const B=Number.isFinite(+n),R=a>=l.length;return n=!n&&utils$1.isArray(t)?t.length:n,R?(utils$1.hasOwnProp(t,n)?t[n]=[t[n],o]:t[n]=o,!B):((!t[n]||!utils$1.isObject(t[n]))&&(t[n]=[]),A(l,o,t[n],a)&&utils$1.isArray(t[n])&&(t[n]=arrayToObject(t[n])),!B)}if(utils$1.isFormData(e)&&utils$1.isFunction(e.entries)){const l={};return utils$1.forEachEntry(e,(o,t)=>{A(parsePropPath(o),t,l,0)}),l}return null}function stringifySafely(e,A,l){if(utils$1.isString(e))try{return(A||JSON.parse)(e),utils$1.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(l||JSON.stringify)(e)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function e(A,l){const o=l.getContentType()||"",t=o.indexOf("application/json")>-1,a=utils$1.isObject(A);if(a&&utils$1.isHTMLForm(A)&&(A=new FormData(A)),utils$1.isFormData(A))return t?JSON.stringify(formDataToJSON(A)):A;if(utils$1.isArrayBuffer(A)||utils$1.isBuffer(A)||utils$1.isStream(A)||utils$1.isFile(A)||utils$1.isBlob(A)||utils$1.isReadableStream(A))return A;if(utils$1.isArrayBufferView(A))return A.buffer;if(utils$1.isURLSearchParams(A))return l.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),A.toString();let B;if(a){if(o.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(A,this.formSerializer).toString();if((B=utils$1.isFileList(A))||o.indexOf("multipart/form-data")>-1){const R=this.env&&this.env.FormData;return toFormData$1(B?{"files[]":A}:A,R&&new R,this.formSerializer)}}return a||t?(l.setContentType("application/json",!1),stringifySafely(A)):A}],transformResponse:[function e(A){const l=this.transitional||defaults.transitional,o=l&&l.forcedJSONParsing,t=this.responseType==="json";if(utils$1.isResponse(A)||utils$1.isReadableStream(A))return A;if(A&&utils$1.isString(A)&&(o&&!this.responseType||t)){const n=!(l&&l.silentJSONParsing)&&t;try{return JSON.parse(A)}catch(B){if(n)throw B.name==="SyntaxError"?AxiosError$1.from(B,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):B}}return A}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function e(A){return A>=200&&A<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],e=>{defaults.headers[e]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=e=>{const A={};let l,o,t;return e&&e.split(`
`).forEach(function(n){t=n.indexOf(":"),l=n.substring(0,t).trim().toLowerCase(),o=n.substring(t+1).trim(),!(!l||A[l]&&ignoreDuplicateOf[l])&&(l==="set-cookie"?A[l]?A[l].push(o):A[l]=[o]:A[l]=A[l]?A[l]+", "+o:o)}),A},$internals=Symbol("internals");function normalizeHeader(e){return e&&String(e).trim().toLowerCase()}function normalizeValue(e){return e===!1||e==null?e:utils$1.isArray(e)?e.map(normalizeValue):String(e)}function parseTokens(e){const A=Object.create(null),l=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=l.exec(e);)A[o[1]]=o[2];return A}const isValidHeaderName=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function matchHeaderValue(e,A,l,o,t){if(utils$1.isFunction(o))return o.call(this,A,l);if(t&&(A=l),!!utils$1.isString(A)){if(utils$1.isString(o))return A.indexOf(o)!==-1;if(utils$1.isRegExp(o))return o.test(A)}}function formatHeader(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(A,l,o)=>l.toUpperCase()+o)}function buildAccessors(e,A){const l=utils$1.toCamelCase(" "+A);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+l,{value:function(t,a,n){return this[o].call(this,A,t,a,n)},configurable:!0})})}let AxiosHeaders$1=class{constructor(A){A&&this.set(A)}set(A,l,o){const t=this;function a(B,R,r){const H=normalizeHeader(R);if(!H)throw new Error("header name must be a non-empty string");const II=utils$1.findKey(t,H);(!II||t[II]===void 0||r===!0||r===void 0&&t[II]!==!1)&&(t[II||R]=normalizeValue(B))}const n=(B,R)=>utils$1.forEach(B,(r,H)=>a(r,H,R));if(utils$1.isPlainObject(A)||A instanceof this.constructor)n(A,l);else if(utils$1.isString(A)&&(A=A.trim())&&!isValidHeaderName(A))n(parseHeaders(A),l);else if(utils$1.isObject(A)&&utils$1.isIterable(A)){let B={},R,r;for(const H of A){if(!utils$1.isArray(H))throw TypeError("Object iterator must return a key-value pair");B[r=H[0]]=(R=B[r])?utils$1.isArray(R)?[...R,H[1]]:[R,H[1]]:H[1]}n(B,l)}else A!=null&&a(l,A,o);return this}get(A,l){if(A=normalizeHeader(A),A){const o=utils$1.findKey(this,A);if(o){const t=this[o];if(!l)return t;if(l===!0)return parseTokens(t);if(utils$1.isFunction(l))return l.call(this,t,o);if(utils$1.isRegExp(l))return l.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(A,l){if(A=normalizeHeader(A),A){const o=utils$1.findKey(this,A);return!!(o&&this[o]!==void 0&&(!l||matchHeaderValue(this,this[o],o,l)))}return!1}delete(A,l){const o=this;let t=!1;function a(n){if(n=normalizeHeader(n),n){const B=utils$1.findKey(o,n);B&&(!l||matchHeaderValue(o,o[B],B,l))&&(delete o[B],t=!0)}}return utils$1.isArray(A)?A.forEach(a):a(A),t}clear(A){const l=Object.keys(this);let o=l.length,t=!1;for(;o--;){const a=l[o];(!A||matchHeaderValue(this,this[a],a,A,!0))&&(delete this[a],t=!0)}return t}normalize(A){const l=this,o={};return utils$1.forEach(this,(t,a)=>{const n=utils$1.findKey(o,a);if(n){l[n]=normalizeValue(t),delete l[a];return}const B=A?formatHeader(a):String(a).trim();B!==a&&delete l[a],l[B]=normalizeValue(t),o[B]=!0}),this}concat(...A){return this.constructor.concat(this,...A)}toJSON(A){const l=Object.create(null);return utils$1.forEach(this,(o,t)=>{o!=null&&o!==!1&&(l[t]=A&&utils$1.isArray(o)?o.join(", "):o)}),l}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([A,l])=>A+": "+l).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(A){return A instanceof this?A:new this(A)}static concat(A,...l){const o=new this(A);return l.forEach(t=>o.set(t)),o}static accessor(A){const o=(this[$internals]=this[$internals]={accessors:{}}).accessors,t=this.prototype;function a(n){const B=normalizeHeader(n);o[B]||(buildAccessors(t,n),o[B]=!0)}return utils$1.isArray(A)?A.forEach(a):a(A),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),utils$1.reduceDescriptors(AxiosHeaders$1.prototype,({value:e},A)=>{let l=A[0].toUpperCase()+A.slice(1);return{get:()=>e,set(o){this[l]=o}}}),utils$1.freezeMethods(AxiosHeaders$1);function transformData(e,A){const l=this||defaults,o=A||l,t=AxiosHeaders$1.from(o.headers);let a=o.data;return utils$1.forEach(e,function(B){a=B.call(l,a,t.normalize(),A?A.status:void 0)}),t.normalize(),a}function isCancel$1(e){return!!(e&&e.__CANCEL__)}function CanceledError$1(e,A,l){AxiosError$1.call(this,e??"canceled",AxiosError$1.ERR_CANCELED,A,l),this.name="CanceledError"}utils$1.inherits(CanceledError$1,AxiosError$1,{__CANCEL__:!0});function settle(e,A,l){const o=l.config.validateStatus;!l.status||!o||o(l.status)?e(l):A(new AxiosError$1("Request failed with status code "+l.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor(l.status/100)-4],l.config,l.request,l))}function parseProtocol(e){const A=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return A&&A[1]||""}function speedometer(e,A){e=e||10;const l=new Array(e),o=new Array(e);let t=0,a=0,n;return A=A!==void 0?A:1e3,function(R){const r=Date.now(),H=o[a];n||(n=r),l[t]=R,o[t]=r;let II=a,k=0;for(;II!==t;)k+=l[II++],II=II%e;if(t=(t+1)%e,t===a&&(a=(a+1)%e),r-n<A)return;const iI=H&&r-H;return iI?Math.round(k*1e3/iI):void 0}}function throttle(e,A){let l=0,o=1e3/A,t,a;const n=(r,H=Date.now())=>{l=H,t=null,a&&(clearTimeout(a),a=null),e.apply(null,r)};return[(...r)=>{const H=Date.now(),II=H-l;II>=o?n(r,H):(t=r,a||(a=setTimeout(()=>{a=null,n(t)},o-II)))},()=>t&&n(t)]}const progressEventReducer=(e,A,l=3)=>{let o=0;const t=speedometer(50,250);return throttle(a=>{const n=a.loaded,B=a.lengthComputable?a.total:void 0,R=n-o,r=t(R),H=n<=B;o=n;const II={loaded:n,total:B,progress:B?n/B:void 0,bytes:R,rate:r||void 0,estimated:r&&B&&H?(B-n)/r:void 0,event:a,lengthComputable:B!=null,[A?"download":"upload"]:!0};e(II)},l)},progressEventDecorator=(e,A)=>{const l=e!=null;return[o=>A[0]({lengthComputable:l,total:e,loaded:o}),A[1]]},asyncDecorator=e=>(...A)=>utils$1.asap(()=>e(...A)),isURLSameOrigin=platform.hasStandardBrowserEnv?((e,A)=>l=>(l=new URL(l,platform.origin),e.protocol===l.protocol&&e.host===l.host&&(A||e.port===l.port)))(new URL(platform.origin),platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent)):()=>!0,cookies=platform.hasStandardBrowserEnv?{write(e,A,l,o,t,a){const n=[e+"="+encodeURIComponent(A)];utils$1.isNumber(l)&&n.push("expires="+new Date(l).toGMTString()),utils$1.isString(o)&&n.push("path="+o),utils$1.isString(t)&&n.push("domain="+t),a===!0&&n.push("secure"),document.cookie=n.join("; ")},read(e){const A=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return A?decodeURIComponent(A[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function combineURLs(e,A){return A?e.replace(/\/?\/$/,"")+"/"+A.replace(/^\/+/,""):e}function buildFullPath(e,A,l){let o=!isAbsoluteURL(A);return e&&(o||l==!1)?combineURLs(e,A):A}const headersToObject=e=>e instanceof AxiosHeaders$1?{...e}:e;function mergeConfig$1(e,A){A=A||{};const l={};function o(r,H,II,k){return utils$1.isPlainObject(r)&&utils$1.isPlainObject(H)?utils$1.merge.call({caseless:k},r,H):utils$1.isPlainObject(H)?utils$1.merge({},H):utils$1.isArray(H)?H.slice():H}function t(r,H,II,k){if(utils$1.isUndefined(H)){if(!utils$1.isUndefined(r))return o(void 0,r,II,k)}else return o(r,H,II,k)}function a(r,H){if(!utils$1.isUndefined(H))return o(void 0,H)}function n(r,H){if(utils$1.isUndefined(H)){if(!utils$1.isUndefined(r))return o(void 0,r)}else return o(void 0,H)}function B(r,H,II){if(II in A)return o(r,H);if(II in e)return o(void 0,r)}const R={url:a,method:a,data:a,baseURL:n,transformRequest:n,transformResponse:n,paramsSerializer:n,timeout:n,timeoutMessage:n,withCredentials:n,withXSRFToken:n,adapter:n,responseType:n,xsrfCookieName:n,xsrfHeaderName:n,onUploadProgress:n,onDownloadProgress:n,decompress:n,maxContentLength:n,maxBodyLength:n,beforeRedirect:n,transport:n,httpAgent:n,httpsAgent:n,cancelToken:n,socketPath:n,responseEncoding:n,validateStatus:B,headers:(r,H,II)=>t(headersToObject(r),headersToObject(H),II,!0)};return utils$1.forEach(Object.keys(Object.assign({},e,A)),function(H){const II=R[H]||t,k=II(e[H],A[H],H);utils$1.isUndefined(k)&&II!==B||(l[H]=k)}),l}const resolveConfig=e=>{const A=mergeConfig$1({},e);let{data:l,withXSRFToken:o,xsrfHeaderName:t,xsrfCookieName:a,headers:n,auth:B}=A;A.headers=n=AxiosHeaders$1.from(n),A.url=buildURL(buildFullPath(A.baseURL,A.url,A.allowAbsoluteUrls),e.params,e.paramsSerializer),B&&n.set("Authorization","Basic "+btoa((B.username||"")+":"+(B.password?unescape(encodeURIComponent(B.password)):"")));let R;if(utils$1.isFormData(l)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)n.setContentType(void 0);else if((R=n.getContentType())!==!1){const[r,...H]=R?R.split(";").map(II=>II.trim()).filter(Boolean):[];n.setContentType([r||"multipart/form-data",...H].join("; "))}}if(platform.hasStandardBrowserEnv&&(o&&utils$1.isFunction(o)&&(o=o(A)),o||o!==!1&&isURLSameOrigin(A.url))){const r=t&&a&&cookies.read(a);r&&n.set(t,r)}return A},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(e){return new Promise(function(l,o){const t=resolveConfig(e);let a=t.data;const n=AxiosHeaders$1.from(t.headers).normalize();let{responseType:B,onUploadProgress:R,onDownloadProgress:r}=t,H,II,k,iI,lI;function CI(){iI&&iI(),lI&&lI(),t.cancelToken&&t.cancelToken.unsubscribe(H),t.signal&&t.signal.removeEventListener("abort",H)}let sI=new XMLHttpRequest;sI.open(t.method.toUpperCase(),t.url,!0),sI.timeout=t.timeout;function oI(){if(!sI)return;const _=AxiosHeaders$1.from("getAllResponseHeaders"in sI&&sI.getAllResponseHeaders()),M={data:!B||B==="text"||B==="json"?sI.responseText:sI.response,status:sI.status,statusText:sI.statusText,headers:_,config:e,request:sI};settle(function(dI){l(dI),CI()},function(dI){o(dI),CI()},M),sI=null}"onloadend"in sI?sI.onloadend=oI:sI.onreadystatechange=function(){!sI||sI.readyState!==4||sI.status===0&&!(sI.responseURL&&sI.responseURL.indexOf("file:")===0)||setTimeout(oI)},sI.onabort=function(){sI&&(o(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,e,sI)),sI=null)},sI.onerror=function(){o(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,e,sI)),sI=null},sI.ontimeout=function(){let gI=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const M=t.transitional||transitionalDefaults;t.timeoutErrorMessage&&(gI=t.timeoutErrorMessage),o(new AxiosError$1(gI,M.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,e,sI)),sI=null},a===void 0&&n.setContentType(null),"setRequestHeader"in sI&&utils$1.forEach(n.toJSON(),function(gI,M){sI.setRequestHeader(M,gI)}),utils$1.isUndefined(t.withCredentials)||(sI.withCredentials=!!t.withCredentials),B&&B!=="json"&&(sI.responseType=t.responseType),r&&([k,lI]=progressEventReducer(r,!0),sI.addEventListener("progress",k)),R&&sI.upload&&([II,iI]=progressEventReducer(R),sI.upload.addEventListener("progress",II),sI.upload.addEventListener("loadend",iI)),(t.cancelToken||t.signal)&&(H=_=>{sI&&(o(!_||_.type?new CanceledError$1(null,e,sI):_),sI.abort(),sI=null)},t.cancelToken&&t.cancelToken.subscribe(H),t.signal&&(t.signal.aborted?H():t.signal.addEventListener("abort",H)));const E=parseProtocol(t.url);if(E&&platform.protocols.indexOf(E)===-1){o(new AxiosError$1("Unsupported protocol "+E+":",AxiosError$1.ERR_BAD_REQUEST,e));return}sI.send(a||null)})},composeSignals=(e,A)=>{const{length:l}=e=e?e.filter(Boolean):[];if(A||l){let o=new AbortController,t;const a=function(r){if(!t){t=!0,B();const H=r instanceof Error?r:this.reason;o.abort(H instanceof AxiosError$1?H:new CanceledError$1(H instanceof Error?H.message:H))}};let n=A&&setTimeout(()=>{n=null,a(new AxiosError$1(`timeout ${A} of ms exceeded`,AxiosError$1.ETIMEDOUT))},A);const B=()=>{e&&(n&&clearTimeout(n),n=null,e.forEach(r=>{r.unsubscribe?r.unsubscribe(a):r.removeEventListener("abort",a)}),e=null)};e.forEach(r=>r.addEventListener("abort",a));const{signal:R}=o;return R.unsubscribe=()=>utils$1.asap(B),R}},streamChunk=function*(e,A){let l=e.byteLength;if(l<A){yield e;return}let o=0,t;for(;o<l;)t=o+A,yield e.slice(o,t),o=t},readBytes=async function*(e,A){for await(const l of readStream(e))yield*streamChunk(l,A)},readStream=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const A=e.getReader();try{for(;;){const{done:l,value:o}=await A.read();if(l)break;yield o}}finally{await A.cancel()}},trackStream=(e,A,l,o)=>{const t=readBytes(e,A);let a=0,n,B=R=>{n||(n=!0,o&&o(R))};return new ReadableStream({async pull(R){try{const{done:r,value:H}=await t.next();if(r){B(),R.close();return}let II=H.byteLength;if(l){let k=a+=II;l(k)}R.enqueue(new Uint8Array(H))}catch(r){throw B(r),r}},cancel(R){return B(R),t.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(e=>A=>e.encode(A))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),test=(e,...A)=>{try{return!!e(...A)}catch{return!1}},supportsRequestStream=isReadableStreamSupported&&test(()=>{let e=!1;const A=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!A}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test(()=>utils$1.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(e=>e.body)};isFetchSupported&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(A=>{!resolvers[A]&&(resolvers[A]=utils$1.isFunction(e[A])?l=>l[A]():(l,o)=>{throw new AxiosError$1(`Response type '${A}' is not supported`,AxiosError$1.ERR_NOT_SUPPORT,o)})})})(new Response);const getBodyLength=async e=>{if(e==null)return 0;if(utils$1.isBlob(e))return e.size;if(utils$1.isSpecCompliantForm(e))return(await new Request(platform.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(e)||utils$1.isArrayBuffer(e))return e.byteLength;if(utils$1.isURLSearchParams(e)&&(e=e+""),utils$1.isString(e))return(await encodeText(e)).byteLength},resolveBodyLength=async(e,A)=>{const l=utils$1.toFiniteNumber(e.getContentLength());return l??getBodyLength(A)},fetchAdapter=isFetchSupported&&(async e=>{let{url:A,method:l,data:o,signal:t,cancelToken:a,timeout:n,onDownloadProgress:B,onUploadProgress:R,responseType:r,headers:H,withCredentials:II="same-origin",fetchOptions:k}=resolveConfig(e);r=r?(r+"").toLowerCase():"text";let iI=composeSignals([t,a&&a.toAbortSignal()],n),lI;const CI=iI&&iI.unsubscribe&&(()=>{iI.unsubscribe()});let sI;try{if(R&&supportsRequestStream&&l!=="get"&&l!=="head"&&(sI=await resolveBodyLength(H,o))!==0){let M=new Request(A,{method:"POST",body:o,duplex:"half"}),O;if(utils$1.isFormData(o)&&(O=M.headers.get("content-type"))&&H.setContentType(O),M.body){const[dI,eI]=progressEventDecorator(sI,progressEventReducer(asyncDecorator(R)));o=trackStream(M.body,DEFAULT_CHUNK_SIZE,dI,eI)}}utils$1.isString(II)||(II=II?"include":"omit");const oI="credentials"in Request.prototype;lI=new Request(A,{...k,signal:iI,method:l.toUpperCase(),headers:H.normalize().toJSON(),body:o,duplex:"half",credentials:oI?II:void 0});let E=await fetch(lI);const _=supportsResponseStream&&(r==="stream"||r==="response");if(supportsResponseStream&&(B||_&&CI)){const M={};["status","statusText","headers"].forEach(aI=>{M[aI]=E[aI]});const O=utils$1.toFiniteNumber(E.headers.get("content-length")),[dI,eI]=B&&progressEventDecorator(O,progressEventReducer(asyncDecorator(B),!0))||[];E=new Response(trackStream(E.body,DEFAULT_CHUNK_SIZE,dI,()=>{eI&&eI(),CI&&CI()}),M)}r=r||"text";let gI=await resolvers[utils$1.findKey(resolvers,r)||"text"](E,e);return!_&&CI&&CI(),await new Promise((M,O)=>{settle(M,O,{data:gI,headers:AxiosHeaders$1.from(E.headers),status:E.status,statusText:E.statusText,config:e,request:lI})})}catch(oI){throw CI&&CI(),oI&&oI.name==="TypeError"&&/Load failed|fetch/i.test(oI.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,e,lI),{cause:oI.cause||oI}):AxiosError$1.from(oI,oI&&oI.code,e,lI)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$1.forEach(knownAdapters,(e,A)=>{if(e){try{Object.defineProperty(e,"name",{value:A})}catch{}Object.defineProperty(e,"adapterName",{value:A})}});const renderReason=e=>`- ${e}`,isResolvedHandle=e=>utils$1.isFunction(e)||e===null||e===!1,adapters={getAdapter:e=>{e=utils$1.isArray(e)?e:[e];const{length:A}=e;let l,o;const t={};for(let a=0;a<A;a++){l=e[a];let n;if(o=l,!isResolvedHandle(l)&&(o=knownAdapters[(n=String(l)).toLowerCase()],o===void 0))throw new AxiosError$1(`Unknown adapter '${n}'`);if(o)break;t[n||"#"+a]=o}if(!o){const a=Object.entries(t).map(([B,R])=>`adapter ${B} `+(R===!1?"is not supported by the environment":"is not available in the build"));let n=A?a.length>1?`since :
`+a.map(renderReason).join(`
`):" "+renderReason(a[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return o},adapters:knownAdapters};function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new CanceledError$1(null,e)}function dispatchRequest(e){return throwIfCancellationRequested(e),e.headers=AxiosHeaders$1.from(e.headers),e.data=transformData.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(e.adapter||defaults.adapter)(e).then(function(o){return throwIfCancellationRequested(e),o.data=transformData.call(e,e.transformResponse,o),o.headers=AxiosHeaders$1.from(o.headers),o},function(o){return isCancel$1(o)||(throwIfCancellationRequested(e),o&&o.response&&(o.response.data=transformData.call(e,e.transformResponse,o.response),o.response.headers=AxiosHeaders$1.from(o.response.headers))),Promise.reject(o)})}const VERSION$1="1.9.0",validators$1={};["object","boolean","number","function","string","symbol"].forEach((e,A)=>{validators$1[e]=function(o){return typeof o===e||"a"+(A<1?"n ":" ")+e}});const deprecatedWarnings={};validators$1.transitional=function e(A,l,o){function t(a,n){return"[Axios v"+VERSION$1+"] Transitional option '"+a+"'"+n+(o?". "+o:"")}return(a,n,B)=>{if(A===!1)throw new AxiosError$1(t(n," has been removed"+(l?" in "+l:"")),AxiosError$1.ERR_DEPRECATED);return l&&!deprecatedWarnings[n]&&(deprecatedWarnings[n]=!0,console.warn(t(n," has been deprecated since v"+l+" and will be removed in the near future"))),A?A(a,n,B):!0}},validators$1.spelling=function e(A){return(l,o)=>(console.warn(`${o} is likely a misspelling of ${A}`),!0)};function assertOptions(e,A,l){if(typeof e!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let t=o.length;for(;t-- >0;){const a=o[t],n=A[a];if(n){const B=e[a],R=B===void 0||n(B,a,e);if(R!==!0)throw new AxiosError$1("option "+a+" must be "+R,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if(l!==!0)throw new AxiosError$1("Unknown option "+a,AxiosError$1.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;let Axios$1=class{constructor(A){this.defaults=A||{},this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(A,l){try{return await this._request(A,l)}catch(o){if(o instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const a=t.stack?t.stack.replace(/^.+\n/,""):"";try{o.stack?a&&!String(o.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+a):o.stack=a}catch{}}throw o}}_request(A,l){typeof A=="string"?(l=l||{},l.url=A):l=A||{},l=mergeConfig$1(this.defaults,l);const{transitional:o,paramsSerializer:t,headers:a}=l;o!==void 0&&validator.assertOptions(o,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),t!=null&&(utils$1.isFunction(t)?l.paramsSerializer={serialize:t}:validator.assertOptions(t,{encode:validators.function,serialize:validators.function},!0)),l.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?l.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:l.allowAbsoluteUrls=!0),validator.assertOptions(l,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),l.method=(l.method||this.defaults.method||"get").toLowerCase();let n=a&&utils$1.merge(a.common,a[l.method]);a&&utils$1.forEach(["delete","get","head","post","put","patch","common"],lI=>{delete a[lI]}),l.headers=AxiosHeaders$1.concat(n,a);const B=[];let R=!0;this.interceptors.request.forEach(function(CI){typeof CI.runWhen=="function"&&CI.runWhen(l)===!1||(R=R&&CI.synchronous,B.unshift(CI.fulfilled,CI.rejected))});const r=[];this.interceptors.response.forEach(function(CI){r.push(CI.fulfilled,CI.rejected)});let H,II=0,k;if(!R){const lI=[dispatchRequest.bind(this),void 0];for(lI.unshift.apply(lI,B),lI.push.apply(lI,r),k=lI.length,H=Promise.resolve(l);II<k;)H=H.then(lI[II++],lI[II++]);return H}k=B.length;let iI=l;for(II=0;II<k;){const lI=B[II++],CI=B[II++];try{iI=lI(iI)}catch(sI){CI.call(this,sI);break}}try{H=dispatchRequest.call(this,iI)}catch(lI){return Promise.reject(lI)}for(II=0,k=r.length;II<k;)H=H.then(r[II++],r[II++]);return H}getUri(A){A=mergeConfig$1(this.defaults,A);const l=buildFullPath(A.baseURL,A.url,A.allowAbsoluteUrls);return buildURL(l,A.params,A.paramsSerializer)}};utils$1.forEach(["delete","get","head","options"],function e(A){Axios$1.prototype[A]=function(l,o){return this.request(mergeConfig$1(o||{},{method:A,url:l,data:(o||{}).data}))}}),utils$1.forEach(["post","put","patch"],function e(A){function l(o){return function(a,n,B){return this.request(mergeConfig$1(B||{},{method:A,headers:o?{"Content-Type":"multipart/form-data"}:{},url:a,data:n}))}}Axios$1.prototype[A]=l(),Axios$1.prototype[A+"Form"]=l(!0)});let CancelToken$1=class Hi{constructor(A){if(typeof A!="function")throw new TypeError("executor must be a function.");let l;this.promise=new Promise(function(a){l=a});const o=this;this.promise.then(t=>{if(!o._listeners)return;let a=o._listeners.length;for(;a-- >0;)o._listeners[a](t);o._listeners=null}),this.promise.then=t=>{let a;const n=new Promise(B=>{o.subscribe(B),a=B}).then(t);return n.cancel=function(){o.unsubscribe(a)},n},A(function(a,n,B){o.reason||(o.reason=new CanceledError$1(a,n,B),l(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(A){if(this.reason){A(this.reason);return}this._listeners?this._listeners.push(A):this._listeners=[A]}unsubscribe(A){if(!this._listeners)return;const l=this._listeners.indexOf(A);l!==-1&&this._listeners.splice(l,1)}toAbortSignal(){const A=new AbortController,l=o=>{A.abort(o)};return this.subscribe(l),A.signal.unsubscribe=()=>this.unsubscribe(l),A.signal}static source(){let A;return{token:new Hi(function(t){A=t}),cancel:A}}};function spread$1(e){return function(l){return e.apply(null,l)}}function isAxiosError$1(e){return utils$1.isObject(e)&&e.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode$1).forEach(([e,A])=>{HttpStatusCode$1[A]=e});function createInstance(e){const A=new Axios$1(e),l=bind(Axios$1.prototype.request,A);return utils$1.extend(l,Axios$1.prototype,A,{allOwnKeys:!0}),utils$1.extend(l,A,null,{allOwnKeys:!0}),l.create=function(t){return createInstance(mergeConfig$1(e,t))},l}const axios=createInstance(defaults);axios.Axios=Axios$1,axios.CanceledError=CanceledError$1,axios.CancelToken=CancelToken$1,axios.isCancel=isCancel$1,axios.VERSION=VERSION$1,axios.toFormData=toFormData$1,axios.AxiosError=AxiosError$1,axios.Cancel=axios.CanceledError,axios.all=function e(A){return Promise.all(A)},axios.spread=spread$1,axios.isAxiosError=isAxiosError$1,axios.mergeConfig=mergeConfig$1,axios.AxiosHeaders=AxiosHeaders$1,axios.formToJSON=e=>formDataToJSON(utils$1.isHTMLForm(e)?new FormData(e):e),axios.getAdapter=adapters.getAdapter,axios.HttpStatusCode=HttpStatusCode$1,axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig}=axios;class DesmyAuth{constructor(){}logout(){this.clear()}logoutApplication(){localStorage.removeItem("a_token"),localStorage.removeItem("app_req")}clearList(A,l){try{A&&A.length>0&&A.forEach(o=>{localStorage.removeItem(o.key)}),l(!0)}catch{l(!1)}}get(A){return localStorage.getItem(A)}saveList(A,l){try{A&&A.length>0&&A.forEach(o=>{localStorage.setItem(o.key,`${o.value}`)}),l(!0)}catch{l(!1)}}clear(){localStorage.clear()}clientClear=()=>{this.remove(DesmyState.CLIENT_ACCESS_TOKEN)};remove(A){localStorage.removeItem(A)}save(A,l){localStorage.setItem(A,l)}getCookie(A){let l=null;if(document.cookie&&document.cookie!==""){const o=document.cookie.split(";");for(let t=0;t<o.length;t++){const a=o[t].trim();if(a.substring(0,A.length+1)===A+"="){l=decodeURIComponent(a.substring(A.length+1));break}}}return l}deleteCookie(A,l="/"){document.cookie=`${encodeURIComponent(A)}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=${l}`}setCookie(A,l,o){let t=`${encodeURIComponent(A)}=${encodeURIComponent(l)}`;if(o?.expires)if(typeof o.expires=="number"){const a=new Date;a.setTime(a.getTime()+o.expires*24*60*60*1e3),t+=`; expires=${a.toUTCString()}`}else o.expires instanceof Date&&(t+=`; expires=${o.expires.toUTCString()}`);o?.path&&(t+=`; path=${o.path}`),o?.secure&&(t+="; secure"),document.cookie=t}}const DesmyAuth$1=new DesmyAuth;class DropdownPositionWrapper extends React2.Component{wrapperRef=React2.createRef();constructor(A){super(A),this.state={styles:{}}}componentDidMount(){window.addEventListener("resize",this.updatePosition),window.addEventListener("scroll",this.updatePosition,!0),this.updatePosition()}componentDidUpdate(A){A.visible!==this.props.visible&&this.props.visible&&this.updatePosition()}componentWillUnmount(){window.removeEventListener("resize",this.updatePosition),window.removeEventListener("scroll",this.updatePosition,!0)}updatePosition=()=>{const{targetRef:A,maxHeight:l=350}=this.props,o=A.current;if(!o)return;const t=o.getBoundingClientRect(),a=window.innerHeight,n=a-t.bottom,B=t.top,R={};let r=l;const H=5;n<l&&B>n?(R.bottom=a-t.top+H,r=B>l?l:B):(R.top=t.bottom+H,r=n>l?l:n);const II={position:"fixed",left:t.left,width:t.width,maxHeight:r,overflowY:"auto",boxShadow:"0 4px 6px rgba(0,0,0,0.2)",fontFamily:"inherit",zIndex:2147483647,...R};this.setState({styles:II})};render(){const{visible:A,children:l,onScroll:o}=this.props,{styles:t}=this.state;return A?ReactDOM.createPortal(jsxRuntimeExports.jsx("div",{ref:this.wrapperRef,style:t,tabIndex:-1,onScroll:o,children:l}),document.body):null}}class DropdownButton extends React2.Component{render(){const{placeholder:A,disabled:l,selectedMultiple:o,selectedList:t,all:a,selectedAll:n,onClick:B,onClear:R,buttonRef:r,dropdownPopoverShow:H}=this.props;return jsxRuntimeExports.jsxs("div",{className:"relative w-full h-12 border font-poppinsRegular bg-inherit border-black dark:border-white",children:[jsxRuntimeExports.jsxs("div",{className:"relative h-full w-full text-sm bg-inherit",ref:r,onClick:()=>{l||B()},role:"button",tabIndex:0,onKeyDown:II=>{(II.key==="Enter"||II.key===" ")&&!l&&B()},children:[jsxRuntimeExports.jsx("div",{className:`absolute left-1.5 ${A&&(t.name!=null||o.length>0)||a&&n?"-top-2.5 text-xs":"text-sm top-2.5"} px-2 bg-inherit transition-all`,children:A}),jsxRuntimeExports.jsx("div",{className:`flex relative h-12 ${l?"cursor-not-allowed":"cursor-pointer"} px-2 items-center w-full`,children:jsxRuntimeExports.jsxs("div",{className:"flex w-full justify-between",children:[jsxRuntimeExports.jsx("div",{className:"pr-5",children:jsxRuntimeExports.jsx("div",{className:"mr-2 bg-inherit text-black text-sm dark:text-white w-full justify-start text-start line-clamp-1",children:o.length>0?o.map(II=>II.name).join(", "):t.name||(a&&n?a:"")})}),!l&&jsxRuntimeExports.jsx("div",{children:H?jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 dark:text-white",viewBox:"0 0 20 20",fill:"currentColor",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"})}):jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 dark:text-white",viewBox:"0 0 20 20",fill:"currentColor",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})]}),jsxRuntimeExports.jsx("div",{onClick:R,className:`absolute right-6 top-4 transition duration-300 ease-in-out ${!DesmyCommons$1.isEmptyOrNull(t?.name)||!DesmyCommons$1.isEmptyOrNull(o)?"opacity-100 scale-100 pointer-events-auto":"opacity-0 scale-75 pointer-events-none"}`,children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"size-4 text-red-500 cursor-pointer",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z"})})})]})}}class DropdownSearch extends React2.Component{render(){const{searchValue:A,onChange:l,inputRef:o}=this.props;return jsxRuntimeExports.jsx("div",{className:"flex w-full relative z-0 p-4 group border-black dark:border-white",children:jsxRuntimeExports.jsx("input",{type:"text",name:"search",autoComplete:"off",ref:o,value:A,onChange:l,className:"block py-2.5 text-xs 2xl:text-sm px-0 bg-inherit w-full text-black dark:text-white border-0 border-b-2 border-black dark:border-white appearance-none focus:outline-none focus:ring-0 focus:border-black dark:focus:border-white peer",placeholder:" Search here...."})})}}class DropdownList extends React2.Component{render(){const{items:A,filterText:l,isMultiple:o,selectedMultiple:t,selectedSingle:a,allText:n,selectedAll:B,dropdownListClass:R,onSelectAll:r,onClearSelected:H,onSelectItem:II,clearLabel:k,error:iI,isLoading:lI,onRetry:CI,emptyMessage:sI,enableDecrypt:oI,encryptHandler:E}=this.props,_=M=>oI&&E?E(M):M,gI=A.filter(M=>M.name.toLowerCase().includes(l.toLowerCase()));return iI?.state?jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full text-red-500 justify-center items-center h-24",children:[jsxRuntimeExports.jsx("div",{className:"text-xs",children:iI.message}),jsxRuntimeExports.jsx("div",{onClick:CI,className:"text-xs uppercase bg-red-500 hover:bg-red-600 transition-all rounded-full text-white px-4 py-2 font-poppinsBold mt-2 cursor-pointer",children:"Retry"})]}):lI?jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full justify-center items-center mt-5",children:jsxRuntimeExports.jsx("span",{className:"text-sm",children:"Loading..."})}):A.length===0?jsxRuntimeExports.jsx("div",{className:"flex w-full h-24 text-sm dark:text-white justify-center items-center text-center",children:sI??"No data found"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[o&&n&&jsxRuntimeExports.jsx("div",{className:`flex text-sm py-2 px-4 cursor-pointer w-full whitespace-nowrap dark:hover:bg-white dark:hover:text-black ${B?"font-poppinsBold":"font-normal"} ${R}`,onClick:r,children:n}),k&&jsxRuntimeExports.jsx("div",{className:`flex text-sm py-2 px-4 cursor-pointer w-full whitespace-nowrap dark:hover:bg-white dark:hover:text-black ${R}`,onClick:H,children:k}),gI.map((M,O)=>{const dI=o?t.some(eI=>eI.id===M.id):a.id===M.id;return jsxRuntimeExports.jsxs("div",{className:`flex text-sm py-2 px-4 cursor-pointer w-full whitespace-nowrap hover:bg-gray-200 dark:hover:bg-white dark:hover:text-black ${dI?"font-poppinsBold":"font-normal"} ${R}`,onClick:eI=>II(eI,M),title:_(M.name),children:[M.icon&&jsxRuntimeExports.jsx("img",{className:"w-4 h-4 mr-2",alt:"icon",src:_(M.icon)}),jsxRuntimeExports.jsx("div",{className:"line-clamp-1",children:_(M.name)}),dI?jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 ml-auto",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z",clipRule:"evenodd"})}):jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-5 h-5 ml-auto",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10s10-4.47 10-10S17.53 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8s8 3.58 8 8s-3.58 8-8 8"})})]},O)})]})}}const emptyDropdownItem={id:"",name:null,icon:null,data:null};class DesmyDropdown extends React2.Component{btnDropdownRef=React2.createRef();divRef=React2.createRef();dropdownContentRef=React2.createRef();searchRef=React2.createRef();constructor(A){super(A),this.state={dropdownPopoverShow:!1,selectedList:emptyDropdownItem,selectedMultiple:[],defaultValue:"",datalist:[],intervalId:0,hasLoaded:!1,isLoading:!1,clear:!1,selectedAll:!1,requestUrl:"",bgColor:"dark:bg-darkDialogBackground",input:{search:""},error:{state:!1,message:""}}}componentDidMount(){this.props.onRef&&this.props.onRef(this),document.addEventListener("mousedown",this.handleClickOutside),this.props.request&&!DesmyCommons$1.isEmptyOrNull(this.props.request.url)?this.setState({isLoading:!0,requestUrl:this.props.request.url},this.fetch):(this.handleDefault(),this.setState({datalist:this.props.data??[]}))}componentDidUpdate(A){this.props.defaultValue!==A.defaultValue&&this.handleDefault(),this.props.data!==A.data&&this.props.data!==void 0&&this.setState({datalist:this.props.data??[],hasLoaded:!0},this.handleDefault),this.props.request&&this.props.request.url!==A.request?.url&&this.setState({requestUrl:this.props.request.url,isLoading:!0},this.fetch)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}handleClickOutside=A=>{const l=this.btnDropdownRef.current,o=this.dropdownContentRef.current;l&&!l.contains(A.target)&&o&&!o.contains(A.target)&&this.closeDropdownPopover()};handleChange=A=>{const l={...this.state.input};l[A.target.name]=A.target.value,this.setState({input:l})};handleDefault=async()=>{try{const A=this.props.data??this.state.datalist,l=this.props.defaultValue;if(DesmyCommons$1.isEmptyOrNull(A)||DesmyCommons$1.isEmptyOrNull(l))return;if(!!this.props.is_multiple){const a=(Array.isArray(l)?l:[l]).map(r=>typeof r=="object"?r?.id:r),n=this.state.selectedMultiple.map(r=>r.id);if(a.length===n.length&&a.every(r=>n.includes(r)))return;const R=A.filter(r=>a.some(H=>H===r.id||DesmyCommons$1.toString(H)===DesmyCommons$1.toString(r.id)));this.setState({selectedMultiple:R,datalist:A,hasLoaded:!0},()=>{this.props.handleChange&&this.props.handleChange(R)})}else{const t=Array.isArray(l)?l[0]:l,a=A.find(H=>typeof t=="object"&&t?DesmyCommons$1.toString(H.id).toLowerCase()===DesmyCommons$1.toString(t?.id).toLowerCase():DesmyCommons$1.toString(H.id).toLowerCase()===DesmyCommons$1.toString(t).toLowerCase()||DesmyCommons$1.toString(H.name).toLowerCase()===DesmyCommons$1.toString(t).toLowerCase());if(!a)return;const n=this.handleEncrypt(a.id),{id:B,...R}=a,r={id:n||B,...R};if(this.state.selectedList&&this.state.selectedList.id===r.id)return;this.setState({selectedList:r,datalist:A,hasLoaded:!0},()=>{this.props.handleChange&&this.props.handleChange(this.state.selectedList)})}}catch{}};handleDefaultClear=()=>{DesmyCommons$1.isEmptyOrNull(this.props.defaultValue)&&!DesmyCommons$1.isEmptyOrNull(this.state.datalist)&&this.handleSelectAll()};handleEncrypt=A=>{if(this.props.enableDecrypt){const l=DesmyCommons$1.toString(A);return DesmyCommons$1.isEmptyOrNull(l)?A:l}return A};fetch=async()=>{const{request:A}=this.props;if(!A)return;const l=A.token;this.setState({isLoading:!0,error:{state:!1,message:""}});try{const t=(await axios.get(A.url,{headers:{"X-CSRFToken":DesmyAuth$1.getCookie("csrftoken"),Authorization:`Token ${l}`}})).data;t.success?(this.onClear(),this.props.handleChange&&this.props.handleChange(this.props.is_multiple?[]:emptyDropdownItem),this.setState({datalist:t.data,isLoading:!1},this.handleDefault)):this.handleError(t.message)}catch{this.handleError()}};handleError=(A="")=>{this.setState({isLoading:!1,error:{state:!0,message:A}})};onClear=()=>{this.setState({selectedMultiple:[],selectedList:emptyDropdownItem,clear:!0})};openDropdownPopover=()=>{this.props.disabled||this.setState(A=>({dropdownPopoverShow:!A.dropdownPopoverShow}),()=>{this.state.dropdownPopoverShow&&this.searchRef.current?.focus()})};closeDropdownPopover=()=>{this.setState({dropdownPopoverShow:!1})};handleSelectAll=()=>{this.props.handleChange&&this.props.handleChange(this.state.datalist),this.setState({selectedAll:!0,dropdownPopoverShow:!1})};handleClear=()=>{this.setState({selectedMultiple:[],selectedList:emptyDropdownItem,selectedAll:!1},()=>{this.props.handleClear&&this.props.handleClear(),this.closeDropdownPopover()})};handleSelectedItem=(A,l)=>{A.preventDefault();const o=!!this.props.is_multiple;let{selectedMultiple:t,selectedList:a}=this.state;o?(t.find(B=>B.id===l.id)?t=t.filter(B=>B.id!==l.id):t=[...t,l],this.setState({selectedMultiple:t,clear:!1,selectedAll:!1},()=>{this.props.handleChange&&this.props.handleChange(this.state.selectedMultiple)})):(a=l,this.setState({selectedList:a,clear:!1,selectedAll:!1},()=>{this.props.handleChange&&this.props.handleChange(this.state.selectedList)}),this.closeDropdownPopover()),this.props.handleDropdownChange&&this.props.handleDropdownChange(o?t:l,this.props.type),this.handleClearSearch()};handleClearSearch=()=>{this.setState(A=>({input:{...A.input,search:""},selectedAll:!1}))};handleClickAway=()=>{};render(){const{dropdownPopoverShow:A,datalist:l,input:o,selectedMultiple:t,selectedList:a,error:n,isLoading:B,selectedAll:R}=this.state,{placeholder:r,disabled:H,is_multiple:II,all:k,dropdownListClass:iI,onClear:lI,emptymessage:CI,containerClassName:sI,enableDecrypt:oI}=this.props;return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:`flex flex-col w-full relative bg-white dark:bg-darkBackground dark:text-white ${sI??""}`,ref:this.divRef,children:[jsxRuntimeExports.jsx(DropdownButton,{placeholder:r,disabled:H,selectedMultiple:t,selectedList:a,all:k,onClear:this.handleClear,selectedAll:R,onClick:this.openDropdownPopover,buttonRef:this.btnDropdownRef,dropdownPopoverShow:A}),jsxRuntimeExports.jsx(DropdownPositionWrapper,{targetRef:this.btnDropdownRef,visible:A,maxHeight:350,children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col relative space-y-2 max-w-[600px] min-w-[400px] font-poppinsRegular min-h-32  pb-5 pt-3 bg-white dark:bg-darkDialogBackground border-[1px] border-gray-200 dark:border-darkPrimaryBorder overflow-hidden",ref:this.dropdownContentRef,children:[jsxRuntimeExports.jsx(DropdownSearch,{searchValue:o.search,onChange:this.handleChange,inputRef:this.searchRef}),jsxRuntimeExports.jsx(DropdownList,{items:l,filterText:o.search,isMultiple:II,selectedMultiple:t,selectedSingle:a,allText:k,selectedAll:R,dropdownListClass:iI,onSelectAll:this.handleSelectAll,onClearSelected:this.handleClear,onSelectItem:this.handleSelectedItem,clearLabel:lI,error:n,isLoading:B,onRetry:this.fetch,emptyMessage:CI,enableDecrypt:oI,encryptHandler:this.handleEncrypt}),II&&l.length>0&&jsxRuntimeExports.jsx("div",{className:"flex w-full  my-4",children:jsxRuntimeExports.jsx("div",{onClick:this.closeDropdownPopover,className:"flex px-3 py-3 w-full text-black text-center justify-center rounded uppercase mx-2 cursor-pointer text-xs border border-gray-830 bg-white font-poppinsSemiBold",children:"Done"})})]})})]})})}}class Dialog extends React2.Component{constructor(A){super(A),this.state={isLoading:!1,loadinghint:"",data:{},value:{startDate:null,endDate:null},date:{show:!1,minDate:null,title:"",value:{startDate:null}},time:{show:!1,value:"",title:""},input:{user_input:""},data_value:"",datalist:{title:"",default_value:"",onchange:"",data:[]}}}async componentDidMount(){try{if(this.props.settings!==void 0){if(this.props.data!==void 0&&this.props.settings.showDateRange){let A={...this.state.value},l={...this.state.data};A.startDate=this.props.data.start_date,A.endDate=this.props.data.end_date,this.setState({value:A,data:l})}this.props.settings.forceLoading&&this.setState({isLoading:!0,loadinghint:this.props.settings.loadinghint}),this.props.settings.datalist!==void 0&&this.setState({data_value:this.props.settings.datalist.default_value,datalist:this.props.settings.datalist})}}catch{}}handleDataChange=A=>{const l=this.state.datalist.is_multiple!==void 0?Array.isArray(A)&&A.length>0?A.map(o=>o.id):[]:A;this.setState({data_value:l})};handleValueChange=A=>{try{const{data:l}=this.state;l.start_date=A.startDate,l.end_date=A.endDate,this.setState({data:l,value:A})}catch{}};handleClose=A=>{try{this.props.settings.loading&&A&&this.setState({isLoading:!0,loadinghint:this.props.settings.loadinghint});const l={...this.state.data,status:A};this.props.settings.datalist!==void 0&&(l.option_data=this.state.data_value),DesmyCommons$1.isEmptyOrNull(this.state.input.user_input)||(l.user_input=this.state.input.user_input),this.props.onClose(l)}catch{}};render(){const{settings:A}=this.props;return jsxRuntimeExports.jsx("div",{className:" w-full h-full font-poppinsRegular bg-white dark:bg-darkPrimary dark:text-white px-4 pt-5 pb-0 text-left shadow-xl transform transition-all sm:my-8 sm:p-6",children:this.state.isLoading?jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full h-48 justify-center text-primary dark:text-white items-center",children:[jsxRuntimeExports.jsx("svg",{version:"1.1",id:"L9",className:"w-24 h-24 ",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 100 100",enableBackground:"new 0 0 0 0",xmlSpace:"preserve",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50",children:jsxRuntimeExports.jsx("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})})}),jsxRuntimeExports.jsx("div",{className:"text-sm w-full text-black dark:text-white text-center justify-center",children:this.state.loadinghint})]}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full",children:[jsxRuntimeExports.jsxs("div",{className:"relative sm:flex sm:items-start items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex w-full flex-col mt-5 text-center sm:mt-0  sm:text-left items-center",children:[A.title!=null&&A.title!=null&&!DesmyCommons$1.isEmptyOrNull(A.title)?jsxRuntimeExports.jsx("div",{className:`flex w-full justify-center items-center text-start lg:justify-start text-md uppercase xl:text-base mt-1.5 ${A.type==DesmyState.ERROR?"text-red-600":"text-gray-900 dark:text-white"} font-poppinsBold`,children:A.title}):null,jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full my-5",children:[jsxRuntimeExports.jsx("div",{className:"flex w-full justify-start text-start items-start",children:this.props.children}),jsxRuntimeExports.jsx("div",{className:"flex w-full relative",children:A.datalist!=null&&(!DesmyCommons$1.isEmptyOrNull(A.datalist.url)||A.datalist.data!=null)?jsxRuntimeExports.jsx(DesmyDropdown,{data:A.datalist.data!=null?A.datalist.data:[],request:{url:`${DesmyCommons$1.isEmptyOrNull(A.datalist.url)?"":A.datalist.url}`},selectedData:this.state.data_value,defaultValue:A.datalist.default_value,handleChange:this.handleDataChange,is_multiple:A.datalist.is_multiple!==void 0?A.datalist.is_multiple:!1,containerClassName:DesmyCommons$1.isEmptyOrNull(this.props.containerDropDownClassName)?"bg-white dark:bg-darkPrimary":this.props.containerDropDownClassName,enableDecrypt:A.datalist.encrypted!==void 0?A.datalist.encrypted:!1,placeholder:`${A.datalist.title}`}):null})]})]}),this.props.settings.handleOnClose!==void 0?jsxRuntimeExports.jsx("div",{className:"absolute right-0 -top-2 cursor-pointer",onClick:()=>this.handleClose(!1),children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z",clipRule:"evenodd"})})}):null]}),jsxRuntimeExports.jsx("div",{className:"flex w-full justify-end",children:jsxRuntimeExports.jsxs("div",{className:"mt-4  sm:flex sm:flex-row-reverse",children:[A.btnPosition!=null&&A.btnPosition!==void 0&&!DesmyCommons$1.isEmptyOrNull(A.btnPosition)?jsxRuntimeExports.jsx("span",{className:"flex w-full rounded-md sm:ml-3 sm:w-auto",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>this.handleClose(!0),className:" uppercase inline-flex justify-center w-full rounded-md border border-transparent px-2 py-2 font-poppinsBold text-primary dark:text-white  focus:outline-none focus:shadow-outline-green transition ease-in-out duration-150 text-sm",children:A.btnPosition})}):null,A.btnNegative!=null&&A.btnNegative!==void 0&&!DesmyCommons$1.isEmptyOrNull(A.btnNegative)?jsxRuntimeExports.jsx("span",{className:"mt-3 flex w-full rounded-md sm:mt-0 sm:w-auto",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>this.handleClose(!1),className:"uppercase inline-flex justify-center w-full rounded-md border border-transparent px-2 py-2 font-poppinsBold text-primary dark:text-white  focus:outline-none focus:shadow-outline-green transition ease-in-out duration-150 text-sm",children:A.btnNegative})}):null]})})]})})}}class DesmyModalHandler extends React2.Component{modalContainer;constructor(A){super(A),this.state={loaded:!1,settings:{title:"",hint:"",zIndex:3e3,btnPosition:"",btnNegative:"",type:DesmyState.ERROR,loading:!1,forceLoading:!1,loadinghint:"",inputFieldLabel:"",showDateRange:!1,date:{show:!1,minDate:null,title:"",value:{startDate:new Date}},time:{show:!1,value:"",title:""},showDateRangeTitle:"",datalist:{title:"",url:"",default_value:"",onchange:"",data:[]}}},this.modalContainer=document.createElement("div"),this.modalContainer.className="modal-container"}componentDidMount(){try{const A={...this.state.settings},l=this.props.settings;l.title!==void 0&&(A.title=l.title),l.forceLoading!==void 0&&(A.forceLoading=l.forceLoading),l.hint!==void 0&&(A.hint=l.hint),l.handleOnClose!==void 0&&(A.handleOnClose=l.handleOnClose),l.btnPosition!==void 0&&(A.btnPosition=l.btnPosition),l.btnNegative!==void 0&&(A.btnNegative=l.btnNegative),l.type!==void 0&&(A.type=l.type),l.loading!==void 0&&(A.loading=l.loading),l.loadinghint!==void 0&&(A.loadinghint=l.loadinghint),l.showDateRange!==void 0&&(A.showDateRange=l.showDateRange),l.date!==void 0&&(A.date=l.date),l.time!==void 0&&(A.time=l.time),l.showDateRangeTitle!==void 0&&(A.showDateRangeTitle=l.showDateRangeTitle),l.inputFieldLabel!==void 0&&(A.inputFieldLabel=l.inputFieldLabel),l.zIndex!==void 0&&(A.zIndex=l.zIndex),l.datalist!==void 0&&(A.datalist=l.datalist),this.setState({settings:A,loaded:!0})}catch{}document.body.appendChild(this.modalContainer)}componentWillUnmount(){document.body.removeChild(this.modalContainer)}render(){const A=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"fixed z-[10000] inset-0 overflow-hidden w-dvw h-dvh flex justify-center items-center",children:jsxRuntimeExports.jsx("div",{className:"w-full h-screen flex justify-center items-center backdrop-blur-sm inset-0",children:jsxRuntimeExports.jsx("div",{className:"max-w-lg w-full",children:jsxRuntimeExports.jsx("div",{className:"w-full inline-block align-middle",children:jsxRuntimeExports.jsx(Dialog,{settings:this.props.settings,data:this.props.data,onClose:this.props.onClose,children:this.props.children})})})})})});return ReactDOM.createPortal(A,this.modalContainer)}}class DesmyAxiosService{axiosInstance=null;baseURL;constructor(A="/api"){this.baseURL=A}async loadAxios(){return this.axiosInstance||(this.axiosInstance=axios.create({baseURL:this.baseURL,timeout:1e5,headers:{"Content-Type":"application/json"}})),this.axiosInstance}async get(A,l={}){return(await this.loadAxios()).get(A,l)}async post(A,l,o={}){return(await this.loadAxios()).post(A,l,o)}async put(A,l,o={}){return(await this.loadAxios()).put(A,l,o)}async delete(A,l={}){return(await this.loadAxios()).delete(A,l)}}class DesmySuspenseWrapper extends React2.Component{render(){const{children:A,fallback:l}=this.props;return jsxRuntimeExports.jsx(React2.Suspense,{fallback:l??jsxRuntimeExports.jsx("div",{}),children:A})}}class DesmyPermissions{constructor(){}hasGrantedPermissions=(A,l,o)=>!A||!l.length?!1:A?.some(t=>t?.permissions.some(({name:a})=>l?.some(n=>a.toLowerCase()===n.toLowerCase())));hasUserGrantedPermissions=(A,l,o=!0)=>{if(!o)return!1;if(A?.has_access&&o)return!0;const t=A?.groups;return DesmyCommons$1.isEmptyOrNull(t)||DesmyCommons$1.isEmptyOrNull(l)?!1:t.some(a=>a.permissions?.some(({name:n})=>l.some(B=>n.toLowerCase()===B.toLowerCase())))};hasGrantedPermissionGroup=(A,l)=>!A||!l.length?!1:A.some(o=>l.some(t=>DesmyCommons$1.toString(o?.type).toLowerCase()===DesmyCommons$1.toString(t).toLowerCase()));hasUserGrantedPermissionGroup=(A,l,o=!0)=>{if(A?.has_access&&o)return!0;const t=A?.groups;return DesmyCommons$1.isEmptyOrNull(t)||DesmyCommons$1.isEmptyOrNull(l)?!1:t.some(a=>l.some(n=>DesmyCommons$1.toString(a?.type).toLowerCase()===DesmyCommons$1.toString(n).toLowerCase()))}}const DesmyPermissions$1=new DesmyPermissions,DesmyLazyloading=e=>React2.lazy(e),DesmyMultiStepModal=e=>{const{className:A="",isOpen:l,backdropClass:o="",children:t}=e;return jsxRuntimeExports.jsxs("div",{className:"flex w-full",children:[jsxRuntimeExports.jsx("div",{className:`${l?`backdrop bg-black/25 h-full w-full  ${o}`:"close-backdrop"}`}),jsxRuntimeExports.jsx("div",{className:`multi-step-modal-cover rounded-lg p-2 ${A} ${l?"open_modal":"close_modal"}`,children:jsxRuntimeExports.jsx("div",{children:t})})]})};class DesmyClickOutsideListener extends React2.Component{containerRef;constructor(A){super(A),this.containerRef=React2.createRef()}componentDidMount(){document.addEventListener("mousedown",this.handleClickOutside),document.addEventListener("touchstart",this.handleClickOutside)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside),document.removeEventListener("touchstart",this.handleClickOutside)}handleClickOutside=A=>{const l=this.containerRef.current;l&&(l.contains(A.target)||this.props.onClickOutside())};render(){return jsxRuntimeExports.jsx("div",{ref:this.containerRef,children:this.props.children})}}function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var A=1;A<arguments.length;A++){var l=arguments[A];for(var o in l)({}).hasOwnProperty.call(l,o)&&(e[o]=l[o])}return e},_extends.apply(null,arguments)}function _objectWithoutPropertiesLoose$2(e,A){if(e==null)return{};var l={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(A.indexOf(o)!==-1)continue;l[o]=e[o]}return l}function _setPrototypeOf$1(e,A){return _setPrototypeOf$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,o){return l.__proto__=o,l},_setPrototypeOf$1(e,A)}function _inheritsLoose(e,A){e.prototype=Object.create(A.prototype),e.prototype.constructor=e,_setPrototypeOf$1(e,A)}var propTypes={exports:{}},reactIs={exports:{}},reactIs_production_min={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactIs_production_min;function requireReactIs_production_min(){if(hasRequiredReactIs_production_min)return reactIs_production_min;hasRequiredReactIs_production_min=1;var e=typeof Symbol=="function"&&Symbol.for,A=e?Symbol.for("react.element"):60103,l=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,t=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,n=e?Symbol.for("react.provider"):60109,B=e?Symbol.for("react.context"):60110,R=e?Symbol.for("react.async_mode"):60111,r=e?Symbol.for("react.concurrent_mode"):60111,H=e?Symbol.for("react.forward_ref"):60112,II=e?Symbol.for("react.suspense"):60113,k=e?Symbol.for("react.suspense_list"):60120,iI=e?Symbol.for("react.memo"):60115,lI=e?Symbol.for("react.lazy"):60116,CI=e?Symbol.for("react.block"):60121,sI=e?Symbol.for("react.fundamental"):60117,oI=e?Symbol.for("react.responder"):60118,E=e?Symbol.for("react.scope"):60119;function _(M){if(typeof M=="object"&&M!==null){var O=M.$$typeof;switch(O){case A:switch(M=M.type,M){case R:case r:case o:case a:case t:case II:return M;default:switch(M=M&&M.$$typeof,M){case B:case H:case lI:case iI:case n:return M;default:return O}}case l:return O}}}function gI(M){return _(M)===r}return reactIs_production_min.AsyncMode=R,reactIs_production_min.ConcurrentMode=r,reactIs_production_min.ContextConsumer=B,reactIs_production_min.ContextProvider=n,reactIs_production_min.Element=A,reactIs_production_min.ForwardRef=H,reactIs_production_min.Fragment=o,reactIs_production_min.Lazy=lI,reactIs_production_min.Memo=iI,reactIs_production_min.Portal=l,reactIs_production_min.Profiler=a,reactIs_production_min.StrictMode=t,reactIs_production_min.Suspense=II,reactIs_production_min.isAsyncMode=function(M){return gI(M)||_(M)===R},reactIs_production_min.isConcurrentMode=gI,reactIs_production_min.isContextConsumer=function(M){return _(M)===B},reactIs_production_min.isContextProvider=function(M){return _(M)===n},reactIs_production_min.isElement=function(M){return typeof M=="object"&&M!==null&&M.$$typeof===A},reactIs_production_min.isForwardRef=function(M){return _(M)===H},reactIs_production_min.isFragment=function(M){return _(M)===o},reactIs_production_min.isLazy=function(M){return _(M)===lI},reactIs_production_min.isMemo=function(M){return _(M)===iI},reactIs_production_min.isPortal=function(M){return _(M)===l},reactIs_production_min.isProfiler=function(M){return _(M)===a},reactIs_production_min.isStrictMode=function(M){return _(M)===t},reactIs_production_min.isSuspense=function(M){return _(M)===II},reactIs_production_min.isValidElementType=function(M){return typeof M=="string"||typeof M=="function"||M===o||M===r||M===a||M===t||M===II||M===k||typeof M=="object"&&M!==null&&(M.$$typeof===lI||M.$$typeof===iI||M.$$typeof===n||M.$$typeof===B||M.$$typeof===H||M.$$typeof===sI||M.$$typeof===oI||M.$$typeof===E||M.$$typeof===CI)},reactIs_production_min.typeOf=_,reactIs_production_min}var reactIs_development={};/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactIs_development;function requireReactIs_development(){return hasRequiredReactIs_development||(hasRequiredReactIs_development=1,process.env.NODE_ENV!=="production"&&function(){var e=typeof Symbol=="function"&&Symbol.for,A=e?Symbol.for("react.element"):60103,l=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,t=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,n=e?Symbol.for("react.provider"):60109,B=e?Symbol.for("react.context"):60110,R=e?Symbol.for("react.async_mode"):60111,r=e?Symbol.for("react.concurrent_mode"):60111,H=e?Symbol.for("react.forward_ref"):60112,II=e?Symbol.for("react.suspense"):60113,k=e?Symbol.for("react.suspense_list"):60120,iI=e?Symbol.for("react.memo"):60115,lI=e?Symbol.for("react.lazy"):60116,CI=e?Symbol.for("react.block"):60121,sI=e?Symbol.for("react.fundamental"):60117,oI=e?Symbol.for("react.responder"):60118,E=e?Symbol.for("react.scope"):60119;function _(nI){return typeof nI=="string"||typeof nI=="function"||nI===o||nI===r||nI===a||nI===t||nI===II||nI===k||typeof nI=="object"&&nI!==null&&(nI.$$typeof===lI||nI.$$typeof===iI||nI.$$typeof===n||nI.$$typeof===B||nI.$$typeof===H||nI.$$typeof===sI||nI.$$typeof===oI||nI.$$typeof===E||nI.$$typeof===CI)}function gI(nI){if(typeof nI=="object"&&nI!==null){var uI=nI.$$typeof;switch(uI){case A:var rI=nI.type;switch(rI){case R:case r:case o:case a:case t:case II:return rI;default:var FI=rI&&rI.$$typeof;switch(FI){case B:case H:case lI:case iI:case n:return FI;default:return uI}}case l:return uI}}}var M=R,O=r,dI=B,eI=n,aI=A,WI=H,GI=o,HI=lI,MI=iI,KI=l,DI=a,NI=t,yI=II,VI=!1;function hI(nI){return VI||(VI=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),wI(nI)||gI(nI)===R}function wI(nI){return gI(nI)===r}function pI(nI){return gI(nI)===B}function xI(nI){return gI(nI)===n}function PI(nI){return typeof nI=="object"&&nI!==null&&nI.$$typeof===A}function XI(nI){return gI(nI)===H}function tI(nI){return gI(nI)===o}function mI(nI){return gI(nI)===lI}function YI(nI){return gI(nI)===iI}function BI(nI){return gI(nI)===l}function AI(nI){return gI(nI)===a}function cI(nI){return gI(nI)===t}function bI(nI){return gI(nI)===II}reactIs_development.AsyncMode=M,reactIs_development.ConcurrentMode=O,reactIs_development.ContextConsumer=dI,reactIs_development.ContextProvider=eI,reactIs_development.Element=aI,reactIs_development.ForwardRef=WI,reactIs_development.Fragment=GI,reactIs_development.Lazy=HI,reactIs_development.Memo=MI,reactIs_development.Portal=KI,reactIs_development.Profiler=DI,reactIs_development.StrictMode=NI,reactIs_development.Suspense=yI,reactIs_development.isAsyncMode=hI,reactIs_development.isConcurrentMode=wI,reactIs_development.isContextConsumer=pI,reactIs_development.isContextProvider=xI,reactIs_development.isElement=PI,reactIs_development.isForwardRef=XI,reactIs_development.isFragment=tI,reactIs_development.isLazy=mI,reactIs_development.isMemo=YI,reactIs_development.isPortal=BI,reactIs_development.isProfiler=AI,reactIs_development.isStrictMode=cI,reactIs_development.isSuspense=bI,reactIs_development.isValidElementType=_,reactIs_development.typeOf=gI}()),reactIs_development}var hasRequiredReactIs;function requireReactIs(){return hasRequiredReactIs||(hasRequiredReactIs=1,process.env.NODE_ENV==="production"?reactIs.exports=requireReactIs_production_min():reactIs.exports=requireReactIs_development()),reactIs.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var objectAssign,hasRequiredObjectAssign;function requireObjectAssign(){if(hasRequiredObjectAssign)return objectAssign;hasRequiredObjectAssign=1;var e=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable;function o(a){if(a==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function t(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de",Object.getOwnPropertyNames(a)[0]==="5")return!1;for(var n={},B=0;B<10;B++)n["_"+String.fromCharCode(B)]=B;var R=Object.getOwnPropertyNames(n).map(function(H){return n[H]});if(R.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(H){r[H]=H}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return objectAssign=t()?Object.assign:function(a,n){for(var B,R=o(a),r,H=1;H<arguments.length;H++){B=Object(arguments[H]);for(var II in B)A.call(B,II)&&(R[II]=B[II]);if(e){r=e(B);for(var k=0;k<r.length;k++)l.call(B,r[k])&&(R[r[k]]=B[r[k]])}}return R},objectAssign}var ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=e,ReactPropTypesSecret_1}var has,hasRequiredHas;function requireHas(){return hasRequiredHas||(hasRequiredHas=1,has=Function.call.bind(Object.prototype.hasOwnProperty)),has}var checkPropTypes_1,hasRequiredCheckPropTypes;function requireCheckPropTypes(){if(hasRequiredCheckPropTypes)return checkPropTypes_1;hasRequiredCheckPropTypes=1;var e=function(){};if(process.env.NODE_ENV!=="production"){var A=requireReactPropTypesSecret(),l={},o=requireHas();e=function(a){var n="Warning: "+a;typeof console<"u"&&console.error(n);try{throw new Error(n)}catch{}}}function t(a,n,B,R,r){if(process.env.NODE_ENV!=="production"){for(var H in a)if(o(a,H)){var II;try{if(typeof a[H]!="function"){var k=Error((R||"React class")+": "+B+" type `"+H+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof a[H]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw k.name="Invariant Violation",k}II=a[H](n,H,R,B,null,A)}catch(lI){II=lI}if(II&&!(II instanceof Error)&&e((R||"React class")+": type specification of "+B+" `"+H+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof II+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),II instanceof Error&&!(II.message in l)){l[II.message]=!0;var iI=r?r():"";e("Failed "+B+" type: "+II.message+(iI??""))}}}}return t.resetWarningCache=function(){process.env.NODE_ENV!=="production"&&(l={})},checkPropTypes_1=t,checkPropTypes_1}var factoryWithTypeCheckers,hasRequiredFactoryWithTypeCheckers;function requireFactoryWithTypeCheckers(){if(hasRequiredFactoryWithTypeCheckers)return factoryWithTypeCheckers;hasRequiredFactoryWithTypeCheckers=1;var e=requireReactIs(),A=requireObjectAssign(),l=requireReactPropTypesSecret(),o=requireHas(),t=requireCheckPropTypes(),a=function(){};process.env.NODE_ENV!=="production"&&(a=function(B){var R="Warning: "+B;typeof console<"u"&&console.error(R);try{throw new Error(R)}catch{}});function n(){return null}return factoryWithTypeCheckers=function(B,R){var r=typeof Symbol=="function"&&Symbol.iterator,H="@@iterator";function II(wI){var pI=wI&&(r&&wI[r]||wI[H]);if(typeof pI=="function")return pI}var k="<<anonymous>>",iI={array:oI("array"),bigint:oI("bigint"),bool:oI("boolean"),func:oI("function"),number:oI("number"),object:oI("object"),string:oI("string"),symbol:oI("symbol"),any:E(),arrayOf:_,element:gI(),elementType:M(),instanceOf:O,node:WI(),objectOf:eI,oneOf:dI,oneOfType:aI,shape:HI,exact:MI};function lI(wI,pI){return wI===pI?wI!==0||1/wI===1/pI:wI!==wI&&pI!==pI}function CI(wI,pI){this.message=wI,this.data=pI&&typeof pI=="object"?pI:{},this.stack=""}CI.prototype=Error.prototype;function sI(wI){if(process.env.NODE_ENV!=="production")var pI={},xI=0;function PI(tI,mI,YI,BI,AI,cI,bI){if(BI=BI||k,cI=cI||YI,bI!==l){if(R){var nI=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw nI.name="Invariant Violation",nI}else if(process.env.NODE_ENV!=="production"&&typeof console<"u"){var uI=BI+":"+YI;!pI[uI]&&xI<3&&(a("You are manually calling a React.PropTypes validation function for the `"+cI+"` prop on `"+BI+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),pI[uI]=!0,xI++)}}return mI[YI]==null?tI?mI[YI]===null?new CI("The "+AI+" `"+cI+"` is marked as required "+("in `"+BI+"`, but its value is `null`.")):new CI("The "+AI+" `"+cI+"` is marked as required in "+("`"+BI+"`, but its value is `undefined`.")):null:wI(mI,YI,BI,AI,cI)}var XI=PI.bind(null,!1);return XI.isRequired=PI.bind(null,!0),XI}function oI(wI){function pI(xI,PI,XI,tI,mI,YI){var BI=xI[PI],AI=NI(BI);if(AI!==wI){var cI=yI(BI);return new CI("Invalid "+tI+" `"+mI+"` of type "+("`"+cI+"` supplied to `"+XI+"`, expected ")+("`"+wI+"`."),{expectedType:wI})}return null}return sI(pI)}function E(){return sI(n)}function _(wI){function pI(xI,PI,XI,tI,mI){if(typeof wI!="function")return new CI("Property `"+mI+"` of component `"+XI+"` has invalid PropType notation inside arrayOf.");var YI=xI[PI];if(!Array.isArray(YI)){var BI=NI(YI);return new CI("Invalid "+tI+" `"+mI+"` of type "+("`"+BI+"` supplied to `"+XI+"`, expected an array."))}for(var AI=0;AI<YI.length;AI++){var cI=wI(YI,AI,XI,tI,mI+"["+AI+"]",l);if(cI instanceof Error)return cI}return null}return sI(pI)}function gI(){function wI(pI,xI,PI,XI,tI){var mI=pI[xI];if(!B(mI)){var YI=NI(mI);return new CI("Invalid "+XI+" `"+tI+"` of type "+("`"+YI+"` supplied to `"+PI+"`, expected a single ReactElement."))}return null}return sI(wI)}function M(){function wI(pI,xI,PI,XI,tI){var mI=pI[xI];if(!e.isValidElementType(mI)){var YI=NI(mI);return new CI("Invalid "+XI+" `"+tI+"` of type "+("`"+YI+"` supplied to `"+PI+"`, expected a single ReactElement type."))}return null}return sI(wI)}function O(wI){function pI(xI,PI,XI,tI,mI){if(!(xI[PI]instanceof wI)){var YI=wI.name||k,BI=hI(xI[PI]);return new CI("Invalid "+tI+" `"+mI+"` of type "+("`"+BI+"` supplied to `"+XI+"`, expected ")+("instance of `"+YI+"`."))}return null}return sI(pI)}function dI(wI){if(!Array.isArray(wI))return process.env.NODE_ENV!=="production"&&(arguments.length>1?a("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):a("Invalid argument supplied to oneOf, expected an array.")),n;function pI(xI,PI,XI,tI,mI){for(var YI=xI[PI],BI=0;BI<wI.length;BI++)if(lI(YI,wI[BI]))return null;var AI=JSON.stringify(wI,function(bI,nI){var uI=yI(nI);return uI==="symbol"?String(nI):nI});return new CI("Invalid "+tI+" `"+mI+"` of value `"+String(YI)+"` "+("supplied to `"+XI+"`, expected one of "+AI+"."))}return sI(pI)}function eI(wI){function pI(xI,PI,XI,tI,mI){if(typeof wI!="function")return new CI("Property `"+mI+"` of component `"+XI+"` has invalid PropType notation inside objectOf.");var YI=xI[PI],BI=NI(YI);if(BI!=="object")return new CI("Invalid "+tI+" `"+mI+"` of type "+("`"+BI+"` supplied to `"+XI+"`, expected an object."));for(var AI in YI)if(o(YI,AI)){var cI=wI(YI,AI,XI,tI,mI+"."+AI,l);if(cI instanceof Error)return cI}return null}return sI(pI)}function aI(wI){if(!Array.isArray(wI))return process.env.NODE_ENV!=="production"&&a("Invalid argument supplied to oneOfType, expected an instance of array."),n;for(var pI=0;pI<wI.length;pI++){var xI=wI[pI];if(typeof xI!="function")return a("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+VI(xI)+" at index "+pI+"."),n}function PI(XI,tI,mI,YI,BI){for(var AI=[],cI=0;cI<wI.length;cI++){var bI=wI[cI],nI=bI(XI,tI,mI,YI,BI,l);if(nI==null)return null;nI.data&&o(nI.data,"expectedType")&&AI.push(nI.data.expectedType)}var uI=AI.length>0?", expected one of type ["+AI.join(", ")+"]":"";return new CI("Invalid "+YI+" `"+BI+"` supplied to "+("`"+mI+"`"+uI+"."))}return sI(PI)}function WI(){function wI(pI,xI,PI,XI,tI){return KI(pI[xI])?null:new CI("Invalid "+XI+" `"+tI+"` supplied to "+("`"+PI+"`, expected a ReactNode."))}return sI(wI)}function GI(wI,pI,xI,PI,XI){return new CI((wI||"React class")+": "+pI+" type `"+xI+"."+PI+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+XI+"`.")}function HI(wI){function pI(xI,PI,XI,tI,mI){var YI=xI[PI],BI=NI(YI);if(BI!=="object")return new CI("Invalid "+tI+" `"+mI+"` of type `"+BI+"` "+("supplied to `"+XI+"`, expected `object`."));for(var AI in wI){var cI=wI[AI];if(typeof cI!="function")return GI(XI,tI,mI,AI,yI(cI));var bI=cI(YI,AI,XI,tI,mI+"."+AI,l);if(bI)return bI}return null}return sI(pI)}function MI(wI){function pI(xI,PI,XI,tI,mI){var YI=xI[PI],BI=NI(YI);if(BI!=="object")return new CI("Invalid "+tI+" `"+mI+"` of type `"+BI+"` "+("supplied to `"+XI+"`, expected `object`."));var AI=A({},xI[PI],wI);for(var cI in AI){var bI=wI[cI];if(o(wI,cI)&&typeof bI!="function")return GI(XI,tI,mI,cI,yI(bI));if(!bI)return new CI("Invalid "+tI+" `"+mI+"` key `"+cI+"` supplied to `"+XI+"`.\nBad object: "+JSON.stringify(xI[PI],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(wI),null,"  "));var nI=bI(YI,cI,XI,tI,mI+"."+cI,l);if(nI)return nI}return null}return sI(pI)}function KI(wI){switch(typeof wI){case"number":case"string":case"undefined":return!0;case"boolean":return!wI;case"object":if(Array.isArray(wI))return wI.every(KI);if(wI===null||B(wI))return!0;var pI=II(wI);if(pI){var xI=pI.call(wI),PI;if(pI!==wI.entries){for(;!(PI=xI.next()).done;)if(!KI(PI.value))return!1}else for(;!(PI=xI.next()).done;){var XI=PI.value;if(XI&&!KI(XI[1]))return!1}}else return!1;return!0;default:return!1}}function DI(wI,pI){return wI==="symbol"?!0:pI?pI["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&pI instanceof Symbol:!1}function NI(wI){var pI=typeof wI;return Array.isArray(wI)?"array":wI instanceof RegExp?"object":DI(pI,wI)?"symbol":pI}function yI(wI){if(typeof wI>"u"||wI===null)return""+wI;var pI=NI(wI);if(pI==="object"){if(wI instanceof Date)return"date";if(wI instanceof RegExp)return"regexp"}return pI}function VI(wI){var pI=yI(wI);switch(pI){case"array":case"object":return"an "+pI;case"boolean":case"date":case"regexp":return"a "+pI;default:return pI}}function hI(wI){return!wI.constructor||!wI.constructor.name?k:wI.constructor.name}return iI.checkPropTypes=t,iI.resetWarningCache=t.resetWarningCache,iI.PropTypes=iI,iI},factoryWithTypeCheckers}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var e=requireReactPropTypesSecret();function A(){}function l(){}return l.resetWarningCache=A,factoryWithThrowingShims=function(){function o(n,B,R,r,H,II){if(II!==e){var k=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw k.name="Invariant Violation",k}}o.isRequired=o;function t(){return o}var a={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:t,element:o,elementType:o,instanceOf:t,node:o,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:l,resetWarningCache:A};return a.PropTypes=a,a},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){if(hasRequiredPropTypes)return propTypes.exports;if(hasRequiredPropTypes=1,process.env.NODE_ENV!=="production"){var e=requireReactIs(),A=!0;propTypes.exports=requireFactoryWithTypeCheckers()(e.isElement,A)}else propTypes.exports=requireFactoryWithThrowingShims()();return propTypes.exports}var propTypesExports=requirePropTypes();const PropTypes=getDefaultExportFromCjs(propTypesExports);function hasClass(e,A){return e.classList?!!A&&e.classList.contains(A):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+A+" ")!==-1}function addClass(e,A){e.classList?e.classList.add(A):hasClass(e,A)||(typeof e.className=="string"?e.className=e.className+" "+A:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+A))}function replaceClassName(e,A){return e.replace(new RegExp("(^|\\s)"+A+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function removeClass$1(e,A){e.classList?e.classList.remove(A):typeof e.className=="string"?e.className=replaceClassName(e.className,A):e.setAttribute("class",replaceClassName(e.className&&e.className.baseVal||"",A))}const config$1={disabled:!1};var timeoutsShape=process.env.NODE_ENV!=="production"?PropTypes.oneOfType([PropTypes.number,PropTypes.shape({enter:PropTypes.number,exit:PropTypes.number,appear:PropTypes.number}).isRequired]):null,classNamesShape=process.env.NODE_ENV!=="production"?PropTypes.oneOfType([PropTypes.string,PropTypes.shape({enter:PropTypes.string,exit:PropTypes.string,active:PropTypes.string}),PropTypes.shape({enter:PropTypes.string,enterDone:PropTypes.string,enterActive:PropTypes.string,exit:PropTypes.string,exitDone:PropTypes.string,exitActive:PropTypes.string})]):null;const TransitionGroupContext=React2.createContext(null);var forceReflow=function e(A){return A.scrollTop},UNMOUNTED="unmounted",EXITED="exited",ENTERING="entering",ENTERED="entered",EXITING="exiting",Transition=function(e){_inheritsLoose(A,e);function A(o,t){var a;a=e.call(this,o,t)||this;var n=t,B=n&&!n.isMounting?o.enter:o.appear,R;return a.appearStatus=null,o.in?B?(R=EXITED,a.appearStatus=ENTERING):R=ENTERED:o.unmountOnExit||o.mountOnEnter?R=UNMOUNTED:R=EXITED,a.state={status:R},a.nextCallback=null,a}A.getDerivedStateFromProps=function(t,a){var n=t.in;return n&&a.status===UNMOUNTED?{status:EXITED}:null};var l=A.prototype;return l.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},l.componentDidUpdate=function(t){var a=null;if(t!==this.props){var n=this.state.status;this.props.in?n!==ENTERING&&n!==ENTERED&&(a=ENTERING):(n===ENTERING||n===ENTERED)&&(a=EXITING)}this.updateStatus(!1,a)},l.componentWillUnmount=function(){this.cancelNextCallback()},l.getTimeouts=function(){var t=this.props.timeout,a,n,B;return a=n=B=t,t!=null&&typeof t!="number"&&(a=t.exit,n=t.enter,B=t.appear!==void 0?t.appear:n),{exit:a,enter:n,appear:B}},l.updateStatus=function(t,a){if(t===void 0&&(t=!1),a!==null)if(this.cancelNextCallback(),a===ENTERING){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this);n&&forceReflow(n)}this.performEnter(t)}else this.performExit();else this.props.unmountOnExit&&this.state.status===EXITED&&this.setState({status:UNMOUNTED})},l.performEnter=function(t){var a=this,n=this.props.enter,B=this.context?this.context.isMounting:t,R=this.props.nodeRef?[B]:[ReactDOM.findDOMNode(this),B],r=R[0],H=R[1],II=this.getTimeouts(),k=B?II.appear:II.enter;if(!t&&!n||config$1.disabled){this.safeSetState({status:ENTERED},function(){a.props.onEntered(r)});return}this.props.onEnter(r,H),this.safeSetState({status:ENTERING},function(){a.props.onEntering(r,H),a.onTransitionEnd(k,function(){a.safeSetState({status:ENTERED},function(){a.props.onEntered(r,H)})})})},l.performExit=function(){var t=this,a=this.props.exit,n=this.getTimeouts(),B=this.props.nodeRef?void 0:ReactDOM.findDOMNode(this);if(!a||config$1.disabled){this.safeSetState({status:EXITED},function(){t.props.onExited(B)});return}this.props.onExit(B),this.safeSetState({status:EXITING},function(){t.props.onExiting(B),t.onTransitionEnd(n.exit,function(){t.safeSetState({status:EXITED},function(){t.props.onExited(B)})})})},l.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},l.safeSetState=function(t,a){a=this.setNextCallback(a),this.setState(t,a)},l.setNextCallback=function(t){var a=this,n=!0;return this.nextCallback=function(B){n&&(n=!1,a.nextCallback=null,t(B))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},l.onTransitionEnd=function(t,a){this.setNextCallback(a);var n=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this),B=t==null&&!this.props.addEndListener;if(!n||B){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var R=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],r=R[0],H=R[1];this.props.addEndListener(r,H)}t!=null&&setTimeout(this.nextCallback,t)},l.render=function(){var t=this.state.status;if(t===UNMOUNTED)return null;var a=this.props,n=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var B=_objectWithoutPropertiesLoose$2(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React2.createElement(TransitionGroupContext.Provider,{value:null},typeof n=="function"?n(t,B):React2.cloneElement(React2.Children.only(n),B))},A}(React2.Component);Transition.contextType=TransitionGroupContext,Transition.propTypes=process.env.NODE_ENV!=="production"?{nodeRef:PropTypes.shape({current:typeof Element>"u"?PropTypes.any:function(e,A,l,o,t,a){var n=e[A];return PropTypes.instanceOf(n&&"ownerDocument"in n?n.ownerDocument.defaultView.Element:Element)(e,A,l,o,t,a)}}),children:PropTypes.oneOfType([PropTypes.func.isRequired,PropTypes.element.isRequired]).isRequired,in:PropTypes.bool,mountOnEnter:PropTypes.bool,unmountOnExit:PropTypes.bool,appear:PropTypes.bool,enter:PropTypes.bool,exit:PropTypes.bool,timeout:function e(A){var l=timeoutsShape;A.addEndListener||(l=l.isRequired);for(var o=arguments.length,t=new Array(o>1?o-1:0),a=1;a<o;a++)t[a-1]=arguments[a];return l.apply(void 0,[A].concat(t))},addEndListener:PropTypes.func,onEnter:PropTypes.func,onEntering:PropTypes.func,onEntered:PropTypes.func,onExit:PropTypes.func,onExiting:PropTypes.func,onExited:PropTypes.func}:{};function noop$1(){}Transition.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:noop$1,onEntering:noop$1,onEntered:noop$1,onExit:noop$1,onExiting:noop$1,onExited:noop$1},Transition.UNMOUNTED=UNMOUNTED,Transition.EXITED=EXITED,Transition.ENTERING=ENTERING,Transition.ENTERED=ENTERED,Transition.EXITING=EXITING;var _addClass=function e(A,l){return A&&l&&l.split(" ").forEach(function(o){return addClass(A,o)})},removeClass=function e(A,l){return A&&l&&l.split(" ").forEach(function(o){return removeClass$1(A,o)})},CSSTransition=function(e){_inheritsLoose(A,e);function A(){for(var o,t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return o=e.call.apply(e,[this].concat(a))||this,o.appliedClasses={appear:{},enter:{},exit:{}},o.onEnter=function(B,R){var r=o.resolveArguments(B,R),H=r[0],II=r[1];o.removeClasses(H,"exit"),o.addClass(H,II?"appear":"enter","base"),o.props.onEnter&&o.props.onEnter(B,R)},o.onEntering=function(B,R){var r=o.resolveArguments(B,R),H=r[0],II=r[1],k=II?"appear":"enter";o.addClass(H,k,"active"),o.props.onEntering&&o.props.onEntering(B,R)},o.onEntered=function(B,R){var r=o.resolveArguments(B,R),H=r[0],II=r[1],k=II?"appear":"enter";o.removeClasses(H,k),o.addClass(H,k,"done"),o.props.onEntered&&o.props.onEntered(B,R)},o.onExit=function(B){var R=o.resolveArguments(B),r=R[0];o.removeClasses(r,"appear"),o.removeClasses(r,"enter"),o.addClass(r,"exit","base"),o.props.onExit&&o.props.onExit(B)},o.onExiting=function(B){var R=o.resolveArguments(B),r=R[0];o.addClass(r,"exit","active"),o.props.onExiting&&o.props.onExiting(B)},o.onExited=function(B){var R=o.resolveArguments(B),r=R[0];o.removeClasses(r,"exit"),o.addClass(r,"exit","done"),o.props.onExited&&o.props.onExited(B)},o.resolveArguments=function(B,R){return o.props.nodeRef?[o.props.nodeRef.current,B]:[B,R]},o.getClassNames=function(B){var R=o.props.classNames,r=typeof R=="string",H=r&&R?R+"-":"",II=r?""+H+B:R[B],k=r?II+"-active":R[B+"Active"],iI=r?II+"-done":R[B+"Done"];return{baseClassName:II,activeClassName:k,doneClassName:iI}},o}var l=A.prototype;return l.addClass=function(t,a,n){var B=this.getClassNames(a)[n+"ClassName"],R=this.getClassNames("enter"),r=R.doneClassName;a==="appear"&&n==="done"&&r&&(B+=" "+r),n==="active"&&t&&forceReflow(t),B&&(this.appliedClasses[a][n]=B,_addClass(t,B))},l.removeClasses=function(t,a){var n=this.appliedClasses[a],B=n.base,R=n.active,r=n.done;this.appliedClasses[a]={},B&&removeClass(t,B),R&&removeClass(t,R),r&&removeClass(t,r)},l.render=function(){var t=this.props;t.classNames;var a=_objectWithoutPropertiesLoose$2(t,["classNames"]);return React2.createElement(Transition,_extends({},a,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},A}(React2.Component);CSSTransition.defaultProps={classNames:""},CSSTransition.propTypes=process.env.NODE_ENV!=="production"?_extends({},Transition.propTypes,{classNames:classNamesShape,onEnter:PropTypes.func,onEntering:PropTypes.func,onEntered:PropTypes.func,onExit:PropTypes.func,onExiting:PropTypes.func,onExited:PropTypes.func}):{};function Mt(e){if(typeof document>"u")return;let A=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",A.firstChild?A.insertBefore(l,A.firstChild):A.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}Mt(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var L$1=e=>typeof e=="number"&&!isNaN(e),N=e=>typeof e=="string",P=e=>typeof e=="function",mt=e=>N(e)||L$1(e),z=e=>React2.isValidElement(e)||N(e)||P(e)||L$1(e),Xt=1,at=()=>`${Xt++}`,I$1=new Map,F$1=[],st=new Set,bt=()=>I$1.size>0,vt=(e,{containerId:A})=>{var l;return(l=I$1.get(A||1))==null?void 0:l.toasts.get(e)};function X$1(e,A){var l;if(A)return!!((l=I$1.get(A))!=null&&l.isToastActive(e));let o=!1;return I$1.forEach(t=>{t.isToastActive(e)&&(o=!0)}),o}function ht(e){if(!bt()){F$1=F$1.filter(A=>e!=null&&A.options.toastId!==e);return}if(e==null||mt(e))I$1.forEach(A=>{A.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let A=I$1.get(e.containerId);A?A.removeToast(e.id):I$1.forEach(l=>{l.removeToast(e.id)})}}var Ct=(e={})=>{I$1.forEach(A=>{A.props.limit&&(!e.containerId||A.id===e.containerId)&&A.clearQueue()})};function nt(e,A){z(e)&&(bt()||F$1.push({content:e,options:A}),I$1.forEach(l=>{l.buildToast(e,A)}))}function rt(e,A){I$1.forEach(l=>{(A==null||!(A!=null&&A.containerId)||A?.containerId===l.id)&&l.toggle(e,A?.id)})}function Pt(e){return st.add(e),()=>{st.delete(e)}}function Wt(e){return e&&(N(e.toastId)||L$1(e.toastId))?e.toastId:at()}function U$1(e,A){return nt(e,A),A.toastId}function V$1(e,A){return{...A,type:A&&A.type||e,toastId:Wt(A)}}function Q$1(e){return(A,l)=>U$1(A,V$1(e,l))}function y$1(e,A){return U$1(e,V$1("default",A))}y$1.loading=(e,A)=>U$1(e,V$1("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...A}));function Gt(e,{pending:A,error:l,success:o},t){let a;A&&(a=N(A)?y$1.loading(A,t):y$1.loading(A.render,{...t,...A}));let n={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},B=(r,H,II)=>{if(H==null){y$1.dismiss(a);return}let k={type:r,...n,...t,data:II},iI=N(H)?{render:H}:H;return a?y$1.update(a,{...k,...iI}):y$1(iI.render,{...k,...iI}),II},R=P(e)?e():e;return R.then(r=>B("success",o,r)).catch(r=>B("error",l,r)),R}y$1.promise=Gt,y$1.success=Q$1("success"),y$1.info=Q$1("info"),y$1.error=Q$1("error"),y$1.warning=Q$1("warning"),y$1.warn=y$1.warning,y$1.dark=(e,A)=>U$1(e,V$1("default",{theme:"dark",...A}));function qt(e){ht(e)}y$1.dismiss=qt,y$1.clearWaitingQueue=Ct,y$1.isActive=X$1,y$1.update=(e,A={})=>{let l=vt(e,A);if(l){let{props:o,content:t}=l,a={delay:100,...o,...A,toastId:A.toastId||e,updateId:at()};a.toastId!==e&&(a.staleId=e);let n=a.render||t;delete a.render,U$1(n,a)}},y$1.done=e=>{y$1.update(e,{progress:1})},y$1.onChange=Pt,y$1.play=e=>rt(!0,e),y$1.pause=e=>rt(!1,e);class DesmyModalContainer extends React2.Component{isMounted;isClose;abortController;constructor(A){super(A),this.isMounted=!1,this.isClose=this.props.close??!0,this.state={isOpen:!1,hasRequest:!1},setTimeout(()=>{this.isMounted&&this.setState({isOpen:!0})},300)}componentDidMount(){this.isMounted=!0,this.isClose=this.props.close??!0}componentWillUnmount(){this.isMounted=!1,this.abortController?.abort()}handleClose=()=>{this.isClose?(this.isMounted&&this.setState({isOpen:!1}),setTimeout(()=>{this.isMounted&&this.props.onClose()},300)):this.props.onClose()};handleDelete=()=>{const A={title:"Confirmation!",btnPosition:"delete",btnNegative:"cancel",type:DesmyState.NOTICE},l=t=>{this.state.hasRequest||(t.status&&this.handleDeleteRequest(),this.setState({modal:null}))},o=jsxRuntimeExports.jsx(DesmyModalHandler,{settings:A,onClose:l,children:jsxRuntimeExports.jsxs("div",{className:"w-full py-2 text-sm",children:["Are you sure you want to delete",jsxRuntimeExports.jsxs("span",{className:"text-red-500 ml-1 font-poppinsBold",children:[this.props.delete?.name,"?"]})]})});this.setState({modal:o})};handleDeleteRequest=()=>{if(!this.props.delete)return;this.abortController=new AbortController;const A=this.abortController.signal;this.setState({hasRequest:!0});try{axios.delete(this.props.delete.url,{headers:{"X-CSRFToken":`${DesmyAuth$1.getCookie("csrftoken")}`,Authorization:`Token ${DesmyAuth$1.get(DesmyState.ACCESS_TOKEN)}`,Accept:"application/json"},signal:A}).then(l=>{this.isMounted&&this.handleAlert(l.data.message,l.data.success)}).catch(l=>{axios.isCancel(l)?console.log("Request canceled:",l.message):this.isMounted&&this.handleAlert()})}catch{this.isMounted&&this.handleAlert()}};handleAlert=(A="",l=!1)=>{const o=DesmyCommons$1.isEmptyOrNull(A)?DesmyState.ERROR_MESSAGE:A;this.isMounted&&this.setState({hasRequest:!1},()=>{l?(y$1.success(o),this.props.onSuccess!==void 0&&this.props.onSuccess(A)):this.props.onError&&this.props.onError(A)})};handleOnClose=()=>{};render(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[this.state.modal,jsxRuntimeExports.jsx(DesmyClickOutsideListener,{onClickOutside:this.handleOnClose,children:jsxRuntimeExports.jsx(DesmyMultiStepModal,{isOpen:this.state.isOpen,onClose:this.handleClose,backdropClass:this.props.backdropClass,className:this.props.className,children:jsxRuntimeExports.jsx(CSSTransition,{unmountOnExit:!0,in:!0,timeout:400,classNames:"modal-content",children:jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{className:"flex justify-center dark:text-white items-center h-screen mx-4",children:jsxRuntimeExports.jsx("div",{className:`bg-gray-200 p-4 rounded-lg w-full ${this.props.containerClassName}`,children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col max-h-[90vh]",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("div",{className:"flex bg-transparent text-start uppercase justify-between mb-4 font-poppinsBlack text-lg",children:[jsxRuntimeExports.jsx("div",{className:"w-full line-clamp-2",children:this.props.data.title}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3",children:[this.props.delete?.show?this.state.hasRequest?jsxRuntimeExports.jsxs("svg",{role:"status",className:"flex w-4 h-4 text-black dark:text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}):jsxRuntimeExports.jsx("span",{onClick:()=>this.handleDelete(),title:"Delete",className:"text-red-800 dark:text-red-300 cursor-pointer",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}):null,jsxRuntimeExports.jsx("svg",{viewBox:"0 0 1024 1024",fill:"currentColor",className:"w-5 h-5 mr-2 cursor-pointer",onClick:this.handleClose,children:jsxRuntimeExports.jsx("path",{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"})})]})]})}),jsxRuntimeExports.jsx("div",{className:"flex-1 max-h-[calc(90%-2rem)] overflow-auto  p-2 rounded-md",children:jsxRuntimeExports.jsx("div",{className:"z-10",children:this.props.children})})]})})})})})})})]})}}function u(){return(u=Object.assign||function(e){for(var A=1;A<arguments.length;A++){var l=arguments[A];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o])}return e}).apply(this,arguments)}function c(e,A){if(e==null)return{};var l,o,t={},a=Object.keys(e);for(o=0;o<a.length;o++)A.indexOf(l=a[o])>=0||(t[l]=e[l]);return t}function i$1(e){var A=React2.useRef(e),l=React2.useRef(function(o){A.current&&A.current(o)});return A.current=e,l.current}var s=function(e,A,l){return A===void 0&&(A=0),l===void 0&&(l=1),e>l?l:e<A?A:e},f=function(e){return"touches"in e},v=function(e){return e&&e.ownerDocument.defaultView||self},d=function(e,A,l){var o=e.getBoundingClientRect(),t=f(A)?function(a,n){for(var B=0;B<a.length;B++)if(a[B].identifier===n)return a[B];return a[0]}(A.touches,l):A;return{left:s((t.pageX-(o.left+v(e).pageXOffset))/o.width),top:s((t.pageY-(o.top+v(e).pageYOffset))/o.height)}},h=function(e){!f(e)&&e.preventDefault()},m=React2.memo(function(e){var A=e.onMove,l=e.onKey,o=c(e,["onMove","onKey"]),t=React2.useRef(null),a=i$1(A),n=i$1(l),B=React2.useRef(null),R=React2.useRef(!1),r=React2.useMemo(function(){var iI=function(sI){h(sI),(f(sI)?sI.touches.length>0:sI.buttons>0)&&t.current?a(d(t.current,sI,B.current)):CI(!1)},lI=function(){return CI(!1)};function CI(sI){var oI=R.current,E=v(t.current),_=sI?E.addEventListener:E.removeEventListener;_(oI?"touchmove":"mousemove",iI),_(oI?"touchend":"mouseup",lI)}return[function(sI){var oI=sI.nativeEvent,E=t.current;if(E&&(h(oI),!function(gI,M){return M&&!f(gI)}(oI,R.current)&&E)){if(f(oI)){R.current=!0;var _=oI.changedTouches||[];_.length&&(B.current=_[0].identifier)}E.focus(),a(d(E,oI,B.current)),CI(!0)}},function(sI){var oI=sI.which||sI.keyCode;oI<37||oI>40||(sI.preventDefault(),n({left:oI===39?.05:oI===37?-.05:0,top:oI===40?.05:oI===38?-.05:0}))},CI]},[n,a]),H=r[0],II=r[1],k=r[2];return React2.useEffect(function(){return k},[k]),React2.createElement("div",u({},o,{onTouchStart:H,onMouseDown:H,className:"react-colorful__interactive",ref:t,onKeyDown:II,tabIndex:0,role:"slider"}))}),g=function(e){return e.filter(Boolean).join(" ")},p=function(e){var A=e.color,l=e.left,o=e.top,t=o===void 0?.5:o,a=g(["react-colorful__pointer",e.className]);return React2.createElement("div",{className:a,style:{top:100*t+"%",left:100*l+"%"}},React2.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:A}}))},b=function(e,A,l){return A===void 0&&(A=0),l===void 0&&(l=Math.pow(10,A)),Math.round(l*e)/l},x$1=function(e){return L(C(e))},C=function(e){return e[0]==="#"&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?b(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:e.length===8?b(parseInt(e.substring(6,8),16)/255,2):1}},w=function(e){return K(I(e))},y=function(e){var A=e.s,l=e.v,o=e.a,t=(200-A)*l/100;return{h:b(e.h),s:b(t>0&&t<200?A*l/100/(t<=100?t:200-t)*100:0),l:b(t/2),a:b(o,2)}},q=function(e){var A=y(e);return"hsl("+A.h+", "+A.s+"%, "+A.l+"%)"},I=function(e){var A=e.h,l=e.s,o=e.v,t=e.a;A=A/360*6,l/=100,o/=100;var a=Math.floor(A),n=o*(1-l),B=o*(1-(A-a)*l),R=o*(1-(1-A+a)*l),r=a%6;return{r:b(255*[o,B,n,n,R,o][r]),g:b(255*[R,o,o,B,n,n][r]),b:b(255*[n,n,R,o,o,B][r]),a:b(t,2)}},D=function(e){var A=e.toString(16);return A.length<2?"0"+A:A},K=function(e){var A=e.r,l=e.g,o=e.b,t=e.a,a=t<1?D(b(255*t)):"";return"#"+D(A)+D(l)+D(o)+a},L=function(e){var A=e.r,l=e.g,o=e.b,t=e.a,a=Math.max(A,l,o),n=a-Math.min(A,l,o),B=n?a===A?(l-o)/n:a===l?2+(o-A)/n:4+(A-l)/n:0;return{h:b(60*(B<0?B+6:B)),s:b(a?n/a*100:0),v:b(a/255*100),a:t}},S=React2.memo(function(e){var A=e.hue,l=e.onChange,o=g(["react-colorful__hue",e.className]);return React2.createElement("div",{className:o},React2.createElement(m,{onMove:function(t){l({h:360*t.left})},onKey:function(t){l({h:s(A+360*t.left,0,360)})},"aria-label":"Hue","aria-valuenow":b(A),"aria-valuemax":"360","aria-valuemin":"0"},React2.createElement(p,{className:"react-colorful__hue-pointer",left:A/360,color:q({h:A,s:100,v:100,a:1})})))}),T=React2.memo(function(e){var A=e.hsva,l=e.onChange,o={backgroundColor:q({h:A.h,s:100,v:100,a:1})};return React2.createElement("div",{className:"react-colorful__saturation",style:o},React2.createElement(m,{onMove:function(t){l({s:100*t.left,v:100-100*t.top})},onKey:function(t){l({s:s(A.s+100*t.left,0,100),v:s(A.v-100*t.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+b(A.s)+"%, Brightness "+b(A.v)+"%"},React2.createElement(p,{className:"react-colorful__saturation-pointer",top:1-A.v/100,left:A.s/100,color:q(A)})))}),F=function(e,A){if(e===A)return!0;for(var l in e)if(e[l]!==A[l])return!1;return!0},X=function(e,A){return e.toLowerCase()===A.toLowerCase()||F(C(e),C(A))};function Y(e,A,l){var o=i$1(l),t=React2.useState(function(){return e.toHsva(A)}),a=t[0],n=t[1],B=React2.useRef({color:A,hsva:a});React2.useEffect(function(){if(!e.equal(A,B.current.color)){var r=e.toHsva(A);B.current={hsva:r,color:A},n(r)}},[A,e]),React2.useEffect(function(){var r;F(a,B.current.hsva)||e.equal(r=e.fromHsva(a),B.current.color)||(B.current={hsva:a,color:r},o(r))},[a,e,o]);var R=React2.useCallback(function(r){n(function(H){return Object.assign({},H,r)})},[]);return[a,R]}var V=typeof window<"u"?React2.useLayoutEffect:React2.useEffect,$=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},J=new Map,Q=function(e){V(function(){var A=e.current?e.current.ownerDocument:document;if(A!==void 0&&!J.has(A)){var l=A.createElement("style");l.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,J.set(A,l);var o=$();o&&l.setAttribute("nonce",o),A.head.appendChild(l)}},[])},U=function(e){var A=e.className,l=e.colorModel,o=e.color,t=o===void 0?l.defaultColor:o,a=e.onChange,n=c(e,["className","colorModel","color","onChange"]),B=React2.useRef(null);Q(B);var R=Y(l,t,a),r=R[0],H=R[1],II=g(["react-colorful",A]);return React2.createElement("div",u({},n,{ref:B,className:II}),React2.createElement(T,{hsva:r,onChange:H}),React2.createElement(S,{hue:r.h,onChange:H,className:"react-colorful__last-control"}))},W={defaultColor:"000",toHsva:x$1,fromHsva:function(e){return w({h:e.h,s:e.s,v:e.v,a:1})},equal:X},Z=function(e){return React2.createElement(U,u({},e,{colorModel:W}))};class DesmyTextInput extends React2.Component{enteredInput="";hasDefault=!1;popoverDropdownRef=React2.createRef();inputRef=React2.createRef();constructor(A){super(A),this.state={dropdownPopoverShow:!1,hasPressed:!1,input:{data:DesmyCommons$1.getDefaultValue(this.props.defaultValue)}}}componentDidMount(){this.props.onRef&&this.props.onRef(this.inputRef.current),this.handleDefaultRequest()}componentDidUpdate(A){A.defaultValue!==this.props.defaultValue&&this.setState({input:{data:""}},()=>this.handleDefaultRequest())}handleDefaultRequest=()=>{const A=DesmyCommons$1.getDefaultValue(this.props.defaultValue);!DesmyCommons$1.isEmptyOrNull(A)&&DesmyCommons$1.isEmptyOrNull(this.state.input.data)&&!this.hasDefault&&(this.hasDefault=!0,this.setState(l=>({input:{...l.input,data:A}})))};handleTextAreaChange=A=>{const l=A.target.value;this.setState(o=>({input:{...o.input,[A.target.name]:l}}),()=>this.props.onChange(l))};handleChange=A=>{const l=A.target.value,{prefix:o,postfix:t,type:a}=this.props;let n=l;o&&n.startsWith(o)&&(n=n.slice(o.length)),t&&n.endsWith(t)&&(n=n.slice(0,-t.length));const B=this.validateInput(n,String(a));a===DesmyState.PHONE_NUMBER||a===DesmyState.NUMBER||a===DesmyState.AMOUNT||a===DesmyState.DECIMAL?B&&this.setState(R=>({input:{...R.input,[A.target.name]:n}}),()=>{this.props.onChange(n)}):this.setState(R=>({input:{...R.input,[A.target.name]:n}}),()=>{B&&this.props.onChange(n)})};validateInput=(A,l)=>{switch(l){case DesmyState.PHONE_NUMBER:return/^[0-9+]*$/.test(A);case DesmyState.NUMBER:return/^[0-9]*$/.test(A);case(DesmyState.AMOUNT||DesmyState.DECIMAL):return/^\d*(\.\d{0,2})?$/.test(A);case DesmyState.EMAIL:{const o=DesmyCommons$1.validateEmail(A);if(this.props.emailExtensions&&this.props.emailExtensions.length>0){const t=this.props.emailExtensions.map(a=>a.trim());return o&&t.some(a=>A.endsWith(a))}return o}default:return!0}};handleClick=A=>{if(this.props.readOnly&&this.props.onFocus){const l={...A,type:"focus",target:A.target};return this.props.onFocus(l)}};handleFocus=A=>{this.props.readOnly||(this.props.type===DesmyState.COLOR?this.setState({dropdownPopoverShow:!0}):this.props.onFocus&&this.props.onFocus(A))};handleColorPicker=()=>{this.setState({dropdownPopoverShow:!0})};closeDropdownPopover=()=>{this.setState({dropdownPopoverShow:!1})};render(){const{defaultValue:A,prefix:l,postfix:o}=this.props;return jsxRuntimeExports.jsxs("div",{className:`${this.props.className||"bg-white dark:bg-darkBackground"} transition-colors duration-300`,children:[jsxRuntimeExports.jsx("div",{className:`relative bg-inherit ${this.props.type===DesmyState.SEARCH?"flex w-full space-x-3":""}`,children:jsxRuntimeExports.jsxs("div",{className:`flex items-center ${!DesmyCommons$1.isEmptyOrNull(l)||!DesmyCommons$1.isEmptyOrNull(o)?"border border-black dark:border-white":""} bg-inherit`,children:[l&&jsxRuntimeExports.jsx("span",{className:"px-1 text-sm text-gray-600 dark:text-gray-300 mr-2",children:l}),this.props.type===DesmyState.TEXTAREA?jsxRuntimeExports.jsx("textarea",{id:`data-${DesmyCommons$1.generateKey()}`,rows:this.props.rows,disabled:!!this.props.disabled,autoFocus:!!this.props.autoFocus,onFocus:this.handleFocus,onClick:this.props.readOnly?this.handleClick:void 0,placeholder:this.props.label,readOnly:this.props.readOnly,maxLength:this.props.maxLength,defaultValue:this.props.defaultValue!==this.state.input.data?this.props.defaultValue:this.state.input.data,onChange:this.handleTextAreaChange,className:`peer bg-transparent border border-black text-xs/7 dark:border-white dark:text-white placeholder-transparent 2xl:text-sm/7 ring-0 px-2 w-full focus:outline-none focus:ring-0 dark:focus:border-white ${this.props.inputClassName}`}):jsxRuntimeExports.jsx("input",{type:`${this.props.type===DesmyState.PASSWORD?"password":"text"}`,id:`data-${DesmyCommons$1.generateKey()}`,name:"data",autoComplete:"data",ref:this.inputRef,readOnly:this.props.readOnly,maxLength:this.props.maxLength,onFocus:this.handleFocus,onClick:this.props.readOnly?this.handleClick:void 0,disabled:!!this.props.disabled,autoFocus:!!this.props.autoFocus,value:this.state.input.data||A,onChange:this.handleChange,className:`peer bg-transparent h-12 ${!DesmyCommons$1.isEmptyOrNull(l)||!DesmyCommons$1.isEmptyOrNull(l)?"":"border border-black  px-2"}  ${this.props.disabled?"cursor-not-allowed":""} dark:border-white dark:text-white placeholder-transparent text-xs 2xl:text-sm ring-0 w-full focus:outline-none focus:ring-0 dark:focus:border-white ${this.props.inputClassName}`,placeholder:this.props.label}),jsxRuntimeExports.jsx("label",{htmlFor:"data",className:`before:content[' '] after:content[' '] pointer-events-none absolute cursor-text left-0 text-[11px] dark:text-white bg-inherit mx-1 px-2 peer-placeholder-shown:text-sm dark:peer-placeholder-shown:text-white 
                                 ${!DesmyCommons$1.isEmptyOrNull(l)||!DesmyCommons$1.isEmptyOrNull(l)?"-top-3.5 text-[11px]":" peer-placeholder-shown:top-3 peer-focus:-top-3 peer-focus:text-black  -top-3.5  peer-focus:text-[11px]"} dark:peer-focus:text-white transition-all`,children:jsxRuntimeExports.jsx("div",{className:"w-full line-clamp-1",children:this.props.label})}),this.props.type===DesmyState.COLOR&&jsxRuntimeExports.jsx("div",{onClick:this.handleColorPicker,className:"absolute top-0 bottom-0 right-2 rounded-2xl cursor-pointer w-12 my-auto h-8",style:{background:`${this.state.input.data}`}}),this.props.type===DesmyState.SEARCH&&jsxRuntimeExports.jsx("div",{className:"bg-primary text-white p-3 rounded-xl cursor-pointer",children:this.props.hasRequest?jsxRuntimeExports.jsxs("svg",{role:"status",className:"inline w-5 h-5 text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}):this.props?.onSearch!=null&&jsxRuntimeExports.jsxs("svg",{fill:"none",stroke:"currentColor",onClick:()=>this.props.onSearch?.(this.state.input.data),strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",className:"w-5",children:[jsxRuntimeExports.jsx("path",{d:"M19 11 A8 8 0 0 1 11 19 A8 8 0 0 1 3 11 A8 8 0 0 1 19 11 z"}),jsxRuntimeExports.jsx("path",{d:"M21 21l-4.35-4.35"})]})})]})}),this.props.type===DesmyState.COLOR&&this.state.dropdownPopoverShow&&jsxRuntimeExports.jsx("div",{ref:this.popoverDropdownRef,className:"absolute border-none z-[800] w-auto float-left py-2 bg-inherit list-none text-left rounded shadow-lg mt-1",children:jsxRuntimeExports.jsx(Z,{color:this.state.input.data,onChange:t=>{this.setState(a=>({input:{...a.input,data:t}}),()=>this.props.onChange(t))}})})]})}}var top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(e,A){return e.concat([A+"-"+start,A+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(e,A){return e.concat([A,A+"-"+start,A+"-"+end])},[]),beforeRead="beforeRead",read$1="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read$1,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getNodeName(e){return e?(e.nodeName||"").toLowerCase():null}function getWindow(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var A=e.ownerDocument;return A&&A.defaultView||window}return e}function isElement(e){var A=getWindow(e).Element;return e instanceof A||e instanceof Element}function isHTMLElement(e){var A=getWindow(e).HTMLElement;return e instanceof A||e instanceof HTMLElement}function isShadowRoot(e){if(typeof ShadowRoot>"u")return!1;var A=getWindow(e).ShadowRoot;return e instanceof A||e instanceof ShadowRoot}function applyStyles(e){var A=e.state;Object.keys(A.elements).forEach(function(l){var o=A.styles[l]||{},t=A.attributes[l]||{},a=A.elements[l];!isHTMLElement(a)||!getNodeName(a)||(Object.assign(a.style,o),Object.keys(t).forEach(function(n){var B=t[n];B===!1?a.removeAttribute(n):a.setAttribute(n,B===!0?"":B)}))})}function effect$2(e){var A=e.state,l={popper:{position:A.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(A.elements.popper.style,l.popper),A.styles=l,A.elements.arrow&&Object.assign(A.elements.arrow.style,l.arrow),function(){Object.keys(A.elements).forEach(function(o){var t=A.elements[o],a=A.attributes[o]||{},n=Object.keys(A.styles.hasOwnProperty(o)?A.styles[o]:l[o]),B=n.reduce(function(R,r){return R[r]="",R},{});!isHTMLElement(t)||!getNodeName(t)||(Object.assign(t.style,B),Object.keys(a).forEach(function(R){t.removeAttribute(R)}))})}}const applyStyles$1={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect:effect$2,requires:["computeStyles"]};function getBasePlacement(e){return e.split("-")[0]}var max$1=Math.max,min=Math.min,round=Math.round;function getUAString(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(A){return A.brand+"/"+A.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(e,A,l){A===void 0&&(A=!1),l===void 0&&(l=!1);var o=e.getBoundingClientRect(),t=1,a=1;A&&isHTMLElement(e)&&(t=e.offsetWidth>0&&round(o.width)/e.offsetWidth||1,a=e.offsetHeight>0&&round(o.height)/e.offsetHeight||1);var n=isElement(e)?getWindow(e):window,B=n.visualViewport,R=!isLayoutViewport()&&l,r=(o.left+(R&&B?B.offsetLeft:0))/t,H=(o.top+(R&&B?B.offsetTop:0))/a,II=o.width/t,k=o.height/a;return{width:II,height:k,top:H,right:r+II,bottom:H+k,left:r,x:r,y:H}}function getLayoutRect(e){var A=getBoundingClientRect(e),l=e.offsetWidth,o=e.offsetHeight;return Math.abs(A.width-l)<=1&&(l=A.width),Math.abs(A.height-o)<=1&&(o=A.height),{x:e.offsetLeft,y:e.offsetTop,width:l,height:o}}function contains(e,A){var l=A.getRootNode&&A.getRootNode();if(e.contains(A))return!0;if(l&&isShadowRoot(l)){var o=A;do{if(o&&e.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function getComputedStyle$1(e){return getWindow(e).getComputedStyle(e)}function isTableElement(e){return["table","td","th"].indexOf(getNodeName(e))>=0}function getDocumentElement(e){return((isElement(e)?e.ownerDocument:e.document)||window.document).documentElement}function getParentNode(e){return getNodeName(e)==="html"?e:e.assignedSlot||e.parentNode||(isShadowRoot(e)?e.host:null)||getDocumentElement(e)}function getTrueOffsetParent(e){return!isHTMLElement(e)||getComputedStyle$1(e).position==="fixed"?null:e.offsetParent}function getContainingBlock(e){var A=/firefox/i.test(getUAString()),l=/Trident/i.test(getUAString());if(l&&isHTMLElement(e)){var o=getComputedStyle$1(e);if(o.position==="fixed")return null}var t=getParentNode(e);for(isShadowRoot(t)&&(t=t.host);isHTMLElement(t)&&["html","body"].indexOf(getNodeName(t))<0;){var a=getComputedStyle$1(t);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||A&&a.willChange==="filter"||A&&a.filter&&a.filter!=="none")return t;t=t.parentNode}return null}function getOffsetParent(e){for(var A=getWindow(e),l=getTrueOffsetParent(e);l&&isTableElement(l)&&getComputedStyle$1(l).position==="static";)l=getTrueOffsetParent(l);return l&&(getNodeName(l)==="html"||getNodeName(l)==="body"&&getComputedStyle$1(l).position==="static")?A:l||getContainingBlock(e)||A}function getMainAxisFromPlacement(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function within(e,A,l){return max$1(e,min(A,l))}function withinMaxClamp(e,A,l){var o=within(e,A,l);return o>l?l:o}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(e){return Object.assign({},getFreshSideObject(),e)}function expandToHashMap(e,A){return A.reduce(function(l,o){return l[o]=e,l},{})}var toPaddingObject=function e(A,l){return A=typeof A=="function"?A(Object.assign({},l.rects,{placement:l.placement})):A,mergePaddingObject(typeof A!="number"?A:expandToHashMap(A,basePlacements))};function arrow(e){var A,l=e.state,o=e.name,t=e.options,a=l.elements.arrow,n=l.modifiersData.popperOffsets,B=getBasePlacement(l.placement),R=getMainAxisFromPlacement(B),r=[left,right].indexOf(B)>=0,H=r?"height":"width";if(!(!a||!n)){var II=toPaddingObject(t.padding,l),k=getLayoutRect(a),iI=R==="y"?top:left,lI=R==="y"?bottom:right,CI=l.rects.reference[H]+l.rects.reference[R]-n[R]-l.rects.popper[H],sI=n[R]-l.rects.reference[R],oI=getOffsetParent(a),E=oI?R==="y"?oI.clientHeight||0:oI.clientWidth||0:0,_=CI/2-sI/2,gI=II[iI],M=E-k[H]-II[lI],O=E/2-k[H]/2+_,dI=within(gI,O,M),eI=R;l.modifiersData[o]=(A={},A[eI]=dI,A.centerOffset=dI-O,A)}}function effect$1(e){var A=e.state,l=e.options,o=l.element,t=o===void 0?"[data-popper-arrow]":o;t!=null&&(typeof t=="string"&&(t=A.elements.popper.querySelector(t),!t)||contains(A.elements.popper,t)&&(A.elements.arrow=t))}const arrow$1={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect$1,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(e){return e.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(e,A){var l=e.x,o=e.y,t=A.devicePixelRatio||1;return{x:round(l*t)/t||0,y:round(o*t)/t||0}}function mapToStyles(e){var A,l=e.popper,o=e.popperRect,t=e.placement,a=e.variation,n=e.offsets,B=e.position,R=e.gpuAcceleration,r=e.adaptive,H=e.roundOffsets,II=e.isFixed,k=n.x,iI=k===void 0?0:k,lI=n.y,CI=lI===void 0?0:lI,sI=typeof H=="function"?H({x:iI,y:CI}):{x:iI,y:CI};iI=sI.x,CI=sI.y;var oI=n.hasOwnProperty("x"),E=n.hasOwnProperty("y"),_=left,gI=top,M=window;if(r){var O=getOffsetParent(l),dI="clientHeight",eI="clientWidth";if(O===getWindow(l)&&(O=getDocumentElement(l),getComputedStyle$1(O).position!=="static"&&B==="absolute"&&(dI="scrollHeight",eI="scrollWidth")),O=O,t===top||(t===left||t===right)&&a===end){gI=bottom;var aI=II&&O===M&&M.visualViewport?M.visualViewport.height:O[dI];CI-=aI-o.height,CI*=R?1:-1}if(t===left||(t===top||t===bottom)&&a===end){_=right;var WI=II&&O===M&&M.visualViewport?M.visualViewport.width:O[eI];iI-=WI-o.width,iI*=R?1:-1}}var GI=Object.assign({position:B},r&&unsetSides),HI=H===!0?roundOffsetsByDPR({x:iI,y:CI},getWindow(l)):{x:iI,y:CI};if(iI=HI.x,CI=HI.y,R){var MI;return Object.assign({},GI,(MI={},MI[gI]=E?"0":"",MI[_]=oI?"0":"",MI.transform=(M.devicePixelRatio||1)<=1?"translate("+iI+"px, "+CI+"px)":"translate3d("+iI+"px, "+CI+"px, 0)",MI))}return Object.assign({},GI,(A={},A[gI]=E?CI+"px":"",A[_]=oI?iI+"px":"",A.transform="",A))}function computeStyles(e){var A=e.state,l=e.options,o=l.gpuAcceleration,t=o===void 0?!0:o,a=l.adaptive,n=a===void 0?!0:a,B=l.roundOffsets,R=B===void 0?!0:B,r={placement:getBasePlacement(A.placement),variation:getVariation(A.placement),popper:A.elements.popper,popperRect:A.rects.popper,gpuAcceleration:t,isFixed:A.options.strategy==="fixed"};A.modifiersData.popperOffsets!=null&&(A.styles.popper=Object.assign({},A.styles.popper,mapToStyles(Object.assign({},r,{offsets:A.modifiersData.popperOffsets,position:A.options.strategy,adaptive:n,roundOffsets:R})))),A.modifiersData.arrow!=null&&(A.styles.arrow=Object.assign({},A.styles.arrow,mapToStyles(Object.assign({},r,{offsets:A.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:R})))),A.attributes.popper=Object.assign({},A.attributes.popper,{"data-popper-placement":A.placement})}const computeStyles$1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};var passive={passive:!0};function effect(e){var A=e.state,l=e.instance,o=e.options,t=o.scroll,a=t===void 0?!0:t,n=o.resize,B=n===void 0?!0:n,R=getWindow(A.elements.popper),r=[].concat(A.scrollParents.reference,A.scrollParents.popper);return a&&r.forEach(function(H){H.addEventListener("scroll",l.update,passive)}),B&&R.addEventListener("resize",l.update,passive),function(){a&&r.forEach(function(H){H.removeEventListener("scroll",l.update,passive)}),B&&R.removeEventListener("resize",l.update,passive)}}const eventListeners={name:"eventListeners",enabled:!0,phase:"write",fn:function e(){},effect,data:{}};var hash$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(e){return e.replace(/left|right|bottom|top/g,function(A){return hash$1[A]})}var hash={start:"end",end:"start"};function getOppositeVariationPlacement(e){return e.replace(/start|end/g,function(A){return hash[A]})}function getWindowScroll(e){var A=getWindow(e),l=A.pageXOffset,o=A.pageYOffset;return{scrollLeft:l,scrollTop:o}}function getWindowScrollBarX(e){return getBoundingClientRect(getDocumentElement(e)).left+getWindowScroll(e).scrollLeft}function getViewportRect(e,A){var l=getWindow(e),o=getDocumentElement(e),t=l.visualViewport,a=o.clientWidth,n=o.clientHeight,B=0,R=0;if(t){a=t.width,n=t.height;var r=isLayoutViewport();(r||!r&&A==="fixed")&&(B=t.offsetLeft,R=t.offsetTop)}return{width:a,height:n,x:B+getWindowScrollBarX(e),y:R}}function getDocumentRect(e){var A,l=getDocumentElement(e),o=getWindowScroll(e),t=(A=e.ownerDocument)==null?void 0:A.body,a=max$1(l.scrollWidth,l.clientWidth,t?t.scrollWidth:0,t?t.clientWidth:0),n=max$1(l.scrollHeight,l.clientHeight,t?t.scrollHeight:0,t?t.clientHeight:0),B=-o.scrollLeft+getWindowScrollBarX(e),R=-o.scrollTop;return getComputedStyle$1(t||l).direction==="rtl"&&(B+=max$1(l.clientWidth,t?t.clientWidth:0)-a),{width:a,height:n,x:B,y:R}}function isScrollParent(e){var A=getComputedStyle$1(e),l=A.overflow,o=A.overflowX,t=A.overflowY;return/auto|scroll|overlay|hidden/.test(l+t+o)}function getScrollParent(e){return["html","body","#document"].indexOf(getNodeName(e))>=0?e.ownerDocument.body:isHTMLElement(e)&&isScrollParent(e)?e:getScrollParent(getParentNode(e))}function listScrollParents(e,A){var l;A===void 0&&(A=[]);var o=getScrollParent(e),t=o===((l=e.ownerDocument)==null?void 0:l.body),a=getWindow(o),n=t?[a].concat(a.visualViewport||[],isScrollParent(o)?o:[]):o,B=A.concat(n);return t?B:B.concat(listScrollParents(getParentNode(n)))}function rectToClientRect(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function getInnerBoundingClientRect(e,A){var l=getBoundingClientRect(e,!1,A==="fixed");return l.top=l.top+e.clientTop,l.left=l.left+e.clientLeft,l.bottom=l.top+e.clientHeight,l.right=l.left+e.clientWidth,l.width=e.clientWidth,l.height=e.clientHeight,l.x=l.left,l.y=l.top,l}function getClientRectFromMixedType(e,A,l){return A===viewport?rectToClientRect(getViewportRect(e,l)):isElement(A)?getInnerBoundingClientRect(A,l):rectToClientRect(getDocumentRect(getDocumentElement(e)))}function getClippingParents(e){var A=listScrollParents(getParentNode(e)),l=["absolute","fixed"].indexOf(getComputedStyle$1(e).position)>=0,o=l&&isHTMLElement(e)?getOffsetParent(e):e;return isElement(o)?A.filter(function(t){return isElement(t)&&contains(t,o)&&getNodeName(t)!=="body"}):[]}function getClippingRect(e,A,l,o){var t=A==="clippingParents"?getClippingParents(e):[].concat(A),a=[].concat(t,[l]),n=a[0],B=a.reduce(function(R,r){var H=getClientRectFromMixedType(e,r,o);return R.top=max$1(H.top,R.top),R.right=min(H.right,R.right),R.bottom=min(H.bottom,R.bottom),R.left=max$1(H.left,R.left),R},getClientRectFromMixedType(e,n,o));return B.width=B.right-B.left,B.height=B.bottom-B.top,B.x=B.left,B.y=B.top,B}function computeOffsets(e){var A=e.reference,l=e.element,o=e.placement,t=o?getBasePlacement(o):null,a=o?getVariation(o):null,n=A.x+A.width/2-l.width/2,B=A.y+A.height/2-l.height/2,R;switch(t){case top:R={x:n,y:A.y-l.height};break;case bottom:R={x:n,y:A.y+A.height};break;case right:R={x:A.x+A.width,y:B};break;case left:R={x:A.x-l.width,y:B};break;default:R={x:A.x,y:A.y}}var r=t?getMainAxisFromPlacement(t):null;if(r!=null){var H=r==="y"?"height":"width";switch(a){case start:R[r]=R[r]-(A[H]/2-l[H]/2);break;case end:R[r]=R[r]+(A[H]/2-l[H]/2);break}}return R}function detectOverflow(e,A){A===void 0&&(A={});var l=A,o=l.placement,t=o===void 0?e.placement:o,a=l.strategy,n=a===void 0?e.strategy:a,B=l.boundary,R=B===void 0?clippingParents:B,r=l.rootBoundary,H=r===void 0?viewport:r,II=l.elementContext,k=II===void 0?popper:II,iI=l.altBoundary,lI=iI===void 0?!1:iI,CI=l.padding,sI=CI===void 0?0:CI,oI=mergePaddingObject(typeof sI!="number"?sI:expandToHashMap(sI,basePlacements)),E=k===popper?reference:popper,_=e.rects.popper,gI=e.elements[lI?E:k],M=getClippingRect(isElement(gI)?gI:gI.contextElement||getDocumentElement(e.elements.popper),R,H,n),O=getBoundingClientRect(e.elements.reference),dI=computeOffsets({reference:O,element:_,placement:t}),eI=rectToClientRect(Object.assign({},_,dI)),aI=k===popper?eI:O,WI={top:M.top-aI.top+oI.top,bottom:aI.bottom-M.bottom+oI.bottom,left:M.left-aI.left+oI.left,right:aI.right-M.right+oI.right},GI=e.modifiersData.offset;if(k===popper&&GI){var HI=GI[t];Object.keys(WI).forEach(function(MI){var KI=[right,bottom].indexOf(MI)>=0?1:-1,DI=[top,bottom].indexOf(MI)>=0?"y":"x";WI[MI]+=HI[DI]*KI})}return WI}function computeAutoPlacement(e,A){A===void 0&&(A={});var l=A,o=l.placement,t=l.boundary,a=l.rootBoundary,n=l.padding,B=l.flipVariations,R=l.allowedAutoPlacements,r=R===void 0?placements:R,H=getVariation(o),II=H?B?variationPlacements:variationPlacements.filter(function(lI){return getVariation(lI)===H}):basePlacements,k=II.filter(function(lI){return r.indexOf(lI)>=0});k.length===0&&(k=II);var iI=k.reduce(function(lI,CI){return lI[CI]=detectOverflow(e,{placement:CI,boundary:t,rootBoundary:a,padding:n})[getBasePlacement(CI)],lI},{});return Object.keys(iI).sort(function(lI,CI){return iI[lI]-iI[CI]})}function getExpandedFallbackPlacements(e){if(getBasePlacement(e)===auto)return[];var A=getOppositePlacement(e);return[getOppositeVariationPlacement(e),A,getOppositeVariationPlacement(A)]}function flip(e){var A=e.state,l=e.options,o=e.name;if(!A.modifiersData[o]._skip){for(var t=l.mainAxis,a=t===void 0?!0:t,n=l.altAxis,B=n===void 0?!0:n,R=l.fallbackPlacements,r=l.padding,H=l.boundary,II=l.rootBoundary,k=l.altBoundary,iI=l.flipVariations,lI=iI===void 0?!0:iI,CI=l.allowedAutoPlacements,sI=A.options.placement,oI=getBasePlacement(sI),E=oI===sI,_=R||(E||!lI?[getOppositePlacement(sI)]:getExpandedFallbackPlacements(sI)),gI=[sI].concat(_).reduce(function(XI,tI){return XI.concat(getBasePlacement(tI)===auto?computeAutoPlacement(A,{placement:tI,boundary:H,rootBoundary:II,padding:r,flipVariations:lI,allowedAutoPlacements:CI}):tI)},[]),M=A.rects.reference,O=A.rects.popper,dI=new Map,eI=!0,aI=gI[0],WI=0;WI<gI.length;WI++){var GI=gI[WI],HI=getBasePlacement(GI),MI=getVariation(GI)===start,KI=[top,bottom].indexOf(HI)>=0,DI=KI?"width":"height",NI=detectOverflow(A,{placement:GI,boundary:H,rootBoundary:II,altBoundary:k,padding:r}),yI=KI?MI?right:left:MI?bottom:top;M[DI]>O[DI]&&(yI=getOppositePlacement(yI));var VI=getOppositePlacement(yI),hI=[];if(a&&hI.push(NI[HI]<=0),B&&hI.push(NI[yI]<=0,NI[VI]<=0),hI.every(function(XI){return XI})){aI=GI,eI=!1;break}dI.set(GI,hI)}if(eI)for(var wI=lI?3:1,pI=function(tI){var mI=gI.find(function(YI){var BI=dI.get(YI);if(BI)return BI.slice(0,tI).every(function(AI){return AI})});if(mI)return aI=mI,"break"},xI=wI;xI>0;xI--){var PI=pI(xI);if(PI==="break")break}A.placement!==aI&&(A.modifiersData[o]._skip=!0,A.placement=aI,A.reset=!0)}}const flip$1={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(e,A,l){return l===void 0&&(l={x:0,y:0}),{top:e.top-A.height-l.y,right:e.right-A.width+l.x,bottom:e.bottom-A.height+l.y,left:e.left-A.width-l.x}}function isAnySideFullyClipped(e){return[top,right,bottom,left].some(function(A){return e[A]>=0})}function hide(e){var A=e.state,l=e.name,o=A.rects.reference,t=A.rects.popper,a=A.modifiersData.preventOverflow,n=detectOverflow(A,{elementContext:"reference"}),B=detectOverflow(A,{altBoundary:!0}),R=getSideOffsets(n,o),r=getSideOffsets(B,t,a),H=isAnySideFullyClipped(R),II=isAnySideFullyClipped(r);A.modifiersData[l]={referenceClippingOffsets:R,popperEscapeOffsets:r,isReferenceHidden:H,hasPopperEscaped:II},A.attributes.popper=Object.assign({},A.attributes.popper,{"data-popper-reference-hidden":H,"data-popper-escaped":II})}const hide$1={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(e,A,l){var o=getBasePlacement(e),t=[left,top].indexOf(o)>=0?-1:1,a=typeof l=="function"?l(Object.assign({},A,{placement:e})):l,n=a[0],B=a[1];return n=n||0,B=(B||0)*t,[left,right].indexOf(o)>=0?{x:B,y:n}:{x:n,y:B}}function offset(e){var A=e.state,l=e.options,o=e.name,t=l.offset,a=t===void 0?[0,0]:t,n=placements.reduce(function(H,II){return H[II]=distanceAndSkiddingToXY(II,A.rects,a),H},{}),B=n[A.placement],R=B.x,r=B.y;A.modifiersData.popperOffsets!=null&&(A.modifiersData.popperOffsets.x+=R,A.modifiersData.popperOffsets.y+=r),A.modifiersData[o]=n}const offset$1={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(e){var A=e.state,l=e.name;A.modifiersData[l]=computeOffsets({reference:A.rects.reference,element:A.rects.popper,placement:A.placement})}const popperOffsets$1={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(e){return e==="x"?"y":"x"}function preventOverflow(e){var A=e.state,l=e.options,o=e.name,t=l.mainAxis,a=t===void 0?!0:t,n=l.altAxis,B=n===void 0?!1:n,R=l.boundary,r=l.rootBoundary,H=l.altBoundary,II=l.padding,k=l.tether,iI=k===void 0?!0:k,lI=l.tetherOffset,CI=lI===void 0?0:lI,sI=detectOverflow(A,{boundary:R,rootBoundary:r,padding:II,altBoundary:H}),oI=getBasePlacement(A.placement),E=getVariation(A.placement),_=!E,gI=getMainAxisFromPlacement(oI),M=getAltAxis(gI),O=A.modifiersData.popperOffsets,dI=A.rects.reference,eI=A.rects.popper,aI=typeof CI=="function"?CI(Object.assign({},A.rects,{placement:A.placement})):CI,WI=typeof aI=="number"?{mainAxis:aI,altAxis:aI}:Object.assign({mainAxis:0,altAxis:0},aI),GI=A.modifiersData.offset?A.modifiersData.offset[A.placement]:null,HI={x:0,y:0};if(O){if(a){var MI,KI=gI==="y"?top:left,DI=gI==="y"?bottom:right,NI=gI==="y"?"height":"width",yI=O[gI],VI=yI+sI[KI],hI=yI-sI[DI],wI=iI?-eI[NI]/2:0,pI=E===start?dI[NI]:eI[NI],xI=E===start?-eI[NI]:-dI[NI],PI=A.elements.arrow,XI=iI&&PI?getLayoutRect(PI):{width:0,height:0},tI=A.modifiersData["arrow#persistent"]?A.modifiersData["arrow#persistent"].padding:getFreshSideObject(),mI=tI[KI],YI=tI[DI],BI=within(0,dI[NI],XI[NI]),AI=_?dI[NI]/2-wI-BI-mI-WI.mainAxis:pI-BI-mI-WI.mainAxis,cI=_?-dI[NI]/2+wI+BI+YI+WI.mainAxis:xI+BI+YI+WI.mainAxis,bI=A.elements.arrow&&getOffsetParent(A.elements.arrow),nI=bI?gI==="y"?bI.clientTop||0:bI.clientLeft||0:0,uI=(MI=GI?.[gI])!=null?MI:0,rI=yI+AI-uI-nI,FI=yI+cI-uI,kI=within(iI?min(VI,rI):VI,yI,iI?max$1(hI,FI):hI);O[gI]=kI,HI[gI]=kI-yI}if(B){var TI,QI=gI==="x"?top:left,fI=gI==="x"?bottom:right,OI=O[M],qI=M==="y"?"height":"width",gg=OI+sI[QI],lg=OI-sI[fI],sg=[top,left].indexOf(oI)!==-1,tg=(TI=GI?.[M])!=null?TI:0,ig=sg?gg:OI-dI[qI]-eI[qI]-tg+WI.altAxis,Xg=sg?OI+dI[qI]+eI[qI]-tg-WI.altAxis:lg,rg=iI&&sg?withinMaxClamp(ig,OI,Xg):within(iI?ig:gg,OI,iI?Xg:lg);O[M]=rg,HI[M]=rg-OI}A.modifiersData[o]=HI}}const preventOverflow$1={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function getNodeScroll(e){return e===getWindow(e)||!isHTMLElement(e)?getWindowScroll(e):getHTMLElementScroll(e)}function isElementScaled(e){var A=e.getBoundingClientRect(),l=round(A.width)/e.offsetWidth||1,o=round(A.height)/e.offsetHeight||1;return l!==1||o!==1}function getCompositeRect(e,A,l){l===void 0&&(l=!1);var o=isHTMLElement(A),t=isHTMLElement(A)&&isElementScaled(A),a=getDocumentElement(A),n=getBoundingClientRect(e,t,l),B={scrollLeft:0,scrollTop:0},R={x:0,y:0};return(o||!o&&!l)&&((getNodeName(A)!=="body"||isScrollParent(a))&&(B=getNodeScroll(A)),isHTMLElement(A)?(R=getBoundingClientRect(A,!0),R.x+=A.clientLeft,R.y+=A.clientTop):a&&(R.x=getWindowScrollBarX(a))),{x:n.left+B.scrollLeft-R.x,y:n.top+B.scrollTop-R.y,width:n.width,height:n.height}}function order(e){var A=new Map,l=new Set,o=[];e.forEach(function(a){A.set(a.name,a)});function t(a){l.add(a.name);var n=[].concat(a.requires||[],a.requiresIfExists||[]);n.forEach(function(B){if(!l.has(B)){var R=A.get(B);R&&t(R)}}),o.push(a)}return e.forEach(function(a){l.has(a.name)||t(a)}),o}function orderModifiers(e){var A=order(e);return modifierPhases.reduce(function(l,o){return l.concat(A.filter(function(t){return t.phase===o}))},[])}function debounce(e){var A;return function(){return A||(A=new Promise(function(l){Promise.resolve().then(function(){A=void 0,l(e())})})),A}}function mergeByName(e){var A=e.reduce(function(l,o){var t=l[o.name];return l[o.name]=t?Object.assign({},t,o,{options:Object.assign({},t.options,o.options),data:Object.assign({},t.data,o.data)}):o,l},{});return Object.keys(A).map(function(l){return A[l]})}var DEFAULT_OPTIONS$1={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var e=arguments.length,A=new Array(e),l=0;l<e;l++)A[l]=arguments[l];return!A.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function popperGenerator(e){e===void 0&&(e={});var A=e,l=A.defaultModifiers,o=l===void 0?[]:l,t=A.defaultOptions,a=t===void 0?DEFAULT_OPTIONS$1:t;return function(B,R,r){r===void 0&&(r=a);var H={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS$1,a),modifiersData:{},elements:{reference:B,popper:R},attributes:{},styles:{}},II=[],k=!1,iI={state:H,setOptions:function(oI){var E=typeof oI=="function"?oI(H.options):oI;CI(),H.options=Object.assign({},a,H.options,E),H.scrollParents={reference:isElement(B)?listScrollParents(B):B.contextElement?listScrollParents(B.contextElement):[],popper:listScrollParents(R)};var _=orderModifiers(mergeByName([].concat(o,H.options.modifiers)));return H.orderedModifiers=_.filter(function(gI){return gI.enabled}),lI(),iI.update()},forceUpdate:function(){if(!k){var oI=H.elements,E=oI.reference,_=oI.popper;if(areValidElements(E,_)){H.rects={reference:getCompositeRect(E,getOffsetParent(_),H.options.strategy==="fixed"),popper:getLayoutRect(_)},H.reset=!1,H.placement=H.options.placement,H.orderedModifiers.forEach(function(WI){return H.modifiersData[WI.name]=Object.assign({},WI.data)});for(var gI=0;gI<H.orderedModifiers.length;gI++){if(H.reset===!0){H.reset=!1,gI=-1;continue}var M=H.orderedModifiers[gI],O=M.fn,dI=M.options,eI=dI===void 0?{}:dI,aI=M.name;typeof O=="function"&&(H=O({state:H,options:eI,name:aI,instance:iI})||H)}}}},update:debounce(function(){return new Promise(function(sI){iI.forceUpdate(),sI(H)})}),destroy:function(){CI(),k=!0}};if(!areValidElements(B,R))return iI;iI.setOptions(r).then(function(sI){!k&&r.onFirstUpdate&&r.onFirstUpdate(sI)});function lI(){H.orderedModifiers.forEach(function(sI){var oI=sI.name,E=sI.options,_=E===void 0?{}:E,gI=sI.effect;if(typeof gI=="function"){var M=gI({state:H,name:oI,instance:iI,options:_}),O=function(){};II.push(M||O)}})}function CI(){II.forEach(function(sI){return sI()}),II=[]}return iI}}var defaultModifiers=[eventListeners,popperOffsets$1,computeStyles$1,applyStyles$1,offset$1,flip$1,preventOverflow$1,arrow$1,hide$1],createPopper=popperGenerator({defaultModifiers});class DesmySearchInput extends React2.Component{popoverDropdownRef=React2.createRef();btnDropdownRef=React2.createRef();searchRef=React2.createRef();divRef=React2.createRef();constructor(A){super(A),this.popoverDropdownRef=React2.createRef(),this.btnDropdownRef=React2.createRef(),this.searchRef=React2.createRef(),this.divRef=React2.createRef(),this.state={dropdownPopoverShow:!1,selectedList:{id:"",name:null,icon:null,data:null},selectedMultiple:[],defaultValue:"",datalist:[],intervalId:0,total:0,hasLoaded:!1,isLoading:!1,clear:!1,selectedAll:!1,requestUrl:"",bgColor:"dark:bg-darkDialogBackground",input:{search:""},error:{state:!1,message:""},searchText:"",filteredOptions:[],selectedOptions:[],showDropdown:!1,page:1,hasMore:!0}}componentDidMount(){this.props.onRef&&this.props.onRef(this),document.addEventListener("mousedown",this.handleClickOutside),this.fetchData("",1)}alert=()=>"";componentDidUpdate(A){try{A.defaultValue!==this.props.defaultValue&&!DesmyCommons$1.isEmptyOrNull(this.props.defaultValue)&&DesmyCommons$1.isEmptyOrNull(this.state.selectedOptions)&&this.handleDefault(),this.props.request?.url!=null&&A?.request?.url!==this.props.request?.url&&this.fetchData("",1)}catch{this.alert()}}handleError=(A="")=>{try{const{error:l}=this.state,o={...l,state:!0,message:A};this.setState({isLoading:!1,error:o})}catch{}};openDropdownPopover=()=>{this.props.disabled||(this.handleDropdownPopover(),this.handleDropdownPopover())};handleScroll=A=>{const{target:l}=A,{searchText:o,page:t,hasMore:a}=this.state;l.scrollHeight-l.scrollTop===l.clientHeight&&a&&this.setState({page:t+1},()=>{this.fetchData(o,this.state.page)})};fetchData=async(A,l)=>{const{request:o}=this.props,t=o?.url,a=o?.token;try{this.setState({isLoading:!0});const n=a?{Authorization:`${a}`}:{},R=await(await fetch(`${t}?query=${A}&page=${l}`,{headers:n})).json();if(R.success){if(!R.data||!R.data.meta)throw new Error("Invalid response format: 'data' or 'meta' is missing.");const{data:r,meta:H}=R.data;if(DesmyCommons$1.isEmptyOrNull(r))this.handleError("No data found.");else{const II=r.map(k=>({id:k.id,name:k.name,icon:null,hint:k.hint||null,data:k}));this.setState(k=>({filteredOptions:l===1?II:[...k.filteredOptions,...II],hasMore:H.current_page<H.last_page,total:H.total,isLoading:!1,error:{state:!1,message:""}}),this.handleDefault)}}else this.handleError(R.message||"Failed to fetch data.")}catch{this.handleError("An error occurred while fetching data. Please check your connection.")}};handleDefault=()=>{const{defaultValue:A}=this.props,{filteredOptions:l}=this.state;let o=[],t="";if(!DesmyCommons$1.isEmptyOrNull(A)&&!DesmyCommons$1.isEmptyOrNull(l)){if(Array.isArray(A))console.log("defaultValue=",A," and filteredOptions=",l),o=A.map(a=>{if(typeof a=="string"){const n=l.find(B=>B.name===a||B.id===a);return Array.isArray(n)?n[0]:n||{id:null,name:a,icon:null,hint:null,data:a}}return a}).filter(a=>!!a);else if(typeof A=="string"){const a=l.find(n=>n.name===A||n.id===A);o=[Array.isArray(a)?a[0]:a||{id:null,name:A,icon:null,hint:null,data:A}]}else if(A){const a=l.find(n=>n.name===A?.name||n.id===A?.id);o=[Array.isArray(a)?a[0]:a||{id:A?.id,name:A?.name,icon:null,hint:null,data:A}]}DesmyCommons$1.isEmptyOrNull(t)?!DesmyCommons$1.isEmptyOrNull(o)&&!DesmyCommons$1.isEmptyOrNull(A)&&this.setState({selectedOptions:o},()=>{this.handleOnSelect(o)}):(JSON.stringify(this.state.selectedOptions)!==JSON.stringify(o)||this.state.searchText!==t)&&this.setState({selectedOptions:o},()=>{this.handleOnSelect(o)})}};handleOnSelect=A=>{if(Array.isArray(A)){const l=A.filter(o=>o.id!=null&&o.name!=null&&o.id!==""&&o.name!=="");this.props.onSelect&&this.props.onSelect(l)}else this.props.onSelect&&this.props.onSelect(A)};handleOpendropdown=()=>{this.props.disabled||(createPopper(this.btnDropdownRef.current,this.popoverDropdownRef.current,{placement:"bottom-start",strategy:"fixed",modifiers:[{name:"offset",options:{offset:[0,10]}},{name:"flip",options:{fallbackPlacements:["top","bottom-start"]}}]}),this.setState({dropdownPopoverShow:!0},()=>{this.searchRef.current?.focus()}))};handleDropdownPopover=()=>{this.props.disabled||(this.handleOpendropdown(),this.handleOpendropdown())};handleInputChange=A=>{const l=A.target.value;this.setState({searchText:l,showDropdown:!!l,page:1,hasMore:!0},()=>{DesmyCommons$1.isEmptyOrNull(l)?this.setState({filteredOptions:[]}):this.fetchData(l,1)})};handleClickAway=()=>{};handleClear=()=>{this.setState({selectedMultiple:[],selectedList:{id:"",name:null,icon:null,data:null},clear:!0},this.handleClickAway)};closeDropdownPopover=()=>{this.setState({dropdownPopoverShow:!1})};handleOptionClick=A=>{const{is_multiple:l,onSelect:o}=this.props;l?this.setState(t=>{const a=[...t.selectedOptions,A],n=t.filteredOptions.filter(B=>B.id!==A.id);return{selectedOptions:a,filteredOptions:n,dropdownPopoverShow:n.length>0}},()=>{o(this.state.selectedOptions)}):(this.setState({searchText:A.name||"",dropdownPopoverShow:!1,selectedOptions:[A]}),o(A))};handleChipRemove=A=>{this.setState(l=>{const o=l.selectedOptions.filter(a=>a.id!==A.id),t=[...l.filteredOptions,A];return this.props.onSelect(o),{selectedOptions:o,filteredOptions:t}})};handleClickOutside=A=>{this.divRef.current&&!this.divRef.current.contains(A.target)&&this.closeDropdownPopover()};render(){const{placeholder:A,is_multiple:l,label:o,disabled:t,autoFocus:a,maxLength:n,inputClassName:B}=this.props,{searchText:R,filteredOptions:r,selectedOptions:H,error:II,total:k,isLoading:iI}=this.state;return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(DesmyClickOutsideListener,{onClickOutside:this.handleClickAway,children:jsxRuntimeExports.jsxs("div",{className:`flex relative flex-col w-full ${this.props.containerClassName!=null?this.props.containerClassName:"bg-white dark:bg-darkBackground dark:text-white"}`,ref:this.divRef,children:[jsxRuntimeExports.jsxs("div",{className:"relative w-full bg-inherit",ref:this.btnDropdownRef,children:[jsxRuntimeExports.jsx("input",{type:"text",maxLength:n,disabled:t,autoFocus:a,placeholder:A||"Search...",value:R,onChange:this.handleInputChange,onFocus:this.handleDropdownPopover,className:`peer bg-transparent h-12 border border-black ${t?"cursor-not-allowed":""} dark:border-white dark:text-white placeholder-transparent text-xs 2xl:text-sm ring-0 px-2 w-full focus:outline-none focus:ring-0 dark:focus:border-white ${B}`}),jsxRuntimeExports.jsx("label",{htmlFor:"data",className:"pointer-events-none absolute cursor-text left-0 -top-3.5 text-[11px] dark:text-white bg-inherit mx-1 px-2 peer-placeholder-shown:text-sm dark:peer-placeholder-shown:text-white peer-placeholder-shown:top-3 peer-focus:-top-3 peer-focus:text-black dark:peer-focus:text-white peer-focus:text-[11px] transition-all",children:o}),jsxRuntimeExports.jsx("div",{className:"bg-inherit",children:jsxRuntimeExports.jsxs("div",{ref:this.popoverDropdownRef,className:(this.state.dropdownPopoverShow?"inline-block ":"hidden ")+"absolute  z-[800] border border-gray-300 dark:border-darkPrimaryBorder top-0 text-base min-w-[400px] max-w-[600px] float-left py-4 bg-inherit  list-none mt-1 "+this.props.dropdownClass,style:{minWidth:"12rem"},children:[jsxRuntimeExports.jsxs("div",{className:"flex w-full justify-between px-3 py-2.5 items-center border-b-[1px] border-gray-200 dark:border-darkPrimaryBorder",children:[jsxRuntimeExports.jsx("div",{className:"flex w-full text-sm justify-start uppercase font-bold items-center",children:DesmyCommons$1.isEmptyOrNull(H)?DesmyCommons$1.isEmptyOrNull(R)?"Recent Data":`Search Found (${k})`:`Selected Data: ${H.length}`}),jsxRuntimeExports.jsx("div",{className:"flex justify-end ml-3",children:jsxRuntimeExports.jsx("div",{className:"border border-gray-300 dark:border-darkPrimaryBorder text-gray-500 hover:bg-gray-600 hover:text-white cursor-pointer text-xs px-2 py-1 uppercase rounded-full",onClick:this.closeDropdownPopover,children:"Done"})})]}),jsxRuntimeExports.jsx("div",{className:"w-full min-w-[400px] max-w-[600px]",children:jsxRuntimeExports.jsx("ul",{onScroll:this.handleScroll,className:"max-h-96 overflow-y-auto z-10",children:iI?jsxRuntimeExports.jsx("div",{className:"flex text-xs dark:text-white h-32 w-full justify-center items-center",children:"Loading..."}):II.state?jsxRuntimeExports.jsx("li",{className:"p-2 text-red-500",children:jsxRuntimeExports.jsx("div",{className:"flex w-full text-xs h-32 p-5 justify-center items-center text-center",children:II.message})}):r.length>0?r.map(lI=>jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs("div",{onClick:()=>this.handleOptionClick(lI),className:"flex items-center text-sm py-4 px-4 font-normal cursor-pointer w-full whitespace-no-wrap hover:bg-gray-200 dark:hover:bg-white dark:hover:text-black transition duration-500 ease-in-out dark:text-white group",children:[lI.icon&&jsxRuntimeExports.jsx("img",{src:lI.icon,alt:"icon",className:"w-4 h-4 mr-2"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{children:lI.name}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-600 dark:text-white dark:group-hover:text-black",children:lI?.hint})]})]})},Math.random())):jsxRuntimeExports.jsx("li",{className:"p-2 text-gray-500",children:jsxRuntimeExports.jsx("div",{className:"flex w-full h-32 justify-center items-center",children:"No results found"})})})})]})})]}),l&&!this.state.dropdownPopoverShow&&!DesmyCommons$1.isEmptyOrNull(H)&&jsxRuntimeExports.jsx("div",{className:"flex flex-wrap max-h-32 overflow-y-scroll mt-4 items-center gap-2",children:H.map(lI=>lI.id&&jsxRuntimeExports.jsxs("div",{className:"flex items-center bg-gray-200 dark:bg-darkPrimaryBorder dark:text-white dark:hover:bg-white dark:hover:text-black rounded-full px-3 py-2 text-xs transition duration-500 ease-in-out",children:[lI.icon&&jsxRuntimeExports.jsx("img",{src:lI.icon,alt:"icon",className:"w-4 h-4 mr-2"}),lI.name,jsxRuntimeExports.jsx("button",{onClick:()=>this.handleChipRemove(lI),className:"ml-2",children:jsxRuntimeExports.jsx("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:"w-4 h-4 text-red-500",children:jsxRuntimeExports.jsx("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})})})]},Math.random()))})]})})})}}class DesmySideBarItem extends React2.Component{constructor(A){super(A),this.state={openMenu:null,openChildMenu:null,is_active:null}}componentDidMount(){this.toggleMenuRequest()}componentDidUpdate(A){this.props.location?.pathname!==A.location?.pathname&&this.toggleMenuRequest()}toggleMenuRequest=()=>{const{location:A,exact:l,pattern:o}=this.props,t=A?.pathname||"",a=Array.isArray(o)?o:o?[o]:[],n=l?a.some(r=>r&&(t===r||r.endsWith("/")&&t===r.slice(0,-1))):!1,B=a.map(r=>r?t.match(r):null).filter(Boolean),R=l?n:B.length>0;this.setState({is_active:R})};handleOnClick=A=>{A.preventDefault(),DesmyCommons$1.isEmptyOrNull(this.props.items)?this.props.onClick?.(A):this.toggleMenu(this.props.name)};handleOnChildClick=(A,l)=>{A.preventDefault(),this.props.onClick?.(A)};toggleMenu=A=>{this.setState(l=>({openMenu:l.openMenu===A?null:A}))};toggleChildMenu=A=>{this.setState(l=>({openChildMenu:l.openChildMenu===A?null:A}))};renderChildItems=(A,l)=>{const{openChildMenu:o}=this.state;return A.map((t,a)=>{const n=o===`${t.label}`;return t.has_permission&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full",children:[jsxRuntimeExports.jsx("a",{onClick:B=>{t.items?(B.preventDefault(),this.toggleChildMenu(`${t.label}`)):(B.preventDefault(),t.onClick?.(t.url))},href:t.url,className:"flex w-full py-2 px-2.5 mb-2 text-xs cursor-pointer",children:jsxRuntimeExports.jsxs("div",{className:"w-full line-clamp-1 flex justify-between",children:[t.label,t.items&&jsxRuntimeExports.jsx("svg",{className:`ml-2 h-4 w-4 flex-shrink-0 transition-transform ${n?"rotate-180":"rotate-0"}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 9l6 6 6-6"})})]})}),t.items&&jsxRuntimeExports.jsx("div",{className:`overflow-hidden transition-all duration-300 ${n?"max-h-96 opacity-100":"max-h-0 opacity-0"} w-full flex flex-col ml-5`,children:this.renderChildItems(t.items,`${t.label}`)})]},`child-${a}`)})};render(){const A=this.state.openMenu===this.props.name;return jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full",children:[jsxRuntimeExports.jsxs("a",{onClick:this.handleOnClick,title:this.props.name,className:`flex space-x-3 text-xs font-poppinsRegular ${this.props.className??"text-black dark:text-white hover:bg-primary/75 dark:hover:bg-white dark:hover:text-black hover:text-white"}  py-2 px-4 items-center rounded transition duration-200 hover:bg-gradient-to-r  ${this.state.is_active?"dark:text-white bg-gray-200 dark:bg-darkBackground font-poppinsSemiBold":"dark:text-white"}`,href:this.props.url,children:[jsxRuntimeExports.jsx("div",{className:"w-6 h-6 flex-shrink-0",children:this.props.icon}),jsxRuntimeExports.jsxs("div",{className:"flex w-full justify-between",children:[jsxRuntimeExports.jsx("div",{className:"text-* w-full line-clamp-1",children:this.props.name}),this.props.items&&jsxRuntimeExports.jsx("svg",{className:`ml-2 h-4 w-4 flex-shrink-0 transition-transform ${A?"rotate-180":"rotate-0"}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 9l6 6 6-6"})})]})]}),jsxRuntimeExports.jsx("div",{className:`overflow-hidden transition-all duration-300 ${A?"max-h-96 opacity-100":"max-h-0 opacity-0"} w-full flex flex-col pl-10 font-poppinsRegular`,children:this.props.items&&this.renderChildItems(this.props.items,this.props.name)})]})}}const millisecondsInWeek=6048e5,millisecondsInDay=864e5,millisecondsInMinute=6e4,millisecondsInHour=36e5,constructFromSymbol=Symbol.for("constructDateFrom");function constructFrom(e,A){return typeof e=="function"?e(A):e&&typeof e=="object"&&constructFromSymbol in e?e[constructFromSymbol](A):e instanceof Date?new e.constructor(A):new Date(A)}function toDate(e,A){return constructFrom(A||e,e)}function addDays(e,A,l){const o=toDate(e,l?.in);return isNaN(A)?constructFrom(e,NaN):(A&&o.setDate(o.getDate()+A),o)}function addMonths(e,A,l){const o=toDate(e,l?.in);if(isNaN(A))return constructFrom(e,NaN);if(!A)return o;const t=o.getDate(),a=constructFrom(e,o.getTime());a.setMonth(o.getMonth()+A+1,0);const n=a.getDate();return t>=n?a:(o.setFullYear(a.getFullYear(),a.getMonth(),t),o)}let defaultOptions={};function getDefaultOptions(){return defaultOptions}function startOfWeek(e,A){const l=getDefaultOptions(),o=A?.weekStartsOn??A?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,t=toDate(e,A?.in),a=t.getDay(),n=(a<o?7:0)+a-o;return t.setDate(t.getDate()-n),t.setHours(0,0,0,0),t}function startOfISOWeek(e,A){return startOfWeek(e,{...A,weekStartsOn:1})}function getISOWeekYear(e,A){const l=toDate(e,A?.in),o=l.getFullYear(),t=constructFrom(l,0);t.setFullYear(o+1,0,4),t.setHours(0,0,0,0);const a=startOfISOWeek(t),n=constructFrom(l,0);n.setFullYear(o,0,4),n.setHours(0,0,0,0);const B=startOfISOWeek(n);return l.getTime()>=a.getTime()?o+1:l.getTime()>=B.getTime()?o:o-1}function getTimezoneOffsetInMilliseconds(e){const A=toDate(e),l=new Date(Date.UTC(A.getFullYear(),A.getMonth(),A.getDate(),A.getHours(),A.getMinutes(),A.getSeconds(),A.getMilliseconds()));return l.setUTCFullYear(A.getFullYear()),+e-+l}function normalizeDates(e,...A){const l=constructFrom.bind(null,A.find(o=>typeof o=="object"));return A.map(l)}function startOfDay(e,A){const l=toDate(e,A?.in);return l.setHours(0,0,0,0),l}function differenceInCalendarDays(e,A,l){const[o,t]=normalizeDates(l?.in,e,A),a=startOfDay(o),n=startOfDay(t),B=+a-getTimezoneOffsetInMilliseconds(a),R=+n-getTimezoneOffsetInMilliseconds(n);return Math.round((B-R)/millisecondsInDay)}function startOfISOWeekYear(e,A){const l=getISOWeekYear(e,A),o=constructFrom(e,0);return o.setFullYear(l,0,4),o.setHours(0,0,0,0),startOfISOWeek(o)}function constructNow(e){return constructFrom(e,Date.now())}function isSameDay(e,A,l){const[o,t]=normalizeDates(l?.in,e,A);return+startOfDay(o)==+startOfDay(t)}function isDate(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function isValid(e){return!(!isDate(e)&&typeof e!="number"||isNaN(+toDate(e)))}function endOfMonth(e,A){const l=toDate(e,A?.in),o=l.getMonth();return l.setFullYear(l.getFullYear(),o+1,0),l.setHours(23,59,59,999),l}function normalizeInterval(e,A){const[l,o]=normalizeDates(e,A.start,A.end);return{start:l,end:o}}function eachDayOfInterval(e,A){const{start:l,end:o}=normalizeInterval(A?.in,e);let t=+l>+o;const a=t?+l:+o,n=t?o:l;n.setHours(0,0,0,0);let B=1;const R=[];for(;+n<=a;)R.push(constructFrom(l,n)),n.setDate(n.getDate()+B),n.setHours(0,0,0,0);return t?R.reverse():R}function startOfMonth(e,A){const l=toDate(e,A?.in);return l.setDate(1),l.setHours(0,0,0,0),l}function startOfYear(e,A){const l=toDate(e,A?.in);return l.setFullYear(l.getFullYear(),0,1),l.setHours(0,0,0,0),l}function endOfWeek(e,A){const l=getDefaultOptions(),o=l.weekStartsOn??l.locale?.options?.weekStartsOn??0,t=toDate(e,A?.in),a=t.getDay(),n=(a<o?-7:0)+6-(a-o);return t.setDate(t.getDate()+n),t.setHours(23,59,59,999),t}const formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=(e,A,l)=>{let o;const t=formatDistanceLocale[e];return typeof t=="string"?o=t:A===1?o=t.one:o=t.other.replace("{{count}}",A.toString()),l?.addSuffix?l.comparison&&l.comparison>0?"in "+o:o+" ago":o};function buildFormatLongFn(e){return(A={})=>{const l=A.width?String(A.width):e.defaultWidth;return e.formats[l]||e.formats[e.defaultWidth]}}const dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=(e,A,l,o)=>formatRelativeLocale[e];function buildLocalizeFn(e){return(A,l)=>{const o=l?.context?String(l.context):"standalone";let t;if(o==="formatting"&&e.formattingValues){const n=e.defaultFormattingWidth||e.defaultWidth,B=l?.width?String(l.width):n;t=e.formattingValues[B]||e.formattingValues[n]}else{const n=e.defaultWidth,B=l?.width?String(l.width):e.defaultWidth;t=e.values[B]||e.values[n]}const a=e.argumentCallback?e.argumentCallback(A):A;return t[a]}}const eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=(e,A)=>{const l=Number(e),o=l%100;if(o>20||o<10)switch(o%10){case 1:return l+"st";case 2:return l+"nd";case 3:return l+"rd"}return l+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:e=>e-1}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})};function buildMatchFn(e){return(A,l={})=>{const o=l.width,t=o&&e.matchPatterns[o]||e.matchPatterns[e.defaultMatchWidth],a=A.match(t);if(!a)return null;const n=a[0],B=o&&e.parsePatterns[o]||e.parsePatterns[e.defaultParseWidth],R=Array.isArray(B)?findIndex(B,II=>II.test(n)):findKey(B,II=>II.test(n));let r;r=e.valueCallback?e.valueCallback(R):R,r=l.valueCallback?l.valueCallback(r):r;const H=A.slice(n.length);return{value:r,rest:H}}}function findKey(e,A){for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)&&A(e[l]))return l}function findIndex(e,A){for(let l=0;l<e.length;l++)if(A(e[l]))return l}function buildMatchPatternFn(e){return(A,l={})=>{const o=A.match(e.matchPattern);if(!o)return null;const t=o[0],a=A.match(e.parsePattern);if(!a)return null;let n=e.valueCallback?e.valueCallback(a[0]):a[0];n=l.valueCallback?l.valueCallback(n):n;const B=A.slice(t.length);return{value:n,rest:B}}}const matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:e=>parseInt(e,10)}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:e=>e+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},enUS={code:"en-US",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:0,firstWeekContainsDate:1}};function getDayOfYear(e,A){const l=toDate(e,A?.in);return differenceInCalendarDays(l,startOfYear(l))+1}function getISOWeek(e,A){const l=toDate(e,A?.in),o=+startOfISOWeek(l)-+startOfISOWeekYear(l);return Math.round(o/millisecondsInWeek)+1}function getWeekYear(e,A){const l=toDate(e,A?.in),o=l.getFullYear(),t=getDefaultOptions(),a=A?.firstWeekContainsDate??A?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,n=constructFrom(A?.in||e,0);n.setFullYear(o+1,0,a),n.setHours(0,0,0,0);const B=startOfWeek(n,A),R=constructFrom(A?.in||e,0);R.setFullYear(o,0,a),R.setHours(0,0,0,0);const r=startOfWeek(R,A);return+l>=+B?o+1:+l>=+r?o:o-1}function startOfWeekYear(e,A){const l=getDefaultOptions(),o=A?.firstWeekContainsDate??A?.locale?.options?.firstWeekContainsDate??l.firstWeekContainsDate??l.locale?.options?.firstWeekContainsDate??1,t=getWeekYear(e,A),a=constructFrom(A?.in||e,0);return a.setFullYear(t,0,o),a.setHours(0,0,0,0),startOfWeek(a,A)}function getWeek(e,A){const l=toDate(e,A?.in),o=+startOfWeek(l,A)-+startOfWeekYear(l,A);return Math.round(o/millisecondsInWeek)+1}function addLeadingZeros(e,A){const l=e<0?"-":"",o=Math.abs(e).toString().padStart(A,"0");return l+o}const lightFormatters={y(e,A){const l=e.getFullYear(),o=l>0?l:1-l;return addLeadingZeros(A==="yy"?o%100:o,A.length)},M(e,A){const l=e.getMonth();return A==="M"?String(l+1):addLeadingZeros(l+1,2)},d(e,A){return addLeadingZeros(e.getDate(),A.length)},a(e,A){const l=e.getHours()/12>=1?"pm":"am";switch(A){case"a":case"aa":return l.toUpperCase();case"aaa":return l;case"aaaaa":return l[0];case"aaaa":default:return l==="am"?"a.m.":"p.m."}},h(e,A){return addLeadingZeros(e.getHours()%12||12,A.length)},H(e,A){return addLeadingZeros(e.getHours(),A.length)},m(e,A){return addLeadingZeros(e.getMinutes(),A.length)},s(e,A){return addLeadingZeros(e.getSeconds(),A.length)},S(e,A){const l=A.length,o=e.getMilliseconds(),t=Math.trunc(o*Math.pow(10,l-3));return addLeadingZeros(t,A.length)}},dayPeriodEnum={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters={G:function(e,A,l){const o=e.getFullYear()>0?1:0;switch(A){case"G":case"GG":case"GGG":return l.era(o,{width:"abbreviated"});case"GGGGG":return l.era(o,{width:"narrow"});case"GGGG":default:return l.era(o,{width:"wide"})}},y:function(e,A,l){if(A==="yo"){const o=e.getFullYear(),t=o>0?o:1-o;return l.ordinalNumber(t,{unit:"year"})}return lightFormatters.y(e,A)},Y:function(e,A,l,o){const t=getWeekYear(e,o),a=t>0?t:1-t;if(A==="YY"){const n=a%100;return addLeadingZeros(n,2)}return A==="Yo"?l.ordinalNumber(a,{unit:"year"}):addLeadingZeros(a,A.length)},R:function(e,A){const l=getISOWeekYear(e);return addLeadingZeros(l,A.length)},u:function(e,A){const l=e.getFullYear();return addLeadingZeros(l,A.length)},Q:function(e,A,l){const o=Math.ceil((e.getMonth()+1)/3);switch(A){case"Q":return String(o);case"QQ":return addLeadingZeros(o,2);case"Qo":return l.ordinalNumber(o,{unit:"quarter"});case"QQQ":return l.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return l.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return l.quarter(o,{width:"wide",context:"formatting"})}},q:function(e,A,l){const o=Math.ceil((e.getMonth()+1)/3);switch(A){case"q":return String(o);case"qq":return addLeadingZeros(o,2);case"qo":return l.ordinalNumber(o,{unit:"quarter"});case"qqq":return l.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return l.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return l.quarter(o,{width:"wide",context:"standalone"})}},M:function(e,A,l){const o=e.getMonth();switch(A){case"M":case"MM":return lightFormatters.M(e,A);case"Mo":return l.ordinalNumber(o+1,{unit:"month"});case"MMM":return l.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return l.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return l.month(o,{width:"wide",context:"formatting"})}},L:function(e,A,l){const o=e.getMonth();switch(A){case"L":return String(o+1);case"LL":return addLeadingZeros(o+1,2);case"Lo":return l.ordinalNumber(o+1,{unit:"month"});case"LLL":return l.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return l.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return l.month(o,{width:"wide",context:"standalone"})}},w:function(e,A,l,o){const t=getWeek(e,o);return A==="wo"?l.ordinalNumber(t,{unit:"week"}):addLeadingZeros(t,A.length)},I:function(e,A,l){const o=getISOWeek(e);return A==="Io"?l.ordinalNumber(o,{unit:"week"}):addLeadingZeros(o,A.length)},d:function(e,A,l){return A==="do"?l.ordinalNumber(e.getDate(),{unit:"date"}):lightFormatters.d(e,A)},D:function(e,A,l){const o=getDayOfYear(e);return A==="Do"?l.ordinalNumber(o,{unit:"dayOfYear"}):addLeadingZeros(o,A.length)},E:function(e,A,l){const o=e.getDay();switch(A){case"E":case"EE":case"EEE":return l.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return l.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return l.day(o,{width:"short",context:"formatting"});case"EEEE":default:return l.day(o,{width:"wide",context:"formatting"})}},e:function(e,A,l,o){const t=e.getDay(),a=(t-o.weekStartsOn+8)%7||7;switch(A){case"e":return String(a);case"ee":return addLeadingZeros(a,2);case"eo":return l.ordinalNumber(a,{unit:"day"});case"eee":return l.day(t,{width:"abbreviated",context:"formatting"});case"eeeee":return l.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return l.day(t,{width:"short",context:"formatting"});case"eeee":default:return l.day(t,{width:"wide",context:"formatting"})}},c:function(e,A,l,o){const t=e.getDay(),a=(t-o.weekStartsOn+8)%7||7;switch(A){case"c":return String(a);case"cc":return addLeadingZeros(a,A.length);case"co":return l.ordinalNumber(a,{unit:"day"});case"ccc":return l.day(t,{width:"abbreviated",context:"standalone"});case"ccccc":return l.day(t,{width:"narrow",context:"standalone"});case"cccccc":return l.day(t,{width:"short",context:"standalone"});case"cccc":default:return l.day(t,{width:"wide",context:"standalone"})}},i:function(e,A,l){const o=e.getDay(),t=o===0?7:o;switch(A){case"i":return String(t);case"ii":return addLeadingZeros(t,A.length);case"io":return l.ordinalNumber(t,{unit:"day"});case"iii":return l.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return l.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return l.day(o,{width:"short",context:"formatting"});case"iiii":default:return l.day(o,{width:"wide",context:"formatting"})}},a:function(e,A,l){const t=e.getHours()/12>=1?"pm":"am";switch(A){case"a":case"aa":return l.dayPeriod(t,{width:"abbreviated",context:"formatting"});case"aaa":return l.dayPeriod(t,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return l.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return l.dayPeriod(t,{width:"wide",context:"formatting"})}},b:function(e,A,l){const o=e.getHours();let t;switch(o===12?t=dayPeriodEnum.noon:o===0?t=dayPeriodEnum.midnight:t=o/12>=1?"pm":"am",A){case"b":case"bb":return l.dayPeriod(t,{width:"abbreviated",context:"formatting"});case"bbb":return l.dayPeriod(t,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return l.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return l.dayPeriod(t,{width:"wide",context:"formatting"})}},B:function(e,A,l){const o=e.getHours();let t;switch(o>=17?t=dayPeriodEnum.evening:o>=12?t=dayPeriodEnum.afternoon:o>=4?t=dayPeriodEnum.morning:t=dayPeriodEnum.night,A){case"B":case"BB":case"BBB":return l.dayPeriod(t,{width:"abbreviated",context:"formatting"});case"BBBBB":return l.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return l.dayPeriod(t,{width:"wide",context:"formatting"})}},h:function(e,A,l){if(A==="ho"){let o=e.getHours()%12;return o===0&&(o=12),l.ordinalNumber(o,{unit:"hour"})}return lightFormatters.h(e,A)},H:function(e,A,l){return A==="Ho"?l.ordinalNumber(e.getHours(),{unit:"hour"}):lightFormatters.H(e,A)},K:function(e,A,l){const o=e.getHours()%12;return A==="Ko"?l.ordinalNumber(o,{unit:"hour"}):addLeadingZeros(o,A.length)},k:function(e,A,l){let o=e.getHours();return o===0&&(o=24),A==="ko"?l.ordinalNumber(o,{unit:"hour"}):addLeadingZeros(o,A.length)},m:function(e,A,l){return A==="mo"?l.ordinalNumber(e.getMinutes(),{unit:"minute"}):lightFormatters.m(e,A)},s:function(e,A,l){return A==="so"?l.ordinalNumber(e.getSeconds(),{unit:"second"}):lightFormatters.s(e,A)},S:function(e,A){return lightFormatters.S(e,A)},X:function(e,A,l){const o=e.getTimezoneOffset();if(o===0)return"Z";switch(A){case"X":return formatTimezoneWithOptionalMinutes(o);case"XXXX":case"XX":return formatTimezone(o);case"XXXXX":case"XXX":default:return formatTimezone(o,":")}},x:function(e,A,l){const o=e.getTimezoneOffset();switch(A){case"x":return formatTimezoneWithOptionalMinutes(o);case"xxxx":case"xx":return formatTimezone(o);case"xxxxx":case"xxx":default:return formatTimezone(o,":")}},O:function(e,A,l){const o=e.getTimezoneOffset();switch(A){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(o,":");case"OOOO":default:return"GMT"+formatTimezone(o,":")}},z:function(e,A,l){const o=e.getTimezoneOffset();switch(A){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(o,":");case"zzzz":default:return"GMT"+formatTimezone(o,":")}},t:function(e,A,l){const o=Math.trunc(+e/1e3);return addLeadingZeros(o,A.length)},T:function(e,A,l){return addLeadingZeros(+e,A.length)}};function formatTimezoneShort(e,A=""){const l=e>0?"-":"+",o=Math.abs(e),t=Math.trunc(o/60),a=o%60;return a===0?l+String(t):l+String(t)+A+addLeadingZeros(a,2)}function formatTimezoneWithOptionalMinutes(e,A){return e%60===0?(e>0?"-":"+")+addLeadingZeros(Math.abs(e)/60,2):formatTimezone(e,A)}function formatTimezone(e,A=""){const l=e>0?"-":"+",o=Math.abs(e),t=addLeadingZeros(Math.trunc(o/60),2),a=addLeadingZeros(o%60,2);return l+t+A+a}const dateLongFormatter=(e,A)=>{switch(e){case"P":return A.date({width:"short"});case"PP":return A.date({width:"medium"});case"PPP":return A.date({width:"long"});case"PPPP":default:return A.date({width:"full"})}},timeLongFormatter=(e,A)=>{switch(e){case"p":return A.time({width:"short"});case"pp":return A.time({width:"medium"});case"ppp":return A.time({width:"long"});case"pppp":default:return A.time({width:"full"})}},dateTimeLongFormatter=(e,A)=>{const l=e.match(/(P+)(p+)?/)||[],o=l[1],t=l[2];if(!t)return dateLongFormatter(e,A);let a;switch(o){case"P":a=A.dateTime({width:"short"});break;case"PP":a=A.dateTime({width:"medium"});break;case"PPP":a=A.dateTime({width:"long"});break;case"PPPP":default:a=A.dateTime({width:"full"});break}return a.replace("{{date}}",dateLongFormatter(o,A)).replace("{{time}}",timeLongFormatter(t,A))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter},dayOfYearTokenRE=/^D+$/,weekYearTokenRE=/^Y+$/,throwTokens=["D","DD","YY","YYYY"];function isProtectedDayOfYearToken(e){return dayOfYearTokenRE.test(e)}function isProtectedWeekYearToken(e){return weekYearTokenRE.test(e)}function warnOrThrowProtectedError(e,A,l){const o=message(e,A,l);if(console.warn(o),throwTokens.includes(e))throw new RangeError(o)}function message(e,A,l){const o=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${A}\`) for formatting ${o} to the input \`${l}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function format(e,A,l){const o=getDefaultOptions(),t=o.locale??enUS,a=o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,n=o.weekStartsOn??o.locale?.options?.weekStartsOn??0,B=toDate(e,l?.in);if(!isValid(B))throw new RangeError("Invalid time value");let R=A.match(longFormattingTokensRegExp).map(H=>{const II=H[0];if(II==="p"||II==="P"){const k=longFormatters[II];return k(H,t.formatLong)}return H}).join("").match(formattingTokensRegExp).map(H=>{if(H==="''")return{isToken:!1,value:"'"};const II=H[0];if(II==="'")return{isToken:!1,value:cleanEscapedString(H)};if(formatters[II])return{isToken:!0,value:H};if(II.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+II+"`");return{isToken:!1,value:H}});t.localize.preprocessor&&(R=t.localize.preprocessor(B,R));const r={firstWeekContainsDate:a,weekStartsOn:n,locale:t};return R.map(H=>{if(!H.isToken)return H.value;const II=H.value;(isProtectedWeekYearToken(II)||isProtectedDayOfYearToken(II))&&warnOrThrowProtectedError(II,A,String(e));const k=formatters[II[0]];return k(B,II,t.localize,r)}).join("")}function cleanEscapedString(e){const A=e.match(escapedStringRegExp);return A?A[1].replace(doubleQuoteRegExp,"'"):e}function getDaysInMonth(e,A){const l=toDate(e,A?.in),o=l.getFullYear(),t=l.getMonth(),a=constructFrom(l,0);return a.setFullYear(o,t+1,0),a.setHours(0,0,0,0),a.getDate()}function isAfter(e,A){return+toDate(e)>+toDate(A)}function isBefore(e,A){return+toDate(e)<+toDate(A)}function isToday(e,A){return isSameDay(constructFrom(e,e),constructNow(e))}function isWithinInterval(e,A,l){const o=+toDate(e,l?.in),[t,a]=[+toDate(A.start,l?.in),+toDate(A.end,l?.in)].sort((n,B)=>n-B);return o>=t&&o<=a}function subDays(e,A,l){return addDays(e,-1,l)}function parseISO(e,A){const l=()=>constructFrom(A?.in,NaN),t=splitDateString(e);let a;if(t.date){const r=parseYear(t.date,2);a=parseDate(r.restDateString,r.year)}if(!a||isNaN(+a))return l();const n=+a;let B=0,R;if(t.time&&(B=parseTime(t.time),isNaN(B)))return l();if(t.timezone){if(R=parseTimezone(t.timezone),isNaN(R))return l()}else{const r=new Date(n+B),H=toDate(0,A?.in);return H.setFullYear(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()),H.setHours(r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()),H}return toDate(n+B+R,A?.in)}const patterns={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},dateRegex=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,timeRegex=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,timezoneRegex=/^([+-])(\d{2})(?::?(\d{2}))?$/;function splitDateString(e){const A={},l=e.split(patterns.dateTimeDelimiter);let o;if(l.length>2)return A;if(/:/.test(l[0])?o=l[0]:(A.date=l[0],o=l[1],patterns.timeZoneDelimiter.test(A.date)&&(A.date=e.split(patterns.timeZoneDelimiter)[0],o=e.substr(A.date.length,e.length))),o){const t=patterns.timezone.exec(o);t?(A.time=o.replace(t[1],""),A.timezone=t[1]):A.time=o}return A}function parseYear(e,A){const l=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+A)+"})|(\\d{2}|[+-]\\d{"+(2+A)+"})$)"),o=e.match(l);if(!o)return{year:NaN,restDateString:""};const t=o[1]?parseInt(o[1]):null,a=o[2]?parseInt(o[2]):null;return{year:a===null?t:a*100,restDateString:e.slice((o[1]||o[2]).length)}}function parseDate(e,A){if(A===null)return new Date(NaN);const l=e.match(dateRegex);if(!l)return new Date(NaN);const o=!!l[4],t=parseDateUnit(l[1]),a=parseDateUnit(l[2])-1,n=parseDateUnit(l[3]),B=parseDateUnit(l[4]),R=parseDateUnit(l[5])-1;if(o)return validateWeekDate(A,B,R)?dayOfISOWeekYear(A,B,R):new Date(NaN);{const r=new Date(0);return!validateDate(A,a,n)||!validateDayOfYearDate(A,t)?new Date(NaN):(r.setUTCFullYear(A,a,Math.max(t,n)),r)}}function parseDateUnit(e){return e?parseInt(e):1}function parseTime(e){const A=e.match(timeRegex);if(!A)return NaN;const l=parseTimeUnit(A[1]),o=parseTimeUnit(A[2]),t=parseTimeUnit(A[3]);return validateTime(l,o,t)?l*millisecondsInHour+o*millisecondsInMinute+t*1e3:NaN}function parseTimeUnit(e){return e&&parseFloat(e.replace(",","."))||0}function parseTimezone(e){if(e==="Z")return 0;const A=e.match(timezoneRegex);if(!A)return 0;const l=A[1]==="+"?-1:1,o=parseInt(A[2]),t=A[3]&&parseInt(A[3])||0;return validateTimezone(o,t)?l*(o*millisecondsInHour+t*millisecondsInMinute):NaN}function dayOfISOWeekYear(e,A,l){const o=new Date(0);o.setUTCFullYear(e,0,4);const t=o.getUTCDay()||7,a=(A-1)*7+l+1-t;return o.setUTCDate(o.getUTCDate()+a),o}const daysInMonths=[31,null,31,30,31,30,31,31,30,31,30,31];function isLeapYearIndex(e){return e%400===0||e%4===0&&e%100!==0}function validateDate(e,A,l){return A>=0&&A<=11&&l>=1&&l<=(daysInMonths[A]||(isLeapYearIndex(e)?29:28))}function validateDayOfYearDate(e,A){return A>=1&&A<=(isLeapYearIndex(e)?366:365)}function validateWeekDate(e,A,l){return A>=1&&A<=53&&l>=0&&l<=6}function validateTime(e,A,l){return e===24?A===0&&l===0:l>=0&&l<60&&A>=0&&A<60&&e>=0&&e<25}function validateTimezone(e,A){return A>=0&&A<=59}function setMonth(e,A,l){const o=toDate(e,l?.in),t=o.getFullYear(),a=o.getDate(),n=constructFrom(e,0);n.setFullYear(t,A,15),n.setHours(0,0,0,0);const B=getDaysInMonth(n);return o.setMonth(A,Math.min(a,B)),o}function setYear(e,A,l){const o=toDate(e,l?.in);return isNaN(+o)?constructFrom(e,NaN):(o.setFullYear(A),o)}function subMonths(e,A,l){return addMonths(e,-1,l)}class DesmyButton extends React2.Component{constructor(A){super(A)}render(){return jsxRuntimeExports.jsx("button",{type:"button",onClick:this.props.onClick,disabled:this.props.hasRequest||this.props.disabled,className:`${this.props.type===DesmyState.SMALL?" px-4 py-3 ":" px-5 py-3 "} w-auto justifiy-center items-center  bg-[var(--color-primary)] hover:bg-primary/75  text-white dark:bg-[var(--color-darkDialogBackground)]  text-xs  dark:hover:bg-[var(--color-white)] dark:hover:text-black ${this.props.className}  font-poppinsRegular items-center   rounded-full cursor-pointer  transition duration-500 ease-in-out`,children:this.props.hasRequest?jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("svg",{role:"status",className:"inline mr-3 w-5 h-5 text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}),jsxRuntimeExports.jsxs("span",{className:"hidden lg:flex",children:[this.props.label_request,"..."]})]}):jsxRuntimeExports.jsxs("div",{className:"flex justify-center items-center",children:[this.props.icon,jsxRuntimeExports.jsx("span",{className:this.props.labelClassName,children:this.props.label})]})})}}const DateContext=React2.createContext(void 0);class DateProvider extends React2.Component{static defaultProps={useRange:!0};constructor(A){super(A);const l=new Date;this.state={startDate:null,endDate:null,isOpen:!1,currentMonthLeft:startOfMonth(l),currentMonthRight:startOfMonth(addMonths(l,1)),useRange:A.useRange??!0,startTime:null,endTime:null}}setStartDate=A=>{this.setState({startDate:A})};setEndDate=A=>{this.setState({endDate:A})};setCurrentMonthLeft=A=>{this.setState({currentMonthLeft:A})};setCurrentMonthRight=A=>{this.setState({currentMonthRight:A})};setIsOpen=A=>{this.state.isOpen!==A&&this.setState({isOpen:A})};setStartTime=A=>{this.setState({startTime:A})};setEndTime=A=>{this.setState({endTime:A})};render(){return jsxRuntimeExports.jsx(DateContext.Provider,{value:{startDate:this.state.startDate,endDate:this.state.endDate,setStartDate:this.setStartDate,setEndDate:this.setEndDate,currentMonthLeft:this.state.currentMonthLeft,currentMonthRight:this.state.currentMonthRight,setCurrentMonthLeft:this.setCurrentMonthLeft,setCurrentMonthRight:this.setCurrentMonthRight,isOpen:this.state.isOpen,setIsOpen:this.setIsOpen,useRange:this.state.useRange,startTime:this.state.startTime,endTime:this.state.endTime,setStartTime:this.setStartTime,setEndTime:this.setEndTime},children:this.props.children})}}function withDateContext(e){return class extends React2.Component{render(){return jsxRuntimeExports.jsx(DateContext.Consumer,{children:A=>{if(!A)throw new Error("DateContext is not available");return jsxRuntimeExports.jsx(e,{...this.props,dateContext:A})}})}}}const Months=({currentMonth:e,onSelectMonth:A,minDate:l,maxDate:o})=>{const t=a=>{const n=startOfMonth(setMonth(e,a)),B=endOfMonth(n);if(l&&o){const R=isWithinInterval(l,{start:n,end:B}),r=isWithinInterval(o,{start:n,end:B}),H=isWithinInterval(n,{start:l,end:o})||isWithinInterval(B,{start:l,end:o});return!(R||r||H)}return l?isBefore(B,l):o?isAfter(n,o):!1};return jsxRuntimeExports.jsx("div",{className:"grid grid-cols-3 gap-2",children:Array.from({length:12}).map((a,n)=>{const B=setMonth(e,n),R=t(n);return jsxRuntimeExports.jsx("button",{className:`p-2 rounded border text-sm font-medium ${R?"text-gray-400 line-through cursor-not-allowed":"hover:bg-gray-200 dark:hover:bg-darkPrimaryBorder"}`,onClick:r=>{r.preventDefault(),!R&&A(n)},disabled:R,children:format(B,"MMM")},n)})})},Years=({currentYear:e,onSelectYear:A,minDate:l,maxDate:o})=>{const t=e-60,a=e+60;return jsxRuntimeExports.jsx("div",{className:"grid grid-cols-4 gap-2 h-80 pb-5 overflow-auto",children:Array.from({length:a-t+1}).map((n,B)=>{const R=t+B,r=setYear(new Date,R),H=l&&isBefore(r,l)||o&&isAfter(r,o);return jsxRuntimeExports.jsx("button",{className:`p-2 rounded border dark:text-white dark:hover:text-white dark:border-darkPrimaryBorder dark:hover:bg-darkPrimaryBorder cursor-pointer ${H?"text-gray-400  line-through cursor-not-allowed":"hover:bg-gray-200"}`,onClick:()=>!H&&A(R),disabled:H,children:R},R)})})};class Days extends React2.Component{constructor(A){super(A),this.state={viewMode:"days"}}componentDidMount(){const{useRange:A,setStartDate:l,setEndDate:o,setCurrentMonthLeft:t,setCurrentMonthRight:a}=this.props.dateContext,{defaultDate:n}=this.props;!A&&n&&(l(n),o(null),t(startOfMonth(n)),a(startOfMonth(addMonths(n,1))))}componentDidUpdate(A){const{startDate:l,endDate:o,setStartDate:t,setEndDate:a,setIsOpen:n}=this.props.dateContext,{useRange:B,withTime:R}=this.props;!B&&l!==A.dateContext.startDate&&(R||n(!1)),B&&l&&o&&(l!==A.dateContext.startDate||o!==A.dateContext.endDate)&&(R||n(!1)),B&&l&&o&&isAfter(l,o)&&(t(o),a(l))}handleSelectDay=(A,l)=>{A.preventDefault();const{minDate:o,maxDate:t,useRange:a,onSelect:n}=this.props,{setStartDate:B,setEndDate:R}=this.props.dateContext;if(!(o&&isBefore(l,subDays(o)))&&!(t&&isAfter(l,addDays(t,1)))){if(!a)B(l),R(null);else{const{startDate:r,endDate:H}=this.props.dateContext;!r||r&&H?(B(l),R(null)):R(l)}n&&n(l)}};canNavigate=(A,l)=>{const{dateContext:o,minDate:t,maxDate:a,useRange:n}=this.props,{currentMonthLeft:B,currentMonthRight:R}=o;if(!n){const r=A==="next"?addMonths(B,1):subMonths(B);return!(A==="prev"&&t&&isBefore(r,t)||A==="next"&&a&&isAfter(r,a))}if(l===0){const r=A==="next"?addMonths(B,1):subMonths(B);return a&&isBefore(r,R)&&!(t&&isBefore(r,t))}else if(l===1){const r=A==="next"?addMonths(R,1):subMonths(R);return t&&isAfter(r,B)&&!(a&&isAfter(r,a))}return!0};navigateMonth=(A,l)=>{const{dateContext:o}=this.props,{currentMonthLeft:t,setCurrentMonthLeft:a,currentMonthRight:n,setCurrentMonthRight:B}=o;if(this.canNavigate(A,l)){if(l===0){const R=A==="next"?addMonths(t,1):subMonths(t);a(R)}else if(l===1){const R=A==="next"?addMonths(n,1):subMonths(n);B(R)}}};selectMonth=A=>{const{calendarIndex:l,dateContext:o}=this.props,{currentMonthLeft:t,setCurrentMonthLeft:a,currentMonthRight:n,setCurrentMonthRight:B}=o;if(l===0){const R=setMonth(t,A);if(!this.canNavigate("next",0)&&isAfter(R,n))return;a(R)}else if(l===1){const R=setMonth(n,A);if(!this.canNavigate("prev",1)&&isBefore(R,t))return;B(R)}this.setState({viewMode:"days"})};selectYear=A=>{const{calendarIndex:l,dateContext:o}=this.props,{currentMonthLeft:t,setCurrentMonthLeft:a,currentMonthRight:n,setCurrentMonthRight:B}=o;if(l===0){const R=setYear(t,A);if(!this.canNavigate("next",0)&&isAfter(R,n))return;a(R)}else if(l===1){const R=setYear(n,A);if(!this.canNavigate("prev",1)&&isBefore(R,t))return;B(R)}this.setState({viewMode:"days"})};isWithinSelectedRange=A=>{const{startDate:l,endDate:o}=this.props.dateContext,{useRange:t}=this.props;return t&&l&&o&&isWithinInterval(A,{start:l,end:o})};isSelectedDate=A=>{const{startDate:l,endDate:o}=this.props.dateContext;return l&&isSameDay(A,l)||o&&isSameDay(A,o)};isWithinCurrentMonth=(A,l)=>{const o=startOfMonth(l),t=endOfMonth(l);return isWithinInterval(A,{start:o,end:t})};isTodayDate=A=>isToday(A);render(){const{calendarIndex:A=0,minDate:l,maxDate:o,dateContext:t}=this.props,{currentMonthLeft:a,currentMonthRight:n}=t,{viewMode:B}=this.state,R=A===0?a:n,r=startOfMonth(R),H=endOfMonth(R),II=startOfWeek(r),k=endOfWeek(H),iI=eachDayOfInterval({start:II,end:k}),lI=l&&isBefore(R,l),CI=o&&isAfter(R,o);return jsxRuntimeExports.jsxs("div",{className:"w-[350px] text-xs h-96 p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-2",children:[jsxRuntimeExports.jsx("button",{className:`p-1 text-gray-500 hover:bg-gray-200 rounded ${lI?"cursor-not-allowed text-gray-300":""}`,onClick:sI=>{sI.preventDefault(),!lI&&this.navigateMonth("prev",A)},disabled:lI,children:"<"}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between w-full space-x-2 px-10",children:[jsxRuntimeExports.jsx("span",{className:`text-lg font-semibold cursor-pointer ${B==="months"?"text-blue-500 underline":"hover:text-blue-500"}`,onClick:()=>this.setState({viewMode:B==="months"?"days":"months"}),children:format(R,"MMM")}),jsxRuntimeExports.jsx("span",{className:`text-lg font-semibold cursor-pointer ${B==="years"?"text-blue-500 underline":"hover:text-blue-500"}`,onClick:()=>this.setState({viewMode:B==="years"?"days":"years"}),children:format(R,"yyyy")})]}),jsxRuntimeExports.jsx("button",{className:`p-1 text-gray-500 hover:bg-gray-200 rounded ${CI?"cursor-not-allowed text-gray-300":""}`,onClick:sI=>{sI.preventDefault(),!CI&&this.navigateMonth("next",A)},disabled:CI,children:">"})]}),B==="months"&&jsxRuntimeExports.jsx(Months,{currentMonth:R,onSelectMonth:this.selectMonth,minDate:l,maxDate:o}),B==="years"&&jsxRuntimeExports.jsx(Years,{currentYear:R.getFullYear(),onSelectYear:this.selectYear,minDate:l,maxDate:o}),B==="days"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"grid grid-cols-7 gap-1 text-center font-semibold text-gray-600 dark:text-white",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(sI=>jsxRuntimeExports.jsx("div",{className:"h-8",children:sI},sI))}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-7 gap-1 text-center",children:iI.map(sI=>{const oI=l&&isBefore(sI,subDays(l))||o&&isAfter(sI,addDays(o,1)),E=this.isSelectedDate(sI),_=this.isWithinSelectedRange(sI),gI=this.isTodayDate(sI),M=this.isWithinCurrentMonth(sI,R);return jsxRuntimeExports.jsx("button",{className:`h-10 w-10 rounded-full text-sm cursor-pointer ${oI?"text-gray-400 line-through cursor-not-allowed":M?_?"bg-blue-200 text-blue-600 dark:bg-darkPrimaryBorder dark:text-white":E?"bg-blue-500 dark:bg-darkBackground text-white":gI?"bg-yellow-200 dark:bg-white dark:text-black text-yellow-800":" dark:hover:bg-darkPrimaryBorder hover:bg-gray-100 text-black dark:text-white":"text-gray-400 cursor-not-allowed"} ${gI&&!_&&!E&&A==0?"bg-primary/100 dark:bg-white dark:text-black text-white":""} `,onClick:O=>{O.preventDefault(),!oI&&this.handleSelectDay(O,sI)},disabled:oI,children:format(sI,"d")},sI.toString())})})]})]})}}const Days$1=withDateContext(Days);class TimeSelector extends React2.Component{parseTime(A){if(!A||!A.includes(":"))return{h:12,m:0,meridian:"AM"};const[l,o="AM"]=A.trim().split(" "),[t,a]=l.split(":"),n=parseInt(t,10),B=parseInt(a,10);return{h:isNaN(n)?12:n,m:isNaN(B)?0:B,meridian:o.toUpperCase()==="PM"?"PM":"AM"}}formatTime(A,l,o){const t=String(A||12).padStart(2,"0"),a=String(l||0).padStart(2,"0");return`${t}:${a} ${o||"AM"}`}updateTime(A,l){const{h:o,m:t,meridian:a}=this.parseTime(this.props.value);let n=o,B=t,R=a;A==="h"?n=l==="up"?n%12+1:n-1||12:A==="m"?B=l==="up"?(B+1)%60:(B-1+60)%60:A==="meridian"&&(R=R==="AM"?"PM":"AM"),this.props.onChange(this.formatTime(n,B,R))}render(){const{label:A,value:l}=this.props,{h:o,m:t,meridian:a}=this.parseTime(l);return jsxRuntimeExports.jsxs("div",{className:"text-xs text-center",children:[jsxRuntimeExports.jsx("label",{className:"flex w-full text-center lg:text-start font-bold mb-1",children:A}),jsxRuntimeExports.jsx("div",{className:"inline-flex items-center rounded p-2 gap-4 shadow dark:bg-darkBackground",children:["h","m","meridian"].map(n=>jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsx("button",{onClick:B=>{B.preventDefault(),this.updateTime(n,"up")},children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"size-5",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"})})}),jsxRuntimeExports.jsxs("div",{className:"flex size-10 font-black text-xl text-center justify-center items-center",children:[n==="h"&&o,n==="m"&&String(t).padStart(2,"0"),n==="meridian"&&a]}),jsxRuntimeExports.jsx("button",{onClick:B=>{B.preventDefault(),this.updateTime(n,"down")},children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"size-5",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6l-6-6z"})})})]},n))})]})}}class TimePicker extends React2.Component{static contextType=DateContext;handleStartTimeChange=A=>{this.context.setStartTime(A)};handleEndTimeChange=A=>{this.context.setEndTime(A)};render(){const{useRange:A,onConfirm:l}=this.props,{startTime:o,endTime:t}=this.context,a=()=>!!(!o||A&&!t);return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2 mt-4 text-xs",children:[jsxRuntimeExports.jsx(TimeSelector,{label:"Start Time",value:o||"12:00 AM",onChange:n=>this.context.setStartTime(n)}),A&&jsxRuntimeExports.jsx(TimeSelector,{label:"End Time",value:t||"12:00 PM",onChange:n=>this.context.setEndTime(n)}),jsxRuntimeExports.jsx("div",{className:"flex w-full justify-end items-center",children:jsxRuntimeExports.jsx("button",{type:"button",className:`mt-2 px-3 rounded-full py-2 cursor-pointer text-sm ${a()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,onClick:n=>{n.preventDefault(),!a()&&l&&l()},disabled:a(),children:"Confirm"})})]})}}class DatePickerProvider extends React2.Component{static contextType=DateContext;parentContainerRef=React2.createRef();inputRef=React2.createRef();popoverDropdownRef=React2.createRef();arrowRef=React2.createRef();popperInstance=null;saveDateValue;constructor(A){super(A),this.state={wasOpenBeforeBlur:!1,isFocusTriggered:!1,isMobile:window.innerWidth<=768||window.innerHeight<1e3,isModal:window.innerHeight<1e3},this.saveDateValue={startDate:"",endDate:""}}componentDidMount(){document.addEventListener("mousedown",this.handleClickOutside),document.addEventListener("visibilitychange",this.handleVisibilityChange),window.addEventListener("resize",this.handleResize),this.handleDefault(),this.state.isMobile||this.handleDatePickerPopover()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside),document.removeEventListener("visibilitychange",this.handleVisibilityChange),window.removeEventListener("resize",this.handleResize),this.popperInstance?.destroy()}componentDidUpdate(){this.handleDateSelection()}handleResize=()=>{};handleDefault=()=>{const{defaultValue:A,withTime:l,useRange:o}=this.props,{setStartDate:t,setEndDate:a,setStartTime:n,setEndTime:B}=this.context,R=E=>E?typeof E=="string"?E:E instanceof Date||typeof E=="object"&&"toISOString"in E?E.toISOString():"":"",r=R(A?.startDate||A),H=R(A?.endDate||A),II=o&&r.includes(" - ")?r.split(" - "):[r,H],k=E=>{if(!E)return{date:null,time:null};if(E.includes("T")){const dI=parseISO(E),eI=E.match(/T(\d{2}:\d{2})/);return{date:isValid(dI)?dI:null,time:eI?eI[1]:null}}const _=E.trim().split(" "),gI=_[0],M=_.length>1?_[1]:null;return{date:isValid(parseISO(gI))?parseISO(gI):null,time:typeof M=="string"?M:null}},{date:iI,time:lI}=k(II[0]),{date:CI,time:sI}=k(II[1]);iI&&t(iI),CI&&a(CI),lI&&n(lI),sI&&B(sI);const oI=(E,_)=>{if(!E)return"";const gI=format(E,"yyyy-MM-dd");if(l&&_){const M=_.includes("AM")||_.includes("PM")?this.convertTo24Hour(_):_;return`${gI} ${M}`}return gI};this.saveDateValue={startDate:oI(iI,lI),endDate:oI(CI,sI)}};parseDate(A){if(!A)return null;if(typeof A=="string"){const l=parseISO(A);return isValid(l)?l:null}return A}extractTime(A){if(!A)return null;let l="";typeof A=="string"?l=A:A instanceof Date&&(l=A.toISOString());const o=l.match(/T(\d{2}:\d{2})/);return o?o[1]:null}toISOStringString(A){return A?typeof A=="string"?A:A instanceof Date?A.toISOString():"":""}handleClickOutside=A=>{this.parentContainerRef.current&&!this.parentContainerRef.current.contains(A.target)&&this.closeDatePickerPopover()};closeDatePickerPopover=()=>{this.context.setIsOpen(!1)};handleInputFocus=()=>{setTimeout(()=>{this.openDatePickerPopover()},500)};openDatePickerPopover=()=>{this.context.setIsOpen(!0),this.state.isMobile||(this.handleDatePickerPopover(),setTimeout(this.handleDatePickerPopover,2))};handleDatePickerPopover=()=>{this.inputRef.current&&this.popoverDropdownRef.current&&(this.popperInstance?.destroy(),this.popperInstance=createPopper(this.inputRef.current,this.popoverDropdownRef.current,{placement:"bottom-start",strategy:"fixed",modifiers:[{name:"offset",options:{offset:[0,10]}},{name:"flip",options:{fallbackPlacements:["top","top-start","bottom","bottom-start"]}},{name:"preventOverflow",options:{boundary:"viewport"}}]}))};convertTo24Hour(A){if(!A)return"";const[l,o]=A.split(" ");if(!l||!o)return A;let[t,a]=l.split(":").map(Number);return o.toLowerCase()==="pm"&&t<12&&(t+=12),o.toLowerCase()==="am"&&t===12&&(t=0),`${String(t).padStart(2,"0")}:${a.toString().padStart(2,"0")}`}formatWithTime=(A,l)=>{const{withTime:o}=this.props;if(!A)return"";const t=o&&l?this.convertTo24Hour(l):"";return t?`${format(A,"yyyy-MM-dd")} ${t}`:format(A,"yyyy-MM-dd")};handleDateSelection=()=>{const{onSelected:A,useRange:l,defaultValue:o,withTime:t}=this.props,{startDate:a,endDate:n,startTime:B,endTime:R,setIsOpen:r}=this.context,H=(CI,sI)=>!t||!sI?CI:`${CI} ${this.convertTo24Hour(sI)}`,II=!DesmyCommons$1.isEmptyOrNull(o),k=DesmyCommons$1.isEmptyOrNull(this.saveDateValue?.startDate);if(II&&k){this.handleDefault();return}const iI=a?H(format(a,"yyyy-MM-dd"),B):"",lI=n?H(format(n,"yyyy-MM-dd"),R):"";iI===this.saveDateValue?.startDate&&lI===this.saveDateValue?.endDate||(this.saveDateValue={startDate:iI,endDate:lI},typeof A=="function"&&(A({startDate:iI,endDate:lI}),!l&&!t&&r(!1)))};handleClose=()=>{this.context.setIsOpen(!1),this.props.onSelected?.({})};handleVisibilityChange=()=>{document.visibilityState==="hidden"?this.setState({wasOpenBeforeBlur:this.context.isOpen}):document.visibilityState==="visible"&&this.state.wasOpenBeforeBlur&&setTimeout(()=>this.context.setIsOpen(!0),100)};render(){const{minDate:A,maxDate:l,label:o,disabled:t,useRange:a=!0,withTime:n}=this.props,{isOpen:B,startDate:R,endDate:r}=this.context,{isMobile:H,isModal:II}=this.state,k=()=>{const iI=this.props.displayFormat||"MM/dd/yyyy",{startTime:lI,endTime:CI}=this.context,sI=(_,gI)=>{if(!_)return"";const M=format(_,iI),O=typeof gI=="string"?gI:"";return n&&O?`${M} ${O}`:M},oI=sI(R,lI),E=sI(r,CI);return a?oI&&E?`${oI} - ${E}`:"":oI};return jsxRuntimeExports.jsxs("div",{className:"relative w-full",ref:this.parentContainerRef,children:[jsxRuntimeExports.jsx("div",{ref:this.inputRef,children:jsxRuntimeExports.jsx(DesmyTextInput,{onFocus:this.handleInputFocus,label:o,disabled:t,readOnly:!0,defaultValue:k(),onChange:()=>{}})}),B&&jsxRuntimeExports.jsxs("div",{ref:this.popoverDropdownRef,className:`${H?`fixed top-0 left-0 right-0 bottom-0 flex flex-col ${II?"bg-black/40":"bg-white dark:bg-darkDialogBackground"} z-[9999999] p-4 overflow-auto`:"absolute"} ${B?"flex opacity-100":"hidden opacity-0"} ${II?"bg-black/40":"bg-white dark:bg-darkDialogBackground dark:border-darkPrimaryBorder dark:text-white border-[2px]"} shadow-lg border-gray-100 rounded p-4 z-50 transition-opacity duration-[2000ms] ${a?"flex gap-4":""}`,children:[!H&&jsxRuntimeExports.jsx("div",{ref:this.arrowRef,id:"arrow",className:"absolute w-4 h-4 bg-white rotate-45 dark:bg-darkDialogBackground"}),H&&jsxRuntimeExports.jsx("div",{className:"absolute z-[9999] right-3 top-2",children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 12",className:`size-8 ${II?"text-white":"text-red-600"} cursor-pointer`,onClick:this.handleClose,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M3.85 3.15a.5.5 0 0 0-.707.707l2.15 2.15l-2.15 2.15a.5.5 0 0 0 .707.707L6 6.714l2.15 2.15a.5.5 0 0 0 .707-.707l-2.15-2.15l2.15-2.15a.5.5 0 0 0-.707-.707L6 5.3z"})})}),II?jsxRuntimeExports.jsx("div",{className:"flex max-w-lg h-full w-full justify-center items-center  mx-auto",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-darkDialogBackground mx-auto rounded-2xl",children:[jsxRuntimeExports.jsx(Days$1,{calendarIndex:0,useRange:a,withTime:n,minDate:A,maxDate:l}),a&&jsxRuntimeExports.jsx(Days$1,{calendarIndex:1,useRange:a,withTime:n,minDate:A,maxDate:l}),n&&jsxRuntimeExports.jsx(TimePicker,{useRange:a,onConfirm:()=>this.context.setIsOpen(!1)})]})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Days$1,{calendarIndex:0,useRange:a,withTime:n,minDate:A,maxDate:l}),a&&jsxRuntimeExports.jsx(Days$1,{calendarIndex:1,useRange:a,withTime:n,minDate:A,maxDate:l}),n&&jsxRuntimeExports.jsx(TimePicker,{useRange:a,onConfirm:()=>this.context.setIsOpen(!1)})]})]})]})}}const DesmyDatePicker=({...e})=>jsxRuntimeExports.jsx(DateProvider,{children:jsxRuntimeExports.jsx(DatePickerProvider,{...e})});class DesmyToast{static context;static initialize(A){DesmyToast.context=A}static success(A){!DesmyToast.context||!DesmyToast.context.addToast||DesmyToast.context.addToast(A,"success")}static error(A){!DesmyToast.context||!DesmyToast.context.addToast||DesmyToast.context.addToast(A,"error")}static info(A){!DesmyToast.context||!DesmyToast.context.addToast||DesmyToast.context.addToast(A,"info")}}class DesmyFilter extends React2.Component{constructor(A){super(A),this.state={isLoading:!0,hasRequest:!1,input:{},filters:{}}}componentDidMount(){if(this.props.content){const A={...this.state.input};this.props.content.forEach(l=>{l.label&&l.value!==null&&(A[l.label]=l)}),console.log("content=",this.props.content," updatedInput=",A),this.setState({input:A})}this.fetchFilters()}fetchFilters=async()=>{try{this.setState({hasRequest:!0});const A=await fetch(this.props.filter?.url,{method:"GET",headers:{"X-CSRFToken":`${DesmyAuth$1.getCookie("csrftoken")}`,Authorization:`Token ${DesmyAuth$1.get(DesmyState.ACCESS_TOKEN)}`}});if(A.ok){const l=await A.json();l&&l.success?this.setState({filters:l.data,isLoading:!1}):this.handleError(l?.message||"Failed to fetch filters")}}catch{}finally{this.setState({hasRequest:!1})}};handleError=A=>{DesmyToast.error(A),this.setState({isLoading:!1,hasRequest:!1}),this.props.onClose?.()};handleOnSubmit=async()=>{const{input:A}=this.state;this.props.onSuccess?.(A)};render(){const{filters:A,input:l,isLoading:o}=this.state,t=Object.entries(A);let a,n;const B=t.find(([R])=>R.toLowerCase().includes("date"));if(B){const[,R]=B;R?.[0]?.startDate&&R?.[0]?.endDate&&(a=new Date(R[0].startDate),n=new Date(R[0].endDate))}return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(DesmyModalContainer,{data:{title:"Filter"},containerClassName:"bg-white dark:bg-darkBackground border-[1px] border-gray-100 dark:border-darkDialogBackground",className:"add-event-multi-modal max-w-lg p-2",onClose:this.props.onClose,children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full min-h-52 space-y-6",children:[o?jsxRuntimeExports.jsxs("div",{className:"flex flex-col px-4 py-5 dark:bg-darkDialogBackground w-full animate-pulse",children:[jsxRuntimeExports.jsx("div",{className:"flex w-24 rounded-full h-4 bg-gray-300 dark:bg-darkPrimaryBorderLight"}),jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full mt-10 space-y-6",children:Array.apply(0,Array(3)).map((R,r)=>jsxRuntimeExports.jsx("div",{className:`flex ${r==0?"w-4/5":r==1?"w-3/5":"w-2/5"} rounded-full h-4 bg-gray-300 dark:bg-darkPrimaryBorderLight`},r))})]}):t.map(([R,r],H)=>r&&r.length>0?R.toLowerCase().includes("date")?jsxRuntimeExports.jsx(DesmyDatePicker,{defaultValue:l[R]?.value,label:DesmyCommons$1.toSentenceCase(String(R.replace("_"," ").toUpperCase())),minDate:a,maxDate:n,displayFormat:"MMMM dd, yyyy",useRange:!0,withTime:!0,onSelected:k=>{const{startDate:iI,endDate:lI}=k;if(iI&&lI){const CI={id:iI,name:`${isValid(parseISO(iI))?format(parseISO(iI),"MMMM dd, yyyy hh:mm a"):""} - ${isValid(parseISO(lI))?format(parseISO(lI),"MMMM dd, yyyy hh:mm a"):""}`,value:{startDate:iI,endDate:lI},label:"Date"};this.setState(sI=>({input:{...sI.input,[R]:CI}}))}}},H):jsxRuntimeExports.jsx(DesmyDropdown,{defaultValue:l[R]?.id,placeholder:DesmyCommons$1.toSentenceCase(String(R.replace("_"," ").toUpperCase())),data:r.map(k=>({id:k.id,name:k.name,value:k.id||k,label:k.name||k})),handleChange:k=>!DesmyCommons$1.isEmptyOrNull(k)&&this.setState(iI=>({input:{...iI.input,[R]:(Array.isArray(k),k)}}))},H):null),jsxRuntimeExports.jsx("div",{className:"flex justify-end mt-5",children:jsxRuntimeExports.jsx(DesmyButton,{onClick:this.handleOnSubmit,hasRequest:this.state.hasRequest,label:"Save"})})]})})})}}class DatatableCard extends React2.Component{header;status;constructor(A){super(A),this.state={stateList:[DesmyState.APPROVED,DesmyState.ACTIVE,DesmyState.SUBMITTED,DesmyState.CONFIRMED,DesmyState.PUBLISHED,DesmyState.CREATED,DesmyState.ACCREDITED,DesmyState.RUNNING,DesmyState.ADMITTED,DesmyState.QUALIFIED,DesmyState.IN_PROGRESS,DesmyState.ACCEPTED],imageExtensions:["jpg","jpeg","png","svg"],imgColumnTypes:["picture","photo"],title:"",contentlist:[],header:"",request:{delete:!1},error:{state:!1,message:"",type:DesmyState.ERROR,color:""},isLoading:!1,viewAll:!1},this.header="",this.status=""}handleDelete=()=>{const A={title:"Confirmation!",btnPosition:"delete",btnNegative:"cancel",type:DesmyState.NOTICE},l=a=>{this.state.request.delete||(a.status&&(this.handleDeleteRequest(),this.props.error({})),this.setState(n=>({request:{...n.request,delete:a.status},modal:void 0})))},o=typeof this.props.user[this.props.settings.deleteinfo?.name??""]=="object"?this.props.user[this.props.settings.deleteinfo?.name??""]?.name:this.props.user[this.props.settings.deleteinfo?.name??""],t=jsxRuntimeExports.jsx(DesmyModalHandler,{settings:A,onClose:l,children:jsxRuntimeExports.jsxs("div",{className:"w-full py-2 text-sm",children:["Are you sure you want to delete",jsxRuntimeExports.jsxs("span",{className:"text-red-500 ml-1 font-poppinsBold",children:[o,"?"]})]})});this.setState({modal:t})};handleError=(A="")=>{try{this.setState({request:{...this.state.request,delete:!1},error:{state:!0,message:DesmyCommons$1.isEmptyOrNull(A)?"Error Message":A,type:"Error",color:"red"}}),this.props.error(this.state.error),DesmyToast.error(A)}catch{}};handleDeleteRequest=()=>{try{const{settings:A,user:l,index:o,handleOnSuccess:t}=this.props,{deleteinfo:a}=A,n=l[a?.id??""];axios.delete(`${A.request_url}/${n}/delete/`,{headers:{"X-CSRFToken":DesmyAuth$1.getCookie("csrftoken"),Authorization:`Token ${DesmyAuth$1.get(DesmyState.ACCESS_TOKEN)}`}}).then(B=>{B.data.success?this.props.handleOnSuccess(o):this.handleError(B.data.message)}).catch(()=>{this.handleError()})}catch{this.handleError()}};handleEdit=()=>{this.state.request.delete||this.props.handleEdit(this.props.user)};onImageClick=A=>{};async componentDidMount(){let A=this.props.user,l=this.props.acces_key,o=this.props.headers,t=A[o[l]];this.header=DesmyCommons$1.toString(o[l]).toLowerCase(),this.status=A.status??A.process_state,this.setState({title:Array.isArray(t)?"":t?.name??DesmyCommons$1.toString(t),contentlist:Array.isArray(t)?t:[]})}toggleView=()=>{this.setState(A=>({viewAll:!A.viewAll}))};extra_handle=()=>this.props.settings.extra_handle?this.props.settings.extra_handle.find(A=>A.name===this.header):!1;render(){const A=jsxRuntimeExports.jsx("span",{className:"text-blue-800 dark:text-blue-300 cursor-pointer flex-col",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),l=jsxRuntimeExports.jsx("span",{className:"text-red-800 dark:text-red-300 cursor-pointer",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),o=jsxRuntimeExports.jsx("span",{className:"text-black dark:text-white cursor-pointer ",children:jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t=DesmyCommons$1.isEmptyOrNull(this.state.title)&&this.props.settings.image!==void 0?this.props.settings.image.placeholder:this.state.title,{viewAll:a,contentlist:n}=this.state,B=a?n:n.slice(0,1),R=a?"collapsible-content expanded":"collapsible-content";return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[this.state.modal,this.props.exceptional_columns.includes(this.header)||this.extra_handle()?jsxRuntimeExports.jsx("div",{className:"flex w-full justify-center items-center",children:this.header==="edit"?jsxRuntimeExports.jsx("span",{onClick:()=>this.handleEdit(),children:A}):this.header==="view"?jsxRuntimeExports.jsx("span",{onClick:()=>this.props.settings.handleOnViewClick?.(this.props.user),children:o}):this.extra_handle()?jsxRuntimeExports.jsx("span",{onClick:()=>this.props.settings.handleOnClickExtra?.(this.props.user,this.props.settings.extra_handle?.find(r=>r.name===this.header)?.name||""),children:this.props.settings.extra_handle?.find(r=>r.name===this.header)?.icon}):this.header==="delete"&&this.state.request.delete?jsxRuntimeExports.jsxs("svg",{role:"status",className:"flex w-4 h-4 text-black dark:text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}):jsxRuntimeExports.jsx("span",{onClick:()=>this.handleDelete(),children:l})}):["status","process_state"].includes(this.header.toLowerCase())?jsxRuntimeExports.jsx("div",{className:`w-16 text-[8px] px-1 line-clamp-1 rounded-full border ${this.state.stateList.includes(this.state.title)?"bg-green-200 text-green-700 border-green-500 hover:bg-green-500 hover:text-white":"bg-red-200 text-red-700 border-red-500 hover:bg-red-500 hover:text-white"} py-1 justify-center text-center items-center`,children:String(this.state.title).toLowerCase()}):this.state.imgColumnTypes.includes(this.header?.toLowerCase()||"")||this.state.imageExtensions.includes(this.state.title?.toLowerCase().split(".").pop()||"")?jsxRuntimeExports.jsx("div",{className:"w-8 ml-3",children:jsxRuntimeExports.jsx("img",{onClick:()=>this.onImageClick(this.state.title),title:"View photo",className:`object-center object-cover w-6 h-6 2xl:w-8 2xl:h-8 ${this.props.settings.image==null||this.props.settings.image.rounded==!1?"":"rounded-full"} cursor-pointer mx-auto`,alt:"photo",src:t})}):jsxRuntimeExports.jsx("span",{className:"text-xs 2xl:text-sm px-4 py-2 flex items-center",children:this.state.contentlist.length>0?jsxRuntimeExports.jsx("ul",{className:`flex flex-col w-full ${R}`,children:B.map((r,H)=>jsxRuntimeExports.jsx("li",{onClick:this.toggleView,className:`w-full ${B.length>1?"line-clamp-1":""}`,title:`${r.name}`,children:jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("div",{className:"mr-3",children:r.name}),H==0&&n.length>1&&jsxRuntimeExports.jsx("div",{onClick:this.toggleView,children:jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 cursor-pointer",children:jsxRuntimeExports.jsx("path",{d:"M12 18.17L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15M12 5.83L15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9 12 5.83z"})})})]})},H))}):this.state.title})]})}}class DesmyDataTable extends React2.Component{renderedSettings=[];dataCollection=[];chunkSize;currentIndex;hasClear;isLoading;hasLoadLastData;current_page;search;filterloaded;queryParam;constructor(A){super(A),this.state={exceptionalColumns:["view","edit","delete"],selected:-1,isLoading:!0,dtablemodal:null,hasRequest:!1,showFilter:!1,filterhead:[],filters:{data:[]},input:{search:"",is_searching:!1},entities:{data:[],meta:{current_page:1,next_page:null,from:1,last_page:1,per_page:500,to:1,total:0}},custom_settings:{sorted_column:"",order:"asc",first_page:1,current_page:1,offset:4},settings:{default_sorted_column:"",header:{title:"",class:"",hint:""},headers:[],columns:[],table_data:[]},error:{state:!1,message:"",type:DesmyState.ERROR,color:"",retry:!0},alerterror:{state:!1,message:"",type:DesmyState.ERROR,color:""}},this.renderedSettings=[],this.dataCollection=[],this.chunkSize=50,this.currentIndex=0,this.hasClear=!1,this.isLoading=!1,this.hasLoadLastData=!1,this.current_page=0,this.search="",this.filterloaded=!1,this.queryParam="",this.handleScroll=this.handleScroll.bind(this)}async componentDidMount(){try{this.props.onRef&&this.props.onRef(this);const A=this.state.custom_settings;A.sorted_column=this.props.settings.default_sorted_column,this.setState({custom_settings:A,settings:this.props.settings},this.fetchEntities)}catch{}}handleScroll(A){const l=A.target;l.scrollTop+l.clientHeight>=l.scrollHeight-10&&this.loadNextBatch()}errors=A=>{this.setState({alerterror:A})};handleReset=()=>{this.setState({alerterror:{state:!1,message:"",type:DesmyState.ERROR,color:""}})};handleError=(A="",l=!0)=>{try{const o=this.state.error,t=this.state.input;t.is_searching=!1,o.state=!0,o.message=DesmyCommons$1.isEmptyOrNull(A)?DesmyState.ERROR_MESSAGE:A,o.type=DesmyState.ERROR,o.color="red",o.retry=l,this.setState({isLoading:!1,error:o,input:t})}catch{}};async fetchEntities(){try{const{current_page:A,sorted_column:l,order:o}=this.state.custom_settings,{per_page:t}=this.state.entities.meta,a=`${this.props.settings.url}/?page=${A}&column=${l}&order=${o}&per_page=${t}&search=${this.search}${this.queryParam?"&"+this.queryParam:""}`;this.setState({isLoading:!0}),axios.get(a,{headers:{"X-CSRFToken":`${DesmyAuth$1.getCookie("csrftoken")}`,Authorization:`Token ${DesmyAuth$1.get(DesmyState.ACCESS_TOKEN)}`}}).then(n=>{const B=n.data;B.success?(this.dataCollection=B.data.data,this.hasClear=!1,this.setState({isLoading:!1,entities:B.data}),this.initialChunck()):(this.hasLoadLastData=!0,this.handleError(B.message,!1))}).catch(n=>{this.handleError(n)})}catch{this.handleError()}}columnHead(A){const l=A.split("_");return l.length>1&&this.state.exceptionalColumns.includes(DesmyCommons$1.toString(l.slice(-1)).toString().toLowerCase())?l.slice(0,-1).join(" ").toUpperCase():l.join(" ").toUpperCase()}sortByColumn(A){try{const l=this.state.custom_settings,{extra_handle:o}=this.props.settings,t=o&&o?.some(n=>n.name===A),a=this.state.exceptionalColumns.includes(A.toLowerCase());if(!t&&!a){const n=A===this.state.custom_settings.sorted_column&&this.state.custom_settings.order==="asc"?"desc":"asc";this.handleClear(),l.current_page=1,l.sorted_column=A,l.order=n,this.setState({isLoading:!0,error:{},custom_settings:l},this.fetchEntities)}}catch{}}tableHeads=()=>{let A;return this.state.custom_settings.order==="asc"?A=jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 2xl:w-4 2xl:h-4 dark:text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})}):A=jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 2xl:w-4 2xl:h-4 dark:text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})}),this.props.settings.headers.map((l,o)=>{const t=this.state.exceptionalColumns.includes(l.toLowerCase()),a=this.state.settings.table_data?.find(n=>n.name===l.toLowerCase());return jsxRuntimeExports.jsx("th",{onClick:()=>this.sortByColumn(l),className:`py-2 sticky ${t?"w-4":a?a.class:""}  top-0 border-b border-gray-200 text-xs 2xl:text-sm bg-gray-100 dark:border-gray-700 dark:bg-darkPrimary`,children:jsxRuntimeExports.jsxs("div",{className:"flex dark:text-white sticky top-0 px-6 py-2 2xl:py-3 text-gray-600 font-poppinsSemiBold tracking-wider uppercase text-xs",children:[jsxRuntimeExports.jsx("span",{children:this.columnHead(l)}),jsxRuntimeExports.jsx("span",{children:this.state.custom_settings.sorted_column===l&&A})]})},o)})};handleClear=()=>{try{const{input:A,entities:l,error:o}=this.state;o.state=!1,A.is_searching=!1,l.meta.total=0,this.setState({input:A}),this.dataCollection=[],this.renderedSettings=[],this.currentIndex=0,this.current_page=0,this.forceUpdate(),this.setState({entities:l,error:o})}catch{}};initialChunck(){this.loadNextBatch()}addHeaderAndColumn=(A,l)=>{this.setState(o=>{const t=[...o.settings.headers,A],a=[...o.settings.columns,l];return{settings:{...o.settings,headers:t,columns:a}}})};removeHeaderAndColumn=A=>{this.setState(l=>{const o=l.settings.headers.indexOf(A);if(o===-1)return null;const t=l.settings.headers.filter((n,B)=>B!==o),a=l.settings.columns.filter((n,B)=>B!==o);return{...l,settings:{...l.settings,headers:t,columns:a}}})};clearFetchEntities=()=>{const{custom_settings:A}=this.state;A.current_page=1,this.handleClear(),this.setState({custom_settings:A},this.fetchEntities)};handleSearch=A=>{const{input:l}=this.state;(A.key==="Enter"||A.keyCode===13)&&!DesmyCommons$1.isEmptyOrNull(l.search)&&l.search.length>2&&(l.is_searching=!0,this.search=l.search,this.setState({input:l},this.clearFetchEntities))};searchFilter=async A=>{const{input:l}=this.state;Object.entries(A.search).length>0&&(l.is_searching=!0,this.setState({filters:A,input:l},this.clearFetchEntities))};handleInput=A=>{const{value:l}=A.target;this.setState(o=>({input:{...o.input,search:l}}))};handleFocus=()=>{this.setState({isFocused:!0})};handleBlur=()=>{this.setState({isFocused:!1})};onChangeValue=A=>{try{this.search=A.target.value,this.setState({searchText:A.target.value},()=>{DesmyCommons$1.isEmptyOrNull(this.search)&&!this.state.input.is_searching&&this.clearFetchEntities()})}catch{}};handleKeyDown=A=>{try{A.key==="Enter"&&!DesmyCommons$1.isEmptyOrNull(this.search)&&this.clearFetchEntities()}catch{}};loadNextBatch=()=>{try{DesmyCommons$1.isEmptyOrNull(this.dataCollection)||(this.renderChunk(),this.forceUpdate(),this.currentIndex+=this.chunkSize),this.isLoading=!1}catch{}};renderChunk(){try{const A=this.props.settings.headers,l=this.currentIndex+this.chunkSize>this.dataCollection.length?this.dataCollection.length:this.currentIndex+this.chunkSize;for(let o=this.currentIndex;o<l;o++){const t=this.dataCollection[o],a=this.state.selected===o?" bg-gray-300 dark:bg-darkPrimary":o%2===0?" dark:bg-[#1c1c1c] bg-[#f3f4f6] ":" bg-inherit";if(t!==void 0){const n=jsxRuntimeExports.jsx("tr",{className:`${a} cursor-pointer text-gray-700  dark:text-white dark:hover:text-black hover:bg-gray-300 dark:hover:bg-white  transition duration-500 ease-in-out`,children:Object.keys(A).map((B,R)=>jsxRuntimeExports.jsx("td",{className:"px-3 justify-content-center flex-wrap",children:jsxRuntimeExports.jsx(DatatableCard,{index:o,handleOnSuccess:this.handleOnSuccess,acces_key:parseInt(B,10),error:this.errors,handleEdit:()=>this.props.settings.handleEdit?.(t,B),settings:this.props.settings,exceptional_columns:this.state.exceptionalColumns,user:t,headers:A},`dtaw${B}${this.search}`)},`trex${R}`))},o);this.renderedSettings.push(n)}}}catch{}}removeFilterByName=A=>{try{const l=this.state.filterhead.filter(t=>t.label!==A),o=l.filter(t=>typeof t=="object"&&"id"in t).map(t=>{const{id:a,value:n,label:B}=t;return`${encodeURIComponent(B)}=${encodeURIComponent(a||n||"")}`}).join("&");this.handleClear(),this.queryParam=o,this.setState({filterhead:l},()=>{this.fetchEntities()})}catch{}};handleRetry=()=>{try{this.clearFetchEntities()}catch{}};handleHint=()=>{const{settings:A,error:l,entities:o}=this.state,t=A.header.hint,a=o.meta.total;return l.state?"":t?`${t} | Loaded ${a}`:`Loaded ${a} data`};handleOnSuccess=A=>{this.renderedSettings.splice(A,1),this.dataCollection.splice(A,1);const l=this.state.entities;l.meta.total=this.renderedSettings.length,this.renderedSettings.length==0&&this.handleClear(),this.forceUpdate()};handleEdit=(A,l)=>{this.props.settings.handleEdit?.(A,l)};handleBreadCrumbNavigations(A,l){A.preventDefault(),this.props.settings.onURLClick?.(l)}renderBreadcrumb(){const{breadcrumb:A}=this.props.settings;return!A||A.length===0?null:jsxRuntimeExports.jsx("nav",{className:"flex text-sm mb-4","aria-label":"Breadcrumb",children:jsxRuntimeExports.jsx("ol",{className:"inline-flex items-center space-x-1 md:space-x-3",children:A.map((l,o)=>jsxRuntimeExports.jsxs("li",{className:"inline-flex items-center",children:[o!==A.length-1?jsxRuntimeExports.jsx("a",{href:l.url,onClick:t=>this.handleBreadCrumbNavigations(t,l.url),className:"text-gray-700 w-full line-clamp-1 dark:text-white/75 dark:hover:text-blue-500 hover:text-blue-600",children:l.name}):jsxRuntimeExports.jsx("span",{className:"text-gray-500 dark:text-white/75","aria-current":"page",children:l.name}),o!==A.length-1&&jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mx-2 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]},o))})})}handlePageChange=A=>{const{custom_settings:l}=this.state;this.clearFetchEntities(),l.current_page=A,this.setState({custom_settings:l,isLoading:!0},this.fetchEntities)};renderPagination=()=>{const{meta:A}=this.state.entities,l=A.last_page,o=A.current_page;if(l<=1)return null;const t=[],a=n=>{t.push(jsxRuntimeExports.jsx("button",{onClick:()=>this.handlePageChange(n),className:`px-3 py-1 mx-1 border rounded ${o===n?"bg-blue-600 text-white":"bg-gray-200 hover:bg-gray-300"}`,children:n},n))};a(1),o>3&&t.push(jsxRuntimeExports.jsx("span",{className:"px-3 py-1 mx-1",children:"..."},"left-ellipsis"));for(let n=Math.max(2,o-1);n<=Math.min(l-1,o+1);n++)a(n);return o<l-2&&t.push(jsxRuntimeExports.jsx("span",{className:"px-3 py-1 mx-1",children:"..."},"right-ellipsis")),l>1&&a(l),jsxRuntimeExports.jsxs("div",{className:"flex justify-center mt-4",children:[o>1&&jsxRuntimeExports.jsx("button",{onClick:()=>this.handlePageChange(o-1),className:"px-3 py-1 mx-1 border rounded bg-gray-200 hover:bg-gray-300",children:"Previous"}),t,o<l&&jsxRuntimeExports.jsx("button",{onClick:()=>this.handlePageChange(o+1),className:"px-3 py-1 mx-1 border rounded bg-gray-200 hover:bg-gray-300",children:"Next"})]})};handleOnClose=()=>{this.setState({showFilter:!1})};handleOnOpenFilter=()=>{this.setState({showFilter:!0})};handleOnFiltered=A=>{const l=Object.entries(A).map(([a,n])=>{if(n&&typeof n=="object"&&"id"in n){const B=n,R=B.id||B.value||n;return a.toLowerCase().includes("date")&&B.value?.startDate&&B.value?.endDate?{queryParam:`start_date=${encodeURIComponent(String(B.value?.startDate))}&end_date=${encodeURIComponent(String(B.value?.endDate))}`,filterItem:{...B,label:a}}:{queryParam:`${encodeURIComponent(a)}=${encodeURIComponent(String(R))}`,filterItem:{...B,label:a}}}return null}).filter(a=>a!==null),o=l.map(a=>a.queryParam).join("&"),t=l.map(a=>a.filterItem);this.handleClear(),this.queryParam=o,this.setState({showFilter:!1,filterhead:t},()=>{this.fetchEntities()})};render(){const{isFocused:A,searchText:l,showFilter:o,filterhead:t}=this.state,a=A&&l!=="";return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[this.state.dtablemodal,o&&jsxRuntimeExports.jsx(DesmyFilter,{content:t,filter:this.props.settings?.filter,onSuccess:this.handleOnFiltered,onClose:this.handleOnClose}),jsxRuntimeExports.jsxs("div",{className:`flex flex-col w-full ${this.props.className}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full mb-5",children:[jsxRuntimeExports.jsxs("header",{className:"flex w-full flex-col md:flex-row justify-start md:justify-between items-center space-x-6",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full  mx-10 md:mx-0 ",children:this.state.settings.header!==void 0?jsxRuntimeExports.jsxs("div",{className:"flex w-full flex-col",children:[jsxRuntimeExports.jsx("h3",{className:`${this.state.settings.header!==void 0?DesmyCommons$1.isEmptyOrNull(this.state.settings.header.class)?" text-grey-darkest uppercase text-3xl 2xl:text-5xl dark:text-white font-poppinsBlack":this.state.settings.header.class:""}`,children:this.state.settings.header.title}),jsxRuntimeExports.jsx("div",{className:"text-grey font-thin text-xs 2xl:text-sm dark:text-white",children:this.handleHint()})]}):null}),jsxRuntimeExports.jsx("div",{className:"flex w-max  flex-col lg:items-end justify-start lg:justify-end",children:jsxRuntimeExports.jsx("div",{className:"flex flex-col lg:items-end justify-start lg:justify-end ",children:jsxRuntimeExports.jsx("div",{className:"flex items-center w-full lg:max-w-md justify-start lg:justify-end mt-5 lg:mt-0",children:jsxRuntimeExports.jsxs("div",{className:"flex w-full text-grey font-thin text-sm dark:text-white",children:[jsxRuntimeExports.jsx("div",{className:"w-full",children:jsxRuntimeExports.jsxs("div",{className:"flex w-full relative",children:[jsxRuntimeExports.jsx("input",{className:`rounded-full lg:rounded-full py-3 px-4 dark:focus:border-white dark:focus:ring-0 text-gray-700 text-xs 2xl:text-sm leading-tight border focus:outline-none focus:border-primary focus:ring-0 bg-inherit dark:text-white transition-all duration-300 ease-in-out
                                        ${a?"w-[300px]":"w-[200px]"}`,onFocus:this.handleFocus,onBlur:this.handleBlur,name:"search",onChange:this.onChangeValue,onKeyDown:this.handleKeyDown,id:"search",type:"text",placeholder:"Search"}),this.state.input.is_searching&&!DesmyCommons$1.isEmptyOrNull(this.search)?jsxRuntimeExports.jsxs("svg",{role:"status",className:"inline absolute top-2.5 bottom-0 right-2 w-4 h-4 2xl:w-6 2xl:h-6 text-primary dark:text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}):null]})}),jsxRuntimeExports.jsx("div",{className:"flex w-10 h-10 2xl:w-12 2xl:h-12 ml-2 flex-shrink-0 justify-center items-center rounded-full dark:hover:text-black bg-gray-200 border border-gray-200 hover:bg-gray-100 dark:border-gray-800 dark:bg-darkDialogBackground  cursor-pointer",onClick:()=>this.handleRetry(),children:jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:"w-4 h-4 2xl:w-5 2xl:h-5",children:[jsxRuntimeExports.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:10,strokeWidth:32,d:"M320 146s24.36-12-64-12a160 160 0 10160 160"}),jsxRuntimeExports.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:32,d:"M256 58l80 80-80 80"})]})}),this.props.settings.filter!==void 0&&this.props.settings.filter!==null?jsxRuntimeExports.jsx("div",{className:"flex w-10 h-10 2xl:w-12 2xl:h-12 ml-2 flex-shrink-0 justify-center items-center rounded-full bg-gray-200 border border-gray-200 hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-700 dark:hover:bg-gray-600 cursor-pointer",onClick:()=>this.handleOnOpenFilter(),children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z"})})}):null]})})})})]}),this.props.content!=null?jsxRuntimeExports.jsx("div",{children:this.props.content}):null]}),jsxRuntimeExports.jsx("div",{}),jsxRuntimeExports.jsx("div",{className:`scrollable_table flex flex-col min-h-[200px] ${this.renderedSettings.length>10?"h-[80vh]":"h-auto"} overflow-auto  scrollbar-width`,onScroll:this.handleScroll,children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col ",children:[jsxRuntimeExports.jsx("div",{children:t.length>0?jsxRuntimeExports.jsx("div",{className:"flex w-full overflow-x-auto mb-2 space-x-4",children:t.map((n,B)=>DesmyCommons$1.isEmptyOrNull(n.name)?null:jsxRuntimeExports.jsxs("div",{className:"flex flex-shrink-0 text-xs relative pl-4 pr-6 py-2 rounded-lg border-[1px] cursor-pointer hover:bg-primary hover:text-white  border-gray-200 bg-gray-50",children:[jsxRuntimeExports.jsxs("div",{className:"flex mr-2",children:[DesmyCommons$1.capitalizeEachWord(DesmyCommons$1.convertUnderscoreToSpaceString(n.label)),":"]}),jsxRuntimeExports.jsx("div",{className:"flex font-poppinsSemiBold",children:n.name}),jsxRuntimeExports.jsx("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:"absolute right-1 top-2 bottom-1 cursor-pointer w-4 h-4 2xl:w-5 2xl:h-5",onClick:()=>this.removeFilterByName(n.label),children:jsxRuntimeExports.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:32,d:"M368 368L144 144M368 144L144 368"})})]},`flter=${B}`))}):null}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full pb-16",children:[this.renderBreadcrumb(),jsxRuntimeExports.jsxs("table",{children:[jsxRuntimeExports.jsx("thead",{className:"w-full",children:jsxRuntimeExports.jsx("tr",{className:"text-sm",children:this.tableHeads()})}),jsxRuntimeExports.jsx("tbody",{children:this.state.error.state?null:this.renderedSettings})]})]}),!this.state.isLoading&&this.dataCollection.length>0&&!this.state.error.state&&this.renderPagination(),!this.state.isLoading&&(!this.dataCollection.length||this.state.error.state)?jsxRuntimeExports.jsxs("div",{className:`flex flex-col w-full h-96 justify-center ${this.state.error.state?"text-red-500":"dark:text-white"} space-y-5 items-center text-base`,children:[this.state.error.state?jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-10 h-10",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}):DesmyCommons$1.isEmptyOrNull(this.search)?jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-10 h-10",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}):jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-10 h-10",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),jsxRuntimeExports.jsx("div",{className:"flex w-full text-sm justify-center text-center",children:this.state.error.state?this.state.error.message:DesmyCommons$1.isEmptyOrNull(this.search)?"No data available to show":jsxRuntimeExports.jsx("span",{className:" font-poppinsSemiBold",children:" Sorry we couldn't find anything!"})}),this.state.error?.retry&&DesmyCommons$1.isEmptyOrNull(this.search)?jsxRuntimeExports.jsx("div",{onClick:()=>this.handleRetry(),className:`uppercase flex font-poppinsSemiBold ${this.state.error.state?"bg-red-400 text-red-700":""} px-6 py-2 cursor-pointer rounded-full my-4`,children:this.state.error.state?"RETRY":"REFRESH"}):null]}):this.state.isLoading?jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full mt-10 justify-center dark:text-white items-center space-y-4",children:[jsxRuntimeExports.jsxs("svg",{role:"status",className:"flex w-4 h-4 2xl:w-6 2xl:h-6 text-black dark:text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}),jsxRuntimeExports.jsx("div",{className:"text-xs 2xl:text-sm",children:"Loading......."})]}):null]})})]})]})}}class DesmyAlert extends React2.Component{constructor(A){super(A),this.state={showForms:!1}}handleToggle=()=>{this.setState({showForms:!this.state.showForms})};handleRetry=()=>{this.props.onRetry&&this.props.onRetry()};render(){const{error:A,handleCloseAlert:l,onRetry:o}=this.props,t=A.type.toLowerCase()==="error";return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:`flex w-full flex-col text-sm flex-wrap ${t?"bg-red-200 text-red-600":"bg-green-200 text-green-600"} border-[1px] ${t?"border-red-400":"border-green-400"} px-4 py-3 rounded relative mb-4`,role:"alert",children:[jsxRuntimeExports.jsxs("div",{className:"font-poppinsBold mr-4",children:[A.type,"!"]}),jsxRuntimeExports.jsx("div",{className:"sm:inline flex w-full flex-wrap ",children:A.message}),jsxRuntimeExports.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-2 py-3",children:jsxRuntimeExports.jsx("svg",{onClick:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:`fill-current h-5 w-5 cursor-pointer ${t?"text-red-500":"text-green-500"}`,children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z",clipRule:"evenodd"})})}),o&&jsxRuntimeExports.jsx("div",{className:"flex w-full justify-end items-center",children:jsxRuntimeExports.jsx("div",{className:"bg-red-400 text-red-700 border-[1px] cursor-pointer hover:bg-red-500 hover:text-white transition-all border-red-500 px-2 py-2 rounded font-poppinsBold",onClick:this.handleRetry,children:"Retry"})})]})})}}class DesmyDataSetTable extends React2.Component{renderedSettings=[];dataCollection=[];chunkSize=6;currentIndex=0;hasClear=!1;hasFinished=!1;isLoading=!1;current_page=0;search="";constructor(A){super(A),this.state={exceptionalColumns:["view","edit","delete"],selected:-1,isLoading:!0,dtablemodal:null,hasRequest:!1,filterhead:[],filters:{search:{},data:[]},input:{search:"",is_searching:!1},entities:{data:[],meta:{current_page:1,next_page:null,from:1,last_page:1,per_page:500,to:1,total:0}},custom_settings:{sorted_column:"",order:"asc",first_page:1,current_page:1,offset:4},settings:{default_sorted_column:"",header:{title:"",class:"",hint:"",search:!0},headers:[],columns:[],table_data:[]},error:{state:!1,message:"",type:DesmyState.ERROR,color:""},alerterror:{state:!1,message:"",type:DesmyState.ERROR,color:""}},this.handleScroll=this.handleScroll.bind(this)}async componentDidMount(){this.props.onRef&&this.props.onRef(this);const{default_sorted_column:A}=this.props.settings,l={...this.state.custom_settings,sorted_column:A};this.chunkSize=this.props.settings.pagination?.per_page??0,this.setState({custom_settings:l,settings:this.props.settings},()=>{this.handleFetchEntities()})}componentDidUpdate(A,l,o){this.hasFinished&&setTimeout(this.handleUpdateDatalist,1e3)}handleUpdateDatalist=()=>{this.props.settings.server_request?.enable||(this.props.data.data?.length>this.dataCollection?.length&&(this.hasClear=!0),this.fetchEntities())};handleScroll(A){const l=A.currentTarget;l.scrollTop+l.clientHeight>=l.scrollHeight-10&&this.loadNextPage()}errors=A=>{this.setState({alerterror:A})};handleReset=()=>{this.setState({alerterror:{state:!1,message:"",type:DesmyState.ERROR,color:""}})};handleError=(A="")=>{try{const l={...this.state.error,state:!0,message:DesmyCommons$1.isEmptyOrNull(A)?DesmyState.ERROR_MESSAGE:A,type:DesmyState.ERROR,color:"red"};this.setState({isLoading:!1,error:l},()=>{this.props.handleOnLoaded(this.renderedSettings,DesmyState.ERROR)})}catch{}};async fetchEntities(){try{const l={...this.state.entities};if(!this.props.settings.server_request?.enable){var A=this.props.data;l.data.length=0,this.hasClear&&this.handleClear(),this.dataCollection=this.dataCollection.concat(A.data),this.hasClear=!1,this.hasFinished=!0,l.meta=A.meta,this.setState({isLoading:!1,entities:l},this.initialChunck);return}const o=`${this.props.settings.url}/?page=${this.state.custom_settings.current_page}&column=${this.state.custom_settings.sorted_column}&order=${this.state.custom_settings.order}&per_page=${this.state.entities.meta.per_page}&search=${this.search}`,a=(await axios.get(o,{headers:{"X-CSRFToken":`${DesmyAuth$1.getCookie("csrftoken")}`,Authorization:`Token ${DesmyAuth$1.get(DesmyState.ACCESS_TOKEN)}`}})).data;a.success?(l.data=[],this.hasClear&&this.handleClear(),this.dataCollection=this.dataCollection.concat(a.data.data),this.hasClear=!1,l.meta=a.data.meta,this.setState({isLoading:!1,entities:l},this.initialChunck)):this.handleError()}catch(l){console.log(l),this.handleError()}}handleFetchEntities=()=>{this.props.handleOnLoaded(this.renderedSettings,DesmyState.LOADING),this.fetchEntities()};handleFiltered=()=>{};handleRetry=()=>{try{this.handleClear();const A={...this.state.custom_settings,current_page:1};this.setState({isLoading:!0,error:{state:!1,message:"",type:DesmyState.ERROR,color:""},custom_settings:A},this.handleFetchEntities)}catch{}};handleClear=()=>{const A={...this.state.input,is_searching:!1},l={...this.state.entities,meta:{...this.state.entities.meta,total:0}};this.setState({input:A}),this.dataCollection=[],this.renderedSettings=[],this.currentIndex=0,this.current_page=0,this.forceUpdate(),this.setState({entities:l})};initialChunck(){this.loadNextBatch()}loadNextPage=()=>{try{if(!this.isLoading){const A={...this.state.custom_settings},l=this.state.entities.meta.next_page;l!==null&&!DesmyCommons$1.isEmptyOrNull(l)&&this.current_page!==l&&(A.current_page=l,this.current_page=l,this.setState({isLoading:!0,custom_settings:A},()=>{this.props.handleOnLoaded(this.renderedSettings,DesmyState.LOADING),this.handleFetchEntities()}))}}catch{}};handleOnSuccess=A=>{this.renderedSettings.splice(A,1),this.dataCollection.splice(A,1);let l=this.state.entities;l.meta.total=this.renderedSettings.length,this.renderedSettings.length==0&&this.handleClear(),this.forceUpdate()};loadNextBatch=()=>{try{this.renderChunk(),this.forceUpdate(),this.currentIndex+=this.chunkSize,this.isLoading=!1}catch{}};renderChunk(){try{const A=this.currentIndex+this.chunkSize>this.dataCollection.length?this.dataCollection.length:this.currentIndex+this.chunkSize;for(let l=this.currentIndex;l<A;l++){const o=this.dataCollection[l];this.renderedSettings.some(t=>t[this.props.settings.deleteinfo.id]===o[this.props.settings.deleteinfo.id])||this.renderedSettings.push(o)}this.props.handleOnLoaded(this.renderedSettings,DesmyState.LOADED)}catch{}}handleFocus=()=>{this.setState({isFocused:!0})};handleBlur=()=>{this.setState({isFocused:!1})};onChangeValue=A=>{try{A.preventDefault(),this.search=A.target.value,this.setState({searchText:A.target.value},()=>{DesmyCommons$1.isEmptyOrNull(this.search)&&!this.state.input.is_searching&&this.handleSearching()})}catch{}};handleSearching(){let A=this.state.custom_settings,l=this.state.input;A.current_page=1,l.is_searching=!0,this.hasClear=!0,this.setState({custom_settings:A,input:l},()=>{this.fetchEntities()})}handleKeyDown=A=>{try{A.key==="Enter"&&!DesmyCommons$1.isEmptyOrNull(this.search)&&this.handleSearching()}catch(l){console.error("Error in handleKeyDown:",l)}};columnHead(A){let l=A.split("_");return l.length>1&&this.state.exceptionalColumns.includes(DesmyCommons$1.toString(l.slice(-1)).toString().toLowerCase())?l.slice(0,-1).join(" ").toUpperCase():l.join(" ").toUpperCase()}sortByColumn(A){try{var l=this.state.custom_settings,o=A===this.state.custom_settings.sorted_column&&this.state.custom_settings.order==="asc"?"desc":"asc";this.handleClear(),l.current_page=1,l.sorted_column=A,l.order=o,this.setState({isLoading:!0,error:{},custom_settings:l},this.fetchEntities)}catch(t){console.error(t)}}tableHeads=()=>{let A;return this.state.custom_settings.order==="asc"?A=jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 2xl:w-4 2xl:h-4 dark:text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})}):A=jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 2xl:w-4 2xl:h-4 dark:text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})}),this.props.settings.headers?this.props.settings.headers?.map((l,o)=>{const t=this.state.exceptionalColumns.includes(l.toLowerCase()),a=this.state.settings.table_data?.find(n=>n.name===l.toLowerCase());return jsxRuntimeExports.jsx("th",{onClick:()=>this.sortByColumn(this.props.settings?.columns?.[o]??""),className:`py-2 sticky ${t?"w-4":a?a.class:""}  top-0 border-b border-gray-200 text-xs 2xl:text-sm bg-gray-100 dark:border-gray-700 dark:bg-darkPrimary`,children:jsxRuntimeExports.jsxs("div",{className:"flex dark:text-white sticky top-0 px-6 py-2 2xl:py-3 text-gray-600 font-poppinsSemiBold tracking-wider uppercase text-xs",children:[jsxRuntimeExports.jsx("span",{children:this.columnHead(l)}),jsxRuntimeExports.jsx("span",{children:this.state.custom_settings.sorted_column===this.props.settings?.columns?.[o]&&A})]})},o)}):[]};handleHint=()=>{try{return this.state.settings?.header?.hint?this.state.settings.header.hint:this.state.error.state?"":`Loaded ${this.state.entities.meta.total} data`}catch{return this.state.error.state?"":"Loaded 0 data"}};render(){const{isFocused:A,searchText:l}=this.state,o=A&&l!=="";return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full mb-5",children:[this.state.settings.header!==void 0?jsxRuntimeExports.jsxs("header",{className:"flex w-full flex-col lg:flex-row justify-start lg:justify-between items-center space-x-6",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full ",children:this.state.settings.header!==void 0?jsxRuntimeExports.jsxs("div",{className:"flex w-full flex-col",children:[jsxRuntimeExports.jsx("h3",{className:`${this.state.settings.header!==void 0?DesmyCommons$1.isEmptyOrNull(this.state.settings.header.class)?" text-grey-darkest uppercase text-3xl 2xl:text-5xl dark:text-white font-poppinsBlack":this.state.settings.header.class:""}`,children:this.state.settings.header.title}),this.props.content!=null?jsxRuntimeExports.jsx("div",{children:this.props.content}):null,jsxRuntimeExports.jsx("div",{className:"text-grey font-thin text-xs 2xl:text-sm dark:text-white",children:this.handleHint()})]}):null}),jsxRuntimeExports.jsx("div",{className:"flex w-max  flex-col lg:items-end justify-start lg:justify-end",children:jsxRuntimeExports.jsx("div",{className:"flex flex-col lg:items-end justify-start lg:justify-end ",children:jsxRuntimeExports.jsx("div",{className:"flex items-center w-full lg:max-w-md justify-start lg:justify-end mt-5 lg:mt-0",children:jsxRuntimeExports.jsxs("div",{className:"flex w-full text-grey font-thin text-sm dark:text-white",children:[jsxRuntimeExports.jsx("div",{className:"w-full",children:jsxRuntimeExports.jsxs("div",{className:"flex w-full relative",children:[jsxRuntimeExports.jsx("input",{className:`rounded-full lg:rounded-full py-3 px-4 dark:focus:border-white dark:focus:ring-0 text-gray-700 text-xs 2xl:text-sm leading-tight border focus:outline-none focus:border-primary focus:ring-0 bg-inherit dark:text-white transition-all duration-300 ease-in-out
                                  ${o?"w-[300px]":"w-[200px]"}`,onFocus:this.handleFocus,onBlur:this.handleBlur,name:"search",onChange:this.onChangeValue,onKeyDown:this.handleKeyDown,id:"search",type:"text",placeholder:"Search"}),this.state.input.is_searching&&!DesmyCommons$1.isEmptyOrNull(this.search)?jsxRuntimeExports.jsxs("svg",{role:"status",className:"inline absolute top-2.5 bottom-0 right-2 w-4 h-4 2xl:w-6 2xl:h-6 text-primary dark:text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}):null]})}),jsxRuntimeExports.jsx("div",{className:"flex w-10 h-10 2xl:w-12 2xl:h-12 ml-2 flex-shrink-0 justify-center items-center rounded-full dark:hover:text-black bg-gray-200 border border-gray-200 hover:bg-gray-100 dark:border-gray-800   cursor-pointer",onClick:()=>this.handleRetry(),children:jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:"w-4 h-4 2xl:w-5 2xl:h-5",children:[jsxRuntimeExports.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:10,strokeWidth:32,d:"M320 146s24.36-12-64-12a160 160 0 10160 160"}),jsxRuntimeExports.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:32,d:"M256 58l80 80-80 80"})]})}),this.props.settings.filter!==void 0&&this.props.settings.filter!==null?jsxRuntimeExports.jsx("div",{className:"flex w-10 h-10 2xl:w-12 2xl:h-12 ml-2 flex-shrink-0 justify-center items-center rounded-full bg-gray-200 border border-gray-200 hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-700 dark:hover:bg-gray-600 cursor-pointer",onClick:()=>this.handleFiltered(),children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z"})})}):null]})})})})]}):null,this.state.alerterror.state?jsxRuntimeExports.jsx(DesmyAlert,{error:this.state.alerterror,handleCloseAlert:this.handleReset}):null]}),jsxRuntimeExports.jsx("div",{}),jsxRuntimeExports.jsx("div",{className:`scrollable_table flex flex-col h-[calc(100vh-290px)] overflow-auto  scrollbar-width ${this.props.className}`,onScroll:this.handleScroll,children:jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full",children:jsxRuntimeExports.jsxs("div",{className:"w-full overflow-x-auto",children:[jsxRuntimeExports.jsxs("table",{className:"w-full whitespace-nowrap",children:[jsxRuntimeExports.jsx("thead",{className:" w-full ",children:jsxRuntimeExports.jsx("tr",{className:"text-left text-sm w-full bg-white dark:bg-darkPrimary",children:this.tableHeads()})}),jsxRuntimeExports.jsx("tbody",{className:"w-full",children:this.props.children})]}),!this.state.isLoading&&(!this.dataCollection.length||this.state.error.state)?jsxRuntimeExports.jsxs("div",{className:`flex flex-col w-full h-96 justify-center ${this.state.error.state?"text-red-500":"dark:text-white"} space-y-5 items-center text-base`,children:[this.state.error.state?jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-10 h-10",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}):DesmyCommons$1.isEmptyOrNull(this.search)?jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-10 h-10",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}):jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-10 h-10",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),jsxRuntimeExports.jsx("div",{className:"flex w-full text-sm justify-center text-center",children:this.state.error.state?this.state.error.message:DesmyCommons$1.isEmptyOrNull(this.search)?"No data available to show":jsxRuntimeExports.jsx("span",{className:" font-poppinsSemiBold",children:" Sorry we couldn't find anything!"})}),this.state.error?.retry&&DesmyCommons$1.isEmptyOrNull(this.search)?jsxRuntimeExports.jsx("div",{onClick:()=>this.handleRetry(),className:`uppercase flex font-poppinsSemiBold ${this.state.error.state?"bg-red-400 text-red-700":""} px-6 py-2 cursor-pointer rounded-full my-4`,children:this.state.error.state?"RETRY":"REFRESH"}):null]}):this.state.isLoading?jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full mt-10 justify-center dark:text-white items-center space-y-4",children:[jsxRuntimeExports.jsxs("svg",{role:"status",className:"flex w-4 h-4 2xl:w-6 2xl:h-6 text-black dark:text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}),jsxRuntimeExports.jsx("div",{className:"text-xs 2xl:text-sm",children:"Loading......."})]}):null]})})})]})})}}class DesmyCustomDataTable extends React2.Component{renderedSettings=[];dataCollection=[];chunkSize=6;currentIndex=0;hasClear=!1;isLoading=!1;current_page=0;search="";constructor(A){super(A),this.state={selected:-1,isLoading:!0,input:{search:"",is_searching:!1},entities:{data:[],meta:{current_page:1,next_page:null,from:1,last_page:1,per_page:500,to:1,total:0}},custom_settings:{sorted_column:"",order:"asc",first_page:1,current_page:1,offset:4},settings:{default_sorted_column:"",header:{title:"",class:"",hint:""},url:"",deleteinfo:{id:""},headers:[],columns:[],table_data:[]},error:{state:!1,message:"",type:DesmyState.ERROR,color:""},alerterror:{state:!1,message:"",type:DesmyState.ERROR,color:""}},this.handleScroll=this.handleScroll.bind(this)}async componentDidMount(){this.props.onRef&&this.props.onRef(this);const{default_sorted_column:A}=this.props.settings,l={...this.state.custom_settings,sorted_column:A};this.chunkSize=this.props.settings.pagination?.per_page??0,this.setState({custom_settings:l,settings:this.props.settings},()=>{this.handleFetchEntities()})}handleScroll(A){const l=A.currentTarget;l.scrollTop+l.clientHeight>=l.scrollHeight-10&&this.loadNextPage()}errors=A=>{this.setState({alerterror:A})};handleReset=()=>{this.setState({alerterror:{state:!1,message:"",type:DesmyState.ERROR,color:""}})};handleError=(A="")=>{try{const l={...this.state.error,state:!0,message:DesmyCommons$1.isEmptyOrNull(A)?DesmyState.ERROR_MESSAGE:A,type:DesmyState.ERROR,color:"red"};this.setState({isLoading:!1,error:l},()=>{this.props.handleOnLoaded(this.renderedSettings,DesmyState.ERROR,A)})}catch{}};async fetchEntities(){try{const A={...this.state.entities},l=`${this.props.settings.url}/?page=${this.state.custom_settings.current_page}&column=${this.state.custom_settings.sorted_column}&order=${this.state.custom_settings.order}&per_page=${this.state.entities.meta.per_page}&search=${this.search}`,t=(await axios.get(l,{headers:{"X-CSRFToken":`${DesmyAuth$1.getCookie("csrftoken")}`,Authorization:`Token ${this.props.settings?.token??DesmyAuth$1.get(DesmyState.ACCESS_TOKEN)}`}})).data;t.success?(A.data=[],this.hasClear&&this.handleClear(),this.dataCollection=this.dataCollection.concat(t.data.data),this.hasClear=!1,A.meta=t.data.meta,this.setState({isLoading:!1,entities:A},this.initialChunck)):this.handleError(t.message)}catch{this.handleError()}}handleFetchEntities=()=>{this.props.handleOnLoaded(this.renderedSettings,DesmyState.LOADING),this.fetchEntities()};handleFiltered=()=>{};handleRetry=()=>{try{this.handleClear();const A={...this.state.custom_settings,current_page:1};this.setState({isLoading:!0,error:{state:!1,message:"",type:DesmyState.ERROR,color:""},custom_settings:A},this.handleFetchEntities)}catch{}};handleClear=()=>{const A={...this.state.input,is_searching:!1},l={...this.state.entities,meta:{...this.state.entities.meta,total:0}};this.setState({input:A}),this.dataCollection=[],this.renderedSettings=[],this.currentIndex=0,this.current_page=0,this.forceUpdate(),this.setState({entities:l})};initialChunck(){this.loadNextBatch()}loadNextPage=()=>{try{if(!this.isLoading){const A={...this.state.custom_settings},l=this.state.entities.meta.next_page;l!==null&&!DesmyCommons$1.isEmptyOrNull(l)&&this.current_page!==l&&(A.current_page=l,this.current_page=l,this.setState({isLoading:!0,custom_settings:A},()=>{this.props.handleOnLoaded(this.renderedSettings,DesmyState.LOADING),this.handleFetchEntities()}))}}catch{}};handleOnSuccess=A=>{this.renderedSettings.splice(A,1),this.dataCollection.splice(A,1);let l=this.state.entities;l.meta.total=this.renderedSettings.length,this.renderedSettings.length==0&&this.handleClear(),this.forceUpdate()};loadNextBatch=()=>{try{this.renderChunk(),this.forceUpdate(),this.currentIndex+=this.chunkSize,this.isLoading=!1}catch{}};renderChunk(){try{const A=this.currentIndex+this.chunkSize>this.dataCollection.length?this.dataCollection.length:this.currentIndex+this.chunkSize;for(let l=this.currentIndex;l<A;l++){const o=this.dataCollection[l];this.renderedSettings.some(t=>t[this.props.settings.deleteinfo.id]===o[this.props.settings.deleteinfo.id])||this.renderedSettings.push(o)}this.props.handleOnLoaded(this.renderedSettings,DesmyState.LOADED)}catch{}}handleFocus=()=>{this.setState({isFocused:!0})};handleBlur=()=>{this.setState({isFocused:!1})};onChangeValue=A=>{try{this.search=A.target.value,DesmyCommons$1.isEmptyOrNull(this.search)&&!this.state.input.is_searching&&this.handleSearching()}catch{}};handleKeyDown=A=>{try{A.key==="Enter"&&!DesmyCommons$1.isEmptyOrNull(this.search)&&this.handleSearching()}catch(l){console.error("Error in handleKeyDown:",l)}};handleSearching(){let A=this.state.custom_settings,l=this.state.input;A.current_page=1,l.is_searching=!0,this.hasClear=!0,this.setState({custom_settings:A,input:l},()=>{this.fetchEntities()})}handleHint=()=>{try{return this.state.settings.header?.hint?this.state.settings.header.hint:this.state.error.state?"":`Loaded ${this.state.entities.meta.total} data`}catch{return this.state.error.state?"":"Loaded 0 data"}};render(){const{isFocused:A,searchText:l}=this.state,o=A&&l!=="";return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full mb-5",children:[jsxRuntimeExports.jsxs("header",{className:"flex w-full flex-col md:flex-row justify-start md:justify-between items-center space-x-6",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full  mx-10 md:mx-0 ",children:this.state.settings.header!==void 0?jsxRuntimeExports.jsxs("div",{className:"flex w-full flex-col",children:[jsxRuntimeExports.jsx("h3",{className:`${this.state.settings.header!==void 0?DesmyCommons$1.isEmptyOrNull(this.state.settings.header.class)?" text-grey-darkest uppercase text-3xl 2xl:text-5xl dark:text-white font-poppinsBlack":this.state.settings.header.class:""}`,children:this.state.settings.header.title}),jsxRuntimeExports.jsx("div",{className:"text-grey font-thin text-xs 2xl:text-sm dark:text-white",children:this.handleHint()})]}):null}),jsxRuntimeExports.jsx("div",{className:"flex w-max  flex-col lg:items-end justify-start lg:justify-end",children:jsxRuntimeExports.jsx("div",{className:"flex flex-col lg:items-end justify-start lg:justify-end ",children:jsxRuntimeExports.jsx("div",{className:"flex items-center w-full lg:max-w-md justify-start lg:justify-end mt-5 lg:mt-0",children:jsxRuntimeExports.jsxs("div",{className:"flex w-full text-grey font-thin text-sm dark:text-white",children:[jsxRuntimeExports.jsx("div",{className:"w-full",children:jsxRuntimeExports.jsxs("div",{className:"flex w-full relative",children:[jsxRuntimeExports.jsx("input",{className:`rounded-full lg:rounded-full py-3 px-4 dark:focus:border-white dark:focus:ring-0 text-gray-700 text-xs 2xl:text-sm leading-tight border focus:outline-none focus:border-primary focus:ring-0 bg-inherit dark:text-white transition-all duration-300 ease-in-out
                                                       ${o?"w-[300px]":"w-[200px]"}`,onFocus:this.handleFocus,onBlur:this.handleBlur,name:"search",onChange:this.onChangeValue,onKeyDown:this.handleKeyDown,id:"search",type:"text",placeholder:"Search"}),this.state.input.is_searching&&!DesmyCommons$1.isEmptyOrNull(this.search)?jsxRuntimeExports.jsxs("svg",{role:"status",className:"inline absolute top-2.5 bottom-0 right-2 w-4 h-4 2xl:w-6 2xl:h-6 text-primary dark:text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}):null]})}),jsxRuntimeExports.jsx("div",{className:"flex w-10 h-10 2xl:w-12 2xl:h-12 ml-2 flex-shrink-0 justify-center items-center rounded-full dark:hover:text-black bg-gray-200 border border-gray-200 hover:bg-gray-100 dark:border-gray-800 dark:bg-darkDialogBackground  cursor-pointer",onClick:()=>this.handleRetry(),children:jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 512 512",fill:"currentColor",className:"w-4 h-4 2xl:w-5 2xl:h-5",children:[jsxRuntimeExports.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:10,strokeWidth:32,d:"M320 146s24.36-12-64-12a160 160 0 10160 160"}),jsxRuntimeExports.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:32,d:"M256 58l80 80-80 80"})]})}),this.props.settings.filter!==void 0&&this.props.settings.filter!==null?jsxRuntimeExports.jsx("div",{className:"flex w-10 h-10 2xl:w-12 2xl:h-12 ml-2 flex-shrink-0 justify-center items-center rounded-full bg-gray-200 border border-gray-200 hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-700 dark:hover:bg-gray-600 cursor-pointer",onClick:()=>this.handleFiltered(),children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z"})})}):null]})})})})]}),this.props.content!=null?jsxRuntimeExports.jsx("div",{children:this.props.content}):null,this.state.alerterror.state?jsxRuntimeExports.jsx(DesmyAlert,{error:this.state.alerterror,handleCloseAlert:this.handleReset}):null]}),jsxRuntimeExports.jsx("div",{}),jsxRuntimeExports.jsx("div",{className:`scrollable_table flex flex-col h-[calc(100vh-290px)] overflow-auto  scrollbar-width ${this.props.className}`,onScroll:this.handleScroll,children:jsxRuntimeExports.jsx("div",{className:"flex flex-col ",children:jsxRuntimeExports.jsx("div",{className:"flex w-full",children:this.props.children})})})]})})}}class DesmyReadMoreOrLess extends React2.Component{static defaultProps={maxLength:100};constructor(A){super(A),this.state={isExpanded:!1}}toggleReadMore=()=>{this.setState(A=>({isExpanded:!A.isExpanded}))};render(){const{text:A,maxLength:l}=this.props,{isExpanded:o}=this.state,t=o||A.length<=l?A:`${A.substring(0,l)}...`;return jsxRuntimeExports.jsxs("div",{children:[t,A.length>l&&jsxRuntimeExports.jsx("span",{onClick:this.toggleReadMore,className:"text-blue-500 dark:text-white font-black underline",children:o?"Read Less":"Read More"})]})}}class DesmyPopupMenu extends React2.Component{dropdownRef=React2.createRef();buttonRef=React2.createRef();constructor(A){super(A),this.state={isOpen:!1,isLoading:!0,datalist:[]}}fetch=async()=>{const{url:A,options:l}=this.props.request;if(DesmyCommons$1.isEmptyOrNull(A))l&&this.setState({datalist:l,isLoading:!1});else try{const t=(await axios.get(DesmyCommons$1.toString(A),{headers:{"X-CSRFToken":`${DesmyAuth$1.getCookie("csrftoken")}`,Authorization:`Token ${DesmyAuth$1.get(DesmyState.ACCESS_TOKEN)}`}})).data;t.success?this.setState({datalist:t.data,isLoading:!1}):this.handleAlert()}catch{this.handleAlert()}};handleAlert=A=>{this.setState({isLoading:!1})};toggleDropdown=A=>{A.preventDefault(),this.setState(l=>({isOpen:!l.isOpen}))};handleClickOutside=A=>{const l=this.dropdownRef.current,o=this.buttonRef.current;l&&!l.contains(A.target)&&o&&!o.contains(A.target)&&this.setState({isOpen:!1})};componentDidMount(){this.fetch(),document.addEventListener("click",this.handleClickOutside)}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutside)}handleOnSelect=A=>{this.setState({isOpen:!1},()=>{this.props.request.onSelect(A)})};render(){const{children:A}=this.props,{isOpen:l}=this.state;return jsxRuntimeExports.jsxs("div",{className:"relative inline-block text-left",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{onContextMenu:this.toggleDropdown,onClick:this.props.onOpen,ref:this.buttonRef,id:"dropdownButton",className:"cursor-pointer",children:A})}),jsxRuntimeExports.jsx("div",{id:"dropdownMenu",ref:this.dropdownRef,style:this.props.style,className:`absolute top-1/2 z-50 right-0 transform translate-x-1/2 mt-2 w-max rounded-md shadow-lg bg-white border-[1px] border-gray-100 transition-all duration-200 ease-in-out ${l?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"} ${this.props.className}`,children:jsxRuntimeExports.jsx("div",{role:"menu",children:this.state.isLoading?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}):this.state.datalist.length>0?this.state.datalist.map((o,t)=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{onClick:()=>this.handleOnSelect(o),className:`flex w-full space-x-3 items-center px-6 py-4 cursor-pointer text-sm hover:bg-gray-100 ${o.id==DesmyState.DELETE?"text-red-500":"text-gray-700"}`,children:[o.icon?o.icon:null,jsxRuntimeExports.jsx("span",{children:o.name})]}),t!==this.state.datalist.length-1&&jsxRuntimeExports.jsx("hr",{className:"border-t border-gray-200"})]},`option-${t}`)):null})})]})}}class DesmyWizard extends React2.Component{constructor(A){super(A),this.state={step:A.defaultStep!==void 0?A.defaultStep:1}}componentDidMount(){this.props.onRef&&this.props.onRef(this)}nextStep=()=>{this.setState(A=>({step:A.step+1}))};prevStep=()=>{this.setState(A=>({step:A.step-1}))};jumpStep=A=>{this.setState({step:A})};getStep=()=>this.state.step;render(){const{step:A}=this.state,{children:l,wizardHeader:o,wizardFooter:t,className:a,loading:n}=this.props;return jsxRuntimeExports.jsx("div",{className:a||"h-screen overflow-hidden",children:jsxRuntimeExports.jsxs("div",{id:"flex-col",className:"flex flex-col h-full",children:[jsxRuntimeExports.jsx("div",{className:"w-full",children:o(A)}),jsxRuntimeExports.jsx("div",{className:"flex flex-row grow min-h-0",children:n?jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full h-[500px] px-5 py-9 mb-10 relative",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full items-center justify-center",children:[jsxRuntimeExports.jsxs("svg",{role:"status",className:"inline w-9 h-9 text-primary dark:text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}),jsxRuntimeExports.jsx("div",{className:"text-sm mt-5",children:"Please wait...."})]})}):jsxRuntimeExports.jsx("div",{className:"w-full h-full overflow-auto",children:jsxRuntimeExports.jsx("div",{className:"lg:px-8",children:l.map((B,R)=>jsxRuntimeExports.jsx("div",{className:R+1===A?"transition-opacity duration-500 opacity-100":"hidden",children:B},R))})})}),jsxRuntimeExports.jsx("div",{children:t(A)})]})})}}class DesmyLazyImage extends React2.Component{imgRef=React2.createRef();observer=null;constructor(A){super(A),this.state={isLoaded:!1}}componentDidMount(){"IntersectionObserver"in window?(this.observer=new IntersectionObserver(A=>{A.forEach(l=>{l.isIntersecting&&this.loadImage()})},{threshold:.1}),this.imgRef.current&&this.observer.observe(this.imgRef.current)):this.loadImage()}componentWillUnmount(){this.observer?.disconnect()}loadImage=()=>{this.state.isLoaded||this.setState({isLoaded:!0})};handleImageLoad=()=>{this.setState({isLoaded:!0}),this.observer?.disconnect()};render(){const{src:A,placeholder:l,alt:o,coverClassName:t,className:a,...n}=this.props,{isLoaded:B}=this.state,R="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";return A?jsxRuntimeExports.jsxs("div",{className:`relative ${t??""}`,children:[!B&&l,jsxRuntimeExports.jsx("img",{ref:this.imgRef,src:B?A:R,alt:o,className:`${a??"h-12"} transition-opacity duration-500 ${B?"opacity-100":"opacity-0"}`,onLoad:this.handleImageLoad,...n})]}):null}}class DesmyFilePicker extends React2.Component{constructor(A){super(A),this.state={selectedImage:null,selectedFile:null,hasLoaded:!1,hasError:!1,filedata:{name:""},image:{url:"",title:""}}}componentDidUpdate(A){!DesmyCommons$1.isEmptyOrNull(this.props.image.url)&&DesmyCommons$1.isEmptyOrNull(this.state.image.url)&&this.setState({image:this.props.image})}async componentDidMount(){this.props.image!==void 0&&this.setState({image:this.props.image})}handleFileUpload=A=>{const l=A.target.files?.[0];if(l)if(this.state.image.type===DesmyState.DOCUMENT){const{filedata:o}=this.state;if(l.type==="application/pdf")o.name=l.name,this.setState({filedata:o},()=>this.props.image.onSelected(l));else return this.handleAlert("Error: You can only upload pdf file format."),!1}else{if(!l.name.toLowerCase().match(/\.(png|jpeg|jpg)$/))return this.handleAlert("Error: You can only upload images in PNG, JPEG or JPG format."),!1;const o=new FileReader;o.readAsDataURL(l),o.onloadend=()=>{this.setState({hasError:!1,selectedFile:l,selectedImage:o.result},()=>{this.props.image.onSelected(l)})}}};handleCancelUpload=()=>{const{image:A}=this.state;A.url="",this.setState({selectedFile:null,selectedImage:null,image:A})};handleAlert=A=>{alert(A)};render(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"relative z-0 mb-7 w-full group",children:jsxRuntimeExports.jsx("div",{className:`bg-gray-200 dark:bg-darkPrimary dark:text-white rounded-lg w-full shadow-sm h-40 justify-center items-center cursor-pointer relative overflow-hidden group ${this.state.selectedImage!==null&&this.state.selectedImage!==void 0?"p-0":DesmyCommons$1.isEmptyOrNull(this.state.image.url)?"p-6":""} ${this.props.className}`,id:"dropzone",children:this.state.selectedImage!==null&&this.state.selectedImage!==void 0||!DesmyCommons$1.isEmptyOrNull(this.state.image.url)?jsxRuntimeExports.jsxs("div",{className:"flex w-full h-full relative",children:[jsxRuntimeExports.jsx(DesmyLazyImage,{className:"object-center object-cover w-full h-full cursor-pointer m-auto",src:`${this.state.selectedImage!==null&&this.state.selectedImage!==void 0?this.state.selectedImage:this.state.image.url}`}),jsxRuntimeExports.jsx("div",{className:"absolute left-0 bottom-0 bg-black/20 bg-opacity-5 right-2 h-full w-full top-0 ",children:jsxRuntimeExports.jsx("div",{className:"cursor-pointer absolute top-2 right-2 w-6 h-6 text-white rounded-full justify-center items-center",onClick:this.handleCancelUpload,children:jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 rounded-full border-[1px] border-white m-auto",children:jsxRuntimeExports.jsx("path",{d:"M2.93 17.07A10 10 0 1117.07 2.93 10 10 0 012.93 17.07zM11.4 10l2.83-2.83-1.41-1.41L10 8.59 7.17 5.76 5.76 7.17 8.59 10l-2.83 2.83 1.41 1.41L10 11.41l2.83 2.83 1.41-1.41L11.41 10z"})})})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("input",{type:"file",className:"absolute inset-0 text-gray-500 w-full h-full opacity-0 z-50",accept:`${DesmyCommons$1.isEmptyOrNull(this.state.image.accept)?"image/*":this.state.image.accept}`,onChange:this.handleFileUpload}),jsxRuntimeExports.jsx("div",{className:"flex w-full h-full justify-center items-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[DesmyCommons$1.isEmptyOrNull(this.state.image.placeholder)?jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"mx-auto h-12 w-12 text-gray-500 dark:text-white",viewBox:"0 0 24 24",strokeWidth:.7,stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})}):jsxRuntimeExports.jsx("div",{className:"mx-auto h-12 w-12 text-gray-500",children:jsxRuntimeExports.jsx(DesmyLazyImage,{className:"object-center object-cover w-full h-full cursor-pointer m-auto",src:this.state.image.placeholder})}),jsxRuntimeExports.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:jsxRuntimeExports.jsx("label",{className:"relative cursor-pointer font-poppinsBold",children:this.state.image.type===DesmyState.DOCUMENT&&!DesmyCommons$1.isEmptyOrNull(this.state.filedata.name)?this.state.filedata.name:this.state.image.title})}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-gray-500",children:DesmyCommons$1.isEmptyOrNull(this.state.image.hint)?"PNG, JPG up to 1MB":this.state.image.hint})]})})]})})})})}}class DesmyDocumentPicker extends React2.Component{constructor(A){super(A),this.state={input:{file:null}}}handleFileChange=A=>{const{input:l}=this.state,o=A.target.files?.[0]||null;if(o&&!["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(o.type)){y$1.error("Only Microsoft Word documents (.doc, .docx) are allowed.");return}this.setState({input:{...l,file:o}}),this.props.onFileSelected(o)};handleCancelDocument=()=>{this.setState({input:{file:null}}),this.props.onFileSelected(null)};render(){return jsxRuntimeExports.jsx("div",{children:this.state.input.file?jsxRuntimeExports.jsxs("div",{className:"flex w-full space-x-2 dark:text-white bg-primary/30 rounded-lg px-3 py-2 relative",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("img",{src:"/static/word.png",className:"w-8",alt:"Word Document"})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full mr-5",children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-primary dark:text-white",children:this.state.input.file?.name}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-600 dark:text-white",children:[this.state.input.file?.size," bytes"]})]}),jsxRuntimeExports.jsx("svg",{onClick:this.handleCancelDocument,viewBox:"0 0 512 512",fill:"currentColor",className:"w-4 h-5 text-primary hover:text-white cursor-pointer absolute right-3 top-3 bottom-0",children:jsxRuntimeExports.jsx("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})})]}):jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("label",{htmlFor:"fileInput",className:"block text-sm text-slate-500 rounded-full dark:text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 dark:file:bg-darkDialogBackground file:text-primary dark:file:text-white hover:file:bg-violet-100 focus:outline-none",children:jsxRuntimeExports.jsxs("div",{className:"flex bg-primary/40 space-x-3 text-xs text-primary hover:bg-primary hover:text-white px-4 py-3 rounded-full transition-all ease-in-out duration-300 transform hover:scale-105 hover:shadow-lg cursor-pointer",children:[jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsxs("svg",{fill:"currentColor",viewBox:"0 0 16 16",className:"w-4 h-4",children:[jsxRuntimeExports.jsx("path",{d:"M.5 9.9a.5.5 0 01.5.5v2.5a1 1 0 001 1h12a1 1 0 001-1v-2.5a.5.5 0 011 0v2.5a2 2 0 01-2 2H2a2 2 0 01-2-2v-2.5a.5.5 0 01.5-.5z"}),jsxRuntimeExports.jsx("path",{d:"M7.646 1.146a.5.5 0 01.708 0l3 3a.5.5 0 01-.708.708L8.5 2.707V11.5a.5.5 0 01-1 0V2.707L5.354 4.854a.5.5 0 11-.708-.708l3-3z"})]})}),jsxRuntimeExports.jsx("span",{children:"Click to upload document"})]})}),jsxRuntimeExports.jsx("input",{type:"file",id:"fileInput",accept:".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:this.handleFileChange,className:"hidden"})]})})}}class DesmyListCard extends React2.Component{constructor(A){super(A),this.state={content:null}}render(){const l=[{id:DesmyState.OPEN,name:"Open",icon:jsxRuntimeExports.jsx("svg",{fill:"none",viewBox:"0 0 15 15",className:"w-4 h-4",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 2a1 1 0 00-1 1v9a1 1 0 001 1h9a1 1 0 001-1V8.5a.5.5 0 00-1 0V12H3V3h3.5a.5.5 0 000-1H3zm9.854.146a.5.5 0 01.146.351V5.5a.5.5 0 01-1 0V3.707L6.854 8.854a.5.5 0 11-.708-.708L11.293 3H9.5a.5.5 0 010-1h3a.499.499 0 01.354.146z",clipRule:"evenodd"})})},{id:DesmyState.EDIT,name:"Edit",icon:jsxRuntimeExports.jsx("svg",{viewBox:"0 0 1024 1024",fill:"currentColor",className:"w-4 h-4",children:jsxRuntimeExports.jsx("path",{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"})})},{id:DesmyState.DELETE,name:"Delete",icon:jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 1024 1024",fill:"currentColor",className:"w-4 h-4",children:[jsxRuntimeExports.jsx("path",{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}),jsxRuntimeExports.jsx("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"})]})}].filter(t=>!(t.id===DesmyState.EDIT&&!this.props.edit_permission||t.id===DesmyState.DELETE&&!this.props.delete_permission||t.id===DesmyState.OPEN&&!this.props.is_open)),o=this.props.optionList&&this.props.optionList.length>0?this.props.optionList:l;return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:this.props.isLoading?jsxRuntimeExports.jsx("div",{className:"flex w-full h-24 animate-pulse",children:jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full h-full bg-gray-300 dark:bg-darkPrimary"})}):jsxRuntimeExports.jsx(DesmyPopupMenu,{className:"cursor-pointer w-56 -mt-6",dropdownId:this.props.key,onOpen:this.props.onOpen,request:{options:o,serverRequest:!1,isEnable:!0,onSelect:t=>{this.props.onAction?.(t)}},children:jsxRuntimeExports.jsx("div",{className:`flex flex-col w-full rounded-lg cursor-pointer  group min-h-24 ${this.props.className??"border border-l-4 px-4 py-4 hover:bg-primary dark:hover:bg-white dark:text-black hover:text-white dark:hover:text-black uppercase hover:border-l-white dark:hover:border-l-white border-l-primary dark:border-l-darkDialogBackground bg-white dark:bg-darkPrimary dark:border-darkDialogBackground border-gray-200 "}`,style:this.props.style,children:jsxRuntimeExports.jsx("div",{className:"w-full",children:jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full",children:this.props.name?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[DesmyCommons$1.isEmptyOrNull(this.props.image)?null:jsxRuntimeExports.jsx("div",{className:"flex h-24 mb-2",children:jsxRuntimeExports.jsx("img",{className:"object-center object-cover rounded-lg transition-transform duration-300 ease-in-out w-full h-full cursor-pointer m-auto",alt:"photo",src:this.props.image})}),jsxRuntimeExports.jsx("div",{className:"text-sm line-clamp-1 text-center dark:text-white dark:group-hover:text-black",children:this.props.name}),DesmyCommons$1.isEmptyOrNull(this.props.caption)?null:jsxRuntimeExports.jsxs("div",{className:"w-full text-xs line-clamp-1 lowercase justify-center lg:text-center text-gray-600 dark:text-white group-hover:text-white dark:group-hover:text-black lg:line-clamp-2",children:["(",this.props.caption,")"]})]}):this.props.children})})})})})}}class DesmyNetworkError extends React2.Component{constructor(A){super(A),this.state={}}render(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex w-full flex-col h-96 justify-center space-y-5 items-center",children:[this.props.icon?jsxRuntimeExports.jsx("div",{className:"flex h-24 mb-5",children:jsxRuntimeExports.jsx("img",{className:"object-center object-contain rounded-lg  transition-transform duration-300 ease-in-out w-full h-full cursor-pointer m-auto",alt:"photo",src:`${this.props.icon}`})}):null,jsxRuntimeExports.jsx("div",{className:`text-sm text-red-600 
          font-poppinsRegular`,children:DesmyCommons$1.isEmptyOrNull(this.props.errormessage)?DesmyState.ERROR_MESSAGE:this.props.errormessage}),jsxRuntimeExports.jsxs("div",{className:"flex w-full justify-center items-center space-x-4",children:[this.props.onRetry!=null?jsxRuntimeExports.jsx("div",{className:"bg-primary text-white px-6 py-3 rounded-full text-xs uppercase cursor-pointer border hover:border-black dark:bg-darkDialogBackground hover:bg-white hover:text-black transition-all",onClick:this.props.onRetry,children:"Retry"}):null,this.props.onCancel!=null?jsxRuntimeExports.jsx("div",{className:"bg-red-500 text-white px-6 py-3 border border-red-500 rounded-full text-xs uppercase cursor-pointer hover:bg-red-700 hover:border-red-700 transition-all",onClick:this.props.onCancel,children:"Cancel"}):null]})]})})}}class DesmyNoDataFound extends React2.Component{render(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full bg-gray-200/50 dark:bg-darkDialogBackground dark:border-darkPrimaryBorder border-[1px] justify-center items-center border-gray-200 rounded-2xl min-h-96",children:jsxRuntimeExports.jsxs("div",{className:"text-base justify-center items-center space-y-4 text-center dark:text-white",children:[jsxRuntimeExports.jsx("div",{className:"flex w-full justify-center text-center",children:jsxRuntimeExports.jsx("svg",{width:"1em",height:"1em",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",className:"w-8 h-8 flex-shrink-0",children:jsxRuntimeExports.jsx("path",{d:"M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0zM12 9v4m0 4h.01"})})}),jsxRuntimeExports.jsx("div",{children:this.props.message??"No data available"}),this.props.action_label&&jsxRuntimeExports.jsx("div",{className:"flex w-full justify-center items-center",children:jsxRuntimeExports.jsx("div",{className:"flex mx-auto",children:jsxRuntimeExports.jsx("div",{onClick:this.props.onAction,className:"text-xs bg-gray-500 hover:bg-black hover:text-white dark:bg-darkPrimaryBorder dark:hover:bg-white dark:hover:text-black  text-white px-6 py-3 rounded-full cursor-pointer",children:this.props.action_label})})})]})})})}}class DesmyEmpty extends React2.Component{constructor(A){super(A),this.state={}}render(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full items-center justify-center dark:text-white space-y-5",children:jsxRuntimeExports.jsxs("div",{className:"flex w-full flex-col h-96 justify-center items-center",children:[DesmyCommons$1.isEmptyOrNull(this.props.image)?null:jsxRuntimeExports.jsx("div",{className:"w-24",children:jsxRuntimeExports.jsx("img",{className:"object-center object-cover w-full h-full cursor-pointer m-auto",alt:"photo",src:`${this.props.image}`})}),jsxRuntimeExports.jsx("div",{className:"text-sm dark:text-white font-poppinsRegular",children:this.props.message})]})})})}}class DesmyModalWrapper extends React2.Component{constructor(A){super(A),this.state={modal:null}}handleClose=()=>{this.props.onClose()};render(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"fixed z-[4000] inset-0 overflow-y-auto font-poppinsRegular",children:jsxRuntimeExports.jsx("div",{className:"fixed justify-items-center px-2 backdrop-blur-sm top-0 right-0 left-0 z-40 w-full inset-0 h-modal h-full justify-center items-center overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[jsxRuntimeExports.jsx("div",{className:"fixed inset-0 transition-opacity",children:jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/25 opacity-75"})}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen"}),jsxRuntimeExports.jsx(DesmyClickOutsideListener,{onClickOutside:this.handleClose,children:jsxRuntimeExports.jsx("div",{className:`inline-block align-bottom font-poppinsRegular px-4 pt-5 pb-0 text-left transform transition-all sm:my-8 sm:align-middle ${DesmyCommons$1.isEmptyOrNull(this.props.className)?" sm:max-w-lg w-full sm:p-6":this.props.className}`,children:this.props.hasRequest?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full h-48 justify-center items-center",children:[jsxRuntimeExports.jsx("svg",{version:"1.1",id:"L9",className:"w-24 h-24  text-white",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 100 100",enableBackground:"new 0 0 0 0",xmlSpace:"preserve",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50",children:jsxRuntimeExports.jsx("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})})}),jsxRuntimeExports.jsxs("div",{children:[this.props.action_label!==null&&this.props.action_label!==void 0?this.props.action_label:"creating"," ...."]})]})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full",children:jsxRuntimeExports.jsx("div",{className:"relative sm:flex sm:items-start items-center",children:this.props.children})})})})})]})})})})}}var extendStatics=function(e,A){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,o){l.__proto__=o}||function(l,o){for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(l[t]=o[t])},extendStatics(e,A)};function __extends(e,A){if(typeof A!="function"&&A!==null)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");extendStatics(e,A);function l(){this.constructor=e}e.prototype=A===null?Object.create(A):(l.prototype=A.prototype,new l)}function __values(e){var A=typeof Symbol=="function"&&Symbol.iterator,l=A&&e[A],o=0;if(l)return l.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(A?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(e,A){var l=typeof Symbol=="function"&&e[Symbol.iterator];if(!l)return e;var o=l.call(e),t,a=[],n;try{for(;(A===void 0||A-- >0)&&!(t=o.next()).done;)a.push(t.value)}catch(B){n={error:B}}finally{try{t&&!t.done&&(l=o.return)&&l.call(o)}finally{if(n)throw n.error}}return a}function __spreadArray(e,A,l){if(l||arguments.length===2)for(var o=0,t=A.length,a;o<t;o++)(a||!(o in A))&&(a||(a=Array.prototype.slice.call(A,0,o)),a[o]=A[o]);return e.concat(a||Array.prototype.slice.call(A))}typeof SuppressedError=="function"&&SuppressedError;function isFunction(e){return typeof e=="function"}function createErrorClass(e){var A=function(o){Error.call(o),o.stack=new Error().stack},l=e(A);return l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l}var UnsubscriptionError=createErrorClass(function(e){return function(l){e(this),this.message=l?l.length+` errors occurred during unsubscription:
`+l.map(function(o,t){return t+1+") "+o.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=l}});function arrRemove(e,A){if(e){var l=e.indexOf(A);0<=l&&e.splice(l,1)}}var Subscription=function(){function e(A){this.initialTeardown=A,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var A,l,o,t,a;if(!this.closed){this.closed=!0;var n=this._parentage;if(n)if(this._parentage=null,Array.isArray(n))try{for(var B=__values(n),R=B.next();!R.done;R=B.next()){var r=R.value;r.remove(this)}}catch(CI){A={error:CI}}finally{try{R&&!R.done&&(l=B.return)&&l.call(B)}finally{if(A)throw A.error}}else n.remove(this);var H=this.initialTeardown;if(isFunction(H))try{H()}catch(CI){a=CI instanceof UnsubscriptionError?CI.errors:[CI]}var II=this._finalizers;if(II){this._finalizers=null;try{for(var k=__values(II),iI=k.next();!iI.done;iI=k.next()){var lI=iI.value;try{execFinalizer(lI)}catch(CI){a=a??[],CI instanceof UnsubscriptionError?a=__spreadArray(__spreadArray([],__read(a)),__read(CI.errors)):a.push(CI)}}}catch(CI){o={error:CI}}finally{try{iI&&!iI.done&&(t=k.return)&&t.call(k)}finally{if(o)throw o.error}}}if(a)throw new UnsubscriptionError(a)}},e.prototype.add=function(A){var l;if(A&&A!==this)if(this.closed)execFinalizer(A);else{if(A instanceof e){if(A.closed||A._hasParent(this))return;A._addParent(this)}(this._finalizers=(l=this._finalizers)!==null&&l!==void 0?l:[]).push(A)}},e.prototype._hasParent=function(A){var l=this._parentage;return l===A||Array.isArray(l)&&l.includes(A)},e.prototype._addParent=function(A){var l=this._parentage;this._parentage=Array.isArray(l)?(l.push(A),l):l?[l,A]:A},e.prototype._removeParent=function(A){var l=this._parentage;l===A?this._parentage=null:Array.isArray(l)&&arrRemove(l,A)},e.prototype.remove=function(A){var l=this._finalizers;l&&arrRemove(l,A),A instanceof e&&A._removeParent(this)},e.EMPTY=function(){var A=new e;return A.closed=!0,A}(),e}(),EMPTY_SUBSCRIPTION=Subscription.EMPTY;function isSubscription(e){return e instanceof Subscription||e&&"closed"in e&&isFunction(e.remove)&&isFunction(e.add)&&isFunction(e.unsubscribe)}function execFinalizer(e){isFunction(e)?e():e.unsubscribe()}var config={Promise:void 0},timeoutProvider={setTimeout:function(e,A){for(var l=[],o=2;o<arguments.length;o++)l[o-2]=arguments[o];return setTimeout.apply(void 0,__spreadArray([e,A],__read(l)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function reportUnhandledError(e){timeoutProvider.setTimeout(function(){throw e})}function noop(){}function errorContext(e){e()}var Subscriber=function(e){__extends(A,e);function A(l){var o=e.call(this)||this;return o.isStopped=!1,l?(o.destination=l,isSubscription(l)&&l.add(o)):o.destination=EMPTY_OBSERVER,o}return A.create=function(l,o,t){return new SafeSubscriber(l,o,t)},A.prototype.next=function(l){this.isStopped||this._next(l)},A.prototype.error=function(l){this.isStopped||(this.isStopped=!0,this._error(l))},A.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},A.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},A.prototype._next=function(l){this.destination.next(l)},A.prototype._error=function(l){try{this.destination.error(l)}finally{this.unsubscribe()}},A.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},A}(Subscription),ConsumerObserver=function(){function e(A){this.partialObserver=A}return e.prototype.next=function(A){var l=this.partialObserver;if(l.next)try{l.next(A)}catch(o){handleUnhandledError(o)}},e.prototype.error=function(A){var l=this.partialObserver;if(l.error)try{l.error(A)}catch(o){handleUnhandledError(o)}else handleUnhandledError(A)},e.prototype.complete=function(){var A=this.partialObserver;if(A.complete)try{A.complete()}catch(l){handleUnhandledError(l)}},e}(),SafeSubscriber=function(e){__extends(A,e);function A(l,o,t){var a=e.call(this)||this,n;return isFunction(l)||!l?n={next:l??void 0,error:o??void 0,complete:t??void 0}:n=l,a.destination=new ConsumerObserver(n),a}return A}(Subscriber);function handleUnhandledError(e){reportUnhandledError(e)}function defaultErrorHandler(e){throw e}var EMPTY_OBSERVER={closed:!0,next:noop,error:defaultErrorHandler,complete:noop},observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function identity(e){return e}function pipeFromArray(e){return e.length===0?identity:e.length===1?e[0]:function(l){return e.reduce(function(o,t){return t(o)},l)}}var Observable=function(){function e(A){A&&(this._subscribe=A)}return e.prototype.lift=function(A){var l=new e;return l.source=this,l.operator=A,l},e.prototype.subscribe=function(A,l,o){var t=this,a=isSubscriber(A)?A:new SafeSubscriber(A,l,o);return errorContext(function(){var n=t,B=n.operator,R=n.source;a.add(B?B.call(a,R):R?t._subscribe(a):t._trySubscribe(a))}),a},e.prototype._trySubscribe=function(A){try{return this._subscribe(A)}catch(l){A.error(l)}},e.prototype.forEach=function(A,l){var o=this;return l=getPromiseCtor(l),new l(function(t,a){var n=new SafeSubscriber({next:function(B){try{A(B)}catch(R){a(R),n.unsubscribe()}},error:a,complete:t});o.subscribe(n)})},e.prototype._subscribe=function(A){var l;return(l=this.source)===null||l===void 0?void 0:l.subscribe(A)},e.prototype[observable]=function(){return this},e.prototype.pipe=function(){for(var A=[],l=0;l<arguments.length;l++)A[l]=arguments[l];return pipeFromArray(A)(this)},e.prototype.toPromise=function(A){var l=this;return A=getPromiseCtor(A),new A(function(o,t){var a;l.subscribe(function(n){return a=n},function(n){return t(n)},function(){return o(a)})})},e.create=function(A){return new e(A)},e}();function getPromiseCtor(e){var A;return(A=e??config.Promise)!==null&&A!==void 0?A:Promise}function isObserver(e){return e&&isFunction(e.next)&&isFunction(e.error)&&isFunction(e.complete)}function isSubscriber(e){return e&&e instanceof Subscriber||isObserver(e)&&isSubscription(e)}var ObjectUnsubscribedError=createErrorClass(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Subject=function(e){__extends(A,e);function A(){var l=e.call(this)||this;return l.closed=!1,l.currentObservers=null,l.observers=[],l.isStopped=!1,l.hasError=!1,l.thrownError=null,l}return A.prototype.lift=function(l){var o=new AnonymousSubject(this,this);return o.operator=l,o},A.prototype._throwIfClosed=function(){if(this.closed)throw new ObjectUnsubscribedError},A.prototype.next=function(l){var o=this;errorContext(function(){var t,a;if(o._throwIfClosed(),!o.isStopped){o.currentObservers||(o.currentObservers=Array.from(o.observers));try{for(var n=__values(o.currentObservers),B=n.next();!B.done;B=n.next()){var R=B.value;R.next(l)}}catch(r){t={error:r}}finally{try{B&&!B.done&&(a=n.return)&&a.call(n)}finally{if(t)throw t.error}}}})},A.prototype.error=function(l){var o=this;errorContext(function(){if(o._throwIfClosed(),!o.isStopped){o.hasError=o.isStopped=!0,o.thrownError=l;for(var t=o.observers;t.length;)t.shift().error(l)}})},A.prototype.complete=function(){var l=this;errorContext(function(){if(l._throwIfClosed(),!l.isStopped){l.isStopped=!0;for(var o=l.observers;o.length;)o.shift().complete()}})},A.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(A.prototype,"observed",{get:function(){var l;return((l=this.observers)===null||l===void 0?void 0:l.length)>0},enumerable:!1,configurable:!0}),A.prototype._trySubscribe=function(l){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,l)},A.prototype._subscribe=function(l){return this._throwIfClosed(),this._checkFinalizedStatuses(l),this._innerSubscribe(l)},A.prototype._innerSubscribe=function(l){var o=this,t=this,a=t.hasError,n=t.isStopped,B=t.observers;return a||n?EMPTY_SUBSCRIPTION:(this.currentObservers=null,B.push(l),new Subscription(function(){o.currentObservers=null,arrRemove(B,l)}))},A.prototype._checkFinalizedStatuses=function(l){var o=this,t=o.hasError,a=o.thrownError,n=o.isStopped;t?l.error(a):n&&l.complete()},A.prototype.asObservable=function(){var l=new Observable;return l.source=this,l},A.create=function(l,o){return new AnonymousSubject(l,o)},A}(Observable),AnonymousSubject=function(e){__extends(A,e);function A(l,o){var t=e.call(this)||this;return t.destination=l,t.source=o,t}return A.prototype.next=function(l){var o,t;(t=(o=this.destination)===null||o===void 0?void 0:o.next)===null||t===void 0||t.call(o,l)},A.prototype.error=function(l){var o,t;(t=(o=this.destination)===null||o===void 0?void 0:o.error)===null||t===void 0||t.call(o,l)},A.prototype.complete=function(){var l,o;(o=(l=this.destination)===null||l===void 0?void 0:l.complete)===null||o===void 0||o.call(l)},A.prototype._subscribe=function(l){var o,t;return(t=(o=this.source)===null||o===void 0?void 0:o.subscribe(l))!==null&&t!==void 0?t:EMPTY_SUBSCRIPTION},A}(Subject);const subject=new Subject,DesmyRxServices={fileViewer:(e,A)=>subject.next({data:e,type:A}),sendData:(e,A)=>subject.next({data:e,type:A}),send:e=>subject.next({type:e}),clearMessages:()=>subject.next({}),getSubscription:()=>subject.asObservable()};class DesmyTableCard extends React2.Component{subscription;constructor(A){super(A),this.state={hasRequest:!1,response:"",data:A.data||{}}}componentDidMount(){this.subscription=DesmyRxServices.getSubscription().subscribe(A=>{A?.type===DesmyState.DATASETTABLE_REQUEST&&this.handleRequest()})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}handleRequest=async()=>{const{data:A}=this.state,{url:l}=this.props;if(!l){this.handleAlert(DesmyState.ERROR);return}try{const o=new FormData;Object.keys(A).forEach(a=>{o.append(a,A[a])}),this.setState({hasRequest:!0,response:""});const t=await axios.post(l,o,{headers:{"X-CSRFToken":DesmyAuth$1.getCookie("csrftoken"),Authorization:`Token ${DesmyAuth$1.get(DesmyState.ACCESS_TOKEN)}`}});this.handleAlert(t.data.success?DesmyState.SUCCESS:DesmyState.ERROR)}catch{this.handleAlert(DesmyState.ERROR)}};handleAlert=(A=DesmyState.ERROR)=>{this.setState({hasRequest:!1,response:A})};renderTableData=()=>{const{data:A}=this.state,{headers:l=[]}=this.props;return l.map((o,t)=>{const a=DesmyCommons$1.toStringDefault(A[o],"");return jsxRuntimeExports.jsx("td",{className:"px-6 py-3 ",children:DesmyCommons$1.toString(o).toLowerCase()!=="action"?jsxRuntimeExports.jsx("div",{className:"w-full line-clamp-1",title:a,children:a}):jsxRuntimeExports.jsx("span",{className:"flex w-full justify-center text-xs",children:this.state.hasRequest?jsxRuntimeExports.jsxs("svg",{role:"status",className:"inline z-0 mr-3 w-5 h-5 dark:text-white animate-spin",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"#E5E7EB"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentColor"})]}):DesmyCommons$1.isEmptyOrNull(this.state.response)?null:this.state.response===DesmyState.ERROR?jsxRuntimeExports.jsx("svg",{viewBox:"0 0 30 30",fill:"currentColor",className:"w-8 h-8 text-red-600 cursor-pointer",onClick:this.handleRequest,children:jsxRuntimeExports.jsx("path",{d:"..."})}):jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 text-green-600",children:jsxRuntimeExports.jsx("path",{d:"..."})})})},t)})};render(){const{isLoading:A}=this.props;return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:A?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{children:"Loading..."})}):jsxRuntimeExports.jsx("tr",{className:`text-sm cursor-pointer hover:bg-gray-200 dark:text-white dark:hover:bg-white dark:hover:text-black ${this.props.background} transition-all ease-in-out duration-150`,children:this.renderTableData()})})}}class DesmyAccordion extends React2.Component{constructor(A){super(A),this.state={isOpen:!1}}toggleAccordion=()=>{this.setState(A=>({isOpen:!A.isOpen}))};render(){const{isOpen:A}=this.state,{children:l,accordionHeader:o,className:t}=this.props;return jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full font-poppinsRegular",children:jsxRuntimeExports.jsxs("div",{className:`rounded transition-all duration-300 ${A?"mb-4":""}`,children:[jsxRuntimeExports.jsxs("div",{className:`relative cursor-pointer ${t}`,onClick:this.toggleAccordion,children:[jsxRuntimeExports.jsx("div",{className:"w-full",children:o(A)}),jsxRuntimeExports.jsx("div",{className:"absolute top-0 justify-center right-0 h-full items-center",children:jsxRuntimeExports.jsx("div",{className:"flex h-full w-full mr-3 items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:`h-6 w-6 m-auto transition-transform transform ${A?"rotate-180":""}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})})})})]}),A&&jsxRuntimeExports.jsx("div",{className:"submenu-enter submenu-enter-active",children:l})]})})}}class Toast extends React2.Component{timerId=null;progressBar=null;progress=0;progressPaused=!1;remainingTime=0;startTime=0;static defaultProps={timeout:8e3};componentDidMount(){const{timeout:A=8e3,onClose:l}=this.props;this.remainingTime=A,this.startTime=Date.now(),this.startTimeout(l),document.addEventListener("visibilitychange",this.handleVisibilityChange)}componentWillUnmount(){this.timerId&&clearInterval(this.timerId),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}clearTimeOut=()=>{this.timerId&&clearInterval(this.timerId)};startTimeout(A){this.timerId=window.setInterval(()=>{if(this.progress>=100){A(),this.clearTimeOut();return}this.progress+=1,this.progress>100&&(this.progress=100),this.updateProgressBar()},100)}startProgressBar(){this.progressBar&&this.updateProgressBar()}updateProgressBar(){this.progressBar&&(this.progressBar.style.width=`${this.progress}%`)}setProgressBarRef=A=>{this.progressBar=A,A&&(A.style.width="0%")};handleMouseEnter=()=>{if(!this.progressPaused){const A=Date.now()-this.startTime;this.remainingTime=(this.props.timeout??8e3)-A,this.timerId&&clearInterval(this.timerId),this.progressPaused=!0}};handleMouseLeave=()=>{const{onClose:A}=this.props;this.progressPaused&&(this.progressPaused=!1,this.startTime=Date.now()-this.progress/100*(this.props.timeout??8e3),this.startTimeout(A))};handleVisibilityChange=()=>{if(document.hidden){this.timerId&&clearInterval(this.timerId),this.progressPaused=!0;const A=Date.now()-this.startTime;this.remainingTime=(this.props.timeout??8e3)-A}else this.progressPaused=!1,this.startTime=Date.now(),this.startTimeout(this.props.onClose)};handleOnClose=A=>{A.preventDefault(),this.props.onClose()};render(){const{message:A,type:l,id:o}=this.props,t=l==="success"?"bg-green-500 border-green-100  text-white":l==="error"?"bg-red-400 text-white border-red-100 ":"bg-blue-500 border-blue-100  text-white",a=l==="success"?"text-green-500":l==="error"?"text-red-400 ":"text-blue-500";return jsxRuntimeExports.jsxs("div",{id:o,onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,className:`relative cursor-pointer z-[99999999] w-full m-2 my-8 min-w-sm md:max-w-sm rounded-lg overflow-hidden ${t} px-12 py-6 shadow-md animate-toast-slide-in transition-all duration-100 ease-out`,style:{pointerEvents:"auto"},children:[jsxRuntimeExports.jsx("button",{className:"absolute top-0  right-0 p-4 text-white cursor-pointer",onClick:this.handleOnClose,children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"h-5 w-4",children:jsxRuntimeExports.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})})}),jsxRuntimeExports.jsx("p",{className:"relative text-sm font-medium",children:jsxRuntimeExports.jsx("span",{className:`absolute -left-7 flex h-5 w-5 items-center justify-center rounded-xl bg-white ${a}`,children:l==="success"?jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"h-3 w-3",children:jsxRuntimeExports.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"})}):l==="error"?jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"h-3 w-3",children:jsxRuntimeExports.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})}):jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"h-5 w-4",children:jsxRuntimeExports.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})})})}),jsxRuntimeExports.jsx("p",{className:"text-sm ",children:A}),jsxRuntimeExports.jsx("div",{ref:this.setProgressBarRef,className:"absolute bottom-0 left-0 h-1 bg-white transition-all ease-linear"})]})}}const ToastContext=React2.createContext(void 0);class DesmyToastProvider extends React2.Component{state={toasts:[]};toastId=0;addToast=(A,l)=>{const o=this.toastId++;this.setState(t=>({toasts:[...t.toasts,{id:o,message:A,type:l}]}))};removeToast=A=>{const l=document.getElementById(`toast-${A}`);l&&(l.classList.remove("animate-toast-slide-in"),l.classList.add("animate-toast-slide-out"),setTimeout(()=>{this.setState(o=>({toasts:o.toasts.filter(t=>t.id!==A)}))},500))};componentDidMount(){DesmyToast.initialize(this)}render(){return jsxRuntimeExports.jsxs(ToastContext.Provider,{value:{addToast:this.addToast,removeToast:this.removeToast},children:[this.props.children,ReactDOM.createPortal(jsxRuntimeExports.jsx("div",{className:"fixed top-4 right-4 z-[9999999] space-y-4",children:this.state.toasts.map(A=>jsxRuntimeExports.jsx(Toast,{message:A.message,type:A.type,onClose:()=>this.removeToast(A.id),id:`toast-${A.id}`},A.id))}),document.getElementById("toast-root"))]})}}const useToast=()=>{const e=React2.useContext(ToastContext);if(!e)throw new Error("useToast must be used within a DesmyToastProvider");return e};var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var hasRequiredClassnames;function requireClassnames(){return hasRequiredClassnames||(hasRequiredClassnames=1,function(e){(function(){var A={}.hasOwnProperty;function l(){for(var a="",n=0;n<arguments.length;n++){var B=arguments[n];B&&(a=t(a,o(B)))}return a}function o(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return l.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var n="";for(var B in a)A.call(a,B)&&a[B]&&(n=t(n,B));return n}function t(a,n){return n?a?a+" "+n:a+n:a}e.exports?(l.default=l,e.exports=l):window.classNames=l})()}(classnames)),classnames.exports}var classnamesExports=requireClassnames();const classNames=getDefaultExportFromCjs(classnamesExports);class DesmyTabLayout extends React2.Component{constructor(A){super(A),this.state={activeTabIndex:0}}setActiveTab=A=>{this.setState({activeTabIndex:A})};render(){const{tabs:A,children:l}=this.props,{activeTabIndex:o}=this.state;return jsxRuntimeExports.jsx("div",{className:"w-full",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full",children:[jsxRuntimeExports.jsx("div",{className:"flex border-b border-gray-300",children:A.map((t,a)=>jsxRuntimeExports.jsxs("div",{onClick:()=>this.setActiveTab(a),className:classNames("py-2 px-4 cursor-pointer text-sm font-medium focus:outline-none transition-all flex items-center",{"border-b-2 border-blue-500 text-blue-500 dark:text-white dark:border-white":o===a,"text-gray-600 hover:text-blue-500 dark:hover:text-white":o!==a}),children:[t.icon&&jsxRuntimeExports.jsx("span",{className:"mr-2",children:t.icon}),t.label]},a))}),jsxRuntimeExports.jsx("div",{className:"mt-4",children:l[o]})]})})}}class UploadManager extends React2.Component{constructor(A){super(A),this.state={currentIndex:0,progress:0,uploading:!1,error:!1,errorMessage:"",cancelTokenSource:null}}componentDidMount(){this.startUpload()}startUpload=()=>{this.setState({uploading:!0,error:!1,errorMessage:""},()=>{this.uploadNext()})};completeUpload=async()=>{const{data:A}=this.props;try{const l=await axios.post(`${A?.complete_url}`,null,{headers:{"X-CSRFToken":`${DesmyAuth$1.getCookie("csrftoken")}`,Authorization:`Token ${this.props.data?.token}`}});l.data.success?(console.log("Upload process completed successfully."),this.props.onClose()):this.setState({error:!0,errorMessage:l.data.message})}catch{this.setState({error:!0,errorMessage:"Completion request failed"})}};uploadNext=async()=>{const{data:A}=this.props,l=A?.datalist,{currentIndex:o}=this.state;if(o>=l.length){this.setState({uploading:!1},()=>{this.props.data?.complete_url!=null?this.completeUpload():this.props.onClose()});return}try{const t=new FormData;Object.entries(l[o]).forEach(([n,B])=>{t.append(n,B)});const a=axios.CancelToken.source();this.setState({cancelTokenSource:a}),axios.post(this.props.data?.url,t,{headers:{"X-CSRFToken":`${DesmyAuth$1.getCookie("csrftoken")}`,Authorization:`Token ${this.props.data?.token}`},cancelToken:a.token}).then(n=>{if(n.data.success){const B=o+1,R=B/l.length*100;this.setState({currentIndex:B,progress:R},()=>{this.uploadNext()})}else this.setState({uploading:!1,error:!0,errorMessage:n.data.message})}).catch(n=>{axios.isCancel(n)?console.log("Upload canceled"):this.setState({uploading:!1,error:!0,errorMessage:n.response?.data?.message||"Upload failed"})})}catch(t){console.log(t),this.setState({uploading:!1,error:!0,errorMessage:t.message})}};resumeUpload=()=>{this.setState({error:!1,uploading:!0,errorMessage:""},()=>{this.uploadNext()})};cancelUpload=()=>{const{cancelTokenSource:A}=this.state;A&&A.cancel("Upload canceled by user"),this.setState({uploading:!1},()=>{this.props.onClose()})};skipUpload=()=>{const{currentIndex:A}=this.state,l=A+1,o=l/this.props.data?.datalist.length*100;this.setState({currentIndex:l,progress:o,error:!1,errorMessage:""},()=>{this.uploadNext()})};render(){const{uploading:A,progress:l,error:o,errorMessage:t,currentIndex:a}=this.state,{data:n}=this.props,B=n?.datalist,R=B&&B[a]?B[a][n.key_name??"name"]:"Unknown",r=B?B.length:0;return jsxRuntimeExports.jsx("div",{className:"my-5",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-darkDialogBackground dark:text-white relative border-[1px] border-gray-100 dark:border-darkPrimaryBorder shadow-md inset-1 rounded-lg p-6 w-full max-w-md",children:[jsxRuntimeExports.jsx("svg",{onClick:this.cancelUpload,viewBox:"0 0 512 512",fill:"currentColor",className:"absolute top-2 right-5 text-red-500 cursor-pointer w-5 h-5 flex-shrink-0",children:jsxRuntimeExports.jsx("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})}),jsxRuntimeExports.jsx("h2",{className:"w-full line-clamp-1 text-lg font-semibold mb-4",children:a<r?n?.title??"Upload Progress":"Finalizing Uploads"}),jsxRuntimeExports.jsx("div",{className:`w-full ${o?"bg-red-100 dark:bg-red-300":"bg-gray-200 dark:bg-darkBackground"} rounded-full h-2 mb-4`,children:jsxRuntimeExports.jsx("div",{className:`h-2 rounded-full transition-all ease-in-out duration-150 ${o?"bg-red-500 dark:bg-red-600":a<r?"bg-blue-500 dark:bg-white":"bg-blue-300 dark:bg-white animate-pulse"}`,style:{width:a<r?`${l}%`:"100%",transition:a<r?"width 0.2s ease":"none"}})}),jsxRuntimeExports.jsxs("div",{className:`${o?"text-red-500":"text-gray-700 dark:text-white"} space-y-1`,children:[a<r&&jsxRuntimeExports.jsxs("div",{className:"flex w-full justify-between items-center text-xs",children:[jsxRuntimeExports.jsx("div",{className:"w-full  line-clamp-1",children:R}),jsxRuntimeExports.jsxs("div",{className:"font-bold",children:["(",a+1,"/",r,")"]})]}),o&&jsxRuntimeExports.jsx("div",{className:"flex w-full justify-between items-center text-xs mb-4",children:jsxRuntimeExports.jsx("div",{children:t})})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end mt-2",children:[a<r&&jsxRuntimeExports.jsx("button",{className:"text-xs bg-red-300 text-red-600 px-5 py-3 rounded-full cursor-pointer hover:bg-red-600 hover:text-white mr-2",onClick:this.skipUpload,children:"Skip"}),o?jsxRuntimeExports.jsx("button",{className:"text-xs bg-red-300 text-red-600 px-5 py-3 rounded-full cursor-pointer hover:bg-red-600 hover:text-white mr-2",onClick:this.resumeUpload,children:"Retry"}):!A&&a<r&&jsxRuntimeExports.jsx("button",{className:"text-xs bg-blue-300 text-blue-600 dark:bg-white dark:text-black dark:hover:bg-white px-5 py-3 rounded-full cursor-pointer hover:bg-blue-600 hover:text-white mr-2",onClick:this.startUpload,children:"Start Upload"})]})]})})}}class DesmyUploadManager extends React2.Component{modalContainerRef=React2.createRef();subscription;constructor(A){super(A),this.state={dataList:[],modals:[],modalId:1},this.modalContainerRef=React2.createRef()}async componentDidMount(){this.subscription=DesmyRxServices.getSubscription().subscribe(A=>{A.type!==void 0&&A.type===DesmyState.UPLOAD_MANAGER_REQUEST&&this.addNewModal(A.data)})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}addNewModal=A=>{const l=this.state.modalId;this.setState(o=>({modals:[{id:l,data:A||[...o.dataList]},...o.modals],modalId:o.modalId+1}),()=>{this.modalContainerRef.current&&this.modalContainerRef.current.scrollTo({top:0,behavior:"smooth"})})};closeModal=A=>{this.setState(l=>({modals:l.modals.filter(o=>o.id!==A)}))};render(){const{modals:A}=this.state,{className:l}=this.props;return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:ReactDOM.createPortal(jsxRuntimeExports.jsx("div",{ref:this.modalContainerRef,className:`fixed right-2 bottom-6 z-[10000] w-full md:w-[500px]  lg:w-[500px] max-h-[90vh]  overflow-y-auto ${l}`,style:{scrollbarWidth:"thin",scrollbarColor:"#888 #f5f5f5"},children:A.map(o=>jsxRuntimeExports.jsx("div",{className:"w-full mb-4",children:jsxRuntimeExports.jsx(UploadManager,{data:o.data,onClose:()=>this.closeModal(o.id)})},o.id))}),document.getElementById("uploadmanager-root"))})}}const xml={createDocument:function e(A){return new DOMParser().parseFromString(A.trim(),"text/xml")}};var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(e,A){for(var l=new u16(31),o=0;o<31;++o)l[o]=A+=1<<e[o-1];for(var t=new u32(l[30]),o=1;o<30;++o)for(var a=l[o];a<l[o+1];++a)t[a]=a-l[o]<<5|o;return[l,t]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;for(var _b=freb(fdeb,0),fd=_b[0],rev=new u16(32768),i=0;i<32768;++i){var x=(i&43690)>>>1|(i&21845)<<1;x=(x&52428)>>>2|(x&13107)<<2,x=(x&61680)>>>4|(x&3855)<<4,rev[i]=((x&65280)>>>8|(x&255)<<8)>>>1}for(var hMap=function(e,A,l){for(var o=e.length,t=0,a=new u16(A);t<o;++t)e[t]&&++a[e[t]-1];var n=new u16(A);for(t=0;t<A;++t)n[t]=n[t-1]+a[t-1]<<1;var B;if(l){B=new u16(1<<A);var R=15-A;for(t=0;t<o;++t)if(e[t])for(var r=t<<4|e[t],H=A-e[t],II=n[e[t]-1]++<<H,k=II|(1<<H)-1;II<=k;++II)B[rev[II]>>>R]=r}else for(B=new u16(o),t=0;t<o;++t)e[t]&&(B[t]=rev[n[e[t]-1]++]>>>15-e[t]);return B},flt=new u8(288),i=0;i<144;++i)flt[i]=8;for(var i=144;i<256;++i)flt[i]=9;for(var i=256;i<280;++i)flt[i]=7;for(var i=280;i<288;++i)flt[i]=8;for(var fdt=new u8(32),i=0;i<32;++i)fdt[i]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max=function(e){for(var A=e[0],l=1;l<e.length;++l)e[l]>A&&(A=e[l]);return A},bits=function(e,A,l){var o=A/8|0;return(e[o]|e[o+1]<<8)>>(A&7)&l},bits16=function(e,A){var l=A/8|0;return(e[l]|e[l+1]<<8|e[l+2]<<16)>>(A&7)},shft=function(e){return(e+7)/8|0},slc=function(e,A,l){(A==null||A<0)&&(A=0),(l==null||l>e.length)&&(l=e.length);var o=new(e.BYTES_PER_ELEMENT==2?u16:e.BYTES_PER_ELEMENT==4?u32:u8)(l-A);return o.set(e.subarray(A,l)),o},ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],err=function(e,A,l){var o=new Error(A||ec[e]);if(o.code=e,Error.captureStackTrace&&Error.captureStackTrace(o,err),!l)throw o;return o},inflt=function(e,A,l){var o=e.length;if(!o||l&&l.f&&!l.l)return A||new u8(0);var t=!A||l,a=!l||l.i;l||(l={}),A||(A=new u8(o*3));var n=function(mI){var YI=A.length;if(mI>YI){var BI=new u8(Math.max(YI*2,mI));BI.set(A),A=BI}},B=l.f||0,R=l.p||0,r=l.b||0,H=l.l,II=l.d,k=l.m,iI=l.n,lI=o*8;do{if(!H){B=bits(e,R,1);var CI=bits(e,R+1,3);if(R+=3,CI)if(CI==1)H=flrm,II=fdrm,k=9,iI=5;else if(CI==2){var _=bits(e,R,31)+257,gI=bits(e,R+10,15)+4,M=_+bits(e,R+5,31)+1;R+=14;for(var O=new u8(M),dI=new u8(19),eI=0;eI<gI;++eI)dI[clim[eI]]=bits(e,R+eI*3,7);R+=gI*3;for(var aI=max(dI),WI=(1<<aI)-1,GI=hMap(dI,aI,1),eI=0;eI<M;){var HI=GI[bits(e,R,WI)];R+=HI&15;var sI=HI>>>4;if(sI<16)O[eI++]=sI;else{var MI=0,KI=0;for(sI==16?(KI=3+bits(e,R,3),R+=2,MI=O[eI-1]):sI==17?(KI=3+bits(e,R,7),R+=3):sI==18&&(KI=11+bits(e,R,127),R+=7);KI--;)O[eI++]=MI}}var DI=O.subarray(0,_),NI=O.subarray(_);k=max(DI),iI=max(NI),H=hMap(DI,k,1),II=hMap(NI,iI,1)}else err(1);else{var sI=shft(R)+4,oI=e[sI-4]|e[sI-3]<<8,E=sI+oI;if(E>o){a&&err(0);break}t&&n(r+oI),A.set(e.subarray(sI,E),r),l.b=r+=oI,l.p=R=E*8,l.f=B;continue}if(R>lI){a&&err(0);break}}t&&n(r+131072);for(var yI=(1<<k)-1,VI=(1<<iI)-1,hI=R;;hI=R){var MI=H[bits16(e,R)&yI],wI=MI>>>4;if(R+=MI&15,R>lI){a&&err(0);break}if(MI||err(2),wI<256)A[r++]=wI;else if(wI==256){hI=R,H=null;break}else{var pI=wI-254;if(wI>264){var eI=wI-257,xI=fleb[eI];pI=bits(e,R,(1<<xI)-1)+fl[eI],R+=xI}var PI=II[bits16(e,R)&VI],XI=PI>>>4;PI||err(3),R+=PI&15;var NI=fd[XI];if(XI>3){var xI=fdeb[XI];NI+=bits16(e,R)&(1<<xI)-1,R+=xI}if(R>lI){a&&err(0);break}t&&n(r+131072);for(var tI=r+pI;r<tI;r+=4)A[r]=A[r-NI],A[r+1]=A[r+1-NI],A[r+2]=A[r+2-NI],A[r+3]=A[r+3-NI];r=tI}}l.l=H,l.p=hI,l.b=r,l.f=B,H&&(B=1,l.m=k,l.d=II,l.n=iI)}while(!B);return r==A.length?A:slc(A,0,r)},et=new u8(0),b2=function(e,A){return e[A]|e[A+1]<<8},b4=function(e,A){return(e[A]|e[A+1]<<8|e[A+2]<<16|e[A+3]<<24)>>>0},b8=function(e,A){return b4(e,A)+b4(e,A+4)*4294967296};function inflateSync(e,A){return inflt(e,A)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch(e){}var dutf8=function(e){for(var A="",l=0;;){var o=e[l++],t=(o>127)+(o>223)+(o>239);if(l+t>e.length)return[A,slc(e,l-1)];t?t==3?(o=((o&15)<<18|(e[l++]&63)<<12|(e[l++]&63)<<6|e[l++]&63)-65536,A+=String.fromCharCode(55296|o>>10,56320|o&1023)):t&1?A+=String.fromCharCode((o&31)<<6|e[l++]&63):A+=String.fromCharCode((o&15)<<12|(e[l++]&63)<<6|e[l++]&63):A+=String.fromCharCode(o)}};function strFromU8(e,A){if(A){for(var l="",o=0;o<e.length;o+=16384)l+=String.fromCharCode.apply(null,e.subarray(o,o+16384));return l}else{if(td)return td.decode(e);var t=dutf8(e),a=t[0],n=t[1];return n.length&&err(8),a}}var slzh=function(e,A){return A+30+b2(e,A+26)+b2(e,A+28)},zh=function(e,A,l){var o=b2(e,A+28),t=strFromU8(e.subarray(A+46,A+46+o),!(b2(e,A+8)&2048)),a=A+46+o,n=b4(e,A+20),B=l&&n==4294967295?z64e(e,a):[n,b4(e,A+24),b4(e,A+42)],R=B[0],r=B[1],H=B[2];return[b2(e,A+10),R,r,t,a+b2(e,A+30)+b2(e,A+32),H]},z64e=function(e,A){for(;b2(e,A)!=1;A+=4+b2(e,A+2));return[b8(e,A+12),b8(e,A+4),b8(e,A+20)]};function unzipSync(e,A){for(var l={},o=e.length-22;b4(e,o)!=101010256;--o)(!o||e.length-o>65558)&&err(13);var t=b2(e,o+8);if(!t)return{};var a=b4(e,o+16),n=a==4294967295||t==65535;if(n){var B=b4(e,o-12);n=b4(e,B)==101075792,n&&(t=b4(e,B+32),a=b4(e,B+48))}for(var R=0;R<t;++R){var r=zh(e,a,n),H=r[0],II=r[1],k=r[2],iI=r[3],lI=r[4],CI=r[5],sI=slzh(e,CI);a=lI,H?H==8?l[iI]=inflateSync(e.subarray(sI,sI+II),new u8(k)):err(14,"unknown compression type "+H):l[iI]=slc(e,sI,sI+II)}return l}function unpackXlsxFile(e){return e instanceof File||e instanceof Blob?e.arrayBuffer().then(unpackXlsxArrayBuffer):unpackXlsxArrayBuffer(e)}function unpackXlsxArrayBuffer(e){var A=new Uint8Array(e),l=unzipSync(A);return Promise.resolve(getContents(l))}function getContents(e){for(var A=[],l=0,o=Object.keys(e);l<o.length;l++){var t=o[l];A[t]=strFromU8(e[t])}return A}function findChild(e,A){for(var l=0;l<e.childNodes.length;){var o=e.childNodes[l];if(o.nodeType===1&&getTagName(o)===A)return o;l++}}function findChildren(e,A){for(var l=[],o=0;o<e.childNodes.length;){var t=e.childNodes[o];t.nodeType===1&&getTagName(t)===A&&l.push(t),o++}return l}function forEach(e,A,l){for(var o=0;o<e.childNodes.length;){var t=e.childNodes[o];A?t.nodeType===1&&getTagName(t)===A&&l(t,o):l(t,o),o++}}function map(e,A,l){var o=[];return forEach(e,A,function(t,a){o.push(l(t,a))}),o}var NAMESPACE_REG_EXP=/.+\:/;function getTagName(e){return e.tagName.replace(NAMESPACE_REG_EXP,"")}function getOuterXml(e){if(e.nodeType!==1)return e.textContent;for(var A="<"+getTagName(e),l=0;l<e.attributes.length;)A+=" "+e.attributes[l].name+'="'+e.attributes[l].value+'"',l++;A+=">";for(var o=0;o<e.childNodes.length;)A+=getOuterXml(e.childNodes[o]),o++;return A+="</"+getTagName(e)+">",A}function getCells(e){var A=e.documentElement,l=findChild(A,"sheetData"),o=[];return forEach(l,"row",function(t){forEach(t,"c",function(a){o.push(a)})}),o}function getCellValue(e,A){return findChild(A,"v")}function getCellInlineStringValue(e,A){if(A.firstChild&&getTagName(A.firstChild)==="is"&&A.firstChild.firstChild&&getTagName(A.firstChild.firstChild)==="t")return A.firstChild.firstChild.textContent}function getDimensions(e){var A=e.documentElement,l=findChild(A,"dimension");if(l)return l.getAttribute("ref")}function getBaseStyles(e){var A=e.documentElement,l=findChild(A,"cellStyleXfs");return l?findChildren(l,"xf"):[]}function getCellStyles(e){var A=e.documentElement,l=findChild(A,"cellXfs");return l?findChildren(l,"xf"):[]}function getNumberFormats(e){var A=e.documentElement,l=findChild(A,"numFmts");return l?findChildren(l,"numFmt"):[]}function getSharedStrings(e){var A=e.documentElement;return map(A,"si",function(l){var o=findChild(l,"t");if(o)return o.textContent;var t="";return forEach(l,"r",function(a){t+=findChild(a,"t").textContent}),t})}function getWorkbookProperties(e){var A=e.documentElement;return findChild(A,"workbookPr")}function getRelationships(e){var A=e.documentElement;return findChildren(A,"Relationship")}function getSheets(e){var A=e.documentElement,l=findChild(A,"sheets");return findChildren(l,"sheet")}function parseProperties(e,A){var l=A.createDocument(e),o={},t=getWorkbookProperties(l);t&&t.getAttribute("date1904")==="1"&&(o.epoch1904=!0),o.sheets=[];var a=function(B){B.getAttribute("name")&&o.sheets.push({id:B.getAttribute("sheetId"),name:B.getAttribute("name"),relationId:B.getAttribute("r:id")})};return getSheets(l).forEach(a),o}function parseFilePaths(e,A){var l=A.createDocument(e),o={sheets:{},sharedStrings:void 0,styles:void 0},t=function(n){var B=n.getAttribute("Target"),R=n.getAttribute("Type");switch(R){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":o.styles=getFilePath(B);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":o.sharedStrings=getFilePath(B);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":o.sheets[n.getAttribute("Id")]=getFilePath(B);break}};return getRelationships(l).forEach(t),o}function getFilePath(e){return e[0]==="/"?e.slice(1):"xl/"+e}function _typeof$7(e){"@babel/helpers - typeof";return _typeof$7=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},_typeof$7(e)}function ownKeys$5(e,A){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);A&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),l.push.apply(l,o)}return l}function _objectSpread$5(e){for(var A=1;A<arguments.length;A++){var l=arguments[A]!=null?arguments[A]:{};A%2?ownKeys$5(Object(l),!0).forEach(function(o){_defineProperty$5(e,o,l[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):ownKeys$5(Object(l)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(l,o))})}return e}function _defineProperty$5(e,A,l){return A=_toPropertyKey$5(A),A in e?Object.defineProperty(e,A,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[A]=l,e}function _toPropertyKey$5(e){var A=_toPrimitive$5(e,"string");return _typeof$7(A)==="symbol"?A:String(A)}function _toPrimitive$5(e,A){if(_typeof$7(e)!=="object"||e===null)return e;var l=e[Symbol.toPrimitive];if(l!==void 0){var o=l.call(e,A);if(_typeof$7(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(e)}function parseStyles(e,A){if(!e)return{};var l=A.createDocument(e),o=getBaseStyles(l).map(parseCellStyle),t=getNumberFormats(l).map(parseNumberFormatStyle).reduce(function(n,B){return n[B.id]=B,n},[]),a=function(B){return B.hasAttribute("xfId")?_objectSpread$5(_objectSpread$5({},o[B.xfId]),parseCellStyle(B,t)):parseCellStyle(B,t)};return getCellStyles(l).map(a)}function parseNumberFormatStyle(e){return{id:e.getAttribute("numFmtId"),template:e.getAttribute("formatCode")}}function parseCellStyle(e,A){var l={};if(e.hasAttribute("numFmtId")){var o=e.getAttribute("numFmtId");A[o]?l.numberFormat=A[o]:l.numberFormat={id:o}}return l}function parseSharedStrings(e,A){return e?getSharedStrings(A.createDocument(e)):[]}function parseExcelDate(e,A){A&&A.epoch1904&&(e+=1462);var l=70*365+19,o=60*60*1e3;return new Date(Math.round((e-l)*24*o))}function _createForOfIteratorHelperLoose$5(e,A){var l=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(l)return(l=l.call(e)).next.bind(l);if(Array.isArray(e)||(l=_unsupportedIterableToArray$6(e))||A){l&&(e=l);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$6(e,A){if(e){if(typeof e=="string")return _arrayLikeToArray$6(e,A);var l=Object.prototype.toString.call(e).slice(8,-1);if(l==="Object"&&e.constructor&&(l=e.constructor.name),l==="Map"||l==="Set")return Array.from(e);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return _arrayLikeToArray$6(e,A)}}function _arrayLikeToArray$6(e,A){(A==null||A>e.length)&&(A=e.length);for(var l=0,o=new Array(A);l<A;l++)o[l]=e[l];return o}function isDateTimestamp(e,A,l){if(e){var o=A[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(BUILT_IN_DATE_NUMBER_FORMAT_IDS.indexOf(Number(o.numberFormat.id))>=0||l.dateFormat&&o.numberFormat.template===l.dateFormat||l.smartDateParser!==!1&&o.numberFormat.template&&isDateTemplate(o.numberFormat.template))return!0}}var BUILT_IN_DATE_NUMBER_FORMAT_IDS=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],DATE_FORMAT_WEIRD_PREFIX=/^\[\$-414\]/,DATE_FORMAT_WEIRD_POSTFIX=/;@$/;function isDateTemplate(e){e=e.toLowerCase(),e=e.replace(DATE_FORMAT_WEIRD_PREFIX,""),e=e.replace(DATE_FORMAT_WEIRD_POSTFIX,"");for(var A=e.split(/\W+/),l=_createForOfIteratorHelperLoose$5(A),o;!(o=l()).done;){var t=o.value;if(DATE_TEMPLATE_TOKENS.indexOf(t)<0)return!1}return!0}var DATE_TEMPLATE_TOKENS=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function parseCellValue(e,A,l){var o=l.getInlineStringValue,t=l.getInlineStringXml,a=l.getStyleId,n=l.styles,B=l.values,R=l.properties,r=l.options;switch(A||(A="n"),A){case"str":e=parseString(e,r);break;case"inlineStr":if(e=o(),e===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(t()));e=parseString(e,r);break;case"s":var H=Number(e);if(isNaN(H))throw new Error('Invalid "shared" string index: '.concat(e));if(H>=B.length)throw new Error('An out-of-bounds "shared" string index: '.concat(e));e=B[H],e=parseString(e,r);break;case"b":if(e==="1")e=!0;else if(e==="0")e=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(e));break;case"z":e=void 0;break;case"e":e=decodeError(e);break;case"d":if(e===void 0)break;var II=new Date(e);if(isNaN(II.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(e));e=II;break;case"n":if(e===void 0)break;var k=isDateTimestamp(a(),n,r);k?(e=parseNumberDefault(e),e=parseExcelDate(e,R)):e=(r.parseNumber||parseNumberDefault)(e);break;default:throw new TypeError("Cell type not supported: ".concat(A))}return e===void 0&&(e=null),e}function decodeError(e){switch(e){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(e)}}function parseString(e,A){return A.trim!==!1&&(e=e.trim()),e===""&&(e=void 0),e}function parseNumberDefault(e){var A=Number(e);if(isNaN(A))throw new Error('Invalid "numeric" cell value: '.concat(e));return A}var LETTERS=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function calculateDimensions(e){var A=function(r,H){return r-H},l=e.map(function(R){return R.row}).sort(A),o=e.map(function(R){return R.column}).sort(A),t=l[0],a=l[l.length-1],n=o[0],B=o[o.length-1];return[{row:t,column:n},{row:a,column:B}]}function columnLettersToNumber(e){for(var A=0,l=0;l<e.length;)A*=26,A+=LETTERS.indexOf(e[l]),l++;return A}function parseCellCoordinates(e){return e=e.split(/(\d+)/),[parseInt(e[1]),columnLettersToNumber(e[0].trim())]}function parseCell(e,A,l,o,t,a,n){var B=parseCellCoordinates(e.getAttribute("r")),R=getCellValue(A,e),r=R&&R.textContent,H;return e.hasAttribute("t")&&(H=e.getAttribute("t")),{row:B[0],column:B[1],value:parseCellValue(r,H,{getInlineStringValue:function(){return getCellInlineStringValue(A,e)},getInlineStringXml:function(){return getOuterXml(e)},getStyleId:function(){return e.getAttribute("s")},styles:t,values:o,properties:a,options:n})}}function parseCells(e,A,l,o,t,a){var n=getCells(e);return n.length===0?[]:n.map(function(B){return parseCell(B,e,A,l,o,t,a)})}function _slicedToArray$2(e,A){return _arrayWithHoles$2(e)||_iterableToArrayLimit$2(e,A)||_unsupportedIterableToArray$5(e,A)||_nonIterableRest$2()}function _nonIterableRest$2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$5(e,A){if(e){if(typeof e=="string")return _arrayLikeToArray$5(e,A);var l=Object.prototype.toString.call(e).slice(8,-1);if(l==="Object"&&e.constructor&&(l=e.constructor.name),l==="Map"||l==="Set")return Array.from(e);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return _arrayLikeToArray$5(e,A)}}function _arrayLikeToArray$5(e,A){(A==null||A>e.length)&&(A=e.length);for(var l=0,o=new Array(A);l<A;l++)o[l]=e[l];return o}function _iterableToArrayLimit$2(e,A){var l=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(l!=null){var o,t,a,n,B=[],R=!0,r=!1;try{if(a=(l=l.call(e)).next,A!==0)for(;!(R=(o=a.call(l)).done)&&(B.push(o.value),B.length!==A);R=!0);}catch(H){r=!0,t=H}finally{try{if(!R&&l.return!=null&&(n=l.return(),Object(n)!==n))return}finally{if(r)throw t}}return B}}function _arrayWithHoles$2(e){if(Array.isArray(e))return e}function parseDimensions(e){var A=getDimensions(e);if(A)return A=A.split(":").map(parseCellCoordinates).map(function(l){var o=_slicedToArray$2(l,2),t=o[0],a=o[1];return{row:t,column:a}}),A.length===1&&(A=[A[0],A[0]]),A}function parseSheet(e,A,l,o,t,a){var n=A.createDocument(e),B=parseCells(n,A,l,o,t,a),R=parseDimensions(n)||calculateDimensions(B);return{cells:B,dimensions:R}}function _createForOfIteratorHelperLoose$4(e,A){var l=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(l)return(l=l.call(e)).next.bind(l);if(Array.isArray(e)||(l=_unsupportedIterableToArray$4(e))||A){l&&(e=l);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$4(e,A){if(e){if(typeof e=="string")return _arrayLikeToArray$4(e,A);var l=Object.prototype.toString.call(e).slice(8,-1);if(l==="Object"&&e.constructor&&(l=e.constructor.name),l==="Map"||l==="Set")return Array.from(e);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return _arrayLikeToArray$4(e,A)}}function _arrayLikeToArray$4(e,A){(A==null||A>e.length)&&(A=e.length);for(var l=0,o=new Array(A);l<A;l++)o[l]=e[l];return o}function dropEmptyRows(e){for(var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=A.rowIndexMap,o=A.accessor,t=o===void 0?function(II){return II}:o,a=A.onlyTrimAtTheEnd,n=e.length-1;n>=0;){for(var B=!0,R=_createForOfIteratorHelperLoose$4(e[n]),r;!(r=R()).done;){var H=r.value;if(t(H)!==null){B=!1;break}}if(B)e.splice(n,1),l&&l.splice(n,1);else if(a)break;n--}return e}function _createForOfIteratorHelperLoose$3(e,A){var l=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(l)return(l=l.call(e)).next.bind(l);if(Array.isArray(e)||(l=_unsupportedIterableToArray$3(e))||A){l&&(e=l);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$3(e,A){if(e){if(typeof e=="string")return _arrayLikeToArray$3(e,A);var l=Object.prototype.toString.call(e).slice(8,-1);if(l==="Object"&&e.constructor&&(l=e.constructor.name),l==="Map"||l==="Set")return Array.from(e);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return _arrayLikeToArray$3(e,A)}}function _arrayLikeToArray$3(e,A){(A==null||A>e.length)&&(A=e.length);for(var l=0,o=new Array(A);l<A;l++)o[l]=e[l];return o}function dropEmptyColumns(e){for(var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=A.accessor,o=l===void 0?function(II){return II}:l,t=A.onlyTrimAtTheEnd,a=e[0].length-1;a>=0;){for(var n=!0,B=_createForOfIteratorHelperLoose$3(e),R;!(R=B()).done;){var r=R.value;if(o(r[a])!==null){n=!1;break}}if(n)for(var H=0;H<e.length;)e[H].splice(a,1),H++;else if(t)break;a--}return e}function _createForOfIteratorHelperLoose$2(e,A){var l=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(l)return(l=l.call(e)).next.bind(l);if(Array.isArray(e)||(l=_unsupportedIterableToArray$2(e))||A){l&&(e=l);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray$1(e,A){return _arrayWithHoles$1(e)||_iterableToArrayLimit$1(e,A)||_unsupportedIterableToArray$2(e,A)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$2(e,A){if(e){if(typeof e=="string")return _arrayLikeToArray$2(e,A);var l=Object.prototype.toString.call(e).slice(8,-1);if(l==="Object"&&e.constructor&&(l=e.constructor.name),l==="Map"||l==="Set")return Array.from(e);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return _arrayLikeToArray$2(e,A)}}function _arrayLikeToArray$2(e,A){(A==null||A>e.length)&&(A=e.length);for(var l=0,o=new Array(A);l<A;l++)o[l]=e[l];return o}function _iterableToArrayLimit$1(e,A){var l=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(l!=null){var o,t,a,n,B=[],R=!0,r=!1;try{if(a=(l=l.call(e)).next,A!==0)for(;!(R=(o=a.call(l)).done)&&(B.push(o.value),B.length!==A);R=!0);}catch(H){r=!0,t=H}finally{try{if(!R&&l.return!=null&&(n=l.return(),Object(n)!==n))return}finally{if(r)throw t}}return B}}function _arrayWithHoles$1(e){if(Array.isArray(e))return e}function getData(e,A){var l=e.dimensions,o=e.cells;if(o.length===0)return[];var t=_slicedToArray$1(l,2);t[0];for(var a=t[1],n=a.column,B=a.row,R=new Array(B),r=0;r<B;){R[r]=new Array(n);for(var H=0;H<n;)R[r][H]=null,H++;r++}for(var II=_createForOfIteratorHelperLoose$2(o),k;!(k=II()).done;){var iI=k.value,lI=iI.row-1,CI=iI.column-1;CI<n&&lI<B&&(R[lI][CI]=iI.value)}var sI=A.rowMap;if(sI)for(var oI=0;oI<R.length;)sI[oI]=oI,oI++;return R=dropEmptyRows(dropEmptyColumns(R,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowIndexMap:sI}),A.transformData&&(R=A.transformData(R)),R}function _typeof$6(e){"@babel/helpers - typeof";return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},_typeof$6(e)}function _createForOfIteratorHelperLoose$1(e,A){var l=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(l)return(l=l.call(e)).next.bind(l);if(Array.isArray(e)||(l=_unsupportedIterableToArray$1(e))||A){l&&(e=l);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(e,A){if(e){if(typeof e=="string")return _arrayLikeToArray$1(e,A);var l=Object.prototype.toString.call(e).slice(8,-1);if(l==="Object"&&e.constructor&&(l=e.constructor.name),l==="Map"||l==="Set")return Array.from(e);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return _arrayLikeToArray$1(e,A)}}function _arrayLikeToArray$1(e,A){(A==null||A>e.length)&&(A=e.length);for(var l=0,o=new Array(A);l<A;l++)o[l]=e[l];return o}function ownKeys$4(e,A){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);A&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),l.push.apply(l,o)}return l}function _objectSpread$4(e){for(var A=1;A<arguments.length;A++){var l=arguments[A]!=null?arguments[A]:{};A%2?ownKeys$4(Object(l),!0).forEach(function(o){_defineProperty$4(e,o,l[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):ownKeys$4(Object(l)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(l,o))})}return e}function _defineProperty$4(e,A,l){return A=_toPropertyKey$4(A),A in e?Object.defineProperty(e,A,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[A]=l,e}function _toPropertyKey$4(e){var A=_toPrimitive$4(e,"string");return _typeof$6(A)==="symbol"?A:String(A)}function _toPrimitive$4(e,A){if(_typeof$6(e)!=="object"||e===null)return e;var l=e[Symbol.toPrimitive];if(l!==void 0){var o=l.call(e,A);if(_typeof$6(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(e)}function readXlsx(e,A){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};l.sheet||(l=_objectSpread$4({sheet:1},l));var o=function(k){if(!e[k])throw new Error('"'.concat(k,'" file not found inside the *.xlsx file zip archive'));return e[k]},t=parseFilePaths(o("xl/_rels/workbook.xml.rels"),A),a=t.sharedStrings?parseSharedStrings(o(t.sharedStrings),A):[],n=t.styles?parseStyles(o(t.styles),A):{},B=parseProperties(o("xl/workbook.xml"),A);if(l.getSheets)return B.sheets.map(function(II){var k=II.name;return{name:k}});var R=getSheetId(l.sheet,B.sheets);if(!R||!t.sheets[R])throw createSheetNotFoundError(l.sheet,B.sheets);var r=parseSheet(o(t.sheets[R]),A,a,n,B,l);l=_objectSpread$4({rowMap:[]},l);var H=getData(r,l);return l.properties?{data:H,properties:B}:H}function getSheetId(e,A){if(typeof e=="number"){var l=A[e-1];return l&&l.relationId}for(var o=_createForOfIteratorHelperLoose$1(A),t;!(t=o()).done;){var a=t.value;if(a.name===e)return a.relationId}}function createSheetNotFoundError(e,A){var l=A&&A.map(function(o,t){return'"'.concat(o.name,'" (#').concat(t+1,")")}).join(", ");return new Error("Sheet ".concat(typeof e=="number"?"#"+e:'"'+e+'"'," not found in the *.xlsx file.").concat(A?" Available sheets: "+l+".":""))}function _typeof$5(e){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},_typeof$5(e)}function _createClass(e,A,l){return Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,A){if(!(e instanceof A))throw new TypeError("Cannot call a class as a function")}function _inherits(e,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(A&&A.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),A&&_setPrototypeOf(e,A)}function _createSuper(e){var A=_isNativeReflectConstruct();return function(){var o=_getPrototypeOf(e),t;if(A){var a=_getPrototypeOf(this).constructor;t=Reflect.construct(o,arguments,a)}else t=o.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,A){if(A&&(_typeof$5(A)==="object"||typeof A=="function"))return A;if(A!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _wrapNativeSuper(e){var A=typeof Map=="function"?new Map:void 0;return _wrapNativeSuper=function(o){if(o===null||!_isNativeFunction(o))return o;if(typeof o!="function")throw new TypeError("Super expression must either be null or a function");if(typeof A<"u"){if(A.has(o))return A.get(o);A.set(o,t)}function t(){return _construct(o,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(o.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,o)},_wrapNativeSuper(e)}function _construct(e,A,l){return _isNativeReflectConstruct()?_construct=Reflect.construct.bind():_construct=function(t,a,n){var B=[null];B.push.apply(B,a);var R=Function.bind.apply(t,B),r=new R;return n&&_setPrototypeOf(r,n.prototype),r},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _isNativeFunction(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function _setPrototypeOf(e,A){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,t){return o.__proto__=t,o},_setPrototypeOf(e,A)}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(l){return l.__proto__||Object.getPrototypeOf(l)},_getPrototypeOf(e)}var InvalidError=function(e){_inherits(l,e);var A=_createSuper(l);function l(o){var t;return _classCallCheck(this,l),t=A.call(this,"invalid"),t.reason=o,t}return _createClass(l)}(_wrapNativeSuper(Error));function NumberType(e){if(typeof e=="string"){var A=e;if(e=Number(e),String(e)!==A)throw new InvalidError("not_a_number")}if(typeof e!="number")throw new InvalidError("not_a_number");if(isNaN(e))throw new InvalidError("invalid_number");if(!isFinite(e))throw new InvalidError("out_of_bounds");return e}function StringType(e){if(typeof e=="string")return e;if(typeof e=="number"){if(isNaN(e))throw new InvalidError("invalid_number");if(!isFinite(e))throw new InvalidError("out_of_bounds");return String(e)}throw new InvalidError("not_a_string")}function BooleanType(e){if(typeof e=="boolean")return e;throw new InvalidError("not_a_boolean")}function DateType(e,A){var l=A.properties;if(e instanceof Date){if(isNaN(e.valueOf()))throw new InvalidError("out_of_bounds");return e}if(typeof e=="number"){if(isNaN(e))throw new InvalidError("invalid_number");if(!isFinite(e))throw new InvalidError("out_of_bounds");var o=parseExcelDate(e,l);if(isNaN(o.valueOf()))throw new InvalidError("out_of_bounds");return o}throw new InvalidError("not_a_date")}function _slicedToArray(e,A){return _arrayWithHoles(e)||_iterableToArrayLimit(e,A)||_unsupportedIterableToArray(e,A)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit(e,A){var l=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(l!=null){var o,t,a,n,B=[],R=!0,r=!1;try{if(a=(l=l.call(e)).next,A!==0)for(;!(R=(o=a.call(l)).done)&&(B.push(o.value),B.length!==A);R=!0);}catch(H){r=!0,t=H}finally{try{if(!R&&l.return!=null&&(n=l.return(),Object(n)!==n))return}finally{if(r)throw t}}return B}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof$4(e){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},_typeof$4(e)}function _createForOfIteratorHelperLoose(e,A){var l=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(l)return(l=l.call(e)).next.bind(l);if(Array.isArray(e)||(l=_unsupportedIterableToArray(e))||A){l&&(e=l);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(e,A){if(e){if(typeof e=="string")return _arrayLikeToArray(e,A);var l=Object.prototype.toString.call(e).slice(8,-1);if(l==="Object"&&e.constructor&&(l=e.constructor.name),l==="Map"||l==="Set")return Array.from(e);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return _arrayLikeToArray(e,A)}}function _arrayLikeToArray(e,A){(A==null||A>e.length)&&(A=e.length);for(var l=0,o=new Array(A);l<A;l++)o[l]=e[l];return o}function ownKeys$3(e,A){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);A&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),l.push.apply(l,o)}return l}function _objectSpread$3(e){for(var A=1;A<arguments.length;A++){var l=arguments[A]!=null?arguments[A]:{};A%2?ownKeys$3(Object(l),!0).forEach(function(o){_defineProperty$3(e,o,l[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):ownKeys$3(Object(l)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(l,o))})}return e}function _defineProperty$3(e,A,l){return A=_toPropertyKey$3(A),A in e?Object.defineProperty(e,A,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[A]=l,e}function _toPropertyKey$3(e){var A=_toPrimitive$3(e,"string");return _typeof$4(A)==="symbol"?A:String(A)}function _toPrimitive$3(e,A){if(_typeof$4(e)!=="object"||e===null)return e;var l=e[Symbol.toPrimitive];if(l!==void 0){var o=l.call(e,A);if(_typeof$4(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(e)}var DEFAULT_OPTIONS={schemaPropertyValueForMissingColumn:void 0,schemaPropertyValueForUndefinedCellValue:void 0,schemaPropertyValueForNullCellValue:null,schemaPropertyShouldSkipRequiredValidationForMissingColumn:function e(){return!1},getEmptyObjectValue:function e(){return null},getEmptyArrayValue:function e(){return null},isColumnOriented:!1,arrayValueSeparator:","};function mapToObjects(e,A,l){l?l=_objectSpread$3(_objectSpread$3({},DEFAULT_OPTIONS),l):l=DEFAULT_OPTIONS;var o=l,t=o.isColumnOriented,a=o.rowIndexMap;validateSchema(A),t&&(e=transpose(e));for(var n=e[0],B=[],R=[],r=1;r<e.length;r++){var H=read(A,e[r],r,void 0,n,R,l);B.push(H)}if(a)for(var II=_createForOfIteratorHelperLoose(R),k;!(k=II()).done;){var iI=k.value;iI.row=a[iI.row-1]+1}return{rows:B,errors:R}}function read(e,A,l,o,t,a,n){for(var B={},R=!0,r=function(eI){var aI=eI.column,WI=eI.value,GI=eI.error,HI=eI.reason,MI={error:GI,row:l+1,column:aI,value:WI};return HI&&(MI.reason=HI),e[aI].type&&(MI.type=e[aI].type),MI},H=[],II=function(){var eI=iI[k],aI=e[eI],WI=_typeof$4(aI.type)==="object"&&!Array.isArray(aI.type),GI="".concat(o||"",".").concat(aI.prop),HI,MI=t.indexOf(eI),KI=MI<0;KI||(HI=A[MI]);var DI,NI,yI;if(WI)DI=read(aI.type,A,l,GI,t,a,n);else if(KI)DI=n.schemaPropertyValueForMissingColumn;else if(HI===void 0)DI=n.schemaPropertyValueForUndefinedCellValue;else if(HI===null)DI=n.schemaPropertyValueForNullCellValue;else if(Array.isArray(aI.type)){var VI=parseArray(HI,n.arrayValueSeparator).map(function(pI){if(!NI){var xI=parseValue(pI,aI,n);return xI.error&&(DI=pI,NI=xI.error,yI=xI.reason),xI.value}});if(!NI){var hI=VI.every(isEmptyValue);DI=hI?n.getEmptyArrayValue(VI,{path:GI}):VI}}else{var wI=parseValue(HI,aI,n);NI=wI.error,yI=wI.reason,DI=NI?HI:wI.value}!NI&&isEmptyValue(DI)&&aI.required&&H.push({column:eI,value:DI,isMissingColumn:KI}),NI?a.push(r({column:eI,value:DI,error:NI,reason:yI})):(R&&!isEmptyValue(DI)&&(R=!1),DI!==void 0&&(B[aI.prop]=DI))},k=0,iI=Object.keys(e);k<iI.length;k++)II();if(R)return n.getEmptyObjectValue(B,{path:o});for(var lI=0,CI=H;lI<CI.length;lI++){var sI=CI[lI],oI=sI.column,E=sI.value,_=sI.isMissingColumn,gI=_&&n.schemaPropertyShouldSkipRequiredValidationForMissingColumn(oI,{object:B});if(!gI){var M=e[oI].required,O=typeof M=="boolean"?M:M(B);O&&a.push(r({column:oI,value:E,error:"required"}))}}return B}function parseValue(e,A,l){if(e===null)return{value:null};var o;if(A.parse?o=parseCustomValue(e,A.parse):A.type?o=parseValueOfType(e,Array.isArray(A.type)?A.type[0]:A.type,l):o={value:e},o.error)return o;if(o.value!==null){if(A.oneOf&&A.oneOf.indexOf(o.value)<0)return{error:"invalid",reason:"unknown"};if(A.validate)try{A.validate(o.value)}catch(t){return{error:t.message}}}return o}function parseCustomValue(e,A){try{var l=A(e);return l===void 0?{value:null}:{value:l}}catch(t){var o={error:t.message};return t.reason&&(o.reason=t.reason),o}}function parseValueOfType(e,A,l){switch(A){case String:return parseCustomValue(e,StringType);case Number:return parseCustomValue(e,NumberType);case Date:return parseCustomValue(e,function(o){return DateType(o,{properties:l.properties})});case Boolean:return parseCustomValue(e,BooleanType);default:if(typeof A=="function")return parseCustomValue(e,A);throw new Error("Unsupported schema type: ".concat(A&&A.name||A))}}function getBlock(e,A,l){for(var o=0,t="";l+o<e.length;){var a=e[l+o];if(a===A)return[t,o];if(a==='"'){var n=getBlock(e,'"',l+o+1);t+=n[0],o+=1+n[1]+1}else t+=a,o++}return[t,o]}function parseArray(e,A){for(var l=[],o=0;o<e.length;){var t=getBlock(e,A,o),a=_slicedToArray(t,2),n=a[0],B=a[1];o+=B+A.length,l.push(n.trim())}return l}var transpose=function e(A){return A[0].map(function(l,o){return A.map(function(t){return t[o]})})};function validateSchema(e){for(var A=0,l=Object.keys(e);A<l.length;A++){var o=l[A],t=e[o];if(!t.prop)throw new Error('"prop" not defined for schema entry "'.concat(o,'".'))}}function isEmptyValue(e){return e==null}function _typeof$3(e){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},_typeof$3(e)}function ownKeys$2(e,A){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);A&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),l.push.apply(l,o)}return l}function _objectSpread$2(e){for(var A=1;A<arguments.length;A++){var l=arguments[A]!=null?arguments[A]:{};A%2?ownKeys$2(Object(l),!0).forEach(function(o){_defineProperty$2(e,o,l[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):ownKeys$2(Object(l)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(l,o))})}return e}function _defineProperty$2(e,A,l){return A=_toPropertyKey$2(A),A in e?Object.defineProperty(e,A,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[A]=l,e}function _toPropertyKey$2(e){var A=_toPrimitive$2(e,"string");return _typeof$3(A)==="symbol"?A:String(A)}function _toPrimitive$2(e,A){if(_typeof$3(e)!=="object"||e===null)return e;var l=e[Symbol.toPrimitive];if(l!==void 0){var o=l.call(e,A);if(_typeof$3(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(e)}function mapToObjectsLegacyBehavior(e,A){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=l.includeNullValues,t=l.ignoreEmptyRows,a=l.isColumnOriented,n=l.rowMap,B={schemaPropertyValueForMissingColumn:void 0,schemaPropertyValueForUndefinedCellValue:void 0,schemaPropertyValueForNullCellValue:void 0,schemaPropertyShouldSkipRequiredValidationForMissingColumn:function(H,II){return II.path,!1},getEmptyObjectValue:function(H,II){var k=II.path;return k?void 0:null},getEmptyArrayValue:function(){return null},arrayValueSeparator:","};o&&(B.schemaPropertyValueForMissingColumn=null,B.schemaPropertyValueForUndefinedCellValue=null,B.schemaPropertyValueForNullCellValue=null,B.getEmptyObjectValue=function(r,H){return H.path,null});var R=mapToObjects(e,A,_objectSpread$2(_objectSpread$2({},B),{},{rowIndexMap:n,isColumnOriented:a}));return t!==!1&&(R.rows=R.rows.filter(function(r){return r!==B.getEmptyObjectValue(r,{path:void 0})})),R}function _typeof$2(e){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},_typeof$2(e)}var _excluded$1=["schemaPropertyValueForEmptyCell"];function ownKeys$1(e,A){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);A&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),l.push.apply(l,o)}return l}function _objectSpread$1(e){for(var A=1;A<arguments.length;A++){var l=arguments[A]!=null?arguments[A]:{};A%2?ownKeys$1(Object(l),!0).forEach(function(o){_defineProperty$1(e,o,l[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):ownKeys$1(Object(l)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(l,o))})}return e}function _defineProperty$1(e,A,l){return A=_toPropertyKey$1(A),A in e?Object.defineProperty(e,A,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[A]=l,e}function _toPropertyKey$1(e){var A=_toPrimitive$1(e,"string");return _typeof$2(A)==="symbol"?A:String(A)}function _toPrimitive$1(e,A){if(_typeof$2(e)!=="object"||e===null)return e;var l=e[Symbol.toPrimitive];if(l!==void 0){var o=l.call(e,A);if(_typeof$2(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(e)}function _objectWithoutProperties$1(e,A){if(e==null)return{};var l=_objectWithoutPropertiesLoose$1(e,A),o,t;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)o=a[t],!(A.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(l[o]=e[o])}return l}function _objectWithoutPropertiesLoose$1(e,A){if(e==null)return{};var l={},o=Object.keys(e),t,a;for(a=0;a<o.length;a++)t=o[a],!(A.indexOf(t)>=0)&&(l[t]=e[t]);return l}function mapToObjectsSpreadsheetBehavior(e,A,l){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},t=o.schemaPropertyValueForEmptyCell,a=_objectWithoutProperties$1(o,_excluded$1);return e(A,l,_objectSpread$1(_objectSpread$1({},a),{},{schemaPropertyValueForNullCellValue:t}))}function _typeof$1(e){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},_typeof$1(e)}function convertMapToSchema(e){for(var A={},l=0,o=Object.keys(e);l<o.length;l++){var t=o[l],a=e[t],n=void 0;_typeof$1(a)==="object"&&(a=Object.keys(e[t])[0],n=convertMapToSchema(e[t][a])),A[t]={prop:a},n&&(A[t].type=n)}return A}function _typeof(e){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},_typeof(e)}var _excluded=["schema","map"];function ownKeys(e,A){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);A&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),l.push.apply(l,o)}return l}function _objectSpread(e){for(var A=1;A<arguments.length;A++){var l=arguments[A]!=null?arguments[A]:{};A%2?ownKeys(Object(l),!0).forEach(function(o){_defineProperty(e,o,l[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):ownKeys(Object(l)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(l,o))})}return e}function _defineProperty(e,A,l){return A=_toPropertyKey(A),A in e?Object.defineProperty(e,A,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[A]=l,e}function _toPropertyKey(e){var A=_toPrimitive(e,"string");return _typeof(A)==="symbol"?A:String(A)}function _toPrimitive(e,A){if(_typeof(e)!=="object"||e===null)return e;var l=e[Symbol.toPrimitive];if(l!==void 0){var o=l.call(e,A);if(_typeof(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(e)}function _objectWithoutProperties(e,A){if(e==null)return{};var l=_objectWithoutPropertiesLoose(e,A),o,t;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)o=a[t],!(A.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(l[o]=e[o])}return l}function _objectWithoutPropertiesLoose(e,A){if(e==null)return{};var l={},o=Object.keys(e),t,a;for(a=0;a<o.length;a++)t=o[a],!(A.indexOf(t)>=0)&&(l[t]=e[t]);return l}function readXlsxFileContents(e,A,l){var o=l.schema,t=l.map,a=_objectWithoutProperties(l,_excluded);!o&&t&&(o=convertMapToSchema(t));var n=readXlsx(e,A,_objectSpread(_objectSpread({},a),{},{properties:o||a.properties}));return o?mapToObjectsSpreadsheetBehavior(mapToObjectsLegacyBehavior,n.data,o,_objectSpread(_objectSpread({},a),{},{properties:n.properties})):n}function readXlsxFile(e){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return unpackXlsxFile(e).then(function(l){return readXlsxFileContents(l,xml,A)})}class ReadTable extends React2.Component{customDatatableRef=React2.createRef();constructor(A){super(A),this.state={datalist:[],hasRequest:!1,show:!0}}clearList=()=>{this.setState({datalist:[]})};handleOnLoaded=(A,l)=>{try{A!==void 0&&(this.clearList(),this.setState({datalist:A,state:l}))}catch{this.alert()}};alert=()=>"";handleOnSubmit=()=>{DesmyRxServices.sendData({datalist:this.state.datalist,url:this.props.reader?.url,complete_url:this.props.reader?.complete_url,title:this.props.reader?.title,token:this.props.reader?.token,key_name:this.props.reader?.key_name},DesmyState.UPLOAD_MANAGER_REQUEST),this.props.onClose&&this.props.onClose()};handleOnClose=()=>{this.setState({show:!1})};render(){const{datalist:A,settings:l}=this.props,{datalist:o,state:t,hasRequest:a}=this.state;return jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full",children:[jsxRuntimeExports.jsx("div",{className:"w-full min-h-[20dvh] max-h-[55dvh] overflow-y-auto overflow-x-hidden",children:jsxRuntimeExports.jsx(DesmyDataSetTable,{className:"h-full font-poppinsRegular",settings:l,data:A,handleOnLoaded:this.handleOnLoaded,children:t===DesmyState.LOADING?Array.from({length:6}).map((n,B)=>jsxRuntimeExports.jsx(DesmyTableCard,{isLoading:!0},`dtal${B}`)):t===DesmyState.ERROR?jsxRuntimeExports.jsx(DesmyNetworkError,{}):DesmyCommons$1.isEmptyOrNull(o)?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:20,children:jsxRuntimeExports.jsx("div",{className:"flex flex-col space-y-2 w-full h-96 justify-center items-center",children:jsxRuntimeExports.jsx("div",{className:"font-poppinsMedium",children:"No data found"})})})}):o.map((n,B)=>{const R=B%2===0?"dark:bg-[#1c1c1c] bg-[#f3f4f6] dark:hover:bg-white":"bg-inherit";return jsxRuntimeExports.jsx(DesmyTableCard,{data:n,background:R,headers:l?.headers},`camp${n.id}${B}`)})})}),!a&&jsxRuntimeExports.jsx("div",{className:"flex w-full justify-end relative my-8 ",children:jsxRuntimeExports.jsx(DesmyButton,{onClick:this.handleOnSubmit,icon:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6 inline-block lg:mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})}),label:"Continue"})})]})}}class DesmySmartFormUpload extends React2.Component{wizardActionRef;constructor(A){super(A),this.wizardActionRef=React2.createRef(),this.state={hasRequest:!1,filedata:[],data:{meta:{count:0,current_page:1,next_page:null,total:0,from:1,to:0,last_page:1,per_page:100},links:{first:null,last:null},next:null,previous:null,count:0,data:[]},input:{}}}handleFileUpload=A=>{try{const{database:l}=this.props,o=A.target.files?.[0];if(!o)return;readXlsxFile(o,{sheet:this.props.reader.sheet_name}).then(t=>{if(t.length===0)return;const a=t[0].map(k=>`${k}`.toLowerCase().replace(/\s+/g,"_"));t=t.slice(1);const n=a.indexOf(this.props.filter_column?.parent??""),B=this.props.filter_column?.unique_fields?this.props.filter_column.unique_fields.map(k=>a.indexOf(k)):[],R={};n!==-1&&B.some(k=>k!==-1)&&t.forEach(k=>{B.forEach(iI=>{const lI=DesmyCommons$1.toString(k[iI]).toLowerCase();lI&&(R[lI]=k)})});let r=100,H=0;const II=async()=>{const k=Math.min(H+r,t.length),iI=t.slice(H,k),lI=iI.map(oI=>{const E={};if(a.forEach((_,gI)=>{l.find(O=>O.id===_)&&(E[_]=DesmyCommons$1.toStringDefault(oI[gI],""))}),!DesmyCommons$1.isEmptyOrNull(E?.parent_unit)){const _=DesmyCommons$1.toStringDefault(oI[n],"").toLowerCase(),gI=R[_];if(gI){const M={};a.forEach((O,dI)=>{O!==this.props.filter_column?.parent&&(M[O]=gI[dI])}),E[this.props.filter_column?.custom??""]=JSON.stringify(M)}}return B.length>0&&B.forEach(_=>{E[a[_]]&&(E.extra=`${E[a[_]]}`)}),E}),CI={...this.state.data.meta,count:this.state.data.data.length+lI.length,total:this.state.data.data.length+lI.length,to:this.state.data.data.length+lI.length},sI={...this.state.data,data:[...this.state.data.data,...lI],meta:CI};this.setState({filedata:[...this.state.filedata,...iI],data:sI},()=>{k<t.length&&(H=k,setTimeout(II,0))})};II()})}catch(l){console.error(l)}};render(){const A=this.props.database.map(l=>l.id);return this.props.settings.headers=A,this.props.settings.columns=A,jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full overflow-auto",children:jsxRuntimeExports.jsx("div",{className:"w-full font-poppinsRegular ",children:jsxRuntimeExports.jsx("div",{className:"flex flex-col h-full w-full",children:this.state.data.data.length===0?jsxRuntimeExports.jsxs("div",{className:"w-full  my-16 space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gray-200 dark:bg-darkPrimary rounded-lg w-full max-w-lg  mx-auto shadow-sm h-60 cursor-pointer relative overflow-hidden group",children:[jsxRuntimeExports.jsx("input",{type:"file",disabled:this.state.hasRequest,className:"absolute inset-0 w-full h-full opacity-0 z-50 cursor-pointer",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:this.handleFileUpload}),jsxRuntimeExports.jsxs("div",{className:"flex-col text-gray-500 dark:text-gray-400 flex h-full justify-center items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 mb-2",children:jsxRuntimeExports.jsx("img",{className:"object-center object-cover w-full h-full cursor-pointer m-auto",alt:"photo",src:this.props.reader?.ui?.icon??"./excel.png"})}),jsxRuntimeExports.jsx("div",{className:"text-xs md:text-sm",children:this.props.reader?.ui?.label??"[Drag and Drop or Click to Upload Excel]"})]})]}),DesmyCommons$1.isEmptyOrNull(this.props.reader.template_url)?null:jsxRuntimeExports.jsx("div",{className:" w-full max-w-lg mx-auto",children:jsxRuntimeExports.jsx("div",{className:"flex w-full justify-end",children:jsxRuntimeExports.jsx("a",{href:`${this.props.reader.template_url}`,target:"_blank",className:"uppercase text-xs bg-green-700 text-white px-4 py-2.5 rounded-full cursor-pointer",children:"Download Template"})})})]}):jsxRuntimeExports.jsx("div",{className:"z-5",children:jsxRuntimeExports.jsx(ReadTable,{headers:A,datalist:this.state.data,...this.props})})})})})})}}class DesmyCropper extends React2.Component{constructor(A){super(A),this.state={image:null}}componentDidMount(){const{media:A}=this.props;A.file!=null&&this.setState({image:URL.createObjectURL(A.file)})}componentWillUnmount(){this.state.image&&URL.revokeObjectURL(this.state.image)}render(){const{image:A}=this.state;return console.log("image=",A),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"fixed z-[50000] w-screen h-screen inset-0 overflow-y-auto font-poppinsRegular"})})}}class DesmyPassportPicker extends React2.Component{constructor(A){super(A),this.state={state:!0,showcropper:!1,media:{file:null},isLoading:!0,passport_photo:null,passport_photo_loading:"",passport_photo_is_verified:!1,error:{state:!1,message:""},input:{passport_photo:null},card_photo_is_verified:!1}}handleFileUpload=A=>{const l=A.target.files?.[0];if(l){if(!l.name.toLowerCase().match(/\.(png|jpeg|jpg)$/)){this.handleAlert("Error: You can only upload images in PNG, SVG, or JPG format.");return}if(l.size>1024*1024){this.handleAlert("Error: Image size should be less than 1MB.");return}this.setState({showcropper:!0,media:{file:l}})}};handleAlert=(A="")=>{try{const l=DesmyCommons$1.isEmptyOrNull(A)?DesmyState.ERROR_MESSAGE:A;this.setState({isLoading:!1,passport_photo_loading:""},()=>{this.props.error?.(l)})}catch{}};handleCancelPassportReader=()=>{};handleCropperClose=()=>{this.setState({showcropper:!1,media:{file:null}})};handleCropper=(A,l)=>{const{input:o}=this.state;o.passport_photo=A,this.setState({input:o,showcropper:!1,passport_photo:l,passport_photo_loading:DesmyState.LOADING},()=>{})};render(){const{showcropper:A}=this.state;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[A&&jsxRuntimeExports.jsx(DesmyCropper,{onSuccess:this.handleCropper,onClose:this.handleCropperClose,media:this.state.media}),jsxRuntimeExports.jsx("div",{className:`${this.props.className??"flex w-full justify-center "}`,children:jsxRuntimeExports.jsx("div",{className:"flex mx-auto lg:mx-0 mt-7 h-64 w-full md:w-1/2 relative shadow-sm bg-gray-200 dark:bg-darkPrimary justify-center items-center rounded-lg overflow-hidden",id:"dropzone",children:jsxRuntimeExports.jsx("div",{className:`absolute w-full h-full top-0 left-0 ${this.state.passport_photo_loading===DesmyState.LOADING?"bg-black bg-opacity-25":""} right-0 bottom-0`,children:jsxRuntimeExports.jsxs("div",{className:"flex p-6 relative flex-col justify-center h-full w-full items-center text-center",children:[DesmyCommons$1.isEmptyOrNull(this.state.passport_photo)?jsxRuntimeExports.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 z-50 cursor-pointer",accept:"image/*",onChange:this.handleFileUpload}):null,jsxRuntimeExports.jsx("div",{className:"text-center text-gray-500",children:this.state.passport_photo_loading===DesmyState.LOADING?jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full h-full text-white justify-center items-center",children:[jsxRuntimeExports.jsx("div",{className:"inline-block h-8 mb-4 mx-auto w-8 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]",role:"status",children:jsxRuntimeExports.jsx("span",{className:"!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]",children:"Loading..."})}),jsxRuntimeExports.jsx("div",{className:"flex w-full justify-center text-sm",children:"Analyzing Picture"})]}):this.state.passport_photo!==null&&this.state.passport_photo!==void 0?jsxRuntimeExports.jsx("div",{className:"absolute right-2 cursor-pointer top-2 w-6 h-6 dark:text-black rounded-full justify-center items-center",onClick:()=>this.handleCancelPassportReader(),children:jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 rounded-full border-[1px] border-black m-auto",children:jsxRuntimeExports.jsx("path",{d:"M2.93 17.07A10 10 0 1117.07 2.93 10 10 0 012.93 17.07zM11.4 10l2.83-2.83-1.41-1.41L10 8.59 7.17 5.76 5.76 7.17 8.59 10l-2.83 2.83 1.41 1.41L10 11.41l2.83 2.83 1.41-1.41L11.41 10z"})})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:.7,stroke:"currentColor",className:"mx-auto h-12 w-12",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})}),jsxRuntimeExports.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-500 dark:text-white",children:jsxRuntimeExports.jsx("label",{className:"relative cursor-pointer",children:jsxRuntimeExports.jsx("span",{children:"Click to upload photo"})})}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"PNG, JPG up to 200kB"})]})})]})})})})]})}}class DesmyVerticalStepper extends React2.Component{constructor(A){super(A),this.state={activeTab:A.tabs[0]?.id||""}}handleTabChange=A=>{this.setState({activeTab:A},()=>{this.props.selected&&this.props.selected(A)})};render(){const{activeTab:A}=this.state,{tabs:l,children:o}=this.props,t=React2.Children.toArray(o).find(a=>React2.isValidElement(a)&&a.props["data-tab"]===A);return jsxRuntimeExports.jsxs("div",{className:"flex space-x-5 dark:bg-darkDialogBackground font-poppinsRegular",children:[jsxRuntimeExports.jsx("div",{className:"lg:w-64 flex-shrink-0 dark:bg-darkBackground border-0 dark:border-darkPrimaryBorder",children:jsxRuntimeExports.jsx("ul",{className:"mr-2 space-y-2",children:l.map(a=>jsxRuntimeExports.jsxs("li",{className:`text-xs rounded flex items-center p-3 cursor-pointer ${A===a.id?"bg-primary/100 dark:bg-darkDialogBackground text-white":"hover:bg-gray-200 dark:hover:bg-white dark:hover:text-black"}`,onClick:()=>this.handleTabChange(a.id),children:[a.icon&&jsxRuntimeExports.jsx("span",{className:"lg:mr-2",children:a.icon}),jsxRuntimeExports.jsx("span",{className:"hidden lg:inline-block",children:a.name})]},a.id))})}),jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-100 dark:bg-inherit",children:jsxRuntimeExports.jsx("div",{className:"rounded-lg p-3",children:t||jsxRuntimeExports.jsx("div",{children:"No content available for this tab."})})})]})}}class DesmyTimeAgo extends React2.Component{intervalId=null;constructor(A){super(A),this.state={timeAgo:DesmyCommons$1.getTimeAgoAndCustomDate(this.props.timestamp)}}componentDidMount(){this.startInterval()}componentDidUpdate(A){A.timestamp!==this.props.timestamp&&(this.setState({timeAgo:DesmyCommons$1.getTimeAgoAndCustomDate(this.props.timestamp)}),this.clearInterval(),this.startInterval())}componentWillUnmount(){this.clearInterval()}startInterval(){this.intervalId=window.setInterval(()=>{this.setState({timeAgo:DesmyCommons$1.getTimeAgoAndCustomDate(this.props.timestamp)})},1e4)}clearInterval(){this.intervalId!==null&&(clearInterval(this.intervalId),this.intervalId=null)}render(){const{className:A}=this.props;return jsxRuntimeExports.jsx("span",{className:A,children:this.state.timeAgo})}}const DesmyComboBoxInput=React2.forwardRef(({value:e,onChange:A,onFocus:l,onKeyDown:o,onClick:t,placeholder:a,hasData:n},B)=>jsxRuntimeExports.jsxs("div",{className:"flex w-full bg-inherit",onClick:t,children:[jsxRuntimeExports.jsx("input",{type:"text",className:"flex flex-grow focus:outline-none text-sm w-full placeholder-gray-300 dark:placeholder-gray-600",value:e,onChange:A,onFocus:l,onKeyDown:o,placeholder:`${n?"Search here......":""}`,autoComplete:"off",ref:B}),jsxRuntimeExports.jsx("div",{className:`absolute left-1.5  ${a!=null&&n?"-top-2.5  text-xs":" text-sm top-2.5"} px-2 bg-inherit transition-all`,children:a})]}));class ComboBoxOption extends React2.Component{render(){const{option:A,isSelected:l,isHighlighted:o,onClick:t,onMouseEnter:a}=this.props,n=o?"bg-gray-200 dark:bg-darkPrimaryBorderLight":l?"bg-black-200 text-white dark:bg-darkPrimaryBorder":"";return jsxRuntimeExports.jsx("div",{className:`cursor-pointer px-6 py-3 font-normal  font-poppinsRegular hover:bg-gray-100 text-black dark:text-white dark:hover:bg-white dark:hover:text-black ${n}`,onClick:()=>t(A),onMouseEnter:a,role:"option","aria-selected":l,tabIndex:-1,children:A.name})}}class ComboBoxList extends React2.Component{render(){const{options:A,loading:l,selectedOptions:o,highlightedIndex:t,onOptionClick:a,onScroll:n,onOptionHover:B,className:R,style:r}=this.props;return jsxRuntimeExports.jsxs("div",{onScroll:n,className:`z-10 max-h-72 border-[1px] border-gray-200 dark:border-gray-700 shadow-lg w-full overflow-auto rounded text-sm ${R||"bg-white dark:bg-darkBackground dark:text-white"}`,role:"listbox",style:r,children:[A.length===0&&!l&&jsxRuntimeExports.jsx("div",{className:"p-2 text-gray-500 dark:text-white",children:"No options found"}),A.map((H,II)=>jsxRuntimeExports.jsx(ComboBoxOption,{option:H,isSelected:o.some(k=>k.id===H.id),isHighlighted:t===II,onClick:a,onMouseEnter:()=>B(II)},H.id)),l&&jsxRuntimeExports.jsx("div",{className:"p-2 text-center text-gray-500 dark:text-white",children:"Loading..."})]})}}function SelectedTag({option:e,onRemove:A}){return jsxRuntimeExports.jsxs("div",{className:"flex items-center bg-blue-200 cursor-pointer text-blue-800 dark:bg-white dark:text-black px-3 py-2.5 rounded-lg mr-1 mb-1 text-xs select-none",children:[jsxRuntimeExports.jsx("span",{children:e.name}),jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 12",onClick:()=>A(e.id),className:"size-4 ml-1 text-red-500 focus:outline-none",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M3.85 3.15a.5.5 0 0 0-.707.707l2.15 2.15l-2.15 2.15a.5.5 0 0 0 .707.707L6 6.714l2.15 2.15a.5.5 0 0 0 .707-.707l-2.15-2.15l2.15-2.15a.5.5 0 0 0-.707-.707L6 5.3z"})})]})}class DesmyComboBox extends React2.Component{containerRef=React2.createRef();inputRef=React2.createRef();debounceTimer=null;ignoreNextClickOutside=!1;constructor(A){super(A);const o=(t=>t?typeof t=="string"?[{id:t,name:t}]:Array.isArray(t)?t:[t]:[])(A.defaultValue);this.state={options:[...o],filteredOptions:[...o],loading:!1,page:1,totalPages:1,searchTerm:"",showDropdown:!1,selectedOptions:A.value?A.value:o,highlightedIndex:-1}}componentDidMount(){this.fetchOptions(1,this.state.searchTerm),document.addEventListener("click",this.handleClickOutside)}componentDidUpdate(A){this.props.value!==A.value&&this.props.value&&this.setState({selectedOptions:this.props.value})}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutside),this.debounceTimer&&window.clearTimeout(this.debounceTimer)}handleClickOutside=A=>{if(this.ignoreNextClickOutside)return;const l=this.containerRef.current;l&&!l.contains(A.target)&&this.setState({showDropdown:!1,highlightedIndex:-1})};openDropdown=()=>{this.setState({showDropdown:!0})};fetchOptions=async(A,l)=>{const{request:o}=this.props;if(!(!o||!o.url)){this.setState({loading:!0});try{const t=o.token?{Authorization:`${o.token}`}:{},n=(await axios.get(o.url,{headers:t,params:{query:l,page:A}})).data;if(n.success){const B=n.data.meta,R=n.data.data;this.setState(r=>{const H=new Set(r.options.map(lI=>lI.id)),II=R.filter(lI=>!H.has(lI.id)),k=[...r.options,...II],iI=k.filter(lI=>!r.selectedOptions.some(CI=>CI.id===lI.id)).filter(lI=>lI.name.toLowerCase().includes(l.toLowerCase()));return{options:k,filteredOptions:iI,page:B.current_page,totalPages:B.last_page,loading:!1}})}else this.setState({loading:!1})}catch{this.setState({loading:!1})}}};handleInputChange=A=>{const l=A.target.value;this.debounceTimer&&window.clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout(()=>{this.setState({searchTerm:l,options:[],filteredOptions:[],page:1,totalPages:1,loading:!1,showDropdown:!0,highlightedIndex:-1},()=>{this.fetchOptions(1,l)})},this.props.debounceTime??300),this.setState({searchTerm:l,showDropdown:!0})};handleOptionClick=(A,l)=>{l&&l.stopPropagation(),this.ignoreNextClickOutside=!0,this.setState(o=>{if(o.selectedOptions.find(B=>B.id===A.id))return null;const t=[...o.selectedOptions,A];this.props.onChange&&this.props.onChange(t);const a=o.filteredOptions.filter(B=>B.id!==A.id),n=o.options.filter(B=>B.id!==A.id);return{selectedOptions:t,searchTerm:"",filteredOptions:a,options:n,highlightedIndex:-1,showDropdown:!!this.props.is_multiple}},()=>{this.focusInput(),this.state.page<this.state.totalPages&&!this.state.loading&&this.fetchOptions(this.state.page+1,this.state.searchTerm),setTimeout(()=>{this.ignoreNextClickOutside=!1},0)})};focusInput(){this.inputRef.current?.focus()}handleRemoveTag=A=>{this.setState(l=>{const o=l.selectedOptions.length===1,t=o?[]:l.selectedOptions.filter(n=>n.id!==A);this.props.onChange&&this.props.onChange(t),o&&this.props.onClear&&this.props.onClear();let a=l.filteredOptions;if(!o){const n=l.options.find(B=>B.id===A);n&&!l.filteredOptions.some(B=>B.id===A)&&(a=[...l.filteredOptions,n]),a=a.filter(B=>B.name.toLowerCase().includes(l.searchTerm.toLowerCase()))}return{selectedOptions:t,filteredOptions:a}})};handleScroll=A=>{const{scrollTop:l,scrollHeight:o,clientHeight:t}=A.currentTarget,{loading:a,page:n,totalPages:B,searchTerm:R}=this.state;o-l-t<10&&!a&&n<B&&this.fetchOptions(n+1,R)};handleOptionHover=A=>{this.setState({highlightedIndex:A})};handleKeyDown=A=>{const{highlightedIndex:l,filteredOptions:o,showDropdown:t,searchTerm:a,selectedOptions:n}=this.state;if(!t){A.key==="ArrowDown"&&(this.openDropdown(),this.setState({highlightedIndex:0}),A.preventDefault());return}switch(A.key){case"ArrowDown":A.preventDefault(),this.setState(B=>({highlightedIndex:B.highlightedIndex<B.filteredOptions.length-1?B.highlightedIndex+1:0}));break;case"ArrowUp":A.preventDefault(),this.setState(B=>({highlightedIndex:B.highlightedIndex>0?B.highlightedIndex-1:B.filteredOptions.length-1}));break;case"Enter":A.preventDefault(),l>=0&&l<o.length&&this.handleOptionClick(o[l]);break;case"Backspace":!a&&n.length>0&&this.handleRemoveTag(n[n.length-1].id);break;case"Escape":A.preventDefault(),this.setState({showDropdown:!1,highlightedIndex:-1});break}};renderDropdown(){const{filteredOptions:A,loading:l,showDropdown:o,highlightedIndex:t}=this.state;return o?jsxRuntimeExports.jsx(DropdownPositionWrapper,{targetRef:this.inputRef,visible:o,maxHeight:350,onScroll:this.handleScroll,children:jsxRuntimeExports.jsx(ComboBoxList,{options:A,loading:l,selectedOptions:this.props.value??this.state.selectedOptions,highlightedIndex:t,onOptionClick:this.handleOptionClick,onOptionHover:this.handleOptionHover,onScroll:this.handleScroll,style:{width:"100%",maxHeight:"100%",overflowY:"auto"}})}):null}handleClearAll=()=>{this.setState({selectedOptions:[]},()=>{this.props.onChange&&this.props.onChange([]),this.props.onClear&&this.props.onClear()})};render(){const{searchTerm:A,selectedOptions:l}=this.state,{placeholder:o,containerClassName:t,type:a=DesmyState.COMBOBOX}=this.props,n=this.props.value??l,B=A;return jsxRuntimeExports.jsxs("div",{className:`relative w-full font-normal text-sm ${t||"bg-white dark:bg-darkBackground dark:text-white"}`,ref:this.containerRef,children:[jsxRuntimeExports.jsxs("div",{className:`flex ${n.length===0?"":`flex-wrap ${a===DesmyState.NORMAL?"":"pt-5"}`} items-center border font-poppinsRegular border-gray-300 dark:border-white bg-inherit rounded-none px-2 py-1 min-h-12 cursor-text  transition-all`,children:[a===DesmyState.NORMAL?jsxRuntimeExports.jsxs("div",{className:"w-full py-2 flex items-start justify-between ",children:[jsxRuntimeExports.jsx("div",{className:"w-full",children:n.map(R=>R.name).join(", ")}),n.length>0&&jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 12",onClick:this.handleClearAll,className:"size-4 ml-1 text-red-500 focus:outline-none cursor-pointer",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M3.85 3.15a.5.5 0 0 0-.707.707l2.15 2.15l-2.15 2.15a.5.5 0 0 0 .707.707L6 6.714l2.15 2.15a.5.5 0 0 0 .707-.707l-2.15-2.15l2.15-2.15a.5.5 0 0 0-.707-.707L6 5.3z"})})]}):n.map(R=>jsxRuntimeExports.jsx(SelectedTag,{option:R,onRemove:this.handleRemoveTag},R.id)),jsxRuntimeExports.jsx("div",{className:`${n.length===0?"py-0":"py-2"} w-full bg-inherit`,children:jsxRuntimeExports.jsx(DesmyComboBoxInput,{ref:this.inputRef,hasData:n.length!==0,onClick:()=>this.focusInput(),value:B,placeholder:o,onChange:this.handleInputChange,onFocus:this.openDropdown,onKeyDown:this.handleKeyDown})})]}),this.renderDropdown()]})}}exports.DesmyAccordion=DesmyAccordion,exports.DesmyAuth=DesmyAuth$1,exports.DesmyAxiosService=DesmyAxiosService,exports.DesmyButton=DesmyButton,exports.DesmyClickOutsideListener=DesmyClickOutsideListener,exports.DesmyComboBox=DesmyComboBox,exports.DesmyCommons=DesmyCommons$1,exports.DesmyCustomDataTable=DesmyCustomDataTable,exports.DesmyDataSetTable=DesmyDataSetTable,exports.DesmyDataTable=DesmyDataTable,exports.DesmyDatePicker=DesmyDatePicker,exports.DesmyDocumentPicker=DesmyDocumentPicker,exports.DesmyDropdown=DesmyDropdown,exports.DesmyEmpty=DesmyEmpty,exports.DesmyFilePicker=DesmyFilePicker,exports.DesmyLazyImage=DesmyLazyImage,exports.DesmyLazyloading=DesmyLazyloading,exports.DesmyListCard=DesmyListCard,exports.DesmyModalContainer=DesmyModalContainer,exports.DesmyModalHandler=DesmyModalHandler,exports.DesmyModalWrapper=DesmyModalWrapper,exports.DesmyMultiStepModal=DesmyMultiStepModal,exports.DesmyNetworkError=DesmyNetworkError,exports.DesmyNoDataFound=DesmyNoDataFound,exports.DesmyPDFReader=DesmyPDFReader,exports.DesmyPassportPicker=DesmyPassportPicker,exports.DesmyPermissions=DesmyPermissions$1,exports.DesmyPopupMenu=DesmyPopupMenu,exports.DesmyReadMoreOrLess=DesmyReadMoreOrLess,exports.DesmyRenderRoutes=DesmyRenderRoutes,exports.DesmyRxServices=DesmyRxServices,exports.DesmySearchInput=DesmySearchInput,exports.DesmySideBarItem=DesmySideBarItem,exports.DesmySmartFormUpload=DesmySmartFormUpload,exports.DesmyState=DesmyState,exports.DesmySuspenseWrapper=DesmySuspenseWrapper,exports.DesmyTabLayout=DesmyTabLayout,exports.DesmyTableCard=DesmyTableCard,exports.DesmyTextInput=DesmyTextInput,exports.DesmyThemeContext=DesmyThemeContext,exports.DesmyThemeProvider=DesmyThemeProvider,exports.DesmyTimeAgo=DesmyTimeAgo,exports.DesmyToast=DesmyToast,exports.DesmyToastProvider=DesmyToastProvider,exports.DesmyUploadManager=DesmyUploadManager,exports.DesmyVerticalStepper=DesmyVerticalStepper,exports.DesmyWithRouter=DesmyWithRouter,exports.DesmyWizard=DesmyWizard,exports.useToast=useToast,Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.umd.js.map
